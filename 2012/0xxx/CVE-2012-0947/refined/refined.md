Based on the provided content, here's the breakdown of CVE-2012-0947:

**Root cause of vulnerability:**

*   A heap-based buffer overflow exists in the `vqa_decode_chunk` function within the libavcodec library, specifically when handling Westwood Studios VQA files. This function is part of FFmpeg.
*   The vulnerability arises from a lack of bounds checking within an inner loop that writes pixel data, which allows writing beyond the allocated buffer.

**Weaknesses/vulnerabilities present:**

*   **Heap-based buffer overflow:** The core issue is that the decoder writes data beyond the bounds of a heap-allocated buffer.

**Impact of exploitation:**

*   **Denial of Service (DoS):** A crafted VQA file can cause the application to crash.
*   **Arbitrary code execution:** It may be possible to execute arbitrary code with the privileges of the user running the vulnerable application.

**Attack vectors:**

*   The vulnerability is triggered by opening a specially crafted VQA file.
*   The attack requires tricking a user into opening the malicious file, likely using social engineering tactics.

**Required attacker capabilities/position:**

*   The attacker needs to create a malformed VQA file designed to trigger the overflow.
*   The attacker must then convince a user to open this crafted file using a vulnerable version of FFmpeg.

**Additional details:**
*   The vulnerability was discovered by Fabian Yamaguchi.
*   A patch was provided by upstream libav which checks the image size and returns an error if the size is not a multiple of the block size to prevent the overflow.
*   Upstream ffmpeg had fixed the issue prior to public disclosure (commit 3583c8706df0abbfa3ecdd6730f4f3d72a01fe6d)
*   The vulnerability affects both libav and ffmpeg
*   The fix was included in libav version 0.8.2 and later.

The provided information gives more detailed insight compared to a basic CVE description, detailing the specific vulnerable function, code snippet, and the mechanism of the overflow.