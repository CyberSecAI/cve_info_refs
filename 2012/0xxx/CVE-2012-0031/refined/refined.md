```
{
  "cve": "CVE-2012-0031",
  "description": "A flaw was found in the way httpd handled child process status information. A malicious program running with httpd child process privileges could use this flaw to cause the parent httpd process to crash during httpd service shutdown.",
  "information": {
    "root_cause": "A child process can trigger the bug by changing the value of *ap_scoreboard_e sb_type*, which resides in the *global_score* structure on the shared memory segment. The value is usually 2 (SB_SHARED).  When changing the scoreboard type of a shared memory segment to something else, the root process will try to release the shared memory using free during normal shutdown. Since the memory was allocated using *mmap*, not *malloc*, the call to *free* from *ap_cleanup_scoreboard* (server/scoreboard.c) triggers an abort within libc.",
    "vulnerabilities": [
      "A child process can change the scoreboard type of a shared memory segment, leading to an invalid free operation in the parent process during shutdown."
    ],
    "impact": "The parent httpd process crashes during shutdown. This could have a denial of service impact.",
    "attack_vectors": [
      "A malicious program running with httpd child process privileges (such as a PHP or CGI script) can modify the shared memory segment."
    ],
    "attacker_capabilities": "Attacker needs to have code execution within an httpd child process to alter the shared memory.",
     "additional_details": "This issue affects httpd versions 2.2.17 through 2.2.21, and is fixed in version 2.2.22.  It affects threaded MPMs (such as event or worker) and not prefork by default on Red Hat Enterprise Linux and Fedora. A vulnerable configuration is when cookie logging is enabled via format string: '%{cookiename}C' "
  }
}
```