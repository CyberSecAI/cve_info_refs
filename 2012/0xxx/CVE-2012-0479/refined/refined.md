Based on the provided content, here's an analysis of CVE-2012-0479:

**1. Verification:**

The provided content includes a bug report from bugzilla.mozilla.org that is explicitly associated with `CVE-2012-0479`. Additionally, the description from mozilla.org confirms this CVE regarding a site identity spoofing issue when loading RSS and Atom feeds.

**2. Root Cause of Vulnerability:**

The root cause is an incorrect handling of Atom/RSS feeds with invalid content loaded over HTTPS. Specifically:

*   The browser's feed converter processes the content.
*   The site identity block updates based on the URL of the feed.
*   The browser does not correctly handle a situation where the feed is invalid, especially when an HTTP error is returned along with the invalid feed.
*   The browser may download the feed, but if that is cancelled, the site identity is still spoofed.

This leads to a state where the address bar shows the URL and security indicators (like the padlock icon) of the HTTPS feed source, while the main window still displays the content of the original page.

**3. Weaknesses/Vulnerabilities Present:**

*   **Site Identity Spoofing:** The browser incorrectly displays the identity of the HTTPS feed source instead of the actual content source, leading to a false sense of security.
*   **Mishandling of Error Responses:** The browser doesn't properly handle error responses (like HTTP 404 or 500) containing XML content while processing Atom/RSS feeds.
*   **Incorrect Stream Conversion:** The feed converter within the browser does not check the HTTP channel response status before processing the content. This results in the secure browser UI assuming that data read from the network means data rendered, which is a broken assumption.

**4. Impact of Exploitation:**

*   **Phishing Attacks:** An attacker can use a malicious page to redirect users to a resource that returns an invalid Atom/RSS feed over HTTPS, while the content of the original page remains, but the browser displays the identity (including SSL indicators) of the resource, potentially tricking users into thinking they are on a legitimate website.
*   **Trust Violation:** Users might be tricked into trusting a malicious site because the security indicators in the address bar are showing that it is secure and trusted (e.g., "Mozilla Corporation" instead of a malicious domain). This is particularly dangerous with sites that use Extended Validation certificates.

**5. Attack Vectors:**

*   **Redirection:** A malicious web page can redirect the user to an HTTPS resource that returns an invalid Atom/RSS feed.
*   **Manual Entry:** Users manually entering the URL of an invalid Atom/RSS feed over HTTPS in the address bar can trigger the vulnerability.

**6. Required Attacker Capabilities/Position:**

*   **Ability to serve a page:** Attackers need to host a malicious web page to initiate the redirect.
*   **HTTPS Server with Invalid Feed:** An attacker needs a server that can respond to requests with an HTTPS response, using a feed content type with an invalid body.
*   **No user interaction required** other than navigating to a malicious URL or entering a crafted URL.

**Additional Technical Details:**

*   The vulnerability is triggered by the browser's handling of `application/atom+xml` or `application/rss+xml` mime types.
*   The issue is specific to cases where the feed data is invalid, leading to the failure of the feed converter.
*   The bug also occurs when a user manually enters the URL of an invalid Atom/RSS feed into the address bar.
*   The security UI was incorrectly updating based on the transfer of data, not the rendering of the content.
*  The issue is also present when a user cancels the download dialog caused by the invalid feed.

**Resolution:**

*   The vulnerability was addressed by having the feed converter check the HTTP channel response status before proceeding.
*   The security UI was updated to stop assuming that bytes transferred == bytes rendered.

**Affected Products:**

*   Firefox
*   Firefox ESR
*   SeaMonkey
*   Thunderbird
*   Thunderbird ESR

**Versions Fixed In:**

*   Firefox 12
*   Firefox ESR 10.0.4
*   SeaMonkey 2.9
*   Thunderbird 12
*   Thunderbird ESR 10.0.4