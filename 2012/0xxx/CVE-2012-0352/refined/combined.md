=== Content from tools.cisco.com_e0bff9c9_20250124_141835.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

| | Cisco Security AdvisoryCisco NX-OS Malformed IP Packet Denial of Service Vulnerability Severity   Advisory ID:  cisco-sa-20120215-nxos  First Published: 2012 February 15 16:00 GMT  Last Updated:  2012 March 26 21:02 GMT  Version 2.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Cisco Bug IDs: [CSCti23447](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti23447)  [CSCti49507](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti49507)  [CSCtj01991](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtj01991)            Email      Summary  * Cisco NX-OS Software is affected by a denial of service (DoS)   vulnerability that could cause Cisco Nexus 1000v, 1010, 5000, and 7000 Series Switches, and the Cisco Virtual Security Gateway (VSG) for Nexus 1000V Series Switches, that are running affected versions of Cisco   NX-OS Software to reload when the IP stack processes a malformed IP   packet.  Cisco has released software updates that address this vulnerability. This advisory is available at the following link:      <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120215-nxos>  Affected Products  * Vulnerable Products Cisco Nexus 1000v, 1010, 5000, and 7000 Series Switches, and the Cisco VSG for Nexus 1000V Series Switches that are running affected versions   of Cisco NX-OS Software are affected by this vulnerability. The   vulnerability is in the operating system's IP stack; therefore, any feature   that makes use of the services that are offered by the IP stack to process IP packets   is affected.  Cisco NX-OS Software versions prior to the First Fixed Release version are affected. Refer to the Software Versions and Fixes   section for details regarding fixed versions.  To determine the version of Cisco NX-OS Software that is running on a Cisco   Nexus switch, administrators can log in to the device and issue the **show   version** command to display the system banner. The following example   shows how to display the version information for the kickstart and   system image that is running on a device that runs Cisco NX-OS Release 5.1(3):  ```   switch# show version   Cisco Nexus Operating System (NX-OS) Software   TAC support: http://www.cisco.com/tac   Documents: http://www.cisco.com/en/US/products/ps9372/tsd_products_support_serie   s_home.html   Copyright (c) 2002-2011, Cisco Systems, Inc. All rights reserved.   The copyrights to certain works contained in this software are   owned by other third parties and used and distributed under   license. Certain components of this software are licensed under   the GNU General Public License (GPL) version 2.0 or the GNU   Lesser General Public License (LGPL) Version 2.1. A copy of each   such license is available at   http://www.opensource.org/licenses/gpl-2.0.php and   http://www.opensource.org/licenses/lgpl-2.1.php      Software     BIOS:      version 3.22.0     kickstart: version 5.1(3)     system:    version 5.1(3)      [...]   ``` Products Confirmed Not VulnerableCisco NX-OS Software for products other than the Cisco Nexus 1000v, 1010, 5000, and 7000 Series Switches, and the Cisco VSG for Nexus 1000V Series Switches, is not affected by this vulnerability. In   particular, the following products that run Cisco NX-OS Software   are not affected:   + Cisco Nexus 2000 Series Switches   + Cisco Nexus 3000 Series Switches   + Cisco Nexus 4000 Series Switches   + Unified Computing System (UCS)   + Cisco MDS 9000 Series Multilayer Switches No other Cisco products are currently known to be affected by this vulnerability.  Details  * Cisco NX-OS Software is the network operating system used by Cisco   products that are part of the Cisco Data Center switching portfolio,   which includes data center switches such as the Cisco Nexus 5000 Series   and the Cisco Nexus 7000 Series.  Certain versions of Cisco NX-OS Software for Cisco Nexus 1000v, 1010, 5000, and 7000 Series Switches, and the Cisco   Virtual Security Gateway (VSG) for Nexus 1000V Series Switches, are affected by a   vulnerability that may cause a reload of an affected device when the   operating system's IP stack processes a malformed IP packet   and obtaining Layer 4 (UDP or TCP) information from the packet is   required.  The vulnerability is in the operating system's IP stack   and any feature that makes use of services offered by the IP stack to   parse IP packets is affected. For instance, the following scenarios may   trigger the vulnerability because they imply that Layer 4 (UDP or TCP)   information is required to be able to perform the configured function:    + A malformed, transit IP packet that would normally be forwarded by the switch is received and     the Time-to-live (TTL) is 1. In this case, an ICMP error message (time     exceeded) needs to be generated. During generation of this ICMP     message, the bug could be triggered.   + Policy-based routing is in use, and to make a routing     decision, an incoming packet needs to be parsed. If the packet is a     malformed TCP segment and the routing policy uses TCP information for     routing decisions, then this bug could be triggered.   + An egress Access Control List (ACL) is applied to an     interface and a malformed IP packet that needs to be forwarded through     that interface is received. **Note:** This list is not exhaustive. It contains some of the   scenarios that have been confirmed to trigger the vulnerability   described in this document. Other scenarios that require accessing Layer   4 information of a malformed IP packet may also result in the   vulnerability being triggered.  Both through-the-device (transit) traffic and to-the-device traffic may trigger this vulnerability. An affected Cisco Nexus switch that has a configured IP address is affected by this vulnerability even if the IP address is used only for management and if the device is configured as a pure Layer 2 switch; that is, no Layer 3 packet forwarding.  When a system reloads because of this vulnerability, a   process called "netstack" will terminate unexpectedly, and the following message will be recorded to the system log:  ```   2012 Feb 02 20:32:15 NX-7010 %SYSMGR-2-SERVICE_CRASHED: Service "netstack" (PID 4335)    hasn't caught signal 11 (core will be saved).   ```  This vulnerability is documented in Cisco Bug IDs [**CSCti23447**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti23447)   ([registered](https://sec.cloudapps.cisco.comRPF/register/register.do) customers only)   and [**CSCti49507**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti49507)   ([registered](https://sec.cloudapps.cisco.comRPF/register/register.do) customers only)   (Cisco Nexus 1000v and 7000 Series) and [**CSCtj01991**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtj01991)   ([registered](https://sec.cloudapps.cisco.comRPF/register/register.do) customers only)   (Cisco Nexus 5000 Series), and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2012-0352.  **Note:** Two Cisco Bug IDs are used to track this vulnerability in Cisco   Nexus 1000v and 7000 Series Switches because the vulnerability was partially   fixed by Cisco Bug [**CSCti23447**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti23447). The fix was completed with [**CSCti49507**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCti49507). For the Cisco Nexus 5000 Series Switches, the vulnerability was completely fixed by Cisco Bug [**CSCtj01991**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtj01991)  Workarounds  * There are no workarounds for the vulnerability described in this document.  Fixed Software  * When   considering software upgrades, customers are advised to consult the   Cisco Security Advisories and Responses archive at <http://www.cisco.com/go/psirt> and review subsequent advisories to   determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded   contain sufficient memory and confirm that current hardware and   software configurations will continue to be supported properly by the   new release. If the information is not clear, customers are advised to   contact the Cisco Technical Assistance Center (TAC) or their contracted   maintenance providers.  Each row of the Cisco NX-OS Software table (below) names a Cisco   NX-OS Software release train. If a given release train is vulnerable,   then the earliest possible releases that contain the fix (along with the   anticipated date of availability for each, if applicable) are listed in   the First Fixed Release column of the table. A device that is running   a release in the given train that is earlier than the release in a   specific column (less than the First Fixed Release) is known to be   vulnerable.       | Platform | Major Release | First Fixed Release |   | --- | --- | --- |   | Cisco VSG for Nexus 1000V Series Switches | 4.x | 4.2(1)VSG1(3.1) |   | Nexus 1000v Series Switches | 4.x | 4.2(1)SV1(4b) (available late April 2012) 4.2(1)SV1(5.1) |   | Nexus 1010 Series Switches | 4.x | 4.2(1)SP1(4) |   | Nexus 5000 Series Switches | 4.x | Vulnerable; migrate to 5.x |   | 5.0.x | 5.0(2)N1(1) |   | 5.1.x | Not vulnerable |   | Nexus 7000 Series Switches | 4.2.x | 4.2.8 |   | 5.0.x | 5.0.5 |   | 5.1.x | 5.1.1 |   | 5.2.x | Not vulnerable |   | 6.x | Not vulnerable |         Cisco NX-OS Software can be downloaded at  <http://www.cisco.com/cisco/software/find.html?q=nx-os>  Exploitation and Public Announcements  * The Cisco   Product Security Incident Response Team (PSIRT) is not aware of any   public announcements or malicious use of the vulnerability that is   described in this advisory.  This vulnerability was discovered while working on customer support cases.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120215-nxos>  Revision History  * | Revision 2.0 | 2012-March-26 | Added Nexus 1010 and VSG as vulnerable products and included fixed software information for them. Added 4.2(1)SV1(4b) as a first fixed release for Nexus 1000v. |   | --- | --- | --- |   | Revision 1.1 | 2012-February-17 | Added 4.x releases for Nexus 1000v Series Switches as vulnerable. |   | Revision 1.0 | 2012-February-15 | Initial public release. |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


