=== Content from bugs.gentoo.org_d4f5dbaf_20250126_012057.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 351490
<app-admin/sudo-1.7.4\_p5: Flaw in Runas Group password checking (CVE-2011-0010)
Last modified: 2012-03-06 02:03:46 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=351490&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=351490&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 351490**](show_bug.cgi?id=351490)
(CVE-2011-0010)
- <app-admin/sudo-1.7.4\_p5: Flaw in Runas Group password checking (CVE-2011-0010)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<app-admin/sudo-1.7.4\_p5: Flaw in Runas Group password checking (CVE-2011-0010)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2011-0010 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.sudo.ws/sudo/alerts/runas\_...](http://www.sudo.ws/sudo/alerts/runas_group_pw.html) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | A1 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2011-01-12 21:40 UTC by Tim Sammut (RETIRED) | | --- | --- | | Modified: | 2012-03-06 02:03 UTC ([History](show_activity.cgi?id=351490)) | | CC List: | 1 user (show)  base-system | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=351490&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=351490&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Tim Sammut (RETIRED)   gentoo-dev  2011-01-12 21:40:22 UTC  ``` From $URL:  Summary: Beginning with sudo version 1.7.0 it has been possible to grant permission to run a command using a specified group via sudo's -g option (run as group), if allowed by the sudoers file. A flaw exists in sudo's password checking logic that allows a user to run a command with only the group changed without being prompted for a password.  Sudo versions affected: Sudo 1.7.0 through 1.7.4p4.  CVE ID: This vulnerability has been assigned CVE CVE-2011-0010 in the Common Vulnerabilities and Exposures database.  Details: It is possible to specify lists of users and groups that a command may be run as in a sudoers file entry. For example, given the following sudoers entry:      %sudo ALL = (ALL : ALL) ALL  a user in the sudo group will be permitted to run any command with any combination of user or group. When sudo determines whether or not to prompt for a password, it first checks whether the invoking user is root, the invoking user is a member of an "exempt" group, or that the target user is the same as the invoking user. If any of those three conditions are true, no password is required. When the "runas group" support was added in sudo 1.7.0, this logic was not updated to take the target group into account. This resulted in sudo incorrectly skipping the password check when the target user is the same as the invoking user, but the invoking user is not a member of the target group.  Impact: Exploitation of the flaw requires that sudo be configured with sudoers entries that contain a Runas group. Entries that do not contain a Runas group, or only contain a Runas user are not affected.  For example, the following entry is affected because it contains both a Runas user and a Runas group:      %sudo ALL = (ALL : ALL) ALL  Whereas this one only contains a Runas user and is not affected:      %wheel ALL = (ALL) ALL  Note that this flaw does not allow a user to run unauthorized commands, it only affects user authentication.  Fix: The flaw is fixed in sudo 1.7.4p5. ```  [Comment 1](#c1)  Diego Elio Pettenò (RETIRED)   gentoo-dev  2011-01-12 21:52:13 UTC  ``` Seen the release notes, bumping in a moment.  ```  [Comment 2](#c2)  Diego Elio Pettenò (RETIRED)   gentoo-dev  2011-01-12 22:26:41 UTC  ``` In tree now.  ```  [Comment 3](#c3)  Tim Sammut (RETIRED)   gentoo-dev  2011-01-12 22:28:48 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=351490#c2)) > In tree now. >   Great, thank you. Are we ok to call for stabilization now?  ```  [Comment 4](#c4)  Tim Sammut (RETIRED)   gentoo-dev  2011-01-12 22:38:47 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=351490#c3)) >  > Great, thank you. Are we ok to call for stabilization now?  >   Thanks for the go-ahead via IRC.  Arches, please test and mark stable: =app-admin/sudo-1.7.4_p5 Target keywords : "alpha amd64 arm hppa ia64 m68k ppc ppc64 s390 sh sparc x86"  ```  [Comment 5](#c5)  Markos Chandras (RETIRED)   gentoo-dev  2011-01-12 22:54:47 UTC  ``` This is a nasty security issue. amd64 done ```  [Comment 6](#c6)  Alex Buell    2011-01-12 23:51:47 UTC  ``` Tested on SPARC, sudo works as usual, no problems found. Please stabilise. ```  [Comment 7](#c7)  Andreas Schürch   gentoo-dev  2011-01-13 07:58:46 UTC  ``` I tested it on x86, looks good over here. ```  [Comment 8](#c8)  Kacper Kowalik (Xarthisius) (RETIRED)   gentoo-dev  2011-01-13 08:02:33 UTC  ``` ppc/ppc64 stable ```  [Comment 9](#c9)  Jeroen Roovers (RETIRED)   gentoo-dev  2011-01-13 14:29:05 UTC  ``` Stable for HPPA. ```  [Comment 10](#c10)  Paweł Hajdan, Jr. (RETIRED)   gentoo-dev  2011-01-15 10:36:19 UTC  ``` x86 stable, thanks Andreas ```  [Comment 11](#c11)  Markus Meier   gentoo-dev  2011-01-15 12:13:43 UTC  ``` arm stable ```  [Comment 12](#c12)  Raúl Porcel (RETIRED)   gentoo-dev  2011-01-15 12:32:36 UTC  ``` alpha/ia64/m68k/s390/sh/sparc stable ```  [Comment 13](#c13)  Tim Sammut (RETIRED)   gentoo-dev  2011-01-15 15:05:16 UTC  ``` Thanks, folks. GLSA request filed. ```  [Comment 14](#c14)  GLSAMaker/CVETool Bot   gentoo-dev  2011-06-20 11:23:05 UTC  ``` CVE-2011-0010 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2011-0010>):   check.c in sudo 1.7.x before 1.7.4p5, when a Runas group is configured, does   not require a password for command execution that involves a gid change but   no uid change, which allows local users to bypass an intended authentication   requirement via the -g option to a sudo command. ```  [Comment 15](#c15)  GLSAMaker/CVETool Bot   gentoo-dev  2012-03-06 02:03:46 UTC  ``` This issue was resolved and addressed in  GLSA 201203-06 at <http://security.gentoo.org/glsa/glsa-201203-06.xml> by GLSA coordinator Sean Amoss (ackle). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=351490)
* - [XML](show_bug.cgi?ctype=xml&id=351490)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=351490)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=351490&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=351490&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=351490&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.sudo.ws_c330b406_20250124_134210.html ===


Open Navigation

Close Navigation

[Sudo](https://www.sudo.ws/)

[GitHub](https://github.com/sudo-project/sudo%20%20%20%20%20%20%20%20%20%20%20%20)

[Blog](/posts/%20%20%20%20%20%20%20%20%20%20%20%20)

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

[Back to homepage](https://www.sudo.ws/)

Close Menu Bar

Open Menu Bar

[![Sudo Logo](/images/sudo-sandwich-logo-65.png)](/)

* About Sudo
  + [A Short Introduction](/about/intro/)
  + [A Brief History of Sudo](/about/history/)
  + [Contributors](/about/contributors/)
  + [Translations](/about/translations/)
  + [Sudo Plugins](/about/plugins/)
  + [Sudo License](/about/license/)
  + [Sudo Logo](/about/logo/)
  + [Export Controls](/about/export/)
* Releases
  + [Stable Release](/releases/stable/)
  + [Legacy Release](/releases/legacy/)
  + [Development Release](/releases/devel/)
  + [ChangeLog](/releases/changelog/)
* Getting Sudo
  + [Source Repo](/getting/repo/)
  + [Source Distribution](/getting/source/)
  + [Prebuilt Packages](/getting/packages/)
  + [Download Mirrors](/getting/download_mirrors/)
  + [Mirroring Sudo](/getting/mirror/)
* Documentation
  + Manual Pages (latest)

    - [Cvtsudoers Manual](/docs/man/cvtsudoers.man/)
    - [Sudo Configuration Manual](/docs/man/sudo.conf.man/)
    - [Sudo Log Client Manual](/docs/man/sudo_sendlog.man/)
    - [Sudo Log Server Configuration Manual](/docs/man/sudo_logsrvd.conf.man/)
    - [Sudo Log Server Manual](/docs/man/sudo_logsrvd.man/)
    - [Sudo Log Server Protocol Manual](/docs/man/sudo_logsrv.proto.man/)
    - [Sudo Manual](/docs/man/sudo.man/)
    - [Sudo Plugin API](/docs/man/sudo_plugin.man/)
    - [Sudo Python Plugin API](/docs/man/sudo_plugin_python.man/)
    - [Sudoers LDAP Manual](/docs/man/sudoers.ldap.man/)
    - [Sudoers Manual](/docs/man/sudoers.man/)
    - [Sudoers Time Stamp Manual](/docs/man/sudoers_timestamp.man/)
    - [Sudoreplay Manual](/docs/man/sudoreplay.man/)
    - [Visudo Manual](/docs/man/visudo.man/)
  + [Manual Pages (all versions)](/docs/man_all/)
  + README Files

    - [README](/docs/readme/readme/)
    - [README.LDAP](/docs/readme/readme_ldap/)
  + [Sudo Installation Notes](/docs/install/)
  + [Sudo Upgrade Notes](/docs/upgrade/)
  + [Contributing to Sudo](/docs/contributing/)
  + [Troubleshooting FAQ](/docs/troubleshooting/)
  + [Building Sudo Packages](/docs/packaging/)
  + [Other Documentation](/docs/other/)
  + [Sudo Alternatives](/docs/alternatives/)
* Security
  + [Security Advisories](/security/advisories/)
  + [Security Policy](/security/policy/)
  + [Static Analysis](/security/static_analysis/)
  + [Fuzzing Sudo](/security/fuzzing/)
  + [Sanitizers and Sudo](/security/sanitizers/)

* [Blog](/posts)
* [Bug Tracker](https://bugzilla.sudo.ws)
* [News](/news)
* [Mailing Lists](/lists)
* [GitHub Repo](https://github.com/sudo-project/sudo)
* [Mercurial Repo](https://www.sudo.ws/repos/sudo)
* [Mastodon](https://fosstodon.org/%40sudoproject)
* [Sudo Mastery Book](https://mwl.io/nonfiction/tools#sudo2)

# Sudo format string vulnerability

Jan 30, 2012

A flaw exists in the debugging code in sudo versions 1.8.0 through
1.8.3p1 that can be used to crash sudo or potentially allow an
unauthorized user to elevate privileges.

## Sudo versions affected:

1.8.0 through 1.8.3p1 inclusive. Older versions of sudo are not
affected.

## CVE ID:

This vulnerability has been assigned
[CVE-2012-0809](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0809)
in the [Common Vulnerabilities and Exposures](https://cve.mitre.org/) database.

## Details:

Sudo 1.8.0 introduced simple debugging support that was primarily
intended for use when developing policy or I/O logging plugins.
The sudo\_debug() function contains a flaw where the program name
is used as part of the format string passed to the fprintf() function.
The program name can be controlled by the caller, either via a
symbolic link or, on some systems, by setting argv[0] when executing
sudo. For example:

```
$ ln -s /usr/bin/sudo ./%s
$ ./%s -D9
Segmentation fault

```

Using standard format string vulnerability exploitation techniques
it is possible to leverage this bug to achieve root privileges.

## Impact:

Successful exploitation of the bug will allow a user to run arbitrary
commands as root.

Exploitation of the bug does **not** require that the
attacker be listed in the sudoers file. As such, we strongly suggest
that affected sites upgrade from affected sudo versions as soon as
possible.

## Workaround:

There is no workaround other than removing the setuid bit from the
sudo binary (and rendering it unusable).

It was initially believed that building sudo with `FORTIFY_SOURCE`
in conjunction with ASLR (address space layout randomization) and
a non-executable stack would deter an attacker. However, an
[integer overflow](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0864)
in GNU libc’s `FORTIFY_SOURCE` support code can be used to bypass
`FORTIFY_SOURCE` protection.

## Fix:

The bug is fixed in sudo 1.8.3p2. Sudo version 1.8.3p1 may be
updated to version 1.8.3p2 via the file sudo-1.8.3p2.patch.gz. For
sudo versions 1.8.0-1.8.3, the patch to sudo.c in sudo-1.8.3p2.patch.gz
will also apply.

## Credit:

Thanks to joernchen of Phenoelit for finding and reporting the bug.

[Flaw in Runas Group password checking](/security/advisories/runas_group_pw/)
[IP addresses in sudoers with netmask may match additional hosts](/security/advisories/netmask/)



=== Content from security.gentoo.org_9a2ee3ef_20250124_134209.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# sudo: Privilege escalation — GLSA **201203-06**

Two vulnerabilities have been discovered in sudo, allowing local
attackers to possibly gain escalated privileges.

### Affected packages

| Package | **app-admin/sudo** on all architectures |
| --- | --- |
| Affected versions | < **1.8.3\_p2** |
| Unaffected versions | >= **1.8.3\_p2**revision >= **1.7.4\_p5** |

### Background

sudo allows a system administrator to give users the ability to run
commands as other users.

### Description

Two vulnerabilities have been discovered in sudo:

* When the sudoers file is configured with a Runas group, sudo does not
  prompt for a password when changing to the new group (CVE-2011-0010).
* A format string vulnerability exists in the "sudo\_debug()" function
  (CVE-2012-0809).

### Impact

A local attacker could possibly gain the ability to run arbitrary
commands with the privileges of other users or groups, including root.

### Workaround

There is no known workaround at this time.

### Resolution

All sudo users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/sudo-1.8.3_p2"

```
### References

* [CVE-2011-0010](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2011-0010)
* [CVE-2012-0809](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-0809)

**Release date**

March 06, 2012

**Latest revision**

March 06, 2012: 1

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [351490](https://bugs.gentoo.org/show_bug.cgi?id=351490)
* [401533](https://bugs.gentoo.org/show_bug.cgi?id=401533)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


