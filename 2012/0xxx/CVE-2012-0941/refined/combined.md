=== Content from www.vulnerability-lab.com_2b16c45c_20250125_095407.html ===
Document Title:
===============
Fortigate UTM WAF Appliance - Multiple Vulnerabilities
References (Source):
====================
http://vulnerability-lab.com/get\_content.php?id=144
http://www.cnnvd.org.cn/vulnerability/show/cv\_id/2012010446
ID: CNNVD-201201-446
http://www.fortiguard.com/advisory/FGA-2012-02.html
http://securitytracker.com/id/1026594
http://www.securityfocus.com/bid/51708/info
http://www.redoracle.eu/index.php?option=com\_vuln&task=view&id=51708
http://www.sans.org/newsletters/risk/display.php?v=11&i=5&rss=Y#12.5.24
http://packetstormsecurity.org/files/109168/VL-144.txt
https://xforce.iss.net/xforce/xfdb/72761
Release Date:
=============
2012-01-26
Vulnerability Laboratory ID (VL-ID):
====================================
144
Common Vulnerability Scoring System:
====================================
6.1
Vulnerability Class:
====================
Multiple
Current Estimated Price:
========================
3.000€ - 4.000€
Product & Service Introduction:
===============================
The FortiGate series of multi-threat security systems detect and eliminate the most damaging, content-based threats from email
and Web traffic such as viruses, worms, intrusions, inappropriate Web content and more in real time - without degrading
network performance.
Ranging from the FortiGate-30 series for small offices to the FortiGate-5000 series for large enterprises, service providers and
carriers, the FortiGate line combines the FortiOS™ security operating system with FortiASIC processors and other hardware to provide
a comprehensive and high-performance array of security and networking functions including:
\* Firewall, VPN, and Traffic Shaping
\* Intrusion Prevention System (IPS)
\* Antivirus/Antispyware/Antimalware
\* Web Filtering
\* Antispam
\* Application Control (e.g., IM and P2P)
\* VoIP Support (H.323. and SCCP)
\* Layer 2/3 routing
\* Multiple WAN interface options
FortiGate appliances provide cost-effective, comprehensive protection against network, content, and application-level threats - including
complex attacks favored by cybercriminals - without degrading network availability and uptime. FortiGate platforms incorporate sophisticated
networking features, such as high availability (active/active, active/passive) for maximum network uptime, and virtual domain (VDOM)
capabilities to separate various networks requiring different security policies.
(Copy from the Vendor Homepage: http://www.fortinet.com/products/fortigate/ && http://www.avfirewalls.com/)
Abstract Advisory Information:
==============================
1.1
Vulnerability-Lab Team discovered multiple persistent Web Vulnerabilities on the FortiGate UTM Appliance Application.
1.2
Vulnerability-Lab Team discovered multiple non-persistent Web Vulnerabilities on the FortiGate UTM Appliance Application.
Vulnerability Disclosure Timeline:
==================================
2012-01-27: Public or Non-Public Disclosure
Discovery Status:
=================
Published
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Medium
Authentication Type:
====================
Restricted Authentication (Guest Privileges)
User Interaction:
=================
Low User Interaction
Disclosure Type:
================
Independent Security Research
Technical Details & Description:
================================
1.1
Multiple input validation vulnerabilities(persistent) are detected on FortGate UTM Appliance Series. Remote attacker can include (persistent)
malicious script code to manipulate specific customer/admin requests. The vulnerability allows an local low privileged attacker to manipulate
the appliance(application) via persistent script code inject.
It is also possible to hijack customer sessions via persistent script code execution on application-side. Successful exploitation can also
result in content/module request manipulation, execution of persistent malicious script code, session hijacking, account steal & phishing.
Vulnerable Module(s): (Persistent)
[+] Endpoint - Monitor - Endpoint Monitor
[+] Dailup List
[+] Log&Report - Display
Picture(s):
../ive2.png
../ive3.png
1.2
Multiple input validation vulnerabilities(non-persistent) are detected on FortGate UTM Appliance Series. The vulnerability allows remote
attackers to hijack admin/customer sessions with required user inter action (client-side). Successful exploitation allows to phish user accounts,
redirect over client side requests or manipulate website context on client-side browser requests.
Vulnerable Module(s): (Non-Persistent)
[+] Endpoint - NAC - Application Database - Listings
[+] List field sorted
Picture(s):
../ive1.png
Interface - UTM WAF Web Application [Appliance]
FortiGate-5000 Series;FortiGate-3950 Series;FortiGate-3810A;FortiGate-3600A;FortiGate-3016B;FortiGate-1240B
FortiGate-800;FortiGate-620B;FortiGate-311B;FortiGate-310B;FortiGate-300A;FortiGate-224B;FortiGate-200B Series
Proof of Concept (PoC):
=======================
The vulnerabilities can be exploited by remote attackers with or without user inter action. For demonstration or reproduce ...
1.1
Code Review: Log&Report =>Display (Persistent)
Url: https://fortigate.com/log/display?log=clog&content\_type=FTP ...

| # | Date | Time | Level | Sub Type | ID | Source | Destination | "<>"" >"<>2"');" onmouseout="nd();" onclick="wij\_display\_modal\_dlg ('/log/display?log=clog&frame=filter&field\_name=cstatus&content\_type=FTP&device=2', { 'width': 610, 'height': 430 });"> Content Status | FTP Command | File |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Code Review: Dailup List (Persistent)
Url: https://www.fortigate.com/vpn/tunnel/dialup?type=| /     [ Column Settings ] [ Clear All Filters ] |
| | Name | Remote Gateway | Remote Port | >');" onmouseout="nd();" onclick="wij\_display\_modal\_dlg(setQueryValues ('/vpn/tunnel/dialup?type=1&start=1&view\_type=0&ipv6=0', ['filterdlg', 'field\_name'], ['1', 'username']), { 'width': 610 });"> Username | Timeout | Proxy ID Source | Proxy ID Destination | Status | | --- | --- | --- | --- | --- | --- | --- | --- | Code Review: Monitor =>Endpoint Monitor (Persistent) Url: /endpointcompliance/monitor/eplist?| Compliant | ');" onmouseout="nd();" onclick="wij\_display\_modal\_dlg(setQueryValues('/endpointcompliance/monitor/eplist?fields\_sorted\_opt=host\_name&status\_filter=2& amp;view\_type=0&ipv6=0', ['filterdlg', 'field\_name'], ['1', 'host\_name']), { 'width': 610 });"> Host Name | IP Address | User | OS Version | FortiClient Version | AV Signature | Detected Applications | Traffic Volume/Attempts | 1.2 Type: Non-Persistent Module: List field sorted Url: https://www.fortigate.com/user/auth/list?fields\_sorted\_opt= Type: Non-Persistent Module: Endpoint -> NAC -> Application Database -> Listings Url: https://www.fortigate.com/endpointcompliance/app\_detect/predefined\_sig\_list?fields\_sorted\_opt= Code-Review: fields\_sorted\_opt   Reference(s): ../dialup.htm ../display.htm ../eplist.htm ../predefined\_sig\_list.htm Solution - Fix & Patch: ======================= 1.1 To fix/patch the persistent input validation vulnerabilities restrict the input fields & parse the input. Locate the vulnerable area(s) reproduce the bugs & parse the output after a malicious(test) insert. Setup a filter or restriction mask to prevent against future persistent input validation attacks. 1.2 To fix the client side input validation vulnerability parse the vulnerable request by filtering the input & cleanup the output. Set a input restriction or configure whitelist/filter to stop client side requests and form a secure exception-handling around. Solution by FortiGate: Fortinet is working towards an updated firmware release to address the issues. This advisory will be updated once a fix schedule is in place. The following precautions are recommended: Ensure all GUI sessions use encryption (via HTTPS); Configure the FortiGate to only allow GUI admin access from trusted hosts or networks; If administrative access to FortiGates is required from untrusted hosts, SSH access is recommended as SSH is not affected; Refrain from administering FortiGate appliances from untrusted or shared computers. Reference: http://www.fortiguard.com/advisory/FGA-2012-02.html Security Risk: ============== 1.1 The security risk of the persistent vulnerabilities are estimated as high because of multiple persistent input validation vulnerabilities on different modules. 1.2 The security risk of the non-persistent cross site requests are estimated as low because of required user inter-action to hijack a not expired session. Credits & Authors: ================== Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve) Disclaimer & Information: ========================= The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability- Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material. Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.vulnerability-lab.com/register Contact: admin@vulnerability-lab.com - support@vulnerability-lab.com - research@vulnerability-lab.com Section: video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com Social: twitter.com/#!/vuln\_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss\_upcoming.php - vulnerability-lab.com/rss/rss\_news.php Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission. Copyright © 2012 | Vulnerability Laboratory | |

