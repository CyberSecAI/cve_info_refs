```
{
  "cve": "CVE-2012-0960",
  "description": "It was discovered that unity-firefox-extension incorrectly handled certain callbacks. A remote attacker could use this issue to cause unity-firefox-extension to crash, resulting in a denial of service, or possibly execute arbitrary code.",
  "vulnerability": {
    "root_cause": "The vulnerability is due to the incorrect handling of callbacks within the unity-firefox-extension. The extension incorrectly associates the UnityObject with the outer window of a browser tab instead of the inner window, which is reused during page navigations. This leads to a situation where the `pagehide` event handler gets disconnected prematurely, causing issues when the tab is closed or when a page is restored from the bfcache. The Unity API also destroys the context instead of freezing the state, requiring reinitialization when a page is recovered from bfcache.",
    "weaknesses": [
      "Incorrect handling of JavaScript callbacks",
      "Improper association of UnityObjects with browser windows",
      "Premature disconnection of `pagehide` event handlers",
       "Unity API context destruction rather than state freezing"
    ],
    "impact": "A remote attacker could exploit this vulnerability to cause the `unity-firefox-extension` to crash, leading to a denial-of-service. It may also allow arbitrary code execution.",
    "attack_vectors": [
      "Navigating to a malicious web page that uses the Unity API in a Firefox browser with the vulnerable extension",
      "Navigating away from a page using the Unity API and then closing the tab",
      "Navigating back to a page using the Unity API recovered from the bfcache and then closing the tab"
    ],
    "attacker_capabilities": "The attacker would need to host a malicious webpage that exploits the vulnerable `unity-firefox-extension`. No specific position is required other than being able to get the user to navigate to the malicious web page."
  },
  "patch": "The vulnerability is resolved by improving the logic in `unity-firefox-extension/content/unity-global-property-initializer.js`. The fix includes:",
  "patch_details": [
      "Keying UnityObject in a weak map with an object tied to the inner window to ensure a new object is created for each page",
      "Preventing disconnection from the `pagehide` event unless the window is being destroyed (using the `dom-window-destroyed` notification)."
    ],
    "affected_packages": [
    "unity-firefox-extension"
  ],
    "affected_versions": [
       "2.4.1-0ubuntu1",
         "2.4.1-0ubuntu1.1",
         "2.4.1-0ubuntu3",
         "2.4.2-0ubuntu1",
        "2.4.4-0ubuntu0.1"
     ],
   "fixed_versions": [
      "2.4.1-0ubuntu1.1",
      "2.4.1-0ubuntu3",
     "2.4.2-0ubuntu1",
     "2.4.4-0ubuntu0.1"
  ]
}
```