```
{
  "cve": "CVE-2012-0870",
  "description": "A flaw was found in the way Samba handled Any Batched (AndX) request packets. A malicious request could cause smbd to enter an infinite recursion and overflow heap-based buffer during recursive calls. This can be triggered by an unauthenticated attacker, resulting in smbd child process crash or possibly code execution.",
  "affected_versions": [
    "Samba versions prior to 3.4.0",
    "Red Hat Enterprise Linux 4 and 5",
    "SUSE Linux Enterprise Server 10 SP3 LTSS, 10 SP4",
    "SUSE CORE 9",
    "Ubuntu 8.04"
 ],
  "vulnerability_details": {
    "root_cause": "Incorrect handling of Any Batched (AndX) request packets in Samba.",
    "weaknesses": [
      "Infinite recursion due to a flaw in processing of AndX request packets.",
      "Heap-based buffer overflow during recursive calls.",
      "Insufficient validation of AndX offsets"
    ],
    "impact": "An unauthenticated remote attacker can cause a denial of service (smbd child process crash) or potentially execute arbitrary code.",
    "attack_vector": "Sending a specially crafted SMB AndX request packet to the server.",
    "attacker_capabilities": "An unauthenticated remote attacker can exploit this vulnerability.",
    "notes": "The issue affects Samba versions prior to 3.4.0. Versions of samba and samba4x packages shipped with Red Hat Enterprise Linux 6, and samba package shipped with Fedora 15 and 16, were not affected"
  }
}
```