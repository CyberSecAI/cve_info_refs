```
{
  "vulnerability_details": {
    "root_cause": "The `mImageBufferSize` in the PNG encoder was initialized with a value different than the size of the source image, leading to padding with uninitialized memory.",
    "weaknesses": [
      "Uninitialized memory usage",
      "Information disclosure"
    ],
    "impact": "Sensitive data from uninitialized memory could be appended to PNG images when converting from ICO format, potentially disclosing this data.",
    "attack_vectors": [
      "Web content using canvas toDataURL to produce ICO files",
      "Browsing websites, which causes icons to be written to disk"
    ],
     "required_capabilities": "An attacker needs to be able to display an HTML page and have the browser encode an ICO file.",
     "additional_details": "The vulnerability was present when encoding images as `image/vnd.microsoft.icon`. The output data had a fixed size, with uninitialized memory as padding beyond the actual image data. The vulnerability was introduced in Firefox 9 with the addition of the ability to encode icons for Win7 jump lists.  The fix uses the actual image size `mImageBufferUsed` instead of the pre-allocated buffer size `mImageBufferSize`."
  }
}
```