=== Content from openwall.com_43797210_20250125_144315.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51702048.3010106@redhat.com>
Date: Thu, 18 Apr 2013 10:33:12 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>, neoice@...ice.net,
        Alexander Wirt <formorer@...ian.org>
Subject: Re: CVE-2012-XXYY Request -- google-authenticator:
 Information disclosure due insecure requirement on the secrets file

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 04/18/2013 04:45 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, Alexander, vendors,
>
> as noted in [1]:
>
> An information disclosure file was found in the way
> google-authenticator, a pluggable authentication module (PAM) which
> allows login using one-time passcodes conforming to the open
> standards developed by the Initiative for Open Authentication
> (OATH), performed management of its secret / state file in certain
> configurations. Due the lack of 'user=' option the secret file was
> previously required to be user-readable, allowing (in certain
> cases) a local attacker to obtain the (pre)shared
> client-to-authentication-server secret, possibly leading to
> victim's account impersonation.
>
> A different vulnerability than CVE-2013-0258.
>
> References: [1]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129> [2]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129#10> [3]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129#20> [4]
> <https://bugzilla.redhat.com/show_bug.cgi?id=953505>
>
> Relevant upstream patch: [5]
> <https://code.google.com/p/google-authenticator/source/detail?r=c3414e9857ad64e52283f3266065ef3023fc69a8>
>
>  @Alexander - since I am not sure I have described the attack
> vector above properly, please correct me if / where required.
>
> @Kurt * the CVE-2012- identifier should be allocated to this issue,
> since the security implications of this problem are for the first
> time mentioned here:
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129#10>
> (2012-09-22),
>
> * from what I have looked, there doesn't seem to be:
> <http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=authenticator>
>
> a CVE identifier allocated to this issue yet (as noted above
> CVE-2013-0258 from that list is different issue).
>
> => could you allocate one?

Please use CVE-2012-6140 for this new issue.

>
> Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRcCBIAAoJEBYNRVNeJnmTS94QANxJrniYl6j2ZzpUVLi3WQ9M
XiYGNctPbJu8duZUqYQVp0Wzj93BnlvDsJ2Ea+lf1fIdwps+qitTDxLcaDAz06qN
bJi3795Mf5JBb81fNzSa8T3igwCO4hpgZvneajsFswbPzUrnSjbTjOn44YHP34L+
pM6OFVsL0I+0ymXbu7oqaMRjfnhBDM1LSYZXKPO7a/Swzl8VRiiqCXKM0xIscFdP
zcRBYQiFn1P5e8zWMkgGVxt+dVB3I5Ly+QkkiNeJRhP5HeBRwod65hTIBZqgLVDm
9qKukd4M2RCHocLSZKLEHqtaEat3ytgpSKKkfRthd+sxiMQRjZZI2o0SNqlnkx5o
I0or7V41GYF9y98pz5zFDc9TMaMfp4OM4gl8KrSu3jw/qNKVfZkiEuC3ybJb10eA
dCOnTetwu8UosUrlRHsC93+urFRmFfkqWXcVvtzTkmcr+MvddBld9IO9d3UKSLW7
NPK2Rzlg7O6QK6fH1g3GzxTLDoXRTelZPosb5t0L4PVoEE0ZjSDCUdLc8/OLDLQv
r61/63HVUJQfuYxuSubSQ14TKlmgbftdZC1p3uerKPojATW7F/tGCoUeMgZAt8bH
UPbF7OxFxxplsNjNaCHM7ZzAsNQHa84m8DWkJMwjKbGvMzZhfwQqXUyN/5TDmxpM
joCyN77TKUyx/A8Th80n
=Z0KR
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_ebd3f0c6_20250125_144316.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D953505)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D953505)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D953505)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 953505

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 953505**](show_bug.cgi?id=953505)
(CVE-2012-6140)
- [CVE-2012-6140](https://access.redhat.com/security/cve/CVE-2012-6140) google-authenticator: Information disclosure due insecure requirement on the secrets file

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-6140 google-authenticator: Information disclosure due insecure requi...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-6140 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [953507](show_bug.cgi?id=953507 "CLOSED WONTFIX - google-authenticator: Information disclosure due insecure requirement on the secrets file [fedora-all]") [953508](show_bug.cgi?id=953508 "CLOSED EOL - google-authenticator: Information disclosure due insecure requirement on the secrets file [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=953505&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=953505&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-04-18 10:34 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:03 UTC ([History](show_activity.cgi?id=953505)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  dwmw2 fsimonce | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-10 11:00:27 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**0005-Add-support-for-a-user-option-that-allows-for-a-maki.patch**](attachment.cgi?id=737353 "View the content of the attachment") (11.95 KB, patch)  [2013-04-18 16:24 UTC](#attach_737353 "Go to the comment associated with the attachment"), Federico Simoncelli | *no flags* | [Details](attachment.cgi?id=737353&action=edit) | [Diff](attachment.cgi?id=737353&action=diff) | | [View All](attachment.cgi?bugid=953505&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=953505#c0)  Jan Lieskovsky    2013-04-18 10:34:42 UTC  ``` An information disclosure file was found in the way google-authenticator, a pluggable authentication module (PAM) which allows login using one-time passcodes conforming to the open standards developed by the Initiative for Open Authentication (OATH), performed management of its secret / state file in certain configurations. Due the lack of 'user=' option the secret file was previously required to be user-readable, allowing (in certain cases) a local attacker to obtain the (pre)shared client-to-authentication-server secret, possibly leading to victim's account impersonation.  A different vulnerability than [CVE-2013-0258](https://access.redhat.com/security/cve/CVE-2013-0258).  References: [1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129> [2] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129#10> [3] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129#20>  Relevant upstream patch: [4] <https://code.google.com/p/google-authenticator/source/detail?r=c3414e9857ad64e52283f3266065ef3023fc69a8>   ```  [Comment 1](show_bug.cgi?id=953505#c1)  Jan Lieskovsky    2013-04-18 10:36:34 UTC  ``` This issue affects the versions of the google-authenticator package, as shipped with Fedora release of 17 and 18. Please schedule an update.  --  This issue affects the version of the google-authenticator package, as shipped with Fedora EPEL 6. Please schedule an update.   ```  [Comment 2](show_bug.cgi?id=953505#c2)  Jan Lieskovsky    2013-04-18 10:47:09 UTC  ``` Created google-authenticator tracking bugs for this issue  Affects: fedora-all [[bug 953507](show_bug.cgi?id=953507 "CLOSED WONTFIX - google-authenticator: Information disclosure due insecure requirement on the secrets file [fedora-all]")] Affects: epel-6 [[bug 953508](show_bug.cgi?id=953508 "CLOSED EOL - google-authenticator: Information disclosure due insecure requirement on the secrets file [epel-6]")]   ```  [Comment 3](show_bug.cgi?id=953505#c3)  Jan Lieskovsky    2013-04-18 10:48:35 UTC  ``` CVE (-2012) Request:   <http://www.openwall.com/lists/oss-security/2013/04/18/4>   ```  [Comment 4](show_bug.cgi?id=953505#c4)  Federico Simoncelli    2013-04-18 16:17:50 UTC  ``` Rawhide, Fedora 18 and Fedora 19 are not affected since they ship git a096a62.  The backport of the suggested patch (c3414e9) to the old hgd525a9bab875 (for f17/epel6) is not trivial.  To make it simpler I decided to backport also:  2d125fc Add support for HOTP to libpam. 26f5977 strtoul() does not return an error  Which apply cleanly.  The patch required for the CVE:  c3414e9 Add support for a "user=" option  Doesn't apply cleanly because of two custom downstream patches (added before I started contributing to this package). I never knew exactly how they were used or where they came from (or why they were in the fedora package if they weren't committed upstream).  Now, we can either remove the two custom patches (f17/el6, since in rawhide, f19, f18 they've been removed already) or we can try to deal with the conflicts (2). I'll attach a proposed patch and comment on the conflicts ASAP.   ```  [Comment 5](show_bug.cgi?id=953505#c5)  Federico Simoncelli    2013-04-18 16:24:23 UTC  ``` Created [attachment 737353](attachment.cgi?id=737353&action=diff "0005-Add-support-for-a-user-option-that-allows-for-a-maki.patch") [[details]](attachment.cgi?id=737353&action=edit "0005-Add-support-for-a-user-option-that-allows-for-a-maki.patch") 0005-Add-support-for-a-user-option-that-allows-for-a-maki.patch  The conflicting parts are:  ++<<<<<<< HEAD  +  int        no_drop_privs; ++======= +   int        fixed_uid; +   uid_t      uid; ++>>>>>>> c3414e9... Add support for a "user=" option that allows for a) making the state file  Which has been resolved to:   +  int        no_drop_privs; +   int        fixed_uid; +   uid_t      uid;  And:  ++<<<<<<< HEAD  +      (params.no_drop_privs ||  +       (old_uid = drop_privileges(pamh, username, uid))) >= 0 &&  +      (fd = open_secret_file(pamh, secret_filename, params.no_drop_privs?"root":username,  +                           params.no_drop_privs?0:uid, &filesize, &mtime)) >= 0 && ++======= +       !drop_privileges(pamh, username, uid, &old_uid, &old_gid) && +       (fd = open_secret_file(pamh, secret_filename, &params, username, uid, +                              &filesize, &mtime)) >= 0 && ++>>>>>>> c3414e9... Add support for a "user=" option that allows for a) making the state file  Which has been resolved to:   -      !drop_privileges(pamh, username, uid, &old_uid, &old_gid) &&  -      (fd = open_secret_file(pamh, secret_filename, &params, username, uid,  -                             &filesize, &mtime)) >= 0 &&  +      (params.no_drop_privs || -        (old_uid = drop_privileges(pamh, username, uid))) >= 0 && -       (fd = open_secret_file(pamh, secret_filename, params.no_drop_privs?"root":username, ++       !drop_privileges(pamh, username, uid, &old_uid, &old_gid)) && ++      (fd = open_secret_file(pamh, secret_filename, &params, params.no_drop_privs?"root":username,  +                           params.no_drop_privs?0:uid, &filesize, &mtime)) >= 0 &&   ```  [Comment 6](show_bug.cgi?id=953505#c6)  Vincent Danen    2013-04-18 20:34:53 UTC  ``` This was assigned CVE-2012-6140:  <http://www.openwall.com/lists/oss-security/2013/04/18/10>   ```  [Comment 7](show_bug.cgi?id=953505#c7)  Jan Lieskovsky    2013-04-19 07:38:31 UTC  ``` Hello Federico,    thank you for checking with me.  (In reply to [comment #4](show_bug.cgi?id=953505#c4)) > Rawhide, Fedora 18 and Fedora 19 are not affected since they ship git > a096a62.  I don't have Fedora 18 system around to check if the google-authenticator-1.0-0.gita096a62.fc18 is in the -stable repository already (or just in -testing). So it's possible the issue is fixed in Fedora 18 already (couldn't verify).  >  > The backport of the suggested patch (c3414e9) to the old hgd525a9bab875 (for > f17/epel6) is not trivial. >  > To make it simpler I decided to backport also: >  > 2d125fc Add support for HOTP to libpam. > 26f5977 strtoul() does not return an error >  > Which apply cleanly. >  > The patch required for the CVE: >  > c3414e9 Add support for a "user=" option >  > Doesn't apply cleanly because of two custom downstream patches (added before > I started contributing to this package). I never knew exactly how they were > used or where they came from (or why they were in the fedora package if they > weren't committed upstream). >  > Now, we can either remove the two custom patches (f17/el6, since in rawhide, > f19, f18 they've been removed already) or we can try to deal with the > conflicts (2). I'll attach a proposed patch and comment on the conflicts > ASAP.  What are the rules for rebasing package version in Fedora 17 / Fedora EPEL 6? Would it be possible to rebase them to the upstream version, which is in Fedora 18 already? If so, I would follow this approach (rebase to latest upstream version in those products too). If not, I would just remove the two custom patches (if those are truly useful features, they should be proposed upstream for inclusion into the current code) and apply the upstream one for the security fix.  HTH, Jan.   ```  [Comment 8](show_bug.cgi?id=953505#c8)  Federico Simoncelli    2013-04-19 14:05:01 UTC  ``` (In reply to [comment #7](show_bug.cgi?id=953505#c7)) > Hello Federico, >  >   thank you for checking with me. >  > (In reply to [comment #4](show_bug.cgi?id=953505#c4)) > > Rawhide, Fedora 18 and Fedora 19 are not affected since they ship git > > a096a62. >  > I don't have Fedora 18 system around to check if the > google-authenticator-1.0-0.gita096a62.fc18 is in the -stable repository > already (or just in -testing). So it's possible the issue is fixed in Fedora > 18 already (couldn't verify).  Ah yes it might be in -testing. We can go ahead and release, the point is that it's not really clear to me what the two custom patches are doing and why they are there. As far as I'm concerned we can go ahead and remove them hoping that nobody is using them.  The two patches are:  Add no-drop-privs option to manage secret files as root <http://pkgs.fedoraproject.org/cgit/google-authenticator.git/tree/0001-Add-no-drop-privs-option-to-manage-secret-files-as-r.patch?h=f17>  Allow expansion of PAM environment variables in secret file name <http://pkgs.fedoraproject.org/cgit/google-authenticator.git/tree/0002-Allow-expansion-of-PAM-environment-variables-in-secr.patch?h=f17>  > > Now, we can either remove the two custom patches (f17/el6, since in rawhide, > > f19, f18 they've been removed already) or we can try to deal with the > > conflicts (2). I'll attach a proposed patch and comment on the conflicts > > ASAP. >  > What are the rules for rebasing package version in Fedora 17 / Fedora EPEL > 6? Would it be possible to rebase them to the upstream version, which is in > Fedora 18 already? If so, I would follow this approach (rebase to latest > upstream version in those products too). If not, I would just remove the two > custom patches (if those are truly useful features, they should be proposed > upstream for inclusion into the current code) and apply the upstream one for > the security fix.  If we can get rid of the two custom patches either way it's fine by me (upgrade to latest version or just apply the fix). I'd prefer to upgrade to the latest version though: gita096a62.  I think that this security issue is a quite good reason to finally remove these custom patches. If there's no objection I'll go ahead and do that.   ```  [Comment 10](show_bug.cgi?id=953505#c10)  David Woodhouse    2013-04-19 21:07:49 UTC  ``` The patches allow a saner option for file storage than the original broken one where the user's home directory was used.  One patch allows the secret file name to contain expanded PAM environment variables: <http://code.google.com/p/google-authenticator/issues/detail?id=108>  The other allows it to do the file manipulation as root rather than using files owned by the user. Can't find the upstream bug for that right now...  Please don't kill this functionality; we really want to be able to use secret files as root in /etc/google-authenticator/$USER, not the default stupid scheme.  Yes, it sucks that Google are so bad at merging submitted patches.   ```  [Comment 11](show_bug.cgi?id=953505#c11)  Federico Simoncelli    2013-04-22 10:12:40 UTC  ``` David please provide a feedback on the patch proposed in [comment 5](show_bug.cgi?id=953505#c5) (and the possible conflict resolution). Thanks.   ```  [Comment 12](show_bug.cgi?id=953505#c12)  Product Security DevOps Team    2019-06-10 11:00:27 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=953505&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugs.debian.org_c4054be3_20250125_144313.html ===

# Debian Bug report logs - #666129 new upstream version fixes security problem with the secret file (CVE-2012-6140)

[![version graph](version.cgi?found=google-authenticator%2F20110413.68230188bdc7-1.1;package=libpam-google-authenticator;collapse=1;width=2;absolute=0;fixed=google-authenticator%2F20130529-1;height=2)](version.cgi?found=google-authenticator%2F20110413.68230188bdc7-1.1;package=libpam-google-authenticator;collapse=1;fixed=google-authenticator%2F20130529-1;absolute=0;info=1)

Package:
[libpam-google-authenticator](pkgreport.cgi?package=libpam-google-authenticator);
Maintainer for [libpam-google-authenticator](pkgreport.cgi?package=libpam-google-authenticator) is [Janos Lenart <ocsi@debian.org>](pkgreport.cgi?maint=ocsi%40debian.org); Source for [libpam-google-authenticator](pkgreport.cgi?package=libpam-google-authenticator) is [src:google-authenticator](pkgreport.cgi?src=google-authenticator) ([PTS](https://tracker.debian.org/pkg/google-authenticator), [buildd](https://buildd.debian.org/google-authenticator), [popcon](https://qa.debian.org/popcon.php?package=google-authenticator)).

Reported by: [Faidon Liambotis <paravoid@debian.org>](pkgreport.cgi?submitter=paravoid%40debian.org)

Date: Wed, 28 Mar 2012 22:24:01 UTC

Severity: *critical*

Tags: security

Found in version google-authenticator/20110413.68230188bdc7-1.1

Fixed in version google-authenticator/20130529-1

**Done:** Salvatore Bonaccorso <carnil@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=666129;mbox=yes), [status mbox](bugreport.cgi?bug=666129;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=666129;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Wed, 28 Mar 2012 22:24:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=2), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Faidon Liambotis <paravoid@debian.org>`:

New Bug report received and forwarded. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Wed, 28 Mar 2012 22:24:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=4), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=5), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=paravoid%40debian.org)
From: Faidon Liambotis <paravoid@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: Please update to a newer upstream release
Date: Thu, 29 Mar 2012 00:59:56 +0300
```
Package: libpam-google-authenticator
Version: 20110413.68230188bdc7-1.1
Severity: wishlist

Hi,

I would like to have a newer version of google-authenticator in the
archive; the version currently in Debian is almost a year old and
several new features have been added to upstream's trunk (it's
unfortunate that upstream doesn't believe in "releases"â¦).

In particular, I was interested in having counter-based HOTP instead of
TOTP, since the box I want to use libpam-google-authenticator in doesn't
have an RTC and relying into not having network outages (for NTP) is a
no-go for this. I was happy to see that upstream supports this, only to
be disappointed that this isn't in Debian :-)

If you're busy, I can certainly help with the upload and do an NMU,
although I'm afraid I don't have the time or will to help with the
maintenance in general.

Thanks, and thank you for packaging google-authenticator.

Regards,
Faidon

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Sat, 22 Sep 2012 07:15:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=7), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `rk <neoice@neoice.net>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Sat, 22 Sep 2012 07:15:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=9), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=10), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=neoice%40neoice.net)
From: rk <neoice@neoice.net>
To: 666129@bugs.debian.org
Subject: RE: Please update to a newer upstream release
Date: Sat, 22 Sep 2012 00:12:10 -0700
```
There is also a severe and somewhat undocumented security issue fixed
by the "user=" parameter added in this commit:
<https://code.google.com/p/google-authenticator/source/detail?r=c3414e9857ad64e52283f3266065ef3023fc69a8>

Without this option, the SECRET file is required to be user-readable
which can expose the secret to an attacker under certain
configurations (notably when required for `sudo`, but not system
login).

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Wed, 24 Oct 2012 16:36:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=12), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Phil Armstrong <phil@kantaka.co.uk>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Wed, 24 Oct 2012 16:36:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=14), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=15), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=phil%40kantaka.co.uk)
From: Phil Armstrong <phil@kantaka.co.uk>
To: Debian Bug Tracking System <666129@bugs.debian.org>
Subject: Re: Please update to a newer upstream release
Date: Wed, 24 Oct 2012 16:42:55 +0100
```
Package: libpam-google-authenticator
Version: 20110413.68230188bdc7-1.1
Followup-For: Bug #666129

Upstream released version 1.0 in May by the way:

  <http://code.google.com/p/google-authenticator/downloads/detail?name=libpam-google-authenticator-1.0-source.tar.bz2>

cheers, Phil

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Thu, 18 Apr 2013 07:18:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=17), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Alexander Wirt <formorer@debian.org>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Thu, 18 Apr 2013 07:18:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=19), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=20), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=formorer%40debian.org)
From: Alexander Wirt <formorer@debian.org>
To: rk <neoice@neoice.net>
Cc: 666129@bugs.debian.org
Subject: Re: Bug#666129: Please update to a newer upstream release
Date: Thu, 18 Apr 2013 09:13:24 +0200
```
tag 666129 security
severity 666129 critical
retitle 666129 new upstream version fixes security problem with the secret file
thanks

On Sat, 22 Sep 2012, rk wrote:

> There is also a severe and somewhat undocumented security issue fixed
> by the "user=" parameter added in this commit:
> <https://code.google.com/p/google-authenticator/source/detail?r=c3414e9857ad64e52283f3266065ef3023fc69a8>
>
> Without this option, the SECRET file is required to be user-readable
> which can expose the secret to an attacker under certain
> configurations (notably when required for `sudo`, but not system
> login).
This is indeed a security problem. Lenart, do you need any help to get the
package updated? I also think it doesn't make sense to ship the package in
this state with wheezy and there I asked for removal from testing.

Alex

```

---

**Added tag(s) security.**
Request was from `Alexander Wirt <formorer@debian.org>`
to `control@bugs.debian.org`.
(Thu, 18 Apr 2013 07:18:07 GMT) ([full text](bugreport.cgi?bug=666129;msg=22), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=22), [link](#21)).

---

**Severity set to 'critical' from 'wishlist'**
Request was from `Alexander Wirt <formorer@debian.org>`
to `control@bugs.debian.org`.
(Thu, 18 Apr 2013 07:18:08 GMT) ([full text](bugreport.cgi?bug=666129;msg=24), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=24), [link](#23)).

---

**Changed Bug title to 'new upstream version fixes security problem with the secret file' from 'Please update to a newer upstream release'**
Request was from `Alexander Wirt <formorer@debian.org>`
to `control@bugs.debian.org`.
(Thu, 18 Apr 2013 07:18:09 GMT) ([full text](bugreport.cgi?bug=666129;msg=26), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Thu, 18 Apr 2013 19:33:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=28), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Thu, 18 Apr 2013 19:33:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=30), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=31), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Alexander Wirt <formorer@debian.org>, 666129@bugs.debian.org
Cc: rk <neoice@neoice.net>
Subject: Re: Bug#666129: Please update to a newer upstream release
Date: Thu, 18 Apr 2013 21:28:10 +0200
```
Control: retitle 666129 new upstream version fixes security problem with the secret file ([CVE-2012-6140](https://security-tracker.debian.org/tracker/CVE-2012-6140))

Hi all

On Thu, Apr 18, 2013 at 09:13:24AM +0200, Alexander Wirt wrote:
> tag 666129 security
> severity 666129 critical
> retitle 666129 new upstream version fixes security problem with the secret file
> thanks
>
> On Sat, 22 Sep 2012, rk wrote:
>
> > There is also a severe and somewhat undocumented security issue fixed
> > by the "user=" parameter added in this commit:
> > <https://code.google.com/p/google-authenticator/source/detail?r=c3414e9857ad64e52283f3266065ef3023fc69a8>
> >
> > Without this option, the SECRET file is required to be user-readable
> > which can expose the secret to an attacker under certain
> > configurations (notably when required for `sudo`, but not system
> > login).
> This is indeed a security problem. Lenart, do you need any help to get the
> package updated? I also think it doesn't make sense to ship the package in
> this state with wheezy and there I asked for removal from testing.

A CVE was assigned for this issue: [CVE-2012-6140](https://security-tracker.debian.org/tracker/CVE-2012-6140), see[1].

 [1]: <http://marc.info/?l=oss-security&m=136630281802738&w=2>

Regards,
Salvatore

```

---

**Changed Bug title to 'new upstream version fixes security problem with the secret file (CVE-2012-6140)' from 'new upstream version fixes security problem with the secret file'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `666129-submit@bugs.debian.org`.
(Thu, 18 Apr 2013 19:33:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=33), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=33), [link](#32)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Mon, 27 May 2013 08:39:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=35), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Mr Allwyn Fernandes <dbwerwesklsdf@stobor.net>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Mon, 27 May 2013 08:39:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=37), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=38), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=dbwerwesklsdf%40stobor.net)
From: Mr Allwyn Fernandes <dbwerwesklsdf@stobor.net>
To: LENART Janos <ocsi@debian.org>,
666129@bugs.debian.org
Subject: NMU to latest git?
Date: Mon, 27 May 2013 18:29:01 +1000
```
Hi Lenart,

Just wondering if you are planning to update google-authenticator to a newer
version, as per bugs #666129 and #660188, or if you mind if I do an NMU? I had
built a deb from git HEAD a few months ago, and have the relevant files handy
to submit if you don't have the time to look at it.

Cheers,

Allwyn.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, LENART Janos <ocsi@debian.org>`:

`Bug#666129`; Package `libpam-google-authenticator`.
(Wed, 29 May 2013 21:06:09 GMT) ([full text](bugreport.cgi?bug=666129;msg=40), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=40), [link](#39)).

---

**Acknowledgement sent**
to `Janos LENART <ocsi@debian.org>`:

Extra info received and forwarded to list. Copy sent to `LENART Janos <ocsi@debian.org>`.
(Wed, 29 May 2013 21:06:09 GMT) ([full text](bugreport.cgi?bug=666129;msg=42), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 666129@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=43), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=ocsi%40debian.org)
From: Janos LENART <ocsi@debian.org>
To: Mr Allwyn Fernandes <dbwerwesklsdf@stobor.net>, 666129@bugs.debian.org
Subject: Re: Bug#666129: NMU to latest git?
Date: Wed, 29 May 2013 21:56:43 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=666129;msg=43) (text/plain, inline)]
```
```
In progress, sorry for the delay
google-authenticator_20130529-1_amd64.changes uploaded successfully to
localhost
along with the files:
  google-authenticator_20130529-1.dsc
  google-authenticator_20130529.orig.tar.gz
  google-authenticator_20130529-1.debian.tar.gz
  libpam-google-authenticator_20130529-1_amd64.deb

Greetings,

        Your Debian queue daemon (running on host franck.debian.org)

On 27 May 2013 09:29, Mr Allwyn Fernandes <dbwerwesklsdf@stobor.net> wrote:

> Hi Lenart,
>
> Just wondering if you are planning to update google-authenticator to a
> newer
> version, as per bugs #666129 and #660188, or if you mind if I do an NMU? I
> had
> built a deb from git HEAD a few months ago, and have the relevant files
> handy
> to submit if you don't have the time to look at it.
>
> Cheers,
>
> Allwyn.
>

--
LÉNÁRT, János
<ocsi@debian.org>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=666129;msg=43) (text/html, inline)]
```

---

**Marked as fixed in versions google-authenticator/20130529-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 30 May 2013 05:27:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=45), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=45), [link](#44)).

---

**Marked Bug as done**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 30 May 2013 05:27:04 GMT) ([full text](bugreport.cgi?bug=666129;msg=47), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=47), [link](#46)).

---

**Notification sent**
to `Faidon Liambotis <paravoid@debian.org>`:

Bug acknowledged by developer.
(Thu, 30 May 2013 05:27:05 GMT) ([full text](bugreport.cgi?bug=666129;msg=49), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=49), [link](#48)).

---

**Message sent on**
to `Faidon Liambotis <paravoid@debian.org>`:

Bug#666129.
(Thu, 30 May 2013 05:27:08 GMT) ([full text](bugreport.cgi?bug=666129;msg=51), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=51), [link](#50)).

---

[Message #52](#52) received at 666129-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=666129;msg=52), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=52), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: control@bugs.debian.org
Cc: 666129-submitter@bugs.debian.org
Subject: closing 666129
Date: Thu, 30 May 2013 07:23:03 +0200
```
close 666129 20130529-1
thanks

New version in unstable (20130529-1)

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 07 Jul 2013 07:30:35 GMT) ([full text](bugreport.cgi?bug=666129;msg=54), [mbox](bugreport.cgi?bug=666129;mbox=yes;msg=54), [link](#53)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=666129).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 14:43:13 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from access.redhat.com_3af0664d_20250126_093601.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security-tracker.debian.org_08352da4_20250126_093613.html ===

# CVE-2012-6140

| **Name** | CVE-2012-6140 |
| --- | --- |
| **Description** | pam\_google\_authenticator.c in the PAM module in Google Authenticator before 1.0 requires user-readable permissions for the secret file, which allows local users to bypass intended access restrictions and discover a shared secret via standard filesystem operations, a different vulnerability than CVE-2013-0258. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-6140) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-6140); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-6140), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-6140), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-6140), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-6140), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-6140), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-6140), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-6140), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-6140)/[CVE](https://www.suse.com/security/cve/CVE-2012-6140/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-6140)/[code](https://github.com/search?type=Code&q=%22CVE-2012-6140%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-6140%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-6140%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [666129](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [google-authenticator](/tracker/source-package/google-authenticator) ([PTS](https://tracker.debian.org/pkg/google-authenticator)) | bookworm, bullseye | 20191231-2 | fixed |
|  | sid, trixie | 20191231-2.1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [google-authenticator](/tracker/source-package/google-authenticator) | source | (unstable) | 20130529-1 |  |  | [666129](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=666129) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from code.google.com_62cb6c0c_20250125_144318.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fgoogle-authenticator)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fgoogle-authenticator)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=google%2Fgoogle-authenticator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Apr 6, 2021. It is now read-only.

[google](/google)
/
**[google-authenticator](/google/google-authenticator)**
Public archive

* [Notifications](/login?return_to=%2Fgoogle%2Fgoogle-authenticator) You must be signed in to change notification settings
* [Fork
  972](/login?return_to=%2Fgoogle%2Fgoogle-authenticator)
* [Star
   5.2k](/login?return_to=%2Fgoogle%2Fgoogle-authenticator)

Open source version of Google Authenticator (except the Android app)

### License

[Apache-2.0 license](/google/google-authenticator/blob/master/LICENSE)

[5.2k
stars](/google/google-authenticator/stargazers) [972
forks](/google/google-authenticator/forks) [Branches](/google/google-authenticator/branches) [Tags](/google/google-authenticator/tags) [Activity](/google/google-authenticator/activity)
 [Star](/login?return_to=%2Fgoogle%2Fgoogle-authenticator)

 [Notifications](/login?return_to=%2Fgoogle%2Fgoogle-authenticator) You must be signed in to change notification settings

* [Code](/google/google-authenticator)
* [Issues
  164](/google/google-authenticator/issues)
* [Pull requests
  1](/google/google-authenticator/pulls)
* [Actions](/google/google-authenticator/actions)
* [Projects
  0](/google/google-authenticator/projects)
* [Wiki](/google/google-authenticator/wiki)
* [Security](/google/google-authenticator/security)
* [Insights](/google/google-authenticator/pulse)

Additional navigation options

* [Code](/google/google-authenticator)
* [Issues](/google/google-authenticator/issues)
* [Pull requests](/google/google-authenticator/pulls)
* [Actions](/google/google-authenticator/actions)
* [Projects](/google/google-authenticator/projects)
* [Wiki](/google/google-authenticator/wiki)
* [Security](/google/google-authenticator/security)
* [Insights](/google/google-authenticator/pulse)

# google/google-authenticator

    master[Branches](/google/google-authenticator/branches)[Tags](/google/google-authenticator/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[217 Commits](/google/google-authenticator/commits/master/) | | |
| [.github/ISSUE\_TEMPLATE](/google/google-authenticator/tree/master/.github/ISSUE_TEMPLATE "This path skips through empty directories") | | [.github/ISSUE\_TEMPLATE](/google/google-authenticator/tree/master/.github/ISSUE_TEMPLATE "This path skips through empty directories") |  |  |
| [mobile](/google/google-authenticator/tree/master/mobile "mobile") | | [mobile](/google/google-authenticator/tree/master/mobile "mobile") |  |  |
| [.gitignore](/google/google-authenticator/blob/master/.gitignore ".gitignore") | | [.gitignore](/google/google-authenticator/blob/master/.gitignore ".gitignore") |  |  |
| [.hgsub](/google/google-authenticator/blob/master/.hgsub ".hgsub") | | [.hgsub](/google/google-authenticator/blob/master/.hgsub ".hgsub") |  |  |
| [.hgsubstate](/google/google-authenticator/blob/master/.hgsubstate ".hgsubstate") | | [.hgsubstate](/google/google-authenticator/blob/master/.hgsubstate ".hgsubstate") |  |  |
| [LICENSE](/google/google-authenticator/blob/master/LICENSE "LICENSE") | | [LICENSE](/google/google-authenticator/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/google/google-authenticator/blob/master/README.md "README.md") | | [README.md](/google/google-authenticator/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* Apache-2.0 license
* Security
# Google Authenticator OpenSource

The Google Authenticator project includes implementations of one-time passcode
generators for several mobile platforms. One-time passcodes are generated using
open standards developed by the
[Initiative for Open Authentication (OATH)](http://www.openauthentication.org/)
(which is unrelated to [OAuth](http://oauth.net/)).

This GitHub project is specifically for the Google Authenticator apps which
target the Blackberry and iOS mobile platforms.

Other related Google Authenticator opensource projects can be found as noted
below:

* [Android app](https://github.com/google/google-authenticator-android).
* [Pluggable Authentication Module](https://github.com/google/google-authenticator-libpam), aka PAM.

There are **no account backups** in any of the apps by design.

These apps are not on the app stores, and their code has diverged from what's in
the app stores, so patches here won't necessarily show up in those versions.

These implementations support the HMAC-Based One-time Password (HOTP) algorithm
specified in [RFC 4226](https://tools.ietf.org/html/rfc4226) and the Time-based
One-time Password (TOTP) algorithm specified
in [RFC 6238](https://tools.ietf.org/html/rfc6238).

Further documentation is available in
the [Wiki](https://github.com/google/google-authenticator/wiki).

## About

Open source version of Google Authenticator (except the Android app)

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/google/google-authenticator/activity)
[Custom properties](/google/google-authenticator/custom-properties)
### Stars

[**5.2k**
stars](/google/google-authenticator/stargazers)
### Watchers

[**362**
watching](/google/google-authenticator/watchers)
### Forks

[**972**
forks](/google/google-authenticator/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fgoogle%2Fgoogle-authenticator&report=google+%28user%29)

## [Releases](/google/google-authenticator/releases)

[1
tags](/google/google-authenticator/tags)

## [Packages 0](/orgs/google/packages?repo_name=google-authenticator)

No packages published

## [Contributors 27](/google/google-authenticator/graphs/contributors)

[+ 13 contributors](/google/google-authenticator/graphs/contributors)

## Languages

* [Java
  43.5%](/google/google-authenticator/search?l=java)
* [Objective-C
  31.1%](/google/google-authenticator/search?l=objective-c)
* [HTML
  25.4%](/google/google-authenticator/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


