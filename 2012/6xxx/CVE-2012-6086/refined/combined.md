=== Content from www.openwall.com_e6582ae4_20250125_155522.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2013/01/02/3) [[next>]](2) [[<thread-prev]](../../../2013/01/02/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50E533B9.901@redhat.com>
Date: Thu, 03 Jan 2013 00:31:05 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Moritz Muehlenhoff <jmm@...ian.org>
Subject: Re: CVE request: Curl insecure usage

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/02/2013 11:02 AM, Moritz Muehlenhoff wrote:
> On Wed, Dec 26, 2012 at 12:38:19PM +0100, Moritz Muehlenhoff wrote:
>> On Thu, Nov 29, 2012 at 10:44:36PM +0100, Moritz Mühlenhoff wrote:
>>>> Also can someone collate and post a list of all the other apps using
>>>> curl insecurely and need CVE's with appropriate links to the
>>>> upstreams/etc? Thanks.
>>>
>>> There are some, which are potentially affected, but where discussion
>>> with upstream is still pending.
>
> Here are two more. These are the last two remaining issues found by
> Alessandro Ghedini:
> Please assign CVE IDs:
>
> 1. Zabbix
> <https://support.zabbix.com/browse/ZBX-5924>

Please use CVE-2012-6086 for this issue.

> 2. Moodle
> This one is two-fold. First of all Moodle embeds PHP-Cas and Moodle is thus
> affected by CVE-2012-5583 as well. (Same code, so same CVE ID).
>
> Additionally there's another issue specific to Moodle, which requires a CVE
> ID:
> <https://github.com/tpyo/amazon-s3-php-class/pull/36>

Please use CVE-2012-6087 for this issue.

>
> Cheers,
>         Moritz
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJQ5TO5AAoJEBYNRVNeJnmTt0oQAINPPhlLqdmfpgOE/qMvUBLe
xCezoVP7zj0T4cpvcmzxjAvcBsfsnYjF0XChfMC+vk5FpK0jmSBdcdyHivhzQP9L
SrR3O1QMZbeo0N9UXgR4q3h9s1Xvccr/4CpZAyraq1d05f/fSRvLQ1oFejFlmOJc
lmoRJl3V6ov5LPr16eiINQRXuq0+eERB8y3zQResJuu68CMzJlBbRsOf59As0gtK
zVfuounDS4ggSLD7GbQiP8Fqu8RAKp47LDyxfKLEI5EwrBpE/e/mtYgx6TFWUk1L
68K5wegMCxjqr1goROY9E/xeStfnrFr8ONKEgJOwNTgg1YiFjWvI3BFXCoVqjQ4e
QIyCMmEhDj+hu81Ct5uraTHDqAynvqfC+nW2KS8LxRgXxMhJM8EWHMKp9Uu1+Adm
k5FZiHRwJ9mc25eryLmn81+8JBe+KLLSAZDs2p54heP/JoW54nj8s32clnpl/6Uw
utOiSnWMJgqByndOOli9Z6jQ3mo1iP1BRdoLNGN4azInq2IavtK2So2xiAoYuyUQ
HQ24xRZB76OQpZoPTnisL/WX9gboOmsbc35DSm5T5uiT7yNb47cooD9o5Hq+U3Vb
GKW5U4LmO4dKMTn/1aXgE6rt/k2Q3YrvuDur77pWTSuYLqIPuY4IEM5NnX8ukavI
JLv+eFxyNQUVIA1kQw+B
=hzGV
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from support.zabbix.com_c1c856eb_20250126_100505.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FZBX-5924)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ZABBIX SUPPORT](/s/-uhzoog/9120004/14o1foa/_/jira-logo-scaled.png)](https://support.zabbix.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FZBX-5924)

![Uploaded image for project: 'ZABBIX BUGS AND ISSUES'](https://support.zabbix.com/secure/projectavatar?pid=10000&avatarId=20377)

1. [ZABBIX BUGS AND ISSUES](/browse/ZBX)
2. [ZBX-5924](/browse/ZBX-5924)

## Possible security issue due to misuse of the libcurl API

[Log In](/login.jsp?os_destination=%2Fbrowse%2FZBX-5924 "Log In")ClosedExportnullXMLWordPrintable
### Details

* **Type:**
  ![Icon: Defect (Security)](/secure/viewavatar?size=xsmall&avatarId=21772&avatarType=issuetype "Defect (Security) - Discovered security vulnerabilities in Zabbix") Defect (Security)
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Minor](/images/icons/priorities/minor.svg "Minor - Minor loss of function, or other problem where easy workaround is present.") Minor
* **Fix Version/s:**
  [1.8.18rc1](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+1.8.18rc1 "1.8.18rc1 "), [2.0.8rc1](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+2.0.8rc1 "2.0.8rc1 "), [2.1.2](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+2.1.2 "2.1.2 ")
* **Affects Version/s:**
  2.0.3
* **Component/s:**
  [Documentation (D)](/issues/?jql=project+%3D+ZBX+AND+component+%3D+%22Documentation+%28D%29%22 "Documentation (D) Zabbix manual, manpages and other documentation"), [Proxy (P)](/issues/?jql=project+%3D+ZBX+AND+component+%3D+%22Proxy+%28P%29%22 "Proxy (P) Zabbix proxy process"), [Server (S)](/issues/?jql=project+%3D+ZBX+AND+component+%3D+%22Server+%28S%29%22 "Server (S) Zabbix server")
* **Labels:**
  + [curl](/issues/?jql=labels+%3D+curl "curl")
  + [security](/issues/?jql=labels+%3D+security "security")
  + [ssl](/issues/?jql=labels+%3D+ssl "ssl")
  + [trivial](/issues/?jql=labels+%3D+trivial "trivial")
* **Environment:**
  Debian
### Description

Alessandro Ghedini on behalf of Debian security team kindly shared his concerns regarding the following:

We recently discovered that zabbix is using the libcurl API in a way that may not be what the original author intended.

In particular I'm referring to the fact that the CURLOPT\_SSL\_VERIFYHOST option is treated as it was a boolean value

while in fact it isn't (it may take three different values):

From the file "src/libs/zbxmedia/eztexting.c":

if (CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_USERAGENT, "Zabbix " ZABBIX\_VERSION)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_FOLLOWLOCATION, 1L)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_WRITEFUNCTION, WRITEFUNCTION2)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_HEADERFUNCTION, HEADERFUNCTION2)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_SSL\_VERIFYPEER, 1L)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_SSL\_VERIFYHOST, 1L)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_POSTFIELDS, postfields)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_POST, 1L)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_URL, EZ\_TEXTING\_API\_URL)) ||

CURLE\_OK != (err = curl\_easy\_setopt(easy\_handle, opt = CURLOPT\_TIMEOUT, (long)EZ\_TEXTING\_TIMEOUT)))

{
zbx\_snprintf(error, max\_error\_len, "Could not set cURL option %d: [%s]", opt, curl\_easy\_strerror(err));
goto clean;
}

Setting the value to "1" does not enable the host checks (well, not all of them)

and this may lead to security issues. The correct value to enable all the security checks is "2".

From the libcurl documentation:

> When CURLOPT\_SSL\_VERIFYHOST is 2, that certificate must indicate

> that the server is the server to which you meant to connect, or the

> connection fails.

>

> Curl considers the server the intended one when the Common Name

> field or a Subject Alternate Name field in the certificate matches

> the host name in the URL to which you told Curl to connect.

>

> When the value is 1, the certificate must contain a Common Name

> field, but it doesn't matter what name it says. (This is not

> ordinarily a useful setting).

>

> When the value is 0, the connection succeeds regardless of the

> names in the certificate.

Note that this should be fixed anyway, since as of curl v7.28.1 the value "1" is not a valid value

anymore and libcurl will return an error.

### Attachments

### Activity

### People

Assignee:

![wiper](https://support.zabbix.com/secure/useravatar?size=small&avatarId=10192)
Andris Zeila

Reporter:

![onlyjob](https://support.zabbix.com/secure/useravatar?size=small&avatarId=10192)
Onlyjob

Votes:
2
Vote for this issue

Watchers:
5
Start watching this issue

### Dates

Created:

2012 Dec 02 07:41

Updated:

2020 Jul 16 14:10

Resolved:

2014 Jan 31 14:22

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for SIA Zabbix. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


