=== Content from co3k.org_0ef92d4f_20250125_151930.html ===

# [co3k.org](/)

* [About](/)
* [Blog](/category/blog.html)
* [Reported Vulnerabilities](/pages/reported-vulnerabilities.html)

## [RedCloth contains unfixed XSS vulnerability for 9 years](/blog/redcloth-unfixed-xss-en "Permalink to RedCloth contains unfixed XSS vulnerability for 9 years")

Translations:
[ja](/blog/redcloth-unfixed-xss)

* 2014-12-11
* [Source](http://github.com/co3k/pelican-co3k.org/blob/master/content/Blog/redcloth-unfixed-xss-en.rst)

## TL;DR

You shouldn't use RedCloth to parse user inputted contents and output the parsed string (except that you allow your user to write arbitrary JavaScript code on your site) because it contains unfixed XSS vulnerability for 9 years, and it be also disclosed for 2 years.

Unfortunately, we may not expect fix the vulnerability by the current developer because he announced that ["unable to keep fixing bugs or work on the next major release"](https://github.com/jgarber/redcloth#redcloth-needs-new-maintainers).

If you want to continue to use RedCloth for such contents, you should patch for the problem yourself, consider contributing to RedCloth, or otherwise.

## What is RedCloth

I recognize RedCloth is a well-known converting Textile library for Ruby.

You can see some information and get the library from <http://redcloth.org/> or <https://rubygems.org/gems/RedCloth>

## The Issue

I reported the PoC to a developer of RedCloth in Feb. 24, 2012: <https://gist.github.com/co3k/75b3cb416c342aa1414c>

For your convenience, I paste (and some modified) a PoC to the following:

```
require 'redcloth'

print RedCloth.new('["clickme":javascript:alert(%27XSS%27)]', [:filter_html, :filter_styles, :filter_classes, :filter_ids]).to_html

# Result:
# <p><a href="javascript:alert(%27XSS%27)">clickme</a></p>

```

You can see the above generated a element has the href attribute value which contains javascript scheme. It causes execute arbitrary JavaScript code by clicking the rendered link.

## Timeline

* Feb. 24, 2012 : I reported the problem to a developer (by sending e-mail)
* Feb. 29, 2012 : A developer discloses the issue in this ticket: <http://jgarber.lighthouseapp.com/projects/13054-redcloth/tickets/243-xss>
* ...
* Sep. 24, 2014 : Announced "RedCloth needs new maintainers" to take over RedCloth by a developer: <https://github.com/jgarber/redcloth/commit/b24f03db023d1653d60dd33b28e09317cd77c6a0>
* Dec. 8, 2014 : I reported a site contains XSS issue caused by this RedCloth vulnerability
* Dec. 9, 2014 : I decided to disclose this problem on my site
* Dec. 11, 2014 : Published.

## Affected Version

I've confirmed the following versions of RedCloth are affected:

* RedCloth 4.2.9 (November 27, 2011) [latest version]
* RedCloth 4.2.0 (June 10, 2009)
* RedCloth 4.1.9 (February 20, 2009)
* RedCloth 3.0.4 (September 15, 2005)
* RedCloth 3.0.3 (February 6, 2005)
* RedCloth 3.0.2 (February 3, 2005)
* RedCloth 3.0.1 (January 18, 2005)

I've confirmed that RedCloth 3.0.0 generates link without javascript scheme. So the version of 3.0.0 is not affected.

I couldn't test with RedCloth 4.0.0 to RedCloth 4.1.1 on my environment.

## Workaround

Some projects use their own RedCloth and avoid a type of this problem. I know the Redmine's case.

Redmine uses old RedCloth 3.0.4 but it is very patched: <http://www.redmine.org/projects/redmine/repository/changes/trunk/lib/redcloth3.rb> and the XSS issue is fixed in <http://www.redmine.org/projects/redmine/repository/revisions/2212> . The Redmine's fix looks good to me; limited types of schemes should be accepted so it might help to create your own patch.

Of course using an alternative library or well-maintained fork of RedCloth 4, or filtering user inputted values, or some monkey patching approach might be effective. But I'm sorry too that I can't indicate specific information since I'm not Ruby-aware programmer.

Please enable JavaScript to view the [comments powered by Disqus.](http://disqus.com/?ref_noscript)
[comments powered by Disqus](http://disqus.com)

#### Recently entries

* [„Å©„ÅÜ„Åó„Å¶„É™„Çπ„ÇØ„Ç¢„Çª„Çπ„É°„É≥„Éà„Åõ„Åö„Å´ JWT „Çí„Çª„ÉÉ„Ç∑„Éß„É≥„Å´‰Ωø„Å£„Å°„ÇÉ„ÅÜ„Çè„ÅëÔºü](/blog/why-do-you-use-jwt-for-session)
* [„Åä„ÅÜ„Å°„Åß‰Ωú„Çå„ÇãÁîü‰ΩìË™çË®º„Ç∑„Çπ„ÉÜ„É†„ÅÆ„ÅîÊèêÊ°à](/blog/handmade-biometric-authentication)
* [Web „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Å´Èñ¢„Åô„Çã„Ç§„É≥„Çø„Éº„É≥„Åß‰ºù„Åà„Çà„ÅÜ„Å®„Åó„Åü„Åì„Å®](/blog/vg-security-intern-2014)
* [RedCloth „Å´„Åä„Åë„ÇãÊú™‰øÆÊ≠£„ÅÆ XSS ËÑÜÂº±ÊÄß„Å´„Å§„ÅÑ„Å¶„ÅÆÊ≥®ÊÑèÂñöËµ∑](/blog/redcloth-unfixed-xss)
* [Zend Framework „ÅÆ XXE ËÑÜÂº±ÊÄßÂØæÁ≠ñ (ZF2014-01) „Å® zendframework/ZendXml „ÅÆ„Çπ„Çπ„É°](/blog/zf2014-01-xxe-protection)

Copyright ¬© 2013 Kousuke Ebihara All Rights Reserved.

[![Creative Commons License](https://licensebuttons.net/l/by-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-sa/3.0/)
The content of this site is licensed under a [Creative Commons Attribution-ShareAlike 3.0 Unported License](http://creativecommons.org/licenses/by-sa/3.0/).

[„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº](/#privacy-policy)

Powered by [Pelican](http://getpelican.com/),
which takes great advantage of [Python](http://python.org).



=== Content from seclists.org_f4ccff51_20250125_151935.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#50)
[![Next](/images/right-icon-16x16.png)](51)

[![Previous](/images/left-icon-16x16.png)](49)
[By Thread](index.html#50)
[![Next](/images/right-icon-16x16.png)](51)

![](/shared/images/nst-icons.svg#search)

# RedCloth contains unfixed XSS vulnerability for 9 years

---

*From*: Kousuke Ebihara <kousuke () co3k org>

*Date*: Thu, 11 Dec 2014 14:43:26 +0900

---

```
I disclosed the following advisory about a XSS vulnerability of
RedCloth (Textile library for Ruby).
<http://co3k.org/blog/redcloth-unfixed-xss-en>

You shouldn't use RedCloth to parse user inputted contents and output
the parsed string (except that you allow your
user to write arbitrary JavaScript code on your site) because it
contains unfixed XSS vulnerability for 9 years,
and it be also disclosed for 2 years.

Unfortunately, we may not expect fix the vulnerability by the current
developer because he announced that "unable to
keep fixing bugs or work on the next major release".

If you want to continue to use RedCloth for such contents, you should
patch for the problem yourself, consider
contributing to RedCloth, or otherwise.

PoC
===

```
require 'redcloth'

print RedCloth.new('["clickme":javascript:alert(%27XSS%27)]',
[:filter_html, :filter_styles, :filter_classes, :filter_ids]).to_html

# Result:
# <p><a href="javascript:alert(%27XSS%27)">clickme</a></p>
```

Timeline
========

* Feb. 24, 2012 : I reported the problem to a developer (by sending e-mail)
* Feb. 29, 2012 : A developer discloses the issue in this ticket:
<http://jgarber.lighthouseapp.com/projects/13054-redcloth/tickets/243-xss>
* ...
* Sep. 24, 2014 : Announced "RedCloth needs new maintainers" to take
over RedCloth by a developer:
<https://github.com/jgarber/redcloth/commit/b24f03db023d1653d60dd33b28e09317cd77c6a0>

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#50)
[![Next](/images/right-icon-16x16.png)](51)

[![Previous](/images/left-icon-16x16.png)](49)
[By Thread](index.html#50)
[![Next](/images/right-icon-16x16.png)](51)

### Current thread:

* **RedCloth contains unfixed XSS vulnerability for 9 years** *Kousuke Ebihara (Dec 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from gist.github.com_1f757830_20250125_151944.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c&source=header-gist)

[Sign¬†in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c) [Sign¬†up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@co3k](https://avatars.githubusercontent.com/u/9206?s=64&v=4)](/co3k)

# [co3k](/co3k)/**[gist:75b3cb416c342aa1414c](/co3k/75b3cb416c342aa1414c)** Secret

Created
February 29, 2012 10:34

Show Gist options

* [Download ZIP](/co3k/75b3cb416c342aa1414c/archive/bb5d4ea1d67d2a15c659599cd84cbefe866864c9.zip)

* [Star
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c)You must be signed in to star a gist
* [Fork
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/co3k/75b3cb416c342aa1414c.js&quot;&gt;&lt;/script&gt;
* Save co3k/75b3cb416c342aa1414c to your computer and use it in GitHub Desktop.

[Code](/co3k/75b3cb416c342aa1414c)
[Revisions
1](/co3k/75b3cb416c342aa1414c/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/co3k/75b3cb416c342aa1414c.js&quot;&gt;&lt;/script&gt;

Save co3k/75b3cb416c342aa1414c to your computer and use it in GitHub Desktop.

[Download ZIP](/co3k/75b3cb416c342aa1414c/archive/bb5d4ea1d67d2a15c659599cd84cbefe866864c9.zip)

 [Raw](/co3k/75b3cb416c342aa1414c/raw/bb5d4ea1d67d2a15c659599cd84cbefe866864c9/gistfile1.rb)

[**gistfile1.rb**](#file-gistfile1-rb)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | require 'redcloth' |
| --- | --- |
|  |  |
|  | print RedCloth.new('["clickme":javascript:alert%28/XSS/.source%29]', [:filter\_html, :filter\_styles, :filter\_classes, :filter\_ids]).to\_html |
|  |  |
|  | # Result: |
|  | # <p><a href="javascript:alert%28/XSS/.source%29">clickme</a></p> |

[![@co3k](https://avatars.githubusercontent.com/u/9206?s=80&v=4)](/co3k)

Copy link

Author

### **[co3k](/co3k)** commented [Feb 29, 2012](/co3k/75b3cb416c342aa1414c?permalink_comment_id=87198#gistcomment-87198)

I've confirmed this with RedCloth-4.2.9 (installed by RubyGems).

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fco3k%2F75b3cb416c342aa1414c)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.debian.org_dd140fb8_20250125_151943.html ===


---

[[Date Prev](msg00052.html)][[Date Next](msg00054.html)]
[[Thread Prev](msg00052.html)][[Thread Next](msg00054.html)]
[[Date Index](maillist.html#00053)]
[[Thread Index](threads.html#00053)]

# [SECURITY] [DSA 3168-1] ruby-redcloth security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3168-1] ruby-redcloth security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Sun, 22 Feb 2015 19:02:22 +0100
* *Message-id*: <[[üîé]](/msgid-search/E1YParG-0004Mi-Au%40centurion.befour.org)¬†[E1YParG-0004Mi-Au@centurion.befour.org](msg00053.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3168-1                   security@debian.org
<http://www.debian.org/security/>                        Sebastien Delafond
February 22, 2015                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ruby-redcloth
CVE ID         : CVE-2012-6684
Debian Bug     : 774748

Kousuke Ebihara discovered that redcloth, a Ruby module used to
convert Textile markup to HTML, did not properly sanitize its
input. This allowed a remote attacker to perform a cross-site
scripting attack by injecting arbitrary JavaScript code into the
generated HTML.

For the stable distribution (wheezy), this problem has been fixed in
version 4.2.9-2+deb7u2.

For the unstable distribution (sid), this problem has been fixed in
version 4.2.9-4.

We recommend that you upgrade your ruby-redcloth packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBCAAGBQJU6hmvAAoJEBC+iYPz1Z1kMFIH/iPYQh1FZgyuwXQxSh19opx4
GsFlA5ev/CxiRyNoJ5feO9XTESI28kEQsXSG4wysYsc45ZcF9/K1HtSYJ0xnfV3g
flRAqLs58vIwJOdvRU1rdYi3Xe4Z4N/f/9PBPnlxAzxL/bejpKy/LU+7z3H4U42e
kXJHWdecSGEk/18eAYz3c2yhA9h2sqG066iB3oCjlMPYAXfwhlKpM1YRjcUzKLD+
dvuMAHWlntWxeljyEBOL/uhKKuNebAYsAdwN6O+7Gezf6HjH2uE2LA1dpBWwxdzU
wcf1JmPd+IGrEDL6/Gse6Bd8OGQbG5Gkra4QTucqVcI9cMCcvumThga188Oxt/k=
=GdNQ
-----END PGP SIGNATURE-----

```

---



=== Content from jgarber.lighthouseapp.com_8cd545d7_20250125_151932.html ===


# [Lighthouse logo](/)

* [Pricing & Signup](/plans "Pricing & Signup")
* [Tour](/tour "Tour")
* [Support](http://help.lighthouseapp.com "Get some help")
* [Login](/login "Login to your lighthouse account")

## Beautifully Simple Issue Tracking

Collaborate effortlessly on projects. Whether you‚Äôre a team of 5 or studio of 50, Lighthouse will help you keep track of your project development with ease.

## Less Fuss, More Function

Cut the fat out of your workflow and stay focused on what‚Äôs important.

![Lighthouse interface screenshot](/marketing/images/screenshot.png "Lighthouse Interface")

Lighthouse will simplify your workflow so you can do the job you were hired to do. Try it for free. No credit card required.

[Try Lighthouse For Free](/signup "Try Lighthouse free for 14 days")

* ## Automatically Organize Tasks

  As you create and tag issues they can be categorized behind the scenes automatically.
* ## Make Better Use Of Your Email

  Stay in your happy place. Create and reply to tickets directly from your inbox.
* ## Consolidate Your Projects

  You can see the status of all your projects in a simple overview and follow along with feeds.
* ## Unify With Customer Support

  Your staff can create new Lighthouse tickets directly from [Tender](https://tenderapp.com), our customer support service.
* ## Set And Meet Goals

  Use milestones to help you plan features and establish release dates.
* ## Share Documents & Images

  Attach documents or images directly to tickets so anyone on your team can find them.

## Whether you're a large company or a small bootstrapped team, Lighthouse is the perfect ticket tracking solution.

* ## [Tender Support](https://tenderapp.com?utm_campaign=lh_mkt&utm_source=logo)

  Need to [unify your customer support](https://tenderapp.com?utm_campaign=lh_mkt&utm_source=unify) Tender is fully integrated with your email & Lighthouse -- and Lighthouse customers receive a discount!
* ##
* ## [We are entp](http://entp.com)

  Lighthouse is a product of entp. We are a consultancy and web incubator collective based in Portland, OR. We specialize in implementing big ideas.

* Copyright ¬© 2007-2018 [entp](http://entp.com "entp.com")
* [Support](http://help.lighthouseapp.com "Lighthouse Support")
* [Twitter](http://twitter.com/lighthouseapp "Twitter")
* [Blog](http://blog.entp.com/ "entp blog")
* [Contact Us](http://entp.com/contact/ "Contact us")
* [Terms of Service](/tos "Lighthouse Terms of Service")
* [Privacy Policy](/privacy "Lighthouse Privacy Policy")
* [API](http://help.lighthouseapp.com/faqs/api "Lighthouse API")


