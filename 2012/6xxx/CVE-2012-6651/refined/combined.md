=== Content from www.openwall.com_28225589_20250125_062234.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[thread-next>]](../../../2014/07/28/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20140724181124.GA30484@kludge.henri.nerv.fi>
Date: Thu, 24 Jul 2014 21:11:24 +0300
From: Henri Salo <henri@...v.fi>
To: oss-security@...ts.openwall.com
Subject: CVE request: WordPress plugin vitamin traversal arbitrary file
 access

Can I get 2012 CVE for WordPress plugin vitamin path parameter traversal
arbitrary file access vulnerability, thanks. Files: add_headers.php, minify.php

Affected: 1.0
Fixed in: 1.1

Short description of plugin:

 Vitamin is about SEO, speed and security. It includes sitemaps for SEO, cache
 for speed, antispam and hacker blocks for security.

Plugin page: <http://wordpress.org/plugins/vitamin/>
Changelog: <http://wordpress.org/plugins/vitamin/changelog/>
OSVDB: <http://osvdb.org/84463> <http://osvdb.org/84464>
SCM: <https://plugins.trac.wordpress.org/changeset/582232/vitamin>

---
Henri Salo

Download attachment "[signature.asc](6/1)" of type "application/pgp-signature" (199 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from plugins.trac.wordpress.org_6af3353a_20250126_064004.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F582232%2Fvitamin)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/581846/vitamin "Changeset 581846 for vitamin")
* [Next Change](/changeset/582236/vitamin "Changeset 582236 for vitamin") →

---

# Changeset [582232](/changeset/582232 "Show full changeset") for [vitamin](/browser/vitamin?rev=582232 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/06/2012 11:41:12 AM
([12 years](/timeline?from=2012-08-06T11%3A41%3A12Z&precision=second "See timeline at 08/06/2012 11:41:12 AM") ago)

Author:
SEO Peter
Message:

Big security issue fixed

Location:
[vitamin](/browser/vitamin?rev=582232)
Files:

4 edited
2 copied

* [tags/1.1](/browser/vitamin/tags/1.1?rev=582232 "Show entry in browser")
  (copied)
  *(copied from [vitamin/trunk](/browser/vitamin/trunk?rev=581751 "Show original file (revision 581844)"))*
* [tags/1.1/add\_headers.php](/browser/vitamin/tags/1.1/add_headers.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/1.1/minify.php](/browser/vitamin/tags/1.1/minify.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/1.1/readme.txt](/browser/vitamin/tags/1.1/readme.txt?rev=582232 "Show entry in browser")
  (copied)
  *(copied from [vitamin/trunk/readme.txt](/browser/vitamin/trunk/readme.txt?rev=581846 "Show original file (revision 581846)"))*
* [trunk/add\_headers.php](/browser/vitamin/trunk/add_headers.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [trunk/minify.php](/browser/vitamin/trunk/minify.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [vitamin/tags/1.1/add\_headers.php](/changeset/582232/vitamin/tags/1.1/add_headers.php "Show the changeset 582232 restricted to vitamin/tags/1.1/add_headers.php")

  | [r581751](/browser/vitamin/trunk/add_headers.php?rev=581751#L10 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/tags/1.1/add_headers.php?rev=582232#L10 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | $path = $\_GET['path']; |
  | 11 | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  |  | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
  | 13 | 18 |  |
  | 14 | 19 | $path = 'wp-content'.DIRECTORY\_SEPARATOR.$path; |
  | 15 | 20 | $file = SP\_ABSPATH.DIRECTORY\_SEPARATOR.$path; |
  | 16 |  |  |
  | 17 | 21 |  |
  | 18 | 22 | require\_once 'classes/spClasses.php'; |
* ## [vitamin/tags/1.1/minify.php](/changeset/582232/vitamin/tags/1.1/minify.php "Show the changeset 582232 restricted to vitamin/tags/1.1/minify.php")

  | [r581751](/browser/vitamin/trunk/minify.php?rev=581751#L9 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/tags/1.1/minify.php?rev=582232#L9 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | $exp  = $\_GET['exp']; |
  | 10 | 10 | $path = $\_GET['path']; |
  |  | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  | 11 | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
* ## [vitamin/trunk/add\_headers.php](/changeset/582232/vitamin/trunk/add_headers.php "Show the changeset 582232 restricted to vitamin/trunk/add_headers.php")

  | [r581751](/browser/vitamin/trunk/add_headers.php?rev=581751#L10 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/trunk/add_headers.php?rev=582232#L10 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | $path = $\_GET['path']; |
  | 11 | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  |  | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
  | 13 | 18 |  |
  | 14 | 19 | $path = 'wp-content'.DIRECTORY\_SEPARATOR.$path; |
  | 15 | 20 | $file = SP\_ABSPATH.DIRECTORY\_SEPARATOR.$path; |
  | 16 |  |  |
  | 17 | 21 |  |
  | 18 | 22 | require\_once 'classes/spClasses.php'; |
* ## [vitamin/trunk/minify.php](/changeset/582232/vitamin/trunk/minify.php "Show the changeset 582232 restricted to vitamin/trunk/minify.php")

  | [r581751](/browser/vitamin/trunk/minify.php?rev=581751#L9 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/trunk/minify.php?rev=582232#L9 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | $exp  = $\_GET['exp']; |
  | 10 | 10 | $path = $\_GET['path']; |
  |  | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  | 11 | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=582232)
* [Zip Archive](?format=zip&new=582232)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_d3181600_20250125_062233.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Vitamin

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fvitamin&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fvitamin&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/vitamin.svg)
# vitamin

By [SEO Peter](http://seopeter.com/)

* [Details](https://wordpress.org/plugins/vitamin/#description)
* [Reviews](https://wordpress.org/plugins/vitamin/#reviews)
* [Development](https://wordpress.org/plugins/vitamin/#developers)

[Support](https://wordpress.org/support/plugin/vitamin/)

## Description

This plugin has been closed as of August 10, 2012 and is not available for download. Reason: Unknown.

## Reviews

![](https://secure.gravatar.com/avatar/67e039c744d4183a93a7ce64fa469b34d030271137d301bcd2abe3121d976b48?s=60&d=retro&r=g)
### [Syntax Error](https://wordpress.org/support/topic/syntax-error-157/)

[washetz](https://profiles.wordpress.org/washetz/ "Posts by washetz")
February 7, 2017

(“Parse error: syntax error, unexpected ‘
DefaultLanguage’ (T\_STRING) in your code on line 3 DefaultLanguage en-US
“)
# BEGIN SP UTF-8 DefaultLanguage en-US RewriteEngine On Options +FollowSymLinks ### Care about comments: RewriteCond %{REQUEST\_URI} ^/wp-comments-post.php$ RewriteRule (.\*) / [L] ### htaccess blocks: OFF ### htaccess redirections: OFF ### htaccess author redirections: OFF ### Fast 404 for search, author and day feeds : RewriteCond %{REQUEST\_URI} ^/search/(.\*)/feed/(.\*)$ [OR] RewriteCond %{REQUEST\_URI} ^/author/(.\*)/feed/(.\*)$ [OR] RewriteCond %{REQUEST\_URI} ^/([0-9]{4})/([0-9]{1,2})/([0-9]{1,2})/feed(.\*)$ RewriteRule ^(.\*) /wp-content/plugins/vitamin/fast404.php?type=search\_feed [L] ### Redirect to sitemaps and robots RewriteCond %{REQUEST\_URI} ^/sitemap\.xml$ RewriteRule (.\*) /wp-content/plugins/vitamin/sitemaps/index-sitemap.xml [L] RewriteCond %{REQUEST\_URI} ^/robots\.txt$ RewriteRule (.\*) /wp-content/plugins/vitamin/sitemaps/robots.txt [L] RewriteCond %{REQUEST\_URI} ^/sitemaps/(.\*)$ RewriteRule ^sitemaps/(.\*) /wp-content/plugins/vitamin/sitemaps/$1 [L] ### htaccess fast 404 for files is ON – 11 Item(s): RewriteCond %{REQUEST\_FILENAME} !-f RewriteCond %{REQUEST\_URI} ^(.\*)/wp-content/(.\*)(\.jpg|\.jpeg|\.png|\.gif|\.ico|\.js|\.css|\.txt|\.htm|\.html|\.php)$ [NC] RewriteRule ^(.\*) /wp-content/plugins/vitamin/fast404.php [L] ### htaccess cache is: OFF ### Minification is: ON RewriteCond %{REQUEST\_FILENAME} -f RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins)/(.\*)$ RewriteCond %{DOCUMENT\_ROOT}/wp-content/cache/firefly.synergize.co/wp-content/%1/%2 -f RewriteRule ^wp-content/(themes|plugins)/(.\*)$ /wp-content/cache/firefly.synergize.co/wp-content/$1/$2 [L] # Minification for css files RewriteCond %{REQUEST\_FILENAME} -f RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins)/(.\*)\.css$ RewriteRule ^wp-content/(themes|plugins)/(.\*)\.css$ /wp-content/plugins/vitamin/minify.php?ext=css&gzip=true&exp=604800&path=$1/$2.css [L] # Minification for js files RewriteCond %{REQUEST\_FILENAME} -f RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins)/(.\*)\.js$ RewriteRule ^wp-content/(themes|plugins)/(.\*)\.js$ /wp-content/plugins/vitamin/minify.php?ext=js&gzip=true&exp=604800&path=$1/$2.js [L] # Minification for txt files RewriteCond %{REQUEST\_FILENAME} -f RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins)/(.\*)\.txt$ RewriteRule ^wp-content/(themes|plugins)/(.\*)\.txt$ /wp-content/plugins/vitamin/minify.php?ext=txt&gzip=true&exp=0&path=$1/$2.txt [L] # Minification for xml files RewriteCond %{REQUEST\_FILENAME} -f RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins)/(.\*)\.xml$ RewriteRule ^wp-content/(themes|plugins)/(.\*)\.xml$ /wp-content/plugins/vitamin/minify.php?ext=xml&gzip=true&exp=0&path=$1/$2.xml [L] ### Headers for expiration if mod\_headers or mod\_expires is off <IfModule !mod\_headers.c> RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins|uploads|cache)/(.\*)\.(jpg|jpeg|png|gif|ico)$ [NC] RewriteRule ^wp-content/(themes|plugins|uploads|cache)/(.\*)\.(jpg|jpeg|png|gif|ico)$ /wp-content/plugins/vitamin/add\_headers.php?ext=$3&gzip=false&exp=604800&path=$1/$2.$3 [L] RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins|uploads|cache)/(.\*)\.(htm|txt|xml)$ [NC] RewriteRule ^wp-content/(themes|plugins|uploads|cache)/(.\*)\.(htm|txt|xml)$ /wp-content/plugins/vitamin/add\_headers.php?ext=$3&gzip=true&exp=0&path=$1/$2.$3 [L] RewriteCond %{REQUEST\_URI} ^/wp-content/(themes|plugins|uploads|cache)/(.\*)\.(js|css)$ [NC] RewriteRule ^wp-content/(themes|plugins|uploads|cache)/(.\*)\.(js|css)$ /wp-content/plugins/vitamin/add\_headers.php?ext=$3&gzip=true&exp=604800&path=$1/$2.$3 [L] </IfModule> ### Headers gzip, expires <IfModule mod\_headers.c> <filesMatch .\*\.(jpg|jpeg|png|gif|ico|js|css)(\.gz)?$> Header append Cache-Control “public” Header append Expires “A604800” </filesMatch> Header unset Accept-Ranges Header unset ETag Header unset Link Header unset Pragma Header unset Transfer-Encoding Header unset X-Pingback Header append Vary Accept-Encoding RewriteCond %{HTTP:Accept-encoding} gzip RewriteCond %{REQUEST\_FILENAME}.gz -f RewriteRule ^(.\*)$ $1.gz [L] <FilesMatch .\*\.gz$> Header set Content-Encoding: gzip </FilesMatch> <FilesMatch .\*\.css.gz$> ForceType text/css </FilesMatch> <FilesMatch .\*\.html?.gz$> ForceType text/html Header unset Expires </FilesMatch> <FilesMatch .\*\.js.gz$> # Works in IE8 and older but obsolete – today standart = application/javascript ForceType text/javascript </FilesMatch> <FilesMatch .\*\.xml.gz$> ForceType text/xml </FilesMatch> <FilesMatch .\*\.txt.gz$> ForceType text/plain </FilesMatch> </IfModule> # END SP
Analyze Here

[Read all 1 review](https://wordpress.org/support/plugin/vitamin/reviews/)
## Contributors & Developers

“Vitamin” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/c9d56e6addada35238b8855ca29c9e0c617e2744a45f0084e05be7072f71b97f?s=32&d=mm&r=g) [Petr Sláma](https://profiles.wordpress.org/seo-peter/)

[Translate “Vitamin” into your language.](https://translate.wordpress.org/projects/wp-plugins/vitamin)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/vitamin/), check out the [SVN repository](https://plugins.svn.wordpress.org/vitamin/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/vitamin/) by [RSS](https://plugins.trac.wordpress.org/log/vitamin/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **1.2.0**
* Last updated **12 years ago**
* Active installations **N/A**
* WordPress version **3.0.0 or higher**
* Tested up to **3.4.2**
* [Advanced View](https://wordpress.org/plugins/vitamin/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_18cf4d6b_20250125_062236.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F582232)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/582231 "Changeset 582231")
* [Next Changeset](/changeset/582233 "Changeset 582233") →

---

# Changeset 582232

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/06/2012 11:41:12 AM
([12 years](/timeline?from=2012-08-06T11%3A41%3A12Z&precision=second "See timeline at 08/06/2012 11:41:12 AM") ago)

Author:
SEO Peter
Message:

Big security issue fixed

Location:
[vitamin](/browser/vitamin?rev=582232)
Files:

4 edited
2 copied

* [tags/1.1](/browser/vitamin/tags/1.1?rev=582232 "Show entry in browser")
  (copied)
  *(copied from [vitamin/trunk](/browser/vitamin/trunk?rev=581751 "Show original file (revision 581844)"))*
* [tags/1.1/add\_headers.php](/browser/vitamin/tags/1.1/add_headers.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/1.1/minify.php](/browser/vitamin/tags/1.1/minify.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/1.1/readme.txt](/browser/vitamin/tags/1.1/readme.txt?rev=582232 "Show entry in browser")
  (copied)
  *(copied from [vitamin/trunk/readme.txt](/browser/vitamin/trunk/readme.txt?rev=581846 "Show original file (revision 581846)"))*
* [trunk/add\_headers.php](/browser/vitamin/trunk/add_headers.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [trunk/minify.php](/browser/vitamin/trunk/minify.php?rev=582232 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [vitamin/tags/1.1/add\_headers.php](/changeset/582232/vitamin/tags/1.1/add_headers.php "Show the changeset 582232 restricted to vitamin/tags/1.1/add_headers.php")

  | [r581751](/browser/vitamin/trunk/add_headers.php?rev=581751#L10 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/tags/1.1/add_headers.php?rev=582232#L10 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | $path = $\_GET['path']; |
  | 11 | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  |  | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
  | 13 | 18 |  |
  | 14 | 19 | $path = 'wp-content'.DIRECTORY\_SEPARATOR.$path; |
  | 15 | 20 | $file = SP\_ABSPATH.DIRECTORY\_SEPARATOR.$path; |
  | 16 |  |  |
  | 17 | 21 |  |
  | 18 | 22 | require\_once 'classes/spClasses.php'; |
* ## [vitamin/tags/1.1/minify.php](/changeset/582232/vitamin/tags/1.1/minify.php "Show the changeset 582232 restricted to vitamin/tags/1.1/minify.php")

  | [r581751](/browser/vitamin/trunk/minify.php?rev=581751#L9 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/tags/1.1/minify.php?rev=582232#L9 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | $exp  = $\_GET['exp']; |
  | 10 | 10 | $path = $\_GET['path']; |
  |  | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  | 11 | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
* ## [vitamin/trunk/add\_headers.php](/changeset/582232/vitamin/trunk/add_headers.php "Show the changeset 582232 restricted to vitamin/trunk/add_headers.php")

  | [r581751](/browser/vitamin/trunk/add_headers.php?rev=581751#L10 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/trunk/add_headers.php?rev=582232#L10 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | $path = $\_GET['path']; |
  | 11 | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  |  | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |
  | 13 | 18 |  |
  | 14 | 19 | $path = 'wp-content'.DIRECTORY\_SEPARATOR.$path; |
  | 15 | 20 | $file = SP\_ABSPATH.DIRECTORY\_SEPARATOR.$path; |
  | 16 |  |  |
  | 17 | 21 |  |
  | 18 | 22 | require\_once 'classes/spClasses.php'; |
* ## [vitamin/trunk/minify.php](/changeset/582232/vitamin/trunk/minify.php "Show the changeset 582232 restricted to vitamin/trunk/minify.php")

  | [r581751](/browser/vitamin/trunk/minify.php?rev=581751#L9 "Show revision 581751 of this file in browser") | [r582232](/browser/vitamin/trunk/minify.php?rev=582232#L9 "Show revision 582232 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | $exp  = $\_GET['exp']; |
  | 10 | 10 | $path = $\_GET['path']; |
  |  | 11 |  |
  |  | 12 | if( FALSE !== strpos($path, "../") ){ die("There are forbidden substrings in file path"); } |
  |  | 13 | if( $ext != substr($path, - strlen($ext)) ) { die("Extension does not fit with extension in filename"); } |
  |  | 14 | if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); } |
  |  | 15 | if( 'phtml' == strtolower($ext) ) { die("Adding headers to phtml files is forbidden"); } |
  | 11 | 16 |  |
  | 12 | 17 | define('SP\_ABSPATH', dirname(dirname(dirname(dirname(\_\_FILE\_\_)))) ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=582232)
* [Zip Archive](?format=zip&new=582232)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.openwall.com_ecdfdf23_20250125_062234.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2014/07/29/1) [[<thread-prev]](../../../2014/07/24/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20140728231034.60C4F1F1BFB@smtpksrv1.mitre.org>
Date: Mon, 28 Jul 2014 19:10:34 -0400 (EDT)
From: cve-assign@...re.org
To: henri@...v.fi
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: WordPress plugin vitamin traversal arbitrary file access

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Can I get 2012 CVE for WordPress plugin vitamin path parameter traversal
> arbitrary file access vulnerability, thanks. Files: add_headers.php, minify.php
>
> Affected: 1.0
> Fixed in: 1.1
>
> Changelog: <http://wordpress.org/plugins/vitamin/changelog/>
> SCM: <https://plugins.trac.wordpress.org/changeset/582232/vitamin>

Use CVE-2012-6651. The scope of this CVE ID is the directory
traversal. It isn't directly about the ability to access .php
and .phtml files in unpatched versions, apparently corrected with
lines such as:

  if( 'php' == strtolower($ext) ) { die("Adding headers to php files is forbidden"); }

We did not research that in depth, but suspect that it may be a
usability fix rather than a security fix.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJT1tc9AAoJEKllVAevmvmsbRwIAJhf/l3HLBx5f4HgY2yEozXF
alxy3DonvvENWr05OlFwLZI90MsYV+V4bvtFA9Qpnsun/Q202qu+/xWfhj6/2LKf
7FRS/7gSsdjUQSuSmyjgO8NpfW7y41D8Zt/+O9hjGj8K5FCuDjoBkuSblJvfW8x7
Lo/mZPrvyrjcSL5ZhUpff++IiLUo0yBWVddu2ehii2o9fjtPTQA2PCa6wZIdgoHv
Mv7p2QRVPvVubfM83WoxmpUq7uukNFYTnPivVgaqw9VqMKHNw6gJlD9o877AJOTk
HCTYa8cL16P85OlVqC2KR/0K+jwcyrtrIQGPBlR9px69TXa/HVsmzmsJSdD/Bzs=
=cnlx
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


