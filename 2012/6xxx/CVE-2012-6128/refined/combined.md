=== Content from www.mandriva.com_502c4ca8_20250124_165951.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.infradead.org_f0fce1eb_20250124_165949.html ===

![OpenConnect](./images/openconnect.png)

[Home](index.html)

[Features](features.html)

[Getting Started](connecting.html)

[Mailing List / Help](mail.html)

[Contribute](contribute.html)

[Protocols](protocols.html)

[VPN Server](https://ocserv.openconnect-vpn.net/)

OpenConnect VPN client

[About](index.html)

[Supported Platforms](platforms.html)

[Download](download.html)

[Packages](packages.html)

[Changelog](changelog.html)

[Licence](licence.html)

# Changelog

For full changelog entries including the latest development, see
[gitweb](https://git.infradead.org/users/dwmw2/openconnect.git).

* **OpenConnect HEAD**
  + Fix Cisco Anyconnect STRAP channel bindings with TLSv1.3 ([#659](https://gitlab.com/openconnect/openconnect/-/issues/659)).
  + Fix ASN.1 encoding of TPMv2 ECDSA signatures with GnuTLS < 3.6.0
  + Handle Pulse configuration packets that cannot fit in a single TLS frame ([#617](https://gitlab.com/openconnect/openconnect/-/issues/617), [!480](https://gitlab.com/openconnect/openconnect/-/merge_requests/480)).
  + Send operating system information to Pulse servers ([!481](https://gitlab.com/openconnect/openconnect/-/merge_requests/481)).
  + Change default user-agent string to be compatible with newer Cisco servers (
    [#544](https://gitlab.com/openconnect/openconnect/-/issues/544),
    [#593](https://gitlab.com/openconnect/openconnect/-/issues/593),
    [#602](https://gitlab.com/openconnect/openconnect/-/issues/602),
    [#618](https://gitlab.com/openconnect/openconnect/-/issues/618),
    [#635](https://gitlab.com/openconnect/openconnect/-/issues/635),
    [#657](https://gitlab.com/openconnect/openconnect/-/issues/657),
    [#662](https://gitlab.com/openconnect/openconnect/-/issues/662),
    [#665](https://gitlab.com/openconnect/openconnect/-/issues/665),
    [!497](https://gitlab.com/openconnect/openconnect/-/merge_requests/497)).
  + Fix bug which has caused GlobalProtect split-include IPv6 routes to be broken since v9.00 ([64f0c03d](https://gitlab.com/openconnect/openconnect/-/commit/64f0c03d660f1d17834f7ff7ce9d0151704bb32f)).
  + Sort GlobalProtect gateways according to portal's regionalized priority list ([#663](https://gitlab.com/openconnect/openconnect/-/issues/663), [!495](https://gitlab.com/openconnect/openconnect/-/merge_requests/498)).
  + openconnect\_disable\_dtls() allows to disable DTLS unless it is already connected ([#697](https://gitlab.com/openconnect/openconnect/-/issues/697))
  + Enable DTLSv1.0 to continue working with OpenSSL v3.1.0 and newer ([!504](https://gitlab.com/openconnect/openconnect/-/merge_requests/504), [!536](https://gitlab.com/openconnect/openconnect/-/merge_requests/536)).
  + Fix bug that caused OpenConnect to incorrectly log the remaining time until a re-key or periodic Trojan ([#677](https://gitlab.com/openconnect/openconnect/-/issues/677), [!539](https://gitlab.com/openconnect/openconnect/-/merge_requests/539))
  + Fix bug that prevented GlobalProtect ESP from working correctly when the server sends both Legacy IP and IPv6 versions of the ESP "magic ping" address, but no IPv6 client address ([!565](https://gitlab.com/openconnect/openconnect/-/merge_requests/565))
  + Use the full URI (including "usergroup" or path) as specified in --server for all requests during authentication instead of only the first one ([!560](https://gitlab.com/openconnect/openconnect/-/merge_requests/560)).
  + Deal with more Juniper NC framing idiocy ([#779](https://gitlab.com/openconnect/openconnect/-/issues/779)).
* **[OpenConnect v9.12](https://www.infradead.org/openconnect/download/openconnect-9.12.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-9.12.tar.gz.asc))* — 2023-05-20
  + Fix FreeBSD build and tests.
  + Add libopenconnect5.symbols file for Debian-style packaging (*[discussion](https://gitlab.com/openconnect/openconnect/-/issues/611#note_1395003963)*).
  + Explicitly reject overly long tun device names.
  + Work around ambiguity between <json.h> from json-parser vs json-c ([!476](https://gitlab.com/openconnect/openconnect/-/merge_requests/476)).
  + Fix symbol versioning for openconnect\_set\_sni().
  + Increase maximum input size from stdin ([#579](https://gitlab.com/openconnect/openconnect/-/issues/579)).
  + Ignore 0.0.0.0 as NBNS address ([!446](https://gitlab.com/openconnect/openconnect/-/merge_requests/446), [vpnc-scripts#58](https://gitlab.com/openconnect/vpnc-scripts/-/issues/58)).
  + Fix Mac OS build of os-tcp-mtu tool ([#612](https://gitlab.com/openconnect/openconnect/-/issues/612)).
* **[OpenConnect v9.11](https://www.infradead.org/openconnect/download/openconnect-9.11.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-9.11.tar.gz.asc))* — 2023-05-17
  + Rebuild test suite certificate chains (which had expired: [#609](https://gitlab.com/openconnect/openconnect/-/issues/609))
  + Fix stray (null) in URL path after Pulse authentication ([4023bd95](https://gitlab.com/openconnect/openconnect/-/commit/4023bd95c3dd6b273462e0782132f70a608dc721)).
  + Fix config XML parsing mistake that left GlobalProtect ESP non-working in v9.10 ([!475](https://gitlab.com/openconnect/openconnect/-/merge_requests/475)).
  + Fix case sensitivity in GPST header matching ([!474](https://gitlab.com/openconnect/openconnect/-/merge_requests/474)).
  + Add external browser support for Windows (([#553](https://gitlab.com/openconnect/openconnect/-/issues/553)).
* **[OpenConnect v9.10](https://www.infradead.org/openconnect/download/openconnect-9.10.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-9.10.tar.gz.asc))* — 2023-05-04
  + Fix external browser authentication with KDE plasma-nm < 5.26.
  + Always redirect stdout to stderr when spawning external browser.
  + Increase default queue length to 32 packets ([#582](https://gitlab.com/openconnect/openconnect/-/issues/582)).
  + Make the [Wintun](https://www.wintun.net/) Layer 3 TUN driver the default on Windows ([!427](https://gitlab.com/openconnect/openconnect/-/merge_requests/427)).
  + Add support for and bundle Wintun 0.14.1 ([!294](https://gitlab.com/openconnect/openconnect/-/merge_requests/294)).
  + Fix receiving multiple packets in one TLS frame, and single packets split across multiple TLS frames, for Array ([#435](https://gitlab.com/openconnect/openconnect/-/issues/435)).
  + Fix ESP failures under Windows ([#427](https://gitlab.com/openconnect/openconnect/-/issues/427)).
  + Add list-system-keys tool to assist Windows/MacOS users in setup.
  + Handle idiosyncratic variation in search domain separators for all protocols ([#433](https://gitlab.com/openconnect/openconnect/-/issues/433), [#443](https://gitlab.com/openconnect/openconnect/-/issues/443), [!388](https://gitlab.com/openconnect/openconnect/-/merge_requests/388)).
  + Support region selection field for Pulse authentication ([!399](https://gitlab.com/openconnect/openconnect/-/merge_requests/399)).
  + Support modified configuration packet from Pulse 9.1R16 servers ([#472](https://gitlab.com/openconnect/openconnect/-/issues/472), [!401](https://gitlab.com/openconnect/openconnect/-/merge_requests/401))
  + Allow hidden form fields to be populated or converted to text fields on the command line ([#493](https://gitlab.com/openconnect/openconnect/-/issues/493), [#489](https://gitlab.com/openconnect/openconnect/-/issues/489), [!409](https://gitlab.com/openconnect/openconnect/-/merge_requests/409))
  + Support yet another strange way of encoding challenge-based 2FA for GlobalProtect ([#495](https://gitlab.com/openconnect/openconnect/-/issues/495), [!411](https://gitlab.com/openconnect/openconnect/-/merge_requests/411))
  + Add --sni option (and corresponding C and Java API functions) to allow [domain-fronting](https://en.wikipedia.org/wiki/Domain_fronting) connections in censored/filtered network environments ([!297](https://gitlab.com/openconnect/openconnect/-/merge_requests/297), [!451](https://gitlab.com/openconnect/openconnect/-/merge_requests/451)).
  + Parrot a GlobalProtect server's software version, if present, as the client version ([!333](https://gitlab.com/openconnect/openconnect/merge_requests/333))
  + Fix NULL pointer dereference that has left Android builds broken since v8.20 ([!389](https://gitlab.com/openconnect/openconnect/-/merge_requests/389)).
  + Fix Fortinet authentication bug where repeated SVPNCOOKIE causes segfaults ([#514](https://gitlab.com/openconnect/openconnect/-/issues/514), [!418](https://gitlab.com/openconnect/openconnect/-/merge_requests/418)).
  + Support F5 VPNs which encode authentication forms only in JSON, not in HTML ([#512](https://gitlab.com/openconnect/openconnect/-/issues/512), [!431](https://gitlab.com/openconnect/openconnect/-/merge_requests/431)).
  + Persist Windows installers for tagged builds ([#463](https://gitlab.com/openconnect/openconnect/-/issues/463), [!391](https://gitlab.com/openconnect/openconnect/-/merge_requests/391)).
  + Support simultaneous IPv6 and Legacy IP ("dual-stack") for Fortinet ([#568](https://gitlab.com/openconnect/openconnect/-/issues/568), [!456](https://gitlab.com/openconnect/openconnect/-/merge_requests/456)).
  + Support "FTM-push" token mode for Fortinet VPNs ([#555](https://gitlab.com/openconnect/openconnect/-/issues/555), [!450](https://gitlab.com/openconnect/openconnect/-/merge_requests/450)).
  + Send IPv6-compatible version string in Pulse IF/T session establishment, and avoid its ESP/IP version layering idiocy on newer servers ([#506](https://gitlab.com/openconnect/openconnect/-/issues/506), [!414](https://gitlab.com/openconnect/openconnect/-/merge_requests/414))
  + Add --no-external-auth option to not advertise external-browser authentication, as a workaround for servers which behave differently when it is advertised ([#470](https://gitlab.com/openconnect/openconnect/-/issues/470), [!398](https://gitlab.com/openconnect/openconnect/-/merge_requests/398))
  + Emulate MacOS-specific contents in the HIP report for GlobalProtect ([!471](https://gitlab.com/openconnect/openconnect/-/merge_requests/471)).
  + Many small improvements in server response parsing, and better logging messages and documentation.
* **[OpenConnect v9.01](https://www.infradead.org/openconnect/download/openconnect-9.01.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-9.01.tar.gz.asc))* — 2022-04-29
  + Fix library minor version (missing bump to 5.8).
* **[OpenConnect v9.00](https://www.infradead.org/openconnect/download/openconnect-9.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-9.00.tar.gz.asc))* — 2022-04-29
  + Add support for AnyConnect "Session Token Re-use Anchor Protocol" (STRAP) ([#410](https://gitlab.com/openconnect/openconnect/-/issues/410)).
  + Add support for AnyConnect "external browser" SSO mode ([!354](https://gitlab.com/openconnect/openconnect/-/merge_requests/354)).
  + On Windows, fix crash on tunnel setup. ([#370](https://gitlab.com/openconnect/openconnect/-/issues/370), [6a2ffbb](https://gitlab.com/openconnect/openconnect/commit/6a2ffbbcd1c4ef0b689cce3d17154f6d4c2e3bc0))
  + Bugfix RSA SecurID token decryption and PIN entry forms, broken in v8.20. ([#388](https://gitlab.com/openconnect/openconnect/-/issues/388), [!344](https://gitlab.com/openconnect/openconnect/-/merge_requests/344))
  + Support [Cisco's multiple-certificate authentication](https://www.cisco.com/c/en/us/support/docs/security/anyconnect-secure-mobility-client-v4x/212483-configure-asa-as-the-ssl-gateway-for-any.html) ([!194](https://gitlab.com/openconnect/openconnect/-/merge_requests/194)).
  + Append internal=no to GlobalProtect authentication/configuration forms, for compatibility with servers which apparently require this to function properly. ([#246](https://gitlab.com/openconnect/openconnect/-/issues/246), [!337](https://gitlab.com/openconnect/openconnect/-/merge_requests/337))
  + Revert GlobalProtect default route handling change from v8.20. ([!367](https://gitlab.com/openconnect/openconnect/-/merge_requests/367))
  + Support split-exclude routes for Fortinet. ([#394](https://gitlab.com/openconnect/openconnect/-/issues/394), [!345](https://gitlab.com/openconnect/openconnect/-/merge_requests/345))
  + Add openconnect\_set\_useragent() function.
  + Add webview callback and SAML/SSO support for AnyConnect, GlobalProtect. ([!126](https://gitlab.com/openconnect/openconnect/-/merge_requests/126)).
* **[OpenConnect v8.20](https://www.infradead.org/openconnect/download/openconnect-8.20.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.20.tar.gz.asc))* — 2022-02-20
  + When the queue length *(-Q option)* is 16 or more, try using [vhost-net](https://www.redhat.com/en/blog/virtqueues-and-virtio-ring-how-data-travels) to accelerate tun device access.
  + Use epoll() where available.
  + Support non-AEAD ciphersuites in DTLSv1.2 with AnyConnect. ([#249](https://gitlab.com/openconnect/openconnect/-/issues/249))
  + Make tncc-emulate.py work with Python 3.7+. ([#152](https://gitlab.com/openconnect/openconnect/-/issues/152), [!120](https://gitlab.com/openconnect/openconnect/merge_requests/120))
  + Emulated a newer version of GlobalProtect official clients, 5.1.5-8; was 4.0.2-19 ([#176](https://gitlab.com/openconnect/openconnect/issues/176), [!131](https://gitlab.com/openconnect/openconnect/merge_requests/131))
  + Support Juniper login forms containing both password and 2FA token ([!121](https://gitlab.com/openconnect/openconnect/-/merge_requests/121))
  + Explicitly disable 3DES and RC4, unless enabled with --allow-insecure-crypto ([!114](https://gitlab.com/openconnect/openconnect/-/merge_requests/114))
  + Add obsolete-server-crypto test ([!114](https://gitlab.com/openconnect/openconnect/-/merge_requests/114))
  + Allow protocols to delay tunnel setup and shutdown ([!117](https://gitlab.com/openconnect/openconnect/-/merge_requests/117))
  + Support for GlobalProtect IPv6 ([!155](https://gitlab.com/openconnect/openconnect/-/merge_requests/155) and [!188](https://gitlab.com/openconnect/openconnect/-/merge_requests/188); previous work in [d6db0ec](https://gitlab.com/openconnect/openconnect/commit/d6db0ec03394234d41fbec7ffc794ceeb486a8f0))
  + SIGUSR1 causes OpenConnect to log detailed connection information and statistics ([!154](https://gitlab.com/openconnect/openconnect/-/merge_requests/154))
  + Allow --servercert to be specified multiple times in order to accept server certificates matching more than one possible fingerprint ([!162](https://gitlab.com/openconnect/openconnect/-/merge_requests/162), [#25](https://gitlab.com/openconnect/openconnect/-/issues/25))
  + Add insecure debugging build mode for developers ([!112](https://gitlab.com/openconnect/openconnect/-/merge_requests/112))
  + Demangle default routes sent as split routes by GlobalProtect ([!118](https://gitlab.com/openconnect/openconnect/-/merge_requests/118))
  + Improve GlobalProtect login argument decoding ([!143](https://gitlab.com/openconnect/openconnect/-/merge_requests/143))
  + Add detection of authentication expiration date, intended to allow front-ends to cache and reuse authentication cookies/sessions ([!156](https://gitlab.com/openconnect/openconnect/-/merge_requests/156))
  + Small bug fixes and clarification of many logging messages.
  + Support more Juniper login forms, including some SSO forms ([!171](https://gitlab.com/openconnect/openconnect/-/merge_requests/171))
  + Automatically build Windows installers for OpenConnect command-line interface ([!176](https://gitlab.com/openconnect/openconnect/-/merge_requests/176))
  + Restore compatibility with newer Cisco servers, by no longer sending them the X-AnyConnect-Platform header ([#101](https://gitlab.com/openconnect/openconnect/-/issues/101), [!175](https://gitlab.com/openconnect/openconnect/-/merge_requests/175))
  + Add support for PPP-based protocols, currently over TLS only ([!165](https://gitlab.com/openconnect/openconnect/-/merge_requests/165)).
  + Add support for two PPP-based protocols, F5 with --protocol=f5 and Fortinet with --protocol=fortinet ([!169](https://gitlab.com/openconnect/openconnect/-/merge_requests/169)).
  + Add experimental support for [Wintun](https://www.wintun.net/) Layer 3 TUN driver under Windows ([#231](https://gitlab.com/openconnect/openconnect/-/issues/231), [!178](https://gitlab.com/openconnect/openconnect/-/merge_requests/178)).
  + Clean up and improve Windows routing/DNS configuration script ([vpnc-scripts!26](https://gitlab.com/openconnect/vpnc-scripts/-/merge_requests/26), [vpnc-scripts!41](https://gitlab.com/openconnect/vpnc-scripts/-/merge_requests/41), [vpnc-scripts!44](https://gitlab.com/openconnect/vpnc-scripts/-/merge_requests/44)).
  + On Windows, reclaim needed IP addresses from down network interfaces so that configuration script can succeed ([!178](https://gitlab.com/openconnect/openconnect/-/merge_requests/178)).
  + Fix output redirection under Windows ([#229](https://gitlab.com/openconnect/openconnect/-/issues/229))
  + More gracefully handle idle timeouts and other fatal errors for Juniper and Pulse ([!187](https://gitlab.com/openconnect/openconnect/-/merge_requests/187))
  + Ignore failures to fetch the Juniper/oNCP landing page if the authentication was successful ([3e779436](https://gitlab.com/openconnect/openconnect/-/commit/3e77943692b511719d9217d2ecc43588b7c6c08b)).
  + Add support for [Array Networks SSL VPN](https://arraynetworks.com/products-secure-access-gateways-ag-series.html) ([#102](https://gitlab.com/openconnect/openconnect/-/issues/102))
  + Support TLSv1.3 with TPMv2 EC and RSA keys, add test cases for swtpm and hardware TPM. ([ed80bfac...ee1cd782](https://gitlab.com/openconnect/openconnect/-/compare/ed80bfacf6baa17a6f5f4a5ec7e11aee541cba95...ee1cd782ab0d91d34785c81425ee27217a66d0aa))
  + Add openconnect\_get\_connect\_url() to simplify passing correct server information to the connecting openconnect process. *(NetworkManager-openconnect [#46](https://gitlab.gnome.org/GNOME/NetworkManager-openconnect/-/issues/46), [#53](https://gitlab.gnome.org/GNOME/NetworkManager-openconnect/-/issues/53))*
  + Disable brittle "system policy" enforcement where it cannot be gracefully overridden at user request. [*(RH#1960763)*](https://bugzilla.redhat.com/show_bug.cgi?id=1960763).
  + Pass "portal cookie" fields from GlobalProtect portal to gateway to avoid repetition of password- or SAML-based login ([!199](https://gitlab.com/openconnect/openconnect/-/merge_requests/199))
  + With --user, enter username supplied via command-line into all authentication forms, not just the first. ([#267](https://gitlab.com/openconnect/openconnect/-/issues/267), [!220](https://gitlab.com/openconnect/openconnect/-/merge_requests/220)).
  + Fix a subtle bug which has prevented ESP rekey and ESP-to-TLS fallback from working reliably with the Juniper/oNCP protocol since v8.04. ([#322](https://gitlab.com/openconnect/openconnect/-/issues/322), [!293](https://gitlab.com/openconnect/openconnect/-/merge_requests/293)).
  + Fix a bug in csd-wrapper.sh which has prevented it from correctly downloading compressed Trojan binaries since at least v8.00. ([!305](https://gitlab.com/openconnect/openconnect/-/merge_requests/305))
  + Make Windows socketpair emulation more robust in the face of Windows's ability to break its localhost routes. ([#228](https://gitlab.com/openconnect/openconnect/-/issues/228), [#361](https://gitlab.com/openconnect/openconnect/-/issues/361), [!320](https://gitlab.com/openconnect/openconnect/-/merge_requests/320))
  + Perform proper disconnect and routes cleanup on Windows when receiving Ctrl+C or Ctrl+Break. ([#362](https://gitlab.com/openconnect/openconnect/-/issues/362), [!323](https://gitlab.com/openconnect/openconnect/-/merge_requests/323))
  + Improve logging in routing/DNS configuration scripts. ([!328](https://gitlab.com/openconnect/openconnect/-/merge_requests/328), [vpnc-scripts!45](https://gitlab.com/openconnect/vpnc-scripts/-/merge_requests/45))
  + Support modified configuration packet from Pulse 9.1R14 servers ([#379](https://gitlab.com/openconnect/openconnect/-/issues/379), [!331](https://gitlab.com/openconnect/openconnect/-/merge_requests/331))
* **[OpenConnect v8.10](https://www.infradead.org/openconnect/download/openconnect-8.10.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.10.tar.gz.asc))* — 2020-05-14
  + Install bash completion script to ${datadir}/bash-completion/completions/openconnect.
  + Improve compatibility of csd-post.sh trojan.
  + Update Android build dependencies and bump API level to support Android 10.
  + Fix potential buffer overflow with GnuTLS describing local certs (CVE-2020-12823).
* **[OpenConnect v8.09](https://www.infradead.org/openconnect/download/openconnect-8.09.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.09.tar.gz.asc))* — 2020-04-29
  + Add bash completion support.
  + Give more helpful error in case of Pulse servers asking for TNCC.
  + Sanitize non-canonical Legacy IP network addresses ([!97](https://gitlab.com/openconnect/openconnect/merge_requests/97))
  + Fix OpenSSL validation for trusted but invalid certificates (CVE-2020-12105).
  + Convert tncc-wrapper.py to Python 3, and include modernized tncc-emulate.py as well. ([!91](https://gitlab.com/openconnect/openconnect/-/issues/91))
  + Disable [Nagle's algorithm](https://en.wikipedia.org/wiki/Nagle%27s_algorithm) for TLS sockets, to improve interactivity when tunnel runs over TCP rather than UDP. ([!89](https://gitlab.com/openconnect/openconnect/-/merge_requests/89)
  + GlobalProtect: more resilient handling of periodic HIP check and login arguments, and predictable naming of challenge forms
    ([!95](https://gitlab.com/openconnect/openconnect/-/merge_requests/95), [!93](https://gitlab.com/openconnect/openconnect/-/merge_requests/93/), [!90](https://gitlab.com/openconnect/openconnect/-/merge_requests/90))
  + Work around PKCS#11 tokens which forget to set CKF\_LOGIN\_REQUIRED ([#123](https://gitlab.com/openconnect/openconnect/issues/123)).
* **[OpenConnect v8.08](https://www.infradead.org/openconnect/download/openconnect-8.08.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.08.tar.gz.asc))* — 2020-04-06
  + Fix check of pin-sha256: public key hashes to be case sensitive ([#116](https://gitlab.com/openconnect/openconnect/issues/116)).
  + Don't give non-functioning stderr to CSD trojan scripts.
  + Fix crash with uninitialised OIDC token.
* **[OpenConnect v8.07](https://www.infradead.org/openconnect/download/openconnect-8.07.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.07.tar.gz.asc))* — 2020-04-04
  + Don't abort Pulse connection when server-provided certificate MD5 doesn't match.
  + Fix off-by-one in check for bad GnuTLS versions, and add build and run time checks.
  + Don't abort connection if CSD wrapper script returns non-zero (for now).
  + Make --passtos work for protocols that use ESP, in addition to DTLS.
  + Convert tncc-wrapper.py to Python 3, and include modernized tncc-emulate.py as well.
* **[OpenConnect v8.06](https://www.infradead.org/openconnect/download/openconnect-8.06.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.06.tar.gz.asc))* — 2020-03-31
  + Implement EAP-TTLS fragmentation.
  + Fix Windows build with MSYS2 ([#74](https://gitlab.com/openconnect/openconnect/issues/74)).
  + Allow custom stoken rcfile to be specified ([#71](https://gitlab.com/openconnect/openconnect/issues/71)).
  + Periodic HIP checking for GlobalProtect, and cross-protocol API ([!56](https://gitlab.com/openconnect/openconnect/merge_requests/56)).
  + Ciphersuite priority override options ([!71](https://gitlab.com/openconnect/openconnect/merge_requests/71)).
  + Clearer GlobalProtect debugging/SAML output ([!66](https://gitlab.com/openconnect/openconnect/merge_requests/66), [!69](https://gitlab.com/openconnect/openconnect/merge_requests/69)).
  + Explain experimental Pulse support for servers where Juniper oNCP is disabled ([!48](https://gitlab.com/openconnect/openconnect/merge_requests/48)).
  + Ignore missing Cisco CSD stub and simply CSD subprocess invocation ([!77](https://gitlab.com/openconnect/openconnect/merge_requests/77), [!74](https://gitlab.com/openconnect/openconnect/merge_requests/74)).
  + Pass IDLE\_TIMEOUT to vpnc-script ([!67](https://gitlab.com/openconnect/openconnect/merge_requests/67)).
  + Windows line-ending flexibility for standard input ([!78](https://gitlab.com/openconnect/openconnect/merge_requests/78)).
  + Disable DTLS for GnuTLS versions between 3.6.3 and 3.6.13 inclusive due to [GnuTLS #960](https://gitlab.com/gnutls/gnutls/-/issues/960).
  + Add RFC6750 Bearer token support ([!70](https://gitlab.com/openconnect/openconnect/-/merge_requests/70)).
* **[OpenConnect v8.05](https://www.infradead.org/openconnect/download/openconnect-8.05.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.05.tar.gz.asc))* — 2019-09-12
  + Fix GlobalProtect ESP stall ([!55](https://gitlab.com/openconnect/openconnect/merge_requests/55)).
  + Fix HTTP chunked encoding buffer overflow (CVE-2019-16239).
* **[OpenConnect v8.04](https://www.infradead.org/openconnect/download/openconnect-8.04.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.04.tar.gz.asc))* — 2019-08-09
  + Rework DTLS MTU detection. ([#10](https://gitlab.com/openconnect/openconnect/issues/10))
  + Add Pulse Connect Secure support.
  + OpenSSL build fixes ([!51](https://gitlab.com/openconnect/openconnect/merge_requests/51)).
  + Add HMAC-SHA256-128 (RFC4868) support for ESP.
  + Support IPv6 in ESP.
  + Translate user-visible strings from openconnect\_get\_supported\_protocols().
  + Fix proxy username/password handling to allow special characters and escaping.
* **[OpenConnect v8.03](https://www.infradead.org/openconnect/download/openconnect-8.03.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.03.tar.gz.asc))* — 2019-05-18
  + Fix detection of utun support on OS X ([#18](https://gitlab.com/openconnect/openconnect/issues/18)).
  + Fix Cisco DTLSv1.2 support for AES256-GCM-SHA384.
  + Fix Solaris 11.4 build by properly detecting memset\_s().
  + Fix recognition of OTP password fields ([#24](https://gitlab.com/openconnect/openconnect/issues/24)).
* **[OpenConnect v8.02](https://www.infradead.org/openconnect/download/openconnect-8.02.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.02.tar.gz.asc))* — 2019-01-16
  + Fix GNU/Hurd build.
  + Discover vpnc-script in default packaged location on FreeBSD/OpenBSD.
  + Support split-exclude routes for GlobalProtect.
  + Fix GnuTLS builds without libtasn1.
  + Fix DTLS support with OpenSSL 1.1.1+.
  + Add Cisco-compatible DTLSv1.2 support.
  + Invoke script with reason=attempt-reconnect before doing so.
* **[OpenConnect v8.01](https://www.infradead.org/openconnect/download/openconnect-8.01.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.01.tar.gz.asc))* — 2019-01-05
  + Fix memset\_s() arguments.
  + Fix OpenBSD build.
* **[OpenConnect v8.00](https://www.infradead.org/openconnect/download/openconnect-8.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-8.00.tar.gz.asc))* — 2019-01-05
  + Clear form submissions (which may include passwords) before freeing (CVE-2018-20319).
  + Allow form responses to be provided on command line.
  + Add support for SSL keys stored in [TPM2](tpm.html).
  + Fix ESP rekey when replay protection is disabled.
  + Drop support for GnuTLS older than 3.2.10.
  + Fix --passwd-on-stdin for Windows to not forcibly open console.
  + Fix portability of shell scripts in test suite.
  + Add Google Authenticator TOTP support for Juniper.
  + Add RFC7469 key PIN support for cert hashes.
  + Add protocol method to securely log out the Juniper session.
  + Relax requirements for Juniper hostname packet response to support old gateways.
  + Add API functions to query the supported protocols.
  + Verify ESP sequence numbers and warn even if replay protection is disabled.
  + Add support for Palo Alto Networks (PAN) GlobalProtect VPN protocol (--protocol=gp).
  + Reorganize listing of command-line options, and include information on supported protocols.
  + SIGTERM cleans up the session similarly to SIGINT.
* **[OpenConnect v7.08](https://www.infradead.org/openconnect/download/openconnect-7.08.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.08.tar.gz.asc))* — 2016-12-13
  + Add SHA256 support for server cert hashes.
  + Enable DHE ciphers for Cisco DTLS.
  + Increase initial oNCP configuration buffer size.
  + Reopen CONIN$ when stdin is redirected on Windows.
  + Improve support for point-to-point routing on Windows.
  + Check for non-resumed DTLS sessions which may indicate a MiTM attack.
  + Add TUNIDX environment variable on Windows.
  + Fix compatibility with Pulse Secure 8.2R5.
  + Fix IPv6 support in Solaris.
  + Support DTLS automatic negotiation.
  + Support --key-password for GnuTLS PKCS#11 PIN.
  + Support automatic DTLS MTU detection with OpenSSL.
  + Drop support for combined GnuTLS/OpenSSL build.
  + Update OpenSSL to allow TLSv1.2, improve compatibility options.
  + Remove --no-cert-check option. It was being (mis)used.
  + Fix OpenSSL support for PKCS#11 EC keys without public key.
  + Support for final OpenSSL 1.1 release.
  + Fix polling/retry on "tun" socket when buffers full.
  + Fix AnyConnect server-side MTU setting.
  + Fix ESP replay detection.
  + Allow build with LibreSSL *(for fetishists only; do not use this as DTLS is broken)*.
  + Add certificate torture test suite.
  + Support PKCS#11 PIN via pin-value= and --key-password for OpenSSL.
  + Fix integer overflow issues with ESP packet replay detection.
  + Add --pass-tos option as in OpenVPN.
  + Support rôle selection form in Juniper VPN.
  + Support DER-format certificates, add certificate format torture tests.
  + For OpenSSL >= 1.0.2, fix certificate validation when only an
    intermediate CA is specified with the --cafile option.
  + Support Juniper "Pre Sign-in Message".
* **[OpenConnect v7.07](https://www.infradead.org/openconnect/download/openconnect-7.07.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.07.tar.gz.asc))* — 2016-07-11
  + More fixes for OpenSSL 1.1 build.
  + Support Juniper "Post Sign-in Message".
  + Add --protocol option.
  + Fix ChaCha20-Poly1305 cipher suite to reflect final standard.
  + Add ability to disable IPv6 support via library API.
  + Set groups appropriately when using setuid().
  + Automatic DTLS MTU detection.
  + Support SSL client certificate authentication with Juniper servers.
  + Revamp SSL certificate validation for OpenSSL and stop supporting OpenSSL older than 0.9.8.
  + Fix handling of multiple DNS search domains with Network Connect.
  + Fix handling of large configuration packets for Network Connect.
  + Enable SNI when built with OpenSSL *(1.0.1g or later)*.
  + Add --resolve and --local-hostname options to command line.
* **[OpenConnect v7.06](https://www.infradead.org/openconnect/download/openconnect-7.06.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.06.tar.gz.asc))* — 2015-03-17
  + Fix openconnect.pc breakage after liboath removal.
  + Refactor Juniper Network Connect receive loop.
  + Fix some memory leaks.
  + Add Bosnian translation.
* **[OpenConnect v7.05](https://www.infradead.org/openconnect/download/openconnect-7.05.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.05.tar.gz.asc))* — 2015-03-10
  + Fix alignment issue which broke LZS compression on ARM etc.
  + Support HTTP authentication to servers, not just proxies.
  + Work around Yubikey [issue](https://forum.yubico.com/viewtopica454-3.html?f=26&t=1601) with non-ASCII passphrase set on pre-KitKat Android.
  + Add SHA256/SHA512 support for OATH.
  + Remove liboath dependency.
  + Support DTLS v1.2 and AES-GCM with OpenSSL 1.0.2.
  + Add OpenSSL 1.0.2 to known-broken releases ([RT#3703](http://rt.openssl.org/Ticket/Display.html?id=3703&user=guest&pass=guest),
    [RT#3711](http://rt.openssl.org/Ticket/Display.html?id=3711&user=guest&pass=guest)).
  + Fix build with OpenSSL HEAD *(OpenSSL 1.1.x).*
  + Preliminary support for Juniper SSL VPN.
* **[OpenConnect v7.04](https://www.infradead.org/openconnect/download/openconnect-7.04.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.04.tar.gz.asc))* — 2015-01-25
  + Change default behaviour to enable only stateless compression.
  + Add --compression argument and openconnect\_set\_compression\_mode().
  + Add support for LZS compression *(compatible with latest Cisco ASA and ocserv)*.
  + Add support for [LZ4](https://code.google.com/p/lz4/) compression *(compatible with ocserv)*.
* **[OpenConnect v7.03](https://www.infradead.org/openconnect/download/openconnect-7.03.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.03.tar.gz.asc))* — 2015-01-09
  + Android build infrastructure updates, including 64-bit support.
  + Clean up handling of incoming packets.
  + Fix issue with two-stage *(i.e. NetworkManager)* connection to servers with trick DNS [*(RH#1179681)*](https://bugzilla.redhat.com/show_bug.cgi?id=1179681).
  + Stop using static variables for received packets.
* **[OpenConnect v7.02](https://www.infradead.org/openconnect/download/openconnect-7.02.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.02.tar.gz.asc))* — 2014-12-19
  + Add PKCS#11 support for OpenSSL.
  + Fix handling of select options in openconnect\_set\_option\_value().
* **[OpenConnect v7.01](https://www.infradead.org/openconnect/download/openconnect-7.01.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.01.tar.gz.asc))* — 2014-12-07
  + Try harder to find a PKCS#11 key to match a given certificate.
  + Handle 'Connection: close' from proxies correctly.
  + Warn when MTU is set too low *(<1280)* to permit IPv6 connectivity.
  + Add support for X-CSTP-DynDNS, to trigger DNS lookup on each reconnect.
* **[OpenConnect v7.00](https://www.infradead.org/openconnect/download/openconnect-7.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-7.00.tar.gz.asc))* — 2014-11-27
  + Add support for GnuTLS 3.4 system: keys including Windows certificate store.
  + Add support for HOTP/TOTP keys from Yubikey NEO devices.
  + Add ---no-system-trust option to disable default certificate authorities.
  + Improve libiconv and libintl detection.
  + Stop calling setenv() from library functions.
  + Support utun driver on OS X.
  + Change library API so string ownership is never transferred.
  + Support new NDIS6 TAP-Windows driver shipped with OpenVPN 2.3.4.
  + Support using PSKC *([RFC6030](https://tools.ietf.org/html/rfc6030))* token files for HOTP/TOTP tokens.
  + Support for updating HOTP token storage when token is used.
  + Support for reading OTP token data from a file.
  + Add full [character set handling](charset.html) for legacy non-UTF8 systems *(including Windows)*.
  + Fix legacy *(i.e. not XML POST)* submission of non-ASCII form entries *(even in UTF-8 locales)*.
  + Add support for 32-bit Windows XP.
  + Avoid retrying without XML POST, when we failed to even reach the server.
  + Fix off-by-one in parameter substitution in error messages.
  + Improve reporting when GSSAPI auth requested but not compiled in.
  + Fix parsing of split include routes on Windows.
  + Fix crash on invocation with --token-mode but no --token-secret.
* **[OpenConnect v6.00](https://www.infradead.org/openconnect/download/openconnect-6.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-6.00.tar.gz.asc))* — 2014-07-08
  + Support SOCKS proxy authentication (password, GSSAPI).
  + Support HTTP proxy authentication (Basic, Digest, NTLM and GSSAPI).
  + Download XML profile in XML POST mode.
  + Fix a couple of bugs involving DTLS rekeying.
  + Fix problems seen when building or connecting without DTLS enabled.
  + Fix tun error handling on Windows hosts.
  + Skip password prompts when using PKCS#8 and PKCS#12 certificates with empty passwords.
  + Fix several minor memory leaks and error paths.
  + Update several Android dependencies, and make the download process more robust.
* **[OpenConnect v5.99](https://www.infradead.org/openconnect/download/openconnect-5.99.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-5.99.tar.gz.asc))* — 2014-03-05
  + Add [RFC4226](https://tools.ietf.org/html/rfc4226) HOTP token support.
  + Tolerate servers closing connection uncleanly after HTTP/1.0 response [*(Ubuntu #1225276)*](https://bugs.launchpad.net/bugs/1225276).
  + Add support for IPv6 split tunnel configuration.
  + Add Windows support with MinGW *(tested with both IPv6 and Legacy IP with latest [vpnc-script-win.js](https://git.infradead.org/users/dwmw2/vpnc-scripts.git/blob_plain/HEAD%3A/vpnc-script-win.js))*
  + Change library API to support updating the auth form when the authgroup is changed [*(Ubuntu #1229195)*](https://bugs.launchpad.net/bugs/1229195).
  + Change --os mac to --os mac-intel, to match the identifier used by Cisco clients.
  + Add new API functions to support invoking the VPN mainloop directly from an application.
  + Add JNI interface and sample Java application.
  + Fix junk in --cookieonly output when CSD is enabled.
  + Enable TOTP, stoken, and JNI support in the Android builds.
  + Add --pfs option to enforce perfect forward secrecy.
  + Enable elliptic curves with GnuTLS 3.2.9+, where there is a
    workaround for certain firewalls that fail with client hellos between
    256 and 512 bytes.
  + Add padding when sending password, to avoid leakage of password
    and username length.
  + Add support for DTLS 1.2 and AES-GCM when connecting to ocserv.
  + Add support for server name indication when compiled with GnuTLS
    3.2.9+.
* **[OpenConnect v5.03](https://www.infradead.org/openconnect/download/openconnect-5.03.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-5.03.tar.gz.asc))* — 2014-02-03
  + Fix crash on --authenticate due to freeing --cafile option in argv.
* **[OpenConnect v5.02](https://www.infradead.org/openconnect/download/openconnect-5.02.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-5.02.tar.gz.asc))* — 2014-01-01
  + Fix XML POST issues with authgroups by falling back to old style login.
  + Fix --cookie-on-stdin with cookies from ocserv.
  + Fix reconnection to wrong host after redirect.
  + Reduce limit of queued packets on DTLS socket, to fix VoIP latency.
  + Fix Solaris build breakage due to missing <string.h> includes.
  + Include path in <group-access> node.
  + Include supporting CA certificates from PKCS#11 tokens *(with GnuTLS 3.2.7+)*.
  + Fix possible heap overflow if MTU is increased on reconnection (CVE-2013-7098).
* **[OpenConnect v5.01](https://www.infradead.org/openconnect/download/openconnect-5.01.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-5.01.tar.gz.asc))* — 2013-06-01
  + Attempt to handle <client-cert-request> in aggregate auth mode.
  + Don't include X-Aggregate-Auth: header in fallback mode.
  + Enable AES256 mode for DTLS with GnuTLS [*(RH#955710)*](https://bugzilla.redhat.com/show_bug.cgi?id=955710).
  + Add --dump-http-traffic option for debugging.
  + Be more permissive in parsing XML forms.
  + Use original URL when falling back to non-XML POST mode.
  + Add --no-xmlpost option to revert to older, compatible behaviour.
  + Close connection before falling back to non-xmlpost mode [*(RH#964650)*](https://bugzilla.redhat.com/show_bug.cgi?id=964650).
  + Improve error handling when server closes connection [*(Debian #708928)*](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=708928).
* **[OpenConnect v5.00](https://www.infradead.org/openconnect/download/openconnect-5.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-5.00.tar.gz.asc))* — 2013-05-15
  + Use GnuTLS by default instead of OpenSSL.
  + Avoid using deprecated gnutls\_pubkey\_verify\_data() function.
  + Fix compatibility issues with XML POST authentication.
  + Fix memory leaks on realloc() failure.
  + Fix certificate validation problem caused by hostname canonicalisation.
  + Add [RFC6238](https://tools.ietf.org/html/rfc6238) TOTP token support using [liboath](https://www.nongnu.org/oath-toolkit/).
  + Replace --stoken option with more generic --token-mode and --token-secret options.
* **[OpenConnect v4.99](https://www.infradead.org/openconnect/download/openconnect-4.99.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.99.tar.gz.asc))* — 2013-02-07
  + Add --os switch to report a different OS type to the gateway.
  + Support new XML POST format.
  + Add SecurID token support using [libstoken](http://stoken.sf.net/).
* **[OpenConnect v4.08](https://www.infradead.org/openconnect/download/openconnect-4.08.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.08.tar.gz.asc))* — 2013-02-13
  + Fix overflow on HTTP request buffers (CVE-2012-6128)
  + Fix connection to servers with round-robin DNS with two-stage auth/connect.
  + Impose minimum MTU of 1280 bytes.
  + Fix some harmless issues reported by Coverity.
  + Improve "Attempting to connect..." message to be explicit when it's connecting to a proxy.
* **[OpenConnect v4.07](https://www.infradead.org/openconnect/download/openconnect-4.07.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.07.tar.gz.asc))* — 2012-08-31
  + Fix segmentation fault when invoked with -p argument.
  + Fix handling of write stalls on CSTP (TCP) socket.
* **[OpenConnect v4.06](https://www.infradead.org/openconnect/download/openconnect-4.06.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.06.tar.gz.asc))* — 2012-07-23
  + Fix default CA location for non-Fedora systems with old GnuTLS.
  + Improve error handing when vpnc-script exits with error.
  + Handle PKCS#11 tokens which won't list keys without login.
* **[OpenConnect v4.05](https://www.infradead.org/openconnect/download/openconnect-4.05.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.05.tar.gz.asc))* — 2012-07-12
  + Use correct CSD script for Mac OS X.
  + Fix endless loop in PIN cache handling with multiple PKCS#11 tokens.
  + Fix PKCS#11 URI handling to preserve all attributes.
  + Don't forget key password on GUI reconnect.
  + Fix GnuTLS v3 build on OpenBSD.
* **[OpenConnect v4.04](https://www.infradead.org/openconnect/download/openconnect-4.04.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.04.tar.gz.asc))* — 2012-07-05
  + Fix GnuTLS password handling for PKCS#8 files.
* **[OpenConnect v4.03](https://www.infradead.org/openconnect/download/openconnect-4.03.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.03.tar.gz.asc))* — 2012-07-02
  + Fix --no-proxy option.
  + Fix handling of requested vs. received MTU settings.
  + Fix DTLS MTU for GnuTLS 3.0.21 and newer.
  + Support more ciphers for OpenSSL encrypted PEM keys, with GnuTLS.
  + Fix GnuTLS compatibility issue with servers that insist on TLSv1.0 or non-AES ciphers [*(RH#836558)*](https://bugzilla.redhat.com/show_bug.cgi?id=836558).
* **[OpenConnect v4.02](https://www.infradead.org/openconnect/download/openconnect-4.02.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.02.tar.gz.asc))* — 2012-06-28
  + Fix build failure due to unconditional inclusion of <gnutls/dtls.h>.
* **[OpenConnect v4.01](https://www.infradead.org/openconnect/download/openconnect-4.01.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.01.tar.gz.asc))* — 2012-06-28
  + Fix DTLS MTU issue with GnuTLS.
  + Fix reconnect crash when compression is disabled.
  + Fix build on systems like FreeBSD 8 without O\_CLOEXEC.
  + Add --dtls-local-port option.
  + Print correct error when /dev/net/tun cannot be opened.
  + Fix openconnect.pc pkg-config file not to require zlib.pc on systems which lack it (like RHEL5).
* **[OpenConnect v4.00](https://www.infradead.org/openconnect/download/openconnect-4.00.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-4.00.tar.gz.asc))* — 2012-06-20
  + Add support for OpenSSL's odd encrypted PKCS#1 files, for GnuTLS.
  + Fix repeated passphrase retry for OpenSSL.
  + Add keystore support for Android.
  + Support TPM, and also additional checks on PKCS#11 certs, even with GnuTLS 2.12.
  + Fix library references to OpenSSL's ERR\_print\_errors\_cb() when built against GnuTLS v2.12.
* **[OpenConnect v3.99](https://www.infradead.org/openconnect/download/openconnect-3.99.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.99.tar.gz.asc))* — 2012-06-13
  + Enable native TPM support when built with GnuTLS.
  + Enable PKCS#11 token support when built with GnuTLS.
  + Eliminate all SSL library exposure through libopenconnect.
  + Parse split DNS information, provide $CISCO\_SPLIT\_DNS environment variable to vpnc-script.
  + Attempt to provide new-style MTU information to server *(on Linux only, unless specified on command line)*.
  + Allow building against GnuTLS, including DTLS support.
  + Add --with-pkgconfigdir= option to configure for FreeBSD's benefit *[(fd#48743)](https://bugs.freedesktop.org/show_bug.cgi?id=48743)*.
* **[OpenConnect v3.20](https://www.infradead.org/openconnect/download/openconnect-3.20.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.20.tar.gz.asc))* — 2012-05-18
  + Cope with non-keepalive HTTP response on authentication success.
  + Fix progress callback with incorrect cbdata which caused KDE crash.
* **[OpenConnect v3.19](https://www.infradead.org/openconnect/download/openconnect-3.19.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.19.tar.gz.asc))* — 2012-05-17
  + Add --config option for reading options from file.
  + Improve OpenSSL DTLS compatibility to work on Ubuntu 10.04.
  + Flush progress logging output promptly after each message.
  + Add symbol versioning for shared library (on sane platforms).
  + Add openconnect\_set\_cancel\_fd() function to allow clean cancellation.
  + Fix corruption of URL in openconnect\_parse\_url() if it specifies a port number.
  + Fix inappropriate exit() calls from library code.
  + Library namespace cleanup — all symbols now have the prefix openconnect\_ on platforms where symbol versioning works.
  + Fix --non-inter option so it still uses login information from command line.
* **[OpenConnect v3.18](https://www.infradead.org/openconnect/download/openconnect-3.18.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.18.tar.gz.asc))* — 2012-04-25
  + Fix autohate breakage with --disable-nls... hopefully.
  + Fix buffer overflow in banner handling.
* **[OpenConnect v3.17](https://www.infradead.org/openconnect/download/openconnect-3.17.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.17.tar.gz.asc))* — 2012-04-20
  + Work around time() brokenness on Solaris.
  + Fix interface plumbing on Solaris 10.
  + Provide asprintf() function for (unpatched) Solaris 10.
  + Make vpnc-script mandatory, like it is for vpnc
  + Don't set Legacy IP address on tun device; let vpnc-script do it.
  + Detect OpenSSL even without pkg-config.
  + Stop building static library by default.
  + Invoke vpnc-script with "pre-init" reason to load tun module if necessary.
* **[OpenConnect v3.16](https://www.infradead.org/openconnect/download/openconnect-3.16.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.16.tar.gz.asc))* — 2012-04-08
  + Fix build failure on Debian/kFreeBSD and Hurd.
  + Fix memory leak of deflated packets.
  + Fix memory leak of zlib state on CSTP reconnect.
  + Eliminate memcpy() calls on packets from DTLS and tunnel device.
  + Use I\_LINK instead of I\_PLINK on Solaris to plumb interface for Legacy IP.
  + Plumb interface for IPv6 on Solaris, instead of expecting vpnc-script to do it.
  + Refer to [vpnc-script](vpnc-script.html) and [help](mail.html) web pages in openconnect output.
  + Fix potential crash when processing libproxy results.
  + Be more conservative in detecting libproxy without pkg-config.
* **[OpenConnect v3.15](https://www.infradead.org/openconnect/download/openconnect-3.15.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.15.tar.gz.asc))* — 2011-11-25
  + Fix for reading multiple packets from Solaris tun device.
  + Call bindtextdomain() to ensure that translations are found in install path.
* **[OpenConnect v3.14](https://www.infradead.org/openconnect/download/openconnect-3.14.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.14.tar.gz.asc))* — 2011-11-08
  + Move executable to $prefix/sbin.
  + Fix build issues on OSX, OpenIndiana, DragonFlyBSD, OpenBSD, FreeBSD & NetBSD.
  + Fix non-portable (void \*) arithmetic.
  + Make more messages translatable.
  + Attempt to make NLS support more portable (with fewer dependencies).
* **[OpenConnect v3.13](https://www.infradead.org/openconnect/download/openconnect-3.13.tar.gz)**
  *([PGP signature](https://www.infradead.org/openconnect/download/openconnect-3.13.tar.gz.asc))* — 2011-09-30
  + Add --cert-expire-warning option.
  + Give visible warning when server dislikes client SSL certificate.
  + Add localisation support.
  + Fix build on Debian systems where dtls1\_stop\_timer() is not available.
  + Fix libproxy detection.
  + Enable a useful set of compiler warnings by default.
  + Fix various minor compiler warnings.
* **[OpenConnect v3.12](https://www.infradead.org/openconnect/download/openconnect-3.12.tar.gz)** — 2011-09-12
  + Fix DTLS compatibility with ASA firmware 8.4.1(11) and above.
  + Fix build failures on GNU Hurd, on systems with ancient OpenSSL,
    and on Debian.
  + Add --pid-file option.
  + Print SHA1 fingerprint with server certificate details.
* **[OpenConnect v3.11](https://www.infradead.org/openconnect/download/openconnect-3.11.tar.gz)** — 2011-07-20
  + Add Android.mk file for Android build support
  + Add logging support for Android, in place of standard syslog().
  + Switch back to using TLSv1, but without extensions.
  + Make TPM support optional, dependent on OpenSSL ENGINE support.
* **[OpenConnect v3.10](https://www.infradead.org/openconnect/download/openconnect-3.10.tar.gz)** — 2011-06-30
  + Switch to using GNU autoconf/automake/libtool.
  + Produce shared library for authentication.
  + Improve library API to make life easier for C++ users.
  + Be more explicit about requiring pkg-config.
  + Invoke script with reason=reconnect on CSTP reconnect.
  + Add --non-inter option to avoid all user input.
* **[OpenConnect v3.02](https://www.infradead.org/openconnect/download/openconnect-3.02.tar.gz)** — 2011-04-19
  + Install man page in make install target.
  + Add openconnect\_vpninfo\_free() to libopenconnect.
  + Clear cached peer\_addr to avoid reconnecting to wrong host.
* **[OpenConnect v3.01](https://www.infradead.org/openconnect/download/openconnect-3.01.tar.gz)** — 2011-03-09
  + Add libxml2 to pkg-config requirements.
* **[OpenConnect v3.00](https://www.infradead.org/openconnect/download/openconnect-3.00.tar.gz)** — 2011-03-09
  + Create libopenconnect.a for GUI authentication dialog to use.
  + Remove auth-dialog, which now lives in the [network-manager-openconnect](https://gitlab.gnome.org/GNOME/NetworkManager-openconnect) package.
  + Cope with more entries in authentication forms.
  + Add --csd-wrapper option to wrap CSD trojan.
  + Report error and abort if CA file cannot be opened.
* **[OpenConnect v2.26](https://www.infradead.org/openconnect/download/openconnect-2.26.tar.gz)** — 2010-09-22
  + Fix potential crash on relative HTTP redirect.
  + Use correct TUN/TAP device node on Android.
  + Check client certificate expiry date.
  + Implement CSTP and DTLS rekeying *(both by reconnecting CSTP)*.
  + Add --force-dpd option to set minimum DPD interval.
  + Don't print webvpn cookie in debug output.
  + Fix host selection in NetworkManager auth dialog.
  + Use SSLv3 instead of TLSv1; some servers *(or their firewalls)*
    don't accept any ClientHello options.
  + Never include address family prefix on script-tun connections.
* **[OpenConnect v2.25](https://www.infradead.org/openconnect/download/openconnect-2.25.tar.gz)** — 2010-05-15
  + Always validate server certificate, even when no extra --cafile is provided.
  + Add --no-cert-check option to avoid certificate validation.
  + Check server hostname against its certificate.
  + Provide text-mode function for reviewing and accepting "invalid" certificates.
  + Fix libproxy detection on NetBSD.
* **[OpenConnect v2.24](https://www.infradead.org/openconnect/download/openconnect-2.24.tar.gz)** — 2010-05-07
  + Forget preconfigured password after a single attempt; don't retry infinitely if it's failing.
  + Set $CISCO\_BANNER environment variable when running script.
  + Better handling of passphrase failure on certificate files.
  + Fix NetBSD build (thanks to Pouya D. Tafti).
  + Fix DragonFly BSD build.
* **[OpenConnect v2.23](https://www.infradead.org/openconnect/download/openconnect-2.23.tar.gz)** — 2010-04-09
  + Support "Cisco Secure Desktop" trojan in NetworkManager auth-dialog.
  + Support proxy in NetworkManager auth-dialog.
  + Add --no-http-keepalive option to work around Cisco's incompetence.
  + Fix build on Debian/kFreeBSD.
  + Fix crash on receiving HTTP 404 error.
  + Improve workaround for server certificates lacking SSL\_SERVER purpose, so that it also works with OpenSSL older than 0.9.8k.
* **[OpenConnect v2.22](https://www.infradead.org/openconnect/download/openconnect-2.22.tar.gz)** — 2010-03-07
  + Fix bug handling port numbers above 9999.
  + Ignore "Connection: Keep-Alive" in HTTP/1.0 to work around server bug with certificate authentication.
  + Handle non-standard port (and full URLs) when used with NetworkManager.
  + Cope with relative redirect and form URLs.
  + Allocate HTTP receive buffer dynamically, to cope with arbitrary size of content.
  + Fix server cert SHA1 comparison to be case-insensitive.
  + Fix build on Solaris and OSX *(strndup(), AI\_NUMERICSERV).*
  + Fix exit code with --background option.
* **[OpenConnect v2.21](https://www.infradead.org/openconnect/download/openconnect-2.21.tar.gz)** — 2010-01-10
  + Fix handling of HTTP 1.0 responses with keepalive [*(RH#553817)*](https://bugzilla.redhat.com/show_bug.cgi?id=553817).
  + Fix case sensitivity in HTTP headers and hostname comparison on redirect.
* **[OpenConnect v2.20](https://www.infradead.org/openconnect/download/openconnect-2.20.tar.gz)** — 2010-01-04
  + Fix use-after-free bug in NetworkManager authentication dialog [*(RH#551665)*](https://bugzilla.redhat.com/show_bug.cgi?id=551665).
  + Allow server to be specified with https:// URL, including port and pathname (which Cisco calls 'UserGroup')
  + Support connection through HTTP and SOCKS proxies.
  + Handle HTTP redirection with port numbers.
  + Handle HTTP redirection with IPv6 literal addresses.
* **[OpenConnect v2.12](https://www.infradead.org/openconnect/download/openconnect-2.12.tar.gz)** — 2009-12-07
  + Fix buffer overflow when generating useragent string.
  + Cope with idiotic schizoDNS configurations by not repeating DNS lookup for VPN server on reconnects.
  + Support DragonFlyBSD. Probably.
* **[OpenConnect v2.11](https://www.infradead.org/openconnect/download/openconnect-2.11.tar.gz)** — 2009-11-17
  + Add IPv6 support for FreeBSD.
  + Support "split tunnel" mode for IPv6 routing.
  + Fix bug where client certificate's MD5 was only given to the
    CSD trojan if a PKCS#12 certificate was used.
* **[OpenConnect v2.10](https://www.infradead.org/openconnect/download/openconnect-2.10.tar.gz)** — 2009-11-04
  + OpenSolaris support.
  + Preliminary support for IPv6 connectivity.
  + Fix session shutdown on exit.
  + Fix reconnection when TCP connection is closed.
  + Support for "Cisco Secure Desktop" idiocy.
  + Allow User-Agent: to be specified on command line.
  + Fix session termination on disconnect.
  + Fix recognition of certificates from OpenSSL 1.0.0.
* **[OpenConnect v2.01](https://www.infradead.org/openconnect/download/openconnect-2.01.tar.gz)** — 2009-06-24
  + Fix bug causing loss of DTLS (and lots of syslog spam about it)
    after a CSTP reconnection.
  + Don't apply OpenSSL certificate chain workaround if we already
    have "extra" certificates loaded (e.g. from a PKCS#12 file).
  + Load "extra" certificates from .pem files too.
  + Fix SEGV caused by freeing certificates after processing cert
    chain.
* **[OpenConnect v2.00](https://www.infradead.org/openconnect/download/openconnect-2.00.tar.gz)** — 2009-06-03
  + Add OpenBSD and FreeBSD support.
  + Build with OpenSSL-0.9.7 (Mac OS X, OpenBSD, etc.)
  + Support PKCS#12 certificates.
  + Automatic detection of certificate type (PKCS#12, PEM, TPM).
  + Work around OpenSSL trust chain issues ([RT#1942](http://rt.openssl.org/Ticket/Display.html?id=1942&user=guest&pass=guest)).
  + Allow PEM passphrase to be specified on command line.
  + Allow PEM passphrase automatically generated from the fsid of the file system on which the certificate is stored.
  + Fix certificate comparisons (in NM auth-dialog and --servercert option) to use SHA1 fingerprint, not signature.
  + Fix segfault in NM auth-dialog when changing hosts.
* **[OpenConnect v1.40](https://www.infradead.org/openconnect/download/openconnect-1.40.tar.gz)** — 2009-05-27
  + Fix validation of server's SSL certificate when NetworkManager runs openconnect as an unprivileged user (which can't read the real user's trust chain file).
  + Fix double-free of DTLS Cipher option on reconnect.
  + Reconnect on SSL write errors
  + Fix reporting of SSL errors through syslog/UI.
* **[OpenConnect v1.30](https://www.infradead.org/openconnect/download/openconnect-1.30.tar.gz)** — 2009-05-13
  + NetworkManager auth-dialog will now cache authentication form options.
* **[OpenConnect v1.20](https://www.infradead.org/openconnect/download/openconnect-1.20.tar.gz)** — 2009-05-08
  + DTLS cipher choice fixes.
  + Improve handling of authentication group selection.
  + Export more information to connection script.
  + Add --background option to dæmonize after connection.
  + Detect TCP connection closure.
* **[OpenConnect v1.10](https://www.infradead.org/openconnect/download/openconnect-1.10.tar.gz)** — 2009-04-01
  + NetworkManager UI rewrite with many improvements.
  + Support for "UserGroups" where a single server offers multiple
    configurations according to the URL used to connect.
* **[OpenConnect v1.00](https://www.infradead.org/openconnect/download/openconnect-1.00.tar.gz)** — 2009-03-18
  + First non-beta release.



=== Content from bugs.mageia.org_3c04690e_20250126_022544.html ===


Mageia Bugzilla – Bug 9083
openconnect new security issue CVE-2012-6128
Last modified: 2013-02-21 22:02:27 CET

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=9083&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 9083**](show_bug.cgi?id=9083)
- openconnect new security issue CVE-2012-6128

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
openconnect new security issue CVE-2012-6128

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/538436/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | has\_procedure mga2-64-ok mga2-32-ok | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2013-02-15 22:22 CET by David Walser | | --- | --- | | Modified: | 2013-02-21 22:02 CET ([History](show_activity.cgi?id=9083)) | | CC List: | 2 users (show)  sysadmin-bugs tmb | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | openconnect-3.15-2.1.mga2.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=9083&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=9083#c0)  David Walser    2013-02-15 22:22:28 CET  ``` Debian has issued an advisory on February 14: <http://www.debian.org/security/2013/dsa-2623>  Patched packages uploaded for Mageia 2 and Cauldron.  Advisory: ========================  Updated openconnect packages fix security vulnerability:  A stack-based buffer overflow flaw was found in the way OpenConnect, a client for Cisco's "AnyConnect" VPN, performed processing of certain host names, paths, or cookie lists, received from the VPN gateway. A remote VPN gateway could provide a specially-crafted host name, path or cookie list that, when processed by the openconnect client would lead to openconnect executable crash (CVE-2012-6128).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6128> <https://bugzilla.redhat.com/show_bug.cgi?id=910330> <http://www.debian.org/security/2013/dsa-2623> ========================  Updated packages in core/updates_testing: ======================== openconnect-3.15-2.2.mga2 libopenconnect1-3.15-2.2.mga2 libopenconnect-devel-3.15-2.2.mga2  from openconnect-3.15-2.2.mga2.src.rpm ```  [Comment 1](show_bug.cgi?id=9083#c1)  claire robinson    2013-02-18 12:51:48 CET  ``` "The program openconnect connects to Cisco "AnyConnect" VPN servers"   Expecting the connection to fail as it's attempting to connect to apache. Just testing with..  # openconnect -v localhost Attempting to connect to 127.0.0.1:443 SSL negotiation with localhost Server certificate verify failed: self signed certificate  Certificate from VPN server "localhost" failed verification. Reason: self signed certificate Enter 'yes' to accept, 'no' to abort; anything else to view: yes Connected to HTTPS on localhost GET <https://localhost/> Got HTTP response: HTTP/1.1 200 OK Date: Mon, 18 Feb 2013 11:21:04 GMT Server: Apache/2.2.23 (Mageia/PREFORK-1.mga2) Last-Modified: Wed, 02 May 2012 21:31:48 GMT ETag: "xxxxx-xx-xxxxxxxxxx" Accept-Ranges: bytes Content-Length: 131 Content-Type: text/html HTTP body length:  (131) Unknown response from server Failed to obtain WebVPN cookie  Testing complete mga2 64 ```  ---   Whiteboard: (none) => has\_procedure mga2-64-ok  [Comment 2](show_bug.cgi?id=9083#c2)  David Walser    2013-02-18 14:43:24 CET  ``` The patch for this is pretty invasive, so if we could find someone with access to a VPN server to test that this actually works, that would be good. ```  [Comment 3](show_bug.cgi?id=9083#c3)  claire robinson    2013-02-18 16:36:11 CET  ``` Do you know of anyone? ```  [Comment 4](show_bug.cgi?id=9083#c4)  claire robinson    2013-02-18 17:01:08 CET  ``` Tested with a url found on redhat bugzilla  # openconnect -v vpn.playdom.com  Connects ok, answering yes to accept the self signed cert and only fails user authentication, due to not having a valid login. ```  [Comment 5](show_bug.cgi?id=9083#c5)  claire robinson    2013-02-18 18:11:45 CET  ``` Tested ok mga2 32  Validating  Advisory & srpm in [comment 0](show_bug.cgi?id=9083#c0)  Could sysadmin please push from core/updates_testing to core/updates  Thanks! ```  ---   Keywords: (none) => validated\_updateCC: (none) => sysadmin-bugsWhiteboard: has\_procedure mga2-64-ok => has\_procedure mga2-64-ok mga2-32-ok  [Comment 6](show_bug.cgi?id=9083#c6)  Thomas Backlund    2013-02-21 22:02:27 CET  ```  Update pushed: <https://wiki.mageia.org/en/Support/Advisories/MGASA-2013-0060> ```  ---   Status: NEW => RESOLVEDCC: (none) => tmbResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=9083&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=9083)
* - [XML](show_bug.cgi?ctype=xml&id=9083)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=9083&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=9083&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from www.debian.org_2a04f3c7_20250124_165948.html ===


---

[[Date Prev](msg00027.html)][[Date Next](msg00029.html)]
[[Thread Prev](msg00027.html)][[Thread Next](msg00029.html)]
[[Date Index](maillist.html#00028)]
[[Thread Index](threads.html#00028)]

# [SECURITY] [DSA 2623-1] openconnect security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2623-1] openconnect security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Thu, 14 Feb 2013 18:19:57 +0100
* *Message-id*: <[[🔎]](/msgid-search/87ehgiersy.fsf%40mid.deneb.enyo.de) [87ehgiersy.fsf@mid.deneb.enyo.de](msg00028.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2623-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
February 14, 2013                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : openconnect
Vulnerability  : buffer overflow
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-6128

Kevin Cernekee discovered that a malicious VPN gateway can send
crafted responses which trigger stack-based buffer overflows.

For the stable distribution (squeeze), this problem has been fixed in
version 2.25-0.1+squeeze2.

We recommend that you upgrade your openconnect packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJRHR74AAoJEL97/wQC1SS+bb0IAJJsKIsF5yBv9kDifVeGbvpR
no4jMiqZpNbMvOD7lEqXkXCcdtKHhDiNrp1qUkj1qj0HAvHvYDW4MybIpcTTrzTr
Jh1qYmtdkF0zr7/4JYEc1zLdPy4ZdfkHppAMI1Tk4jR5qBhavhtNs8cZ4aJmhVTO
hel8O2mkTMSgUdsA7ig4TL7LuuvRSeA/Hd5AwinXjT5vCpBzPH0GlIWPoCiQoL5T
sK4C1Y5dVUEMyVn3MQVoKYzs3FS8Gys1iPVmUVAw9sh94oXAXEsj6KkShsuqG2ri
SS67oYeBo1xYkzW25uVTnQndZQqLQtAaSZ7ai9csEeGNHAhkv9VizxhvhGZX1q8=
=/dNn
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_cf70351d_20250124_165952.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](../../../2013/02/13/1) [[<thread-prev]](../../../2013/02/11/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <511AB410.9040504@redhat.com>
Date: Tue, 12 Feb 2013 14:28:48 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Florian Weimer <fw@...eb.enyo.de>, Mike Miller <mtmiller@...e.org>
Subject: Re: CVE request: openconnect buffer overflow

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/11/2013 12:52 PM, Florian Weimer wrote:
> Kevin Cernekee discovered that a malicious VPN gateway can send a
> very long hostname/path (for redirects) or cookie list (in
> general), which OpenConnect will attempt to write on a fixed length
> buffer.
>
> Upstream commit:
>
> <<http://git.infradead.org/users/dwmw2/openconnect.git/commitdiff/26f752c3dbf69227679fc6bebb4ae071aecec491>>
>
>  This needs a CVE name from 2012.

Please use CVE-2012-6128 for this issue.

It should be noted that this can be executed by a man in the middle
attacker (which is exactly why you're using a VPN Usually =).

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRGrQQAAoJEBYNRVNeJnmTPGwQAINZYQzKx4N77zOpEqm7iHWI
kJV82S4bRs44X8aavpZjndxlaPG21W2pxciS52cVMd6He5nL3dEi6ftXayIeSYWy
deQ15soD0+/oGPOq76u0Mql4D+tCrS+/U75X0jwY9RsdcOso47Bm+zQnVgYuvxBh
AdnyB3MFxk1VGilt+jdKoys3P1Vj9Wsgq0rJ9UN1+aVu7McVndc8Y19ZjTXMIYHi
6z9buUz88mVCzTTDcgq3m/4/ikOeOIgRjpBV1/xpdffj/Vixws0K8a9lHO6McJ+5
WYZtQ2V8NgEeq6D0zZtgqDpasee/sVQYAtDgmFerItVFdTqQcyc7CPtqN4TZUkcH
SCRabgE8XQ9sw7Umop7lyG2H+fhM6LmYwdWSq4hqeOGrehceYDv6/e0BWd0+pp2d
daNcV+beaFg5+b/ndbVF+KqFgcAUSAtz7zrP5uagoJdY+T1eYVl0fPb+wibgCfUE
vxkRTt1/Y2sKGm/L83fSW87suflYWF0qbntcpu8BZBLyI/V2F3rTn8LRK30Ca9dO
tWXJ9c8OyDRFwtHHdTzETVr6gsKvFTin5qzjgheWmKPLQm+k8uRiGvezWbEGQ9ct
8sjIFZqcWk3bPUnBTPjQfJGYvquG4OIW0liGfolaA6YPUG8kAc0pmX/c0/LzURIH
7wgL41jESIpDLC3zRouv
=5wZF
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.novell.com_b454ec4d_20250126_022549.html ===




=== Content from wiki.mageia.org_5232df9c_20250124_165952.html ===

# [Wiki](/en/) » Support/Advisories/MGASA-2013-0060

From Mageia wiki

Jump to: [navigation](#mw-head), [search](#p-search)

## MGASA-2013-0060

| **Date:** | February 21st, 2013 |
| --- | --- |
| **Affected releases:** | 2 |
| **Media:** | Core |

**Description:**

Updated openconnect packages fix security vulnerability:

A stack-based buffer overflow flaw was found in the way OpenConnect, a

client for Cisco's "AnyConnect" VPN, performed processing of certain

host names, paths, or cookie lists, received from the VPN gateway.

A remote VPN gateway could provide a specially-crafted host name, path

or cookie list that, when processed by the openconnect client would lead

to openconnect executable crash (CVE-2012-6128).

**Updated Packages:**

i586:

libopenconnect1-3.15-2.2.mga2.i586.rpm

libopenconnect-devel-3.15-2.2.mga2.i586.rpm

openconnect-3.15-2.2.mga2.i586.rpm

openconnect-debug-3.15-2.2.mga2.i586.rpm

x86\_64:

lib64openconnect1-3.15-2.2.mga2.x86\_64.rpm

lib64openconnect-devel-3.15-2.2.mga2.x86\_64.rpm

openconnect-3.15-2.2.mga2.x86\_64.rpm

openconnect-debug-3.15-2.2.mga2.x86\_64.rpm

SRPMS:

openconnect-3.15-2.2.mga2.src.rpm

**References:**

<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6128>

<https://bugzilla.redhat.com/show_bug.cgi?id=910330>

<http://www.debian.org/security/2013/dsa-2623>

<https://bugs.mageia.org/show_bug.cgi?id=9083>

Retrieved from "<https://wiki.mageia.org/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&oldid=14602>"

## Navigation menu

### Personal tools

* [Log in](/mw-en/index.php?title=Special:UserLogin&returnto=Support%2FAdvisories%2FMGASA-2013-0060 "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/en/Support/Advisories/MGASA-2013-0060 "View the content page [c]")
* [Discussion](/mw-en/index.php?title=Talk:Support/Advisories/MGASA-2013-0060&action=edit&redlink=1 "Discussion about the content page [t]")

### Variants

### Views

* [Read](/en/Support/Advisories/MGASA-2013-0060)
* [View source](/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&action=history "Past revisions of this page [h]")

### More

### Search

### Navigation

* [Main page](/en/Main_Page "Visit the main page [z]")
* [Documentation](/en/Documentation)
* [Community portal](/en/Mageia_wiki%3ACommunity_portal "About the project, what you can do, where to find things")
* [Current events](/en/Mageia_wiki%3ACurrent_events "Find background information on current events")
* [Recent changes](/en/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/en/Special%3ARandom "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

### Tools

* [What links here](/en/Special%3AWhatLinksHere/Support/Advisories/MGASA-2013-0060 "A list of all wiki pages that link here [j]")
* [Related changes](/en/Special%3ARecentChangesLinked/Support/Advisories/MGASA-2013-0060 "Recent changes in pages linked from this page [k]")
* [Special pages](/en/Special%3ASpecialPages "A list of all special pages [q]")
* [Printable version](/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&printable=yes "Printable version of this page [p]")
* [Permanent link](/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&oldid=14602 "Permanent link to this revision of the page")
* [Page information](/mw-en/index.php?title=Support/Advisories/MGASA-2013-0060&action=info "More information about this page")

* This page was last edited on 21 February 2013, at 19:56.
* Content is available under [Creative Commons - Attribution-ShareAlike 3.0 Unported](https://creativecommons.org/licenses/by-sa/3.0/) unless otherwise noted.

* [Privacy policy](/en/Mageia_wiki%3APrivacy_policy "Mageia wiki:Privacy policy")
* [About Mageia wiki](/en/Mageia_wiki%3AAbout "Mageia wiki:About")
* [Disclaimers](/en/Mageia_wiki%3AGeneral_disclaimer "Mageia wiki:General disclaimer")

* [![Creative Commons - Attribution-ShareAlike 3.0 Unported](https://i.creativecommons.org/l/by-sa/3.0/88x31.png)](https://creativecommons.org/licenses/by-sa/3.0/)
* [![Powered by MediaWiki](/en/resources/assets/poweredby_mediawiki_88x31.png)](//www.mediawiki.org/)



=== Content from lists.opensuse.org_27ad6b0e_20250124_165948.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/#UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6)

# openSUSE-SU-2013:0979-1: moderate: update for openconnect

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

10 Jun
2013

10 Jun
'13

16:27

openSUSE Security Update: update for openconnect
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0979-1
Rating: moderate
References: #817152
Cross-References: CVE-2012-6128
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This version update fixes several bugs:
- Frequent connection drops fixed (bnc#817152).
- Update to version 4.09
\* Fix overflow on HTTP request buffers
(CVE-2012-6128)(bnc#803347)
\* Fix connection to servers with round-robin DNS with
two-stage auth/connect.
\* Impose minimum MTU of 1280 bytes.
\* Fix some harmless issues reported by Coverity.
\* Improve "Attempting to connect..." message to be
explicit when it's connecting to a proxy.
- Update to version 4.07
\* Fix segmentation fault when invoked with -p argument.
\* Fix handling of write stalls on CSTP (TCP) socket.
- Update to version 4.06
\* Fix default CA location for non-Fedora systems with
old GnuTLS.
\* Improve error handing when vpnc-script exits with
error.
\* Handle PKCS#11 tokens which won't list keys without
login.
- Update to version 4.05
\* Use correct CSD script for Mac OS X.
\* Fix endless loop in PIN cache handling with multiple
PKCS#11 tokens.
\* Fix PKCS#11 URI handling to preserve all attributes.
\* Don't forget key password on GUI reconnect.
\* Fix GnuTLS v3 build on OpenBSD.
- Update to version 4.04
\* Fix GnuTLS password handling for PKCS#8 files.
- Update to version 4.03
\* Fix --no-proxy option.
\* Fix handling of requested vs. received MTU settings.
\* Fix DTLS MTU for GnuTLS 3.0.21 and newer.
\* Support more ciphers for OpenSSL encrypted PEM keys,
with GnuTLS.
\* Fix GnuTLS compatibilty issue with servers that insist
on TLSv1.0 or non-AES ciphers (RH#836558).
- Update to version 4.02
\* Fix build failure due to unconditional inclusion of
<gnutls/dtls.h>.
- Update to version 4.01
\* Add support for OpenSSL's odd encrypted PKCS#1 files,
for GnuTLS.
\* Fix repeated passphrase retry for OpenSSL.
\* Add keystore support for Android.
\* Support TPM, and also additional checks on PKCS#11
certs, even with GnuTLS 2.12.
\* Fix library references to OpenSSL's
ERR\_print\_errors\_cb() when built against GnuTLS v2.12.
- Update to version 4.00
\* Add support for OpenSSL's odd encrypted PKCS#1 files,
for GnuTLS.
\* Fix repeated passphrase retry for OpenSSL.
\* Add keystore support for Android.
\* Support TPM, and also additional checks on PKCS#11
certs, even with GnuTLS 2.12.
\* Fix library references to OpenSSL's
ERR\_print\_errors\_cb() when built against GnuTLS v2.12.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-429
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
openconnect-4.08-3.4.1
openconnect-debuginfo-4.08-3.4.1
openconnect-debugsource-4.08-3.4.1
openconnect-devel-4.08-3.4.1
openconnect-doc-4.08-3.4.1
- openSUSE 12.3 (noarch):
openconnect-lang-4.08-3.4.1
References:
<http://support.novell.com/security/cve/CVE-2012-6128.html>
<https://bugzilla.novell.com/817152>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6/#UAVOXMSVIXS6H5MZRLCLA76MNKO4CXW6)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.redhat.com_f507b90d_20250126_022546.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D910330)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D910330)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D910330)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 910330

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 910330**](show_bug.cgi?id=910330)
(CVE-2012-6128)
- [CVE-2012-6128](https://access.redhat.com/security/cve/CVE-2012-6128) openconnect: Stack-based buffer overflow when processing certain host names, paths, or cookie lists

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-6128 openconnect: Stack-based buffer overflow when processing certai...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-6128 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [910331](show_bug.cgi?id=910331 "CLOSED ERRATA - CVE-2012-6128 openconnect: Stack-based buffer overflow when processing certain host names, paths, or cookie lists [fedora-all]") [910333](show_bug.cgi?id=910333 "CLOSED ERRATA - CVE-2012-6128 openconnect: Stack-based buffer overflow when processing certain host names, paths, or cookie lists [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=910330&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=910330&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-02-12 11:03 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:00 UTC ([History](show_activity.cgi?id=910330)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  dwmw2 jrusnack | | Fixed In Version: | OpenConnect 4.99 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-12-08 16:19:01 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=910330#c0)  Jan Lieskovsky    2013-02-12 11:03:04 UTC  ``` A stack-based buffer overflow flaw was found in the way OpenConnect, a client for Cisco's "AnyConnect" VPN, performed processing of certain host names, paths, or cookie lists, received from the VPN gateway. A remote VPN gateway could provide a specially-crafted host name, path or cookie list that, when processed by the openconnect client would lead to openconnect executable crash.  Relevant upstream patch: [1] <http://git.infradead.org/users/dwmw2/openconnect.git/commitdiff/26f752c3dbf69227679fc6bebb4ae071aecec491>  References: [2] <http://www.openwall.com/lists/oss-security/2013/02/11/9> [3] <http://www.infradead.org/openconnect/changelog.html>   ```  [Comment 1](show_bug.cgi?id=910330#c1)  Jan Lieskovsky    2013-02-12 11:05:32 UTC  ``` This issue affects the versions of the openconnect package, as shipped with Fedora release of 17 and 18. Please schedule an update.  --  This issue affects the versions of the openconnect package, as shipped with Fedora EPEL 5 and Fedora EPEL 6. Please schedule an update.   ```  [Comment 2](show_bug.cgi?id=910330#c2)  Jan Lieskovsky    2013-02-12 11:06:55 UTC  ``` Created openconnect tracking bugs for this issue  Affects: fedora-all [[bug 910331](show_bug.cgi?id=910331 "CLOSED ERRATA - CVE-2012-6128 openconnect: Stack-based buffer overflow when processing certain host names, paths, or cookie lists [fedora-all]")] Affects: epel-all [[bug 910333](show_bug.cgi?id=910333 "CLOSED ERRATA - CVE-2012-6128 openconnect: Stack-based buffer overflow when processing certain host names, paths, or cookie lists [epel-all]")]   ```  [Comment 3](show_bug.cgi?id=910330#c3)  Vincent Danen    2013-02-12 22:01:27 UTC  ``` This was assigned CVE-2012-6128:  <http://www.openwall.com/lists/oss-security/2013/02/12/7>   ```  [Comment 4](show_bug.cgi?id=910330#c4)  Fedora Update System    2013-02-24 08:46:31 UTC  ``` openconnect-4.08-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=910330#c5)  Fedora Update System    2013-02-24 08:58:17 UTC  ``` openconnect-4.08-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=910330#c6)  Fedora Update System    2013-06-17 19:07:54 UTC  ``` openconnect-4.08-1.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 7](show_bug.cgi?id=910330#c7)  Fedora Update System    2013-06-17 19:08:31 UTC  ``` openconnect-4.08-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=910330&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from wiki.mageia.org_d9c907d7_20250126_022545.html ===

# [Wiki](/en/) » Main Page

From Mageia wiki

Jump to: [navigation](#mw-head), [search](#p-search)

Welcome to the Mageia wiki

| Wiki main box one v005.png **Current release** *Support: 3 months minimum after next release*   * [Mageia 9 Release Notes](/en/Mageia_9_Release_Notes "Mageia 9 Release Notes") * [Mageia 9 Errata](/en/Mageia_9_Errata "Mageia 9 Errata") * [List of updates](https://advisories.mageia.org/) * [Mageia 9 Reviews](/en/Mageia_9_Press "Mageia 9 Press") | Wiki main box three v003.png **Distribution development** *Brewing fresh Mageia releases*   * [Planning](/en/Mageia_10_Development "Mageia 10 Development") * [Features proposals policy](/en/Features_policy "Features policy") * [Technical specifications proposals](/en/Category%3AProposedFeatureMageia10 "Category:ProposedFeatureMageia10") * [Mageia 10 Release Notes](/en/Mageia_10_Release_Notes "Mageia 10 Release Notes") |
| --- | --- |
| Wiki main box two v004.png **Mageia Users** *Find help and engage with other 'Mageians'*   * [Documentation](/en/Documentation "Documentation") - newcomers start [here](/en/Newcomers_start_here "Newcomers start here") * [User Forums](/en/User_Forums "User Forums") & [Communities](/en/Users_Community_team "Users Community team") * [Commercial services](/en/Commercial_vendors "Commercial vendors") | Wiki main box four v004.png **Contributor's Corner** *Helping the Mageia project and its users*   * See how you can [contribute](https://www.mageia.org/en/contribute/) * Find [IRC](/en/Mageia_IRC_Channels_Liberachat "Mageia IRC Channels Liberachat"), [forums](https://forums.mageia.org/en/), [mailing lists](/en/Mailing_lists "Mailing lists") or [Matrix](/en/Matrix "Matrix") * Join a Mageia  [team](/en/Contributing "Contributing") * [Donations](http://www.mageia.org/en/donate/) |
| Wiki main box six v004.png **Wiki in other languages** [简体中文](/en/%E9%A6%96%E9%A1%B5 "首页") [Česky cs: wiki](http://www.wiki.mageia.cz/) [Deutsch](/en/Hauptseite-de "Hauptseite-de") [Español](/en/Bienvenido "Bienvenido") [Français](/en/Accueil-fr "Accueil-fr") (wiki Mageia) et [mageialinux-online.org](http://www.mageialinux-online.org/wiki/wiki.php) (wiki MLO) [Nederlands](/en/Hoofdpagina-nl "Hoofdpagina-nl") [Polski](/en/Main_Page_PL "Main Page PL") [Português brasileiro](/en/P%C3%A1gina_inicial-pt-BR "Página inicial-pt-BR") [Português (Portugal)](/en/P%C3%A1gina_Principal_pt-PT "Página Principal pt-PT") [Русский](https://wiki.mageia.org.ru/) [Türkçe](/en/Ana_sayfa "Ana sayfa") | Wiki main box five v003.png **A selection of useful links** *Quick access to several handy resources*   * [Advisories](https://advisories.mageia.org/) * [Bug reporting](https://bugs.mageia.org/) * [Mageia Applications Database](https://madb.mageia.org/) * [Mageia Rescue](/en/Rescue "Rescue") * [Mirrors](https://mirrors.mageia.org/) and their [status](https://mirrors.mageia.org/status) * [User Account registration](https://identity.mageia.org/)   Previous Mageia releases: Mageia [8](/en/Mageia_8_Release_Notes "Mageia 8 Release Notes"), [7](/en/Archive%3A_Mageia_7 "Archive: Mageia 7"), [6](/en/Archive%3A_Mageia_6 "Archive: Mageia 6"), [5](/en/Archive%3A_Mageia_5 "Archive: Mageia 5"), [4](/en/Archive%3A_Mageia_4 "Archive: Mageia 4"), [3](/en/Archive%3A_Mageia_3 "Archive: Mageia 3"), [2](/en/Archive%3A_Mageia_2 "Archive: Mageia 2"), [1](/en/Archive%3A_Mageia_1 "Archive: Mageia 1") (no longer supported) |

Retrieved from "<https://wiki.mageia.org/mw-en/index.php?title=Main_Page&oldid=63299>"

## Navigation menu

### Personal tools

* [Log in](/mw-en/index.php?title=Special:UserLogin&returnto=Main+Page "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Main page](/en/Main_Page "View the content page [c]")
* [Discussion](/mw-en/index.php?title=Talk:Main_Page&action=edit&redlink=1 "Discussion about the content page [t]")

### Variants

### Views

* [Read](/en/Main_Page)
* [View source](/mw-en/index.php?title=Main_Page&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/mw-en/index.php?title=Main_Page&action=history "Past revisions of this page [h]")

### More

### Search

### Navigation

* [Main page](/en/Main_Page "Visit the main page [z]")
* [Documentation](/en/Documentation)
* [Community portal](/en/Mageia_wiki%3ACommunity_portal "About the project, what you can do, where to find things")
* [Current events](/en/Mageia_wiki%3ACurrent_events "Find background information on current events")
* [Recent changes](/en/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/en/Special%3ARandom "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

### Tools

* [What links here](/en/Special%3AWhatLinksHere/Main_Page "A list of all wiki pages that link here [j]")
* [Related changes](/en/Special%3ARecentChangesLinked/Main_Page "Recent changes in pages linked from this page [k]")
* [Special pages](/en/Special%3ASpecialPages "A list of all special pages [q]")
* [Printable version](/mw-en/index.php?title=Main_Page&printable=yes "Printable version of this page [p]")
* [Permanent link](/mw-en/index.php?title=Main_Page&oldid=63299 "Permanent link to this revision of the page")
* [Page information](/mw-en/index.php?title=Main_Page&action=info "More information about this page")

* This page was last edited on 8 December 2024, at 14:37.
* Content is available under [Creative Commons - Attribution-ShareAlike 3.0 Unported](https://creativecommons.org/licenses/by-sa/3.0/) unless otherwise noted.

* [Privacy policy](/en/Mageia_wiki%3APrivacy_policy "Mageia wiki:Privacy policy")
* [About Mageia wiki](/en/Mageia_wiki%3AAbout "Mageia wiki:About")
* [Disclaimers](/en/Mageia_wiki%3AGeneral_disclaimer "Mageia wiki:General disclaimer")

* [![Creative Commons - Attribution-ShareAlike 3.0 Unported](https://i.creativecommons.org/l/by-sa/3.0/88x31.png)](https://creativecommons.org/licenses/by-sa/3.0/)
* [![Powered by MediaWiki](/en/resources/assets/poweredby_mediawiki_88x31.png)](//www.mediawiki.org/)



=== Content from git.infradead.org_5e31bf5e_20250124_165947.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[projects](/) / [users](?a=project_list;pf=users) / [dwmw2](?a=project_list;pf=users/dwmw2) / [openconnect.git](?p=users/dwmw2/openconnect.git;a=summary) / commitdiff

commit
grep
author
committer
pickaxe
 [?](?p=users/dwmw2/openconnect.git;a=search_help "search help") search:

re

[summary](?p=users/dwmw2/openconnect.git;a=summary) | [shortlog](?p=users/dwmw2/openconnect.git;a=shortlog;h=26f752c3dbf69227679fc6bebb4ae071aecec491) | [log](?p=users/dwmw2/openconnect.git;a=log;h=26f752c3dbf69227679fc6bebb4ae071aecec491) | [commit](?p=users/dwmw2/openconnect.git;a=commit;h=26f752c3dbf69227679fc6bebb4ae071aecec491) | commitdiff | [tree](?p=users/dwmw2/openconnect.git;a=tree;h=1a8e0f4d6c1a209702840f677ffa7a7763bbe63a;hb=26f752c3dbf69227679fc6bebb4ae071aecec491)

[raw](?p=users/dwmw2/openconnect.git;a=commitdiff_plain;h=26f752c3dbf69227679fc6bebb4ae071aecec491) | [patch](?p=users/dwmw2/openconnect.git;a=patch;h=26f752c3dbf69227679fc6bebb4ae071aecec491) | inline | [side by side](?p=users/dwmw2/openconnect.git;a=commitdiff;h=26f752c3dbf69227679fc6bebb4ae071aecec491;ds=sidebyside) (parent: [3edcc28](?p=users/dwmw2/openconnect.git;a=commitdiff;h=3edcc28d19074f85b1e3aa117744a8a83536aba9))

[http: Fix overflow on HTTP request buffers](?p=users/dwmw2/openconnect.git;a=commit;h=26f752c3dbf69227679fc6bebb4ae071aecec491)

| author | [Kevin Cernekee](?p=users/dwmw2/openconnect.git;a=search;h=26f752c3dbf69227679fc6bebb4ae071aecec491;s=Kevin+Cernekee;st=author "Search for commits authored by Kevin Cernekee") [<cernekee@gmail.com>](?p=users/dwmw2/openconnect.git;a=search;h=26f752c3dbf69227679fc6bebb4ae071aecec491;s=cernekee@gmail.com;st=author "Search for commits authored by cernekee@gmail.com") |  |
| --- | --- | --- |
|  | Sat, 27 Oct 2012 19:25:50 +0000 (12:25 -0700) |
| committer | [Kevin Cernekee](?p=users/dwmw2/openconnect.git;a=search;h=26f752c3dbf69227679fc6bebb4ae071aecec491;s=Kevin+Cernekee;st=committer "Search for commits committed by Kevin Cernekee") [<cernekee@gmail.com>](?p=users/dwmw2/openconnect.git;a=search;h=26f752c3dbf69227679fc6bebb4ae071aecec491;s=cernekee@gmail.com;st=committer "Search for commits committed by cernekee@gmail.com") |  |
|  | Sun, 28 Oct 2012 05:10:02 +0000 (22:10 -0700) |

A malicious VPN gateway can send a very long hostname/path (for redirects)

or cookie list (in general), which OpenConnect will attempt to sprintf()

into a fixed length buffer.  Each HTTP server response line can add

roughly MAX\_BUF\_LEN (131072) bytes to the next OpenConnect HTTP request,

but the request buffer (buf) is capped at MAX\_BUF\_LEN bytes and is

allocated on the stack.

The result of passing a long "Location:" header looks like:

    Attempting to connect to server 127.0.0.1:443

    SSL negotiation with localhost

    Server certificate verify failed: self signed certificate in certificate chain

    Connected to HTTPS on localhost

    GET https://localhost/

    Got HTTP response: HTTP/1.0 301 Moved

    Ignoring unknown HTTP response line '[aaaaaaaaaaaaaaaaaa](?p=users/dwmw2/openconnect.git;a=object;h=aaaaaaaaaaaaaaaaaa)'

    SSL negotiation with localhost

    Server certificate verify failed: self signed certificate in certificate chain

    Connected to HTTPS on localhost

    \*\*\* buffer overflow detected \*\*\*: /scr/openconnect2/.libs/lt-openconnect terminated

    ======= Backtrace: =========

    /lib/x86\_64-linux-gnu/libc.so.6(\_\_fortify\_fail+0x5c)[0x7fd62729b82c]

    /lib/x86\_64-linux-gnu/libc.so.6(+0x109700)[0x7fd62729a700]

    /lib/x86\_64-linux-gnu/libc.so.6(+0x108b69)[0x7fd627299b69]

    /lib/x86\_64-linux-gnu/libc.so.6(\_IO\_default\_xsputn+0xdd)[0x7fd62720d13d]

    /lib/x86\_64-linux-gnu/libc.so.6(\_IO\_vfprintf+0x1ae7)[0x7fd6271db4a7]

    /lib/x86\_64-linux-gnu/libc.so.6(\_\_vsprintf\_chk+0x94)[0x7fd627299c04]

    /lib/x86\_64-linux-gnu/libc.so.6(\_\_sprintf\_chk+0x7d)[0x7fd627299b4d]

    /scr/openconnect2/.libs/libopenconnect.so.2(openconnect\_obtain\_cookie+0xc0)[0x7fd62832d210]

    /scr/openconnect2/.libs/lt-openconnect[0x40413f]

    /lib/x86\_64-linux-gnu/libc.so.6(\_\_libc\_start\_main+0xed)[0x7fd6271b276d]

    /scr/openconnect2/.libs/lt-openconnect[0x404579]

The proposed fix is to use dynamically allocated buffers with overflow

checking.

Signed-off-by: Kevin Cernekee <cernekee@gmail.com>

| [http.c](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491) |  | [patch](?p=users/dwmw2/openconnect.git;a=commitdiff;h=26f752c3dbf69227679fc6bebb4ae071aecec491#patch1) | [blob](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491) | [history](?p=users/dwmw2/openconnect.git;a=history;f=http.c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491) |
| --- | --- | --- |

diff --git [a/http.c](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef) [b/http.c](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491)
index 1df648873dba30d574963b43895d882f0c146eef..d49f26fac4ac548eacd04fd26d11efd70394285c 100644 (file)

--- a/[http.c](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef)
+++ b/[http.c](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491)
@@ [-35,6](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l35) [+35,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l35) @@
 #include <errno.h>
 #include <stdlib.h>
 #include <stdio.h>
+#include <stdarg.h>

 #include "openconnect-internal.h"

@@ [-44,6](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l44) [+45,85](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l45) @@ static int proxy\_read(struct openconnect\_info \*vpninfo, int fd,
                      unsigned char \*buf, size\_t len);

 #define MAX\_BUF\_LEN 131072
+#define BUF\_CHUNK\_SIZE 4096
+
+struct oc\_text\_buf {
+       char \*data;
+       int pos;
+       int buf\_len;
+       int error;
+};
+
+static struct oc\_text\_buf \*buf\_alloc(void)
+{
+       return calloc(1, sizeof(struct oc\_text\_buf));
+}
+
+static void buf\_append(struct oc\_text\_buf \*buf, const char \*fmt, ...)
+{
+       va\_list ap;
+
+       if (!buf || buf->error)
+               return;
+
+       if (!buf->data) {
+               buf->data = malloc(BUF\_CHUNK\_SIZE);
+               if (!buf->data) {
+                       buf->error = -ENOMEM;
+                       return;
+               }
+               buf->buf\_len = BUF\_CHUNK\_SIZE;
+       }
+
+       while (1) {
+               int max\_len = buf->buf\_len - buf->pos, ret;
+
+               va\_start(ap, fmt);
+               ret = vsnprintf(buf->data + buf->pos, max\_len, fmt, ap);
+               va\_end(ap);
+               if (ret < 0) {
+                       buf->error = -EIO;
+                       break;
+               } else if (ret < max\_len) {
+                       buf->pos += ret;
+                       break;
+               } else {
+                       int new\_buf\_len = buf->buf\_len + BUF\_CHUNK\_SIZE;
+
+                       if (new\_buf\_len > MAX\_BUF\_LEN) {
+                               /\* probably means somebody is messing with us \*/
+                               buf->error = -E2BIG;
+                               break;
+                       }
+
+                       buf->data = realloc(buf->data, new\_buf\_len);
+                       if (!buf->data) {
+                               buf->error = -ENOMEM;
+                               break;
+                       }
+                       buf->buf\_len = new\_buf\_len;
+               }
+       }
+}
+
+static int buf\_error(struct oc\_text\_buf \*buf)
+{
+       return buf ? buf->error : -ENOMEM;
+}
+
+static int buf\_free(struct oc\_text\_buf \*buf)
+{
+       int error = buf\_error(buf);
+
+       if (buf) {
+               if (buf->data)
+                       free(buf->data);
+               free(buf);
+       }
+
+       return error;
+}
+
 /\*
  \* We didn't really want to have to do this for ourselves -- one might have
  \* thought that it would be available in a library somewhere. But neither
@@ [-347,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l347) [+427,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l427) @@ static int fetch\_config(struct openconnect\_info \*vpninfo, char \*fu, char \*bu,
                        char \*server\_sha1)
 {
        struct vpn\_option \*opt;
-       char buf[MAX\_BUF\_LEN];
+       struct oc\_text\_buf \*buf;
        char \*config\_buf = NULL;
        int result, buflen;
        unsigned char local\_sha1\_bin[SHA1\_SIZE];
@@ [-361,25](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l361) [+441,31](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l441) @@ static int fetch\_config(struct openconnect\_info \*vpninfo, char \*fu, char \*bu,
                return -EINVAL;
        }

-       sprintf(buf, "GET %s%s HTTP/1.1\r\n", fu, bu);
-       sprintf(buf + strlen(buf), "Host: %s\r\n", vpninfo->hostname);
-       sprintf(buf + strlen(buf),  "User-Agent: %s\r\n", vpninfo->useragent);
-       sprintf(buf + strlen(buf),  "Accept: \*/\*\r\n");
-       sprintf(buf + strlen(buf),  "Accept-Encoding: identity\r\n");
+       buf = buf\_alloc();
+       buf\_append(buf, "GET %s%s HTTP/1.1\r\n", fu, bu);
+       buf\_append(buf, "Host: %s\r\n", vpninfo->hostname);
+       buf\_append(buf, "User-Agent: %s\r\n", vpninfo->useragent);
+       buf\_append(buf, "Accept: \*/\*\r\n");
+       buf\_append(buf, "Accept-Encoding: identity\r\n");

        if (vpninfo->cookies) {
-               sprintf(buf + strlen(buf),  "Cookie: ");
+               buf\_append(buf, "Cookie: ");
                for (opt = vpninfo->cookies; opt; opt = opt->next)
-                       sprintf(buf + strlen(buf),  "%s=%s%s", opt->option,
+                       buf\_append(buf, "%s=%s%s", opt->option,
                                      opt->value, opt->next ? "; " : "\r\n");
        }
-       sprintf(buf + strlen(buf),  "X-Transcend-Version: 1\r\n\r\n");
+       buf\_append(buf, "X-Transcend-Version: 1\r\n\r\n");
+
+       if (buf\_error(buf))
+               return buf\_free(buf);

-       if (openconnect\_SSL\_write(vpninfo, buf, strlen(buf)) != strlen(buf)) {
+       if (openconnect\_SSL\_write(vpninfo, buf->data, buf->pos) != buf->pos) {
                vpn\_progress(vpninfo, PRG\_ERR,
                             \_("Failed to send GET request for new config\n"));
+               buf\_free(buf);
                return -EIO;
        }
+       buf\_free(buf);

        buflen = process\_http\_response(vpninfo, &result, NULL, &config\_buf);
        if (buflen < 0) {
@@ [-697,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l697) [+783,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l783) @@ static int handle\_redirect(struct openconnect\_info \*vpninfo)
 int openconnect\_obtain\_cookie(struct openconnect\_info \*vpninfo)
 {
        struct vpn\_option \*opt;
-       char buf[MAX\_BUF\_LEN];
+       struct oc\_text\_buf \*buf;
        char \*form\_buf = NULL;
        int result, buflen;
        char request\_body[2048];
@@ [-731,27](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l731) [+817,26](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l817) @@ int openconnect\_obtain\_cookie(struct openconnect\_info \*vpninfo)
         \*
         \* So we process the HTTP for ourselves...
         \*/
-       sprintf(buf, "%s /%s HTTP/1.1\r\n", method, vpninfo->urlpath ?: "");
-       sprintf(buf + strlen(buf), "Host: %s\r\n", vpninfo->hostname);
-       sprintf(buf + strlen(buf),  "User-Agent: %s\r\n", vpninfo->useragent);
-       sprintf(buf + strlen(buf),  "Accept: \*/\*\r\n");
-       sprintf(buf + strlen(buf),  "Accept-Encoding: identity\r\n");
+       buf = buf\_alloc();
+       buf\_append(buf, "%s /%s HTTP/1.1\r\n", method, vpninfo->urlpath ?: "");
+       buf\_append(buf, "Host: %s\r\n", vpninfo->hostname);
+       buf\_append(buf, "User-Agent: %s\r\n", vpninfo->useragent);
+       buf\_append(buf, "Accept: \*/\*\r\n");
+       buf\_append(buf, "Accept-Encoding: identity\r\n");

        if (vpninfo->cookies) {
-               sprintf(buf + strlen(buf),  "Cookie: ");
+               buf\_append(buf, "Cookie: ");
                for (opt = vpninfo->cookies; opt; opt = opt->next)
-                       sprintf(buf + strlen(buf),  "%s=%s%s", opt->option,
-                                     opt->value, opt->next ? "; " : "\r\n");
+                       buf\_append(buf, "%s=%s%s", opt->option,
+                                  opt->value, opt->next ? "; " : "\r\n");
        }
        if (request\_body\_type) {
-               sprintf(buf + strlen(buf),  "Content-Type: %s\r\n",
-                             request\_body\_type);
-               sprintf(buf + strlen(buf),  "Content-Length: %zd\r\n",
-                             strlen(request\_body));
+               buf\_append(buf, "Content-Type: %s\r\n", request\_body\_type);
+               buf\_append(buf, "Content-Length: %zd\r\n", strlen(request\_body));
        }
-       sprintf(buf + strlen(buf),  "X-Transcend-Version: 1\r\n\r\n");
+       buf\_append(buf, "X-Transcend-Version: 1\r\n\r\n");
        if (request\_body\_type)
-               sprintf(buf + strlen(buf), "%s", request\_body);
+               buf\_append(buf, "%s", request\_body);

        if (vpninfo->port == 443)
                vpn\_progress(vpninfo, PRG\_INFO, "%s https://%s/%s\n",
@@ [-762,7](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l762) [+847,11](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l847) @@ int openconnect\_obtain\_cookie(struct openconnect\_info \*vpninfo)
                             method, vpninfo->hostname, vpninfo->port,
                             vpninfo->urlpath ?: "");

-       result = openconnect\_SSL\_write(vpninfo, buf, strlen(buf));
+       if (buf\_error(buf))
+               return buf\_free(buf);
+
+       result = openconnect\_SSL\_write(vpninfo, buf->data, buf->pos);
+       buf\_free(buf);
        if (result < 0)
                return result;

@@ [-1095,21](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=1df648873dba30d574963b43895d882f0c146eef#l1095) [+1184,28](?p=users/dwmw2/openconnect.git;a=blob;f=http.c;h=d49f26fac4ac548eacd04fd26d11efd70394285c;hb=26f752c3dbf69227679fc6bebb4ae071aecec491#l1184) @@ static int process\_socks\_proxy(struct openconnect\_info \*vpninfo, int ssl\_sock)
 static int process\_http\_proxy(struct openconnect\_info \*vpninfo, int ssl\_sock)
 {
        char buf[MAX\_BUF\_LEN];
+       struct oc\_text\_buf \*reqbuf;
        int buflen, result;

-       sprintf(buf, "CONNECT %s:%d HTTP/1.1\r\n", vpninfo->hostname, vpninfo->port);
-       sprintf(buf + strlen(buf), "Host: %s\r\n", vpninfo->hostname);
-       sprintf(buf + strlen(buf), "User-Agent: %s\r\n", vpninfo->useragent);
-       sprintf(buf + strlen(buf), "Proxy-Connection: keep-alive\r\n");
-       sprintf(buf + strlen(buf), "Connection: keep-alive\r\n");
-       sprintf(buf + strlen(buf), "Accept-Encoding: identity\r\n");
-       sprintf(buf + strlen(buf), "\r\n");
+       reqbuf = buf\_alloc();
+       buf\_append(reqbuf, "CONNECT %s:%d HTTP/1.1\r\n", vpninfo->hostname, vpninfo->port);
+       buf\_append(reqbuf, "Host: %s\r\n", vpninfo->hostname);
+       buf\_append(reqbuf, "User-Agent: %s\r\n", vpninfo->useragent);
+       buf\_append(reqbuf, "Proxy-Connection: keep-alive\r\n");
+       buf\_append(reqbuf, "Connection: keep-alive\r\n");
+       buf\_append(reqbuf, "Accept-Encoding: identity\r\n");
+       buf\_append(reqbuf, "\r\n");
+
+       if (buf\_error(reqbuf))
+               return buf\_free(reqbuf);

        vpn\_progress(vpninfo, PRG\_INFO,
                     \_("Requesting HTTP proxy connection to %s:%d\n"),
                     vpninfo->hostname, vpninfo->port);

-       result = proxy\_write(vpninfo, ssl\_sock, (unsigned char \*)buf, strlen(buf));
+       result = proxy\_write(vpninfo, ssl\_sock, (unsigned char \*)reqbuf->data, reqbuf->pos);
+       buf\_free(reqbuf);
+
        if (result) {
                vpn\_progress(vpninfo, PRG\_ERR,
                             \_("Sending proxy request failed: %s\n"),

Unnamed repository; edit this file 'description' to name the repository.
[RSS](?p=users/dwmw2/openconnect.git;a=rss "log RSS feed")
[Atom](?p=users/dwmw2/openconnect.git;a=atom "log Atom feed")



=== Content from www.infradead.org_9c90d0ae_20250126_022542.html ===
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)
iQIcBAABAgAGBQJRHAGjAAoJEGN2LNpn4vNZbqkQAKOHh6/uNclpdr6Knh6uVtyo
76lnMVGPkf0a8NiTr8QQaTmM0lWLaDlkcPUuiehDOjxz0jLfyrRMjmMy3QB68GB1
9fs4kNdxA883eIpBhdRZyoOECWyMKl1A0XMWtJZmPqvz68ZEv27YpvO4/8tpU3hv
5mVC5QKwA4f+DIzWvQ1By/lT7WC/2SjUnE0nFz4fbS0I+I3CZM2y6tHndoWs3UhQ
EaZXLKKsFUzKo4PSCnMOX2U/kqo3Ocy/lGjEZ5IvJHrsf6iWmrfjkwfbQpr6J8qu
gcTqDvuvN8O69uGJYJflY2Mcj9MlCTz162Hp3HGbV7/v/QNsPUmkh3O0wLYJWpFL
gm1T0AikvVUModzVU1sARyLwnbIbF/O6m+gatCenffOYxJoe4/Y0d8amam7whTqr
4Py4x5Cp63uEPUBwqRfdBhTsGjJwU54IBJe75ON56VRmDbnMHtct7t8QPezoU5KF
hLO+l01xd7bEeUpbJ/Zahw2YWrPCC+tSMh0rFwqEV9/rj8RYkinEbqfiYAiht++W
HhkBvOlDjj5M6Aj1ZqP3EdOJPQn6FC4ofn3Njga6QKBETLjdVTmKIa+9XtgBOOHP
u7E2Up83znDwNkiNEQWWkQkPftPkSQI2u7IBYjJICXEyYuK16wZEVEcI/CFTKIOY
Lk6hm5ALoGrmUdYJLSnu
=ULX1
-----END PGP SIGNATURE-----

