=== Content from bugs.debian.org_4ea18c5f_20250124_202444.html ===

# Debian Bug report logs - #686650 bcron: CVE-2012-6110: bcron file descriptors not closed

[![version graph](version.cgi?collapse=1;height=2;found=bcron%2F0.09-12;found=bcron%2F0.09-11;package=bcron;absolute=0;fixed=bcron%2F0.09-13;fixed=bcron%2F0.09-11%2Bsqueeze1;width=2)](version.cgi?fixed=bcron%2F0.09-13;fixed=bcron%2F0.09-11%2Bsqueeze1;found=bcron%2F0.09-12;found=bcron%2F0.09-11;collapse=1;package=bcron;absolute=0;info=1)

Package:
[bcron](pkgreport.cgi?package=bcron);
Maintainer for [bcron](pkgreport.cgi?package=bcron) is [Georges Khaznadar <georgesk@debian.org>](pkgreport.cgi?maint=georgesk%40debian.org); Source for [bcron](pkgreport.cgi?package=bcron) is [src:bcron](pkgreport.cgi?src=bcron) ([PTS](https://tracker.debian.org/pkg/bcron), [buildd](https://buildd.debian.org/bcron), [popcon](https://qa.debian.org/popcon.php?package=bcron)).

Reported by: [Anton Khalikov <anton@khalikov.ru>](pkgreport.cgi?submitter=anton%40khalikov.ru)

Date: Tue, 4 Sep 2012 11:00:01 UTC

Severity: *critical*

Tags: security, upstream

Found in versions bcron/0.09-12, bcron/0.09-11

Fixed in versions bcron/0.09-13, bcron/0.09-11+squeeze1

**Done:** Gerrit Pape <pape@smarden.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=686650;mbox=yes), [status mbox](bugreport.cgi?bug=686650;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=686650;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Tue, 04 Sep 2012 11:00:04 GMT) ([full text](bugreport.cgi?bug=686650;msg=2), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Anton Khalikov <anton@khalikov.ru>`:

New Bug report received and forwarded. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Tue, 04 Sep 2012 11:00:04 GMT) ([full text](bugreport.cgi?bug=686650;msg=4), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=5), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=anton%40khalikov.ru)
From: Anton Khalikov <anton@khalikov.ru>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: bcron: Possible bcron security breach
Date: Tue, 04 Sep 2012 16:49:14 +0600
```
Package: bcron
Version: 0.09-12
Severity: normal
Tags: upstream

Dear Maintainer,

I think I have found a security breach in bcron. Bcron-exec program does not close
its file descriptors when does fork()/exec() to run scheduled jobs. When used in
untrusted environment such as shared hosting, it is possible for one user to send
spam from neighbour user's accounts or read other's cron job stdout.

In deeper details. If any user's program runs through cron and generates some output to
stdout/stderr, cron must send its output to owner's e-mail. Bcron uses start_slot()
function to create a temp file, write e-mail message headers in there to prepare
this mail to be sent and then does fork/exec to run scheduled task and redirects
its stdout/stderr to this particular file. After this task done its work,
bcron in end_slot() compares the length of temp file with stored length of empty
temp file with only headers filled in and if they differ, end_slot() runs sendmail
to deliver this message.

start_slot() calls forkexec_slot() to fork and forkexec_slot() calls exec_cmd()
to exec corresponding task. But before calling execv() it must close all open fds
execpt stdin/stdout/stderr. Unfortunatelly, there is no such code in exec_cmd().

If one creates 2 tasks and runs them simultaneously using bcron, the following
situation occurs:

1. First task (cron1.sh):

root@debian:~# lsof -p 14230
COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF  NODE NAME
cron1.sh 14230 root  cwd    DIR  254,0     4096   902 /root
cron1.sh 14230 root  rtd    DIR  254,0     4096     2 /
cron1.sh 14230 root  txt    REG  254,0   106920   624 /bin/dash
cron1.sh 14230 root  mem    REG  254,0  1583120   732 /lib/x86_64-linux-gnu/libc-2.13.so
cron1.sh 14230 root  mem    REG  254,0   136936   977 /lib/x86_64-linux-gnu/ld-2.13.so
cron1.sh 14230 root    0u   CHR    1,3      0t0  1199 /dev/null
cron1.sh 14230 root    1u   REG   0,17   479453 22716 /tmp/bcron.14096.1346752020.105007 (deleted)
cron1.sh 14230 root    2u   REG   0,17   479453 22716 /tmp/bcron.14096.1346752020.105007 (deleted)
cron1.sh 14230 root    3r  FIFO    0,8      0t0 55752 pipe
cron1.sh 14230 root   10r   REG  254,0       45   115 /root/cron1.sh

2. second task (cron2.sh):

root@debian:~# lsof -p 14231
COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF  NODE NAME
cron2.sh 14231 root  cwd    DIR  254,0     4096   902 /root
cron2.sh 14231 root  rtd    DIR  254,0     4096     2 /
cron2.sh 14231 root  txt    REG  254,0   106920   624 /bin/dash
cron2.sh 14231 root  mem    REG  254,0  1583120   732 /lib/x86_64-linux-gnu/libc-2.13.so
cron2.sh 14231 root  mem    REG  254,0   136936   977 /lib/x86_64-linux-gnu/ld-2.13.so
cron2.sh 14231 root    0u   CHR    1,3      0t0  1199 /dev/null
cron2.sh 14231 root    1u   REG   0,17   316908 22717 /tmp/bcron.14096.1346752020.105958 (deleted)
cron2.sh 14231 root    2u   REG   0,17   316908 22717 /tmp/bcron.14096.1346752020.105958 (deleted)
cron2.sh 14231 root    3r  FIFO    0,8      0t0 44757 pipe
cron2.sh 14231 root    6u   REG   0,17   318938 22716 /tmp/bcron.14096.1346752020.105007 (deleted)
cron2.sh 14231 root   10r   REG  254,0       45   112 /root/cron2.sh

Notice fd #6 is temp file created for gathering output of cron1.sh but cron2.sh
has access to it and may overwrite it with its own content. And this message
would be sent from cron1 while cron1 never generated it.

Speaking about shared hosting environment, it is possible for malicious user
to send spam without any traces showing this spam was sent from his/her account.

I'm going to attach path fixing this issue after it is tested and considered stable.

-- System Information:
Debian Release: wheezy/sid
  APT prefers testing
  APT policy: (500, 'testing')
Architecture: amd64 (x86_64)

Kernel: Linux 3.2.0-3-amd64 (SMP w/1 CPU core)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages bcron depends on:
ii  libbg1  1.106-1
ii  libc6   2.13-35

Versions of packages bcron recommends:
ii  bcron-run                       0.09-12
ii  postfix [mail-transport-agent]  2.9.3-2.1
ii  runit                           2.1.1-6.2
ii  ucspi-unix                      0.36-4

bcron suggests no packages.

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Wed, 05 Sep 2012 07:15:08 GMT) ([full text](bugreport.cgi?bug=686650;msg=7), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Anton Khalikov <anton@khalikov.ru>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Wed, 05 Sep 2012 07:15:08 GMT) ([full text](bugreport.cgi?bug=686650;msg=9), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=10), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=anton%40khalikov.ru)
From: Anton Khalikov <anton@khalikov.ru>
To: 686650@bugs.debian.org
Subject: PATCH
Date: Wed, 5 Sep 2012 13:11:09 +0600
```
Hello there,

the patch is as simple as follows:

$ diff bcron-exec.c.orig bcron-exec.c
108a109
>   int slot;
110d110
<   close(fdin);
113c113,115
<   close(fdout);
---
>   for (slot = 0; slot < SLOT_MAX; ++slot)
>     if (slots[slot].tmpfd != -1)
>       close(slots[slot].tmpfd);

I'm going to do more testing on production systems with heavy bcron usage (few thousands jobs per day) and report about success/failure after a couple of days.

---
Best regards,
Anton Khalikov

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Fri, 07 Sep 2012 08:09:03 GMT) ([full text](bugreport.cgi?bug=686650;msg=12), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Anton Khalikov <anton@khalikov.ru>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Fri, 07 Sep 2012 08:09:03 GMT) ([full text](bugreport.cgi?bug=686650;msg=14), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=15), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=anton%40khalikov.ru)
From: Anton Khalikov <anton@khalikov.ru>
To: 686650@bugs.debian.org
Subject: PATCH worked ok
Date: Fri, 7 Sep 2012 14:07:47 +0600
```
[[Message part 1](bugreport.cgi?att=0;bug=686650;msg=15) (text/plain, inline)]
```
```
Hello there,

looks like the provided patch works ok: no complaints received. It has been tested on 7 production servers within 2 days.

---
Best regards,
Anton Khalikov

```
```
[[Message part 2](bugreport.cgi?att=1;bug=686650;msg=15) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Fri, 07 Sep 2012 08:57:07 GMT) ([full text](bugreport.cgi?bug=686650;msg=17), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Anton Khalikov <anton@khalikov.ru>, 686650@bugs.debian.org`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Fri, 07 Sep 2012 08:57:07 GMT) ([full text](bugreport.cgi?bug=686650;msg=19), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=20), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=pape%40smarden.org)
From: Gerrit Pape <pape@smarden.org>
To: Anton Khalikov <anton@khalikov.ru>, 686650@bugs.debian.org
Subject: Re: Bug#686650: PATCH worked ok
Date: Fri, 7 Sep 2012 08:47:47 +0000
```
On Fri, Sep 07, 2012 at 02:07:47PM +0600, Anton Khalikov wrote:
> Hello there,
>
> looks like the provided patch works ok: no complaints received. It has been tested on 7 production servers within 2 days.

Thanks you very much, Anton.  I'll take this upstream.

Regards, Gerrit.

```

---

**Severity set to 'critical' from 'normal'**
Request was from `Gerrit Pape <pape@dbnbgs.smarden.org>`
to `control@bugs.debian.org`.
(Wed, 16 Jan 2013 14:51:04 GMT) ([full text](bugreport.cgi?bug=686650;msg=22), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=22), [link](#21)).

---

**Added tag(s) security.**
Request was from `Gerrit Pape <pape@dbnbgs.smarden.org>`
to `control@bugs.debian.org`.
(Wed, 16 Jan 2013 14:51:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=24), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=24), [link](#23)).

---

**Reply sent**
to `Gerrit Pape <pape@smarden.org>`:

You have taken responsibility.
(Wed, 16 Jan 2013 15:03:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=26), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=26), [link](#25)).

---

**Notification sent**
to `Anton Khalikov <anton@khalikov.ru>`:

Bug acknowledged by developer.
(Wed, 16 Jan 2013 15:03:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=28), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 686650-close@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=29), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=pape%40smarden.org)
From: Gerrit Pape <pape@smarden.org>
To: 686650-close@bugs.debian.org
Subject: Bug#686650: fixed in bcron 0.09-13
Date: Wed, 16 Jan 2013 15:02:28 +0000
```
Source: bcron
Source-Version: 0.09-13

We believe that the bug you reported is fixed in the latest version of
bcron, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 686650@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Gerrit Pape <pape@smarden.org> (supplier of updated bcron package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Wed, 16 Jan 2013 10:13:37 +0000
Source: bcron
Binary: bcron bcron-run
Architecture: all source
Version: 0.09-13
Distribution: unstable
Urgency: medium
Maintainer: Gerrit Pape <pape@smarden.org>
Changed-By: Gerrit Pape <pape@smarden.org>
Description:
 bcron      - Bruce's cron system (programs)
 bcron-run  - Bruce's cron system
Closes: [686650](bugreport.cgi?bug=686650)
Changes:
 bcron (0.09-13) unstable; urgency=medium
 .
   * debian/diff/0008-bcron-exec-Mark-all-temporary-files-close-...diff:
     new; from upstream git; bcron-exec: Mark all temporary files
     close-on-exec and close selfpipe; this fixes a security bug in
     bcron where cron jobs get access to the temporary output files from
     all other jobs that are still running (closes: #[686650](bugreport.cgi?bug=686650)).
Checksums-Sha1:
 acf2f180ec33b25510d373a00edcb8057221548b 1042 bcron_0.09-13.dsc
 13967b5f9bc815f44da4d3c57dfcae0155da00d1 9893 bcron_0.09-13.diff.gz
 f3b7353f6e83f25e2a0015d8bf01793ea1decfec 8930 bcron-run_0.09-13_all.deb
Checksums-Sha256:
 4ce05a73efee27ba75d6a95efdb5ff8f9915ca70c041a0ef15182c4fb7e8e878 1042 bcron_0.09-13.dsc
 d7a5c0da1e7cb92faa1fa9a29ef4c6636f1f9df158acd9f94ae35e7e5b304f52 9893 bcron_0.09-13.diff.gz
 f7700963d863fdaa08f30360b6ceaa1ec303e9fb10185beef4e29bce98d1c3ce 8930 bcron-run_0.09-13_all.deb
Files:
 4617fcc0b0c088ea88656e22f6588e3f 1042 admin optional bcron_0.09-13.dsc
 d2fc2b72ebd095d55764e8f6e6ad2e67 9893 admin optional bcron_0.09-13.diff.gz
 2dea60dad96f5c0d3843bab5000527d6 8930 admin optional bcron-run_0.09-13_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlD2gFMACgkQGJoyQbxwpv/DPACfWNiOscyMpSz8wj03EMExC5CX
SsIAn2nS3o4wWZqwjHU7AIB3IdWioS87
=8npn
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'bcron: CVE-2012-6110: bcron file descriptors not closed' from 'bcron: Possible bcron security breach'**
Request was from `Henri Salo <henri@nerv.fi>`
to `control@bugs.debian.org`.
(Thu, 17 Jan 2013 13:12:03 GMT) ([full text](bugreport.cgi?bug=686650;msg=31), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=31), [link](#30)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Thu, 17 Jan 2013 23:36:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=33), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `Jonathan Wiltshire <jmw@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Thu, 17 Jan 2013 23:36:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=35), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=36), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=jmw%40debian.org)
From: Jonathan Wiltshire <jmw@debian.org>
To: 686650@bugs.debian.org
Subject: Re: bcron: Possible bcron security breach
Date: Thu, 17 Jan 2013 11:42:08 -0000
```
Package: bcron

Dear maintainer,

Recently you fixed one or more security problems and as a result you closed
this bug. These problems were not serious enough for a Debian Security
Advisory, so they are now on my radar for fixing in the following suites
through point releases:

squeeze (6.0.7) - use target "stable"

Please prepare a minimal-changes upload targetting each of these suites,
and submit a debdiff to the Release Team [0] for consideration. They will
offer additional guidance or instruct you to upload your package.

I will happily assist you at any stage if the patch is straightforward and
you need help. Please keep me in CC at all times so I can
track [1] the progress of this request.

For details of this process and the rationale, please see the original
announcement [2] and my blog post [3].

0: debian-release@lists.debian.org
1: <http://prsc.debian.net/tracker/686650/>
2: <201101232332.11736.thijs@debian.org>
3: <http://deb.li/prsc>

Thanks,

with his security hat on:
--
Jonathan Wiltshire                                      jmw@debian.org
Debian Developer                         <http://people.debian.org/~jmw>

4096R: 0xD3524C51 / 0A55 B7C5 1223 3942 86EC  74C3 5394 479D D352 4C51

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Fri, 18 Jan 2013 15:09:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=38), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent**
to `Gerrit Pape <pape@dbnbgs.smarden.org>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Fri, 18 Jan 2013 15:09:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=40), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=41), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=pape%40dbnbgs.smarden.org)
From: Gerrit Pape <pape@dbnbgs.smarden.org>
To: debian-release@lists.debian.org
Cc: Jonathan Wiltshire <jmw@debian.org>, 686650@bugs.debian.org
Subject: bcron update for stable
Date: Fri, 18 Jan 2013 14:57:29 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=686650;msg=41) (text/plain, inline)]
```
```
Hi,

as suggested by Jonathan below, I prepared a bcron package fixing
#686650 as candidate for the next squeeze point release.  A debdiff is
attached, the package ready for upload.

Regards, Gerrit.

On Thu, Jan 17, 2013 at 11:42:08AM -0000, Jonathan Wiltshire wrote:
> Package: bcron
>
> Dear maintainer,
>
> Recently you fixed one or more security problems and as a result you closed
> this bug. These problems were not serious enough for a Debian Security
> Advisory, so they are now on my radar for fixing in the following suites
> through point releases:
>
> squeeze (6.0.7) - use target "stable"
>
> Please prepare a minimal-changes upload targetting each of these suites,
> and submit a debdiff to the Release Team [0] for consideration. They will
> offer additional guidance or instruct you to upload your package.
>
> I will happily assist you at any stage if the patch is straightforward and
> you need help. Please keep me in CC at all times so I can
> track [1] the progress of this request.
>
> For details of this process and the rationale, please see the original
> announcement [2] and my blog post [3].
>
> 0: debian-release@lists.debian.org
> 1: <http://prsc.debian.net/tracker/686650/>
> 2: <201101232332.11736.thijs@debian.org>
> 3: <http://deb.li/prsc>
>
> Thanks,
>
> with his security hat on:
> --
> Jonathan Wiltshire                                      jmw@debian.org
> Debian Developer                         <http://people.debian.org/~jmw>
>
> 4096R: 0xD3524C51 / 0A55 B7C5 1223 3942 86EC  74C3 5394 479D D352 4C51

```
```
[[debdiff](bugreport.cgi?att=1;bug=686650;filename=debdiff;msg=41) (text/plain, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Fri, 18 Jan 2013 20:33:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=43), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent**
to `"Adam D. Barratt" <adam@adam-barratt.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Fri, 18 Jan 2013 20:33:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=45), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=46), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=adam%40adam-barratt.org.uk)
From: "Adam D. Barratt" <adam@adam-barratt.org.uk>
To: Gerrit Pape <pape@dbnbgs.smarden.org>
Cc: debian-release@lists.debian.org, Jonathan Wiltshire <jmw@debian.org>,
686650@bugs.debian.org
Subject: Re: bcron update for stable
Date: Fri, 18 Jan 2013 20:28:53 +0000
```
Control: found -1 0.09-11

On Fri, 2013-01-18 at 14:57 +0000, Gerrit Pape wrote:

> as suggested by Jonathan below, I prepared a bcron package fixing
> #686650 as candidate for the next squeeze point release.  A debdiff is
> attached, the package ready for upload.

Please go ahead; thanks.

Regards,

Adam

```

---

**Marked as found in versions bcron/0.09-11.**
Request was from `"Adam D. Barratt" <adam@adam-barratt.org.uk>`
to `686650-submit@bugs.debian.org`.
(Fri, 18 Jan 2013 20:33:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=48), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=48), [link](#47)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Gerrit Pape <pape@smarden.org>`:

`Bug#686650`; Package `bcron`.
(Tue, 22 Jan 2013 20:45:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=50), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=50), [link](#49)).

---

**Acknowledgement sent**
to `"Adam D. Barratt" <adam@adam-barratt.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Gerrit Pape <pape@smarden.org>`.
(Tue, 22 Jan 2013 20:45:06 GMT) ([full text](bugreport.cgi?bug=686650;msg=52), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=52), [link](#51)).

---

[Message #53](#53) received at 686650@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=53), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=53), reply):

![](/cgi-bin/libravatar.cgi?email=adam%40adam-barratt.org.uk)
From: "Adam D. Barratt" <adam@adam-barratt.org.uk>
To: Gerrit Pape <pape@dbnbgs.smarden.org>
Cc: debian-release@lists.debian.org, Jonathan Wiltshire <jmw@debian.org>,
686650@bugs.debian.org
Subject: Re: bcron update for stable
Date: Tue, 22 Jan 2013 20:41:45 +0000
```
On Fri, 2013-01-18 at 20:28 +0000, Adam D. Barratt wrote:
> On Fri, 2013-01-18 at 14:57 +0000, Gerrit Pape wrote:
>
> > as suggested by Jonathan below, I prepared a bcron package fixing
> > #686650 as candidate for the next squeeze point release.  A debdiff is
> > attached, the package ready for upload.
>
> Please go ahead; thanks.

Flagged for acceptance in to p-u.

Regards,

Adam

```

---

**Reply sent**
to `Gerrit Pape <pape@smarden.org>`:

You have taken responsibility.
(Tue, 22 Jan 2013 20:51:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=55), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=55), [link](#54)).

---

**Notification sent**
to `Anton Khalikov <anton@khalikov.ru>`:

Bug acknowledged by developer.
(Tue, 22 Jan 2013 20:51:05 GMT) ([full text](bugreport.cgi?bug=686650;msg=57), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=57), [link](#56)).

---

[Message #58](#58) received at 686650-close@bugs.debian.org ([full text](bugreport.cgi?bug=686650;msg=58), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=58), reply):

![](/cgi-bin/libravatar.cgi?email=pape%40smarden.org)
From: Gerrit Pape <pape@smarden.org>
To: 686650-close@bugs.debian.org
Subject: Bug#686650: fixed in bcron 0.09-11+squeeze1
Date: Tue, 22 Jan 2013 20:47:09 +0000
```
Source: bcron
Source-Version: 0.09-11+squeeze1

We believe that the bug you reported is fixed in the latest version of
bcron, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 686650@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Gerrit Pape <pape@smarden.org> (supplier of updated bcron package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 18 Jan 2013 03:21:49 +0000
Source: bcron
Binary: bcron bcron-run
Architecture: all source
Version: 0.09-11+squeeze1
Distribution: stable
Urgency: high
Maintainer: Gerrit Pape <pape@smarden.org>
Changed-By: Gerrit Pape <pape@smarden.org>
Description:
 bcron      - Bruce's cron system (programs)
 bcron-run  - Bruce's cron system
Closes: [686650](bugreport.cgi?bug=686650)
Changes:
 bcron (0.09-11+squeeze1) stable; urgency=high
 .
   * debian/diff/0008-bcron-exec-Mark-all-temporary-files-close-...diff:
     new; from upstream git; bcron-exec: Mark all temporary files
     close-on-exec and close selfpipe; this fixes a security bug in
     bcron where cron jobs get access to the temporary output files from
     all other jobs that are still running ([CVE-2012-6110](https://security-tracker.debian.org/tracker/CVE-2012-6110), closes:
     #[686650](bugreport.cgi?bug=686650)).
Checksums-Sha1:
 e43f2943ae85c6faed0e89f5239a35ebf0cbaa3e 1003 bcron_0.09-11+squeeze1.dsc
 c674016644770a244d2405add3dcc1eaf93fcd5c 9813 bcron_0.09-11+squeeze1.diff.gz
 0a11fa23a16081444c1d56f1a66ca41bccf4cb34 8856 bcron-run_0.09-11+squeeze1_all.deb
Checksums-Sha256:
 ea4c3aee269124e0a22a1e005a40b11cfa8285bc84a2693917e18763a7f73319 1003 bcron_0.09-11+squeeze1.dsc
 22ec07febaafb47fc257cbd0db6df087fd957900ecef77b731df216c3520f630 9813 bcron_0.09-11+squeeze1.diff.gz
 f4dd528f70c8b92e72caf4bdb163525829b24673f3c655f36d9ee1593113392d 8856 bcron-run_0.09-11+squeeze1_all.deb
Files:
 7bc703c6abe42b1605a2e7d9c83b498a 1003 admin optional bcron_0.09-11+squeeze1.dsc
 acfe940f0537953c7eda49b4cbfe9920 9813 admin optional bcron_0.09-11+squeeze1.diff.gz
 002a91faa6ebaf620ae4b3bb8a6df090 8856 admin optional bcron-run_0.09-11+squeeze1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlD74OkACgkQGJoyQbxwpv+vmwCfWFtwITNdvyYBelYH5jPN0pS9
vU8An2L9LHBFz6oM3Xnlq7KqE8VPLx7/
=5l6X
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 24 Feb 2013 07:28:15 GMT) ([full text](bugreport.cgi?bug=686650;msg=60), [mbox](bugreport.cgi?bug=686650;mbox=yes;msg=60), [link](#59)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=686650).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 20:24:44 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from untroubled.org_a11c429f_20250124_202440.html ===
-------------------------------------------------------------------------------
Changes in version 0.11
- Updated to build against bglibs v2
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.10
- Fixed bug in bcron-exec that allowed cron jobs to access the temporary
output file from all other jobs that are still running.
- Fixed a debug note that forced supplementary groups off in bcron-exec.
- Fixed a bug in bcron-exec that would cause lost log messages.
- Fixed handling of failure to change directory at startup.
- Blocked access to files outside of the spool in bcron-spool.
- Added debug messages to bcron-exec.
- Fixed a bug in bcron-spool that caused listing missing crontabs to
silently succeed.
- Added support for dumping the current job schedule in bcron-sched.
- Added configuration file for hard-coded sendmail command line.
- Added a self-test mode for bcron-exec.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.09
- Fixed several build and portability issues.
- The default path for bcron-spool is changed to /var/run/bcron-spool
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.08
- Reordered some things in bcron-exec to provide error emails more often
when jobs fail to run because of system errors.
- bcron-update internally strips slashes from paths to prevent problems
with doubled or trailing slashes in arguments.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.07
- Added logging of warnings when crontabs fail to be parsed properly.
- Added sending email notification if a job was killed.
- Fixed crash in parsing of faulty timespecs.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.06
- Added support for listing all system crontabs.
- bcron-exec now waits until all the programs its running have exited so
that email gets sent properly.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.05
- Die with error if executing the shell or wrapper failed in bcron-exec.
- Set up supplemental groups in bcron-exec.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------
Changes in version 0.04
- Fixed (for good this time?) the bug in bcron-exec causing delayed
execution of programs.
Development of this version has been sponsored by FutureQuest, Inc.
ossi@FutureQuest.net http://www.FutureQuest.net/
-------------------------------------------------------------------------------


=== Content from security-tracker.debian.org_a8e6c6e7_20250126_032028.html ===

# CVE-2012-6110

| **Name** | CVE-2012-6110 |
| --- | --- |
| **Description** | bcron-exec in bcron before 0.10 does not close file descriptors associated with temporary files when running a cron job, which allows local users to modify job files and send spam messages by accessing an open file descriptor. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2012-6110) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-6110); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2012-6110), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2012-6110), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2012-6110), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2012-6110), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-6110), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2012-6110), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2012-6110), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2012-6110)/[CVE](https://www.suse.com/security/cve/CVE-2012-6110/), GitHub [advisories](https://github.com/advisories?query=CVE-2012-6110)/[code](https://github.com/search?type=Code&q=%22CVE-2012-6110%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2012-6110%22), [web search](https://duckduckgo.com/html?q=%22CVE-2012-6110%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [686650](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686650) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [bcron](/tracker/source-package/bcron) ([PTS](https://tracker.debian.org/pkg/bcron)) | bullseye | 0.11-9 | fixed |
|  | bookworm | 0.11-19 | fixed |
|  | sid, trixie | 0.11-23 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [bcron](/tracker/source-package/bcron) | source | squeeze | 0.09-11+squeeze1 |  |  |  |
| [bcron](/tracker/source-package/bcron) | source | (unstable) | 0.09-13 | low |  | [686650](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=686650) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


