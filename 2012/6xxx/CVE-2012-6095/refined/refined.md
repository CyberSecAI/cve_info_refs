Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2012-6095:

**Root Cause:**
- A time-of-check time-of-use (TOCTOU) race condition exists in ProFTPD when handling MKD/XMKD FTP commands in conjunction with the `UserOwner` directive.

**Weaknesses/Vulnerabilities:**
- **Race Condition:** A local attacker can exploit the time gap between directory creation and the application of `UserOwner`.
- **Symlink Vulnerability**: By creating a symbolic link during this time gap, an attacker can manipulate the target directory of `UserOwner`.

**Impact of Exploitation:**
- **Privilege Escalation:** A local attacker could potentially escalate privileges.
- **Unauthorized File Ownership Change**: By replacing a newly created directory with a symlink pointing to a sensitive location, the attacker can cause the server to change the ownership of that sensitive location via the `UserOwner` directive.

**Attack Vectors:**
- **Local Access:** The attacker must have local access to the machine where ProFTPD is running.
- **Symbolic Link Creation:** The attacker creates a symlink with the same name as the created directory, but pointing to a different (and potentially sensitive) location.

**Required Attacker Capabilities/Position:**
- The attacker needs to be a local user on the system running ProFTPD.
- The attacker needs to have sufficient permissions to create directories and symbolic links within the directory where ProFTPD is creating new directories.
- The attacker must be able to perform these actions within a specific time window after directory creation and before ProFTPD applies `UserOwner` to the newly created directory.

**Additional Details:**
- The vulnerability is triggered when the `UserOwner` directive is used.
- The issue affects both the core FTP functionality as well as mod\_sftp's handling of MKDIR.
- The vulnerability can be mitigated using the `DefaultRoot` directive, as it confines the user to a chrooted environment.
- The fix involves using `lchown(2)` instead of `chown(2)` when applying `UserOwner`, ensuring changes are made to the symlink rather than its target.
- A more robust fix using `mkdtemp(3)`, `lchown(2)`, and `rename(2)` was also implemented to further secure the directory creation process, while also addressing a related issue where  setuid/setgid bits were not being propagated correctly to new directories in some cases when using `mkdtemp(3)`.

This information is derived from the provided bugzilla entries, mailing list discussions, and commit logs.