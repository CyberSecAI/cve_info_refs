=== Content from bugzilla.redhat.com_ef047e5a_20250126_005302.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D892715)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D892715)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D892715)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 892715

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 892715**](show_bug.cgi?id=892715)
(CVE-2012-6095)
- [CVE-2012-6095](https://access.redhat.com/security/cve/CVE-2012-6095) proftpd: Symlink race condition when applying UserOwner to a newly (ProFTPD) created directory

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-6095 proftpd: Symlink race condition when applying UserOwner to a ne...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-6095 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [892718](show_bug.cgi?id=892718 "CLOSED CURRENTRELEASE - CVE-2012-6095 proftpd: Symlink race condition when applying UserOwner to a newly (ProFTPD) created directory [fedora-all]") [892719](show_bug.cgi?id=892719 "CLOSED CURRENTRELEASE - CVE-2012-6095 proftpd: Symlink race condition when applying UserOwner to a newly (ProFTPD) created directory [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=892715&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=892715&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-01-07 16:47 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:58 UTC ([History](show_activity.cgi?id=892715)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  matthias paul | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-08-19 09:39:17 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=892715#c0)  Jan Lieskovsky    2013-01-07 16:47:28 UTC  ``` A time-of-check time-of-use (TOCTOU) race condition flaw was found in the way ProFTPD, flexible, stable and highly-configurable FTP server, handled MKD/XMKD FTP commands when the UserOwner directive was involved. A local attacker could use this flaw to possibly escalate their privileges via symbolic-link attacks on directories, created by ProFTPD prior UserOwner ownership was applied.  Upstream bug report: [1] <http://bugs.proftpd.org/show_bug.cgi?id=3841>  Relevant upstream patch: [2] <http://bugs.proftpd.org/show_bug.cgi?id=3841#c8>  References: [3] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=697524>   ```  [Comment 1](show_bug.cgi?id=892715#c1)  Jan Lieskovsky    2013-01-07 16:50:38 UTC  ``` This issue affects the versions of the proftpd package, as shipped with Fedora release of 16 and 17. Please schedule an update.  --  This issue affects the versions of the proftpd package, as shipped with Fedora EPEL 5 and 6. Please schedule an update.   ```  [Comment 2](show_bug.cgi?id=892715#c2)  Jan Lieskovsky    2013-01-07 16:51:58 UTC  ``` Created proftpd tracking bugs for this issue  Affects: fedora-all [[bug 892718](show_bug.cgi?id=892718 "CLOSED CURRENTRELEASE - CVE-2012-6095 proftpd: Symlink race condition when applying UserOwner to a newly (ProFTPD) created directory [fedora-all]")] Affects: epel-all [[bug 892719](show_bug.cgi?id=892719 "CLOSED CURRENTRELEASE - CVE-2012-6095 proftpd: Symlink race condition when applying UserOwner to a newly (ProFTPD) created directory [epel-all]")]   ```  [Comment 3](show_bug.cgi?id=892715#c3)  Jan Lieskovsky    2013-01-08 11:30:37 UTC  ``` The CVE identifier of [CVE-2012-6095](https://access.redhat.com/security/cve/CVE-2012-6095) has been assigned to this issue:   <http://www.openwall.com/lists/oss-security/2013/01/07/3>   ```  [Comment 4](show_bug.cgi?id=892715#c4)  Fedora Update System    2013-01-30 00:31:11 UTC  ``` proftpd-1.3.4b-5.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=892715#c5)  Fedora Update System    2013-01-30 00:31:39 UTC  ``` proftpd-1.3.4b-5.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=892715#c6)  Fedora Update System    2013-01-30 00:58:54 UTC  ``` proftpd-1.3.4b-5.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 7](show_bug.cgi?id=892715#c7)  Fedora Update System    2013-02-05 21:22:37 UTC  ``` proftpd-1.3.3g-2.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=892715#c8)  Fedora Update System    2013-02-05 21:25:28 UTC  ``` proftpd-1.3.3g-2.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=892715#c9)  Paul Howarth    2013-08-19 09:19:19 UTC  ``` This has been addressed in all current Fedora and EPEL releases. Can we close the bug now?   ```  [Comment 10](show_bug.cgi?id=892715#c10)  Tomas Hoger    2013-08-19 09:39:17 UTC  ``` Yes, thank you!   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=892715&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from proftpd.org_0ac51d91_20250124_113637.html ===
$Id: NEWS,v 1.1468 2013/01/04 22:16:41 castaglia Exp $
-----------------------------------------------------------------------------
More details on the bugs listed below can be found by using the bug number
indicated in the following URL:
http://bugs.proftpd.org/show\_bug.cgi?id=N
where `N' is the bug number.
-----------------------------------------------------------------------------
1.3.5rc1 - Released 04-Jan-2013
--------------------------------
- Bug 3712 - mod\_wrap2/mod\_load build errors: missing config.h.
- Bug 3713 - mod\_tls cannot be compiled using Openssl 0.9.6.
- Bug 3646 - Debug logging to stderr should include timestamps and PID.
- Bug 3714 - ftpwho/ftptop are not showing command arguments (e.g. downloaded
file name).
- Bug 3715 - MLSD/MLST fail when "DirFakeUser off" or "DirFakeGroup off" used.
- Bug 3717 - proftpd fails to run with "Abort trap" error message.
- Bug 3719 - LIST -R can loop endlessly if bad directory symlink exists.
- Bug 3720 - Various module logfile permissions are 0600 instead of 0640.
- Bug 3723 - mod\_memcache segfault on server restart.
- Bug 3721 - mod\_rewrite does not replace characters if there are more than
8 occurrences. To handle this situation, a new RewriteMaxReplace directive
has been added for configuring this limit.
- Bug 3724 - Unloading mod\_quotatab causes segfault.
- Bug 3686 - Support SHA2 digests in mod\_sftp. See the SFTPDigests directive
documentation for more information.
- Bug 3629 - Support  conditional config section.
- Bug 3682 - Configure does not detect libiconv under Gentoo FreeBSD.
- Bug 3726 - mod\_exec does not always capture stdout/stderr output from
executed command.
- Bug 3727 - mod\_wrap2 causes unexpected LogFormat %u expansion for SFTP
connections.
- Bug 3729 - mod\_ldap can segfault when LDAPUsers is used with no optional
filters.
- Bug 3728 - Build failure in wtmp.c on Gentoo/FreeBSD on sparc.
- Bug 3734 - DirFakeUser/DirFakeGroup off with name causes SIGSEGV for
MLSD/MLST commands.
- Bug 3739 - Allow for configurable SSH version identifiers in mod\_sftp. The
SSH version identifier can now be configured for mod\_sftp via the
ServerIdent directive.
- Bug 3718 - ftptop fails to build on OpenSUSE.
- Bug 3699 - ProFTPD crash on start up on Mac OSX Lion with NLS enabled.
- Bug 3744 - Support ls(1) -1 option for LIST command.
- Bug 3746 - Support applying ListOptions only to NLST or to LIST commands.
- Bug 3747 - Support option for displaying symlinks via MLSD using syntax
preferred by FileZilla. The new FactsOptions directive can be used for
this purpose.
- Bug 3745 - Reject PASV command if no IPv4 address available.
- Bug 3701 - Modify ScoreboardFile directive to support disabling scoreboarding.
- Bug 3742 - Improper handling of self-signed certificate in client-sent cert
list when "TLSVerifyClient on" is used.
- Bug 3749 - Compile of src/netacl.c fails on Tru64 UNIX (OSF/1) due to
conflict with system header.
- Bug 3743 - Random stalls/segfaults seen when transferring large files
via SFTP.
- Bug 3752 - proftpd process exit status is zero for "Failed binding to
address, port N: Address already in use" startup failure.
- Bug 3751 - mod\_ban does not close/reopen the BanLog/BanTable file descriptors
on restart, causing a file descriptor leak.
- Bug 3707 - Add request/transfer ID to the logging of the initial and closing
commands for SFTP file transfers. This can now be accomplished using a
LogFormat variable of '%{note:sftp.file-handle}'.
- Bug 3757 - Support SFTPOption for ignoring requests to modify file ownership.
- Bug 3756 - mod\_ctrls no longer listens on ControlsSocket after restart.
- Bug 3731 - Support active data transfers while RootRevoke is in effect.
- Bug 3737 - Allow UTF8 when UseEncoding is used.
- Bug 3573 - Support Elliptic Curve Cryptography (ECC) in SSH.
- Bug 3758 - ProFTPD crashes when handling mod\_gss authentication due to null
pointer.
- Ability to load SSH host keys from an SSH agent, in addition to files on
disk. See doc/contrib/mod\_sftp.html#SFTPHostKey for more information.
- Bug 3761 - SSH2 key exchange fails if client sends certain SSH message before
NEWKEYS.
- Bug 3763 - Ensure that mod\_sftp operates properly when OpenSSL FIPS mode is
enabled.
- Bug 3764 - mod\_sftp does not correctly handle a 'guess' KEX message when the
client guesses correctly.
- Bug 3765 - mod\_sftp should honor the GroupOwner directive for MKDIR requests.
- Bug 3626 - Display variable %f off by a factor of 1024 on 64-bit platforms.
- Bug 3673 - Support date/timestamp variables in mod\_rewrite.
- Bug 3754 - ProFTPD refuses to delete/rename a symlink pointing outside a
writable directory.
- Bug 3766 - Support a QuotaDefault directive, for configuring default limits.
- Bug 3767 - mod\_rewrite segfault when handling SITE CHGRP without a parameter.
- Bug 3768 - ExecTimeout 0 (zero) not treated as infinite.
- Added new mod\_geoip contrib module.
- Bug 3769 - Ensure that encoded strings are NUL-terminated.
- Bug 3732 - AIX build error: undefined symbol: .alloca.
- Bug 3782 - SQLShowInfo does not work properly for error responses.
- Bug 3780 - AIX gives "error setting listen fd IP\_TOS: Invalid argument".
- Bug 3736 - Trying to re-authenticate an existing FTP connection causes invalid
503 response.
- Bug 3785 - Support resolution of tilde (~) within a chrooted session.
- Bug 3787 - Read-only SFTP OPEN request permissions not properly ignored.
- Bug 3740 - Overwrite permission denied when reloading multiple times and
multiple  sections in proftpd.conf.
- Bug 3791 - Invalid handling of SCP control messages fragmented over multiple
SSH packets.
- Bug 3794 - Cygwin build failure in lib/tpl.c due to wrong include of mman.h.
- Bug 3795 - ProFTPD needs to use -pthread linker option if linking against
OpenSSL with thread support.
- Bug 3790 - Logfile timestamps change to GMT after MFMT command.
- Bug 3798 - Downloading nonexistent file via SCP results in timeout rather
than error.
- Bug 3800 - Multiple \*Options directives should be handled properly.
- Bug 3801 - mod\_tls should have directive like Apache mod\_ssl's
SSLHonorCipherOrder. The mod\_tls module now supports a
TLSServerCipherPreference directive.
- Bug 3804 - ioctl(RPROTDIS) code no longer needed on Solaris 11.
- Bug 3808 - Segfault in mod\_tls when mod\_tls\_shmcache used.
- Bug 3809 - Segfaults in mod\_radius when configured with RadiusGroupInfo.
- Bug 3811 - ExtendedLog entries not written if MaxClients limit reached.
- Bug 3814 - Support "configtest" command for contrib init.d script.
- Bug 3816 - Installation of ftpasswd does not honor DESTDIR environment
variable.
- Bug 3813 - Ability to use CreateHome to create parent directories as
non-root user, for better interoperability with NFS.
- Bug 3806 - Support reverse DNS resolution for IPv6 addresses when
gethostbyname2(3) is not available.
- Bug 3820 - Support device/interface names in , MasqueradeAddress,
and DefaultAddress.
- Bug 3822 - Resolving %U/%u LogFormat variables inconsistent between
mod\_log/mod\_sql in certain cases.
- Bug 3824 - Use RFC compliant address/port for data transfer if FTP client has
not sent PORT/PASV/EPRT/EPSV commands.
- Bug 3825 - Handle RFC 1918 IP addresses in PORT/EPRT commands.
- Bug 3827 - Use non-filesystem based SFTP handle generator instead of
mktemp(3).
- Bug 3828 - Certain sequences of FTP data transfer commands lead to NULL
pointer dereferences in mod\_deflate.
- Bug 3830 - MFF/MFMT command segfaults due to insufficient parameter checks.
- Bug 3829 - RNFR without following RNTO can lead to NULL pointer dereference.
- Bug 3832 - Support disabling of system logging on per-connection basis.
- Bug 3792 - Recursive SCP uploads using preserve-time (-p) option may not work.
- Bug 3831 - Sporadic "451 Insufficient memory or file locked" failure when
downloading.
- Bug 3833 - Enable TCP keepalive by default, with configurable SocketOption.
- Bug 3837 - mod\_tls unable to read certificate files after SIGHUP.
- Bug 3842 - Incorrect handling of REALPATH requests for symlink paths in
mod\_sftp.
- Bug 3843 - ProFTPD should not fail when starting up due to loading same
module multiple times.
- Bug 3845 - mod\_sftp does not provide response codes for %s LogFormat variable
for AUTH ExtendedLog.
- Bug 3846 - Avoid scanning ScoreboardFile needlessly on login if limits are
not configured.
- Bug 3850 - ftpasswd should support generating SHA-256, SHA-512 hashes where
possible.
- Bug 3851 - SFTPPassPhraseProvider fails due to incorrect pointer.
- Bug 3852 - Support directive for ignoring symlink DefaultRoot directories.
See the new AllowChrootSymlinks directive.
- Bug 3839 - Enhance mod\_cap to support dropping root privs entirely.
- Bug 3841 - Possible symlink race when applying UserOwner to newly created
directory.
- Bug 3855 - Restarting proftpd may cause Include files not to be parsed.
1.3.4 - Released 09-Nov-2011
--------------------------------
- Bug 3702 - ProFTPD with mod\_sql\_mysql dies of "Alarm clock" on FreeBSD.
- Bug 3669 - mod\_sql\_mysql.so: undefined symbol: make\_scrambled\_password with
MySQL 5.5 on Fedora.
- Bug 3192 - PQescapeStringConn() needs a better check.
- Bug 3704 - Enable OpenSSL countermeasure against SSLv3/TLSv1 BEAST attacks.
To disable this countermeasure, which may cause interoperability issues
with some clients, use the NoEmptyFragments TLSOption.
- Bug 3706 - Support SFTPOption for ignoring requests to modify timestamps.
- Bug 3640 - rpmbuild on CentOS5.5 (64bit): "File not found by glob".
- Bug 3711 - Response pool use-after-free memory corruption error.
1.3.4rc3 - Released 26-Sep-2011
--------------------------------
- Bug 3637 - Enforce pcre and libmemcached version requirements.
- Bug 3639 - Avoid spinning proftpd process if read(2) returns EAGAIN.
- Bug 3641 - SITE CPFR/CPTO does not update quota tally.
- Bug 3642 - Segfault seen in mod\_sql\_mysql if "SQLAuthenticate groupsetfast"
used.
- Bug 3645 - Ensure that SQLNamedConnectInfos with PERSESSION connection
policies are opened before chroot.
- Bug 3644 - Disable signal handling for exiting session processes.
- Bug 3649 - MaxStoreFileSize can be bypassed using REST/APPE.
- Bug 3652 - TCPAccessSyslogLevel directive broken by Bug#3317.
- Bug 3653 - Segfault with "DefaultServer off" and no matching server for
incoming IP address.
- Bug 3656 - Prefer "File too big" error message for MaxStoreFilesize.
- Bug 3658 - TLSVerifyOrder directive is broken.
- Bug 3555 - Support optional maximum number of clients to be disconnected
via 'ftpdctl kick'.
- Bug 3660 - SITE MKDIR/RMDIR should update quota tallies properly.
- Bug 3663 - TimeoutLogin cannot interrupt mod\_delay as it should.
- Bug 3664 - mod\_sftp does not update process title.
- Bug 3667 - Scoreboard scrubbing can block daemon process for long periods
of time.
- mod\_ldap configuration directives have been overhauled, hopefully
yielding a more straightforward, easier way to configure mod\_ldap.
See the Changes section of README.LDAP for details.
- Bug 3665 - GID of new files are inherited from parent directory on FreeBSD.
To provide the more expected behavior, where the GID of new files is that
of the logged-in user, on FreeBSD machines, the GroupOwner directive can
now handles a parameter value of "~" as "use GID of logged-in user".
- Bug 3668 - File descriptor leak during scoreboard scrubbing. This leak
was inadvertently introduced by the fix for Bug#3667.
- Bug 3670 - WrapDenyMsg not displayed when using mod\_wrap2 + mod\_sftp.
- Bug 3671 - TLSOption AllowClientRenegotiations to be unconditionally required
for client-initiated renegotiations. This undoes the functionality added
for Bug#3585, in light of CVE-2011-1473.
- Bug 3674 - After running "proftpd -t" command, ftpdctl commands no longer
work.
- Bug 3675 - Automatically disable sendfile support for AIX systems.
- Bug 3676 - RADIUS-based logins don't work using mod\_sftp.
- Bug 3679 - Support NAS-IPv6-Address RADIUS attribute.
- Bug 3680 - SFTP MKDIR does not respect the IgnoreSFTPUploadPerms option.
- Bug 3681 - Non POSIX test constructions in autoconf script.
- Bug 3685 - NULL pointer dereference after an idle timeout.
- Bug 3692 - SQLLog IGNORE\_ERRORS parameter does not work.
- Bug 3693 - Clients are disconnected if proftpd cannot listen on port for
passive data transfer.
- Bug 3696 - ExtendedLog not getting written on timeouts.
- Bug 3697 - Filenames with embedded IAC do not get processed correctly.
- Bug 3698 -  does not prevent deletion of a file/directory via
renaming.
1.3.4rc2 - Released 01-Apr-2011
--------------------------------
- Bug 3566 - Ability to turn verbose process titles off.
- Bug 3567 - IdentLookups do not work for IPv6 servers.
- Bug 3571 - RLimitMemory "max" soft/hard limits don't work.
- Bug 3572 - Support use of "notes" variables in SQLNamedQuery.
- Bug 3500 - Support for other combinations of hashed values in mod\_sql\_passwd.
- Bug 3524 - mod\_quotatab\_sql does not properly update the file upload count
for a DELE.
- Bug 3575 - Process privileges may not handled properly when the
--enable-autoshadow configure option is used.
- Bug 3577 - MFMT can fail due to utimes(2) peculiarities.
- Bug 3544 - mod\_sftp closes channel too early after scp download. This
manifests as "lost connection" using OpenSSH's scp(1).
- Bug 3579 - mod\_sftp\_pam may tell client to disable echoing erroneously.
- Bug 3578 - Ability to suppress sending messages from PAM to clients.
- Bug 3580 - TLSSessionCache needs to allow configuring OpenSSL's internal
session caching expiration, for long-lived sessions.
- Bug 3585 - Allow client-requested SSL session renegotiation when securely
supported.
- Bug 3586 - mod\_sftp behaves badly when receiving badly formed SSH messages.
- Bug 3591 - %F LogFormat variable should work for MKD/RMD commands.
- Bug 3592 - Support case-insensitivity option for
PathAllowFilter/PathDenyFilter directives.
- Bug 3593 - Using "$shell $libtool" in prxs does not work for all shells.
- Added new mod\_tls\_memcache contrib module.
- Bug 3599 - Support SFTPOptions parameter for ignoring SFTP SETSTAT/FSETSTAT
permission changes.
- Bug 3598 - HiddenStores makes the APPE command overwrite files instead of
appending them. APPE is now denied if HiddenStores is in effect.
- Bug 3565 - Support a MaxCommandRate, for detecting and throttling clients
which are sending commands too quickly.
- Bug 3559 - ExtendedLog should support EXIT command, for logging when a
session ends.
- Bug 3538 - WrapAllowMsg directive broken due to Bug#3423.
- Bug 3604 - Support DirFakeUser, DirFakeGroup and DirFakeMode for MLSD/MLST
commands.
- Bug 3605 - DisplayReadme output should appear after DisplayLogin for the
PASS command.
- Bug 3595 - Avoid buggy glibc regcomp(3) for regular expressions. To do
this, use the new --enable-pcre configure option to enable the use of the
PCRE library for regular expression support.
- Bug 3607 - SocketOptions receive/send buffer size parameters no longer work.
- Bug 3606 - mod\_wrap2 needs to support netmask rules for IPv6 addresses.
- Bug 3608 - Make mod\_quotatab poll for the QuotaLock file.
- Bug 3576 - Support setting CapabilitiesSet on per-user basis via
mod\_ifsession's  and .
- Bug 3612 - APPE/STOU upload flags erroneously preserved across upload
commands.
- Bug 3609 - Support full PCRE regular expressions if PCRE support is enabled.
- Bug 3614 - Malicious module can use sreplace() function to overflow buffer.
- Bug 3616 - Install contrib utilities as part of 'make install' target.
- Bug 3619 - Exiting sessions don't seem to die properly.
- Bug 3618 - ScoreboardFile locking should be more resilient.
- Bug 3617 - Enhance the Trace directive to support range of channel log levels.
- Bug 3620 - Need LogFormat variable for IP address of server handling session.
- Bug 3262 - Allow SQL logging to separate database/server.
- Bug 3574 - Better handling of ALLO command.
- Bug 3621 - mod\_quotatab increments tallies for aborted uploads if
DeleteAbortedStores is on.
- Bug 3622 - mod\_delay sometimes logs "unable to load DelayTable into memory".
- Bug 3624 - Plaintext command injection in FTPS support.
- Bug 3625 - mod\_ifsession rules using regular expressions do not work.
- Bug 3623 - Truncated client name saved in ScoreboardFile.
- Bug 3627 - %w variable populated with non-absolute path in SQLLog statement.
- Bug 3628 - Unnecessarily verbose "warning: unable to throttle bandwidth:
Interrupted system call".
- Bug 3630 - SSH DISCONNECT messages sent by mod\_sftp even for FTP connections
in some cases.
- Bug 3632 - mod\_sql should log "unrecoverable database error" at a higher
priority.
- Bug 3631 - Support TraceOptions directive, for altering TraceLog format
slightly.
- Bug 3633 - Using SQLOption noDisconnectOnError can cause ExtendedLog logging
to silently fail.
- Bug 3610 - Proftpd is eating CPU when reparsing configuration file on SIGHUP.
- Bug 3634 - Incorrect generation of DSA signature for SSH sessions.
1.3.4rc1 - Released 17-Dec-2010
--------------------------------
- Bug 3399 -  statement does not restore access to MFMT commands.
- Bug 3365 - First certificate in TLSCertificateChainFile is skipped.
- Bug 3302 - MLST response should include full path name.
- Bug 3400 - Add Japanese translation.
- Bug 3401 - mod\_sftp does not compile with pre-0.9.7 OpenSSL.
- Bug 3402 - mod\_tls does not compile with pre-0.9.7 OpenSSL due to Bug#3349.
- Bug 3403 - File upload followed by MLSD leads to wrong file size entries in
TransferLog.
- Bug 3339 - Support ban rule for clients which login too frequently.
- Bug 3405 - Multiple SFTPAuthorizedUserKeys stores causes segfault on 64-bit
platforms.
- Bug 3404 - SyslogLevel not applied to SystemLog.
- Bug 3354 - Renaming a file across mount points to a full disk does not fail
as expected.
- Bug 3353 - Support setting IPTOS/DSCP markings on data and control streams.
There is a mod\_qos module for handling this; see the RELEASE\_NOTES for more
details.
- Bug 3392 - Display  information in 'ban info' ftpdctl action
response.
- Bug 3393 - Specify the  when using 'ban' or 'permit' ftpdctl
actions.
- Bug 2196 - Handle IPv4-mapped IPv6 addresses as IPv4 addresses.
- Bug 3407 - Use glob characters as literal characters if no glob match found
for LIST/NLST.
- Bug 2768 - Provide --with-mysql-config/--with-postgres-config build options.
- Bug 3408 - Use  instead of  where possible.
- Bug 3374 - TLSVerifyClient and TLSOptions NoCertRequest are incompatible.
- Added mod\_copy, mod\_deflate, mod\_ifversion to the contrib/ modules directory.
- Bug 3373 - RadiusGroupInfo should not require that both names and IDs be VSAs.
- Bug 3371 - Group limits in  blocks won't work with
RADIUS-supplied groups.
- Bug 3412 - Include files not included after restart due to permissions.
- Bug 3409 - Build failure on newer FreeBSD due to utmp/utmpx system changes.
- Bug 3318 - MLSD should indicate symlinks if ShowSymlinks is enabled.
- Bug 3411 - Support ftpdctl action to manually request a mod\_dynmasq refresh.
- Bug 3417 - Unsafe use of pointer when scanning config for ScoreboardFile.
- Bug 3418 - %U sometimes showing up as "(none)" in ExtendedLog.
- Bug 3421 - RewriteHome does not work properly for SFTP connections.
- Bug 3413 - Support DirFakeUser, DirFakeGroup for SFTP connections.
- Bug 3419 - SSL\_shutdown() errors with openssl-0.9.8m.
- Bug 3423 - Last line of multiline DisplayLogin file improperly handled.
- Bug 3426 - mod\_sftp does not log to TransferLog by default.
- Bug 3425 - Improperly constructed destination paths for SCP uploads.
- Bug 3428 - Honor the Trace directive in mod\_ifsession sections.
- Bug 3429 - mod\_sftp should honor the UserOwner and GroupOwner directives.
- Bug 3427 - mod\_sftp does not handle recursive SCP uploads properly.
- Bug 3432 - ExecBeforeCommand does not interpolate the %F/%f variables
properly.
- Bug 3434 - TraceLog contains messages even with "Trace DEFAULT:0" configured.
- Bug 3433 - SFTPDisplayBanner does not handle variables in configured file.
- Bug 3435 - Encoding/decoding conversion can cause CPU spike.
- Bug 3436 - Support build-time option to disable use of nonblocking open of
log files. Use --disable-nonblocking-log-open to get the pre-1.3.3 behavior
of opening log files.
- Bug 3437 - UseImplicitSSL TLSOption causes PBSZ/PROT commands to fail.
- Bug 3439 - Encoding fails if an NLS-enabled proftpd starts in a UTF8 locale.
- Bug 3438 -  configuration cannot be applied to OPTS command.
- Bug 3440 - ScanOnLogin QuotaOption not honored properly if tally record has
to be created.
- Bug 3444 - Support SFTPOptions parameter to disable optimistic KEXINIT
behavior.
- Bug 3445 - mod\_sftp should send its NEWKEYS message first, before reading
the client's NEWKEYS message.
- Bug 3443 - Deprecate the DisplayGoAway directive.
- Bug 3446 - .ftpaccess ignored in some cases.
- Bug 3447 - mod\_sftp can become confused during large recursive SCP uploads.
- Bug 3448 - Ensure that STAT/LSTAT/FSTAT SFTP requests do not use cached/stale
data.
- Bug 3449 - mod\_sftp does not properly handle the O\_TRUNC flag in a SFTP OPEN
request.
- Bug 3450 - mod\_sftp does not properly handle the O\_APPEND flag in a SFTP OPEN
request.
- Bug 3451 - WinSCP can't upload files using protocol version 5 with mod\_sftp.
- Bug 3452 - mod\_sftp does not advertise its supported SFTP extensions for
protocol version 5.
- Bug 3454 - msgfmt(1) options used for generating NLS files are not compatible
with Solaris' msgfmt.
- Bug 3457 - Support LogFormat variable for indicating whether a file is being
modified. A new "%{file-modified}" LogFormat variable is supported.
- Bug 3456 - Problem attempting to recursively download a directory via SCP.
- Bug 3458 - mod\_sftp incorrectly performs OpenSSL cleanup.
- Bug 3459 - mod\_radius segfaults during incorrect login due to stale data.
- Bug 3431 - Ensure that timezone info files are opened prior to chroot.
- Bug 3460 - REALPATH SFTP request can cause improperly cached directory
configuration.
- Bug 3462 - ftpasswd script's --delete-user option does not work.
- Bug 3463 - ftpasswd script's --delete-group option does not work.
- Bug 3466 - mod\_ifsession does not check for properly closed  contexts.
- Bug 3465 - SIGSEGV at LIST after CCC.
- Bug 3470 - Deferred resolution  paths not handled properly by
mod\_sftp.
- Bug 3469 - ExtendedLog's %f variable not properly expanded for DELE if path
begins with tilde ('~').
- Bug 3467 - mod\_ifsession does not merge  blocks properly.
- Bug 3471 - Null values in allow/deny rules causes mod\_wrap2 to segfault.
- Bug 3472 - mod\_sftp publickey authentication fails for large keys.
- Bug 3424 - Bad LDAP lookup can cause mod\_ldap segfault under some conditions.
- Bug 3396 - Support -c and -u LIST options.
- Bug 3395 - Provide LogFormat variable %d for non-directory commands.
- Bug 3476 - LIST/NLST of path starting with "-" fails.
- Bug 3475 - Add new 'noGetgrouplist' AuthUnixOption to work around buggy
libc code.
- Bug 3474 - Using SQLite database and SQLLog directive can lead to problems
under load.
- Bug 3479 - Support anonymous username variable in mod\_exec.
- Bug 3480 - mod\_sftp does not interoperate with old ssh.com/Tectia clients.
A new "OldProtocolCompat" SFTPOption has been added.
- Bug 3481 - Problem with SFTP directory listings.
- Bug 3483 - NULL pointer dereference handling SITE command in mod\_quotatab.
- Bug 3485 - Disabling IPv6 via -4 or --ipv4 command-line options does not work.
- Bug 3487 - Null pointer dereference with EPRT/EPSV/PASV/PORT command during
data transfer.
- Bug 3482 - ProFTPD corrupts utmpx log files on FreeBSD 9.0/HEAD.
- Bug 3491 - Directory pattern not matching as expected.
- Bug 3492 - Null pointer dereference during data transfer due to RNFR/RNTO.
- Bug 3493 - mod\_sftp should only expect Subject key header to match if
explicitly configured.
- Bug 3494 - Null pointer dereference for IPv6-enabled proftpd when no
DefaultServer configured.
- Bug 3496 - Sessions don't end when the control connection is closed during
a data transfer.
- Bug 3495 - Support SMTP authentication in the ftpmail Perl script. See
the doc/contrib/ftpmail.html doc for more information.
- Bug 3501 -  logins with "AuthAliasOnly on" still handled as
anonymous logins.
- Bug 3502 - Support environment variables better in the config file.
- Bug 3503 - Support CreateHome parameter for specifying the group ownership
of the home directory.
- Bug 3390 - Add extra %-variable to LogFormat directive to log UID/GID of
logged user. Both LogFormat and SQLLog now support new %{uid} and %{gid}
variables.
- Bug 3505 - Support for SSH2 client "alive" checks, a la OpenSSH's
ClientAliveCount/Interval.
- Bug 3506 - Support ListOption for returning 226 response code when listing
nonexistent file, instead of 450.
- Bug 3511 - SQLAuthType Backend not properly rejected by mod\_sql\_sqlite.
- Bug 3512 - Add ability to check client certificate CommonName (CN) when
verifying SSL/TLS clients.
- Bug 3513 - EPERM error logged unnecessarily for SFTP logins on Linux.
- Bug 3514 - Test suite tmpdir improvements.
- Bug 3484 - Support range expressions for IP addresses in Allow/Deny/From
rules.
- Bug 3516 - Support the "space-available" SFTP extension.
- Bug 3517 - mod\_quotatab decrements file tally improperly for failed DELE
commands.
- Bug 3518 - Support SiteMiscEngine directive, for disabling mod\_site\_misc
functionality via proftpd.conf.
- Bug 3519 - Inappropriate directory traversal allowed by mod\_site\_misc.
- Bug 3520 - MultilineRFC2228 directive should be supported in
and  sections.
- Bug 3521 - Telnet IAC processing stack overflow.
- Bug 3522 - Error when handling SSH DISCONNECT messages with no language tag.
- Bug 3525 - Default syslog logging causes logging to the wrong syslog
facilities.
- Bug 3528 - ExtendedLog %s variable not expanded properly for successful PASS
commands.
- Bug 3526 - CPU usage at 100% when checking HideFiles pattern. Credit goes
to Thomas Shinnick for providing the fix for this; it addresses a more
general problem of high memory and CPU consumption when proftpd searches
for .ftpaccess files.
- Bug 3529 - "LIST /\*" now lists more than the expected directory.
- Bug 3310 - UseSendfile should be supported in  and .ftpaccess
sections.
- Bug 3531 - mod\_quotatab contains duplicate EDQUOT errno code.
- Bug 3530 - Conflicting interactions among HideUser, HideGroup, and
HideNoAccess directives.
- Bug 3208 - Improve ScoreboardFile performance under load. This adds a
new ScoreboardMutex directive, which can be used to explicitly configure
the file mutex used for starting/ending sessions. By default, the
ScoreboardMutex path will be automatically set to the same ScoreboardFile
path, with a ".lck" suffix appended.
- Bug 3536 - mod\_sql has insufficient bounds checking in sql\_prepare\_where()
function.
- Bug 3547 - Multiple AllowClass directives not handled properly.
- Bug 3515 - Support DisplayLogin functionality for SFTP connections.
- Bug 3548 - Null pointer segfault in mod\_sftp when handling aborted connection.
- Bug 3551 - SQLAuthType Crypt implementation needs to handle NULL return value
from crypt(3).
- Bug 3550 - SFTP compressed uploads can cause corrupted uploaded files.
- Bug 3554 - Support Apache-style %I, %O LogFormat variables.
- Bug 3556 - Disable protocol support on per-user/group/class basis.
- Bug 3508 - mod\_wrap2 should support checking of WrapTables allow/deny rules
at connect time.
- Bug 3558 - Check all DNS names for a client against DNS names/patterns in
access rules.
- Bug 3560 - ExtendedLog shows incorrect byte size for first file downloaded
via SFTP in some cases.
1.3.3 - Released 24-Feb-2010
--------------------------------
- Bug 3389 - Cannot create mod\_ban whitelists using  and
sections.
- Bug 3397 - HideFiles none does not work properly on a per-user basis.
1.3.3rc4 - Released 12-Feb-2010
--------------------------------
- Bug 3355 - mod\_ban should support BanEngine in  config sections.
- Bug 3358 - mod\_tls doesn't compile with pre-0.9.7 openssl.
- Bug 3357 - mod\_sftp fails to compile on AIX.
- Bug 3356 - Build timestamp using date(1) can fail depending on environment.
- Bug 3359 - mod\_tls\_shmcache segfaults during syntax check.
- Bug 3362 - Regression in handling of MaxLoginAttempts in 1.3.3rc1.
- Bug 3370 - Lack of PID protection in ScoreboardFile.
- Bug 3372 - ProFTPD crashes when retrying a failed login with mod\_radius
being used.
- Bug 3375 - Minor SIGHUP-based memory leak in mod\_tls.
- Bug 3376 - Handle the full RFC4716 formatted keys in SQL values.
- Bug 3377 - mod\_wrap2 attempts to resolve 'ALL' keyword as an IP address.
- Bug 3383 - ExtendedLog variables for protocol and version not handled
properly.
- Bug 3381 - RADIUS authentication broken on 64-bit platforms.
- Bug 3380 - Support user-specific salts in encoded passwords.
- Bug 3385 - Memory leak during SCP download.
- Bug 3386 - Downloading via SCP can stall due to rekeying.
- Bug 3387 - SIGHUP will eventually cause certain modules (as DSO modules) to
segfault.
1.3.3rc3 - Released 10-Dec-2009
--------------------------------
- Bug 3303 - FileZilla reports "Server did not properly shut down TLS
connection" after TimeoutIdle triggered.
- Bug 3305 - Emulate Solaris 10 syslog "header" on Solaris 10 servers.
- Bug 3307 - All FTP logins treated as anonymous logins.
- Bug 3312 - Uploading via SFTP/SCP to FIFO whose reader is closed causes
session to hang.
- Bug 3313 - Uploading via SFTP to FIFOs fails due to illegal lseek(2),
truncate(2) calls.
- Bug 3314 - Downloading from FIFOs via SFTP/SCP fails.
- Bug 3315 - Support the %u variable in SFTPAuthorizedUserKeys paths.
- Bug 3316 - Messages from PAM modules are ignored when authenticating SSH
clients via 'keyboard-interactive'.
- Bug 3317 - mod\_wrap/libwrap should honor SyslogFacility setting.
- Bug 3311 - configure script should automatically detect when -ldl is needed
by OpenSSL.
- Bug 3324 - Vulnerability in SSL/TLS protocol during renegotiation
(CVE-2009-3555).
- Bug 3327 - Clear external SSL session caches on server restart/shutdown.
- Bug 3326 - Shared memory segment used for session cache should be protected
via mlock(2).
- Bug 3322 - Support the "version-select" SFTP extension.
- Bug 3321 - Support the "check-file-name" and "check-file-handle" SFTP
extensions.
- Bug 3320 - Support the "copy-file" SFTP extension.
- Bug 3328 - Failed database transaction can cause mod\_quotatab to loop
endlessly.
- Bug 3307 - Transparently handle the X-variant commands when checking
permissions. The fix for this issue has been reimplemented to be more
transparent; some existing configurations were broken by the previous
implementation.
- Bug 3329 - Support the "vendor-id" SFTP extension.
- Bug 3332 - Segfault in mod\_wrap when TCPAccessFiles do not exist and client
sends USER for account which does not exist.
- Bug 3333 - mod\_sql\_mysql should support calling stored procedures better.
- Bug 3337 -  sections with a trailing directory name of one
character have  problems. This is regression caused by Bug#3146.
- Bug 3331 - Update bundled libtool to 2.2.4.
- Bug 3341 - mod\_wrap2 segfaults when a valid user retries the USER command.
- Bug 3342 - FEAT response contains LF without preceding CR.
- Bug 3306 - ECONNREFUSED while handling SIGHUP.
- Bug 3345 - mod\_sftp returns EACCES rather than ENOENT for an OPEN request
for a nonexistent file.
- Bug 3344 - Support SHA256, SHA512 passwords in databases.
- Bug 3348 - Rewriting of home directories via RewriteHome does not work for
chrooted sessions.
- Bug 3349 - SSL\_SESSION\_cmp not available in OpenSSL 1.0.0 betas.
- Bug 3350 - Segfault caused by scrubbing zero-length portion of memory.
- Bug 3347 - mod\_auth\_file handles 'getgroups' request incorrectly.
- Bug 3351 - Nonchrooted logins on HPUX do not get proper UID/GID.
- Bug 3352 - mod\_sftp does not reject/close connections that have been rejected
by mod\_wrap.
1.3.3rc2 - Released 20-Oct-2009
--------------------------------
- Bug 3263 - Supplying option SFTPRekey timeout parameter causes segmentation
fault.
- Bug 3265 - SFTP requests are logged to ExtendedLog without regard to classes.
- Bug 2758 - ProFTPD doesn't always pay attention to AccessDenyMsg.
- Bug 3266 - Support "implicit" FTPS.
- Bug 2070 - AuthAliasOnly off in  section kills anonymous logins.
- Bug 3268 - Files whose names start with whitespace are not listed properly.
- Bug 1908 - ExtendedLog to work properly in  context.
- Bug 3269 - RewriteCondition OR/ornext flag does not work.
- Bug 3254 - NLST/LIST and symbolic link problem.
- Bug 3272 - Avoid encoding if to/from charsets are the same.
- Bug 3274 - Timestamp formatting in TransferLog needs padded day-of-month.
- Bug 3270 - Lost connections to databases not correctly handled. This
also adds support for a new "noReconnect" SQLOption.
- Bug 3275 - Improper SSL/TLS certificate subjectAltName verification.
- Bug 3252 - %F/%f Display variables can report wrong size on 64-bit systems.
- Bug 3278 - Aborted data transfers not reflected in RADIUS accounting.
- Bug 3282 - With "SQLNegativeCache on", mod\_sql will look up wrong cached
user value for subsequent USER commands.
- Bug 3284 - Slower transfers of multiple small file transfers after upgrade
from 1.3.0a to 1.3.2a.
- Bug 3279 - .ftpaccess configurations not merged properly with existing
configuration.
- Bug 3287 - MaxTransfersPerHost, MaxTransfersPerUser directives not supported
properly.
- Bug 2013 - Track RFC2228 sessions in scoreboard. The scoreboard entry
format now has a 'protocol' field, for tracking 'ftp' and 'ftps'.
- Bug 3286 - Client command field in scoreboard entry too short for SSH2/SFTP
commands.
- Bug 3229 - LangDefault does not accept any setting on FreeBSD.
- Bug 2368 - Allow contrib modules to extend mod\_sql's SQLAuthTypes. This
also includes a new mod\_sql\_passwd contrib module which can handle
hex- and base64-encoded MD5 and SHA1 passwords, without the leading
"{digest}" prefix required by the mod\_sql OpenSSL SQLAuthType.
- Bug 3292 - "Incorrect MAC received on packet" error using AES CTR ciphers.
- Bug 3293 - SFTPCipher arcfour256 does not work properly.
- Bug 3294 - Support configurable HiddenStores prefixes.
- Bug 3295 - proftpd segfaults when STAT is used with ListOptions "-1".
- Bug 3296 - mod\_quotatab should reject an upload via APPE if the quota is
already exceeded.
- Bug 3297 - Symlinks to directories which end in trailing slashes may not be
handled properly.
- Bug 3298 - QuotaExcludeFilter directive ignored by mod\_quotatab.
- Bug 3290 - Change default mod\_sql connection policy to open database
connection on first use.
- Bug 3281 - TimeoutLogin not handled properly by mod\_ban.
- Bug 3213 - Use locale-sensitive libncursesw library for ftptop where
available.
- Bug 3214 - ftpwho/ftptop truncate UTF8 strings due to byte, versus character,
lengths.
- Bug 3300 - Support disabling use of S\_RLOGIN when calling AIX
loginrestrictions(). A new AuthUnixOptions directive is added to support
just this one setting, 'aixNoRLogin'.
1.3.3rc1 - Released 30-Jun-2009
--------------------------------
- Bug 1801 - Faulty SQLConnectInfo PERCALL policy - connections not closed
after each call.
- Bug 2894 - Deprecate the AnonymousGroup directive.
- Bug 3123 - Use PQescapeStringConn() rather than PQescapeString().
- Bug 3133 - mod\_facts should advertise TVFS support in the FEAT response.
- Bug 3128 - mod\_sql\_sqlite should use transactions for INSERT/UPDATE
statements.
- Bug 3155 - Change the IdentLookups default to 'off'. The RFC1413 IDENT
lookup adds latency to the login process, so much so that it is a FAQ
to configure "IdentLookups off". In addition, the IDENT protocol is not
secure; it can easily be spoofed using man-in-the-middle attacks. Sites
that require IDENT lookups must now explicitly configure "IdentLookups on".
- Bug 3156 - Allow resumed downloads when HiddenStore is in effect.
- Bug 3170 - RewriteMap unescape URL encoding broken by RewriteCondition
backreference handling.
- Bug 2728 - Support for variables in ServerIdent directive. The %L, %V,
and %v variables are now supported for ServerIdent identity strings.
- Bug 3178 - mod\_wrap2 does not handle IPv4-mapped IPv6 addresses.
- Bug 3179 - Restarted proftpd using mod\_shaper will segfault.
- Bug 2720 - HideUser/HideGroup should be more flexible.
- Bug 3183 - Incorrect logging to wtmp.
- Bug 2608 - DNS should not be used for "server config" address discovery.
A new -S command-line option has been added, for specifying the IP address
to use for the host, rather than using DNS to resolve the host IP address
from the hostname.
- Bug 3184 - When started in a chroot, proftpd fails to set transfer buffer
size.
- Added mod\_sftp, mod\_sftp\_pam, and mod\_sftp\_sql to the contrib modules.
- Bug 3185 - mod\_wrap2 does not honour partial DNS name in access files.
This appears to have been a regression caused by the fix for Bug#3178.
- Bug 3186 - Support use of  directive with mod\_ban. The
BanEngine directive can now appear in an  section, in order
to exclude connection classes from mod\_ban's rules.
- Bug 3188 - prxs broken due to typo.
- Bug 3154 - Update bundled libtool version. The bundled libltdl version
has been updated to libtool 1.5.26.
- Bug 3111 - Support SSL/TLS server certificates stored in PKCS#12 files.
- Bug 3189 - Linker errors occur when using "make -j" parallel builds.
ProFTPD now builds successfully using "make -jN", where N is the number
of simultaneous build processes to use.
- Bug 3176 - Postgres chokes on standard charset names.
- Bug 3129 - Support configurable scoreboard scrubbing. A new configuration
directive, ScoreboardScrub, can be used to control whether the ScoreboardFile
is scrubbed, and how often.
- Bug 3190 - MLSD/MLST do not honor  configurations.
- Bug 3196 - mod\_quotatab does not honor last group in supplemental group list.
- Bug 3203 - Missing SQL backend modules can lead to null pointer segfault in
mod\_sql.
- Bug 3204 - Better support for installation and libs in prxs. The prxs
tool now handles the $Libraries$ build system hints in source files,
and honors the DESTDIR environment variable.
- Bug 3167 - Support rewriting of home directories.
- Bug 2985 - Newest .spec file requires relatively current version of RPM.
The provided .spec file now requires RPM 4.2 or later.
- Bug 3207 - Support for SSL/TLS session caching across processes/machines.
The mod\_tls module now supports a TLSSessionCache directive, and an API
for modules to provide external SSL session caching mechanisms.
- Bug 3210 - Data transfers protected by SSL/TLS should reuse the control
connection SSL session. If the TLSRequired policy allows/requires SSL/TLS
protections on data transfers, then reuse of the SSL session from the
control connection is now enforced. Use "TLSOptions NoSessionReuseRequired"
to relax this requirement.
- Bug 3215 - mod\_wrap2\_sql should support comma-delimited lists of clients.
This is the same as Bug#3048, only it affects the mod\_wrap2\_sql module.
- Bug 2613 - Configure script should not append '/proftpd' to the
--localstatedir.
- Bug 2680 - Add support for .
- Bug 3187 - Inconsistent mod\_ban logging and display when using
"BanEngine off" in an  configuration.
- Bug 3219 - Support environment variable substitutions in mod\_rewrite rules.
RewriteCondition and RewriteRules can now contain "%{ENV:var}" style
strings for environment variable substitution.
- Bug 3221 - Command line defines (-D/--define) are lost on SIGHUP.
- Bug 3028 - Unable to escape special characters in RewriteRule substitution
string.
- Bug 3161 - Updating tallies for deleted files should occur based on file
ownership.
- Bug 2067 - Allow/Deny Filters should be supported in the  context.
- Bug 2434 - Buggy interaction between custom SQLUserInfo and 'userset'
SQLAuthenticate parameter. See the SQLUserInfo description for more details.
- Bug 3226 - HideFiles directive not working properly in  sections.
- Bug 3231 - Use getgrset(3) on AIX to emulate getgrouplist(3).
- Bug 3043 - SQLGroupInfo should allow custom queries. See the SQLGroupInfo
description for more information.
- Bug 2178 - Extend TLSRequired for  and .ftpaccess contexts.
- Bug 3209 - mod\_wrap2 should support the 'spawn' feature (or equivalent) of
tcpwrappers. Using mod\_wrap/mod\_wrap2 in conjunction with the mod\_exec
module, this is now possible.
- Bug 3225 - Opening of files during restart can inappropriately use
stdin/stdout/stderr descriptors, leading to bad behavior. The "bad behavior"
can manifest as server shutdown (due to mod\_tls errors),
"Bad file descriptor" log messages, etc.
- Bug 3234 - SSL connections can cause 100% CPU usage.
- Bug 3233 - Dynamic config causes many copies of static configs to be merged.
- Bug 3086 - mod\_quotatab write locking is ineffective.
- Bug 3029 - Support a RewriteCondition variable for renames.
- Bug 3230 - Differentiate among protocol connections in DelayTable.
- Bug 3032 - CR character allowed in filename but not shown.
- Bug 3237 - "error setting IPV6\_V6ONLY: Protocol not available" message
filling up log file.
- Added mod\_shaper, mod\_exec to the contrib modules.
- Bug 3249 - mod\_ban support for TimeoutLogin.
- Bug 3253 - Support for %S variable in SQL queries.
- Bug 3247 - "TLSRequired auth" and "TLSOptions AllowPerUser" are incompatible.
- Bug 3256 - "SO\_OOBINLINE" error occuring again. This is a regression of
Bug 2332 caused by code movement in 1.3.2.
- Bug 3258 - Log cluttered with "using sendfile capability" messages.
- Bug 3261 - Badly formatted TLSRenegotiate directive causes proftpd to hang.
- Bug 3257 - CAP\_AUDIT\_WRITE capability needed for some PAM modules.
- Bug 3243 - Broken support for AllowOverride per user/group/class conditionals.
The user/group/class conditional arguments to the AllowOverride directive
were not properly honored. The fix for this is to remove all support in
the AllowOverride directive, and instead use mod\_ifsession for conditionals.
1.3.2 - Released 5-Feb-2009
--------------------------------
- Bug 3169 - Multiple RewriteRules for the same RewriteCondition not processed
properly.
- Bug 3171 - ExtendedLog should log full SITE command using %m.
- Bug 3173 - Encoding-dependent SQL injection vulnerability.
1.3.2rc4 - Released 23-Jan-2009
--------------------------------
- Bug 2045 - SQLShowInfo should not be displayed when query returns no data.
- Bug 2915 - mod\_rewrite does not work well for SITE commands.
- Bug 1636 - GroupRatio does not check user's supplemental group membership.
- Bug 3137 - ProFTPD does not log filename %f for uploaded files.
- Bug 3142 - "Invalid number of arguments MFMT" due to spaces in path argument.
- Bug 3144 - mod\_dynmasq returns same IP address, even though actual IP
address has changed.
- Bug 3040 - Support for CreateHome parent directories owned by user.
- Added Russian translation.
- Bug 2020 - HideFiles sometimes fails.
- Bug 3146 -  paths using glob characters may not match as expected.
- Bug 3147 - Comma-delimited commands in  sections not handled properly.
- Bug 3149 - Bad handling of %p, %V, and %v variables in mod\_sql.
- Bug 3150 - mod\_facl erroneously assumes no permissions, rather than all
permissions, in some cases.
- Bug 3159 - mod\_rewrite build fails due to missing mode argument in open(2)
call on some platforms.
1.3.2rc3 - Released 20-Nov-2008
--------------------------------
- Bug 3114 - Bad handling of uid/gid parameters for CreateHome.
- Bug 3115 - Cross-site request forgery.
- Bug 3116 - SQLNegativeCache with no group info can cause segfault.
- Bug 3117 - Authentication improperly allowed (Bug#2922 regression).
- Bug 3119 - Search for libcap2 in addition to libcap for mod\_cap support.
- Bug 3120 - WrapTables not allowed in  context.
- Bug 3122 - iconv() not detected properly on FreeBSD when --enable-nls is used.
- Bug 3124 - mod\_sql improperly substitutes variables in user/group names.
- Bug 3089 - Memory pool double-free on session exit after aborted data
transfer.
- Bug 3092 - FSIO API needs mechanism for allowing registered FS handlers to
permit atomic renames.
- Bug 2767 - gcc 4.0/amd64 warnings.
- Bug 3126 - Segfault in mod\_sql\_sqlite when user belongs to multiple groups.
- Bug 3130 - HideFiles can cause segfault.
- Bug 3131 - Session process uses 100% CPU after aborted transfer.
- Bug 3132 - Handling of SIGABRT signal leads to endless loop.
- Bug 3073 - Command arguments not decoded properly in some places.
- Bug 3135 - Aborting a download can lead to segfault in some cases.
1.3.2rc2 - Released 17-Sep-2008
--------------------------------
- Added Chinese translation
- Bug 3076 - RPM build failing on 64 bit OS due to incomplete .spec.
- Bug 3082 - Use "DEFAULT" keyword instead of "ALL" for Trace directive.
Hopefully the "DEFAULT" keyword will be more accurate, more descriptive
of the actual functionality triggered by the keyword.
- Bug 3083 - Multiple issues with handling of  definitions.
- Bug 3077 - Transparently handle the X-variant commands when checking
 permissions.
- Bug 3036 - Quota information not persisted if session ends abruptly.
- Bug 3094 - Perform unidirectional SSL/TLS shutdown on data connections.
- Bug 3096 - libcap version errors on newer Linux kernel.
- Bug 3074 - Support configure option for pkgconfig .pc file install
location.
- Bug 3095 - TLSPassphraseProvider port number truncated.
- Bug 3099 - Add trace logging of filesystem permission errors. To see
this additional logging, use Trace logging, and configure it to log
the "fileperms" log channel.
- Bug 3100 - Support ftpmail options for sending emails only for specific
users. See doc/contrib/ftpmail.html for more details.
- Bug 3030 - GroupOwner should work for all groups. Previously, GroupOwner
(without using UserOwner) could fail, if the user did not belong to
the specified group. Now proftpd will automatically detect, when
handling GroupOwner, when root privileges need to be used for the
configured group.
- Bug 3101 - mod\_wrap2 does not compile on FreeBSD with custom includes.
- Bug 3098 - Socket descriptor leak when using syslog logging, especially at
SyslogLevel 'notice' or higher.
- Bug 3055 - Support Display variable for specifying the timestamp format.
See doc/howto/DisplayFiles.html for more information.
- Bug 2537 - mod\_sql does not support %{...}t variable. SQLNamedQuery
statements can now use "%{time:...}" variables for formatting time strings
using strftime(3).
- Bug 2564 - Improper logging of "max connections per host". The issue was
one of the timing of the logging of the "Login successful" message. Now
it happens as part of a LOG\_CMD handler for the PASS command.
- Bug 3104 - Syslog logging does not work on Mac OS X.
- Bug 2991 - Need a `prxs' (ProFTPD Extensions) command-line tool for building
shared modules without proftpd source.
- Bug 3106 - Add support for Mac OSX 10.5 sendfile.
- Bug 3107 - TLSProtocol supports misleading "SSLv23" parameter.
- Bug 3108 - Support removing MLST from FEAT list. The mod\_facts module
now supports a FactsAdvertise directive; see doc/modules/mod\_facts.html
for details.
- Bug 3109 - Errors with file uploads logged but not reported to clients.
- Bug 3112 - Uploaded files are not removed if close() fails.
1.3.2rc1 - Released 15-Apr-2008
--------------------------------
- Bug 2978 - Support more verbose OpenSSL diagnostic logging. There is now
support for an "EnableDiags" TLSOptions setting, which logs a lot of
SSL/TLS protocol information to the TLSLog.
- Bug 2969 - Allow APPE after REST.
- Bug 2983 - Use getgrouplist(3) for group lookup, if available. This may
potentially speed up the group membership lookup on some systems.
- Bug 2984 - mod\_auth\_file uid2name() does not cache results causing slow LIST
response.
- Bug 2925 - Add caching of IP address and DNS name lookups. This may help
speed up data transfers, especially rapid-fire data transfers as used by
"download accelerators".
- Bug 2979 - Ability to ban clients which connect too often. The mod\_ban
module now supports a "ClientConnectRate" BanOnEvent rule.
- Bug 2987 - Verbose ban information (i.e. 'ftpdctl ban info -v') not working
on FreeBSD.
- Bug 2986 - Authoritative PAM is not honored.
- Bug 2988 - mod\_wrap2\_file ignores "ALL" keyword.
- Bug 2982 - Support limit on number of simultaneous file transfers from one
client. Two new configuration directives, MaxTransfersPerHost and
MaxTransfersPerUser, have been added.
- Bug 2386 - Controls should use kernel-enforced credentials where possible.
- Added mod\_dynmasq contrib module. See doc/contrib/mod\_dynmasq.html for
more information.
- Bug 2968 - Ability to allow protection on control channel, but reject
protection on data channel. See doc/contrib/mod\_tls.html#TLSRequired
for details.
- Added mod\_unique\_id contrib module. See doc/contrib/mod\_unique\_id.html
for details.
- Bug #2990 - TLSCryptoDevice does not work.
- Bug #2989 - Unable to authenticate users if RadiusUserInfo is not configured.
- Bug #2937 - Should list modules (with versions) for modules loaded as DSOs.
The -vv command-line option now shows all modules (and versions), both
static and shared. See the RELEASE\_NOTES for more details.
- Bug #2993 - Unable to compile 1.3.1 on Debian unstable/amd64. The configure
script was brokenly checking for the umode\_t data type, which is not needed
by the proftpd source code.
- Bug #2992 - The %f LogFormat variable expanded improperly to "-" for
SITE CHMOD.
- Bug #2995 - The %f LogFormat variable expanded to same file for RNFR and
RNTO.
- Bug #2996 - Requirement for same OpenSSL header, library version in mod\_tls
too restrictive. If differences are detected now, the difference is logged,
but the daemon will start up.
- Bug 3005 - OOB abort closes the control connection.
- Bug 3004 - 'ScanOnLogin' QuotaOption does not honor QuotaDirectoryTally
directive.
- Bug 3006 - 'ScanOnLogin' QuotaOption may try to update a nonexistent tally
record.
- Bug 3001 - Incomplete downloads not logged properly in TransferLog if
sendfile is used.
- Bug 3012 - SITE UTIME should support YYYYMMDDhhmmss format.
- Bug 3013 - "TLSOptions AllowPerUser" not working as expected.
- Bug 3019 - DisplayLogin in  section not displayed properly.
- Bug 3015 - Support for RFC3659. There is a new module, mod\_facts, which
implements the RFC3659 commands of MLSD and MLST, as well as the MFF and
MFMT commands from an Internet Draft.
- Bug 2894 - The AnonymousGroup directive has been marked for deprecation,
and will be removed in a future release.
- Bug 3003 - Fallback to normal transmission in case of sendfile EOVERFLOW
error missing.
- Bug 2874 - Data transfer buffers should be allocated at startup, not at
compile time.
- Bug 3014 - Optionally set PAM\_TTY item when using PAM. Use
"AuthPAMOptions NoTTY" to disable this.
- Bug 2741 - Apply TimeoutNoTransfer, TimeoutStalled, TimeoutIdle to
 section.
- Bug 2997 - Uploading files with "~" causes harmless but annoying log
message.
- Bug 2889 - Update SQLLog so that RNTO stores the path when using the
%F variable.
- Bug 2731 - Add ability to set process priority for file transfers. A new
TransferPriority directive has been added, which can be used to set the
scheduling priority of the session process during file transfers.
- Bug 3020 - Server replies to NLST with 450 at the wrong time.
- Bug 1771 - mod\_ratio compile warnings.
- Bug 1973 - mod\_ratio uses the too-small int datatype for tracking bytes.
The mod\_ratio module has been updated to use off\_t, instead of int, for
tracking bytes.
- Bug 1896 - Check AIX account status. The AIX-specific loginrestrictions()
and passwdexpired() functions, if present, are now used by the mod\_auth\_unix
module during login.
- Bug 2453 - Separate RFC1413 code into mod\_ident module.
- Bug 3023 - Allow uploading to /dev/null. This allows testing of network
link speeds by uploading directly to /dev/null on the server.
- Bug 3022 - Timed SQL connections don't reconnect to database.
- Added mod\_sql\_sqlite contrib module, for authenticating using a SQLite
database. See doc/contrib/mod\_sql\_sqlite.html for more details.
- Added mod\_sql\_odbc contrib module, for connecting to a database via
ODBC drivers. See doc/contrib/mod\_sql\_odbc.html for more information.
- Bug 3025 - Using %b in a SQLNamedQuery does not properly log the file size
for DELE.
- Bug 3026 - RewriteCondition does not negate -d -f -s tests.
- Bug 3027 - Unmatched backreferences are not handled properly in RewriteRules.
Unmatched backreferences are now replaced with empty strings.
- Bug 2999 - Data transfer not aborted when control connection is closed.
- Bug 3031 - IPv4-mapped IPv6 connections not matched properly against IPv4
glob ACLs.
- Bug 3033 - Class rules not honoring '!' negation character.
- Bug 3034 - Rewritten command parameters need to be set in multiple places.
- Bug 2577 - IPv6 support should be enabled by default. IPv6 support is
now enabled by default in the proftpd build, but the shipping
proftpd.conf has:
UseIPv6 off
To disable IPv6 support completely at build time, use the --disable-ipv6
configure option.
- Bug 2000 - mod\_cap should not use bundled libcap. Now if a system libcap
is present, that system library will be used instead of the bundled libcap.
If no system libcap is present, the bundled libcap will be used.
- Bug 3044 - Segfault if mod\_delay fails to load DelayTable.
- Bug 3048 - mod\_wrap2\_file should support comma-delimited lists of clients.
- Bug 3045 - "QuotaOptions ScanOnLogin" does not work for 'class' or
'all' limits.
- Bug 3047 - BanOnEvent should support optional ban message. Now messages
for individual ban rules can be configured, in addition to the BanMessage
directive.
- Added contrib/ftpmail, a Perl script which reads a TransferLog FIFO and
sends automatic email notifications whenever uploads occur. See
doc/contrib/ftpmail.html for more details.
- Bug 3050 - Support use of OpenSSL in FIPS mode. See doc/howto/TLS.html for
details on how to use FIPS mode.
- Bug 3051 - mod\_quotatab incorrectly reduces file count on rename.
- Bug 2840 - Online Certificate Status Protocol (OCSP) support.
- Bug 3058 - Handling of OPTS command results in badly set values in code.
- Bug 3059 - Wrong handling of UTF8 conversions.
- Bug 3061 - Segfault in mod\_quotatab\_sql if the SQL query returns NULL
bytes/files values.
- Bug 3056 - Support non-UTF8 encoding and character sets. See
doc/modules/mod\_lang.html for more information on the UseEncoding directive.
- Bug 3064 - Better handling of 0xFF character for Cyrillic, non-UTF8 charsets.
These character sets use the same value as the Telnet IAC character in
the alphabet. RFC959 states that FTP control messages must support Telnet
characters; this requirement causes problems for the character sets.
This the RFC959 requirement is relaxed if --enable-nls is used, and if
one of the problematic character sets is configured.
1.3.1 - Released 5-Oct-2007
--------------------------------
- Bug 2944 - mod\_sql\_mysql fails to compile due to missing quotation.
- Bug 2946 - Anonymous logins fail if the mod\_facl module is enabled.
- Bug 2947 - SIGBUS on Mac OS X when dynamically loading shared libs.
- Bug 2950 - Hostname with multiple IP addresses might cause "ai\_family not
supported" error if IPv6 support enabled.
- Bug 2955 - Undeclared identifier MAP\_FAILED for mod\_delay on AIX.
- Bug 2958 - mod\_wrap2 does not handle multiple rules in access files.
- Bug 2963 - Use of -A option for LIST/NLST commands not cleared for
subsequent commands.
- Bug 2964 - Building RPM fails because of \*snprintf trying to be redefined.
This is actually caused by a particular combination of compiler flags
(-O2 and -Wp,-D\_FORTIFY\_SOURCE=2), which are used by the `rpmbuild'
command in some Linux releases.
- Bug 2974 - Install error if multiple modules, using their own build script,
are built as shared modules.
- Bug 2981 - Command-line long options --ipv4 and --ipv6 do not work.
- Bug 2795 - Improvements to RPM .spec file to build more of the modules, plus
better optional packaging organization.
1.3.1rc3 - Released 04-Jul-2007
--------------------------------
- Bug 2875 - Malformed getopt checks cause compilation errors in getopt.c.
- Bug 2877 - ServerType 'inetd' results in "getnameinfo error: ai\_family not
supported" errors in log.
- Bug 2878 - Error compiling proftpd on Solaris 2.9 using --with-lastlog.
- Bug 2881 - ProFTPD does not support OPTS UTF8 command when --enable-nls is
used.
- Bug 2883 - Problem with locale and SQL database queries.
- Bug 2893 - ProFTPD can use the wrong group data if the user name changes.
- Bug 2897 - mod\_quotatab subtracts size of deleted file from bytes-transferred
tally.
- Bug 2902 - Stack read overrun in mod\_xfer on 32bit platform. Use an
explicit compiler cast to ensure that the proper data type size is used
in the arguments for a variadic function.
- Bug 2906 - RewriteCondition backreferences not properly substituted.
- Bug 2913 - TYPE command does not clear ASCII flag from LIST/NLST commands.
- Bug 2911 - NLST on a nonexistent path, followed by an NLST on an existing
file, causes segfault.
- Bug 2922 - Auth API allows one auth module to authenticate user data provided
by a different auth module.
- Bug 2921 - NLST fails if using POSIX ACLs. The mod\_ls module, when
handling the NLST command, was using an unnecessary access(2) check.
- Bug 2864 - DisplayLogin should work regardless of chroot. This now works
for DisplayQuit and DisplayTransferFiles as well.
- Bug 2920 - ABOR command not handled during data transfer.
- Bug 2924 - DeleteAbortedStores doesn't work when the ABOR command is used.
- Bug 2890 - SystemLog permission errors on SIGHUP when mod\_tls is enabled.
- Bug 2932 - Syslog contains "error setting IPV6\_V6ONLY: Protocol not
available". Check the IPV6\_V6ONLY socket option first, and only attempt
to disable it if needed. Also use the IPPROTO\_IPV6 socket level.
- Bug 2934 - Function perm\_copy\_fd() not in older Linux libacl versions.
- Bug 2923 - ftptop display flickers if delay is greater than 25 seconds.
- Bug 2900 - Some kernels incorrectly reuse IPv6 ports for EPSV command.
- Bug 2935 - DELE command doesn't check file stat result before logging.
- Bug 2938 - mod\_wrap2 does not honor WrapTables for  logins.
- Bug 2939 - Anonymous restrictions apply after a failed anonymous login
followed by a successful normal user login.
- Bug 2942 - BanLog directive does not accept "none" parameter.
1.3.1rc2 - Released 12-Jan-2007
--------------------------------
- Bug 2856 - Support for RADIUS NAS-Identifier attribute.
- Bug 2849 - Error msg "Not owner" returned by "SIZE in ASCII mode" is
misleading.
- Bug 2857 - Failure to properly unregister event handlers leads to segfault
after restarts.
- Bug 2869 - mod\_sql botches WHERE clauses.
- Bug 2872 - CreateHome doesn't recreate symlinks from skeleton properly.
1.3.1rc1 - Released 12-Dec-2006
--------------------------------
- Bug 2766 - Support for automatic stack trace if SIGSEGV is received.
- Bug 2714 - mod\_auth\_file munges AuthUserFile, AuthGroupFile records.
- Bug 2721 - mod\_auth\_unix does not behave properly when first in AuthOrder.
- Bug 2535 - Compare directives using integer comparisons when possible to
improve performance.
- Bug 2753 - CCC not closing SSL/TLS connection correctly.
- Bug 2654 - FEAT command should be subject to .
- Bug 2740 - TYPE command not allowed before USER/PASS, causes problem for
`ftp -n'.
- Bug 2777 - ProFTPD does handle data sockets properly on FreeBSD 6.
- Bug 2664 - Add 'delay info' ftpdctl action for showing DelayTable values.
This patch also added a 'delay reset' ftpdctl action, for clearing the
DelayTable.
- Bug 2769 - mod\_auth\_pam needs a patch to allow pam\_group to work.
- Bug 2599 - Support for using OpenSSL "engines".
- Bug 2611 - CreateHome should allow non-root-owned parent directories.
- Bug 2686 - Allow CCC command but still require SSL/TLS protection during
authentication.
- Bug 2628 - SQLHomedirOnDemand should be deprecated. The CreateHome
directive should be used instead.
- Bug 2627 - Support for RADIUS quotatab module. The mod\_quotatab\_radius
module has been added to the contrib/ directory. See README.modules
and doc/contrib/mod\_quotatab\_radius.html for more information.
- Bug 2651 - LogFormat should support variable for logging the response
message. A new %S logging variable has been added.
- Bug 2447 - HAVE\_OPENSSL should be managed by configure. There is a
new configure option, --enable-openssl, which is honored by mod\_ldap
and mod\_sql. This configure option can be used instead of using
the HAVE\_OPENSSL CFLAGS variable, although HAVE\_OPENSSL will still work.
- Bug 2733 - IP TOS not being set for data transfers. Other socket-level
options were not being properly honored for data transfers, too.
- Added mod\_ban. See doc/contrib/mod\_ban.html for more details.
- Enhanced the mod\_sql API to allow other modules (such as mod\_conf\_sql)
to make fuller use of SQL databases via mod\_sql.
- Bug 2713 - Ability to check a user's existing disk bytes/files usage and
update tally accordingly. The mod\_quotatab module now has a QuotaOptions
directive, one of whose parameters is ScanOnLogin, which directs the
module to update existing tallies after scanning the user's home
directory.
- Bug 2786 - REST in ASCII mode returns error but leaves session in
inconsistent state.
- Bug 2785 - IPv4-mapped IPv6 network ACLs not matched properly against
IPv4 connections.
- Bug 2732 - Support for DisplayChdir, rather than DisplayFirstChdir.
- Bug 2506 - Better ability to configure what sort of debug output to generate.
This is done via the new Trace and TraceLog directives.
- Bug 2514 - Trouble with mod\_tls and DSA certificates.
- Bug 2792 - ProFTPD fails after SIGHUP signal when Controls support is
enabled.
- Bug 2775 - Support for DisplayFileTransfer directive.
- Bug 2793 - LogFormat variable for the ProFTPD version. This adds a
"%{version}" variable to the LogFormat directive.
- Bug 2797 - Add ability to force cleaning the scoreboard. This can now
be done using "ftpdctl scoreboard scrub".
- Bug 2800 - free\_proc\_title() in developer build tries to free strings from
pool allocated by mod\_tls.
- Bug 2801 - Error compiling proftpd on NetBSD 3.0/sparc64.
- Bug 2687 - Support for more efficient group table schema. A new
directive, SQLOptions, has been added. One possible parameter of this
directive is 'useNormalizedGroupSchema', in which case mod\_sql will
process the group info table in a more efficient manner.
- Bug 2798 - MDTM should return time in GMT. MDTM responses now always use GMT.
- Bug 2784 - Ability to specify MySQL Unix domain socket path.
- Bug 2610 - Support for logging to /var/log/lastlog. See the RELEASE\_NOTES
for more details on how to use this feature.
- Bug 2710 - ProFTPD should install its header files into the installation
location. The `make install' target now causes proftpd header files,
including config.h, to be installed into a include/proftpd/ directory
in the installation location.
- Bug 2626 - ERROR macro collision can cause compiler errors on HP-UX.
The ERROR, DECLINED, and HANDLED macros have been renamed PR\_ERROR,
PR\_DECLINED, and PR\_HANDLED, respectively. Compatibility macros for
older contrib modules are available.
- Bug 2807 - mod\_sql processes SQLLog QUIT query twice. This bug is a
consequence of Bug 1965.
- Bug 2810 - Incorrect use of assignment instead of comparison in mod\_wrap.
- Bug 2803 - mod\_auth\_file does not properly iterate through AuthUserFile
entries.
- Bug 2809 - conf.h should be included before mysql.h in mod\_sql\_mysql.c.
- Bug 2774 - Idle clients exhibit excessive usage of system resources.
This occurs because of interrupted system calls, which trigger tightly
spinning retry loops within the process. The ability to tune the delay
used in these retry loops has been added to address this behavior.
- Added mod\_wrap2, mod\_wrap2\_file, and mod\_wrap2\_sql. See
doc/contrib/mod\_wrap2.html for more details.
- Bug 2825 - SSL/TLS CRLs are not working properly.
- Bug 2835 - Group quotas not honored for supplemental group membership.
- Bug 2837 - Defines improperly persist across daemon restarts.
- Bug 2839 - ProFTPD seems to re-read the file two times in RETR command.
The problem was one where sendfile() was being used, and the sendfile()
called failed for some reason. In that case, proftpd would fall back
to transmitting the data via normal, non-sendfile() means. If the
sendfile() call had actually sent data to the client already, this
fallback attempt would result in the client receiving too much data.
Now, if there was an error using sendfile(), proftpd logs the error
and considers it a failed transfer due to an I/O error.
- Bug 2756 - Support for TLSPassPhraseProvider.
- Bug 2799 - SQLNamedQuery should support environment variables. SQL
queries defined using the SQLNamedQuery directive can now use
"%{env:VAR}" to have the environment variable VAR substituted into the
query.
- Bug 2828 - Support variables in SQL Where directives. Now the variables
supported for SQLNamedQuery statements, except for "%{n}" numeric
references, are also supported for the SQLGroupWhereClause and
SQLUserWhereClause directives.
- Bug 2842 - Filesystem statcache is not correctly caching return value of
stat().
- Bug 2817 - Ability to disable IPv6 support at runtime. You can now
configure "UseIPv6 off" in your proftpd.conf to disable IPv6 support
(assuming proftpd was compiled using --enable-ipv6).
- Bug 2847 - HiddenStores files not properly removed if data transfer times
out.
- Bug 2848 - Unable to properly parse config files using Windows-style line
endings. Such line endings can appear in the proftpd.conf if the file
is transferred using Windows machines, or using FTP clients that do not
properly translate CRLF to LF when handling ASCII files.
- Bug 2850 - Small event pool allocation on 64-bit machine leads to segfault
on startup.
- Bug 2860 - Failure to check for data length in mod\_tls could lead to remote
buffer overwriting.
- Bug 2863 - LIST of nonexistent file causes RST on data channel.
- Bug 2862 - NLST / returns a listing of the current directory.
- Bug 2867 - Local authorized user buffer overflow in Controls request
handling.
1.3.0a - Released 27-Nov-2006
--------------------------------
- Bug 2858 - CVE-2006-5815: remote code execution in ProFTPD.
1.3.0 - Released 16-Apr-2006
--------------------------------
- Bug 2733 - libtool requires sh/bash.
- Bug 2770 - FreeBSD compiler warning that "\_\_GLIBC\_\_" is not defined.
- Bug 2771 - FreeBSD compiler warning about undeclared fgetpwent/fgetgrent
functions.
- Bug 2772 - FreeBSD compiler warning that "\_FILE\_OFFSET\_BITS" is not defined.
1.3.0rc5 - Released 18-Mar-2006
--------------------------------
- Bug 2757 - Add support for quota modules to RPM spec.
- Bug 2759 - Adding --with-includes to configure can cause problems when
building with other packages. Fixed so that CPPFLAGS and LDFLAGS are
restored to their original settings after running the configure
script. This was a regression (of sorts) from fixing Bug #2708.
- Bug 2764 - REST command does not return an error for negative numbers.
- Bug 2717 - Wrong timestamp in logs for chrooted processes. Ultimately
this behavior looks to be a glibc bug. In the meantime, the workaround
is to manually set the TZ environment variable, if it is not already
set, before calling chroot(). This bug appears to be specific to
glibc, thus the workaround is only enabled on platforms using glibc-2.3
or later.
- Bug 2765 - Child process segfaults while handling a SIGTERM.
- Bug 2723 - mod\_delay causes process to hang on OS X when proftpd exits.
1.3.0rc4 - Released 01-Mar-2006
--------------------------------
- Bug 2703 - Disk quota exceeded for small files not being triggered.
- Bug 2706 - utmp/wtmp logging on NetBSD needs some tweaks.
- Bug 2708 - configure cannot detect some headers. The configure
script now adds the directories mentioned via the --with-includes
and --with-libraries options to the CPPFLAGS and LDFLAGS environment
variables.
- Bug 2711 - Controls socket detection broken.
- Bug 2712 - DisplayFirstChdir directive does not work.
- Bug 2705 - proftpd fails to log anything to syslog after dropping privs
on Solaris. This happens because of the default permissions on /dev/log
on Solaris.
- Portability tweaks for Mac OS 10.4.
- Bug 2729 - Authorative PAM authentication doesn't work. The mod\_auth\_pam
module still had code for supporting the deprecated AuthPAMAuthoritative
directive. As per Bug #2440, however, the AuthOrder directive should
be used for configuring authoritativeness. This fixes mod\_auth\_pam
to behave properly using the new AuthOrder setting.
- Bug 2709 - mod\_sql improperly strips spaces from names, allowing for
confusing authentication.
- Bug 2735 - Allow REST 0 in ASCII mode.
- Bug 2746 - Data transfer function does not return error condition in case of
read errors.
- Bug 2752 - FEAT reply not RFC 2389 compliant.
1.3.0rc3 - Released 31-Oct-2005
--------------------------------
- Bug 2660 - Add mod\_facl in rpm spec file.
- Bug 2662 - OpenSolaris/Solaris 11 has TCP\_CORK but not SOL\_TCP.
- Bug 2667 - mod\_tls handles SIGHUP badly.
- Bug 2668 - mod\_ctrls fails to open socket during SIGHUP.
- Bug 2669 - mod\_radius segfaults if PASS command sent with no USER command.
- Bug 2674 - mod\_sql string escape problem during group lookups.
- Bug 2676 - configure option --disable-ipv6 enables IPv6.
- Bug 2685 - ListOptions' max parameters cannot be set higher than 255.
- Bug 2689 - Parser does not complain about unclosed configuration sections.
- Bug 2695 - Client IP/host is not logged when client exits.
- Bug 2697 - Improper SSL session shutdown sequence used for some FTPS clients.
- Bug 2682 - Signals can interrupt privilege switching.
- Bug 2692 - R\_DUP response messages can break the FTP protocol responses.
1.3.0rc2 - Released 24-Jul-2005
--------------------------------
- Bug 2584 - mod\_sql\_postgres missing end-of-comment character.
- Bug 2587 - HideNoAccess does not work for DefaultRoot/ logins.
- Bug 2590 - AIX uses unsigned int for ULONG\_MAX, causing printf format warning.
- Bug 2591 - wrong argument type in call to pr\_log\_debug in mod\_delay.c on AIX.
- Bug 2593 - `make install-modules' does not honour DESTDIR enviroment variable.
- Bug 2596 - STAT command can cause segfault.
- Bug 2588 - AIX requires \_USE\_IRS #define to use hstrerror().
- Bug 2582 - ProFTPD on Tru64 with SIA does not call sia\_ses\_estab().
- Added new 'dns' control to mod\_ctrls\_admin, for enabling/disabling
UseReverseDNS configuration at runtime. See doc/contrib/mod\_ctrls\_admin.html
for details.
- Bug 2605 - Compiler warnings/errors about missing typecasts on HP-UX.
- Bug 2589 - Makefile in modules/ directory is not portable.
- Bug 2598 - Build system should check for duplicate module requests.
- Bug 2585 - Proftpd does not write RFC 3164 compliant messages into /dev/log.
- Bug 2601 - mod\_delay sometimes delays for a long time.
- Bug 2622 - Segfault seen randomly in mod\_delay.
- Bug 2578 - ProFTPD does not listen on IPv6 addresses on FreeBSD.
- Bug 2624 - "fh\_data" macro collision causes compiler error on Tru64 V5.1A.
- Bug 2250 - Add ports, compiling info to FreeBSD README.
- Bug 2631 - Segfault when using RadiusAcctServer.
- Bug 2632 - Invalid application of `sizeof' to an incomplete type on AIX.
- Bug 2637 -  does not work.
- Bug 2636 - Data connection failure when handling STOR does not trigger
error response.
- Bug 2639 - HiddenStores does not work.
- Bug 2630 - Use of mmap in mod\_delay may be problematic on HP-UX. This
change adds locking of the DelayTable, which may (or may not) also
help on other platforms.
- Bug 2644 - mod\_sql\_mysql should handle old MySQL password format more
gracefully. Starting with MySQL 4.1.1, the format for passwords stored
using the MySQL PASSWORD() function changed. This format change causes
issues for sites that have passwords stored in the older format. Users
of mod\_sql+mod\_sql\_mysql would see this as users being unable to login.
Now, if compiled against MySQL 4.1.1 or later, mod\_sql\_mysql will first
check the password using the current MySQL format; if that fails it
will fall back to checking the old format. Note that this only affects
sites which have "SQLAuthTypes Backend" in their proftpd.conf.
- Bug 2647 - Improper "socklen\_t" redefine for HP-UX when using X/Open.
- Fixed mod\_sql bug where using SQLLog and SQLNamedQuery with the %L or
%a variables, and logging the EXIT pseudo-command, would cause a segfault.
- Bug 2375 - Slow directory listing with several blank .ftpaccess files.
- Bug 2646 - ftpshut format string vulnerability.
- Bug 2645 - SQLShowInfo format string vulnerability.
- Bug 2560 - Reporting errors when user filesystem quota is exceeded.
- Bug 2653 - When MaxStoreFileSize is reached, error should be EDQUOT rather
than EPERM.
- Bug 2657 - Segfault in tls\_get\_error() function in mod\_tls.
- Bug 2658 - Segfault in mod\_radius when using long password.
1.3.0rc1 - Released 10-Apr-2005
--------------------------------
- Bug 2449 - ProFTPD silently ignores extra command-line parameters
- Bug 2457 - Directory listing provides bad info when path ends with /.
- Bug 2458 - Bad handling of CreateHome parameters.
- Bug 2463 - mod\_xfer doesn't check how many bytes it has written to disk.
- Bug 2476 - Incorrect detection of symbolic link loop across devices.
- Add support for a -V command-line option, which displays various
compile-time settings.
- Bug 2455 - Allow fine-tuning of how often mod\_xfer updates the scoreboard.
This adds an --enable-scoreboard-updates configure option.
- Bug 2389 - 64-bit compilation warnings.
- Bug 2468 - Ability to disable address/port collision checking. A new
command-line option, -N, can be used to disable proftpd's checks for
 address/port collisions.
- Bug 2488 - Wrong order of privs calls on HP generates "unable to setregid()"
error (Bug #2317 revisited).
- Bug 2392 - mod\_sql needs better handling of its backend modules.
- Daniel Weuthen  contributed a SuSE-specific init.d script
for ProFTPD.
- Bug 2485 - SQL backend modules close all open connections too early.
This fixes a bug where a "signal 11" would be reported, when a session
ends, if the "EXIT" SQLLog command was configured.
- New mod\_ldap version 2.8.13
- Bug 2490 -  affects PORT command. When the EPRT, EPSV, PASV,
and PORT commands became able (see Bug #2086), they became
affected by  as well, which breaks older configurations.
Using the following configuration:
AllowAll

is a way to workaround this bug in 1.2.10 installations.
- Bug 2492 - Off-by-one error in FreeBSD PAM username length check.
- Bug 2496 - NLST off-by-one bug when handling relative paths in a chrooted
session.
- Bug 2494 - ABOR problem with Cisco routers copy ftp flash.
- Bug 2499 - make\_cmd() does not NULL-terminate cmd->argv[].
- Bug 2497 - Users can login without password if pam\_start() fails.
- Bug 2273 - Ability to limit number of unauthenticated clients from a single
host. There is a new MaxConnectionsPerHost directive for configuring
the maximum number of connections from a single host at the same time.
- Bug 1965 - Change timing of handling of QUIT command. The actual ending
of the session is now done by LOG\_CMD/LOG\_CMD\_ERR handlers for the QUIT
command. This allows modules that wish to do POST\_CMD processing of
QUIT, like mod\_sql, a chance to see the command.
- Bug 2484 - Better ftptop formatting.
- Bug 2071 - Add Variables API.
- Added DSO support. See the README.DSO file for more information.
- Bug 2509 - sendfile() usage fails with > 2GB files.
- Bug 2480 - Remote users discovery. Leon Juranic described an information
leak via timing differences in the handling of the USER command for
valid versus invalid users. The mod\_delay module was added to address
this timing difference. See doc/modules/mod\_delay.html for details.
- Bug 2518 - Ability to log SSL/TLS commands in an ExtendedLog. A
new "SEC" logging class has been added for use in ExtendedLog directives,
e.g 'ExtendedLog /path/to/rfc2228.log SEC'.
- Bug 2507 - Enable use of sendfile by default. Use the new UseSendfile
directive to disable, e.g. 'UseSendfile off'.
- Bug 2471 - Restart command (REST) is not working correctly for text files.
When in ASCII mode, ProFTPD now refuses to handle REST. This behavior
is documented in doc/howto/ASCII.html.
- Bug 2454 - Extend  to honor multiple addresses. With this
change, the Bind directive is now deprecated. See the RELEASE\_NOTES
for more details.
- Bug 2516 - Getting "421 Login Timeout" immediately upon connect.
- Bug 2520 - Turning on AuthAliasOnly disables MaxClientsPerHost.
- Bug 2510 - Use of ExportCertData TLSOption leads to segfault.
- Bug 2528 - Incorrect username 'and' parsing in AllowUser.
- Bug 2170 - Add byte count variables, similar to the file count Display
variables. The added variable names are:
%{total\_bytes\_in}
%{total\_bytes\_out}
%{total\_bytes\_xfer}
In addition, variables of a similar syntax can be used for display
file counts, instead of the already-existing variables:
%{total\_files\_in}
%{total\_files\_out}
%{total\_files\_xfer}
- Bug 2027 - Add log message for timed out passive transfers.
- Bug 2406 - Add a SQLEngine directive. See the mod\_sql documentation
for details.
- Bug 2229 - NLST and LIST behave differently e.g. when listing an empty
directory.
- Bug 2534 - Add suport for -S ListOption, for sorting files by file size.
- Bug 2536 - mod\_ifsession does not properly merge in all directives.
- Bug 2540 - Fails to disable mod\_delay if no DelayTable file exists.
- Bug 2541 -  path resolved at startup time, rather than at
session time.
- Bug 2549 - Allow contrib modules to be built from multiple source files.
- Bug 1651 - Add contrib module to limit connection acceptance based on system
load. mod\_load is now one of the provided contrib/ modules.
- Bug 2503 - Bundled libcap library does not compile on IA64 machine.
- Bug 2556 - Rename of directory across devices fails. The solution is to
prevent renaming of directories. Proper support for copying of directories
will require module support.
- Bug 2563 - Linking fails on Solaris with libz and libmysqlclient. The
linker in question was Solaris ld, not GNU ld; the Solaris linker is
more particular about the order of specified libraries. GNU ld is
less strict.
- Bug 2331 - ProFTPD should honor POSIX ACLs. Please read the README.facl
file for more information on POSIX ACL support in ProFTPD.
- Bug 2573 - TLSProtocol directive in proftpd.conf is ignored. By fixing
this bug, sites may find that a mod\_tls configuration which worked
prior to 1.3.0rc1 now does not work, failing with an error like
"wrong version number" appearing in the TLSLog. To restore the previous
behavior, these sites can use "TLSProtocol SSLv23" in proftpd.conf.
- Bug 2559 - IPv6 socket option should be set for ServerType inetd.
- Bug 2164 - Support non-PASS response codes (i.e. 232).
- Bug 2515 - mod\_quotatab should enforce hard limits at the filesystem level.
- Bug 2567 - Segmentation fault with 64-bit binary due to structure layout
difference.
- Bug 2551 - Recursive LIST with symlinked directories gives duplicate results.
- Bug 2576 - PWD command does not handle " character properly.
- Bug 2493 - mod\_tls should support CCC command.
- Bug 2580 - ProFTPD on Tru64 with SIA allows login with blank password.
- Bug 2554 - mod\_delay gets segfault-signal on several logins.
1.2.10 - Released 04-Sep-2004
--------------------------------
- Bug 2440 - Unable to use PAM authentication properly. Use a "\*" after
the module name in an AuthOrder directive to indicate that an auth
module is authoritative.
- Bug 2441 - AIX5 portability bug with mod\_auth\_unix, mod\_auth\_file.
- Bug 2442 - Segfault in FreeBSD PAM library with long login names.
- Bug 2445 - AuthUserFile in  context overrides  setting.
- Bug 2444 - Use of sendfile() does not interoperate well with RFC2228
security mechanisms. Using sendfile(2) to send data bypasses the handling
of the data by RFC2228 security mechanisms (such as those provided by
mod\_tls). So if security mechanisms are detected, do not use sendfile().
- Scrub the ScoreboardFile for stale sessions in inetd mode.
- Bug 2427 - proftpd gets a memory fault when run from ssh batch mode.
1.2.10rc3 - Released 13-Jul-2004
--------------------------------
- Fixed typo that prevented 1.2.10rc2 from compiling.
1.2.10rc2 - Released 13-Jul-2004
---------------------------------
- Bug 2396 - NLST command doesn't understand options. This was caused by
the solution for Bug 2322. However, it is not a popular solution, so
NLST will once again handle options, but only the relevant options.
- Bug 2034 - Add support for a "graceful shutdown" signal. See
contrib/mod\_ctrls\_admin.html#shutdown for details.
- Bug 2400 -  search order is wrong. The documentation correctly
stated that  sections are matched in order of definition, but the
code has the match order in the reverse order of definition.
- Bug 2401 - MaxClientsPerClass only checks first directive in config file.
- Bug 2399 - Rename start/stop control actions to up/down.
- Bug 2082 - Add mod\_rewrite "replaceall" builtin function. See the
RewriteMap documentation for more details.
- Bug 2403 - Sending SIGHUP to proftpd stops it when using Classes. The fix
for Bug #2400 could result in an infinite loop during a SIGHUP.
- Bug 2405 - "LIST \*" should not list dotfiles.
- Bug 2366 - Add support for -h LIST option.
- Bug 2332 - SO\_OOBINLINE error after upgrading proftpd from 1.2.6 to 1.2.9.
This is due mostly to a change in the logging; a check for error values
and logging of them was added. The setting of this particular socket option
has been moved earlier in the session, as it was found that short-lived
TCP connections, as from monitoring systems, would cause this error.
- Bug 2407 - mod\_auth\_file does not allow for proper cascading of "end" and
"set" auth requests.
- Bug 2410 - CreateHome always copies skel directory.
- Bug 2336 - Use of /dev/log on Solaris leads to kernel memory leak.
ProFTPD's use of the /dev/log device on Solaris was tickling a Solaris
kernel bug that caused the Solaris kernel to leak memory.
- Added a TimeoutLinger directive to complement the --enable-timeout-linger
configure option.
- Bug 2125 - -vv command line switch should list versions of modules.
- Bug 2420 - Name field is not escaped before querying database.
The mod\_quotatab module was not properly escaping the name string it
used when looking up records from SQL databases.
- Bug 2424 - SQLDefaultHomedir overrides column value.
- Bug 2411 - Caching effects cause RNTO to fail if AllowOverwrite is off and
target path does not exist.
- Bug 2422 - %v not working in SQLNamedQuery.
- Bug 2418 - chmod returns 550 with filename containing multiple spaces.
- Bug 2431 - mod\_sql does not use UID/GID properly in cache lookups.
- Bug 2303 - Problem evaluating multiple  rules.
- Bug 2419 - Ability to disable TLSRequired on per-user basis (e.g. for
anonymous logins).
- Bug 2438 - Display variable %z not expanded properly.
- Bug 2439 -  doesn't work.
1.2.10rc1 - Released 28-Apr-2004
---------------------------------
- Bug 2135 - Add ability to handle passphrase-protected server keys. mod\_tls
can now properly prompt for passphrases for protected server certificate
keys when the daemon is starting up.
- Bug 2086 - Add limits for PORT, PASV. This means that now one can use
 to place access controls on the PORT and PASV commands. This
applies to the EPRT and EPSV commands as well.
- Bug 2174 - mod\_auth\_unix should not act authoritatively. This was causing
problems when using mod\_auth\_unix.c and the AuthOrder configuration
directive.
- Bug 2098 - Added SetEnv and UnsetEnv configuration directives.
- Bug 2271 - Improper autoconf check for getaddrinfo() on Tru64 UNIX 5.1.
The getaddrinfo symbol is a macro, not a function, on that platform.
- Bug 2255 - RADIUS Service-Type should reflect attribute expectations.
- Added Event API.
- Bug 2272 - Address/port collision check needs to handle DefaultAddress.
- Bug 2072 - Add Controls API.
This API includes a new program, ftpdctl, that is used to communicate
directly with the proftpd daemon via a new core module, mod\_ctrls. For
this new functionality to be used, proftpd must be configured using the
added --enable-ctrls option.
- Bug 2015 - Add AND, OR keywords to Allow/DenyUser directives.
The AllowUser, DenyUser, AllowGroup, and DenyGroup directives now take
an optional keyword that indicates what type of expression they are:
AND, OR, or regex. By default, AllowUser and DenyUser are OR expressions,
and AllowGroup and DenyGroup are AND expressions. For example:
AllowUser regex ^ftp
DenyUser AND dave,bob
AllowGroup OR web,doc
These demonstrate that the optional keyword modifier must be the first
parameter in the configuration directive.
- Bug 2046 - Change RFNR and RNTO logging class to WRITE. This means that
ExtendedLogs that use the WRITE logging class will now include the
RNFR and RNTO commands.
- Mac OS X 10.3 portability fixes.
- Bug 2274 - Default server only binds to one IP address of host if
the --enable-ipv6 configure option is used. ProFTPD will now properly
bind to all addresses for the default "server config" server.
- Bug 2048 - Add ability to get configuration file values from environment.
For example, you can now have the following in your proftpd.conf:
DefaultAddress %{env:PR\_DEFAULT\_ADDR}
which indicates to ProFTPD's configuration parser to get the value of
the PR\_DEFAULT\_ADDR environment variable, and substitute it in, e.g.:
PR\_DEFAULT\_ADDR=1.2.3.4 ./proftpd ...
If the indicated environment variable is not present, the value is
substituted with the empty string.
- Bug 1635 - Older systems' chown(1) does not support -h option. The solution
is to prevent this error from stopping the 'make install' process, as it
is a harmless error on such systems.
- Bug 2290 - gmtime() static storage may be overwritten by modules.
- Bug 2288 - ServerFQDN set to 255.255.255.255 and not hostname.
- Added mod\_quotatab to the contrib area.
- Bug 2300 - poll() returns 1 and read returns 0, resulting in an infinite
loop. The actual bug was caused by a goto that was being inappropriately
used; a return value was not being checked to see if it was an error value.
- Bug 2305 - Compile Problems since > 1.2.9
Fix the build under Solaris - ftpdctl needs to be linked against libsocket
and libnsl.
- Bug 2267 - Broken IP subnet matching. Added new ACL parsing/matching code.
- Bug 2307 - MySQL 4.1.1 API change causes mod\_sql\_mysql compilation failure.
- Bug 2319 - Build scripts have owner-only execute permission. This was
causing problems whenever a user other than the owner of the files
attempted to build proftpd.
- Bug 2320 - autoconf check for socklen\_t doesn't work on FreeBSD 4.8-RELEASE.
The fix is to include , if present, sooner in the check.
- Bug 1925 - Clean up of Class code. The Class and Classes directives are
now deprecated. See README.classes for more details.
- Bug 2295 - mod\_tls returns multiline response to AUTH commands.
- Bug 2322 - NLST -a returns listing formatted for LIST -a. RFC959 does not
explicitly allow dash-style options for LIST or NLST, although many clients
attempt to use them. De facto FTP server behaviors handle options for LIST;
options for NLST will be explicitly rejected.
- Bug 2315 - Overlapping virtual server causes error. If a
was configured to handle the same IP address and port as the "server config"
server, the wrong server configuration was being removed.
- Bug 2324 - Directories whose names contain whitespace are inaccessible.
- Bug 2306 - ftpcount output should handle case of no users. When no clients
are connected, ftpcount now displays "0 users".
- Bug 2337 - TLSRenegotiate parameters not processed correctly.
- Bug 2340 - Problem with parallel builds. Proper dependencies added when
building ftpwho and ftptop.
- Bug 2327 - SQLNegativeCache causes unnecessary errors in server logging.
- Bug 2237 - HiddenStores does not check for existing file in edge case.
- Bug 2171 - Add delete options to ftpasswd. The ftpasswd script now
supports the --delete-user and --delete-group options.
- Bug 2105 - Remove Authoritative directives. The AuthPAMAuthoritative
directive, and the "\*" syntax of SQLAuthenticate, have been deprecated.
- Bug 1696 - Include directive should support directories. The Include
directive now functions just like Apache's Include directive, including
handling glob characters.
- Bug 2311 - MaxClients counts unauthenticated users. According to the
documentation, the MaxClients configuration directive should only count
authenticated clients.
- Bug 2339 - STAT command doesn't follow RFC959. Previously, ProFTPD did
not support use of the STAT command during file transfers. This
functionality is now implemented. Sites wishing to prevent this can
limit use of the STAT command by using .
- Bug 2257 - Add SITE SYMLINK command to mod\_site. Rather than adding
this command to the mod\_site module, a new module, mod\_site\_misc, has
been added to the contrib area. The mod\_site\_misc module implements
SITE SYMLINK, and a few other SITE commands. See contrib/mod\_site\_misc.html
for details.
- Bug 2355 - Send error message to client when 'TLSRequired on' is in effect.
Previously, if SSL/TLS was configured to be required for both control
and data channels, if the client did not perform the SSL/TLS handshake for
a data transfer, the connection would hang. Now, an error message is sent
to the client if no handshake is done.
- Bug 2353 - REST doesn't handle offsets greater than 2 GB.
- Bug 2357 - ftptop should use COLS for determining display width.
- Bug 2321 - FTP permission checks inconsistent for DELE and RMD/XRMD when
symlink is in directory path. This bug affected the RNFR command as well.
- Bug 2361 - Second USER command causes problems with chrooted session.
- Bug 2363 - ABOR response RFC 959 compliance. The 226 response was being
sent before closing the data connection; RFC 959 implies that the data
connection is closed first.
- Bug 2369 - EPSV should not send network address when MasqueradeAddress is
used. RFC 2428 does not address the case where a server may wish to
return an address in the EPSV response that differs from the control
connection address, as is done in a PASV response for forwarding devices
(e.g. NAT, firewall). Until the proper behavior can be determined,
do not honor MasqueradeAddress for EPSV.
- Bug 2367 - LIST \*.\* strange behaviour. The builtin listing mechanism
was inadvertently recursing into globbed directories when recursion was
not actually requested.
- Bug 2371 - ftpasswd should have option to compare password against value
in passwd file. ftpasswd now supports a --not-previous-password option.
- Added a `howto' directory under `doc/', for mini-HOWTOs.
- Bug 2221 - proftpd on hp-ux 11.22. The default data type of socklen\_t
on HP-UX 11 is problematic; many system calls expect an int, and the
default type is a size\_t. This mismatch causes problems for 64-bit
builds.
- Bug 2385 - Renames fail with error "Invalid cross-device link".
- Bug 2383 - mod\_ctrls.c: ctrls\_listen(): Invalid size in bind() argument.
The size of struct sockaddr\_un is not consistent across platforms.
- Bug 2387 - PRIVS\_USER macro should set effective GID to user's primary GID.
- Added a `modules/' directory under `doc/', for core module documentation.
Currently there are HTML docs for mod\_auth\_file, mod\_cap, and mod\_ctrls.
- Bug 2317 - Wrong order of privs calls on HP generates "unable to setregid()"
error.
1.2.9 - Released 31-Oct-2003
---------------------------------
- Bug 2181 - The prior fix for Bug#2181, handling of the PORT command when the
--enable-ipv6 configure option is used, was not quite correct. A problem
still existed when an IPv4 client used the PORT command when talking to
an IPv4-only vhost (as opposed to an IPv4 and IPv6 vhost). Now PORT is
properly handled in all cases.
- Bug 2204 - On systems that use the gethostbyname2() function, IPv4 clients
were not being properly resolved to their DNS names.
- Bug 2242 - proftpd reread included additional config as user nobody instead
of root. The bug was caused by configuration directive handlers
(specifically, SyslogFacility and SystemLog) that would incorrectly change
the process privileges; depending on the order of configuration in
proftpd.conf, some Included files might not be parseable due to permissions
problems.
- Bug 2197 - The RPM .spec has been updated for easy RPM builds from CVS
snapshots.
- Check for excessive length of symlink directory listing entries (submitted
by Michael Hendrickx )
- Two memory leaks, seen mostly during recursive directory listings, have
been fixed.
1.2.9rc3 - Released 15-Oct-2003
---------------------------------
- Bug 2167 - getnameinfo() on FreeBSD doesn't support IP address lookups.
- Bug 2176 - getnameinfo() error on Cygwin during startup.
The sa\_family member of the address was not being properly initialized
in some instances.
- Bug 2179 - ROOT\_UID instead of ROOT\_GID used in setegid() call.
This affects Cygwin installations.
- Fixed ASCII file remote exploit discovered by X-Force at ISS:
http://xforce.iss.net/xforce/alerts/id/154
- Bug 2181 - IPv4 active transfers don't work when using --enable-ipv6.
IPv4-mapped IPv6 addresses were not being properly compared for active
data transfers.
- Bug 2200 - Correct segfaults with xlate\_ascii\_write() on IRIX.
- Bug 2024 - DefaultServer not functioning properly.
The addition of the Bindings API in 1.2.8rc1 inadvertently caused the
DefaultServer directive to not be properly honored in some configurations.
- Bug 2183 - Directory configuration lookups broken in 1.2.9rc2 (same as
Bug 2165).
- Bug 2191 - Segfault in mod\_sql\_mysql when using 'Backend' SQLAuthType.
This happens only with MySQL 4.1. In MySQL 4.1, the way in which MySQL
handles its passwords changed, and mod\_sql\_mysql was using the new
interface incorrectly.
- Bug 2202 - AllowLogSymlinks check is flawed.
Calling open(2) on a path that is a symlink will follow that symlink;
the AllowLogSymlink check assumed that open() did not follow the symlink.
The fix is to use the O\_NOFOLLOW flag when opening log file paths. However,
this flag does not exist on Solaris machines, and so there still exists
a race condition on Solaris when checking that a log path is not a symlink.
- Bug 2188 - Wildcard sockets not properly handled on FreeBSD.
Similar to bugs 2167, the sin\_len/sin6\_len members of socket structures
were not being properly set for wildcard sockets.
- Bug 2204 - Reverse DNS lookups not happening properly on connected clients
on FreeBSD. The gethostbyname2() function needs to be used on FreeBSD.
- Bug 2222 - Overlapping vhosts should warn instead of die.
Prior to 1.2.9rc1, it was possible to have multiple vhosts configured that
resolved to the same IP address/port combination. This typically occurs
when DNS names are used, and different DNS names resolve to the same IP
address. In 1.2.9rc1, these collisions are scanned for, and such collisions
are treated as a fatal error. With this change, such colliding vhosts
are handled similar to vhosts that have unresolvable names: they are
logged, then removed from the in-memory list of vhosts.
1.2.9rc2 - Released 11-Sep-2003
---------------------------------
- Bug 2051 - freebytes in TransferRate does not work properly.
- Bug 2043 - Proftpd converts LF to CRLF on PUT on Cygwin. This turned out
to be caused by the Cygwin layer. The fix was to use the Cygwin-specific
O\_BINARY open() flag when opening binary files on Cygwin.
- Bug 1804 - Permit selection of additional contrib modules when building
the RPM
- Bug 2074 - MaxStoreFileSize restriction capabilities ignored. This bug
was affecting MaxRetrieveFileSize as well.
- Bug 2075 - LIST / fails under Cygwin. This was due to the addition of
an additional path separator character; Cygwin treats paths that start
with "//" differently than paths that start with "/".
- Bug 2076 - The --enable-transfer-buffer-size configure option doesn't work
properly. It was overriding the --enable-buffer-size option, rather than
the corresponding tunable buffer size.
- Bug 2069 - Long MKD path causes truncated server response.
- Fixed handling of %N/%y in DisplayConnect files.
- Bug 2083 - "550 Access denied" on group permission with AuthGroupFile. This
was caused by a strictly linear search in the AuthGroupFile from the
current file pointer to end of file, which (depending on the ordering of
entries in the file) might have skipped necessary group entries.
- Bug 2088 - proftpd -t segfault. A very specific configuration would cause
a segfault in the configuration parser: if the first sub-context in a given
context (e.g. a  context within a  context) was empty,
the removal of that empty context from the internal structures by the
parser would inadvertently trigger a segfault later. This has been
fixed by using a better memory pool, with a longer lifetime, for allocating
the internal configuration structures.
- Bug 2090 - mod\_rewrite doesn't compile on Solaris 8. The FIONREAD macro
was undefined, due to a strange necessity in the Solaris system headers
for a missing flag.
- Bug 2100 - Invalid domain in  tag causes segmentation fault.
- Fixed handling of mod\_tls' TLSCertificateChainFile directive.
- Bug 2103 - AuthAliasOnly in server context causes hang.
- Bug 2110 - Segfault if gethostname(2) returns NULL.
- Bug 2113 - mod\_sql default uses mysql keyword "password". The default
has been changed to "passwd".
- Bug 2115 - ftptop depends on snprintf but doesn't link in lib/libsupp.a
on snprintf-less platforms
- Corrected handling of mod\_tls' TLSCACertificateFile and TLSCACertificatePath
directives so that they are properly allowed in  and
contexts.
- Bug 2119 - FEAT response format does not conform to RFC2389. Extraneous
leading whitespace removed.
- Fixed file descriptor leaks that occur if mod\_tls encounters errors when
handling CA certificate files.
- Bug 2118 - mod\_sql's %F doesn't work for DELE command; %f is inconsistent.
mod\_sql's handling of cookies is now updated to match mod\_log.
- Bug 1711 - IPv6 support. Support for EPRT and EPSV added. To enable IPv6
support, use the new --enable-ipv6 configure option.
- Bug 2130 - %y in DisplayLogin is not updated correctly.
- Bug 2137 - NLST and IgnoreHidden causes segfault.
- Bug 2142 - sstrncpy() not available to lib/vsnprintf.c. sstrncpy() is now
implemented in the support library (libsupp.a).
- Bug 2144 - Rework autoconf handling of --enable-sia option.
- Bug 2147 - Segmentation fault processing file in ASCII mode.
- Fixed mod\_ifsession's handling of multiple configuration sets.
- Bug 2148 - Enforce PR\_TUNABLE\_LOGIN\_MAX.
- Bug 2141 - Glob Allow/Deny parameters cause extraneous log messages when
comparing addresses.
- Bug 1804 - RPM spec file improvements
The spec file now has xinetd support, builds under newer version of RPM,
installs standalone support with the main proftpd RPM, and accepts --with
mod\_modname arguments during the build process.
- Bug 2127 - Entry in the file section
The RPM spec's %files section now honors the install prefix.
- Bug 2108 - IgnoreHidden should not hide dotfiles
Dotfiles are now displayed when the -a argument is supplied, even when the
IgnoreHidden directive is enabled. To replicate the old behavior of hiding
dotfiles no matter what, use either of the following directives:
ListOptions "" strict
HideFiles ^\..\*
- Bug 2146 - DNS names not handled properly when --enable-ipv6 is used
DNS names with both A and AAAA records were not being properly handled;
listening sockets for both the IPv4 and IPv6 addresses were not being
established.
- Bug 2007 - autoconf header detection problem.
On FreeBSD and other platforms, changes in autoconf require that headers
be included in the proper order during configure's check.
- Bug 2153 - Small error in handling PR\_AUTH\_RFC2228 authentication code
- Bug 2154 - SQL query loses shell information.
An index was not being properly incremented in some cases when retrieving
user information.
- Bug 2161 - Duplicate autoconf check for sia.h.
- Bug 2122 - EAGAIN on Solaris can cause an infinite loop.
Under certain conditions, when reading from a descriptor on Solaris,
EAGAIN can be returned, which proftpd did not handle properly.
1.2.9rc1 - Released 15-May-2003
---------------------------------
- Bug 1828 - mod\_sql can only find mysql.sock if in /tmp. This was caused
by the fact that mod\_sql\_mysql did not load/read the MySQL .cnf
configuration files. Now, when starting, mod\_sql\_mysql will read .cnf
files for "client" sections.
- Bug 1960 - Add removed file size by DELE command to xferlog.
- Bug 1967 - Add display of uptime to ftpwho, ftptop.
- Added AnonRejectPasswords directive.
- Added ftpshut -R command-line option, for deleting the ftpshut shutdown
file.
- Bug 1972 - %T not correctly shows time at performance of a command "rename".
This was due to improper use of uninitialized data.
- Bug 1794 - Scoreboard format changes.
- Bug 1979 - Add TLSTimeoutHandshake directive. This adds a directive to
configure a timer when SSL/TLS handshakes are occurring, to prevent
a malicious client from attempting to DOS a TLS-enabled server. The default
timeout is 5 minutes.
- Bug 1869 - Add option "-S/--server" to ftpcount, ftptop, ftpwho. This
option can be used to specify a ServerName; the utilities will then
display information for that specific server.
- Bug 1980 - Login with incorrect password possible when using mod\_radius.
This was caused by the retaining of the OK state when a user authenticated
via RADIUS, but the login process later fails (e.g. home directory
inaccessible or something similar); subsequent logging in as a different
user would succeed because the OK flag was not cleared.
- Added contrib module mod\_ifsession-0.9rc6.
- Bug 1932 - Make Max\* checks a PASS POST\_CMD handler. One of the consequences
of this change is that the Max\* limits will always be enforced after the
PASS command has been sent, not after the USER command (as used to be done).
Also, MaxHostsPerUser and MaxClientsPerUser limits will be determined using
the locally resolved username, not using any user aliases.
- ProFTPD now checks for IP address/port collisions in the configuration
file, and will refuse to start unless all configured server contexts
have unique IP address/port combinations.
- Bug 1969 - Add scoreboard-scrubbing timer. The scoreboard will be scanned
now every 30 seconds for entries with invalid PIDs; this timer can be
adjusted using the PR\_TUNABLE\_SCOREBOARD\_SCRUB\_TIMER #define.
- Bug 1921 - Socket-level performance tweaks. This change deprecates the
tcpReceiveWindow and tcpSendWindow configuration directives, replacing
them with a single SocketOptions configuration directive. This new
directive can be used to tune the TCP send and receive window sizes as well
as the TCP max segment size. A new configure option,
--enable-transfer-buffer-size, is also added, to be used for tuning the
size of internal buffers used for file transfers. Using this option to
configure an 8K buffer size often results in higher transfer speeds.
- Bug 1849 - Compile can have trouble finding mysql.h. The MySQL backend
module was assuming that mysql.h would be found in a directory named
"mysql"; for some distributions this is not the case. Similarly for
the Postgres backend module and the libpq-fe.h file. Users may need to
alter the --with-includes configure option used when building mod\_sql.
- Bug 1915 - Unsafe pointer usage in scoreboard file format.
- Bug 1983 - Filenames beginning with '#' fail to upload/download.
- Bug 1985 - mod\_rewrite fails to build on platforms without flock().
- Bug 1730 - mod\_sql\_mysql logging of long transfers fails. This turned out
to be caused by the default MySQL timeouts on non-interactive sessions
(8 hours). The fix involves marking mod\_sql\_mysql sessions as interactive;
this means that users may use the 'interactive-timeout' option in their
.cnf files to override the default interactive session timeout (also 8 hours).
- Bug 1989 - SQLLog '\*' doesn't match any commands.
- Bug 1986 - mod\_rewrite backreferences not zero-based (use $1 not $0?). The
bug here turned out to be an off-by-one offset; mod\_rewrite was starting
at 1 when examining matched groups, rather than 0. Most of the time $0 will
not be what is desired, however, for $0 refers to the original string being
matched.
- Bug 1987 - mod\_rewrite seems not to handle more than one backreference.
- By default, mod\_tls will now turn manually turn RSA blinding on, when
OpenSSL older than 0.9.7b is used, in order to thwart certain timing attacks
possible against RSA operations. The following URL contains more information:
http://www.openssl.org/news/secadv\_20030317.txt
- Bug 1995 - incorrect handling of curses/ncurses header and libraries in
ftptop
- New mod\_radius directives: RadiusGroupInfo, RadiusVendor. mod\_radius
now looks for custom response information in Vendor-Specific Attributes
(VSAs) rather than the normal RADIUS attributes; VSAs are more flexible.
- Fixed a bug with mod\_tls' use of SSL\_shutdown(), to prevent it from hanging
when interacting with some buggy FTPS clients (e.g FlashFXP, SmartFTP)
- Bug 1935 - mod\_ls memory leak. When a recursive directory listing is
requested (and allowed), proftpd would use its memory pool system,
allocating memory for every file to be listed. For large/deep directory
structures, this memory usage could grow quite large. And, due to the
way in which the underlying memory allocator (the C library, usually)
works, that memory is never really released back to the operating system.
This means that tools like ps and top reporting a never-shrinking memory
footprint for the process. To help alleviate this, proftpd has been
altered to use malloc/realloc when providing recursive directory listings,
making the memory footprint a little smaller. The caching behavior of
the underlying memory allocator cannot be changed, though.
- Bug 1997 - UnixWare 7.1.3 & port 20.
- Bug 1998 - Add ListOptions for setting limits on -R listings. New
keywords have been added to the ListOptions directive: maxdepth, maxdirs,
and maxfiles.
- Bug 2011 - No "FTP session closed." msgs written to logfile. This affected
only inetd-run servers.
- Added two new configure options, --disable-curses and --disable-ncurses.
By default, ftptop will use ncurses if available, then curses (if available).
In some cases, both curses and ncurses may be present, and yet the admin
would prefer ftptop to use curses. Using the above options, one can
disable ftptop's use of ncurses or curses, as needed.
- Bug 2016 - man pages should be autogenerated to reflect the --prefix used.
- Bug 2018 - Incorrect caching of TransferRate values.
- Bug 1813 - configure code: mistake in BSD sendfile semantic detection.
- Bug 2019 - proftpd support for Solaris 8/9 native sendfile
- Bug 2002 - Per- PathAllowFilter/PathDenyFilter.
- Added RootRevoke directive.
- Bug 2021 - Inetd mode and scoreboard format changes.
- Bug 1532 - Human readable disk free cookie. Display\* files can now make
use of a %f magic cookie for displaying the available disk space with
units (i.e. KB, MB, GB, etc). This compliments the currently available
%F cookie, used to display the number of bytes of available space (without
units).
- Bug 2003 - mod\_auth.c does not compile for cygwin on W2K.
- Bug 2029 - Rewrite rule may execute more than once if multiple
RewriteConditions exist. This turned out to be caused by mod\_rewrite's
merging down of its directives, and the way in which multiple occurrences
of directives are handled. Now, even for merged-down mod\_rewrite directives,
a given RewriteRule will only be processed once.
- Fixed minor fd leak where listening socket descriptors were not being
properly closed in a session process, when the session is first starting.
- Cygwin compilation/portability fixes.
- Fixed bug where AllowForeignAddress was not properly blocking "bounce"
attacks in some cases. Patch contributed by Patrick Hardy .
- Bug 2032 - AuthOrder not working when first option is mod\_auth\_file.c. This
was caused by mod\_auth\_file's returning of an ERROR condition, rather than
DECLINED, when the module could not obtain the user's encrypted password
for verification.
- Bug 2047 - 1024 or more chars in .ftpaccess causes lockup. Certain conditions
allowed for parsing of configuration files to enter an infinite loop.
- Bug 2031 - Add support for flags for RewriteCondition, RewriteRule
(a la Apache's mod\_rewrite). mod\_rewrite now supports various tests that
can be used in RewriteConditions, the NC and OR flags for RewriteConditions,
and the NC and L flags for RewriteRules.
- Bug 1977 - Add %u variable support in configuration file. With this feature,
one can configure DefaultRoot paths such as /home/%u/public\_ftp, and the
%u variable will be expanded to the logged in user name.
1.2.8 - Released 04-Mar-2003
---------------------------------
- Bug 1863 - Unable to build under UnixWare 7
- Bug 1943 - Unable to install on FreeBSD 5.0. FreeBSD 5.0's header files
have been rewritten, and glibc's glob.h collided with the new files. The
fix was simply to use size\_t, rather than trying to determine and use
\_\_size\_t (glob.h was intended to be used during library compilation, not
during application compilation).
- Bug 1950 - OSX setgrent(3) returns int, causing compiler warning. Unlike
most other Unix flavours (but like FreeBSD), OSX's setgrent(3) returns
int, rather than void. A configure check was written to test for this.
- Bug 1949 - Compiler warns of 'long double' usage on OSX. Typecasts have
been added to quell some warnings, and an autoconf check added for compiler
support for -Wno-long-double to quell others.
- Bug 1952 - Umask Bug: Server Not Honoring VirtualHost Umask. This was
a statcache caching effect bug.
- Bug 1916 - Transfers hang with strange transfertime in logfile. This
appears to have been due to use of an uninitialized value.
- Bug 1948 - mod\_xfer relinquishes privs before chmod takes place. In
places where UserOwner is used to "give away" files, the chmod() attempt
that follows the chown() (used to preserve permissions sometimes altered
by the operating system's chown(2) call) did not use root privs, and thus
the client did not have permission to write the file.
- Added FTPS FEAT responses, as per Section 5 of the FTPS Draft.
- Bug 1956 - Upload transfer rate broken. The wrong variable was being used.
- Bug 1941 - SCO OpenServer 5.0.5 issues. Fixing this bug required adding
more autoconf portability checks.
- Bug 1958 - ftpwho -o oneline has newlines when client is idle.
- Bug 1908 - ExtendedLog to work properly again in  context.
- Bug 1966 - SCO OpenServer 5.0.5 and inetd.
- Bug 1953 - STAT -R does not work. There were some variable initialization
issues in the handling of options for the STAT command.
- Bug 1970 - Transfer time wraps around and causes problems with transfer
speed calculation. This was a reporting problem, mostly. An internal
variable was storing time in microseconds; now using milliseconds.
- Bug 1937 - Transfer hangs when using TransferRate limits on a resumed
download. This turned out to be a misuse of the resumed file position
when calculating the TransferRate.
- Bug 1964 - When uploading to an NFS mounted file system in passive mode
read() get EAGAIN and closes connection. This turned out to be caused
by control messages in the STREAMS device (and thus relevant only to
systems that use STREAMS).
- Portability fixes for FreeBSD-5.0.
- Bug 1976 - Login hangs, spawned process runs in endless loop in mod\_auth.
This was caused by a combination of "AuthAliasOnly on" and UserAlias
directives in which the alias and the username were identical. Different
alias and username in a UserAlias directive is now required.
1.2.8rc2 - Released 29-Jan-2003
---------------------------------
- Bug 1894 - Double chdir into self-referencing symlink fails with
"No such file or directory". The errno value has been changed from
ENOENT to ELOOP.
- Bug 1272 - Requested Addition: DenyFilter by User or DenyFilter by Directory.
AllowFilter and DenyFilter are now extended to  and .ftpaccess
contexts.
- Bug 1671 - new directive SQLLogFile.
- mod\_linuxprivs has been renamed to mod\_cap and is now built into ProFTPD
by default if the host OS (Linux) supports it. autoconf detection code
based on a submission by Mihai RUSU . The mod\_cap
directives are CapabilitiesEngine and CapabilitiesSet.
- Bug 1893 - Apple likes to move things. PAM support works on OS X again.
Submitted by: thesin@users.sourceforge.net (Justin F. Hallett)
- Bug 1826 - Makefiles are a bit icky
- Bug 1904 - Tru64 UNIX 4.0D and sstrncpy()
- Bug 1891 - SGI syslog isn't being written to. Turns out that /dev/log on
SGI is a STREAMS device, just as for Solaris. The fix for this bug works
for IRIX6; earlier versions of IRIX may still see this bug.
- Bug 1919 -  section already configured for $dir needs
clarification. This has been resolved by adding a debug statement (level 2)
to the  handler that reports on the given/resolved paths used.
- Bug 1910 - ProFTPD hangs on SIGHUP. This was triggered by mixing stdio
and regular I/O library calls related to password and group entries.
- Add -Wundef and -Wfloat-equal to CFLAGS (Suggested by Steve Grubb
)
- Fixed broken tcpReceiveWindow and tcpSendWindow configuration directives.
The setsockopt(2) function was being called at the wrong time during the
establishment of the data connection.
- %f for DELE commands was not being properly expanded.
- Bug 1923 - %N magic cookie reports incorrectly. This was an off-by-one
bug.
- %L was reporting the remote IP address, rather than the local IP address.
- Bug 1922 - Server allows RNTO an existing file even with AllowOverwrite
turned off. Now, RNTOs to existing files are denied unless AllowOverwrite
is on.
- ftptop now displays transfer rates in it's "transfer speed" display mode.
Use the 't' key to toggle between ftptop display modes.
- Bug 1926 - AuthOrder doesn't work
- Bug 1918 - AuthUserFile not works normally.
- Bug 1241 - Additional functionality: HomedirOnDemand. This has been added
as a new configuration directive, CreateHome.
- Bug 1734 - Cygwin - Unable to set uid
- Bug 1938 - upload to root directory fails. This was caused by caching
effects.
- Bug 1939 - RLimitMemory seems broken. The problem turned out to be bad
handling of the case where sizes were used without specifying units.
- Bug 1911 - NLST is not being Limited in DIRS. The issue was that directory
paths were not being properly expanded, for purposes of looking up s,
in the handling of NLST.
1.2.8rc1 - Released 28-Dec-2002
---------------------------------
- Bug 1597 - Problems with HP-UX 10/11 trusted systems, mod\_pam, and mod\_unixpw.
- Bug 1482 - Add new %U meta to LogFormat, for logging original username.
- Bug 1683 - Handling of VirtualHosts on startup. Now, rather than dying
when unable to resolve a  DNS hostname when starting up, the
daemon will log the error, and skip the bad .
- Bug 1825 - AUTH macro namespace cleanup. A "PR\_" prefix has been added to
the AUTH\_\* macros, to help prevent namespace collisions. This means that
some third-party auth modules may need to be updated.
- Bug 1806 - Add RFC2389 support.
- Bug 1833 - Add ability to have add'l module initialization callback.
- Bug 1743 - No magic cookie for number of files transfered. New cookies
added for Display\* files: "%i" for total number of files uploaded (read "in")
during a session, "%o" for total number of files download (written "out")
during a session, and "%t" for total number of files transferred (both
uploaded and downloaded).
- Bug 1653 - Complete the FS API abstraction implementation. The Developer
Guide will have the complete details on using this API.
- Bug 1712 - TLS support. mod\_tls-2.0.5 has been added to the distribution.
Many, many thanks to Peter Runestig for his work on this, and for maintaining
his code through so many versions of ProFTPD.
- Bug 1788 - Add ability to configure auth module checking order. This is
now configurable via the new AuthOrder directive.
- Bug 1205 - Add debug option to SystemLog. Actually, this feature request
has been resolved by adding a new DebugLevel configuration directive, so
that a debugging verbosity can be set in the configuration file as well
as on the command line.
- Added mod\_rewrite to distribution.
- Bug 1403 - per-server system logs via ServerLog directive.
- Bug 1605 - MKD and RMD do not log filepaths with %f or %F option in
ExtendedLog.
- Removing the RateRead\* and RateWrite\* configuration directives, and replacing
them with a single new directive, TransferRate.
- Bug 1789 - Add ability to block recursive directory listings. The
LsDefaultOptions configuration directive has been deprecated in favor of
the more feature-rich ListOptions directive.
- Added Bindings API
- Bug 1515 - Enable mod\_log to log into default log / syslog. The ExtendedLog
directive can now take a "path" of the form: "syslog:level", where the
"syslog:" prefix tells mod\_log to log that ExtendedLog data via syslog,
and the "level" informs mod\_log of which syslog level to use.
- AIX sendfile support. Thanks to Andy Igoshin  for the patch.
- 1858 - move "session closed" logging from graceful quit to child exit
sequence. This allows for better log reporting, with respect to sessions
ended through means such as catastrophic death of client, or segfaults.
- Added --enable-devel configure option, for enabling code of interest to
developers
- Bug 1507 - regex pattern matching in [Allow/Deny][User/Group]. This has
been implemented by adding a "regex" optional parameter to the AllowGroup,
DenyGroup, AllowUser, and DenyUser directives. The documentation will
be adjusted accordingly.
- Bug 1882 - SITE chmod 777 filename. The patch for this works
for filename parameters to the SITE CHGRP command as well.
- Bug 1881 - Bug in Function MaxClients. This was caused by an off-by-one
bug in the handling of non-anonymous settings.
- Bug 1886 - Ftpwho uses too many lines when authenticating.
- Bug 1875 - same radius packet id for start- and stop-accounting record.
- Bug 1883 - socklen\_t patch. Thanks to Andy Igoshin  for the
patch.
- Bug 1885 - -q/--quiet option for use with the -n/--nodaemon flag. Useful
for running proftpd from inittab or with daemontools.
- Bug 1677 - Integrate ProFTPD with C2/SIA on Tru64 Unix. The --enable-sia
configure option has been added.
- Bug 1837 - Add module specifically for handling Auth\*Files, providing
finer-grained control. The new mod\_auth\_file module is compiled in by
default, and can be disabled using the --disable-auth-file configure option.
For consistency, mod\_unixpw.c has been renamed to mod\_auth\_unix (and now
has a --disable-auth-unix configure option), and mod\_pam.c has been renamed
to mod\_auth\_pam.c (with an explicit --enable-auth-pam configure option).
- Bug 1900 - ftpwho's output on uploads. ftpwho now reports "n/a" rather than
"0%" on uploads, for the server does not know how large of a file is being
uploaded in advance, and cannot determine a "percentage done" value.
- Bug 1888 - Increase mod\_linuxprivs configurability. Two new directives,
LinuxPrivsEngine and LinuxPrivsCapabilities, are added.
- Bug 1905 - AIX needs "config.h" included before \*anything\* else.
- Bug 1903 - ftpwho depends on snprintf but doesn't link in lib/libsupp.a
Primarily of issue under Solaris 2.5 and Tru64 4.0D.
- Bug 1863 - Unable to build under UnixWare 7
- Bug 1906 - Add description strings to AC\_DEFINE
1.2.7 - Released 05-Dec-2002
----------------------------
- Bug 1840 - Problem with syslog default destination on HP-UX. HPUX uses
a default device of /dev/log.un rather than /dev/log.
- Bug 1844 - DisplayLogin %y macro is off by 1. Consequence of scoreboarding
code changes.
- Bug 1838 - Since 1.2.6: in add\_useralias() setting flag CF\_MERGEDOWN breaks
aliased anonymous functionality. The fix was to set the CF\_MERGEDOWN flag
only if the UserAlias directive is not being used in the
context.
- Bug 1812 - Double logging lines for ExtendedLog. No need to merge this
particular directive down.
- Bug 1848 - undefined reference to `halfdelay'. curses does not seem to
provide this function, as ncurses does. The patch works around this by
using halfdelay() if linking against ncurses, and using nodelay() and sleep()
if linking against curses.
- Bug 1839 - undefined reference to `get\_fs\_size'. Expand BSD
statfs()/statvfs() support beyond FreeBSD.
- Bug 1680 - Error in startup script. Add /usr/local/sbin/ to the included
rc script's $PATH
- Bug 1852 - Proftpd gets signal 11 on "quote site". The mod\_site module
was not properly checking the number of parameters for SITE commands.
- Bug 1856 - TimesGMT acts like default is 'off'. The default for this
directive was inadvertently set to "off", rather than the documented default
setting of "on".
- Bug 1853 - SyslogFacility: unable to open syslog. This turned out to be
due to the fact that /dev/log on Solaris (and other platforms?) is a
STREAMS device, which requires open() and putmsg(), rather than connect()
and send().
- 1846 - File overwrites fail. Tracked down by Sergei Rozinov to involve
uninitialized stack data.
- Bug 1861 - 'ftpwho -v -o oneline' print all connections in one line. This
bug appeared in 1.2.7rc3, a consequnce of Bug#1815.
- Bug 1868 - Wrong cmdopts in ftpcount.c.
- Added custom memory scrubber routine to deal with the issue mentioned in
this Bugtraq thread: http://online.securityfocus.com/archive/1/298598
1.2.7rc3 - Released 15-Nov-2002
-------------------------------
- Fixed configure script detection and handling of ncurses (HAVE\_LIBNCURSES
was not being properly defined).
- Added --enable-scoreboard-buffer-size option to configure script, for
tuning the size of some scoreboard fields (e.g. the full client command
and the current working directory).
- Bug 1287 - Error compile with autoshadow option. AIX does not have
traditional shadow support, and uses other mechanisms. This means that
the --enable-autoshadow and --enable-shadow configure options should not
be used when configuring proftpd for AIX. The configure script has been
updated to detect when these options are used on AIX, and to automatically
disable them.
- Bug 1722 - Can't work magic cookie %F on FreeBSD.
- Make sure session.xfer uses cleared memory so unset structure members
won't contain random values.
- Fixed handling of AuthAliasOnly, broken slightly by Bug#1567.
- Bug 1800 - Proftpd child segfaults when using a PASS without no USER first.
mod\_wrap was making a bad assumption about the USER name being available.
This assumption has been corrected.
- Bug 1803 - Check for SIZEOF\_UNSIGNED\_LONG\_LONG to determine LFS support
breaks some Linux installations
- Bug 1805 - PAM support under Mac OS X
- Bug 1772 - Docs fixup in RPM spec file
- Bug 1398 - there is no log rotate for /var/log/xferlog
- Bug 1814 - class names are truncated in scoreboard entry
- ftptop can now use either curses or ncurses
- Bug 1818 - proftpd doesn't compile on hpux11
- Bug 1760 - AllowOverwrite not operational.
- Bug 1703 - mod\_sql\_mysql compile error. This was eventually tracked down
to an overlap between ProFTPD's bundled getopt implementation, and
MySQL's bundled getopt implementation. To prevent this problem, a new
--without-getopt configure option has been added, which tells the ProFTPD
build process to explicitly not use the ProFTPD bundled getopt
implementation.
- Only link ftptop with lib{n,}curses - it isn't needed in any other
binaries
- Bug 1815 - Patch to add class information to ftpwho (with verbose on)
- Bug 1810 - Wrong permissions assigned to uploaded file. This turned out
to be related to the addition of the statcache code, and its interaction
with the UserOwner and GroupOwner configuration directives.
- Bug 1830 - MaxClientsPerHost (small) Bug. Off-by-one error in the handling
of the MaxClientsPerHost directive, introduced by the change in timing of
scoreboard modifications of the new scoreboarding code.
- ftpasswd now exits with different values, depending on the problem cause.
Thanks to Graham Dunn  for these changes.
1.2.7rc2 - Released 22-Oct-2002
-------------------------------
- Bug 1757 - non-ANSI Syntax in netio.c
- Bug 1735 - Proftpd 1.2.6 compiled on FreeBSD 4.6.2 exits on signal 11
- Bug 1759 - ftpwho shows much more connections than really is. This bug
only occurred for those daemons running in inetd mode.
- Bug 1769 - Lack of supplemental groups can cause segfault. This bug is
a result of the fix for Bug 1666.
- Bug 1770 - Forgetting to check for no IP in string.
- Moved the switching to the User/Group for a vhost up in the order, to occur
before any modules' session initialization callback is invoked.
- Bug 1644 - LogFormat local IP and FQDN tags missing. Added %L to LogFormat
meta sequences for logging local server IP address, and %V for
logging local server FQDN.
- Bug 1785 - Bad handling of symlinks. This bug appeared as a consequence
of Bug#1486's fix, which involved caching of struct stats in
order to effect a speed-up of directory listings.
- Bug 1778 - 1.2.7rc1 fails to link on OpenBSD 3.2-current. The ftptop
utility was not properly utilizing the macro detecting the
presence (or absence) of the ncurses library.
- Adding new configure options (see configure --help) for setting some of
the "tunable" values in options.h via the configure command.
1.2.7rc1 - Released 01-Oct-2002
-------------------------------
- Bug 1649 - setproctitle() prepends and appends process name
- Bug 1666 - Auth modules can return duplicate supplemental groups
- Bug 1654 - Add DESTDIR in Makefile
- Bug 1682 - Broken SyslogFacility requires custom syslog code
- Bug 1076 - Toggle parsing of .ftpaccess files with a AllowOverride
- Bug 1724 - AuthPAM off does not work beginning 1.2.5
- Bug 1593 - mod\_sql doesn't cache failed uid lookups
- Bug 1719 - Add RFC2228 stuff to distribution
- Bug 1663 - Add SITE CHGRP command
- Bug 1725 - disconnect when specify multiple ranges on Allow
- Bug 1253 - No ability to configure address for main server
- Bug 1432 - Pedantic handling of leading whitespace in FTP commands
- Bug 1652 - Add connection-rate limiting mechanism
- Bug 1662 - Define \_GNU\_SOURCE
- Bug 1486 - mod\_ls is extremly slow
- Bug 1669 - Filename meta (%f) not correctly expanded for some commands
in WRITE logging class
- Bug 1065 - New directives to limit file size on upload and download
- Bug 1658 - Separate session/daemon resource limit settings
- Bug 1436 - Feature Enhancement: Timeouts on a  basis
- Bug 1737 - Enhance file hiding via regular expressions
- Bug 1736 - RETR does not handle an inappropriate REST
- Bug 1745 - multiple similar entries in extended log
- Added NetIO API
- Bug 1726 - Cygwin's Makefile inconsistency
- Bug 1713 - Scoreboard changes
- Bug 1395 - Check return values in PRIVS calls
- Bug 1732 - No checking for NULL at inet\_ascii and pr\_fnmatch
- Bug 1687 - Add contrib module for RADIUS authentication, accounting
- Bug 1572 - Need to use pam\_end() to close session on Solaris 8
- Bug 1475 - Minor changes to SITE command handling
- Bug 1748 - SQLLog doesn't work with DELE (no filename with %f)
- Bug 1694 - SQLLog QUIT doesn't execute on connection close
- Bug 1675 - add new MaxClientsPerUser configuration option
1.2.6 - Released 04-Sep-2002
----------------------------
New mod\_ldap (2.8.10)
- Fixed bug in matching of IP addresses introduced by Bug#1701
1.2.6rc2 - Released 15-Aug-2002
-------------------------------
- Bug 1681 - Fixed bug made when adding ,  support
- Bug 1645 - Changed ordering of close() of HiddenStor files slightly
- Bug 1674 - Changed timing of allocation of dynamic buffer (to avoid segfaults)
in the supplied fgetgrent() function, which is used for
AuthGroupFiles under FreeBSD.
- Bug 1697 - Fixed memory leak involving allocated regex\_t \*s and SIGHUP
- Bug 1701 - Fixed/enhanced name/IP matching function by adding matching of
ip1/ip2 to function; it was just name1/name2, name1/ip2 matching.
1.2.6rc1 - Released 02-July-2002
--------------------------------
- Bug 1407 - Removed unnecessary check for prior PORT/PASV in STOR
PRE\_CMD handler (RETR PRE\_CMD handler did not have these checks)
- Added new Define, ,  configuration directives, new
command-line option -D (a la Apache)
- Bug 1556 - Restructuring the way signals are handled, so that signal handling
functions are executed synchronously, not asynchronously
- Bug 1463 - Added reporting of dispatching to auth handlers at debug level 6
- Bug 1258 - Added STOU command handler
- Bug 1534 - Added LFS support
- Bug 1647 - Changed unnecessary use of umode\_t to mode\_t in mod\_ls.
- Bug 1650 - Mergedown bug with LsDefaultOptions directive fixed.
- Bug 1306 - Added a TimeoutSession directive that can be used to set a maximum
time limit on an entire session.
- Bug 1643 - Cleaned up several source code files.
- Bug 1569 - Cygwin support, added README.cygwin
- Bug 1171 - Added handling backslash-escaped newlines in configuration files,
so that a directive can be split across multiple lines using
a trailing \ before the newline character.
- Removed the deprecated AllowChmod and ShowDotFiles configuration directives.
- Bug 1655 - Added support for a -n option when listing directories.
- Bug 1502 - Added a lingering\_close function. As discussed in the bug
report, this may cause issues with some clients; keep an eye
for this, as the timeout (ten minutes) may be too long or short.
- Bug 1664 - Changed mod\_sql to decline UID-to-name resolution if a UID
field has been configured to NULL; similarly for GID.
- Removed mod\_quota.c due to bugs, lack of maintainership. Consult
http://bugs.proftpd.org for a list of the mod\_quota bugs.
- Bug 1667 - Moved definition of USE\_SHADOW, AUTO\_SHADOW macros from command
line into config.h, with the other macros.
- Bug 1628 - Added getgroups auth handler to mod\_sql. The lack of this was
causing some DefaultRoot directives (those that relied on
group-expressions) not be correctly honored, as mod\_sql was
not supplying the groups for the users.
- Bug 1543 - Change mod\_sql to not remove embedded whitespace within a
username, just to strip leading and trailing whitespace.
1.2.5 - Released 08-Jun-2002
----------------------------
New mod\_sql (4.08)
- Bug 1379 - Changed mod\_sql.c to use memset() instead of bzero()
- Bug 1576 - Checks for a NULL pointer in a border case involving use of
SQLHomedirOnDemand
- Bug 1586 - Fixed bad assumption concerning row count involving SQL-provided
group information
- Bug 1625 - Adds compatibility fix to mod\_sql\_mysql for older MySQL libraries
(a function name changed in MySQL 3.23.14)
1.2.5rc3 - Released 30-May-2002
-------------------------------
New mod\_ldap (2.8.6)
- Bug 1612 - Fixed logging of RFC931 usernames in xferlog
- Bug 1595 - Transfers that result in error conditions no longer cause
the data connection to be closed prematurely via data\_cleanup()
- Bug 1627 - Fixed bug in timer code where timers were being blocked
indefinitely, manifesting as non-functioning idle timeouts
- Bug 1521 - Cleanup of function prototypes
- Bug 1379 - Changing remaining bzero/bcopy occurrences to memset/memcpy
- Bug 1394 - ftpstats program is not working
1.2.5rc2 - Released 13-May-2002
-------------------------------
- Added Andrew Houghton to the credits
- Added in the new format FAQ
- Bug 1580 - Minor additions to the RPM spec file to allow RPMs to be built
by non-root users.
- Bug 1546 - PF\_ARGV\_WRITABLE, PF\_ARGV\_WRITEABLE are used mixed. Fixed to
use PF\_ARGV\_WRITEABLE consistently (less changes to make).
- Bug 1608 - src/dirtree.c produces two unnecessary warnings. Fixed to
cast to mode\_t for initialization of variables.
- Bug 1610 - compiling mod\_core.c gives an unneeded/dazzling msg
- Removed legacy documentation, updated licence template, licence update
in ftp.h to include the SSL clause. Updated CREDITS (ML)
- New mod\_ldap (2.8.3)
- Bug 1544 - Daemon does not switch to configured User/Group identity in
 as documented
- Bug 1581 - Changed Hide{User,Group} directive to use pointers for
proper handling of uid\_t/gid\_t types
- Migrated to the new form of the directive list from the pdd sgml sources
(ML)
- Bug 1563 - Moved checking for bad address lookup up, to prevent segfault
when using MasqueradeAddress
- Bug 1567 - Fixed parsing of AuthAliasOnly to honor Boolean parameter
- Bug 1579 - the contrib RPM init.d script make inappropriate use of
ftpshut in a few cases
- Bug 1588 - Examined return value of inet\_get\_conn\_info() to prevent
segfaults for ephemeral TCP connections
- Bug 1570 - Changed MasqueradeAddress context checks in code to match
docs
- Bug 1601 - RNTO handler did not properly cleanup after itself in an
error condition, tickling a later segfault
- Bug 1523 - Amended fix for this bug to include a pool that should prevent
memory leaks for long-running daemons
- Bug 1566 - Changed OpenBSD-specific macro checks to allow for proper
use of sockets
- Bug 1578 - RootLogin's configuration directive handler did not properly
set the mergedown flag
- New mod\_wrap (1.2.3)
- Bug 1509 - removed contrib/genuser.pl (per TJ)
- Bug 1509 - added contrib/ftpasswd utility script (contributed by TJ)
- Bug 1318 - sendfile() semantics incorrect under Linux
- Bug 1450 - Timers removed immediately/alarm() return no longer used for
timing
- Bug 1446 - DefaultServer overrides SocketBindTight
- Bug 1378 - Replace alloca stuff in glibc-glob.c with something more standard
- Bug 1498 -  block failing with mod\_ldap
- Bug 1381 - include/glibc-glob.h fix for Tru64 UNIX
- Bug 1465 - can't bind to port that hasn't been closed by forked child
process
- Bug 1379 - replace bzero/bcopy with memset/memcpy
- Bug 1476 - doc updates
- Bug 1520 - security checks for TransferLogs
- Bug 1435 - AccessDenyMsg for  not working
- Bug 1492 - Bad interaction between HiddenStor and UserOwner
- Bug 1493 - incorrect parsing of AuthUserFile
- Bug 1485 - Adds CF\_MERGEDOWN\_MULTI config\_rec flag
- Bug 1459 - server fails to send response in some cases
- Bug 1533 - use memset correctly
- Bug 1517 - doc update
- Bug 1461 - modules/mod\_unixpw.c pw\_getgroups() makes dangerous assumption
- Bug 1512 - Minor credentials cleanups
- Bug 1516 - wrong response to CDUP/XCUP/XCWD
- Bug 1451 - add\_config\_param\_str() no longer uses permanent\_pool
- Bug 1523 - umask allocation in  moved to permanent\_pool
- Bug 1380 - updated getopt library for Tru64/AIX
- Bug 1468 - segfault with empty .ftpaccess
- Bug 1445 - PID file contents change when attempting to start
the daemon a second time
- Bug 1539 - losing SGID bit on created directories w/ {User,Group}Owner
in effect
- Bug 1537 - doc update
1.2.5rc1 - Released 18-Dec-2001
-------------------------------
- New mod\_sql (4.07)
- New mod\_wrap (1.2.2)
- New mod\_ldap (2.8.1)
- New Directive: UseGlobbing, allows glibc-based filepath globbing
to be disabled.
- Bug 1113 - Make.rules for HPUX incorrectly generated
- Bug 1334 - (should have been in 1.2.4, but was missed somehow)
MaxClients none in VirtualHost forbids connect
- Bug 1368 - umask bug is hopefully squashed for good
- Bug 1389 - fixed hang on PWD
- Bug 1355 - Added POST\_CMD\_ERR handler to API
- Bug 1396 - DenyFilter works only in server config scope
- Bug 1410 - SIGIO now conditionally compiled
- Bug 1281 - Improper checking of server context
- Bug 1364 - Immediate chown() after file creation
- Bug 1415 - Change allowed contexts for Include
- Bug 1430 - Possible bad handling of Directory contexts
- Bug 1426 - sigsegv on `ls ///////////'
- Bug 1360 - Add getgroups abstraction for auth modules
- Bug 1289 - Increase information passed to timer callbacks
- Bug 1341 - Bad tracking of forked processes
- Bug 1400 - Improper use of MODRET\_HASDATA macro
- Bug 1416 - PidFile in  context is unnecessary, even wasteful
- Bug 1429 - Trivial fixes to dispatch reporting
- Bug 1419 - Remove unnecessary colons from PRIVS\_ macros
- Bug 1418 - Slight change to exithandler handling to allow module
finalization slot
- Bug 1392 - Added LOG\_CMD\_ERR cleanup handler for LIST/NLST/RETR/
STOR/APPE/STOU, to defer clearing of transfer counters.
- Bug 1391 - ABOR handler now clears session.xfer
- Check retr\_file for validity when RESToring
1.2.4 - Released 19-Oct-2001
----------------------------
Ooops. 1.2.3 was released with a bug that breaks Umask on
certain platforms. This results in files being mode 0.
- Bug 1348 - Fix for mode 0 problem
1.2.3 - Released 18-Oct-2001
----------------------------
PASS argument now intentionally hidden in the proctitle.
- Bug 1242 - More verbose logging of regex evaluations
- Bug 1343 - Better reporting of command dispatching
- Bug 1335 - Documentation patch
- Bug 1334 - MaxClients none in  now works
- Bug 1344 - QUIT now properly logged.
- Bug 1247 - Allow/Deny now bahave as in <1.2.2 (multiple lines work)
- Bug 1327 - AllowForeignAddress now merges down
- Bug 1280 - datatype fixups
- Bug 1311 - DirFake\* can no longer raise sigsegv
- Bug 1331 - Reverse DNS is now forward checked for security
- Bug 1305 - limits.h is now included if present
1.2.2 - Released 17-Aug-2001
----------------------------
README.mod\_sql update from author
new mod\_sql from author
- Bug 1285 - Documentation updates
- Bug 1278 - pedantic fix to access\_check()
- Bug 1266 - Use of APPEnd could corrupt files
- Bug 1286 - mod\_ls displays set[ug]id bits
- Bug 1145 - DirFakeUser now applies to STAT
- Bug 1216 - xferlog man page update
- Bug 1111 - INSTALL update
- Bug 1262 - Doc update
- Bug 1217 - Doc update
- Bug 1187 - Upstream update to mod\_quota
- Bug 1232 - UserOwner no longer performs chgrp
- Bug 1219 - compilation fix under gcc 3.0
- Bug 1230 - Portability fix for Sol 8 (sparcv9)
- Bug 1169 - Fix bug introduced by 1098, breaking DefaultRoot other
than "~\*"
- Bug 1234 - ABOR now always returns 226 (as per RFC959)
- New mod\_sql from upstream maintainer
1.2.2rc3 - Released 19-Jun-2001
-------------------------------
- Bugs 1164,1020,1134,1190,1207
Documentation updates
- Bug 1215 - Removed setpgid()/setpgrp() from fork\_server()
- Bug 1145 - DirFakeUser can display current logged in user
- Bug 1210 - Possible silent truncation in net-ascii mode
- Bug 1212 - special files (devices, etc) didn't show up in directory
listings.
- Bug 1189 - (again)  dups allowed in
- Bug 1155 - non rfc behavior on filenames with spaces
- Bug 1193 - Error "~" processing while renaming files
- Bug 1203 - negation ('!') notation in Allow/Deny ACL broken
- Bug 1161 - %F magic cookie now displays free space on cwd
- Bug 1151 - Allow  searching in vhost or main server conf
- Copyright/License updated to allow linking to OpenSSL
- Bug 1183 - Removed duplicate find\_class() call
- Bug 1189 -  duping checked for
- Bug 1185 - symlinks in homedirs now resolved at login
- Bug 1149 - Patch to contrib RPM init script
- Bug 1132 - Compilation fix for glibc 2.0
- Bug 1201 - Modifications to contrib/xferstats.holger-preiss
- Bug 1090 - {Allow,Deny}Filter Errors now \*really\* logged
- New mod\_sql (and friends) from upstream maintainer
- Bug 1175 - GNU HURD portability
- Bug 1176 - PWD/XPWD can now be ed
- Bug 1177 - mod\_readme moved to contrib/
- Bug 1155 - HPUX portability cleanup
- Bug 1172 - Compiler clean for getopt code.
- Bug 1170 - Compiler cleanup for pr\_fnmatch code.
- Bug 1169 - Better handling of DefaultRoot/DefaultChdir
- Bug 1168 - variable definitions moved from proftpd.h to main.c
- Bug 1160 - BSD root socket semantics needed for svr4.2mp;UX/4800
- Bug 1156 - USER command now takes an argument with spaces in it
- Bug 1152 - Off-by-one in the PassivePorts code
- Bug 1137 - NLST displayed hidden files
1.2.2rc2 - Released 20-Apr-2001
-------------------------------
The `AllowChmod' directive has been deprecated, and will not work
consistantly. Use  instead.
- Bug 1112 - Compilation fix for IRIX 6.2.
- Bug 1128 - Fixed possibled Linux sendfile() corruption issue.
- Bug 1093 - Checking for world writable log files and symlinks.
- Bug 1094 - AuthUserFile/AuthGroupFile disallow relative paths.
- Bug 1096 - Case sensitivity issues in config, better checking of
RLimit\* directive arguments.
- Bug 1090 - AllowFilter/DenyFilter now logs correctly.
- Bug 1119 - glibc-glob compilation issue on IRIX6.
- Bug 1090 - ExtendedLog should now report ALL events (even errors)
1.2.2rc1 - Released 24-Mar-2001
-------------------------------
- Bug 1085 - Better logging of "User is not a UserAlias" and "Can't find
user."
- Bug 1043 - Fixed possible infinite loop in bandwidth throttling code.
- New RLimit\* directives used to control resource usage on support platforms.
- Bug 1075 - Sub-contexts (, etc) weren't being fully copied from
 to vhosts.
- Bug 1049 - New User/Groups weren't being seen after startup w/out a SIGHUP.
- Bug 1066 - new GNU glob() and friends, which properly limits recursion and
avoids DoS issues. Built-in glob support is now always compiled in to
proftpd regardless of libc support on build platform.
- New directive "MasqueradeAddress", used to emit a "fake" (non-interface) IP
in server ident, magic cookies and PASV commands. Useful for firewalled or
NAT'd networks that are not FTP aware.
- Bug 1044 - New directive "AccessDenyMsg", works just like AccessAllowMsg,
but does the obvious.
- Bug 1055 - Not really a bug, but still .. ftpwho/ftpcount now attempt to
scan proftpd.conf looking for ScoreboardPath, if all else fails
- Bug 1042 -  arbitrarily not matching.
1.2.1 - Released 01-Mar-2001
----------------------------
- A relatively major issue was discovered with session.groups which may cause
any group-expressions inside of  (DenyGroup, etc) to malfunction.
This is the primary reason for the 1.2.1 release.
- Default CFLAGS changed from "-g3 -O6" to "-O2" because it is reported
that -O6 is highly experimental, and including debugging really isn't all
the useful, as someone \_really\_ interested in debugging can edit Make.rules.
- Defining classes without an explicit "Classes On" now generates a log
warning.
- New mod\_sql and mod\_ldap from their respective maintainers.
1.2.0-final - Released 26-Feb-2001
----------------------------------
- Numerous additional bug fixes from Bugzilla. See http://bugs.proftpd.org
for more info.
- New and updated README.\* and INSTALL.
- initgroups() support has been removed, it will be re-added in 1.3 after we
have proper modular support in authentication modules.
- mod\_sql.c, mod\_sql\_mysql.c and mod\_sql\_postgres.c back in, with a new
maintainer (replacements for mod\_sqlpw and friends).
- instead of using kill(pid,SIGCONT) to determine if scoreboard pids are
correct, proftpd now uses kill(pid,0) which should be a lot lighter on
heavy-load systems. Thanks to Rob Schulhof  for pointing
out that kill(pid,0) is both valid AND useful. ;) Also removed some
completely useless and redundant /proc stat code which did the same thing
as kill(pid,0) on linux systems.
- logging to file (via SystemLog) is now done with a single write instead of
two in order to be atomic.
1.2.0rc3 - Released: 05-Feb-2001
--------------------------------
- mod\_sqlpw.c, mod\_mysql.c and mod\_pgsql.c have been REMOVED from the
distribution. They are currently unmaintained and have numerous bugs.
If any kind soul  is interested in maintaining them, they may be
brought back into a future version of proftpd.
- sendfile now defaults to off, use --enable-sendfile at configure
time to enable. Additionally, sendfile is probably fixed.
- initgroups/getgroups new defaults to off, use --enable-initgroups at
configure time to enable (mainly useful for large systems). Be careful,
though, as initgroups/getgroups breaks module handling and will not work
in conjunction with other third-party modules (mod\_sqlpw, etc).
- Passive FTP works properly now (was broken in RC2).
- Compilation problems fixed on some obscure platforms.
- PAM authentication finally works again on Solaris (due to an annoying bug in
Solaris).
- Added the DeleteAbortedStores directive.
- Fixed a minor bug in SITE HELP.
- Eliminated a race when logging in with MaxClients.
- AllowChmod defaults to 'on' now for simplicity and compatibility.
- Honor ExtendedLog NONE.
- Added SyslogLevel directive.
- Added --with-includes option to configure.
- Added --with-libraries option to configure.
- On systems with wtmpx, don't use wtmp at all.
- Handle files that begin with ~ properly.
- Documentation updated for PAM on FreeBSD operating systems.
- NUMEROUS other bug fixes, including many security issues
1.2.0RC2 - Released: 27-Jul-2000
--------------------------------
- Made sure ServerUseReverseDNS was honored.
- Compile problems on various problems.
- Added descriptions for more errors to be more RFC compliant.
- UID/GID handling is more portable now on systems with unusual UID/GID sizes.
- PAM handles should be persistent across jailed environments.
- Various additions to configure to make it more portable and correct.
- AllowChmod works properly now.
- HP/UX sendfile support.
- Cleaned up configure and supporting files.
1.2.0RCl - Released: 11-Jul-2000
--------------------------------
- Fixed a bug in mod\_ls that could cause a crash.
- Fixed a minor bug related to group permissions.
- Fixed a bug in calculating file system size when using statvfs.
- Fixed a bug when a 'TYPE L' directive is passed improperly.
- Fixed Umask directive handling in directories.
- Changed bandwidth throttling to use select() instead of usleep() to work
better across platforms.
- Updated mod\_ldap to 2.5.2.
- Environment is now preserved before trying anything fancy with set\_proc\_title.
- Warn a user if an invalid class is specified in ExtendedLog.
- Logging of transfer times is more precise now.
- mod\_quota now comes with ProFTPD in the contrib directory.
- FreeBSD 4.0 support.
- Unixware support.
- Updated config.guess and config.sub to reflect new platforms.
- Added a %k directive to DisplayQuit that shows a more user-friendly count of
data transferred (ie: 23MB, 1.2GB, etc.).
- Added a -t option to ProFTPD to allow syntax testing of a config file.
- Made config file errors more useful by giving the filename and line number of
the error.
- Added %A, %F, and %m directives to LogFormat to allow for the creation of
CLF-style logs.
- Portability fixes to mod\_tar.
- Timezone is preserved across jailed environments now.
- Slightly optimized directory listing/sorting in mod\_ls as an interim measure.
mod\_ls will be rewritten entirely in 1.3.
- Added a -L option to mod\_ls, so things like mirror work properly with
symbolic links.
- Fixed the 'password shows up where username should be' problem with MySQL
authentication.
- Fixed a potential security problem in setproctitle-enabled systems.
- Documented a buffer issue with CustomLog -- This will be entirely rewritten
in 1.3.
- Fixed a potential buffer problem in mod\_ls.
- Clarified syslog message information in INSTALL.
- ProFTPD will now generate a PID file in standalone operation.
- DisplayReadme now accepts patterns.
- Added AllowChmod directive.
- Allow comments and blank lines in password files.
- \*snprintf emulation was incomplete on Solaris and other platforms with no
\*snprintf implementation.
- PAM now properly registers and closes a session, conforming closer to the PAM
specification.
- More documentation updates.
- Fix a permissions display problem under certain circumstances.
- Minor fixes to classes support.
- AllowForeignAddress now applies to passive connections as well.
- Major performance upgrade to groups initialization. Those that have large
groups shouldn't see the 'hangs forever on login' problems.
- Fixed GroupOwner's semantics and added the related UserOwner directive.
- Added SQLKey, SQLKeyField, and SQLAuthoritative to mod\_sql.
- Fixed access checks for LIST and NLST.
- Cleaned up use of '.' and '..' in mod\_ls.
- Fixed a case where ServerUseReverseDNS wasn't being honored.
1.2.0pre10 - Released: 17-Jan-2000
----------------------------------
- sendfile() handles errors and non-optimal conditions The Right Way(tm).
- install\_group works right in warped cases of having more than one GID 0
group defined. No, don't ask. :)
- sendfile() doesn't log spurious messages unless it's in debug mode now.
- A meaningful error is now generated with bad group files.
- Complex group permissions work correctly now, where they did not in a
rare case.
- Updated included version of mod\_ldap.
- Bandwidth and sendfile() use are now mutually exclusive.
- Corrected minor log issues.
- Fixed various compilation issues on various platforms (isn't this vague :)).
- More informative error messages.
- Minor semi-Y2K issue in mod\_readme fixed (don't ask...look at the code :)).
- Corrected error messages on most commands in cases where an invalid number
of arguments are specified.
- An error message is now generated when ~ expansion is meaningless.
- Invalid host entries don't show up as (null) anymore.
1.2.0pre9 - Released: 27-Oct-1999
---------------------------------
- New support for BSD sendfile() semantics.
- sendfile() deprecates politely on Linux 2.0.x.
- AuthPAMAuthoritative now defaults to False. This should clear up any
confusion on using PAM with AuthUserFile and friends.
- Removed Bandwidth from the documentation.
- Fixed a rare segfault in mod\_auth.
- Logging has changed slightly to be more informative and more consistent.
All messages that get logged are now preceded with
 (remote host[remote ip]).
- mod\_ldap for authentication against LDAP directories is now in place.
- ftpwho/ftpcount -- a grammatical error corrected, and they now build
as seperate binaries.
- Fixed the 'no names, just UIDs' bug.
- Added genuser.pl to facilitate AuthUserFile entry creation.
- Umask now takes an optional second argument, specifying a directory umask.
- Work around FreeBSD's broken setpassent(), and a new option to override
this in fixed versions of FreeBSD's libc (--enable-force-setpassent).
- Generate RPMs for both inetd and standalone versions of ProFTPD.
- Added AuthUsingAlias to allow for more fine-grain control of anonymous
logins.
- Added support for 'TYPE L 8' and 'TYPE L 7' per RFC 959.


=== Content from www.openwall.com_9e787660_20250124_113638.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50EB3B57.5020901@redhat.com>
Date: Mon, 07 Jan 2013 14:17:11 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE Request -- proFTPD (X < 1.3.5.rc1): Symlink
 race condition when applying UserOwner to a newly (ProFTPD) created directory

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/07/2013 09:55 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> proFTPD upstream has recently released v1.3.5.rc1 release: [1]
> <http://proftpd.org/docs/NEWS-1.3.5rc1> correcting one security
> issue:
>
> A time-of-check time-of-use (TOCTOU) race condition flaw was found
> in the way ProFTPD, flexible, stable and highly-configurable FTP
> server, handled MKD/XMKD FTP commands when the UserOwner directive
> was involved. A local attacker could use this flaw to possibly
> escalate their privileges via symbolic-link attacks on
> directories, created by ProFTPD prior the UserOwner ownership was
> applied.
>
> Upstream bug report: [2]
> <http://bugs.proftpd.org/show_bug.cgi?id=3841>
>
> Relevant upstream patch: [3]
> <http://bugs.proftpd.org/show_bug.cgi?id=3841#c8>
>
> References: [4]
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=697524> [5]
> <https://bugzilla.redhat.com/show_bug.cgi?id=892715>
>
> Could you allocate a CVE id for this?
>
> Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team
>

Please use CVE-2012-6095 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJQ6ztXAAoJEBYNRVNeJnmTOzcP/3z4cZl+fw20kpE2dRKsuTVC
El8SgIkwuNAMUJUi2m2SHKqrGqFpJlh+GwneD+hIFsi/eqJR0707ahaEozvqD3f2
oN8JXGLLYvhe/kUL4hloYEb20FtnN9kgwV9/G1p5CuNB5fz/TZhvAb5uKBqDe2FH
onqHMOyHC6GSCwJ4gyNAMHTJxuhTz1WuIBuM5acjtprU+EoDkNyLYC278Lk9j8Vf
MjH5Jnl8FQaDSgpnUeNBHe22sYj8ehBgYrEdLvt1Ths56w61W+M6kXc9Qny6oAmb
45zAym3zBpIOnD/5kyLxB2pOkjuVrY8tSYwJWBB8M7pw1m1uR1+LyF/yLiPhkwc5
+hLDj1gAp9JVs8+r48r297TZcsxfa+/h+JIL7FrYOhN8otWCpCe9L8ev+cBWRoF7
hDso6GFa1sJP2H7WSiLn3PLN6nBNShCKP1K4EC0gnSRWQjTGg/0BzpCWbd01ya5N
qZWqahLGz0nfX8mUp4WfBuXnbQvecwOSet55bf3ic9Aj0vfXetSc8D5OzZRESIS7
i161wLBZYSe86JInouBuYydChz7F3ETioGMRK0LVm4YKxmMTB6a+tYbx0g96+hfm
UGllilhvFg9h4/aQyHY74p8qkpJszp9xm4GfLqfuFV/Rq7NwYM82IkRgR1zBDMeq
iOMH3avIYe+rA859EzEv
=Ck6K
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from secunia.com_1f18020b_20250124_113637.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.debian.org_c36c027b_20250124_113638.html ===


---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)]
[[Thread Prev](msg00007.html)][[Thread Next](msg00009.html)]
[[Date Index](maillist.html#00008)]
[[Thread Index](threads.html#00008)]

# [SECURITY] [DSA 2606-1] proftpd-dfsg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2606-1] proftpd-dfsg security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Sun, 13 Jan 2013 21:35:13 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20130113203513.08FE45AA43%40kinkhorst.com) [20130113203513.08FE45AA43@kinkhorst.com](msg00008.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2606-1                   security@debian.org
<http://www.debian.org/security/>                           Thijs Kinkhorst
January 13, 2013                       <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : proftpd-dfsg
Vulnerability  : symlink race
Problem type   : local
Debian-specific: no
CVE ID         : CVE-2012-6095
Debian Bug     : 697524

It has been discovered that in ProFTPd, an FTP server, an attacker on
the same physical host as the server may be able to perform a symlink
attack allowing to elevate privileges in some configurations.

For the stable distribution (squeeze), this problem has been fixed in
version 1.3.3a-6squeeze5.

For the testing distribution (wheezy), this problem will be fixed soon.

For the unstable distribution (sid), this problem has been fixed in
version 1.3.4a-3.

We recommend that you upgrade your proftpd-dfsg packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJQ8xpIAAoJEFb2GnlAHawE/usH/i2IjOweYkzsTrO5Nkq1kVra
0ycwOWKJt7LQiwfV55s5ieiDXII3d/ite6lE+nsAIPFwFhcT1dKLpsFqCixCQKUk
ZzH3b3HDf0I0VX549wIO6F990blDUFA4SugyLMYnNiOnmyxRo6J9uPUFE0Zx6Dl6
BzulhIeDQsuTbA4QvRLJH9KcBshwXihUQ/Avzw92B4OmJ7tYBDjT/DegU6eI7eRh
LG+gFbGqn0q7HeO+muPxVLCAKUH9sxKjx8zqI9P3biFvlcuCR/HAeYjpgaEUIaXu
Tlo5oS/vLG3w+GzhjNReHyfdISmfMWM6H5kpLX31deaz7kFDb2jSPjTiWeVtyvs=
=5TDn
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.proftpd.org_f3e65b05_20250124_113636.html ===


| Bugzilla – Bug 3841 | Possible symlink race when applying UserOwner to newly created directory | Last modified: 2013-07-26 16:09:30 UTC |
| --- | --- | --- |

| * BG * |    CS * |    DE * |    EN * |    FR * |    JA * |    ZH-TW |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](/doc/bugzilla3-doc/en/html/bug_page.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](?GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](?GoAheadAndLogIn=1#forgot)
  Login:

  [x]

*First*
*Last*
*Prev*
*Next*

*No search results available*

[**Bug 3841**](show_bug.cgi?id=3841) -
Possible symlink race when applying UserOwner to newly created directory

| Summary: | Possible symlink race when applying UserOwner to newly created directory |
| --- | --- |

| | **[Status](page.cgi?id=fields.html#status)**: | CLOSED FIXED | | --- | --- | |  | | | [Product:](describecomponents.cgi) | ProFTPD | | **[Component](describecomponents.cgi?product=ProFTPD):** | mod\_core | | **Version**: | 1.3.3 | | **Platform**: | All All | |  | | | **[Importance](page.cgi?id=fields.html#importance)**: | P2 normal | | **[Assigned To](page.cgi?id=fields.html#assigned_to)**: | proftpd development group | |  | | | **URL**: |  | | **[Keywords](describekeywords.cgi)**: | Backport | | |  | | | Depends on: |  | | Blocks: | [3963](show_bug.cgi?id=3963 "CLOSED FIXED - Improve permission setting when creating directories") ||  | Show dependency [tree](showdependencytree.cgi?id=3841&hide_resolved=1) / [graph](showdependencygraph.cgi?id=3841) | | |  | | **Reported**: | 2012-11-08 22:18 UTC by TJ Saunders | | --- | --- | | **Modified**: | 2013-07-26 16:09 UTC ([History](show_activity.cgi?id=3841)) | | **CC List**: | 6 users (show)  bernd frankie jannhorn johnw paul tomas.klacko | |  | | | [See Also:](page.cgi?id=fields.html#see_also) |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Fixes issue**](attachment.cgi?id=3867 "View the content of the attachment") (9.85 KB, patch)  [2012-11-08 22:23 UTC](#attach_3867 "Go to the comment associated with the attachment"), TJ Saunders | [Details](attachment.cgi?id=3867&action=edit) | | [**Updates previous patch**](attachment.cgi?id=3868 "View the content of the attachment") (12.62 KB, patch)  [2012-11-09 07:44 UTC](#attach_3868 "Go to the comment associated with the attachment"), TJ Saunders | [Details](attachment.cgi?id=3868&action=edit) | | [**Builds on previous patch, adds fix**](attachment.cgi?id=3880 "View the content of the attachment") (8.62 KB, patch)  [2012-12-28 00:00 UTC](#attach_3880 "Go to the comment associated with the attachment"), TJ Saunders | [Details](attachment.cgi?id=3880&action=edit) | | [**Fixes handling/propagation of SUID/SGID bits from parent directory**](attachment.cgi?id=3935 "View the content of the attachment") (1.52 KB, patch)  [2013-02-12 22:38 UTC](#attach_3935 "Go to the comment associated with the attachment"), TJ Saunders | [Details](attachment.cgi?id=3935&action=edit) | | [Show Obsolete](#a0) (1)  [Add an attachment](attachment.cgi?bugid=3841&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3841&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- |  | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

  |

| [Description](show_bug.cgi?id=3841#c0)  TJ Saunders    2012-11-08 22:18:12 UTC  ``` Jann Horn reported that there is a possible race condition in the handling of the MKD/XMKD FTP commands, when the UserOwner directive is involved, and the attacker is on the same physical machine as a running proftpd:    1.  Locally create directory `foo'.   2.  In ftp client, send "MKD foo/etc".   3.  ProFTPD creates `foo/etc/' directory.   4.  Locally move `foo' out of the way.   5.  Locally create symlink `foo -> /'.   6.  ProFTPD applies UserOwner to `foo/etc', changing ownership of /etc.  The race is the time between when proftpd creates the requested directory (step 3) and when proftpd applies the UserOwner ownership changes (step 6); in that time, a local attack can replace the created directory with a symlink that points to some other directory that the local attacker does not control.  Note that using the DefaultRoot directive to restrict sessions mitigates this attack, since the symlinks created by the local attacker will point outside of the chroot(2) area within the FTP session, and thus the ownership change will fail. ```  [Comment 1](show_bug.cgi?id=3841#c1)  TJ Saunders    2012-11-08 22:21:02 UTC  ``` Note that this race applies to mod_sftp and the handling of the MKDIR SFTP request as well. ```  [Comment 2](show_bug.cgi?id=3841#c2)  TJ Saunders    2012-11-08 22:23:17 UTC  ``` Created [attachment 3867](attachment.cgi?id=3867 "Fixes issue") [[details]](attachment.cgi?id=3867&action=edit "Fixes issue") Fixes issue  This patch fixes the issue by using the lchown(2) system call for changing ownership, rather than chown(2).  Thus if a symlink is moved into place, only the ownership on the symlink is changed rather than on the target/victim directory. ```  [Comment 3](show_bug.cgi?id=3841#c3)  TJ Saunders    2012-11-09 07:44:51 UTC  ``` Created [attachment 3868](attachment.cgi?id=3868 "Updates previous patch") [[details]](attachment.cgi?id=3868&action=edit "Updates previous patch") Updates previous patch  This updates the previous patch to also use lchown(2) when applying the UserOwner directive to newly uploaded/appended files, as well as when applying UserOwner to newly created directories. ```  [Comment 4](show_bug.cgi?id=3841#c4)  Jann Horn    2012-11-09 17:56:44 UTC  ``` Hmm, I think `lchown` doesn't protect against symlinks in the middle of the path. Look at the exact wording at <http://pubs.opengroup.org/onlinepubs/009695399/functions/lchown.html> :      The lchown() function shall be equivalent to chown(), except in the case where the named file is a symbolic link.  I would suggest opening the parent folder with opendir() and then using mkdirat() and fchownat() (with AT_SYMLINK_NOFOLLOW) to create the directory and change its ownership. ```  [Comment 5](show_bug.cgi?id=3841#c5)  TJ Saunders    2012-11-09 18:18:53 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=3841#c4)) > Hmm, I think `lchown` doesn't protect against symlinks in the middle of the > path. Look at the exact wording at > <http://pubs.opengroup.org/onlinepubs/009695399/functions/lchown.html> : >  >     The lchown() function shall be equivalent to chown(), except in the case > where the named file is a symbolic link. >  > I would suggest opening the parent folder with opendir() and then using > mkdirat() and fchownat() (with AT_SYMLINK_NOFOLLOW) to create the directory and > change its ownership.  Even the description of the AT_SYMLINK_NOFOLLOW flag for fchownat(2), in the Linux man page, suggests that that approach may not handle symlinks in the middle of the path:         AT_SYMLINK_NOFOLLOW               If pathname is a symbolic link, do not dereference  it:  instead               operate on the link itself, like lchown(2).  (By default, fchow‐               nat() dereferences symbolic links, like chown(2).)  And it appears that some older implementations of fchownat(2) had problems with the AT_SYMLINK_NOFOLLOW flag, for which the workaround was to use lchown(2):    <http://lists.gnu.org/archive/html/bug-coreutils/2006-12/msg00246.html>  Using opendir(3) to get the dirfd argument for mkdirat(2) is non-portable; some Unix implementations go out of their way to make it difficult to get the fd from a DIR *.  Using mkdirat(2) with a dirfd argument of AT_FDCWD might work -- except that proftpd always builds the absolute path when calling mkdir(2), and using the absolute path in mkdirat(2) means that the dirfd argument is ignored, thus making the use of mkdirat(2) equivalent to mkdir(2).  The fchownat(2) system call is also fairly recent (appearing in FreeBSD in 8.0, for example), and thus we have to have fallback/workarounds in place -- in which case, falling back to using lchown(2) is what would happen.  Symlinks in the middle of the path (i.e. leading up to the path specified by the FTP client) can happen normally; I don't think we want to reject changing of ownership due to symlinks in the path leading up to the target path -- it's only symlinks in the path after the target path -- and in your use case, that can only happen when the target path itself becomes a symlink.  And for that case, lchown(2) detects the situation, and does the right thing. ```  [Comment 6](show_bug.cgi?id=3841#c6)  TJ Saunders    2012-11-09 18:25:37 UTC  ``` Another possibility would be to use mkdtemp(3) + lchown(2) + rename(2), to create a temporary directory, set its ownership, then atomically rename it into place.  If the newpath argument exists at the time of renaming oldpath (a directory), then the rename(2) would fail, according to the semantics described in the man page.  I'll be updating the patch to attempt the above, if mkdtemp(3) support is detected via autoconf. ```  [Comment 7](show_bug.cgi?id=3841#c7)  Jann Horn    2012-11-10 14:39:52 UTC  ``` Given the variety of systems you have to support, that sounds like a good approach to me. ```  [Comment 8](show_bug.cgi?id=3841#c8)  TJ Saunders    2012-12-28 00:00:38 UTC  ``` Created [attachment 3880](attachment.cgi?id=3880 "Builds on previous patch, adds fix") [[details]](attachment.cgi?id=3880&action=edit "Builds on previous patch, adds fix") Builds on previous patch, adds fix  This patch builds on the previous one, and adds a new pr_fsio_smkdir() ("secure mkdir") function.  The pr_fsio_smkdir() function uses mkdtemp(3), lchown(2), and rename(2) to securely create the requested directory (and still respects UserOwner/GroupOwner).  The patch updates the core engine as well as mod_sftp to use the new function. ```  [Comment 9](show_bug.cgi?id=3841#c9)  TJ Saunders    2012-12-28 00:03:45 UTC  ``` Patch committed to CVS, and backported to 1.3.4 branch. ```  [Comment 10](show_bug.cgi?id=3841#c10)  TJ Saunders    2013-01-05 00:42:17 UTC  ``` Resolved in 1.3.5rc1. ```  [Comment 11](show_bug.cgi?id=3841#c11)  TJ Saunders    2013-01-07 21:21:03 UTC  ``` For posterity, CVE-2012-6095 has been assigned for this issue. ```  [Comment 12](show_bug.cgi?id=3841#c12)  Paul Howarth    2013-01-10 19:51:33 UTC  ``` (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > Patch committed to CVS, and backported to 1.3.4 branch.  I think there may be a problem with the backport; when I try UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission denied" when trying to create directories. Same with regular users and a <Directory> section if I use DefaultRoot (but OK if I don't).  Tracing fsio and fileaccess, I see this when trying to create ~ftp/uploads/testd3 (which works with 1.3.4b):  Jan 10 19:39:47 [5991] <fsio:8>: using vroot stat() for path '/uploads' Jan 10 19:39:47 [5991] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 10 19:39:47 [5991] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 10 19:39:47 [5991] <fsio:8>: using vroot chdir() for path '/uploads' Jan 10 19:39:47 [5991] <fsio:8>: using vroot stat() for path '.message' Jan 10 19:39:47 [5991] <fsio:8>: using vroot opendir() for path '.' Jan 10 19:39:51 [5991] <fsio:8>: using vroot stat() for path '/uploads/testd3' Jan 10 19:39:51 [5991] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 10 19:39:51 [5991] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 10 19:39:51 [5991] <fileperms:1>: MKD, user 'ftp' (UID 14, GID 50): error making directory '/uploads/testd3': No such file or directory  An earlier try with 1.3.4b did:  Jan 10 15:27:53 [2183] <fsio:8>: using vroot stat() for path '/uploads/testdir' Jan 10 15:27:53 [2183] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 10 15:27:53 [2183] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 10 15:27:53 [2183] <fsio:8>: using vroot mkdir() for path '/uploads/testdir' Jan 10 15:27:53 [2183] <fsio:8>: using vroot stat() for path '/uploads/testdir' Jan 10 15:27:53 [2183] <fsio:8>: using vroot chown() for path '/uploads/testdir'  Is this working for you?  Incidentally, whilst trying this I also found that one of the API tests is failing for me with the 1.3.4 branch:  api/event.c:185:E:base:event_dump_test:0: (after this point) Received signal 11 (Segmentation fault)  I could raise a separate bug for that if you like. ```  [Comment 13](show_bug.cgi?id=3841#c13)  TJ Saunders    2013-01-10 20:12:36 UTC  ``` (In reply to [comment #12](show_bug.cgi?id=3841#c12)) > (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > > Patch committed to CVS, and backported to 1.3.4 branch. >  > I think there may be a problem with the backport; when I try > UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission > denied" when trying to create directories. Same with regular users and a > <Directory> section if I use DefaultRoot (but OK if I don't).  OK, I think I've identified the cause, and fixed it in CVS (both trunk and in the 1.3.4 branch).  I can provide a patch if necessary.  Also, could you provide the config, and the FTP commands sent, for this <Anonymous> test case you're using, so that I can add them to the proftpd testsuite?  > Incidentally, whilst trying this I also found that one of the API tests is > failing for me with the 1.3.4 branch: >  > api/event.c:185:E:base:event_dump_test:0: (after this point) Received signal 11 > (Segmentation fault) >  > I could raise a separate bug for that if you like.  That's OK -- this should now be fixed in the 1.3.4 branch as well.  Thanks! ```  [Comment 14](show_bug.cgi?id=3841#c14)  Paul Howarth    2013-01-10 22:03:24 UTC  ``` (In reply to [comment #13](show_bug.cgi?id=3841#c13)) > (In reply to [comment #12](show_bug.cgi?id=3841#c12)) > > (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > > > Patch committed to CVS, and backported to 1.3.4 branch. > >  > > I think there may be a problem with the backport; when I try > > UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission > > denied" when trying to create directories. Same with regular users and a > > <Directory> section if I use DefaultRoot (but OK if I don't). >  > OK, I think I've identified the cause, and fixed it in CVS (both trunk and in > the 1.3.4 branch).  I can provide a patch if necessary.  The change in fsio.c doesn't seem to have helped here, either for the <Anonymous> or <Directory> cases. Did I miss a change elsewhere?  > Also, could you provide the config, and the FTP commands sent, for this > <Anonymous> test case you're using, so that I can add them to the proftpd > testsuite?  I was testing it manually, just doing mkdir in an ~ftp/uploads directory (and my ~paul/ftptest directory similarly for the <Directory> test) with full permissions for all users.  The config I was using boils down to this:  ServerName                      "ProFTPD server" ServerIdent                     on "FTP Server ready." ServerAdmin                     root@localhost DefaultServer                   on DefaultRoot                     ~ !adm AuthPAMConfig                   proftpd AuthOrder                       mod_auth_pam.c* mod_auth_unix.c UseReverseDNS                   off User                            nobody Group                           nobody MaxInstances                    20 UseSendfile                     off LogFormat                       default "%h %l %u %t \"%r\" %s %b" LogFormat                       auth    "%v [%P] %h %t \"%r\" %s" TraceLog                        /var/log/proftpd/trace.log Trace                           fsio:8 fileperms:10 <IfModule mod_vroot.c>   VRootEngine                   on </IfModule> <Global>   Umask                         022   AllowOverwrite                yes   <Limit ALL SITE_CHMOD>     AllowAll   </Limit>   # Test UserOwner and GroupOwner with <Directory>   <IfModule mod_cap.c>     CapabilitiesEngine on     CapabilitiesSet +CAP_CHOWN +CAP_FOWNER   </IfModule>   <Directory /home/paul/ftptest>     UserOwner                   daemon     GroupOwner                  daemon   </Directory> </Global> <Anonymous ~ftp>     User                        ftp     Group                       ftp     AccessGrantMsg              "Anonymous login ok, restrictions apply."     UserAlias                   anonymous ftp     MaxClients                  10 "Sorry, max %m users -- try again later"     DisplayLogin                /welcome.msg     DisplayChdir                .message     DisplayReadme               README*     DirFakeUser                 on ftp     DirFakeGroup                on ftp     # Test the UserOwner and GroupOwner directives     UserOwner                   daemon     GroupOwner                  daemon     WtmpLog                     off     ExtendedLog                 /var/log/proftpd/access.log WRITE,READ default     ExtendedLog                 /var/log/proftpd/auth.log AUTH auth </Anonymous>  > > Incidentally, whilst trying this I also found that one of the API tests is > > failing for me with the 1.3.4 branch: > >  > > api/event.c:185:E:base:event_dump_test:0: (after this point) Received signal 11 > > (Segmentation fault) > >  > > I could raise a separate bug for that if you like. >  > That's OK -- this should now be fixed in the 1.3.4 branch as well.  Thanks!  That seems to be fixed for me now, thanks. ```  [Comment 15](show_bug.cgi?id=3841#c15)  TJ Saunders    2013-01-10 22:25:14 UTC  ``` (In reply to [comment #14](show_bug.cgi?id=3841#c14)) > (In reply to [comment #13](show_bug.cgi?id=3841#c13)) > > (In reply to [comment #12](show_bug.cgi?id=3841#c12)) > > > (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > > > > Patch committed to CVS, and backported to 1.3.4 branch. > > >  > > > I think there may be a problem with the backport; when I try > > > UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission > > > denied" when trying to create directories. Same with regular users and a > > > <Directory> section if I use DefaultRoot (but OK if I don't). > >  > > OK, I think I've identified the cause, and fixed it in CVS (both trunk and in > > the 1.3.4 branch).  I can provide a patch if necessary. >  > The change in fsio.c doesn't seem to have helped here, either for the > <Anonymous> or <Directory> cases. Did I miss a change elsewhere?  Probably didn't fix your particular use case, but it was necessary for another issue I ran into, when first trying to reproduce this behavior you're reporting.  > manually, just doing mkdir in an ~ftp/uploads directory (and > my ~paul/ftptest directory similarly for the <Directory> test) with full > permissions for all users.  I'm assuming you're using ftp(1) for the manual testing?  If so, could you copy-paste that client view here?  Specifically, I need to know the exact MKD command (and arguments) sent by the client; some clients send different paths for MKD than what was typed/entered by the user.  > The config I was using boils down to this:  Thanks; I'll work on seeing if I can recreate the behavior using this config.  (It might turn out to be related to mod_vroot...) ```  [Comment 16](show_bug.cgi?id=3841#c16)  TJ Saunders    2013-01-10 22:49:57 UTC  ``` (In reply to [comment #15](show_bug.cgi?id=3841#c15)) > (In reply to [comment #14](show_bug.cgi?id=3841#c14)) > > (In reply to [comment #13](show_bug.cgi?id=3841#c13)) > > > (In reply to [comment #12](show_bug.cgi?id=3841#c12)) > > > > (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > > > > > Patch committed to CVS, and backported to 1.3.4 branch. > > > >  > > > > I think there may be a problem with the backport; when I try > > > > UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission > > > > denied" when trying to create directories. Same with regular users and a > > > > <Directory> section if I use DefaultRoot (but OK if I don't). > > >  > > > OK, I think I've identified the cause, and fixed it in CVS (both trunk and in > > > the 1.3.4 branch).  I can provide a patch if necessary. > >  > > The change in fsio.c doesn't seem to have helped here, either for the > > <Anonymous> or <Directory> cases. Did I miss a change elsewhere? >  > Probably didn't fix your particular use case, but it was necessary for another > issue I ran into, when first trying to reproduce this behavior you're > reporting. >  > > manually, just doing mkdir in an ~ftp/uploads directory (and > > my ~paul/ftptest directory similarly for the <Directory> test) with full > > permissions for all users. >  > I'm assuming you're using ftp(1) for the manual testing?  If so, could you > copy-paste that client view here?  Specifically, I need to know the exact MKD > command (and arguments) sent by the client; some clients send different paths > for MKD than what was typed/entered by the user. >  > > The config I was using boils down to this: >  > Thanks; I'll work on seeing if I can recreate the behavior using this config.  > (It might turn out to be related to mod_vroot...)  OK, I've just committed more changes (to trunk and the 1.3.4 branch) to the pr_fsio_smkdir() function src/fsio.c, which appear to fix this issue (at least, it fixed the bug of the same apparent symptoms I encountered locally, using your config [minus the mod_vroot config]). ```  [Comment 17](show_bug.cgi?id=3841#c17)  Paul Howarth    2013-01-11 12:25:03 UTC  ``` (In reply to [comment #16](show_bug.cgi?id=3841#c16)) > (In reply to [comment #15](show_bug.cgi?id=3841#c15)) > > (In reply to [comment #14](show_bug.cgi?id=3841#c14)) > > > (In reply to [comment #13](show_bug.cgi?id=3841#c13)) > > > > (In reply to [comment #12](show_bug.cgi?id=3841#c12)) > > > > > (In reply to [comment #9](show_bug.cgi?id=3841#c9)) > > > > > > Patch committed to CVS, and backported to 1.3.4 branch. > > > > >  > > > > > I think there may be a problem with the backport; when I try > > > > > UserOwner/GroupOwner in an <Anonymous ~ftp> section, I'm getting "permission > > > > > denied" when trying to create directories. Same with regular users and a > > > > > <Directory> section if I use DefaultRoot (but OK if I don't). > > > >  > > > > OK, I think I've identified the cause, and fixed it in CVS (both trunk and in > > > > the 1.3.4 branch).  I can provide a patch if necessary. > > >  > > > The change in fsio.c doesn't seem to have helped here, either for the > > > <Anonymous> or <Directory> cases. Did I miss a change elsewhere? > >  > > Probably didn't fix your particular use case, but it was necessary for another > > issue I ran into, when first trying to reproduce this behavior you're > > reporting. > >  > > > manually, just doing mkdir in an ~ftp/uploads directory (and > > > my ~paul/ftptest directory similarly for the <Directory> test) with full > > > permissions for all users. > >  > > I'm assuming you're using ftp(1) for the manual testing?  If so, could you > > copy-paste that client view here?  Specifically, I need to know the exact MKD > > command (and arguments) sent by the client; some clients send different paths > > for MKD than what was typed/entered by the user. > >  > > > The config I was using boils down to this: > >  > > Thanks; I'll work on seeing if I can recreate the behavior using this config.  > > (It might turn out to be related to mod_vroot...) >  > OK, I've just committed more changes (to trunk and the 1.3.4 branch) to the > pr_fsio_smkdir() function src/fsio.c, which appear to fix this issue (at least, > it fixed the bug of the same apparent symptoms I encountered locally, using > your config [minus the mod_vroot config]).  I missed a "LoadModule mod_vroot.c" line from the config file above (I need mod_vroot to keep PAM happy) - sorry about that. With the new code, I'm still getting the same problem, but if I drop the "LoadModule mod_vroot.c" then it all works as expected, so it *is* mod_vroot-related, at least now.  > I'm assuming you're using ftp(1) for the manual testing?  If so, could you > copy-paste that client view here?  Specifically, I need to know the exact MKD > command (and arguments) sent by the client; some clients send different paths > for MKD than what was typed/entered by the user.  I added command tracing to the trace log, so I now get (with mod_vroot):  Jan 11 12:04:52 [12686] <command:7>: dispatching PRE_CMD command 'SYST' to mod_tls.c Jan 11 12:04:52 [12686] <command:7>: dispatching PRE_CMD command 'SYST' to mod_core.c Jan 11 12:04:52 [12686] <command:7>: dispatching PRE_CMD command 'SYST' to mod_core.c Jan 11 12:04:52 [12686] <command:7>: dispatching CMD command 'SYST' to mod_core.c Jan 11 12:04:52 [12686] <command:7>: dispatching LOG_CMD command 'SYST' to mod_log.c Jan 11 12:04:55 [12686] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_tls.c Jan 11 12:04:55 [12686] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 11 12:04:55 [12686] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 11 12:04:55 [12686] <command:7>: dispatching CMD command 'CWD uploads' to mod_core.c Jan 11 12:04:55 [12686] <fsio:8>: using vroot stat() for path '/uploads' Jan 11 12:04:55 [12686] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 11 12:04:55 [12686] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 11 12:04:55 [12686] <fsio:8>: using vroot chdir() for path '/uploads' Jan 11 12:04:55 [12686] <fsio:8>: using vroot stat() for path '.message' Jan 11 12:04:55 [12686] <command:7>: dispatching POST_CMD command 'CWD uploads' to mod_readme.c Jan 11 12:04:55 [12686] <fsio:8>: using vroot opendir() for path '.' Jan 11 12:04:55 [12686] <command:7>: dispatching LOG_CMD command 'CWD uploads' to mod_log.c Jan 11 12:05:00 [12674] <fsio:8>: using system lstat() for path '/etc/shutmsg' Jan 11 12:05:02 [12686] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_tls.c Jan 11 12:05:02 [12686] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:05:02 [12686] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:05:02 [12686] <command:7>: dispatching CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:05:02 [12686] <fsio:8>: using vroot stat() for path '/uploads/anothertestdir' Jan 11 12:05:02 [12686] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 11 12:05:02 [12686] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 11 12:05:02 [12686] <fileperms:1>: MKD, user 'ftp' (UID 14, GID 50): error making directory '/uploads/anothertestdir': No such file or directory Jan 11 12:05:02 [12686] <command:7>: dispatching LOG_CMD_ERR command 'MKD anothertestdir' to mod_log.c Jan 11 12:05:05 [12686] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_tls.c Jan 11 12:05:05 [12686] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_core.c Jan 11 12:05:05 [12686] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_core.c Jan 11 12:05:05 [12686] <command:7>: dispatching CMD command 'QUIT' to mod_core.c Jan 11 12:05:05 [12686] <command:7>: dispatching LOG_CMD command 'QUIT' to mod_log.c Jan 11 12:05:05 [12686] <command:7>: dispatching LOG_CMD command 'QUIT' to mod_core.c  And without mod_vroot:  Jan 11 12:06:54 [12845] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_tls.c Jan 11 12:06:54 [12845] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 11 12:06:54 [12845] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 11 12:06:54 [12845] <command:7>: dispatching CMD command 'CWD uploads' to mod_core.c Jan 11 12:06:54 [12845] <fsio:8>: using system stat() for path '/uploads' Jan 11 12:06:54 [12845] <fsio:8>: using system stat() for path '/uploads/.ftpaccess' Jan 11 12:06:54 [12845] <fsio:8>: using system stat() for path '/.ftpaccess' Jan 11 12:06:54 [12845] <fsio:8>: using system chdir() for path '/uploads' Jan 11 12:06:54 [12845] <fsio:8>: using system stat() for path '.message' Jan 11 12:06:54 [12845] <command:7>: dispatching POST_CMD command 'CWD uploads' to mod_readme.c Jan 11 12:06:54 [12845] <fsio:8>: using system opendir() for path '.' Jan 11 12:06:54 [12845] <command:7>: dispatching LOG_CMD command 'CWD uploads' to mod_log.c Jan 11 12:06:58 [12831] <fsio:8>: using system lstat() for path '/etc/shutmsg' Jan 11 12:06:59 [12845] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_tls.c Jan 11 12:06:59 [12845] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:06:59 [12845] <command:7>: dispatching PRE_CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:06:59 [12845] <command:7>: dispatching CMD command 'MKD anothertestdir' to mod_core.c Jan 11 12:06:59 [12845] <fsio:8>: using system stat() for path '/uploads/anothertestdir' Jan 11 12:06:59 [12845] <fsio:8>: using system stat() for path '/uploads/.ftpaccess' Jan 11 12:06:59 [12845] <fsio:8>: using system stat() for path '/.ftpaccess' Jan 11 12:06:59 [12845] <fsio:8>: using system lchown() for path '/uploads/dstXXX2gE70k' Jan 11 12:06:59 [12845] <command:7>: dispatching LOG_CMD command 'MKD anothertestdir' to mod_log.c Jan 11 12:07:02 [12845] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_tls.c Jan 11 12:07:02 [12845] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_core.c Jan 11 12:07:02 [12845] <command:7>: dispatching PRE_CMD command 'QUIT' to mod_core.c Jan 11 12:07:02 [12845] <command:7>: dispatching CMD command 'QUIT' to mod_core.c Jan 11 12:07:02 [12845] <command:7>: dispatching LOG_CMD command 'QUIT' to mod_log.c Jan 11 12:07:02 [12845] <command:7>: dispatching LOG_CMD command 'QUIT' to mod_core.c ```  [Comment 18](show_bug.cgi?id=3841#c18)  TJ Saunders    2013-01-14 00:46:48 UTC  ``` (In reply to [comment #17](show_bug.cgi?id=3841#c17))  > > OK, I've just committed more changes (to trunk and the 1.3.4 branch) to the > > pr_fsio_smkdir() function src/fsio.c, which appear to fix this issue (at least, > > it fixed the bug of the same apparent symptoms I encountered locally, using > > your config [minus the mod_vroot config]). >  > I missed a "LoadModule mod_vroot.c" line from the config file above (I need > mod_vroot to keep PAM happy) - sorry about that. With the new code, I'm still > getting the same problem, but if I drop the "LoadModule mod_vroot.c" then it > all works as expected, so it *is* mod_vroot-related, at least now. >   OK.  I've just updated CVS (trunk and 1.3.4 branch) with some changes; these add a new function that mod_vroot can use.  I've pushed changes to mod_vroot to make use of the new function:    <https://github.com/Castaglia/proftpd-mod_vroot>  Hopefully the combination of updated CVS code and updated mod_vroot addresses the remaining issues. ```  [Comment 19](show_bug.cgi?id=3841#c19)  Paul Howarth    2013-01-14 13:46:49 UTC  ``` (In reply to [comment #18](show_bug.cgi?id=3841#c18)) > (In reply to [comment #17](show_bug.cgi?id=3841#c17)) >  > > > OK, I've just committed more changes (to trunk and the 1.3.4 branch) to the > > > pr_fsio_smkdir() function src/fsio.c, which appear to fix this issue (at least, > > > it fixed the bug of the same apparent symptoms I encountered locally, using > > > your config [minus the mod_vroot config]). > >  > > I missed a "LoadModule mod_vroot.c" line from the config file above (I need > > mod_vroot to keep PAM happy) - sorry about that. With the new code, I'm still > > getting the same problem, but if I drop the "LoadModule mod_vroot.c" then it > > all works as expected, so it *is* mod_vroot-related, at least now. > >  >  > OK.  I've just updated CVS (trunk and 1.3.4 branch) with some changes; these > add a new function that mod_vroot can use. >  > I've pushed changes to mod_vroot to make use of the new function: >  >   <https://github.com/Castaglia/proftpd-mod_vroot> >  > Hopefully the combination of updated CVS code and updated mod_vroot addresses > the remaining issues.  I've applied the changes from CVS (1.3.4 branch) and updated my mod_vroot (0.9.2) with this recent change (does it depend on any of the previous changes since 0.9.2?) and, as before, it works fine without mod_vroot. With mod_vroot, proftpd is now able to create the directory (which is an improvement) but it still fails to do the chown.  Regular user:  Jan 14 13:24:12 [31008] <command:7>: dispatching PRE_CMD command 'CWD ftptest' to mod_tls.c Jan 14 13:24:12 [31008] <command:7>: dispatching PRE_CMD command 'CWD ftptest' to mod_core.c Jan 14 13:24:12 [31008] <command:7>: dispatching PRE_CMD command 'CWD ftptest' to mod_core.c Jan 14 13:24:12 [31008] <command:7>: dispatching CMD command 'CWD ftptest' to mod_core.c Jan 14 13:24:12 [31008] <fsio:8>: using vroot stat() for path '/ftptest' Jan 14 13:24:12 [31008] <fsio:8>: using vroot stat() for path '/ftptest/.ftpaccess' Jan 14 13:24:12 [31008] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 14 13:24:12 [31008] <fsio:8>: using vroot chdir() for path '/ftptest' Jan 14 13:24:12 [31008] <command:7>: dispatching POST_CMD command 'CWD ftptest' to mod_readme.c Jan 14 13:24:12 [31008] <command:7>: dispatching LOG_CMD command 'CWD ftptest' to mod_log.c Jan 14 13:24:14 [31008] <command:7>: dispatching PRE_CMD command 'MKD td4' to mod_tls.c Jan 14 13:24:14 [31008] <command:7>: dispatching PRE_CMD command 'MKD td4' to mod_core.c Jan 14 13:24:14 [31008] <command:7>: dispatching PRE_CMD command 'MKD td4' to mod_core.c Jan 14 13:24:14 [31008] <command:7>: dispatching PRE_CMD command 'MKD td4' to mod_vroot.c Jan 14 13:24:14 [31008] <command:7>: dispatching CMD command 'MKD td4' to mod_core.c Jan 14 13:24:14 [31008] <fsio:8>: using vroot stat() for path '/ftptest/td4' Jan 14 13:24:14 [31008] <fsio:8>: using vroot stat() for path '/ftptest/.ftpaccess' Jan 14 13:24:14 [31008] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 14 13:24:14 [31008] <fsio:8>: using vroot mkdir() for path '/ftptest/td4' Jan 14 13:24:14 [31008] <command:7>: dispatching POST_CMD command 'MKD td4' to mod_vroot.c Jan 14 13:24:14 [31008] <command:7>: dispatching LOG_CMD command 'MKD td4' to mod_log.c  (no sign of a chown attempt there)  Anonymous user:  Jan 14 13:25:23 [31119] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_tls.c Jan 14 13:25:23 [31119] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 14 13:25:23 [31119] <command:7>: dispatching PRE_CMD command 'CWD uploads' to mod_core.c Jan 14 13:25:23 [31119] <command:7>: dispatching CMD command 'CWD uploads' to mod_core.c Jan 14 13:25:23 [31119] <fsio:8>: using vroot stat() for path '/uploads' Jan 14 13:25:23 [31119] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 14 13:25:23 [31119] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 14 13:25:23 [31119] <fsio:8>: using vroot chdir() for path '/uploads' Jan 14 13:25:23 [31119] <fsio:8>: using vroot stat() for path '.message' Jan 14 13:25:23 [31119] <command:7>: dispatching POST_CMD command 'CWD uploads' to mod_readme.c Jan 14 13:25:23 [31119] <fsio:8>: using vroot opendir() for path '.' Jan 14 13:25:23 [31119] <command:7>: dispatching LOG_CMD command 'CWD uploads' to mod_log.c Jan 14 13:25:27 [31119] <command:7>: dispatching PRE_CMD command 'MKD td5' to mod_tls.c Jan 14 13:25:27 [31119] <command:7>: dispatching PRE_CMD command 'MKD td5' to mod_core.c Jan 14 13:25:27 [31119] <command:7>: dispatching PRE_CMD command 'MKD td5' to mod_core.c Jan 14 13:25:27 [31119] <command:7>: dispatching PRE_CMD command 'MKD td5' to mod_vroot.c Jan 14 13:25:27 [31119] <command:7>: dispatching CMD command 'MKD td5' to mod_core.c Jan 14 13:25:27 [31119] <fsio:8>: using vroot stat() for path '/uploads/td5' Jan 14 13:25:27 [31119] <fsio:8>: using vroot stat() for path '/uploads/.ftpaccess' Jan 14 13:25:27 [31119] <fsio:8>: using vroot stat() for path '/.ftpaccess' Jan 14 13:25:27 [31119] <fsio:8>: using vroot mkdir() for path '/uploads/td5' Jan 14 13:25:27 [31119] <fsio:8>: using system lchown() for path '/uploads/td5' Jan 14 13:25:27 [31119] <command:7>: dispatching POST_CMD command 'MKD td5' to mod_vroot.c Jan 14 13:25:27 [31119] <command:7>: dispatching LOG_CMD command 'MKD td5' to mod_log.c  I also got a message in /var/log/messages: Jan 14 13:25:27 zion proftpd[31119]: 192.168.2.1 (::1[::1]) - lchown(/uploads/td5) as root failed: No such file or directory  Is there any other tracing or debugging I could turn on to help with this? ```  [Comment 20](show_bug.cgi?id=3841#c20)  TJ Saunders    2013-01-14 17:56:17 UTC  ``` (In reply to [comment #19](show_bug.cgi?id=3841#c19))  > > OK.  I've just updated CVS (trunk and 1.3.4 branch) with some changes; these > > add a new function that mod_vroot can use. > >  > > I've pushed changes to mod_vroot to make use of the new function: > >  > >   <https://github.com/Castaglia/proftpd-mod_vroot> > >  > > Hopefully the combination of updated CVS code and updated mod_vroot addresses > > the remaining issues. >  > I've applied the changes from CVS (1.3.4 branch) and updated my mod_vroot > (0.9.2) with this recent change (does it depend on any of the previous changes > since 0.9.2?)  No.  The mod_vroot additions are only dependent on the API changes in proftpd; they don't depend on any other mod_vroot changes.   and, as before, it works fine without mod_vroot. With mod_vroot, > proftpd is now able to create the directory (which is an improvement) but it > still fails to do the chown.  Got it.  With the fix for this issue, there's a new lchown() FSIO callback that mod_vroot needed to implement.  I've pushed changes to mod_vroot in GitHub that implements that callback; hopefully should work better for you.  (I'm not sure I'll have time today to write the proper regression test for this use case, but I will do it soon.) ```  [Comment 21](show_bug.cgi?id=3841#c21)  Paul Howarth    2013-01-14 19:41:27 UTC  ``` (In reply to [comment #20](show_bug.cgi?id=3841#c20)) > (In reply to [comment #19](show_bug.cgi?id=3841#c19)) >  > > > OK.  I've just updated CVS (trunk and 1.3.4 branch) with some changes; these > > > add a new function that mod_vroot can use. > > >  > > > I've pushed changes to mod_vroot to make use of the new function: > > >  > > >   <https://github.com/Castaglia/proftpd-mod_vroot> > > >  > > > Hopefully the combination of updated CVS code and updated mod_vroot addresses > > > the remaining issues. > >  > > I've applied the changes from CVS (1.3.4 branch) and updated my mod_vroot > > (0.9.2) with this recent change (does it depend on any of the previous changes > > since 0.9.2?) >  > No.  The mod_vroot additions are only dependent on the API changes in proftpd; > they don't depend on any other mod_vroot changes. >  >  and, as before, it works fine without mod_vroot. With mod_vroot, > > proftpd is now able to create the directory (which is an improvement) but it > > still fails to do the chown. >  > Got it.  With the fix for this issue, there's a new lchown() FSIO callback that > mod_vroot needed to implement.  I've pushed changes to mod_vroot in GitHub that > implements that callback; hopefully should work better for you.  (I'm not sure > I'll have time today to write the proper regression test for this use case, but > I will do it soon.)  Nearly there now. The <Anonymous> case now works, with or without mod_vroot.  However, the <Directory> case only works without mod_vroot; with mod_vroot, the directory is created but there's no sign of any attempt to do the lchown(), as in the previous attempt. ```  [Comment 22](show_bug.cgi?id=3841#c22)  TJ Saunders    2013-01-15 01:07:38 UTC  ``` (In reply to [comment #21](show_bug.cgi?id=3841#c21))  > Nearly there now. The <Anonymous> case now works, with or without mod_vroot. >  > However, the <Directory> case only works without mod_vroot; with mod_vroot, the > directory is created but there's no sign of any attempt to do the lchown(), as > in the previous attempt.  What's the pared-down config that you're using for this <Directory> use case? ```  [Comment 23](show_bug.cgi?id=3841#c23)  Paul Howarth    2013-01-15 12:23:46 UTC  ``` (In reply to [comment #22](show_bug.cgi?id=3841#c22)) > (In reply to [comment #21](show_bug.cgi?id=3841#c21)) >  > > Nearly there now. The <Anonymous> case now works, with or without mod_vroot. > >  > > However, the <Directory> case only works without mod_vroot; with mod_vroot, the > > directory is created but there's no sign of any attempt to do the lchown(), as > > in the previous attempt. >  > What's the pared-down config that you're using for this <Directory> use case?  Unchanged from [Comment #14](show_bug.cgi?id=3841#c14) (with or without a LoadModule mod_vroot.c as needed). ```  [Comment 24](show_bug.cgi?id=3841#c24)  TJ Saunders    2013-01-16 17:42:36 UTC  ``` (In reply to [comment #23](show_bug.cgi?id=3841#c23))  > > What's the pared-down config that you're using for this <Directory> use case? >  > Unchanged from [Comment #14](show_bug.cgi?id=3841#c14) (with or without a LoadModule mod_vroot.c as > needed).  Ah, right.  The problem is a known issue with mod_vroot, and how it changes the interpretation/handling of <Directory> paths; see:    <https://github.com/Castaglia/proftpd-mod_vroot/issues>  Unfortunately I don't have a good/easy fix/solution for this yet. ```  [Comment 25](show_bug.cgi?id=3841#c25)  Paul Howarth    2013-01-16 20:31:20 UTC  ``` (In reply to [comment #24](show_bug.cgi?id=3841#c24)) > (In reply to [comment #23](show_bug.cgi?id=3841#c23)) >  > > > What's the pared-down config that you're using for this <Directory> use case? > >  > > Unchanged from [Comment #14](show_bug.cgi?id=3841#c14) (with or without a LoadModule mod_vroot.c as > > needed). >  > Ah, right.  The problem is a known issue with mod_vroot, and how it changes the > interpretation/handling of <Directory> paths; see: >  >   <https://github.com/Castaglia/proftpd-mod_vroot/issues> >  > Unfortunately I don't have a good/easy fix/solution for this yet.  This is OK. With the workaround path cited above, it works as expected. So as long as it's not a regression, there's no issue for me. I needed mod_vroot support as it's on by default in Fedora to work around a PAM issue but UserOwner is not used by default so what we have now covers my needs as Fedora maintainer.  Thanks for the help with this. ```  [Comment 26](show_bug.cgi?id=3841#c26)  John Workman    2013-02-12 21:32:46 UTC  ``` I'm afraid I found a bug in pr_fsio_smkdir() of fsio.c. This function does not properly calculate the permission mode of subdirectories being created inside of a parent directory which has the sgid bit set. It does an explicit chmod on the created subdirectory using mode & ~DirUmask which means the subdirectory does not inherit the sgid bit of its parent.  Compiling ProFTPD without mkdtemp solves this problem. ```  [Comment 27](show_bug.cgi?id=3841#c27)  TJ Saunders    2013-02-12 21:37:27 UTC  ``` (In reply to [comment #26](show_bug.cgi?id=3841#c26)) > I'm afraid I found a bug in pr_fsio_smkdir() of fsio.c. This function does not > properly calculate the permission mode of subdirectories being created inside > of a parent directory which has the sgid bit set. It does an explicit chmod on > the created subdirectory using mode & ~DirUmask which means the subdirectory > does not inherit the sgid bit of its parent. >  > Compiling ProFTPD without mkdtemp solves this problem.  Was this issue found in proftpd-1.3.4b, or in the current CVS code? ```  [Comment 28](show_bug.cgi?id=3841#c28)  TJ Saunders    2013-02-12 21:37:56 UTC  ``` (In reply to [comment #27](show_bug.cgi?id=3841#c27)) > (In reply to [comment #26](show_bug.cgi?id=3841#c26)) > > I'm afraid I found a bug in pr_fsio_smkdir() of fsio.c. This function does not > > properly calculate the permission mode of subdirectories being created inside > > of a parent directory which has the sgid bit set. It does an explicit chmod on > > the created subdirectory using mode & ~DirUmask which means the subdirectory > > does not inherit the sgid bit of its parent. > >  > > Compiling ProFTPD without mkdtemp solves this problem. >  > Was this issue found in proftpd-1.3.4b, or in the current CVS code?  Never mind; I see the issue. ```  [Comment 29](show_bug.cgi?id=3841#c29)  TJ Saunders    2013-02-12 22:38:48 UTC  ``` Created [attachment 3935](attachment.cgi?id=3935 "Fixes handling/propagation of SUID/SGID bits from parent directory") [[details]](attachment.cgi?id=3935&action=edit "Fixes handling/propagation of SUID/SGID bits from parent directory") Fixes handling/propagation of SUID/SGID bits from parent directory  This patch should fix the issue.  Thanks! ```  [Comment 30](show_bug.cgi?id=3841#c30)  TJ Saunders    2013-02-12 22:55:14 UTC  ``` Patch committed to CVS, and backported to 1.3.4 branch, with accompanying regression test. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3841)
* - [XML](show_bug.cgi?ctype=xml&id=3841)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3841)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*No search results available*

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](/doc/bugzilla3-doc/en/html/bug_page.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](?GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](?GoAheadAndLogIn=1#forgot)
    Login:

    [x]


