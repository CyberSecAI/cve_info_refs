=== Content from www.vulnerability-lab.com_4ebf4111_20250125_040311.html ===
Document Title:
===============
FortiWeb 4kC,3kC,1kC & VA - Cross Site Vulnerabilities
References (Source):
====================
http://www.vulnerability-lab.com/get\_content.php?id=702
http://www.fortiguard.com/advisory/FG-IR-012-008.html
CVE ID: 2012-6346
Release Date:
=============
2012-12-02
Vulnerability Laboratory ID (VL-ID):
====================================
702
Common Vulnerability Scoring System:
====================================
2.1
Product & Service Introduction:
===============================
FortiWeb web application firewalls protect, balance, and accelerate your web applications, databases, and any
information exchanged between them. Whether you are protecting applications delivered over a large enterprise,
service provider, or cloud-based provider network, FortiWeb appliances will reduce deployment time and
simplify security management. Fortinet s FortiWeb™ has passed ICSA Web Application Firewall Certification.
The latest model being tested is FortiWeb 1000C. ICSA Labs certifications are evidence of FortiWeb s commitment
to uphold the industry s highest security standards. Achieving this certification ensures that FortiWeb™ customers
benefit from best practices in the security industry for all their Web application needs.
(Copy of the Vendor Homepage: http://www.fortinet.com/products/fortiweb/ )
Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered multiple cross site scripting vulnerabilities in
Fortinets FortiWeb 4000C, 3000C/3000CFsx, 1000C, 400C & Virtual Appliance.
Vulnerability Disclosure Timeline:
==================================
2012-10-01: Researcher Notification & Coordination
2012-10-05: Vendor Notification
2012-10-11: Vendor Response/Feedback
2012-11-11: Vendor Fix/Patch
2012-12-03: Public Disclosure
Discovery Status:
=================
Published
Affected Product(s):
====================
Fortinet
Product: FortiWeb Application Series 4000C, 3000C/3000CFsx, 1000C, 400C & Virtual Appliance
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Low
Technical Details & Description:
================================
A non persistent cross site scripting vulnerability is detected in Fortinets FortiWeb 4000C, 3000C/3000CFsx, 1000C, 400C & Virtual Appliance.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with low or medium required user inter action
and without local privileged application user account. The vulnerability is located in the Regular Expression - Validation (pcre\_expression/validate)
module with the bound vulnerable redir and mkey parameters. Successful exploitation results in client side account steal, client side phishing &
client-side appliance module context request manipulation.
Vulnerable Module(s):
[+] Regular Expression - Validation Module (pcre\_expression/validate)
Vulnerable Parameter(s):
[+] redir
[+] mkey
Proof of Concept (PoC):
=======================
The client side cross site scripting vulnerability can be exploited by remote attackers without application user account and
with medium required user interaction. For demonstration or reproduce ...
Code Review: Regular Expression - Validation Module (mkey & redir)| |  | | --- | |
<[CLIENT SIDE SCRIPT CODE EXECUTION!]") <">

... or| |  | | --- | |
<[CLIENT SIDE SCRIPT CODE EXECUTION!]") <">

PoC:
https://fortiweb.127.0.0.1:1336/waf/pcre\_expression/validate?redir=/success&mkey=0%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C
https://fortiweb.127.0.0.1:1336/waf/pcre\_expression/validate?redir=/success%20%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C&mkey=0
Solution - Fix & Patch:
=======================
The vulnerability can be patched by parsing all mkey and redir success parameter requests of the vulnerable Regular Expression - Validation module.
2012-11-11: Vendor Fix/Patch
Security Risk:
==============
The security risk of the non persistent cross site scripting vulnerabilities are estimated as low(+)|(-)medium.
Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@vulnerability-lab.com)
Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases
or trade with fraud/stolen material.
Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.vulnerability-lab.com/register
Contact: admin@vulnerability-lab.com - support@vulnerability-lab.com - research@vulnerability-lab.com
Section: video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com
Social: twitter.com/#!/vuln\_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab
Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss\_upcoming.php - vulnerability-lab.com/rss/rss\_news.php
Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.
Copyright © 2012 | Vulnerability Laboratory

