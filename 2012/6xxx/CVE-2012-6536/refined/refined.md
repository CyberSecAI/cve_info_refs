Based on the provided information, here's an analysis of CVE-2012-6536:

**Root Cause of Vulnerability:**

The root cause of the vulnerability lies in the insufficient validation of the user-supplied Extended Sequence Number (ESN) replay window size in the Linux kernel's XFRM (IPsec) subsystem. Specifically, when a user creates or updates an IPsec state with ESN enabled, the kernel fails to verify if the provided netlink message contains enough bytes for the complete replay window bitmap.

**Weaknesses/Vulnerabilities Present:**

1.  **Insufficient Input Validation:** The kernel does not properly check the length of the provided ESN replay window data against the expected size based on the header information.
2.  **Heap Memory Leak:** Due to insufficient validation, if a user provides less data than expected, the kernel copies random heap memory into the replay bitmap, which can be exposed to the user.
3.  **Replay Window Corruption:** The random heap data copied into the replay bitmap can lead to unpredictable behavior in the replay handling code.

**Impact of Exploitation:**

1.  **Information Leak:** A malicious user with `CAP_NET_ADMIN` privileges can leak up to approximately 3.5KB of heap memory.
2.  **Replay Window Manipulation:** The copied random bytes into the replay bitmap can corrupt the replay window, potentially causing issues with IPsec traffic.

**Attack Vectors:**

1.  **Netlink Interface:** The vulnerability is accessed through the XFRM netlink interface.
2.  **User-Supplied Input:** Attackers manipulate the netlink message by not providing enough bytes for ESN replay window.

**Required Attacker Capabilities/Position:**

1.  **CAP_NET_ADMIN Privilege:** Exploitation requires the attacker to have the `CAP_NET_ADMIN` capability, allowing them to interact with the XFRM netlink interface.
2.  **Ability to craft Netlink Messages:** The attacker must be able to construct specific netlink messages to create/update IPsec states with ESN and manipulate the size of the replay window data.

**Additional Details:**

*   The vulnerability primarily affects users of the XFRM netlink interface with ESN enabled.
*   The fix involves correctly calculating the bitmap length and ensuring the user-supplied bitmap is either fully specified or empty, with zero initialization in the latter case.
*   The maximum size of the replay bitmap is limited to 128 bytes, resulting in a maximum replay window of 4096 packets.

The provided information includes details of the vulnerability, the fix and discussion around CVE assignment not included in the standard CVE description.