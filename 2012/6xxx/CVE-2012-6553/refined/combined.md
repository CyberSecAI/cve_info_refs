=== Content from waleedassar.blogspot.com_5dc6268b_20250125_034711.html ===


# [waliedassar](http://waleedassar.blogspot.com/)

## Thursday, May 17, 2012

### [Resource Hacker Heap Overflow Vulnerability](http://waleedassar.blogspot.com/2012/05/resource-hacker-heap-overflow.html)

I have discovered a vulnerability in Resource Hacker 3.6.0.92. The vulnerability occurs due an improper way of reading strings of RT\_STRING resources.

In the images below, you can see how the string table looks like.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaSfzhGSO3h7fp-76KzxHUtlNlhdduE8ilv0d5jZIXXkLS3YU7LsaHRSBRzRalmRpeedkmkuTa_XFWl4xkCr11X7jswKVYbZp3SFGKPZ2l9FD1g-QYH6Q08PdfE0Ajsk99nycnTMYh3V0/s400/dem.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaSfzhGSO3h7fp-76KzxHUtlNlhdduE8ilv0d5jZIXXkLS3YU7LsaHRSBRzRalmRpeedkmkuTa_XFWl4xkCr11X7jswKVYbZp3SFGKPZ2l9FD1g-QYH6Q08PdfE0Ajsk99nycnTMYh3V0/s1600/dem.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYvmp5webGui2nAJ-v8A_ilMRwirE7jMIyKB7tpWKU2EtaiMfirGDTOyi8uHTGpaVB_zPEuZsNYCDODNgPhs6bf-sXPKytgqcdlWlcE-AKJoV3VhsSQsOQWz6xHsbdJ8ulGNASnEd-5eA/s400/dem2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYvmp5webGui2nAJ-v8A_ilMRwirE7jMIyKB7tpWKU2EtaiMfirGDTOyi8uHTGpaVB_zPEuZsNYCDODNgPhs6bf-sXPKytgqcdlWlcE-AKJoV3VhsSQsOQWz6xHsbdJ8ulGNASnEd-5eA/s1600/dem2.jpg)
At address ***0x457C6F***, there is a loop that goes through strings in the string table one by one.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOuC_o3VciVx7fpBtFDCisGkntu-6VMjtr1oLQJ193IEI1qryabRx2ZQqMw6D2RxydF0TIqkRthua1RksNwE1mjsao-kYnmSh6_KZjcaCmrqQI2nc34PLC1xpxRe2-PyGbVDsURxkHNbc/s400/demr.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOuC_o3VciVx7fpBtFDCisGkntu-6VMjtr1oLQJ193IEI1qryabRx2ZQqMw6D2RxydF0TIqkRthua1RksNwE1mjsao-kYnmSh6_KZjcaCmrqQI2nc34PLC1xpxRe2-PyGbVDsURxkHNbc/s1600/demr.jpg)

The "***readStringIntoBuffer***" function converts the unicode string into its ASCII form. The new ASCII string is stored in a heap-based memory block. After the "***readStringIntoBuffer***" function returns, the "***parseIndiv\_string***" function is called to parse and format strings in order to be display them properly.

N.B. I have assigned the names, ***readStringIntoBuffer*** and ***parseIndiv\_string*** for functions at ***0x45FAE4*** and ***0x451C00*** for sake of simplification.

We have to go abit deeper and look at the "***parseIndiv\_string***" function since it is the vulnerable function.

The "***parseIndiv\_string***" function allocates a new heap-based memory block with size equal to the ASCII string length plus ***0x32***. A question arises here, why ***0x32***?

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBg779A_v5qBGv2YblElRNhtQpypmDMjSw3lsQvTzBh51zw4byhNUlluIAX1A9ZaGj8syOyPRKE3nBmoRags0dtGW1qYAiNRGZ60-B7AiRfuNei9-KgmOUeO9yWq8QABfagWsWzQ_t_Zw/s400/demrrr.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBg779A_v5qBGv2YblElRNhtQpypmDMjSw3lsQvTzBh51zw4byhNUlluIAX1A9ZaGj8syOyPRKE3nBmoRags0dtGW1qYAiNRGZ60-B7AiRfuNei9-KgmOUeO9yWq8QABfagWsWzQ_t_Zw/s1600/demrrr.jpg)
After the new block is allocated, a loop is entered. Inside this loop, the ASCII string is copied to the new block byte by byte. But if a ***TAB*** character (***0x09***) or ***line feed*** character (***0x0A***) is found, the two characters "**\t**" in case of 0x09 or "**\n**" in case of 0x0A are copied to the new block.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjA4h6VKvpM5yJ64RSE9yFmiH3hNoCQll7OxJMgpyKzdOZQJs3mMRE6t53sPVWRnbHfOOAvdtLLXVr98FqlILilbf59mrKirYVHuMCZ5Rfj0fyP_YVqpRgsv-4Dy7z77yCXNbr_ADtk3Zo/s400/demttt.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjA4h6VKvpM5yJ64RSE9yFmiH3hNoCQll7OxJMgpyKzdOZQJs3mMRE6t53sPVWRnbHfOOAvdtLLXVr98FqlILilbf59mrKirYVHuMCZ5Rfj0fyP_YVqpRgsv-4Dy7z77yCXNbr_ADtk3Zo/s1600/demttt.jpg)

So, if we have a string with more than 0x19 (0x32/2) TABs (or line feeds), we will have a heap overflow.

A POC can be found [here](http://ollytlscatch.googlecode.com/files/ResHacker_HO.exe).

You can follow me on Twitter [@waleedassar](https://twitter.com/waleedassar)

Posted by
walied

at
[1:13 PM](http://waleedassar.blogspot.com/2012/05/resource-hacker-heap-overflow.html "permanent link")

[![](http://img1.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/5036198523690297182/67906972961906414 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=5036198523690297182&postID=67906972961906414&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=5036198523690297182&postID=67906972961906414&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=5036198523690297182&postID=67906972961906414&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=5036198523690297182&postID=67906972961906414&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=5036198523690297182&postID=67906972961906414&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=5036198523690297182&postID=67906972961906414&target=pinterest "Share to Pinterest")

Labels:
[Resource hacker](http://waleedassar.blogspot.com/search/label/Resource%20hacker),
[resourcehacker](http://waleedassar.blogspot.com/search/label/resourcehacker),
[vulnerability](http://waleedassar.blogspot.com/search/label/vulnerability)

#### No comments:

#### Post a Comment

[Newer Post](http://waleedassar.blogspot.com/2012/05/pe-explorer-heap-overflow-vulnerability.html "Newer Post")

[Older Post](http://waleedassar.blogspot.com/2012/05/resource-tuner-heap-overflow.html "Older Post")

[Home](http://waleedassar.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://waleedassar.blogspot.com/feeds/67906972961906414/comments/default)

## Followers

## Blog Archive

* ►
  [2020](http://waleedassar.blogspot.com/2020/)
  (1)
  + ►
    [January](http://waleedassar.blogspot.com/2020/01/)
    (1)

* ►
  [2015](http://waleedassar.blogspot.com/2015/)
  (1)
  + ►
    [April](http://waleedassar.blogspot.com/2015/04/)
    (1)

* ►
  [2014](http://waleedassar.blogspot.com/2014/)
  (2)
  + ►
    [June](http://waleedassar.blogspot.com/2014/06/)
    (1)
  + ►
    [February](http://waleedassar.blogspot.com/2014/02/)
    (1)

* ►
  [2013](http://waleedassar.blogspot.com/2013/)
  (6)
  + ►
    [February](http://waleedassar.blogspot.com/2013/02/)
    (2)
  + ►
    [January](http://waleedassar.blogspot.com/2013/01/)
    (4)

* ▼
  [2012](http://waleedassar.blogspot.com/2012/)
  (46)
  + ►
    [December](http://waleedassar.blogspot.com/2012/12/)
    (1)
  + ►
    [November](http://waleedassar.blogspot.com/2012/11/)
    (6)
  + ►
    [October](http://waleedassar.blogspot.com/2012/10/)
    (4)
  + ►
    [September](http://waleedassar.blogspot.com/2012/09/)
    (2)
  + ►
    [August](http://waleedassar.blogspot.com/2012/08/)
    (1)
  + ►
    [July](http://waleedassar.blogspot.com/2012/07/)
    (2)
  + ►
    [June](http://waleedassar.blogspot.com/2012/06/)
    (4)
  + ▼
    [May](http://waleedassar.blogspot.com/2012/05/)
    (4)
    - [ResEdit Named Entries Two Buffer Overflow Vulnerab...](http://waleedassar.blogspot.com/2012/05/resedit-named-entries-two-buffer.html)
    - [PE Explorer Heap Overflow Vulnerability](http://waleedassar.blogspot.com/2012/05/pe-explorer-heap-overflow-vulnerability.html)
    - [Resource Hacker Heap Overflow Vulnerability](http://waleedassar.blogspot.com/2012/05/resource-hacker-heap-overflow.html)
    - [Resource Tuner Heap Overflow Vulnerability](http://waleedassar.blogspot.com/2012/05/resource-tuner-heap-overflow.html)
  + ►
    [April](http://waleedassar.blogspot.com/2012/04/)
    (2)
  + ►
    [March](http://waleedassar.blogspot.com/2012/03/)
    (9)
  + ►
    [February](http://waleedassar.blogspot.com/2012/02/)
    (5)
  + ►
    [January](http://waleedassar.blogspot.com/2012/01/)
    (6)

* ►
  [2011](http://waleedassar.blogspot.com/2011/)
  (6)
  + ►
    [December](http://waleedassar.blogspot.com/2011/12/)
    (6)

* ►
  [2010](http://waleedassar.blogspot.com/2010/)
  (13)
  + ►
    [October](http://waleedassar.blogspot.com/2010/10/)
    (1)
  + ►
    [September](http://waleedassar.blogspot.com/2010/09/)
    (9)
  + ►
    [August](http://waleedassar.blogspot.com/2010/08/)
    (3)

## About Me

[walied](https://www.blogger.com/profile/18278414703959705421)

[View my complete profile](https://www.blogger.com/profile/18278414703959705421)

## Search This Blog

|  |  |
| --- | --- |

## Bitcoin Donations

1Bk6ttgc3ek5GeFSbc5gqZebdvSGpkPxra

Powered by [Blogger](https://www.blogger.com).


