```
{
  "cve": "CVE-2012-2329",
  "description": "A buffer overflow was reported in the apache_request_headers() function in PHP 5.4.x. The apache_request_headers() function has a loop that copies the name of an environment variable while it fixes cases and converts '_' to '-'. While this loop is supposed to only copy the variable name (e.g., \"Cookie\" from \"HTTP_COOKIE\"), it instead continues to the end of the entire environment variable. If the string being copied is longer than 128 bytes, it will overflow the buffer, resulting in a crash of the PHP interpreter.",
  "affected_versions": {
    "php": "5.4.0 through 5.4.2"
  },
  "vulnerability_details": {
    "root_cause": "The `apache_request_headers()` function in PHP 5.4.x incorrectly iterates through and copies the entire value of an HTTP environment variable into a fixed-size buffer. This happens because the loop does not terminate correctly at the end of the variable name, leading to a buffer overflow.",
    "weaknesses": [
      "Buffer Overflow",
	  "Improper Input Validation"
    ],
    "impact": "A buffer overflow vulnerability can cause the PHP interpreter to crash. This vulnerability is triggered when processing HTTP headers in a specific way, using the vulnerable `apache_request_headers()` function.",
    "attack_vector": "An attacker can trigger the buffer overflow by sending a crafted HTTP request with a long environment variable, for example, a long cookie header.",
    "required_capabilities": "The attacker needs the ability to send HTTP requests to a server running a vulnerable version of PHP and that uses PHP-CGI, or any other SAPI using this function.",
    "additional_details": "This vulnerability affects PHP-CGI and not Apache module configurations. It is triggered by processing HTTP headers with long environment variables, such as the cookie."
  }
}
```