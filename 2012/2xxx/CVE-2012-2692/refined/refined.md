```
{
  "cveId": "CVE-2012-2692",
  "description": "The provided content describes a vulnerability in MantisBT where the delete_attachments_threshold permission was not being checked when a user attempted to delete an attachment. Instead, the update_bug_threshold permission was checked, which could allow unauthorized users to delete attachments.",
  "vulnerabilityDetails": {
    "rootCause": "MantisBT was incorrectly using the `update_bug_threshold` instead of `delete_attachments_threshold` when checking permissions for attachment deletion.",
    "weaknesses": [
      "Incorrect access control logic",
      "Insufficient permission checking"
    ],
    "impact": "Users with the `update_bug_threshold` level access could delete attachments even if they did not have the required `delete_attachments_threshold` access level, potentially leading to unauthorized deletion of issue attachments.",
    "attackVectors": [
      "Web interface",
      "SOAP API"
     ],
    "attackerCapabilities": "An attacker needs to have at least update_bug_threshold access to the affected issue."
  },
    "affectedComponents": [
    "bug_file_delete.php",
    "api/soap/mc_issue_attachment_api.php"
  ],
  "patches": [
    {
    "commitId": "f82f98cc78ab2c15e5b16acd27a3d0c57e7ba98e",
    "description": "Fix #14016: delete_attachments_threshold is not checked"
  },
  {
    "commitId": "ceafe6f0c679411b81368052633a63dd3ca06d9c",
    "description": "Fix #14016: delete_attachments_threshold is not checked"
   },
   {
    "commitId": "31d11568473e8f65487468e480f2516415386bc7",
     "description": "Fix #14015: attachment deletion: remove update_bug_threshold check"
   },
   {
    "commitId": "628e93708fa7e35e751fd23863d207423a25c408",
    "description": "Fix #14015: attachment deletion: remove update_bug_threshold check"
   },
  {
    "commitId": "c9314184f541f0e3e3b91b3533104e50292c3e68",
    "description":"Additional patch to fix #14016"
   },
    {
    "commitId":"75568c536d66d3cd05cf1d4e36be5c4b557b48ca",
    "description": "Additional patch to fix #14016"
  }
  ]
}
```