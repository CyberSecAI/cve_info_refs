Based on the provided information, here's an analysis of CVE-2012-2947:

**Root Cause of Vulnerability:**

The vulnerability lies within the IAX2 channel driver of Asterisk when handling calls placed on hold. Specifically, if the `mohinterpret` setting is set to `passthrough` on the end placing the call on hold, and the call is placed on hold without a specified music-on-hold class, Asterisk will attempt to use an invalid pointer to a music-on-hold class name.

**Weaknesses/Vulnerabilities Present:**

*   **Invalid Pointer Usage:** The core issue is the dereferencing of an invalid pointer when a music-on-hold class is not explicitly provided during a hold operation under specific conditions.
*   **Missing Input Validation/Sanitization:** The vulnerability arises because the code does not handle the case where a music-on-hold class is not provided when mohinterpret=passthrough is enabled.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** Exploiting this vulnerability leads to a crash of the Asterisk daemon, resulting in a denial of service for the telephony system. The invalid pointer dereference is what causes the crash, rendering the service unavailable.

**Attack Vectors:**

*   **Remote Attack:** The attack can be executed remotely by placing a call.
*   **Specific IAX2 Call:** The attack targets the IAX2 channel driver in Asterisk.
*   **Hold Operation:** The attack is triggered when a call is placed on hold using the IAX2 protocol.
*   **Specific Settings:**  Requires `mohinterpret=passthrough` to be set and no music-on-hold class specified.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must have network access to the Asterisk server.
*   **Call Initiation:** The attacker must be able to initiate a call using the IAX2 protocol to reach the vulnerable code.
*  **Mohinterpret Configuration**: The attacker doesn't have to control this, but they must target a system that has mohinterpret configured to passthrough.
*   **Hold Call Capability**: The attacker must be able to place the call on hold

**Summary of Technical Details:**

The vulnerability occurs in the following sequence of events:
1. An IAX2 call is established.
2.  The `mohinterpret` setting is configured to `passthrough` on the calling end.
3. The call is placed on hold without a music-on-hold class.
4. The Asterisk IAX2 channel driver attempts to dereference an invalid pointer intended to point to the music-on-hold class. This causes a crash.

**Additional Notes:**

*   The vulnerability is classified as "Moderate" severity.
*   No known exploits were known at the time of the advisory.
*   The fix involves setting the extra data parameter to null if the control frame does not contain it.
*   The vulnerability affects multiple versions of Asterisk (1.8.x and 10.x) and Certified Asterisk (1.8.11-cert).