=== Content from access.redhat.com_3b675c1c_20250126_050928.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_cc37b07c_20250126_050930.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D810013)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D810013)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D810013)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 810013

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 810013**](show_bug.cgi?id=810013)
(CVE-2012-2146)
- [CVE-2012-2146](https://access.redhat.com/security/cve/CVE-2012-2146) python-elixir: weak use of crypto can leak information

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2012-2146 python-elixir: weak use of crypto can leak information

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2012-2146 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [923220](show_bug.cgi?id=923220 "CLOSED ERRATA - CVE-2012-2146 python-elixir: weak use of crypto can leak information [fedora-all]") [923221](show_bug.cgi?id=923221 "CLOSED ERRATA - CVE-2012-2146 python-elixir: weak use of crypto can leak information [epel-5]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [817150](show_bug.cgi?id=817150) | | TreeView+ | [depends on](buglist.cgi?bug_id=810013&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=810013&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2012-04-04 22:10 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:51 UTC ([History](show_activity.cgi?id=810013)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  a.badger fw fweimer gwync mitr security-response-team sochotni tmraz | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-07-12 13:09:01 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**migration script tests**](attachment.cgi?id=577963 "View the content of the attachment") (1.08 KB, application/x-xz)  [2012-04-17 09:25 UTC](#attach_577963 "Go to the comment associated with the attachment"), Stanislav Ochotnicky | *no flags* | [Details](attachment.cgi?id=577963&action=edit) | | [**Proposed patch to fix the bug**](attachment.cgi?id=578385 "View the content of the attachment") (5.20 KB, patch)  [2012-04-18 15:11 UTC](#attach_578385 "Go to the comment associated with the attachment"), Stanislav Ochotnicky | sochotni: review? | [Details](attachment.cgi?id=578385&action=edit) | [Diff](attachment.cgi?id=578385&action=diff) | | [**A possible test case patch**](attachment.cgi?id=582122 "View the content of the attachment") (1.37 KB, patch)  [2012-05-04 13:20 UTC](#attach_582122 "Go to the comment associated with the attachment"), Miloslav Trmač | *no flags* | [Details](attachment.cgi?id=582122&action=edit) | [Diff](attachment.cgi?id=582122&action=diff) | | [View All](attachment.cgi?bugid=810013&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=810013#c0)  Vincent Danen    2012-04-04 22:10:58 UTC  ``` It was reported that python-elixir, a library for ORM mapping on top of SQLAlchemy with support for encrypting data stored in a database, suffers from weak use of cryptography.  It uses Blowfish in CFB mode, which has an additional parameter (IV), which is not specified and thus defaults to zero.  CFB mode is only secure if the the IV is unpredictable and different for every message.  Because of this, and because the encryption key is shared for each database table (fields and rows), the same plaintext prefix is always encrypted to an identical and corresponding ciphertext prefix.  As a result, an attacker with access to the database could figure out the plaintext values of encrypted text.   ```  [Comment 20](show_bug.cgi?id=810013#c20)  Stanislav Ochotnicky    2012-04-17 09:25:13 UTC  ``` Created [attachment 577963](attachment.cgi?id=577963 "migration script tests") [[details]](attachment.cgi?id=577963&action=edit "migration script tests") migration script tests  I have created a simple set of scripts to test if data migration would be feasible. It seems that with modifications, data could be migrated like this:  1. prepare migration script, backup database etc  2. stop all database work  3. run migration script  4. install errata for this bug  5. continue working as before  I am using monkey-patching to "fix" old python-elixir encryption code without actually touching the source files so we can sort of use fixed code without installing the errata.  Migration script would have to use the encryption method expected. In this case I've used the first variant, i.e. keep using python-crypto. We could make the migration script a bit more generic where administrators doing the migration would just have to put in table names that contain encrypted data. I was also thinking about a way to prevent accidental running of the script twice, which would cause the data to be encrypted twice and didn't come up with anything short of creating additional table in the database that would contain already converted table names. Not a hard thing to do actually, but not sure it's worth doing.   ```  [Comment 21](show_bug.cgi?id=810013#c21)  Tomas Mraz    2012-04-17 09:39:55 UTC  ``` If it is necessary to migrate, it should be definitely migrated to AES-128 cipher and m2crypto.   ```  [Comment 24](show_bug.cgi?id=810013#c24)  Stanislav Ochotnicky    2012-04-18 15:11:53 UTC  ``` Created [attachment 578385](attachment.cgi?id=578385&action=diff "Proposed patch to fix the bug") [[details]](attachment.cgi?id=578385&action=edit "Proposed patch to fix the bug") Proposed patch to fix the bug  After talking to mitr, I've contacted upstream[1].   I have a patch that adds additional encryption methods (turned off by default so that we don't break stuff when users install errata without migrating first). It uses AES/python-crypto to encrypt so we don't have to do major rewrites. Attached patch is a complete proposed change to python-elixir package.  I've also updated example migration scripts to reflect this change   [1] <http://groups.google.com/group/sqlelixir/browse_thread/thread/efc16227514cffa>   ```  [Comment 28](show_bug.cgi?id=810013#c28)  Vincent Danen    2012-04-27 20:34:34 UTC  ``` This has also been reported upstream, although currently there are no comments:  <http://elixir.ematia.de/trac/ticket/119>  (and no response to the message that Stanislav notes in [comment #24](show_bug.cgi?id=810013#c24)   ```  [Comment 29](show_bug.cgi?id=810013#c29)  Vincent Danen    2012-04-27 20:57:40 UTC  ``` CVE and peer review requested:  <http://www.openwall.com/lists/oss-security/2012/04/27/8>   ```  [Comment 31](show_bug.cgi?id=810013#c31)  Kurt Seifried    2012-04-29 06:49:52 UTC  ``` Added CVE as per <http://www.openwall.com/lists/oss-security/2012/04/29/1>   ```  [Comment 32](show_bug.cgi?id=810013#c32)  Vincent Danen    2012-04-30 21:55:58 UTC  ``` Florian Weimer noted the following observations:  > CFB mode is only secure if the the IV is unpredictable and different                                                                                                                                                                                                           > for every message.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              There are a few additional requirements.  Without some form of message                                                                                                                                                                                                           authentication, chosen-ciphertext attacks are still possible even with                                                                                                                                                                                                           a random IV.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      > Because of this, and because the encryption key is shared for each                                                                                                                                                                                                             > database table (fields and rows), the same plaintext prefix is                                                                                                                                                                                                                 > always encrypted to an identical and corresponding ciphertext                                                                                                                                                                                                                  > prefix.  As a result, an attacker with access to the database could                                                                                                                                                                                                            > figure out the plaintext values of encrypted text.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              And you can group by encrypted column values in the database.  That's                                                                                                                                                                                                            why I'm not sure if it's actually possible to address this issue in a                                                                                                                                                                                                            satisfying manner.   Thoughts?  I imagine, if he's accurate (no idea, not familiar with the software but I don't see why he wouldn't be spot-on here), then we may need to revist how we're handling this.   ```  [Comment 33](show_bug.cgi?id=810013#c33)  Tomas Mraz    2012-05-02 06:38:46 UTC  ``` (In reply to [comment #32](show_bug.cgi?id=810013#c32)) > Florian Weimer noted the following observations: >  > And you can group by encrypted column values in the database.  That's            > why I'm not sure if it's actually possible to address this issue in a            > satisfying manner.  I do not understand how would you group by encrypted column if the IV is random - or what he really means by this sentence.  Also I am not really sure if the chosen-ciphertext attack applies - it would require that the attacker has full write access to the database columns that are later decrypted and plaintext shown to the attacker - I am not sure it is really purpose of python-elixir encryption to protect against such attack although using OFB or CTR mode would be better in this regard.   ```  [Comment 34](show_bug.cgi?id=810013#c34)  Stanislav Ochotnicky    2012-05-02 08:25:32 UTC  ``` (In reply to [comment #32](show_bug.cgi?id=810013#c32)) > Florian Weimer noted the following observations: >  > > CFB mode is only secure if the the IV is unpredictable and different > > for every message.                                                                          The fix uses CBC mode not CFB  > There are a few additional requirements.  Without some form of message > authentication, chosen-ciphertext attacks are still possible even with > a random IV.  python-elixir is a thin ORM mapping layer on top of SQLAlchemy. Protection against chosen-ciphertext would be out of scope for this library.  > > Because of this, and because the encryption key is shared for each > > database table (fields and rows), the same plaintext prefix is > > always encrypted to an identical and corresponding ciphertext > > prefix.  As a result, an attacker with access to the database could > > figure out the plaintext values of encrypted text.                                                                             Not true. We produce random IV for each row in the database. Even if you have 2 same plaintext fields they will be completely different in ciphertext.  Yes, users will have to migrate their data to be able to use new cipher algorithms. There is no other way to properly protect them unfortunately.  >  > And you can group by encrypted column values in the database.  That's  > why I'm not sure if it's actually possible to address this issue in a  > satisfying manner.  It's not without database migration.   > Thoughts?  I imagine, if he's accurate (no idea, not familiar with the  > software but I don't see why he wouldn't be spot-on here), then we may > need to revist how we're handling this.  Our approach still seems OK to me. Did I miss anything?   ```  [Comment 35](show_bug.cgi?id=810013#c35)  Tomas Mraz    2012-05-02 08:39:30 UTC  ``` (In reply to [comment #34](show_bug.cgi?id=810013#c34)) > The fix uses CBC mode not CFB CBC has the same properties in regards to random IV and chosen ciphertext attacks as CFB. But as the IV is random in the fix and chosen ciphertext attack is not considered in the model I think we are OK.  > Our approach still seems OK to me. Did I miss anything? Nope, it seems OK to me as well.   ```  [Comment 36](show_bug.cgi?id=810013#c36)  Vincent Danen    2012-05-02 17:29:41 UTC  ``` Thanks for the clarification on the given questions.  Very much appreciated.   ```  [Comment 37](show_bug.cgi?id=810013#c37)  Florian Weimer    2012-05-04 12:40:07 UTC  ``` (In reply to [comment #33](show_bug.cgi?id=810013#c33)) > I do not understand how would you group by encrypted column if the IV is random > - or what he really means by this sentence.  You could do this before, when the encryption was convergent. I'm concerned that the fix (while appropriate from a crypto point of view, even though an AEAD would be better) breaks application functionality.  After all, it does break the encryption test case.   ```  [Comment 38](show_bug.cgi?id=810013#c38)  Miloslav Trmač    2012-05-04 13:18:35 UTC  ``` (In reply to [comment #37](show_bug.cgi?id=810013#c37)) > I'm concerned > that the fix (while appropriate from a crypto point of view, even though an > AEAD would be better) breaks application functionality.  After all, it does > break the encryption test case.  I was unsure what this refers to, so, to save others some time: the distributed tarball contains a "test" directory, but most tests are only in svn.  Among them is a test to the effect of: >    class Person(Entity): >        name = Field(String(50)) >        password = Field(String(40)) ... >        acts_as_encrypted(for_fields=['password', 'ssn'], with_secret='secret') and (shortened) >    def test_two_consecutive_updates(self): >        jonathan = Person( >            name='Jonathan LaCour', >            password='s3cr3tw0RD', >        ) ... >        p = Person.get_by(name='Jonathan LaCour') >        assert p.password == 's3cr3tw0RD' >        session.flush() >        assert p.password == 'r\\x9d\\xa8\\xb4\\x8d|\\xffp\\xf5\\x0e' >        session.flush() >        assert p.password == 'r\\x9d\\xa8\\xb4\\x8d|\\xffp\\xf5\\x0e'  testing that the ciphertext will have a specific, constant, value.   IMHO: * Sorting on the encrypted values while the encryption is incorrect can't be helped; migrating the database will stop that attack from working.  * The patch does not change the encryption mode by default, so nothing is broken by a mere package update.  OTOH, if we want to fix the crypto, we simply have to break this test, and applications that would be broken by the change need to be modified at the time with_aes is set to True.   ```  [Comment 39](show_bug.cgi?id=810013#c39)  Miloslav Trmač    2012-05-04 13:20:49 UTC  ``` Created [attachment 582122](attachment.cgi?id=582122&action=diff "A possible test case patch") [[details]](attachment.cgi?id=582122&action=edit "A possible test case patch") A possible test case patch  This is how the test case could be updated for with_aes=True.   ```  [Comment 40](show_bug.cgi?id=810013#c40)  Florian Weimer    2012-05-15 15:02:26 UTC  ``` (In reply to [comment #38](show_bug.cgi?id=810013#c38)) > I was unsure what this refers to, so, to save others some time: the distributed > tarball contains a "test" directory, but most tests are only in svn.  Oops.  I wasn't aware of that. > IMHO: > * Sorting on the encrypted values while the encryption is incorrect can't be > helped; migrating the database will stop that attack from working.  I'm not sure if it is incorrect if it works.  But if you think this is really important to fix (even though upstream appears unlikely to pick up the patch), I think the proposed opt-in approach looks okay.   ```  [Comment 43](show_bug.cgi?id=810013#c43)  Stefan Cornelius    2013-03-19 13:08:19 UTC  ``` Created python-elixir tracking bugs for this issue  Affects: fedora-all [[bug 923220](show_bug.cgi?id=923220 "CLOSED ERRATA - CVE-2012-2146 python-elixir: weak use of crypto can leak information [fedora-all]")]   ```  [Comment 44](show_bug.cgi?id=810013#c44)  Stefan Cornelius    2013-03-19 13:09:24 UTC  ``` Created python-elixir tracking bugs for this issue  Affects: epel-5 [[bug 923221](show_bug.cgi?id=923221 "CLOSED ERRATA - CVE-2012-2146 python-elixir: weak use of crypto can leak information [epel-5]")]   ```  [Comment 46](show_bug.cgi?id=810013#c46)  Toshio Ernie Kuratomi    2013-03-31 13:35:11 UTC  ``` I'm  thinking  of orphaning  elixir (I  don't  use it anymore) but  wanted  to  see  this  wrapped  up  before  doing  so.  sochotni,  your  patch  looks  good  to  me.   elixir  upstream  seems  to  be  dying.   how  do  you  feel  about  applying  your  patch  locally?   would  you  want  me  to  do  that  our  would  you  like  to  just  take  over ( you  already  have  commit)?   ```  [Comment 47](show_bug.cgi?id=810013#c47)  Miloslav Trmač    2013-04-02 12:56:28 UTC  ``` (In reply to [comment #46](show_bug.cgi?id=810013#c46)) > I'm  thinking  of orphaning  elixir (I  don't  use it anymore) but  wanted  > to  see  this  wrapped  up  before  doing  so. >  > sochotni,  your  patch  looks  good  to  me.   elixir  upstream  seems  to  > be  dying.   how  do  you  feel  about  applying  your  patch  locally?   > would  you  want  me  to  do  that  our  would  you  like  to  just  take  > over ( you  already  have  commit)?  Earlier I have looked for uses of python-elixir in Fedora, and found none.    Would it make sense to not only orphan the package, but also remove it from the distribution (and modify TurboGears not to require it)?  It's rather draconian (and unkind to out-of-Fedora uses of elixir through TurboGears), but perhaps still worth it - an unmaintained package doing crypto makes me nervous.  I don't know.  I'm not at all certain that dropping the package altogether is a good idea - I'm just noting this as a possible option.   ```  [Comment 48](show_bug.cgi?id=810013#c48)  Toshio Ernie Kuratomi    2013-04-02 13:48:32 UTC  ``` I  would  be fine dropping the package in f19/ rawhide  if nothing requires it.  but we still need to fix this as we can't  drop packages in released versions of fedora.   there's  no  way to remove the package from the machines of users who may have installed it.  I'm  leery off making promises to retire this before looking at why turbogears  needs it but I suspect it's  just their preferred package for doing database migrations. if so,  python-alembic can fill  the need for new software.   ```  [Comment 49](show_bug.cgi?id=810013#c49)  Gwyn Ciesla    2014-08-19 14:43:09 UTC  ``` An progress on this?  I maintain moodle which needs this several layers down the chain in el5 where it's orphaned.  Is it worth my picking unorphaning it?   ```  [Comment 50](show_bug.cgi?id=810013#c50)  Miloslav Trmač    2014-08-19 14:51:51 UTC  ``` (In reply to Jon Ciesla from [comment #49](show_bug.cgi?id=810013#c49)) > An progress on this?  I maintain moodle which needs this several layers down > the chain in el5 where it's orphaned.  Do the layers down the chain actually use acts_as_encrypted?   ```  [Comment 51](show_bug.cgi?id=810013#c51)  Dan Callaghan    2014-08-20 22:56:05 UTC  ``` Stano, in [comment 42](show_bug.cgi?id=810013#c42) you mention having a patch, could you please attach it here?  I would also be in favour of just patching TurboGears not to require python-elixir and letting the package be retired. I had a look through TurboGears, there is no hard runtime requirement on elixir (it's imported with except ImportError: pass). The quickstart tool can optionally include Elixir support in the generated project, so we could either patch that option out entirely, or just leave it up to the user to satisfy their application's dependency if they do pass --elixir. But really nobody should be starting a new project with TurboGears1 nowadays anyway.  Jon, do you know if your application (is it Moodle, or some other transitive dep?) is actually *using* Elixir or is it just in the dependency chain because of TurboGears?   ```  [Comment 52](show_bug.cgi?id=810013#c52)  Dan Callaghan    2014-08-20 22:59:28 UTC  ``` (In reply to Dan Callaghan from [comment #51](show_bug.cgi?id=810013#c51)) > Stano, in [comment 42](show_bug.cgi?id=810013#c42) you mention having a patch, could you please attach it > here?  Ah, I clicked through to the CVE and found the upstream issue Stano filed with his patch:  <http://elixir.ematia.de/trac/ticket/119> <https://sochotni.fedorapeople.org/python-elixir-aes-encryption-addition.patch>   ```  [Comment 53](show_bug.cgi?id=810013#c53)  Dan Callaghan    2014-08-20 23:38:38 UTC  ``` Oops, I just realised the patch is already attached here. Sorry for the noise.  So I took the EPEL7 branch of python-elixir a few weeks back, since I need it for the TurboGears1 stack which I am now maintaining in EPEL7 (I'm not actually using Elixir anywhere).  The patch applies cleanly on Elixir 0.7.1, and I have backported it to Elixir 0.5.0 for EPEL5 as well. So I will take this package in EPEL5 and all Fedora branches and apply the patch, unless there are any objections.   ```  [Comment 54](show_bug.cgi?id=810013#c54)  Dan Callaghan    2014-08-25 03:21:31 UTC  ``` (In reply to Dan Callaghan from [comment #53](show_bug.cgi?id=810013#c53)) > So I will take this package in EPEL5 and all > Fedora branches and apply the patch  Done.   ```  [Comment 55](show_bug.cgi?id=810013#c55)  Fedora Update System    2014-09-09 22:17:33 UTC  ``` python-elixir-0.7.1-14.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 56](show_bug.cgi?id=810013#c56)  Fedora Update System    2014-09-09 22:21:10 UTC  ``` python-elixir-0.7.1-14.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 57](show_bug.cgi?id=810013#c57)  Product Security DevOps Team    2019-07-12 13:09:01 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2012-2146>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=810013&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_0b0cc322_20250125_014659.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](../../../2012/04/28/1) [[thread-next>]](../../../2012/04/28/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120427204048.GB3020@redhat.com>
Date: Fri, 27 Apr 2012 14:40:48 -0600
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Subject: weak use of crypto in python-elixir can lead to information
 disclosure (CVE and peer review request)

Could a CVE be assigned for the following issue?

It was reported that python-elixir, a library for ORM mapping on top of
SQLAlchemy with support for encrypting data stored in a database,
suffers from weak use of cryptography.  It uses Blowfish in CFB mode,
which has an additional parameter (IV), which is not specified and thus
defaults to zero.  CFB mode is only secure if the the IV is
unpredictable and different for every message.  Because of this, and
because the encryption key is shared for each database table (fields and
rows), the same plaintext prefix is always encrypted to an identical and
corresponding ciphertext prefix.  As a result, an attacker with access
to the database could figure out the plaintext values of encrypted text.

References:

<https://bugzilla.redhat.com/show_bug.cgi?id=810013>
<http://groups.google.com/group/sqlelixir/browse_thread/thread/efc16227514cffa?pli=1>
<http://elixir.ematia.de/trac/ticket/119>

So far there has been no response from upstream, and we have what I
think is a suitable proposal to fix the flaw and a possible migration
script to ease migrating from an insecure encrypted db to a secure one
(noted in the google groups message).

Not sure if anyone else is shipping python-elixir at all, but if you
are, input on the proposed fix and migration script (in the absence of
an upstream response) would be fantastic.

--
Vincent Danen / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_b81f7f0b_20250125_014700.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2012/04/27/8) [[thread-next>]](../../../2012/04/29/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <87zk9w131k.fsf@mid.deneb.enyo.de>
Date: Sat, 28 Apr 2012 13:58:15 +0200
From: Florian Weimer <fw@...eb.enyo.de>
To: oss-security@...ts.openwall.com
Subject: Re: weak use of crypto in python-elixir can lead to information disclosure (CVE and peer review request)

* Vincent Danen:

> CFB mode is only secure if the the IV is unpredictable and different
> for every message.

There are a few additional requirements.  Without some form of message
authentication, chosen-ciphertext attacks are still possible even with
a random IV.

> Because of this, and because the encryption key is shared for each
> database table (fields and rows), the same plaintext prefix is
> always encrypted to an identical and corresponding ciphertext
> prefix.  As a result, an attacker with access to the database could
> figure out the plaintext values of encrypted text.

And you can group by encrypted column values in the database.  That's
why I'm not sure if it's actually possible to address this issue in a
satisfying manner.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from groups.google.com_9147c62c_20250125_014658.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## SQLElixir

[Conversations](./g/sqlelixir)[About](./g/sqlelixir/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# [patch] Encryption scheme doesn't use proper random seed

 133 viewsSkip to first unread message![Stanislav Ochotnicky's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2APlh3khkZieUHOKRTopCTQYJvBwvpTwJJmUT_1rMhHcQEm4a=s40-c)
### Stanislav Ochotnicky

unread,Apr 18, 2012, 2:49:52 PM4/18/12Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto SQLElixir, Miloslav Trmač, Stanislav OchotnickyRed Hat security response team discovered a vulnerability in Elixir

that can cause encrypted data to be decrypted without knowledge of

secret password. Only users using elixirt.ext.encrypted module are

affected.

It is generally caused by following code snippet:

def encrypt\_value(value, secret):

 return Blowfish.new(secret, Blowfish.MODE\_CFB) \

 .encrypt(value).encode('string\_escape')

This code doesn't create proper random seed (IV argument for Blowfish)

and therefore attacker with access to both database and able to add

new data into database will be able to decrypt contents even without

knowing the password.

Unfortunately to properly fix this issue a database migration is

required as well and this change is backward incompatible since we

need to store seed (IV) in the database.

Proposed patch[1] should fix the issue. It adds new encryption

mechanism that is enabled when acts\_as\_encrypted is used with

"with\_aes=True" parameter. It also prints out warning to stderr about

insecure Blowfish method when it's used. Note that by patch doesn't

enable new encryption by default, as that would cause current

applications to stop working. First they will need to actively migrate

their data, then start using AES.

Apart from that, we have tarball with example migration[2] that could

help with migration of current databases. Users should be able to

modify this example to properly migrate their databases. It is

possible with minimal changes to the current code, provided database

schema used fields that are big enough to contain IV seed together

with encrypted data. A second pair of eyes that would look into the

migration scripts and perhaps improve them or warn about possible

shortcomings or other problems would be appreciated.

I have also filed a bug report at <http://elixir.ematia.de/trac/ticket/119>

Thanks,

P.S. Please keep me and Miloslav in CC, thank you

[1] <http://sochotni.fedorapeople.org/python-elixir-aes-encryption-addition.patch>

[2] <http://sochotni.fedorapeople.org/migration_test.tar.xz>Reply allReply to authorForward0 new messages

=== Content from www.openwall.com_c000e141_20250125_014700.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2012/04/28/3) [[next>]](2) [[<thread-prev]](../../../2012/04/28/2) [[thread-next>]](../../../2012/04/30/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4F9CE456.6020301@redhat.com>
Date: Sun, 29 Apr 2012 00:48:54 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Vincent Danen <vdanen@...hat.com>
Subject: Re: weak use of crypto in python-elixir can lead to
 information disclosure (CVE and peer review request)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 04/27/2012 02:40 PM, Vincent Danen wrote:
> Could a CVE be assigned for the following issue?
>
> It was reported that python-elixir, a library for ORM mapping on
> top of SQLAlchemy with support for encrypting data stored in a
> database, suffers from weak use of cryptography.  It uses Blowfish
> in CFB mode, which has an additional parameter (IV), which is not
> specified and thus defaults to zero.  CFB mode is only secure if
> the the IV is unpredictable and different for every message.
> Because of this, and because the encryption key is shared for each
> database table (fields and rows), the same plaintext prefix is
> always encrypted to an identical and corresponding ciphertext
> prefix.  As a result, an attacker with access to the database could
> figure out the plaintext values of encrypted text.
>
>
> References:
>
> <https://bugzilla.redhat.com/show_bug.cgi?id=810013>
> <http://groups.google.com/group/sqlelixir/browse_thread/thread/efc16227514cffa?pli=1>
>
>  <http://elixir.ematia.de/trac/ticket/119>

Please use CVE-2012-2146 for this issue.

>
> So far there has been no response from upstream, and we have what
> I think is a suitable proposal to fix the flaw and a possible
> migration script to ease migrating from an insecure encrypted db to
> a secure one (noted in the google groups message).
>
> Not sure if anyone else is shipping python-elixir at all, but if
> you are, input on the proposed fix and migration script (in the
> absence of an upstream response) would be fantastic.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBAgAGBQJPnORNAAoJEBYNRVNeJnmTVt8P/iLnoj3xpoIKZLcJswL8ISLN
EeQTjDJhSFo9J+HjpiWWFZQH/XDF3tJVPpJcy3E/sOLV4GRMDy7lW30WKBxlQOEb
b3MO4UVutTIyI4cr5ry+GLINzF4/YaifwI1KOUsVEKRPU8WYjdSnTsvNAn7QmmrI
XuXz+MVm8xcNHOTJ1VkQyVBerERTjWdiT/Ik425mvcRIcB0NV3ruOS3V48qfFqIx
WRdvkVSeSqqWyoB202X82lCUcMPxv/zXT755WUB7lcXvrcTjn8WNBCMEAjXDifNC
yHc0eFH7WW56pLzcSJUwN897xt+LAjDrntObKbXJ1epe4a5DtZhlWfkd4MpNAhSS
A+7U3vNKPJxTJ9R99Dj8XBXGlh1mM+NaBcQN5/bDxduRTHCQLjCTYPAxrIlZXD6n
0JzBueDY003zzsUOqN/HuREI57+jNL+ODbzZz1/SHVUWcL6XEhAQF+R39osGV8Iu
rZUFqX103nhSh7p4yEznTl2NtT3gyf2+6TiXgKfJAPfpchsEA9Ld14sp+FQjd4AN
Rr7oqE8tiNecQwn58iAJ4vbYyhNcPOlB5eLEn6Oe8Wke707WBvP6M2NCP9pt0AwP
itOMKo+Tbm42/bWEKUKo3L5VlCh2ZJBm1Efc1MkAl1qcT3VAeD6SiegTZD5DOVqy
kQBYLJYUMlzt/WtXROBR
=Ut6W
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


