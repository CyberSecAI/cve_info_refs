=== Content from www.debian.org_6c14e1b4_20250125_100601.html ===


---

[[Date Prev](msg00140.html)][[Date Next](msg00142.html)]
[[Thread Prev](msg00140.html)][[Thread Next](msg00142.html)]
[[Date Index](maillist.html#00141)]
[[Thread Index](threads.html#00141)]

# [SECURITY] [DSA 2498-1] dhcpcd security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2498-1] dhcpcd security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Sun, 24 Jun 2012 20:45:04 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20120624184504.C7B95200AF%40scapa.corsac.net)Â [20120624184504.C7B95200AF@scapa.corsac.net](msg00141.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2498-1                   security@debian.org
<http://www.debian.org/security/>                         Yves-Alexis Perez
June 23, 2012                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dhcpcd
Vulnerability  : remote stack overflow
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-2152
Debian Bug     : #671265

It was discovered that dhcpcd, a DHCP client, was vulnerable to a stack
overflow. A malformed DHCP message could crash the client, causing a denial of
service, and potentially remote code execution through properly designed
malicous DHCP packets.

For the stable distribution (squeeze), this problem has been fixed in
version 1:3.2.3-5+squeeze1.

For the testing distribution (wheezy), this problem has been fixed in
version 1:3.2.3-11.

For the unstable distribution (sid), this problem has been fixed in
version 1:3.2.3-11.

We recommend that you upgrade your dhcpcd package.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBCgAGBQJP52AwAAoJEDBVD3hx7wuoCkcQANmkWRLHyxzRfYFcnYmv137e
1mTjyDavnytTXiRA1x3cDsS9kZMgO/NUFDfCP6tTVqB3tYnwFdP4pr8eaqj2CIQD
WLCVFd3BcGXeWni959gY5KEr/F7te5z1HawbZJrDzTv3jOUJB5mP5kfPpwN2Cx8F
Zv0DzO7lxb6ogbEzQOY8GV47CDQov8msBSPiaKSgTbamKh9i7FXvfOgDaY8xAB4+
GLAvgPzXe9Mvz6vVjt//pHlqOtJXBBn4IPf3ESJO2Pk9KEHlEInCxXUuak4w7kGn
yN4Ao40YwgpZDvN8HvXDeOwlAtYaZSFKXQT190aL+ZgVmBEGr+dhTDEoFkBrILXT
lB64mIEOaM+xrIlr03k0pdhGrldvnkYnmOAppRkhtK8di1ElidLMiGUrNGJ/jD9Y
YC28h3K/TVUY5veQaR9raGVu5/NOguDcwNbi+REB1ZYVVvB6Fd2FX1LJvqV06w/q
OJqr7OfyUb1rbxZQG1VD/tLKJQI9UmNovj910t9ne6Vjbv5rAt7WCmLSdKMjvhcR
B2Ke0ptetb8+wWpm295B7i03jtL6URm/ILxtwTbLzMIK7CRw2ABbuDjpE8uYL52V
9utjelsq29PqrWuf1KeawcPd3IK8FyTNIwj/wls8H+LiCfy78WOmUQmLsIeHU9G9
O59HjbsoUZzQ+RTkoTcx
=iUQH
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_9fcb3413_20250125_100601.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4FA1659C.7040702@redhat.com>
Date: Wed, 02 May 2012 10:49:32 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Marcus Meissner <meissner@...e.de>
Subject: Re: CVE Request: dhcpcd 3.2.3 remote stack overflow
 / denial of service

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 05/02/2012 10:08 AM, Marcus Meissner wrote:
> Hi,
>
> I would like a CVE for following issue:
>
> One of our customers reported a crash of dhcpcd (a DHCP client)
> version 3.2.3 as found in our products.
>
> This was triggered by regular network traffic happening, so
> attackers in the local network could inject such a packet.
>
> The issue is apparently fixed in dhcpcd-4.0.2 (oldest GIT revision
> of dhcpcd I can find), as it features the necessary checks on
> cursory review.
>
>
> Problem is that the "to copyed" size of a packet is decoded from
> the network data and not checked against the maximum size of the
> retrieved packet.
>
> In dhcpcd 3.2.3 it is copied to a fixed size stackbuffer on some
> paths and so overwrites stack.
>
> On our SLE11 product this is caught by -fstack-protector, turning
> this into a remote denial of service (crash).
>
> Place to look for places like this:
>
> bytes = get_udp_data(&pp, packet); if ((size_t)bytes >
> sizeof(*dhcp)) { syslog(LOG_ERR, "%s: packet greater than DHCP size
> from %s", iface->name, inet_ntoa(from)); continue; }
>
> bytes is calculated from packet data and not bounded in
> get_udp_data(). So without the if() check, it would later copy over
> bytes into a fixed buffer in some paths.
>
> Also: bytes = packet.bh_caplen - ETHER_HDR_LEN; if (bytes > len)
> bytes = len; memcpy(data, payload, bytes);
>
> I have pasted the current patch we use against our quite heavily
> patches dhcpcd 3.2.3 on
> <https://bugzilla.novell.com/show_bug.cgi?id=760334>
>
> Reference: <https://bugzilla.novell.com/show_bug.cgi?id=760334>
>
> Ciao, Marcus

For the record: this is about as perfect as a CVE request gets =)

Please use CVE-2012-2152  for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iQIcBAEBAgAGBQJPoWWbAAoJEBYNRVNeJnmTSyQQANX5RzPCr5crrVvVdzbhHVeE
E6eG+VrU1+6kW16ELlC6NntivQWXtx0PiwSR6WMqfaFw69+RJOAHTYYheQYjhAkv
WzG84mqZHFAXRPwh7mB19vq4W2YhVt58MvDAQOXojX5FmBR9jPxXvKKU3qQR+6b3
tU7JytuzJ7PCUHFLrERnKyda9yiawQvE09IJJpeiyIqha0ZHayYXCatyRetpMPQP
8YzPOZ1aLBJEkbjFTY441npKH8tu0RyDyafhRjpz4i3YUT+XxpWRQ3oA7EnTfNWN
izFp/epIQQ+YPPYs5mw5cLBZip2XvQhf2G+OLAMN9R+tySD32VqbBBrHP+OZoUrE
XZjo2h1adm/r2siETX3mkdUvT8rxarJP9j2l0VQOQ8gIQViI7I+PjupA7mfFT2NS
IOQrZeqlmzuJc9cnerlK5iED5BhAiXhvt3TzhDrUMRQNRL2QIRUeTb5lI34mtf2Y
wSgl2wchARkN8c4Rok/zFMGDh+2MN/EmfscHqcBZJ9zhZ7giQADjcyG9wPMnJzmd
GSDKmZMcQ8zIqyvZEE2OdoXc8SoKEwSDk7kD5eXw8NVn+mZY8knsCyGPLfCAEQX2
qzDolOadO+1nyl/nENicdKCeV64dLe5x+8el7KWGlaID7bMpNMRfez0myUcOcvR/
RgECkrqMseLYbStFKlS2
=5d9X
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.novell.com_e9e96043_20250126_075622.html ===




=== Content from www.openwall.com_bdacb4ff_20250125_100601.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120502160803.GH20471@suse.de>
Date: Wed, 2 May 2012 18:08:03 +0200
From: Marcus Meissner <meissner@...e.de>
To: OSS Security List <oss-security@...ts.openwall.com>
Subject: CVE Request: dhcpcd 3.2.3 remote stack overflow / denial of service

Hi,

I would like a CVE for following issue:

One of our customers reported a crash of dhcpcd (a DHCP client) version
3.2.3 as found in our products.

This was triggered by regular network traffic happening, so attackers
in the local network could inject such a packet.

The issue is apparently fixed in dhcpcd-4.0.2 (oldest GIT revision of
dhcpcd I can find), as it features the necessary checks on cursory review.

Problem is that the "to copyed" size of a packet is decoded from the network data
and not checked against the maximum size of the retrieved packet.

In dhcpcd 3.2.3 it is copied to a fixed size stackbuffer on some paths
and so overwrites stack.

On our SLE11 product this is caught by -fstack-protector, turning this
into a remote denial of service (crash).

Place to look for places like this:

                bytes = get_udp_data(&pp, packet);
                if ((size_t)bytes > sizeof(*dhcp)) {
                        syslog(LOG_ERR,
                            "%s: packet greater than DHCP size from %s",
                            iface->name, inet_ntoa(from));
                        continue;
                }

bytes is calculated from packet data and not bounded in get_udp_data().
So without the if() check, it would later copy over bytes into a fixed buffer
in some paths.

Also:
                bytes = packet.bh_caplen - ETHER_HDR_LEN;
                if (bytes > len)
                        bytes = len;
                memcpy(data, payload, bytes);

I have pasted the current patch we use against our quite heavily patches dhcpcd 3.2.3
on <https://bugzilla.novell.com/show_bug.cgi?id=760334>

Reference: <https://bugzilla.novell.com/show_bug.cgi?id=760334>

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


