```
RELATED
CVE-2012-2749 is a vulnerability in MySQL related to incorrect calculation of key length for sort order indexes.

Root cause of vulnerability:
- The crash occurs due to an incorrect calculation of key length during the creation of a reference for a sort order index.
- The issue is that `keyuse->used_tables` can have `OUTER_REF_TABLE_BIT` enabled but the `used_tables` parameter (of `create_ref_for_key()` function) does not have it. Key parts with `OUTER_REF_TABLE_BIT` are omitted leading to incorrect (potentially zero) key length calculations.

Weaknesses/vulnerabilities present:
- Incorrect key length calculation during sort order index creation.
- Missing check for `OUTER_REF_TABLE_BIT` in the `create_ref_for_key()` function.

Impact of exploitation:
- mysqld daemon crash leading to denial of service.
- Can be triggered by non-admin database user with full SQL access.

Attack vectors:
- Authenticated database user executing specific SQL queries (e.g. `SELECT SUBQUERY WITH NON UNIQUE INDEX`).

Required attacker capabilities/position:
- Authenticated database user with full SQL access.
```