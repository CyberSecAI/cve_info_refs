```
{
  "cveId": "CVE-2012-2695",
  "description": "The rubygem-activerecord gem is vulnerable to SQL injection when processing nested query parameters. If a Ruby on Rails application directly passes request parameters to the 'where' method of an ActiveRecord class, a remote attacker could use this flaw to cause the 'params[:id]' to return a specially-crafted hash, resulting in the WHERE clause of the SQL statement to query an arbitrary table with a value of attacker's choice, leading to disclosure of sensitive information.",
  "vulnerability": {
    "rootCause": "The vulnerability stems from the way Active Record handles nested query parameters. When a Ruby on Rails application directly passes request parameters to the 'where' method of an ActiveRecord class, an attacker can craft a request that causes `params[:id]` to return a specially crafted hash. This specially crafted hash can then be used to inject SQL into the WHERE clause.",
    "weaknesses": [
      "SQL Injection",
      "Improper Input Validation"
    ],
    "impact": "A remote attacker can inject SQL into a SQL query, causing the application to query an arbitrary table with some value. This can lead to the disclosure of sensitive information.",
    "attackVector": "A remote attacker sends a specially crafted HTTP request to a vulnerable Ruby on Rails application.",
    "requiredCapabilities": "The attacker needs to be able to send HTTP requests to the vulnerable application, and have knowledge of the applicationâ€™s use of ActiveRecord's `where` method to manipulate the SQL query generated.",
      "additionalDetails": "This vulnerability is a variant of CVE-2012-2661, and applications vulnerable to CVE-2012-2661 are not protected from this vulnerability by the patch for that vulnerability.  The vulnerability can be mitigated by casting the parameter to an expected value."
  }
}
```