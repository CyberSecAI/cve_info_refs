=== Content from wiki.mahara.org_5d97da08_20250126_052854.html ===


* [![Mahara Wiki](/images/maharawiki-logo.png)
  Mahara Wiki](/wiki/Mahara_Wiki)
* Menu

* Navigation
  + [Main page](/wiki/Mahara_Wiki "Visit the main page [z]")
  + [User manual](http://manual.mahara.org/)
  + [Developer area](/wiki/Developer_Area)
  + [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
  + [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

* Search
* + [What links here](/wiki/Special%3AWhatLinksHere/Security "A list of all wiki pages that link here [j]")
  + [Related changes](/wiki/Special%3ARecentChangesLinked/Security "Recent changes in pages linked from this page [k]")
  + [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
  + Printable version
  + [Permanent link](/index.php?title=Security&oldid=13315 "Permanent link to this revision of this page")
  + [Page information](/index.php?title=Security&action=info "More information about this page")
  + [Recent changes](/wiki/Special%3ARecentChanges "Special:RecentChanges")
  + [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents)
* + [Log in](/index.php?title=Special:UserLogin&returnto=Security "You are encouraged to log in; however, it is not mandatory [o]")

*Actions*

* [Page](/wiki/Security "View the content page [c]")
* [Discussion](/index.php?title=Talk:Security&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")
* [View source](/index.php?title=Security&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=Security&action=history "Past revisions of this page [h]")

# Security

### From Mahara Wiki

#####

## Contents

* [1 Introduction](#Introduction)
* [2 Security announcements](#Security_announcements)
* [3 How do you test Mahara for security issues?](#How_do_you_test_Mahara_for_security_issues?)
* [4 How do you report a security issue?](#How_do_you_report_a_security_issue?)
* [5 What should you include in your report?](#What_should_you_include_in_your_report?)
* [6 What will we do?](#What_will_we_do?)
* [7 What should you keep in mind?](#What_should_you_keep_in_mind?)
* [8 Security in our development process](#Security_in_our_development_process)
## Introduction

Security is very important to the Mahara project team. As potential issues are reported to us, we will test, patch if necessary, and release fixes as quickly as possible to the Mahara software for organisations to patch their instances.

The Mahara team does not have a bug bounty program. We still appreciate security bug reports and will list their reporters in the [Security researchers](/wiki/Contributors#Security_researchers "Contributors") section of our contributors page as a thank you if issues are reported to us first via a responsible disclosure.

In particular, we appreciate reports that concern the Mahara software. While potential security issues concerning the Mahara infrastructure and supporting tools can be reported, we rely on the security improvements made by the projects who support and package these tools. For example, if you come across security issues in the wiki that is based on MediaWiki, you may wish to report the issue to the MediaWiki project.

## Security announcements

[Security announcements](https://mahara.org/interaction/forum/view.php?id=43) for issues in the Mahara software are made in separately to allow community members to subscribe to them and see them easily.

## How do you test Mahara for security issues?

We do not approve test accounts on mahara.org and other project infrastructure maintained by the Mahara project team that are created for the purpose of finding security or other issues.

Please [install a local copy of Mahara](/wiki/Developer_Area/Developer_Environment "Developer Area/Developer Environment") using the [latest code](https://mahara.org/download) on your own infrastructure to test the software. It is open source and you do not incur any fees for installing it.

## How do you report a security issue?

You can report security bugs in two different ways:

1. **Preferred**: Send an email to [[email protected]](/cdn-cgi/l/email-protection#3c4f595f494e5548457c515d545d4e5d12534e5b). You will receive an automatic reply acknowledging receipt of your report. We do not include your original message.
2. In our [bug tracker](https://bugs.launchpad.net/mahara/%2Bfilebug): If you think (or know) you have found a security bug, please **make sure you click 'This bug is a security vulnerability'** under the 'This bug contains information that is' on the bug tracker form.

Before reporting any potential issues, please verify that

* your report is not covered on our '[Responses to common security reports](/wiki/Security/Responses_to_common_security_reports "Security/Responses to common security reports")' page.
* vulnerabilities with the infrastructure [haven't already been reported](/wiki/Contributors#Mahara_project_infrastructure "Contributors").

We keep a [register of all vulnerabilities that have been addressed in the Mahara codebase](https://mahara.org/interaction/forum/view.php?id=43).

## What should you include in your report?

For the Mahara team to investigate security reports, please provide the following information:

* Whether the issue affects the Mahara application (which version was tested?) or a part of the project infrastructure;
* Type of vulnerability and its impact and severity. We recommend determining the [CVSS vector string and score](https://www.first.org/cvss/calculator/3.0);
* Whether the vulnerability has already been published or shared with others;
* Description of the security issue;
* Step-by-step instructions or proof of concept to replicate the issue;
* Was personal information exposed? If so, what happened with it.

## What will we do?

Our team will investigate vulnerability reports and be in touch with you within 10 New Zealand business days either with follow-up questions or our assessment and next steps. We appreciate your patience. Some bugs take time to investigate and the process may involve a review of the codebase for similar problems.

If you found a security vulnerability in the Mahara codebase that requires mitigation, we will request a CVE, credit you as reporter in the CVE and on our [security contributor page](/wiki/Contributors#Security_researchers "Contributors") (if you like), and provide a timeline for fixing the problem through publishing a security release for all currently supported versions of Mahara. We aim to address security vulnerabilities as quickly as possible and make fixes available to the Mahara community, allowing organisations to patch their own installations of Mahara. We may prioritise the fixing of issues based on scope and severity of the vulnerability.

We make security release announcements via our [official Mahara security advisory forum](https://mahara.org/interaction/forum/view.php?id=43).

## What should you keep in mind?

We ask that you verify that security issues found by automated tools are not **false positives**. For example, reports of 'possible sensitive information in source code' are unlikely to apply to JavaScript files intentionally downloaded by a web browser and stored in our public source code repository.

If you want to report a **TLS configuration** issue, we expect to have an A or A+ rating on [SSLLabs](https://ssllabs.com/). We will only take reports into consideration where our rating would drop below A when caused by TLS configuration issues.

Please note that the Mahara team can only request a **CVE** for security issues in the Mahara application itself. The Mahara project is unable to request CWE numbers for security issues.

The Mahara project **does not run a bug bounty** and cannot compensate for time spent.

## Security in our development process

Mahara developers are committed to achieving the highest standard of security. All commits to the Mahara git repository are reviewed by at least one developer who will enforce the guidelines found in [our code review guidelines](/wiki/Developer_Area/How_to_Review_Code "Developer Area/How to Review Code").

Some of the developers are also members of the security team and follow [the security guidelines](/wiki/Developer_Area/Security_Team "Developer Area/Security Team").

Retrieved from ‘<https://wiki.mahara.org/index.php?title=Security&oldid=13315>’

* This page was last modified on 27 Haziran 2022, at 15:15.
* [Privacy policy](/wiki/Mahara_Wiki%3APrivacy_policy)
* [About Mahara Wiki](/wiki/Mahara_Wiki%3AAbout)
* [Disclaimers](/wiki/Mahara_Wiki%3AGeneral_disclaimer)

* [Powered by MediaWiki](https://www.mediawiki.org/)



=== Content from bugs.launchpad.net_4cecef42_20250125_022458.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# XEE possible in mahara

Bug #1047111 reported by
[Melissa Draper](https://launchpad.net/~melissa)
on 2012-09-07

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.6.0](https://launchpad.net/mahara/%2Bmilestone/1.6.0) |
|  | [1.4](https://bugs.launchpad.net/mahara/1.4) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.4.4](https://launchpad.net/mahara/%2Bmilestone/1.4.4) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.5.3](https://launchpad.net/mahara/%2Bmilestone/1.5.3) |

### Bug Description

There is a security issue with the default XML parser for PHP, where ENTITY fields are

loaded and substituted in text parts.

This allows possible attackers to read from internal networks, or files readable by the

web server user.

This includes reading of the config.php file, which contains sensitive information such

as the database password, and the password salt field.

The fix for this was to include a call to libxml\_disable\_entity\_loader(true) during the

initialization of a page.

More information can be found at the following:

 <http://projects.webappsec.org/w/page/13247003/XML%20External%20Entities>

 <http://websec.io/2012/08/27/Preventing-XEE-in-PHP.html>

Reported by Mike Haworth.

See [original description](comments/0)

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-07

| **summary**: | - XXE possible in mahara+ XEE possible in mahara |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#1](/mahara/%2Bbug/1047111/comments/1) |
| --- | --- | --- | --- |

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297223/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297223)
  (1.8 KiB,
  text/plain)

note that this won't change the default block title if it contains secure content in it, only block content

note that this won't change the default block title if it contains secure content in it, only block content

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#2](/mahara/%2Bbug/1047111/comments/2) |
| --- | --- | --- | --- |

* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297224/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297224)
  (2.0 KiB,
  text/plain)

note that this won't change the default block title if it contains secure content in it, only block content

note that this won't change the default block title if it contains secure content in it, only block content

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#3](/mahara/%2Bbug/1047111/comments/3) |
| --- | --- | --- | --- |

* [xmlsecbug-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297225/%2Bfiles/xmlsecbug-14.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297225)
  (1.8 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#4](/mahara/%2Bbug/1047111/comments/4) |
| --- | --- | --- | --- |

* [xmlsecbug-15.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297226/%2Bfiles/xmlsecbug-15.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297226)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#5](/mahara/%2Bbug/1047111/comments/5) |
| --- | --- | --- | --- |

* [xmlsecbug-16.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297227/%2Bfiles/xmlsecbug-16.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297227)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#6](/mahara/%2Bbug/1047111/comments/6) |
| --- | --- | --- | --- |

* [xmlsecbug-master.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297228/%2Bfiles/xmlsecbug-master.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297228)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-09-14: |  |  | [#7](/mahara/%2Bbug/1047111/comments/7) |
| --- | --- | --- | --- |

* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313736/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313736)
  (1.7 KiB,
  text/plain)

The final fixes for this bug are as follows:

1.4: <https://reviews.mahara.org/#/c/1668/>

1.5: <https://reviews.mahara.org/#/c/1669/>

1.6: <https://reviews.mahara.org/#/c/1670/>

The final fixes for this bug are as follows:
1.4: https://reviews.mahara.org/#/c/1668/
1.5: https://reviews.mahara.org/#/c/1669/
1.6: https://reviews.mahara.org/#/c/1670/

| **visibility**: | private → public |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-09-14: |  |  | [#8](/mahara/%2Bbug/1047111/comments/8) |
| --- | --- | --- | --- |

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313737/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313737)
  (1.7 KiB,
  text/plain)

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-14

| **description**: | updated |
| --- | --- |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-14

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-16:  [**A change has been merged**](/mahara/%2Bbug/1047111/comments/9) |  |  | [#9](/mahara/%2Bbug/1047111/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1784>

Committed: <http://gitorious.org/mahara/mahara/commit/9748c636d45712f23ec730e09a9edbf14c49956b>

Submitter: Melissa Draper (<email address hidden>)

Branch: master

commit 9748c636d45712f23ec730e09a9edbf14c49956b

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1784
Committed: http://gitorious.org/mahara/mahara/commit/9748c636d45712f23ec730e09a9edbf14c49956b
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: master
commit 9748c636d45712f23ec730e09a9edbf14c49956b
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#10](/mahara/%2Bbug/1047111/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1790>

Committed: <http://gitorious.org/mahara/mahara/commit/353870b01a0ba0d6c94c8f7c4e30cabf5627d95f>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.4\_STABLE

commit 353870b01a0ba0d6c94c8f7c4e30cabf5627d95f

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1790
Committed: http://gitorious.org/mahara/mahara/commit/353870b01a0ba0d6c94c8f7c4e30cabf5627d95f
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.4\_STABLE
commit 353870b01a0ba0d6c94c8f7c4e30cabf5627d95f
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#11](/mahara/%2Bbug/1047111/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1792>

Committed: <http://gitorious.org/mahara/mahara/commit/c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.6\_STABLE

commit c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1792
Committed: http://gitorious.org/mahara/mahara/commit/c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.6\_STABLE
commit c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#12](/mahara/%2Bbug/1047111/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1791>

Committed: <http://gitorious.org/mahara/mahara/commit/ecc08a242be1b23fcb10bc4d96e93da128c3a3d6>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.5\_STABLE

commit ecc08a242be1b23fcb10bc4d96e93da128c3a3d6

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1791
Committed: http://gitorious.org/mahara/mahara/commit/ecc08a242be1b23fcb10bc4d96e93da128c3a3d6
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.5\_STABLE
commit ecc08a242be1b23fcb10bc4d96e93da128c3a3d6
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-11-08: |  |  | [#13](/mahara/%2Bbug/1047111/comments/13) |
| --- | --- | --- | --- |

-----BEGIN PGP SIGNED MESSAGE-----

Hash: SHA1

status fixreleased

-----BEGIN PGP SIGNATURE-----

Version: GnuPG v1.4.12 (GNU/Linux)

Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iJwEAQECAAYFAlCbHO8ACgkQuMoJ2LQ3zxH8TAP/YN4BiCJZsn5a899/0UzV31Qg

lM8LXAwZWa6zFv6t0BQUHCqe6eFK9wPp51qgCWWXjUZ3vvvVcsyeWp6626aBFKSU

pCQXI9E7huPw802nJQ9WcZXRBUmgw87ww72Tx4mybnu7SPSrkZgXdnPGSMwDs89N

oWvTpl7Xuac48e6p0lU=

=ouU+

-----END PGP SIGNATURE-----

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
status fixreleased
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iJwEAQECAAYFAlCbHO8ACgkQuMoJ2LQ3zxH8TAP/YN4BiCJZsn5a899/0UzV31Qg
lM8LXAwZWa6zFv6t0BQUHCqe6eFK9wPp51qgCWWXjUZ3vvvVcsyeWp6626aBFKSU
pCQXI9E7huPw802nJQ9WcZXRBUmgw87ww72Tx4mybnu7SPSrkZgXdnPGSMwDs89N
oWvTpl7Xuac48e6p0lU=
=ouU+
-----END PGP SIGNATURE-----

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-05-01:  [**A change has been merged**](/mahara/%2Bbug/1047111/comments/15) |  |  | [#15](/mahara/%2Bbug/1047111/comments/15) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2102>

Committed: <http://gitorious.org/mahara/mahara/commit/f33d4cef66356d3fd96c54bde58bee983d6e61a1>

Submitter: Aaron Wells (<email address hidden>)

Branch: master

commit f33d4cef66356d3fd96c54bde58bee983d6e61a1

Author: Aaron Wells <email address hidden>

Date: Wed May 1 14:16:23 2013 +1200

Documenting safe usage of simplexml\_load\_file()

[Bug1047111](/bugs/1047111)

Change-Id: I850603dbc1d85f4360ce227d2658e5abb51af1aa

Reviewed: https://reviews.mahara.org/2102
Committed: http://gitorious.org/mahara/mahara/commit/f33d4cef66356d3fd96c54bde58bee983d6e61a1
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: master
commit f33d4cef66356d3fd96c54bde58bee983d6e61a1
Author: Aaron Wells <aaronw@catalyst.net.nz>
Date: Wed May 1 14:16:23 2013 +1200
Documenting safe usage of simplexml\_load\_file()
Bug1047111
Change-Id: I850603dbc1d85f4360ce227d2658e5abb51af1aa

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-05-01: |  |  | [#14](/mahara/%2Bbug/1047111/comments/14) |
| --- | --- | --- | --- |

I added a comment to init.php explaining why we used libxml\_disable\_entity\_loader(), and the safe way to use simplexml\_load\_file with LIBXML\_NONET: <https://reviews.mahara.org/#/c/2102/>

I added a comment to init.php explaining why we used libxml\_disable\_entity\_loader(), and the safe way to use simplexml\_load\_file with LIBXML\_NONET: https://reviews.mahara.org/#/c/2102/

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1047111/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297223/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297223 "Change patch details")
* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297224/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297224 "Change patch details")
* [xmlsecbug-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297225/%2Bfiles/xmlsecbug-14.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297225 "Change patch details")
* [xmlsecbug-15.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297226/%2Bfiles/xmlsecbug-15.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297226 "Change patch details")
* [xmlsecbug-16.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297227/%2Bfiles/xmlsecbug-16.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297227 "Change patch details")
* [xmlsecbug-master.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297228/%2Bfiles/xmlsecbug-master.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297228 "Change patch details")
* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313736/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313736 "Change patch details")
* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313737/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313737 "Change patch details")

* [Add patch](/mahara/%2Bbug/1047111/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_1775b6d3_20250126_052851.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# XEE possible in mahara

Bug #1047111 reported by
[Melissa Draper](https://launchpad.net/~melissa)
on 2012-09-07

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.6.0](https://launchpad.net/mahara/%2Bmilestone/1.6.0) |
|  | [1.4](https://bugs.launchpad.net/mahara/1.4) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.4.4](https://launchpad.net/mahara/%2Bmilestone/1.4.4) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | Critical | [Hugh Davenport](https://launchpad.net/~hugh-davenport) | [Mahara 1.5.3](https://launchpad.net/mahara/%2Bmilestone/1.5.3) |

### Bug Description

There is a security issue with the default XML parser for PHP, where ENTITY fields are

loaded and substituted in text parts.

This allows possible attackers to read from internal networks, or files readable by the

web server user.

This includes reading of the config.php file, which contains sensitive information such

as the database password, and the password salt field.

The fix for this was to include a call to libxml\_disable\_entity\_loader(true) during the

initialization of a page.

More information can be found at the following:

 <http://projects.webappsec.org/w/page/13247003/XML%20External%20Entities>

 <http://websec.io/2012/08/27/Preventing-XEE-in-PHP.html>

Reported by Mike Haworth.

See [original description](comments/0)

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-07

| **summary**: | - XXE possible in mahara+ XEE possible in mahara |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#1](/mahara/%2Bbug/1047111/comments/1) |
| --- | --- | --- | --- |

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297223/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297223)
  (1.8 KiB,
  text/plain)

note that this won't change the default block title if it contains secure content in it, only block content

note that this won't change the default block title if it contains secure content in it, only block content

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#2](/mahara/%2Bbug/1047111/comments/2) |
| --- | --- | --- | --- |

* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297224/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297224)
  (2.0 KiB,
  text/plain)

note that this won't change the default block title if it contains secure content in it, only block content

note that this won't change the default block title if it contains secure content in it, only block content

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#3](/mahara/%2Bbug/1047111/comments/3) |
| --- | --- | --- | --- |

* [xmlsecbug-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297225/%2Bfiles/xmlsecbug-14.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297225)
  (1.8 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#4](/mahara/%2Bbug/1047111/comments/4) |
| --- | --- | --- | --- |

* [xmlsecbug-15.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297226/%2Bfiles/xmlsecbug-15.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297226)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#5](/mahara/%2Bbug/1047111/comments/5) |
| --- | --- | --- | --- |

* [xmlsecbug-16.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297227/%2Bfiles/xmlsecbug-16.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297227)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-09-07: |  |  | [#6](/mahara/%2Bbug/1047111/comments/6) |
| --- | --- | --- | --- |

* [xmlsecbug-master.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297228/%2Bfiles/xmlsecbug-master.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297228)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-09-14: |  |  | [#7](/mahara/%2Bbug/1047111/comments/7) |
| --- | --- | --- | --- |

* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313736/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313736)
  (1.7 KiB,
  text/plain)

The final fixes for this bug are as follows:

1.4: <https://reviews.mahara.org/#/c/1668/>

1.5: <https://reviews.mahara.org/#/c/1669/>

1.6: <https://reviews.mahara.org/#/c/1670/>

The final fixes for this bug are as follows:
1.4: https://reviews.mahara.org/#/c/1668/
1.5: https://reviews.mahara.org/#/c/1669/
1.6: https://reviews.mahara.org/#/c/1670/

| **visibility**: | private → public |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-09-14: |  |  | [#8](/mahara/%2Bbug/1047111/comments/8) |
| --- | --- | --- | --- |

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313737/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313737)
  (1.7 KiB,
  text/plain)

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-14

| **description**: | updated |
| --- | --- |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-09-14

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-16:  [**A change has been merged**](/mahara/%2Bbug/1047111/comments/9) |  |  | [#9](/mahara/%2Bbug/1047111/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1784>

Committed: <http://gitorious.org/mahara/mahara/commit/9748c636d45712f23ec730e09a9edbf14c49956b>

Submitter: Melissa Draper (<email address hidden>)

Branch: master

commit 9748c636d45712f23ec730e09a9edbf14c49956b

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1784
Committed: http://gitorious.org/mahara/mahara/commit/9748c636d45712f23ec730e09a9edbf14c49956b
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: master
commit 9748c636d45712f23ec730e09a9edbf14c49956b
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#10](/mahara/%2Bbug/1047111/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1790>

Committed: <http://gitorious.org/mahara/mahara/commit/353870b01a0ba0d6c94c8f7c4e30cabf5627d95f>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.4\_STABLE

commit 353870b01a0ba0d6c94c8f7c4e30cabf5627d95f

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1790
Committed: http://gitorious.org/mahara/mahara/commit/353870b01a0ba0d6c94c8f7c4e30cabf5627d95f
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.4\_STABLE
commit 353870b01a0ba0d6c94c8f7c4e30cabf5627d95f
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#11](/mahara/%2Bbug/1047111/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1792>

Committed: <http://gitorious.org/mahara/mahara/commit/c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.6\_STABLE

commit c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1792
Committed: http://gitorious.org/mahara/mahara/commit/c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.6\_STABLE
commit c1a8c97f665cb558d3c58f0e68bd059c8bfe7fde
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-10-17: |  |  | [#12](/mahara/%2Bbug/1047111/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1791>

Committed: <http://gitorious.org/mahara/mahara/commit/ecc08a242be1b23fcb10bc4d96e93da128c3a3d6>

Submitter: Melissa Draper (<email address hidden>)

Branch: 1.5\_STABLE

commit ecc08a242be1b23fcb10bc4d96e93da128c3a3d6

Author: Hugh Davenport <email address hidden>

Date: Tue Oct 16 13:25:56 2012 +1300

Fix Leap2A import from Moodle

Related to [bug #1047111](/bugs/1047111)

That bug fixed the XXE attack by setting the following to true

     libxml\_disable\_entity\_loader

This caused issues with the leap2a importer used by mnet, which

    used the simplexml\_load to load the xml which relies on file

    based remote entities. For this situation, a the following flag

    is used, which stops network based XXE attacks

     LIBXML\_NONET

Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022

    Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/1791
Committed: http://gitorious.org/mahara/mahara/commit/ecc08a242be1b23fcb10bc4d96e93da128c3a3d6
Submitter: Melissa Draper (melissa@catalyst.net.nz)
Branch: 1.5\_STABLE
commit ecc08a242be1b23fcb10bc4d96e93da128c3a3d6
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Tue Oct 16 13:25:56 2012 +1300
Fix Leap2A import from Moodle
Related to bug #1047111
That bug fixed the XXE attack by setting the following to true
libxml\_disable\_entity\_loader
This caused issues with the leap2a importer used by mnet, which
used the simplexml\_load to load the xml which relies on file
based remote entities. For this situation, a the following flag
is used, which stops network based XXE attacks
LIBXML\_NONET
Change-Id: I3d95ebc9c38374d339d66a80feaa39f5c15f1022
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-11-08: |  |  | [#13](/mahara/%2Bbug/1047111/comments/13) |
| --- | --- | --- | --- |

-----BEGIN PGP SIGNED MESSAGE-----

Hash: SHA1

status fixreleased

-----BEGIN PGP SIGNATURE-----

Version: GnuPG v1.4.12 (GNU/Linux)

Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org/>

iJwEAQECAAYFAlCbHO8ACgkQuMoJ2LQ3zxH8TAP/YN4BiCJZsn5a899/0UzV31Qg

lM8LXAwZWa6zFv6t0BQUHCqe6eFK9wPp51qgCWWXjUZ3vvvVcsyeWp6626aBFKSU

pCQXI9E7huPw802nJQ9WcZXRBUmgw87ww72Tx4mybnu7SPSrkZgXdnPGSMwDs89N

oWvTpl7Xuac48e6p0lU=

=ouU+

-----END PGP SIGNATURE-----

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
status fixreleased
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iJwEAQECAAYFAlCbHO8ACgkQuMoJ2LQ3zxH8TAP/YN4BiCJZsn5a899/0UzV31Qg
lM8LXAwZWa6zFv6t0BQUHCqe6eFK9wPp51qgCWWXjUZ3vvvVcsyeWp6626aBFKSU
pCQXI9E7huPw802nJQ9WcZXRBUmgw87ww72Tx4mybnu7SPSrkZgXdnPGSMwDs89N
oWvTpl7Xuac48e6p0lU=
=ouU+
-----END PGP SIGNATURE-----

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-05-01:  [**A change has been merged**](/mahara/%2Bbug/1047111/comments/15) |  |  | [#15](/mahara/%2Bbug/1047111/comments/15) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2102>

Committed: <http://gitorious.org/mahara/mahara/commit/f33d4cef66356d3fd96c54bde58bee983d6e61a1>

Submitter: Aaron Wells (<email address hidden>)

Branch: master

commit f33d4cef66356d3fd96c54bde58bee983d6e61a1

Author: Aaron Wells <email address hidden>

Date: Wed May 1 14:16:23 2013 +1200

Documenting safe usage of simplexml\_load\_file()

[Bug1047111](/bugs/1047111)

Change-Id: I850603dbc1d85f4360ce227d2658e5abb51af1aa

Reviewed: https://reviews.mahara.org/2102
Committed: http://gitorious.org/mahara/mahara/commit/f33d4cef66356d3fd96c54bde58bee983d6e61a1
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: master
commit f33d4cef66356d3fd96c54bde58bee983d6e61a1
Author: Aaron Wells <aaronw@catalyst.net.nz>
Date: Wed May 1 14:16:23 2013 +1200
Documenting safe usage of simplexml\_load\_file()
Bug1047111
Change-Id: I850603dbc1d85f4360ce227d2658e5abb51af1aa

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-05-01: |  |  | [#14](/mahara/%2Bbug/1047111/comments/14) |
| --- | --- | --- | --- |

I added a comment to init.php explaining why we used libxml\_disable\_entity\_loader(), and the safe way to use simplexml\_load\_file with LIBXML\_NONET: <https://reviews.mahara.org/#/c/2102/>

I added a comment to init.php explaining why we used libxml\_disable\_entity\_loader(), and the safe way to use simplexml\_load\_file with LIBXML\_NONET: https://reviews.mahara.org/#/c/2102/

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1047111/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297223/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297223 "Change patch details")
* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297224/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297224 "Change patch details")
* [xmlsecbug-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297225/%2Bfiles/xmlsecbug-14.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297225 "Change patch details")
* [xmlsecbug-15.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297226/%2Bfiles/xmlsecbug-15.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297226 "Change patch details")
* [xmlsecbug-16.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297227/%2Bfiles/xmlsecbug-16.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297227 "Change patch details")
* [xmlsecbug-master.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3297228/%2Bfiles/xmlsecbug-master.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3297228 "Change patch details")
* [xmlsecbug-13.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313736/%2Bfiles/xmlsecbug-13.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313736 "Change patch details")
* [xmlsecbug-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1047111/%2Battachment/3313737/%2Bfiles/xmlsecbug-12.patch)
  [Edit](/mahara/%2Bbug/1047111/%2Battachment/3313737 "Change patch details")

* [Add patch](/mahara/%2Bbug/1047111/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from mahara.org_f480931a_20250125_022500.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / XML External Entities Vulnerability in versions 1.4.3 and 1.5.2

---

This topic is closed. Only moderators and the group administrators can post new replies.

![anonymous profile picture](https://mahara.org/theme/raw/images/no_userphoto40.png)
Account deleted

Posts: 197

13 September 2012, 20:53

XML External Entities Vulnerability in versions 1.4.3 and 1.5.2

Category:                     XML External Entities
Severity:                       Critical
Versions affected:       < 1.4.4, < 1.5.3
Reported by:               Mike Haworth
Identifier:                      CVE-2012-2239
Bug report:                  [1047111](https://bugs.launchpad.net/mahara/%2Bbug/1047111)

As part of a the [Mahara Security Bug Bounty Program](https://wiki.mahara.org/index.php/Security#Mahara_Security_Bug_Bounty_Program), a critical XML parsing vulnerability was discovered. The vulnerability has been fixed by the Mahara core developers.

Upgrading to Mahara 1.4.4 or 1.5.3 is strongly recommended for all sites running on a php version equal to or greater than 5.2.11.

Download links for fixed versions:

[https://launchpad.net/mahara/+milestone/1.4.4](https://launchpad.net/mahara/%2Bmilestone/1.4.4)
  [https://launchpad.net/mahara/+milestone/1.5.3](https://launchpad.net/mahara/%2Bmilestone/1.5.3)

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from www.debian.org_7f35fb66_20250125_022457.html ===


---

[[Date Prev](msg00234.html)][[Date Next](msg00236.html)]
[[Thread Prev](msg00234.html)][[Thread Next](msg00236.html)]
[[Date Index](maillist.html#00235)]
[[Thread Index](threads.html#00235)]

# [SECURITY] [DSA 2591-1] mahara security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2591-1] mahara security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 28 Dec 2012 02:08:41 +0100
* *Message-id*: <[[🔎]](/msgid-search/20121228010841.GA18216%40pisco.westfalen.local) [20121228010841.GA18216@pisco.westfalen.local](msg00235.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2591-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
December 27, 2012                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : mahara
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-2239 CVE-2012-2243 CVE-2012-2244 CVE-2012-2246
                 CVE-2012-2247 CVE-2012-2253 CVE-2012-6037

Multiple security issues have been found in Mahara - an electronic
portfolio, weblog, and resume builder -, which can result in cross-site
scripting, clickjacking or arbitrary file execution.

For the stable distribution (squeeze), these problems have been fixed in
version 1.2.6-2+squeeze6.

For the unstable distribution (sid), these problems have been fixed in
version 1.5.1-3.1.

We recommend that you upgrade your mahara packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlDc1IMACgkQXm3vHE4uylqMPgCg5dS6sguZrMHSYcBwOKfBL2N+
j2wAn36pxjwQBWzicqcDoQhMnxzZM+PZ
=6mgD
-----END PGP SIGNATURE-----

```

---


