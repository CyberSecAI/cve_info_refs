=== Content from launchpad.net_10fd6ae1_20250126_110134.html ===

[Log in / Register](https://launchpad.net/~dlitz/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~dlitz)

## [Darsey Litzenberger](https://launchpad.net/~dlitz)

* Overview
* [Code](https://code.launchpad.net/~dlitz)
* [Bugs](https://bugs.launchpad.net/~dlitz)
* [Blueprints](https://blueprints.launchpad.net/~dlitz)
* [Translations](https://translations.launchpad.net/~dlitz)
* [Answers](https://answers.launchpad.net/~dlitz)

* [Related packages](https://launchpad.net/~dlitz/%2Brelated-packages)
* [Related projects](https://launchpad.net/~dlitz/%2Brelated-projects)

## User information

Launchpad Id:
dlitz

Email:
[Log in](%2Blogin) for email information.

Member since:
2007-11-13

Languages:

English

OpenPGP keys:

19E11FE8B3CFF273ED174A24928CEC1339C25CF7

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[0](https://launchpad.net/~dlitz/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**dwon**
 on
**irc.freenode.net**

![IRC](/@@/social-irc "IRC")
**dwon**
 on
**irc.oftc.net**

## [All memberships](https://launchpad.net/~dlitz/%2Bparticipation) Latest memberships

| [PyCrypto Developers](/~pycrypto)  Joined on 2008-03-26 | |
| --- | --- |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_cba4b39b_20250125_182933.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpycrypto%2Fpycrypto%2Fblob%2F373ea760f21701b162e8c4912a66928ee30d401a%2FChangeLog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpycrypto%2Fpycrypto%2Fblob%2F373ea760f21701b162e8c4912a66928ee30d401a%2FChangeLog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=pycrypto%2Fpycrypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 27, 2022. It is now read-only.

[pycrypto](/pycrypto)
/
**[pycrypto](/pycrypto/pycrypto)**
Public archive

* [Notifications](/login?return_to=%2Fpycrypto%2Fpycrypto) You must be signed in to change notification settings
* [Fork
  635](/login?return_to=%2Fpycrypto%2Fpycrypto)
* [Star
   2.5k](/login?return_to=%2Fpycrypto%2Fpycrypto)

* [Code](/pycrypto/pycrypto)
* [Issues
  152](/pycrypto/pycrypto/issues)
* [Pull requests
  60](/pycrypto/pycrypto/pulls)
* [Actions](/pycrypto/pycrypto/actions)
* [Projects
  0](/pycrypto/pycrypto/projects)
* [Security](/pycrypto/pycrypto/security)
* [Insights](/pycrypto/pycrypto/pulse)

Additional navigation options

* [Code](/pycrypto/pycrypto)
* [Issues](/pycrypto/pycrypto/issues)
* [Pull requests](/pycrypto/pycrypto/pulls)
* [Actions](/pycrypto/pycrypto/actions)
* [Projects](/pycrypto/pycrypto/projects)
* [Security](/pycrypto/pycrypto/security)
* [Insights](/pycrypto/pycrypto/pulse)

## Files

Â 373ea76
## Breadcrumbs

1. [pycrypto](/pycrypto/pycrypto/tree/373ea760f21701b162e8c4912a66928ee30d401a)
/
# ChangeLog

Copy path Blame  Blame
## Latest commit

## History

[History](/pycrypto/pycrypto/commits/373ea760f21701b162e8c4912a66928ee30d401a/ChangeLog)647 lines (451 loc) Â· 22.5 KBÂ 373ea76
## Breadcrumbs

1. [pycrypto](/pycrypto/pycrypto/tree/373ea760f21701b162e8c4912a66928ee30d401a)
/
# ChangeLog

Top
## File metadata and controls

* Code
* Blame

647 lines (451 loc) Â· 22.5 KB[Raw](https://github.com/pycrypto/pycrypto/raw/373ea760f21701b162e8c4912a66928ee30d401a/ChangeLog)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466472.6=== \* [CVE-2012-2417] Fix LP#985164: insecure ElGamal key generation. (thanks: Legrandin)
 In the ElGamal schemes (for both encryption and signatures), g is supposed to be the generator of the entire Z^\*\_p group. However, in PyCrypto 2.5 and earlier, g is more simply the generator of a random sub-group of Z^\*\_p.
 The result is that the signature space (when the key is used for signing) or the public key space (when the key is used for encryption) may be greatly reduced from its expected size of log(p) bits, possibly down to 1 bit (the worst case if the order of g is 2).
 While it has not been confirmed, it has also been suggested that an attacker might be able to use this fact to determine the private key.
 Anyone using ElGamal keys should generate new keys as soon as practical.
 Any additional information about this bug will be tracked at https://bugs.launchpad.net/pycrypto/+bug/985164
 \* Huge documentation cleanup (thanks: Legrandin).
 \* Added more tests, including test vectors from NIST 800-38A (thanks: Legrandin)
 \* Remove broken MODE\_PGP, which never actually worked properly. A new mode, MODE\_OPENPGP, has been added for people wishing to write OpenPGP implementations. Note that this does not implement the full OpenPGP specification, only the "OpenPGP CFB mode" part of that specification. https://bugs.launchpad.net/pycrypto/+bug/996814
 \* Fix: getPrime with invalid input causes Python to abort with fatal error https://bugs.launchpad.net/pycrypto/+bug/988431
 \* Fix: Segfaults within error-handling paths (thanks: Paul Howarth & Dave Malcolm) https://bugs.launchpad.net/pycrypto/+bug/934294
 \* Fix: Block ciphers allow empty string as IV https://bugs.launchpad.net/pycrypto/+bug/997464
 \* Fix DevURandomRNG to work with Python3's new I/O stack. (thanks: Sebastian Ramacher)
 \* Remove automagic dependencies on libgmp and libmpir, let the caller disable them using args.
 \* Many other minor bug fixes and improvements (mostly thanks to Legrandin)
2.5=== \* Added PKCS#1 encryption schemes (v1.5 and OAEP). We now have a decent, easy-to-use non-textbook RSA implementation. Yay!
 \* Added PKCS#1 signature schemes (v1.5 and PSS). v1.5 required some extensive changes to Hash modules to contain the algorithm specific ASN.1 OID. To that end, we now always have a (thin) Python module to hide the one in pure C.
 \* Added 2 standard Key Derivation Functions (PBKDF1 and PBKDF2).
 \* Added export/import of RSA keys in OpenSSH and PKCS#8 formats.
 \* Added password-protected export/import of RSA keys (one old method for PKCS#8 PEM only).
 \* Added ability to generate RSA key pairs with configurable public exponent e.
 \* Added ability to construct an RSA key pair even if only the private exponent d is known, and not p and q.
 \* Added SHA-2 C source code (fully from Lorenz Quack).
 \* Unit tests for all the above.
 \* Updates to documentation (both inline and in Doc/pycrypt.rst)
 \* All of the above changes were put together by Legrandin (Thanks!)
 \* Minor bug fixes (setup.py and tests).
2.4.1===== \* Fix "error: Setup script exited with error: src/config.h: No such file or directory" when installing via easy\_install. (Sebastian Ramacher)
2.4=== \* Python 3 support! (Thorsten E. Behrens, Anders Sundman) PyCrypto now supports every version of Python from 2.1 through 3.2.
 \* Timing-attack countermeasures in \_fastmath: When built against libgmp version 5 or later, we use mpz\_powm\_sec instead of mpz\_powm. This should prevent the timing attack described by Geremy Condra at PyCon 2011: http://blip.tv/pycon-us-videos-2009-2010-2011/pycon-2011-through-the-side-channel-timing-and-implementation-attacks-in-python-4897955
 \* New hash modules (for Python >= 2.5 only): SHA224, SHA384, and SHA512 (FrÃ©dÃ©ric Bertolus)
 \* Configuration using GNU autoconf. This should help fix a bunch of build issues.
 \* Support using MPIR as an alternative to GMP.
 \* Improve the test command in setup.py, by allowing tests to be performed on a single sub-package or module only. (Legrandin)
 You can now do something like this:
 python setup.py test -m Hash.SHA256 --skip-slow-tests
 \* Fix double-decref of "counter" when Cipher object initialisation fails (Ryan Kelly)
 \* Apply patches from Debian's python-crypto 2.3-3 package (Jan Dittberner, Sebastian Ramacher): - fix-RSA-generate-exception.patch - epydoc-exclude-introspect.patch - no-usr-local.patch
 \* Fix launchpad bug #702835: "Import key code is not compatible with GMP library" (Legrandin)
 \* More tests, better documentation, various bugfixes.
2.3=== \* Fix NameError when attempting to use deprecated getRandomNumber() function.
 \* \_slowmath: Compute RSA u parameter when it's not given to RSA.construct. This makes \_slowmath behave the same as \_fastmath in this regard.
 \* Make RSA.generate raise a more user-friendly exception message when the user tries to generate a bogus-length key.
2.2===
 \* Deprecated Crypto.Util.number.getRandomNumber(), which had confusing semantics. It's been replaced by getRandomNBitInteger and getRandomInteger. (Thanks: Lorenz Quack)
 \* Better isPrime() and getPrime() implementations that do a real Rabin-Miller probabilistic primality test (not the phony test we did before with fixed bases). (Thanks: Lorenz Quack)
 \* getStrongPrime() implementation for generating RSA primes. (Thanks: Lorenz Quack)
 \* Support for importing and exporting RSA keys in DER and PEM format. (Thanks: Legrandin)
 \* Fix PyCrypto when floor division (python -Qnew) is enabled.
 \* When building using gcc, use -std=c99 for compilation. This should fix building on FreeBSD and NetBSD.
2.1.0=====
 \* Fix building PyCrypto on Win64 using MS Visual Studio 9. (Thanks: Nevins Bartolomeo.)
2.1.0beta1==========
 \* Modified RSA.generate() to ensure that e is coprime to p-1 and q-1. Apparently, RSA.generate was capable of generating unusable keys.
2.1.0alpha2===========
 \* Modified isPrime() to release the global interpreter lock while performing computations. (patch from Lorenz Quack)
 \* Release the GIL while encrypting, decrypting, and hashing (but not during initialization or finalization).
 \* API changes:
 - Removed RandomPoolCompat and made Crypto.Util.randpool.RandomPool a wrapper around Crypto.Random that emits a DeprecationWarning. This is to discourage developers from attempting to provide backwards compatibility for systems where there are NO strong entropy sources available.
 - Added Crypto.Random.get\_random\_bytes(). This should allow people to use something like this if they want backwards-compatibility:
 try: from Crypto.Random import get\_random\_bytes except ImportError: try: from os import urandom as get\_random\_bytes except ImportError: get\_random\_bytes = open("/dev/urandom", "rb").read
 - Implemented \_\_ne\_\_() on pubkey, which fixes the following broken behaviour: >>> pk.publickey() == pk.publickey() True >>> pk.publickey() != pk.publickey() True (patch from Lorenz Quack)
 - Block ciphers created with MODE\_CTR can now operate on strings of any size, rather than just multiples of the underlying cipher's block size.
 - Crypto.Util.Counter objects now raise OverflowError when they wrap around to zero. You can override this new behaviour by passing allow\_wraparound=True to Counter.new()
2.1.0alpha1===========
 \* This version supports Python versions 2.1 through 2.6.
 \* Clarified copyright status of much of the existing code by tracking down Andrew M. Kuchling, Barry A. Warsaw, Jeethu Rao, Joris Bontje, Mark Moraes, Paul Swartz, Robey Pointer, and Wim Lewis and getting their permission to clarify the license/public-domain status of their contributions. Many thanks to all involved!
 \* Replaced the test suite with a new, comprehensive package (Crypto.SelfTest) that includes documentation about where its test vectors came from, or how they were derived.
 Use "python setup.py test" to run the tests after building.
 \* API changes:
 - Added Crypto.version\_info, which from now on will contain version information in a format similar to Python's sys.version\_info.
 - Added a new random numbers API (Crypto.Random), and deprecated the old one (Crypto.Util.randpool.RandomPool), which was misused more often than not.
 The new API is used by invoking Crypto.Random.new() and then just reading from the file-like object that is returned.
 CAVEAT: To maintain the security of the PRNG, you must call Crypto.Random.atfork() in both the parent and the child processes whenever you use os.fork(). Otherwise, the parent and child will share copies of the same entropy pool, causing them to return the same results! This is a limitation of Python, which does not provide readily-accessible hooks to os.fork(). It's also a limitation caused by the failure of operating systems to provide sufficiently fast, trustworthy sources of cryptographically-strong random numbers.
 - Crypto.PublicKey now raises ValueError/TypeError/RuntimeError instead of the various custom "error" exceptions
 - Removed the IDEA and RC5 modules due to software patents. Debian has been doing this for a while
 - Added Crypto.Random.random, a strong version of the standard Python 'random' module.
 - Added Crypto.Util.Counter, providing fast counter implementations for use with CTR-mode ciphers.
 \* Bug fixes:
 - Fixed padding bug in SHA256; this resulted in bad digests whenever (the number of bytes hashed) mod 64 == 55.
 - Fixed a 32-bit limitation on the length of messages the SHA256 module could hash.
 - AllOrNothing: Fixed padding bug in digest()
 - Fixed a bad behaviour of the XOR cipher module: It would silently truncate all keys to 32 bytes. Now it raises ValueError when the key is too long.
 - DSA: Added code to enforce FIPS 186-2 requirements on the size of the prime p
 - Fixed the winrandom module, which had been omitted from the build process, causing security problems for programs that misuse RandomPool.
 - Fixed infinite loop when attempting to generate RSA keys with an odd number of bits in the modulus. (Not that you should do that.)
 \* Clarified the documentation for Crypto.Util.number.getRandomNumber.
 Confusingly, this function does NOT return N random bits; It returns a random N-bit number, i.e. a random number between 2\*\*(N-1) and (2\*\*N)-1.
 Note that getRandomNumber is for internal use only and may be renamed or removed in future releases.
 \* Replaced RIPEMD.c with a new implementation (RIPEMD160.c) to alleviate copyright concerns.
 \* Replaced the DES/DES3 modules with ones based on libtomcrypt-1.16 to alleviate copyright concerns.
 \* Replaced Blowfish.c with a new implementation to alleviate copyright concerns.
 \* Added a string-XOR implementation written in C (Crypto.Util.strxor) and used it to speed up Crypto.Hash.HMAC
 \* Converted documentation to reStructured Text.
 \* Added epydoc configuration Doc/epydoc-config
 \* setup.py now emits a warning when building without GMP.
 \* Added pct-speedtest.py to the source tree for doing performance testing on the new code.
 \* Cleaned up the code in several places.
2.0.1=====
 \* Fix SHA256 and RIPEMD on AMD64 platform. \* Deleted Demo/ directory. \* Add PublicKey to Crypto.\_\_all\_\_
2.0===
 \* Added SHA256 module contributed by Jeethu Rao, with test data from Taylor Boon.
 \* Fixed AES.c compilation problems with Borland C.  (Contributed by Jeethu Rao.)
 \* Fix ZeroDivisionErrors on Windows, caused by the system clock not having enough resolution.  \* Fix 2.1/2.2-incompatible use of (key not in dict), pointed out by Ian Bicking.
 \* Fix FutureWarning in Crypto.Util.randpool, noted by James P Rutledge.
 1.9alpha6=========
 \* Util.number.getPrime() would inadvertently round off the bit size; if you asked for a 129-bit prime or 135-bit prime, you got a 128-bit prime.
 \* Added Util/test/prime\_speed.py to measure the speed of prime generation, and PublicKey/test/rsa\_speed.py to measure the speed of RSA operations.
 \* Merged the \_rsa.c and \_dsa.c files into a single accelerator module, \_fastmath.c.
 \* Speed improvements: Added fast isPrime() function to \_fastmath, cutting the time to generate a 1024-bit prime by a factor of 10. Optimized the C version of RSA decryption to use a longer series of operations that's roughly 3x faster than a single exponentiation. (Contributed by Joris Bontje.)
 \* Added support to RSA key objects for blinding and unblinding  data. (Contributed by Joris Bontje.)
 \* Simplified RSA key generation: hard-wired the encryption exponent to 65537 instead of generating a random prime; generate prime factors in a loop until the product  is large enough.  \* Renamed cansign(), canencrypt(), hasprivate(), to  can\_sign, can\_encrypt, has\_private. If people shriek about this change very loudly, I'll add aliases for the old method names that log a warning and call the new method.
1.9alpha5=========
 \* Many randpool changes. RandomPool now has a randomize(N:int) method that can be called to get N bytes of entropy for the pool (N defaults to 0, which 'fills up' the pool's entropy) KeyboardRandom overloads this method.
 \* Added src/winrand.c for Crypto.Util.winrandom and now use winrandom for \_randomize if possible. (Calls Windows CryptoAPI CryptGenRandom)
 \* Several additional places for stirring the pool, capturing inter-event entropy when reading/writing, stirring before and after saves.
 \* RandomPool.add\_event now returns the number of estimated bits of added entropy, rather than the pool entropy itself (since the pool entropy is capped at the number of bits in the pool)
 \* Moved termios code from KeyboardRandomPool into a KeyboardEntry class, provided a version for Windows using msvcrt.
 \* Fix randpool.py crash on machines with poor timer resolution. (Reported by Mark Moraes and others.)
 \* If the GNU GMP library is available, two C extensions will be  compiled to speed up RSA and DSA operations. (Contributed by  Paul Swartz.)
 \* DES3 with a 24-byte key was broken; now fixed.  (Patch by Philippe Frycia.)
1.9alpha4=========
 \* Fix compilation problem on Windows.
 \* HMAC.py fixed to work with pre-2.2 Pythons  \* setup.py now dies if built with Python 1.x
1.9alpha3=========
 \* Fix a ref-counting bug that caused core dumps.  (Reported by Piers Lauder and an anonymous SF poster.)
1.9alpha2=========
 \* (Backwards incompatible) The old Crypto.Hash.HMAC module is gone, replaced by a copy of hmac.py from Python 2.2's standard library. It will display a warning on interpreter versions older than 2.2.  \* (Backwards incompatible) Restored the Crypto.Protocol package, and modernized and tidied up the two modules in it, AllOrNothing.py and Chaffing.py, renaming various methods and changing the interface.  \* (Backwards incompatible) Changed the function names in Crypto.Util.RFC1751.  \* Restored the Crypto.PublicKey package at user request. I think I'll leave it in the package and warn about it in the documentation. I hope that eventually I can point to someone else's better public-key code, and at that point I may insert warnings and begin the process of deprecating this code.
 \* Fix use of a Python 2.2 C function, replacing it with a  2.1-compatible equivalent. (Bug report and patch by Andrew Eland.)
 \* Fix endianness bugs that caused test case failures on Sparc, PPC, and doubtless other platforms.
 \* Fixed compilation problem on FreeBSD and MacOS X.  \* Expanded the test suite (requires Sancho, from  http://www.mems-exchange.org/software/sancho/)
 \* Added lots of docstrings, so 'pydoc Crypto' now produces  helpful output. (Open question: maybe \*all\* of the documentation should be moved into docstrings?)  \* Make test.py automatically add the build/\* directory to sys.path.
 \* Removed 'inline' declaration from C functions. Some compilers don't support it, and Python's pyconfig.h no longer tells you whether it's supported or not. After this change, some ciphers got slower, but others got faster.  \* The C-level API has been changed to reduce the amount of memory-to-memory copying. This makes the code neater, but  had ambiguous performance effects; again, some ciphers got slower and others became faster. Probably this is due to my compiler optimizing slightly worse or better as a result.
 \* Moved C source implementations into src/ from block/, hash/,  and stream/. Having Hash/ and hash/ directories causes problems on case-insensitive filesystems such as Mac OS.
 \* Cleaned up the C code for the extensions.  1.9alpha1=========
 \* Added Crypto.Cipher.AES.
 \* Added the CTR mode and the variable-sized CFB mode from the NIST standard on feedback modes.   \* Removed Diamond, HAVAL, MD5, Sapphire, SHA, and Skipjack. MD5 and SHA are included with Python; the others are all of marginal usefulness in the real world.
 \* Renamed the module-level constants ECB, CFB, &c., to MODE\_ECB, MODE\_CFB, as part of making the block encryption modules  compliant with PEP 272. (I'm not sure about this change; if enough users complain about it, I might back it out.)  \* Made the hashing modules compliant with PEP 247 (not backward compatible -- the major changes are that the constructor is now  MD2.new and not MD2.MD2, and the size of the digest is now  given as 'digest\_size', not 'digestsize'.
 \* The Crypto.PublicKey package is no longer installed; the interfaces are all wrong, and I have no idea what the right interfaces should be.
1.1alpha2========= \* Most importantly, the distribution has been broken into twoparts: exportable, and export-controlled. The exportable partcontains all the hashing algorithms, signature-only public keyalgorithms, chaffing & winnowing, random number generation, variousutility modules, and the documentation.
 The export-controlled part contains public-key encryptionalgorithms such as RSA and ElGamal, and bulk encryption algorithmslike DES, IDEA, or Skipjack. Getting this code still requires thatyou go through an access control CGI script, and denies you access ifyou're outside the US or Canada.
 \* Added the RIPEMD hashing algorithm. (Contributed byHirendra Hindocha.)
 \* Implemented the recently declassified Skipjack blockencryption algorithm. My implementation runs at 864 K/sec on aPII/266, which isn't particularly fast, but you're probably better offusing another algorithm anyway. :)
 \* A simple XOR cipher has been added, mostly for use by thechaffing/winnowing code. (Contributed by Barry Warsaw.)
 \* Added Protocol.Chaffing and Hash.HMAC.py. (Contributed byBarry Warsaw.)
 Protocol.Chaffing implements chaffing and winnowing, recentlyproposed by R. Rivest, which hides a message (the wheat) by addingmany noise messages to it (the chaff). The chaff can be discarded bythe receiver through a message authentication code. The neat thingabout this is that it allows secret communication without actuallyhaving an encryption algorithm, and therefore this falls within theexportable subset.
 \* Tidied up randpool.py, and removed its use of a blockcipher; this makes it work with only the export-controlled subsetavailable.
 \* Various renamings and reorganizations, mostly internal.
 1.0.2=====
 \* Changed files to work with Python 1.5; everything has beenre-arranged into a hierarchical package. (Not backward compatible.)The package organization is:Crypto. Hash. MD2, MD4, MD5, SHA, HAVAL Cipher. ARC2, ARC4, Blowfish, CAST, DES, DES3, Diamond,  IDEA, RC5, Sapphire PublicKey. DSA, ElGamal, qNEW, RSA Util. number, randpool, RFC1751
 Since this is backward-incompatible anyway, I also changedmodule names from all lower-case to mixed-case: diamond -> Diamond,rc5 -> RC5, etc. That had been an annoying inconsistency for a while.  \* Added CAST5 module contributed by <wiml@hhhh.org>.
 \* Added qNEW digital signature algorithm (from the digisign.pyI advertised a while back). (If anyone would like to suggest newalgorithms that should be implemented, please do; I think I've goteverything that's really useful at the moment, but...)
 \* Support for keyword arguments has been added. This allowedremoving the obnoxious key handling for Diamond and RC5, where thefirst few bytes of the key indicated the number of rounds to use, andvarious other parameters. Now you need only do something like:
from Crypto.Cipher import RC5obj = RC5.new(key, RC5.ECB, rounds=8)
(Not backward compatible.)
 \* Various function names have been changed, and parameternames altered. None of these were part of the public interface, so itshouldn't really matter much.
 \* Various bugs fixed, the test suite has been expanded, andthe build process simplified.
 \* Updated the documentation accordingly.
 1.0.1=====  \* Changed files to work with Python 1.4 .
 \* The DES and DES3 modules now automatically correct theparity of their keys.  \* Added R. Rivest's DES test (see http://theory.lcs.mit.edu/~rivest/destest.txt)
1.0.0=====
 \* REDOC III succumbed to differential cryptanalysis, and hasbeen removed.
 \* The crypt and rotor modules have been dropped; they're stillavailable in the standard Python distribution.
 \* The Ultra-Fast crypt() module has been placed in a separatedistribution.
 \* Various bugs fixed.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from bugs.launchpad.net_157568bb_20250126_110135.html ===

[Log in / Register](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Blogin)

[![](/@@/product-logo)](https://launchpad.net/pycrypto)

## [Python-Crypto](https://launchpad.net/pycrypto)

* [Overview](https://launchpad.net/pycrypto)
* [Code](https://code.launchpad.net/pycrypto)
* [Bugs](https://bugs.launchpad.net/pycrypto)
* [Blueprints](https://blueprints.launchpad.net/pycrypto)
* [Translations](https://translations.launchpad.net/pycrypto)
* [Answers](https://answers.launchpad.net/pycrypto)

# ElGamal key generation is broken

Bug #985164 reported by
[Legrandin](https://launchpad.net/~gooksankoo)
on 2012-04-18

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Python-Crypto](https://bugs.launchpad.net/pycrypto) | Fix Released | High | Unassigned |  |

### Bug Description

In the ElGamal schemes (for both encryption and signatures), g is supposed to be the generator of the entire Z^\*\_p group.

However, in the current implementation, g is more simply the generator of a random sub-group of Z^\*\_p.

The order of such sub-group may be smaller than p-1, and since there are not constraints or checks on the factorization of p-1, the order may be \*much\* smaller than what it should be.

To say, if I limit the bit size to 8 bits, I get p=211 and g=107. The order of g is 42, much less than the expected (and "secure") 210!

See [original description](comments/0)

## CVE References

* [2012-2417](/bugs/cve/2012-2417 "PyCrypto before 2.6 does not produce ...")

[Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo)
on 2012-04-18

| **visibility**: | private â†’ public |
| --- | --- |

[Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo)
on 2012-04-18

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo) wrote on 2012-04-18: |  |  | [#1](/pycrypto/%2Bbug/985164/comments/1) |
| --- | --- | --- | --- |

Patch available here:

<https://github.com/Legrandin/pycrypto/commit/9f912f13df99ad3421eff360d6a62d7dbec755c2>

Patch available here:
https://github.com/Legrandin/pycrypto/commit/9f912f13df99ad3421eff360d6a62d7dbec755c2

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#2](/pycrypto/%2Bbug/985164/comments/2) |
| --- | --- | --- | --- |

Thanks for this. Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)

Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

Thanks for this. Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)
Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#3](/pycrypto/%2Bbug/985164/comments/3) |
| --- | --- | --- | --- |

This looks relevant: <http://tools.ietf.org/html/rfc2785>

This looks relevant: http://tools.ietf.org/html/rfc2785

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#4](/pycrypto/%2Bbug/985164/comments/4) |
| --- | --- | --- | --- |

Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo) wrote on 2012-04-22: |  |  | [#5](/pycrypto/%2Bbug/985164/comments/5) |
| --- | --- | --- | --- |

> Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)

One way is to factor p-1 and find all its divisors. The divisors are also all the possible orders a sub-group of Zp can have.

The generator g is safe (with respect to this problem) if g^d mod p is not 1 for all divisors other than p-1.

That may not be enough though: when the key is used for signing, one should also check that g and g^{-1} don't divide p-1 (see patch). Those are at least the additional contraints I have found so far for the key...

> Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

g is also made public, so that would be only relevant if the attack was based on some precomputation I think. The main problem I see is that the signature space (when the key is used for signing) or the public key space (when the key is used for encryption) may be greatly reduced from log(p) bits down to up 1 bit (worst case if the order of g is 2). That's already bad enough, but it could be that such fact may also be used to work out the private key (which the RFC you have found seem to imply).

> Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

I can submit a complete/tested/polished set of changes in one week time. As you can guess, the changes are mostly about improving documentation of the public key module: right now, qnew and maybe pycrypt.rst are still missing. I run into this problem by reviewing the Elgamal code.

> Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)
One way is to factor p-1 and find all its divisors. The divisors are also all the possible orders a sub-group of Zp can have.
The generator g is safe (with respect to this problem) if g^d mod p is not 1 for all divisors other than p-1.
That may not be enough though: when the key is used for signing, one should also check that g and g^{-1} don't divide p-1 (see patch). Those are at least the additional contraints I have found so far for the key...
> Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.
g is also made public, so that would be only relevant if the attack was based on some precomputation I think. The main problem I see is that the signature space (when the key is used for signing) or the public key space (when the key is used for encryption) may be greatly reduced from log(p) bits down to up 1 bit (worst case if the order of g is 2). That's already bad enough, but it could be that such fact may also be used to work out the private key (which the RFC you have found seem to imply).
> Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?
I can submit a complete/tested/polished set of changes in one week time. As you can guess, the changes are mostly about improving documentation of the public key module: right now, qnew and maybe pycrypt.rst are still missing. I run into this problem by reviewing the Elgamal code.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-24: |  |  | [#6](/pycrypto/%2Bbug/985164/comments/6) |
| --- | --- | --- | --- |

I've got a CVE identifier for this issue: CVE-2012-2417

I've got a CVE identifier for this issue: CVE-2012-2417

[Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz)
on 2012-04-25

| Changed in pycrypto: | |
| --- | --- |
| **importance**: | Undecided â†’ High |
| **status**: | New â†’ In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-05-24: |  |  | [#7](/pycrypto/%2Bbug/985164/comments/7) |
| --- | --- | --- | --- |

Fixed in PyCrypto 2.6.

Fixed in PyCrypto 2.6.

| Changed in pycrypto: | |
| --- | --- |
| **status**: | In Progress â†’ Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mike Doherty (doherty)](https://launchpad.net/~doherty) wrote on 2012-06-28: |  |  | [#8](/pycrypto/%2Bbug/985164/comments/8) |
| --- | --- | --- | --- |

How can the user know whether they have an ElGamal key generated by the vulnerable versions of PyCrypto? For example, it is not stated in USN-1484-1 whether this library is used by Seahorse. The security notice also did not specify that users should replace the potentially-vulnerable keys. Even more disappointing, the notice states that "The problem can be corrected by updating your system..." Well, the software may be fixed, but the potentially-insecure keys are not magically made more secure by upgrading PyCrypto.

How can the user know whether they have an ElGamal key generated by the vulnerable versions of PyCrypto? For example, it is not stated in USN-1484-1 whether this library is used by Seahorse. The security notice also did not specify that users should replace the potentially-vulnerable keys. Even more disappointing, the notice states that "The problem can be corrected by updating your system..." Well, the software may be fixed, but the potentially-insecure keys are not magically made more secure by upgrading PyCrypto.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mike Doherty (doherty)](https://launchpad.net/~doherty) wrote on 2012-06-28: |  |  | [#9](/pycrypto/%2Bbug/985164/comments/9) |
| --- | --- | --- | --- |

I'm sorry, the notice does in fact recommend regenerating keys.

I'm sorry, the notice does in fact recommend regenerating keys.

[See full activity log](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/pycrypto/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/pycrypto/%2Bbug/985164/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.debian.org_7cc1ccb8_20250125_182927.html ===


---

[[Date Prev](msg00141.html)][[Date Next](msg00143.html)]
[[Thread Prev](msg00141.html)][[Thread Next](msg00143.html)]
[[Date Index](maillist.html#00142)]
[[Thread Index](threads.html#00142)]

# [SECURITY] [DSA 2502-1] python-crypto security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2502-1] python-crypto security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 24 Jun 2012 22:37:16 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20120624203716.GA5562%40pisco.westfalen.local)Â [20120624203716.GA5562@pisco.westfalen.local](msg00142.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2502-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
June 24, 2012                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : python-crypto
Vulnerability  : programming error
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-2417

It was discovered that that the ElGamal code in PythonCrypto, a
collection of cryptographic algorithms and protocols for Python used
insecure insufficient prime numbers in key generation, which lead to a
weakened signature or public key space, allowing easier brute force
attacks on such keys.

For the stable distribution (squeeze), this problem has been fixed in
version 2.1.0-2+squeeze1.

For the unstable distribution (sid), this problem has been fixed in
version 2.6-1.

We recommend that you upgrade your python-crypto packages. After
installing this update, previously generated keys need to be regenerated.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAk/nejoACgkQXm3vHE4uylpcwQCgy8NI7uK5JDoG1wECP5DalcHJ
Sh8AnArv97xwCBREhnhWhALGIDxEFiOO
=c1sj
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.launchpad.net_34dbe17f_20250126_110134.html ===

[Log in / Register](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Blogin)

[![](/@@/product-logo)](https://launchpad.net/pycrypto)

## [Python-Crypto](https://launchpad.net/pycrypto)

* [Overview](https://launchpad.net/pycrypto)
* [Code](https://code.launchpad.net/pycrypto)
* [Bugs](https://bugs.launchpad.net/pycrypto)
* [Blueprints](https://blueprints.launchpad.net/pycrypto)
* [Translations](https://translations.launchpad.net/pycrypto)
* [Answers](https://answers.launchpad.net/pycrypto)

# ElGamal key generation is broken

Bug #985164 reported by
[Legrandin](https://launchpad.net/~gooksankoo)
on 2012-04-18

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Python-Crypto](https://bugs.launchpad.net/pycrypto) | Fix Released | High | Unassigned |  |

### Bug Description

In the ElGamal schemes (for both encryption and signatures), g is supposed to be the generator of the entire Z^\*\_p group.

However, in the current implementation, g is more simply the generator of a random sub-group of Z^\*\_p.

The order of such sub-group may be smaller than p-1, and since there are not constraints or checks on the factorization of p-1, the order may be \*much\* smaller than what it should be.

To say, if I limit the bit size to 8 bits, I get p=211 and g=107. The order of g is 42, much less than the expected (and "secure") 210!

See [original description](comments/0)

## CVE References

* [2012-2417](/bugs/cve/2012-2417 "PyCrypto before 2.6 does not produce ...")

[Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo)
on 2012-04-18

| **visibility**: | private â†’ public |
| --- | --- |

[Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo)
on 2012-04-18

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo) wrote on 2012-04-18: |  |  | [#1](/pycrypto/%2Bbug/985164/comments/1) |
| --- | --- | --- | --- |

Patch available here:

<https://github.com/Legrandin/pycrypto/commit/9f912f13df99ad3421eff360d6a62d7dbec755c2>

Patch available here:
https://github.com/Legrandin/pycrypto/commit/9f912f13df99ad3421eff360d6a62d7dbec755c2

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#2](/pycrypto/%2Bbug/985164/comments/2) |
| --- | --- | --- | --- |

Thanks for this. Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)

Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

Thanks for this. Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)
Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#3](/pycrypto/%2Bbug/985164/comments/3) |
| --- | --- | --- | --- |

This looks relevant: <http://tools.ietf.org/html/rfc2785>

This looks relevant: http://tools.ietf.org/html/rfc2785

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-21: |  |  | [#4](/pycrypto/%2Bbug/985164/comments/4) |
| --- | --- | --- | --- |

Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Legrandin (gooksankoo)](https://launchpad.net/~gooksankoo) wrote on 2012-04-22: |  |  | [#5](/pycrypto/%2Bbug/985164/comments/5) |
| --- | --- | --- | --- |

> Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)

One way is to factor p-1 and find all its divisors. The divisors are also all the possible orders a sub-group of Zp can have.

The generator g is safe (with respect to this problem) if g^d mod p is not 1 for all divisors other than p-1.

That may not be enough though: when the key is used for signing, one should also check that g and g^{-1} don't divide p-1 (see patch). Those are at least the additional contraints I have found so far for the key...

> Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.

g is also made public, so that would be only relevant if the attack was based on some precomputation I think. The main problem I see is that the signature space (when the key is used for signing) or the public key space (when the key is used for encryption) may be greatly reduced from log(p) bits down to up 1 bit (worst case if the order of g is 2). That's already bad enough, but it could be that such fact may also be used to work out the private key (which the RFC you have found seem to imply).

> Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?

I can submit a complete/tested/polished set of changes in one week time. As you can guess, the changes are mostly about improving documentation of the public key module: right now, qnew and maybe pycrypt.rst are still missing. I run into this problem by reviewing the Elgamal code.

> Do you know if there is a way to take an existing key and find out whether it has this problem? (Even better, to compute the order of the sub-group?)
One way is to factor p-1 and find all its divisors. The divisors are also all the possible orders a sub-group of Zp can have.
The generator g is safe (with respect to this problem) if g^d mod p is not 1 for all divisors other than p-1.
That may not be enough though: when the key is used for signing, one should also check that g and g^{-1} don't divide p-1 (see patch). Those are at least the additional contraints I have found so far for the key...
> Also, given that this is a \*random\* sub-group, does this actually help an attacker? I'm going to fix this anyway, but I want to get an understanding of how bad this is. I don't know much about ElGamal encryption.
g is also made public, so that would be only relevant if the attack was based on some precomputation I think. The main problem I see is that the signature space (when the key is used for signing) or the public key space (when the key is used for encryption) may be greatly reduced from log(p) bits down to up 1 bit (worst case if the order of g is 2). That's already bad enough, but it could be that such fact may also be used to work out the private key (which the RFC you have found seem to imply).
> Is it okay if I just merge your entire tree (up to 6f312637208cc70b231892109564e2aebc92728a)?
I can submit a complete/tested/polished set of changes in one week time. As you can guess, the changes are mostly about improving documentation of the public key module: right now, qnew and maybe pycrypt.rst are still missing. I run into this problem by reviewing the Elgamal code.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-04-24: |  |  | [#6](/pycrypto/%2Bbug/985164/comments/6) |
| --- | --- | --- | --- |

I've got a CVE identifier for this issue: CVE-2012-2417

I've got a CVE identifier for this issue: CVE-2012-2417

[Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz)
on 2012-04-25

| Changed in pycrypto: | |
| --- | --- |
| **importance**: | Undecided â†’ High |
| **status**: | New â†’ In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Darsey Litzenberger (dlitz)](https://launchpad.net/~dlitz) wrote on 2012-05-24: |  |  | [#7](/pycrypto/%2Bbug/985164/comments/7) |
| --- | --- | --- | --- |

Fixed in PyCrypto 2.6.

Fixed in PyCrypto 2.6.

| Changed in pycrypto: | |
| --- | --- |
| **status**: | In Progress â†’ Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mike Doherty (doherty)](https://launchpad.net/~doherty) wrote on 2012-06-28: |  |  | [#8](/pycrypto/%2Bbug/985164/comments/8) |
| --- | --- | --- | --- |

How can the user know whether they have an ElGamal key generated by the vulnerable versions of PyCrypto? For example, it is not stated in USN-1484-1 whether this library is used by Seahorse. The security notice also did not specify that users should replace the potentially-vulnerable keys. Even more disappointing, the notice states that "The problem can be corrected by updating your system..." Well, the software may be fixed, but the potentially-insecure keys are not magically made more secure by upgrading PyCrypto.

How can the user know whether they have an ElGamal key generated by the vulnerable versions of PyCrypto? For example, it is not stated in USN-1484-1 whether this library is used by Seahorse. The security notice also did not specify that users should replace the potentially-vulnerable keys. Even more disappointing, the notice states that "The problem can be corrected by updating your system..." Well, the software may be fixed, but the potentially-insecure keys are not magically made more secure by upgrading PyCrypto.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mike Doherty (doherty)](https://launchpad.net/~doherty) wrote on 2012-06-28: |  |  | [#9](/pycrypto/%2Bbug/985164/comments/9) |
| --- | --- | --- | --- |

I'm sorry, the notice does in fact recommend regenerating keys.

I'm sorry, the notice does in fact recommend regenerating keys.

[See full activity log](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/pycrypto/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/pycrypto/%2Bbug/985164/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/pycrypto/%2Bbug/985164/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from secunia.com_08064721_20250125_182926.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from www.mandriva.com_9794a93b_20250125_182929.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* LanguageÂ ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + FranÃ§ais
  + ÃÂ Ã‘ÂƒÃ‘ÂÃ‘ÂÃÂºÃÂ¸ÃÂ¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site Â»

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site Â»

Language
English (International)
FranÃ§ais
ÃÂ Ã‘ÂƒÃ‘ÂÃ‘ÂÃÂºÃÂ¸ÃÂ¹

* Â© 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from github.com_049a0f7a_20250125_182931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLegrandin%2Fpycrypto%2Fcommit%2F9f912f13df99ad3421eff360d6a62d7dbec755c2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLegrandin%2Fpycrypto%2Fcommit%2F9f912f13df99ad3421eff360d6a62d7dbec755c2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Legrandin%2Fpycrypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Legrandin](/Legrandin)
/
**[pycrypto](/Legrandin/pycrypto)**
Public

forked from [pycrypto/pycrypto](/pycrypto/pycrypto)

* [Notifications](/login?return_to=%2FLegrandin%2Fpycrypto) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2FLegrandin%2Fpycrypto)
* [Star
   10](/login?return_to=%2FLegrandin%2Fpycrypto)

* [Code](/Legrandin/pycrypto)
* [Pull requests
  0](/Legrandin/pycrypto/pulls)
* [Actions](/Legrandin/pycrypto/actions)
* [Projects
  0](/Legrandin/pycrypto/projects)
* [Wiki](/Legrandin/pycrypto/wiki)
* [Security](/Legrandin/pycrypto/security)
* [Insights](/Legrandin/pycrypto/pulse)

Additional navigation options

* [Code](/Legrandin/pycrypto)
* [Pull requests](/Legrandin/pycrypto/pulls)
* [Actions](/Legrandin/pycrypto/actions)
* [Projects](/Legrandin/pycrypto/projects)
* [Wiki](/Legrandin/pycrypto/wiki)
* [Security](/Legrandin/pycrypto/security)
* [Insights](/Legrandin/pycrypto/pulse)

## Commit

[Permalink](/Legrandin/pycrypto/commit/9f912f13df99ad3421eff360d6a62d7dbec755c2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix to bug #985164 (ElGamal key generation). Fix to missing range cheâ€¦

[Browse files](/Legrandin/pycrypto/tree/9f912f13df99ad3421eff360d6a62d7dbec755c2)
Browse the repository at this point in the history

```
â€¦ck in signature verification.
```

* Loading branch information

Legrandin
committed
Apr 18, 2012

1 parent
[c8e2138](/Legrandin/pycrypto/commit/c8e21380a6059a56bd88267a5e744ddd8badfe66)

commit 9f912f1

Showing
**1 changed file**
with
**40 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

64 changes: 40 additions & 24 deletions

64
[lib/Crypto/PublicKey/ElGamal.py](#diff-53da0c2e2278ee903b554222c089da9c63f18e92d730657f25ad63368e025147 "lib/Crypto/PublicKey/ElGamal.py")

Show comments

[View file](/Legrandin/pycrypto/blob/9f912f13df99ad3421eff360d6a62d7dbec755c2/lib/Crypto/PublicKey/ElGamal.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -110,6 +110,9 @@ class error (Exception): |
|  |  | def generate(bits, randfunc, progress\_func=None): |
|  |  | """Randomly generate a fresh, new ElGamal key. |
|  |  |  |
|  |  | The key will be safe for use for both encryption and signature |
|  |  | (although it should be used for \*\*only one\*\* purpose). |
|  |  |  |
|  |  | :Parameters: |
|  |  | bits : int |
|  |  | Key length, or size (in bits) of the modulus \*p\*. |
| Expand All | | @@ -131,37 +134,48 @@ def generate(bits, randfunc, progress\_func=None): |
|  |  | :Return: An ElGamal key object (`ElGamalobj`). |
|  |  | """ |
|  |  | obj=ElGamalobj() |
|  |  | # Generate prime p |
|  |  | # Generate a safe prime p |
|  |  | # See Algorithm 4.86 in Handbook of Applied Cryptography |
|  |  | if progress\_func: |
|  |  | progress\_func('p\n') |
|  |  | obj.p=bignum(getPrime(bits, randfunc)) |
|  |  | # Generate random number g |
|  |  | while 1: |
|  |  | q = bignum(getPrime(bits-1, randfunc)) |
|  |  | obj.p = 2\*q+1 |
|  |  | if number.isPrime(obj.p, randfunc=randfunc): |
|  |  | break |
|  |  | # Generate generator g |
|  |  | # See Algorithm 4.80 in Handbook of Applied Cryptography |
|  |  | # Note that the order of the group is n=p-1=2q, where q is prime |
|  |  | if progress\_func: |
|  |  | progress\_func('g\n') |
|  |  | size=bits-1-(ord(randfunc(1)) & 63) # g will be from 1--64 bits smaller than p |
|  |  | if size<1: |
|  |  | size=bits-1 |
|  |  | while (1): |
|  |  | obj.g=bignum(getPrime(size, randfunc)) |
|  |  | if obj.g < obj.p: |
|  |  | while 1: |
|  |  | # We must avoid g=2 because of Bleichenbacher's attack described |
|  |  | # in "Generating ElGamal signatures without knowning the secret key", |
|  |  | # 1996 |
|  |  | # |
|  |  | obj.g = number.getRandomRange(3, obj.p, randfunc) |
|  |  | safe = 1 |
|  |  | if pow(obj.g, 2, obj.p)==1: |
|  |  | safe=0 |
|  |  | if safe and pow(obj.g, q, obj.p)==1: |
|  |  | safe=0 |
|  |  | # Discard g if it divides p-1 because of the attack described |
|  |  | # in Note 11.67 (iii) in HAC |
|  |  | if safe and divmod(obj.p-1, obj.g)[1]==0: |
|  |  | safe=0 |
|  |  | # g^{-1} must not divide p-1 because of Khadir's attack |
|  |  | # described in "Conditions of the generator for forging ElGamal |
|  |  | # signature", 2011 |
|  |  | ginv = number.inverse(obj.g, obj.p) |
|  |  | if safe and divmod(obj.p-1, ginv)[1]==0: |
|  |  | safe=0 |
|  |  | if safe: |
|  |  | break |
|  |  | size=(size+1) % bits |
|  |  | if size==0: |
|  |  | size=4 |
|  |  | # Generate random number x |
|  |  | # Generate private key x |
|  |  | if progress\_func: |
|  |  | progress\_func('x\n') |
|  |  | while (1): |
|  |  | size=bits-1-ord(randfunc(1)) # x will be from 1 to 256 bits smaller than p |
|  |  | if size>2: |
|  |  | break |
|  |  | while (1): |
|  |  | obj.x=bignum(getPrime(size, randfunc)) |
|  |  | if obj.x < obj.p: |
|  |  | break |
|  |  | size = (size+1) % bits |
|  |  | if size==0: |
|  |  | size=4 |
|  |  | obj.x=number.getRandomRange(2, obj.p-1, randfunc) |
|  |  | # Generate public key y |
|  |  | if progress\_func: |
|  |  | progress\_func('y\n') |
|  |  | obj.y = pow(obj.g, obj.x, obj.p) |
| Expand Down  Expand Up | | @@ -326,6 +340,8 @@ def \_sign(self, M, K): |
|  |  | return (a, b) |
|  |  |  |
|  |  | def \_verify(self, M, sig): |
|  |  | if sig[0]<1 or sig[0]>p-1: |
|  |  | return 0 |
|  |  | v1=pow(self.y, sig[0], self.p) |
|  |  | v1=(v1\*pow(sig[0], sig[1], self.p)) % self.p |
|  |  | v2=pow(self.g, M, self.p) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9f912f1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLegrandin%2Fpycrypto%2Fcommit%2F9f912f13df99ad3421eff360d6a62d7dbec755c2) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.openwall.com_78408287_20250125_182929.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2012/05/24/14) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120524233054.GA6157@rivest.dlitz.net>
Date: Thu, 24 May 2012 19:30:54 -0400
From: "Dwayne C. Litzenberger" <dlitz@...tz.net>
To: oss-security@...ts.openwall.com
Subject: CVE-2012-2417 - PyCrypto <= 2.5 insecure ElGamal key generation

CVE-2012-2417 [https://bugs.launchpad.net/pycrypto/+bug/985164](https://bugs.launchpad.net/pycrypto/%2Bbug/985164)

PyCrypto (also known as python-crypto) versions 2.5 and earlier implement
incorrect ElGamal key generation.  The bug has been fixed in PyCrypto
2.6, which was released this morning.  Details below:

     In the ElGamal schemes (for both encryption and signatures), g is
     supposed to be the generator of the entire Z^*_p group. However, in
     PyCrypto 2.5 and earlier, g is more simply the generator of a random
     sub-group of Z^*_p.

     The result is that the signature space (when the key is used for
     signing) or the public key space (when the key is used for encryption)
     may be greatly reduced from its expected size of log(p) bits, possibly
     down to 1 bit (the worst case if the order of g is 2).

     While it has not been confirmed, it has also been suggested that an
     attacker might be able to use this fact to determine the private key.

Anyone using ElGamal keys should generate new keys as soon as practical.

Any additional information about this bug will be tracked at the above URL.

--
Dwayne C. Litzenberger <dlitz@...tz.net>
  OpenPGP: 19E1 1FE8 B3CF F273 ED17  4A24 928C EC13 39C2 5CF7

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (223 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


