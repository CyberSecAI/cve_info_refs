=== Content from www.debian.org_6bf655fd_20250124_234546.html ===


---

[[Date Prev](msg00180.html)][[Date Next](msg00182.html)]
[[Thread Prev](msg00180.html)][[Thread Next](msg00182.html)]
[[Date Index](maillist.html#00181)]
[[Thread Index](threads.html#00181)]

# [SECURITY] [DSA 2540-1] mahara security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2540-1] mahara security update
* *From*: Raphael Geissert <geissert@debian.org>
* *Date*: Fri, 7 Sep 2012 13:12:57 -0500
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/201209071313.04841.geissert%40debian.org)Â [201209071313.04841.geissert@debian.org](msg00181.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2540-1                   security@debian.org
<http://www.debian.org/security/>                          Raphael Geissert
September 07, 2012                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : mahara
Vulnerability  : cross-site scripting
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2012-2237

Emanuel Bronshtein discovered that Mahara, an electronic portfolio,
weblog, and resume builder, contains multiple cross-site scripting
vulnerabilities due to missing sanitization and insufficient encoding
of user-supplied data.

For the stable distribution (squeeze), these problems have been fixed in
version 1.2.6-2+squeeze5.

For the testing distribution (wheezy), these problems will be fixed soon.

For the unstable distribution (sid), these problems have been fixed in
version 1.5.1-2.

We recommend that you upgrade your mahara packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlBKOSoACgkQYy49rUbZzlqMuQCcCeRBuS2zAqqHCqa6RT8JxNrm
1RcAn2XnC9u7pbj/U4PuLIa2EVuOoDOM
=jstg
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.launchpad.net_8925ce29_20250126_043342.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Links & resources urls are unsanitised

Bug #1009774 reported by
[Richard Mansfield](https://launchpad.net/~richard-mansfield)
on 2012-06-06

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Melissa Draper](https://launchpad.net/~melissa) | [Mahara 1.4.3](https://launchpad.net/mahara/%2Bmilestone/1.4.3) |

### Bug Description

Discovered by Emanuel Bronshtein. Present in all versions, requires an admin account.

Configure site -> Menus -> Add External Link:

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/site/menu.php>

Â Add new Link:

Â Name: XSS

Â Linked to: javascript:alert(location)

Â click "Add".

Â ...

Â fix: Allow only whitelisted protocols (http,https,mailto).

The sanitize\_url function should be used for this.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-11: |  |  | [#1](/mahara/%2Bbug/1009774/comments/1) |
| --- | --- | --- | --- |

Using sanitize\_url() fixes the problem, but breaks links if used as-is, because it removes anything without an explicit protocol, or anything not in (http, https, ftp).

Using sanitize\_url() fixes the problem, but breaks links if used as-is, because it removes anything without an explicit protocol, or anything not in (http, https, ftp).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#2](/mahara/%2Bbug/1009774/comments/2) |
| --- | --- | --- | --- |

* [master and 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195578/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195578)
  (1.6 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#3](/mahara/%2Bbug/1009774/comments/3) |
| --- | --- | --- | --- |

* [1.4](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195579/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195579)
  (1.6 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#4](/mahara/%2Bbug/1009774/comments/4) |
| --- | --- | --- | --- |

* [1.2](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195580/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195580)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-07-31: |  |  | [#5](/mahara/%2Bbug/1009774/comments/5) |
| --- | --- | --- | --- |

The final patch for this is at <https://reviews.mahara.org/#/c/1451/>

The final patch for this is at https://reviews.mahara.org/#/c/1451/

| **security vulnerability**: | yes â†’ no |
| --- | --- |
| **visibility**: | private â†’ public |
| Changed in mahara: | |
| **assignee**: | nobody â†’ Melissa Draper (melissa) |
| **status**: | Confirmed â†’ Fix Released |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-07-31

| **security vulnerability**: | no â†’ yes |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-07-31:  [**A change has been merged**](/mahara/%2Bbug/1009774/comments/6) |  |  | [#6](/mahara/%2Bbug/1009774/comments/6) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1460>

Committed: <http://gitorious.org/mahara/mahara/commit/e47eea0381645be217c516a43411e4998e70c404>

Submitter: Hugh Davenport (<email address hidden>)

Branch: master

commit e47eea0381645be217c516a43411e4998e70c404

Author: Melissa Draper <email address hidden>

Date: Mon Jul 9 14:25:03 2012 +1200

Sanitize links in links and resources menu ([bug #1009774](/bugs/1009774))

Links placed in the links and resources list have not been getting

Â Â Â Â checked and so have been displayed unfiltered to users and other

Â Â Â Â admins. These user-supplied links are now checked with sanitize\_url

Â Â Â Â which has been extended to convert relative links to absolute.

Change-Id: I679627c4e33621df82705c39e77e7226ffef5a97

Â Â Â Â Signed-off-by: Melissa Draper <email address hidden>

Reviewed: https://reviews.mahara.org/1460
Committed: http://gitorious.org/mahara/mahara/commit/e47eea0381645be217c516a43411e4998e70c404
Submitter: Hugh Davenport (hugh@catalyst.net.nz)
Branch: master
commit e47eea0381645be217c516a43411e4998e70c404
Author: Melissa Draper <melissa@catalyst.net.nz>
Date: Mon Jul 9 14:25:03 2012 +1200
Sanitize links in links and resources menu (bug #1009774)
Links placed in the links and resources list have not been getting
checked and so have been displayed unfiltered to users and other
admins. These user-supplied links are now checked with sanitize\_url
which has been extended to convert relative links to absolute.
Change-Id: I679627c4e33621df82705c39e77e7226ffef5a97
Signed-off-by: Melissa Draper <melissa@catalyst.net.nz>

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1009774/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [master and 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195578/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195578 "Change patch details")
* [1.4](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195579/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195579 "Change patch details")
* [1.2](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195580/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195580 "Change patch details")

* [Add patch](/mahara/%2Bbug/1009774/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_1388bf58_20250124_234547.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Links & resources urls are unsanitised

Bug #1009774 reported by
[Richard Mansfield](https://launchpad.net/~richard-mansfield)
on 2012-06-06

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Melissa Draper](https://launchpad.net/~melissa) | [Mahara 1.4.3](https://launchpad.net/mahara/%2Bmilestone/1.4.3) |

### Bug Description

Discovered by Emanuel Bronshtein. Present in all versions, requires an admin account.

Configure site -> Menus -> Add External Link:

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/site/menu.php>

Â Add new Link:

Â Name: XSS

Â Linked to: javascript:alert(location)

Â click "Add".

Â ...

Â fix: Allow only whitelisted protocols (http,https,mailto).

The sanitize\_url function should be used for this.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-11: |  |  | [#1](/mahara/%2Bbug/1009774/comments/1) |
| --- | --- | --- | --- |

Using sanitize\_url() fixes the problem, but breaks links if used as-is, because it removes anything without an explicit protocol, or anything not in (http, https, ftp).

Using sanitize\_url() fixes the problem, but breaks links if used as-is, because it removes anything without an explicit protocol, or anything not in (http, https, ftp).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#2](/mahara/%2Bbug/1009774/comments/2) |
| --- | --- | --- | --- |

* [master and 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195578/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195578)
  (1.6 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#3](/mahara/%2Bbug/1009774/comments/3) |
| --- | --- | --- | --- |

* [1.4](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195579/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195579)
  (1.6 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-19: |  |  | [#4](/mahara/%2Bbug/1009774/comments/4) |
| --- | --- | --- | --- |

* [1.2](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195580/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195580)
  (1.7 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-07-31: |  |  | [#5](/mahara/%2Bbug/1009774/comments/5) |
| --- | --- | --- | --- |

The final patch for this is at <https://reviews.mahara.org/#/c/1451/>

The final patch for this is at https://reviews.mahara.org/#/c/1451/

| **security vulnerability**: | yes â†’ no |
| --- | --- |
| **visibility**: | private â†’ public |
| Changed in mahara: | |
| **assignee**: | nobody â†’ Melissa Draper (melissa) |
| **status**: | Confirmed â†’ Fix Released |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-07-31

| **security vulnerability**: | no â†’ yes |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-07-31:  [**A change has been merged**](/mahara/%2Bbug/1009774/comments/6) |  |  | [#6](/mahara/%2Bbug/1009774/comments/6) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1460>

Committed: <http://gitorious.org/mahara/mahara/commit/e47eea0381645be217c516a43411e4998e70c404>

Submitter: Hugh Davenport (<email address hidden>)

Branch: master

commit e47eea0381645be217c516a43411e4998e70c404

Author: Melissa Draper <email address hidden>

Date: Mon Jul 9 14:25:03 2012 +1200

Sanitize links in links and resources menu ([bug #1009774](/bugs/1009774))

Links placed in the links and resources list have not been getting

Â Â Â Â checked and so have been displayed unfiltered to users and other

Â Â Â Â admins. These user-supplied links are now checked with sanitize\_url

Â Â Â Â which has been extended to convert relative links to absolute.

Change-Id: I679627c4e33621df82705c39e77e7226ffef5a97

Â Â Â Â Signed-off-by: Melissa Draper <email address hidden>

Reviewed: https://reviews.mahara.org/1460
Committed: http://gitorious.org/mahara/mahara/commit/e47eea0381645be217c516a43411e4998e70c404
Submitter: Hugh Davenport (hugh@catalyst.net.nz)
Branch: master
commit e47eea0381645be217c516a43411e4998e70c404
Author: Melissa Draper <melissa@catalyst.net.nz>
Date: Mon Jul 9 14:25:03 2012 +1200
Sanitize links in links and resources menu (bug #1009774)
Links placed in the links and resources list have not been getting
checked and so have been displayed unfiltered to users and other
admins. These user-supplied links are now checked with sanitize\_url
which has been extended to convert relative links to absolute.
Change-Id: I679627c4e33621df82705c39e77e7226ffef5a97
Signed-off-by: Melissa Draper <melissa@catalyst.net.nz>

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1009774/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [master and 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195578/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195578 "Change patch details")
* [1.4](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195579/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195579 "Change patch details")
* [1.2](https://bugs.launchpad.net/mahara/%2Bbug/1009774/%2Battachment/3195580/%2Bfiles/0001-Sanitise-links-in-Links-and-resources-menu-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009774/%2Battachment/3195580 "Change patch details")

* [Add patch](/mahara/%2Bbug/1009774/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from mahara.org_3ae8d48a_20250124_234550.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Multiple Cross-site Scripting Vulnerabilities in versions 1.4.2 and 1.5.1

---

This topic is closed. Only moderators and the group administrators can post new replies.

![anonymous profile picture](https://mahara.org/theme/raw/images/no_userphoto40.png)
Account deleted

Posts: 197

31 July 2012, 1:45

Multiple Cross-site Scripting Vulnerabilities in versions 1.4.2 and 1.5.1

Category: Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Cross-site scripting
Severity: Â Â Â  Â Â Â Â Â Â  Â  Â  Â  Â  Â Â  High
Versions affected: Â Â Â Â Â  < 1.4.3, < 1.5.2
Reported by:Â Â Â Â Â Â Â  Â  Â  Â Â  Emanuel Bronshtein
Identifier: Â  Â  Â  Â  Â Â Â  Â Â Â Â Â Â Â Â  CVE-2012-2237
Bug report:Â Â Â Â  Â  Â  Â Â Â  Â Â Â Â  [1009784](https://bugs.launchpad.net/mahara/%2Bbug/1009784), [1009774](https://bugs.launchpad.net/mahara/%2Bbug/1009774), [1009777](https://bugs.launchpad.net/mahara/%2Bbug/1009777)

As part of a the [Mahara Security Bug Bounty Program](https://wiki.mahara.org/index.php/Security#Mahara_Security_Bug_Bounty_Program), several cross-site scripting vulnerabilities were identified in all supported versions of Mahara. The vulnerabilities have been fixed by the Mahara core developers.

Upgrading to Mahara 1.4.3 or 1.5.2 is strongly recommended for all sites.

Download links for fixed versions:

[https://launchpad.net/mahara/+milestone/1.4.3](https://launchpad.net/mahara/%2Bmilestone/1.4.3)
Â  [https://launchpad.net/mahara/+milestone/1.5.2](https://launchpad.net/mahara/%2Bmilestone/1.5.2)

[edited to fix the CVE ID and add download links]

### Edits to this post:

* ![anonymous profile picture](https://mahara.org/theme/raw/images/no_userphoto20.png)
* ![anonymous profile picture](https://mahara.org/theme/raw/images/no_userphoto20.png)

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_afcd2a7f_20250124_234548.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Logged-in user's name unescaped in top right header

Bug #1009777 reported by
[Richard Mansfield](https://launchpad.net/~richard-mansfield)
on 2012-06-06

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Richard Mansfield](https://launchpad.net/~richard-mansfield) | [Mahara 1.5.2](https://launchpad.net/mahara/%2Bmilestone/1.5.2) |

### Bug Description

Discovered by Emanuel Bronshtein. Present in 1.5

By Changing "Display name" in Content->Profile:

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/artefact/internal/>

Â to:

Â XSS<script>alert(1)</script>

Â then click "Save profile".

Â javascript code executed on every request to mahara pages when the user log-in to the system.

Â (unfiltered HTML printed near "Settings" in top of the page)

---

I think the display\_default\_name function should be added as a dwoo plugin, along the lines of display\_name (see htdocs/lib/dwoo/mahara/plugins/function.display\_name.php); other calls to display\_default\_name in templates should be modified to avoid double-escaping.

In the long term perhaps we should reconsider the policy for calls to php functions in the dwoo templates - I believe the policy can be changed to disallow calls to arbitrary php functions, or to escape the output from them, but a change like that would require testing all our templates, and lots of work for 3rd party plugins & themes.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-11: |  |  | [#1](/mahara/%2Bbug/1009777/comments/1) |
| --- | --- | --- | --- |

* [0001-Add-display\_default\_name-dwoo-plugin-bug-1009777.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Battachment/3184510/%2Bfiles/0001-Add-display_default_name-dwoo-plugin-bug-1009777.patch)
  [Edit](/mahara/%2Bbug/1009777/%2Battachment/3184510)
  (3.1 KiB,
  text/plain)

Patch for master. You may need to remove dwoo/cache and dwoo/compile from dataroot before this takes effect.

Patch for master. You may need to remove dwoo/cache and dwoo/compile from dataroot before this takes effect.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-11: |  |  | [#2](/mahara/%2Bbug/1009777/comments/2) |
| --- | --- | --- | --- |

* [Patch for 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Battachment/3185650/%2Bfiles/0001-Add-display_default_name-dwoo-plugin-bug-1009777.patch)
  [Edit](/mahara/%2Bbug/1009777/%2Battachment/3185650)
  (3.2 KiB,
  text/plain)

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-07-31

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed â†’ Won't Fix |
| **status**: | Won't Fix â†’ Fix Released |
| **assignee**: | nobody â†’ Richard Mansfield (richard-mansfield) |
| **visibility**: | private â†’ public |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-07-31:  [**A change has been merged**](/mahara/%2Bbug/1009777/comments/3) |  |  | [#3](/mahara/%2Bbug/1009777/comments/3) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1457>

Committed: <http://gitorious.org/mahara/mahara/commit/47e3906d6791b93b7eaf1d6500828924b10b2bb6>

Submitter: Hugh Davenport (<email address hidden>)

Branch: master

commit 47e3906d6791b93b7eaf1d6500828924b10b2bb6

Author: Richard Mansfield <email address hidden>

Date: Mon Jun 11 17:16:37 2012 +1200

Add display\_default\_name dwoo plugin ([bug #1009777](/bugs/1009777))

This just html escapes the output of display\_default\_name. Existing

Â Â Â Â calls are modified to avoid double escaping.

Change-Id: I117a748a4d4cdb3313377f3441bbd20567a88fcb

Â Â Â Â Signed-off-by: Richard Mansfield <email address hidden>

Reviewed: https://reviews.mahara.org/1457
Committed: http://gitorious.org/mahara/mahara/commit/47e3906d6791b93b7eaf1d6500828924b10b2bb6
Submitter: Hugh Davenport (hugh@catalyst.net.nz)
Branch: master
commit 47e3906d6791b93b7eaf1d6500828924b10b2bb6
Author: Richard Mansfield <richard.mansfield@catalyst.net.nz>
Date: Mon Jun 11 17:16:37 2012 +1200
Add display\_default\_name dwoo plugin (bug #1009777)
This just html escapes the output of display\_default\_name. Existing
calls are modified to avoid double escaping.
Change-Id: I117a748a4d4cdb3313377f3441bbd20567a88fcb
Signed-off-by: Richard Mansfield <richard.mansfield@catalyst.net.nz>

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1009777/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Add-display\_default\_name-dwoo-plugin-bug-1009777.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Battachment/3184510/%2Bfiles/0001-Add-display_default_name-dwoo-plugin-bug-1009777.patch)
  [Edit](/mahara/%2Bbug/1009777/%2Battachment/3184510 "Change patch details")
* [Patch for 1.5](https://bugs.launchpad.net/mahara/%2Bbug/1009777/%2Battachment/3185650/%2Bfiles/0001-Add-display_default_name-dwoo-plugin-bug-1009777.patch)
  [Edit](/mahara/%2Bbug/1009777/%2Battachment/3185650 "Change patch details")

* [Add patch](/mahara/%2Bbug/1009777/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_55788fba_20250124_234549.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Javascript login form includes unencoded parameters

Bug #1009784 reported by
[Richard Mansfield](https://launchpad.net/~richard-mansfield)
on 2012-06-07

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Critical | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 1.4.3](https://launchpad.net/mahara/%2Bmilestone/1.4.3) |

### Bug Description

Discovered by Emanuel Bronshtein, present in all versions.

parameters from URI are passed to javascript innerHTML without proper encoding, it possible to use some encoding inside javascript strings, as:

Â \x22\x3E = ">

Â \u0022\u003E = ">

Â by using this encoding it possible to trigger XSS.

Payload:

Â "><h1>XSS</h1><img src=9 onerror=alert("XSS")> = \x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

XSS Example:

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/users/changeuser.php?xss=>\x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/users/bulk.php?xss=>\x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

---

When a logged-out user tries to access a page that requires them to be logged in, a login form is generated, all get parameters are added to the form's action attribute & all post parameters are added as hidden elements inside the form. The login form is then inserted into the dom using innerHTML. This is for convenience, to let the user continue whatever it was they were trying to do if, for example, their session expired. I think it may be enough to url encode each query parameter name & value in the action url before generating the form, but haven't tested this yet.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-07: |  |  | [#1](/mahara/%2Bbug/1009784/comments/1) |
| --- | --- | --- | --- |

* [0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Battachment/3180115/%2Bfiles/0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009784/%2Battachment/3180115)
  (1.3 KiB,
  text/plain)

This appears to fix it for me, but I'd appreciate some more opinions.

I think we also need to have a good look through all the innerHTML calls, because this is not necessarily restricted to the login form. I think 'Pieform' forms with jsform = true are doing the right thing though.

This appears to fix it for me, but I'd appreciate some more opinions.
I think we also need to have a good look through all the innerHTML calls, because this is not necessarily restricted to the login form. I think 'Pieform' forms with jsform = true are doing the right thing though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-14: |  |  | [#2](/mahara/%2Bbug/1009784/comments/2) |
| --- | --- | --- | --- |

The same problem exists in versions 1.2, 1.4, 1.5, and the same patch fixes it.

[On 1.2 & 1.4, that patch won't apply cleanly with plain 'git am' or 'git apply', but 'patch' works, as do 'git am -3' and 'git apply -C2']

The same problem exists in versions 1.2, 1.4, 1.5, and the same patch fixes it.
[On 1.2 & 1.4, that patch won't apply cleanly with plain 'git am' or 'git apply', but 'patch' works, as do 'git am -3' and 'git apply -C2']

[Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000)
on 2012-07-08

| Changed in mahara: | |
| --- | --- |
| **assignee**: | nobody â†’ Son Nguyen (ngson2000) |
| **status**: | Confirmed â†’ In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-09: |  |  | [#3](/mahara/%2Bbug/1009784/comments/3) |
| --- | --- | --- | --- |

There are

Â - 66 innerHTML calls in Mahara PHP code(\*.php).

Â - 10 calls in templates (\*.tpl)

Â - 40 calls in Mahara JS code(\*.js)

and over 500 calls in other third party packages including jquery, jscalendar, jscolor, Mochikit, tinymce, and flowplayer.

I would search these calls to identify XSS vulnerabilities.

There are
- 66 innerHTML calls in Mahara PHP code(\*.php).
- 10 calls in templates (\*.tpl)
- 40 calls in Mahara JS code(\*.js)
and over 500 calls in other third party packages including jquery, jscalendar, jscolor, Mochikit, tinymce, and flowplayer.
I would search these calls to identify XSS vulnerabilities.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-09: |  |  | [#4](/mahara/%2Bbug/1009784/comments/4) |
| --- | --- | --- | --- |

Identification XSS vulnerabilities using innerHTML calls

1. PHP code

Â Â - admin/extensions/plugins.php -> OK

Â Â - admin/upgrade.php -> OK

Â Â - artefact/blog/view -> OK

Â Â - artefact/internal/blocktype/textbox -> OK

Identification XSS vulnerabilities using innerHTML calls
1. PHP code
- admin/extensions/plugins.php -> OK
- admin/upgrade.php -> OK
- artefact/blog/view -> OK
- artefact/internal/blocktype/textbox -> OK

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-11: |  |  | [#5](/mahara/%2Bbug/1009784/comments/5) |
| --- | --- | --- | --- |

A report and patch have been sent to Melissa for verifying and reviewing.

A report and patch have been sent to Melissa for verifying and reviewing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ruslan Kabalin (rkabalin)](https://launchpad.net/~rkabalin) wrote on 2012-07-12: |  |  | [#6](/mahara/%2Bbug/1009784/comments/6) |
| --- | --- | --- | --- |

The patch looks good to me.

The patch looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-07-31: |  |  | [#7](/mahara/%2Bbug/1009784/comments/7) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/1455/> and <https://reviews.mahara.org/#/c/1454/> are final fixes for this

https://reviews.mahara.org/#/c/1455/ and https://reviews.mahara.org/#/c/1454/ are final fixes for this

| **security vulnerability**: | yes â†’ no |
| --- | --- |
| **visibility**: | private â†’ public |
| Changed in mahara: | |
| **status**: | In Progress â†’ Fix Released |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-07-31

| **security vulnerability**: | no â†’ yes |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-07-31:  [**A change has been merged**](/mahara/%2Bbug/1009784/comments/8) |  |  | [#8](/mahara/%2Bbug/1009784/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1459>

Committed: <http://gitorious.org/mahara/mahara/commit/c24ccb84d79a5032cf58adaed401fd6399018d95>

Submitter: Hugh Davenport (<email address hidden>)

Branch: master

commit c24ccb84d79a5032cf58adaed401fd6399018d95

Author: Richard Mansfield <email address hidden>

Date: Fri Jun 8 11:29:16 2012 +1200

Json-encode login form when injected by js ([bug #1009784](/bugs/1009784))

Change-Id: Ia81053332cfa9e0f79268031795af8d34b45ff78

Â Â Â Â Signed-off-by: Richard Mansfield <email address hidden>

Reviewed: https://reviews.mahara.org/1459
Committed: http://gitorious.org/mahara/mahara/commit/c24ccb84d79a5032cf58adaed401fd6399018d95
Submitter: Hugh Davenport (hugh@catalyst.net.nz)
Branch: master
commit c24ccb84d79a5032cf58adaed401fd6399018d95
Author: Richard Mansfield <richard.mansfield@catalyst.net.nz>
Date: Fri Jun 8 11:29:16 2012 +1200
Json-encode login form when injected by js (bug #1009784)
Change-Id: Ia81053332cfa9e0f79268031795af8d34b45ff78
Signed-off-by: Richard Mansfield <richard.mansfield@catalyst.net.nz>

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1009784/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Battachment/3180115/%2Bfiles/0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009784/%2Battachment/3180115 "Change patch details")

* [Add patch](/mahara/%2Bbug/1009784/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_05c26496_20250126_043343.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Javascript login form includes unencoded parameters

Bug #1009784 reported by
[Richard Mansfield](https://launchpad.net/~richard-mansfield)
on 2012-06-07

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Critical | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 1.4.3](https://launchpad.net/mahara/%2Bmilestone/1.4.3) |

### Bug Description

Discovered by Emanuel Bronshtein, present in all versions.

parameters from URI are passed to javascript innerHTML without proper encoding, it possible to use some encoding inside javascript strings, as:

Â \x22\x3E = ">

Â \u0022\u003E = ">

Â by using this encoding it possible to trigger XSS.

Payload:

Â "><h1>XSS</h1><img src=9 onerror=alert("XSS")> = \x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

XSS Example:

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/users/changeuser.php?xss=>\x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

Â <http://localhost/mahara-1.5.1/mahara-1.5.1/htdocs/admin/users/bulk.php?xss=>\x22\x3E\x3C\x68\x31\x3E\x58\x53\x53\x3C\x2F\x68\x31\x3E\x3C\x69\x6D\x67\x20\x73\x72\x63\x3D\x39\x20\x6F\x6E\x65\x72\x72\x6F\x72\x3D\x61\x6C\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29\x3E

---

When a logged-out user tries to access a page that requires them to be logged in, a login form is generated, all get parameters are added to the form's action attribute & all post parameters are added as hidden elements inside the form. The login form is then inserted into the dom using innerHTML. This is for convenience, to let the user continue whatever it was they were trying to do if, for example, their session expired. I think it may be enough to url encode each query parameter name & value in the action url before generating the form, but haven't tested this yet.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-07: |  |  | [#1](/mahara/%2Bbug/1009784/comments/1) |
| --- | --- | --- | --- |

* [0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Battachment/3180115/%2Bfiles/0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009784/%2Battachment/3180115)
  (1.3 KiB,
  text/plain)

This appears to fix it for me, but I'd appreciate some more opinions.

I think we also need to have a good look through all the innerHTML calls, because this is not necessarily restricted to the login form. I think 'Pieform' forms with jsform = true are doing the right thing though.

This appears to fix it for me, but I'd appreciate some more opinions.
I think we also need to have a good look through all the innerHTML calls, because this is not necessarily restricted to the login form. I think 'Pieform' forms with jsform = true are doing the right thing though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Mansfield (richard-mansfield)](https://launchpad.net/~richard-mansfield) wrote on 2012-06-14: |  |  | [#2](/mahara/%2Bbug/1009784/comments/2) |
| --- | --- | --- | --- |

The same problem exists in versions 1.2, 1.4, 1.5, and the same patch fixes it.

[On 1.2 & 1.4, that patch won't apply cleanly with plain 'git am' or 'git apply', but 'patch' works, as do 'git am -3' and 'git apply -C2']

The same problem exists in versions 1.2, 1.4, 1.5, and the same patch fixes it.
[On 1.2 & 1.4, that patch won't apply cleanly with plain 'git am' or 'git apply', but 'patch' works, as do 'git am -3' and 'git apply -C2']

[Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000)
on 2012-07-08

| Changed in mahara: | |
| --- | --- |
| **assignee**: | nobody â†’ Son Nguyen (ngson2000) |
| **status**: | Confirmed â†’ In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-09: |  |  | [#3](/mahara/%2Bbug/1009784/comments/3) |
| --- | --- | --- | --- |

There are

Â - 66 innerHTML calls in Mahara PHP code(\*.php).

Â - 10 calls in templates (\*.tpl)

Â - 40 calls in Mahara JS code(\*.js)

and over 500 calls in other third party packages including jquery, jscalendar, jscolor, Mochikit, tinymce, and flowplayer.

I would search these calls to identify XSS vulnerabilities.

There are
- 66 innerHTML calls in Mahara PHP code(\*.php).
- 10 calls in templates (\*.tpl)
- 40 calls in Mahara JS code(\*.js)
and over 500 calls in other third party packages including jquery, jscalendar, jscolor, Mochikit, tinymce, and flowplayer.
I would search these calls to identify XSS vulnerabilities.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-09: |  |  | [#4](/mahara/%2Bbug/1009784/comments/4) |
| --- | --- | --- | --- |

Identification XSS vulnerabilities using innerHTML calls

1. PHP code

Â Â - admin/extensions/plugins.php -> OK

Â Â - admin/upgrade.php -> OK

Â Â - artefact/blog/view -> OK

Â Â - artefact/internal/blocktype/textbox -> OK

Identification XSS vulnerabilities using innerHTML calls
1. PHP code
- admin/extensions/plugins.php -> OK
- admin/upgrade.php -> OK
- artefact/blog/view -> OK
- artefact/internal/blocktype/textbox -> OK

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2012-07-11: |  |  | [#5](/mahara/%2Bbug/1009784/comments/5) |
| --- | --- | --- | --- |

A report and patch have been sent to Melissa for verifying and reviewing.

A report and patch have been sent to Melissa for verifying and reviewing.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ruslan Kabalin (rkabalin)](https://launchpad.net/~rkabalin) wrote on 2012-07-12: |  |  | [#6](/mahara/%2Bbug/1009784/comments/6) |
| --- | --- | --- | --- |

The patch looks good to me.

The patch looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Melissa Draper (melissa)](https://launchpad.net/~melissa) wrote on 2012-07-31: |  |  | [#7](/mahara/%2Bbug/1009784/comments/7) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/1455/> and <https://reviews.mahara.org/#/c/1454/> are final fixes for this

https://reviews.mahara.org/#/c/1455/ and https://reviews.mahara.org/#/c/1454/ are final fixes for this

| **security vulnerability**: | yes â†’ no |
| --- | --- |
| **visibility**: | private â†’ public |
| Changed in mahara: | |
| **status**: | In Progress â†’ Fix Released |

[Melissa Draper (melissa)](https://launchpad.net/~melissa)
on 2012-07-31

| **security vulnerability**: | no â†’ yes |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2012-07-31:  [**A change has been merged**](/mahara/%2Bbug/1009784/comments/8) |  |  | [#8](/mahara/%2Bbug/1009784/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/1459>

Committed: <http://gitorious.org/mahara/mahara/commit/c24ccb84d79a5032cf58adaed401fd6399018d95>

Submitter: Hugh Davenport (<email address hidden>)

Branch: master

commit c24ccb84d79a5032cf58adaed401fd6399018d95

Author: Richard Mansfield <email address hidden>

Date: Fri Jun 8 11:29:16 2012 +1200

Json-encode login form when injected by js ([bug #1009784](/bugs/1009784))

Change-Id: Ia81053332cfa9e0f79268031795af8d34b45ff78

Â Â Â Â Signed-off-by: Richard Mansfield <email address hidden>

Reviewed: https://reviews.mahara.org/1459
Committed: http://gitorious.org/mahara/mahara/commit/c24ccb84d79a5032cf58adaed401fd6399018d95
Submitter: Hugh Davenport (hugh@catalyst.net.nz)
Branch: master
commit c24ccb84d79a5032cf58adaed401fd6399018d95
Author: Richard Mansfield <richard.mansfield@catalyst.net.nz>
Date: Fri Jun 8 11:29:16 2012 +1200
Json-encode login form when injected by js (bug #1009784)
Change-Id: Ia81053332cfa9e0f79268031795af8d34b45ff78
Signed-off-by: Richard Mansfield <richard.mansfield@catalyst.net.nz>

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1009784/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch](https://bugs.launchpad.net/mahara/%2Bbug/1009784/%2Battachment/3180115/%2Bfiles/0001-Json-encode-login-form-when-injected-by-js-bug-10097.patch)
  [Edit](/mahara/%2Bbug/1009784/%2Battachment/3180115 "Change patch details")

* [Add patch](/mahara/%2Bbug/1009784/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))


