```
Message-ID: <20120831103448.GA23147@inutil.org>
Date: Fri, 31 Aug 2012 12:34:48 +0200
From: Moritz Muehlenhoff <jmm@...til.org>
To: michaelni@....at
Cc: oss-security@...ts.openwall.com
Subject: Information on security issues fixed in ffmpeg 0.11?

Hi Michael,

[Adding the oss-security mailing list to CC, which is used by
all major distros to discuss security issues in open source
software]

<http://ffmpeg.org/security.html> lists several CVE ID, which
have been fixed in ffmpeg 0.11;

CVE-2012-2772, CVE-2012-2774, CVE-2012-2775, CVE-2012-2776, CVE-2012-2777,
CVE-2012-2779, CVE-2012-2782, CVE-2012-2783, CVE-2012-2784, CVE-2012-2785,
CVE-2012-2786, CVE-2012-2787, CVE-2012-2788, CVE-2012-2789, CVE-2012-2790,
CVE-2012-2791, CVE-2012-2792, CVE-2012-2793, CVE-2012-2794, CVE-2012-2795,
CVE-2012-2796, CVE-2012-2797, CVE-2012-2798, CVE-2012-2799, CVE-2012-2800,
CVE-2012-2801, CVE-2012-2802, CVE-2012-2803, CVE-2012-2804,

Do you additional information on these issues, preferably a matching git
commit to the CVE IDs?

Cheers,
        Moritz

Message-ID: <20120902213625.GE25092@kiste2>
Date: Sun, 2 Sep 2012 23:36:25 +0200
From: Michael Niedermayer <michaelni@....at>
To: Moritz Muehlenhoff <jmm@...til.org>
Cc: oss-security@...ts.openwall.com
Subject: Re: Information on security issues fixed in ffmpeg 0.11?

Hi Moritz

On Fri, Aug 31, 2012 at 12:34:48PM +0200, Moritz Muehlenhoff wrote:
> Hi Michael,
>
> [Adding the oss-security mailing list to CC, which is used by
> all major distros to discuss security issues in open source
> software]
>
> <http://ffmpeg.org/security.html> lists several CVE ID, which
> have been fixed in ffmpeg 0.11;
>
> CVE-2012-2772, CVE-2012-2774, CVE-2012-2775, CVE-2012-2776, CVE-2012-2777,
> CVE-2012-2779, CVE-2012-2782, CVE-2012-2783, CVE-2012-2784, CVE-2012-2785,
> CVE-2012-2786, CVE-2012-2787, CVE-2012-2788, CVE-2012-2789, CVE-2012-2790,
> CVE-2012-2791, CVE-2012-2792, CVE-2012-2793, CVE-2012-2794, CVE-2012-2795,
> CVE-2012-2796, CVE-2012-2797, CVE-2012-2798, CVE-2012-2799, CVE-2012-2800,
> CVE-2012-2801, CVE-2012-2802, CVE-2012-2803, CVE-2012-2804,
>
> Do you additional information on these issues, preferably a matching git
> commit to the CVE IDs?

Please recheck the page, ive added git hashes to them.

[...]
--
Michael     GnuPG fingerprint: 9FF2128B147EF6730BADF133611EC787040B0FAB

In a rich man's house there is no place to spit but his face.
-- Diogenes of Sinope
```
```
# USN-1705-1: Libav vulnerabilities

28 January 2013

Libav could be made to crash or run programs as your login if it opened a
specially crafted file.

## Details

It was discovered that Libav incorrectly handled certain malformed media

files. If a user were tricked into opening a crafted media file, an

attacker could cause a denial of service via application crash, or possibly

execute arbitrary code with the privileges of the user invoking the

program.
```
```
# USN-1706-1: FFmpeg vulnerabilities

28 January 2013

FFmpeg could be made to crash or run programs as your login if it opened a
specially crafted file.

## Details

It was discovered that FFmpeg incorrectly handled certain malformed media

files. If a user were tricked into opening a crafted media file, an

attacker could cause a denial of service via application crash, or possibly

execute arbitrary code with the privileges of the user invoking the

program.
```
```
ffmpeg (4:0.5.9-0ubuntu0.10.04.3) lucid-security; urgency=low

  * SECURITY UPDATE: unspecified security issue in vp56.c (LP: [#1104019](/bugs/1104019))
    - debian/patches/CVE-2012-2783.patch: release frames on error in
      libavcodec/vp56.c.
    - CVE-2012-2783
```
```
libav (4:0.7.6-0ubuntu0.11.10.3) oneiric-security; urgency=low

  * SECURITY UPDATE: unspecified security issue in vp56.c (LP: [#1104019](/bugs/1104019))
    - debian/patches/CVE-2012-2783.patch: release frames on error in
      libavcodec/vp56.c.
    - CVE-2012-2783
```
```
CVE-2012-2783, d85b3c4fff4c4b255232fcc01edbd57f19d60998
```
```
### 0.11

Fixes following vulnerabilities:

```
CVE-2012-2772, cb7190cd2c691fd93e4d3664f3fce6c19ee001dd
CVE-2012-2774, 59a4b73531428d2f420b4dad545172c8483ced0f
CVE-2012-2775, 9d3032b960ae03066c008d6e6774f68b17a1d69d
CVE-2012-2776, ba775a54bc2136ec5da85385a923b05ee6fab159
CVE-2012-2777, 25715064c2ef4978672a91f8c856f3e8809a7c45
CVE-2012-2779, 229e4c133287955d5f3f837520a3602709b21950
CVE-2012-2782, 9a57a37b7041581c10629c8241260a5d7bfbc1e7
CVE-2012-2783, d85b3c4fff4c4b255232fcc01edbd57f19d60998
CVE-2012-2785, 326f7a68bbd429c63fd2f19f4050658982b5b081
               d462949974668ffb013467d12dc4934b9106fe19
CVE-2012-2786, d1c95d2ce39560e251fdb14f4af91b04fd7b845c
CVE-2012-2787, 01bf2ad7351fdaa2e21b6bdf963d22d6ffccb920
CVE-2012-2788, c41ac870470c614185e1752c11f892809022248a
CVE-2012-2789, 97a5addfcf0029d0f5538ed70cb38cae4108a618
CVE-2012-2790, 2837d8dc276760db1821b81df3f794a90bfa56e6
CVE-2012-2791, 0846719dd11ab3f7a7caee13e7af71f71d913389
CVE-2012-2792, d442c4462a2692e27a24e1a9d0eb6f18725c7bd8
CVE-2012-2793, 83c7803f55b3231faeb93c1a634399a70fae9480
CVE-2012-2794, 5ad7335ebac2b38bb2a1c8df51a500b78461c05a
CVE-2012-2795, a0abefb0af64a311b15141062c77dd577ba590a3
               2a7063de547b1d8fb1cef523469390fb59fb2c50
               b3a43515827f3d22a881c33b87384f01c86786fd
CVE-2012-2796, 5e59a77cec804a9b44c60ea22c17beba6453ef23
CVE-2012-2797, cca9528524c7a4b91451f4322bd50849af5d057e
CVE-2012-2798, 72b9537d8886f679494651df517dfed9b420cf1f
CVE-2012-2799, 64bd7f8e4db1742e86c5ed02bd530688b74063e3
CVE-2012-2800, f0bf9e9c2a65e9a2b9d9e4e94f99acb191dc7ae7
CVE-2012-2801, 1df49142bab1b7bccd11392aa9e819e297d21a6e
CVE-2012-2802, 2c22701c371c2f3dea21fcdbb97c981939fb77af
CVE-2012-2803, 951cbea56fdc03ef96d07fbd7e5bed755d42ac8a
CVE-2012-2804, 4a80ebe491609e04110a1dd540a0ca79d3be3d04
CVE-2012-5359, msvr12-017
CVE-2012-5360, msvr12-017
CVE-2012-5361, msvr12-017
CVE-2016-3062, 689e59b7ffed34eba6159dcc78e87133862e3746
```
Based on the information provided, here's a breakdown of the vulnerability associated with CVE-2012-2783:

**Root Cause of Vulnerability:**
- The vulnerability is due to an unspecified security issue within the `vp56.c` file in FFmpeg/Libav. Specifically, it relates to how the software handles errors.

**Weaknesses/Vulnerabilities Present:**
-  The core issue is related to improper error handling in the `vp56.c` file. The vulnerability lies in the fact that frames are not released when errors occur during the processing of VP5/VP6 video streams.

**Impact of Exploitation:**
- **Denial of Service (DoS):** An attacker can cause a denial of service by crafting a malicious media file. This can lead to an application crash.
- **Potential Arbitrary Code Execution:** There is a possibility that arbitrary code could be executed with the privileges of the user running the affected program if a specially crafted media file is opened.

**Attack Vectors:**
- The primary attack vector involves tricking a user into opening a specially crafted or malformed media file.
- The vulnerability can be triggered by processing a specially crafted media file that has a specific format.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to supply a malicious media file to the user.
- The attacker needs a way to entice the user to open this specially crafted media file.
- No special position or advanced capabilities are needed. The attacker can be remote.

**Additional Notes**
*   The vulnerability is present in both `ffmpeg` and `libav`.
*   The fix involves adding code to release frames when errors occur in the `libavcodec/vp56.c` file.
*   The provided information indicates that this issue can lead to a denial-of-service and potentially arbitrary code execution, but does not offer specifics on the exact exploit for arbitrary code execution.
*   This issue was addressed in FFmpeg 0.11 and later, as well as corresponding Libav versions, and specific patches were created for Ubuntu distributions
*  The issue also relates to a double free vulnerability in mpeg_decode_frame, which was fixed by ensuring extradata was not decoded more than once
* This issue affects multiple versions of FFmpeg and Libav.