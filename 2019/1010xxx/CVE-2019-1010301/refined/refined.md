```
{
  "vulnerability": {
    "root_cause": "A stack buffer overflow occurs in the `ProcessGpsInfo` function within `gpsinfo.c` due to insufficient bounds checking when handling GPS data in a JPEG file.",
    "weaknesses": [
      "Stack buffer overflow",
      "Insufficient bounds checking"
    ],
    "impact": "Denial of service (program crash).",
    "attack_vectors": [
      "Specially crafted JPEG file with malicious GPS data"
    ],
    "required_capabilities": "The attacker needs to be able to provide the vulnerable software with a crafted JPEG file. This could be through local file processing, web upload, or any other method that results in the vulnerable software processing the crafted file."
  },
  "affected_component": {
    "name": "jhead",
    "version": "3.03",
    "file": "gpsinfo.c",
    "function": "ProcessGpsInfo",
    "line": 151
  },
  "details": "The `ProcessGpsInfo` function in `gpsinfo.c` does not properly validate the length of GPS data within a JPEG's EXIF metadata, leading to a buffer overflow when `sprintf` is used to format the data into a fixed size buffer. Specifically, the code at gpsinfo.c:151 calculates the size of the output buffer based on the size of the input data, without verifying if the allocated buffer is large enough. If the input data is maliciously large the `sprintf` function will write past the end of the output buffer leading to a crash. The vulnerability can be triggered by providing a crafted JPEG file with manipulated GPS data. The vulnerability was resolved by using patches from Debian"
}
```