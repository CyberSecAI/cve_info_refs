The content is related to CVE-2019-3691.

**Root cause of vulnerability:**
The vulnerability stems from insecure handling of the `munge.key` file during the installation or update process of the `munge` package. Specifically, the `chown` and `chmod` commands were used without proper checks, allowing a local attacker to exploit a race condition using symbolic links to escalate privileges.

**Weaknesses/vulnerabilities present:**
1.  **Insecure `chown` and `chmod` usage:** The `fixperm` macro and direct `chown` commands on the `munge.key` file were susceptible to symlink attacks, where an attacker could create a symbolic link to a sensitive file and have the installation process change its permissions.
2.  **Race condition:** The initial key file creation using `dd` from `/dev/urandom` could be raced by an attacker, by creating a symbolic link in its place.
3. **Insecure handling of existing keys:** The code that tried to preserve the existing key if it was owned by the correct user and had the correct mode used `cat` on the existing file, without checking if it was a symbolic link.

**Impact of exploitation:**
A local attacker with `munge` user privileges could escalate to root privileges by manipulating the `munge.key` file using symbolic links, potentially leading to arbitrary file reads, overwriting or modifications as root.

**Attack vectors:**
1.  Create a symbolic link named `munge.key` pointing to a sensitive file before the package installation or update. The `chown` and `chmod` commands during installation/update will then operate on the linked file as root, potentially leaking the content or changing the ownership/permissions of the linked file.
2. Create a symbolic link named `munge.key` pointing to a sensitive file, wait for the installation to try to preserve it by `cat`, thereby reading the linked file.

**Required attacker capabilities/position:**
The attacker needs to have local access to the system with at least the privileges of the `munge` user. This user is also the owner of the `munge.key` file in `/etc/munge/`. The attacker also needs to be able to create symbolic links and manipulate files in `/etc/munge/`.