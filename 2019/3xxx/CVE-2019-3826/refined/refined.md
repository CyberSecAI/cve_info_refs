```
{
  "cveId": "CVE-2019-3826",
  "description": "A stored, DOM based, cross-site scripting (XSS) flaw was found in Prometheus before version 2.7.1. An attacker could exploit this by convincing an authenticated user to visit a crafted URL on a Prometheus server, allowing for the execution and persistent storage of arbitrary scripts.",
  "vulnerability": {
    "rootCause": "The vulnerability is caused by insufficient sanitization of user-supplied input when using the query history functionality in Prometheus.",
    "weaknesses": [
      "Cross-Site Scripting (XSS) - Stored, DOM based"
    ],
    "impact": "An attacker can execute arbitrary scripts within the context of the victim's browser, potentially leading to sensitive data exposure, session hijacking, or other malicious activities. The injected scripts are persistently stored, affecting subsequent visits to the crafted URL.",
    "attackVectors": [
      "Network - An attacker crafts a malicious URL."
    ],
    "attackerCapabilities": "The attacker needs to convince an authenticated user to visit the crafted URL on a vulnerable Prometheus server. This might involve social engineering tactics such as phishing emails or malicious links on other sites.",
	"additionalDetails": "The vulnerability lies in the handling of the query history feature, which allows users to store and recall previously executed queries. By injecting malicious JavaScript code into a query, the attacker could cause it to be executed when the history is accessed. This XSS is stored in the browser's local storage. The vulnerability is present in Prometheus versions prior to 2.7.1."
  }
}
```