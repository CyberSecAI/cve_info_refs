```text
RELATED
```

### Summary:
The vulnerability is an out-of-bounds (OOB) read in HHVM (HipHop Virtual Machine) when using `stream_get_line()` on malformed streams from `bz2` and `php://output`.

### Root Cause:
The `readImpl` functions for `bz2` and `php://output` streams incorrectly returned -1 on read errors. This caused `File::readRecord` to read `(size_t)(-1)` bytes from its stream buffer, leading to an out-of-bounds heap read.

### Weakness:
Improper error handling in `readImpl` functions of `BZ2File` and `OutputFile` classes, leading to an out-of-bounds read in `File::readRecord`.

### Impact:
An attacker could trigger an out-of-bounds read, potentially leading to information disclosure or denial of service.

### Attack Vector:
The vulnerability can be triggered by operating `stream_get_line` on a malformed stream such as `bz2` and `php://output`.

### Required Capabilities:
An attacker needs to be able to supply or trigger the use of a malformed bz2 or php://output stream that is then processed using stream_get_line.