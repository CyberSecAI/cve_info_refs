```
{
  "Root cause of vulnerability": "The cron job in `/etc/cron.weekly/nagios` calls `/usr/bin/bzip2` on files in `/var/log/nagios/archives/*.log`. Because the `/var/log/nagios` and `/var/log/nagios/archives` directories are owned by the `nagios` user, this user can create symlinks there.",
  "Weaknesses/vulnerabilities present": "The cron job executes `bzip2` on files in a directory writable by the `nagios` user. `bzip2` uses racy system calls (stat/lstat/open) for sanity checks, creating a race condition vulnerability. The cron job runs with root privileges.",
  "Impact of exploitation": "An attacker can potentially achieve several impacts:\n  1. **Denial of Service (DoS):** By placing a FIFO in `/var/log/nagios/archives/some.log`, `bzip2` will block indefinitely when trying to open the FIFO, causing a DoS against the cron job.\n  2. **Information Leakage:** An attacker can deduce the existence of files by observing how `bzip2` reacts to broken vs. valid symlinks. While the output is mailed to root, other means of observation may be possible. Also, if a private file has group or world read permissions, they can replace the input file with a symlink to the private file (e.g., /root/.bash_history) and bzip2 will compress the file to `/var/log/nagios/archives`.\n  3. **File Corruption:** By replacing the `/var/log/nagios/archives` directory with a symlink to another directory containing `.log` files, an attacker can corrupt arbitrary `.log` files on the system.",
  "Attack vectors": "Local. An attacker can exploit the vulnerability by creating malicious symlinks, FIFOs, or files within the `/var/log/nagios/archives` directory.",
  "Required attacker capabilities/position": "The attacker must have local access and be able to write to the `/var/log/nagios` and `/var/log/nagios/archives` directories, which are owned by the `nagios` user. An attacker with `nagios` user privileges can exploit this vulnerability to achieve root level access."
}
```