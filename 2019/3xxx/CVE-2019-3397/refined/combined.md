=== Content from jira.atlassian.com_a71e9051_20250121_003139.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FBSERV-11706)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![Create and track feature requests for Atlassian products.](/s/2u4fri/9120016/1rg1jpn/_/jira-logo-scaled.png)](https://jira.atlassian.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FBSERV-11706)

IMPORTANT: JAC is a Public system and anyone on the internet will be able to view the data in the created JAC tickets. Please don’t include Customer or Sensitive data in the JAC ticket.

![Uploaded image for project: 'Bitbucket Data Center'](https://jira.atlassian.com/secure/projectavatar?pid=13310&avatarId=105193)

1. [Bitbucket Data Center](/browse/BSERV)
2. [BSERV-11706](/browse/BSERV-11706)

## Bitbucket Data Center - Path traversal in the migration tool leads to RCE - CVE-2019-3397

[Log In](/login.jsp?os_destination=%2Fbrowse%2FBSERV-11706 "Log In")ClosedExportnullView workflowXMLWordPrintable
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=51493&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Highest](/images/icons/priorities/highest.svg "Highest - Our top priority issues") Highest
* **Fix Version/s:**
  [5.16.3](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+5.16.3 "5.16.3 "), [6.0.3](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+6.0.3 "6.0.3 "), [6.1.2](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+6.1.2 "6.1.2 "), [5.13.6](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+5.13.6 "5.13.6 "), [5.14.4](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+5.14.4 "5.14.4 "), [5.15.3](/issues/?jql=project+%3D+BSERV+AND+fixVersion+%3D+5.15.3 "5.15.3 ")
* **Affects Version/s:**
  5.13.0, 5.14.0, 5.15.0, 5.16.0, 6.0.0, 6.1.0
* **Component/s:**
  [Database - Migration](/issues/?jql=project+%3D+BSERV+AND+component+%3D+%22Database+-+Migration%22 "Database - Migration ")
* **Labels:**
  + [CVE-2019-3397](/issues/?jql=labels+%3D+CVE-2019-3397 "CVE-2019-3397")
  + [advisory](/issues/?jql=labels+%3D+advisory "advisory")
  + [advisory-released](/issues/?jql=labels+%3D+advisory-released "advisory-released")
  + [cvss-critical](/issues/?jql=labels+%3D+cvss-critical "cvss-critical")
  + [idor](/issues/?jql=labels+%3D+idor "idor")
  + [path-traversal](/issues/?jql=labels+%3D+path-traversal "path-traversal")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Symptom Severity:**
  Severity 1 - Critical
* **Bug Fix Policy:**
   [View Atlassian Server bug fix policy](https://confluence.atlassian.com/support/atlassian-bug-fixing-policy-201294573.html)

### Description

### Issue Summary

Bitbucket Data Center had a path traversal vulnerability in the Data Center migration tool. A remote attacker with authenticated user with admin permissions can exploit this path traversal vulnerability to write files to arbitrary locations which can lead to remote code execution on systems that run a vulnerable version of Bitbucket Data Center. Bitbucket Server versions without a Data Center license are not vulnerable to this vulnerability.

Affected versions of Bitbucket Data Center:

* 5.13.0 <= version < 5.13.6
* 5.14.0 <= version < 5.14.4
* 5.15.0 <= version < 5.15.3
* 5.16.0 <= version < 5.16.3
* 6.0.0 <= version < 6.0.3
* 6.1.0 <= version 6.1.2

### **What You Need to Do**

Atlassian recommends that you upgrade to the latest version. For a full description of the latest version of Bitbucket Data Center, see the [release notes](https://confluence.atlassian.com/bitbucketserver/bitbucket-server-6-1-release-notes-966687591.html). You can download the latest version of Bitbucket Data Center from the [download centre.](https://www.atlassian.com/software/bitbucket/download/data-center)

**Upgrade Bitbucket Data Center to version 6.1.2 or higher.**

If you are running **Bitbucket Data Center 5.13.x** and **cannot upgrade to 6.1.2**  **then** **upgrade to version 5.13.6.**

If you are running **Bitbucket Data Center 5.14.x** and **cannot upgrade to 6.1.2** **then** **upgrade to version 5.14.4.**

If you are running **Bitbucket Data Center 5.15.x** and **cannot upgrade to 6.1.2** **then** **upgrade to version 5.15.3.**

If you are running **Bitbucket Data Center 5.16.x** and **cannot upgrade to 6.1.2** **then** **upgrade to version 5.16.3.**

If you are running **Bitbucket Data Center 6.0.x** and **cannot upgrade to 6.1.2** **then** **upgrade to version 6.0.3.**

### **Mitigation**

The import functionality can be disabled via a feature flag, which would mitigate this vulnerability. This can be done by setting the property feature.data.center.migration.import=false in bitbucket.properties. Note that the export functionality would still work in this case. Bitbucket Server must then be restarted for changes to become effective.

If an import task still needs to be run, enable the feature on an isolated cluster node (inaccessible by users and admins but still connected to the cluster and accessible by sysadmins) with a node-local bitbucket.properties file where the property feature.data.center.migration.import=true is set. Imports can then be started by talking to this node directly while it would still be disabled on other nodes.

For additional details, see the full advisory:

<https://confluence.atlassian.com/bitbucketserver/bitbucket-data-center-path-traversal-in-the-migration-tool-rce-cve-2019-3397-969526871.html>

### Attachments

### Issue Links

mentioned in

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://confluence.atlassian.com/pages/viewpage.action?pageId=969526871) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=549782984) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=610567104) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=644777874) Loading...

### Forms

### Activity

### People

Assignee:

![Unassigned](https://jira.atlassian.com/secure/useravatar?size=small&avatarId=10613)
Unassigned

Reporter:

![sraj2@atlassian.com](https://jira.atlassian.com/secure/useravatar?size=small&avatarId=10612)
FNU

Votes:
0
Vote for this issue

Watchers:
5
Start watching this issue

### Dates

Created:

18/Apr/2019 1:28 AM

Updated:

17/Feb/2020 5:14 AM

Resolved:

29/Apr/2019 1:34 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)
* [Privacy policy](https://www.atlassian.com/legal/privacy-policy)
* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)

[Atlassian](http://www.atlassian.com/)


