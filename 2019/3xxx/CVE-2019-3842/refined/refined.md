```
{
  "CVE-2019-3842": {
    "description": "In systemd before v242-rc4, it was discovered that pam_systemd does not properly sanitize the environment before using the XDG_SEAT variable. It is possible for an attacker, in some particular configurations, to set a XDG_SEAT environment variable which allows for commands to be checked against polkit policies using the \"allow_active\" element rather than \"allow_any\".",
    "vulnerability_details": {
      "root_cause": "The pam_systemd module uses the getenv() function to retrieve the XDG_SEAT environment variable, without proper sanitization, before passing it to systemd-logind via D-Bus. This allows an attacker to set a custom XDG_SEAT variable.",
      "weaknesses": [
        "Improper Input Sanitization",
        "Privilege Escalation"
      ],
      "impact": "By setting a custom XDG_SEAT variable, an attacker can bypass polkit policies that distinguish between active and inactive sessions. This allows an attacker to perform actions as an active user on a local console, even if they are not actually physically present or interacting with the console. This can lead to local privilege escalation.",
      "attack_vectors": [
        "Local access with the ability to execute commands",
          "Exploitation of a setuid binary that uses PAM"
      ],
        "attacker_capabilities": "The attacker needs to be able to run commands on the target machine (e.g., via SSH), have an account that can be used with `su`, and a running system with no X server and a login prompt on a tty. The attacker also needs to be able to set environment variables."

    },
        "affected_components": [
          "pam_systemd module of systemd",
          "polkit policies"
      ],
    "additional_information": [
        "The vulnerability is triggered when a new session is created by pam_systemd, and the calling process is not already part of a session. This can be achieved by scheduling an at job that sets the XDG_SEAT and XDG_VTNR variables, then calls su.",
        "The vulnerability is only triggered for interactive sessions because the systemd PAM module is only invoked for interactive sessions"

      ]
  }
}
```