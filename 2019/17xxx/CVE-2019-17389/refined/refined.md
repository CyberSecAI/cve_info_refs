- **Root cause of vulnerability:** The MQTT-SN implementation `emcute` in RIOT-OS has a receive thread that exits the packet receive loop if `sock_udp_recv` returns an error. This occurs when a received packet is larger than the supplied buffer.
- **Weaknesses/vulnerabilities present:** The `emcute` receive thread uses a `return` statement when an error occurs in `sock_udp_recv`, which causes the thread to terminate. This leads to a denial-of-service (DoS) vulnerability.
- **Impact of exploitation:** An attacker can send a large UDP packet (> 512 bytes) to the MQTT-SN client. This causes the `sock_udp_recv` function to return an error (`-ENOBUFS`), which in turn terminates the receive loop. Consequently, the MQTT client stops working and will not receive any further messages, effectively causing a denial of service. The client will not reconnect until `emcute_run` is invoked again, typically requiring a device restart.
- **Attack vectors:** An attacker can send a crafted UDP packet that exceeds the buffer size to the vulnerable device.
- **Required attacker capabilities/position:** The attacker needs to be able to send UDP packets to the target device's network. The attacker does not need any authentication to send the malicious packet.

The provided content gives more detail than the standard CVE description.