```
{
  "CVE-2019-17178": {
    "description": "HuffmanTree_makeFromFrequencies in lodepng.c in LodePNG through 2019-09-28, as used in WinPR in FreeRDP and other products, has a memory leak because a supplied realloc pointer (i.e., the first argument to realloc) is also used for a realloc return value.",
    "affected_products": [
      "openSUSE Leap 15.1",
      "openSUSE Leap 15.0",
       "SUSE Linux Enterprise Desktop 12 SP4",
       "SUSE Linux Enterprise Desktop 15 SP1",
       "SUSE Linux Enterprise Desktop 15 SP2",
       "SUSE Linux Enterprise Desktop 15 SP3",
        "SUSE Linux Enterprise Desktop 15 SP4",
       "SUSE Linux Enterprise Desktop 15",
       "SUSE Linux Enterprise Server 12 SP4",
       "SUSE Linux Enterprise Server 12 SP5",
       "SUSE Linux Enterprise Server 15 SP1",
       "SUSE Linux Enterprise Server 15 SP2",
       "SUSE Linux Enterprise Server 15 SP3",
       "SUSE Linux Enterprise Server 15 SP4",
       "SUSE Linux Enterprise Server 15",
       "SUSE Linux Enterprise Server for SAP Applications 12 SP4",
       "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
        "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
       "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
       "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
       "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
        "SUSE Linux Enterprise Server for SAP Applications 15",
       "SUSE Linux Enterprise Software Development Kit 12 SP4",
       "SUSE Linux Enterprise Software Development Kit 12 SP5",
       "SUSE Linux Enterprise Workstation Extension 12 SP4",
       "SUSE Linux Enterprise Workstation Extension 12 SP5",
        "SUSE Linux Enterprise Workstation Extension 15 SP1",
       "SUSE Linux Enterprise Workstation Extension 15 SP2",
       "SUSE Linux Enterprise Workstation Extension 15 SP3",
       "SUSE Linux Enterprise Workstation Extension 15 SP4",
        "SUSE Linux Enterprise Workstation Extension 15",
       "openSUSE Leap 15.2",
       "openSUSE Leap 15.3",
       "openSUSE Leap 15.4",
        "openSUSE Tumbleweed"

    ],
    "root_cause": "The vulnerability is caused by a memory leak in the `HuffmanTree_makeFromFrequencies` function within `lodepng.c`. The function uses the same pointer for both the input and output of the `realloc` function. When `realloc` fails, it returns `NULL` without freeing the original memory, which results in a memory leak.",
    "vulnerabilities": [
      "Memory leak"
    ],
    "impact": "A memory leak can lead to a denial-of-service by exhausting available memory.",
    "attack_vectors": [
      "Network",
       "An attacker could trigger the vulnerable code path remotely."
    ],
    "attacker_capabilities": "An attacker needs the ability to cause the vulnerable `HuffmanTree_makeFromFrequencies` function to be called with crafted input.",
    "more_info": "The issue occurs in the `HuffmanTree_makeFromFrequencies` function in `winpr/libwinpr/utils/lodepng/lodepng.c`. Specifically, the code uses `tree->lengths = (unsigned*)realloc(tree->lengths, numcodes * sizeof(unsigned));` and then uses that result without checking for failure. If `realloc` fails, the original pointer is not freed, causing a memory leak. The fix involves checking for `NULL` after realloc and freeing the original memory if `realloc` fails. This same pattern was found in other files.  The fix was applied to multiple SUSE products including SLES, SLED, and openSUSE distributions. The fix was done in the `FreeRDP` repository commit 9fee4ae076b1ec97b97efb79ece08d1dab4df29a, addressing issue #5645. Patches were subsequently released for affected products."
  }
}
```