=== Content from gist.github.com_9cbfa6b0_20250121_002629.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@fxb6476](https://avatars.githubusercontent.com/u/18406541?s=64&v=4)](/fxb6476)

# [fxb6476](/fxb6476)/**[Disclosure](/fxb6476/0b9883a88ff2ca40de46a8469834e16c)**

Last active
October 15, 2019 15:19

Show Gist options

* [Download ZIP](/fxb6476/0b9883a88ff2ca40de46a8469834e16c/archive/4bfaae511794d13091641a168c964933502ca06b.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/fxb6476/0b9883a88ff2ca40de46a8469834e16c.js&quot;&gt;&lt;/script&gt;
* Save fxb6476/0b9883a88ff2ca40de46a8469834e16c to your computer and use it in GitHub Desktop.

[Code](/fxb6476/0b9883a88ff2ca40de46a8469834e16c)
[Revisions
6](/fxb6476/0b9883a88ff2ca40de46a8469834e16c/revisions)
[Stars
1](/fxb6476/0b9883a88ff2ca40de46a8469834e16c/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/fxb6476/0b9883a88ff2ca40de46a8469834e16c.js&quot;&gt;&lt;/script&gt;

Save fxb6476/0b9883a88ff2ca40de46a8469834e16c to your computer and use it in GitHub Desktop.

[Download ZIP](/fxb6476/0b9883a88ff2ca40de46a8469834e16c/archive/4bfaae511794d13091641a168c964933502ca06b.zip)

CVE-2019-17502

 [Raw](/fxb6476/0b9883a88ff2ca40de46a8469834e16c/raw/4bfaae511794d13091641a168c964933502ca06b/Disclosure)

[**Disclosure**](#file-disclosure)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [Vulnerability Description] |
| --- | --- |
|  | - Hydra through 0.1.8 has a NULL pointer dereference and daemon crash when processing POST requests |
|  | that lack a 'Content-Length' header. The issue comes from the process\_header\_end() function, which |
|  | calls boa\_atoi(), which ultimately calls aoti() on a null pointer. |
|  |  |
|  |  |
|  | [Additional Information] |
|  | - The Hydra web server is widely used by embedded networking equipment, such as switches, and embedded devices in general. |
|  | Because of this fact, it is very difficult to specify device models or vendors that may be impacted by this vulnerability. |
|  | Rudimentary scans using Shodan show over 8,000 devices registered broadcasting the "Hydra v0.1.8" server, open to the |
|  | world. |
|  |  |
|  | - The Hydra web site explains: |
|  |  |
|  | "Hydra, is a modification of Boa web server, which supports multiple threads of execution, and has more features. |
|  | Boa is a high performance web server for Unix-alike computers, covered by the Gnu General Public License. |
|  | Hydra was based on Boa version 0.94.13." |
|  |  |
|  | Hydra v0.1.8 source code -> http://hydra.hellug.gr/download/ last update was in 2006. |
|  |  |
|  | - Overview: |
|  |  |
|  | Hydra added additional code to Boa's process\_header\_end() function. The additional code makes a call to the boa\_atoi() |
|  | function with req->content\_length variable as an argument. |
|  |  |
|  | The value of req->content\_length is supposed to be set by the function process\_option\_line(), which sets it |
|  | to the numerical value after the 'Content-Length: ' header. However, if the 'Content-Length' header is omitted |
|  | from the POST request, the value of req->content\_length remains NULL. |
|  |  |
|  | Finally, after the call to process\_option\_line(), read.c makes a call to the process\_header\_end() function. |
|  | The additional code added by Hydra in process\_head\_end(), then makes an unchecked call to boa\_atoi() passing |
|  | req->content\_length as a parameter, which is NULL. Inside boa\_atoi() the atoi() function is called as follows, |
|  | atoi(req->content\_length) -> atoi(NULL). This results in the segment fault exception being thrown, and the Hydra |
|  | daemon crashing. |
|  |  |
|  | - Proof Of Concept: |
|  | --># curl http://<server-ip>/<dir-to-cgi>/<cgi-script -X POST |
|  | (By default CURL will not add the 'Content-Length' header if data is not passed.) |
|  |  |
|  |  |
|  | [Vulnerability Type 'Other'] |
|  | - Null Pointer Reference -> Segment Fault |
|  |  |
|  |  |
|  | [Vendor of Product] |
|  | - (OpenSource) Hydra Web Server, fork of boa webserver 0.94.13 |
|  |  |
|  |  |
|  | [Affected Product Code Base] |
|  | - http://hydra.hellug.gr/download/ |
|  | - Personal clone of Hydra v0.1.8 -> https://github.com/fxb6476/Hydra-v0.1.8 |
|  |  |
|  |  |
|  | [Affected Componenet] |
|  | - request.c, read.c, util.c, all contribute to the vulnerability. |
|  |  |
|  |  |
|  | [Attack Type] |
|  | - Local if the web server is only visible on the local network. |
|  | Remote if the web server is visible to the internet. |
|  |  |
|  |  |
|  | [Impact on Component] |
|  | - Denial of Service |
|  |  |
|  |  |
|  | [Discoverer] |
|  | - Felix Blanco, Marshall Hallenbeck, Justin Bacco, Datto Inc. |
|  |  |
|  |  |
|  | [Reference] |
|  | - https://github.com/fxb6476/Hydra-v0.1.8 -> Hydra v0.1.8 clone |
|  | - http://hydra.hellug.gr/download/ -> Hydra v0.1.8 original source code download |

[![@fxb6476](https://avatars.githubusercontent.com/u/18406541?s=80&v=4)](/fxb6476)

Copy link

Author

### **[fxb6476](/fxb6476)** commented [Oct 12, 2019](/fxb6476/0b9883a88ff2ca40de46a8469834e16c?permalink_comment_id=3053152#gistcomment-3053152)

[![CVE_CoreDump](https://user-images.githubusercontent.com/18406541/66693518-2d8ede80-ec99-11e9-8fc4-8b15ed54dc22.png)](https://user-images.githubusercontent.com/18406541/66693518-2d8ede80-ec99-11e9-8fc4-8b15ed54dc22.png)

Backtrace leading to segment fault.

Sorry, something went wrong.

[![@fxb6476](https://avatars.githubusercontent.com/u/18406541?s=80&v=4)](/fxb6476)

Copy link

Author

### **[fxb6476](/fxb6476)** commented [Oct 12, 2019](/fxb6476/0b9883a88ff2ca40de46a8469834e16c?permalink_comment_id=3053153#gistcomment-3053153)

[![CVE_Exploit](https://user-images.githubusercontent.com/18406541/66693550-a1c98200-ec99-11e9-936e-c5b7abdc6c53.png)](https://user-images.githubusercontent.com/18406541/66693550-a1c98200-ec99-11e9-936e-c5b7abdc6c53.png)

Output from 'curl' after successful exploitation.

You can also try accessing the local web ui, which should have crashed.

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Ffxb6476%2F0b9883a88ff2ca40de46a8469834e16c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from hydra.hellug.gr_7ba781a6_20250121_002628.html ===


Home |
[Download](/download.html) |
[Mailing list](/mailinglist.html)

---

### A description of Hydra

Hydra is a high performance multi threaded HTTP web server. Unlike traditional multi threaded web servers, Hydra uses
a constant, but configurable, pool of threads, and each thread can handle several connections by multiplexing the connections.
This may remind you a non blocking server, and this is true, but Hydra has not the killing limitation of a non blocking server, which
is that they cannot use more than one CPU. Hydra will take advantage of every available CPU in a system.

Hydra is still on alpha stage, and currently is not a working web server, is an adventure.
A test server of hydra with gnutls and php has been set up at:
<https://www.gnutls.org:5555/>.

### Status

Hydra is not actively maintained any more. It is mostly used as a [GnuTLS](http://www.gnutls.org)'s testbed.

### Features

Hydra is a small HTTP server, but this does not mean that lacks of features. A list of the features
is available below.

| Everything is configurable | All the server's parameters, such as the number of threads, file caching, etc, can be set using a configuration file. |
| --- | --- |
| Hydra is concurent | All requests are handled by several parallel multiplexers, and no single connection can affect the server's availability. |
| Virtual Hosting | Several sites can be hosted using a single server. |
| SSL 3.0 and TLS 1.0 | Security protocols are integrated to the server, using [GnuTLS](http://www.gnutls.org). |
| HTTP/1.1 | Hydra supports several popular features of the HTTP/1.1 specification. |
| CGI/1.1 | All CGI/1.1 compiant applications will run smoothly under Hydra. |
| Support for server side scripting languages | Hydra has **experimental** support for dynamic modules that execute scripts internally, thus avoids the expensive execution of CGIs, in a separate process. Using this feature Hydra can efficiently support scripting languages such as [PHP](http://www.php.net). |

### History of Hydra

Hydra, is a modification of [Boa web server](http://www.boa.org), which supports
multiple threads of execution, and has more features. Boa is a high performance web server for Unix-alike
computers, covered by the Gnu General Public License. Hydra was based on
Boa version 0.94.13.

Why Hydra? Well, Lernean Hydra was a nine headed, monstrous serpent in Greek Mythology,
and seemed to resemble fine a multi-threaded Boa. An interesting feature of
Hydra is that a head, when cut off was replaced by two others. This was not
duplicated in Hydra's threads!

Boa was created in 1991 by Paul Phillips. It is being maintained and enhanced
by Larry Doolittle and Jon Nelson.
For more information about boa, visit [http://www.boa.org](http://www.boa.org/).

### Maintainer

Hydra's maintainer is Nikos Mavroyanopoulos. Available at
![nmav.gnutls.org](http://www.gnu.org/software/gnutls/nmav.gnutls.org.png)


