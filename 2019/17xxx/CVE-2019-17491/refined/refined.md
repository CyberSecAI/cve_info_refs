Based on the provided content, here's a breakdown of the identified vulnerabilities:

**1. Arbitrary File Upload**

*   **Root Cause:** The `actionTests` function in `ProblemController` allows unauthenticated file uploads without proper validation or sanitization.
*   **Weaknesses:**
    *   Unrestricted file upload: The application doesn't check the file type or content, allowing any file to be uploaded.
    *   `move_uploaded_file` usage: The function directly moves the uploaded file to a specified directory without proper sanitization of the filename.
*   **Impact:**
    *   Arbitrary code execution: An attacker can upload a PHP file containing malicious code, which can then be executed by accessing the uploaded file's URL. This allows for complete system compromise.
    *   Data exfiltration/manipulation: An attacker can upload files to modify or steal data.
*   **Attack Vectors:**
    *   HTTP POST request to `/jnoj/web/polygon/problem/tests?id=<problem_id>` with a multipart/form-data containing the file.
*   **Required Attacker Capabilities/Position:**
    *   Ability to send HTTP requests to the server. No authentication is needed.

**2. Stored XSS in Problem Title (Front-End)**

*   **Root Cause:** The application does not sanitize the problem title when creating or editing a problem.
*   **Weaknesses:**
    *   Lack of input sanitization: The `Problem[title]` parameter is directly stored in the database without being escaped.
*   **Impact:**
    *   Cross-site scripting: Malicious JavaScript code injected into the title will be executed in the user's browser when they view the list of problems.
*   **Attack Vectors:**
    *   HTTP POST request to `/jnoj/web/polygon/problem/create` or `/jnoj/web/polygon/problem/update` with a malicious payload in `Problem[title]`.
*   **Required Attacker Capabilities/Position:**
    *   Authenticated user, with the ability to create or modify problems.

**3. Stored XSS in Problem Details (Front-End)**

*   **Root Cause:** The application doesn't properly sanitize various fields when updating problem details, and the front-end sanitization can be bypassed.
*  **Weaknesses:**
    *   Inadequate server-side sanitization: While the front-end may perform some HTML escaping, the server receives unsanitized input when the user modifies the POST request.
    *   `strip_tags` bypass: The `strip_tags` function used on the `hint` parameter can be bypassed, allowing malicious code injection.
*   **Impact:**
    *   Cross-site scripting: Malicious JavaScript code injected into various fields (title, description, input, output, etc.) will execute in the user's browser when they view the problem details.
*   **Attack Vectors:**
    *   HTTP POST request to `/jnoj/web/polygon/problem/update?id=<problem_id>` with malicious payloads in `Problem[title]`, `Problem[description]`, `Problem[input]`, `Problem[output]`, `Problem[sample_input]`, `Problem[sample_output]`, etc..
*   **Required Attacker Capabilities/Position:**
    *   Authenticated user, with the ability to edit problems.

**4. Stored XSS in Problem Creation (Admin Panel)**

*   **Root Cause:** Similar to the previous front-end XSS issues, input sanitization is lacking during problem creation in the admin panel.
*   **Weaknesses:**
    *   Lack of input sanitization: Several fields, such as title, sample inputs and outputs, are not sanitized when creating a new problem.
*   **Impact:**
    *   Cross-site scripting: Malicious JavaScript code injected into problem fields will execute in the administrator's browser when they view the created problem.
*   **Attack Vectors:**
    *   HTTP POST request to `/jnoj/web/admin/problem/create` with malicious payloads in `Problem[title]`, `Problem[sample_input]`, and `Problem[sample_output]`.
*   **Required Attacker Capabilities/Position:**
    *   Authenticated administrator.

**5. Persistent XSS in Settings Page (Admin Panel)**

*   **Root Cause:** User-provided data within the admin settings is not sanitized and is rendered on every page.
*   **Weaknesses:**
    *   Lack of output encoding: The settings are stored as raw HTML and rendered on every page of the application without sanitization.
*  **Impact:**
    *   Persistent cross-site scripting: Malicious JavaScript code injected into admin settings will execute on every page view by any user (front-end and back-end)
*   **Attack Vectors:**
    *   Admin must navigate to settings and inject the malicious code.
*   **Required Attacker Capabilities/Position:**
    *   Authenticated administrator.

**Summary of vulnerabilities:**

*   **File Upload:** Critical vulnerability allowing for arbitrary code execution.
*  **Stored XSS:** Multiple instances of stored XSS vulnerabilities in both the front-end (polygon module) and back-end (admin module), potentially leading to account compromise or other malicious actions. The front-end sanitization can be bypassed by manipulating the HTTP requests directly, indicating that the server side lacks proper input validation.