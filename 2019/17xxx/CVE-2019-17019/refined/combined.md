=== Content from www.mozilla.org_cfffba22_20250120_231217.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-01

## Security Vulnerabilities fixed in Firefox 72

Announced
January 7, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 72

#### [#CVE-2019-17015: Memory corruption in parent process during new content process initialization on Windows](#CVE-2019-17015)

Reporter
Thomas Imbert
Impact
high
##### Description

During the initialization of a new content process, a pointer offset can be manipulated leading to memory corruption and a potentially exploitable crash in the parent process.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1599005](https://bugzilla.mozilla.org/show_bug.cgi?id=1599005)

#### [#CVE-2019-17016: Bypass of @namespace CSS sanitization during pasting](#CVE-2019-17016)

Reporter
Michał Bentkowski
Impact
high
##### Description

When pasting a `<style>` tag from the clipboard into a rich text editor, the CSS sanitizer incorrectly rewrites a @namespace rule. This could allow for injection into certain types of websites resulting in data exfiltration.

##### References

* [Bug 1599181](https://bugzilla.mozilla.org/show_bug.cgi?id=1599181)

#### [#CVE-2019-17017: Type Confusion in XPCVariant.cpp](#CVE-2019-17017)

Reporter
bo13oy
Impact
high
##### Description

Due to a missing case handling object types, a type confusion vulnerability could occur, resulting in a crash. We presume that with enough effort that it could be exploited to run arbitrary code.

##### References

* [Bug 1603055](https://bugzilla.mozilla.org/show_bug.cgi?id=1603055)

#### [#CVE-2019-17018: Windows Keyboard in Private Browsing Mode may retain word suggestions](#CVE-2019-17018)

Reporter
Siye Lui
Impact
moderate
##### Description

When in Private Browsing Mode on Windows 10, the Windows keyboard may retain word suggestions to improve the accuracy of the keyboard.

##### References

* [Bug 1549394](https://bugzilla.mozilla.org/show_bug.cgi?id=1549394)

#### [#CVE-2019-17019: Python files could be inadvertently executed upon opening a download](#CVE-2019-17019)

Reporter
Prithwish Kumar Pal
Impact
moderate
##### Description

When Python was installed on Windows, a python file being served with the MIME type of `text/plain` could be executed by Python instead of being opened as a text file when the Open option was selected upon download.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1568003](https://bugzilla.mozilla.org/show_bug.cgi?id=1568003)

#### [#CVE-2019-17020: Content Security Policy not applied to XSL stylesheets applied to XML documents](#CVE-2019-17020)

Reporter
Matthew Somerville
Impact
moderate
##### Description

If an XML file is served with a Content Security Policy and the XML file includes an XSL stylesheet, the Content Security Policy will not be applied to the contents of the XSL stylesheet. If the XSL sheet e.g. includes JavaScript, it would bypass any of the restrictions of the Content Security Policy applied to the XML document.

##### References

* [Bug 1597645](https://bugzilla.mozilla.org/show_bug.cgi?id=1597645)

#### [#CVE-2019-17021: Heap address disclosure in parent process during content process initialization on Windows](#CVE-2019-17021)

Reporter
Thomas Imbert
Impact
moderate
##### Description

During the initialization of a new content process, a race condition occurs that can allow a content process to disclose heap addresses from the parent process.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1599008](https://bugzilla.mozilla.org/show_bug.cgi?id=1599008)

#### [#CVE-2019-17022: CSS sanitization does not escape HTML tags](#CVE-2019-17022)

Reporter
Michał Bentkowski
Impact
moderate
##### Description

When pasting a `<style>` tag from the clipboard into a rich text editor, the CSS sanitizer does not escape < and > characters. Because the resulting string is pasted directly into the text node of the element this does not result in a direct injection into the webpage; however, if a webpage subsequently copies the node's innerHTML, assigning it to another innerHTML, this would result in an XSS vulnerability. Two WYSIWYG editors were identified with this behavior, more may exist.

##### References

* [Bug 1602843](https://bugzilla.mozilla.org/show_bug.cgi?id=1602843)

#### [#CVE-2019-17023: NSS may negotiate TLS 1.2 or below after a TLS 1.3 HelloRetryRequest had been sent](#CVE-2019-17023)

Reporter
Google oss-fuzz
Impact
low
##### Description

After a HelloRetryRequest has been sent, the client may negotiate a lower protocol that TLS 1.3, resulting in an invalid state transition in the TLS State Machine. If the client gets into this state, incoming Application Data records will be ignored.

##### References

* [Bug 1590001](https://bugzilla.mozilla.org/show_bug.cgi?id=1590001)

#### [#CVE-2019-17024: Memory safety bugs fixed in Firefox 72 and Firefox ESR 68.4](#CVE-2019-17024)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Bob Clary reported memory safety bugs present in Firefox 71 and Firefox ESR 68.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 72 and Firefox ESR 68.4](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1507180%2C1595470%2C1598605%2C1601826)

#### [#CVE-2019-17025: Memory safety bugs fixed in Firefox 72](#CVE-2019-17025)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Karl Tomlinson, Jason Kratzer, Tyson Smith, Jon Coppeard, and Christian Holler reported memory safety bugs present in Firefox 71. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 72](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1328295%2C1328300%2C1590447%2C1590965%2C1595692%2C1597321%2C1597481)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_923e7972_20250121_011555.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1549394)
* [XML](/show_bug.cgi?ctype=xml&id=1549394)

Closed
[Bug 1549394](/show_bug.cgi?id=1549394)
(CVE-2019-17018)

Opened 6 years ago
Closed 5 years ago

# Potential privacy leak from Win10 keyboard autocomplete of data entered in Private Browsing

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Potential privacy leak from Win10 keyboard autocomplete of data entered in Private Browsing

## Categories

### (Core :: Widget: Win32, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Widget%3A%20Win32#Widget%3A%20Win32)

Widget: Win32
▾

Core :: Widget: Win32
Mapping of cross platform widget interfaces to Win32 platform APIs.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Widget%3A%20Win32)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows 10

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla72

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox66 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix) |
| firefox67 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix) |
| firefox68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox72 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox66 |  | wontfix |
| firefox67 |  | wontfix |
| firefox68 |  | wontfix |
| firefox72 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jesup, Assigned: m\_kato)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1875645d5594d36bca29657d51d24ed6?d=mm&size=40)  [m\_kato](/user_profile?user_id=8636)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/605ee8cd1c9a74704916c7bdc4e4865d?d=mm&size=40)  [rkraesig](/user_profile?user_id=699639)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1598346](/show_bug.cgi?id=1598346 "RESOLVED FIXED - mingw-w64 missing IS_PRIVATE")

Dependency [tree](/showdependencytree.cgi?id=1549394&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1549394)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1269295](/show_bug.cgi?id=1269295 "RESOLVED DUPLICATE - Investigate Private Browsing mode for IME")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main72+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-17018

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[inputmethod](/buglist.cgi?keywords=inputmethod&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main72+]

QA Whiteboard:

[qa-72b-p2]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Bug 1549394 - Part 1. Clean up input scope support for IMM32.](/attachment.cgi?id=9110154)  [5 years ago](#c9)  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9110154&action=edit) | [Review](/attachment.cgi?id=9110154) |
| --- | --- | --- |
| [Bug 1549394 - Part 2. Set IS\_PRIVATE input scope in private browsing.](/attachment.cgi?id=9110155)  [5 years ago](#c10)  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9110155&action=edit) | [Review](/attachment.cgi?id=9110155) |
| [advisory.txt](/attachment.cgi?id=9114961)  [5 years ago](#c19)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   219 bytes, text/plain |  | [Details](/attachment.cgi?id=9114961&action=edit) |
| [advisory.txt](/attachment.cgi?id=9118593)  [5 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   217 bytes, text/plain |  | [Details](/attachment.cgi?id=9118593&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1549394#c0)• 6 years ago |
|  | |

Chrome is expected to fix a privacy leak from Incognito mode to normal browsing via the keyboard learning autocomplete data and exposing it in the normal browsing context. See <https://hothardware.com/news/micrsoft-chromium-fixes> (latter part).

Basically, we should be using IS\_PRIVATE as the input scope in Private Browsing on windows to avoid the Win10 keyboard from learning from input and offering as corrections or autocomplete data when we're not in Private Browsing.

See <https://docs.microsoft.com/en-us/windows/desktop/api/inputscope/ne-inputscope-inputscope>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1549394#c1)• 6 years ago |
|  | |

AFAICT this would need to live in WinIMEHandler.cpp and TSFTextStore.cpp, and would be relatively straightforward to do once we figure out how to go from the window/widget ref to "is this window in private browsing".

[status-firefox66](/buglist.cgi?f1=cf_status_firefox66&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix)
[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1549394#c2)• 6 years ago |
|  | |

We should also use it for password fields in NON-private browsing (unless we're using IS\_PASSWORD and that does the same, although it's deprecated now).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a18969_1689)• 6 years ago |

Keywords: [privacy](/buglist.cgi?keywords=privacy&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1549394#c3)• 6 years ago |
|  | |

The priority flag is not set for this bug.

:jimm, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a1470403_279663)• 6 years ago |

Flags: needinfo?(jmathies)Keywords: [inputmethod](/buglist.cgi?keywords=inputmethod&resolution=---)Priority: -- → P3

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1549394#c4)• 5 years ago |
|  | |

3 years ago, although I investigated IS\_PRIVATE flag support for MS-IME, IME didn't see this flag and IME called `LCIEIsCurrentProcessInPrivate` to detect whether IE/Edge is private mode. If MS-IME supports IS\_PRIVATE, we should support it.

When I test Chrome Canary 80 with Windows 10 Build 1903, incognito mode on Chrome won't change to IME private mode. And this is same result even if using Insider build 18990.

See Also: → [1269295](/show_bug.cgi?id=1269295 "RESOLVED DUPLICATE - Investigate Private Browsing mode for IME")

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1549394#c5)• 5 years ago |
|  | |

Makoto-san, currently, MS-IME is being redesigned as you know. How about to request it via Feedback Hub? If you file it, I'll tell the feedback URL to the engineers.

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1549394#c6)• 5 years ago |
|  | |

(In reply to Masayuki Nakano [:masayuki] (he/him)(JST, +0900) from [comment #5](/show_bug.cgi?id=1549394#c5 "RESOLVED FIXED - Potential privacy leak from Win10 keyboard autocomplete of data entered in Private Browsing"))

> Makoto-san, currently, MS-IME is being redesigned as you know. How about to request it via Feedback Hub? If you file it, I'll tell the feedback URL to the engineers.

<https://aka.ms/AA6eu0q>

When I talked with Yukawa-san when he came to Japan, he said, "Although I approved this patch, I didn't know whether MS-IME supported private mode by IS\_PRIVATE really."

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a17056175_8636)• 5 years ago |

See Also: [1269295](/show_bug.cgi?id=1269295 "RESOLVED DUPLICATE - Investigate Private Browsing mode for IME") →

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1549394#c8)• 5 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=d7df176b91caf8ef1f7a59bccd1cad647b699855>

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1549394#c9)• 5 years ago |
|  | |

Attached file
[Bug 1549394 - Part 1. Clean up input scope support for IMM32.](attachment.cgi?id=9110154)
— [Details](attachment.cgi?id=9110154&action=edit)

Use AutoTArray to set input scope.

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1549394#c10)• 5 years ago |
|  | |

Attached file
[Bug 1549394 - Part 2. Set IS\_PRIVATE input scope in private browsing.](attachment.cgi?id=9110155)
— [Details](attachment.cgi?id=9110155&action=edit)

Microsoft IME on Windows 10 20H1 (build 19025+) supports IME private mode by

input scope. Although previous Windows version uses undocumented API for

Edge and IE only, next Windows will use public API for it.

So let's use IS\_PRIVATE input scope in private browsing mode.

Depends on D53917

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1549394#c11)• 5 years ago |
|  | |

Pushed by m\_kato@ga2.so-net.ne.jp:
<https://hg.mozilla.org/integration/autoland/rev/fb2f4ca36af4>
Part 1. Clean up input scope support for IMM32. r=masayuki
<https://hg.mozilla.org/integration/autoland/rev/5da3dcd12b69>
Part 2. Set IS\_PRIVATE input scope in private browsing. r=masayuki

|  | [Cristian Brindusan [:cbrindusan]](/user_profile?user_id=600663) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1549394#c12)• 5 years ago |
|  | |

Backed out 2 changesets ([bug 1549394](/show_bug.cgi?id=1549394 "RESOLVED FIXED - Potential privacy leak from Win10 keyboard autocomplete of data entered in Private Browsing")) for MinGW bustages at TSFTextStore.cpp.

Push with failures: <https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=pending%2Crunning%2Csuccess%2Ctestfailed%2Cbusted%2Cexception&revision=5da3dcd12b69775a4479f3589a886aaebdbdb41a&selectedJob=277327480>

Failure log: <https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=277327480&repo=autoland&lineNumber=73741>

Flags: needinfo?(m\_kato)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1549394#c13)• 5 years ago |
|  | |

Sorry for the mingw failure. We had a similar one of these recently, you can follow that pattern to fix it.

File a bug like [Bug 1597739](/show_bug.cgi?id=1597739 "RESOLVED FIXED - mingw builds don't define ASSOCF_NONE (and presumably other API flags for AssocQueryString?)") blocking mingw-clang

Stick in a mingw hack-around: <https://hg.mozilla.org/mozilla-central/rev/ba86d1b7d2a5>

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1549394#c14)• 5 years ago |
|  | |

Backout by cbrindusan@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/85e1dc70361e>
Backed out 2 changesets for MinGW bustages at TSFTextStore.cpp. CLOSED TREE

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1549394#c15)• 5 years ago |
|  | |

MinGW doesn't have IS\_PRIVATE (Why?). So re-landed this using **MINGW32**

Assignee: nobody → m\_katoFlags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1549394#c16)• 5 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=d425733b85e8369f9543a34e6b8d3b143064eeb3>

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1549394#c17)• 5 years ago |
|  | |

Pushed by m\_kato@ga2.so-net.ne.jp:
<https://hg.mozilla.org/integration/autoland/rev/4cbaf7e27c2e>
Part 1. Clean up input scope support for IMM32. r=masayuki
<https://hg.mozilla.org/integration/autoland/rev/f081bea8c605>
Part 2. Set IS\_PRIVATE input scope in private browsing. r=masayuki

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a17201523_578488)• 5 years ago |

Blocks: [1598346](/show_bug.cgi?id=1598346 "RESOLVED FIXED - mingw-w64 missing IS_PRIVATE")

|  | [Cristina Coroiu [:ccoroiu]](/user_profile?user_id=601025) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1549394#c18)• 5 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/4cbaf7e27c2e>

<https://hg.mozilla.org/mozilla-central/rev/f081bea8c605>

Status: NEW → RESOLVEDClosed: 5 years ago
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla72

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a17545467_75935)• 5 years ago |

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix)
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a18736541_631815)• 5 years ago |

QA Whiteboard: [qa-72b-p2]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a18846893_578488)• 5 years ago |

Whiteboard: [adv-main72+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1549394#c19)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9114961) (obsolete)
— [Details](attachment.cgi?id=9114961&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1549394#c20)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9118593)
— [Details](attachment.cgi?id=9118593&action=edit)

[Attachment #9114961](/attachment.cgi?id=9114961&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1549394#a21194015_578488)• 5 years ago |

Alias: CVE-2019-17018
You need to [log in](/show_bug.cgi?id=1549394&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_11091ed6_20250120_231216.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1568003)
* [XML](/show_bug.cgi?ctype=xml&id=1568003)

Closed
[Bug 1568003](/show_bug.cgi?id=1568003)
(CVE-2019-17019)

Opened 6 years ago
Closed 5 years ago

# On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

66 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 72

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox71 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix) |
| firefox72 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox71 |  | wontfix |
| firefox72 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: prithwishkkumarpal, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6ccda53d7d26fca5b9270de01daa082f?d=mm&size=40)  [prithwishkkumarpal](/user_profile?user_id=643677)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information")

[1605102](/show_bug.cgi?id=1605102 "RESOLVED FIXED - Always ask what to do for text/plain mimetype combined with ApplicationReputation file extensions (and disable/hide the checkbox in this case)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1568003&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1568003)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [post-critsmash-triage][adv-main72+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-17019

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main72+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a13635867_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [advisory.txt](/attachment.cgi?id=9118585)  [5 years ago](#c69)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   393 bytes, text/plain |  | [Details](/attachment.cgi?id=9118585&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9118594)  [5 years ago](#c70)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   407 bytes, text/plain |  | [Details](/attachment.cgi?id=9118594&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1568003#c0)• 6 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36

Steps to reproduce:

Python need to be set in environment variables in client machine and in browser, in the application settings the content type as always ask.If some python code is there in google drive or office 365 and user clicks on download a pop up appears with 2 options - save file and open file. If user selects open file the python script will get executed. If the script is malicious it can perform malicious activity. Even it can connect remote server to download malicious file to file system.

Actual results:

Python script got executed by selecting open option.

Expected results:

Malicious code execution leading system compromise, change in OS level, delete of data etc.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1568003#c1)• 6 years ago |
|  | |

Dimi and Dan, do you think we should treat .py the same as .js, and/or if there's anything else we should do here (keeping in mind the fallout over jnlp)?

I'm inclined to say "no", given that .js is default-associated to the WSH and python isn't, and a python interpreter won't even be present by default. I also don't know a lot of people who OS-associate python files to the interpreter rather than the editor, but perhaps that's my bias... But I could be convinced, I guess?

Component: Untriaged → File HandlingFlags: needinfo?(dveditz)Flags: needinfo?(dlee)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1568003#c2)• 5 years ago |
|  | |

I tried this on two different types of machines (Mac, Win). One had a default association of .py with a code editor and one didn't have an association at all. Other than installing development tools sufficient to build Firefox I didn't customize any handlers. On both systems Chrome made the same choice not to treat .py as special, and got the same OS-defined handler (or lack of). As you point out .js is a special danger on Windows because of defaults.

Commercial mass-market software isn't distributed in python form, but Business and home-grown enterprise stuff quite possibly is. I can see non-developer users of such software setting up the python runtime as the handler for .py files (or more likely the installer doing it) and then being more at risk.

Most Users: no python

Developers: python goes to editor

some users: python-based package installed, .py probably executes

How big is that 3rd group? Bigger than the second, surely, but enough so that it's worth inconveniencing the second group (who are likely more influential in terms of recommending Firefox)?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a253177_1689)• 5 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1568003#c3)• 5 years ago |
|  | |

(In reply to :Gijs (back Aug 12; he/him) from [comment #1](/show_bug.cgi?id=1568003#c1 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Dimi and Dan, do you think we should treat .py the same as .js, and/or if there's anything else we should do here (keeping in mind the fallout over jnlp)?
>
> I'm inclined to say "no", given that .js is default-associated to the WSH and python isn't, and a python interpreter won't even be present by default. I also don't know a lot of people who OS-associate python files to the interpreter rather than the editor, but perhaps that's my bias... But I could be convinced, I guess?

If attacker is aware of victim's machine work, the tool he uses then it may lead to a huge data breach or any specific attack.

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1568003#c4)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #2](/show_bug.cgi?id=1568003#c2 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I tried this on two different types of machines (Mac, Win). One had a default association of .py with a code editor and one didn't have an association at all. Other than installing development tools sufficient to build Firefox I didn't customize any handlers. On both systems Chrome made the same choice not to treat .py as special, and got the same OS-defined handler (or lack of). As you point out .js is a special danger on Windows because of defaults.
>
> Commercial mass-market software isn't distributed in python form, but Business and home-grown enterprise stuff quite possibly is. I can see non-developer users of such software setting up the python runtime as the handler for .py files (or more likely the installer doing it) and then being more at risk.
>
> Most Users: no python
>
> Developers: python goes to editor
>
> some users: python-based package installed, .py probably executes
>
> How big is that 3rd group? Bigger than the second, surely, but enough so that it's worth inconveniencing the second group (who are likely more influential in terms of recommending Firefox)?

There is another category who are not developers. Instead they run online available python code in machines. They are the greatest victims.

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1568003#c5)• 5 years ago |
|  | |

Python script is included in the download protection binary list, so we may trigger dp ping after downloading, and the response may be roughly considered falling into one of these categories: safe, danger or unknown.

If I understand correctly, In Chrome, for certain extensions they think “may be dangerous”[1], when the response verdict type is unknown, they will show a warning message to ask users to confirm after downloading(I tried downloading some py files, but without any luck getting an “unknown” response to prove this). And for us, unknown are treated as safe for all the extensions.

I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.

[1] <https://cs.chromium.org/chromium/src/chrome/browser/resources/safe_browsing/download_file_types.asciipb?l=806&rcl=9fcc7347a6466e7740e829f672ff19ae2b83ba9b>

Flags: needinfo?(dlee)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1568003#c6)• 5 years ago |
|  | |

(In reply to Dimi Lee [OOO 7/13-8/2][:dimi][:dlee] from [comment #5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Python script is included in the download protection binary list, so we may trigger dp ping after downloading, and the response may be roughly considered falling into one of these categories: safe, danger or unknown.
>
> If I understand correctly, In Chrome, for certain extensions they think “may be dangerous”[1], when the response verdict type is unknown, they will show a warning message to ask users to confirm after downloading(I tried downloading some py files, but without any luck getting an “unknown” response to prove this). And for us, unknown are treated as safe for all the extensions.
>
> I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.
>
> [1] <https://cs.chromium.org/chromium/src/chrome/browser/resources/safe_browsing/download_file_types.asciipb?l=806&rcl=9fcc7347a6466e7740e829f672ff19ae2b83ba9>

Please let me know whether I need to share any video to prove it that its working

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1568003#c7)• 5 years ago |
|  | |

The priority flag is not set for this bug.

:Gijs, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1568003#c8)• 5 years ago |
|  | |

Reporter: can you provide an online sample of (ie link to) a python file where we behave differently from Chrome on the same machine?

(In reply to Dimi Lee [OOO 7/13-8/2][:dimi][:dlee] from [comment #5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.

Only if it actually solves anything here, which I'm not sure it would without more details about whether we actually behave differently in the case that's being reported (and if so, if that's actually a result of the safebrowsing difference).

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1568003#c9)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1568003#c8 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Reporter: can you provide an online sample of (ie link to) a python file where we behave differently from Chrome on the same machine?
>
> (In reply to Dimi Lee [OOO 7/13-8/2][:dimi][:dlee] from [comment #5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.
>
> Only if it actually solves anything here, which I'm not sure it would without more details about whether we actually behave differently in the case that's being reported (and if so, if that's actually a result of the safebrowsing difference).

If you want I can share a recorded version. Does bugzilla allow video upload?

Flags: needinfo?(prithwishkkumarpal)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1568003#c10)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #9](/show_bug.cgi?id=1568003#c9 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1568003#c8 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > Reporter: can you provide an online sample of (ie link to) a python file where we behave differently from Chrome on the same machine?
> >
> > (In reply to Dimi Lee [OOO 7/13-8/2][:dimi][:dlee] from [comment #5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
> >
> > > I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.
> >
> > Only if it actually solves anything here, which I'm not sure it would without more details about whether we actually behave differently in the case that's being reported (and if so, if that's actually a result of the safebrowsing difference).
>
> If you want I can share a recorded version. Does bugzilla allow video upload?

Yes, but there are filesize limits - depending on the size it may be easier to upload to youtube, dropbox or gdrive as an unlisted/private thing and share the link here.

That said, sharing a link to a broken python file where we behave differently from Chrome (on the same machine) would be the most helpful.

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1568003#c11)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1568003#c10 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to PRITHWISH from [comment #9](/show_bug.cgi?id=1568003#c9 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > (In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1568003#c8 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
> >
> > > Reporter: can you provide an online sample of (ie link to) a python file where we behave differently from Chrome on the same machine?
> > >
> > > (In reply to Dimi Lee [OOO 7/13-8/2][:dimi][:dlee] from [comment #5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
> > >
> > > > I also checked the telemetry, a fairly large amount of python script dp ping responses are unknown, so this might be a way to consider to improve security if we think this is something worth doing.
> > >
> > > Only if it actually solves anything here, which I'm not sure it would without more details about whether we actually behave differently in the case that's being reported (and if so, if that's actually a result of the safebrowsing difference).
> >
> > If you want I can share a recorded version. Does bugzilla allow video upload?
>
> Yes, but there are filesize limits - depending on the size it may be easier to upload to youtube, dropbox or gdrive as an unlisted/private thing and share the link here.
>
> That said, sharing a link to a broken python file where we behave differently from Chrome (on the same machine) would be the most helpful.

Within limited file size it is possible to this scripting attack.

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1568003#c12)• 5 years ago |
|  | |

It is a security vulnerability for firefox. Let me know what else need to be shared for this.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1568003#c13)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #12](/show_bug.cgi?id=1568003#c12 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> what else need to be shared for this.

Please provide a link to a python file with which this problem reproduces in Firefox and doesn't reproduce in Chrome.

Please *also* provide a screen recording of the Firefox vs. Chrome behaviour you're seeing for this file.

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1568003#c14)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #13](/show_bug.cgi?id=1568003#c13 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to PRITHWISH from [comment #12](/show_bug.cgi?id=1568003#c12 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > what else need to be shared for this.
>
> Please provide a link to a python file with which this problem reproduces in Firefox and doesn't reproduce in Chrome.
>
> Please *also* provide a screen recording of the Firefox vs. Chrome behaviour you're seeing for this file.

<https://drive.google.com/file/d/1gIR9YZDF1oQd0A3g_5sf1CXxO4p-iTuz/view?usp=sharing>

Run it in firefox with about:preferences content type python as always ask

Flags: needinfo?(prithwishkkumarpal)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1568003#c15)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #14](/show_bug.cgi?id=1568003#c14 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to :Gijs (he/him) from [comment #13](/show_bug.cgi?id=1568003#c13 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > (In reply to PRITHWISH from [comment #12](/show_bug.cgi?id=1568003#c12 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
> >
> > > what else need to be shared for this.
> >
> > Please provide a link to a python file with which this problem reproduces in Firefox and doesn't reproduce in Chrome.
> >
> > Please *also* provide a screen recording of the Firefox vs. Chrome behaviour you're seeing for this file.
>
> <https://drive.google.com/file/d/1gIR9YZDF1oQd0A3g_5sf1CXxO4p-iTuz/view?usp=sharing>
>
> Run it in firefox with about:preferences content type python as always ask

So what's different in Chrome? If you click the downloaded file in Chrome, doesn't exactly the same thing happen?

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1568003#c16)• 5 years ago |
|  | |

no

Flags: needinfo?(prithwishkkumarpal)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1568003#c17)• 5 years ago |
|  | |

"no" is unhelpfully brief if it takes a week to get a response.

On Mac Chrome gives me the "This type of file can harm your computer. Do you want to keep ... anyway?" message when I click the download button on the drive page in [comment 14](/show_bug.cgi?id=1568003#c14 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). This is consistent with what Dimi said in [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"), although at the time he was having trouble finding a file that would trigger it.

We know from the unhappiness over JNLP handling that our UX around dangerous types needs improving. If we have a bug or plan to improve that then we could/should throw python on the "dangerous" list once we've done that (have this bug depend on that one). Until that UX changes we can't. We certainly can't give "unknown" files the "known bad" safebrowsing treatment.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a5546983_1689)• 5 years ago |

Summary: Python script execution using browser → Python files that aren't "known good" should get some kind of dangerous-file download warning

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a5546994_1689)• 5 years ago |

Type: defect → enhancement

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1568003#c18)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #17](/show_bug.cgi?id=1568003#c17 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> "no" is unhelpfully brief if it takes a week to get a response.
>
> On Mac Chrome gives me the "This type of file can harm your computer. Do you want to keep ... anyway?" message when I click the download button on the drive page in [comment 14](/show_bug.cgi?id=1568003#c14 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). This is consistent with what Dimi said in [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"), although at the time he was having trouble finding a file that would trigger it.
>
> We know from the unhappiness over JNLP handling that our UX around dangerous types needs improving. If we have a bug or plan to improve that then we could/should throw python on the "dangerous" list once we've done that (have this bug depend on that one). Until that UX changes we can't. We certainly can't give "unknown" files the "known bad" safebrowsing treatment.

Apologize for late reply. The issue we are discussing about is regarding firefox not chrome. Firefox doesn't give any alert if python environment is set. It directly run the script in host machine.

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1568003#c19)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #18](/show_bug.cgi?id=1568003#c18 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to Daniel Veditz [:dveditz] from [comment #17](/show_bug.cgi?id=1568003#c17 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > "no" is unhelpfully brief if it takes a week to get a response.
> >
> > On Mac Chrome gives me the "This type of file can harm your computer. Do you want to keep ... anyway?" message when I click the download button on the drive page in [comment 14](/show_bug.cgi?id=1568003#c14 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). This is consistent with what Dimi said in [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"), although at the time he was having trouble finding a file that would trigger it.
> >
> > We know from the unhappiness over JNLP handling that our UX around dangerous types needs improving. If we have a bug or plan to improve that then we could/should throw python on the "dangerous" list once we've done that (have this bug depend on that one). Until that UX changes we can't. We certainly can't give "unknown" files the "known bad" safebrowsing treatment.
>
> Apologize for late reply. The issue we are discussing about is regarding firefox not chrome. Firefox doesn't give any alert if python environment is set. It directly run the script in host machine.

Instead of enhancement it should be fixed so that it behaves properly as chrome i.e. when I click on open it will show the script in browser and will not execute it.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1568003#c20)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #19](/show_bug.cgi?id=1568003#c19 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Instead of enhancement it should be fixed so that it behaves properly as chrome i.e. when I click on open it will show the script in browser and will not execute it.

That's exactly what we see happen with your example link from [comment 14](/show_bug.cgi?id=1568003#c14 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). So the difference I'm seeing is our UI could make it clearer that this is a "dangerous" type, which would be an enhancement.

We're not seeing a "click and execute" behavior unless the user has at some point specified that python files are handled by an interpreter, and turned off the "always ask" setting. You have not provided a testcase that exhibits this behavior or even shared a video as requested showing this happen on your system from which we might be able to glean a few extra clues.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1568003#c21)• 5 years ago |
|  | |

We already have bugs on improving the user experience around "dangerous type" files. So far we have seen no evidence that Python is uniquely dangerous since in none of the default configs we have found are they immediately executed.

Status: NEW → RESOLVEDClosed: 5 years agoResolution: --- → INCOMPLETE

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1568003#c22)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #21](/show_bug.cgi?id=1568003#c21 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> We already have bugs on improving the user experience around "dangerous type" files. So far we have seen no evidence that Python is uniquely dangerous since in none of the default configs we have found are they immediately executed.

So according to you, this is not an issue? Python code with vulnerable code will not impact the individual user? Right?

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1568003#c23)• 5 years ago |
|  | |

I will like to public this issue and users decide whether its a vulnerability or not.

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1568003#c24)• 5 years ago |
|  | |

Will reopen this bug.

Status: RESOLVED → REOPENEDResolution: INCOMPLETE → ---

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1568003#c25)• 5 years ago |
|  | |

The bug was closed incomplete because you've repeatedly refused to provide details of the specifics of this issue and why/how the behaviour is any different from other browsers.

Status: REOPENED → RESOLVEDClosed: 5 years ago → 5 years agoResolution: --- → INCOMPLETE

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1568003#c26)• 5 years ago |
|  | |

I replied to each of the questions. Kindly follow the previous communications. Also let me know if any further information required. Keeping mind that after answering all the questions and clarifications the bug id was generated not before that.

Status: RESOLVED → REOPENEDResolution: INCOMPLETE → ---

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1568003#c27)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #26](/show_bug.cgi?id=1568003#c26 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I replied to each of the questions.

(In reply to :Gijs (he/him) from [comment #15](/show_bug.cgi?id=1568003#c15 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> So what's different in Chrome?

You didn't answer this question. Please provide screen recordings of what you're doing in Chrome vs. Firefox, from a clean Firefox profile and default Chrome setup. It's still not clear what steps you're following, and why you think the effect in Firefox is different from the effect of the exact same steps in Chrome, to the point that it's a security bug.

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1568003#c28)• 5 years ago |
|  | |

Step 1: Set python in environment variable in pc and in browser the content type for python need to be set to Always ask

Step 2: Upload a malicious python script file in google drive / one drive etc. and share the link with victim

Step 3: Victim should try to access the url from Firefox and click on download

Step 4: When victim clicks on it a popup appears with two options - Save file and open with

Step 5: If victim selects open with the malicious script gets executed

While in other browsers, the malicious python script file will not run from browser. When victim clicks on download, the malicious file will get downloaded rather than getting executed.

Firefox is different from chrome in the sense that after clicking on download it again allow user to select option to save file or open with. Its a browser design flaw because when user clicks on download it is assumed that file need to be downloaded rather then asking for confirmation/permission. Moreover even if victim clicks on open it is executing the script but it should open the script as read only / editable mode using notepad or notepad++ rather than executing it.

Because of this feature there is a possibility that user may be a victim of remote code execution where code will be shared through social engineering means and when victim tries to open it the script will get executed leading to information disclosure, directory or file access or even file or directory data delete or encryption.

Flags: needinfo?(prithwishkkumarpal)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1568003#c29)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #28](/show_bug.cgi?id=1568003#c28 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Step 1: Set python in environment variable in pc and in browser the content type for python need to be set to Always ask
>
> Step 2: Upload a malicious python script file in google drive / one drive etc. and share the link with victim
>
> Step 3: Victim should try to access the url from Firefox and click on download
>
> Step 4: When victim clicks on it a popup appears with two options - Save file and open with
>
> Step 5: If victim selects open with the malicious script gets executed

I can't reproduce, I have to manually find a python executable on disk if I want to open the file with python. Tested on macOS.

What OS are you testing on? What does step 1 ("set python in environment variable in pc") really mean? Are you pre-selecting python as the handler for .py files in Firefox? Or making it the OS default handler for python files? Or something else?

This is why a screencast would be helpful...

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1568003#c30)• 5 years ago |
|  | |

I am using windows 7. Its just an settings and configurations. I will be sharing a document. Let me know the process to share the video and documents.

Flags: needinfo?(prithwishkkumarpal)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1568003#c31)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #30](/show_bug.cgi?id=1568003#c30 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I am using windows 7. Its just an settings and configurations.

There's really not enough detail here. In Firefox? In Windows? Both? And what did you set up?

> I will be sharing a document. Let me know the process to share the video and documents.

Just attach them to the bug. If that doesn't work due to filesize, use a private file hosting site (e.g. box, dropbox, google drive, ...) of your choice and link the uploaded content here.

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1568003#c32)• 5 years ago |
|  | |

sure. I will do that and share the link

Flags: needinfo?(prithwishkkumarpal)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1568003#c33)• 5 years ago |
|  | |

Please find the below link to download the steps for reproducing the vulnerability

<https://drive.google.com/file/d/1_yGGtABf3uB1c9WKaSSh7rbto4Kg0zwF/view?usp=sharing>

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1568003#c34)• 5 years ago |
|  | |

OK, so finally it turns out there is a real issue here, and I'm sad that this wasn't picked up before - details matter when reporting bugs, so the python install + PATH modifications + win7 reference steps were crucial in figuring out what you're actually seeing.

When opening a python file served by gdrive, google sends us a content-disposition: attachment header, with a `.py` filename - but a text/plain mimetype.

So the "open with" option by default indicates the default OS handler for text/plain files... which is notepad.

Unfortunately, if the user selects "open", we tell the OS "open this file" (without directly specifying notepad), and then the user will find out that on Windows, the python installer made python the default handler for python scripts (and told the OS that python scripts' mimetypes are text/plain - I'm pretty sure there's helper app service code that does a sanity check that the extension and the mimetype match before relying on the mimetype).

None of this happens on Linux/mac.

Dan, I'm guessing we want to re-assess the security severity here. The UI is just lying here and we need to fix it. Perhaps you're still more likely to hit this accidentally than via malicious exploits, as the attacker would need to convince you to install python and update your PATH and all the rest of it, but even so.

:toshi/:bz/:mak, any ideas about what we should be doing instead? I can see a few options, but the file handling code is pretty old and crufty and I'm not sure how easily we can change basic assumptions here without breaking other uses. Options:

1. make the dialog / external app code pass in the actual handler instead of calling `file.launch()`. This will involve figuring out complete commandline invocations from the registry / windows APIs ourselves so it's a little messy. Also goes the opposite way from stated/suggested direction elsewhere ( <https://bugzilla.mozilla.org/show_bug.cgi?id=1306338> ).
2. fix the external helper app service's concept of what the "default" is to more heavily favour the default for the file extension instead of the mimetype, even though file extensions are a stupid way to do this, and accept that this is just how Windows works.
3. add hacky checks for this specific case (or, slightly less hacky, for anything in the safebrowsing list of dodgy extensions)

TL;DR: too many things pretend python files are just "text/plain" - until they're not.

Type: enhancement → defectFlags: needinfo?(tkikuchi)Flags: needinfo?(mak)Flags: needinfo?(dveditz)Flags: needinfo?(bzbarsky)Keywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)OS: Unspecified → WindowsSummary: Python files that aren't "known good" should get some kind of dangerous-file download warning → On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1568003#c35)• 5 years ago |
|  | |

Kindly raise a cve number and share it with me.

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1568003#c36)• 5 years ago |
|  | |

I tried the repro steps locally. The problem I can see is Firefox executes a python script though Firefox's "Opening script\_run\_python.py" dialog says "Open with Notepad (default)".

> :toshi/:bz/:mak, any ideas about what we should be doing instead?

I think the expected behavior should be either 1) to open with Notepad as shown in the dialog or 2) to make the dialog say "Open with Python.File (default)" keeping the current behavior. The latter idea is what we currently do for a link to a .py file without any `Content-Disposition`.

Interestingly, to get this repro, I didn't have to set any environment variables nor `about:preference` settings. I just installed Python for Windows with the default settings. I saw the same behavior on Win10, too.

Flags: needinfo?(tkikuchi)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1568003#c37)• 5 years ago |
|  | |

Yes. because environment variables are set on installation by default and if not need to set manually

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1568003#c38)• 5 years ago |
|  | |

Provided it's not a solution to this bug, [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") sounds like something we may evaluate regardless in a separate bug. Did we discard that already? And if so, why?

(In reply to :Gijs (he/him) from [comment #34](/show_bug.cgi?id=1568003#c34 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> So the "open with" option by default indicates the default OS handler for text/plain files... which is notepad.
>
> Unfortunately, if the user selects "open", we tell the OS "open this file" (without directly specifying notepad), and then the user will find out that on Windows, the python installer made python the default handler for python scripts (and told the OS that python scripts' mimetypes are text/plain

> 2. fix the external helper app service's concept of what the "default" is to more heavily favour the default for the file extension instead of the mimetype, even though file extensions are a stupid way to do this, and accept that this is just how Windows works.

While it's not great, Windows always worked off file extensions, denying this fact seems to only bring troubles. I'd go this way. As :toshi pointed out it would be consistent with the non Content-Disposition case, so it seems the way to go.

Flags: needinfo?(mak)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1568003#c39)• 5 years ago |
|  | |

OK, I'll try to work out why we're doing something else in the content-disp case and if it's easy to make the content-disp case behave like the non-content-disp one.

Boris, still interested in hearing if you've got historical context here about things to watch out for, having only recently read some of e.g. [bug 453455](/show_bug.cgi?id=453455 "RESOLVED FIXED - Make \"do this automatically for files like this from now on\" work even with \"content-disposition: attachment\"") and some of the issues around content-disp: attachment there.

Assignee: nobody → gijskruitbosch+bugsStatus: REOPENED → ASSIGNEDPriority: -- → P1

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1568003#c40)• 5 years ago |
|  | |

> and told the OS that python scripts' mimetypes are text/plain

Yeah, this is just bonkers, as a general thing. As you said, we do verify that the extension of the file we're putting the data in is a valid extension for the MIME type, and fix the extension as needed if it's not, but if *everyone* lies to us about what they are doing... Like your TL;DR says, people really need to stop abusing the system. :(

> fix the external helper app service's concept of what the "default" is to more heavily favour the default for the file extension instead of the mimetype, even though file extensions are a stupid way to do this, and accept that this is just how Windows works.

I *think* the code flow here is doing the "give me the info for this (type, extension) pair" thing, or at least I really hope it is. If the Windows implementation of the helper app service doesn't handle that correctly, then it needs to be fixed!

In particular, if we are given a type and an extension, and that extension is a valid extension for that type, and Windows does helper app lookup by extension, then we should be doing that lookup based on that extension.

What `nsOSHelperAppService::GetMIMEInfoFromOS` does right now is:

1. Get the default extension for the given type.
2. Look up the handler for that default extension.
3. If we found something, and the given extension is valid for the given type, add it to the MIME info.
4. If we found nothing for the default extension, look up info for the given extension.

or so (there are some more complications). It seems like the logic should be more like:

1. Look up the type for the given extension.
2. If this matches the given type, look up handlers by the given extension, since that's the extension we will end up using. We can use the existing nsOSHelperAppService::typeFromExtEquals thing on Windows for this, I bet.
3. Otherwise look up the default extension for the type and look up based on that.
4. If none of that found anything useful, continue to look up by the given extension, I guess, as now? I'm not sure what exactly should happen here if the given extension does not match the given MIME type in any sort of useful way *and* there is no handler for the default exension for the given MIME type.

What should get stored in our prefs in terms of how to handle things in the future, given all that, is an interesting question. we don't *really* want to associate the Python interpreter with all text/plain downloads, for example, but if everyone is lying to us about .py being text/plain, I don't see a simple way to avoid that short of a blacklist or something. Or persisting helper apps on a per (type, extension) basis, not a per-type basis, as long as the extension is a valid one for the type, etc.

Flags: needinfo?(bzbarsky)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1568003#c41)• 5 years ago |
|  | |

Is there any further information required from my end? When can I expect the CVE number for the same?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1568003#c42)• 5 years ago |
|  | |

(In reply to Toshihito Kikuchi [:toshi] from [comment #36](/show_bug.cgi?id=1568003#c36 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I think the expected behavior should be either 1) to open with Notepad as shown in the dialog or 2) to make the dialog say "Open with Python.File (default)" keeping the current behavior. The latter idea is what we currently do for a link to a .py file without any `Content-Disposition`.

Can you provide an example? I sort of expect that the server you tested doesn't send `text/plain` as the mimetype, but it'd be good to have this confirmed.

Flags: needinfo?(tkikuchi)

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1568003#c43)• 5 years ago |
|  | |

Yes, in the case of 2), Content-Type was `text/x-python`.

Flags: needinfo?(tkikuchi)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1568003#c44)• 5 years ago |
|  | |

(In reply to Marco Bonardo [:mak] from [comment #38](/show_bug.cgi?id=1568003#c38 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Provided it's not a solution to this bug, [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") sounds like something we may evaluate regardless in a separate bug. Did we discard that already? And if so, why?

No, we should still look at this. Dimi, would you mind filing a separate, non-security bug for this, not mentioning any of the relevant details of this bug?

Flags: needinfo?(dlee)

|  | [Dimi Lee [:dimi]](/user_profile?user_id=468232) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1568003#c45)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #44](/show_bug.cgi?id=1568003#c44 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to Marco Bonardo [:mak] from [comment #38](/show_bug.cgi?id=1568003#c38 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > Provided it's not a solution to this bug, [comment 5](/show_bug.cgi?id=1568003#c5 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") sounds like something we may evaluate regardless in a separate bug. Did we discard that already? And if so, why?
>
> No, we should still look at this. Dimi, would you mind filing a separate, non-security bug for this, not mentioning any of the relevant details of this bug?

Done, [Bug 1595729](/show_bug.cgi?id=1595729 "NEW - Consider not treating unknown verdict type as a safe download")

Flags: needinfo?(dlee)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1568003#c46)• 5 years ago |
|  | |

(In reply to Boris Zbarsky [:bzbarsky, bz on IRC] from [comment #40](/show_bug.cgi?id=1568003#c40 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> or so (there are some more complications). It seems like the logic should be more like:
>
> 1. Look up the type for the given extension.
> 2. If this matches the given type, look up handlers by the given extension, since that's the extension we will end up using. We can use the existing nsOSHelperAppService::typeFromExtEquals thing on Windows for this, I bet.
> 3. Otherwise look up the default extension for the type and look up based on that.
> 4. If none of that found anything useful, continue to look up by the given extension, I guess, as now? I'm not sure what exactly should happen here if the given extension does not match the given MIME type in any sort of useful way *and* there is no handler for the default exension for the given MIME type.

I think I've got a patch for this locally, but there's some remaining stuff to work out. FWIW, I think this is too risky a change to uplift, so we probably want to file a generic non-security "cover" bug to make it easier to deal with regressions and all the rest of this - or open up this bug.

If we want a patch for uplift it'd have to be something specific for the python+text/plain combination, but that feels very yucky so I'd prefer not to.

> What should get stored in our prefs in terms of how to handle things in the future, given all that, is an interesting question. we don't *really* want to associate the Python interpreter with all text/plain downloads, for example, but if everyone is lying to us about .py being text/plain, I don't see a simple way to avoid that short of a blacklist or something. Or persisting helper apps on a per (type, extension) basis, not a per-type basis, as long as the extension is a valid one for the type, etc.

Right. I don't really want to change the stored types in the handler service *only* on Windows, and doing so everywhere would likely get us complaints from Linux users. Seems macOS is off in its own world with UTIs and whatnot, from a quick look. So not wild about this unless you think we really need to go this route?

If we're not doing that, we run into a conundrum: how to make an exception for python here to avoid permanent mis-association for `text/plain`. I see a few solutions:

1. blocklist / hardcode `text/plain` that doesn't use `.txt` as something for which you can't save the association. We already have a similar exception for `application/octet-stream`, so this isn't completely out of the question, but I suppose if you currently work with an enterprise system with (say) `.dat` files that it serves as text/plain, you're gonna be pretty peeved. A workaround would be saving the default with a file with the correct extension, see below.
2. blocklist / hardcode `text/plain` with any extensions on the ApplicationReputation list. This would stop permanently associating e.g. MS Office files mis-served as text/plain. Unsure how common that is (though worth noting that permanent association for any files mis-served as `application/octet-stream`, probably more common, is already not possible!). I guess we could perhaps avoid this by changing the mimetype based on the file extension? Though that's yet more risk in terms of change from the status quo, and would entail doublechecking how solid the logic for passing extensions is, ie do we end up passing `.py` for URLs like `example.com/serve.py?file=foo` ?
3. blocklist / hardcode `text/plain` with any extensions on the `sExecutableExts` list. This would avoid Office files but doesn't currently include python, so we'd need to add it, which probably has other side effects.
4. hardcode blocking `text/plain` just for python (`.py`/`.pyc` files). This feels too specific.
5. check the primary extension for a mimetype before allowing storing the choice permanently. This is tricky, because now we end up in the situation where some of the stated aims for the existing code (e.g. treating `.jpg` and `.jpeg` the same) won't work anymore - there can only be one primary extension for a given mimetype. For `text/plain` it'll be `.txt`, so we wouldn't offer the "always store" option for `text/plain` with a `.py` file, but we also wouldn't offer the "always store" option for at least one of `.jpg` or `.jpeg` with an `image/jpeg` mimetype.

Between all of these, I'm leaning towards 2, and accept that users can't change the default for bogus-mimetype MS office files.

In addition to that choice, as noted in (1) above, we should work out whether we should be honouring an existing saved "always open" choice for `text/plain` when receiving a `text/plain` file that happens to be a `.py` file (or anything else that doesn't have the "primary extension", `.txt`). I think the answer should probably be "yes"... in the hope that not many people have already selected they want all `text/plain` files to open with the python file handler... but I'm open to other ideas (like a one-time scrubbing of the association or whatever, or scrubbing it if it's python (which sort of points the finger at this bug and seems unlikely), or ...).

Flags: needinfo?(bzbarsky)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1568003#c47)• 5 years ago |
|  | |

Freddy, do you think we should file something with gdrive to suggest they don't serve python files with `text/plain` but use `text/x-python` (which is what macOS and, based on web searches, linux distros, normally use) ?

Mark, the internet suggests you worked on the Python Windows installer? Do you know why it registers as `text/plain` in the windows registry and what'd break if it used `text/x-python` like mac and Linux do? It looks like the registry stuff was added in <https://bugs.python.org/issue23260> , in <https://github.com/python/cpython/commit/bb24087a2cbfb186b540cc71a74ec8c39c1ebe3a> , but I'm really not familiar with Python's infrastructure or community so unsure if there are more details somewhere and/or if this is even the right repository...

Flags: needinfo?(markh)Flags: needinfo?(fbraun)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1568003#c48)• 5 years ago |
|  | |

> I think this is too risky a change to uplift

I agree.

> Seems macOS is off in its own world with UTIs and whatnot, from a quick look

Yeah, I'm not really sure how this works in practice. I've definitely had problems with us creating files like "ajax-175" that are actually PDFs and then MacOS refusing to open them as PDF...

> Between all of these, I'm leaning towards 2, and accept that users can't change the default for bogus-mimetype MS office files.

I don't know that I have strong opinions here. I haven't stayed current on all the edge cases involved in this particular UX flow.

Flags: needinfo?(bzbarsky)

|  | [Mark Hammond [:markh] [:mhammond]](/user_profile?user_id=16943) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1568003#c49)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #47](/show_bug.cgi?id=1568003#c47 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Mark, the internet suggests you worked on the Python Windows installer?

Not for many years now.

> Do you know why it registers as `text/plain` in the windows registry and what'd break if it used `text/x-python` like mac and Linux do? It looks like the registry stuff was added in <https://bugs.python.org/issue23260> , in <https://github.com/python/cpython/commit/bb24087a2cbfb186b540cc71a74ec8c39c1ebe3a> , but I'm really not familiar with Python's infrastructure or community so unsure if there are more details somewhere and/or if this is even the right repository...

That's the correct repo. The author of that patch actually works for MS, so I'm a little surprised to find it registered that way - but regardless, I suspect there's no good reason for it to be done that way and possibly just carrying forward some poor decisions made many years before. I'd be happy to open an issue on that repo, but it might be better to wait until this (or a similar) bug is made public? Even if Python does change, it's not going to change how we address this issue because we need to deal with already installed/released Python versions, right?

Flags: needinfo?(markh)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1568003#c50)• 5 years ago |
|  | |

(In reply to Mark Hammond [:markh] from [comment #49](/show_bug.cgi?id=1568003#c49 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Even if Python does change, it's not going to change how we address this issue because we need to deal with already installed/released Python versions, right?

Yep, just trying to figure out where all the moving pieces are here - but I definitely agree we should chase this after a Firefox fix is shipped.

(In reply to Boris Zbarsky [:bzbarsky, bz on IRC] from [comment #48](/show_bug.cgi?id=1568003#c48 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> > Between all of these, I'm leaning towards 2, and accept that users can't change the default for bogus-mimetype MS office files.
>
> I don't know that I have strong opinions here. I haven't stayed current on all the edge cases involved in this particular UX flow.

OK. Marco, do you have thoughts on how best to detect we're handling `.py` as `text/plain` and not offer the "always do this" checkbox in the unknownContentType dialog on Windows in this case (see [comment #46](/show_bug.cgi?id=1568003#c46 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") for context) ?

Flags: needinfo?(mak)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1568003#c51)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #47](/show_bug.cgi?id=1568003#c47 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Freddy, do you think we should file something with gdrive to suggest they don't serve python files with `text/plain` but use `text/x-python` (which is what macOS and, based on web searches, linux distros, normally use) ?

Yes, but imho we still ought to implement a patch that implements astop gap on our end.

Flags: needinfo?(fbraun)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1568003#c52)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1568003&comment_id=14487163 "1 revision") |
|  | |

(In reply to :Gijs (he/him) from [comment #50](/show_bug.cgi?id=1568003#c50 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> OK. Marco, do you have thoughts on how best to detect we're handling `.py` as `text/plain` and not offer the "always do this" checkbox in the unknownContentType dialog on Windows in this case (see [comment #46](/show_bug.cgi?id=1568003#c46 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") for context) ?

First, I read again all of the discussion taking a bit more time, I think bz's proposal to change the handler search order makes sense, as well as your proposal to hardcode text/plain for things in the ApplicationReputation list.

For the handling, it's not very different from what we do for octet-stream here <https://searchfox.org/mozilla-central/rev/e7c61f4a68b974d5fecd216dc7407b631a24eb8f/toolkit/mozapps/downloads/HelperAppDlg.jsm#512> so it sounds like we should be able to just add another case. We have both the url and the type there.

That will uncheck the checkbox and disable it. This UX choice is ugly, imo. The user doesn't know why this checkbox gets disabled, and the explanation is too complicate to show it. I think we should actually hide/collapse the checkbox and not show it, that is closer to a "we show you the feature only if the website supports it". It would be less frustrating for the user.

There is actually a difference from octet-stream, for which we never want to remember the action; here we may want to remember the action if the user changes the handler in the dialog to one valid for the extension (and its real type)... Unfortunately this would require the dialog to know all the handlers for the extension, and onchange check if the picked handler is in that list. That sounds over complicate and unnecessary.

In the end I'd just remove the checkbox and file Tech Evangelism bugs to ask servers to serve files with proper types...

If your question was wider, please let me know.

Flags: needinfo?(mak)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a9934549_1689)• 5 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1568003#c53)• 5 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #51](/show_bug.cgi?id=1568003#c51 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to :Gijs (he/him) from [comment #47](/show_bug.cgi?id=1568003#c47 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > Freddy, do you think we should file something with gdrive to suggest they don't serve python files with `text/plain` but use `text/x-python` (which is what macOS and, based on web searches, linux distros, normally use) ?
>
> Yes, but imho we still ought to implement a patch that implements astop gap on our end.

For sure.

I'll shortly be putting up a patch to execute on the steps in [comment #40](/show_bug.cgi?id=1568003#c40 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") in [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information"). Please do not link the two bugs or comment on [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information") with anything relating to this bug, python, or the vulnerability itself.

I'm planning to use either this bug or another separate bug to add checks to disable "always do this for files of this type" for files that are in the application reputation check list. [comment #0](/show_bug.cgi?id=1568003#c0 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") suggests this bug doesn't happen when "always ask" is not selected, and I'd like to understand that better first.

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1568003#c54)• 5 years ago |
|  | |

Hi All,

When can I expect the CVE number for the mentioned issue. It has been 4 months since the conversation is going on.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1568003#c55)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1568003&comment_id=14509277 "1 revision") |
|  | |

(In reply to PRITHWISH from [comment #54](/show_bug.cgi?id=1568003#c54 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> It has been 4 months since the conversation is going on.

It's only been 3 weeks since it became clear what issue you were actually reported, after it repeatedly took us a week or more to get answers to questions we asked you. We're actively working on a patch, see [comment #53](/show_bug.cgi?id=1568003#c53 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") (posted less than a week ago).

Flags: needinfo?(dveditz)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1568003#c56)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #54](/show_bug.cgi?id=1568003#c54 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> When can I expect the CVE number for the mentioned issue.

I don't think we normally assign CVEs before we release a version of Firefox that contains a fix for the issue. Dan, can you comment?

Flags: needinfo?(dveditz)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1568003#c57)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #56](/show_bug.cgi?id=1568003#c56 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> (In reply to PRITHWISH from [comment #54](/show_bug.cgi?id=1568003#c54 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))
>
> > When can I expect the CVE number for the mentioned issue.
>
> I don't think we normally assign CVEs before we release a version of Firefox that contains a fix for the issue. Dan, can you comment?

But is a vulnerability.right?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1568003#c58)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #53](/show_bug.cgi?id=1568003#c53 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I'll shortly be putting up a patch to execute on the steps in [comment #40](/show_bug.cgi?id=1568003#c40 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") in [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information"). Please do not link the two bugs or comment on [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information") with anything relating to this bug, python, or the vulnerability itself.

This seems to have landed and stuck without (so far) any negative consequences.

> I'm planning to use either this bug or another separate bug to add checks to disable "always do this for files of this type" for files that are in the application reputation check list. [comment #0](/show_bug.cgi?id=1568003#c0 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python") suggests this bug doesn't happen when "always ask" is not selected, and I'd like to understand that better first.

I'm still digging at this. I've verified that on existing 70/71 builds, if you pick "remember this choice" for the python file served as text plain, that correctly shows up as a permanent choice in about:preferences indicating you selected the OS default app for text/plain files, which it lists (correctly) as "Use Notepad (default)". Ditto for the new 72 nightly builds that have the patch for [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information") - it's a little bit wrong, because the dialog shows "Open with python.exe", but the python.exe isn't what is remembered, it's just "use the default OS helper", with the mime type (of text/plain). Disabling the checkbox here would still reduce confusion, but probably isn't a security issue because there are no ill effects.

However, in both situations, we still prompt, even with the code as-is.

This could be because of [bug 453455](/show_bug.cgi?id=453455 "RESOLVED FIXED - Make \"do this automatically for files like this from now on\" work even with \"content-disposition: attachment\""). However, even if I create an "adversarial" testcase that uses `<a download href="foo.py">Link</a>` and instruct the server to serve `foo.py` with `Content-Type: text/plain` without a `Content-Disposition` header, I already still get asked (ie the "always do this" gets ignored).

Still digging as to why this is. This is made a little bit trickier because I don't have a visual studio environment in the VM where I'm testing this so I can't easily step through what our compiled code is doing here. I'm trying to use the browser toolbox for this, but trying to break into HandlerService.js causes the debugged process to crash... So, still digging.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1568003#c59)• 5 years ago |
|  | |

> and instruct the server to serve foo.py with Content-Type: text/plain without a Content-Disposition header

We implement the `download` attribute by effectively pretending that the channel had `Content-Disposition: attachment`. So you end up hitting the same code.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1568003#c60)• 5 years ago |
|  | |

(In reply to Boris Zbarsky [:bzbarsky, bz on IRC] from [comment #59](/show_bug.cgi?id=1568003#c59 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> > and instruct the server to serve foo.py with Content-Type: text/plain without a Content-Disposition header
>
> We implement the `download` attribute by effectively pretending that the channel had `Content-Disposition: attachment`. So you end up hitting the same code.

Is there any other way we could end up downloading something served as text/plain ?

Flags: needinfo?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1568003#c61)• 5 years ago |
|  | |

I *think* the answer is "no".

Flags: needinfo?(bzbarsky)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1568003#c62)• 5 years ago |
|  | |

(In reply to Boris Zbarsky [:bzbarsky, bz on IRC] from [comment #61](/show_bug.cgi?id=1568003#c61 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> I *think* the answer is "no".

OK, good, that's what I thought too.

That leaves 2 things, ish:

1. disable the checkbox in this case, even if the effects are benign from a security PoV
2. ensure we don't accidentally start launching python files with python if/when we fix [bug 453455](/show_bug.cgi?id=453455 "RESOLVED FIXED - Make \"do this automatically for files like this from now on\" work even with \"content-disposition: attachment\"") (or if there's some case Boris and I are missing in terms of text/plain downloading that wouldn't allow for inline opening).

For (2), I'm leaning towards adding an explicit check for ApplicationReputation file extensions at <https://searchfox.org/mozilla-central/rev/04d8e7629354bab9e6a285183e763410860c5006/uriloader/exthandler/nsExternalHelperAppService.cpp#1658-1663> , and fall back to the `alwaysAsk` case there, just as we do for the content disposition attachment case. Even though that's not necessary today for this specific case, it seems like it would be wise in terms of future-proofing.

Neither of these seem super urgent given the main fix of making the dialog reflect reality has landed and is now on beta, but I'll try and get it done this week or next so we can consider beta uplift.

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1568003#c63)• 5 years ago |
|  | |

Hi All,

Is the fix for the same has been published? It is opened since 5 months and neither I received the cve number or any acknowledgement for identifying the bug.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a12820878_20209)• 5 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1568003#c64)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #63](/show_bug.cgi?id=1568003#c63 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Is the fix for the same has been published?

The main portion of this fix ([bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information")) is currently in beta (Firefox 72). It's not made it to the release channel yet; if all goes well that'll happen in January ( <https://wiki.mozilla.org/RapidRelease/Calendar> ).

> It is opened since 5 months and neither I received the cve number or any acknowledgement for identifying the bug.

I already responded to your points about timelines in [comment #55](/show_bug.cgi?id=1568003#c55 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). It's been much less than 5 months since it actually became clear what the issue was - more like 5 weeks. As for a CVE, I don't think we assign one until the bug is fixed on our release channels. Dan can confirm whether I've understood this correctly.

This bug is still open because of the issues in [comment #62](/show_bug.cgi?id=1568003#c62 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). I was hoping to get to this sooner but various other things were dropped on my plate that took precedence. Because of end-of-year holidays, the other issues may miss 72 and not be released until 73.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1568003#c65)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #63](/show_bug.cgi?id=1568003#c63 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Is the fix for the same has been published? It is opened since 5 months and neither I received the cve number or any acknowledgement for identifying the bug.

As Gijs said we have not shipped this fix yet. The CVE and acknowledgement will go in the advisories we publish when we ship.

(In reply to :Gijs from [comment #64](/show_bug.cgi?id=1568003#c64 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> This bug is still open because of the issues in [comment #62](/show_bug.cgi?id=1568003#c62 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"). I was hoping to get to this sooner but various other things were dropped on my plate that took precedence. Because of end-of-year holidays, the other issues may miss 72 and not be released until 73.

As a not-yet-fixed bug this but will get missed by the advisory writing process. Can we split those additional issues into a follow-up bug, resolve this one FIXED, and then write an advisory for Fx72 on Jan 7?

Flags: needinfo?(dveditz) → needinfo?(gijskruitbosch+bugs)Whiteboard: depends on bug 1597985--DO NOT LINK

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a12940488_159069)• 5 years ago |

Depends on: [1605102](/show_bug.cgi?id=1605102 "RESOLVED FIXED - Always ask what to do for text/plain mimetype combined with ApplicationReputation file extensions (and disable/hide the checkbox in this case)")

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1568003#c66)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #65](/show_bug.cgi?id=1568003#c65 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> As a not-yet-fixed bug this but will get missed by the advisory writing process. Can we split those additional issues into a follow-up bug, resolve this one FIXED, and then write an advisory for Fx72 on Jan 7?

Sure. I filed [bug 1605102](/show_bug.cgi?id=1605102 "RESOLVED FIXED - Always ask what to do for text/plain mimetype combined with ApplicationReputation file extensions (and disable/hide the checkbox in this case)").

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago → 5 years ago
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed)Flags: needinfo?(gijskruitbosch+bugs)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 72

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1568003#c67)• 5 years ago |
|  | |

Do we need to do something for ESR still?

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1568003#c68)• 5 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #67](/show_bug.cgi?id=1568003#c67 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Do we need to do something for ESR still?

I don't know. :-(

I don't think we can uplift [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information") to ESR before we release 72. We need at least some confidence there aren't going to be major regressions, first. We could add code in 68 that's specific to the python or apprep/text/plain case, but I don't think we can realistically do that before we've shipped a fix on regular release.

Can we mark this tracking the 73 version of 68esr so we come back to it for that?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a13025826_75935)• 5 years ago |

[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)Flags: needinfo?(ryanvm)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a13635867_458188)• 5 years ago |

Flags: qe-verify-Whiteboard: depends on bug 1597985--DO NOT LINK → depends on bug 1597985--DO NOT LINK[post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a14255235_578488)• 5 years ago |

Whiteboard: depends on bug 1597985--DO NOT LINK[post-critsmash-triage] → depends on bug 1597985--DO NOT LINK[post-critsmash-triage][adv-main72+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1568003#c69)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9118585) (obsolete)
— [Details](attachment.cgi?id=9118585&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1568003#c70)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9118594)
— [Details](attachment.cgi?id=9118594&action=edit)

[Attachment #9118585](/attachment.cgi?id=9118585&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a14524033_578488)• 5 years ago |

Alias: CVE-2019-17019

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1568003#c71)• 5 years ago |
|  | |

Hi,

Is the [CVE-2019-17019](https://www.cve.org/CVERecord?id=CVE-2019-17019) available in google? In the attached advisory.txt, my name has been mis spelled. It will be Prithwish Kumar Pal

|  | [Mark Hammond [:markh] [:mhammond]](/user_profile?user_id=16943) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1568003#c72)• 5 years ago |
|  | |

ni? Tom for [comment 71](/show_bug.cgi?id=1568003#c71 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python").

Flags: needinfo?(tom)

|  | [PRITHWISH KUMAR PAL](/user_profile?user_id=643677)  Reporter |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1568003#c73)• 5 years ago |
|  | |

(In reply to PRITHWISH from [comment #71](/show_bug.cgi?id=1568003#c71 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Hi,
>
> Is the [CVE-2019-17019](https://www.cve.org/CVERecord?id=CVE-2019-17019) available in google? In the attached advisory.txt, my name has been mis spelled. It will be Prithwish Kumar Pal

Hi Team,

In the mentioned CVE the reporter name has been wrongly spelled. It will be Prithwish Kumar Pal. Mis-spelled evidence is attached within.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1568003#c74)• 5 years ago |
|  | |

I apologize for that - I filed <https://github.com/mozilla/foundation-security-advisories/pull/40> to fix it on our website and we will submit the CVE details to MITRE shortly and that should have the correct spelling in it.

Flags: needinfo?(tom)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1568003#c75)• 5 years ago |
|  | |

Is this ready for an ESR approval request?

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1568003#c76)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [bug 1597985 comment #4](/show_bug.cgi?id=1597985#c4 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information"))

> Comment on [attachment 9110267](/attachment.cgi?id=9110267 "Bug 1597985 - prefer file extension as provided over default extension for mimetype to look up default applications on Windows, r?bzbarsky") [[details]](/attachment.cgi?id=9110267&action=edit "Bug 1597985 - prefer file extension as provided over default extension for mimetype to look up default applications on Windows, r?bzbarsky")
>
> [Bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information") - prefer file extension as provided over default extension for mimetype to look up default applications on Windows, r?bzbarsky
>
> ### ESR Uplift Approval Request
>
> * **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate
> * **User impact if declined**: security issue
> * **Fix Landed on Version**: 72
> * **Risk to taking this patch**: Low-Medium
> * **Why is the change risky/not risky? (and alternatives if risky)**: we're changing longstanding behaviour of how we look up handler apps on Windows. Still, this has baked on 72 and we don't *currently* think there are any regressions - though it's a bit tricky given that there were some other changes to handler applications that muddy the waters (eg. [bug 1601905](/show_bug.cgi?id=1601905 "VERIFIED FIXED - 68.3.x can't open attachments with spaces in name")).
> * **String or UUID changes made by this patch**: nope

Ryan, I've put the form in here rather than the public bug? This is a bit messy... :-\

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(ryanvm)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1568003#c77)• 5 years ago |
|  | |

A regression was just reported for [bug 1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information"), so I don't think this is ready for this ESR round. Leaving ni for Ryan to update tracking flags.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1568003#c78)• 5 years ago |
|  | |

Pushing it back a cycle for now, but honestly, I'm thinking we should maybe just wontfix for ESR and let it go out with ESR78 instead.

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) → [74+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=74%2B)Flags: needinfo?(ryanvm)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1568003#c79)• 5 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #78](/show_bug.cgi?id=1568003#c78 "RESOLVED FIXED - On Windows, python files get executed instead of opened by notepad, because both Windows and the network suggest the file is text/plain, but ShellExecuteW will then open the file with python"))

> Pushing it back a cycle for now, but honestly, I'm thinking we should maybe just wontfix for ESR and let it go out with ESR78 instead.

WFM. Does this mean you want to clear the tracking flag, too?

I'm also going to self-needinfo because ideally we should also contact the python installer folks about this, and maybe the gdrive folks.

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)Flags: needinfo?(ryanvm)Flags: needinfo?(gijskruitbosch+bugs)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a15358285_75935)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[74+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=74%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-)Flags: needinfo?(ryanvm)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1568003#c80)• 5 years ago |
|  | |

I've reported the python windows installer side of this to the python security mailing list.

I also spent a good half hour trying to find somewhere to report a non-security issue with gdrive, but was unable to find an issue tracker or other contact point (amusingly, <https://support.google.com/drive/answer/4431192/> suggests there should be a contact option on the gdrive help page, but as far as I can tell this does not exist - the best thing I could find in the list on <https://support.google.com/drive> is "Contact Google Drive support" , which goes straight back to the first page). I eventually used "send feedback" on gdrive itself but my expectation is that nothing will happen as a result of that.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1568003#c81)• 5 years ago |
|  | |

The good folks at Python have updated their Windows installer in <https://bugs.python.org/issue39631> . I'm not an expert on their release processes, but based on reading the changelog tea leaves, I think the fix should be in 3.7.8, and was landed on the main and 3.8 and 3.9 branches as well (but, afaict, there's been no release with the fix on those branches just yet, though it's in the 3.9.0 beta 2 release and later). I'm guessing this will not change existing installations, though I'm not 100% sure.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1568003#a44515719_1689)• 4 years ago |

Group: core-security-releaseDepends on: [1597985](/show_bug.cgi?id=1597985 "RESOLVED FIXED - Windows mime info gathering from the OS should prioritize file extensions over mimetypes when looking up handler information")Whiteboard: depends on bug 1597985--DO NOT LINK[post-critsmash-triage][adv-main72+] → [post-critsmash-triage][adv-main72+]
You need to [log in](/show_bug.cgi?id=1568003&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom Ritter [:tjr]](/user_profile?user_id=578488)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250121_011556.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


