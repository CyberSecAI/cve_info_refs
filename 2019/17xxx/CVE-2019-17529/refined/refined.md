```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is a heap-buffer-overflow in the `AP4_CencSampleEncryption::DoInspectFields` function due to insufficient bounds checking when parsing sample encryption information.",
    "weaknesses": [
      "Heap-buffer-overflow due to out-of-bounds read during parsing of sample encryption data."
    ],
    "impact": "The heap-buffer-overflow can lead to a crash of the application, and potentially to arbitrary code execution if exploited further.",
    "attack_vectors": "The vulnerability can be triggered by processing a specially crafted MP4 file that contains manipulated sample encryption data.",
    "required_capabilities": "An attacker needs to provide a malicious MP4 file to the `mp4dump` tool to trigger the vulnerability."
  },
  "additional_details": {
    "affected_function": "AP4_CencSampleEncryption::DoInspectFields at Ap4CommonEncryption.cpp-3437",
    "affected_version": "bento4 1.5.1.0",
    "trigger_command": "mp4dump --verbosity 2 @@",
    "source_code_snippet": "3433             info += 2;\n3434             for (unsigned int j=0; j<num_entries; j++) {\n3435                 unsigned int bocd = AP4_BytesToUInt16BE(info);\n3436                 AP4_FormatString(header, sizeof(header), \"sub-entry %04d.%d bytes of clear data\", i, j);\n3437                 inspector.AddField(header, bocd);\n3438                 unsigned int boed = AP4_BytesToUInt32BE(info+2);\n3439                 AP4_FormatString(header, sizeof(header), \"sub-entry %04d.%d bytes of encrypted data\", i, j);\n3440                 inspector.AddField(header, boed);\n3441                 info += 6;\n3442             }",
    "crash_report": "==20093==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61300000dfee at pc 0x00000060256b bp 0x7ffdb67cdb90 sp 0x7ffdb67cdb80\nREAD of size 4 at 0x61300000dfee thread T0\n    #0 0x60256a in AP4_CencSampleEncryption::DoInspectFields(AP4_AtomInspector&) /src/bento4/Source/C++/Core/Ap4CommonEncryption.cpp:3437",
	"poc_available": true,
    "poc_file": "poc1.tar.gz"
  }
}
```