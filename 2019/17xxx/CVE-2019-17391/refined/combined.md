=== Content from www.espressif.com_4de03778_20250120_233716.html ===

[Skip to main content](#main-content)

[![Home](https://www.espressif.com/sites/all/themes/espressif/logo-black.svg)](/en "Home")
## Main menu

* [Home](/en)
* Hardware
  + Product Overview
    - [SoCs](/en/products/socs)
    - [Modules](/en/products/modules)
    - [DevKits](/en/products/devkits)
    - [Equipment](/en/products/equipment/production-testing-equipment/overview)
    - [Product Selector](https://products.espressif.com/#/product-selector?language=en)
  + ESP32-Wrap
    - ESP32-P
      * [ESP32-P4](/en/products/socs/esp32-p4 "A high-performing SoC offering extensive IO connectivity, HMI, and security features")
    - ESP32-S
      * [ESP32-S3](/en/products/socs/esp32-s3 "A powerful AI SoC with rich peripherals, ideal for HMI applications")
      * [ESP32-S2](/en/products/socs/esp32-s2 "A secure and Wi-Fi SoC with numerous I/O capabilities
        ")
    - ESP32-C
      * [ESP32-C6](/en/products/socs/esp32-c6 "A low-power Wi-Fi 6 SoC with enhanced connectivity")
      * [ESP32-C61](/en/products/socs/esp32-c61 "Delivering affordable Wi-Fi 6 connectivity")
      * [ESP32-C5](/en/products/socs/esp32-c5 "A 2.4 and 5 GHz dual-band Wi-Fi 6 RISC-V MCU")
      * [ESP32-C3](/en/products/socs/esp32-c3 "A cost-effective RISC-V SoC for secure IoT applications")
      * [ESP32-C2](/en/products/socs/esp32-c2 "A small-sized & cost-effective SoC for simple applications")
    - ESP32-H
      * [ESP32-H2](/en/products/socs/esp32-h2 "An 802.15.4 SoC for low power & secure connectivity")
    - ESP32
      * [ESP32](/en/products/socs/esp32 "A revolutionary Wi-Fi + Bluetooth SoC for IoT applications")
    - ESP8266
      * [ESP8266](/en/products/socs/esp8266 "Recommend upgrading to ESP32-C2 (ESP8684)")
* SDKs
  + [ESP-IDF](/en/products/sdks/esp-idf "Official IoT development framework")
    - [IDF Component Manager](https://components.espressif.com/)
  + [ESP-Matter SDK](https://www.espressif.com/en/solutions/device-connectivity/esp-matter-solution#sdk-for-matter "Simplified API and the required tools for building Matter-compatible devices")
  + [Zephyr® for Espressif](/en/sdks/esp-zephyr "Seamless IoT integration and optimized support")
  + [ESP-Arduino](/en/sdks/esp-arduino "Arduino IDE and development support for ESP32")
  + [ESP-AT](https://github.com/espressif/esp-at "AT commands to interface with ESP products")
    - [Overview](/en/products/sdks/esp-at/overview)
    - [Resources](/en/products/sdks/esp-at/resource)
  + [ESP-HOSTED](https://github.com/espressif/esp-hosted "Use ESP SoCs as communication co-processors")
  + [ESP-ADF](https://github.com/espressif/esp-adf "Official audio development framework")
  + [ESP-Mesh-Lite](/en/sdks/esp-mesh-lite "Mesh networking solution based on the Wi-Fi protocol")
  + [ESP HomeKit SDK](https://github.com/espressif/esp-homekit-sdk "Apple HomeKit-certified accessory development")
  + [ESP-BLE-MESH](/en/products/sdks/esp-idf/esp-ble-mesh "Fully SIG-Qualified Bluetooth Mesh Stack")
* Cloud
  + Special Menu
    - [ESP RainMaker®](https://rainmaker.espressif.com/ "Private AIoT Cloud platform with minimal coding and high security")
    - [ESP Insights](https://insights.espressif.com/ "A remote diagnostics solution to monitor the health of on-field devices")
  + Cloud Menu
    - ESP RainMaker®
      * [Homepage](https://rainmaker.espressif.com/)
      * [Product Brief](https://www.espressif.com/sites/default/files/RainMaker/ESP%20RainMaker%20Product%20Brief_EN.pdf)
      * [Tech Blogs](https://blog.espressif.com/rainmaker/home)
      * [Customer Stories](https://www.espressif.com/sites/default/files/RainMaker/ESP%20RainMaker%20Customer%20Story_EN.pdf)
    - ESP Insights
      * [Homepage](https://insights.espressif.com/)
      * [Tech Blogs](https://blog.espressif.com/esp-insights/home)
      * [Get Started](https://github.com/espressif/esp-insights#getting-started)
      * [Dashboard](https://dashboard.insights.espressif.com/)
    - Cloud Services
      * [Maintain & Iterate](/en/support/services)
      * [Tools Support](/en/support/services)
      * [Consult & Customize](/en/support/services)
    - Develop Resources
      * [Get Started](https://rainmaker.espressif.com/docs/intro/)
      * [GitHub Repository](https://github.com/espressif/esp-rainmaker)
      * Client APPs
        + [Nova Home (Source Code Available)](https://rainmaker.espressif.com/docs/nova-intro/)
        + [ESP RainMaker (Fully Open Source)](https://github.com/espressif/esp-rainmaker#phone-apps)
      * [Dashboard (Public)](https://dashboard.rainmaker.espressif.com/login)
    - Solution Integration
      * [Matter Fabric](https://www.espressif.com/en/news/RainMaker_Matter_Fabric "Quickly create your own Matter ecosystem")
      * [ESP-Mesh-Lite](/en/sdks/esp-mesh-lite "Cloud-based mesh device group control")
      * [AWS IoT ExpressLink](/en/solutions/device-connectivity/esp-aws-iot-expresslink "Build Cloud-connected devices with AWS IoT")
* Solutions
  + Special Menu
    - [ESP Matter Offerings](/en/solutions/device-connectivity/esp-matter-solution "SoCs, SDKs, and services for easy Matter device building")
  + Solutions Menu
    - Device Connectivity
      * [Remote Debugging Platform (ESP Insights)](https://insights.espressif.com/)
      * [ACK Solution (Alexa Connect Kit)](/en/solutions/device-connectivity/ack-solution)
      * [ACS Solution (Amazon Common Software)](/en/solutions/device-connectivity/acs-solution)
      * [ESP AWS IoT ExpressLink Solution](/en/solutions/device-connectivity/esp-aws-iot-expresslink)
    - Low-Power Solutions
      * [Wireless Communication Protocol (ESP-NOW)](/en/solutions/low-power-solutions/esp-now)
      * [ESP Smart Switch Solution](/en/solutions/low-power-solutions/esp-smart-switch)
    - HMI
      * [Smart Displays](/en/solutions/hmi/smart-displays)
    - Audio Solutions
      * [AVS Solution (Alexa Voice Services)](/en/solutions/audio-solutions/esp-avs)
      * [ESP Audio Front-End Algorithms](/en/solutions/audio-solutions/esp-afe)
    - AI Solutions
      * [Face Detection (ESP-WHO)](/en/products/devkits/esp-eye/overview?id=esp-who-wrap)
      * [Voice Assistant (ESP-SR)](/en/solutions/audio-solutions/esp-skainet/overview)
        + [Overview](/en/solutions/audio-solutions/esp-skainet/overview)
        + [Resources](/en/solutions/audio-solutions/esp-skainet/resources)
    - Peripherals
      * [Device Drivers](https://docs.espressif.com/projects/espressif-esp-iot-solution/en/latest/index.html)
      * [USB Solutions](/en/solutions/peripherals/usb-solutions)
* Support
  + [Technical Documents](/en/support/documents/technical-documents "Open-source datasheets, technical reference manuals, user guides, API references, test reports, and more!")
    - [All Types](/en/support/documents/technical-documents)
    - [SoCs](/en/support/download/documents/chips)
    - [Modules](/en/support/download/documents/modules)
    - [DevKits](/en/support/download/documents/development-board)
    - [Equipment](/en/support/download/documents/production-testing-equipment)
  + Services
    - [Self-Service Resources](/en/support/services)
    - [Open Software](/en/support/services)
    - [Hardware & RF](/en/support/services)
    - [Cloud](/en/support/services)
    - [Certification](/en/support/services)
    - [Manufacturing](/en/support/services)
    - [On-Site Assistance](/en/support/services)
  + Download
    - [SDKs & Demos](/en/support/download/sdks-demos)
    - [APPs](/en/support/download/apps)
    - [Tools](/en/support/download/other-tools)
    - [ESP-AT](/en/support/download/at)
  + Quality & Reliability
    - [Certificates](/en/support/documents/certificates)
    - [PCNs](/en/support/documents/pcns)
    - [Advisories](/en/support/documents/advisories)
    - [Longevity Commitment](/en/products/longevity-commitment)
  + FAQ
    - [ESP-FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/)
    - [Commercial FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/commercial-faq/index.html)
* Ecosystem
  + Partnership and Resource
    - [AWS Technology Partner](/en/ecosystem/partnership-and-resource/aws-advanced-technology-partner)
    - [Third-Party Platforms](/en/ecosystem/partnership-and-resource/third-party-platforms)
    - [Third-Party SDKs](/en/ecosystem/partnership-and-resource/third-party-sdks)
  + Developer Zone
    - [ESP Developer Portal](https://developer.espressif.com/)
    - [Espressif DevCon](https://devcon.espressif.com)
    - [Tech Blogs](https://medium.com/the-esp-journal)
    - [ESP32 Forum](https://www.esp32.com/)
  + Community
    - [Courses](/en/ecosystem/community-engagement/courses)
    - [Rust](https://github.com/esp-rs/esp-hal)
    - [Books](/en/ecosystem/community-engagement/books)
    - [Videos](/en/ecosystem/community-engagement/videos)
    - [Projects](/en/ecosystem/community-engagement/projects)
* Company
  + About Us
    - [About Espressif](/en/company/about-espressif)
    - [Milestones](/en/company/about-us/milestones)
    - [CEO Messages](/en/company/about-us/ceo-letter)
    - [Logo Guidelines](/en/about-espressif/logo-guidelines)
  + Newsroom
    - [News](/en/company/newsroom/news)
    - [Newsletter](/en/company/newsroom/newsletter)
    - [Tech Blogs](https://medium.com/the-esp-journal)
    - [Events](/en/company/newsroom/events)
  + Investor Relations
    - [Reports](/en/company/investor-relations/reports)
    - [Investor Inquiries](/en/company/investor-relations/investor-inquiries)
  + Corporate Responsibility
    - [Reports](/en/company/corporate-responsibility/reports)
    - [Wildlife Protection](/en/company/corporate-responsibility/wildlife-protection-program)
  + Join Us
    - [People at Espressif](/en/join-us/people-at-espressif)
    - [Campus Recruitment](/en/join-us/campus-recruitment)
    - [Open Positions](/en/join-us/job-search)
* Contact
  + [Contact Sales](/en/contact-us/sales-questions)
  + [Technical Inquiries](/en/contact-us/technical-inquiries)
  + [Circuit Schematic & PCB Design Review](/en/contact-us/circuit-schematic-pcb-design-review)
  + [Get Samples](/en/contact-us/get-samples)
  + [Become Our Supplier](/en/contact-us/become-our-supplier)
  + [Comments & Suggestions](/en/contact-us/comments-and-suggestions)

## Search form

Search

Search[EN](https://www.espressif.com/en/news/Security_Advisory_Concerning_Fault_Injection_and_eFuse_Protections)[中文](https://www.espressif.com/zh-hans/news/Security_Advisory_Concerning_Fault_Injection_and_eFuse_Protections)[Subscribe](https://www.espressif.com/en/subscribe)

* ![](/sites/default/files/banner/news-banner-2023.jpg?v=1)
  ![](/sites/default/files/banner/news-banner-2023-mobile-bg.jpg)
  # News

## You are here

[Home](/en)

news

# Security Advisory concerning fault injection and eFuse protections (CVE-2019-17391)

### China, ShanghaiNov 1, 2019

The ESP32-D0WD-V3 chip has checks in ROM which prevent fault injection attack. This chip and related modules will be available in Q4 2019. More information about ESP32-D0WD-V3 will be released soon.

**Issue Summary**

An attacker who uses fault injection to physically disrupt the ESP32 CPU immediately after reset can corrupt eFuse bits when they are being read out by the internal hardware. This includes corrupting read protection eFuse bits, which control software read access to other parts of eFuse.

This fault injection attack can allow bypassing of read protection for Flash Encryption and Secure Boot keys stored in eFuse. The keys are often also corrupted by the fault, but by repeating the attack and analyzing the results a full eFuse key value may be recovered.

At time of writing, currently available ESP32 chips (ESP32-D0WD, ESP32-D2WD, ESP32-S0WD, ESP32-PICO-D4, and related modules) are vulnerable to this attack. **The ESP32-D0WD-V3 chip has checks in ROM which prevent this attack. This chip and related modules will be available in Q4 2019.** More information about ESP32-D0WD-V3 will be released soon.

This issue has been found and disclosed to Espressif by LimitedResults. Espressif thanks LimitedResults for responsibly disclosing this issue.

 **What is fault injection?**

Fault injection is a technique for disrupting the behaviour of a hardware system by injecting faults via physical means, often by carefully timed voltage or clock fluctuations. To deploy fault injection an attacker must have physical access to the hardware to modify it and inject faults.

Following a fault, the system will usually crash. However sometimes a carefully timed fault may cause the CPU or an internal hardware process to skip a particular instruction or corrupt the result of a particular operation. By repeating the fault injection process a large number of times, an attacker may eventually get a result which bypasses a security measure.

All electronic hardware is vulnerable to some types of physical fault injection, although the difficulty of inducing the fault varies.

**Impact of the attack**

This attack requires physical access to the device, and the time and resources to modify the device to apply fault injection.

Using fault injection to successfully recover the Flash Encryption key from an ESP32 allows an attacker to read the device’s flash contents including firmware and data stored in flash. It also allows updating the encrypted contents of flash.

Using fault injection to successfully recover the Secure Boot key from an ESP32 allows generating a new valid secure boot digest to allow booting a modified bootloader.

The recommended configuration for Flash Encryption and Secure Boot keys is that each devices generates individual and unique keys. If this is the case, then eFuse keys recovered from a single ESP32 chip cannot be reused on other ESP32 chips. The physical fault injection attack must be repeated against each individual chip in order to recover additional keys.

 **Mitigations in ROM**

In May 2019, Espressif worked with security analysts from Riscure in order to review the ESP32 boot ROM code including modifications made to harden it against fault injection.

When making these changes, it was identified that there might be potential for fault injection to corrupt eFuse values when they were read by the hardware after reset. Additional checks were added in ROM code to protect against this possibility, and these checks are included in the ESP32-D0WD-V3 chip.

ESP32-D0WD-V3 also adds support for a new Secure Boot V2 scheme based on asymmetric cryptography. Secure Boot V2 does not require a read-protected Secure Boot key. ESP-IDF software support for Secure Boot V2 will be released in Q4 2019. Secure Boot V1 is also supported on ESP32-D0WD-V3, with checks in ROM to prevent fault injection attacks.

The forthcoming ESP32-S2 SoC has additional hardware and ROM code provisions to protect against fault injection, including against this attack. ESP32-S2 also uses the Secure Boot V2 scheme.

 **Disclosure History**

• July 24: LimitedResults informed Espressif of a new vulnerability allowing an attacker to read keys stored in eFuse.

• September 12: LimitedResults provided a proof of concept report demonstrating fault injection attack and analysis to recover keys stored in eFuse.

• November: Agreed public disclosure date.

 **Recommendations for ESP32 Users**

If producing devices which require ESP32 Flash Encryption and/or Secure Boot features then it is recommended to use ESP32-D0WD-V3 chips or the related ESP32-WROVER-E modules which include fault injection checks in ROM. Please contact [Espressif Sales](https://www.espressif.com/en/company/contact/pre-sale-questions-crm) with your requirements.

For already deployed hardware using other ESP32 silicon revisions, there is no software mitigation for this issue.

Additional general recommendations:

• Remove any unnecessary sensitive data from flash storage, if possible. This includes providing a “factory reset” option which removes customer data from flash before the product is sold or disposed of.

• Use per-device unique keys for Secure Boot and Flash Encryption.

• Generate per-device unique keys stored in flash for application uses, rather than using a single shared key across all devices.

Share this article

* ![](/sites/all/themes/espressif/images/linkedin-share.png) LinkedIn
* ![](/sites/all/themes/espressif/images/wechat-share.png) 微信
  #### 微信分享

  打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮
* ![](/sites/all/themes/espressif/images/twitter-share.png) Twitter
* ![](/sites/all/themes/espressif/images/facebook-share.png) Facebook

Reuse this content

top

### Stay Informed with Us

Get the latest on innovations, product launches, upcoming events, documentation updates, PCN notifications, advisories, and more.

Subscribe

* PRODUCTS
* [SoCs](/en/products/socs)
* [Modules](/en/products/modules)
* [DevKits](/en/products/devKits)
* [Product Selector](https://products.espressif.com/#/product-selector)

* DEVELOPERS
* [Developer Portal](https://developer.espressif.com/)
* [ESP DevCon](http://devcon.espressif.com/)
* [Tech Blogs](https://medium.com/the-esp-journal)
* [News](/en/company/newsroom/news)

* COMPANY
* [About Espressif](/en/company/about-espressif)
* [Logo Guidelines](/en/about-espressif/logo-guidelines)
* [Sales Questions](/en/contact-us/sales-questions)
* [Work With Us](/en/join-us/job-search)

* RESOURCES
* [Tech Documents](/en/support/documents/technical-documents)
* [GitHub](https://github.com/espressif)
* [ESP-FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/)
* [Get Samples](/en/contact-us/get-sample)

* [linkdin](https://www.linkedin.com/company/espressif-systems/)
* [youtube](https://www.youtube.com/channel/UCDBWNF7CJ2U5eLGT7o3rKog)
* [twitter](https://twitter.com/EspressifSystem)
* [facebook](https://www.facebook.com/espressif/)
* [ins](https://www.instagram.com/espressif_systems_official/)
* [github](https://github.com/espressif)

Copyright © 2024 Espressif Systems. All rights reserved.

[![](/sites/all/themes/espressif/images/gongan.png)](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011502019094)[沪ICP备2021026420号](https://beian.miit.gov.cn/)

* [Terms of Service](/en/content/terms-use)
* [Privacy Policy](/en/content/privacy)

690 Bibo Road Block 2 Suite 204, Zhangjiang Shanghai, China

## Languages

* [English](/en/news/Security_Advisory_Concerning_Fault_Injection_and_eFuse_Protections)
* 简体中文

 [![](/sites/all/themes/espressif/images/new-home/down.png?v=2)](https://www.espressif.com/en/contact-us/sales-questions)

![](https://px.ads.linkedin.com/collect/?pid=4339316&fmt=gif)
/


