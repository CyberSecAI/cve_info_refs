- **Root cause of vulnerability**: A vulnerability exists in the `PD_GET_DIAG_HIST` stored procedure in IBM Db2 that can be exploited under specialized conditions.
- **Weaknesses/vulnerabilities present**: The vulnerability stems from insufficient access control or validation when the `PD_GET_DIAG_HIST` procedure is invoked, which allows a malicious user with specific permissions to cause a denial of service.
- **Impact of exploitation**: Successful exploitation can lead to a denial of service (DoS) by crashing the Db2 instance.
- **Attack vectors**: Attackers must have `EXECUTE` privileges on the `PD_GET_DIAG_HIST` stored procedure and access to the diagnostic directory on the Db2 server.
- **Required attacker capabilities/position**: The attacker needs to have database user-level access with `EXECUTE` privilege on the `PD_GET_DIAG_HIST` procedure and must also have access to the diagnostic directory on the Db2 server.