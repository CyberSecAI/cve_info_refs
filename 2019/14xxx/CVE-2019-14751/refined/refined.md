CVE-2019-14751 is a directory traversal vulnerability in NLTK Downloader before version 3.4.5.

- **Root cause:** The `_unzip_iter()` function in `nltk/downloader.py` extracts ZIP archives without proper validation of extraction paths, allowing an attacker to use a crafted ZIP archive with relative paths (e.g., `files/../../../../../tmp/evil.txt`) to write arbitrary files to the filesystem. This is also known as a "Zip Slip" vulnerability.
- **Weakness:** Lack of validation on extraction paths when unzipping archives.
- **Impact:** Attackers can write arbitrary files to locations on the filesystem where the user running NLTK Downloader has write access. This could lead to overwriting configuration files, executing malicious code, or gaining remote access. The impact is limited by the permissions of the user running the NLTK Downloader, so privilege escalation is not possible.
- **Attack vector:** A user must be tricked into downloading a malicious NLTK data package from a malicious or compromised server. The attacker needs to host a malicious `index.xml` and `zip-slip.zip` on a webserver and trick the user into configuring the NLTK downloader to use that server.
- **Required attacker capabilities/position:** The attacker needs a web server to host the malicious files and must convince the user to configure their NLTK downloader to use the attacker's server. The attacker doesn't need any privileges on the victim's machine.
- **Remediation:** Upgrade to NLTK version 3.4.5 or later. The fix involves replacing a block of code that manually created the directory structure and extracted files with `zf.extractall(root)`, which should handle path traversal issues correctly. A patch is available at: https://github.com/nltk/nltk/commit/f59d7ed8df2e0e957f7f247fe218032abdbe9a10