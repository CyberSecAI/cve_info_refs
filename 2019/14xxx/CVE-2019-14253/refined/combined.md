=== Content from github.com_f4e5af4b_20250120_233011.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmkz%2Fexploit%2Fblob%2Fmaster%2FPUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmkz%2Fexploit%2Fblob%2Fmaster%2FPUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kmkz%2Fexploit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kmkz](/kmkz)
/
**[exploit](/kmkz/exploit)**
Public

* [Notifications](/login?return_to=%2Fkmkz%2Fexploit) You must be signed in to change notification settings
* [Fork
  63](/login?return_to=%2Fkmkz%2Fexploit)
* [Star
   189](/login?return_to=%2Fkmkz%2Fexploit)

* [Code](/kmkz/exploit)
* [Issues
  0](/kmkz/exploit/issues)
* [Pull requests
  0](/kmkz/exploit/pulls)
* [Actions](/kmkz/exploit/actions)
* [Projects
  0](/kmkz/exploit/projects)
* [Wiki](/kmkz/exploit/wiki)
* [Security](/kmkz/exploit/security)
* [Insights](/kmkz/exploit/pulse)

Additional navigation options

* [Code](/kmkz/exploit)
* [Issues](/kmkz/exploit/issues)
* [Pull requests](/kmkz/exploit/pulls)
* [Actions](/kmkz/exploit/actions)
* [Projects](/kmkz/exploit/projects)
* [Wiki](/kmkz/exploit/wiki)
* [Security](/kmkz/exploit/security)
* [Insights](/kmkz/exploit/pulse)

## Files

 master
## Breadcrumbs

1. [exploit](/kmkz/exploit/tree/master)
/
# PUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/kmkz/exploit/commits/master/PUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt)120 lines (86 loc) · 5.03 KB master
## Breadcrumbs

1. [exploit](/kmkz/exploit/tree/master)
/
# PUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt

Top
## File metadata and controls

* Code
* Blame

120 lines (86 loc) · 5.03 KB[Raw](https://github.com/kmkz/exploit/raw/refs/heads/master/PUBLISURE-EXPLOIT-CHAIN-ADVISORY.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120######################################################################## From 0 to local Administrator (3 vulns) exploit-chain:## 1 - Improper access control (cwe-285) - pre-authenticated, from network# 2 - SQL injection (cwe-89) - Publisure admin access# 3 - Unrestricted file upload RCE (cwe-484) - local admin access on targeted server (default config/deployment)######################################################################### Publication date: September 05/2019## Author: # Bourbon Jean-Marie (@kmkz\_security) - Hacknowledge company## Product Homepage: # Source code download: N/A## Tested on : # version 2.1.2# ######################################################################
####################################################################### Improper Access Control ## CVSSv3: 7.2 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)# OVE ID: OVE-20190724-0002# CVE ID: CVE-2019-14253######################################################################## (Pre-Authenticated) Multiples SQL injection## CVSSv3: 8.2 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N)# OVE ID: OVE-20190724-0003# CVE ID: CVE-2019-14254######################################################################## Unrestricted File Upload RCE## CVSSv3: 9.1(CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)# OVE ID: OVE-20190724-0004# CVE ID: CVE-2019-14252######################################################################## Fixes:# Upgrade to latest product version and/or contact support for more information about patches###################################################################### I. PRODUCT
Publisure Hybrid mail is a highly efficient and cost effective alternative to traditional methods of producing and posting correspondence within an organization. The Publisure system can either be used for centralised, internal production within your existing facilities or alternatively, it can be implemented as a fully outsourced solution.
Note that this advisory is based on a version 2.1.2 which is a legacy version since a newer one was released.
II. ADVISORY
A combination of three different vulnerabilities permits an unauthenticated attacker to gain Administrator access on the server hosting Publisure application.
III. VULNERABILITIES DESCRIPTIONS
a) The first issue permits to bypass authentication mechanism allowing malicious person to perform query on PHP forms within the /AdminDir folder that should be restricted.
b) The second weakness is that SQL queries are not well sanitized resulting in multiple SQL injection in "userAccFunctions.php" functions.Using this two steps, an attacker can access passwords and/or grant access to user account "user" in order to become "Administrator" (for example).
c) Once successfully authenticated as an administrator, he is able to inject PHP backdoor by using "adminCons.php" form. This backdoor will then be stored in E:\PUBLISURE\webservice\webpages\AdminDir\Templates\ folder even if removed from "adminCons.php" view (permitting to hide the malicious PHP file).
IV. PROOF OF CONCEPT
a) Access to AdminDir PHP scripts and database querying is possible whithout authentication (ex: http://192.168.13.37/AdminDir/editUser.php?id=2)
b) Vulnerable URL example: http://192.168.13.37/AdminDir/editUser.php?id=sqli
"editUser.php" vulnerable code: $user = getUserDtails($\_GET['id']);
"userAccFunctions.php" vulnerable code example:
function getUserDtails($id) { global $db; //The reseller\_accounts table has been used to store department information since PDQit $Q = "SELECT a.username as username,a.contact\_firstname,a.contact\_lastname,a.email,r.company\_name, a.enabled, a.record\_id, a.password, a.unique\_identifier, a.reseller\_id, a.approval, a.resourceEditType, a.docView FROM accounts a, reseller\_accounts r WHERE r.record\_id = a.reseller\_id AND a.record\_id = $id"; $R = $db->query($Q); return $R;}
c) "adminCons.php" form permits to upload leading to RCE and allow attacker to hide malicious PHP code stored within "/AdminDir/Templates" folder (ex: http://192.168.13.37/AdminDir/Templates/tata.php?c=whoami)
V. RECOMMENDATIONS
a) Restrict access to administrative (and other) folder when non authenticated.
b) Prepare SQL query before execution using PDO to escape injections.
c) Check file type on file upload forms to prevent PHP code upload instead of templates.
 VI. TIMELINE July 23th, 2019: Vulnerability identificationJuly 30th, 2019: First contact with the editor (Publisure) and vulnerabilities acknowledgementAugust 13th, 2019: Contact to vendor to ask for fix - no replySeptember 04th, 2019: Vendor was informed 24h before public disclosureSeptember 05th, 2019: public disclosure after 45 days
VIII. LEGAL NOTICES The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.I accept no responsibility for any damage caused by the use or misuse of this advisory.
The applied disclosure policy is based on US CERT Responsible Disclosure Policy - https://www.us-cert.gov/vulnerability-disclosure-policy

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


