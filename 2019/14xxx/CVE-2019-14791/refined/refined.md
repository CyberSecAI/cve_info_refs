Based on the provided content, here's the breakdown of the vulnerability:

**Root cause of vulnerability:**

- The vulnerability stems from the lack of proper security checks in the `cpabc_appointments_save_edition()` function. This function allows any user, even those not logged in, to modify the plugin's settings for custom JavaScript and custom CSS. The function uses `update_option` to directly store base64 encoded user-provided content from the POST parameter "editionarea" into the database, with no sanitization beyond `stripcslashes`.

**Weaknesses/vulnerabilities present:**

- **Persistent Cross-Site Scripting (XSS):** By injecting malicious JavaScript code into the custom JavaScript setting through the vulnerable function, an attacker can execute arbitrary JavaScript code in the browsers of users who visit the website. This JavaScript code can then perform actions such as stealing cookies, redirecting to phishing sites, or modifying content.

**Impact of exploitation:**

- **Arbitrary JavaScript execution:** An attacker can execute malicious JavaScript code in the context of the user's browser when the affected page is visited, leading to various attacks, including:
    - Account hijacking (session hijacking)
    - Defacement of website
    - Redirection to malicious websites
    - Data theft
    - Other malicious actions.

**Attack vectors:**

- **Unauthenticated POST request:** An attacker can exploit this vulnerability by sending a crafted POST request to the `wp-admin/admin-post.php` endpoint with specific parameters that trigger the vulnerable code.
-  Specifically, the POST request must contain the parameters `CP_ABC_post_edition` , `cfwpp_edit` with a value of `js` or `css`, and `editionarea` containing the malicious JavaScript or CSS code.
- The attacker does not need to be logged into WordPress to perform this action.

**Required attacker capabilities/position:**

- The attacker needs to be able to send HTTP POST requests to the target website.
- No special privileges are needed.
- The attacker does not need an account on the WordPress site.

**Additional Information:**
- The `is_admin()` check in the code is misleading because it does not verify user roles. It only checks whether the request is for an admin page, and is thus bypassable by posting to `/wp-admin/admin-post.php`.
- The vulnerability was found in the Appointment Booking Calendar plugin by the Plugin Vulnerabilities team, who noted that they had previously identified other vulnerabilities in plugins from the same developer, Code People.
-  The provided proof of concept demonstrates how to inject a simple JavaScript alert, but more complex and malicious payloads can be injected.