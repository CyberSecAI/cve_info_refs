=== Content from www.pluginvulnerabilities.com_4d6ed7db_20250120_233343.html ===

[Login](https://www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://www.pluginvulnerabilities.com/product/subscription/)
  + [Set Up](https://www.pluginvulnerabilities.com/set-up/)
* [Why Plugin Vulnerabilities?](https://www.pluginvulnerabilities.com/why-plugin-vulnerabilities/)
  + [We Provide Fixes for Vulnerabilities](https://www.pluginvulnerabilities.com/we-provide-fixes-for-wordpress-plugin-vulnerabilities/)
  + [We Provide Accurate Vulnerability Information](https://www.pluginvulnerabilities.com/we-provide-accurate-information-on-the-affected-versions-of-vulnerable-wordpress-plugins/)
  + [Insightful Blocked Exploit Attempt Reporting](https://www.pluginvulnerabilities.com/insightful-blocked-exploit-attempt-reporting-from-a-wordpress-firewall-plugin/)
  + [How We Are Improving the Security of WordPress Plugins](https://www.pluginvulnerabilities.com/how-we-are-improving-the-security-of-wordpress-plugins/)
  + [Proactive Monitoring for Vulnerabilities in New Versions of WordPress Plugins](https://www.pluginvulnerabilities.com/proactive-monitoring-for-vulnerabilities-in-new-versions-of-wordpress-plugins/)
  + [Select Plugins to Receive Security Reviews](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/)
* Our Plugins
  + [Plugin Vulnerabilities Firewall](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)
  + [Lockdown Mode Plugin for WordPress](https://www.pluginvulnerabilities.com/lockdown-mode-plugin/)
  + [2FA for WooCommerce](https://www.pluginvulnerabilities.com/two-factor-authentication-2fa-for-woocommerce-plugin/)
* Other Services
  + [Plugin Security Review](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/)
  + [Continuous Plugin Security Review Service](https://www.pluginvulnerabilities.com/continuous-wordpress-plugin-security-review-service/)
  + [Theme Security Review](https://www.pluginvulnerabilities.com/wordpress-theme-security-review-service/)
  + [Hacked WordPress Website Cleanup](https://www.whitefirdesign.com/services/hacked-wordpress-website-cleanup.html)
  + [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html)
  + [Blue Hat Hacking Service for WordPress Plugins/Websites](https://www.pluginvulnerabilities.com/blue-hat-hacking-service-for-wordpress-plugins-websites/)
  + [Plugin Vulnerabilities Subscription for ClassicPress](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/)
  + [Plugin Vulnerabilities Daily Newsletter](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/)
  + [Solutions for Web Hosts](https://www.pluginvulnerabilities.com/solutions-for-web-hosts/)
  + [Solutions for Security Providers](https://www.pluginvulnerabilities.com/solutions-for-security-providers/)
* [Plugin Search](https://www.pluginvulnerabilities.com/plugin-search/)
  + [Search WooCommerce Plugins](https://www.pluginvulnerabilities.com/plugin-search/?woocommerce=)
  + [Search Elementor Plugins](https://www.pluginvulnerabilities.com/plugin-search/?elementor=)
* [Research](https://www.pluginvulnerabilities.com/blog/)
  + [Unfixed Security Issues in WordPress](https://www.pluginvulnerabilities.com/unfixed-security-issues-in-wordpress/)
  + [Latest WordPress News](https://www.pluginvulnerabilities.com/latest-wordpress-news/)
  + [Latest ClassicPress News](https://www.pluginvulnerabilities.com/latest-classicpress-news/)
  + [What WordPress Plugins Are No Longer Receiving Updates Through the WordPress Plugin Directory?](https://www.pluginvulnerabilities.com/2024/10/22/what-wordpress-plugins-are-no-longer-receiving-updates-through-the-wordpress-plugin-directory/)
  + [WordPress Firewall Plugin Protection Comparison](https://www.pluginvulnerabilities.com/wordpress-firewall-plugin-protection-comparison/)
  + [Security Advisories on WordPress Plugin Developers](https://www.pluginvulnerabilities.com/security-advisories-on-wordpress-plugin-developers/)
  + [Send us a Tip](https://www.pluginvulnerabilities.com/news-tip/)
* [About](https://www.pluginvulnerabilities.com/about/)
  + [WordPress Plugin Zero-Day Vulnerability Exploitation Info Sharing Partnership](https://www.pluginvulnerabilities.com/wordpress-plugin-zero-day-vulnerability-exploitation-info-sharing-partnership/)
  + [Get Free Help Fixing A Security Vulnerability In Your WordPress Plugin](https://www.pluginvulnerabilities.com/get-free-help-fixing-a-security-vulnerability-in-your-wordpress-plugin/)
  + [Contact Us](https://www.pluginvulnerabilities.com/contact/)
  + [Feedback](https://www.pluginvulnerabilities.com/feedback/)
  + [Report a WordPress Plugin Vulnerability We Are Missing](https://www.pluginvulnerabilities.com/report-a-vulnerability/)

30
Jul
2019

# Reflected Cross-Site Scripting (XSS) Vulnerability in WooCommerce Variation Swatches (Variation Swatches for WooCommerce)

The plugin [WooCommerce Variation Swatches (Variation Swatches for WooCommerce)](https://wordpress.org/plugins/woo-variation-swatches/) was closed on the WordPress Plugin Directory yesterday. That is one of the 1,000 most popular plugins with 60,000+ installs, so we were alerted to its closure. While we were looking in to the plugin to see if there were any vulnerabilities we should be warning users of the plugin that also use [our service](https://www.pluginvulnerabilities.com/product/subscription/), we found that it contains a reflected cross-site scripting (XSS) vulnerability.

The plugin’s admin page is made accessible to WordPress user with the “edit\_theme\_options” capability:

| ``` 92  ``` | ``` add_menu_page( $page_title, $menu_title, 'edit_theme_options', $this->slug, array( $this, 'settings_form' ), 'dashicons-admin-generic', 31 ); ``` |
| --- | --- |

add\_menu\_page( $page\_title, $menu\_title, 'edit\_theme\_options', $this->slug, array( $this, 'settings\_form' ), 'dashicons-admin-generic', 31 );

Though oddly the function that runs when accessing that first restricts access to users with a different capability, “manage\_options”:

| ``` 456 457 458 459  ``` | ``` public function settings_form() { 	if ( ! current_user_can( 'manage_options' ) ) { 		wp_die( __( 'You do not have sufficient permissions to access this page.' ) ); 	} ``` |
| --- | --- |

public function settings\_form() {
if ( ! current\_user\_can( 'manage\_options' ) ) {
wp\_die( \_\_( 'You do not have sufficient permissions to access this page.' ) );
}

Normally only Administrators would have either of those.

In that function the function last\_tab\_input() is called:

| ``` 493  ``` | ``` $this->last_tab_input(); ``` |
| --- | --- |

$this->last\_tab\_input();

That will output the result of another function, get\_last\_active\_tab(), without escaping it:

| ``` 501 502 503  ``` | ``` private function last_tab_input() { 	printf( '<input type="hidden" id="_last_active_tab" name="%s[_last_active_tab]" value="%s">', $this->settings_name, $this->get_last_active_tab() ); } ``` |
| --- | --- |

private function last\_tab\_input() {
printf( '<input type="hidden" id="\_last\_active\_tab" name="%s[\_last\_active\_tab]" value="%s">', $this->settings\_name, $this->get\_last\_active\_tab() );
}

That function in turn will return the value of the GET input “tab” if exists, without validating, sanitizing or escaping it:

| ``` 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548  ``` | ``` private function get_last_active_tab() {   	$last_tab = trim( $this->get_option( '_last_active_tab' ) );   	if ( isset( $_GET[ 'tab' ] ) && ! empty( $_GET[ 'tab' ] ) ) { 		$last_tab = trim( $_GET[ 'tab' ] ); 	}   	$default_tab = ''; 	foreach ( $this->fields as $tabs ) { 		if ( isset( $tabs[ 'active' ] ) && $tabs[ 'active' ] ) { 			$default_tab = $tabs[ 'id' ]; 			break; 		} 	}   	return ! empty( $last_tab ) ? $last_tab : $default_tab;   } ``` |
| --- | --- |

private function get\_last\_active\_tab() {
$last\_tab = trim( $this->get\_option( '\_last\_active\_tab' ) );
if ( isset( $\_GET[ 'tab' ] ) && ! empty( $\_GET[ 'tab' ] ) ) {
$last\_tab = trim( $\_GET[ 'tab' ] );
}
$default\_tab = '';
foreach ( $this->fields as $tabs ) {
if ( isset( $tabs[ 'active' ] ) && $tabs[ 'active' ] ) {
$default\_tab = $tabs[ 'id' ];
break;
}
}
return ! empty( $last\_tab ) ? $last\_tab : $default\_tab;
}

So an attacker who could get an Administrator to visit a URL they generated with malicious JavaScript code in the “tab” parameter could cause the malicious JavaScript to be loaded on the page. Major web browser other than Firefox include XSS filtering that will limit the ability for that code to run, combined with the targeted nature of this type of attack, at this time hackers are not trying to exploit this type of vulnerability on a wide scale.

## Full Disclosure

Due to the moderators of the WordPress Support Forum’s [continued inappropriate behavior](https://www.pluginvulnerabilities.com/2019/05/17/wordpress-support-forum-moderator-jan-dembowski-gets-in-the-way-of-people-dealing-with-hacks-due-to-wp-live-chat-support/) we are [full disclosing vulnerabilities in protest until WordPress gets that situation cleaned up](https://www.pluginvulnerabilities.com/2018/09/25/our-new-disclosure-policy-in-response-to-the-continued-inappropriate-behavior-of-the-wordpress-support-forum-moderators/), so we are releasing this post and then leaving a message about that for the developer through the WordPress Support Forum. You can notify the developer of this issue on the forum as well. Hopefully the moderators will finally see the light and clean up their act soon, so these full disclosures will no longer be needed (we hope they end soon). You would think they would have already done that, but considering that they believe that having plugins, which have millions installs, remain in the Plugin Directory [despite them knowing they are vulnerable is “appropriate action”](https://www.pluginvulnerabilities.com/2019/04/22/wordpress-believes-that-leaving-millions-of-installs-of-plugins-vulnerable-to-publicly-known-vulnerabilities-is-appropriate-action/), something is very amiss with them (which is even more reason the moderation needs to be cleaned up).

**Update:**To clear up the confusion where developers claim we hadn’t tried to notify them through the Support Forum (while at the same time moderators are complaining about us doing just that), here is the message we left for this vulnerability:

[![](https://www.pluginvulnerabilities.com/wp-content/uploads/2019/07/woo-variation-swatches-notifications.png)](https://www.pluginvulnerabilities.com/wp-content/uploads/2019/07/woo-variation-swatches-notifications.png)

## Is It Fixed?

If you are reading this post down the road the best way to find out if this vulnerability or other WordPress plugin vulnerabilities in plugins you use have been fixed is to sign up for [our service](https://www.pluginvulnerabilities.com/product/subscription/), since what we uniquely do when it comes to that type of data is to test to see if vulnerabilities have really been fixed. Relying on the developer’s information, can lead you astray, as we often find that they believe they have fixed vulnerabilities, but have failed to do that.

## Proof of Concept

The following proof of concept will cause any available cookies to be shown in an alert box, when logged in as an Administrator. Major web browsers other than Firefox provide XSS filtering, so this proof of concept will not work in those web browsers.

Make sure to replace “[path to WordPress]” with the location of WordPress.

```
http://[path to WordPress]/wp-admin/admin.php?page=woo-variation-swatches-settings&tab="><script>alert(document.cookie);</script>
```

No related posts.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).

---

### Need Continued Support for a Closed Plugin?

Does your website depend on a WordPress plugin that is no longer being supported by the original developer? With our [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html), we can maintain the plugin for you, so you can safely use the plugin going forward.
[Plugin Vulnerabilities](https://www.pluginvulnerabilities.com)
Posted in [Closed Plugins](https://www.pluginvulnerabilities.com/category/closed-plugins/), [Vulnerability Report](https://www.pluginvulnerabilities.com/category/vulnerability-report/)
[Closed Plugins](https://www.pluginvulnerabilities.com/tag/closed-plugins/), [Reflected Cross-Site Scripting (XSS)](https://www.pluginvulnerabilities.com/tag/reflected-cross-site-scripting-xss/), [Variation Swatches for WooCommerce](https://www.pluginvulnerabilities.com/tag/variation-swatches-for-woocommerce/), [Vulnerability Report](https://www.pluginvulnerabilities.com/tag/vulnerability-report/), [WooCommerce Variation Swatches](https://www.pluginvulnerabilities.com/tag/woocommerce-variation-swatches/)
[Leave a comment](https://www.pluginvulnerabilities.com/2019/07/30/reflected-cross-site-scripting-xss-vulnerability-in-woocommerce-variation-swatches/#respond)

# Post navigation

### Leave a Reply [Cancel reply](/2019/07/30/reflected-cross-site-scripting-xss-vulnerability-in-woocommerce-variation-swatches/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### What WordPress Security issue do you need help with today?

Protecting Your WordPress Websites

Cleaning Up Hacked WordPress Websites

Ensuring WordPress Websites are Secure

Fixing a Vulnerable WP Plugin You Use

Ensuring a WordPress Plugin is Secure

Maintenance for Abandoned WP Plugin

Ensuring a WordPress Theme is Secure

Protecting Your Customers’ Websites

Fixing a Vulnerable Plugin You Develop

How Many Websites Do You Have?
1
2-10
11+

How Critical is it That Your Website Remain Secure?
Low
Medium
High

or

### Latest WordPress Plugin Security Scorecard Grades

* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/meta-box)[Meta Box](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=meta-box)     B
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/fluent-smtp)[FluentSMTP](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=fluent-smtp)     D+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/wp-simple-firewall)[Shield](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=wp-simple-firewall)     F
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/ninjafirewall)[NinjaFirewall (WP Editio...](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=ninjafirewall)     D
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/gravity-forms-pdf-extended)[Gravity PDF](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=gravity-forms-pdf-extended)     C
* [See More Recent Grades](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?results=recent)
* [Check Another Plugin](https://www.pluginvulnerabilities.com/plugin-security-scorecard/)
* [Jetpack vs WPScan](/plugin-security-scorecard/?slug=jetpack&vs=wpscan)
### Latest News

* [300,000 Install WordPress Plugin That Hasn’t Updated Insecure Library in 21 Months Claims Patchstack Ensures the Plugin is Secure](https://www.pluginvulnerabilities.com/2025/01/17/300000-install-wordpress-plugin-that-hasnt-updated-insecure-library-in-21-months-claims-patchstack-ensures-the-plugin-is-secure/)
* [Two-Factor Authentication (2FA) Won’t Stop an Attacker From Using Their Own WordPress Account to Engage in Malicious Activity](https://www.pluginvulnerabilities.com/2025/01/17/two-factor-authentication-2fa-wont-stop-an-attacker-from-using-their-own-wordpress-account-to-engage-in-malicious-activity/)
* [1+ Million Install WordPress Plugin Has Been Using an Outdated Known Insecure Version of a Library For Nearly 3 Years](https://www.pluginvulnerabilities.com/2025/01/16/1-million-install-wordpress-plugin-has-been-using-an-outdated-known-insecure-version-of-a-library-for-nearly-3-years/)
### Follow Us

* [Google News](https://news.google.com/publications/CAAqBwgKMNaxwAsw6MzXAw)
* [Bluesky](https://bsky.app/profile/pluginvulns.bsky.social)
* [RSS](https://www.pluginvulnerabilities.com/category/news/feed/)
### Latest Plugin Security Reviews

* [WordPress Plugin Security Review: WP API Privacy](https://www.pluginvulnerabilities.com/2024/11/18/wordpress-plugin-security-review-wp-api-privacy/)
* [WordPress Plugin Security Review: Two Factor](https://www.pluginvulnerabilities.com/2024/09/17/wordpress-plugin-security-review-two-factor/)
* [WordPress Plugin Security Review: Download Monitor](https://www.pluginvulnerabilities.com/2024/09/06/wordpress-plugin-security-review-download-monitor/)

Powered by WordPress and WooCommerce

© 2016-2025 [White Fir Design LLC](http://www.whitefirdesign.com/) | [Privacy Policy](/privacy-policy/)
 Fruitful theme by [fruitfulcode](http://fruitfulcode.com)

[↑](#top "Back to top")

![](https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)


