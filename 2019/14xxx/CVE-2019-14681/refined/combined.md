=== Content from wordpress.org_7d35fc73_20250120_232731.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Deny All Firewall

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdeny-all-firewall&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdeny-all-firewall&locale=en_US)

Search plugins

![](https://ps.w.org/deny-all-firewall/assets/banner-772x250.jpg?rev=3150585)
![](https://ps.w.org/deny-all-firewall/assets/icon-256x256.jpg?rev=3150585)
# Deny All Firewall

By [Webd Ltd](https://webd.uk)

[Download](https://downloads.wordpress.org/plugin/deny-all-firewall.1.8.2.zip)

* [Details](https://wordpress.org/plugins/deny-all-firewall/#description)
* [Reviews](https://wordpress.org/plugins/deny-all-firewall/#reviews)
* [Installation](https://wordpress.org/plugins/deny-all-firewall/#installation)
* [Development](https://wordpress.org/plugins/deny-all-firewall/#developers)

[Support](https://wordpress.org/support/plugin/deny-all-firewall/)

## Description

#### Deny All Firewall

This plugin examines your WordPress installation and injects rules into your .htaccess file which completely block access to everything *except* genuine site content.

Doing so reduces load on your server, prevents hackers from scanning your site for exploits and even reduces the carbon footprint of your site! **We estimate that this plugin will reduce the amount of CO2 used by an average WordPress site by 100Kg per year which is equivalent to the carbon footprint of a flight from London to Ibiza**!

Blocked requests can be logged and whitelisted to fine tune your firewall to your specific website.

Whitelisted requests can be 301 redirected to another web address.

The plugin monitors for content changes and will alert users if changes are detected and rules need to be refreshed.

There is a “Lock Down” feature which blocks **all** requests with Query Strings or POST data. This is how SQL / PHP injection, XSS and other attacks are implemented but it is also how some themes and plugins talk to your server so may require some requests to be whitelisted for your site.

There is a “Sitemap” feature which autmatically generates an XML sitemap and lets search engines find it through a robots.txt file. This sitemap is more detailed than the one automatically generated by WordPress.

There is an “Allow All Content” feature for sites with way too much content to list in the .htaccess file.

There is an “Allow All IPs” feature for sites with too many users to list all their IP addresses in the .htaccess file.

There is a “Force SSL” feature for sites with an SSL certificate to force visitors to use HTTPS rather than HTTP.

Prevents WordPress version from being shown in and /feed/ meta.

Currently we only support Apache servers but will be looking to include Nginx in the future.

Please contact us through the support forum to let us know immediately if the plugin blocks anything that it shouldn’t do!

## Installation

Easily use this plugin to prevent access to everyting except your site’s content using the .htaccess file …

1) Install “Deny All Firewall” automatically or by uploading the ZIP file.

2) Activate the plugin through the “Plugins” menu in WordPress.

3) From the Dashboard, select “Deny All Firewall” from the “Settings” menu.

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“Deny All Firewall” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/4807bba73ab7f4c9a1d97dd70bddaf25e6dc841765b3b3ce906ff75c3857d104?s=32&d=mm&r=g)

[Translate “Deny All Firewall” into your language.](https://translate.wordpress.org/projects/wp-plugins/deny-all-firewall)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/deny-all-firewall/), check out the [SVN repository](https://plugins.svn.wordpress.org/deny-all-firewall/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/deny-all-firewall/) by [RSS](https://plugins.trac.wordpress.org/log/deny-all-firewall/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.8.2

* Added support for .avif images

#### 1.8.1

* Enabled whitelist for WooCommerce API “wc-api”

#### 1.8.0

* Added support for “Merge + Minify + Refresh” plugin to serve gzip compressed CSS and JS files

#### 1.7.9

* Minor security fixes for string translations

#### 1.7.8

* General housekeeping

#### 1.7.7

* Updated link to Yoast! sitemap option, fixed bug with anchor tags in 301 redirects, added .webp to allowed image types and allowed date archives

#### 1.7.6

* Fixed a bug that prevented Authors and Editors from refreshing the firewall rules

#### 1.7.5

* Added .map to allowed filetypes in /wp-content/uploads/ and /wp-content/plugins/
* Prevent showing of WordPress version in and /feed/ meta

#### 1.7.4

* Added XLS, XLSX, WOFF, WOFF2, TTF and OFT to allowed filetypes in /wp-content/uploads/

#### 1.7.3

* Prevent server callbacks from refreshing .htaccess

#### 1.7.2

* Fix bug where Site Health check blocks the current user

#### 1.7.1

* Permanent fix for mystery .htaccess RewriteRule bug

#### 1.7.0

* Temporary fix for mystery .htaccess RewriteRule bug

#### 1.6.9

* Allowed for the omission of trailing slashes

#### 1.6.8

* Preparing for WordPress v6.0

#### 1.6.7

* Bug fix to allow pages of search
* Bug fix to allow “\_” in content slugs
* Bug fix to allow the use of (.\*) wildcards in whitelist redirects

#### 1.6.6

* Fixed a bug whereby sitemap was disabled when already enabled on settings update

#### 1.6.5

* Fixed a bug when .htaccess cannot be opened
* Fixed a bug to enable server ipv6 detection

#### 1.6.4

* Fixed a bug retrieving server IP adddress
* Removed all PHP short tags

#### 1.6.2

* Fixed a bug with current user IP address check

#### 1.6.0

* Added a check to redirect to the login page if a logged in user’s IP changes

#### 1.5.9

* Fixed a bug on some systems that causes infinite redirects with Force SSL option

#### 1.5.8

* Added ability to change the content of the “403 Forbidden” page and added a search facility

#### 1.5.7

* Removed WP CRON event to auto-refresh firewall rules as this causes issue with Cloudflare

#### 1.5.6

* Added support for IPv6 server IP and WordPress search queries

#### 1.5.5

* Added Yoast SEO detection to prevent XML Sitemap conflicts

#### 1.5.4

* Bug fix

#### 1.5.3

* Allow custom post type preview when using lock down feature

#### 1.5.2

* Added .mpg and .m4a to /wp-content/uploads/ whitelist
* Fixed bug to allow WPBakery Page Builder to edit pages when “Allow All IPs” is selected

#### 1.5.1

* Added support for the new sitemap XSL file in WordPress v5.5

#### 1.5.0

* Added “Force SSL” option

#### 1.4.9

* Bug fixes

#### 1.4.8

* Fixed a bug with “lock down” feature when running WooCommerce

#### 1.4.7

* Fixed bugs with “lock down” feature when running WooCommerce

#### 1.4.6

* Block requests with no HTTP\_HOST

#### 1.4.5

* Bug fixes

#### 1.4.4

* Added options to allow all content and / or IPs

#### 1.4.3

* Deactivation now uninstalls plugin changes, bug fix

#### 1.4.2

* Added “Refresh Firewall Rules” button to editor, bug fixes

#### 1.4.1

* Bug fixes

#### 1.4.0

* Refresh firewall rules from the admin notice
* Prevent caching of 403 page
* Compatibility when WordPress installed in a sub directory
* Bug fixes

#### 1.3.9

* Autodetect if comments are open on any posts and allow through the firewall
* Bug fixes

#### 1.3.8

* Fixed bug when the server’s external IP cannot be established

#### 1.3.7

* Fixed bug with “Administration email verification”

#### 1.3.6

* Locked down /wp-json/ POST requests

#### 1.3.5

* Bug fixes

#### 1.3.4

* Bug fixes

#### 1.3.3

* Allowed wp-json through POST block
* Bug fix

#### 1.3.2

* Added new “Sitemap” feature
* Bug fixes

#### 1.3.1

* Added new “Lock Down” feature
* Removed un-necessary options
* Bug fixes

#### 1.3.0

* Added delete checkbox to Whitelist
* Bug fix

#### 1.2.9

* Refined content change monitoring
* Bug fixes

#### 1.2.8

* Added the ability to 301 redirect whitelisted requests
* Made the 403 page more user friendly

#### 1.2.7

* Refined content change monitoring
* Unblocked .png from /wp-includes/

#### 1.2.6

* Modified the blocked request logging to be more compatible with different servers

#### 1.2.5

* Unblock /wp-json/wp/v2/users for logged in users as it is used when editing posts in Gutenberg

#### 1.2.4

* Option to automatically refresh the firewall rules if content changes have been detected
* Option to show content changed notices on all pages or just the settings page
* Whitelisted .gif in /wp-content/

#### 1.2.3

* Notifications shown when site content has changed

#### 1.2.2

* Made whitelisted font filetypes consistent
* Whitelisted Google verification files
* Bug fixes

#### 1.2.1

* Whitelisted .bmp files from /wp-content/uploads/
* Compatibility fixes for older PHP and WordPress installations

#### 1.2.0

* Updated log file analyses to include existing directory detection
* Minor bug fix

#### 1.1.9

* Minor bug fixes

#### 1.1.8

* Updated 403 page
* Updated log file analysis
* Minor bug fixes

#### 1.1.7

* CSRF vulnerability fixed

#### 1.1.6

* Added more whitelisted filetypes to wp-content
* Fixed a problem with WooCommerce /checkout/order-received/
* Made whitelisted requests more secure

#### 1.1.5

* Added more whitelisted filetypes to wp-includes, wp-admin and wp-content

#### 1.1.4

* Added “Whitelist” / “Unblock” feature

#### 1.1.3

* Unblocked inactive theme screenshot.png
* Show if blocked requests exist in log file

#### 1.1.2

* Unblocked paginated taxonomies
* Started adding notes to logged blocked requests

#### 1.1.1

* Bug fixes

#### 1.1.0

* Blocks user sniffing

#### 1.0.9

* Created an option to turn on log

#### 1.0.8

* Bug fix

#### 1.0.7

* Settings page now shows top twenty blocked requests

#### 1.0.6

* Unblocked and secured WP-Cron
* Started logging blocked requests

#### 1.0.5

* Created a custom 403 page

#### 1.0.4

* Display status of server’s external IP

#### 1.0.3

* Locates server’s external IP address and whitelists it for /wp-admin/

#### 1.0.2

* /wp-admin/ unblocked for logged in client IP now works with Cloudflare

#### 1.0.1

* Bug fixes

#### 1.0.0

* First version of the plugin

## Meta

* Version **1.8.2**
* Last updated **3 months ago**
* Active installations **80+**
* WordPress version **4.7.0 or higher**
* Tested up to **6.7.1**
* PHP version **5.6 or higher**
* Tags [carbon footprint](https://wordpress.org/plugins/tags/carbon-footprint/)[firewall](https://wordpress.org/plugins/tags/firewall/)[Green](https://wordpress.org/plugins/tags/green/)[htaccess](https://wordpress.org/plugins/tags/htaccess/)
* [Advanced View](https://wordpress.org/plugins/deny-all-firewall/advanced/)

## Ratings

No reviews have been submitted yet.

[Add my review](https://wordpress.org/support/plugin/deny-all-firewall/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/deny-all-firewall/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/4807bba73ab7f4c9a1d97dd70bddaf25e6dc841765b3b3ce906ff75c3857d104?s=32&d=mm&r=g)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/deny-all-firewall/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://webd.uk/product/support-us/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.pluginvulnerabilities.com_4759fb54_20250120_232736.html ===

[Login](https://www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://www.pluginvulnerabilities.com/product/subscription/)
  + [Set Up](https://www.pluginvulnerabilities.com/set-up/)
* [Why Plugin Vulnerabilities?](https://www.pluginvulnerabilities.com/why-plugin-vulnerabilities/)
  + [We Provide Fixes for Vulnerabilities](https://www.pluginvulnerabilities.com/we-provide-fixes-for-wordpress-plugin-vulnerabilities/)
  + [We Provide Accurate Vulnerability Information](https://www.pluginvulnerabilities.com/we-provide-accurate-information-on-the-affected-versions-of-vulnerable-wordpress-plugins/)
  + [Insightful Blocked Exploit Attempt Reporting](https://www.pluginvulnerabilities.com/insightful-blocked-exploit-attempt-reporting-from-a-wordpress-firewall-plugin/)
  + [How We Are Improving the Security of WordPress Plugins](https://www.pluginvulnerabilities.com/how-we-are-improving-the-security-of-wordpress-plugins/)
  + [Proactive Monitoring for Vulnerabilities in New Versions of WordPress Plugins](https://www.pluginvulnerabilities.com/proactive-monitoring-for-vulnerabilities-in-new-versions-of-wordpress-plugins/)
  + [Select Plugins to Receive Security Reviews](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/)
* Our Plugins
  + [Plugin Vulnerabilities Firewall](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)
  + [Lockdown Mode Plugin for WordPress](https://www.pluginvulnerabilities.com/lockdown-mode-plugin/)
  + [2FA for WooCommerce](https://www.pluginvulnerabilities.com/two-factor-authentication-2fa-for-woocommerce-plugin/)
* Other Services
  + [Plugin Security Review](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/)
  + [Continuous Plugin Security Review Service](https://www.pluginvulnerabilities.com/continuous-wordpress-plugin-security-review-service/)
  + [Theme Security Review](https://www.pluginvulnerabilities.com/wordpress-theme-security-review-service/)
  + [Hacked WordPress Website Cleanup](https://www.whitefirdesign.com/services/hacked-wordpress-website-cleanup.html)
  + [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html)
  + [Blue Hat Hacking Service for WordPress Plugins/Websites](https://www.pluginvulnerabilities.com/blue-hat-hacking-service-for-wordpress-plugins-websites/)
  + [Plugin Vulnerabilities Subscription for ClassicPress](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/)
  + [Plugin Vulnerabilities Daily Newsletter](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/)
  + [Solutions for Web Hosts](https://www.pluginvulnerabilities.com/solutions-for-web-hosts/)
  + [Solutions for Security Providers](https://www.pluginvulnerabilities.com/solutions-for-security-providers/)
* [Plugin Search](https://www.pluginvulnerabilities.com/plugin-search/)
  + [Search WooCommerce Plugins](https://www.pluginvulnerabilities.com/plugin-search/?woocommerce=)
  + [Search Elementor Plugins](https://www.pluginvulnerabilities.com/plugin-search/?elementor=)
* [Research](https://www.pluginvulnerabilities.com/blog/)
  + [Unfixed Security Issues in WordPress](https://www.pluginvulnerabilities.com/unfixed-security-issues-in-wordpress/)
  + [Latest WordPress News](https://www.pluginvulnerabilities.com/latest-wordpress-news/)
  + [Latest ClassicPress News](https://www.pluginvulnerabilities.com/latest-classicpress-news/)
  + [What WordPress Plugins Are No Longer Receiving Updates Through the WordPress Plugin Directory?](https://www.pluginvulnerabilities.com/2024/10/22/what-wordpress-plugins-are-no-longer-receiving-updates-through-the-wordpress-plugin-directory/)
  + [WordPress Firewall Plugin Protection Comparison](https://www.pluginvulnerabilities.com/wordpress-firewall-plugin-protection-comparison/)
  + [Security Advisories on WordPress Plugin Developers](https://www.pluginvulnerabilities.com/security-advisories-on-wordpress-plugin-developers/)
  + [Send us a Tip](https://www.pluginvulnerabilities.com/news-tip/)
* [About](https://www.pluginvulnerabilities.com/about/)
  + [WordPress Plugin Zero-Day Vulnerability Exploitation Info Sharing Partnership](https://www.pluginvulnerabilities.com/wordpress-plugin-zero-day-vulnerability-exploitation-info-sharing-partnership/)
  + [Get Free Help Fixing A Security Vulnerability In Your WordPress Plugin](https://www.pluginvulnerabilities.com/get-free-help-fixing-a-security-vulnerability-in-your-wordpress-plugin/)
  + [Contact Us](https://www.pluginvulnerabilities.com/contact/)
  + [Feedback](https://www.pluginvulnerabilities.com/feedback/)
  + [Report a WordPress Plugin Vulnerability We Are Missing](https://www.pluginvulnerabilities.com/report-a-vulnerability/)

21
Jun
2019

# Cross-Site Request Forgery (CSRF) Vulnerability in Deny All Firewall

It is a continuing bad sign for the overall security of WordPress plugins that so many [security plugins have security vulnerabilities of their own](https://www.pluginvulnerabilities.com/tag/security-vulnerability-in-security-plugin/). We ran across one such plugin, [Deny All Firewall](https://wordpress.org/plugins/deny-all-firewall/), due to our monitoring of changelog entries of plugins to keep customer of [our service](https://www.pluginvulnerabilities.com/product/subscription/) aware of vulnerabilities that were or are in the plugins they use. The plugin is described as:

> This plugin examines your WordPress installation and allows you to inject rules into your .htaccess file which completely block access to everything *except* genuine site content.

In checking over it a bit we found a number of issues, from storing a log file in a way that anyone can access it, to the logging capability possibly being insecure, but we didn’t check further on that since part of it wasn’t working right. What we did confirm was that it would be possible for an attacker to cause Administrators to disable the plugin’s functionality without intending it, which is referred to as cross-site request forgery (CSRF).

The plugin registers it’s settings page to be accessible to WordPress users with the “manage\_options” capability, so Administrators:

| ``` 55  ``` | ``` add_options_page('Deny All Firewall Settings','Deny All Firewall', 'manage_options', 'daf_settings', array($this, 'daf_settings_page')); ``` |
| --- | --- |

add\_options\_page('Deny All Firewall Settings','Deny All Firewall', 'manage\_options', 'daf\_settings', array($this, 'daf\_settings\_page'));

Access that page will cause the function daf\_settings\_page() in the file /deny-all-firewall.php to run. In that function is this code:

| ``` 152 153 154  ``` | ``` if (isset($_GET['daf_remove']) && $_GET['daf_remove'] == 'true') {   	if ($this->daf_remove_rules()) { ``` |
| --- | --- |

if (isset($\_GET['daf\_remove']) && $\_GET['daf\_remove'] == 'true') {
if ($this->daf\_remove\_rules()) {

With that code, if the GET input “daf\_remove” is set to “true” the function daf\_remove\_rules() runs and the plugin’s functionality is disabled. What is missing there is a nonce check to prevent cross-site request forgery (CSRF) protection, so an attacker could cause a logged in Administrator to send a request that does that without the Administrator intending to disable the functionality.

Due to the moderators of the WordPress Support Forum’s [continued inappropriate behavior](https://www.pluginvulnerabilities.com/2019/05/17/wordpress-support-forum-moderator-jan-dembowski-gets-in-the-way-of-people-dealing-with-hacks-due-to-wp-live-chat-support/) we are [full disclosing vulnerabilities in protest until WordPress gets that situation cleaned up](https://www.pluginvulnerabilities.com/2018/09/25/our-new-disclosure-policy-in-response-to-the-continued-inappropriate-behavior-of-the-wordpress-support-forum-moderators/), so we are releasing this post and then leaving a message about that for the developer through the WordPress Support Forum. You can notify the developer of this issue on the forum as well. Hopefully the moderators will finally see the light and clean up their act soon, so these full disclosures will no longer be needed (we hope they end soon). You would think they would have already done that, but considering that they believe that having plugins, which have millions installs, remain in the Plugin Directory [despite them knowing they are vulnerable is “appropriate action”](https://www.pluginvulnerabilities.com/2019/04/22/wordpress-believes-that-leaving-millions-of-installs-of-plugins-vulnerable-to-publicly-known-vulnerabilities-is-appropriate-action/), something is very amiss with them (which is even more reason the moderation needs to be cleaned up).

**Update:**To clear up the confusion where developers claim we hadn’t tried to notify them through the Support Forum (while at the same time moderators are complaining about us doing just that), here is the message we left for this vulnerability:

[![](https://www.pluginvulnerabilities.com/wp-content/uploads/2019/06/deny-all-firewall-notification.png)](https://www.pluginvulnerabilities.com/wp-content/uploads/2019/06/deny-all-firewall-notification.png)

## Is It Fixed?

If you are reading this post down the road the best way to find out if this vulnerability or other WordPress plugin vulnerabilities in plugins you use have been fixed is to sign up for [our service](https://www.pluginvulnerabilities.com/product/subscription/), since what we uniquely do when it comes to that type of data is to test to see if vulnerabilities have really been fixed. Relying on the developer’s information, can lead you astray, as we often find that they believe they have fixed vulnerabilities, but have failed to do that.

## Proof of Concept

The following proof of concept will disable the plugn’s functinality, when logged in to WordPress.

Make sure to replace “[path to WordPress]” with the location of WordPress.

```
http://[path to WordPress]/wp-admin/options-general.php?page=daf_settings&daf_remove=true
```

No related posts.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).
[Plugin Vulnerabilities](https://www.pluginvulnerabilities.com)
Posted in [Vulnerability Report](https://www.pluginvulnerabilities.com/category/vulnerability-report/)
[Cross-Site Request Forgery (CSRF)](https://www.pluginvulnerabilities.com/tag/cross-site-request-forgery-csrf/), [Deny All Firewall](https://www.pluginvulnerabilities.com/tag/deny-all-firewall/), [Security Vulnerability in Security Plugin](https://www.pluginvulnerabilities.com/tag/security-vulnerability-in-security-plugin/), [Vulnerability Report](https://www.pluginvulnerabilities.com/tag/vulnerability-report/)
[6 Comments](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comments)

# Post navigation

## 6 thoughts on “Cross-Site Request Forgery (CSRF) Vulnerability in Deny All Firewall”

1. ![](https://secure.gravatar.com/avatar/23a9a17ff5fead95d96d506c2753db22?s=60&d=mm&r=g)

   [Oliver Campion](https://webd.uk) -
   [June 25, 2019 at 1:29 am](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13664)

   Firstly (and most importantly), thank you “Plugin Vulnerabilities” for indirectly alerting us to this bug in our plugin.

   As you’ve mentioned, the plugin completely locks down a WordPress site so as to only serve content that exists rather than to allow hackers to scan a site for exploits (such as the one you have so proudly discovered).

   We were alerted to this issue by WordPress Plugin Support on Saturday 22nd, giving hackers a full 24 hours head start on us to make use of the issue since you failed to notify us before publishing this post.

   Luckily for the users of our plugin the exploit you have discovered would only turn off the plugins capabilities and wouldn’t cause WordPress to be compromised on its own; and we immediately released a fix.

   In future, we hope that you contact plugin developers directly when you locate future issues so that they are able to create a fix before you carelessly tell the world how clever you are.

   Please note that we have tried to contact yourselves via the contact form on your website prior to leaving this comment and would like you to comment further on …

   “In checking over it a bit we found a number of issues, from storing a log file in a way that anyone can access it, to the logging capability possibly being insecure.”

   … since …

   a) The log file is not accessible when the firewall is enabled

   b) When the firewall is disabled, the log file is not created

   c) The log file entires are JSON encoded

   So, over to you 🙂

   Once again, thank you so much for your interest in our plugin. We feel that we have created something quite revolutionary and our clients who use it are already benefiting from decreased use of server resources and comfort that hackers continued efforts have been thwarted before they commence.

   Kind regards,

   Oliver

   [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13664#respond)

   * ![](https://secure.gravatar.com/avatar/43d3d05e8661efc480320db4edd33bb6?s=60&d=mm&r=g)

     Plugin Vulnerabilities -
     [June 25, 2019 at 10:30 am](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13684)

     First off, you are making a lot of claims about your plugin that seem highly overstated at best and you are providing no evidence to support any of that, while claims like that call for strong evidence, preferably from independent testing. Considering how insecure the plugin has been, it seem unlikely that you really understand what you are trying to provide.

     If you actually read our post you would have seen that the WordPress team actually caused you to be alerted after our disclosure. If you are going to criticize someone you might to know what you are talking about first. Also, the vulnerabilities already existed in the plugin, so our disclosure isn’t the problem, it is the vulnerabilities, which shouldn’t exist in a “quite revolutionary” security plugin.

     We got your message, but haven’t hard time to get back to you since we are busy working on things for our customers, but quickly you don’t claim that the log file is not accessible if the firewall is not enabled. Also JSON encoding the file doesn’t deal with sanitization and escaping when using the data.

     [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13684#respond)
3. ![](https://secure.gravatar.com/avatar/23a9a17ff5fead95d96d506c2753db22?s=60&d=mm&r=g)

   [Oliver Campion](http://webd.uk) -
   [June 26, 2019 at 2:15 am](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13687)

   Thanks for your reply.

   Claiming the plugin to be \*so\* insecure when in fact it was a minor flaw that would only have disabled its own capabilities (and only if a user with administrator access clicked on a malicious link) is \*very\* dramatic.

   To quote WordPress support “Strictly speaking, even calls to SERVER should be sanitized … however we do not require that, as they are considerably harder to leverage.” Despite this, we are still going to implement $\_SERVER sanitisation. And again, the log file isn’t created if the plugin isn’t enabled.

   On the other hand (seeing as you would like evidence) lets take a look at what the plugin could do for your own website 🙂

   A very brief look finds the following …

   – Users exposed … you currently allow hackers to see your usernames (whitefirdesign) and seeing as your login page is wide open this isn’t very good at all <https://www.pluginvulnerabilities.com/wp-login.php> (we have another plugin, block-wp-login that you might want to use for that)

   – Theme PHP exposed … <https://www.pluginvulnerabilities.com/wp-content/content.php>

   – Plugin readme.txt exposed … <https://www.pluginvulnerabilities.com/wp-content/plugins/fruitful-shortcodes/readme.txt>

   – Entire wp-content PHP exposed

   Unfortunately, the plugin couldn’t do anything about you publicly displaying your WordPress version at the bottom of your theme but there’s only so much you can do with .htaccess 🙂

   Now you will notice that you have the ability to sort out your own back yard before you make this comment public. Which isn’t a luxury you allowed us. Let’s hope you have the time to fix your site and the confidence to allow this post to be put public.

   Kind regards,

   Oliver

   [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13687#respond)

   * ![](https://secure.gravatar.com/avatar/43d3d05e8661efc480320db4edd33bb6?s=60&d=mm&r=g)

     Plugin Vulnerabilities -
     [June 26, 2019 at 10:59 am](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13688)

     You really don’t seem to know what you are talking about security at all and didn’t respond to specific points we made, but we will respond to yours.

     > Claiming the plugin to be \*so\* insecure when in fact it was a minor flaw that would only have disabled its own capabilities (and only if a user with administrator access clicked on a malicious link) is \*very\* dramatic.

     Your plugin has failed to implement basic security while it is a security plugin, if you really don’t understand why that is a problem, you shouldn’t be developing a security plugin.

     > To quote WordPress support “Strictly speaking, even calls to SERVER should be sanitized … however we do not require that, as they are considerably harder to leverage.”

     We couldn’t find any WordPress documentation that matches the wording you are quoting, so we don’t know where got that, but if it was the team running the Plugin Directory, that would be another thing they have gotten wrong, since some $\_SERVER variables come from user input, so they need to be sanitized, valididated, and or escaped.

     > – Users exposed … you currently allow hackers to see your usernames (whitefirdesign) and seeing as your login page is wide open this isn’t very good at all <https://www.pluginvulnerabilities.com/wp-login.php> (we have another plugin, block-wp-login that you might want to use for that)

     Usernames [are not considered a secret by WordPress](https://wptavern.com/why-showing-the-wordpress-username-is-not-a-security-risk) and if you look at the top of website we have link to login, since we have customers that need to login. The security of logins is handled by using a strong password, not hiding usernames or login pages.

     > – Theme PHP exposed … <https://www.pluginvulnerabilities.com/wp-content/content.php>

     You linked to a file that doesn’t exist and the not found page for our website is shown, so there isn’t an issue there.

     > – Plugin readme.txt exposed … <https://www.pluginvulnerabilities.com/wp-content/plugins/fruitful-shortcodes/readme.txt>

     That isn’t a security issue.

     > – Entire wp-content PHP exposed

     Directory listing isn’t enabled, so we don’t know what you are referring to there.

     [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13688#respond)
5. ![](https://secure.gravatar.com/avatar/23a9a17ff5fead95d96d506c2753db22?s=60&d=mm&r=g)

   [Oliver](http://webd.uk) -
   [June 26, 2019 at 3:46 pm](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13689)

   Brilliant.

   When you’ve caught up, we’ll be here to help.

   Thanks for your input,

   Oliver

   [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13689#respond)

   * ![](https://secure.gravatar.com/avatar/43d3d05e8661efc480320db4edd33bb6?s=60&d=mm&r=g)

     Plugin Vulnerabilities -
     [June 26, 2019 at 3:49 pm](https://www.pluginvulnerabilities.com/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#comment-13690)

     What are you talking about? We are not the ones with a problem handling security here.

     [Reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/?replytocom=13690#respond)

### Leave a Reply [Cancel reply](/2019/06/21/cross-site-request-forgery-csrf-vulnerability-in-deny-all-firewall/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### What WordPress Security issue do you need help with today?

Protecting Your WordPress Websites

Cleaning Up Hacked WordPress Websites

Ensuring WordPress Websites are Secure

Fixing a Vulnerable WP Plugin You Use

Ensuring a WordPress Plugin is Secure

Maintenance for Abandoned WP Plugin

Ensuring a WordPress Theme is Secure

Protecting Your Customers’ Websites

Fixing a Vulnerable Plugin You Develop

How Many Websites Do You Have?
1
2-10
11+

How Critical is it That Your Website Remain Secure?
Low
Medium
High

or

### Latest WordPress Plugin Security Scorecard Grades

* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/meta-box)[Meta Box](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=meta-box)     B
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/fluent-smtp)[FluentSMTP](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=fluent-smtp)     D+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/wp-simple-firewall)[Shield](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=wp-simple-firewall)     F
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/ninjafirewall)[NinjaFirewall (WP Editio...](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=ninjafirewall)     D
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/gravity-forms-pdf-extended)[Gravity PDF](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=gravity-forms-pdf-extended)     C
* [See More Recent Grades](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?results=recent)
* [Check Another Plugin](https://www.pluginvulnerabilities.com/plugin-security-scorecard/)
* [Patchstack vs WPVulnerability](/plugin-security-scorecard/?slug=patchstack&vs=wpvulnerability)
### Latest News

* [300,000 Install WordPress Plugin That Hasn’t Updated Insecure Library in 21 Months Claims Patchstack Ensures the Plugin is Secure](https://www.pluginvulnerabilities.com/2025/01/17/300000-install-wordpress-plugin-that-hasnt-updated-insecure-library-in-21-months-claims-patchstack-ensures-the-plugin-is-secure/)
* [Two-Factor Authentication (2FA) Won’t Stop an Attacker From Using Their Own WordPress Account to Engage in Malicious Activity](https://www.pluginvulnerabilities.com/2025/01/17/two-factor-authentication-2fa-wont-stop-an-attacker-from-using-their-own-wordpress-account-to-engage-in-malicious-activity/)
* [1+ Million Install WordPress Plugin Has Been Using an Outdated Known Insecure Version of a Library For Nearly 3 Years](https://www.pluginvulnerabilities.com/2025/01/16/1-million-install-wordpress-plugin-has-been-using-an-outdated-known-insecure-version-of-a-library-for-nearly-3-years/)
### Follow Us

* [Google News](https://news.google.com/publications/CAAqBwgKMNaxwAsw6MzXAw)
* [Bluesky](https://bsky.app/profile/pluginvulns.bsky.social)
* [RSS](https://www.pluginvulnerabilities.com/category/news/feed/)
### Latest Plugin Security Reviews

* [WordPress Plugin Security Review: WP API Privacy](https://www.pluginvulnerabilities.com/2024/11/18/wordpress-plugin-security-review-wp-api-privacy/)
* [WordPress Plugin Security Review: Two Factor](https://www.pluginvulnerabilities.com/2024/09/17/wordpress-plugin-security-review-two-factor/)
* [WordPress Plugin Security Review: Download Monitor](https://www.pluginvulnerabilities.com/2024/09/06/wordpress-plugin-security-review-download-monitor/)

Powered by WordPress and WooCommerce

© 2016-2025 [White Fir Design LLC](http://www.whitefirdesign.com/) | [Privacy Policy](/privacy-policy/)
 Fruitful theme by [fruitfulcode](http://fruitfulcode.com)

[↑](#top "Back to top")

![](https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)


