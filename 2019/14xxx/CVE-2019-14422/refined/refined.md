- **Root cause of vulnerability**: The URI handler of TortoiseSVN (Tsvncmd:) allows a customized diff operation on Excel workbooks, which can be exploited to open remote workbooks without proper macro security settings.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the way TortoiseSVN handles the `tsvncmd:` URI scheme, specifically when performing diff operations on .xls files. It executes `diff-xls.js` using wscript, opening the files for analysis without any macro security warnings.
- **Impact of exploitation**: A remote attacker can execute arbitrary code by placing a macro virus in a network drive, and forcing the victim to open the workbooks, triggering the malicious macro. Since it uses wscript, the attacker can hide their tracks by killing the wscript process and closing excel after the code execution.
- **Attack vectors**: The vulnerability can be exploited remotely via a specially crafted URL, which can be embedded in a .url file or opened directly in a web browser (though the latter may show a notification prompt). The attacker must control a network drive to host the malicious workbook.
- **Required attacker capabilities/position**: The attacker needs to be able to host the malicious macro-enabled Excel file on a network drive. The attacker also needs to induce the victim to open a crafted URL. The attacker does not require any authentication.