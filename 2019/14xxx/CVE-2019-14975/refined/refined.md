The provided content describes a heap-buffer-overflow vulnerability in MuPDF.

**Root cause of vulnerability:**
- The vulnerability is a heap-buffer-overflow in the `fz_chartorune` function located in `fitz/string.c:388:6`.
- The root cause is related to the handling of missing or empty strings, specifically when converting characters to runes.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: A memory safety violation where data is written beyond the allocated buffer on the heap.

**Impact of exploitation:**
- The heap-buffer-overflow can lead to memory corruption, potentially allowing an attacker to overwrite critical data structures, which can cause a denial of service, or allow for arbitrary code execution.

**Attack vectors:**
- The vulnerability is triggered when processing a malformed PDF file. Specifically, the `mutool clean` command is used to demonstrate the issue.
- The vulnerable code path is reached when processing a string within a PDF file using the `fz_chartorune` function during PDF cleaning.

**Required attacker capabilities/position:**
- The attacker needs to provide a specially crafted PDF file that will trigger the vulnerability when processed by the vulnerable `mutool clean` command.

**Additional Details:**
- The provided ASAN log details the exact location of the overflow and the call stack leading to the vulnerable code.
- The bug report also includes a patch commit that fixes the handling of missing/empty strings, resolving the vulnerability.