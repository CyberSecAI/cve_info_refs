=== Content from medium.com_8942619b_20250120_233743.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffa839acaad59&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40infiniti_css%2Ftrend-micro-password-manager-dll-hijack-fa839acaad59&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40infiniti_css%2Ftrend-micro-password-manager-dll-hijack-fa839acaad59&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Trend Micro Password Manager DLL Hijack

[![Infiniti Team](https://miro.medium.com/v2/resize:fill:88:88/2*5a0p3lP6fbUfd9EDfvpbXg.png)](/%40infiniti_css?source=post_page---byline--fa839acaad59--------------------------------)

[Infiniti Team](/%40infiniti_css?source=post_page---byline--fa839acaad59--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa0e672953b9a&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40infiniti_css%2Ftrend-micro-password-manager-dll-hijack-fa839acaad59&user=Infiniti+Team&userId=a0e672953b9a&source=post_page-a0e672953b9a--byline--fa839acaad59---------------------post_header-----------)

2 min read·Aug 15, 2019

--

1

Listen

Share

**Trend Micro Password Manager** managed website passwords and login IDs in one secure location.

A DLL Hijacking vulnerability has been discovered in the official Trend Micro Password Manager. DLL Hijacking vulnerability is not difficult to find and exploit if an application has this issue.

# Vulnerability Details

The *“tmtap.dll”* file that is loaded by PwmSvc process that is service of Trend Micro Password Manager However, this file does not exist in the folder where PwmSvc.exe locates.

![]()

PwmSvc service process will load tmtap.dll file but this DLL does not exist in PwmSvc.exe’s folder. So, PwmSvc.exe will find this DLL file in Environment folders. A local user can exploit this issue by placing a malicious tmtap.dll file in a writeable Environment folder.

Steps to exploit:

* Creates a small “tmtap.dll” file and place to any writeable Environment folder. When this DLL file is loaded, the “calc.exe” will be executed as system privilege. In the case the folder is “C:\Python37”, it is an Environment folder.

![]()

* PwmSvc.exe process will load “C:\Python37\tmtap.dll”

![]()

tmtap.dll is loaded by *PwmSvc.exe*

![]()

Exploit success

Service that causes vulnerability: **PwmSvc.exe**

DLL that is dynamically tested and succeeded: **tmtap.dll**

# Affected Products

Trend Micro Password Manager for Windows below 5.0.0.1058

# Timeline:

* 03/July/2019: Reported Vulnerability to Trend Micro
* 05/July/2019: Trend Micro acknowledged the Vulnerability
* 01/Aug/2019: Vulnerability Fixed (Version of [Trend Micro Password Manager](https://pwm.trendmicro.com/) 5.0.0.1058)
* 13/Aug/2019: Trend Micro has assigned the following CVE ID for my submission: CVE-2019–14687
* 14/Aug/2019: Trend Micro has published a security bulletin: <https://esupport.trendmicro.com/solution/en-US/1123396.aspx>

**Trần Văn Khang (aka** [**Khang Kì Tổ**](/%40k1t0ky0)**) — Infiniti Team, VinCSS (a member of Vingroup)**

[Security](/tag/security?source=post_page-----fa839acaad59--------------------------------)[Trend Micro](/tag/trend-micro?source=post_page-----fa839acaad59--------------------------------)[Dll Hijacking](/tag/dll-hijacking?source=post_page-----fa839acaad59--------------------------------)[Privilege Escalation](/tag/privilege-escalation?source=post_page-----fa839acaad59--------------------------------)

--

--

1

[![Infiniti Team](https://miro.medium.com/v2/resize:fill:96:96/2*5a0p3lP6fbUfd9EDfvpbXg.png)](/%40infiniti_css?source=post_page---post_author_info--fa839acaad59--------------------------------)[![Infiniti Team](https://miro.medium.com/v2/resize:fill:128:128/2*5a0p3lP6fbUfd9EDfvpbXg.png)](/%40infiniti_css?source=post_page---post_author_info--fa839acaad59--------------------------------)Follow[## Written by Infiniti Team](/%40infiniti_css?source=post_page---post_author_info--fa839acaad59--------------------------------)[18 Followers](/%40infiniti_css/followers?source=post_page---post_author_info--fa839acaad59--------------------------------)·[1 Following](/%40infiniti_css/following?source=post_page---post_author_info--fa839acaad59--------------------------------)

We are The Infiniti — practical cyber security R&D team from VinCSS (a member of Vingroup).

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----fa839acaad59--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----fa839acaad59--------------------------------)[About](/about?autoplay=1&source=post_page-----fa839acaad59--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----fa839acaad59--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----fa839acaad59--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----fa839acaad59--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fa839acaad59--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fa839acaad59--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----fa839acaad59--------------------------------)[Teams](/business?source=post_page-----fa839acaad59--------------------------------)


