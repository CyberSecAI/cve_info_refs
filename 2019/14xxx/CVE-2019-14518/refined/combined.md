=== Content from github.com_ea6cafeb_20250120_235634.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1041)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1041)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=evolution-cms%2Fevolution)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evolution-cms](/evolution-cms)
/
**[evolution](/evolution-cms/evolution)**
Public

forked from [modxcms/evolution](/modxcms/evolution)

* [Notifications](/login?return_to=%2Fevolution-cms%2Fevolution) You must be signed in to change notification settings
* [Fork
  93](/login?return_to=%2Fevolution-cms%2Fevolution)
* [Star
   260](/login?return_to=%2Fevolution-cms%2Fevolution)

* [Code](/evolution-cms/evolution)
* [Issues
  213](/evolution-cms/evolution/issues)
* [Pull requests
  1](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

Additional navigation options

* [Code](/evolution-cms/evolution)
* [Issues](/evolution-cms/evolution/issues)
* [Pull requests](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

# Stored Cross Site Scripting #1041

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Stored Cross Site Scripting](#top)#1041Copy linkAssignees [![AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)](/AgelxNash)![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=80)
## Description

![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=48)[prasadlingamaiah](https://github.com/prasadlingamaiah)opened [on Mar 22, 2019](https://github.com/evolution-cms/evolution/issues/1041#issue-424228726)

**Stored Cross Site Scripting Vulnerability**

**Risk Description**

Stored cross-site scripting vulnerabilities arise when user input is stored and later embedded into the application's responses in an unsafe way. An attacker can use the vulnerability to inject malicious JavaScript code into the application, which will execute within the browser of any user who views the relevant application content. The attacker-supplied code can perform a wide variety of actions, such as stealing victims' session tokens or login credentials, performing arbitrary actions on their behalf, and logging their keystrokes. Methods for introducing malicious content include any function where request parameters or headers are processed and stored by the application, and any out-of-band channel whereby data can be introduced into the application's processing space (for example, email messages sent over SMTP that are ultimately rendered within a web mail application). Stored cross-site scripting flaws are typically more serious than reflected vulnerabilities because they do not require a separate delivery mechanism in order to reach target users and are not hindered by web browsers' XSS filters. Depending on the affected page, ordinary users may be exploited during normal use of the application. In some situations, this can be used to create web application worms that spread exponentially and ultimately exploit all active users.

**POC:**

Let's see welcome before login

[![1 login page](https://user-images.githubusercontent.com/24879082/54828115-7d945c80-4cd9-11e9-9dde-292c473603c7.PNG)](https://user-images.githubusercontent.com/24879082/54828115-7d945c80-4cd9-11e9-9dde-292c473603c7.PNG)

Login to the Application

[![2 after login dashboard](https://user-images.githubusercontent.com/24879082/54828142-8e44d280-4cd9-11e9-92d3-ffdb072c1cad.PNG)](https://user-images.githubusercontent.com/24879082/54828142-8e44d280-4cd9-11e9-92d3-ffdb072c1cad.PNG)

Go to the Template Location and add new template

[![3 templete location](https://user-images.githubusercontent.com/24879082/54828172-9c92ee80-4cd9-11e9-81bc-57b534c5555b.png)](https://user-images.githubusercontent.com/24879082/54828172-9c92ee80-4cd9-11e9-81bc-57b534c5555b.png)

add xss payload in description and new category location using <ScRipT>alert("XSS");</ScRipT>

[![5  new category](https://user-images.githubusercontent.com/24879082/54828235-bf250780-4cd9-11e9-8369-361de54b7dd1.PNG)](https://user-images.githubusercontent.com/24879082/54828235-bf250780-4cd9-11e9-8369-361de54b7dd1.PNG)

Save and exit the template location will get xss popup

[![6 save and close](https://user-images.githubusercontent.com/24879082/54828322-eb408880-4cd9-11e9-9247-992bdec49f4e.PNG)](https://user-images.githubusercontent.com/24879082/54828322-eb408880-4cd9-11e9-9247-992bdec49f4e.PNG)

**Mitigation:**

Output encoding: It is recommended to implement ‘output encoding’ to convert untrusted input into a safe form where the input is displayed as data to the user without executing as code in the browser. Java HTML encoding Function public static String HTMLEncode(String aTagFragment){      final StringBuffer result = new StringBuffer();      final StringCharacterIterator iterator = new                                     StringCharacterIterator(aTagFragment);      char character =  iterator.current();      while (character != StringCharacterIterator.DONE )      {        if (character == '<')  result.append("<");        else if (character == '>') result.append(">");        else if (character == '"')  result.append(""");        else if (character == ''')  result.append("'");        else if (character == '\') result.append("\");        else if (character == '&')  result.append("&");        else {             //the char is not a special one             //add it to the result as is             result.append(character);        }        character = iterator.next();      }      return result.toString();   } •          Escaping: Escape all untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. EASPI API String safe = ESAPI.encoder().encodeForHTML( request.getParameter( "input" ) ); •          Filtering input parameter: Positive or "whitelist" input validation with appropriate canonicalization is the recommended filtering technique. Alternatively, black-list filtering input works by removing some or all special characters from your input. Special characters are characters that enable script to be generated within an HTML stream. Special characters include the following: <> " ' % ; ) ( & + - JavaScript Codefunction RemoveBad(strTemp) {     strTemp = strTemp.replace(/<|>|"|'|%|;|(|)|&|+|-/g,"");     return strTemp; }

## Metadata

### Assignees

* [![@AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)AgelxNash](/AgelxNash)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a89ce84c_20250120_235636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1043)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1043)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=evolution-cms%2Fevolution)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evolution-cms](/evolution-cms)
/
**[evolution](/evolution-cms/evolution)**
Public

forked from [modxcms/evolution](/modxcms/evolution)

* [Notifications](/login?return_to=%2Fevolution-cms%2Fevolution) You must be signed in to change notification settings
* [Fork
  93](/login?return_to=%2Fevolution-cms%2Fevolution)
* [Star
   260](/login?return_to=%2Fevolution-cms%2Fevolution)

* [Code](/evolution-cms/evolution)
* [Issues
  213](/evolution-cms/evolution/issues)
* [Pull requests
  1](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

Additional navigation options

* [Code](/evolution-cms/evolution)
* [Issues](/evolution-cms/evolution/issues)
* [Pull requests](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

# Reflected Cross Site scripting Vulnerability in Evolution CMS 2.0.x #1043

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Reflected Cross Site scripting Vulnerability in Evolution CMS 2.0.x](#top)#1043Copy linkAssignees [![AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)](/AgelxNash)Labels[Type/Bug](https://github.com/evolution-cms/evolution/issues?q=state%3Aopen%20label%3A%22Type%2FBug%22)![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=80)
## Description

![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=48)[prasadlingamaiah](https://github.com/prasadlingamaiah)opened [on Mar 22, 2019](https://github.com/evolution-cms/evolution/issues/1043#issue-424256128)

**Reflected Cross Site scripting Vulnerability**

**Description:**

The second and the most common type of XSS is Reflected XSS (Non-persistent XSS). In this case, the attacker’s payload has to be a part of the request that is sent to the web server. It is then reflected back in such a way that the HTTP response includes the payload from the HTTP request. Attackers use malicious links, phishing emails, and other social engineering techniques to lure the victim into making a request to the server. The reflected XSS payload is then executed in the user’s browser.

Reflected XSS is not a persistent attack, so the attacker needs to deliver the payload to each victim. These attacks are often made using social networks.

Login to application

[![1 login page](https://user-images.githubusercontent.com/24879082/54832068-812be180-4ce1-11e9-83c1-3618f0de26c8.PNG)](https://user-images.githubusercontent.com/24879082/54832068-812be180-4ce1-11e9-83c1-3618f0de26c8.PNG)

Goto the Document Manager and view the list of documents

[![domule location docs](https://user-images.githubusercontent.com/24879082/54832203-b9332480-4ce1-11e9-8263-7b742448d875.png)](https://user-images.githubusercontent.com/24879082/54832203-b9332480-4ce1-11e9-8263-7b742448d875.png)

there is a search perimeter insert xss payload as <ScRipT>alert("XSS");</ScRipT>

[![search parameter](https://user-images.githubusercontent.com/24879082/54832339-f5668500-4ce1-11e9-81cb-ebd009706aeb.PNG)](https://user-images.githubusercontent.com/24879082/54832339-f5668500-4ce1-11e9-81cb-ebd009706aeb.PNG)

Effected URL

<https://20.0.0.143/evolution-2.0.x/manager/#?a=112&id=1>

[![1 Documents location](https://user-images.githubusercontent.com/24879082/54832379-0fa06300-4ce2-11e9-8142-f6ddc4571e2a.PNG)](https://user-images.githubusercontent.com/24879082/54832379-0fa06300-4ce2-11e9-8142-f6ddc4571e2a.PNG)

**Mitigation:**

Output encoding: It is recommended to implement ‘output encoding’ to convert untrusted input into a safe form where the input is displayed as data to the user without executing as code in the browser. Java HTML encoding Function public static String HTMLEncode(String aTagFragment){      final StringBuffer result = new StringBuffer();      final StringCharacterIterator iterator = new                                     StringCharacterIterator(aTagFragment);      char character =  iterator.current();      while (character != StringCharacterIterator.DONE )      {        if (character == '<')  result.append("<");        else if (character == '>') result.append(">");        else if (character == '"')  result.append(""");        else if (character == ''')  result.append("'");        else if (character == '\') result.append("\");        else if (character == '&')  result.append("&");        else {             //the char is not a special one             //add it to the result as is             result.append(character);        }        character = iterator.next();      }      return result.toString();   } •          Escaping: Escape all untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. EASPI API String safe = ESAPI.encoder().encodeForHTML( request.getParameter( "input" ) ); •          Filtering input parameter: Positive or "whitelist" input validation with appropriate canonicalization is the recommended filtering technique. Alternatively, black-list filtering input works by removing some or all special characters from your input. Special characters are characters that enable script to be generated within an HTML stream. Special characters include the following: <> " ' % ; ) ( & + - JavaScript Codefunction RemoveBad(strTemp) {     strTemp = strTemp.replace(/<|>|"|'|%|;|(|)|&|+|-/g,"");     return strTemp; }

While the issue was investigated, there were some backend updates done which apparently automatically mysteriously fixed the issue.

## Metadata

### Assignees

* [![@AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)AgelxNash](/AgelxNash)
### Labels

[Type/Bug](https://github.com/evolution-cms/evolution/issues?q=state%3Aopen%20label%3A%22Type%2FBug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0808a420_20250120_235635.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1042)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevolution-cms%2Fevolution%2Fissues%2F1042)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=evolution-cms%2Fevolution)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evolution-cms](/evolution-cms)
/
**[evolution](/evolution-cms/evolution)**
Public

forked from [modxcms/evolution](/modxcms/evolution)

* [Notifications](/login?return_to=%2Fevolution-cms%2Fevolution) You must be signed in to change notification settings
* [Fork
  93](/login?return_to=%2Fevolution-cms%2Fevolution)
* [Star
   260](/login?return_to=%2Fevolution-cms%2Fevolution)

* [Code](/evolution-cms/evolution)
* [Issues
  213](/evolution-cms/evolution/issues)
* [Pull requests
  1](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

Additional navigation options

* [Code](/evolution-cms/evolution)
* [Issues](/evolution-cms/evolution/issues)
* [Pull requests](/evolution-cms/evolution/pulls)
* [Discussions](/evolution-cms/evolution/discussions)
* [Actions](/evolution-cms/evolution/actions)
* [Security](/evolution-cms/evolution/security)
* [Insights](/evolution-cms/evolution/pulse)

# I-Frame Injection Vulnerability in Evolution CMS 2.0.x #1042

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[I-Frame Injection Vulnerability in Evolution CMS 2.0.x](#top)#1042Copy linkAssignees [![AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)](/AgelxNash)![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=80)
## Description

![@prasadlingamaiah](https://avatars.githubusercontent.com/u/24879082?v=4&size=48)[prasadlingamaiah](https://github.com/prasadlingamaiah)opened [on Mar 22, 2019](https://github.com/evolution-cms/evolution/issues/1042#issue-424243076)

**I-Frame Injection Vulnerability**

**Risk Description**

Malware Attackers use this IFrame and include the malware websites. They are able to include the webpage one-pixel square (You won’t able to see it in webpage). Obfuscate the JavaScript that will run automatically from that included page so that it looks something like %6C%20%66%72%61%6D%65%62%6F – leaving no obvious clue that it’s malicious. Using Iframe Injection, an attacker can inject advertisements inside any other websites, insert malware infected site links, redirect to malware infected sites and more.

**POC**

Login to Evolution CMS application

[![1 login page](https://user-images.githubusercontent.com/24879082/54830048-bdf5d980-4cdd-11e9-9c04-6ea211adf84f.PNG)](https://user-images.githubusercontent.com/24879082/54830048-bdf5d980-4cdd-11e9-9c04-6ea211adf84f.PNG)

Goto the template location and try to create New template

[![1 edit template](https://user-images.githubusercontent.com/24879082/54830100-d82fb780-4cdd-11e9-8a97-824a1e48d229.PNG)](https://user-images.githubusercontent.com/24879082/54830100-d82fb780-4cdd-11e9-8a97-824a1e48d229.PNG)

insert the payload in description location, template name as "/><iframe/src="[https://evil.com">](https://evil.com%22%3E)</iframe>

[![1 edit template](https://user-images.githubusercontent.com/24879082/54830180-0614fc00-4cde-11e9-9548-ff483254e15d.PNG)](https://user-images.githubusercontent.com/24879082/54830180-0614fc00-4cde-11e9-9548-ff483254e15d.PNG)

save and close the template.

[![sabve and close](https://user-images.githubusercontent.com/24879082/54830255-2cd33280-4cde-11e9-88e7-a4293fb385d4.png)](https://user-images.githubusercontent.com/24879082/54830255-2cd33280-4cde-11e9-88e7-a4293fb385d4.png)

Now open the template list like below you will get Iframe which is running malicious.

[![1](https://user-images.githubusercontent.com/24879082/54830331-5429ff80-4cde-11e9-9497-f640480fb63b.PNG)](https://user-images.githubusercontent.com/24879082/54830331-5429ff80-4cde-11e9-9497-f640480fb63b.PNG)

**Mitigation:**

1.      you should include the Content Security Policy frame-ancestors header in your HTTP response to prevent your website being loaded in a frame. Some older browsers may not have support for this header, so also use the X-Frame-Options header with value DENY, SAMEORIGIN or ALLOW-FROM uri. X-Frame-Options takes precedence over CSP frame-ancestors in some browsers. 2.      You could additionally have some Javascript "frame-breaker" code that will prevent your website from being "framed" in older browsers. •          Output encoding: It is recommended to implement ‘output encoding’ to convert untrusted input into a safe form where the input is displayed as data to the user without executing as code in the browser. Java HTML encoding Function public static String HTMLEncode(String aTagFragment){      final StringBuffer result = new StringBuffer();      final StringCharacterIterator iterator = new                                     StringCharacterIterator(aTagFragment);      char character =  iterator.current();      while (character != StringCharacterIterator.DONE )      {        if (character == '<')  result.append("<");        else if (character == '>') result.append(">");        else if (character == '"')  result.append(""");        else if (character == ''')  result.append("'");        else if (character == '\') result.append("\");        else if (character == '&')  result.append("&");        else {             //the char is not a special one             //add it to the result as is             result.append(character);        }        character = iterator.next();      }      return result.toString();   } •          Escaping: Escape all untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. EASPI API String safe = ESAPI.encoder().encodeForHTML( request.getParameter( "input" ) );   •          Filtering input parameter: Positive or "whitelist" input validation with appropriate canonicalization is the recommended filtering technique. Alternatively, black-list filtering input works by removing some or all special characters from your input. Special characters are characters that enable script to be generated within an HTML stream. Special characters include the following: <> " ' % ; ) ( & + - JavaScript Codefunction RemoveBad(strTemp) {     strTemp = strTemp.replace(/<|>|"|'|%|;|(|)|&|+|-/g,"");     return strTemp; }

## Metadata

### Assignees

* [![@AgelxNash](https://avatars.githubusercontent.com/u/1748872?s=64&u=f8d7533c7c0a74cf9eafbbc5be1ddb1409396aa6&v=4)AgelxNash](/AgelxNash)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


