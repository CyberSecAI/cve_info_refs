=== Content from github.com_d322e7b6_20250121_010201.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInnotecSystem%2FDevice-Reversing%2Fwiki%2FFirmware-Inspection)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInnotecSystem%2FDevice-Reversing%2Fwiki%2FFirmware-Inspection)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Fshow&source=header-repo&source_repo=InnotecSystem%2FDevice-Reversing)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[InnotecSystem](/InnotecSystem)
/
**[Device-Reversing](/InnotecSystem/Device-Reversing)**
Public

* [Notifications](/login?return_to=%2FInnotecSystem%2FDevice-Reversing) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FInnotecSystem%2FDevice-Reversing)
* [Star
   5](/login?return_to=%2FInnotecSystem%2FDevice-Reversing)

* [Code](/InnotecSystem/Device-Reversing)
* [Issues
  0](/InnotecSystem/Device-Reversing/issues)
* [Pull requests
  0](/InnotecSystem/Device-Reversing/pulls)
* [Actions](/InnotecSystem/Device-Reversing/actions)
* [Projects
  0](/InnotecSystem/Device-Reversing/projects)
* [Wiki](/InnotecSystem/Device-Reversing/wiki)
* [Security](/InnotecSystem/Device-Reversing/security)
* [Insights](/InnotecSystem/Device-Reversing/pulse)

Additional navigation options

* [Code](/InnotecSystem/Device-Reversing)
* [Issues](/InnotecSystem/Device-Reversing/issues)
* [Pull requests](/InnotecSystem/Device-Reversing/pulls)
* [Actions](/InnotecSystem/Device-Reversing/actions)
* [Projects](/InnotecSystem/Device-Reversing/projects)
* [Wiki](/InnotecSystem/Device-Reversing/wiki)
* [Security](/InnotecSystem/Device-Reversing/security)
* [Insights](/InnotecSystem/Device-Reversing/pulse)

# Firmware Inspection

[Jump to bottom](#wiki-pages-box)

Mario Bartolomé edited this page Dec 20, 2019
·
[3 revisions](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection/_history)

This is the second of three mini-posts where I will write about some fun discoveries

* 1/3: [Dissecting a ~~piñata~~Router](https://github.com/InnotecSystem/Device-Reversing/wiki/Dissecting-a-router)
* **2/3: Inspecting a router's firmware and reversing binaries to achieve RCE**
* 3/3: [Stored XSS via DHCP injection](https://github.com/InnotecSystem/Device-Reversing/wiki/XSS-Injection-via-DHCP-requests)

# 0x02/0x03 : Firmware inspection and binary reversing to achieve RCE

## Seeking some interesting info

While still intact, I ran an Nmap scanner against the router. It found an open telnet service running behind port 2301 (naughty naughty), which presents a login when opening a session to it.

![Telnet logon at port 2301](https://user-images.githubusercontent.com/23175380/64639364-fca45b00-d407-11e9-9757-a10ae58412bb.png)

But telnet has no login support by default... so it may be a modified version of telnet, or the system is using the `-l` flag on telnet command to set a binary that will take care of the login.

During the firmware inspection, and by having a look to the file `rcS` contained at `etc_ro`, the login management software behind the scenes can be found:

![Login management sw behind the telnet service](https://user-images.githubusercontent.com/23175380/64637833-e943c080-d404-11e9-93a9-1bcf5df2766c.png)

So let's reverse it!

#### Reversing the login management binary

---

* CVE-2019-14919. Affected product/version: Billion Smart Energy Router SG600R2. Firmw v3.02.rc6

This is kinda embarrassing... Just by checking the strings at the binary, the "Login incorrect" message appears to be next to the **correct username and password**. Straight away in clear-text. Embedded into the source. Some awesome programming practices here.

Let's go step by step. Start by instructing **radare2** to analyze the binary by issuing `aaaa` to perform an in-deep analysis.

Then, by having a look to the strings at the data sections (use `iz` in radare2 to get information about the strings in data sections), the *Login incorrect* address seems to be stored in the `.rodata` section at address `0x00400d44`.

![Strings found at binary](https://user-images.githubusercontent.com/23175380/64925410-677ed900-d7f0-11e9-932c-4f727f887a7c.png)

By checking the cross-references the string has (use `axt 0x00400d44`to `a`nalyze `x`refs `t`o address), it's kinda easy to find that it was used only at the login process:

![XRefs to string](https://user-images.githubusercontent.com/23175380/64925414-7c5b6c80-d7f0-11e9-9430-8de64abb8b0e.png)

So by navigating to that address (`s 0x400ad8` to `s`eek to an specific address) and checking the graphic view (`VV` to change to graphic View), the whole login process comes clear:

![HardCoded credentials](https://user-images.githubusercontent.com/23175380/64637855-f8c30980-d404-11e9-90bd-fdf67860bdd8.png)

And yup, the login works

![Root shell](https://user-images.githubusercontent.com/23175380/64637883-05dff880-d405-11e9-8aef-4b1c998a183c.png)

#### "Hidden" Root WebShell

---

* CVE-2019-14920. Affected product/version: Billion Smart Energy Router SG600R2. Firmw v3.02.rc6

When rains, it pours!

While checking the file system, a really eye-catching name came up:

![...the fuck is that?](https://user-images.githubusercontent.com/23175380/64637929-15f7d800-d405-11e9-92db-94c33db9087a.png)

The other files are listed as part of the administration of the router, but not this one... there's no sign of it at the panels:

![No system command here](https://user-images.githubusercontent.com/23175380/64638236-ae8e5800-d405-11e9-804b-ebfa85a02830.png)

Feels like Christmas... Let's open it!

A hidden root webshell. All for me...

![A root WebShell all for you!](https://user-images.githubusercontent.com/23175380/64638289-c239be80-d405-11e9-8ede-33c3eba3ed64.png)

### And last but not least

Oh, yeah, the admin password... I found a file where the username and the password are stored:

![Super hard password](https://user-images.githubusercontent.com/23175380/64638351-d41b6180-d405-11e9-9044-ea67e4cdc37c.png)

Also a couple of wild stored XSS appeared... One of them with a really interesting exploitation path.

Check on the next part of this mini-writeup to find out more!

---

If you readed the whole ~~annoying~~ post you may want to know the user/pass:

user: `hsinchu-binos2` \\ pass: `33659498`

### Toggle table of contents Pages 4

* Loading

  [Home](/InnotecSystem/Device-Reversing/wiki)
* Loading

  [Dissecting a router](/InnotecSystem/Device-Reversing/wiki/Dissecting-a-router)
* Loading

  [Firmware Inspection](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection)

  + [0x02/0x03 : Firmware inspection and binary reversing to achieve RCE](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection#0x020x03--firmware-inspection-and-binary-reversing-to-achieve-rce)
  + [Seeking some interesting info](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection#seeking-some-interesting-info)
  + [Reversing the login management binary](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection#reversing-the-login-management-binary)
  + ["Hidden" Root WebShell](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection#hidden-root-webshell)
  + [And last but not least](/InnotecSystem/Device-Reversing/wiki/Firmware-Inspection#and-last-but-not-least)
* Loading

  [XSS Injection via DHCP requests](/InnotecSystem/Device-Reversing/wiki/XSS-Injection-via-DHCP-requests)

##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


