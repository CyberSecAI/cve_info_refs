```text
CVE-2019-5158: WAGO e!COCKPIT Firmware Downgrade Vulnerability

- Root cause: Improper input validation in the firmware update package functionality. The software does not properly validate the firmware version reported in the package metadata, allowing an attacker to present a misleading version number.
- Vulnerability: The e!COCKPIT software allows users to update WAGO controllers' firmware via `wup` files. The software accepts both encrypted and unencrypted zip file archives. The `package-info.xml` file, which contains firmware metadata, is not properly validated.
- Impact: An attacker can create a malicious `wup` file with a manipulated `package-info.xml` file, causing the user to believe they are installing a newer firmware version when in reality an older, potentially vulnerable version is being installed. This could allow the attacker to exploit known vulnerabilities in the older firmware and gain access to the device.
- Attack vector: An attacker prepares a malicious `wup` file by modifying the `package-info.xml` file to report a different version number than the actual firmware contained within the package. The attacker can then have the user install this malicious `wup` file through the e!COCKPIT software. The software can automatically make `wup` files placed in `C:\ProgramData\WAGO Software\e!COCKPIT\FirmwareRepository` available to the user in the Firmware Update dialog box.
- Required attacker capabilities/position: The attacker needs the ability to create a custom `wup` file. User interaction is required to install the malicious firmware update package.
```