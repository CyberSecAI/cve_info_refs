Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2019-5722

**Root Cause of Vulnerability:**
*   Lack of user input validation in the parameter handling within the Portier application. This allows an attacker to inject arbitrary SQL commands.

**Weaknesses/Vulnerabilities Present:**
*   **SQL Injection (CWE-89):** Multiple input fields throughout the Portier application are vulnerable to SQL injection attacks. This includes the login form, which is exploitable even by unauthenticated users, although it won't bypass login.

**Impact of Exploitation:**
*   **Arbitrary SQL Command Execution:** An attacker can execute almost any SQL command on the database server.
*   **Data Breach:**  The most significant real-world impact is the potential to steal encrypted passwords of users, especially those with supervisor privileges.
*   **Data Manipulation:** Attackers could potentially modify or delete data stored in the database.

**Attack Vectors:**
*   **Vulnerable Input Fields:** Any input field that is not properly sanitized before being passed to a database query is a potential attack vector. Examples are mentioned like the login form and search form fields.
*   **Plain Text Communication:** The application communicates with the database in plain text, allowing an attacker to sniff traffic and capture database queries to craft attack vectors.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs to be able to intercept the network traffic between the Portier application and the database server.
*   **Knowledge of SQL:** The attacker needs to have knowledge of SQL to craft appropriate injection payloads.
*   **No Authentication Required:** The SQL injection vulnerability in the login form can be exploited without prior authentication, although it won't bypass the login.

**Additional Details:**
*   The application supports Firebird and MS SQL database servers.
*   Stacked queries are not supported by either database, limiting the scope of some exploitation techniques.
*   Firebird databases may have a smaller number of exploitable input fields compared to MS SQL due to the lack of support for `UNION SELECT` when an `ORDER BY` statement terminates the entire query.
*   The provided proof-of-concept demonstrates how to extract user passwords, using a `UNION SELECT` statement to append a malicious query to the existing SQL query.

**Solution:**
*   The advisory recommends using prepared statements for all database queries as a mitigation.