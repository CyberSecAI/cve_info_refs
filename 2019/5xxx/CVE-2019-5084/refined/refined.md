```
CVE-2019-5084:
```
- **Vulnerability:** Heap out-of-bounds write
- **Root Cause:** A specially crafted TIF image can cause an offset beyond the bounds of a heap allocation to be written. The vulnerability lies in the TIF-parsing functionality of LEADTOOLS 20, specifically within the `L_ConvertBuffer` function. The image width calculation, based on `ImageWidth` and `SamplesPerPixel`, can be manipulated to produce an out-of-bounds offset during data writing.
- **Weakness:** Improper calculation of buffer offset within the `L_ConvertBuffer` function when processing a TIF image. Specifically, the offset calculation is influenced by the `ImageWidth` and `SamplesPerPixel` values in a way that a malicious TIF can make it write out of bounds.
- **Impact:** Code execution.
- **Attack vector:** By crafting a malicious TIF image.
- **Attacker capability:** An attacker can specially craft a TIF image that, when parsed by LEADTOOLS, triggers the out-of-bounds write. User interaction is required to open the malicious TIF file.