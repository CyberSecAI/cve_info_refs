=== Content from github.com_5b1ac164_20250120_235640.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Finversepath%2Fadvisories%2Fblob%2Fmaster%2FSecurity_Advisory-Ref_FSC-HWSEC-VR2019-0001-Xilinx_ZU%2B-Encrypt_Only_Secure_Boot_bypass.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Finversepath%2Fadvisories%2Fblob%2Fmaster%2FSecurity_Advisory-Ref_FSC-HWSEC-VR2019-0001-Xilinx_ZU%2B-Encrypt_Only_Secure_Boot_bypass.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=inversepath%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 14, 2024. It is now read-only.

[inversepath](/inversepath)
/
**[advisories](/inversepath/advisories)**
Public archive

forked from [f-secure-foundry/advisories](/f-secure-foundry/advisories)

* [Notifications](/login?return_to=%2Finversepath%2Fadvisories) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Finversepath%2Fadvisories)
* [Star
   1](/login?return_to=%2Finversepath%2Fadvisories)

* [Code](/inversepath/advisories)
* [Pull requests
  0](/inversepath/advisories/pulls)
* [Actions](/inversepath/advisories/actions)
* [Projects
  0](/inversepath/advisories/projects)
* [Security](/inversepath/advisories/security)
* [Insights](/inversepath/advisories/pulse)

Additional navigation options

* [Code](/inversepath/advisories)
* [Pull requests](/inversepath/advisories/pulls)
* [Actions](/inversepath/advisories/actions)
* [Projects](/inversepath/advisories/projects)
* [Security](/inversepath/advisories/security)
* [Insights](/inversepath/advisories/pulse)

## Files

 master
## Breadcrumbs

1. [advisories](/inversepath/advisories/tree/master)
/
# Security\_Advisory-Ref\_FSC-HWSEC-VR2019-0001-Xilinx\_ZU+-Encrypt\_Only\_Secure\_Boot\_bypass.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/inversepath/advisories/commits/master/Security_Advisory-Ref_FSC-HWSEC-VR2019-0001-Xilinx_ZU%2B-Encrypt_Only_Secure_Boot_bypass.txt)139 lines (99 loc) · 5.91 KB master
## Breadcrumbs

1. [advisories](/inversepath/advisories/tree/master)
/
# Security\_Advisory-Ref\_FSC-HWSEC-VR2019-0001-Xilinx\_ZU+-Encrypt\_Only\_Secure\_Boot\_bypass.txt

Top
## File metadata and controls

* Code
* Blame

139 lines (99 loc) · 5.91 KB[Raw](https://github.com/inversepath/advisories/raw/refs/heads/master/Security_Advisory-Ref_FSC-HWSEC-VR2019-0001-Xilinx_ZU%2B-Encrypt_Only_Secure_Boot_bypass.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139Security advisory: Xilinx ZU+ Encrypt Only Secure Boot bypass=============================================================
The Xilinx Zynq UltraScale+ (ZU+) family of System-on-Chip (SoC) devicessupports a secure boot mode referred to as "encrypt only".
The encrypt only mode is an alternative to the "hardware root of trust" one,allowing secure boot without asymmetric authentication but which instead,quoting the ZU+ reference manual ([1] p279), "requires that all configurationloaded must be encrypted and authenticated using AES-GCM".
Two design flaws have been identified that allow to execute arbitrary code,resulting in loss of authentication and confidentiality, leveraging on the lackof authentication for boot metadata, by means of boot image tampering.
The flaws spawn from the lack of authentication for execution addressesspecified in headers loaded early in the boot stage.
Such headers are not encrypted and, lacking authentication, allow an externalattacker to control, with some restrictions, loaded code execution addresses.
The first design flaw is present in the boot header parsing, performed by theZU+ internal boot ROM. Given that the internal boot ROM cannot be updated, onlya new silicon revision by Xilinx, with an adequately patched boot ROM, canaddress the first vulnerability.
The second flaw is present in the partition header table parsing, performed bythe first-stage boot loader (FSBL). The second vulnerability can be addressedby software means, implementing authentication of the partition header, itsresolution however cannot result in a safe use of the encrypt only mode as longas the first vulnerability remains unresolved.
Loss of authentication allows the adversary sufficient control of the systemsuch that loss of confidentiality can occur as well.
It is highly recommended, for implementers of any secure boot or trust schemewhich involves encryption, using ZU+ P/Ns, to only use the "hardware root oftrust" mode.
Xilinx ZU+ lack of authentication for boot header in encrypt only secure boot-----------------------------------------------------------------------------
The first-stage boot loader (FSBL) execution address is a parameter included inthe boot header, the first section of the boot image loaded by the ZU+ internalboot ROM.
By design, the boot header is not authenticated under the "encrypt only" secureboot mode, this opens up the possibility of malicious tampering of the FSBLexecution address, in a manner that allows arbitrary code execution.
Such tampering can occur when a malicious party has the opportunity ofmodifying the boot header contents, for example by means of local boot device(e.g. SD) tampering.
As a constraint to exploitation, the FSBL execution address must point to theOn-chip memory (OCM) region. This means that the execution address cannot bedirectly pointed at arbitrarily controlled plaintext code stored in externalmemories (e.g. QSPI).
This aspect does not prevent the possibility to exploit the issues, but merelyincreases the difficulty required. A feasible scenario would be identifying aROP “gadget” or jump, within the FSBL payload, which would allow to bypass the“encryption only” strategy enforcement.
Xilinx ZU+ lack of authentication for partition headers in encrypt only secure boot-----------------------------------------------------------------------------------
The destination execution address for boot partitions is a parameter includedin partition headers, sections of the boot image loaded by first-stage bootloader (FSBL).
By design, the partition headers are not authenticated under the "encrypt only"secure boot mode, this opens up the possibility of malicious tampering of thedestination execution address, in a manner that allows arbitrary codeexecution.
Such tampering can occur when a malicious party has the opportunity ofmodifying the boot header contents, for example by means of local boot device(e.g. SD) tampering.
The exploitation of the destination execution address lack of authenticationdoes not pose challenges as it can be manipulated to point at the partitionheader itself, which can be modified to include valid instructions andtherefore achieving arbitrary code execution.
Affected versions-----------------
All Xilinx Zynq UltraScale+ P/Ns are believed to be vulnerable, tests have beenperformed against an Xilinx Zynq UltraScale+ MPSoC ZCU104 Evaluation Kit.
Given that the internal boot ROM cannot be updated, only a new silicon revisionby Xilinx, with an adequately patched boot ROM, can address the boot headerlack of authentication.
The partition header lack of authentication can be theoretically addressed withan FSBL patch, though none is available at this time.
Credit------
Vulnerabilities discovered and reported by the Inverse Path team at F-Secure,in collaboration with Robert Bosch GmbH.
CVE---
CVE-2019-5478: Xilinx ZU+ lack of authentication for boot header in encrypt only secure bootCVE-2019-5478: Xilinx ZU+ lack of authentication for partition headers in encrypt only secure boot
Timeline--------
2019-06-21: findings identified during a security audit by Inverse Path team at F-Secure in collaboration with Robert Bosch GmbH.
2019-06-25: findings shared with Bosch PSIRT.
2019-06-28: findings shared with Xilinx PSIRT.
2019-07-05: Xilinx PSIRT confirms the findings.
2019-07-15: Xilinx PSIRT agrees to public disclosure process, consisting of a Security Design Advisory and updates to the Technical Reference Manual.
2019-08-12: Xilinx Design Advisory [2] and F-Secure advisory [3] release.
2019-09-03: Xilinx communicates assigned CVE.
References----------
[1] https://www.xilinx.com/support/documentation/user\_guides/ug1085-zynq-ultrascale-trm.pdf[2] https://www.xilinx.com/support/answers/72588.html
Permalink---------
[3] https://github.com/f-secure-foundry/advisories/blob/master/Security\_Advisory-Ref\_FSC-HWSEC-VR2019-0001-Xilinx\_ZU+-Encrypt\_Only\_Secure\_Boot\_bypass.txt

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.xilinx.com_36c486c9_20250120_235642.html ===
Loading×Sorry to interruptCSS ErrorRefresh
