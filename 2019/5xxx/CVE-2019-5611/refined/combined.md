=== Content from security.FreeBSD.org_a6c4c455_20250121_012105.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-19:22.mbuf Security Advisory
The FreeBSD Project
Topic: IPv6 remote Denial-of-Service
Category: kernel
Module: net
Announced: 2019-08-20
Credits: Clement Lecigne
Affects: All supported versions of FreeBSD.
Corrected: 2019-08-10 00:01:25 UTC (stable/12, 12.0-STABLE)
2019-08-20 17:49:33 UTC (releng/12.0, 12.0-RELEASE-p10)
2019-08-10 00:02:45 UTC (stable/11, 11.3-STABLE)
2019-08-20 17:49:33 UTC (releng/11.3, 11.3-RELEASE-p3)
2019-08-20 17:49:33 UTC (releng/11.2, 11.2-RELEASE-p14)
CVE Name: CVE-2019-5611
For general information regarding FreeBSD Security Advisories, including
descriptions of the fields above, security branches, and the following
sections, please visit .
I. Background
mbufs are a unit of memory management mostly used in the kernel for network
packets and socket buffers. m\_pulldown(9) is a function to arrange the data
in a chain of mbufs.
II. Problem Description
Due do a missing check in the code of m\_pulldown(9) data returned may not be
contiguous as requested by the caller.
III. Impact
Extra checks in the IPv6 code catch the error condition and trigger a kernel
panic leading to a remote DoS (denial-of-service) attack with certain
Ethernet interfaces. At this point it is unknown if any other than the IPv6
code paths can trigger a similar condition.
IV. Workaround
For the currently known attack vector systems with IPv6 not enabled are not
vulnerable.
On systems with IPv6 active, IPv6 fragmentation may be disabled, or
a firewall can be used to filter out packets with certain or excessive
amounts of extension headers in a first fragment. These rules may be
dependent on the operational needs of each site.
V. Solution
Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date,
and reboot.
1) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
# shutdown -r +10min "Rebooting for security update"
2) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch
# fetch https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch.asc
# gpg --verify mbuf.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile your kernel as described in
 and reboot the
system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/12/ r350828
releng/12.0/ r351259
stable/11/ r350829
releng/11.3/ r351259
releng/11.2/ r351259
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQKTBAEBCgB9FiEE/A6HiuWv54gCjWNV05eS9J6n5cIFAl1cPgFfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEZD
MEU4NzhBRTVBRkU3ODgwMjhENjM1NUQzOTc5MkY0OUVBN0U1QzIACgkQ05eS9J6n
5cK+4w/7BCGyLpeSCIaHMpKdZvSqKc6RptLyxPq1q6XO/5fUxQiBXuwxfZIUO45o
VyQCsuVf0QDeT/HaMJAdTr450RlSs1ozyzEmd2iLfwqmpc8JRemihrzHkNMfny1U
Y4ffN6zyrOLyFeyQcdbgHUKHwuAvGZFhR/PtPJfWDmULi0vW5PHBGjxOQmxKbbUr
6zcR+gKrm5E3vLW4vD2gvsB1RGyOzUBOaEeQU36LE1/W6hhgwtXAkZacEP+W4BiB
jPbG7u23C3a2KcRImCWM2vJ5dZFoa0Mz5+vHzaSMwPT49KRRRRkcd7+azqUfbGg0
k9Py6KuwGhclNmehpUth0NlvR89JV58Fbkh7TaCWHV51hAWoH/1EQdJNY9yb0eAZ
AgsvAiotWU1VNDcF2xWaf5m3VE87jl0/Bz9BgpVFI0kHuof4OwiG9PkdFI1q0Yl2
TdkksZj1iRETN8/Qt5HGzY1pGQFRc7b+nE9GIfIUcEH1B7d7Gb58DVElZ95Og+EF
bGwR6/e7r39mBsqs0qloYgk/2c6B4vuFyt8b9Yhuw4ns0SpO4cP9XYXawUff7+p3
oLo7dqPKn8fMRLhT0/QZfPRyluUshVvJW1Yg9HWdYMYm7wFAilemnMWMxJKIUOmt
pkQx3e6Tvk3VNkls4yv7GbApO5iMNXaBvC2JYMP0GUiQ1FOkB9M=
=ip7/
-----END PGP SIGNATURE-----


=== Content from seclists.org_5094bb52_20250120_231805.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](32)
[By Date](date.html#33)
[![Next](/images/right-icon-16x16.png)](34)

[![Previous](/images/left-icon-16x16.png)](32)
[By Thread](index.html#33)
[![Next](/images/right-icon-16x16.png)](34)

![](/shared/images/nst-icons.svg#search)

# FreeBSD Security Advisory FreeBSD-SA-19:22.mbuf

---

*From*: FreeBSD Security Advisories <security-advisories () freebsd org>

*Date*: Tue, 20 Aug 2019 20:12:53 +0000 (UTC)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

=============================================================================
FreeBSD-SA-19:22.mbuf                                       Security Advisory
                                                          The FreeBSD Project

Topic:          IPv6 remote Denial-of-Service

Category:       kernel
Module:         net
Announced:      2019-08-20
Credits:        Clement Lecigne
Affects:        All supported versions of FreeBSD.
Corrected:      2019-08-10 00:01:25 UTC (stable/12, 12.0-STABLE)
                2019-08-20 17:49:33 UTC (releng/12.0, 12.0-RELEASE-p10)
                2019-08-10 00:02:45 UTC (stable/11, 11.3-STABLE)
                2019-08-20 17:49:33 UTC (releng/11.3, 11.3-RELEASE-p3)
                2019-08-20 17:49:33 UTC (releng/11.2, 11.2-RELEASE-p14)
CVE Name:       CVE-2019-5611

For general information regarding FreeBSD Security Advisories, including
descriptions of the fields above, security branches, and the following
sections, please visit <URL:<https://security.FreeBSD.org/>>.

I.   Background

mbufs are a unit of memory management mostly used in the kernel for network
packets and socket buffers.  m_pulldown(9) is a function to arrange the data
in a chain of mbufs.

II.  Problem Description

Due do a missing check in the code of m_pulldown(9) data returned may not be
contiguous as requested by the caller.

III. Impact

Extra checks in the IPv6 code catch the error condition and trigger a kernel
panic leading to a remote DoS (denial-of-service) attack with certain
Ethernet interfaces.  At this point it is unknown if any other than the IPv6
code paths can trigger a similar condition.

IV.  Workaround

For the currently known attack vector systems with IPv6 not enabled are not
vulnerable.

On systems with IPv6 active, IPv6 fragmentation may be disabled, or
a firewall can be used to filter out packets with certain or excessive
amounts of extension headers in a first fragment.  These rules may be
dependent on the operational needs of each site.

V.   Solution

Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date,
and reboot.

1) To update your vulnerable system via a binary patch:

Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:

# freebsd-update fetch
# freebsd-update install
# shutdown -r +10min "Rebooting for security update"

2) To update your vulnerable system via a source code patch:

The following patches have been verified to apply to the applicable
FreeBSD release branches.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

# fetch [https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch](https://security.FreeBSD.org/patches/SA-19%3A22/mbuf.patch)
# fetch [https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch.asc](https://security.FreeBSD.org/patches/SA-19%3A22/mbuf.patch.asc)
# gpg --verify mbuf.patch.asc

b) Apply the patch.  Execute the following commands as root:

# cd /usr/src
# patch < /path/to/patch

c) Recompile your kernel as described in
<URL:<https://www.FreeBSD.org/handbook/kernelconfig.html>> and reboot the
system.

VI.  Correction details

The following list contains the correction revision numbers for each
affected branch.

Branch/path                                                      Revision
- -------------------------------------------------------------------------
stable/12/                                                        r350828
releng/12.0/                                                      r351259
stable/11/                                                        r350829
releng/11.3/                                                      r351259
releng/11.2/                                                      r351259
- -------------------------------------------------------------------------

To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:

# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base

Or visit the following URL, replacing NNNNNN with the revision number:

<URL:<https://svnweb.freebsd.org/base?view=revision&revision=NNNNNN>>

VII. References

<URL:<https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=238787>>
<URL:<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5611>>

The latest revision of this advisory is available at
<URL:[https://security.FreeBSD.org/advisories/FreeBSD-SA-19:22.mbuf.asc](https://security.FreeBSD.org/advisories/FreeBSD-SA-19%3A22.mbuf.asc)>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEE/A6HiuWv54gCjWNV05eS9J6n5cIFAl1cPgFfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEZD
MEU4NzhBRTVBRkU3ODgwMjhENjM1NUQzOTc5MkY0OUVBN0U1QzIACgkQ05eS9J6n
5cK+4w/7BCGyLpeSCIaHMpKdZvSqKc6RptLyxPq1q6XO/5fUxQiBXuwxfZIUO45o
VyQCsuVf0QDeT/HaMJAdTr450RlSs1ozyzEmd2iLfwqmpc8JRemihrzHkNMfny1U
Y4ffN6zyrOLyFeyQcdbgHUKHwuAvGZFhR/PtPJfWDmULi0vW5PHBGjxOQmxKbbUr
6zcR+gKrm5E3vLW4vD2gvsB1RGyOzUBOaEeQU36LE1/W6hhgwtXAkZacEP+W4BiB
jPbG7u23C3a2KcRImCWM2vJ5dZFoa0Mz5+vHzaSMwPT49KRRRRkcd7+azqUfbGg0
k9Py6KuwGhclNmehpUth0NlvR89JV58Fbkh7TaCWHV51hAWoH/1EQdJNY9yb0eAZ
AgsvAiotWU1VNDcF2xWaf5m3VE87jl0/Bz9BgpVFI0kHuof4OwiG9PkdFI1q0Yl2
TdkksZj1iRETN8/Qt5HGzY1pGQFRc7b+nE9GIfIUcEH1B7d7Gb58DVElZ95Og+EF
bGwR6/e7r39mBsqs0qloYgk/2c6B4vuFyt8b9Yhuw4ns0SpO4cP9XYXawUff7+p3
oLo7dqPKn8fMRLhT0/QZfPRyluUshVvJW1Yg9HWdYMYm7wFAilemnMWMxJKIUOmt
pkQx3e6Tvk3VNkls4yv7GbApO5iMNXaBvC2JYMP0GUiQ1FOkB9M=
=ip7/
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](32)
[By Date](date.html#33)
[![Next](/images/right-icon-16x16.png)](34)

[![Previous](/images/left-icon-16x16.png)](32)
[By Thread](index.html#33)
[![Next](/images/right-icon-16x16.png)](34)

### Current thread:

* **FreeBSD Security Advisory FreeBSD-SA-19:22.mbuf** *FreeBSD Security Advisories (Aug 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugs.freebsd.org_1880a4be_20250121_012105.html ===


FreeBSD Bugzilla – Bug 238787
IPv6 remote DoS (panic) vulnerability via m\_pulldown() bug
Last modified: 2019-11-13 01:49:54 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](page.cgi?id=reporting.html)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=238787&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=238787&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 238787**](show_bug.cgi?id=238787)
- IPv6 remote DoS (panic) vulnerability via m\_pulldown() bug

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
IPv6 remote DoS (panic) vulnerability via m\_pulldown() bug

| | [Status](page.cgi?id=fields.html#bug_status): | Closed FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Base System | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Base System "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | kern ([show other bugs](buglist.cgi?component=kern&product=Base%20System&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | CURRENT | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Any Any | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal Affects Many People | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Jonathan T. Looney | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | crash, security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2019-06-24 11:51 UTC by crest | | --- | --- | | Modified: | 2019-11-13 01:49 UTC ([History](show_activity.cgi?id=238787)) | | CC List: | 8 users (show)  bz chris emaste gnn jtl koobs secteam sigsys | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://gnats.netbsd.org/30098> | |  | | | Flags: | koobs: mfc-stable12+ koobs: mfc-stable11+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=238787&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=238787&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=238787#c0)  crest    2019-06-24 11:51:47 UTC  ``` A bug supposedly reported years ago is still unfixed in FreeBSD according to this post from a few hours ago:  <https://www.reddit.com/r/BSD/comments/c4krwr/freebsd_ipv6_remote_dingdong_attack_kernel_panic/?ref=share&ref_source=link> archived at: [https://web.archive.org/web/20190624115041/https://www.reddit.com/r/BSD/comments/c4krwr/freebsd_ipv6_remote_dingdong_attack_kernel_panic/?ref=share&ref_source=link](https://web.archive.org/web/20190624115041/https%3A//www.reddit.com/r/BSD/comments/c4krwr/freebsd_ipv6_remote_dingdong_attack_kernel_panic/?ref=share&ref_source=link). ```  [Comment 1](show_bug.cgi?id=238787#c1)  Mark Linimon   freebsd_committer freebsd_triage  2019-06-24 11:56:34 UTC  ``` Fix assignment.  Hadn't had enough caffeine yet. ```  [Comment 2](show_bug.cgi?id=238787#c2)  Kubilay Kocak   freebsd_committer freebsd_triage  2019-06-24 12:06:46 UTC  ``` Could not find references for "reported to and publicly acknowledged by FreeBSD in 2006".  If any existing bug exists, please close this as a duplicate of that and retriage that one. ```  [Comment 3](show_bug.cgi?id=238787#c3)  crest    2019-06-24 12:14:14 UTC  ``` I haven't found an open PR with crashes in m_pulldown which is why I created a new PR instead of adding a comment to the existing report, but if the message was send to the security team and got dropped as the reddit post implies there might not be any publicly visible PR for it. Now that the report was posted in a public forum any further discussion should probably happen in the open as well. ```  [Comment 4](show_bug.cgi?id=238787#c4)  Kubilay Kocak   freebsd_committer freebsd_triage  2019-06-24 13:02:28 UTC  ``` OpenBSD Commit:  <https://github.com/openbsd/src/commit/993ebdb685a594e5fe7427998c1025b419e85db6> ```  [Comment 5](show_bug.cgi?id=238787#c5)  Ed Maste   freebsd_committer freebsd_triage  2019-06-24 13:48:10 UTC  ``` NetBSD bug report and analysis: <http://gnats.netbsd.org/30098> ```  [Comment 6](show_bug.cgi?id=238787#c6)  Ed Maste   freebsd_committer freebsd_triage  2019-08-08 04:03:25 UTC  ``` NetBSD change: <https://github.com/NetBSD/src/commit/1f94be1791b90c41bfadc9b0aa0621df55213659>  XNU change: <https://github.com/apple/darwin-xnu/commit/5bbb823c13f3ab1ab58878f96b35433a29882676> ```  [Comment 7](show_bug.cgi?id=238787#c7)  commit-hook   freebsd_committer freebsd_triage  2019-08-09 05:20:00 UTC  ``` A commit references this bug:  Author: jtl Date: Fri Aug  9 05:19:00 UTC 2019 New revision: 350815 URL: <https://svnweb.freebsd.org/changeset/base/350815>  Log:   In m_pulldown(), before trying to prepend bytes to the subsequent mbuf,   ensure that the subsequent mbuf contains the remainder of the bytes   the caller sought. If this is not the case, fall through to the code   which gathers the bytes in a new mbuf.    This fixes a bug where m_pulldown() could fail to gather all the desired   bytes into consecutive memory.    PR:		238787   Reported by:	A reddit user   Discussed with:	emaste   Obtained from:	NetBSD   MFC after:	3 days  Changes:   head/sys/kern/uipc_mbuf2.c ```  [Comment 8](show_bug.cgi?id=238787#c8)  Jonathan T. Looney   freebsd_committer freebsd_triage  2019-08-09 05:22:38 UTC  ``` I was able to replicate the crash. The fix from NetBSD fixed the crash. After discussing it with emaste@, I committed the fix to head. ```  [Comment 9](show_bug.cgi?id=238787#c9)  crest    2019-08-09 11:32:05 UTC  ``` Why wasn't the reddit user named by his/her nickname as "TheGrandSchlonging"? ```  [Comment 10](show_bug.cgi?id=238787#c10)  Ed Maste   freebsd_committer freebsd_triage  2019-08-09 12:03:00 UTC  ``` Because they've said in the past > nor do I want "TheGrandSchlonging" to appear in FreeBSD commit logs ```  [Comment 11](show_bug.cgi?id=238787#c11)  Kubilay Kocak   freebsd_committer freebsd_triage  2019-08-09 12:17:10 UTC  ``` Assign to committer resolving (keep secteam CC'd) ```  [Comment 12](show_bug.cgi?id=238787#c12)  commit-hook   freebsd_committer freebsd_triage  2019-08-10 00:01:29 UTC  ``` A commit references this bug:  Author: jtl Date: Sat Aug 10 00:01:26 UTC 2019 New revision: 350828 URL: <https://svnweb.freebsd.org/changeset/base/350828>  Log:   MFC r350815:     In m_pulldown(), before trying to prepend bytes to the subsequent mbuf,     ensure that the subsequent mbuf contains the remainder of the bytes     the caller sought. If this is not the case, fall through to the code     which gathers the bytes in a new mbuf.      This fixes a bug where m_pulldown() could fail to gather all the desired     bytes into consecutive memory.    PR:		238787   Approved by:	so (emaste)  Changes: _U  stable/12/   stable/12/sys/kern/uipc_mbuf2.c ```  [Comment 13](show_bug.cgi?id=238787#c13)  commit-hook   freebsd_committer freebsd_triage  2019-08-10 00:03:32 UTC  ``` A commit references this bug:  Author: jtl Date: Sat Aug 10 00:02:46 UTC 2019 New revision: 350829 URL: <https://svnweb.freebsd.org/changeset/base/350829>  Log:   MFC r350815:     In m_pulldown(), before trying to prepend bytes to the subsequent mbuf,     ensure that the subsequent mbuf contains the remainder of the bytes     the caller sought. If this is not the case, fall through to the code     which gathers the bytes in a new mbuf.      This fixes a bug where m_pulldown() could fail to gather all the desired     bytes into consecutive memory.    PR:		238787   Approved by:	so (emaste)  Changes: _U  stable/11/   stable/11/sys/kern/uipc_mbuf2.c ```  [Comment 14](show_bug.cgi?id=238787#c14)  Ed Maste   freebsd_committer freebsd_triage  2019-08-13 20:54:09 UTC  ``` Original report can be found at <http://web.archive.org/web/20091116125618/clem1.be/gimme/ipv6sec.pdf> ```  [Comment 15](show_bug.cgi?id=238787#c15)  Bjoern A. Zeeb   freebsd_committer freebsd_triage  2019-11-12 22:19:03 UTC  ``` This was published as FreeBSD-SA-19:22.mbuf and with that I assume can be closed. ```  [Comment 16](show_bug.cgi?id=238787#c16)  Kubilay Kocak   freebsd_committer freebsd_triage  2019-11-13 01:49:54 UTC  ``` ^Triage: Track merge status ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=238787)
* - [XML](show_bug.cgi?ctype=xml&id=238787)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=238787)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](page.cgi?id=reporting.html)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=238787&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=238787&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.FreeBSD.org_bfa8daee_20250121_012051.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-19:22.mbuf Security Advisory
The FreeBSD Project
Topic: IPv6 remote Denial-of-Service
Category: kernel
Module: net
Announced: 2019-08-20
Credits: Clement Lecigne
Affects: All supported versions of FreeBSD.
Corrected: 2019-08-10 00:01:25 UTC (stable/12, 12.0-STABLE)
2019-08-20 17:49:33 UTC (releng/12.0, 12.0-RELEASE-p10)
2019-08-10 00:02:45 UTC (stable/11, 11.3-STABLE)
2019-08-20 17:49:33 UTC (releng/11.3, 11.3-RELEASE-p3)
2019-08-20 17:49:33 UTC (releng/11.2, 11.2-RELEASE-p14)
CVE Name: CVE-2019-5611
For general information regarding FreeBSD Security Advisories, including
descriptions of the fields above, security branches, and the following
sections, please visit .
I. Background
mbufs are a unit of memory management mostly used in the kernel for network
packets and socket buffers. m\_pulldown(9) is a function to arrange the data
in a chain of mbufs.
II. Problem Description
Due do a missing check in the code of m\_pulldown(9) data returned may not be
contiguous as requested by the caller.
III. Impact
Extra checks in the IPv6 code catch the error condition and trigger a kernel
panic leading to a remote DoS (denial-of-service) attack with certain
Ethernet interfaces. At this point it is unknown if any other than the IPv6
code paths can trigger a similar condition.
IV. Workaround
For the currently known attack vector systems with IPv6 not enabled are not
vulnerable.
On systems with IPv6 active, IPv6 fragmentation may be disabled, or
a firewall can be used to filter out packets with certain or excessive
amounts of extension headers in a first fragment. These rules may be
dependent on the operational needs of each site.
V. Solution
Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date,
and reboot.
1) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
# shutdown -r +10min "Rebooting for security update"
2) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch
# fetch https://security.FreeBSD.org/patches/SA-19:22/mbuf.patch.asc
# gpg --verify mbuf.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile your kernel as described in
 and reboot the
system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/12/ r350828
releng/12.0/ r351259
stable/11/ r350829
releng/11.3/ r351259
releng/11.2/ r351259
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQKTBAEBCgB9FiEE/A6HiuWv54gCjWNV05eS9J6n5cIFAl1cPgFfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEZD
MEU4NzhBRTVBRkU3ODgwMjhENjM1NUQzOTc5MkY0OUVBN0U1QzIACgkQ05eS9J6n
5cK+4w/7BCGyLpeSCIaHMpKdZvSqKc6RptLyxPq1q6XO/5fUxQiBXuwxfZIUO45o
VyQCsuVf0QDeT/HaMJAdTr450RlSs1ozyzEmd2iLfwqmpc8JRemihrzHkNMfny1U
Y4ffN6zyrOLyFeyQcdbgHUKHwuAvGZFhR/PtPJfWDmULi0vW5PHBGjxOQmxKbbUr
6zcR+gKrm5E3vLW4vD2gvsB1RGyOzUBOaEeQU36LE1/W6hhgwtXAkZacEP+W4BiB
jPbG7u23C3a2KcRImCWM2vJ5dZFoa0Mz5+vHzaSMwPT49KRRRRkcd7+azqUfbGg0
k9Py6KuwGhclNmehpUth0NlvR89JV58Fbkh7TaCWHV51hAWoH/1EQdJNY9yb0eAZ
AgsvAiotWU1VNDcF2xWaf5m3VE87jl0/Bz9BgpVFI0kHuof4OwiG9PkdFI1q0Yl2
TdkksZj1iRETN8/Qt5HGzY1pGQFRc7b+nE9GIfIUcEH1B7d7Gb58DVElZ95Og+EF
bGwR6/e7r39mBsqs0qloYgk/2c6B4vuFyt8b9Yhuw4ns0SpO4cP9XYXawUff7+p3
oLo7dqPKn8fMRLhT0/QZfPRyluUshVvJW1Yg9HWdYMYm7wFAilemnMWMxJKIUOmt
pkQx3e6Tvk3VNkls4yv7GbApO5iMNXaBvC2JYMP0GUiQ1FOkB9M=
=ip7/
-----END PGP SIGNATURE-----


=== Content from packetstormsecurity.com_04a1a8dd_20250120_231804.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from security.netapp.com_044bdedb_20250120_231806.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [September 2019 FreeBSD Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20190910-0002)

## September 2019 FreeBSD Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20190910-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20190910-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20190910-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20190910-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20190910-0002
**Version:**
3.0

**Last updated:**
01/24/2020

**Status:**
Final.

**CVEs:** CVE-2019-5608, CVE-2019-5609, CVE-2019-5610, CVE-2019-5611, CVE-2019-5612

Overview
#### Summary

Multiple NetApp products incorporate FreeBSD. FreeBSD versions 12.0-STABLE before r351264, 12.0-RELEASE before 12.0-RELEASE-p10, 11.3-STABLE before r351265, 11.3-RELEASE before 11.3-RELEASE-p3, and 11.2-RELEASE before 11.2-RELEASE-p14 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-5608](https://nvd.nist.gov/vuln/detail/CVE-2019-5608) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-5609](https://nvd.nist.gov/vuln/detail/CVE-2019-5609) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2019-5610](https://nvd.nist.gov/vuln/detail/CVE-2019-5610) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-5611](https://nvd.nist.gov/vuln/detail/CVE-2019-5611) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-5612](https://nvd.nist.gov/vuln/detail/CVE-2019-5612) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* [https://security.FreeBSD.org/advisories/FreeBSD-SA-19:19.mldv2.asc](https://security.FreeBSD.org/advisories/FreeBSD-SA-19%3A19.mldv2.asc)
* [https://security.freebsd.org/advisories/FreeBSD-SA-19:21.bhyve.asc](https://security.freebsd.org/advisories/FreeBSD-SA-19%3A21.bhyve.asc)
* [https://security.freebsd.org/advisories/FreeBSD-SA-19:20.bsnmp.asc](https://security.freebsd.org/advisories/FreeBSD-SA-19%3A20.bsnmp.asc)
* [https://security.freebsd.org/advisories/FreeBSD-SA-19:22.mbuf.asc](https://security.freebsd.org/advisories/FreeBSD-SA-19%3A22.mbuf.asc)
* [https://security.freebsd.org/advisories/FreeBSD-SA-19:23.midi.asc](https://security.freebsd.org/advisories/FreeBSD-SA-19%3A23.midi.asc)

Affected Products
#### Affected Products

* Clustered Data ONTAP

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Linux 7.3 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Windows 7.3 and above
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity Management Plug-ins (VMware vCenter)
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element HealthTools
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC)
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MAX Data
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp Data Availability Services
* NetApp E-Series Performance Analyzer
* NetApp Element System Firmware
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Service Level Manager
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Baseboard Management Controller (BMC)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SteelStore Cloud Integrated Storage
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 3.x
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* SANtricity Unified Manager
* SAS Firmware
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID Webscale NAS Bridge
* StorageGRID9 (9.x and prior)
* System Setup
* Trident
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Clustered Data ONTAP** | <https://mysupport.netapp.com/products/ontap9/9.3P18/> <https://mysupport.netapp.com/products/ontap9/9.5P10/> <https://mysupport.netapp.com/products/ontap9/9.6P5/> <https://mysupport.netapp.com/products/ontap9/9.7/> Fixed under bug 1267438. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20190910-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20190910 | Initial Public Release |
| 2.0 | 20190918 | Clustered Data ONTAP moved to Affected Products and Data ONTAP operating in 7-Mode moved to Products Not Affected |
| 3.0 | 20200124 | Clustered Data ONTAP added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)


