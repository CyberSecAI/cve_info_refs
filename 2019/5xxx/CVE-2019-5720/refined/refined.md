```text
RELATED
```

- **Vulnerability:** SQL Injection
- **Root Cause:** The application uses the `db_escape()` function for escaping values, but some variables are not properly escaped before being used in SQL queries. Specifically, the `$reference` and `$type` parameters are vulnerable.
- **Affected areas:**
  - `includes/db/class.reflines_db.inc:156`
  - `includes/references.inc:365`
  - `admin/db/voiding_db.inc:127`
  - `admin/void_transaction.php:316`
  - `admin/void_transaction.php:352`
  - `purchasing/includes/db/grn_db.inc:170`
  - `purchasing/includes/db/grn_db.inc:99`
  - `purchasing/po_receive_items.php:254`
- **Attack Vectors:** By manipulating the `$reference` and `$type` parameters in HTTP POST requests.
- **Impact:** An attacker can inject arbitrary SQL code, potentially leading to data breaches, modification, or deletion.
- **Details:**
  - The `$type` variable is used in a `switch` statement, but the comparison is flawed as `'25' == '+25dasdasdasd'` evaluates to true in PHP.
  - MySQL's implicit type conversion allows strings to be treated as integers, exacerbating the vulnerability.
  - MySQL's SQL Truncation behavior can be exploited to bypass certain input validation checks.
- **Exploit/Proof of Concept:** The provided PoC demonstrates how to inject SQL code through the `ref` parameter in `purchasing/po_entry_items.php` and the `filterType` parameter in `admin/void_transaction.php`.
```