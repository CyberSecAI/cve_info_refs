- **Root cause of vulnerability**: A bug in the V8 JavaScript engine (version 7.5.45 and prior) within Foxit PDF Reader. The bug occurs due to an incorrect check when handling arrays with a large length. Specifically, setting an array's length to `INT32_MAX` (0xffffffff) causes `Array.prototype.includes()` to take a very slow path. This slow path iterates over every element of the array, allocating large amounts of memory leading to an out-of-memory condition.
- **Weaknesses/vulnerabilities present**:
  - **Memory Corruption:** The incorrect handling of large array lengths in the `includes()` function results in an out-of-memory condition. Foxit's handling of this exception leaves the JavaScript engine in an unstable state which leads to a memory corruption vulnerability.
  - **Improper Handling of Exceptional Conditions (CWE-703):** The out-of-memory exception is caught but not properly handled, causing the program to continue in an undefined state.
- **Impact of exploitation**: Successful exploitation can lead to arbitrary code execution. In the provided example, it initially leads to a crash due to an access violation but it could be further abused for code execution.
- **Attack vectors**:
  - **Malicious PDF document:** An attacker can create a specially crafted PDF document that triggers the vulnerability when opened by a user. The PDF document contains Javascript code to trigger the vulnerability.
  - **Malicious website:** If the browser plugin extension for Foxit PDF Reader is enabled, visiting a malicious website could also trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs to either trick the user into opening a malicious PDF file or lure them to a malicious website with the browser plugin enabled.