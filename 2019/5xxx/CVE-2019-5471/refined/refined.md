- **Root cause of vulnerability**: The application fails to sanitize branch names containing special characters such as `<` and `>` before sending them in emails, resulting in the email being rendered as HTML.
- **Weaknesses/vulnerabilities present**:
    - Persistent Cross-Site Scripting (XSS) vulnerability.
    - Lack of input sanitization for branch names.
- **Impact of exploitation**:
    -  An attacker can inject arbitrary JavaScript code into the email, which will be executed when the email is viewed in a vulnerable email client or in the letter opener.
    - Potentially, attacker can use Gitlab's name to mislead users.
    - An attacker can send malicious emails to any Gitlab user by adding them as a member of their own repo.
- **Attack vectors**:
    - Creating a branch with a malicious name containing XSS payloads through the Git client or API.
    - Forking a repository, creating a malicious branch, making changes, and creating a merge request to the original repo.
    - Adding Gitlab users to a repository under attacker's control, and assigning them to review merge requests with malicious branch names.
- **Required attacker capabilities/position**:
    -  Ability to create branches and merge requests.
    -  Ability to fork repositories.
    -  Ability to add users as members to a repository controlled by the attacker.
    -  No special privileges are required other than a regular Gitlab user account.