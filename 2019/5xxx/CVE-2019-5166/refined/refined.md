- **Root cause of vulnerability:** A stack buffer overflow occurs in the `iocheckd` service when parsing a specially crafted XML cache file (`/tmp/iocheckCache.xml`). Specifically, the `dns` parameter within the XML can be manipulated to cause an overflow when its content is used as an argument to the `sprintf()` function, leading to a crash and code execution.
- **Weaknesses/vulnerabilities present:**
    - Stack buffer overflow (CWE-120) due to insufficient bounds checking when copying the DNS value into a fixed-size buffer.
    - The vulnerable XML cache file (`/tmp/iocheckCache.xml`) is globally writeable, allowing any user to place malicious content.
- **Impact of exploitation:**
    - Code execution: An attacker can execute arbitrary code by overflowing the buffer.
- **Attack vectors:**
    - The attacker must first write a malicious XML file to `/tmp/iocheckCache.xml` on the device.
    - The vulnerability can then be triggered by sending the `BC_SaveParameter` message, which will cause the `iocheckCache.xml` file to be parsed.
- **Required attacker capabilities/position:**
    - The attacker needs to have write access to the `/tmp` directory on the WAGO PFC200 device to place the crafted XML file.
    - The attacker needs to be able to send the `BC_SaveParameter` message to trigger the parsing of this file.