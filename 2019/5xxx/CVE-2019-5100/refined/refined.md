- **Root cause of vulnerability:** Integer overflow in the calculation of buffer size during BMP image parsing. The `biWidth` field from the BMP header is multiplied by 4 to determine the buffer size. A large `biWidth` value can cause an integer overflow, leading to a smaller-than-required buffer allocation.
- **Weaknesses/vulnerabilities present:**
    - Integer overflow (CWE-190): The multiplication of `biWidth` by 4 can result in an integer overflow if `biWidth` is sufficiently large, leading to an undersized buffer.
    - Buffer overflow: Because of the undersized buffer, the subsequent `memmove` operation copies more data than the buffer can hold, resulting in a heap-based buffer overflow.
- **Impact of exploitation:**  Arbitrary code execution due to the heap buffer overflow, as the attacker can overwrite adjacent memory regions.
- **Attack vectors:**
    -  A specially crafted BMP image file with a large `biWidth` value is required to trigger the integer overflow and subsequent buffer overflow.
- **Required attacker capabilities/position:** An attacker needs to provide a specially crafted BMP file to be processed by the vulnerable LEADTOOLS library. User interaction is required to open the malicious image.