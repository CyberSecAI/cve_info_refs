=== Content from talosintelligence.com_6ecc121d_20250121_010103.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0939

## WAGO PFC100/200 Web-Based Management (WBM) FastCGI configuration insufficient resource pool denial of service

##### March 9, 2020

##### CVE Number

CVE-2019-5149

### Summary

The WBM web application on firmwares prior to 03.02.02 and 03.01.07 on the WAGO PFC100 and PFC2000, respectively, runs on a lighttpd web server and makes use of the FastCGI module, which is intended to “provide high performance for all Internet applications without the penalties of Web server APIs.” However, the default configuration of this module appears to limit the number of concurrent php-cgi processes to two, which can be abused to cause a denial of service of the entire web server.

### Tested Versions

WAGO PFC200 Firmware version 03.00.39(12)
WAGO PFC200 Firmware version 03.01.07(13)
WAGO PFC100 Firmware version 03.00.39(12)
WAGO PFC100 Firmware version 03.02.02(14)

Based on inspection of various firmware versions, this vulnerability appears to impact all versions from the current and going back to at least 10 and likely earlier.

### Product URLs

* <https://www.wago.com/us/pfc200>
* <https://www.wago.com/us/pfc100>

### CVSSv3 Score

5.3 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

### CWE

CWE-410: Insufficient Resource Pool

### Details

The WAGO PFC100 and PFC200 devices are programmable automation controllers that boast high cybersecurity standards by including VPN, SSL and firewall software. WAGO controllers are used in many industries including automotive, rail, power engineering, manufacturing, and building management.

The WBM web application runs on a lighttpd web server and makes use of the FastCGI module which is intended to “provide high performance for all Internet applications without the penalties of Web server APIs.” However, the default configuration of this module appears to limit the number of concurrent php-cgi processes to two, which can be abused to cause a DoS of the entire web server.

The default configuration in `/etc/lighttpd/mod_fastcgi.conf`:

```
fastcgi.server += (
".php" =>
( "localhost" =>
    (
    "socket" => "/tmp/php-fastcgi.socket",
    "bin-path" => "/usr/bin/php-cgi",
    "min-procs" => 1,
    "max-procs" => 2,
    "max-load-per-proc" => 8,
    "idle-timeout" => 50,
    # Fix PATH_INFO for PHP scripts that rely on it (like Wordpress).
    "broken-scriptfilename" => "enable"
    )of
)
)

```

By sending several malicious requests it is possible for an attacker to indefinitely deny legitimate access to the WBM web application.

### Exploit Proof of Concept

Sending a POST to /wbm/login.php with the username “admin” or “user” and large password (tens-of-thousands of characters) will result in around a 50 second DoS of the WBM web application (the idle timeout specified in the mod\_fastcgi config) due to the use of PHP crypt() as described in TALOS-2019-XXXX.

```
{"username":"admin","password":"a"*30000}

```

The web server is configured (via fastcgi) to allow no more than two concurrent processes. By sending a large number of the above requests the web server will attempt to process all of them, two at a time, for 50 seconds each, resulting in an DoS of the web server for a potentially indefinite length of time.

Note that this example is used to illustrate the ease of exploitation of this vulnerability but it is by no means the only way to do so.

### Timeline

2019-10-23 - Vendor passed to CERT@VDE for coordination/handling

2019-12-16 - Disclosure deadline extended

2020-01-28 - Talos discussion about vulnerabilities with Vendor

2020-03-09 - Public Release

##### Credit

Discovered by Patrick DeSantis of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2019-0923](/vulnerability_reports/TALOS-2019-0923) [Previous Report

TALOS-2019-0899](/vulnerability_reports/TALOS-2019-0899)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


