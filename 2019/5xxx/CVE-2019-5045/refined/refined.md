- **Root cause of vulnerability**: A heap-based buffer overflow in the PDF parsing functionality when processing a specially crafted JPEG2000 image embedded within a PDF file. The vulnerability stems from an improperly sized memory allocation during the parsing of the `siz` block of a JPEG2000 codestream, specifically related to the `ssizDepth` value.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflow (CWE-122). The vulnerability lies in how NitroPDF calculates and allocates memory for handling JPEG2000 image data within PDF files. An overly large `ssizDepth` value in the JPEG2000 `siz` block triggers an undersized heap allocation. Subsequent processing of the file leads to out-of-bounds write access to the heap due to lack of proper size checks, resulting in a heap overflow.
- **Impact of exploitation**: Arbitrary code execution. The heap overflow can be exploited to overwrite adjacent heap memory, leading to arbitrary code execution by carefully manipulating the content of the image and the sizes involved.
- **Attack vectors**: The attack vector is a malicious PDF file containing a crafted JPEG2000 image.
- **Required attacker capabilities/position**: The attacker needs to craft a malicious PDF file with a specially crafted JPEG2000 image to trigger the vulnerability. The victim needs to open the malicious PDF file using the vulnerable version of NitroPDF.