=== Content from talosintelligence.com_e7aaf262_20250120_232246.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0819

## NitroPDF Page Kids Remote Code Execution Vulnerability

##### October 9, 2019

##### CVE Number

CVE-2019-5050

### Summary

A specifically crafted PDF file can lead to a heap corruption when opened in NitroPDF 12.12.1.522. With careful memory manipulation, this can lead to arbitrary code execution. In order to trigger this vulnerability, the victim would need to open the malicious file.

### Tested Versions

NitroPDF 12.12.1.522

### Product URLs

<https://www.gonitro.com/>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-122: Heap Based Buffer Overflow

### Details

A potential remote code execution vulnerability exists in the PDF parsing functionality of Nitro Pro. A specially crafted PDF file can tirgger this vulnerability resulting in potential code execution.

While parsing the page tree of the PDF document, a parser confusion can lead to `/Page` objects being considered as `/Pages` object. In general, `/Pages` object contains an array of `/Kids` objects which can themselves be of type `/Pages` or `/Page`. Page object is supposed to define the contents of the page. In NitroPDF, when the `/Page` object, wrongfully, contains a `/Kids` array along with `/Count` value specifying the number of expected kid objects, this `/Page` object is parsed as a `/Pages` object. Additionally, if there’s a discrepancy in actual objects being present in the document, the number of objects in `/Kids` array and the value of `/Count`, an out of bounds memory access on the heap can be triggered. The following part of the PDF document causes a crash:

```
2 0 obj
<<
/Count 1
/Kids [  3 0 R ]
>>
endobj

3 0 obj
<<
/Type /Page
/Count 20
/Kids [ 4 0 R ]
>>
endobj

```

Object `2 0` is a proper `/Pages` document and points to `3 0` an its `/Kids`. Object `3 0` in turn declares itself having a type of `/Page` instead of `/Pages` but still has both `/Kids` and `/Count`. Parsing this in NitroPDF results in the following crash:

```
(3d18.6774): Access violation - code c0000005 (!!! second chance !!!)
npdf!PDDocUpdateTextCache+0x5400:
00007ff9`1dee6890 410f1001        movups  xmm0,xmmword ptr [r9] ds:000001be`3fc211c0=????????????????????????????????
0:000> k 5
 # Child-SP          RetAddr           Call Site
00 00000030`f49fe090 00007ff9`1ded52b4 npdf!PDDocUpdateTextCache+0x5400
01 00000030`f49fe0d0 00007ff9`1dedbfba npdf!PDWordFinderReleaseWordList+0x10d44
02 00000030`f49fe210 00007ff9`1deeadee npdf!PDDocAcquirePage+0x3a
03 00000030`f49fe260 00007ff9`1dee6de3 npdf!PDDocUpdateTextCache+0x995e
04 00000030`f49fe2a0 00007ff9`1dee0811 npdf!PDDocUpdateTextCache+0x5953

```

The above crash is due to access to read access to invalid memory pointed by `r9`. If we take a look at the rest of the crashing basic block we can see:

```
.text:00000001803C6890 movups  xmm0, xmmword ptr [r9]
.text:00000001803C6894 add     r9, 18h
.text:00000001803C6898 add     rax, 18h
.text:00000001803C689C movups  xmmword ptr [rax-18h], xmm0
.text:00000001803C68A0 movsd   xmm1, qword ptr [r9-8]
.text:00000001803C68A6 movsd   qword ptr [rax-8], xmm1
.text:00000001803C68AB cmp     r9, rcx
.text:00000001803C68AE jnz     short loc_1803C6890

```

Above code is essentially a for loop that copies contents from memory pointed to by `r9` to buffer pointed to by `rax`. In each loop, the addresses are increased by 0x18. So, we have a case of out of bounds read followed directly by write. The initial out of bounds value in `r9` is actually the 4th argument to this function and `rax` comes, indirectly, from the 3rd. If we step back to the point where this function is called, we can see the following in `r9` and `r8` (source and destination respectively) registers:

```
npdf!PDWordFinderReleaseWordList+0x10d3f:
00007ff9`1ded52af e87c150100      call    npdf!PDDocUpdateTextCache+0x53a0 (00007ff9`1dee6830)
0:000> ?r8
Evaluate expression: 1863222632440 = 000001b1`d0b91ff8
0:000> ?r9
Evaluate expression: 1863222632896 = 000001b1`d0b921c0
0:000> dd r9
000001b1`d0b921c0  ???????? ???????? ???????? ????????
000001b1`d0b921d0  ???????? ???????? ???????? ????????
000001b1`d0b921e0  ???????? ???????? ???????? ????????
000001b1`d0b921f0  ???????? ???????? ???????? ????????
000001b1`d0b92200  ???????? ???????? ???????? ????????
000001b1`d0b92210  ???????? ???????? ???????? ????????
000001b1`d0b92220  ???????? ???????? ???????? ????????
000001b1`d0b92230  ???????? ???????? ???????? ????????

```

So, when the function is called for the first time, the register `r9` already points out of bounds to invalid memory. The code just prior to this function call actually calculates the offset which causes an out of bounds heap access:

```
00007ff9`1ded5286 488b4628        mov     rax,qword ptr [rsi+28h]
00007ff9`1ded528a 8bcb            mov     ecx,ebx
00007ff9`1ded528c 48ffc1          inc     rcx
00007ff9`1ded528f 488d1449        lea     rdx,[rcx+rcx*2]                   [1]
00007ff9`1ded5293 4c8d0cd0        lea     r9,[rax+rdx*8]                    [2]
00007ff9`1ded5297 8b5c2440        mov     ebx,dword ptr [rsp+40h]
00007ff9`1ded529b 488d0c5b        lea     rcx,[rbx+rbx*2]                   [3]
00007ff9`1ded529f 4c8d04c8        lea     r8,[rax+rcx*8]                    [4]
00007ff9`1ded52a3 488d942488000000 lea     rdx,[rsp+88h]
00007ff9`1ded52ab 488d4e28        lea     rcx,[rsi+28h]
00007ff9`1ded52af e87c150100      call    npdf!PDDocUpdateTextCache+0x53a0 (00007ff9`1dee6830)

```

At [1] above, the index into the array is calculated into `rdx`. The value in `rcx` comes directly from the `/Count` value in the object. Then at [2], the offset into the memory array is calculated, and `r9` points to its final value. Similarly at [3] and [4], the destination pointer is calculated, only the value in `ebx` actually represents the number of valid `/Page` objects found so far.

It should be noted that this parser confusion can be nested any number of levels into the page tree which has influence on memory layout and pointer arithmetic. By manipulating this layout, the valid `/Page` and other objects in the PDF document, this bug can result in arbitrary out of bounds memory access. By carefully controlling the memory contents adjacent the overflown chunk, this overflow can potentially be abused to overwrite adjacent heap memory which can ultimately lead to arbitrary code execution.

### Timeline

2019-05-07 - Vendor disclosure

2019-07-02 - 60 day follow up

2019-07-29 - 2nd follow up (90 days approaching notice)

2019-08-06 - 3rd follow up

2019-08-07 - Vendor acknowledged & advised prior emails went to spam folder; Talos issued copy of report

2019-09-03 - Talos granted disclosure extension to 2019-09-10

2019-09-05 - Vendor advised issues will be addressed in a future release (timeline unknown)

2019-10-09 - Public Disclosure

##### Credit

Discovered by Aleksandar Nikolic of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2019-0830](/vulnerability_reports/TALOS-2019-0830) [Previous Report

TALOS-2019-0817](/vulnerability_reports/TALOS-2019-0817)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


