This document provides detailed information about CVE-2019-5179 and related vulnerabilities.

**Root cause of vulnerability:**
- Stack-based buffer overflow when parsing a crafted XML cache file (`/tmp/iocheckCache.xml`). Specifically, the `ntp` parameter within the XML is vulnerable.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow: The `sprintf` function is used to format a string with the content of the `ntp` node from the XML file. The destination buffer on the stack is smaller than the potentially larger input from the XML, leading to a buffer overflow.
- Insecure file permissions: The `/tmp/iocheckCache.xml` file is globally writeable, allowing any user to write to it. This allows an attacker to place a malicious XML file for parsing by the iocheckd service.

**Impact of exploitation:**
- Code execution: By controlling the overflowed data, an attacker can overwrite return addresses on the stack and gain arbitrary code execution on the device.
- Service crash: A specially crafted XML file with a large `ntp` value will cause the `iocheckd` service to crash if not properly crafted for code execution.

**Attack vectors:**
- Local file manipulation: An attacker can write the malicious XML file to `/tmp/iocheckCache.xml` due to its globally writeable permissions.
- Network trigger: The parsing of the XML file is triggered by sending the `BC_SaveParameter` message to the `iocheckd` service.
- The vulnerability is present in the parsing of multiple XML tags, not just the `ntp` tag.

**Required attacker capabilities/position:**
- The attacker needs to be able to write to the `/tmp` directory on the WAGO PFC200 device to place a malicious XML file.
- The attacker needs to be able to send a specific network message to trigger the parsing of the malicious XML file.
- No authentication required, and it does not specify if network access is required to trigger.
- The provided CVSS score indicates local attack vector, which means the attacker needs some form of access to the device.

**Specifics for CVE-2019-5179:**
- The vulnerability exists when processing the `<ntp>` tag in the XML file.
- The extracted `ntp` value is used as an argument to `/etc/config-tools/config_sntp time-server-1=<contents of ntp node>` using `sprintf()`.
- The destination buffer at `sp+0x440` is overflowed if the `ntp` value is larger than `1024-len("/etc/config-tools/config_sntp time-server-1=")` characters.
- An `ntp` value of length `0x3fc` will cause the service to crash.

**Additional details:**
- The document also includes mitigation advice:
  - Disable the iocheckd service through the web interface.
  - Disable iocheckd caching using a custom network message (`RC_WriteRegister`).
- The report contains example XML payloads for each vulnerable parameter, including `gateway`, `domainname`, `hostname`, `ip`, `subnetmask`, and `type`, as well as `ntp` for this CVE.
- The report includes snippets of assembly code illustrating the vulnerable `sprintf` calls and the corresponding overflow.

This report provides a comprehensive analysis of the vulnerability and demonstrates how a specially crafted XML file can lead to code execution on the WAGO PFC200 device.