- **Root cause of vulnerability:** Double free vulnerability in the `iocheckd` service when parsing the `iocheckCache.xml` file. The heap buffer used to store the values for `gateway` is freed multiple times, specifically as many times as `gateway` elements are present in the XML file.
- **Weaknesses/vulnerabilities present:** Double free vulnerability (CWE-415) leading to memory corruption.
- **Impact of exploitation:**
    - Denial of service by crashing the `iocheckd` service.
    - Prevents execution of certain functionalities such as `BC_FactoryRestore`, `BC_SetSwitchMode`, and `BC_SaveParameter`.
    - Disables the ability to set crucial network parameters, including IP address, subnet mask, gateway address, DNS server, NTP server, hostname, and domain name.
    - Potentially allows for code execution depending on the memory allocator.
- **Attack vectors:**
    - An attacker needs to place a specially crafted XML file (`iocheckCache.xml`) at `/tmp/`, which is globally writeable.
    - The vulnerability is triggered by sending the `BC_SaveParameter` message that causes the crafted XML file to be parsed.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to write to the `/tmp` directory on the device.
    - The attacker needs to be able to send network messages to the device to trigger the parsing of the crafted file.