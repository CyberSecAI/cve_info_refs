### CVE-2019-5715
**Root cause of vulnerability:**
-  The vulnerability stems from the insufficient sanitization of user-provided input when it's processed and written to a database record. Specifically, specially crafted input can be interpreted and executed as SQL SELECT statements during this process. This flaw exists within the DBField classes, which handle the underlying data object logic.

**Weaknesses/vulnerabilities present:**
- Reflected SQL Injection: User-supplied data can be used to inject malicious SQL queries.
- Insufficient Input Sanitization:  The application fails to properly sanitize user-provided data before using it in SQL queries.
- Vulnerable DBField Classes: The vulnerability exists in the DBField classes which are used to manage data within the database.

**Impact of exploitation:**
- Information Disclosure: An attacker can potentially view data from other database tables. This could include draft content, user credentials and other sensitive information not intended to be exposed.
-  While the primary impact is data exposure, in certain situations user credentials can also be leaked. The strong one-way cryptography (bcrypt with salts) used to secure these credentials, makes it impractical to gain access via offline password attacks.

**Attack vectors:**
- User Input Fields: Exploitation occurs when user input is accepted for writing to database records, such as in contact forms or similar scenarios, that are then exposed to the user again (e.g. via email).
- Direct and Indirect Assignment: The vulnerability affects both direct assignment on DataObjects (through methods like `update()`, setters via method calls, or magic methods) and indirect assignment (e.g., through `Form->saveInto()`).

**Required attacker capabilities/position:**
- The attacker needs to be able to provide specific, crafted input that is not properly sanitized by the application and is then written to database records.
- Exploitation requires a specific implementation that accepts user input for this purpose.
- This input must then be displayed again, for example by emailing a copy of the form.

**Additional details:**
- Most DBField types in SilverStripe 3 are affected. In SilverStripe 4, the DBYear field type is mainly affected, which reduces the vulnerability's impact to uncommon use cases within the current release line.
- Custom DBField classes might also be affected if they don't properly handle non-scalar values; they may need adjustments to `DBField::scalarValueOnly()` and `DBField::prepValueForDB()`.
- Subclasses of DBCompositeField in 4.x are safe by default.