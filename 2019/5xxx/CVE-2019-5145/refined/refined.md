- **Root cause of vulnerability**: Use-after-free vulnerability in the JavaScript engine of Foxit PDF Reader. Specifically, the vulnerability occurs when a JavaScript `Keystroke` action is triggered via `resetForm` function. This leads to a previously freed object in memory being reused.
- **Weaknesses/vulnerabilities present**: Use-after-free (CWE-416). The vulnerability stems from the way Foxit handles `Keystroke` actions triggered during form resets. When the default value of a field is changed within the event handler during a form reset, it results in an object being freed, which is later accessed, leading to the use-after-free.
- **Impact of exploitation**: Arbitrary code execution. An attacker can manipulate the freed memory before it is reused to achieve remote code execution.
- **Attack vectors**: A specially crafted PDF document. An attacker needs to trick the user into opening the malicious PDF file. If the browser plugin extension is enabled, visiting a malicious site can also trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs the ability to create a malicious PDF file containing the specific JavaScript code to trigger the vulnerability. They also need to convince the victim to open the malicious PDF file or visit a malicious site that triggers the exploit.