- **Root cause of vulnerability**: A heap-based buffer overflow in the ASN1 certificate writing functionality of Openweave-core. Specifically, the `ASN1Writer::EncodeHead` function uses a `uint16_t` to store the total length of the ASN.1 element, leading to an integer overflow when handling a large input TLV byte string. This overflow bypasses a size check, resulting in an out-of-bounds write via `val.GetBytes(mWritePoint, valLen)`.
- **Weaknesses/vulnerabilities present**:
  - Heap-based buffer overflow (CWE-122)
  - Integer overflow leading to insufficient bounds checking
  - Lack of validation on the size of input data
- **Impact of exploitation**: Arbitrary code execution due to the heap-based buffer overflow.
- **Attack vectors**: A specially crafted Weave certificate.
- **Required attacker capabilities/position**: An attacker needs to craft a malicious Weave certificate to trigger the vulnerability. The attacker does not need to be authenticated. User interaction is required as the user must attempt to use the crafted certificate as input to the vulnerable `weave resign-command`.