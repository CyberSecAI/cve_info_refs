- **Root cause of vulnerability**: The `TimeoutPrepared` parameter in the firmware update command is not properly sanitized and is used to construct a command that is then executed by the system.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The application constructs a system command using user-supplied input without proper sanitization or escaping, allowing the injection of malicious commands.
- **Impact of exploitation**: An attacker can inject operating system commands, which are executed with the privileges of the `iot` user. This can lead to a compromise of the device, allowing the attacker to perform unauthorized actions, install malware, or gain further access to the network.
- **Attack vectors**: The attack vector involves sending a specially crafted firmware update command to the WAGO PFC200 Controller via the Cloud Connectivity service. Specifically, the attacker manipulates the `TimeoutPrepared` parameter value within this command.
- **Required attacker capabilities/position**: The attacker needs web administrator privileges to configure the Cloud Connectivity service. They also need to have the ability to send commands through the cloud service to the device, specifically through the Wago Cloud Azure IoT Hub application.