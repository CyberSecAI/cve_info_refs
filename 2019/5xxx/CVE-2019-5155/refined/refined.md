- **Root cause of vulnerability**: The vulnerability is due to the lack of proper input sanitization of parameters within the firmware update command. Specifically, the `system()` function is used to execute the crafted command using user-supplied values.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The application fails to neutralize special elements used in an OS command, allowing an attacker to inject arbitrary commands.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary operating system commands with the privileges of the `iot` user. This could lead to complete compromise of the affected device, including data theft, modification of configuration, and potential denial of service.
- **Attack vectors**: The attack vector is through the cloud connectivity service of the WAGO PFC200 controller. Specifically, the vulnerability is triggered by sending a crafted Firmware Update command from the cloud provider.
- **Required attacker capabilities/position**: An attacker needs to be able to send commands to the cloud service, which means they would need to have compromised the cloud service or be an authorized user with the ability to send commands to the device through the cloud service. The attacker must also have web administrator privileges to configure the cloud connectivity service.