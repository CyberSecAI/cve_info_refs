- **Root cause of vulnerability**: An out-of-bounds write vulnerability exists in the BMP parser of the ImageGear library due to improper calculation of buffer size and insufficient size check.
- **Weaknesses/vulnerabilities present**: Out-of-bounds write (CWE-787). The `dstBuffer` is allocated with an insufficient size due to a calculation error, and the size check at line 5 is bypassed due to a signed comparison.
- **Impact of exploitation**: An attacker can achieve remote code execution by providing a specially crafted BMP file that triggers the out-of-bounds write, leading to memory corruption.
- **Attack vectors**: The vulnerability is triggered by loading a malformed BMP file using the `IG_load_file` function.
- **Required attacker capabilities/position**: An attacker needs to provide a malformed BMP file to the victim to trigger the vulnerability. No specific position or capabilities other than the ability to provide a file is required.