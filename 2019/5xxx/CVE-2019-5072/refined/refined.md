- **Root cause of vulnerability**: Improper neutralization of special elements used in an OS command, specifically within the `/goform/WanParameterSetting` resource of the Tenda AC9 router firmware. The `dns2` POST parameter is vulnerable to command injection.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability exists due to insufficient sanitization of the `dns2` parameter, allowing an attacker to inject and execute arbitrary OS commands.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary commands on the router as root, potentially leading to complete control of the device, data exfiltration, or further attacks on the network.
- **Attack vectors**: The vulnerability is triggered by sending a specially crafted HTTP POST request to the `/goform/WanParameterSetting` endpoint with malicious commands in the `dns2` parameter.
- **Required attacker capabilities/position**: The attacker needs to be authenticated to the router's web interface to exploit this vulnerability. This suggests the attack can be done by a local user of the network who has gained access to the router's web interface or a remote attacker who has compromised a local machine or gained access to a user's credentials.