=== Content from talosintelligence.com_515e79c9_20250121_010921.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0931

## Moxa AWK-3131A WAP Hostname Command Injection Vulnerability

##### February 24, 2020

##### CVE Number

CVE-2019-5142

### Summary

An exploitable command injection vulnerability exists in the hostname functionality of the Moxa AWK-3131A firmware version 1.13. A specially crafted entry to network configuration information can cause execution of arbitrary system commands, resulting in full control of the device. An attacker can send various authenticated requests to trigger this vulnerability.

### Tested Versions

Moxa AWK-3131A Industrial IEEE 802.11a/b/g/n wireless AP/bridge/client version 1.13

### Product URLs

<http://www.moxa.com/product/AWK-3131A.htm>

### CVSSv3 Score

7.2 - CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

### CWE

CWE-78: Improper Neutralization of Special Elements used in an OS Command (‘OS Command Injection’)

### Details

The Moxa AWK-3131A Industrial IEEE 802.11a/b/g/n wireless AP/bridge/client is a wireless networking appliance intended for use in industrial environments. The manufacturer specifically highlights automated materials handling and automated guided vehicles as target markets.

The Moxa AWK-3131A is susceptible to OS command Injection vulnerability due to improper filtering of data passed to and retrieved from the flash memory.

During configuration when making changes to `"Device Name"`(hostname) via `web` or `telnet`, the system needs to reboot in order to save the changes made. This is due to the fact that you can’t save anywhere else, except for `/var` (which in this case acts like `/tmp`). Therefore, in order to make the changes persistent, the system saves the changes within the flash memory. Once the systems reboots, the binary `"init"` would retrieve the config file from the flash memory, gets the config information needed and at some point calls `iw_system` and passes the config information to another binary called `"iw_ip_update"` as shown below.

```
00413090  3c020042   lui     $v0, 0x42
00413094  24449ce4   addiu   $a0, $v0, -0x631c  {data_419ce4, "%s -m %d -n -r"}
00413098  3c020042   lui     $v0, 0x42
0041309c  24459cb8   addiu   $a1, $v0, -0x6348  {data_419cb8, "/usr/sbin/iw_ip_update"}
004130a0  00003021   move    $a2, $zero  {0x0}
004130a4  8f82818c   lw      $v0, -0x7e74($gp)  {iw_system}
004130a8  0040c821   move    $t9, $v0
004130ac  0320f809   jalr    $t9
004130b0  00000000   nop
004130b4  8fdc0010   lw      $gp, 0x10($fp) {var_40}  {0x475b40}

```

Once `"iw_ip_update"` gets the information needed, it calls `"iw_system"` to execute `echo "%s" "%s" localhost >> /etc/hosts` as you can see below.

```
004030b0  3c020040   lui     $v0, 0x40
004030b4  24444008   addiu   $a0, $v0, 0x4008  {0x404008, "echo 127.0.0.1 localhost > %s"}
004030b8  3c020040   lui     $v0, 0x40
004030bc  24454028   addiu   $a1, $v0, 0x4028  {data_404028, "/etc/hosts"}
004030c0  8f828084   lw      $v0, -0x7f7c($gp)  {iw_system}
004030c4  0040c821   move    $t9, $v0
004030c8  0320f809   jalr    $t9
004030cc  00000000   nop
004030d0  8fdc0010   lw      $gp, 0x10($fp) {var_18}
004030d4  8fc2001c   lw      $v0, 0x1c($fp) {var_c}
004030d8  8c420004   lw      $v0, 4($v0)
004030dc  00402021   move    $a0, $v0
004030e0  8f8280b8   lw      $v0, -0x7f48($gp)  {iw_ipv4_string}
004030e4  0040c821   move    $t9, $v0
004030e8  0320f809   jalr    $t9
004030ec  00000000   nop
004030f0  8fdc0010   lw      $gp, 0x10($fp) {var_18}
004030f4  00401821   move    $v1, $v0
004030f8  8fc20018   lw      $v0, 0x18($fp) {var_10}
004030fc  3c040040…  li      $a0, 0x404034  {"echo %s "%s" localhost >> %s"}
00403104  00602821   move    $a1, $v1
00403108  00403021   move    $a2, $v0
0040310c  3c020040   lui     $v0, 0x40
00403110  24474028   addiu   $a3, $v0, 0x4028  {data_404028, "/etc/hosts"}
00403114  8f828084   lw      $v0, -0x7f7c($gp)  {iw_system}
00403118  0040c821   move    $t9, $v0
0040311c  0320f809   jalr    $t9
00403120  00000000   nop
00403124  8fdc0010   lw      $gp, 0x10($fp) {var_18}  {0x41c8f0}

```
### Timeline

2019-10-22 - Vendor Disclosure

2020-02-24 - Public Release

##### Credit

Discovered by Jared Rittle and Alexander Perez Palma of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2019-0932](/vulnerability_reports/TALOS-2019-0932) [Previous Report

TALOS-2019-0930](/vulnerability_reports/TALOS-2019-0930)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


