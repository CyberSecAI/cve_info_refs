```text
CVE-2019-5180:
  - Root cause: Stack buffer overflow in the iocheckd service "I/O-Check" functionality of WAGO PFC200 due to insufficient input validation when parsing the iocheckCache.xml file. Specifically, the 'ip' parameter within the XML file is used in a sprintf() call without proper bounds checking.
  - Weakness: CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow'). The vulnerability occurs because the length of the 'ip' value from the XML file is not checked before being used in a sprintf() function, which copies the data into a fixed-size buffer on the stack.
  - Impact: Code execution. By providing an overly long 'ip' value in the iocheckCache.xml file, an attacker can overwrite parts of the stack, potentially hijacking control flow and executing arbitrary code.
  - Attack vector: An attacker can write a specially crafted XML file to /tmp/iocheckCache.xml (which is globally writable) and then trigger the parsing of this file by sending the BC_SaveParameter message.
  - Required attacker capabilities/position: The attacker needs to be able to write to the /tmp/iocheckCache.xml file on the WAGO PFC200 device. All users have write access to /tmp, so this can be achieved by any user on the system or by an attacker who has gained write access to the file system.
  - Vulnerable code: At 0x1ea48, the extracted ip value from the xml file is used as an argument to `/etc/config-tools/config_interfaces interface=X1 state=enabled ip-address=<contents of ip node>` using `sprintf()`. The destination buffer `sp+0x440` is overflowed with the call to `sprintf()` for any `ip` values that are greater than `1024-len("/etc/config-tools/config_interfaces interface=X1 state=enabled ip-address=")` in length. A `ip` value of length `0x3da` will cause the service to crash.
```