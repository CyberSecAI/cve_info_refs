- **Root cause of vulnerability**: A heap out-of-bounds write vulnerability exists in the UI tag parsing functionality of the DICOM image format in LEADTOOLS 20. This occurs when handling the UI tag, specifically during a `memmove` operation. The size of the allocated buffer is based on the initial UI element size. However, the memmove copies a substring into the buffer, and this substring can be larger than the initial allocation, causing a write beyond the allocated buffer.

- **Weaknesses/vulnerabilities present**: Heap out-of-bounds write (CWE-787). The vulnerability occurs due to a size mismatch when copying data using `memmove`. The code allocates a buffer based on the initial size of the UI element, but doesn't account for the adjusted size after backslash processing. This allows the `memmove` to write beyond the bounds of the heap allocation.

- **Impact of exploitation**: An attacker can cause a heap-based buffer overflow, potentially leading to code execution. The overflow could overwrite critical data structures on the heap, which could allow an attacker to gain control of the application.

- **Attack vectors**: The attacker can exploit this vulnerability by crafting a malicious DICOM image file. The crafted image would include a UI tag with data designed to trigger the out-of-bounds write during parsing.

- **Required attacker capabilities/position**: The attacker needs the ability to provide the crafted DICOM file to an application that uses the vulnerable LEADTOOLS library to process it. The attacker does not need to be in a privileged position, and can trigger the vulnerability remotely by convincing a user to open a malicious DICOM file.