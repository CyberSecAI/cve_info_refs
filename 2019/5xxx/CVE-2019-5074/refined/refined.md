```
## Vulnerability Report for CVE-2019-5074

### Summary
A stack buffer overflow vulnerability exists in the iocheckd service "I/O-Check" functionality of WAGO PFC 200 controllers. By sending specially crafted packets, an attacker can trigger a stack buffer overflow leading to arbitrary code execution. The vulnerability can be triggered by sending unauthenticated packets.

### Affected Products
- WAGO PFC200 Firmware version 03.01.07(13)
- WAGO PFC200 Firmware version 03.00.39(12)
- WAGO PFC100 Firmware version 03.00.39(12)

### Root Cause
The iocheckd service uses an incorrect buffer length when copying system data into a stack buffer while processing the BC\_ProductLabel message. Specifically, when a value is present for the QS-STRING system value, a stack buffer overflow occurs, potentially leading to a crash or code execution.

### Vulnerability Details
1.  **Weakness**: Stack buffer overflow due to incorrect buffer length.
2.  **Location**: iocheckd service "I/O-Check" functionality, specifically when handling the BC\_ProductLabel message and copying the QS-STRING system value.
3.  **Details**: A buffer of 0x20 bytes is allocated on the stack. The system value "QS-STRING" is then copied into this buffer using `strncpy` with a length of 0x40 bytes. This results in a 0x20-byte overflow of the stack buffer.
4.  **Exploitation**: An attacker can overwrite the QS-STRING value using the iocheckd protocol and cause the overflow. This overwrites the return address and other saved registers on the stack (r4-r7, pc), allowing the attacker to control program execution.

### Impact
Successful exploitation of this vulnerability can lead to remote code execution.

### Attack Vector
1.  **Attacker Position**: Remote, unauthenticated attacker.
2.  **Attack Vector**: Sending a specially crafted packet to the iocheckd service "I/O-Check" to trigger the buffer overflow when processing the BC\_ProductLabel message. The attacker needs to control the QS-STRING value to overwrite the stack.

### Mitigation
Disable the iocheckd service "I/O-Check" via the web-based management interface.
```