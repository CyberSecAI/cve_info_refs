- **Root cause of vulnerability:** A heap buffer overflow occurs due to the usage of `strcpy` with a fixed-size destination buffer (0x28 bytes) and a source buffer that can be controlled by an attacker. The source buffer is the value of the WAGONRSTR variable stored in the device's EEPROM.
- **Weaknesses/vulnerabilities present:** Heap buffer overflow (CWE-120). The iocheckd service on port 6626 does not perform bounds checking before copying data from EEPROM into a fixed-size heap buffer.
- **Impact of exploitation:** The heap buffer overflow can lead to arbitrary code execution on the affected device.
- **Attack vectors:** An attacker can send unauthenticated packets to port 6626 to trigger the vulnerability. The attacker needs to overwrite the WAGONRSTR value in the EEPROM with a value longer than 0x28 bytes.
- **Required attacker capabilities/position:** The attacker must be able to send network packets to the affected device on port 6626, which is typically open to the local network. The attacker does not require authentication to trigger the vulnerability and modify the EEPROM value.