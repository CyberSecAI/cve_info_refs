- **Root cause of vulnerability**: A format string vulnerability exists in the `conio_writestr` function within the `iw_console` application of the Moxa AWK-3131A firmware. This occurs because the time server input is not properly sanitized, allowing an attacker to inject format string specifiers.
- **Weaknesses/vulnerabilities present**:
    - Format string vulnerability in `conio_writestr`.
    - Insufficient input validation on the time server string. Specifically, the firmware only performs a length check, failing to sanitize format string specifiers
- **Impact of exploitation**:
    - Remote code execution (RCE). By crafting a malicious format string, an attacker can overwrite the return address (`$ra`) and program counter (`$pc`), allowing them to redirect program flow and execute arbitrary code.
    - The vulnerability can lead to a segmentation fault and complete device compromise
- **Attack vectors**:
    - Network based. An attacker can exploit this vulnerability via Telnet or SSH after authenticating with a low privilege user account. The attacker sends commands to the `iw_console` which eventually calls the vulnerable `conio_writestr` function.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to establish a network connection to the Moxa device and must have valid credentials to log in via Telnet or SSH.
    - The attacker must be able to send commands to the `iw_console`, navigate to the time server settings, and set a malicious time server value.