```
{
  "CVE-2019-0573": {
    "Description": "The Data Sharing Service DSOpenSharedFile method takes a flag to delete a shared file on close which can be abused to delete an arbitrary file.",
    "Root cause": "The vulnerability exists due to the Data Sharing Service's DSOpenSharedFile method not properly validating the file permissions and path before performing a delete operation. Specifically, the service doesn't check if the file was shared as writable before applying the delete-on-close flag, and it performs path verification too late, after the file has already been opened with the delete flag set.",
    "Weaknesses": [
      "Improper file permission check: The DSOpenSharedFile method does not check if the file was shared as writable before setting the delete-on-close flag.",
       "Late path verification: The path verification occurs after the file is already opened with the delete flag, rendering the verification ineffective against symlink attacks.",
      "Lack of impersonation: The service does not impersonate the user when calling CreateFile, allowing it to open files with SYSTEM privileges."
    ],
    "Impact": "A local attacker can exploit this vulnerability to delete arbitrary files that the user has read access to, potentially leading to data loss or system instability. This is achieved by creating a file, setting it to read-only, sharing it, then using the vulnerability to trigger a delete by the Data Sharing Service (DSSVC) which runs with SYSTEM privileges.",
    "Attack vectors": "Local access is required to exploit this vulnerability. The attacker must be able to create shared files, set file permissions, and call the DSOpenSharedFile method.",
   "Required attacker capabilities": "The attacker must have the ability to execute code locally on the target system. They also need the ability to create a file, share it, set permissions, and interact with the Data Sharing Service.",
    "Additional details": "The vulnerability is present in Windows 10 1803 and 1809. The PoC involves creating a file, setting read-only permissions, then using the vulnerable service to delete the file. The service opens the file as SYSTEM, allowing it to bypass user-level permissions. Although the service attempts to verify the path, this is done after the file is already opened with the 'delete on close' flag, rendering the check ineffective against symlink attacks or other path manipulations. The issue arises from the service not impersonating the user when creating the file handle."
  }
}
```