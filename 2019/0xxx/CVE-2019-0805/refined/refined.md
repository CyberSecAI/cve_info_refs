```
{
  "CVE-2019-0805": {
    "Root cause": "The LUAFV driver allows mapping of the original file read-only without creating it in the virtual store. The driver copies the real file's SECTION_OBJECT_POINTERS (SOP) to the virtual file object. When creating a new section for a file, the kernel calls MiCreateImageOrDataSection, which calls LuafvPreAcquireForSectionSynchronization. If the file is not being mapped writable, LUAFV leaves the SOP pointing to the real file. MiCreateImageOrDataSection then checks if the SOP::DataSectionObject CONTROL_AREA is populated, and creates a new one backed by the virtual file if not. This control area gets written into the SOP structure of the virtual file, which ends up writing into the SOP structure of the real file upon read-only mapping. The cache manager reuses the same SOP structure for the same file, leading to cache poisoning.",
    "Weaknesses": [
      "The LUAFV driver improperly handles delayed virtualization, specifically how it manages SECTION_OBJECT_POINTERS (SOP).",
      "The cache manager reuses SOP structures for the same file which is not invalidated when the backing file is changed.",
      "The LUAFV driver allows mapping the original file read-only without creating the file in the virtual store."
    ],
    "Impact": "A local user can elevate privileges by poisoning the cache of a system file. By replacing a system file's cache with malicious content, an attacker can execute arbitrary code with elevated privileges.",
    "Attack vectors": "Local access is required. An attacker must open a file that can be delay virtualized and then manipulate the file system operations in a specific way to trigger the vulnerability.",
    "Required attacker capabilities": "The attacker needs the ability to create hardlinks, open files with read/write access, and perform file system operations to trigger the delayed virtualization process."
  }
}
```