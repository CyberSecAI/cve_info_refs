=== Content from lists.apache.org_cc918c19_20250121_010554.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from launchpad.support.sap.com_0db57a91_20250121_010553.html ===


Note: Your browser does not support JavaScript or it is turned off. Press the button to proceed.



=== Content from packetstormsecurity.com_e8de1763_20250121_010552.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from cwiki.apache.org_42feb145_20250121_010553.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2Fww%2Fs2-059)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2Fww%2Fs2-059)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-059
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=158871348 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=158871348)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=158871348)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=158871348#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=158871348)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=158871348)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=158871348)
  + [Export to Word](/confluence/exportword?pageId=158871348)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=158871348)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-059](/confluence/display/WW/S2-059)

* Created by  [René Gielen](/confluence/display/~rgielen), last modified on [Aug 13, 2020](/confluence/pages/diffpagesbyversion.action?pageId=158871348&selectedPageVersions=1&selectedPageVersions=2 "Show changes")

## Summary

Forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.

| Who should read this | All Struts 2 developers and users |
| --- | --- |
| Impact of vulnerability | Possible Remote Code Execution vulnerability |
| Maximum security rating | Important |
| Recommendation | Always validate incoming parameters' values when re-assigning them to certain Struts' tags attributes.  [Don't use %{...} or ${...} syntax referencing user modifiable input in tag attributes](https://struts.apache.org/security/#use-struts-tags-instead-of-raw-el-expressions) other than *value* unless you have a valid use-case.  Consider activating [Proactive OGNL Expression Injection Protection](https://struts.apache.org/security/#proactively-protect-from-ognl-expression-injections-attacks-if-easily-applicable) if applicable  Alternatively upgrade to [Struts 2.5.22](/confluence/display/WW/Version%2BNotes%2B2.5.22) or greater |
| Affected Software | Struts 2.0.0 - Struts 2.5.20 |
| Reporters | Matthias Kaiser, Apple Information Security |
| CVE Identifier | CVE-2019-0230 |

## Problem

The Apache Struts frameworks, when forced, performs double evaluation of attributes' values assigned to certain tags attributes such as `id` so it is possible to pass in a value that will be evaluated again when a tag's attributes will be rendered. With a carefully crafted request, this can lead to Remote Code Execution (RCE).

The problem only applies when forcing OGNL evaluation inside a Struts tag attribute, when the expression to evaluate references raw, unvalidated input that an attacker is able to directly modify by crafting a corresponding request.

Example:

```
<s:url var="url" namespace="/employee" action="list"/><s:a id="%{skillName}" href="%{url}">List available Employees</s:a>

```

If an attacker is able to modify the `skillName` attribute in a request such that a raw OGNL expression gets passed to the `skillName` property without further validation, the provided OGNL expression contained in the `skillName` attribute gets evaluated when the tag is rendered as a result of the request.

The opportunity for using double evaluation is by design in Struts since 2.0.0 and a useful tool when done right, which most notably means **only referencing validated values in the given expression**. However, when referencing unvalidated user input in the expression, malicious code can get injected. In an ongoing effort, the Struts framework includes mitigations for limiting the impact of injected expressions, but Struts before 2.5.22 left an attack vector open which is addressed by this report.

This issue is similar to:

* [S2-029](/confluence/display/WW/S2-029)
* [S2-036](/confluence/display/WW/S2-036)

## Solution

**The ultimate fix is adding a proper validation of each value that's coming in and it's used in tag's attributes. [Don't use forced evaluation of an attribute](https://struts.apache.org/security/#use-struts-tags-instead-of-raw-el-expressions) other than *value* using %{...} or ${...} syntax unless really needed for a valid use-case.**

By upgrading to Struts 2.5.22, possible malicious effects of forced double evaluation are further limited and close the reported attack vector, especially when combined with [Proactive OGNL Expression Injection Protection](https://struts.apache.org/security/#proactively-protect-from-ognl-expression-injections-attacks-if-easily-applicable).

## Backward compatibility

No issues expected when upgrading to Struts 2.5.22

## References

* [LGTM / Semmle: An analysis of the double evaluation behaviour and which attributes support it](https://securitylab.github.com/research/apache-struts-double-evaluation)
* [Use Struts tags instead of raw EL expressions](https://struts.apache.org/security/#use-struts-tags-instead-of-raw-el-expressions)
* [Proactively protect from OGNL Expression Injections attacks if easily applicable](https://struts.apache.org/security/#proactively-protect-from-ognl-expression-injections-attacks-if-easily-applicable)

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 69, "requestCorrelationId": "b856ea4ec32c0260"}


=== Content from lists.apache.org_cb78d41a_20250121_010554.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from packetstormsecurity.com_c0cf1e56_20250121_010553.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
