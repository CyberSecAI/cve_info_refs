=== Content from pankajupadhyay.in_bc180db8_20250121_031500.html ===


# [Pankaj Upadhyay](https://pankajupadhyay.in/ "Pankaj Upadhyay")

…just another security professional, coming out of his shell

Search Icon
Search for:

Menu Toggle Icon

[Skip to content](#content)

* [$ls -a](https://pankajupadhyay.in/)
* [$echo](https://pankajupadhyay.in/hall-of-fames-acknowledgements/)
* [Home](/)

![Pankaj Upadhyay](https://s2.wp.com/wp-content/themes/premium/radiate/images/header/header-image-one.jpg)

## [XSS Vulnerability in TCL’s Website due to Insecure AEM Instance](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/)

[July 4, 2024July 5, 2024](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> A more fitting title for this post could have been “$10 for an XSS” ;), but to summarize, I discovered a Cross-Site Scripting (XSS) vulnerability on the US website of the well-known electronics company TCL and reported it to them.

This issue stemmed from an unpatched Adobe Experience Manager (AEM) vulnerability on TCL’s side.

[![](https://pankajupadhyay.in/wp-content/uploads/2022/08/screen-shot-2021-03-23-at-1.38.49-am.png?w=1024)](https://pankajupadhyay.in/wp-content/uploads/2022/08/screen-shot-2021-03-23-at-1.38.49-am.png)

Adobe Experience Manager is a suite of online cloud-based services provided by Adobe for content and digital asset management. From my limited research and reading a few years ago, I divided AEM into two main parts for my understanding. One part is accessible to the public, such as any content or documents, while the other is enterprise-side and designed to be protected from general public access. This protection is mainly achieved through authentication and an inbuilt Web Application Firewall (WAF) known as AEM Dispatcher.

Occasionally, I use Google dorking to look for known AEM bad patterns, such as sites with the exposed /crx/de endpoint. /crx/de is AEM’s content repository and should not be publicly accessible. While looking for it, I discovered that TCL had this issue. I then checked if the /setPreferences.jsp endpoint was exposed. There was a known vulnerability in AEM where the ‘keymap’ parameter, when passed to this endpoint, was vulnerable to XSS. Although this issue was later resolved by AEM, many sites are still susceptible to it. Most sites block this endpoint via AEM Dispatcher, so extra effort is needed to bypass this dispatcher and access the endpoint.

[0ang3el](https://x.com/0ang3el)‘s aem-hacker utility also highlights it [here](https://github.com/0ang3el/aem-hacker/blob/master/aem_hacker.py#L191) and can help in testing out against this AEM XSS attack vector.

I first tested the ‘keymap’ parameter with an HTML <h1> tag. When <h1> rendered on the page, I tried the javascript alert payload, and the alert popped up, confirming the presence of XSS.

I reported this to TCL’s security team.

Later, I realized that since the /crx/de endpoint was already exposed, the ‘..;’ AEM filter bypass wasn’t actually needed for this XSS. I shared the other URL with their security team as well.

<https://www.tcl.com/crx/de/setPreferences.jsp;.html?language=en&keymap=testmap%3Csvg%20onload=%22alert(document.domain)%22%3E>

**Timeline:**

* **03/23/2021** – Reported the issue to TCL team.
* **03/29/2021** – Requested an acknowledgment. Also shared that their /crx environment was exposed and another XSS vector that wouldn’t need the ‘..;’ escape.
* **06/28/2021** – Requested an update.
* **08/19/2021** – TCL responded, confirming the issue but deemed it low risk. They offered $10 and requested for my PayPal details.
* **09/13/2021** – I respectfully declined their offer and informed them about my preference to publish a blog post on this once they fix the issue. Asked for a timeline.
* **08/20/2022** – Requested an update.
* **Recently** – Forgot about this finding for a long time. Noticed recently that the finding was resolved hence shared this post for the knowledge and awareness of my readers.

[Hacking](https://pankajupadhyay.in/category/hacking/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Web-Security](https://pankajupadhyay.in/tag/web-security/), [XSS](https://pankajupadhyay.in/tag/xss/)
[Leave a comment](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/#respond)

## [CVE-2019-8081 in Adobe Experience Manager](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/)

[October 2, 2020April 15, 2021](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

[Adobe Experience Manager](https://www.adobe.com/marketing/experience-manager.html) is a suite of online cloud-based services provided by Adobe for content and digital asset management. It includes a set of analytics, social, advertising, media optimization, targeting, Web experience management and content management products aimed at the advertising industry. There are various functions to enable consumers in managing their digital asset and content in different ways. One of the function provided by Adobe is ‘**Workflows**‘.

Workflows consist of a series of steps that are executed in a specific order. Each step performs a distinct activity such as activating a page or sending an email message. A workflow is made of steps which can be customized by using either an ECMA script or a Java class. AEM provides many useful workflow processes “by default”.

**Vulnerability Details:**

One of the Adobe provided workflow utility, [**urlcaller**](https://helpx.adobe.com/experience-manager/6-2/sites/developing/using/wf-process-ref.html) (which is a simple workflow process that calls any given URL), was logging the supplied password in the debug log. Adobe does mention here that this workflow process should be used only during development and demonstrations but people/organizations unaware of this condition and unaware of the password logging issue here, might have used this workflow process in any security sensitive setting which might have logged the passwords unknowingly in their debug logs.

Below is path of this workflow script and arguments it take.

* **ECMAScript path**: **/etc/workflow/scripts/urlcaller.ecma**
* **Payload**: None.
* **Arguments**:
  + **args := url [‘,’ login ‘,’ password]**
  + **url := /\* The URL to be called \*/**
  + **login := /\* The login to access the URL \*/**
  + **password := /\* The password to access the URL \*/**
  + for example: **<http://localhost:4502/my.jsp>, mylogin, mypassword**

**How I came across this issue?**

While testing one of the AEM targets, I came across an open and misconfigured [querybuilder servlet](https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/querybuilder-api.html) and used it to query the internal system for \*.ecma files. I came across this file urlcaller.ecma, and when I looked at the source code, I noticed that this code was logging the supplied password to the debug log.

![](https://pankajupadhyay.in/wp-content/uploads/2020/10/image-1.png?w=300)

I reported this issue to Adobe PSIRT. They did their investigation and confirmed the issue. Adobe released an advisory regarding this issue in their [security bulletin](https://helpx.adobe.com/security/products/experience-manager/apsb19-48.html) and assigned [CVE-2019-8081](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8081) to this finding.

Adobe PSIRT team was very responsive and updated me regularly on the fixes.

**Vendor Response:**

I shared a draft post with the Adobe team for review. As per Adobe team, for an AEM environment to be at risk, the following criteria is required:

* An administrator must enable debug logging
* This sample code, which is meant for demo purposes only, would be nevertheless used in production environments

![](https://pankajupadhyay.in/wp-content/uploads/2020/10/image.png?w=1024)

I don’t agree with this statement entirely but if you have ever used this workflow utility in your organization or if you are using an older version of AEM, please do check if this utility has logged any password to your debug logs and take the required action.

**Timeline:**

02/23/2019 – Reported this issue to Adobe
02/24/2019 – Adobe PSIRT responded and assigned it a case id
03/13/2019 – I requested for an update
03/14/2019 – Adobe PSIRT said they are still investing the issue
09/26/2019 – Adobe PSIRT informed me that they are fixing this issue in the next release
10/15/2019 – Adobe released the security bulletin for AEM.
08/25/2020 – Shared a draft post with Adobe for review
10/02/2020 – Published the blog post

References:

* <https://www.adobe.com/marketing/experience-manager.html>
* <https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/querybuilder-api.html>
* <https://en.wikipedia.org/wiki/Adobe_Experience_Cloud>
* <https://helpx.adobe.com/security/products/experience-manager/apsb19-48.html>
* <https://docs.adobe.com/content/help/en/experience-manager-65/developing/extending-aem/extending-workflows/workflows-process-ref.html>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/), [Security](https://pankajupadhyay.in/category/security/)
[1 Comment](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/#comments)

## [Ok Google! bypass ‘flag\_secure’](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/)

[May 1, 2020May 19, 2020](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> Google Assistant on Android 9 can bypass the screen-capture protection provided by Android’s FLAG\_SECURE.

**Vulnerability Details:**

[**FLAG\_SECURE**](https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE) is a window level flag in Android ecosystem that allows mobile apps to safeguard their content from a screenshot capture. Application needs to enable it by specifying the `[WindowManager.LayoutParams#FLAG_SECURE](https://developer.android.com/reference/android/view/WindowManager.LayoutParams#FLAG_SECURE)` for the windows/screens, it doesn’t want to be recorded.

**We observed that Google Assistant on Pixel devices, was able to capture screenshots even when screens were protected with FLAG\_SECURE.**

This is also important to know that MediaProjectionAPI in Android, allows an app to capture screenshots programmatically. Any rogue app using this API and with proper permissions would have been able to capture screen of the device when other apps are in-use.

[NightWatch CyberSecurity](https://wwws.nightwatchcybersecurity.com/2016/04/13/research-securing-android-applications-from-screen-capture/) has written a detailed post on FLAG\_SECURE and MediaProjectionAPI. Google has some [sample code](https://github.com/android/media-samples/tree/master/ScreenCapture) on Github on how to use this API in capturing device screen in real time.

**Testing Steps:**

1. Install the Google Search app (<https://play.google.com/store/apps/details?id=com.google.android.googlequicksearchbox>). Enable assistant.
2. Go to the settings for Google Search and enable screenshots under “General”. Also enable “Use Screen Context” option under “Google Assistant”, “Phone”
3. Open Chrome in **incognito mode**, press Power + Volume Down. Note that screenshots won’t work.
4. Now tap the home button and hold, and say **“take screenshot”** or **“share screenshot”** and google assistant will take screenshot bypassing the ‘flag\_secure’ restrictions.

**This was tested on Pixel 2 and Pixel 3 devices running Android 9.**

**Timeline:**
03/12/2019 – Reported the finding through Google VRP
03/14/2019 – Google confirms the finding. Also tells us that it is a duplicate of an already tracked bug.
03/14/2019 – Asked when it will be patched and at what point we can disclose it publicly.
03/19/2019 – Received below response. Google recommended to check the status of the fix time to time.
![undefined](https://pankajupadhyay.in/wp-content/uploads/2020/05/screen-shot-2020-05-01-at-1.51.56-am.png)
04/30/2019 – I reached out to Google to know about the status of the fix and shared a draft write-up. No response from Google.
06/20/2019 – Asked again. No response.
08/30/2019 – Asked for a status update. No response.
04/14/2020 – Noticed that this finding was fixed in Android’s [September 2019 bulletin](https://source.android.com/security/bulletin/2019-09-01) and [CVE-2019-2103](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2103) was assigned to this issue. I shared a modified write-up with Google and asked if CVE-2019-2103 is for the same vulnerability. I did not receive any response.
05/01/2020 – Published this blog post.

This was jointly discovered by [Pankaj Upadhyay](https://pankajupadhyay.in/) and [NightWatch CyberSecurity](https://wwws.nightwatchcybersecurity.com/).

[Security](https://pankajupadhyay.in/category/security/)
[androidsecurity](https://pankajupadhyay.in/tag/androidsecurity/), [SecurityResearch](https://pankajupadhyay.in/tag/securityresearch/)
[Leave a comment](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/#respond)

## [Audible, and a curious case of insecure by-default in Adobe SDKs](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/)

[December 6, 2019December 6, 2019](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> “[Insecure Communication](https://www.owasp.org/index.php/Mobile_Top_10_2016-M3-Insecure_Communication)” in Mobile apps are placed under OWASP Top 10 vulnerabilities and can be exploited in performing MITM attacks on targeted users. In this case, an adversary in the same network would have been able to view or modify user related information transmitted from the Audible mobile application to Adobe’s cloud services. Also, the underlying ISPs and/or Wifi Access point providers would have been able to see these calls and the shared data.

I was looking at Amazon’s **[Audible](https://play.google.com/store/apps/details?id=com.audible.application&hl=en_US)** app and noticed an HTTP call to a weird looking domain. After digging a little more, I found that it was owned by Adobe and seemed to be used for Adobe’s cloud based services for user behavior analysis.

User behavior analysis is very important to many online and app-based services and provides insights to product managers and marketers about their app/service usage.

An easy way to integrate this feature into mobile applications, is through the use of mobile SDKs. These software development kits/tools are available for different mobile operating systems and mobile developers can utilize these SDKs to implement specific functionalities in their apps, without worrying about the underlying operating system.

While searching for the cause of this behavior in Audible, I discussed it with [nightwatchcybersecurity](https://wwws.nightwatchcybersecurity.com/2019/11/06/insecure-defaults-in-adobes-mobile-sdks/). We noticed that it was happening because Adobe SDK for mobile, was not using a secure connection for transmitting user data between SDK and Adobe Cloud services. Further investigation revealed that SSL setting was disabled by-default in Adobe SDK for mobile app.

**Audible** seemed to be using these default settings and hence SDK utilized by Audible was missing the SSL/TLS protection while connecting to Adobe Cloud Services. Because of that, user data was being transmitted on an insecure connection. I reported this to Amazon team and they were able to resolve this issue very quickly. They also kept me updated on the status of the fix and were very proactive on the communication front.

Coming back to the SDK, Adobe SDK for mobile comes with a configuration file named as [ADBMobileConfig.json](https://docs.adobe.com/content/help/en/mobile-services/using/manage-app-settings-ug/configuring-app/download-sdk.html). This file comes with some pre-populated attributes and values, and SSL attribute is one of them. By default, this option was set as ‘false’ as mentioned [here](https://docs.adobe.com/content/help/en/mobile-services/android/configuration-android/json-config.html). Mobile Apps using this SDK and using the default values are missing the very important SSL protection.

NightWatch has written a detailed blog on this [‘insecure-default’](https://wwws.nightwatchcybersecurity.com/2019/11/06/insecure-defaults-in-adobes-mobile-sdks/) behavior and also has released a utility, to scan for this and some other settings.

**Adobe’s Response**
*Adobe has released new versions of the mobile SDKs, which can be found here:
<https://github.com/Adobe-Marketing-Cloud/acp-sdks>.

The SDKs are configurable in Adobe Experience Platform Launch and require SSL for data transmission.*

**Amazon’s Response**
*Thank you for your patience on the matter, we have no comments or change requests for the draft you have shared. We would appreciate if you can send us a link of your publication when you publish it.*

**Fixed version:**
Audible version 2.35 onward for Android

Amazon Case ID # PO135515801
CVE from MITRE # CVE-2019-11554

**Timeline:**

03/11/2019 – Reported this issue to Amazon
03/12/2019 – A case ID was assigned and additional questions were asked
03/14/2019 – Case manager informed that they were going ahead with the fix
04/04/2019 – Case manager informed that they had fixed the issue but were waiting for their users to upgrade the app.
04/23/2019 – Case manager informed that an updated version was made available to most of their users and they were closing this issue on their end.
11/06/2019 – Shared a draft report with nightwatchcyber for review.
11/06/2019 – Shared a draft report with Amazon.
11/07/2019 – Shared a draft report with Adobe.
11/07/2019 – Adobe acknowledged the email.
11/12/2019 – Shared an updated draft with everyone
11/12/2019 – Amazon acknowledged the email.
11/13/2019 – Adobe responded that if I could add their official response in my blogpost.
11/21/2019 – Amazon responded that I could go ahead with the post.
12/05/2019 – Published the blog post.

**References:**
1) Audible iOS App:
<https://apps.apple.com/us/app/audible-audiobooks-originals/id379693831>
2) Audible Android App:
<https://play.google.com/store/apps/details?id=com.audible.application&hl=en_US>
3) New Versions of Adobe Mobile SDKs:
 <https://github.com/Adobe-Marketing-Cloud/acp-sdks>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/)
[Adobe SDK](https://pankajupadhyay.in/tag/adobe-sdk/), [Secure By Default](https://pankajupadhyay.in/tag/secure-by-default/), [Web-Security](https://pankajupadhyay.in/tag/web-security/)
[Leave a comment](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/#respond)

## [Arbitrary Command execution in Privacy Disclaimer page of a very popular organization](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/)

[November 17, 2019December 6, 2019](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> I found that ‘security and privacy’ section of this company’s website was vulnerable to command execution. I informed them about this issue and their security team was able to confirm it. They added me to their hall of fame and were able to fix the issue quickly. My overall experience of working with them was very pleasant.

One fine evening, while exploring an organization’s ‘Security and Privacy’ page, I don’t remember how I came across a [java stack trace](https://www.twilio.com/blog/how-to-read-and-understand-a-java-stacktrace). The last paragraph, after the stack trace caught my attention. It said –
**“You are seeing this page because development mode is enabled. To disable this mode, set struts.devmode=false”**.

I googled the error message but could not find anything relevant. Then, I searched for “**struts dev mode**” and somehow, landed at [Pwntester’s](http://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/) insightful blog on **OGNL Injection** via struts dev mode, (as well as a few other links on the command execution capability of the dev mode setting).

[**OGNL**](https://en.wikipedia.org/wiki/OGNL) is an expression language for Java which allows getting and setting JavaBeans properties, on the fly (using java reflection). It also allows execution of methods of Java classes.

Struts2 comes with an **inbuilt OGNL debug console named as [dev mode](https://struts.apache.org/core-developers/development-mode.html)**, to help developers with more verbose logs. This can also be used in testing OGNL expressions. Dev mode is disabled by default. If enabled, this setting uses [debugging interceptor](https://struts.apache.org/core-developers/debugging-interceptor.html) and supports four types of debug parameters.

* debug = console
   (non-intrusive way to confirm if devMode setting is enabled. If enabled, a new window with webconsole will open with a black background which can be used for further OGNL expression testing.)
* debug = browser
   (non-intrusive way to confirm if devMode is enabled. This will show all properties of the specified object value e.g. debug=browser&object=%23parameters)
* debug = xml
* debug = command
   (this is used to execute the intended OGNL payload.)

By using parameter **debug=command** and passing the specially crafted OGNL payload as ‘**expression**‘ parameter, a command execution can be achieved. e.g. As shown in the below URL, **debug** and **expression** parameters are passed to a Struts Action, HelloWorld.action.

```
http://<target>/struts2-blank/example/HelloWorld.action?debug=command&expression=1%2b1

```

**Mitigation and Remediation:**

**Always disable devMode in production**. Apache also mentions this in their [security tips](https://struts.apache.org/security/). Best way is to ensure the following setting is applied to your `struts.xml` in production:

```
<constant name ="struts.devMode" value="false" />
```

While by-default devMode is set to ‘False’, many applications enable this setting in their non-prod environment for verbose logs and forget to disable it when deploying to Prod.

**Timeline:**
8/26/2018 – Reported the issue to this organization
8/28/2018 – They acknowledged the report and confirmed that it was a valid issue and was not previously reported either internally or externally.
10/08/2018 – They fixed the issue and asked me to validate it.
10/08/2018 – They added me to their security hall of fame list.
05/02/2019 – Draft blog post shared with them
05/03/2019 – Organization said they need time to review it
06/20/2019 – Followed up with the them
06/25/2019 – They wrote that they were still reviewing the post
07/11/2019 – Followed up with the organization, received no response
07/22/2019 – Followed up with the organization, received no response
08/16/2019 – Followed up with the organization, received no response
08/22/2019 – Followed up with the organization, received no response
11/13/2019 – Followed up with the organization, no response from their side
11/16/2019 – Published this post but without any name.

**References:**
1) <http://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/>
2) <https://www.cvedetails.com/cve/cve-2012-0394>
3) <https://struts.apache.org/security/>
3) <https://www.rapid7.com/db/modules/exploit/multi/http/struts_dev_mode>
4) <https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/struts2-development-mode-enabled/>
5) <https://gist.github.com/mgeeky/5ba0170a5fd0171eb91bc1fd0f2618b7>
6) <https://issues.apache.org/jira/browse/WW-4348>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/), [Security](https://pankajupadhyay.in/category/security/)
[Struts-devMode](https://pankajupadhyay.in/tag/struts-devmode/), [Web-Security](https://pankajupadhyay.in/tag/web-security/)
[Leave a comment](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/#respond)

## [Tale of a Cross-Site Scripting vulnerability in ICICI Bank Website](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/)

[September 21, 2019December 10, 2019](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> **If you’re teaching reflected cross-site scripting to a newbie, what could be a classic example?**
>
> A search page taking search keyword as input and reflecting it back on the result page, along with the search results.

I logged into ICICI Bank website after ages and noticed a new search page on my dashboard. Out of curiosity, I just wanted to check if they were encoding the input properly. I entered a few special characters in the search field and right clicked on the result page to view the HTML source but an alert popped up stating that ‘Due to security reason, right click is not allowed’. It is generally very trivial to bypass such client side restrictions and I don’t think any site needs to do that as a security control.

I just added ‘view-source:’ before the URL and was able to see the generated HTML source. After looking at the HTML source, I worked on the XSS payload and below payload successfully popped up an alert, confirming the presence of Cross-Site Scripting vulnerability.

```
xxx')</script>alert("XSS")
```

* ![](https://pankajupadhyay.in/wp-content/uploads/2019/09/xss_icici_2.jpg?w=1024)

**Timeline:**

07/31/2016 – Reported this issue to ICICI’s anti-phishing email and whatever other emails I was able to find. Also shared the screenshot and steps to reproduce the issue.
08/02/2016 – Received a generic reply from their customer care asking for my account details and phone number to help me further.
08/02/2016 – Requested them to forward that email to their IT Security team or to anyone responsible for the IT department.
08/26/2016 – Asked for an acknowledgement or an update. Received a generic email from someone in customer care department.
03/05/2017 – Requested for an update.
01/18/2018 – After some good time, when I logged in to the ICICI site, I noticed that XSS was fixed. Emailed them again to confirm if it was fixed.
01/25/2018 – Received a generic email again from the customer care department asking for my account details and phone number to help me further.
09/21/2019 – As I never received an official response, my understanding is that this issue has been resolved. I’m writing this blog post for the general security awareness of my blog readers.

[Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Web-Security](https://pankajupadhyay.in/tag/web-security/), [XSS](https://pankajupadhyay.in/tag/xss/)
[1 Comment](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/#comments)

## [Formula Injection in npm’s xlsx module](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/)

[July 22, 2019July 22, 2019](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

**Summary:**
SheetJS package in npm ecosystem does not have any defense against Formula Injection.

**Details:**
Sheetjs package [xlsx](https://www.npmjs.com/package/xlsx) in npm ecosystem, allows parsing and editing various spreadsheet formats. As it is JS driven, it gives ability to render tables in the browser and allows modification of the tables on the fly. It also allows exporting this data in various spreadsheet formats e.g. xlsx, xlsb, csv etc.

[Formula Injection](http://georgemauer.net/2017/10/07/csv-injection.html) happens, when an application uses untrusted user input inside a spreadsheet format file and when this file is opened with a spreadsheet program such as Microsoft Excel.

This vulnerability exists because of the way Spreadsheet softwares handle formula characters (such as =, @, +, -). However, depending on the use-cases, applications can perform additional checks such data validation or escaping of formula characters by passing a single quote (‘) before the formula character, as described [here](https://www.we45.com/blog/2017/02/14/csv-injection-theres-devil-in-the-detail).

**Steps to reproduce:**

1. Click on one of the demos provided by sheetjs module e.g.
   <http://sheetjs.com/demos/modify.html>
   <http://sheetjs.com/demos/table.html>
2. Edit any cell in the table and update with the below value
   =cmd|’ /C calc’!A1
3. Export it into any spreadsheet format such as csv, xlsx, xlsb etc and open this file with Microsoft Excel
4. Excel’s latest versions show a warning. Click ok.
5. When this Formula executes, it will pop a calculator up on your Windows machine.
6. This can further be extended in exfiltrating data OOB as described [here](https://www.notsosecure.com/data-exfiltration-formula-injection/).

**Timeline:**

3/12/2019 – Reported to npm security team via a bug bounty platform, as well as sent an email directly to securityATnpm.com.
3/30/2019 – On the bounty platform, Package maintainer responded that this was excel’s behavior and not a vulnerability in the package itself. They also shared that this was reported to them via Github in January.
3/30/2019 – Report was closed on the bug bounty platform.
4/18/2019 – On the email side, one Security engineer from npm team acknowledged receiving the report and said he would be circling back.
6/27/2019 – Security Engineer from npm team reached out and shared that there was an outage hence there was no response from them. He asked for more details, which I provided.
7/02/2019 – Security Engineer from npm team said that he was able to reproduce the issue and also drafted an advisory. He said that advisory would be released once the patch is applied.
7/03/2019 – Security Engineer from npm team wrote back that the package maintainer said that this was an intended functionality and meant to behave like excel does. He also referenced that the npm working group had dismissed this vulnerability report through the bug bounty platform.
7/03/2019 – I requested for a public disclosure which was approved.
7/19/2019 – I shared a draft write-up with the npm team.
7/22/2019 – Publishing this blog post.

I’m writing this post for the awareness of [SheetJS](http://sheetjs.com/) users and consumers. If you are using this package, your users may not be protected against formula injection, by default. If you’re using it in your development projects, you may have to implement your own work-around, given on your use-case. Also, as a user, don’t ignore the excel warnings and review the untrusted formula before letting it execute.

**References:**

* <http://georgemauer.net/2017/10/07/csv-injection.html>
* <https://www.contextis.co.uk/resources/blog/comma-separated-vulnerabilities/>
* <https://pentestmag.com/formula-injection/>
* <https://www.we45.com/blog/2017/02/14/csv-injection-theres-devil-in-the-detail>
* <https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSV%20Injection>

[Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
[npm-security](https://pankajupadhyay.in/tag/npm-security/), [Security](https://pankajupadhyay.in/tag/security/)
[Leave a comment](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/#respond)

## [WebEx Meetings are vulnerable to MITM](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/)

[June 24, 2019May 2, 2020](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

In my free time, I was looking at some Android applications and noticed that I was able to intercept SSL traffic for Webex Meetings app. When explored it further, I found that Webex Meetings mobile app accepts self-signed certificates. Also there is no certificate pinning enabled.

This makes Webex meet app vulnerable to Man in the middle attack.

Users of this app, if connected to a public Wi-Fi spot, can be targeted by any person on the same network. If connected to a rogue Wi-Fi hotspot, Wi-Fi provider may have access to the data passed from the app to the server. Malwares on the device can also exploit this vulnerability to intercept any sensitive data while it is traveling across the wire.

A [proper SSL](https://developer.android.com/training/articles/security-ssl) ensures confidentiality and integrity of the information passed from point A to point B and is very important.
OWASP also puts **‘Insecure Communication’** on 3rd position in their top 10 list for mobile application vulnerabilities.
<https://www.owasp.org/index.php/Mobile_Top_10_2016-M3-Insecure_Communication>

In simpler terms, if you love connecting to free Wi-Fi hotspots for your Webex meetings, in your gym or coffeeshops, then your meetings may not be not secret anymore.

**Vulnerable version:**

I tested Webex Meetings Android app, version 10.6.0.21060208 Samsung S8 (on Android version 8.0).
As per vendor’s response, it seems all Webex mobile clients have similar behavior.

**Vendor Response :**

> Hi Pankaj, after discussing with our development team, I’ve learned that the Webex mobile client accepts self-signed certificates because the Webex meetings component also allows for deployments using self-signed certificates. Similarly, because the Webex mobile client has to be used with so many different sites, certificate pinning is also not enabled.
>
> See the documentation: <https://www.cisco.com/c/en/us/td/docs/collaboration/CWMS/3_0/Administration_Guide/cwms_b_administration-guide-3-0.html>
>
> Page 219 of administrator guide instructs how to import self-signed certificate on mobile device to join meetings. There are also instructions for iOS there as well.
>
> Page 256 of administrator guide instructs certificate management on the meetings server itself, including self-signed certificates.
>
> The guide also mentions that the client warns on accepting the self-signed certificate, and users should make sure the application is genuine before accepting Connect.
>
> These choices are consciously made by the business and documented for customers. As such, we do not consider them vulnerabilities. Although, you are correct, these configurations leave open the possibility of some attacks intended to defeat some SSL protections from attackers with privileged network positions. However, OCSP stapling is enabled as a hardening measure to verify SSL certificates.
>
> Due to requirements of supporting applications using self-signed certificates, the Webex business unit will not make any changes to address your findings. You are of course free to make public your findings. If you do so, please include references to the above documentation.
>
> Thank you again for your reports.

**Timeline:**

03/10/2018 – Issue reported to Cisco PSIRT
03/10/2018 – Report acknowledged by the incident manager and I was asked for more information
03/10/2018 – Shared the required details. Shared some screenshots from Packet Capture app.
03/27/2018 – I was asked if I could gather more information.
04/10/2018 – I shared some information again.
10/05/2018 – Reached out to the case manager and PSIRT DL for an update. 10/17/2018 – Reached out to PSIRT DL again for an update.
03/13/2019 – Reached out to PSIRT DL again for an update and asking permission for a public disclosure.
03/15/2019 – Got a response that previous case managed had moved on to a different position and also dev team was not able to confirm my report and because of that, there were no fixes.
03/20/2019 – Got the response confirming that Webex mobile clients accept self-signed cert and it is an intended behavior.

![](https://pankajupadhyay.in/wp-content/uploads/2019/06/screen-shot-2019-06-20-at-1.07.16-pm.png)

04/30/2019 – Requested for a public disclosure as even though Webex suggested they have it in the ‘admin’ documentation, I didn’t think Webex users were aware about the inherent risks.
06/20/2019 – Shared a draft write up with the PSIRT team
06/24/2019 – Released the advisory for the public.

**Credits:**

No CVE or bounty was awarded as vendor does not consider it a security issue. Vendor credited me for reporting this bug in their public bug release notes.

![](https://pankajupadhyay.in/wp-content/uploads/2019/06/screen-shot-2019-06-24-at-3.52.49-am.png)

<https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvi63354>

**Update :**
Someone pointed out that this issue was previously reported for the iOS app in 2012. CVE for that issue is [CVE-2012-6399](https://nvd.nist.gov/vuln/detail/CVE-2012-6399).

[Security](https://pankajupadhyay.in/category/security/)
[Security](https://pankajupadhyay.in/tag/security/)
[Leave a comment](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/#respond)

## [Popping up an XSS alert via a field which does not accept more than 20 characters](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/)

[July 27, 2011July 19, 2019](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

While testing an app, a text field was not accepting more than 20 characters (server side validation). I inserted following piece of code to check XSS (From [RSnake’s XSS cheat sheet](http://ha.ckers.org/xss.html)):

```
'';!--"<XSS>=&{()}

```

and verified the HTML source for the encoded characters . As `<` was in the HTML source,  the input field was seem to be missing output encoding and hence was vulnerable to cross site scripting.

Now, I just needed a popup to conclude this theory. I started looking for a smaller script. I tried to create/find some payloads which were less than 20 characters but I was unable to find anything. At that point of time, a random question came to my mind that, what is the smallest possible payload to pop up an alert. I know it was not needed to prove the XSS or missing output encoding but just a random question.

```
<a href=http://a.by>

```
> Update (7th March, 2019)- This is very old post and may be obsolete now. I guess as someone replied to that question in 2017, following may be the smallest payload to pop up an alert now. I need to check.
>
> <svg/onload=alert()>

[Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Penetration Testing](https://pankajupadhyay.in/tag/penetration-testing/), [XSS](https://pankajupadhyay.in/tag/xss/)
[Leave a comment](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/#respond)

## [ABC of Multibyte Characters](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/)

[August 30, 2009July 19, 2019](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

How many times you have seen some strange characters in an email or on any web site. How many times, as a developer you have seen that your code/content is getting converted to ‘?’ and users complained.

Previously, internet was limited to english (ASCII) but as soon as it started getting used globally, ASCII was not enough to help…..

If you want to read ABC of multibyte characters, ABC of character sets…. read this article written by [Joel](http://www.joelonsoftware.com/AboutMe.html), one of my favorite writer…<http://www.joelonsoftware.com/articles/Unicode.html>

[Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
[1 Comment](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/#comments)

## Posts navigation

[← Older posts](https://pankajupadhyay.in/page/2/)

### Categories

* [Hacking](https://pankajupadhyay.in/category/hacking/)
* [Java](https://pankajupadhyay.in/category/java/)
* [Note To Self](https://pankajupadhyay.in/category/note-to-self/)
* [Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/)
* [Security](https://pankajupadhyay.in/category/security/)
* [Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
* [Web](https://pankajupadhyay.in/category/web/)
* [XSS](https://pankajupadhyay.in/category/xss/)
### Archives

* [July 2024](https://pankajupadhyay.in/2024/07/)
* [October 2020](https://pankajupadhyay.in/2020/10/)
* [May 2020](https://pankajupadhyay.in/2020/05/)
* [December 2019](https://pankajupadhyay.in/2019/12/)
* [November 2019](https://pankajupadhyay.in/2019/11/)
* [September 2019](https://pankajupadhyay.in/2019/09/)
* [July 2019](https://pankajupadhyay.in/2019/07/)
* [June 2019](https://pankajupadhyay.in/2019/06/)
* [July 2011](https://pankajupadhyay.in/2011/07/)
* [August 2009](https://pankajupadhyay.in/2009/08/)
* [March 2009](https://pankajupadhyay.in/2009/03/)

[Scroll to Top](#masthead)

[Pankaj Upadhyay](https://pankajupadhyay.in/)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pankaj Upadhyay](https://pankajupadhyay.in)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpankajupadhyay.in%252F2024%252F07%252F04%252Faddressing-xss-vulnerabilities-a-case-study-with-tcl%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pankaj Upadhyay](https://pankajupadhyay.in)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpankajupadhyay.in%252F2024%252F07%252F04%252Faddressing-xss-vulnerabilities-a-case-study-with-tcl%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://pankajupadhyay.in)
  + [View site in Reader](https://wordpress.com/read/feeds/161139046)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

Privacy & Cookies: This site uses cookies. By continuing to use this website, you agree to their use.

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from pankajupadhyay.in_35fa9760_20250121_031500.html ===


# [Pankaj Upadhyay](https://pankajupadhyay.in/ "Pankaj Upadhyay")

…just another security professional, coming out of his shell

Search Icon
Search for:

Menu Toggle Icon

[Skip to content](#content)

* [$ls -a](https://pankajupadhyay.in/)
* [$echo](https://pankajupadhyay.in/hall-of-fames-acknowledgements/)
* [Home](/)

![Pankaj Upadhyay](https://s2.wp.com/wp-content/themes/premium/radiate/images/header/header-image-one.jpg)

## [XSS Vulnerability in TCL’s Website due to Insecure AEM Instance](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/)

[July 4, 2024July 5, 2024](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> A more fitting title for this post could have been “$10 for an XSS” ;), but to summarize, I discovered a Cross-Site Scripting (XSS) vulnerability on the US website of the well-known electronics company TCL and reported it to them.

This issue stemmed from an unpatched Adobe Experience Manager (AEM) vulnerability on TCL’s side.

[![](https://pankajupadhyay.in/wp-content/uploads/2022/08/screen-shot-2021-03-23-at-1.38.49-am.png?w=1024)](https://pankajupadhyay.in/wp-content/uploads/2022/08/screen-shot-2021-03-23-at-1.38.49-am.png)

Adobe Experience Manager is a suite of online cloud-based services provided by Adobe for content and digital asset management. From my limited research and reading a few years ago, I divided AEM into two main parts for my understanding. One part is accessible to the public, such as any content or documents, while the other is enterprise-side and designed to be protected from general public access. This protection is mainly achieved through authentication and an inbuilt Web Application Firewall (WAF) known as AEM Dispatcher.

Occasionally, I use Google dorking to look for known AEM bad patterns, such as sites with the exposed /crx/de endpoint. /crx/de is AEM’s content repository and should not be publicly accessible. While looking for it, I discovered that TCL had this issue. I then checked if the /setPreferences.jsp endpoint was exposed. There was a known vulnerability in AEM where the ‘keymap’ parameter, when passed to this endpoint, was vulnerable to XSS. Although this issue was later resolved by AEM, many sites are still susceptible to it. Most sites block this endpoint via AEM Dispatcher, so extra effort is needed to bypass this dispatcher and access the endpoint.

[0ang3el](https://x.com/0ang3el)‘s aem-hacker utility also highlights it [here](https://github.com/0ang3el/aem-hacker/blob/master/aem_hacker.py#L191) and can help in testing out against this AEM XSS attack vector.

I first tested the ‘keymap’ parameter with an HTML <h1> tag. When <h1> rendered on the page, I tried the javascript alert payload, and the alert popped up, confirming the presence of XSS.

I reported this to TCL’s security team.

Later, I realized that since the /crx/de endpoint was already exposed, the ‘..;’ AEM filter bypass wasn’t actually needed for this XSS. I shared the other URL with their security team as well.

<https://www.tcl.com/crx/de/setPreferences.jsp;.html?language=en&keymap=testmap%3Csvg%20onload=%22alert(document.domain)%22%3E>

**Timeline:**

* **03/23/2021** – Reported the issue to TCL team.
* **03/29/2021** – Requested an acknowledgment. Also shared that their /crx environment was exposed and another XSS vector that wouldn’t need the ‘..;’ escape.
* **06/28/2021** – Requested an update.
* **08/19/2021** – TCL responded, confirming the issue but deemed it low risk. They offered $10 and requested for my PayPal details.
* **09/13/2021** – I respectfully declined their offer and informed them about my preference to publish a blog post on this once they fix the issue. Asked for a timeline.
* **08/20/2022** – Requested an update.
* **Recently** – Forgot about this finding for a long time. Noticed recently that the finding was resolved hence shared this post for the knowledge and awareness of my readers.

[Hacking](https://pankajupadhyay.in/category/hacking/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Web-Security](https://pankajupadhyay.in/tag/web-security/), [XSS](https://pankajupadhyay.in/tag/xss/)
[Leave a comment](https://pankajupadhyay.in/2024/07/04/addressing-xss-vulnerabilities-a-case-study-with-tcl/#respond)

## [CVE-2019-8081 in Adobe Experience Manager](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/)

[October 2, 2020April 15, 2021](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

[Adobe Experience Manager](https://www.adobe.com/marketing/experience-manager.html) is a suite of online cloud-based services provided by Adobe for content and digital asset management. It includes a set of analytics, social, advertising, media optimization, targeting, Web experience management and content management products aimed at the advertising industry. There are various functions to enable consumers in managing their digital asset and content in different ways. One of the function provided by Adobe is ‘**Workflows**‘.

Workflows consist of a series of steps that are executed in a specific order. Each step performs a distinct activity such as activating a page or sending an email message. A workflow is made of steps which can be customized by using either an ECMA script or a Java class. AEM provides many useful workflow processes “by default”.

**Vulnerability Details:**

One of the Adobe provided workflow utility, [**urlcaller**](https://helpx.adobe.com/experience-manager/6-2/sites/developing/using/wf-process-ref.html) (which is a simple workflow process that calls any given URL), was logging the supplied password in the debug log. Adobe does mention here that this workflow process should be used only during development and demonstrations but people/organizations unaware of this condition and unaware of the password logging issue here, might have used this workflow process in any security sensitive setting which might have logged the passwords unknowingly in their debug logs.

Below is path of this workflow script and arguments it take.

* **ECMAScript path**: **/etc/workflow/scripts/urlcaller.ecma**
* **Payload**: None.
* **Arguments**:
  + **args := url [‘,’ login ‘,’ password]**
  + **url := /\* The URL to be called \*/**
  + **login := /\* The login to access the URL \*/**
  + **password := /\* The password to access the URL \*/**
  + for example: **<http://localhost:4502/my.jsp>, mylogin, mypassword**

**How I came across this issue?**

While testing one of the AEM targets, I came across an open and misconfigured [querybuilder servlet](https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/querybuilder-api.html) and used it to query the internal system for \*.ecma files. I came across this file urlcaller.ecma, and when I looked at the source code, I noticed that this code was logging the supplied password to the debug log.

![](https://pankajupadhyay.in/wp-content/uploads/2020/10/image-1.png?w=300)

I reported this issue to Adobe PSIRT. They did their investigation and confirmed the issue. Adobe released an advisory regarding this issue in their [security bulletin](https://helpx.adobe.com/security/products/experience-manager/apsb19-48.html) and assigned [CVE-2019-8081](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8081) to this finding.

Adobe PSIRT team was very responsive and updated me regularly on the fixes.

**Vendor Response:**

I shared a draft post with the Adobe team for review. As per Adobe team, for an AEM environment to be at risk, the following criteria is required:

* An administrator must enable debug logging
* This sample code, which is meant for demo purposes only, would be nevertheless used in production environments

![](https://pankajupadhyay.in/wp-content/uploads/2020/10/image.png?w=1024)

I don’t agree with this statement entirely but if you have ever used this workflow utility in your organization or if you are using an older version of AEM, please do check if this utility has logged any password to your debug logs and take the required action.

**Timeline:**

02/23/2019 – Reported this issue to Adobe
02/24/2019 – Adobe PSIRT responded and assigned it a case id
03/13/2019 – I requested for an update
03/14/2019 – Adobe PSIRT said they are still investing the issue
09/26/2019 – Adobe PSIRT informed me that they are fixing this issue in the next release
10/15/2019 – Adobe released the security bulletin for AEM.
08/25/2020 – Shared a draft post with Adobe for review
10/02/2020 – Published the blog post

References:

* <https://www.adobe.com/marketing/experience-manager.html>
* <https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/querybuilder-api.html>
* <https://en.wikipedia.org/wiki/Adobe_Experience_Cloud>
* <https://helpx.adobe.com/security/products/experience-manager/apsb19-48.html>
* <https://docs.adobe.com/content/help/en/experience-manager-65/developing/extending-aem/extending-workflows/workflows-process-ref.html>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/), [Security](https://pankajupadhyay.in/category/security/)
[1 Comment](https://pankajupadhyay.in/2020/10/02/cve-2019-8081-in-adobe-experience-manager/#comments)

## [Ok Google! bypass ‘flag\_secure’](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/)

[May 1, 2020May 19, 2020](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> Google Assistant on Android 9 can bypass the screen-capture protection provided by Android’s FLAG\_SECURE.

**Vulnerability Details:**

[**FLAG\_SECURE**](https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE) is a window level flag in Android ecosystem that allows mobile apps to safeguard their content from a screenshot capture. Application needs to enable it by specifying the `[WindowManager.LayoutParams#FLAG_SECURE](https://developer.android.com/reference/android/view/WindowManager.LayoutParams#FLAG_SECURE)` for the windows/screens, it doesn’t want to be recorded.

**We observed that Google Assistant on Pixel devices, was able to capture screenshots even when screens were protected with FLAG\_SECURE.**

This is also important to know that MediaProjectionAPI in Android, allows an app to capture screenshots programmatically. Any rogue app using this API and with proper permissions would have been able to capture screen of the device when other apps are in-use.

[NightWatch CyberSecurity](https://wwws.nightwatchcybersecurity.com/2016/04/13/research-securing-android-applications-from-screen-capture/) has written a detailed post on FLAG\_SECURE and MediaProjectionAPI. Google has some [sample code](https://github.com/android/media-samples/tree/master/ScreenCapture) on Github on how to use this API in capturing device screen in real time.

**Testing Steps:**

1. Install the Google Search app (<https://play.google.com/store/apps/details?id=com.google.android.googlequicksearchbox>). Enable assistant.
2. Go to the settings for Google Search and enable screenshots under “General”. Also enable “Use Screen Context” option under “Google Assistant”, “Phone”
3. Open Chrome in **incognito mode**, press Power + Volume Down. Note that screenshots won’t work.
4. Now tap the home button and hold, and say **“take screenshot”** or **“share screenshot”** and google assistant will take screenshot bypassing the ‘flag\_secure’ restrictions.

**This was tested on Pixel 2 and Pixel 3 devices running Android 9.**

**Timeline:**
03/12/2019 – Reported the finding through Google VRP
03/14/2019 – Google confirms the finding. Also tells us that it is a duplicate of an already tracked bug.
03/14/2019 – Asked when it will be patched and at what point we can disclose it publicly.
03/19/2019 – Received below response. Google recommended to check the status of the fix time to time.
![undefined](https://pankajupadhyay.in/wp-content/uploads/2020/05/screen-shot-2020-05-01-at-1.51.56-am.png)
04/30/2019 – I reached out to Google to know about the status of the fix and shared a draft write-up. No response from Google.
06/20/2019 – Asked again. No response.
08/30/2019 – Asked for a status update. No response.
04/14/2020 – Noticed that this finding was fixed in Android’s [September 2019 bulletin](https://source.android.com/security/bulletin/2019-09-01) and [CVE-2019-2103](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2103) was assigned to this issue. I shared a modified write-up with Google and asked if CVE-2019-2103 is for the same vulnerability. I did not receive any response.
05/01/2020 – Published this blog post.

This was jointly discovered by [Pankaj Upadhyay](https://pankajupadhyay.in/) and [NightWatch CyberSecurity](https://wwws.nightwatchcybersecurity.com/).

[Security](https://pankajupadhyay.in/category/security/)
[androidsecurity](https://pankajupadhyay.in/tag/androidsecurity/), [SecurityResearch](https://pankajupadhyay.in/tag/securityresearch/)
[Leave a comment](https://pankajupadhyay.in/2020/05/01/ok-google-bypass-flag-secure/#respond)

## [Audible, and a curious case of insecure by-default in Adobe SDKs](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/)

[December 6, 2019December 6, 2019](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> “[Insecure Communication](https://www.owasp.org/index.php/Mobile_Top_10_2016-M3-Insecure_Communication)” in Mobile apps are placed under OWASP Top 10 vulnerabilities and can be exploited in performing MITM attacks on targeted users. In this case, an adversary in the same network would have been able to view or modify user related information transmitted from the Audible mobile application to Adobe’s cloud services. Also, the underlying ISPs and/or Wifi Access point providers would have been able to see these calls and the shared data.

I was looking at Amazon’s **[Audible](https://play.google.com/store/apps/details?id=com.audible.application&hl=en_US)** app and noticed an HTTP call to a weird looking domain. After digging a little more, I found that it was owned by Adobe and seemed to be used for Adobe’s cloud based services for user behavior analysis.

User behavior analysis is very important to many online and app-based services and provides insights to product managers and marketers about their app/service usage.

An easy way to integrate this feature into mobile applications, is through the use of mobile SDKs. These software development kits/tools are available for different mobile operating systems and mobile developers can utilize these SDKs to implement specific functionalities in their apps, without worrying about the underlying operating system.

While searching for the cause of this behavior in Audible, I discussed it with [nightwatchcybersecurity](https://wwws.nightwatchcybersecurity.com/2019/11/06/insecure-defaults-in-adobes-mobile-sdks/). We noticed that it was happening because Adobe SDK for mobile, was not using a secure connection for transmitting user data between SDK and Adobe Cloud services. Further investigation revealed that SSL setting was disabled by-default in Adobe SDK for mobile app.

**Audible** seemed to be using these default settings and hence SDK utilized by Audible was missing the SSL/TLS protection while connecting to Adobe Cloud Services. Because of that, user data was being transmitted on an insecure connection. I reported this to Amazon team and they were able to resolve this issue very quickly. They also kept me updated on the status of the fix and were very proactive on the communication front.

Coming back to the SDK, Adobe SDK for mobile comes with a configuration file named as [ADBMobileConfig.json](https://docs.adobe.com/content/help/en/mobile-services/using/manage-app-settings-ug/configuring-app/download-sdk.html). This file comes with some pre-populated attributes and values, and SSL attribute is one of them. By default, this option was set as ‘false’ as mentioned [here](https://docs.adobe.com/content/help/en/mobile-services/android/configuration-android/json-config.html). Mobile Apps using this SDK and using the default values are missing the very important SSL protection.

NightWatch has written a detailed blog on this [‘insecure-default’](https://wwws.nightwatchcybersecurity.com/2019/11/06/insecure-defaults-in-adobes-mobile-sdks/) behavior and also has released a utility, to scan for this and some other settings.

**Adobe’s Response**
*Adobe has released new versions of the mobile SDKs, which can be found here:
<https://github.com/Adobe-Marketing-Cloud/acp-sdks>.

The SDKs are configurable in Adobe Experience Platform Launch and require SSL for data transmission.*

**Amazon’s Response**
*Thank you for your patience on the matter, we have no comments or change requests for the draft you have shared. We would appreciate if you can send us a link of your publication when you publish it.*

**Fixed version:**
Audible version 2.35 onward for Android

Amazon Case ID # PO135515801
CVE from MITRE # CVE-2019-11554

**Timeline:**

03/11/2019 – Reported this issue to Amazon
03/12/2019 – A case ID was assigned and additional questions were asked
03/14/2019 – Case manager informed that they were going ahead with the fix
04/04/2019 – Case manager informed that they had fixed the issue but were waiting for their users to upgrade the app.
04/23/2019 – Case manager informed that an updated version was made available to most of their users and they were closing this issue on their end.
11/06/2019 – Shared a draft report with nightwatchcyber for review.
11/06/2019 – Shared a draft report with Amazon.
11/07/2019 – Shared a draft report with Adobe.
11/07/2019 – Adobe acknowledged the email.
11/12/2019 – Shared an updated draft with everyone
11/12/2019 – Amazon acknowledged the email.
11/13/2019 – Adobe responded that if I could add their official response in my blogpost.
11/21/2019 – Amazon responded that I could go ahead with the post.
12/05/2019 – Published the blog post.

**References:**
1) Audible iOS App:
<https://apps.apple.com/us/app/audible-audiobooks-originals/id379693831>
2) Audible Android App:
<https://play.google.com/store/apps/details?id=com.audible.application&hl=en_US>
3) New Versions of Adobe Mobile SDKs:
 <https://github.com/Adobe-Marketing-Cloud/acp-sdks>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/)
[Adobe SDK](https://pankajupadhyay.in/tag/adobe-sdk/), [Secure By Default](https://pankajupadhyay.in/tag/secure-by-default/), [Web-Security](https://pankajupadhyay.in/tag/web-security/)
[Leave a comment](https://pankajupadhyay.in/2019/12/06/audible-and-a-curious-case-of-insecure-by-default-in-adobe-sdks/#respond)

## [Arbitrary Command execution in Privacy Disclaimer page of a very popular organization](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/)

[November 17, 2019December 6, 2019](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> I found that ‘security and privacy’ section of this company’s website was vulnerable to command execution. I informed them about this issue and their security team was able to confirm it. They added me to their hall of fame and were able to fix the issue quickly. My overall experience of working with them was very pleasant.

One fine evening, while exploring an organization’s ‘Security and Privacy’ page, I don’t remember how I came across a [java stack trace](https://www.twilio.com/blog/how-to-read-and-understand-a-java-stacktrace). The last paragraph, after the stack trace caught my attention. It said –
**“You are seeing this page because development mode is enabled. To disable this mode, set struts.devmode=false”**.

I googled the error message but could not find anything relevant. Then, I searched for “**struts dev mode**” and somehow, landed at [Pwntester’s](http://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/) insightful blog on **OGNL Injection** via struts dev mode, (as well as a few other links on the command execution capability of the dev mode setting).

[**OGNL**](https://en.wikipedia.org/wiki/OGNL) is an expression language for Java which allows getting and setting JavaBeans properties, on the fly (using java reflection). It also allows execution of methods of Java classes.

Struts2 comes with an **inbuilt OGNL debug console named as [dev mode](https://struts.apache.org/core-developers/development-mode.html)**, to help developers with more verbose logs. This can also be used in testing OGNL expressions. Dev mode is disabled by default. If enabled, this setting uses [debugging interceptor](https://struts.apache.org/core-developers/debugging-interceptor.html) and supports four types of debug parameters.

* debug = console
   (non-intrusive way to confirm if devMode setting is enabled. If enabled, a new window with webconsole will open with a black background which can be used for further OGNL expression testing.)
* debug = browser
   (non-intrusive way to confirm if devMode is enabled. This will show all properties of the specified object value e.g. debug=browser&object=%23parameters)
* debug = xml
* debug = command
   (this is used to execute the intended OGNL payload.)

By using parameter **debug=command** and passing the specially crafted OGNL payload as ‘**expression**‘ parameter, a command execution can be achieved. e.g. As shown in the below URL, **debug** and **expression** parameters are passed to a Struts Action, HelloWorld.action.

```
http://<target>/struts2-blank/example/HelloWorld.action?debug=command&expression=1%2b1

```

**Mitigation and Remediation:**

**Always disable devMode in production**. Apache also mentions this in their [security tips](https://struts.apache.org/security/). Best way is to ensure the following setting is applied to your `struts.xml` in production:

```
<constant name ="struts.devMode" value="false" />
```

While by-default devMode is set to ‘False’, many applications enable this setting in their non-prod environment for verbose logs and forget to disable it when deploying to Prod.

**Timeline:**
8/26/2018 – Reported the issue to this organization
8/28/2018 – They acknowledged the report and confirmed that it was a valid issue and was not previously reported either internally or externally.
10/08/2018 – They fixed the issue and asked me to validate it.
10/08/2018 – They added me to their security hall of fame list.
05/02/2019 – Draft blog post shared with them
05/03/2019 – Organization said they need time to review it
06/20/2019 – Followed up with the them
06/25/2019 – They wrote that they were still reviewing the post
07/11/2019 – Followed up with the organization, received no response
07/22/2019 – Followed up with the organization, received no response
08/16/2019 – Followed up with the organization, received no response
08/22/2019 – Followed up with the organization, received no response
11/13/2019 – Followed up with the organization, no response from their side
11/16/2019 – Published this post but without any name.

**References:**
1) <http://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/>
2) <https://www.cvedetails.com/cve/cve-2012-0394>
3) <https://struts.apache.org/security/>
3) <https://www.rapid7.com/db/modules/exploit/multi/http/struts_dev_mode>
4) <https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/struts2-development-mode-enabled/>
5) <https://gist.github.com/mgeeky/5ba0170a5fd0171eb91bc1fd0f2618b7>
6) <https://issues.apache.org/jira/browse/WW-4348>

[Note To Self](https://pankajupadhyay.in/category/note-to-self/), [Security](https://pankajupadhyay.in/category/security/)
[Struts-devMode](https://pankajupadhyay.in/tag/struts-devmode/), [Web-Security](https://pankajupadhyay.in/tag/web-security/)
[Leave a comment](https://pankajupadhyay.in/2019/11/17/command-execution-in-security-portal/#respond)

## [Tale of a Cross-Site Scripting vulnerability in ICICI Bank Website](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/)

[September 21, 2019December 10, 2019](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

> **If you’re teaching reflected cross-site scripting to a newbie, what could be a classic example?**
>
> A search page taking search keyword as input and reflecting it back on the result page, along with the search results.

I logged into ICICI Bank website after ages and noticed a new search page on my dashboard. Out of curiosity, I just wanted to check if they were encoding the input properly. I entered a few special characters in the search field and right clicked on the result page to view the HTML source but an alert popped up stating that ‘Due to security reason, right click is not allowed’. It is generally very trivial to bypass such client side restrictions and I don’t think any site needs to do that as a security control.

I just added ‘view-source:’ before the URL and was able to see the generated HTML source. After looking at the HTML source, I worked on the XSS payload and below payload successfully popped up an alert, confirming the presence of Cross-Site Scripting vulnerability.

```
xxx')</script>alert("XSS")
```

* ![](https://pankajupadhyay.in/wp-content/uploads/2019/09/xss_icici_2.jpg?w=1024)

**Timeline:**

07/31/2016 – Reported this issue to ICICI’s anti-phishing email and whatever other emails I was able to find. Also shared the screenshot and steps to reproduce the issue.
08/02/2016 – Received a generic reply from their customer care asking for my account details and phone number to help me further.
08/02/2016 – Requested them to forward that email to their IT Security team or to anyone responsible for the IT department.
08/26/2016 – Asked for an acknowledgement or an update. Received a generic email from someone in customer care department.
03/05/2017 – Requested for an update.
01/18/2018 – After some good time, when I logged in to the ICICI site, I noticed that XSS was fixed. Emailed them again to confirm if it was fixed.
01/25/2018 – Received a generic email again from the customer care department asking for my account details and phone number to help me further.
09/21/2019 – As I never received an official response, my understanding is that this issue has been resolved. I’m writing this blog post for the general security awareness of my blog readers.

[Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Web-Security](https://pankajupadhyay.in/tag/web-security/), [XSS](https://pankajupadhyay.in/tag/xss/)
[1 Comment](https://pankajupadhyay.in/2019/09/21/tale-of-a-cross-site-scripting-vulnerability-in-icici-bank-website/#comments)

## [Formula Injection in npm’s xlsx module](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/)

[July 22, 2019July 22, 2019](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

**Summary:**
SheetJS package in npm ecosystem does not have any defense against Formula Injection.

**Details:**
Sheetjs package [xlsx](https://www.npmjs.com/package/xlsx) in npm ecosystem, allows parsing and editing various spreadsheet formats. As it is JS driven, it gives ability to render tables in the browser and allows modification of the tables on the fly. It also allows exporting this data in various spreadsheet formats e.g. xlsx, xlsb, csv etc.

[Formula Injection](http://georgemauer.net/2017/10/07/csv-injection.html) happens, when an application uses untrusted user input inside a spreadsheet format file and when this file is opened with a spreadsheet program such as Microsoft Excel.

This vulnerability exists because of the way Spreadsheet softwares handle formula characters (such as =, @, +, -). However, depending on the use-cases, applications can perform additional checks such data validation or escaping of formula characters by passing a single quote (‘) before the formula character, as described [here](https://www.we45.com/blog/2017/02/14/csv-injection-theres-devil-in-the-detail).

**Steps to reproduce:**

1. Click on one of the demos provided by sheetjs module e.g.
   <http://sheetjs.com/demos/modify.html>
   <http://sheetjs.com/demos/table.html>
2. Edit any cell in the table and update with the below value
   =cmd|’ /C calc’!A1
3. Export it into any spreadsheet format such as csv, xlsx, xlsb etc and open this file with Microsoft Excel
4. Excel’s latest versions show a warning. Click ok.
5. When this Formula executes, it will pop a calculator up on your Windows machine.
6. This can further be extended in exfiltrating data OOB as described [here](https://www.notsosecure.com/data-exfiltration-formula-injection/).

**Timeline:**

3/12/2019 – Reported to npm security team via a bug bounty platform, as well as sent an email directly to securityATnpm.com.
3/30/2019 – On the bounty platform, Package maintainer responded that this was excel’s behavior and not a vulnerability in the package itself. They also shared that this was reported to them via Github in January.
3/30/2019 – Report was closed on the bug bounty platform.
4/18/2019 – On the email side, one Security engineer from npm team acknowledged receiving the report and said he would be circling back.
6/27/2019 – Security Engineer from npm team reached out and shared that there was an outage hence there was no response from them. He asked for more details, which I provided.
7/02/2019 – Security Engineer from npm team said that he was able to reproduce the issue and also drafted an advisory. He said that advisory would be released once the patch is applied.
7/03/2019 – Security Engineer from npm team wrote back that the package maintainer said that this was an intended functionality and meant to behave like excel does. He also referenced that the npm working group had dismissed this vulnerability report through the bug bounty platform.
7/03/2019 – I requested for a public disclosure which was approved.
7/19/2019 – I shared a draft write-up with the npm team.
7/22/2019 – Publishing this blog post.

I’m writing this post for the awareness of [SheetJS](http://sheetjs.com/) users and consumers. If you are using this package, your users may not be protected against formula injection, by default. If you’re using it in your development projects, you may have to implement your own work-around, given on your use-case. Also, as a user, don’t ignore the excel warnings and review the untrusted formula before letting it execute.

**References:**

* <http://georgemauer.net/2017/10/07/csv-injection.html>
* <https://www.contextis.co.uk/resources/blog/comma-separated-vulnerabilities/>
* <https://pentestmag.com/formula-injection/>
* <https://www.we45.com/blog/2017/02/14/csv-injection-theres-devil-in-the-detail>
* <https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSV%20Injection>

[Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
[npm-security](https://pankajupadhyay.in/tag/npm-security/), [Security](https://pankajupadhyay.in/tag/security/)
[Leave a comment](https://pankajupadhyay.in/2019/07/22/formula-injection-in-npms-xlsx-module/#respond)

## [WebEx Meetings are vulnerable to MITM](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/)

[June 24, 2019May 2, 2020](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

In my free time, I was looking at some Android applications and noticed that I was able to intercept SSL traffic for Webex Meetings app. When explored it further, I found that Webex Meetings mobile app accepts self-signed certificates. Also there is no certificate pinning enabled.

This makes Webex meet app vulnerable to Man in the middle attack.

Users of this app, if connected to a public Wi-Fi spot, can be targeted by any person on the same network. If connected to a rogue Wi-Fi hotspot, Wi-Fi provider may have access to the data passed from the app to the server. Malwares on the device can also exploit this vulnerability to intercept any sensitive data while it is traveling across the wire.

A [proper SSL](https://developer.android.com/training/articles/security-ssl) ensures confidentiality and integrity of the information passed from point A to point B and is very important.
OWASP also puts **‘Insecure Communication’** on 3rd position in their top 10 list for mobile application vulnerabilities.
<https://www.owasp.org/index.php/Mobile_Top_10_2016-M3-Insecure_Communication>

In simpler terms, if you love connecting to free Wi-Fi hotspots for your Webex meetings, in your gym or coffeeshops, then your meetings may not be not secret anymore.

**Vulnerable version:**

I tested Webex Meetings Android app, version 10.6.0.21060208 Samsung S8 (on Android version 8.0).
As per vendor’s response, it seems all Webex mobile clients have similar behavior.

**Vendor Response :**

> Hi Pankaj, after discussing with our development team, I’ve learned that the Webex mobile client accepts self-signed certificates because the Webex meetings component also allows for deployments using self-signed certificates. Similarly, because the Webex mobile client has to be used with so many different sites, certificate pinning is also not enabled.
>
> See the documentation: <https://www.cisco.com/c/en/us/td/docs/collaboration/CWMS/3_0/Administration_Guide/cwms_b_administration-guide-3-0.html>
>
> Page 219 of administrator guide instructs how to import self-signed certificate on mobile device to join meetings. There are also instructions for iOS there as well.
>
> Page 256 of administrator guide instructs certificate management on the meetings server itself, including self-signed certificates.
>
> The guide also mentions that the client warns on accepting the self-signed certificate, and users should make sure the application is genuine before accepting Connect.
>
> These choices are consciously made by the business and documented for customers. As such, we do not consider them vulnerabilities. Although, you are correct, these configurations leave open the possibility of some attacks intended to defeat some SSL protections from attackers with privileged network positions. However, OCSP stapling is enabled as a hardening measure to verify SSL certificates.
>
> Due to requirements of supporting applications using self-signed certificates, the Webex business unit will not make any changes to address your findings. You are of course free to make public your findings. If you do so, please include references to the above documentation.
>
> Thank you again for your reports.

**Timeline:**

03/10/2018 – Issue reported to Cisco PSIRT
03/10/2018 – Report acknowledged by the incident manager and I was asked for more information
03/10/2018 – Shared the required details. Shared some screenshots from Packet Capture app.
03/27/2018 – I was asked if I could gather more information.
04/10/2018 – I shared some information again.
10/05/2018 – Reached out to the case manager and PSIRT DL for an update. 10/17/2018 – Reached out to PSIRT DL again for an update.
03/13/2019 – Reached out to PSIRT DL again for an update and asking permission for a public disclosure.
03/15/2019 – Got a response that previous case managed had moved on to a different position and also dev team was not able to confirm my report and because of that, there were no fixes.
03/20/2019 – Got the response confirming that Webex mobile clients accept self-signed cert and it is an intended behavior.

![](https://pankajupadhyay.in/wp-content/uploads/2019/06/screen-shot-2019-06-20-at-1.07.16-pm.png)

04/30/2019 – Requested for a public disclosure as even though Webex suggested they have it in the ‘admin’ documentation, I didn’t think Webex users were aware about the inherent risks.
06/20/2019 – Shared a draft write up with the PSIRT team
06/24/2019 – Released the advisory for the public.

**Credits:**

No CVE or bounty was awarded as vendor does not consider it a security issue. Vendor credited me for reporting this bug in their public bug release notes.

![](https://pankajupadhyay.in/wp-content/uploads/2019/06/screen-shot-2019-06-24-at-3.52.49-am.png)

<https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvi63354>

**Update :**
Someone pointed out that this issue was previously reported for the iOS app in 2012. CVE for that issue is [CVE-2012-6399](https://nvd.nist.gov/vuln/detail/CVE-2012-6399).

[Security](https://pankajupadhyay.in/category/security/)
[Security](https://pankajupadhyay.in/tag/security/)
[Leave a comment](https://pankajupadhyay.in/2019/06/24/webex-meetings-are-vulnerable-to-mitm/#respond)

## [Popping up an XSS alert via a field which does not accept more than 20 characters](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/)

[July 27, 2011July 19, 2019](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

While testing an app, a text field was not accepting more than 20 characters (server side validation). I inserted following piece of code to check XSS (From [RSnake’s XSS cheat sheet](http://ha.ckers.org/xss.html)):

```
'';!--"<XSS>=&{()}

```

and verified the HTML source for the encoded characters . As `<` was in the HTML source,  the input field was seem to be missing output encoding and hence was vulnerable to cross site scripting.

Now, I just needed a popup to conclude this theory. I started looking for a smaller script. I tried to create/find some payloads which were less than 20 characters but I was unable to find anything. At that point of time, a random question came to my mind that, what is the smallest possible payload to pop up an alert. I know it was not needed to prove the XSS or missing output encoding but just a random question.

```
<a href=http://a.by>

```
> Update (7th March, 2019)- This is very old post and may be obsolete now. I guess as someone replied to that question in 2017, following may be the smallest payload to pop up an alert now. I need to check.
>
> <svg/onload=alert()>

[Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/), [Security](https://pankajupadhyay.in/category/security/), [XSS](https://pankajupadhyay.in/category/xss/)
[Penetration Testing](https://pankajupadhyay.in/tag/penetration-testing/), [XSS](https://pankajupadhyay.in/tag/xss/)
[Leave a comment](https://pankajupadhyay.in/2011/07/27/cross-site-scripting-verification-on-a-field-which-does-not-accept-more-than-20-characters/#respond)

## [ABC of Multibyte Characters](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/)

[August 30, 2009July 19, 2019](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/)[Pankaj Upadhyay](https://pankajupadhyay.in/author/pupadhyay/)

How many times you have seen some strange characters in an email or on any web site. How many times, as a developer you have seen that your code/content is getting converted to ‘?’ and users complained.

Previously, internet was limited to english (ASCII) but as soon as it started getting used globally, ASCII was not enough to help…..

If you want to read ABC of multibyte characters, ABC of character sets…. read this article written by [Joel](http://www.joelonsoftware.com/AboutMe.html), one of my favorite writer…<http://www.joelonsoftware.com/articles/Unicode.html>

[Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
[1 Comment](https://pankajupadhyay.in/2009/08/30/abc-of-multibyte-characters/#comments)

## Posts navigation

[← Older posts](https://pankajupadhyay.in/page/2/)

### Categories

* [Hacking](https://pankajupadhyay.in/category/hacking/)
* [Java](https://pankajupadhyay.in/category/java/)
* [Note To Self](https://pankajupadhyay.in/category/note-to-self/)
* [Penetration Testing](https://pankajupadhyay.in/category/penetration-testing/)
* [Security](https://pankajupadhyay.in/category/security/)
* [Uncategorized](https://pankajupadhyay.in/category/uncategorized/)
* [Web](https://pankajupadhyay.in/category/web/)
* [XSS](https://pankajupadhyay.in/category/xss/)
### Archives

* [July 2024](https://pankajupadhyay.in/2024/07/)
* [October 2020](https://pankajupadhyay.in/2020/10/)
* [May 2020](https://pankajupadhyay.in/2020/05/)
* [December 2019](https://pankajupadhyay.in/2019/12/)
* [November 2019](https://pankajupadhyay.in/2019/11/)
* [September 2019](https://pankajupadhyay.in/2019/09/)
* [July 2019](https://pankajupadhyay.in/2019/07/)
* [June 2019](https://pankajupadhyay.in/2019/06/)
* [July 2011](https://pankajupadhyay.in/2011/07/)
* [August 2009](https://pankajupadhyay.in/2009/08/)
* [March 2009](https://pankajupadhyay.in/2009/03/)

[Scroll to Top](#masthead)

[Pankaj Upadhyay](https://pankajupadhyay.in/)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pankaj Upadhyay](https://pankajupadhyay.in)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpankajupadhyay.in%252F2024%252F07%252F04%252Faddressing-xss-vulnerabilities-a-case-study-with-tcl%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pankaj Upadhyay](https://pankajupadhyay.in)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fpankajupadhyay.in%252F2024%252F07%252F04%252Faddressing-xss-vulnerabilities-a-case-study-with-tcl%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://pankajupadhyay.in)
  + [View site in Reader](https://wordpress.com/read/feeds/161139046)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

Privacy & Cookies: This site uses cookies. By continuing to use this website, you agree to their use.

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from helpx.adobe.com_dcfa5f7d_20250121_010610.html ===


# Adobe Security Bulletin

Search

User Guide

Select an article:
Select an article:

On this page

* [Summary](#Summary)
* [Affected product versions](#Affectedproductversions)
* [Solution](#solution)
* [Vulnerability details](#Vulnerabilitydetails)
* [Acknowledgments](#Acknowledgments)

![](/shared/article-3/alert.svg)

某些 Creative Cloud 应用程序、服务和功能在中国不可用。

[![](/shared/article-3/asurion_banner_final.jpg)](https://asurion.com/adobe/?utm_source=adobe&utm_medium=bannerad&utm_campaign=adobesupport)

Security updates available for Adobe Experience Manager | APSB19-48

| Bulletin ID | Date Published | Priority |
| --- | --- | --- |
| APSB19-48 | October 15, 2019 | 2 |

## Summary

Adobe has released security updates for Adobe Experience Manager (AEM). These updates resolve multiple vulnerabilities in AEM versions 6.3, 6.4 and 6.5.  Successful exploitation could result in unauthorized access to the AEM environment.

## Affected product versions

| **Product** | **Version** | **Platform** |
| --- | --- | --- |
| Adobe Experience Manager | 6.5  6.4  6.3  6.2  6.1  6.0 | All |

## Solution

Adobe categorizes these updates with the following [priority ratings](/security/severity-ratings.html) and recommends users update their installation to the newest version:

| Product | Version | Platform | Priority | Availability |
| --- | --- | --- | --- | --- |
| Adobe Experience Manager | 6.5 | All | 2 | [Releases and Updates](https://helpx.adobe.com/experience-manager/aem-releases-updates.html#65) |
| 6.4 | All | 2 | [Releases and Updates](https://helpx.adobe.com/experience-manager/aem-releases-updates.html#64) |
| 6.3 | All | 2 | [Releases and Updates](https://helpx.adobe.com/experience-manager/aem-releases-updates.html#63) |

Please contact [Adobe customer care](https://helpx.adobe.com/marketing-cloud/contact-support.html) for assistance with earlier AEM versions.

## Vulnerability details

| **Vulnerability Category** | **Vulnerability Impact** | **Severity** | **CVE Number** | **Affected Versions** | **Download Package** |
| --- | --- | --- | --- | --- | --- |
| Cross-Site Request Forgery | Sensitive Information disclosure | Important | CVE-2019-8234 | AEM 6.2  AEM 6.3  AEM 6.4 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0) |
| Reflected Cross Site Scripting | Sensitive Information disclosure | Moderate | CVE-2019-8078 | AEM 6.2  AEM 6.3  AEM 6.4 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0) |
| Stored Cross Site Scripting | Sensitive Information disclosure | Important | CVE-2019-8079 | AEM 6.0  AEM 6.1  AEM 6.2  AEM 6.3  AEM 6.4 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.4.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.4.0) |
| Stored Cross Site Scripting | Privilege Escalation | Important | CVE-2019-8080 | AEM 6.3  AEM 6.4 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0) |
| Authentication Bypass | Sensitive Information disclosure | Important | CVE-2019-8081 | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| XML External Entity Injection | Sensitive Information disclosure | Important | CVE-2019-8082 | AEM 6.2  AEM 6.3  AEM 6.4 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0) |
| Cross Site Scripting | Sensitive Information disclosure | Moderate | CVE-2019-8083 | AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| Reflected Cross Site Scripting | Sensitive Information disclosure | Moderate | CVE-2019-8084 | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.5.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.5.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| Reflected Cross Site Scripting | Sensitive Information disclosure | Moderate | CVE-2019-8085 | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.5.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.5.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| XML External Entity Injection | Sensitive Information disclosure | Important | CVE-2019-8086 | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| XML External Entity Injection | Sensitive Information disclosure | Important | CVE-2019-8087 | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |
| JavaScript Code Injection | Arbitrary Code Execution | Critical | CVE-2019-8088\* | AEM 6.2  AEM 6.3  AEM 6.4  AEM 6.5 | [Cumulative Fix Pack for 6.3 SP3 – AEM-6.3.3.6](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq630/cumulativefixpack/AEM-CFP-6.3.3.6)  [Service Pack for 6.4 - AEM-6.4.6.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq640/servicepack/AEM-6.4.6.0)  [Service Pack for 6.5 - AEM-6.5.2.0](https://www.adobeaemcloud.com/content/marketplace/marketplaceProxy.html?packagePath=/content/companies/public/adobe/packages/cq650/servicepack/AEM-6.5.2.0) |

Note:

JavaScript code execution (CVE-2019-8088) impacts version 6.2 only.  Beginning with 6.3, the strictly sandboxed Rhino engine is used to execute JavaScript, which reduces the impact of CVE-2019-8088 to blind Server-Side Request Forgery (SSRF) attacks and denial-of-service (DoS).

Note:

Note: the packages listed in the table above are the minimum fix packs to address the relevant vulnerability.  For the latest versions, please see the release notes links referenced above.

## Acknowledgments

Adobe would like to thank the following individuals and organizations for reporting the relevant issues and for working with Adobe to help protect our customers:

* [Lorenzo Pirondini](https://www.linkedin.com/in/lorenzo-pirondini/) ([Netcentric, a Cognizant Digital Business](http://www.netcentric.biz/)) (CVE-2019-8078, CVE-2019-8079, CVE-2019-8080, CVE-2019-8083, CVE-2019-8084, CVE-2019-8085)

* Pankaj Upadhyay of T. Rowe Price Associates, Inc. ([https://pankajupadhyay.in](https://pankajupadhyay.in/)) (CVE-2019-8081)

* Mikhail Egorov @0ang3el (CVE-2019-8086, CVE-2019-8087, CVE-2019-8088)

### Revisions

October 15, 2019: Updated CVE id from CVE-2019-8077 to CVE-2019-8234.

March 11, 2020: Added a note to clarify that JavaScript code execution (CVE-2019-8088) only impacts AEM 6.2.

### Ask the Community

Post questions and get answers from experts.

[Ask now](https://community.adobe.com/)

### Contact Us

Real help from real people.

[Start now](/contact.html)

^ Back to top

Was this page helpful?
Yes

No

No comment
Submit
By clicking Submit, you accept the [Adobe Terms of Use.](https://www.adobe.com/legal/terms.html)

Language Navigation

Language Navigation

Choose a region

Selecting a region changes the language and/or content on Adobe.com.

* Americas
* Brasil
* Canada - English
* Canada - Français
* Latinoamérica
* México
* Argentina
* Colombia
* Perú
* Chile
* United States
* Asia Pacific
* Australia
* Hong Kong S.A.R. of China
* India - English
* Indonesia - English
* Malaysia - English
* New Zealand
* Philippines - English
* Vietnam - English
* 中国
* 中國香港特別行政區
* 台灣地區
* 日本
* Indonesia
* Malaysia
* Pilipinas
* Việt Nam
* भारत
* 한국
* Singapore
* Thailand - English
* ประเทศไทย
* Europe, Middle East and Africa
* Africa - English
* België - Nederlands
* Belgique - Français
* Belgium - English
* Česká republika
* Danmark
* Deutschland
* Eesti
* España
* France
* Greece - English
* Ireland
* Israel - English
* Italia
* Latvija
* Lietuva
* Luxembourg - Deutsch
* Luxembourg - English
* Luxembourg - Français
* Magyarország
* Middle East and North Africa - English
* Nederland
* Norge
* Österreich
* Polska
* Portugal
* România
* Schweiz
* Slovenija
* Slovensko
* Suisse
* Suomi
* Svizzera
* Türkiye
* United Kingdom
* България
* Россия
* Україна
* الشرق الأوسط وشمال أفريقيا - اللغة العربية
* ישראל - עברית
* Sverige
* Saudi Arabia - English
* United Arab Emirates - English
* الإمارات العربية المتحدة
* المملكة العربية السعودية

Language Navigation

Language Navigation

Choose a region

Selecting a region changes the language and/or content on Adobe.com.

* Americas
* Brasil
* Canada - English
* Canada - Français
* Latinoamérica
* México
* Argentina
* Colombia
* Perú
* Chile
* United States
* Asia Pacific
* Australia
* Hong Kong S.A.R. of China
* India - English
* Indonesia - English
* Malaysia - English
* New Zealand
* Philippines - English
* Vietnam - English
* 中国
* 中國香港特別行政區
* 台灣地區
* 日本
* Indonesia
* Malaysia
* Pilipinas
* Việt Nam
* भारत
* 한국
* Singapore
* Thailand - English
* ประเทศไทย
* Europe, Middle East and Africa
* Africa - English
* België - Nederlands
* Belgique - Français
* Belgium - English
* Česká republika
* Danmark
* Deutschland
* Eesti
* España
* France
* Greece - English
* Ireland
* Israel - English
* Italia
* Latvija
* Lietuva
* Luxembourg - Deutsch
* Luxembourg - English
* Luxembourg - Français
* Magyarország
* Middle East and North Africa - English
* Nederland
* Norge
* Österreich
* Polska
* Portugal
* România
* Schweiz
* Slovenija
* Slovensko
* Suisse
* Suomi
* Svizzera
* Türkiye
* United Kingdom
* България
* Россия
* Україна
* الشرق الأوسط وشمال أفريقيا - اللغة العربية
* ישראל - עברית
* Sverige
* Saudi Arabia - English
* United Arab Emirates - English
* الإمارات العربية المتحدة
* المملكة العربية السعودية



=== Content from www.linkedin.com_55624dca_20250121_031458.html ===



