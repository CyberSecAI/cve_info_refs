=== Content from cdn.prod.website-files.com_5a36c2ef_20250121_014912.html ===




=== Content from research.loginsoft.com_6dcce87c_20250120_234247.html ===
[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22ba452b20ebeb6450c5_Loginsoft%20Logo%20Black.svg)](/)Services[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management](/vulnerability-management-configuration)Threat Research & Intelligence Services[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)Software Supply Chain Security Services[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)Cloud Native Security Services[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science &Â AI](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Development &Â Support](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation](/staff-augmentation)ServicesCybersecurity Solutions[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-management-configuration)SOFTWARE SUPPLY CHAIN SECURITY[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/zero-day-discovery)THREAT RESEARCH & INTELLIGENCE[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/external-attack-surface-discovery)CLOUDÂ NATIVEÂ SECURITY[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science & AI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Dev & Support![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/staff-augmentation)Platforms[LOVI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/lovi)[Cytellite![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cytellite)[Research-as-a-Service](/research-as-a-service)Research[Zero-Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-advisories)[Our Research![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](https://research.loginsoft.com/)Company[Blog![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/blogs)[Reports![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/reports)[Case Studies![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/case-studies)[About us![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/about-us)[Careers![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/careers)[Talk to us](/contact)[Talk to us](/contact)By using this website, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our [Privacy Policy](/privacy-policy) for more information.Accept![Green Plus icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65cde7d5fe78a54970c7984e_Green-Plus.svg)[Home](/)/Research/[Zero Day Discovery](/security-advisories)/CVE-2019-9589: NULL POINTER DEREFERENCE Vulnerability in function PSOutputDev::setupResources( ) - xpdf-4.01
## CVE-2019-9589: NULL POINTER DEREFERENCE Vulnerability in function PSOutputDev::setupResources( ) - xpdf-4.01

Vulnerability ReportsFebruary 27, 2019![Profile Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65a91b500b759f07aaa89823_Blog%20Author%20DP%20Placeholder.png)

Jason Franscisco

**NULL POINTER DEREFERENCE Vulnerability in function PSOutputDev::setupResources( ) - xpdf-4.01**

Loginsoft-2019-1103

27 February, 2019

##### CVE Number

CVE-2019-9589

##### CWE

CWE-476: NULL Pointer Dereference

##### Product Details

Xpdf is a free PDF viewer and toolkit, including a text extractor, image converter, HTML converter, and more. Most of the tools are available as open source.
**URL:** <https://www.xpdfreader.com/download.html>

##### Vulnerable Versions

4.01

##### Vulnerability Details

During our research there is a null pointer dereference vulnerability, in `PSOutputDev::setupResources( )` located in PSOutputDev.cc in xpdf-4.01. The same be triggered by sending a crafted pdf file to the pdftops binary. It allows an attacker to cause Denial of Service (Segmentation fault) or possibly have unspecified other impact.

##### SYNOPSIS

In Progress

##### Vulnerable Source Code

```

if ((gsDict.dictGetValNF(i, &gsRef)->isRef())) {
        ref0 = gsRef.getRef();
â    skip = (GBool)visitedResources[ref0.num];
        visitedResources[ref0.num] = 1;
            }

```

##### Analysis

DEBUG:
GDB:

```

[ Legend: Modified register | Code | Heap | Stack | String ]
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ registers ââââ
$rax   : 0x0000602fa004e880  â  0x0000000000000000
$rbx   : 0x000060300004e820  â  0x000060705b800009  â  0x0000000000000000
$rcx   : 0x00007fffffffda30  â  0x000060f000000009  â  0x0000000000000000
$rdx   : 0x000060300004e880  â  0x0000000000000000
$rsp   : 0x00007fffffffd990  â  0x000060400000d3d0  â  0x000061d00001cc80  â  0x000061300000de80  â  0x00000000005b1dc8  â  0x0000000000518dd8  â   push rbp
$rbp   : 0x00007fffffffda90  â  0x00007fffffffdb40  â  0x00007fffffffdbe0  â  0x00007fffffffdc80  â  0x00007fffffffdd50  â  0x000000000058efd0  â   push r15
$rsi   : 0x00007fffffffda30  â  0x000060f000000009  â  0x0000000000000000
$rdi   : 0x00007fffffffda30  â  0x000060f000000009  â  0x0000000000000000
$rip   : 0x0000000000451b2d  â   movzx eax, BYTE PTR [rax]
$r8    : 0x0
$r9    : 0x185d1
$r10   : 0x58
$r11   : 0x00007ffff7f1d820  â  0x0000000000000000
$r12   : 0x00007fffffffdaf0  â  0xbebebebe0000000d
$r13   : 0x00007fffffffde30  â  0x0000000000000012
$r14   : 0x0
$r15   : 0x0
$eflags: [CARRY parity adjust zero sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
$cs: 0x0033 $ss: 0x002b $ds: 0x0000 $es: 0x0000 $fs: 0x0000 $gs: 0x0000
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ stack ââââ
0x00007fffffffd990â+0x0000: 0x000060400000d3d0  â  0x000061d00001cc80  â  0x000061300000de80  â  0x00000000005b1dc8  â  0x0000000000518dd8  â   push rbp     â $rsp
0x00007fffffffd998â+0x0008: 0x0000616000002180  â  0x0000000000595a68  â  0x000000000044fa1e  â   push rbp
0x00007fffffffd9a0â+0x0010: 0x000060c000007840  â  0x000000004a000006
0x00007fffffffd9a8â+0x0018: 0x0000000000000000
0x00007fffffffd9b0â+0x0020: 0x00000000a0000000  â  0x0000000000000000
0x00007fffffffd9b8â+0x0028: 0x000000000050ee6f  â   add rsp, 0x30
0x00007fffffffd9c0â+0x0030: 0xffffffff0000000d
0x00007fffffffd9c8â+0x0038: 0x00007ffff5da9242  â   mov QWORD PTR [rbx+0x28], rax
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ code:x86:64 ââââ
     0x451b21  add    BYTE PTR [rbx-0xdf7b], cl
     0x451b27  dec    DWORD PTR [rax-0x68]
     0x451b2a  add    rax, rdx
â   0x451b2d  movzx  eax, BYTE PTR [rax]
     0x451b30  movsx  eax, al
     0x451b33  mov    DWORD PTR [rbp-0xe8], eax
     0x451b39  mov    rax, QWORD PTR [rbp-0xf8]
     0x451b40  mov    rdx, QWORD PTR [rax+0x138]
     0x451b47  mov    eax, DWORD PTR [rbp-0xe0]
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ source:/home/aceteam/Downloads/sources/xpdf-4.01/xpdf/PSOutputDev.cc+1991 ââââ
   1986
   1987           // check for an already-visited ExtGState
   1988           skip = gFalse;
   1989           if ((gsDict.dictGetValNF(i, &gsRef)->isRef())) {
   1990         ref0 = gsRef.getRef();
â 1991         skip = (GBool)visitedResources[ref0.num];
   1992         visitedResources[ref0.num] = 1;
   1993           }
   1994           if (!skip) {
   1995
   1996         // process the ExtGState's SMask's transparency group's resource dict
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ threads ââââ
[#0] Id 1, Name: "pdftops", stopped, reason: SIGSEGV
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ trace ââââ
[#0] 0x451b2d â PSOutputDev::setupResources(this=0x616000002180, resDict=0x60400000d3d0)
[#1] 0x450cdc â PSOutputDev::writeDocSetup(this=0x616000002180, catalog=0x611000008880)
[#2] 0x44f990 â PSOutputDev::init(this=0x616000002180, outputFuncA=0x44eb56 , outputStreamA=0x616000001e80, fileTypeA=psFile, docA=0x60700000dfb0, firstPageA=0x2, lastPageA=0x4, modeA=psModePS, imgLLXA=0x0, imgLLYA=0x0, imgURXA=0x0, imgURYA=0x0, manualCtrlA=0x0, honorUserUnitA=0x1)
[#3] 0x44ee44 â PSOutputDev::PSOutputDev(this=0x616000002180, fileName=0x60200004e290 "out.ps", docA=0x60700000dfb0, firstPageA=0x2, lastPageA=0x4, modeA=psModePS, imgLLXA=0x0, imgLLYA=0x0, imgURXA=0x0, imgURYA=0x0, manualCtrlA=0x0, customCodeCbkA=0x0, customCodeCbkDataA=0x0, honorUserUnitA=0x1)
[#4] 0x47dbbc â main(argc=0x3, argv=0x7fffffffde38)

gefâ¤  ptype visitedResources
type = char *
gefâ¤  x visitedResources[0]
0x0:    Cannot access memory at address 0x0

```

##### Proof of Concept

`pdftops -f 2 -l 4 -level2 -noembt1 -preload -nocrop -noshrink -nocenter -pagecrop -userunit -duplex -upw rome $POC out.ps`
POC FILE: [REPRODUCER](https://github.com/SegfaultMasters/covering360/blob/master/xpdf/poc%27s/NPPOC?raw=true)

**Timeline**
Vendor Disclosure: 2019-2-27
Public Disclosure: 2019-3-6

##### Credit

Discovered by ACE Team - [Loginsoft](https://www.loginsoft.com)

Explore Cybersecurity Platforms

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros.

Discover Lovi
## Sign up to our Newsletter

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Cybersecurity Solutions[Vulnerability Intelligence](/vulnerability-intelligence)[Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[Vulnerability & Configuration Management](/vulnerability-management-configuration)[OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[OSS - Dependancy Defence](/software-supply-chain-security/dependency-defense)[OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)[Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)[Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[Data Science &Â AI](/data-science-and-ai)[Software Development Â & Support](/software-development-and-support)[QA Automation](/qa-automation)[Staff Augmentation](/staff-augmentation)Platforms[LOVI](/lovi)[Cytellite](/cytellite)Company[Blogs](/blogs)[Reports](/reports)[About us](/about-us)[Careers](/careers)Research[Research-as-a -Service](/research-as-a-service)[Zero-Day Discovery](/security-advisories)![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22b99ceecda456b052cd_Loginsoft%20Logo%20White.svg)1-703-956-7410info@loginsoft.com[![Linkedin Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d02956967bd81ab620_LinkedIn.svg)](https://www.linkedin.com/company/loginsoft/)[![X icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d0e8e8f3e5866a563b_X.svg)](https://twitter.com/Loginsoft_Inc)[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b8dafdc42d3397ec72e17c_github-mark-white%201.svg)](https://github.com/Loginsoft-Research)Â© 2024 - Copyright[Privacy policy](/privacy-policy)

![](https://px.ads.linkedin.com/collect/?pid=562737&fmt=gif)


