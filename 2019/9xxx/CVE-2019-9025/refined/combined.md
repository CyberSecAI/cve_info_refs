=== Content from security.netapp.com_3e6e4d2b_20250120_234936.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [February 2019 PHP Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20190321-0001)

## February 2019 PHP Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20190321-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20190321-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20190321-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20190321-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20190321-0001
**Version:**
1.0

**Last updated:**
03/21/2019

**Status:**
Final.

**CVEs:** CVE-2019-9025, CVE-2019-9024, CVE-2019-9023, CVE-2019-9022, CVE-2019-9021, CVE-2019-9020

Overview
#### Summary

Multiple NetApp products incorporate PHP. PHP versions before 5.6.40, 7.x before 7.1.26, 7.2.x before 7.2.14, and 7.3.x before 7.3.1 are susceptible to vulnerabilities,that could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-9020](https://nvd.nist.gov/vuln/detail/CVE-2019-9020) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-9021](https://nvd.nist.gov/vuln/detail/CVE-2019-9021) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-9022](https://nvd.nist.gov/vuln/detail/CVE-2019-9022) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2019-9023](https://nvd.nist.gov/vuln/detail/CVE-2019-9023) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-9024](https://nvd.nist.gov/vuln/detail/CVE-2019-9024) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2019-9025](https://nvd.nist.gov/vuln/detail/CVE-2019-9025) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://bugs.php.net/bug.php?id=77367>
* <https://bugs.php.net/bug.php?id=77380>
* <https://bugs.php.net/bug.php?id=77370>
* <https://bugs.php.net/bug.php?id=77371>
* <https://bugs.php.net/bug.php?id=77381>
* <https://bugs.php.net/bug.php?id=77382>
* <https://bugs.php.net/bug.php?id=77385>
* <https://bugs.php.net/bug.php?id=77394>
* <https://bugs.php.net/bug.php?id=77418>
* <https://bugs.php.net/bug.php?id=77369>
* <https://bugs.php.net/bug.php?id=77247>
* <https://bugs.php.net/bug.php?id=77242>
* <https://bugs.php.net/bug.php?id=77249>

Affected Products
#### Affected Products

None.

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Linux 7.3 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Windows 7.3 and above
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity Management Plug-ins (VMware vCenter)
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC)
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MAX Data
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp Element System Firmware
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Service Level Manager
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SteelStore Cloud Integrated Storage
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 3.x
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* SAS Firmware
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID Webscale NAS Bridge
* StorageGRID9 (9.x and prior)
* System Setup
* Trident
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20190321-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20190321 | Initial Public Release, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from bugs.php.net_d8e6b474_20250120_234934.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Sec Bug](bug.php?id=77367) #77367 | Negative size parameter in mb\_split | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2018-12-29 02:43 UTC | Modified: | 2019-02-22 23:17 UTC |  | | From: | hugh at allthethings dot co dot nz | Assigned: | [stas](search.php?cmd=display&assign=stas) ([profile](https://people.php.net/stas)) | | Status: | Closed | Package: | [mbstring related](search.php?cmd=display&package_name[]=mbstring+related) | | PHP Version: | 7.3.0 | OS: | Linux | | Private report: | No | CVE-ID: | [2019-9025](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9025) |   View [Developer](bug.php?id=77367&edit=1) [Edit](bug.php?id=77367&edit=2)   **[2018-12-29 02:43 UTC] hugh at allthethings dot co dot nz** ``` Description: ------------ mb_split doesn't correctly detect the length when the $string has an unfinished multibyte character at the end of the string. This causes a crash due to a negative parameter to add_next_index_stringl, which calls zend_string_init and memcpy.  This could be used to cause memory corruption/leakage.   configure options are: ./configure --enable-static --enable-cli --enable-mbstring --disable-shared --disable-all CFLAGS="-fPIC -Og -g3" LIBS=-ldl   Could reproduce on master. Couldn't reproduce on 5.6.39, 7.0.33, 7.1.25 and 7.2.13, though the same code exists (a different fuzz may produce the same).  Caused by comparison of unsigned number (size_t) to 0 to test whether it is positive. Fixed by altering the comparison to not test for negative, but instead check whether value to subtract is less than.  Patch at <https://gist.github.com/hughdavenport/5128662f237d8b54d2e2b22dc7d18d5e>  Interestingly, it doesn't crash with "[[:word:]]", but does with "\w", so the docs at <https://secure.php.net/manual/en/regexp.reference.character-classes.php> may be slightly incorrect.  Test script: --------------- php -r 'var_dump(mb_split("\w","\xfc"));'  Expected result: ---------------- No crash   Actual result: -------------- $ gdb --args ./php-7.3.0/sapi/cli/php-mbstring-afl-fast -r 'var_dump(mb_split("\w","\xfc"));' GNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git Copyright (C) 2018 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later <<http://gnu.org/licenses/gpl.html>> This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.  Type "show copying" and "show warranty" for details. This GDB was configured as "x86_64-linux-gnu". Type "show configuration" for configuration details. For bug reporting instructions, please see: <<http://www.gnu.org/software/gdb/bugs/>>. Find the GDB manual and other documentation resources online at: <<http://www.gnu.org/software/gdb/documentation/>>. For help, type "help". Type "apropos word" to search for commands related to "word"... Reading symbols from ./php-7.3.0/sapi/cli/php-mbstring-afl-fast...done. (gdb) r Starting program: /home/hugh/php-7.3.0/sapi/cli/php-mbstring-afl-fast -r var_dump\(mb_split\(\"\\w\",\"\\xfc\"\)\)\; [Thread debugging using libthread_db enabled] Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".  Program received signal SIGSEGV, Segmentation fault. __memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:526 526     ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S: No such file or directory. (gdb) bt #0  __memmove_avx_unaligned_erms () at ../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:526 #1  0x0000000000a72a5a in zend_string_init (str=0x122821e "", len=18446744073709551611, persistent=0) at Zend/zend_string.h:157 #2  add_next_index_stringl (arg=0x7ffff661c080, str=0x122821e "", length=18446744073709551611) at Zend/zend_API.c:1595 #3  0x000000000072bf72 in zif_mb_split (execute_data=<optimized out>, return_value=<optimized out>) at ext/mbstring/php_mbregex.c:1303 #4  0x0000000000c4d418 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER (execute_data=0x7ffff661c030) at Zend/zend_vm_execute.h:690 #5  0x0000000000b3e39e in execute_ex (ex=0x7ffff661c030) at Zend/zend_vm_execute.h:55287 #6  0x0000000000b3e8db in zend_execute (op_array=0x7ffff667d2a0, return_value=<optimized out>) at Zend/zend_vm_execute.h:60834 #7  0x0000000000a36222 in zend_eval_stringl (str=<optimized out>, str_len=<optimized out>, retval_ptr=<optimized out>, string_name=<optimized out>) at Zend/zend_execute_API.c:1018 #8  0x0000000000a365fb in zend_eval_stringl_ex (str=0x121ae20 "var_dump(mb_split(\"\\w\",\"\\xfc\"));", str_len=140737327259816, retval_ptr=0x0, string_name=0xf0c436 "Command line code",     handle_exceptions=1) at Zend/zend_execute_API.c:1059 #9  zend_eval_string_ex (str=0x121ae20 "var_dump(mb_split(\"\\w\",\"\\xfc\"));", retval_ptr=0xfffffffffffa1ef8, string_name=0x11ca0f6 <stage3_table_html5_1D500+774> "", handle_exceptions=1)     at Zend/zend_execute_API.c:1070 #10 0x0000000000ce5c66 in do_cli (argc=<optimized out>, argv=<optimized out>) at sapi/cli/php_cli.c:1030 #11 0x0000000000ce407b in main (argc=3, argv=<optimized out>) at sapi/cli/php_cli.c:1392   $ ./php-7.3.0/sapi/cli/php-mbstring-asan-fast -r 'var_dump(mb_split("\w","\xfc"));' ================================================================= ==9942==ERROR: AddressSanitizer: negative-size-param: (size=-5)     #0 0x4db2e5 in __asan_memcpy (/home/hugh/php-7.3.0/sapi/cli/php-mbstring-asan-fast+0x4db2e5)     #1 0x1083844 in zend_string_init /home/hugh/php-7.3.0/Zend/zend_string.h:157:2     #2 0x1083844 in add_next_index_stringl /home/hugh/php-7.3.0/Zend/zend_API.c:1595     #3 0xa7648f in zif_mb_split /home/hugh/php-7.3.0/ext/mbstring/php_mbregex.c     #4 0x1410c05 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/hugh/php-7.3.0/Zend/zend_vm_execute.h:690:2     #5 0x11fee0d in execute_ex /home/hugh/php-7.3.0/Zend/zend_vm_execute.h:55287:7     #6 0x11ff661 in zend_execute /home/hugh/php-7.3.0/Zend/zend_vm_execute.h:60834:2     #7 0x1012390 in zend_eval_stringl /home/hugh/php-7.3.0/Zend/zend_execute_API.c:1018:4     #8 0x1012c1a in zend_eval_stringl_ex /home/hugh/php-7.3.0/Zend/zend_execute_API.c:1059:11     #9 0x1012c1a in zend_eval_string_ex /home/hugh/php-7.3.0/Zend/zend_execute_API.c:1070     #10 0x153d7c6 in do_cli /home/hugh/php-7.3.0/sapi/cli/php_cli.c:1030:5     #11 0x153a6de in main /home/hugh/php-7.3.0/sapi/cli/php_cli.c:1392:18     #12 0x7fb02af8cb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310     #13 0x43aa99 in _start (/home/hugh/php-7.3.0/sapi/cli/php-mbstring-asan-fast+0x43aa99)  0x6030000032fe is located 30 bytes inside of 32-byte region [0x6030000032e0,0x603000003300) allocated by thread T0 here:     #0 0x4f00f0 in malloc (/home/hugh/php-7.3.0/sapi/cli/php-mbstring-asan-fast+0x4f00f0)     #1 0xf66f9c in __zend_malloc /home/hugh/php-7.3.0/Zend/zend_alloc.c:2904:14  SUMMARY: AddressSanitizer: negative-size-param (/home/hugh/php-7.3.0/sapi/cli/php-mbstring-asan-fast+0x4db2e5) in __asan_memcpy ==9942==ABORTING      ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2018-12-29 12:43 UTC] [cmb@php.net](//people.php.net/cmb)** -Status: Open +Status: Verified -Assigned To: +Assigned To: cmb **[2018-12-29 12:43 UTC] [cmb@php.net](//people.php.net/cmb)** ``` Thanks for reporting this bug.  I can confirm the described issue, and also that your patch fixes it.  PHP-7.2 and older are not affected, since `n` had been declared as int there.  > Interestingly, it doesn't crash with "[[:word:]]", but does with > "\w", so the docs at > <https://secure.php.net/manual/en/regexp.reference.character-classes.php> > may be slightly incorrect.  These docs are about the PCRE extension; mb_split() and the other mbregex functions use the Oniguruma engine which uses a somewhat different pattern syntax.  ``` **[2018-12-29 13:22 UTC] [cmb@php.net](//people.php.net/cmb)** -Status: Verified +Status: Analyzed -Assigned To: cmb +Assigned To: stas **[2018-12-29 13:22 UTC] [cmb@php.net](//people.php.net/cmb)** ``` Stas, can you please apply the formatted patch[1] to the security repo (PHP-7.3 and up)?  [1] <<https://gist.github.com/cmb69/a2be4dd4240bbee11ce4cb801c60d6ab>>  ``` **[2018-12-29 19:42 UTC] hugh at allthethings dot co dot nz** ``` Ah yeh, being an int in previous versions makes sense. Thought I was going mad!  That makes sense with the docs. I'm not sure any of the function pages describe what syntax Oniguruma uses. Would it be worth me creating another bug for that to get written at some point?  Cheers,  Hugh  ``` **[2018-12-30 03:12 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: +CVE-ID: needed **[2018-12-30 03:12 UTC] [stas@php.net](//people.php.net/stas)** ``` In security repo as ee30a1fa4c05a5e3d53898296ed9bdb6a1d63239  ``` **[2018-12-30 22:36 UTC] [cmb@php.net](//people.php.net/cmb)** ``` > That makes sense with the docs. I'm not sure any of the function > pages describe what syntax Oniguruma uses. Would it be worth me > creating another bug for that to get written at some point?  A quick search for existing Oniguruma pattern syntax in the manual brought up nothing, so indeed this should be filed as documentation problem.  The syntax is documented in <<https://github.com/kkos/oniguruma/blob/master/doc/RE>>.  ``` **[2018-12-30 22:42 UTC] hugh at allthethings dot co dot nz** ``` File [bug #77383](bug.php?id=77383) for the doc issue  ``` **[2019-01-07 08:20 UTC] [stas@php.net](//people.php.net/stas)** ``` Automatic comment on behalf of cmbecker69@gmx.de Revision: <http://git.php.net/?p=php-src.git;a=commit;h=e617f03066ce81d26f56c06d6bd7787c7de08703> Log: Fix #77367: Negative size parameter in mb_split  ``` **[2019-01-07 08:20 UTC] [stas@php.net](//people.php.net/stas)** -Status: Analyzed +Status: Closed **[2019-01-07 08:21 UTC] [stas@php.net](//people.php.net/stas)** ``` Automatic comment on behalf of cmbecker69@gmx.de Revision: <http://git.php.net/?p=php-src.git;a=commit;h=e617f03066ce81d26f56c06d6bd7787c7de08703> Log: Fix #77367: Negative size parameter in mb_split  ``` **[2019-01-07 13:17 UTC] [cmb@php.net](//people.php.net/cmb)** ``` Automatic comment on behalf of cmbecker69@gmx.de Revision: <http://git.php.net/?p=php-src.git;a=commit;h=11ce508ee3390d4e68542c9fdae1277e3e75a573> Log: Fix #77367: Negative size parameter in mb_split  ``` **[2019-02-22 23:17 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: needed +CVE-ID: 2019-9025 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Mon Jan 20 23:01:30 2025 UTC |


