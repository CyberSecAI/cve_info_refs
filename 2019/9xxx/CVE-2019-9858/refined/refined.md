```
{
  "vulnerability_details": {
    "root_cause": "A path traversal vulnerability exists due to an unsanitized POST parameter in the php-horde-form package.",
    "weaknesses": [
      "Unsanitized user input in the `object[photo][img][file]` POST parameter.",
       "Path traversal vulnerability."
    ],
    "impact": "Remote code execution can be achieved by an authenticated attacker.",
    "attack_vectors": [
      "Manipulating the `object[photo][img][file]` POST parameter during an image upload to write a PHP backdoor file to an arbitrary writable location on the server."
    ],
    "required_capabilities": [
      "An attacker needs to be an authenticated user of the Horde Groupware Webmail application.",
      "The attacker must be able to access the contact creation functionality."
    ]
  },
  "additional_details": {
     "exploit_details": "The vulnerability is located in the `Horde/Form/Type.php` file, specifically within the `Horde_Form_Type_image` class's `onSubmit()` method. The `getImage()` and `_getUpload()` methods use unsanitized user input from the POST parameter `object[photo][img][file]` as a path to save the uploaded image. This allows an attacker to control the `$tmp_file` variable passed to `move_uploaded_file()`. By setting this parameter to a path like `../usr/share/horde/static/bd.php` or `../var/www/html/horde/static/bd.php`, an attacker can write a PHP backdoor to a publicly accessible web directory, like the `static/` directory.",
    "affected_versions": "Horde Groupware Webmail versions 5.2.22 and 5.2.17 are confirmed to be vulnerable, and other versions may also be affected.",
    "patches": "The fix involves sanitizing the filename using `basename()` in the `Horde_Form_Type.php` file before creating the temporary file path, as shown in the provided diff.",
   "poc": "A Metasploit module has been developed to automate exploitation, demonstrating the ability to bypass path restrictions and deploy a payload. The module is capable of exploiting various Horde installations, whether installed via PEAR or `apt-get`."
  }
}
```