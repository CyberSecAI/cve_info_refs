=== Content from bugzilla.mozilla.org_e4ce09b4_20250120_233227.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Mon Jan 20 2025 15:32:26 PST

* **Bug ID:**
  1527592,
  1534536,
  1520132,
  1543159,
  1539393,
  1459932,
  1459182,
  1516425

---

| [ID](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1459932](/show_bug.cgi?id=1459932 "RESOLVED FIXED - Crash in NameResolver::resolve") |  | [Crash in NameResolver::resolve](/show_bug.cgi?id=1459932) | Core | JavaScript Engine | jorendorff | RESO | FIXE | 2020-06-04 |
| [1516425](/show_bug.cgi?id=1516425 "RESOLVED FIXED - Crash in mozilla::layout::GetLayerManager") |  | [Crash in mozilla::layout::GetLayerManager](/show_bug.cgi?id=1516425) | Core | Graphics: Layers | rhunt | RESO | FIXE | 2020-06-04 |
| [1534536](/show_bug.cgi?id=1534536 "RESOLVED FIXED - Intermittent GECKO(10544) | SUMMARY: AddressSanitizer: heap-use-after-free z:\build\build\src\dom\localstorage\ActorsParent.cpp:7760 in mozilla::dom::`anonymous namespace'::QuotaClient::AbortOperations") |  | [Intermittent GECKO(10544) | SUMMARY: AddressSanitizer: heap-use-after-free z:\build\build\src\dom\localstorage\ActorsParent.cpp:7760 in mozilla::dom::`anonymous namespace'::QuotaClient::AbortOperations](/show_bug.cgi?id=1534536) | Core | Storage: localStorag | jan.varga | RESO | FIXE | 2020-06-04 |
| [1539393](/show_bug.cgi?id=1539393 "RESOLVED FIXED - TransactionDatabaseOperationBase::ActorDestroy doesn't check if we are waiting for the Continue message") |  | [TransactionDatabaseOperationBase::ActorDestroy doesn't check if we are waiting for the Continue message](/show_bug.cgi?id=1539393) | Core | Storage: IndexedDB | jan.varga | RESO | FIXE | 2020-06-04 |
| [1459182](/show_bug.cgi?id=1459182 "RESOLVED FIXED - Assertion failure: TypedArrayObject::is(args[0]) for same-compartment wrappers in Float32Array sort") |  | [Assertion failure: TypedArrayObject::is(args[0]) for same-compartment wrappers in Float32Array sort](/show_bug.cgi?id=1459182) | Core | JavaScript: Standard | andrebargull | RESO | FIXE | 2020-06-04 |
| [1543159](/show_bug.cgi?id=1543159 "RESOLVED FIXED - TypeHashSet::MapEntries doesn't handle ObjectKey elements correctly") |  | [TypeHashSet::MapEntries doesn't handle ObjectKey elements correctly](/show_bug.cgi?id=1543159) | Core | JavaScript Engine | nicolas.b.pierron | RESO | FIXE | 2022-01-06 |
| [1520132](/show_bug.cgi?id=1520132 "RESOLVED FIXED - Crash in mozilla::layers::UiCompositorControllerChild::OpenForSameProcess") |  | [Crash in mozilla::layers::UiCompositorControllerChild::OpenForSameProcess](/show_bug.cgi?id=1520132) | Core | Graphics: Layers | rbarker | RESO | FIXE | 2020-06-04 |
| [1527592](/show_bug.cgi?id=1527592 "VERIFIED FIXED - Assertion failure: IsConstructor(args.CallArgs::newTarget()) (provided new.target value must be a constructor), at js/src/vm/Interpreter.cpp:622") |  | [Assertion failure: IsConstructor(args.CallArgs::newTarget()) (provided new.target value must be a constructor), at js/src/vm/Interpreter.cpp:622](/show_bug.cgi?id=1527592) | Core | JavaScript Engine | jdemooij | VERI | FIXE | 2023-12-06 |

8 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from www.mozilla.org_8c874c66_20250120_233228.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-13

## Security vulnerabilities fixed in Firefox 67

Announced
May 21, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 67

#### [#CVE-2019-9815: Disable hyperthreading on content JavaScript threads on macOS](#CVE-2019-9815)

Reporter
[Multiple independent researchers](https://mdsattacks.com/#People)
Impact
high
##### Description

If hyperthreading is not disabled, a timing attack vulnerability exists, similar to previous Spectre attacks. Apple has shipped macOS 10.14.5 with an option to disable hyperthreading in applications running untrusted code in a thread through a new sysctl. Firefox now makes use of it on the main thread and any worker threads.
*Note: users need to update to macOS 10.14.5 in order to take advantage of this change.*

##### References

* [Bug 1546544](https://bugzilla.mozilla.org/show_bug.cgi?id=1546544)
* [RIDL and Fallout: MDS attacks](https://mdsattacks.com/)

#### [#CVE-2019-9816: Type confusion with object groups and UnboxedObjects](#CVE-2019-9816)

Reporter
Samuel Groß of Google Project Zero
Impact
high
##### Description

A possible vulnerability exists where type confusion can occur when manipulating JavaScript objects in object groups, allowing for the bypassing of security checks within these groups.
*Note: this vulnerability has only been demonstrated with `UnboxedObjects`, which are disabled by default on all supported releases.*

##### References

* [Bug 1536768](https://bugzilla.mozilla.org/show_bug.cgi?id=1536768)

#### [#CVE-2019-9817: Stealing of cross-domain images using canvas](#CVE-2019-9817)

Reporter
Luật Nguyễn
Impact
high
##### Description

Images from a different domain can be read using a canvas object in some circumstances. This could be used to steal image data from a different site in violation of same-origin policy.

##### References

* [Bug 1540221](https://bugzilla.mozilla.org/show_bug.cgi?id=1540221)

#### [#CVE-2019-9818: Use-after-free in crash generation server](#CVE-2019-9818)

Reporter
Thomas Imbert
Impact
high
##### Description

A race condition is present in the crash generation server used to generate data for the crash reporter. This issue can lead to a use-after-free in the main process, resulting in a potentially exploitable crash and a sandbox escape.
*Note: this vulnerability only affects Windows. Other operating systems are unaffected.*

##### References

* [Bug 1542581](https://bugzilla.mozilla.org/show_bug.cgi?id=1542581)

#### [#CVE-2019-9819: Compartment mismatch with fetch API](#CVE-2019-9819)

Reporter
Nils
Impact
high
##### Description

A vulnerability where a JavaScript compartment mismatch can occur while working with the `fetch` API, resulting in a potentially exploitable crash.

##### References

* [Bug 1532553](https://bugzilla.mozilla.org/show_bug.cgi?id=1532553)

#### [#CVE-2019-9820: Use-after-free of ChromeEventHandler by DocShell](#CVE-2019-9820)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in the chrome event handler when it is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1536405](https://bugzilla.mozilla.org/show_bug.cgi?id=1536405)

#### [#CVE-2019-9821: Use-after-free in AssertWorkerThread](#CVE-2019-9821)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in `AssertWorkerThread` due to a race condition with shared workers. This results in a potentially exploitable crash.

##### References

* [Bug 1539125](https://bugzilla.mozilla.org/show_bug.cgi?id=1539125)

#### [#CVE-2019-11691: Use-after-free in XMLHttpRequest](#CVE-2019-11691)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when working with `XMLHttpRequest` (XHR) in an event loop, causing the XHR main thread to be called after it has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1542465](https://bugzilla.mozilla.org/show_bug.cgi?id=1542465)

#### [#CVE-2019-11692: Use-after-free removing listeners in the event listener manager](#CVE-2019-11692)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when listeners are removed from the event listener manager while still in use, resulting in a potentially exploitable crash.

##### References

* [Bug 1544670](https://bugzilla.mozilla.org/show_bug.cgi?id=1544670)

#### [#CVE-2019-11693: Buffer overflow in WebGL bufferdata on Linux](#CVE-2019-11693)

Reporter
crixer
Impact
high
##### Description

The `bufferdata` function in WebGL is vulnerable to a buffer overflow with specific graphics drivers on Linux. This could result in malicious content freezing a tab or triggering a potentially exploitable crash.
*Note: this issue only occurs on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1532525](https://bugzilla.mozilla.org/show_bug.cgi?id=1532525)

#### [#CVE-2019-7317: Use-after-free in png\_image\_free of libpng library](#CVE-2019-7317)

Reporter
OSS-Fuzz, Eddie Lee
Impact
high
##### Description

A use-after-free vulnerability was discovered in the `png_image_free` function in the libpng library. This could lead to denial of service or a potentially exploitable crash when a malformed image is processed.

##### References

* [Bug 1542829](https://bugzilla.mozilla.org/show_bug.cgi?id=1542829)

#### [#CVE-2019-11694: Uninitialized memory memory leakage in Windows sandbox](#CVE-2019-11694)

Reporter
Jeremy Fetiveau of SSD Secure Disclosure
Impact
moderate
##### Description

A vulnerability exists in the Windows sandbox where an uninitialized value in memory can be leaked to a renderer from a broker when making a call to access an otherwise unavailable file. This results in the potential leaking of information stored at that memory location.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1534196](https://bugzilla.mozilla.org/show_bug.cgi?id=1534196)

#### [#CVE-2019-11695: Custom cursor can render over user interface outside of web content](#CVE-2019-11695)

Reporter
bignis
Impact
moderate
##### Description

A custom cursor defined by scripting on a site can position itself over the addressbar to spoof the actual cursor when it should not be allowed outside of the primary web content area. This could be used by a malicious site to trick users into clicking on permission prompts, doorhanger notifications, or other buttons inadvertently if the location is spoofed over the user interface.

##### References

* [Bug 1445844](https://bugzilla.mozilla.org/show_bug.cgi?id=1445844)

#### [#CVE-2019-11696: Java web start .JNLP files are not recognized as executable files for download prompts](#CVE-2019-11696)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

Files with the `.JNLP` extension used for "Java web start" applications are not treated as executable content for download prompts even though they can be executed if Java is installed on the local system. This could allow users to mistakenly launch an executable binary locally.

##### References

* [Bug 1392955](https://bugzilla.mozilla.org/show_bug.cgi?id=1392955)

#### [#CVE-2019-11697: Pressing key combinations can bypass installation prompt delays and install extensions](#CVE-2019-11697)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If the `ALT` and "a" keys are pressed when users receive an extension installation prompt, the extension will be installed without the install prompt delay that keeps the prompt visible in order for users to accept or decline the installation. A malicious web page could use this with spoofing on the page to trick users into installing a malicious extension.

##### References

* [Bug 1440079](https://bugzilla.mozilla.org/show_bug.cgi?id=1440079)

#### [#CVE-2019-11698: Theft of user history data through drag and drop of hyperlinks to and from bookmarks](#CVE-2019-11698)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a crafted hyperlink is dragged and dropped to the bookmark bar or sidebar and the resulting bookmark is subsequently dragged and dropped into the web content area, an arbitrary query of a user's browser history can be run and transmitted to the content page via `drop` event data. This allows for the theft of browser history by a malicious site.

##### References

* [Bug 1543191](https://bugzilla.mozilla.org/show_bug.cgi?id=1543191)

#### [#CVE-2019-11700: res: protocol can be used to open known local files](#CVE-2019-11700)

Reporter
James Lee
Impact
moderate
##### Description

A hyperlink using the `res:` protocol can be used to open local files at a known location in Internet Explorer if a user approves execution when prompted.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1549833](https://bugzilla.mozilla.org/show_bug.cgi?id=1549833)

#### [#CVE-2019-11699: Incorrect domain name highlighting during page navigation](#CVE-2019-11699)

Reporter
tzachyr
Impact
low
##### Description

A malicious page can briefly cause the wrong name to be highlighted as the domain name in the addressbar during page navigations. This could result in user confusion of which site is currently loaded for spoofing attacks.

##### References

* [Bug 1528939](https://bugzilla.mozilla.org/show_bug.cgi?id=1528939)

#### [#CVE-2019-11701: webcal: protocol default handler loads vulnerable web page](#CVE-2019-11701)

Reporter
Peter af Geijerstam
Impact
low
##### Description

The default `webcal:` protocol handler will load a web site vulnerable to cross-site scripting (XSS) attacks. This default was left in place as a legacy feature and has now been removed.
*Note: this issue only affects users with an account on the vulnerable service. Other users are unaffected.*

##### References

* [Bug 1518627](https://bugzilla.mozilla.org/show_bug.cgi?id=1518627)

#### [#CVE-2019-9814: Memory safety bugs fixed in Firefox 67](#CVE-2019-9814)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Andrei Ciure, Julien Cristau, Jan de Mooij, Jan Varga, Marcia Knous, André Bargull, and Philipp reported memory safety bugs present in Firefox 66. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425)

#### [#CVE-2019-9800: Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](#CVE-2019-9800)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Bogdan Tara, Jan de Mooij, Jason Kratzer, Jan Varga, Gary Kwong, Tim Guan-tin Chien, Tyson Smith, Ronald Crane, and Ted Campbell reported memory safety bugs present in Firefox 66 and Firefox ESR 60.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540166%2C1534593%2C1546327%2C1540136%2C1538736%2C1538042%2C1535612%2C1499719%2C1499108%2C1538619%2C1535194%2C1516325%2C1542324%2C1542097%2C1532465%2C1533554%2C1541580)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_dce9a178_20250121_013804.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1518627)
* [XML](/show_bug.cgi?ctype=xml&id=1518627)

Closed
[Bug 1518627](/show_bug.cgi?id=1518627)
(CVE-2019-11701)

Opened 6 years ago
Closed 6 years ago

# Remove the default protocol handler for webcal given it has serious XSS vulnerabilities

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Remove the default protocol handler for webcal given it has serious XSS vulnerabilities

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 67

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox65 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox65&o1=equals&v1=wontfix) |
| firefox66 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix) |
| firefox67 | --- | [verified](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox65 |  | wontfix |
| firefox66 |  | wontfix |
| firefox67 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: p4fg, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9369b326f84a0b5a3873d79993385a8b?d=mm&size=40)  [p4fg](/user_profile?user_id=631270)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### ( [URL](http://poc.shellcode.se/webcal.html "http://poc.shellcode.se/webcal.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1532035](/show_bug.cgi?id=1532035 "RESOLVED DUPLICATE - webcal:// default url handler is vunerable to XSS which allow malicious URL crafting (+ Invalid SSL certificate)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[poc.shellcode.se/webcal.html](http://poc.shellcode.se/webcal.html "http://poc.shellcode.se/webcal.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main67+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-11701

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[wsec-xss](/buglist.cgi?keywords=wsec-xss&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main67+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c12 "6 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Video PoC of bug](/attachment.cgi?id=9035156)  [6 years ago](#c3)  [Peter af Geijerstam](/user_profile?user_id=631270)   2.04 MB, video/mp4 |  | [Details](/attachment.cgi?id=9035156&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1518627#c0)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1518627&comment_id=13850160 "3 revisions") |
|  | |

Operating system: Ubuntu Linux 18.04 LTS

Firefox version: Firefox Quantum 64.0 (Mozilla Firefox for Ubuntu canonical-1.0)

I was looking around in about:config researching a totally different bug and found the following handler installed (by default i presume as i have not installed it):

gecko.handlerService.schemes.webcal.0.name;30 Boxes

gecko.handlerService.schemes.webcal.0.uriTemplate;<https://30boxes.com/external/widget?refer=ff&url=%s>

This service is unfortunately vulnerable, and as your general eligibility states that third-party websites utilized are in-scope ("We will pay bounties for vulnerabilities in third-party libraries incorporated into shipped client code or third-party websites utilized by Mozilla.") i thought i would try to report this bug to get this handler removed.

To reproduce: either create the following url as a link or just paste it into the web-browser:

webcal://www.mozilla.org?q=<script>document.location='[http://redirected.shellcode.se';</script>](http://redirected.shellcode.se';%EF%BF%BD/script%3E)

(I created a simple link to this on a page on my domain: <http://poc.shellcode.se/webcal.html>)

Firefox asks if you want to open the link with the application "30 Boxes" (Unless the user has clicked "Remember my choice for webcal links"). Clicking ok will transfer the user to the url:

<https://30boxes.com/external/widget?refer=ff&url=www.mozilla.org?q=webcal%3A%2F%2Fwww.mozilla.org%3Fq%3D%3Cscript%3Edocument.location%3D'http%3A%2F%2Fredirected.shellcode.se'%3B%3C%2Fscript%3E>

This page is vulnerable to XSS and the javascript is executed. In this case only a "harmless" redirect.

I understand that the main bug is not on your domain, but the handler seems to be installed by default and thus affects the standard product.

Thanks for your time!

Best regards

Peter - Sweden

Flags: sec-bounty?

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1518627#c1)• 6 years ago |
|  | |

It seems that bugzilla is filtering out the script-tags in my report which probably makes it difficult to understand.

Please view the PoC on my page: <http://poc.shellcode.se/webcal.html>

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1518627#c2)• 6 years ago |
|  | |

Trying markdown:

```
webcal://www.mozilla.org?q=<script>document.location='http://redirected.shellcode.se';</script>

```

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1518627#c3)• 6 years ago |
|  | |

Attached video
[Video PoC of bug](attachment.cgi?id=9035156)
— [Details](attachment.cgi?id=9035156&action=edit)

Simple recording of the bug in action

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1518627#c4)• 6 years ago |
|  | |

dolske: who owns our default handlers? We should remove "30 Boxes" in any case but someone should go through the others and clean out the cruft.

Status: UNCONFIRMED → NEWComponent: Security → GeneralEver confirmed: trueFlags: needinfo?(dolske)Keywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[wsec-xss](/buglist.cgi?keywords=wsec-xss&resolution=---)

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a1189688_112088)• 6 years ago |

Component: General → File Handling

|  | [Justin Dolske [:Dolske]](/user_profile?user_id=27780) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1518627#c5)• 6 years ago |
|  | |

Gijs, can you help here? Let's at least focus on nuking 30boxes in this bug, if we can easily clean out any other cruft while we're here great, otherwise let's spin that off to a new bug if it's complicated.

Flags: needinfo?(dolske) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1518627#c6)• 6 years ago |
|  | |

Sure, I can attempt to come up with a patch tomorrow or later this week.

This is slightly messy because while just removing the existing handler option from the default prefs is easy, I'm not aware of a trivial way of migrating existing profiles; AIUI we import things from the prefs into the handlers DB. Paolo, can you point to any relevant precedent on how to update these and/or remove items?

:dolske: Should we point people to a SUMO page or something if we detect they were actually using this?

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNEDFlags: needinfo?(paolo.mozmail)Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(dolske)

|  | [:Paolo Amadini](/user_profile?user_id=332229) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1518627#c7)• 6 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #6](/show_bug.cgi?id=1518627#c6 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> Paolo, can you point to any relevant precedent on how to update these and/or remove items?

See [bug 1252831 comment 9](/show_bug.cgi?id=1252831#c9 "RESOLVED FIXED - https://30boxes.com serves an expired certificate"), as well as [bug 1252831 comment 12](/show_bug.cgi?id=1252831#c12 "RESOLVED FIXED - https://30boxes.com serves an expired certificate") and the following discussion. I'll be happy to review a patch in that bug, where you can also more easily notify the localization team and add a migration step to remove the old URLs. When looking for old URLs, note that there might be leftovers with slightly different alternate version of the URL found in localized repositories, or older versions with the HTTP scheme.

In [bug 1252831](/show_bug.cgi?id=1252831 "RESOLVED FIXED - https://30boxes.com serves an expired certificate") I originally said that the migration step shouldn't remove the handler if it already set as the default, but I'll leave this up to you and Dolske given this new bug. Pointing to a SUMO article might be worth doing if we change the current handler and remove the option to bring it back.

An alternative could be to leave the HTTPS version as an available handler, but not the default, if any other URL variation used to be the default on the system. After a release or two, we can run a similar migration step again, which should remove the option entirely if the user took no action and the handler is still not the default.

Flags: needinfo?(paolo.mozmail)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a1276653_159069)• 6 years ago |

Priority: -- → P1

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1518627#c8)• 6 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1518627#c4 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> dolske: who owns our default handlers? We should remove "30 Boxes" in any case but someone should go through the others and clean out the cruft.

Ni me to look at the other stuff we still have...

Flags: needinfo?(dolske) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1518627#c9)• 6 years ago |
|  | |

(In reply to Peter af Geijerstam from [comment #0](/show_bug.cgi?id=1518627#c0 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> [https://30boxes.com/external/widget?refer=ff&url=www.mozilla.org?q=<script>document.location='http://redirected.shellcode.se';</script>](https://30boxes.com/external/widget?refer=ff&url=www.mozilla.org?q=%EF%BF%BDscript%3Edocument.location='http://redirected.shellcode.se';%EF%BF%BD/script%3E)
>
> This page is vulnerable to XSS and the javascript is executed. In this case only a "harmless" redirect.
>
> I understand that the main bug is not on your domain, but the handler seems to be installed by default and thus affects the standard product.

Thanks again for reporting this. A fix has just been pushed to our alpha / nightly channel (should be available in the next 12-24h), and it should remove the handler completely.

I've tried in vain to find a contact point for 30boxes. Have you reported this issue to them at all?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(p4fg)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a2672402_159069)• 6 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1518627#c10)• 6 years ago |
|  | |

I tried to message the owners of 30boxes, but cannot see that i ever got any replies. It does not seem to be maintained anymore.

Best regards

Peter

Flags: needinfo?(p4fg)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1518627#c11)• 6 years ago |
|  | |

Fixed in 67 via [bug 1252831](/show_bug.cgi?id=1252831 "RESOLVED FIXED - https://30boxes.com serves an expired certificate"). Should be in today's morning nightly.

On balance, I'm not convinced we want to uplift this to 66 beta, though I could be persuaded. The migration version was the same between nightly and beta prior to this bug so from that perspective it is at least possible... Thoughts, Dan?

Status: ASSIGNED → RESOLVEDClosed: 6 years agoFlags: needinfo?(dveditz)Resolution: --- → FIXED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a2921265_159069)• 6 years ago |

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed)Target Milestone: --- → Firefox 67

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1518627#c12)• 6 years ago |
|  | |

3rd party services aren't formally covered by our bounty program but we'd like to offer a small one as our thanks.

Flags: sec-bounty?Flags: sec-bounty+Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1518627#c13)• 6 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #11](/show_bug.cgi?id=1518627#c11 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> On balance, I'm not convinced we want to uplift this to 66 beta,

I agree, it's low severity. Anyone actually using 30boxes as their calendar is pretty insecure already and we can't fix that.

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1518627#c14)• 6 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #12](/show_bug.cgi?id=1518627#c12 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> 3rd party services aren't formally covered by our bounty program but we'd like to offer a small one as our thanks.

I would sure appreciate it. However, what you are writing does note correspond with public information about your security bug bounty program <https://www.mozilla.org/en-US/security/bug-bounty/>:

(Second bullet point under General Eligibility): *"We will pay bounties for vulnerabilities in third-party libraries incorporated into shipped client code **or third-party websites utilized by Mozilla.**"*

Firefox being shipped with 30-boxes pre-installed as a webcal-handler would i my opinion be exactly what "third-party websites utilized by Mozilla" is all about, I hope you agree!

Best regards

Peter

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1518627#c15)• 6 years ago |
|  | |

The only other handlers we have in en-US are for yahoo mail, gmail and mibbit for irc/ircs. They're all maintained and relatively new/modern so I'm not worried about those much. Note maybe [bug 1494105](/show_bug.cgi?id=1494105 "RESOLVED WONTFIX - Yahoo mailto broken by Yahoo changes") (functionality issue, not security related) for yahoo mail...

I filed [bug 1526890](/show_bug.cgi?id=1526890 "RESOLVED FIXED - [meta] Enforce https: URLs for region.properties `uriTemplate` values") to deal with the fact that some of our other locales have some http: (non-TLS) links.

Other than that, off-hand they look like they're for major companies - mostly Google, Yahoo, Yandex, Microsoft, sometimes "just" in their locale - e.g. onet.pl is big in Poland (cf. <https://www.alexa.com/topsites/countries/PL> )but probably not well-known in the US), so I'm less worried about maintainability. I'm not the right person to do a full audit for XSS in their respective links, also because all of the webmail ones are behind auth portals and require accounts etc. In any case, given that they're not places where I think we'd struggle finding a contact to just actually fix any XSS or other web security issues, I don't think there's any others that need to be removed.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a2999991_159069)• 6 years ago |

[status-firefox65](/buglist.cgi?f1=cf_status_firefox65&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox65&o1=equals&v1=wontfix)
[status-firefox66](/buglist.cgi?f1=cf_status_firefox66&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a3029579_1689)• 6 years ago |

Group: firefox-core-security → core-security-release

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a7461311_488993)• 6 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1518627#c17)• 6 years ago |
|  | |

Updated the link in [comment #0](/show_bug.cgi?id=1518627#c0 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities") to a URI-escaped one which still shows the XSS (as I was momentarily confused as to whether it got fixed by 30boxes - seems it still hasn't...).

|  | [Timea Zsoldos [:zstimi/tzsoldos], Desktop QA](/user_profile?user_id=586868) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1518627#c18)• 6 years ago |
|  | |

This issue is still reproducible for me too. Could you please tell me if there is anything else that will be fixed in this bug, or intended to fix the issue in another bug? Thanks.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1518627#c19)• 6 years ago |
|  | |

(In reply to Timea Zsoldos [:zstimi/tzsoldos], Desktop Release QA from [comment #18](/show_bug.cgi?id=1518627#c18 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> This issue is still reproducible for me too. Could you please tell me if there is anything else that will be fixed in this bug, or intended to fix the issue in another bug? Thanks.

We should have removed the 30 boxes app as an option for webcal links. That should be verifiable, and should be done in [bug 1252831](/show_bug.cgi?id=1252831 "RESOLVED FIXED - https://30boxes.com serves an expired certificate") (where the patches for that landed).

Flags: needinfo?(timea.zsoldos)

|  | [Timea Zsoldos [:zstimi/tzsoldos], Desktop QA](/user_profile?user_id=586868) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1518627#c20)• 6 years ago |
|  | |

I have reproduced this issue using Firefox 66.0a1 (2019.01.08) on Ubuntu 18.04 x64, Win 10 x64 and macOS 10.13.6 follow the test case:

1. The prefs by default:

   gecko.handlerService.schemes.webcal.0.name; 30 Boxes

   gecko.handlerService.schemes.webcal.0.uriTemplate; <https://30boxes.com/external/widget?refer=ff&url=%s>
2. Paste into the URL : webcal://www.mozilla.org?q=<script>document.location='[http://redirected.shellcode.se';</script>](http://redirected.shellcode.se';%EF%BF%BD/script%3E)
3. Firefox asks if you want to open the link with the application "30 Boxes", then shows the message "You have been maliciously redirected to this page..."

I verified using Firefox 67.0b10 on Win 10 x64, macOS 10.13.6 and Ubuntu 18.04 x64, the two prefs are:

gecko.handlerService.schemes.webcal.0.name; chrome://browser-region/locale/region.properties

gecko.handlerService.schemes.webcal.0.uriTemplate; chrome://browser-region/locale/region.properties

This time Firefox doesn't asks if you want to open the link with the application "30 Boxes" and doesn't shows the message.

Based on [comment #17](/show_bug.cgi?id=1518627#c17 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities") if I paste into URL the link: <https://30boxes.com/external/widget?refer=ff&url=www.mozilla.org?q=webcal%3A%2F%2Fwww.mozilla.org%3Fq%3D%3Cscript%3Edocument.location%3D%27http%3A%2F%2Fredirected.shellcode.se%27%3B%3C%2Fscript%3E>

the message "You have been maliciously redirected to this page..." shows.

vs Chrome : "This page isn’t working" ... ERR\_BLOCKED\_BY\_XSS\_AUDITOR page opened.

|  | [Timea Zsoldos [:zstimi/tzsoldos], Desktop QA](/user_profile?user_id=586868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a8076673_586868)• 6 years ago |

Flags: needinfo?(timea.zsoldos)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1518627#c21)• 6 years ago |
|  | |

(In reply to Timea Zsoldos [:zstimi/tzsoldos], Desktop Release QA from [comment #20](/show_bug.cgi?id=1518627#c20 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities"))

> Based on [comment #17](/show_bug.cgi?id=1518627#c17 "VERIFIED FIXED - Remove the default protocol handler for webcal given it has serious XSS vulnerabilities") if I paste into URL the link: <https://30boxes.com/external/widget?refer=ff&url=www.mozilla.org?q=webcal%3A%2F%2Fwww.mozilla.org%3Fq%3D%3Cscript%3Edocument.location%3D%27http%3A%2F%2Fredirected.shellcode.se%27%3B%3C%2Fscript%3E>
>
> the message "You have been maliciously redirected to this page..." shows.

Yes, this is the XSS vulnerability in the webpage which we have no way of fixing.

> vs Chrome : "This page isn’t working" ... ERR\_BLOCKED\_BY\_XSS\_AUDITOR page opened.

Yes, this is Chrome's XSS auditor, which attempts to spot XSS-type content in URLs. We don't have such a feature; there's some background in [bug 528661 comment 56](/show_bug.cgi?id=528661#c56 "RESOLVED WONTFIX - Heuristics to block reflected XSS via X-XSS-Protection HTTP header") as to why not.

Anyway, based on the rest of your comment I think we can mark this verified.

Status: RESOLVED → VERIFIED
[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=verified)Summary: XSS in the default protocol-handler for webcal → Remove the default protocol handler for webcal given it has serious XSS vulnerabilities

|  | [Timea Zsoldos [:zstimi/tzsoldos], Desktop QA](/user_profile?user_id=586868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a8090739_586868)• 6 years ago |

Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a10792668_280903)• 6 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main67+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a10807232_280903)• 6 years ago |

Alias: CVE-2019-11701

|  | [Peter af Geijerstam](/user_profile?user_id=631270)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1518627#c22)• 6 years ago |
|  | |

The bug-bounty hall-of-fame have not been updated in quite a while, last entries was Q1 2018?

<https://www.mozilla.org/en-US/security/bug-bounty/hall-of-fame/>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a44357308_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1518627#a170104984_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1518627&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Peter af Geijerstam](/user_profile?user_id=631270)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


