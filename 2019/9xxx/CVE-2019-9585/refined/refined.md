```
{
  "vulnerability": {
    "CVE": "CVE-2019-9585",
    "description": "eQ-3 Homematic CCU2 prior 2.47.10 and CCU3 prior 3.47.10 JSON API has Improper Access Control for Interface.\\*\\*\\*Metadata related operations, resulting in the ability to read, set and deletion of Metadata",
    "related_content": [
      {
        "source": "psytester.github.io_5be5fa69_20250121_001803.html",
        "content": "The system provides a JSON API. While some methods require a dedicated user access level identified by provided sessionID, a number of methods can also be used with any string as sessionID.\nA code review of the file `/www/api/methods.conf` revealed that the `Interface.setMetadata` / `Interface.getMetadata` and `Interface.removeMetadata` method can be used without valid authentication.\nThey require the *session\_id* parameter, but due to `LEVEL NONE` the SessionID value is never checked.\n\n```\nInterface.setMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/setmetadata.tcl\n  INFO {Setzt ein Metadatum zu einem Object}\n  ARGUMENTS {_session_id_ objectId dataId value}\n}\n\nInterface.getMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/getmetadata.tcl\n  INFO {Gibt ein Metadatum zu einem Object zurück}\n  ARGUMENTS {_session_id_ objectId dataId}\n}\n\nInterface.removeMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/removemetadata.tcl\n  INFO {Entfernt ein Metadatum eines Objects}\n  ARGUMENTS {_session_id_ objectId dataId}\n}\n```\n\nExample method call without valid sessionID:\n\n```\ncurl -X POST -k -i 'https://1.2.3.4/api/homematic.cgi' --data '{\n  \"version\": \"1.1\",\n  \"method\": \"Interface.getMetadata\",\n  \"params\": {\n    \"_session_id_\": \"@unknownvalue@\",\n    \"objectId\": \".....\",\n\t\"dataId\": \".....\"\n  }\n}'\n```\n\nIf those Metadata gots corrupt by an attack, the WebUI is no longer able to show or modify the details of a device.\nSettings–>Devices–> select “HM-RCV-50 BidCoS-RF” and press “Set” button might show up such error message:\n\n```\nDas Gerät mit der Seriennummer 'BidCoS-RF' vom Interface 'systemHacked' konnte nicht abgefragt werden!\n```",
        "root_cause": "Improper access control in the JSON API of eQ-3 Homematic CCU2 and CCU3 devices.",
        "vulnerabilities": [
          "Improper Access Control"
        ],
        "impact": "An attacker can retrieve, modify, or delete internal metadata. Corrupted metadata can prevent the WebUI from displaying or modifying device details.",
         "attack_vector": "The vulnerability can be exploited by sending crafted HTTP POST requests to the JSON API endpoints without a valid session ID.",
        "attacker_capabilities": "The attacker needs network access to the vulnerable device's API and does not require valid credentials for exploiting the `Interface.setMetadata`, `Interface.getMetadata`, and `Interface.removeMetadata` methods."
      },
      {
        "source": "github.com_4ab00eac_20250121_022612.html",
         "content": "While analyzing the implementation of the CCU2 and CCU3, an Improper Access Control vulnerability has been identified, which can be exploited in order to retrieve, modify or delete internal MetaData.\n\nThe system provides a JSON API. While some methods require a dedicated user access level identified by provided sessionID, a number of methods can also be used with any string as sessionID.\nA code review of the file ```/www/api/methods.conf``` revealed that the ```Interface.setMetadata``` / ```Interface.getMetadata``` and ```Interface.removeMetadata``` method can be used without valid authentication.\n\nThey require the \\_session\\_id\\_ parameter, but due to ```LEVEL NONE``` the SessionID value is never checked.\n```\nInterface.setMetadata {\nLEVEL NONE\nSCRIPT_FILE interface/setmetadata.tcl\nINFO {Setzt ein Metadatum zu einem Object}\nARGUMENTS {\\_session\\_id\\_ objectId dataId value}\n}\nInterface.getMetadata {\nLEVEL NONE\nSCRIPT_FILE interface/getmetadata.tcl\nINFO {Gibt ein Metadatum zu einem Object zurück}\nARGUMENTS {\\_session\\_id\\_ objectId dataId}\n}\nInterface.removeMetadata {\nLEVEL NONE\nSCRIPT_FILE interface/removemetadata.tcl\nINFO {Entfernt ein Metadatum eines Objects}\nARGUMENTS {\\_session\\_id\\_ objectId dataId}\n}\n```\nExample method call without valid sessionID:\n```\ncurl -X POST -k -i 'https://1.2.3.4/api/homematic.cgi' --data '{\n\"version\": \"1.1\",\n\"method\": \"Interface.getMetadata\",\n\"params\": {\n\"\\_session\\_id\\_\": \"@unknownvalue@\",\n\"objectId\": \".....\",\n\"dataId\": \".....\"\n}\n}'\n```\nIf those Metadata gots corrupt by an attack, the WebUI is no longer able to show or modify the details of a device.\nSettings-->Devices--> select \"HM-RCV-50 BidCoS-RF\" and press \"Set\" button might show up such error message:\n```\nDas Gerät mit der Seriennummer 'BidCoS-RF' vom Interface 'systemHacked' konnte nicht abgefragt werden!\n```",
        "root_cause": "The vulnerability lies in the JSON API where specific methods do not enforce session ID validation due to `LEVEL NONE` configuration.",
        "vulnerabilities": [
          "Improper Access Control",
          "Lack of Session ID Validation"
        ],
        "impact": "Metadata can be corrupted, leading to malfunctions in the WebUI, preventing display or modification of device settings.",
        "attack_vector": "The attack is launched by sending HTTP POST requests with arbitrary session ID values to the vulnerable API endpoints.",
        "attacker_capabilities": "The attacker requires network access to the device's API and does not need valid login credentials."
      },
      {
        "source": "github.com_3d8b9f07_20250121_001802.html",
        "content": "The system provides a JSON API. While some methods require a dedicated user access level identified by provided sessionID, a number of methods can also be used with any string as sessionID.\n\nA code review of the file `/www/api/methods.conf` revealed that the `Interface.setMetadata` / `Interface.getMetadata` and `Interface.removeMetadata` method can be used without valid authentication.\n\nThey require the *session\_id* parameter, but due to `LEVEL NONE` the SessionID value is never checked.\n\n```\nInterface.setMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/setmetadata.tcl\n  INFO {Setzt ein Metadatum zu einem Object}\n  ARGUMENTS {_session_id_ objectId dataId value}\n}\n\nInterface.getMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/getmetadata.tcl\n  INFO {Gibt ein Metadatum zu einem Object zurück}\n  ARGUMENTS {_session_id_ objectId dataId}\n}\n\nInterface.removeMetadata {\n  LEVEL NONE\n  SCRIPT_FILE interface/removemetadata.tcl\n  INFO {Entfernt ein Metadatum eines Objects}\n  ARGUMENTS {_session_id_ objectId dataId}\n}\n```\n\nExample method call without valid sessionID:\n\n```\ncurl -X POST -k -i 'https://1.2.3.4/api/homematic.cgi' --data '{\n  \"version\": \"1.1\",\n  \"method\": \"Interface.getMetadata\",\n  \"params\": {\n    \"_session_id_\": \"@unknownvalue@\",\n    \"objectId\": \".....\",\n\t\"dataId\": \".....\"\n  }\n}'\n```\n\nIf those Metadata gots corrupt by an attack, the WebUI is no longer able to show or modify the details of a device.\nSettings-->Devices--> select \"HM-RCV-50 BidCoS-RF\" and press \"Set\" button might show up such error message:\n\n```\nDas Gerät mit der Seriennummer 'BidCoS-RF' vom Interface 'systemHacked' konnte nicht abgefragt werden!\n```",
          "root_cause": "The root cause is the lack of session ID validation in the JSON API for specific methods that handle metadata.",
          "vulnerabilities": [
            "Improper Access Control",
            "Missing Authentication Checks"
          ],
          "impact": "An attacker can manipulate the system's metadata, potentially causing the WebUI to malfunction, preventing users from managing devices.",
          "attack_vector": "The attack vector is sending HTTP POST requests with invalid or arbitrary session IDs to the vulnerable API endpoints.",
          "attacker_capabilities": "The attacker must have network access to the device but doesn't need valid credentials due to the lack of session validation."
       }
    ]
  }
}
```