=== Content from code610.blogspot.com_945abd72_20250121_005739.html ===


# [code16](https://code610.blogspot.com/)

## Strony

* [Strona główna](https://code610.blogspot.com/)
* [Mini arts](https://code610.blogspot.com/p/mini-arts.html)
* [Notes Magazine](https://code610.blogspot.com/p/notes-magazine.html)
* [Found bugs](https://code610.blogspot.com/p/found.html)
* [CTFs](https://code610.blogspot.com/p/ctfs.html)
* [Contact](https://code610.blogspot.com/p/contact.html)

## czwartek, 21 marca 2019

### Crashing XnView 2.48

[Last time](https://code610.blogspot.com/2018/08/updating-xnview.html) when we talked about bugs in [XnView](http://xnview.com/) I was surprised 'how good' can be the response 'from the Vendor'. But when 'response' is not 'responsible' - responsible disclosure is pointless. So, here we go...

This time I used the same behaviour like [before](https://code610.blogspot.com/2018/08/updating-xnview.html): I "started fuzzing XnView". But (just like before) I realized that **XnView Classic** is not **XnView MP**... So I fuzzed both. ;)

All cases were tested only with Windows 7 (32bit) so I'm not aware if you can get similar results on other operating systems. You can try that:) So...

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihhb71hMCZO4qwpE1XT82ZWHjN5VOWnH6XOUqcR72s_Rf00IGer0RxfkbO4hrYMPMCdgfgIVW100aIyDdBNkCiOWyk4jXSm2hj0GavyCr72L_u75EP5d2wDrV6APjPNBzbpmy9UtUert4/s400/00.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihhb71hMCZO4qwpE1XT82ZWHjN5VOWnH6XOUqcR72s_Rf00IGer0RxfkbO4hrYMPMCdgfgIVW100aIyDdBNkCiOWyk4jXSm2hj0GavyCr72L_u75EP5d2wDrV6APjPNBzbpmy9UtUert4/s1600/00.jpg)

We will start from **XnView MP 0.93.1 - (******[TL;DR - XnView MP 0.93.1 pack](https://github.com/c610/tmp/blob/master/XnViewMP.0.93.1-pack.zip)):****

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdt19JT18AgrjHshaqjZoavxZQ-RfuDvu311b9IZlCvoZeBax5CHzQSux299P4gwYIeoncr4njtxoDa9J92yroIa8M_nv8RimYDvqurBFD9mES5Q3WcRO1ylY81SVCQ05NL66k8yS3T_M/s400/01.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdt19JT18AgrjHshaqjZoavxZQ-RfuDvu311b9IZlCvoZeBax5CHzQSux299P4gwYIeoncr4njtxoDa9J92yroIa8M_nv8RimYDvqurBFD9mES5Q3WcRO1ylY81SVCQ05NL66k8yS3T_M/s1600/01.jpg)

**01# - VCRUNTIME140!memcpy:**

**---<windbg>---**

eax=00000000 ebx=038a6d40 ecx=00000018 edx=000000da esi=038edc40 edi=03941000

eip=72cc2c63 esp=05a3e580 ebp=05a3e598 iopl=0         nv up ei pl nz na po nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202

VCRUNTIME140!memcpy+0x483:

72cc2c63 660f7f07        movdqa  xmmword ptr [edi],xmm0 ds:0023:03941000=????????????????????????????????

**---</windbg>---**

**02# -** **ntdll!RtlFreeHeap:**

**---<windbg>---**

eax=20746665 ebx=af55275c ecx=6f6e3bf6 edx=00006f6e esi=6b26a2f2 edi=af550000

eip=772e205b esp=002abdb8 ebp=002abdec iopl=0         nv up ei pl nz na pe nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206

ntdll!RtlFreeHeap+0x12a:

772e205b 8930            mov     dword ptr [eax],esi  ds:0023:20746665=????????

**---</windbg>---**

**03# -** **ntdll!RtlpNtMakeTemporaryKey:**

**---<windbg>---**

eax=0679f248 ebx=00000000 ecx=772907ed edx=0679efe5 esi=00330000 edi=03b9ffe8

eip=7733283b esp=0679f238 ebp=0679f2b0 iopl=0         nv up ei pl zr na pe nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246

ntdll!RtlpNtMakeTemporaryKey+0x1a77:

7733283b eb12            jmp     ntdll!RtlpNtMakeTemporaryKey+0x1a8b (7733284f)

**---</windbg>---**

**04# -** **ntdll!RtlReAllocateHeap:**

**---<windbg>---**

eax=0f710c33 ebx=0389e1f0 ecx=0389e1f7 edx=00713c3e esi=0389e1f8 edi=00270000

eip=772e7f78 esp=0465ee30 ebp=0465ef34 iopl=0         nv up ei pl nz na pe nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206

ntdll!RtlReAllocateHeap+0x124:

772e7f78 668b4010        mov     ax,word ptr [eax+10h]    ds:0023:0f710c43=????

**---</windbg>---**

(Yep, I will post here only cases described by Windbg as 'exploitable'.)

Now let's switch to **XnView Classic version 2.48 - (******[TL;DR - XnView Classic 2.48 pack](https://github.com/c610/tmp/blob/master/XnViewClassic.2.48-pack.zip)):****

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMOqjervUFAEbnSn9BEvxWVtXWCzPiVvKdVaMAjhze3rLxNz-ZT6WSe_8eKGCi05FJJipNCmhYKPmsNkbmfgF2_xSrBUQ2rY2KpnEC3KMKCzCLEepRw_NAXWNyhf1lR2D5PBgTeE4NVYU/s400/02.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMOqjervUFAEbnSn9BEvxWVtXWCzPiVvKdVaMAjhze3rLxNz-ZT6WSe_8eKGCi05FJJipNCmhYKPmsNkbmfgF2_xSrBUQ2rY2KpnEC3KMKCzCLEepRw_NAXWNyhf1lR2D5PBgTeE4NVYU/s1600/02.jpg)

Here we go:

**01#  - xnview+0x38536c:**

**---<windbg>---**

eax=00000000 ebx=00000000 ecx=00000010 edx=00000191 esi=002adc20 edi=00300fe0

eip=006d536c esp=001ed9f4 ebp=001eda10 iopl=0         nv up ei pl nz na po nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202

xnview+0x38536c:

006d536c 660f7f5720      movdqa  xmmword ptr [edi+20h],xmm2 ds:0023:00301000=????????????????????????????????

**---</windbg>---**

**02# -** **ntdll!RtlPrefixUnicodeString:**

**---<windbg>---**

eax=00324828 ebx=00325fe0 ecx=00000000 edx=00000000 esi=00324820 edi=002b0000

eip=77935fbd esp=030bf724 ebp=030bf74c iopl=0         nv up ei pl zr na pe nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246

ntdll!RtlPrefixUnicodeString+0x712:

77935fbd 8b4904          mov     ecx,dword ptr [ecx+4] ds:0023:00000004=????????

**---</windbg>---**

**03# - ntdll!RtlQueueWorkItem:**

**---<windbg>---**

eax=34fce1ef ebx=00000000 ecx=779a3ab9 edx=00000000 esi=fffffff8 edi=003e0000

eip=7790bdc6 esp=002bd7c4 ebp=002bd800 iopl=0         nv up ei pl nz na pe nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206

ntdll!RtlQueueWorkItem+0x5e3:

7790bdc6 3106            xor     dword ptr [esi],eax  ds:0023:fffffff8=????????

**---</windbg>---**

**#04 - xnview+0x385399:**

**---<windbg>---**

eax=00000000 ebx=00000000 ecx=00000010 edx=000000da esi=00af5720 edi=00b2cf90

eip=003e5399 esp=0099dba4 ebp=0099dbc0 iopl=0         nv up ei pl nz na po nc

cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202

xnview+0x385399:

003e5399 660f7f7f70      movdqa  xmmword ptr [edi+70h],xmm7 ds:0023:00b2d000=????????????????????????????????

**---</windbg>---**

***\*\*\* Updated 24.03.2019 12:00 \*\*\****

For now you can find them
also described as [CVE-2019-9965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9965), [CVE-2019-9964](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9964), [CVE-2019-9963](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9963),
[CVE-2019-9962](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9962), [CVE-2019-9966](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9966), [CVE-2019-9967](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9967), [CVE-2019-9968](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9968),
[CVE-2019-9969](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9969).

[See you next time.](https://www.youtube.com/watch?v=W9iQ0pcSVIM&fbclid=IwAR0eKBleWSHMdM45nQHR84aMtFZt0TRweNeApZbUUdq0Jvsqwtgix68kUr4)

[Cheers](https://twitter.com/CodySixteen)

Posted by

[code16](https://www.blogger.com/profile/10414695159301496862 "author profile")

at

[10:03](https://code610.blogspot.com/2019/03/crashing-xnview-248.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4457504812250871322/1329488801874356476 "Wyślij posta przez e-mail")

[Wyślij pocztą e-mail](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1329488801874356476&target=email "Wyślij pocztą e-mail")[Wrzuć na bloga](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1329488801874356476&target=blog "Wrzuć na bloga")[Udostępnij w X](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1329488801874356476&target=twitter "Udostępnij w X")[Udostępnij w usłudze Facebook](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1329488801874356476&target=facebook "Udostępnij w usłudze Facebook")[Udostępnij w serwisie Pinterest](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1329488801874356476&target=pinterest "Udostępnij w serwisie Pinterest")

Labels:
[binary](https://code610.blogspot.com/search/label/binary),
[debug](https://code610.blogspot.com/search/label/debug),
[fuzz](https://code610.blogspot.com/search/label/fuzz),
[poc](https://code610.blogspot.com/search/label/poc),
[writeup](https://code610.blogspot.com/search/label/writeup)

#### Brak komentarzy:

#### Prześlij komentarz

[Nowszy post](https://code610.blogspot.com/2019/03/lazysysadmin-ctf.html "Nowszy post")

[Starszy post](https://code610.blogspot.com/2019/03/dll-injection-part-2.html "Starszy post")

[Strona główna](https://code610.blogspot.com/)

Subskrybuj:
[Komentarze do posta (Atom)](https://code610.blogspot.com/feeds/1329488801874356476/comments/default)

## O mnie

[![Moje zdjęcie](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxTLkJwUjO012n0PeP9QOXHkiKVBchiASFL9T6Rad6IsRCwX5CEz_v6pEQP3C_7HRetAZ72fNNZmenletYgK1cYrMKZoAzT0KOEPKauvcQIEq3lsP873D8edyRzITkefA/s113/koszulka.jpg)](https://www.blogger.com/profile/10414695159301496862)
[code16](https://www.blogger.com/profile/10414695159301496862)

Cody Sixteen

[Wyświetl mój pełny profil](https://www.blogger.com/profile/10414695159301496862)

## Archiwum bloga

* ►
  [2024](https://code610.blogspot.com/2024/)
  (10)
  + ►
    [12](https://code610.blogspot.com/2024/12/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2024/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2024/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2024/07/)
    (2)
  + ►
    [04](https://code610.blogspot.com/2024/04/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2024/01/)
    (2)

* ►
  [2023](https://code610.blogspot.com/2023/)
  (14)
  + ►
    [12](https://code610.blogspot.com/2023/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2023/11/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2023/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2023/04/)
    (9)

* ►
  [2022](https://code610.blogspot.com/2022/)
  (16)
  + ►
    [09](https://code610.blogspot.com/2022/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2022/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2022/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2022/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2022/04/)
    (7)
  + ►
    [03](https://code610.blogspot.com/2022/03/)
    (1)
  + ►
    [02](https://code610.blogspot.com/2022/02/)
    (2)

* ►
  [2021](https://code610.blogspot.com/2021/)
  (37)
  + ►
    [12](https://code610.blogspot.com/2021/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2021/11/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2021/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2021/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2021/08/)
    (8)
  + ►
    [07](https://code610.blogspot.com/2021/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2021/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2021/05/)
    (7)
  + ►
    [04](https://code610.blogspot.com/2021/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2021/03/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2021/02/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2021/01/)
    (2)

* ►
  [2020](https://code610.blogspot.com/2020/)
  (62)
  + ►
    [12](https://code610.blogspot.com/2020/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2020/11/)
    (2)
  + ►
    [10](https://code610.blogspot.com/2020/10/)
    (1)
  + ►
    [09](https://code610.blogspot.com/2020/09/)
    (2)
  + ►
    [08](https://code610.blogspot.com/2020/08/)
    (5)
  + ►
    [07](https://code610.blogspot.com/2020/07/)
    (5)
  + ►
    [06](https://code610.blogspot.com/2020/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2020/05/)
    (5)
  + ►
    [04](https://code610.blogspot.com/2020/04/)
    (11)
  + ►
    [03](https://code610.blogspot.com/2020/03/)
    (10)
  + ►
    [02](https://code610.blogspot.com/2020/02/)
    (6)
  + ►
    [01](https://code610.blogspot.com/2020/01/)
    (7)

* ▼
  [2019](https://code610.blogspot.com/2019/)
  (97)
  + ►
    [12](https://code610.blogspot.com/2019/12/)
    (4)
  + ►
    [11](https://code610.blogspot.com/2019/11/)
    (9)
  + ►
    [10](https://code610.blogspot.com/2019/10/)
    (8)
  + ►
    [09](https://code610.blogspot.com/2019/09/)
    (5)
  + ►
    [08](https://code610.blogspot.com/2019/08/)
    (20)
  + ►
    [07](https://code610.blogspot.com/2019/07/)
    (10)
  + ►
    [06](https://code610.blogspot.com/2019/06/)
    (3)
  + ►
    [05](https://code610.blogspot.com/2019/05/)
    (8)
  + ▼
    [03](https://code610.blogspot.com/2019/03/)
    (15)
    - [Born2Root 2 CTF](https://code610.blogspot.com/2019/03/born2root-2-ctf.html)
    - [FourAndSix:2 CTF](https://code610.blogspot.com/2019/03/fourandsix2-ctf.html)
    - [FourAndSix:1 CTF](https://code610.blogspot.com/2019/03/fourandsix1-ctf_28.html)
    - [Stack Overflows for Beginners - CTF - part 1](https://code610.blogspot.com/2019/03/stack-overflows-for-beginners-ctf-part-1.html)
    - [RootThis CTF](https://code610.blogspot.com/2019/03/rootthis-ctf.html)
    - [Creating evil module for Drupal](https://code610.blogspot.com/2019/03/creating-evil-module-for-drupal.html)
    - [LazySysAdmin CTF](https://code610.blogspot.com/2019/03/lazysysadmin-ctf.html)
    - [Crashing XnView 2.48](https://code610.blogspot.com/2019/03/crashing-xnview-248.html)
    - [DLL Injection - part 2](https://code610.blogspot.com/2019/03/dll-injection-part-2.html)
    - [DC-1:1 CTF](https://code610.blogspot.com/2019/03/dc-11-ctf.html)
    - [Temple Of Doom1 CTF](https://code610.blogspot.com/2019/03/temple-of-doom1-ctf.html)
    - [MinU:1 CTF](https://code610.blogspot.com/2019/03/minu1-ctf.html)
    - [Fowsniff CTF](https://code610.blogspot.com/2019/03/fowsniff-ctf.html)
    - [HackDay Albania CTF](https://code610.blogspot.com/2019/03/hackday-albania-ctf.html)
    - [SolidState CTF](https://code610.blogspot.com/2019/03/solidstate-ctf.html)
  + ►
    [02](https://code610.blogspot.com/2019/02/)
    (5)
  + ►
    [01](https://code610.blogspot.com/2019/01/)
    (10)

* ►
  [2018](https://code610.blogspot.com/2018/)
  (67)
  + ►
    [12](https://code610.blogspot.com/2018/12/)
    (13)
  + ►
    [11](https://code610.blogspot.com/2018/11/)
    (4)
  + ►
    [10](https://code610.blogspot.com/2018/10/)
    (3)
  + ►
    [09](https://code610.blogspot.com/2018/09/)
    (4)
  + ►
    [08](https://code610.blogspot.com/2018/08/)
    (7)
  + ►
    [07](https://code610.blogspot.com/2018/07/)
    (9)
  + ►
    [06](https://code610.blogspot.com/2018/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2018/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2018/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2018/03/)
    (7)
  + ►
    [01](https://code610.blogspot.com/2018/01/)
    (10)

* ►
  [2017](https://code610.blogspot.com/2017/)
  (58)
  + ►
    [12](https://code610.blogspot.com/2017/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2017/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2017/10/)
    (9)
  + ►
    [09](https://code610.blogspot.com/2017/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2017/08/)
    (11)
  + ►
    [07](https://code610.blogspot.com/2017/07/)
    (4)
  + ►
    [06](https://code610.blogspot.com/2017/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2017/05/)
    (10)
  + ►
    [04](https://code610.blogspot.com/2017/04/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2017/02/)
    (1)
  + ►
    [01](https://code610.blogspot.com/2017/01/)
    (6)

* ►
  [2016](https://code610.blogspot.com/2016/)
  (63)
  + ►
    [12](https://code610.blogspot.com/2016/12/)
    (2)
  + ►
    [11](https://code610.blogspot.com/2016/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2016/10/)
    (6)
  + ►
    [09](https://code610.blogspot.com/2016/09/)
    (8)
  + ►
    [08](https://code610.blogspot.com/2016/08/)
    (6)
  + ►
    [07](https://code610.blogspot.com/2016/07/)
    (12)
  + ►
    [06](https://code610.blogspot.com/2016/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2016/05/)
    (23)

## Etykiety

* [.net](https://code610.blogspot.com/search/label/.net)
* [android](https://code610.blogspot.com/search/label/android)
* [binary](https://code610.blogspot.com/search/label/binary)
* [crackme](https://code610.blogspot.com/search/label/crackme)
* [ctf](https://code610.blogspot.com/search/label/ctf)
* [debug](https://code610.blogspot.com/search/label/debug)
* [docker](https://code610.blogspot.com/search/label/docker)
* [drones](https://code610.blogspot.com/search/label/drones)
* [enlil](https://code610.blogspot.com/search/label/enlil)
* [FortiGate](https://code610.blogspot.com/search/label/FortiGate)
* [fuzz](https://code610.blogspot.com/search/label/fuzz)
* [infrastructure](https://code610.blogspot.com/search/label/infrastructure)
* [malware](https://code610.blogspot.com/search/label/malware)
* [notes](https://code610.blogspot.com/search/label/notes)
* [pentest](https://code610.blogspot.com/search/label/pentest)
* [poc](https://code610.blogspot.com/search/label/poc)
* [pwn](https://code610.blogspot.com/search/label/pwn)
* [RE](https://code610.blogspot.com/search/label/RE)
* [web](https://code610.blogspot.com/search/label/web)
* [writeup](https://code610.blogspot.com/search/label/writeup)

|  |  |
| --- | --- |

Motyw Okno obrazu. Obsługiwane przez usługę [Blogger](https://www.blogger.com).


