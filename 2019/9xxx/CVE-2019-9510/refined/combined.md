=== Content from docs.microsoft.com_99569e08_20250121_002938.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Configure Network Level Authentication for Remote Desktop Services Connections

* Article
* 11/17/2009
## In this article

Applies To: Windows Server 2008 R2

Network Level Authentication is an authentication method that can be used to enhance RD Session Host server security by requiring that the user be authenticated to the RD Session Host server before a session is created.

Network Level Authentication completes user authentication before you establish a remote desktop connection and the logon screen appears. This is a more secure authentication method that can help protect the remote computer from malicious users and malicious software. The advantages of Network Level Authentication are:

* It requires fewer remote computer resources initially. The remote computer uses a limited number of resources before authenticating the user, rather than starting a full remote desktop connection as in previous versions.
* It can help provide better security by reducing the risk of denial-of-service attacks.

To use Network Level Authentication, you must meet the following requirements:

* The client computer must be using at least Remote Desktop Connection 6.0.
* The client computer must be using an operating system, such as Windows 7, Windows Vista, or Windows XP with Service Pack 3, that supports the Credential Security Support Provider (CredSSP) protocol.
* The RD Session Host server must be running Windows Server 2008 R2 or Windows Server 2008.

Use the following procedure to configure Network Level Authentication for a connection.

Membership in the local **Administrators** group, or equivalent, is the minimum required to complete this procedure. Review details about using the appropriate accounts and group memberships at [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477).

**To configure Network Level Authentication for a connection**

1. On the RD Session Host server, open Remote Desktop Session Host Configuration. To open Remote Desktop Session Host Configuration, click **Start**, point to **Administrative Tools**, point to **Remote Desktop Services**, and then click **Remote Desktop Session Host Configuration**.
2. Under **Connections**, right-click the name of the connection, and then click **Properties**.
3. On the **General** tab, select the **Allow connections only from computers running Remote Desktop with Network Level Authentication** check box.

   If the **Allow connections only from computers running Remote Desktop with Network Level Authentication** check box is selected and is not enabled, the **Require user authentication for remote connections by using Network Level Authentication** Group Policy setting has been enabled and has been applied to the RD Session Host server.
4. Click **OK**.

The Network Level Authentication setting for an RD Session Host server can also be set in the following ways:

* During the installation of the RD Session Host role service in Server Manager, on the **Specify Authentication Method for Remote Desktop Session Host** page in the **Add Roles Wizard**.
* On the **Remote** tab in the **System Properties** dialog box on an RD Session Host server.

  If the **Allow connections from computers running any version of Remote Desktop (less secure)** is not selected and is not enabled, the **Require user authentication for remote connections by using Network Level Authentication** Group Policy setting has been enabled and has been applied to the RD Session Host server.

  To configure the Network Level Authentication setting by using the **Remote** tab in the **System Properties** dialog box on an RD Session Host server, see **Change Remote Connection Settings**.
* By applying the **Require user authentication for remote connections by using Network Level Authentication** Group Policy setting.

  This Group Policy setting is located in **Computer Configuration\Policies\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Security** and can be configured by using either the Local Group Policy Editor or the Group Policy Management Console (GPMC). Note that the Group Policy setting will take precedence over the setting configured in Remote Desktop Session Host Configuration or on the **Remote** tab.

To determine whether a computer is running a version of Remote Desktop Connection that supports Network Level Authentication, start Remote Desktop Connection, click the icon in the upper-left corner of the **Remote Desktop Connection** dialog box, and then click **About**. Look for the phrase **Network Level Authentication supported** in the **About Remote Desktop Connection** dialog box.

For more information about Remote Desktop Services, see the Remote Desktop Services page on the Windows Server 2008 R2 TechCenter ([https://go.microsoft.com/fwlink/?LinkId=138055](https://go.microsoft.com/fwlink/?linkid=138055)).

For more information about Group Policy settings for Remote Desktop Services, see the Remote Desktop Services Technical Reference ([https://go.microsoft.com/fwlink/?LinkId=138134](https://technet.microsoft.com/en-us/library/%28v%3DWS.11%29)).

#### Additional references

* [Configure Security Settings for Remote Desktop Services Connections](cc753488%28v%3Dws.10%29)

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from docs.microsoft.com_791b5f29_20250121_002937.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan
[Edit](https://github.com/MicrosoftDocs/open_specs_windows/blob/live/documentation/windows_protocols/MS-RDPBCGR/e729948a-3f4e-4568-9aef-d355e30b5389.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# 5.5 Automatic Reconnection

* Article
* 09/03/2022

Feedback

## In this article

The Automatic Reconnection feature allows a client to
reconnect to an existing session (after a short-term network failure has
occurred) without having to resend the user's credentials to the server. A
connection which employs Automatic Reconnection proceeds as follows:

1. The user logs in
   to a new or existing session. As soon as the user has been authenticated, a [Server Auto-Reconnect Packet](18f4f605-0ee3-4175-8a62-cf8775252547)
   (section 2.2.4.2) is generated by the server and sent to the client in the [Save Session Info PDU](885c1879-e0c8-4e2d-80c4-81acea9b51fb)
   (section 2.2.10.1). The Auto-Reconnect Packet (also called the auto-reconnect
   cookie) contains a 16-byte cryptographically secure random number (called the
   auto-reconnect random) and the ID of the session to which the user has
   connected.
2. The client
   receives the cookie and stores it in memory, never allowing programmatic access
   to it.
3. In the case of a
   disconnection due to a network error, the client attempts to reconnect to the
   server by trying to reconnect continuously or for a predetermined number of
   times. Once it has connected, the client and server can exchange large random
   numbers (the client and server random specified in section [5.3.4](5c763306-c9c0-483d-8674-31ed881de118)). If [Enhanced RDP Security](592a0337-dc91-4de3-a901-e1829665291d)
   (section 5.4) is in effect, no client random is sent to the server (section [5.3.2](b9a49d9e-44db-46aa-90a7-bb7f75718e02)).
4. The client derives
   a 16-byte security verifier from the random number contained in the
   auto-reconnect cookie received in Step 2. This security verifier is wrapped in
   a [Client Auto-Reconnect
   Packet](2985e8e3-db10-4a92-9fd5-d5e742d2d0f2) (section 2.2.4.3) and sent to the server as part of the extended
   information (section [2.2.1.11.1.1.1](05ada9e4-a468-494b-8694-eb806a0ecc89))
   of the [Client Info PDU](772d618e-b7d6-4cd0-b735-fa08af558f9d)
   (section 2.2.1.11).

   The auto-reconnect random is used
   to key the HMAC function ([[RFC2104]](https://go.microsoft.com/fwlink/?LinkId=90314)), which uses
   MD5 as the iterative hash function. The security verifier is derived by
   applying the HMAC to the client random received in Step 3.

   ```
    SecurityVerifier = HMAC(AutoReconnectRandom, ClientRandom)

   ```

   When Enhanced RDP Security
   is in effect the client random value is not generated (section 5.3.2). In this
   case, for the purpose of generating the security verifier, the client random is
   assumed to be an array of 32 zero bytes. This implies that the derived security
   verifier will always have the same value for a given auto-reconnect random when
   auto-reconnecting with Enhanced RDP Security.
5. When the server
   receives the Client Auto-Reconnect Packet, it looks up the auto-reconnect
   random for the session and computes the security verifier using the client
   random (the same calculation executed by the client). If the security verifier
   value which the client transmitted matches the one computed by the server, the
   client is granted access. At this point, the server has confirmed that the
   client requesting auto-reconnection was the last one connected to the session
   in question.
6. If the check in
   Step 5 passes, then the client is automatically reconnected to the desired
   session; otherwise the client obtains the user's credentials to regain access
   to the session on the remote server.

The auto-reconnect cookie associated with a given session is
flushed and regenerated whenever a client connects to the session or the
session is reset. This ensures that if a different client connects to the
session, then any previous clients which were connected can no longer use the
auto-reconnect mechanism to connect. Furthermore, the server invalidates and updates
the cookie at hourly intervals, sending the new cookie to the client in the
Save Session Info PDU.

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_dc2c1f6e_20250121_002939.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#576688

## Microsoft Windows RDP can bypass the Windows lock screen

#### Vulnerability Note VU#576688

Original Release Date: 2019-06-04 | Last Revised: 2019-06-19

---

### Overview

Microsoft Windows RDP can allow an attacker to bypass the lock screen on remote sessions.

### Description

| In Windows a session can be locked, which presents the user with a screen that requires authentication to continue using the session. Session locking can happen over RDP in the same way that a local session can be locked.  [CWE-288](https://cwe.mitre.org/data/definitions/288.html): Authentication Bypass Using an Alternate Path or Channel (CVE-2019-9510)Starting with Windows 10 1803 (released in April 2018) and Windows Server 2019, the handling of RDP sessions has changed in a way that can cause unexpected behavior with respect to session locking. If a network anomaly triggers a temporary RDP disconnect, upon [Automatic Reconnection](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rdpbcgr/e729948a-3f4e-4568-9aef-d355e30b5389) the RDP session will be restored to an **unlocked** state, regardless of how the remote system was left. For example, consider the following steps:   1. User connects to remote Windows 10 1803 or Server 2019 or newer system using RDP. 2. User locks remote desktop session. 3. User leaves the physical vicinity of the system being used as an RDP client  At this point, an attacker can interrupt the network connectivity of the RDP client system. The RDP client software will automatically reconnect to the remote system once internet connectivity is restored. But because of this vulnerability, the reconnected RDP session is restored to a logged-in desktop rather than the login screen. This means that the remote system unlocks without requiring any credentials to be manually entered. Two-factor authentication systems that integrate with the Windows login screen, such as Duo Security MFA, may also bypassed using this mechanism. We suspect that other MFA solutions that leverage the Windows login screen are similarly affected. Any login banners enforced by an organization will also be bypassed.It is important to note that this vulnerability is with the Microsoft Windows lock screen's behavior when RDP is being used, and the vulnerability is present when no MFA solutions are installed. While MFA product vendors are affected by this vulnerability, the MFA software vendors are not necessarily at fault for relying on the Windows lock screen to behave as expected.Note that this vulnerability was originally described as requiring Network Level Authentication (NLA). We have since confirmed that this behavior is present whether or not NLA is enabled. Also, some combinations of RDP clients and Windows versions prior to Windows 10 1803 and Server 2019 may also demonstrate automatic session unlocking upon RDP reconnect. In such cases, neither MFA integrated with the login screen nor login banner displaying is bypassed in our testing. Although these cases are a different issue than VU#576688, the workarounds listed in this vulnerability note should still be applied to prevent these similar symptoms. |
| --- |

### Impact

| By interrupting network connectivity of a system, an attacker with access to a system being used as a Windows RDP client can gain access to a connected remote system, regardless of whether or not the remote system was locked. |
| --- |

### Solution

| The CERT/CC is currently unaware of a practical solution to this problem. Please consider the following workarounds. |
| --- |

| **Disable RDP Automatic Reconnection on RDP servers**Microsoft RDP supports a feature called [Automatic Reconnection](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rdpbcgr/e729948a-3f4e-4568-9aef-d355e30b5389), which "*... allows a client to reconnect to an existing session (after a short-term network failure has occurred) without having to resend the user's credentials to the server.*" This Automatic Reconnection feature, used in conjunction with this vulnerability, can allow an attacker to reach a user's desktop session without needing to provide any credentials. The Automatic Reconnection feature can be disabled in Windows Group Policy by setting the following key to **disabled**:Local Computer -> Computer Configuration -> Administrative Templates -> Windows Components -> Remote Desktop Services -> Remote Desktop Session Host -> Connections -> Automatic reconnection**Protect access to RDP client systems**If you have a system that is being used as an RDP client, be sure to lock the **local** system as opposed to the remote system. Even if the local system has nothing of value on it, the live RDP session will only be protected by limiting access to the client system. Locking the remote system over RDP does not provide any protection.**Disconnect RDP sessions instead of locking them**Because locking a remote RDP session provides no effective protection, RDP sessions should be disconnected rather than locked. This invalidates the current session, which prevents an automatic RDP session reconnection without credentials. |
| --- |

### Vendor Information

| Note that vendors other than Microsoft listed as "Affected" are simply indicators that the vendors have products that are affected by this vulnerability in Microsoft Windows RDP. The vendors' actual products do not necessarily contain a vulnerability, but rather that the vendor has a product that may not provide the login protection as expected, as the result of this issue with Microsoft Windows. |
| --- |

576688
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23576688/) to view vendors.**
### [Centrify](#CHEU-BCUS5J) Affected

Notified:  June 05, 2019  Updated: June 06, 2019

**Statement Date:   June 06, 2019**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Duo Security](#CHEU-BBGRU6) Affected

Notified:  April 22, 2019  Updated: June 18, 2019

### Status

Affected

### Vendor Statement

The Windows login/lock screens are secured by credential providers that collect credentials and perform other authentication-related activities, such as multi-factor authentication (MFA). Some are provided by Microsoft—the most common one being the password provider that usually collects the password as part of login. Other third-party providers, such as Duo, work similarly to the Microsoft providers, but add an additional element of MFA to the login.

With changes introduced in v1803 of Windows 10 and Server 2019, Microsoft has decided to use the credentials cached on the client machine to both re-authenticate the connection and unlock the previously-locked desktop, upon reconnecting Remote Desktop Protocol (RDP) sessions. In doing so, Microsoft has hindered credential providers from being able to prompt when a machine is unlocked in this context. By forcing the use of cached credentials, Microsoft has broken functionality used by credential providers to add resilience to this workflow.

To be clear, this is not a vulnerability or defect in Duo's service, but rather, it is a defect in how Microsoft has decided to unlock reconnected RDP sessions that have cached, valid authentication credentials without prompting the user.

We are unaware of Microsoft providing any effective workarounds for this unexpected change, but will continue to evaluate options to provide an integration as was previously achieved. We hope that Microsoft will provide appropriate configuration to allow those that want the previous functionality to be restored to be able to do so.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://help.duo.com/s/article/5148?language=en_US>

### [Microsoft](#CHEU-BBDQ8X) Affected

Notified:  April 19, 2019  Updated: June 11, 2019

**Statement Date:   May 29, 2019**

### Status

Affected

### Vendor Statement

After investigating this scenario,  Microsoft has determined that this scenario
is using valid, cached credentials. It does not compromise security boundaries
or bypass security features.  Therefore it does not meet the Microsoft Security
Servicing Criteria for Windows.  The RDP behavior change observed in VU#576688
was introduced in Windows Server 2019. The change allows the connection to
proceed in the earliest phase of connection. As long as it is connected, the
client will cache the credentials used for connecting and reuse them when it
needs to auto-reconnect.

As a best practice, Microsoft recommends that users always lock the client RDP
and all computers when unattended.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Okta Inc.](#CHEU-BCURZP) Affected

Notified:  June 05, 2019  Updated: June 07, 2019

**Statement Date:   June 06, 2019**

### Status

Affected

### Vendor Statement

This is not a vulnerability or defect in Okta’s service or multi-factor
authentication (MFA) integration to Windows Server. Rather, this is an issue in
how Microsoft unlocks reconnected Remote Desktop Protocol (RDP) sessions
without calling the credential provider.

The Okta MFA Credential Provider does not currently support Windows 10 or
Windows Server 2019. However, any organization that has chosen to use the Okta
MFA Credential Provider for Windows 10 or Windows Server 2019 may be vulnerable
to this Microsoft issue, and users may not be prompted for authentication or
MFA upon re-establishing an RDP session.

As of June 6, we are unaware of any official Microsoft fix, and advise our
customers to reach out to Microsoft for next steps.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://support.okta.com/help/s/article/Understanding-and-Mitigating-the-Windows-RDP-Authentication-Bypass-CVE-2019-9510>

### [Authy](#WDON-BCV6ZK) Not Affected

Notified:  June 05, 2019  Updated: June 06, 2019

**Statement Date:   June 05, 2019**

### Status

Not Affected

### Vendor Statement

We do not provide windows login integration at any level.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Gemalto AV](#CHEU-BCURZR) Not Affected

Notified:  June 05, 2019  Updated: June 17, 2019

**Statement Date:   June 17, 2019**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Silverfort](#CHEU-BCUKC5) Not Affected

Notified:  June 05, 2019  Updated: June 17, 2019

**Statement Date:   June 05, 2019**

### Status

Not Affected

### Vendor Statement

Due to the way our products operates, we are not affected by this vulnerability. We use a unique technology which allows us to enforce MFA on top of the authentication protocol itself (e.g. Kerberos, NTLM, LDAP) without  relying on Windows login screen.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://www.silverfort.io/blog/how-silverfort-overcomes-the-new-lock-screen-bypass-vulnerability/>

### [TUNIX Digital Security](#MOLR-BCWR55) Not Affected

Updated:  June 11, 2019

### Status

Not Affected

### Vendor Statement

TUNIX/Authenticationservice interacts at a level that is not affected.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [AuthLite](#CHEU-BCUKC3) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Idaptive](#CHEU-BCUKBX) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [ManageEngine](#CHEU-BCUJRV) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ping Identity](#CHEU-BCUJRT) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [RSA Security, Inc.](#CHEU-BCUJS3) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [SecureAuth](#CHEU-BCUKBZ) Unknown

Notified:  June 05, 2019  Updated: June 06, 2019

**Statement Date:   June 05, 2019**

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Symantec](#CHEU-BCUJRZ) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Vasco](#CHEU-BCUS5F) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Watchguard Technologies, Inc.](#CHEU-BCUJRX) Unknown

Notified:  June 05, 2019  Updated: June 05, 2019

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

View all 17 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 4.6 | AV:L/AC:L/Au:N/C:P/I:P/A:P |
| Temporal | 4.1 | E:POC/RL:U/RC:C |
| Environmental | 4.2 | CDP:ND/TD:H/CR:ND/IR:ND/AR:ND |

### References

* [https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732713(v=ws.11)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732713%28v%3Dws.11%29)
* <https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rdpbcgr/e729948a-3f4e-4568-9aef-d355e30b5389>
* <https://social.technet.microsoft.com/Forums/windowsserver/en-US/1fd171de-a1b5-4721-86bf-082e4a375049/rds-2019-but-probably-other-versions-as-well-locked-rdp-session-logs-in-after-session-reconnect>
### Acknowledgements

Thanks to Joe Tammariello of the SEI for reporting this vulnerability.

This document was written by Will Dormann.

### Other Information

| **CVE IDs:** | [CVE-2019-9510](http://web.nvd.nist.gov/vuln/detail/CVE-2019-9510) |
| --- | --- |
| **Date Public:** | 2019-02-19 |
| **Date First Published:** | 2019-06-04 |
| **Date Last Updated:** | 2019-06-19 02:24 UTC |
| **Document Revision:** | 136 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from social.technet.microsoft.com_f8b76ca2_20250121_002939.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# RDS 2019 (but probably other versions as well): locked RDP session logs in after session reconnect

* Article
* 02/19/2019
## In this article

#### Question

Tuesday, February 19, 2019 2:57 PM

Hi. I'm running into some sort of security issue. Some of our customers actively lock their RDP session so obviously no-one can use it. It seems that when you lock your RDP session, and then get a reconnect to the server, and the RDP client reconnects, it automatically logs you in again, circumventing the lock.

Easy to abuse too: locked session? Just disconnect the network cable / wifi until the session starts reconnecting, and reconnect the cable and \*poof\* you are in.

Now some of this is prevented as we have some customers that have 2FA implemented on the RD Gateways, so when the session reconnects, you'll need to approve the 2FA. But not all customers have that.

Would there be any way to prevent this? Anyone else can confirm this?

#### All replies (7)

Friday, February 22, 2019 8:46 AM

hi,

1 "Some of our customers actively lock their RDP session so obviously no-one can use it."

Do you mean if one problematical user lock his rdp session and other user can not remote access rdsh server?

2 "It seems that when you lock your RDP session, and then get a reconnect to the server, and the RDP client reconnects, it automatically logs you in again, circumventing the lock."

if we config screen lock policy for domain user ,will it solve this problem ?

UserConfig\AdministrativeTemplates\Control Panel\Personalization

1.Enable screen saver

2.Force specific screen saver (tried adding one & also leaving as blank)

3.Password protect the screen saver

4.Screen saver timeout to 60 seconds

Please remember to **mark the replies as answers** if they help.

If you have feedback for TechNet Subscriber Support, contact tnmff@microsoft.com.

---

Friday, February 22, 2019 9:44 AM

Hi,

You may Disable Automatic Reconnection on your RD Session Host server(s) to stop this behavior.  You can do this via group policy setting:

Computer Configuration\ Administrative Templates\ Windows Components\ Remote Desktop Services\ Remote Desktop Session Host\ Connections\

Automatic Reconnection     Disabled

After making sure the group policy setting has been applied (gpupdate /force) to your RDSH servers, please disconnect or log off all sessions.  Once users log back on automatic reconnects will be disabled.

Thanks.

-TP

---

Friday, February 22, 2019 10:25 AM | **1 vote**

> Hi,
>
> You may Disable Automatic Reconnection on your RD Session Host server(s) to stop this behavior.  You can do this via group policy setting:
>
> Computer Configuration\ Administrative Templates\ Windows Components\ Remote Desktop Services\ Remote Desktop Session Host\ Connections\
>
> Automatic Reconnection     Disabled
>
> After making sure the group policy setting has been applied (gpupdate /force) to your RDSH servers, please disconnect or log off all sessions.  Once users log back on automatic reconnects will be disabled.
>
> Thanks.
>
> -TP

Well, that's not a real fix. I guess there should be a mechanism in place, if a user is actually working in his session and it gets disconnected, the reconnect should 'log in'. However, when the session was already locked, it shouldn't unlock. Disabling reconnecting altogether wouldn't be really userfriendly, given that all our users are on WAN. We've got quite stable connections for most of them, but still, reconnects occur over time.

I actually think this is quite a security breach. Settings screensaver to 60 seconds (what?!) is another workaround, but certainly not a fix. I'll keep on looking.

---

Friday, February 22, 2019 11:44 AM

Hi,

That's true, it's a workaround that you can choose or not based on what is a higher priority.  It's not my preference, but like or it not this has been the way it behaves for a long time.

Have you opened a support case with Microsoft?  It is possible they will consider this a security issue and develop a hotfix to change it.

There are additional ways you can look at this from a security perspective.  For example, locking a remote session while keeping the local device unlocked isn't good security policy.  Likewise allowing physical access to a client device that is currently powered on with an activate authenticated user local session (whether locked or not, or open remote session or not) by another person is not the best from security perspective.

Besides opening a support case what you could do is run a program inside of each session and have it lock the session upon reconnect.  Essentially, you can write small program that will listen for the reconnect event and then lock the session.  Downside would be the session would lock every time there is disconnect/reconnect and not just for the ones where session was previously locked.

-TP

---

Thursday, February 28, 2019 3:42 PM

hi

I think you can post your idea in this forum , I hope there will be better answer for you.

Remote Desktop Services customer voice

<https://remotedesktop.uservoice.com/forums/266795-remote-desktop-services>

Please remember to **mark the replies as answers** if they help.

If you have feedback for TechNet Subscriber Support, contact tnmff@microsoft.com.

---

Thursday, February 28, 2019 3:44 PM

Yeah I guess I'll do that. Thanks.

---

Monday, March 4, 2019 6:51 AM

Thank you for your support and understanding.

Please remember to **mark the replies as answers** if they help.

If you have feedback for TechNet Subscriber Support, contact tnmff@microsoft.com.

---

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


