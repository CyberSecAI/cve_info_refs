=== Content from github.com_a1dd40e1_20250121_003259.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F853)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F853)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix ECDH message encryption for some session keys #853

 Merged

[twiss](/twiss)
merged 4 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:fix-ecdh-encryption](/twiss/openpgpjs/tree/fix-ecdh-encryption "twiss/openpgpjs:fix-ecdh-encryption")

Feb 5, 2019

 Merged

# [Fix ECDH message encryption for some session keys](#top) #853

[twiss](/twiss)
merged 4 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:fix-ecdh-encryption](/twiss/openpgpjs/tree/fix-ecdh-encryption "twiss/openpgpjs:fix-ecdh-encryption")

Feb 5, 2019

[Conversation
1](/openpgpjs/openpgpjs/pull/853)
[Commits
4](/openpgpjs/openpgpjs/pull/853/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/853/checks)
[Files changed](/openpgpjs/openpgpjs/pull/853/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![twiss](https://avatars.githubusercontent.com/u/908303?s=60&v=4)](/twiss)

Copy link

Member

### @twiss **[twiss](/twiss)** commented [Feb 4, 2019](#issue-406384284)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=60&v=4)](/sanjanarajan)

**[sanjanarajan](/sanjanarajan)**
reviewed
[Feb 4, 2019](#pullrequestreview-199671979)

 [View reviewed changes](/openpgpjs/openpgpjs/pull/853/files)

[test/general/openpgp.js](/openpgpjs/openpgpjs/pull/853/files#diff-dd238ea97010c9e750ccff6a2331f8ad13426290190981cc77585607f111e4bb)
Outdated

Show resolved

Hide resolved

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
mentioned this pull request
[Feb 4, 2019](#ref-pullrequest-406430414)

[Work around OpenPGP.js bug encrypting ECDH messages
ProtonMail/go-crypto#12](/ProtonMail/go-crypto/pull/12)
 Merged

 [twiss](/twiss)
added 2 commits
[February 4, 2019 18:13](#commits-pushed-9954ea4)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Update openpgpjs/elliptic](/openpgpjs/openpgpjs/pull/853/commits/9954ea4e56a7bb393a16e62ac0fdc5e4ff2ee976 "Update openpgpjs/elliptic")`

`[9954ea4](/openpgpjs/openpgpjs/pull/853/commits/9954ea4e56a7bb393a16e62ac0fdc5e4ff2ee976)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Fix ECDH message encryption for some session keys](/openpgpjs/openpgpjs/pull/853/commits/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e "Fix ECDH message encryption for some session keys")`

`[7ba4f8c](/openpgpjs/openpgpjs/pull/853/commits/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e)`

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/97bbe46436d408ba3d9a4effcd8b9432b366f611..8e12ae723da49cec115ca19de87fbc2234d45ea2)
the
fix-ecdh-encryption

branch
3 times, most recently
from
[`97bbe46`](/openpgpjs/openpgpjs/commit/97bbe46436d408ba3d9a4effcd8b9432b366f611) to
[`8e12ae7`](/openpgpjs/openpgpjs/commit/8e12ae723da49cec115ca19de87fbc2234d45ea2)  [Compare](/openpgpjs/openpgpjs/compare/97bbe46436d408ba3d9a4effcd8b9432b366f611..8e12ae723da49cec115ca19de87fbc2234d45ea2)
[February 5, 2019 10:17](#event-2118034600)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Fix async describe() in test suite that always runs](/openpgpjs/openpgpjs/pull/853/commits/6b2f1ed7b0487d387139acf71099e5c452789b4d "Fix async describe() in test suite that always runs")`

`[6b2f1ed](/openpgpjs/openpgpjs/pull/853/commits/6b2f1ed7b0487d387139acf71099e5c452789b4d)`

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/8e12ae723da49cec115ca19de87fbc2234d45ea2..6b2f1ed7b0487d387139acf71099e5c452789b4d)
the
fix-ecdh-encryption

branch
from
[`8e12ae7`](/openpgpjs/openpgpjs/commit/8e12ae723da49cec115ca19de87fbc2234d45ea2) to
[`6b2f1ed`](/openpgpjs/openpgpjs/commit/6b2f1ed7b0487d387139acf71099e5c452789b4d)  [Compare](/openpgpjs/openpgpjs/compare/8e12ae723da49cec115ca19de87fbc2234d45ea2..6b2f1ed7b0487d387139acf71099e5c452789b4d)
[February 5, 2019 11:07](#event-2118150808)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Specify git commits in package.json](/openpgpjs/openpgpjs/pull/853/commits/a875d2da043435d9def68faff721ec7b6e573819 "Specify git commits in package.json")`

`[a875d2d](/openpgpjs/openpgpjs/pull/853/commits/a875d2da043435d9def68faff721ec7b6e573819)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
merged commit [`9d7db98`](/openpgpjs/openpgpjs/commit/9d7db98362cbd1ea3a8eb26b55d0d876b0a1de14)
into
openpgpjs:master

[Feb 5, 2019](https://github.com/openpgpjs/openpgpjs/pull/853#event-2118357221)

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
deleted the
fix-ecdh-encryption

branch
[February 5, 2019 12:47](#event-2118357328)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F853)

Reviewers

[![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=40&v=4)](/sanjanarajan) [sanjanarajan](/sanjanarajan)

sanjanarajan left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=52&v=4)](/twiss) [![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=52&v=4)](/sanjanarajan)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sec-consult.com_fcb68771_20250121_003302.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/kritische-schwachstellen-in-openpgp-js/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities In Openpgp.js
# Multiple Vulnerabilities In Openpgp.js

Title

Multiple vulnerabilities

Product

OpenPGP.js

Vulnerable Version

<=4.2.0

Fixed Version

4.3.0

CVE Number

CVE-2019-9153, CVE-2019-9154, CVE-2019-9155

Impact

critical

Homepage

[https://openpgpjs.org](https://openpgpjs.org "https://openpgpjs.org")

Found

31.12.2018

By

Wolfgang Ettlinger (Office Vienna) | SEC Consult Vulnerability Lab

In the course of a project aimed at improving the browser plugin “Mailvelope” SEC Consult was tasked by the German Bundesamt für Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope and OpenPGP.js software. During this engagement several vulnerabilities were found, that e.g. in specific scenarios could have allowed an attacker to steal a victim’s private key.

## Vendor Description

*“This project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device. Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library). The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications. It should allow you to sign, encrypt, decrypt, and verify any kind of text – in particular e-mails – as well as managing keys.”*

Source: [https://openpgpjs.org](https://openpgpjs.org/)

## Business Recommendation

SEC Consult was tasked by the German Bundesamt für Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope browser extension as well as the parts of OpenPGP.js used by Mailvelope. During the course of this audit multiple security vulnerabilities with severities ranging from minor to critical have been identified. Some of the vulnerabilities with higher severity are published as an advisory. A more detailed description of the vulnerabilities as well as a description of other vulnerabilities found during this project can be found in the report that has been made available by the BSI:

[https://www.bsi.bund.de/[…]/Publications/Studies/Mailvelope\_Extensions/Mailvelope\_Extensions\_pdf.html](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html)

## Vulnerability Overview/description

### 1) Message Signature Bypass (CVE-2019-9153)

OpenPGP defines several types of signatures with each type carrying a different semantic. Signatures are implemented as packets and each signature packet can contain subpackets.

To indicate a message signature (e.g. a signed e-mail), the signature type “text” is used. The text signature packet verifies both its subpackets as well as the signed text.

During verification of a message signature, OpenPGP.js does not verify that the signature is of type text. An attacker could therefore construct a message that, instead of a text signature, contains a signature of another type. As the input required for the verification process depends on the signature type, an attacker could use a signature with a type that only verifies its subpackets and does not require additional input.

An attacker could construct a message that contains a valid “standalone” or “timestamp” signature packet signed by another person. OpenPGP.js would incorrectly assume this message to be signed by that person.

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

OpenPGP signature subpackets contain information related to a signature (e.g. the creation timestamp). These subpackets may appear in a “hashed” and “unhashed” subpacket container. While the information in the hashed subpackets is signed, the unhashed subpackets are not cryptographically protected. OpenPGP.js however does not distinguish between these subpackets. When parsing a signature packet, the signed information is parsed first. When the unhashed packets are read, the information from the hashed packets is overwritten.

An attacker could arbitrarily modify the contents of e.g. a key certification signature or revocation signature. As a result, the attacker could e.g. convince a victim to use an obsolete key for encryption.

### 3) Invalid Curve Attack (CVE-2019-9155)

The implementation of the Elliptic Curve Diffie-Hellman (ECDH) key exchange algorithm does not verify that the communication partner’s public key is valid (i.e. that the point lies on the elliptic curve). This causes the application to implicitly calculate the resulting secret key not based on the specified elliptic curve but rather an altered curve. By carefully choosing multiple altered curves (and therefore the resulting public key), and observing whether decryption fails, an attacker can extract the victim’s private key.

This attack requires the attacker to be able to provide multiple manipulated messages and to observe whether decryption fails.

## Proof Of Concept

### 1) Message Signature Bypass (CVE-2019-9153)

The script message\_signature\_bypass.js (see below) demonstrates this issue. The function fakeSignature reads a signed message and replaces its content. It then replaces the signature with a standalone signature of the victim.

Source code ([SEC\_Consult\_BSI\_Mailvelope-signature\_bypass.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-message_signature_bypass.txt))

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

The script unsigned\_subpackets.js demonstrates this issue. It parses an expired key and adds additional unhashed subpackets that specify a different key expiration. When this newly-created key is parsed, it can be used for encrypting messages.

Source code ([SEC\_Consult\_BSI\_Mailvelope-unsigned\_subpackets.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-unsigned_subpackets.txt))

### 3) Invalid Curve Attack (CVE-2019-9155)

The script in invalid\_curve\_attack.js demonstrates this issue. Note that since OpenPGP uses only the x-coordinate of the secret point, the oracle succeeds both when it calculates the same point as the attacker or when it calculates its inverse point. Therefore, the Chinese Remainder Theorem cannot be directly applied to the result. Instead, the script demonstrates that the remainders of the private key matches the corresponding gathered remainder. In order to fully implement this attack, an attacker could verify the results using other public key points with a non-prime order.

Source code ([SEC\_Consult\_BSI\_Mailvelope-invalid\_curve\_attack.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-invalid_curve_attack.txt))

## Vulnerable / Tested Versions

The version 4.1.2 was found to be vulnerable. The Invalid Curve attack is also viable against version 4.2.0.

## Vendor Contact Timeline

Vendor communication was conducted by the BSI as well as their contractors.

## Solution

Upgrade to the latest version of OpenPGP.js.

## Workaround

None.

## Advisory URL

[https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html](/vulnerability-lab/)

EOF Wolfgang Ettlinger / @2019

### Contact

Interested to work with the experts of SEC Consult? Send us your application.

Want to improve your own cyber security with the experts of SEC Consult?

[contact us](/contact/)[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from packetstormsecurity.com_7eab44d3_20250121_003258.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.bsi.bund.de_9555648f_20250121_003302.html ===


# Navigation and service

*Go to:*

* [Content](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#content)
* [Main Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646# )
* [Search](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#search)

## Menu

* [Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#nav)

## Service menu

## Servicemenue

* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
* **English**
* [Gebär­den­sprache](DE/Service/Gebaerdensprache/gebaerdensprache_node.html)
* [Le­ichte Sprache](DE/Service/LeichteSprache/leichtesprache_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Lo­gin](Login/Login/login_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo.svg?__blob=normal&v=4)](DE/Home/home_node.html "to homepage")

[![Logo "Deutschland Digital Sicher](/_config/AdditionalLogo.svg?__blob=value&v=6)](DE/Home/home_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo-bsi-smaller.svg?__blob=normal&v=3)](DE/Home/home_node.html "to homepage")

## Main Menu

* [Das BSI](DE/Das-BSI/das-bsi_node.html "Das BSI")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Das BSI

  + [Cy­ber­na­tion Deutsch­land](DE/Das-BSI/Cybernation/cybernation_node.html)
  + [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
  + [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
  + [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
  + [Zeit­strahl](DE/Das-BSI/Zeitstrahl/BSI-Zeitstrahl_node.html)
  + [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
  + [Umwel­terk­lärung](DE/Das-BSI/Nachhaltigkeit/EMAS/umwelterklaerung_node.html "Umwelterklärung")
* [The­men](DE/Themen/themen_node.html "Themen")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### All topics

  + [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
    #### Our top themes

    - [Na­tionales IT-Lagezen­trum](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/Nationales-IT-Lagezentrum/nationales-it-lagezentrum_node.html "Nationales IT-Lagezentrum")
    - [CERT-Bund](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/CERT-Bund/cert-bund_node.html "CERT-Bund")
    - [Zusam­me­nar­beit mit Bund und Län­dern](DE/Themen/Oeffentliche-Verwaltung/Zusammenarbeit_mit_Bund_und_Laendern/bund-laender-zusammenarbeit_node.html "Zusammenarbeit mit Bund und Ländern")
    - [Sicher­heits­ber­atung](DE/Themen/Oeffentliche-Verwaltung/Sicherheitsberatung/sicherheitsberatung_node.html "Sicherheitsberatung")
    - [Min­dest­stan­dards Bund](DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/Mindeststandards_node.html "Mindeststandards")[All topics](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html)
  + [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
    #### Our top themes

    - [Threat In­tel­li­gence](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Threat-Intelligence/threat-intelligence_node.html "Threat Intelligence")
    - [IT-Sicher­heitskennze­ichen](DE/Themen/Unternehmen-und-Organisationen/IT-Sicherheitskennzeichen/it-sicherheitskennzeichen_node.html "IT-Sicherheitskennzeichen")
    - [IT-Grund­schutz](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/it-grundschutz_node.html "IT-Grundschutz")
    - [Zer­ti­fizierung und An­erken­nung](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/zertifizierung-und-anerkennung_node.html "Zertifizierung und Anerkennung")
    - [Ran­somware An­griffe](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)[All topics](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html)
  + [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
    #### Our top themes

    - [Sicher­heit beim On­li­neshop­ping](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Online-Banking-Online-Shopping-und-mobil-bezahlen/Online-Shopping/online-shopping_node.html "Sicherheit beim Onlineshopping")
    - [On­line-Ac­count ab­sich­ern](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Cyber-Sicherheitsempfehlungen/Accountschutz/accountschutz_node.html "Accountschutz")
    - [Bedro­hun­gen durch Cy­ber-Krim­inelle](DE/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/methoden-der-cyber-kriminalitaet_node.html "Methoden der Cyber-Kriminalität")
    - [E-Mail, So­cial Me­dia, Mes­sen­ger und Co.](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Onlinekommunikation/onlinekommunikation_node.html "Onlinekommunikation")
    - [Smart Me­ter­ing & Lade­in­fras­truk­tur](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Internet-der-Dinge-Smart-leben/Smart-Meter-Gateway/smart-meter-gateway_node.html "Smart-Meter-Gateway")[All topics](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html)
  + [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")
    #### Our top themes

    - [NIS-2-reg­ulierte Un­ternehmen](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html "NIS-2-regulierte Unternehmen")
    - [Ak­tuelle In­for­ma­tio­nen aus dem KRI­TIS-Fach­bere­ich](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-aktuell/kritis-aktuell_node.html "Aktuelle Informationen aus dem KRITIS-Fachbereich")
    - [KRI­TIS-FAQ](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-FAQ/kritis-faq_node.html "KRITIS-FAQ")
    - [Ser­vice für KRI­TIS-Be­treiber](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/Service-fuer-KRITIS-Betreiber/service-fuer-kritis-betreiber_node.html "Service für KRITIS-Betreiber")
    - [UP KRI­TIS](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/UP-KRITIS/up-kritis_node.html "UP KRITIS")[All topics](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### IT-Sicherheitsvorfall

  + [Ver­braucherin­nen und Ver­brauch­er](DE/IT-Sicherheitsvorfall/Buergerinnen-und-Buerger/buergerinnen-und-buerger_node.html "Verbraucherinnen und Verbraucher")
  + [Un­ternehmen](DE/IT-Sicherheitsvorfall/Unternehmen/unternehmen_node.html "Unternehmen")
  + [Kri­tis­che In­fras­truk­turen und meldepflichtige Un­ternehmen](DE/IT-Sicherheitsvorfall/Kritische-Infrastrukturen-und-meldepflichtige-Unternehmen/kritische-infrastrukturen-und-meldepflichtige-unternehmen_node.html "Kritische Infrastrukturen und meldepflichtige Unternehmen")
  + [CVD-Richtlin­ie des BSI](DE/IT-Sicherheitsvorfall/IT-Schwachstellen/it-schwachstellen_node.html "CVD-Richtlinie des BSI")
* [Kar­riere](DE/Karriere/karriere_node.html "Karriere")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Karriere

  + [Willkom­men im #TeamB­SI](DE/Karriere/Team_BSI/team_bsi_node.html "Willkommen im Team BSI")
  + [Warum BSI?](DE/Karriere/Warum_BSI/warum_BSI_node.html "Warum BSI?")
  + [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
  + [Ein­stieg](DE/Karriere/Einstieg/einstieg_node.html "Einstieg")
  + [FAQ](DE/Karriere/FAQ/faq_node.html "FAQ")
  + [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
  + [Ter­mine](DE/Karriere/Termine/termine_node.html "Termine")
  + [Kon­takt Per­son­al­gewin­nung](DE/Karriere/Kontakt/kontakt_node.html "Kontakt Personalgewinnung")
* [Ser­vice](DE/Service-Navi/service-navi_node.html "Service")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Service

  + [Presse](DE/Service-Navi/Presse/presse_node.html "Presse")
  + [Mediathek](SiteGlobals/Forms/Suche/Mediathek_Formular.html?nn=132646)
  + [Pub­lika­tio­nen](DE/Service-Navi/Publikationen/publikationen_node.html "Publikationen")
  + [Newslet­ter und So­cial Me­dia](DE/Service-Navi/Abonnements/abonnements_node.html "Newsletter und Social Media")
  + [Ve­r­anstal­tun­gen](DE/Service-Navi/Veranstaltungen/veranstaltungen_node.html "Veranstaltungen")
  + [Ver­gaben an Ex­terne](DE/Service-Navi/Vergaben-an-Externe/vergaben-an-externe_node.html "Vergaben an Externe")
  + [Die E-Rech­nung im BSI](DE/Service-Navi/Die-E-Rechnung-im-BSI/die-e-rechnung-im-bsi_node.html "Die E-Rechnung im BSI")
  + [Kosten für Leis­tun­gen des BSI](DE/Service-Navi/Hinweise-Kosten/Hinweise-Kosten_node.html "Kosten für Leistungen des BSI")
  + [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
  + [Fra­gen & Antworten](DE/Service-Navi/FAQ/faq_node.html "Fragen & Antworten")
* [![SucheOeffnen](/SiteGlobals/Frontend/Images/icons/search.svg?__blob=normal&v=3)
  ![SucheSchliessen](/SiteGlobals/Frontend/Images/icons/search-blue.svg?__blob=normal&v=3)
  SucheOeffnen](SiteGlobals/Forms/Suche/Servicesuche_Formular.html?nn=132646)

## Search

Search

### Frequently searched

* [Regulierung nach NIS-2](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html)
* [Gefährdungen durch Ransomware](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)
* [Zertifizierung Produkte & Personen (FAQ)](DE/Service-Navi/FAQ/Zertifizierung/faq_node.html)
* [Zertifizierung Common Criteria](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/Zertifizierung-von-Produkten/Zertifizierung-nach-CC/zertifizierung-nach-cc_node.html)
* [Elektronische Identitäten](DE/Themen/Oeffentliche-Verwaltung/Elektronische-Identitaeten/elektronische-identitaeten_node.html)
* [Digitaler Verbraucherschutz](DE/Themen/Verbraucherinnen-und-Verbraucher/Leistungen-und-Kooperationen/Digitaler-Verbraucherschutz/digitaler-verbraucherschutz_node.html)
* [Technische Richtlinien](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/technische-richtlinien_node.html)
* [Kritische Infrastrukturen](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [Künstliche Intelligenz](DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Kuenstliche-Intelligenz/kuenstliche-intelligenz_node.html)

![Close](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)

## You are here:

1. [to homepage](DE/Home/home_node.html "to homepage")
2. **Mailvelope Extensions Security Audit**

# Mailvelope Extensions Security Audit

**date**
30.07.2019

![Bild-Dokument für das Frontend](/SiteGlobals/Frontend/Images/kopfbereich.png?__blob=normal&v=9 "Bild-Dokument für das Frontend")

 ![Cover Mailvelope Extensions Security Audit](/SharedDocs/Bilder/EN/Publications/cover/Mailvelope_Extensions.png?__blob=normal&v=1 "Cover Mailvelope Extensions Security Audit")

SEC Consult was tasked by the Federal Office for Information Security (german abbreviated as BSI) with performing a security audit and source code review of the Mailvelope Google Chrome and Firefox Add-ons, the OpenPGP.js library as well as the GPGME-json utility. Objective of this review was to reveal common security issues and to offer suggestions for improvements. The focus of the audit was to identify:

* vulnerabilities in the cryptographic algorithms,
* routines that could cause user data compromise,
* and routines that could be abused for user monitoring.

The vulnerabilities outlined in this document are subject to a coordinated vulnerability disclosure process and the appropriate maintainers have been notified. [Most of the vulnerabilities are patched, while some uncritical vulnerabilities are not yet addressed. Passages in this report regarding unpatched vulnerabilities are hence expunged.]

The following chapter summarizes the scope and timetable of the audit, the results of the audit and outlines the measures recommended by SEC Consult.

* [PDF, 1MB download](/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.pdf?__blob=publicationFile&v=1 "Opens in new window")

# Footer

Seite drucken

## Subnavigation of all website sections

### Themen

* [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
* [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
* [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
* [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")

### Das BSI

* [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
* [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
* [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
* [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")

### Karriere

* [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
* [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
* [Studi­um und Aus­bil­dung](DE/Karriere/Einstieg/Studium-und-Ausbildung/studium-und-ausbildung_node.html "Studium und Ausbildung")

### IT-Sicherheitsvorfall

* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")

### Follow us

* [Das BSI auf Facebook](https://www.facebook.com/bsi.fuer.buerger "External link: Das BSI auf Facebook (Opens new window)")
* [Das BSI auf 'X'](https://x.com/BSI_Bund "External link: Das BSI auf X (Opens new window)")
* [BSI-Instagram](https://www.instagram.com/bsi_bund "External link: Das BSI auf Instagram (Opens new window)")
* [Das BSI auf LinkedIn](https://de.linkedin.com/company/bsibund "External link: Das BSI auf LinkedIn (Opens new window)")
* [Das BSI auf Mastodon](https://social.bund.de/%40bsi/ "External link: Das BSI auf Mastodon (Opens new window)")
* [Newsletterverwaltung](DE/Service-Navi/Abonnements/Newsletter/newsletter_node.html "Newsletterverwaltung")
* [Das BSI auf YouTube](https://www.youtube.com/channel/UC_VgLyJQsChxKfDJcdI-Tcg "External link: Das BSI auf YouTube (Opens new window)")
* [Das BSI auf Xing](https://www.xing.com/pages/bsibund "External link: Das BSI auf Xing (Opens new window)")
* [RSS](DE/Service-Navi/Abonnements/RSS/rss_node.html "RSS")

[![Logo Zertifikat IT-Grundschutz ISO 27001](/SharedDocs/Bilder/DE/BSI/Logos/Logo_Zertifizierung-ISO27001_IT-Grundschutz.svg?__blob=normal "Logo Zertifikat IT-Grundschutz ISO 27001 (Quelle: BSI)")](./DE/Service/Impressum/impressum_node.html#ISO)

* [Im­pres­sum](DE/Service/Impressum/impressum_node.html)
* [Daten­schutz](DE/Service/Datenschutz/datenschutz_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Bar­ri­ere­frei­heit](DE/Service/Barrierefreiheit/barrierefreiheit_node.html)

© Federal Office for Information Security

Top
[TOP](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#Start "Top")

## Hinweis zur Verwendung von Cookies

Das BSI speichert keine personenbezogenen Daten der Webseitenbesucher. Details in unserer [Datenschutzerklärung](DE/Service/Datenschutz/datenschutz_node.html "Datenschutz")

OK

![](https://piwik.itzbund.de/piwik.php?idsite=35&rec=1&url=https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646)



=== Content from openpgpjs.org_8a2bbf97_20250121_024123.html ===

![This project is supported by the Horizon 2020 Framework Programme of the European Union](images/logo-gdpr-eu-white.svg)
![OpenPGP.js Logo](images/icon_openpgpjs.png "OpenPGP.js")

## About

This project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device.
Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library).
The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications.
It should allow you to sign, encrypt, decrypt, and verify any kind of text - in particular e-mails - as well as managing keys.

This project is maintained by [Proton Mail](https://proton.me/blog/openpgpjs-email-encryption).

Contacts:

* To report security issues: [[email protected]](/cdn-cgi/l/email-protection#8dfee8eef8ffe4f9f4cde2fde8e3fdeafde7fea3e2ffea) (Please download our [PGP key](.well-known/openpgpkey/hu/t5s8ztdbon8yzntexy6oz5y48etqsnbb), either manually or using [WKD](https://wiki.gnupg.org/WKD))
* For general inquiries: [[email protected]](/cdn-cgi/l/email-protection#12717d7c66737166527d62777c62756278613c7d6075) ([PGP key](.well-known/openpgpkey/hu/dj3498u4hyyarh35rkjfnghbjxug6b19))

## Download

[![js logo](./images/logo_js.png "Download OpenPGP.js")](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started "Download OpenPGP.js")

## Resources

* [Source code](https://github.com/openpgpjs/openpgpjs)
* [Getting started](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started)
* [API documentation](https://docs.openpgpjs.org)
* [GitHub issues](https://github.com/openpgpjs/openpgpjs/issues)
* [Wiki](https://github.com/openpgpjs/openpgpjs/wiki)
* [Twitter](https://twitter.com/openpgpjs)

## Gold Members / Supporters

[![Proton Mail logo](./images/logo_proton_mail.png "Proton Mail")
Proton Mail](https://proton.me/mail "Proton Mail")
[![globaleaks logo](./images/logo_globaleaks.png "Globaleaks")
GlobaLeaks.org](https://www.globaleaks.org "Globaleaks")
[![mailvelope logo](./images/logo_mailvelope.png "Mailvelope")
Mailvelope](https://www.mailvelope.com "Mailvelope")

## Who else is using OpenPGP.js

[![FlowCrypt logo](./images/logo_flowcrypt.jpg "PGP Encryption for Gmail")
FlowCrypt](https://flowcrypt.com/ "FlowCrypt")
[![Mymail-Crypt logo](./images/logo_mymail_crypt.jpg "Google Chrome Extension Mymail-Crypt")
Mymail-Crypt](https://chrome.google.com/webstore/detail/mymail-crypt-for-gmail/jcaobjhdnlpmopmjhijplpjhlplfkhba "Google Chrome Extension Mymail-Crypt")
[![udc logo](./images/logo_openudc.png "Universal Digital Currencies")
UDC](https://www.openudc.org/ "Universal Digital Currencies")
[![encrypto logo](./images/logo_encrypto.png "encrypt.to uses OpenPGP.js to encrypt messages and send via Rails backend")
Encrypt.to](https://encrypt.to "Encrypt To")
[![PGP Anywhere](./images/logo_pgpanywhere.png "Encrypt and decrypt PGP on the go")
PGP Anywhere](https://chrome.google.com/webstore/detail/pgp-anywhere/cdlcdnmhcodhagbmljapgbjdimjckilb "PGP Anywhere")
[![Passbolt logo](./images/logo_passbolt.png "Open source password manager for teams")
passbolt](https://www.passbolt.com "Passbolt")

## Architecture

![OpenPGP.js overview](images/overview.png)



=== Content from github.com_4ee4c2ba_20250121_003301.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.3.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.3.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs/tree/v4.3.0)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs/tree/v4.3.0)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

1. [Releases](/openpgpjs/openpgpjs/releases)
2. [v4.3.0](/openpgpjs/openpgpjs/releases/tag/v4.3.0)

# v4.3.0 - Security Release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/openpgpjs/openpgpjs/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.3.0)

 Loading

[View all tags](/openpgpjs/openpgpjs/tags)

![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)
[twiss](/twiss)
released this
17 Dec 19:43

[v4.3.0](/openpgpjs/openpgpjs/tree/v4.3.0)

[`d24bdd5`](/openpgpjs/openpgpjs/commit/d24bdd5fa21b501b2fd3defacab5af24c63dd322)

This release fixes more security issues. Please upgrade to the latest version as soon as possible.

## Security fixes

* Validate ECC public keys, to prevent an attack extracting private keys
* Remove non-AES CFB quick check, to prevent side-channel timing attacks
* Reject messages encrypted with a symmetric algorithm not in preferred algorithms
* Check signature public key algorithm against issuer key algorithm
* Always look at the same literal data packet in getText() and verify()
* Return generic error on PKESK checksum mismatch when decrypting

## Other changes

* Fix undefined behavior when reading 3DES-encrypted packet
* Consider non-expired signatures from expired keys to still be valid
* Check that signing key was not expired at signature creation time
* Check that message signatures are not expired when verifying them
* Fix revocation example in README, use `revocationCertificate` instead of `revocationSignature`
* Fix CMAC of the empty string
* Add config values to preferred algorithms
* Fall back to RFC4880bis-mandated symmetric algorithms (AES128 and EAX) instead of config value

## Example of behavior changes for preferred algorithms

As an example, previously, if you set `openpgp.config.encryption_cipher = openpgp.enums.symmetric.twofish`, OpenPGP.js would:

1. When generating a key, not add Twofish to the preferred algorithms
2. When encrypting to that generated key, not use Twofish (since it wasn't in the preferred algorithms)
3. When encrypting to a key with non-supported preferred algorithms, or multiple keys with no overlapping preferred algorithms, fall back to Twofish

Then, if you were to decrypt that last message using GPG, it would warn that the message was encrypted with an algorithm that's not in the preferred algorithms. This could happen even with the default config value of AES256, since RFC4880 mandates falling back to 3DES, not AES256. (RFC4880bis mandates falling back to AES128.)

Since this version, if you set `openpgp.config.encryption_cipher = openpgp.enums.symmetric.twofish`, OpenPGP.js will instead:

1. When generating a key, add Twofish to the preferred algorithms
2. When encrypting to that generated key, use Twofish (since it is in the preferred algorithms)
3. When encrypting to a key with non-supported preferred algorithms, or multiple keys with no overlapping preferred algorithms, fall back to AES128 (since that's the algorithm mandated by RFC4880bis)

## Example of backwards-incompatible behavior

In some edge cases, some of the above changes are not backwards-compatible. For example, if you use OpenPGP.js < 4.3.0 and:

1. Set `openpgp.config.encryption_cipher` to any value other than `openpgp.enums.symmetric.aes256`, `openpgp.enums.symmetric.aes128` or `openpgp.enums.symmetric.tripledes`, and
2. Encrypt messages to a key with non-supported preferred algorithms, or multiple keys with no overlapping preferred algorithms

And then try to decrypt those messages using OpenPGP.js >= 4.3.0, you will get an error. (Similarly, GPG gives a warning in this situation, but still decrypts the messages as well.)

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d1cad0c9_20250121_003300.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F853%2Fcommits%2F7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F853%2Fcommits%2F7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

# Fix ECDH message encryption for some session keys #853

 Merged

[twiss](/twiss)
merged 4 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:fix-ecdh-encryption](/twiss/openpgpjs/tree/fix-ecdh-encryption "twiss/openpgpjs:fix-ecdh-encryption")

Feb 5, 2019

[Conversation
1](/openpgpjs/openpgpjs/pull/853)
[Commits
4](/openpgpjs/openpgpjs/pull/853/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/853/checks)
[Files changed](/openpgpjs/openpgpjs/pull/853/files)

 Merged

# [Fix ECDH message encryption for some session keys](#top) #853

 Show file tree

 Hide file tree

Changes from **1 commit**

Commits

[Show all changes

4 commits](/openpgpjs/openpgpjs/pull/853/files)
Select commit
Hold shift + click to select a range

[`9954ea4`
Update openpgpjs/elliptic

twiss Feb 4, 2019](/openpgpjs/openpgpjs/pull/853/commits/9954ea4e56a7bb393a16e62ac0fdc5e4ff2ee976)
[`7ba4f8c`
Fix ECDH message encryption for some session keys

twiss Feb 4, 2019](/openpgpjs/openpgpjs/pull/853/commits/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e)
[`6b2f1ed`
Fix async describe() in test suite that always runs

twiss Feb 4, 2019](/openpgpjs/openpgpjs/pull/853/commits/6b2f1ed7b0487d387139acf71099e5c452789b4d)
[`a875d2d`
Specify git commits in package.json

twiss Feb 5, 2019](/openpgpjs/openpgpjs/pull/853/commits/a875d2da043435d9def68faff721ec7b6e573819)

**File filter**

### Filter by extension

Filter by extension

.js
(4)

All 1 file type selected

---

Viewed files

[Clear filters](/openpgpjs/openpgpjs/pull/853/commits/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

* src/crypto

  + src/crypto/crypto.js
    [crypto.js](#diff-6a3254a4cdeb21fb0829a88306c341d1849c9288df487a4e2909191a1b087233)
  + public\_key/elliptic

    - src/crypto/public\_key/elliptic/ecdh.js
      [ecdh.js](#diff-24ef6b4c24786a81013650b6adc305785a26eeb535b59efc971ea1c7789cd1a5)
* test

  + crypto

    - test/crypto/elliptic.js
      [elliptic.js](#diff-9684e84685552e956c69638b29b00daf3c0bb22fc7c8a61baf9ca379784a3a23)
  + general

    - test/general/openpgp.js
      [openpgp.js](#diff-dd238ea97010c9e750ccff6a2331f8ad13426290190981cc77585607f111e4bb)

 [Prev](/openpgpjs/openpgpjs/pull/853/commits/9954ea4e56a7bb393a16e62ac0fdc5e4ff2ee976)Previous commit

 [Next](/openpgpjs/openpgpjs/pull/853/commits/6b2f1ed7b0487d387139acf71099e5c452789b4d)Next commit

Fix ECDH message encryption for some session keys

* Loading branch information

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

[twiss](/openpgpjs/openpgpjs/commits?author=twiss "View all commits by twiss")
committed
Feb 4, 2019

commit 7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e

## There are no files selected for viewing

6 changes: 4 additions & 2 deletions

6
[src/crypto/crypto.js](#diff-6a3254a4cdeb21fb0829a88306c341d1849c9288df487a4e2909191a1b087233 "src/crypto/crypto.js")

Show comments

[View file](/twiss/openpgpjs/blob/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e/src/crypto/crypto.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,7 @@ |
|  |  | /\*\* |
|  |  | \* @fileoverview Provides functions for asymmetric encryption and decryption as |
|  |  | \* well as key generation and parameter handling for all public-key cryptosystems. |
|  |  | \* @requires bn.js |
|  |  | \* @requires crypto/public\_key |
|  |  | \* @requires crypto/cipher |
|  |  | \* @requires crypto/random |
| Expand All | | @@ -32,6 +33,7 @@ |
|  |  | \* @module crypto/crypto |
|  |  | \*/ |
|  |  |  |
|  |  | import BN from 'bn.js'; |
|  |  | import publicKey from './public\_key'; |
|  |  | import cipher from './cipher'; |
|  |  | import random from './random'; |
| Expand Down  Expand Up | | @@ -89,9 +91,9 @@ export default { |
|  |  | const oid = pub\_params[0]; |
|  |  | const Q = pub\_params[1].toUint8Array(); |
|  |  | const kdf\_params = pub\_params[2]; |
|  |  | const res = await publicKey.elliptic.ecdh.encrypt( |
|  |  | const { V, C } = await publicKey.elliptic.ecdh.encrypt( |
|  |  | oid, kdf\_params.cipher, kdf\_params.hash, data, Q, fingerprint); |
|  |  | return constructParams(types, [res.V, res.C]); |
|  |  | return constructParams(types, [new BN(V), C]); |
|  |  | } |
|  |  | default: |
|  |  | return []; |
| Expand Down | |  |

70 changes: 38 additions & 32 deletions

70
[src/crypto/public\_key/elliptic/ecdh.js](#diff-24ef6b4c24786a81013650b6adc305785a26eeb535b59efc971ea1c7789cd1a5 "src/crypto/public_key/elliptic/ecdh.js")

Show comments

[View file](/twiss/openpgpjs/blob/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e/src/crypto/public_key/elliptic/ecdh.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @fileoverview Key encryption and decryption for RFC 6637 ECDH |
|  |  | \* @requires bn.js |
|  |  | \* @requires crypto/public\_key/elliptic/curve |
|  |  | \* @requires crypto/aes\_kw |
|  |  | \* @requires crypto/cipher |
| Expand Down  Expand Up | | @@ -49,10 +50,18 @@ function buildEcdhParam(public\_algo, oid, cipher\_algo, hash\_algo, fingerprint) { |
|  |  | } |
|  |  |  |
|  |  | // Key Derivation Function (RFC 6637) |
|  |  | async function kdf(hash\_algo, X, length, param) { |
|  |  | async function kdf(hash\_algo, S, length, param, curve, compat) { |
|  |  | const len = compat ? |
|  |  | S.byteLength() : |
|  |  | curve.curve.curve.p.byteLength(); |
|  |  | // Note: this is not ideal, but the RFC's are unclear |
|  |  | // https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-02#appendix-B |
|  |  | const X = curve.curve.curve.type === 'mont' ? |
|  |  | S.toArrayLike(Uint8Array, 'le', len) : |
|  |  | S.toArrayLike(Uint8Array, 'be', len); |
|  |  | const digest = await hash.digest(hash\_algo, util.concatUint8Array([ |
|  |  | new Uint8Array([0, 0, 0, 1]), |
|  |  | new Uint8Array(X), |
|  |  | X, |
|  |  | param |
|  |  | ])); |
|  |  | return digest.subarray(0, length); |
| Expand All | | @@ -61,24 +70,17 @@ async function kdf(hash\_algo, X, length, param) { |
|  |  | /\*\* |
|  |  | \* Generate ECDHE ephemeral key and secret from public key |
|  |  | \* |
|  |  | \* @param {module:type/oid} oid Elliptic curve object identifier |
|  |  | \* @param {module:enums.symmetric} cipher\_algo Symmetric cipher to use |
|  |  | \* @param {module:enums.hash} hash\_algo Hash algorithm to use |
|  |  | \* @param {Curve} curve Elliptic curve object |
|  |  | \* @param {Uint8Array} Q Recipient public key |
|  |  | \* @param {String} fingerprint Recipient fingerprint |
|  |  | \* @returns {Promise<{V: Uint8Array, Z: Uint8Array}>} Returns public part of ephemeral key and generated ephemeral secret |
|  |  | \* @returns {Promise<{V: Uint8Array, S: BN}>} Returns public part of ephemeral key and generated ephemeral secret |
|  |  | \* @async |
|  |  | \*/ |
|  |  | async function genPublicEphemeralKey(oid, cipher\_algo, hash\_algo, Q, fingerprint) { |
|  |  | const curve = new Curve(oid); |
|  |  | const param = buildEcdhParam(enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint); |
|  |  | cipher\_algo = enums.read(enums.symmetric, cipher\_algo); |
|  |  | async function genPublicEphemeralKey(curve, Q) { |
|  |  | const v = await curve.genKeyPair(); |
|  |  | Q = curve.keyFromPublic(Q); |
|  |  | const S = v.derive(Q); |
|  |  | const V = new Uint8Array(v.getPublic()); |
|  |  | const Z = await kdf(hash\_algo, S, cipher[cipher\_algo].keySize, param); |
|  |  | return { V, Z }; |
|  |  | const S = v.derive(Q); |
|  |  | return { V, S }; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -94,33 +96,28 @@ async function genPublicEphemeralKey(oid, cipher\_algo, hash\_algo, Q, fingerprint |
|  |  | \* @async |
|  |  | \*/ |
|  |  | async function encrypt(oid, cipher\_algo, hash\_algo, m, Q, fingerprint) { |
|  |  | const { V, Z } = await genPublicEphemeralKey(oid, cipher\_algo, hash\_algo, Q, fingerprint); |
|  |  | return { |
|  |  | V: new BN(V), |
|  |  | C: aes\_kw.wrap(Z, m.toString()) |
|  |  | }; |
|  |  | const curve = new Curve(oid); |
|  |  | const { V, S } = await genPublicEphemeralKey(curve, Q); |
|  |  | const param = buildEcdhParam(enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint); |
|  |  | cipher\_algo = enums.read(enums.symmetric, cipher\_algo); |
|  |  | const Z = await kdf(hash\_algo, S, cipher[cipher\_algo].keySize, param, curve, false); |
|  |  | const C = aes\_kw.wrap(Z, m.toString()); |
|  |  | return { V, C }; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Generate ECDHE secret from private key and public part of ephemeral key |
|  |  | \* |
|  |  | \* @param {module:type/oid} oid Elliptic curve object identifier |
|  |  | \* @param {module:enums.symmetric} cipher\_algo Symmetric cipher to use |
|  |  | \* @param {module:enums.hash} hash\_algo Hash algorithm to use |
|  |  | \* @param {Curve} curve Elliptic curve object |
|  |  | \* @param {Uint8Array} V Public part of ephemeral key |
|  |  | \* @param {Uint8Array} d Recipient private key |
|  |  | \* @param {String} fingerprint Recipient fingerprint |
|  |  | \* @returns {Promise<Uint8Array>} Generated ephemeral secret |
|  |  | \* @returns {Promise<BN>} Generated ephemeral secret |
|  |  | \* @async |
|  |  | \*/ |
|  |  | async function genPrivateEphemeralKey(oid, cipher\_algo, hash\_algo, V, d, fingerprint) { |
|  |  | const curve = new Curve(oid); |
|  |  | const param = buildEcdhParam(enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint); |
|  |  | cipher\_algo = enums.read(enums.symmetric, cipher\_algo); |
|  |  | async function genPrivateEphemeralKey(curve, V, d) { |
|  |  | V = curve.keyFromPublic(V); |
|  |  | d = curve.keyFromPrivate(d); |
|  |  | const S = d.derive(V); |
|  |  | return kdf(hash\_algo, S, cipher[cipher\_algo].keySize, param); |
|  |  | return d.derive(V); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -137,8 +134,17 @@ async function genPrivateEphemeralKey(oid, cipher\_algo, hash\_algo, V, d, fingerp |
|  |  | \* @async |
|  |  | \*/ |
|  |  | async function decrypt(oid, cipher\_algo, hash\_algo, V, C, d, fingerprint) { |
|  |  | const Z = await genPrivateEphemeralKey(oid, cipher\_algo, hash\_algo, V, d, fingerprint); |
|  |  | const curve = new Curve(oid); |
|  |  | const S = await genPrivateEphemeralKey(curve, V, d); |
|  |  | const param = buildEcdhParam(enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint); |
|  |  | cipher\_algo = enums.read(enums.symmetric, cipher\_algo); |
|  |  | try { |
|  |  | const Z = await kdf(hash\_algo, S, cipher[cipher\_algo].keySize, param, curve, false); |
|  |  | return new BN(aes\_kw.unwrap(Z, C)); |
|  |  | } catch(e) {} |
|  |  | // Work around old OpenPGP.js bug. |
|  |  | const Z = await kdf(hash\_algo, S, cipher[cipher\_algo].keySize, param, curve, true); |
|  |  | return new BN(aes\_kw.unwrap(Z, C)); |
|  |  | } |
|  |  |  |
|  |  | export default { encrypt, decrypt, genPublicEphemeralKey, genPrivateEphemeralKey }; |
|  |  | export default { encrypt, decrypt, genPublicEphemeralKey, genPrivateEphemeralKey, buildEcdhParam, kdf }; |

41 changes: 26 additions & 15 deletions

41
[test/crypto/elliptic.js](#diff-9684e84685552e956c69638b29b00daf3c0bb22fc7c8a61baf9ca379784a3a23 "test/crypto/elliptic.js")

Show comments

[View file](/twiss/openpgpjs/blob/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e/test/crypto/elliptic.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -197,10 +197,10 @@ describe('Elliptic Curve Cryptography', async function () { |
|  |  | const curve = new elliptic\_curves.Curve('p256'); |
|  |  | let key1 = curve.keyFromPrivate(key\_data.p256.priv); |
|  |  | let key2 = curve.keyFromPublic(signature\_data.pub); |
|  |  | const shared1 = openpgp.util.Uint8Array\_to\_hex(key1.derive(key2)); |
|  |  | const shared1 = openpgp.util.Uint8Array\_to\_hex(key1.derive(key2).toArrayLike(Uint8Array)); |
|  |  | key1 = curve.keyFromPublic(key\_data.p256.pub); |
|  |  | key2 = curve.keyFromPrivate(signature\_data.priv); |
|  |  | const shared2 = openpgp.util.Uint8Array\_to\_hex(key2.derive(key1)); |
|  |  | const shared2 = openpgp.util.Uint8Array\_to\_hex(key2.derive(key1).toArrayLike(Uint8Array)); |
|  |  | expect(shared1).to.equal(shared2); |
|  |  | done(); |
|  |  | }); |
| Expand Down  Expand Up | | @@ -424,25 +424,36 @@ describe('Elliptic Curve Cryptography', async function () { |
|  |  | async function genPublicEphemeralKey(curve, Q, fingerprint) { |
|  |  | const curveObj = new openpgp.crypto.publicKey.elliptic.Curve(curve); |
|  |  | const oid = new openpgp.OID(curveObj.oid); |
|  |  | return openpgp.crypto.publicKey.elliptic.ecdh.genPublicEphemeralKey( |
|  |  | oid, |
|  |  | curveObj.cipher, |
|  |  | curveObj.hash, |
|  |  | Q, |
|  |  | fingerprint |
|  |  | const { V, S } = await openpgp.crypto.publicKey.elliptic.ecdh.genPublicEphemeralKey( |
|  |  | curveObj, Q |
|  |  | ); |
|  |  | let cipher\_algo = curveObj.cipher; |
|  |  | const hash\_algo = curveObj.hash; |
|  |  | const param = openpgp.crypto.publicKey.elliptic.ecdh.buildEcdhParam( |
|  |  | openpgp.enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint |
|  |  | ); |
|  |  | cipher\_algo = openpgp.enums.read(openpgp.enums.symmetric, cipher\_algo); |
|  |  | const Z = await openpgp.crypto.publicKey.elliptic.ecdh.kdf( |
|  |  | hash\_algo, S, openpgp.crypto.cipher[cipher\_algo].keySize, param, curveObj, false |
|  |  | ); |
|  |  | return { V, Z }; |
|  |  | } |
|  |  | async function genPrivateEphemeralKey(curve, V, d, fingerprint) { |
|  |  | const curveObj = new openpgp.crypto.publicKey.elliptic.Curve(curve); |
|  |  | const oid = new openpgp.OID(curveObj.oid); |
|  |  | return openpgp.crypto.publicKey.elliptic.ecdh.genPrivateEphemeralKey( |
|  |  | oid, |
|  |  | curveObj.cipher, |
|  |  | curveObj.hash, |
|  |  | V, |
|  |  | d, |
|  |  | fingerprint |
|  |  | const S = await openpgp.crypto.publicKey.elliptic.ecdh.genPrivateEphemeralKey( |
|  |  | curveObj, V, d |
|  |  | ); |
|  |  | let cipher\_algo = curveObj.cipher; |
|  |  | const hash\_algo = curveObj.hash; |
|  |  | const param = openpgp.crypto.publicKey.elliptic.ecdh.buildEcdhParam( |
|  |  | openpgp.enums.publicKey.ecdh, oid, cipher\_algo, hash\_algo, fingerprint |
|  |  | ); |
|  |  | cipher\_algo = openpgp.enums.read(openpgp.enums.symmetric, cipher\_algo); |
|  |  | const Z = await openpgp.crypto.publicKey.elliptic.ecdh.kdf( |
|  |  | hash\_algo, S, openpgp.crypto.cipher[cipher\_algo].keySize, param, curveObj, false |
|  |  | ); |
|  |  | return Z; |
|  |  | } |
|  |  | const ECDHE\_VZ1 = await genPublicEphemeralKey("curve25519", Q1, fingerprint1); |
|  |  | const ECDHE\_VZ2 = await genPublicEphemeralKey("curve25519", Q2, fingerprint1); |
| Expand Down | |  |

39 changes: 39 additions & 0 deletions

39
[test/general/openpgp.js](#diff-dd238ea97010c9e750ccff6a2331f8ad13426290190981cc77585607f111e4bb "test/general/openpgp.js")

Show comments

[View file](/twiss/openpgpjs/blob/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e/test/general/openpgp.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -304,6 +304,37 @@ const twoPasswordGPGFail = ['-----BEGIN PGP MESSAGE-----', |
|  |  | '=cHCV', |
|  |  | '-----END PGP MESSAGE-----'].join('\n'); |
|  |  |  |
|  |  | const ecdh\_msg\_bad = `-----BEGIN PGP MESSAGE----- |
|  |  | Version: ProtonMail |
|  |  | Comment: https://protonmail.com |
|  |  |  |
|  |  | wV4DlF328rtCW+wSAQdA9FsAz4rCdoxY/oZaa68WMPMXbO+wtHs4ZXtAOJOs |
|  |  | SlwwDaABXYC2dt0hUS2zRAL3gBGf4udH/CKJ1vPE58sNeh0ERYLxPHgwrpqI |
|  |  | oNVWOWH50kUBIdqd7by8RwLOk9GyV6008iFOlOG90mfjvt2g5DsnSB4wEeMg |
|  |  | pVu3fXj8iAKvFxvihwv1M7gNtP14StP6CngvyGVVEHQ= |
|  |  | =mvcB |
|  |  | -----END PGP MESSAGE-----`; |
|  |  |  |
|  |  | const ecdh\_dec\_key = `-----BEGIN PGP PRIVATE KEY BLOCK----- |
|  |  | Version: OpenPGP.js v4.4.6 |
|  |  | Comment: https://openpgpjs.org |
|  |  |  |
|  |  | xYYEXEBTPxYJKwYBBAHaRw8BAQdAbXBY+2lpOatB+ZLokS/JIWqrVOseja9S |
|  |  | ewQxMKN6ueT+CQMIuUXr0XofC6VgJvFLyLwDlyyvT4I1HWGKZ6W9HUaslKvS |
|  |  | rw362rbMZKKfUtfjRJvpqiIU3Dr7iDkHB5vT7Tp5S7AZ2tNKoh/bwfTKdHsT |
|  |  | 1803InFhX3Rlc3RlcjJAcHJvdG9ubWFpbC5jb20iIDxxYV90ZXN0ZXIyQHBy |
|  |  | b3Rvbm1haWwuY29tPsJ3BBAWCgAfBQJcQFM/BgsJBwgDAgQVCAoCAxYCAQIZ |
|  |  | AQIbAwIeAQAKCRClzcrGJTMHyTpjAQCJZ7p0TJBZyPQ8m64N24glaM6oM78q |
|  |  | 2Ogpc0e9LcrPowD6AssY2YfUwJNzVFVzR+Lulzu6XVPjn0pXGMhOl03SrQ3H |
|  |  | iwRcQFM/EgorBgEEAZdVAQUBAQdAAgJJUhKvjGWMq1sDhrJgvqbHK1t1W5RF |
|  |  | Xoet5noIlAADAQgH/gkDCOFdJ7Yv2cTZYETRT5+ak/ntmslcAqtk3ebd7Ok3 |
|  |  | tQIjO3TYUbkV1eqrpA4I42kGCUkU4Dy26wxuaLRSsO1u/RgXjExZLP9FlWFI |
|  |  | h6lLS1bCYQQYFggACQUCXEBTPwIbDAAKCRClzcrGJTMHyfNBAP9sdyU3GHNR |
|  |  | 7+QdwYvQp7wN+2VUd8vIf7iwAHOK1Cj4ywD+NhzjFfGYESJ68nnkrYlYdf+u |
|  |  | OBqYz6mzZAWQZqsjbg4= |
|  |  | =zrks |
|  |  | -----END PGP PRIVATE KEY BLOCK-----`; |
|  |  |  |
|  |  | function withCompression(tests) { |
|  |  | const compressionTypes = Object.keys(openpgp.enums.compression).map(k => openpgp.enums.compression[k]); |
|  |  |  |
| Expand Down  Expand Up | | @@ -2262,6 +2293,14 @@ describe('[Sauce Labs Group 2] OpenPGP.js public api tests', function() { |
|  |  | expect(decrypted.data).to.equal('Hello world'); |
|  |  | }); |
|  |  |  |
|  |  | it('should decrypt broken ECC message from old OpenPGP.js', async function() { |
|  |  | const { keys: [key] } = await openpgp.key.readArmored(ecdh\_dec\_key); |
|  |  | const message = await openpgp.message.readArmored(ecdh\_msg\_bad); |
|  |  | await key.decrypt('12345'); |
|  |  | const decrypted = await openpgp.decrypt({ message, privateKeys: [key] }); |
|  |  | expect(decrypted.data).to.equal('\n'); |
|  |  | }); |
|  |  |  |
|  |  | }); |
|  |  |  |
|  |  | describe('Errors', function() { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


