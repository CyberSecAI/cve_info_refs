=== Content from gitlab.com_ae3a4221_20250121_010753.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stack buffer overflow in function agclose()

**Tested Environment** : Windows 7/10 (32 bit)

**Command** : bcomps.exe -s -t -v -x -o OUT.ps POC

**POC** : [REPRODUCER](https://raw.githubusercontent.com/SegfaultMasters/covering360/master/Graphviz/SOFGFV)

**DEBUG** :

```
Debug: 0:000> kb
 # ChildEBP RetAddr  Args to Child
00 00c0316c 69e24c98 0125c1e0 00000000 00000080 cdt!dttree+0x9 [graphviz\lib\cdt\dttree.c @ 12]
01 00c0324c 69e19d8d 0125be58 00c034bc 00cffbb8 cgraph!agfstsubg+0x38 [graphviz\lib\cgraph\subg.c @ 74]
02 00c03384 69e19db9 0125be58 00c035f4 00cffbb8 cgraph!agclose+0x9d [graphviz\lib\cgraph\graph.c @ 107]
03 00c034bc 69e19db9 0125b680 00c0372c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
04 00c035f4 69e19db9 0125aea8 00c03864 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
05 00c0372c 69e19db9 0125a6d0 00c0399c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
06 00c03864 69e19db9 01259ef8 00c03ad4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
07 00c0399c 69e19db9 01259720 00c03c0c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
08 00c03ad4 69e19db9 01258f48 00c03d44 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
09 00c03c0c 69e19db9 01258770 00c03e7c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0a 00c03d44 69e19db9 01257f98 00c03fb4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0b 00c03e7c 69e19db9 012577c0 00c040ec 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0c 00c03fb4 69e19db9 01256fe8 00c04224 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0d 00c040ec 69e19db9 01256810 00c0435c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0e 00c04224 69e19db9 01256038 00c04494 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0f 00c0435c 69e19db9 01255860 00c045cc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
10 00c04494 69e19db9 01255088 00c04704 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
11 00c045cc 69e19db9 012548b0 00c0483c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
12 00c04704 69e19db9 012540d8 00c04974 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
13 00c0483c 69e19db9 01253900 00c04aac 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
14 00c04974 69e19db9 01253128 00c04be4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
15 00c04aac 69e19db9 01252950 00c04d1c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
16 00c04be4 69e19db9 01252178 00c04e54 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
17 00c04d1c 69e19db9 012519a0 00c04f8c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
18 00c04e54 69e19db9 012511c8 00c050c4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
19 00c04f8c 69e19db9 012509e8 00c051fc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1a 00c050c4 69e19db9 01250210 00c05334 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1b 00c051fc 69e19db9 0124fa38 00c0546c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1c 00c05334 69e19db9 0124f260 00c055a4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1d 00c0546c 69e19db9 0124ea88 00c056dc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1e 00c055a4 69e19db9 0124e2b0 00c05814 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1f 00c056dc 69e19db9 0124dad8 00c0594c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
20 00c05814 69e19db9 0124d300 00c05a84 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0:000> u
cdt!dttree+0x9 [graphviz\lib\cdt\dttree.c @ 12]:
69df5589 53              push    ebx
69df558a 56              push    esi
69df558b 57              push    edi
69df558c 8dbde4fdffff    lea     edi,[ebp-21Ch]
69df5592 b987000000      mov     ecx,87h
69df5597 b8cccccccc      mov     eax,0CCCCCCCCh
69df559c f3ab            rep stos dword ptr es:[edi]
69df559e a1a0f0df69      mov     eax,dword ptr [cdt!__security_cookie (69dff0a0)]
0:000> .exr -1
ExceptionAddress: 69df5589 (cdt!dttree+0x00000009)
   ExceptionCode: c00000fd (Stack overflow)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 00c02f4c
FAULTING_SOURCE_FILE:  graphviz\cmd\tools\bcomps.c
FAILURE_SYMBOL_NAME:  bcomps.exe!main
FAILURE_BUCKET_ID:  STACK_OVERFLOW_c00000fd_bcomps.exe!main
0:000> g
(834.1350): Stack overflow - code c00000fd (!!! second chance !!!)
Registers:
eax=0125c1e0 ebx=00a69000 ecx=69df5580 edx=0125be58 esi=00c03180 edi=00c0324c
eip=69df5589 esp=00c02f50 ebp=00c0316c iopl=0         nv up ei pl nz na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010206
cdt!dttree+0x9:
69df5589 53              push    ebx

```

Edited Mar 20, 2019 by [Loginsoft Security Research](/Research-Loginsoft)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from research.loginsoft.com_7ae43c36_20250121_010755.html ===
[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22ba452b20ebeb6450c5_Loginsoft%20Logo%20Black.svg)](/)Services[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management](/vulnerability-management-configuration)Threat Research & Intelligence Services[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)Software Supply Chain Security Services[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)Cloud Native Security Services[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science &Â AI](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Development &Â Support](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation](/staff-augmentation)ServicesCybersecurity Solutions[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-management-configuration)SOFTWARE SUPPLY CHAIN SECURITY[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/zero-day-discovery)THREAT RESEARCH & INTELLIGENCE[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/external-attack-surface-discovery)CLOUDÂ NATIVEÂ SECURITY[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science & AI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Dev & Support![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/staff-augmentation)Platforms[LOVI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/lovi)[Cytellite![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cytellite)[Research-as-a-Service](/research-as-a-service)Research[Zero-Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-advisories)[Our Research![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](https://research.loginsoft.com/)Company[Blog![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/blogs)[Reports![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/reports)[Case Studies![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/case-studies)[About us![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/about-us)[Careers![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/careers)[Talk to us](/contact)[Talk to us](/contact)By using this website, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our [Privacy Policy](/privacy-policy) for more information.Accept![Green Plus icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65cde7d5fe78a54970c7984e_Green-Plus.svg)[Home](/)/Research/[Zero Day Discovery](/security-advisories)/CVE-2019-9904: Stack buffer overflow in function agclose() - graphviz
## CVE-2019-9904: Stack buffer overflow in function agclose() - graphviz

Vulnerability ReportsMarch 20, 2019![Profile Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65a91b500b759f07aaa89823_Blog%20Author%20DP%20Placeholder.png)

Jason Franscisco

### Invalid memory access in GfxIndexedColorSpace::mapColorToBase( )

16 March, 2019

##### CVE Number

CVE-2019-9904

##### CWE

CWE-121: Stack-based Buffer Overflow

##### Product Details

Graphviz is open source graph visualization software. It has several main layout programs. See the gallery for sample layouts. It also has web and interactive graphical interfaces, and auxiliary tools, libraries, and language bindings. We're not able to put a lot of work into GUI editors but there are quite a few external projects and even commercial tools that incorporate Graphviz.**URL:**<https://gitlab.com/graphviz/graphviz>

##### Vulnerability Details

During our research we discovered Stack buffer overflow in agclose() located in graph.c for bcomps binary. The same be triggered by sending a crafted pdf file to the pdftops binary. It allows an attacker to cause Denial of Service (Segmentation fault) or possibly have unspecified other impact.

##### SYNOPSIS

we observed that main function calls another function agclose(g) which is defined in graph.c to close a graph or subgraph and freeing its storageIn agclose(), control flow goes to for loop here it calls agclose() function recursively that causes stack Exhaustion.

##### vulnerable Source code

for (subg = agfstsubg(g); subg; subg = next\_subg) { next\_subg = agnxtsubg(subg); agclose(subg); }

##### Analysis

```
 0:000> kb
# ChildEBP RetAddr  Args to Child
00 00c0316c 69e24c98 0125c1e0 00000000 00000080 cdt!dttree+0x9 [graphviz\lib\cdt\dttree.c @ 12]
01 00c0324c 69e19d8d 0125be58 00c034bc 00cffbb8 cgraph!agfstsubg+0x38 [graphviz\lib\cgraph\subg.c @ 74]
02 00c03384 69e19db9 0125be58 00c035f4 00cffbb8 cgraph!agclose+0x9d [graphviz\lib\cgraph\graph.c @ 107]
03 00c034bc 69e19db9 0125b680 00c0372c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
04 00c035f4 69e19db9 0125aea8 00c03864 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
05 00c0372c 69e19db9 0125a6d0 00c0399c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
06 00c03864 69e19db9 01259ef8 00c03ad4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
07 00c0399c 69e19db9 01259720 00c03c0c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
08 00c03ad4 69e19db9 01258f48 00c03d44 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
09 00c03c0c 69e19db9 01258770 00c03e7c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0a 00c03d44 69e19db9 01257f98 00c03fb4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0b 00c03e7c 69e19db9 012577c0 00c040ec 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0c 00c03fb4 69e19db9 01256fe8 00c04224 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0d 00c040ec 69e19db9 01256810 00c0435c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0e 00c04224 69e19db9 01256038 00c04494 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0f 00c0435c 69e19db9 01255860 00c045cc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
10 00c04494 69e19db9 01255088 00c04704 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
11 00c045cc 69e19db9 012548b0 00c0483c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
12 00c04704 69e19db9 012540d8 00c04974 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
13 00c0483c 69e19db9 01253900 00c04aac 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
14 00c04974 69e19db9 01253128 00c04be4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
15 00c04aac 69e19db9 01252950 00c04d1c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
16 00c04be4 69e19db9 01252178 00c04e54 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
17 00c04d1c 69e19db9 012519a0 00c04f8c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
18 00c04e54 69e19db9 012511c8 00c050c4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
19 00c04f8c 69e19db9 012509e8 00c051fc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1a 00c050c4 69e19db9 01250210 00c05334 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1b 00c051fc 69e19db9 0124fa38 00c0546c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1c 00c05334 69e19db9 0124f260 00c055a4 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1d 00c0546c 69e19db9 0124ea88 00c056dc 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1e 00c055a4 69e19db9 0124e2b0 00c05814 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
1f 00c056dc 69e19db9 0124dad8 00c0594c 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
20 00c05814 69e19db9 0124d300 00c05a84 00cffbb8 cgraph!agclose+0xc9 [graphviz\lib\cgraph\graph.c @ 109]
0:000> u
cdt!dttree+0x9 [graphviz\lib\cdt\dttree.c @ 12]:
69df5589 53              push    ebx
69df558a 56              push    esi
69df558b 57              push    edi
69df558c 8dbde4fdffff    lea     edi,[ebp-21Ch]
69df5592 b987000000      mov     ecx,87h
69df5597 b8cccccccc      mov     eax,0CCCCCCCCh
69df559c f3ab            rep stos dword ptr es:[edi]
69df559e a1a0f0df69      mov     eax,dword ptr [cdt!__security_cookie (69dff0a0)]
0:000> .exr -1
ExceptionAddress: 69df5589 (cdt!dttree+0x00000009)
   ExceptionCode: c00000fd (Stack overflow)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 00c02f4c
FAULTING_SOURCE_FILE:  graphviz\cmd\tools\bcomps.c
FAILURE_SYMBOL_NAME:  bcomps.exe!main
FAILURE_BUCKET_ID:  STACK_OVERFLOW_c00000fd_bcomps.exe!main
0:000> g
(834.1350): Stack overflow - code c00000fd (!!! second chance !!!)
Registers:
eax=0125c1e0 ebx=00a69000 ecx=69df5580 edx=0125be58 esi=00c03180 edi=00c0324c
eip=69df5589 esp=00c02f50 ebp=00c0316c iopl=0         nv up ei pl nz na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010206
cdt!dttree+0x9:
69df5589 53              push    ebx
```

##### Proof of Concept

`bcomps.exe -s -t -v -x -o test.ps $POC`Tested Environment : Windows 7/10 (32-bit)
â

##### Timeline

Vendor Disclosure: 2019-3-16

Public Disclosure: 2019-3-21

##### Credit

Discovered by ACE Team - Loginsoft

Explore Cybersecurity Platforms

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros.

Discover Lovi
## Sign up to our Newsletter

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Cybersecurity Solutions[Vulnerability Intelligence](/vulnerability-intelligence)[Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[Vulnerability & Configuration Management](/vulnerability-management-configuration)[OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[OSS - Dependancy Defence](/software-supply-chain-security/dependency-defense)[OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)[Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)[Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[Data Science &Â AI](/data-science-and-ai)[Software Development Â & Support](/software-development-and-support)[QA Automation](/qa-automation)[Staff Augmentation](/staff-augmentation)Platforms[LOVI](/lovi)[Cytellite](/cytellite)Company[Blogs](/blogs)[Reports](/reports)[About us](/about-us)[Careers](/careers)Research[Research-as-a -Service](/research-as-a-service)[Zero-Day Discovery](/security-advisories)![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22b99ceecda456b052cd_Loginsoft%20Logo%20White.svg)1-703-956-7410info@loginsoft.com[![Linkedin Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d02956967bd81ab620_LinkedIn.svg)](https://www.linkedin.com/company/loginsoft/)[![X icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d0e8e8f3e5866a563b_X.svg)](https://twitter.com/Loginsoft_Inc)[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b8dafdc42d3397ec72e17c_github-mark-white%201.svg)](https://github.com/Loginsoft-Research)Â© 2024 - Copyright[Privacy policy](/privacy-policy)

![](https://px.ads.linkedin.com/collect/?pid=562737&fmt=gif)



=== Content from cdn.prod.website-files.com_5a36c2ef_20250121_031618.html ===




=== Content from security.gentoo.org_9d7cb9ec_20250121_010755.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Graphviz: Multiple vulnerabilities — GLSA **202107-04**

Multiple vulnerabilities have been found in Graphviz, the worst of
which could result in the arbitrary execution of code.

### Affected packages

| Package | **media-gfx/graphviz** on all architectures |
| --- | --- |
| Affected versions | < **2.47.1** |
| Unaffected versions | >= **2.47.1** |

### Background

Graphviz is an open source graph visualization software.

### Description

Multiple vulnerabilities have been discovered in Graphviz. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to process a specially crafted
file using Graphviz, possibly resulting in execution of arbitrary code
with the privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All Graphviz users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-gfx/graphviz-2.47.1"

```
### References

* [CVE-2019-9904](https://nvd.nist.gov/vuln/detail/CVE-2019-9904)
* [CVE-2020-18032](https://nvd.nist.gov/vuln/detail/CVE-2020-18032)

**Release date**

July 03, 2021

**Latest revision**

July 03, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [684844](https://bugs.gentoo.org/show_bug.cgi?id=684844)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


