=== Content from wiki.mozilla.org_73f8d6fa_20250121_013835.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_35fd2cf6_20250120_233300.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-15

## Security vulnerabilities fixed in Thunderbird 60.7

Announced
May 21, 2019
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 60.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2019-9815: Disable hyperthreading on content JavaScript threads on macOS](#CVE-2019-9815)

Reporter
[Multiple independent researchers](https://mdsattacks.com/#People)
Impact
high
##### Description

If hyperthreading is not disabled, a timing attack vulnerability exists, similar to previous Spectre attacks. Apple has shipped macOS 10.14.5 with an option to disable hyperthreading in applications running untrusted code in a thread through a new sysctl. Firefox now makes use of it on the main thread and any worker threads.
*Note: users need to update to macOS 10.14.5 in order to take advantage of this change.*

##### References

* [Bug 1546544](https://bugzilla.mozilla.org/show_bug.cgi?id=1546544)
* [RIDL and Fallout: MDS attacks](https://mdsattacks.com/)

#### [#CVE-2019-9816: Type confusion with object groups and UnboxedObjects](#CVE-2019-9816)

Reporter
Samuel Groß of Google Project Zero
Impact
high
##### Description

A possible vulnerability exists where type confusion can occur when manipulating JavaScript objects in object groups, allowing for the bypassing of security checks within these groups.
*Note: this vulnerability has only been demonstrated with `UnboxedObjects`, which are disabled by default on all supported releases.*

##### References

* [Bug 1536768](https://bugzilla.mozilla.org/show_bug.cgi?id=1536768)

#### [#CVE-2019-9817: Stealing of cross-domain images using canvas](#CVE-2019-9817)

Reporter
Luật Nguyễn
Impact
high
##### Description

Images from a different domain can be read using a canvas object in some circumstances. This could be used to steal image data from a different site in violation of same-origin policy.

##### References

* [Bug 1540221](https://bugzilla.mozilla.org/show_bug.cgi?id=1540221)

#### [#CVE-2019-9818: Use-after-free in crash generation server](#CVE-2019-9818)

Reporter
Thomas Imbert
Impact
high
##### Description

A race condition is present in the crash generation server used to generate data for the crash reporter. This issue can lead to a use-after-free in the main process, resulting in a potentially exploitable crash and a sandbox escape.
*Note: this vulnerability only affects Windows. Other operating systems are unaffected.*

##### References

* [Bug 1542581](https://bugzilla.mozilla.org/show_bug.cgi?id=1542581)

#### [#CVE-2019-9819: Compartment mismatch with fetch API](#CVE-2019-9819)

Reporter
Nils
Impact
high
##### Description

A vulnerability where a JavaScript compartment mismatch can occur while working with the `fetch` API, resulting in a potentially exploitable crash.

##### References

* [Bug 1532553](https://bugzilla.mozilla.org/show_bug.cgi?id=1532553)

#### [#CVE-2019-9820: Use-after-free of ChromeEventHandler by DocShell](#CVE-2019-9820)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in the chrome event handler when it is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1536405](https://bugzilla.mozilla.org/show_bug.cgi?id=1536405)

#### [#CVE-2019-11691: Use-after-free in XMLHttpRequest](#CVE-2019-11691)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when working with `XMLHttpRequest` (XHR) in an event loop, causing the XHR main thread to be called after it has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1542465](https://bugzilla.mozilla.org/show_bug.cgi?id=1542465)

#### [#CVE-2019-11692: Use-after-free removing listeners in the event listener manager](#CVE-2019-11692)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when listeners are removed from the event listener manager while still in use, resulting in a potentially exploitable crash.

##### References

* [Bug 1544670](https://bugzilla.mozilla.org/show_bug.cgi?id=1544670)

#### [#CVE-2019-11693: Buffer overflow in WebGL bufferdata on Linux](#CVE-2019-11693)

Reporter
crixer
Impact
high
##### Description

The `bufferdata` function in WebGL is vulnerable to a buffer overflow with specific graphics drivers on Linux. This could result in malicious content freezing a tab or triggering a potentially exploitable crash.
*Note: this issue only occurs on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1532525](https://bugzilla.mozilla.org/show_bug.cgi?id=1532525)

#### [#CVE-2019-7317: Use-after-free in png\_image\_free of libpng library](#CVE-2019-7317)

Reporter
OSS-Fuzz, Eddie Lee
Impact
high
##### Description

A use-after-free vulnerability was discovered in the `png_image_free` function in the libpng library. This could lead to denial of service or a potentially exploitable crash when a malformed image is processed.

##### References

* [Bug 1542829](https://bugzilla.mozilla.org/show_bug.cgi?id=1542829)

#### [#CVE-2019-9797: Cross-origin theft of images with createImageBitmap](#CVE-2019-9797)

Reporter
AaylaSecura1138
Impact
high
##### Description

Cross-origin images can be read in violation of the same-origin policy by exporting an image after using `createImageBitmap` to read the image and then rendering the resulting bitmap image within a `canvas` element.

##### References

* [Bug 1528909](https://bugzilla.mozilla.org/show_bug.cgi?id=1528909)

#### [#CVE-2018-18511: Cross-origin theft of images with ImageBitmapRenderingContext](#CVE-2018-18511)

Reporter
AaylaSecura1138
Impact
high
##### Description

Cross-origin images can be read from a `canvas` element in violation of the same-origin policy using the `transferFromImageBitmap` method.

##### References

* [Bug 1526218](https://bugzilla.mozilla.org/show_bug.cgi?id=1526218)

#### [#CVE-2019-11694: Uninitialized memory memory leakage in Windows sandbox](#CVE-2019-11694)

Reporter
Jeremy Fetiveau of SSD Secure Disclosure
Impact
moderate
##### Description

A vulnerability exists in the Windows sandbox where an uninitialized value in memory can be leaked to a renderer from a broker when making a call to access an otherwise unavailable file. This results in the potential leaking of information stored at that memory location.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1534196](https://bugzilla.mozilla.org/show_bug.cgi?id=1534196)

#### [#CVE-2019-11698: Theft of user history data through drag and drop of hyperlinks to and from bookmarks](#CVE-2019-11698)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a crafted hyperlink is dragged and dropped to the bookmark bar or sidebar and the resulting bookmark is subsequently dragged and dropped into the web content area, an arbitrary query of a user's browser history can be run and transmitted to the content page via `drop` event data. This allows for the theft of browser history by a malicious site.

##### References

* [Bug 1543191](https://bugzilla.mozilla.org/show_bug.cgi?id=1543191)

#### [#CVE-2019-5798: Out-of-bounds read in Skia](#CVE-2019-5798)

Reporter
Tran Tien Hung of Viettel Cyber Security
Impact
moderate
##### Description

An out-of-bounds read can occur in the Skia library during path transformations. This could result in the exposure of data stored in memory.

##### References

* [Bug 1535518](https://bugzilla.mozilla.org/show_bug.cgi?id=1535518)

#### [#CVE-2019-9800: Memory safety bugs fixed in Firefox 67, Firefox ESR 60.7, and Thunderbird 60.7](#CVE-2019-9800)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Bogdan Tara, Jan de Mooij, Jason Kratzer, Jan Varga, Gary Kwong, Tim Guan-tin Chien, Tyson Smith, Ronald Crane, and Ted Campbell reported memory safety bugs present in Firefox 66, Firefox ESR 60.6, and Thunderbird 60.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67, Firefox ESR 60.7, and Thunderbird 60.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540166%2C1534593%2C1546327%2C1540136%2C1538736%2C1538042%2C1535612%2C1499719%2C1499108%2C1538619%2C1535194%2C1516325%2C1542324%2C1542097%2C1532465%2C1533554%2C1541580)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_3659d679_20250121_013836.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_98869d99_20250121_013838.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1536768)
* [XML](/show_bug.cgi?ctype=xml&id=1536768)

Closed
[Bug 1536768](/show_bug.cgi?id=1536768)
(CVE-2019-9816)

Opened 6 years ago
Closed 6 years ago

# IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed

## Categories

### (Core :: JavaScript Engine: JIT, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

66 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla68

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | [67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) |
| firefox66 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix) |
| firefox67 | [+](/buglist.cgi?f1=cf_tracking_firefox67&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed) |
| firefox68 | [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 | 67+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox66 |  | wontfix |
| firefox67 | + | fixed |
| firefox68 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: saelo, Assigned: mgaudet)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0c4c6c72545e010e29e8da0e3bb229ee?d=mm&size=40)  [mgaudet](/user_profile?user_id=607045)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/dd173269d2ae1dd60942eeb75caaef98?d=mm&size=40)  [saelo](/user_profile?user_id=634439)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

### ( [URL](https://bugs.chromium.org/p/project-zero/issues/detail?id=1808 "https://bugs.chromium.org/p/project-zero/issues/detail?id=1808") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugs.chromium.org/p/project-zero/issu...](https://bugs.chromium.org/p/project-zero/issues/detail?id=1808 "https://bugs.chromium.org/p/project-zero/issues/detail?id=1808")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [adv-main67+][adv-esr60.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-9816

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main67+][adv-esr60.7+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem](/attachment.cgi?id=9054337)  [6 years ago](#c4)  [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)   47 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c13 "6 years ago")  lizzard : [approval-mozilla-esr60+](#c15 "6 years ago")  abillings : [sec-approval+](#c9 "6 years ago") | [Details](/attachment.cgi?id=9054337&action=edit) | [Review](/attachment.cgi?id=9054337) |
| --- | --- | --- |
| [Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem](/attachment.cgi?id=9054583)  [6 years ago](#c6)  [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)   47 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#a1716115_24572 "6 years ago")  lizzard : [approval-mozilla-esr60+](#a2278018_451704 "6 years ago")  abillings : [sec-approval+](#a1168648_280903 "6 years ago") | [Details](/attachment.cgi?id=9054583&action=edit) | [Review](/attachment.cgi?id=9054583) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Samuel Groß](/user_profile?user_id=634439)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1536768#c0)• 6 years ago |
|  | |

While fuzzing Spidermonkey, I encountered the following (commented and modified) JavaScript program which crashes debug builds of the latest release version of Spidermonkey (from commit [3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c](https://github.com/mozilla/gecko-dev/commit/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c)):

```
function O1() {
    this.s = 'foobar';
    this.a = 42;

    // Avoid unboxed layout for O1 instances as this will cause the JIT
    // compiler to behave differently and not emit the ObjectGroupDispatch
    // operation (see below).
    delete this.a;
}

// This function will be inlined below in v4, together with the default
// Object.prototype.toString implementation.
// This just demonstrates that a custom function can be inlined which
// will make assumptions about the input ObjectGroup.
O1.prototype.toString = function() {
    return this.s;
};

function v4(v5) {
    // Once v22 is allocated as unboxed object, this will convert it to a
    // native object, which will cause its ObjectGroup to change.
    delete v5.nonExistent;

    // The call to .toString here will be implemented as a switch
    // (ObjectGroupDispatch operation) on the ObjectGroup with two cases
    // (ObjectGroup of v22 and v17). Depending on the input, the dispatch will
    // jump to one of the two inlined implementations of toString. However,
    // after v22 is allocated as UnboxedObject (still with the same
    // ObjectGroup as before), the delete operation above will convert it back
    // to a NativeObject, now changing the ObjectGroup. Afterwards, this
    // ObjectGroupDispatch operation will see an unexpected ObjectGroup and,
    // in debug builds, crash with an assertion failure. In release builds
    // it will just fallthrough to whichever branch was emitted right after
    // the dispatch operation.
    return v5.toString();
}

function v11() {
    const v22 = {p: 1337};
    v4(v22);

    let v26 = 0;
    do {
        const v17 = new O1;
        v4(v17);
        v26++;
    } while (v26 < 100);
}
for (let v33 = 0; v33 < 100; v33++) {
    const v37 = v11();
}

```

The program will crash with an assertion similar to:

```
> ../build_DBG.OBJ/dist/bin/js crash.js
Assertion failure: Unexpected ObjectGroup, at js/src/jit/MacroAssembler.cpp:2014
[1]    54116 trace trap  ../build_DBG.OBJ/dist/bin/js crash.js

```

It appears that roughly the following is happening here:

* Initially, the objects v22 and v17 will be allocated as native objects with two different ObjectGroups (an ObjectGroup [1] stores type information such as the prototype object and property/method types for an object): OG1 and OG2.
* Function v4 will be called repeatedly with objects of both ObjectGroups and will eventually be JIT compiled by IonMonkey. At that point, it will be compiled to expect an object with ObjectGroup OG1 or OG2 based on type feedback from the interpreter/baseline JIT and will be deoptimized if it is ever called with an object of a different group.
* The call to .toString in v4 will be optimized by inlining [2] the two possible implementations (O1.prototype.toString and Object.prototype.toString) and then performing a switch on the ObjectGroup of the input to determine which implementation to jump to. The switch is implemented by the ObjectGroupDispatch operation. Since both input ObjectGroups are covered, the instruction does not have a default (fallback) path [3].
* At a later point, the allocation site of v22 is modified to create an object with unboxed layout [4] which will store its properties inline in an unboxed form but still use ObjectGroup OG1.
* Afterwards, in the JIT code for v4, the delete operation converts the UnboxedObject back to a NativeObject [5], this time changing the ObjectGroup to a new group OG3 [6].
* Finally, when executing the machine code for the ObjectGroupDispatch operation, the new ObjectGroup matches none of the expected ones. At this point the program will crash with an assertion in debug builds. In release builds, it would now simply fall through to whichever one of the inlined implementations was directly following the ObjectGroupDispatch operation.

At least this way of triggering the bug is related to UnboxedObjects, which [have recently been disabled by default](https://github.com/mozilla/gecko-dev/commit/26965039e60a00b3600ce2e6a559106e4a3a30ca). However, I am not sure if the conversion from unboxed to native objects due to the property deletion is the only reason that an object's ObjectGroup can change unexpectedly (in this situation).

As for exploitation, it might be possible to cause a type confusion by causing a fallthrough to the inlined code for the other ObjectGroup. In that case, the inlined code would expect to receive an object of a specific ObjectGroup and might omit further security checks based on that. For this specific sample it seems that the fallthrough path always happens to be the correct one (i.e. the one for Object.prototype.toString), but I assume it could also be the other way around in a different context. Furthermore, it might be possible to cause other code constructs (apart form the ObjectGroupDispatch) that rely on ObjectGroup information to misbehave in this situation.

Please note: this bug is subject to a 90 day disclosure deadline. After 90 days elapse or a patch has been made broadly available (whichever is earlier), the bug report will become visible to the public.

With any fix, please give credit for identifying the vulnerability to Samuel Groß of Google Project Zero.

[1] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/vm/ObjectGroup.h#L87>

[2] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/jit/IonBuilder.cpp#L4517>

[3] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/jit/IonBuilder.cpp#L4923>

[4] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/vm/UnboxedObject.cpp#L1416>

[5] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/vm/UnboxedObject.cpp#L1150>

[6] <https://github.com/mozilla/gecko-dev/blob/3ecf89da497cf1abe2a89d1b3c282b48e5dfac8c/js/src/vm/UnboxedObject.cpp#L756>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a3018_159069)• 6 years ago |

Group: firefox-core-security → javascript-core-securityComponent: General → JavaScript Engine: JITProduct: Firefox → Core

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1536768#c1)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1536768&comment_id=13998414 "1 revision") |
|  | |

Thanks for the report. We have to check if there's a way to trigger this without unboxed objects. Maybe `__proto__` mutation.

Regardless, ObjectGroupDispatch is complicated enough that we should probably have it crash in release builds too when it sees an unexpected group.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a106756_406194)• 6 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1536768#c2)• 6 years ago |
|  | |

Matthew, you might have the fresh-est knowledge about this part of the code. Mind to have a look and forwarding to the right person or taking it?

Status: UNCONFIRMED → NEW
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected)Ever confirmed: trueFlags: needinfo?(mgaudet)Priority: -- → P1

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1536768#c3)• 6 years ago |
|  | |

Ok, I'll spend today looking at this. At the bare minimum I'll produce a patch to crash on an unexpected group in `ObjectGroupDispatch`.

Flags: needinfo?(mgaudet)

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1536768#c4)• 6 years ago |
|  | |

Attached file
[Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem](attachment.cgi?id=9054337)
— [Details](attachment.cgi?id=9054337&action=edit)

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1536768#c5)• 6 years ago |
|  | |

## Investigation into other group change mechanisms

*tldr;* I can't prove this is unexploitable outside of UnboxedObjects, due to my unfamiliarity with edge cases of group changes. It seems generally to be an excellent idea to assert in ObjectGroupDispatch. However, I was unable to generate an exploitable test case from attempting to trigger group changes through other mechanisms.

In order for this to be exploitable outside UnboxedObjects we would need to find a way to change the group of an object in such a way that we don't trigger bailout or invalidation, as was the case of the UnboxedLayout bug described in this bug.

First, let's look at [the callers of `setGroup()`](https://searchfox.org/mozilla-central/search?q=symbol:_ZN8JSObject8setGroupEPN2js11ObjectGroupE&redirect=false). These callers can be divided into roughly three categories:

1. *Allocation*: These calls to setGroup apply only to newly created objects; *e.g.* `js::MapIteratorObject::createResultPair`, `js::NewArrayOperationWithTemplate`.
2. *Partially Initialized -> Fully initialized*: This would be the transition that occurs in [`UpdateShapeTypeAndValue`](https://searchfox.org/mozilla-central/rev/ddd1679c0534f7ddf36cafddd17b710c4fefe3c4/js/src/vm/NativeObject.cpp#1202). This happens when an objects transitions into its final 'initialized' shape, and the group is changed from a partially-initalized group to a final group.

   I was unable to determine how the boundaries of the "new script" range are determined, so I was unable to experiment with these group transitions.
3. *Singleton-ification*: `JSObject::setSingleton` and `JSObject::changeToSingleton` modify the group. This seems relatively controlled.
4. *Prototype Modification*: or `SetProto`.

The most promising in terms of exploitability seems to be prototype mutation. However, in my experiments, I was unable to trigger a situation where prototype mutation did not in turn invalidate or bailout from Ion.

### Caveats:

There are aspects I haven't investigated that might be cause for concern: While I think that this is *most likely* to be exploitable by trying to change the group of an object in an Ion frame without triggering bailout, it is possible that there are other ways that type barriers can be missed leading to an `ObjectGroupDispatch`. I didn't really investigate them.

### Final Comment

This was not a comprehensive audit: I don't feel like I am qualified to give an overarching recommendation about potential exploitability of this bug, as it sits at the corner of a number of things I have a weak knowledge of: Type Barriers, group mutation, and Ion's guard invariants.

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1536768#c6)• 6 years ago |
|  | |

Attached file
[Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem](attachment.cgi?id=9054583)
— [Details](attachment.cgi?id=9054583&action=edit)

Depends on D25304

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1536768#c7)• 6 years ago |
|  | |

Jan requested I also check the completeness of FunctionDispatch; see above patch.

This change has the potential to cause crashes where we formerly wouldn't have: I'm not sure if we want to subject this patch to some fuzzing before we land it?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a1072940_75935)• 6 years ago |

Assignee: nobody → mgaudet
[status-firefox66](/buglist.cgi?f1=cf_status_firefox66&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix)
[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox67](/buglist.cgi?f1=cf_tracking_firefox67&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox67&o1=equals&v1=%2B)
[tracking-firefox68](/buglist.cgi?f1=cf_tracking_firefox68&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B)

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1536768#c8)• 6 years ago |
|  | |

Comment on [attachment 9054337](/attachment.cgi?id=9054337 "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") [[details]](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem")

[Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r?jandem

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It would be difficult.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All, if UnboxedObjects were enabled, however, we disabled them by default on all supported branches already
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1116855](/show_bug.cgi?id=1116855 "RESOLVED FIXED - Allow creating unboxed objects in interpreted constructors")
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: They should be easy to do.
* **How likely is this patch to cause regressions; how much testing does it need?**: It's possible that this could create crashes where we were silently experiencing a vulnerability (and potentially incorrect execution).
[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: sec-approval?

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a1137731_607045)• 6 years ago |

[Attachment #9054583](/attachment.cgi?id=9054583&action=edit "Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1536768#c9)• 6 years ago |
|  | |

Comment on [attachment 9054337](/attachment.cgi?id=9054337 "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") [[details]](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem")

[Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r?jandem

Sec-approval+ for mozilla-central. Please nominate ESR60 and Beta patches as well.

[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a1168648_280903)• 6 years ago |

[Attachment #9054583](/attachment.cgi?id=9054583&action=edit "Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem") -
Flags: sec-approval? → sec-approval+

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1536768#c10)• 6 years ago |
|  | |

Comment on [attachment 9054337](/attachment.cgi?id=9054337 "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") [[details]](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem")

[Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r?jandem

### Beta/Release Uplift Approval Request

* **Feature/Bug causing the regression**: [Bug 1116855](/show_bug.cgi?id=1116855 "RESOLVED FIXED - Allow creating unboxed objects in interpreted constructors")
* **User impact if declined**: Potential security issue
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It's possible that this could create crashes where we were silently experiencing a vulnerability (and potentially incorrect execution).
* **String changes made/needed**: None

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potential security issue
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It's possible that this could create crashes where we were silently experiencing a vulnerability (and potentially incorrect execution).
* **String or UUID changes made by this patch**: None
[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: approval-mozilla-esr60?
[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: approval-mozilla-beta?

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a1219206_607045)• 6 years ago |

[Attachment #9054583](/attachment.cgi?id=9054583&action=edit "Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem") -
Flags: approval-mozilla-esr60? approval-mozilla-beta?

|  | [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1536768#c11)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1536768&comment_id=14030464 "1 revision") |
|  | |

Landed on autoland:

<https://hg.mozilla.org/integration/autoland/rev/8f07c3939286> - [Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r=jandem

<https://hg.mozilla.org/integration/autoland/rev/c22855eae212> - [Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of FunctionDispatch without fallbacks r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1536768#c12)• 6 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/8f07c3939286>

<https://hg.mozilla.org/mozilla-central/rev/c22855eae212>

Group: javascript-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 6 years ago
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla68

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1536768#c13)• 6 years ago |
|  | |

Comment on [attachment 9054337](/attachment.cgi?id=9054337 "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") [[details]](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem")

[Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r?jandem

Approved for 67 beta 10, thanks.

[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a1716115_24572)• 6 years ago |

[Attachment #9054583](/attachment.cgi?id=9054583&action=edit "Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1536768#c14)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/b4fc373023df>

<https://hg.mozilla.org/releases/mozilla-beta/rev/8f151985cb7f>

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1536768#c15)• 6 years ago |
|  | |

Comment on [attachment 9054337](/attachment.cgi?id=9054337 "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") [[details]](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem")

[Bug 1536768](/show_bug.cgi?id=1536768 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed") - Check completeness of ObjectGroupDispatch in opt builds r?jandem

Fix for sec-high issue, let's take it for ESR 60.7.

[Attachment #9054337](/attachment.cgi?id=9054337&action=edit "Bug 1536768 - Check completeness of ObjectGroupDispatch in opt builds r?jandem") -
Flags: approval-mozilla-esr60? → approval-mozilla-esr60+

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a2278018_451704)• 6 years ago |

[Attachment #9054583](/attachment.cgi?id=9054583&action=edit "Bug 1536768 - Check completeness of FunctionDispatch without fallbacks r?jandem") -
Flags: approval-mozilla-esr60? → approval-mozilla-esr60+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1536768#c16)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/303fa85d8f89>

<https://hg.mozilla.org/releases/mozilla-esr60/rev/c9328455c9c1>

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a4111218_280903)• 6 years ago |

Whiteboard: [adv-main67+][adv-esr60.7+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a4708218_280903)• 6 years ago |

Alias: CVE-2019-9816

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1536768#c17)• 6 years ago |
|  | |

The Project Zero report on this (which looks to be the same as [comment 0](/show_bug.cgi?id=1536768#c0 "RESOLVED FIXED - IonMonkey: unexpected ObjectGroup in ObjectGroupDispatch operation might lead to potentially unsafe code being executed")) is public now.

URL: [https://bugs.chromium.org/p/project-z...](https://bugs.chromium.org/p/project-zero/issues/detail?id=1808)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536768#a38258914_1689)• 5 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1536768&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Matthew Gaudet (he/him) [:mgaudet]](/user_profile?user_id=607045)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ca3e0273_20250120_233300.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-14

## Security vulnerabilities fixed in Firefox ESR 60.7

Announced
May 21, 2019
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 60.7

#### [#CVE-2019-9815: Disable hyperthreading on content JavaScript threads on macOS](#CVE-2019-9815)

Reporter
[Multiple independent researchers](https://mdsattacks.com/#People)
Impact
high
##### Description

If hyperthreading is not disabled, a timing attack vulnerability exists, similar to previous Spectre attacks. Apple has shipped macOS 10.14.5 with an option to disable hyperthreading in applications running untrusted code in a thread through a new sysctl. Firefox now makes use of it on the main thread and any worker threads.
*Note: users need to update to macOS 10.14.5 in order to take advantage of this change.*

##### References

* [Bug 1546544](https://bugzilla.mozilla.org/show_bug.cgi?id=1546544)
* [RIDL and Fallout: MDS attacks](https://mdsattacks.com/)

#### [#CVE-2019-9816: Type confusion with object groups and UnboxedObjects](#CVE-2019-9816)

Reporter
Samuel Groß of Google Project Zero
Impact
high
##### Description

A possible vulnerability exists where type confusion can occur when manipulating JavaScript objects in object groups, allowing for the bypassing of security checks within these groups.
*Note: this vulnerability has only been demonstrated with `UnboxedObjects`, which are disabled by default on all supported releases.*

##### References

* [Bug 1536768](https://bugzilla.mozilla.org/show_bug.cgi?id=1536768)

#### [#CVE-2019-9817: Stealing of cross-domain images using canvas](#CVE-2019-9817)

Reporter
Luật Nguyễn
Impact
high
##### Description

Images from a different domain can be read using a canvas object in some circumstances. This could be used to steal image data from a different site in violation of same-origin policy.

##### References

* [Bug 1540221](https://bugzilla.mozilla.org/show_bug.cgi?id=1540221)

#### [#CVE-2019-9818: Use-after-free in crash generation server](#CVE-2019-9818)

Reporter
Thomas Imbert
Impact
high
##### Description

A race condition is present in the crash generation server used to generate data for the crash reporter. This issue can lead to a use-after-free in the main process, resulting in a potentially exploitable crash and a sandbox escape.
*Note: this vulnerability only affects Windows. Other operating systems are unaffected.*

##### References

* [Bug 1542581](https://bugzilla.mozilla.org/show_bug.cgi?id=1542581)

#### [#CVE-2019-9819: Compartment mismatch with fetch API](#CVE-2019-9819)

Reporter
Nils
Impact
high
##### Description

A vulnerability where a JavaScript compartment mismatch can occur while working with the `fetch` API, resulting in a potentially exploitable crash.

##### References

* [Bug 1532553](https://bugzilla.mozilla.org/show_bug.cgi?id=1532553)

#### [#CVE-2019-9820: Use-after-free of ChromeEventHandler by DocShell](#CVE-2019-9820)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in the chrome event handler when it is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1536405](https://bugzilla.mozilla.org/show_bug.cgi?id=1536405)

#### [#CVE-2019-11691: Use-after-free in XMLHttpRequest](#CVE-2019-11691)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when working with `XMLHttpRequest` (XHR) in an event loop, causing the XHR main thread to be called after it has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1542465](https://bugzilla.mozilla.org/show_bug.cgi?id=1542465)

#### [#CVE-2019-11692: Use-after-free removing listeners in the event listener manager](#CVE-2019-11692)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when listeners are removed from the event listener manager while still in use, resulting in a potentially exploitable crash.

##### References

* [Bug 1544670](https://bugzilla.mozilla.org/show_bug.cgi?id=1544670)

#### [#CVE-2019-11693: Buffer overflow in WebGL bufferdata on Linux](#CVE-2019-11693)

Reporter
crixer
Impact
high
##### Description

The `bufferdata` function in WebGL is vulnerable to a buffer overflow with specific graphics drivers on Linux. This could result in malicious content freezing a tab or triggering a potentially exploitable crash.
*Note: this issue only occurs on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1532525](https://bugzilla.mozilla.org/show_bug.cgi?id=1532525)

#### [#CVE-2019-7317: Use-after-free in png\_image\_free of libpng library](#CVE-2019-7317)

Reporter
OSS-Fuzz, Eddie Lee
Impact
high
##### Description

A use-after-free vulnerability was discovered in the `png_image_free` function in the libpng library. This could lead to denial of service or a potentially exploitable crash when a malformed image is processed.

##### References

* [Bug 1542829](https://bugzilla.mozilla.org/show_bug.cgi?id=1542829)

#### [#CVE-2019-9797: Cross-origin theft of images with createImageBitmap](#CVE-2019-9797)

Reporter
AaylaSecura1138
Impact
high
##### Description

Cross-origin images can be read in violation of the same-origin policy by exporting an image after using `createImageBitmap` to read the image and then rendering the resulting bitmap image within a `canvas` element.

##### References

* [Bug 1528909](https://bugzilla.mozilla.org/show_bug.cgi?id=1528909)

#### [#CVE-2018-18511: Cross-origin theft of images with ImageBitmapRenderingContext](#CVE-2018-18511)

Reporter
AaylaSecura1138
Impact
high
##### Description

Cross-origin images can be read from a `canvas` element in violation of the same-origin policy using the `transferFromImageBitmap` method.

##### References

* [Bug 1526218](https://bugzilla.mozilla.org/show_bug.cgi?id=1526218)

#### [#CVE-2019-11694: Uninitialized memory memory leakage in Windows sandbox](#CVE-2019-11694)

Reporter
Jeremy Fetiveau of SSD Secure Disclosure
Impact
moderate
##### Description

A vulnerability exists in the Windows sandbox where an uninitialized value in memory can be leaked to a renderer from a broker when making a call to access an otherwise unavailable file. This results in the potential leaking of information stored at that memory location.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1534196](https://bugzilla.mozilla.org/show_bug.cgi?id=1534196)

#### [#CVE-2019-11698: Theft of user history data through drag and drop of hyperlinks to and from bookmarks](#CVE-2019-11698)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a crafted hyperlink is dragged and dropped to the bookmark bar or sidebar and the resulting bookmark is subsequently dragged and dropped into the web content area, an arbitrary query of a user's browser history can be run and transmitted to the content page via `drop` event data. This allows for the theft of browser history by a malicious site.

##### References

* [Bug 1543191](https://bugzilla.mozilla.org/show_bug.cgi?id=1543191)

#### [#CVE-2019-5798: Out-of-bounds read in Skia](#CVE-2019-5798)

Reporter
Tran Tien Hung of Viettel Cyber Security
Impact
moderate
##### Description

An out-of-bounds read can occur in the Skia library during path transformations. This could result in the exposure of data stored in memory.

##### References

* [Bug 1535518](https://bugzilla.mozilla.org/show_bug.cgi?id=1535518)

#### [#CVE-2019-9800: Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](#CVE-2019-9800)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Bogdan Tara, Jan de Mooij, Jason Kratzer, Jan Varga, Gary Kwong, Tim Guan-tin Chien, Tyson Smith, Ronald Crane, and Ted Campbell reported memory safety bugs present in Firefox 66 and Firefox ESR 60.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540166%2C1534593%2C1546327%2C1540136%2C1538736%2C1538042%2C1535612%2C1499719%2C1499108%2C1538619%2C1535194%2C1516325%2C1542324%2C1542097%2C1532465%2C1533554%2C1541580)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_ee6a31cd_20250120_233259.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1540221)
* [XML](/show_bug.cgi?ctype=xml&id=1540221)

Closed
[Bug 1540221](/show_bug.cgi?id=1540221)
(CVE-2019-9817)

Opened 6 years ago
Closed 6 years ago

# Security: Cross-origin theft of images in fillText and CanvasPattern

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Security: Cross-origin theft of images in fillText and CanvasPattern

## Categories

### (Core :: Graphics: Canvas2D, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20Canvas2D#Graphics%3A%20Canvas2D)

Graphics: Canvas2D
▾

Core :: Graphics: Canvas2D
Bugs with the HTML5 [<canvas>](http://whatwg.org/specs/web-apps/current-work/#dynamic) element, its XUL sibling, and related rendering contexts.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Canvas2D&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Canvas2D&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20Canvas2D)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

68 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla68

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | [67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified) |
| firefox66 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix) |
| firefox67 | [+](/buglist.cgi?f1=cf_tracking_firefox67&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=verified) |
| firefox68 | [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 | 67+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox66 |  | wontfix |
| firefox67 | + | verified |
| firefox68 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: manhluat93.php, Assigned: baku, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=40)  [baku](/user_profile?user_id=446257)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/c03cd9291a2fb2bc96782c4a093df007?d=mm&size=40)  [manhluat93.php](/user_profile?user_id=560605)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/029a38b9773f1943419c24b7c3d93761?d=mm&size=40)  [lsalzman](/user_profile?user_id=536714)

NeedInfo From:

 [manhluat93.php](/user_profile?user_id=560605)

[6 years ago](#c20)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1544785](/show_bug.cgi?id=1544785 "RESOLVED INCOMPLETE - Intermittent TEST-UNEXPECTED-TIMEOUT | /html/semantics/embedded-content/the-canvas-element/security.pattern.fillStyle.sub.html | redirected to cross-origin HTMLVideoElement: Setting fillStyle to an origin-unclear pattern makes the canvas origin-unclean")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-sop, reporter-external, sec-high, Whiteboard: [adv-main67+][adv-esr60.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-9817

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main67+][adv-esr60.7+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [abillings](/user_profile?user_id=280903) | [sec-bounty](#a2067720_280903 "6 years ago") | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c14 "6 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [cross\_origin\_fillText.html](/attachment.cgi?id=9054890)  [6 years ago](#c2)  [Luat Nguyen](/user_profile?user_id=560605)   849 bytes, text/html |  | [Details](/attachment.cgi?id=9054890&action=edit) |
| --- | --- | --- |
| [Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond](/attachment.cgi?id=9055137)  [6 years ago](#c5)  [Andrea Marchesini [:baku]](/user_profile?user_id=446257)   47 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c18 "6 years ago")  lizzard : [approval-mozilla-esr60+](#a2696290_451704 "6 years ago")  abillings : [sec-approval+](#a1049076_280903 "6 years ago") | [Details](/attachment.cgi?id=9055137&action=edit) | [Review](/attachment.cgi?id=9055137) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Luat Nguyen](/user_profile?user_id=560605)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1540221#c0)• 6 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36

Steps to reproduce:

1. Navigate to <https://cyberjutsu.io/files/cross_origin_fillText.html>
2. You can see the Google logo has been stolen, then print it out as the textarea value

Tested on latest Stable && Nightly (Windows 10)

Actual results:

At <https://dxr.mozilla.org/mozilla-central/source/dom/canvas/CanvasRenderingContext2D.cpp?redirect_type=single#3527>

```

      if (state->gradientStyles[style]) {  // Gradient
        pattern = GetGradientFor(style);
      } else if (state->patternStyles[style]) {  // Pattern
        pattern = GetPatternFor(style);
      } else {
        MOZ_ASSERT(false, "Should never reach here.");
        return;
      }
      MOZ_ASSERT(pattern, "No valid pattern.");

      if (style == Style::FILL) {
        params.context->SetPattern(pattern);
      } else {
        params.textStrokePattern = pattern;
      }

```

it's possible to draw a canvaspattern (which can be loaded with an image) as background of a text.

Due to lacking of checking mWriteonly/Principal/CORs later on, we can extract the whole canvas by calling .toDataURL() for example.

```
    ctx.font = "10000px Arial"; // <-- make the dot "." to big, to leak the whole image. we can fix it dynamically depends on image's size.
    ctx.fillStyle = pattern;
    ctx.fillText(".", 0, 200);

```

Expected results:

canvas.toDataURL() should not be invoked successfully due to invalid CORs.

|  | [Alex Gaynor [:Alex\_Gaynor]](/user_profile?user_id=537703) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a3035_537703)• 6 years ago |

Group: firefox-core-security → gfx-core-securityComponent: Untriaged → Canvas: 2DProduct: Firefox → Core

|  | [Luat Nguyen](/user_profile?user_id=560605)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1540221#c1)• 6 years ago |
|  | |

The patch should be trivial.

We can call |CanvasUtils::DoDrawImageSecurityCheck| once the fillstyle is a canvaspattern.

For example:

<https://dxr.mozilla.org/mozilla-central/source/dom/canvas/CanvasRenderingContext2D.cpp#286>

|  | [Luat Nguyen](/user_profile?user_id=560605)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1540221#c2)• 6 years ago |
|  | |

Attached file
[cross\_origin\_fillText.html](attachment.cgi?id=9054890)
— [Details](attachment.cgi?id=9054890&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1540221#c3)• 6 years ago |
|  | |

confirmed :(

Baku, can you take a look?

Assignee: nobody → amarchesiniStatus: UNCONFIRMED → NEWEver confirmed: trueFlags: sec-bounty?Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1540221#c4)• 6 years ago |
|  | |

This is a 'known' issue. We have web-platform tests, (disabled of course) here:

<https://searchfox.org/mozilla-central/source/testing/web-platform/meta/html/semantics/embedded-content/the-canvas-element>

I have a patch to fix them all. Would be really great if somebody can help me checking if we have covered all the possible scenarios. We don't have enough tests and the few we have, if WPT, are disabled.

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1540221#c5)• 6 years ago |
|  | |

Attached file
[Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond](attachment.cgi?id=9055137)
— [Details](attachment.cgi?id=9055137&action=edit)

|  | [Luat Nguyen](/user_profile?user_id=560605)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1540221#c6)• 6 years ago |
|  | |

Hi folks,

I don't think those tests are covering my case.

Since the bug is placed in |Canvas2D::fillText| method

which invoking the actual vulnerable function |DrawText|

( <https://dxr.mozilla.org/mozilla-central/rev/3ebf6f2a81387d7087ef235c3ce60452baf550f3/dom/canvas/CanvasRenderingContext2D.cpp#3527,3580,3588,3590,3616> )

The bug exists in this function only. Other places (which the test-cases already reach) are not vulnerable to this.

To confirm,

<https://github.com/servo/servo/search?q=path%3Atests%2Fwpt%2Fweb-platform-tests%2Fhtml%2Fsemantics%2Fembedded-content%2Fthe-canvas-element%2F+fillText&unscoped_q=path%3Atests%2Fwpt%2Fweb-platform-tests%2Fhtml%2Fsemantics%2Fembedded-content%2Fthe-canvas-element%2F+filltext>

No match found.

It means the test-cases won't recognize this vulnerability.

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1540221#c7)• 6 years ago |
|  | |

Comment on [attachment 9055137](/attachment.cgi?id=9055137 "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") [[details]](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond")

[Bug 1540221](/show_bug.cgi?id=1540221 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern") - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Impossible. Here we are exposing images which should be protected by cross-origin.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Easy. I hope.
* **How likely is this patch to cause regressions; how much testing does it need?**: There are good tests. I think this patch should not introduce regressions.
[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1540221#c8)• 6 years ago |
|  | |

(In reply to Andrea Marchesini [:baku] from [comment #7](/show_bug.cgi?id=1540221#c7 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"))

> Comment on [attachment 9055137](/attachment.cgi?id=9055137 "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") [[details]](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond")
>
> [Bug 1540221](/show_bug.cgi?id=1540221 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern") - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r?aosmond
>
> ### Security Approval Request

> * **Which older supported branches are affected by this flaw?**:

Which older branches are affected?

Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1540221#c9)• 6 years ago |
|  | |

> Which older branches are affected?

All. this is not a regression. This was a missing feature. There were WPTs too, disabled since ever.

Flags: needinfo?(amarchesini)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1540221#c10)• 6 years ago |
|  | |

sec-approval+ for trunk. We'll want this on beta and ESR60 as well.

[status-firefox66](/buglist.cgi?f1=cf_status_firefox66&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix)
[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected)
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox67](/buglist.cgi?f1=cf_tracking_firefox67&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox67&o1=equals&v1=%2B)
[tracking-firefox68](/buglist.cgi?f1=cf_tracking_firefox68&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a1049076_280903)• 6 years ago |

[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1540221#c11)• 6 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/aa0feb50773a>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1540221#c12)• 6 years ago |
|  | |

That got backed out for WPT failures in /html/semantics/embedded-content/the-canvas-element/security.pattern.fillStyle.sub.html

<https://hg.mozilla.org/mozilla-central/rev/8b591d56ff49>

Push with failure: <https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&tochange=6f0b0ab56a478e99853a465ceaa7a5d8c7e2b1b8&fromchange=aa0feb50773a391760802da8121742653321d1ce&selectedJob=239548783>

Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=239548783&repo=autoland>

TEST-UNEXPECTED-FAIL | /html/semantics/embedded-content/the-canvas-element/security.pattern.fillStyle.sub.html | redirected to same-origin HTMLVideoElement: Setting fillStyle to an origin-unclear pattern makes the canvas origin-unclean - assert\_throws: function "function() { canvas.toDataURL(); }" did not throw

Sorry for the late notice.

Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1540221#c13)• 6 years ago |
|  | |

Right. I forgot to submit security.pattern.fillStyle.sub.html.ini. As any other 'HTMLVideoElement redirect' test, this one fails too. See: <https://searchfox.org/mozilla-central/rev/1b2636e8517aa48422ed516affe4d28cb7fa220a/testing/web-platform/meta/2dcontext/imagebitmap/createImageBitmap-origin.sub.html.ini>

Flags: needinfo?(amarchesini)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a1511437_600971)• 6 years ago |

[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Attachment description: Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r?aosmond → Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond

|  | [Andrei Ciure[:aciure]](/user_profile?user_id=600674) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a1536110_600674)• 6 years ago |

Regressions: [1544785](/show_bug.cgi?id=1544785 "RESOLVED INCOMPLETE - Intermittent TEST-UNEXPECTED-TIMEOUT | /html/semantics/embedded-content/the-canvas-element/security.pattern.fillStyle.sub.html | redirected to cross-origin HTMLVideoElement: Setting fillStyle to an origin-unclear pattern makes the canvas origin-unclean")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1540221#c14)• 6 years ago |
|  | |

Looks like this was successfully landed on the 16th but never got resolved :

<https://hg.mozilla.org/mozilla-central/rev/3fd42eb67a3f>

Andrea, please request Beta/ESR60 approval on this when you get a chance. It grafts cleanly to Beta as-landed but needs a rebased patch for ESR60.

Status: NEW → RESOLVEDClosed: 6 years ago
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=fixed)Flags: needinfo?(amarchesini)Flags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla68

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a2067720_280903)• 6 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1540221#c15)• 6 years ago |
|  | |

(In reply to Andrea Marchesini [:baku] from [comment #4](/show_bug.cgi?id=1540221#c4 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"))

> This is a 'known' issue. We have web-platform tests, (disabled of course) here:
>
> <https://searchfox.org/mozilla-central/source/testing/web-platform/meta/html/semantics/embedded-content/the-canvas-element>

Did we file a security bug when we turned these off?

Flags: needinfo?(james)Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1540221#c16)• 6 years ago |
|  | |

Comment on [attachment 9055137](/attachment.cgi?id=9055137 "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") [[details]](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond")

[Bug 1540221](/show_bug.cgi?id=1540221 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern") - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond

### Beta/Release Uplift Approval Request

* **User impact if declined**: cross origin images can be read using canvas objects.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This patch seems stable in nightly and it has good tests. I think this is a low risk patch to be uplift.
* **String changes made/needed**: none
Flags: needinfo?(amarchesini)
[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Flags: approval-mozilla-beta?

|  | [James Graham [:jgraham]](/user_profile?user_id=389650) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1540221#c17)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1540221&comment_id=14070298 "1 revision") |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #15](/show_bug.cgi?id=1540221#c15 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"))

> (In reply to Andrea Marchesini [:baku] from [comment #4](/show_bug.cgi?id=1540221#c4 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"))
>
> > This is a 'known' issue. We have web-platform tests, (disabled of course) here:
> >
> > <https://searchfox.org/mozilla-central/source/testing/web-platform/meta/html/semantics/embedded-content/the-canvas-element>
>
> Did we file a security bug when we turned these off?

No. There are several problems with requiring/expecting that:

* I (and others on my team) who are responsible for maintining the sync with upstream don't have the correct expertise or appropriate resources to identify which wpt failures may represent security issues. Even in "obvious" cases (like if the test is evidently intended to check SOP correctness) there are many reasons for failure other than a security issue.
* Most tests aren't disabled if they fail. Typically disabling is only used in cases where the test is too unstable to run in CI. In the case that the test is marked as expected:FAIL there is generally no review whatsoever, and these are just as likely to represent security issues as other tests.

The way that we need to deal with this is for platform teams to actively monitor the wpt tests that fail (or otherwise aren't passing) in their components. <https://jgraham.github.io/wptdash> is intended to help with this, and the intent is that we will be able to add annotations to the test results linking them with bugs, so teams are able to triage the Firefox failures (or at least the Firefox-only failures) and so keep the number of untriaged issues to zero, just like we do for incoming bug reports. As a side effect that should allow us to identify potential security issues faster.

So I fully agree that we should be more actively looking at the results of these tests, not only for security bugs, and there are efforts ongoing to make that more workable for platform teams.

Flags: needinfo?(james)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1540221#c18)• 6 years ago |
|  | |

Comment on [attachment 9055137](/attachment.cgi?id=9055137 "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") [[details]](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond")

[Bug 1540221](/show_bug.cgi?id=1540221 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern") - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond

Looks minmal, uplift approved for 67 beta 14, thanks.

[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1540221#c19)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3a1b53518d5f>

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a2160473_75935)• 6 years ago |

Group: gfx-core-security → core-security-release

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a2286501_458188)• 6 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a2291495_553429)• 6 years ago |

QA Whiteboard: [qa-triaged]

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1540221#c20)• 6 years ago |
|  | |

Hi, I tried reproducing this issue but the Steps were a bit confusing, and the Results even more so.

In an older version of Firefox I can see 2 images plus the Text for the Leaked image.

In newer versions of Firefox, where the fix is supposed to be I only see 1 Google logo and no text in the Leaked section.

However on Chrome I do not see any images or text in the leak section.

What are the correct Expected Results ? can someone help us out with that ?

Flags: needinfo?(manhluat93.php)Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1540221#c21)• 6 years ago |
|  | |

Chrome implementation seems to be broken. The spec says that we should not expose the content, but it can still be shown.

Flags: needinfo?(amarchesini)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1540221#c22)• 6 years ago |
|  | |

So the expected results should be to display 1 Google image but no code in the leak section right ??

Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1540221#c23)• 6 years ago |
|  | |

(In reply to Rares Doghi from [comment #22](/show_bug.cgi?id=1540221#c22 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"))

> So the expected results should be to display 1 Google image but no code in the leak section right ??

4.12.5.6 Security with canvas elements

<https://html.spec.whatwg.org/multipage/canvas.html#security-with-canvas-elements>

"Information leakage can occur if scripts from one origin can access information (e.g. read pixels) from images from another origin (one that isn't the same).

To mitigate this, bitmaps used with canvas elements and ImageBitmap objects are defined to have a flag indicating whether they are origin-clean. All bitmaps start with their origin-clean set to true. The flag is set to false when cross-origin images are used.

The toDataURL(), toBlob(), and getImageData() methods check the flag and will throw a "SecurityError" DOMException rather than leak cross-origin data."

This has nothing to do with the displaying of the canvas content.

Flags: needinfo?(amarchesini)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1540221#c24)• 6 years ago |
|  | |

Do you think this is a safe uplift for ESR as well?

Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1540221#c25)• 6 years ago |
|  | |

This test is covered by several tests and it has not introduced any regressions in nightly.

The code is relatively easy, so yes, I think it's OK to uplift it.

Flags: needinfo?(amarchesini)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a2696290_451704)• 6 years ago |

[Attachment #9055137](/attachment.cgi?id=9055137&action=edit "Bug 1540221 - Setting fillStyle to a pattern of an unclean canvas makes the canvas origin-unclean, r=aosmond") -
Flags: approval-mozilla-esr60+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1540221#c26)• 6 years ago |
|  | |

The changes fail to apply on ESR60, conflicts with at least [bug 1500768](/show_bug.cgi?id=1500768 "RESOLVED FIXED - Implement SVG image support for createImageBitmap"). Please provide patches for ESR.

Flags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1540221#c27)• 6 years ago |
|  | |

I don't think we need to uplift to esr60 because there, we don't have clean-origin at all. Fixing this would require the uplift [bug 1502799](/show_bug.cgi?id=1502799 "RESOLVED FIXED - Implement origin-clean algorithm for ImageBitmap") too.

Flags: needinfo?(amarchesini)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1540221#c28)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1540221&comment_id=14091462 "1 revision") |
|  | |

The testcase from #c0 reproduces on ESR60 - what can we do to fix this bug there?

Flags: needinfo?(amarchesini)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1540221#c29)• 6 years ago |
|  | |

Uplifting this patch would require [bug 1502799](/show_bug.cgi?id=1502799 "RESOLVED FIXED - Implement origin-clean algorithm for ImageBitmap") (which might include [bug 1526218](/show_bug.cgi?id=1526218 "VERIFIED FIXED - Tainted canvases can be rendered in a bitmap context") and [bug 1528909](/show_bug.cgi?id=1528909 "RESOLVED FIXED - ImageBitmap drawn to canvases, does not affect taint"))

Flags: needinfo?(amarchesini)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1540221#c30)• 6 years ago |
|  | |

Wontfixing for esr60, in that case.

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
[67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=-)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1540221#c31)• 6 years ago |
|  | |

Dan, do you have an opinion here? We've fixed this for 67 but the work seems a bit complex for esr uplift. Do you think it is OK here to wait for esr68 or should we go for an uplift here and in the 3 bugs mentioned in [comment 29](/show_bug.cgi?id=1540221#c29 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern")?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1540221#c32)• 6 years ago |
|  | |

[Tracking Requested - why for this release]:

The two regressions in [comment 29](/show_bug.cgi?id=1540221#c29 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern") are small/safe-looking patches, and this patch isn't too bad, so the question is how risky is the patch in [bug 1502799](/show_bug.cgi?id=1502799 "RESOLVED FIXED - Implement origin-clean algorithm for ImageBitmap") to back-port? It's longish but looks pretty straightforward (a lot of passing a new argument around).

Given how easy this attack is to pull off once the bug is known I don't see how we could skip fixing a sec-high bug on ESR-60.

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=-) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=%3F)Flags: needinfo?(dveditz)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1540221#c33)• 6 years ago |
|  | |

baku, given [comment 32](/show_bug.cgi?id=1540221#c32 "VERIFIED FIXED - Security: Cross-origin theft of images in fillText and CanvasPattern"), could you put together patches and request uplift for esr60 on whatever would be needed?

[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=%3F) → [67+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=67%2B)Flags: needinfo?(amarchesini)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a3306493_280903)• 6 years ago |

Whiteboard: [adv-main67+]

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1540221#c34)• 6 years ago |
|  | |

Liz, do you want 1 single big patch or you are OK with them to be separate? I can rebase them in case they don't apply to esr60.

Flags: needinfo?(amarchesini)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1540221#c35)• 6 years ago |
|  | |

Separate is fine!

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a3903099_280903)• 6 years ago |

Alias: CVE-2019-9817

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1540221#c36)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/ebd350549d83>

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1540221#c37)• 6 years ago |
|  | |

Backed out for bustage (more info in [bug 1502799](/show_bug.cgi?id=1502799 "RESOLVED FIXED - Implement origin-clean algorithm for ImageBitmap")):

<https://hg.mozilla.org/releases/mozilla-esr60/rev/9d3b9a48a91710e8bf4eb36c5181e391c7c14abe>

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1540221#c38)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/64ee63facd4ff96b3e8590cff559d7e97ac6b061>

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1540221#c39)• 6 years ago |
|  | |

Hi, I have retested this issue in Beta 67, Esr 60.7.0 as well as Nightly 68.0a1 (2019-05-16) and after comparing to release 66 I can confirm that this issue is Verified as fixed.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=verified)
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=verified)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified)Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a4252438_280903)• 6 years ago |

Whiteboard: [adv-main67+] → [adv-main67+][adv-esr60.7+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a37453750_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1540221#a163201804_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1540221&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Luat Nguyen](/user_profile?user_id=560605)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8c874c66_20250120_233259.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-13

## Security vulnerabilities fixed in Firefox 67

Announced
May 21, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 67

#### [#CVE-2019-9815: Disable hyperthreading on content JavaScript threads on macOS](#CVE-2019-9815)

Reporter
[Multiple independent researchers](https://mdsattacks.com/#People)
Impact
high
##### Description

If hyperthreading is not disabled, a timing attack vulnerability exists, similar to previous Spectre attacks. Apple has shipped macOS 10.14.5 with an option to disable hyperthreading in applications running untrusted code in a thread through a new sysctl. Firefox now makes use of it on the main thread and any worker threads.
*Note: users need to update to macOS 10.14.5 in order to take advantage of this change.*

##### References

* [Bug 1546544](https://bugzilla.mozilla.org/show_bug.cgi?id=1546544)
* [RIDL and Fallout: MDS attacks](https://mdsattacks.com/)

#### [#CVE-2019-9816: Type confusion with object groups and UnboxedObjects](#CVE-2019-9816)

Reporter
Samuel Groß of Google Project Zero
Impact
high
##### Description

A possible vulnerability exists where type confusion can occur when manipulating JavaScript objects in object groups, allowing for the bypassing of security checks within these groups.
*Note: this vulnerability has only been demonstrated with `UnboxedObjects`, which are disabled by default on all supported releases.*

##### References

* [Bug 1536768](https://bugzilla.mozilla.org/show_bug.cgi?id=1536768)

#### [#CVE-2019-9817: Stealing of cross-domain images using canvas](#CVE-2019-9817)

Reporter
Luật Nguyễn
Impact
high
##### Description

Images from a different domain can be read using a canvas object in some circumstances. This could be used to steal image data from a different site in violation of same-origin policy.

##### References

* [Bug 1540221](https://bugzilla.mozilla.org/show_bug.cgi?id=1540221)

#### [#CVE-2019-9818: Use-after-free in crash generation server](#CVE-2019-9818)

Reporter
Thomas Imbert
Impact
high
##### Description

A race condition is present in the crash generation server used to generate data for the crash reporter. This issue can lead to a use-after-free in the main process, resulting in a potentially exploitable crash and a sandbox escape.
*Note: this vulnerability only affects Windows. Other operating systems are unaffected.*

##### References

* [Bug 1542581](https://bugzilla.mozilla.org/show_bug.cgi?id=1542581)

#### [#CVE-2019-9819: Compartment mismatch with fetch API](#CVE-2019-9819)

Reporter
Nils
Impact
high
##### Description

A vulnerability where a JavaScript compartment mismatch can occur while working with the `fetch` API, resulting in a potentially exploitable crash.

##### References

* [Bug 1532553](https://bugzilla.mozilla.org/show_bug.cgi?id=1532553)

#### [#CVE-2019-9820: Use-after-free of ChromeEventHandler by DocShell](#CVE-2019-9820)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in the chrome event handler when it is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1536405](https://bugzilla.mozilla.org/show_bug.cgi?id=1536405)

#### [#CVE-2019-9821: Use-after-free in AssertWorkerThread](#CVE-2019-9821)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur in `AssertWorkerThread` due to a race condition with shared workers. This results in a potentially exploitable crash.

##### References

* [Bug 1539125](https://bugzilla.mozilla.org/show_bug.cgi?id=1539125)

#### [#CVE-2019-11691: Use-after-free in XMLHttpRequest](#CVE-2019-11691)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when working with `XMLHttpRequest` (XHR) in an event loop, causing the XHR main thread to be called after it has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1542465](https://bugzilla.mozilla.org/show_bug.cgi?id=1542465)

#### [#CVE-2019-11692: Use-after-free removing listeners in the event listener manager](#CVE-2019-11692)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when listeners are removed from the event listener manager while still in use, resulting in a potentially exploitable crash.

##### References

* [Bug 1544670](https://bugzilla.mozilla.org/show_bug.cgi?id=1544670)

#### [#CVE-2019-11693: Buffer overflow in WebGL bufferdata on Linux](#CVE-2019-11693)

Reporter
crixer
Impact
high
##### Description

The `bufferdata` function in WebGL is vulnerable to a buffer overflow with specific graphics drivers on Linux. This could result in malicious content freezing a tab or triggering a potentially exploitable crash.
*Note: this issue only occurs on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1532525](https://bugzilla.mozilla.org/show_bug.cgi?id=1532525)

#### [#CVE-2019-7317: Use-after-free in png\_image\_free of libpng library](#CVE-2019-7317)

Reporter
OSS-Fuzz, Eddie Lee
Impact
high
##### Description

A use-after-free vulnerability was discovered in the `png_image_free` function in the libpng library. This could lead to denial of service or a potentially exploitable crash when a malformed image is processed.

##### References

* [Bug 1542829](https://bugzilla.mozilla.org/show_bug.cgi?id=1542829)

#### [#CVE-2019-11694: Uninitialized memory memory leakage in Windows sandbox](#CVE-2019-11694)

Reporter
Jeremy Fetiveau of SSD Secure Disclosure
Impact
moderate
##### Description

A vulnerability exists in the Windows sandbox where an uninitialized value in memory can be leaked to a renderer from a broker when making a call to access an otherwise unavailable file. This results in the potential leaking of information stored at that memory location.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1534196](https://bugzilla.mozilla.org/show_bug.cgi?id=1534196)

#### [#CVE-2019-11695: Custom cursor can render over user interface outside of web content](#CVE-2019-11695)

Reporter
bignis
Impact
moderate
##### Description

A custom cursor defined by scripting on a site can position itself over the addressbar to spoof the actual cursor when it should not be allowed outside of the primary web content area. This could be used by a malicious site to trick users into clicking on permission prompts, doorhanger notifications, or other buttons inadvertently if the location is spoofed over the user interface.

##### References

* [Bug 1445844](https://bugzilla.mozilla.org/show_bug.cgi?id=1445844)

#### [#CVE-2019-11696: Java web start .JNLP files are not recognized as executable files for download prompts](#CVE-2019-11696)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

Files with the `.JNLP` extension used for "Java web start" applications are not treated as executable content for download prompts even though they can be executed if Java is installed on the local system. This could allow users to mistakenly launch an executable binary locally.

##### References

* [Bug 1392955](https://bugzilla.mozilla.org/show_bug.cgi?id=1392955)

#### [#CVE-2019-11697: Pressing key combinations can bypass installation prompt delays and install extensions](#CVE-2019-11697)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If the `ALT` and "a" keys are pressed when users receive an extension installation prompt, the extension will be installed without the install prompt delay that keeps the prompt visible in order for users to accept or decline the installation. A malicious web page could use this with spoofing on the page to trick users into installing a malicious extension.

##### References

* [Bug 1440079](https://bugzilla.mozilla.org/show_bug.cgi?id=1440079)

#### [#CVE-2019-11698: Theft of user history data through drag and drop of hyperlinks to and from bookmarks](#CVE-2019-11698)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a crafted hyperlink is dragged and dropped to the bookmark bar or sidebar and the resulting bookmark is subsequently dragged and dropped into the web content area, an arbitrary query of a user's browser history can be run and transmitted to the content page via `drop` event data. This allows for the theft of browser history by a malicious site.

##### References

* [Bug 1543191](https://bugzilla.mozilla.org/show_bug.cgi?id=1543191)

#### [#CVE-2019-11700: res: protocol can be used to open known local files](#CVE-2019-11700)

Reporter
James Lee
Impact
moderate
##### Description

A hyperlink using the `res:` protocol can be used to open local files at a known location in Internet Explorer if a user approves execution when prompted.
*Note: this issue only occurs on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1549833](https://bugzilla.mozilla.org/show_bug.cgi?id=1549833)

#### [#CVE-2019-11699: Incorrect domain name highlighting during page navigation](#CVE-2019-11699)

Reporter
tzachyr
Impact
low
##### Description

A malicious page can briefly cause the wrong name to be highlighted as the domain name in the addressbar during page navigations. This could result in user confusion of which site is currently loaded for spoofing attacks.

##### References

* [Bug 1528939](https://bugzilla.mozilla.org/show_bug.cgi?id=1528939)

#### [#CVE-2019-11701: webcal: protocol default handler loads vulnerable web page](#CVE-2019-11701)

Reporter
Peter af Geijerstam
Impact
low
##### Description

The default `webcal:` protocol handler will load a web site vulnerable to cross-site scripting (XSS) attacks. This default was left in place as a legacy feature and has now been removed.
*Note: this issue only affects users with an account on the vulnerable service. Other users are unaffected.*

##### References

* [Bug 1518627](https://bugzilla.mozilla.org/show_bug.cgi?id=1518627)

#### [#CVE-2019-9814: Memory safety bugs fixed in Firefox 67](#CVE-2019-9814)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Andrei Ciure, Julien Cristau, Jan de Mooij, Jan Varga, Marcia Knous, André Bargull, and Philipp reported memory safety bugs present in Firefox 66. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1527592%2C1534536%2C1520132%2C1543159%2C1539393%2C1459932%2C1459182%2C1516425)

#### [#CVE-2019-9800: Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](#CVE-2019-9800)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Bogdan Tara, Jan de Mooij, Jason Kratzer, Jan Varga, Gary Kwong, Tim Guan-tin Chien, Tyson Smith, Ronald Crane, and Ted Campbell reported memory safety bugs present in Firefox 66 and Firefox ESR 60.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 67 and Firefox ESR 60.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540166%2C1534593%2C1546327%2C1540136%2C1538736%2C1538042%2C1535612%2C1499719%2C1499108%2C1538619%2C1535194%2C1516325%2C1542324%2C1542097%2C1532465%2C1533554%2C1541580)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


