=== Content from research.loginsoft.com_54d102b9_20250120_234753.html ===
[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22ba452b20ebeb6450c5_Loginsoft%20Logo%20Black.svg)](/)Services[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management](/vulnerability-management-configuration)Threat Research & Intelligence Services[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)Software Supply Chain Security Services[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)Cloud Native Security Services[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science &Â AI](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Development &Â Support](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation](/staff-augmentation)ServicesCybersecurity Solutions[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-management-configuration)SOFTWARE SUPPLY CHAIN SECURITY[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/zero-day-discovery)THREAT RESEARCH & INTELLIGENCE[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/external-attack-surface-discovery)CLOUDÂ NATIVEÂ SECURITY[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science & AI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Dev & Support![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/staff-augmentation)Platforms[LOVI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/lovi)[Cytellite![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cytellite)[Research-as-a-Service](/research-as-a-service)Research[Zero-Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-advisories)[Our Research![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](https://research.loginsoft.com/)Company[Blog![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/blogs)[Reports![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/reports)[Case Studies![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/case-studies)[About us![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/about-us)[Careers![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/careers)[Talk to us](/contact)[Talk to us](/contact)By using this website, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our [Privacy Policy](/privacy-policy) for more information.Accept![Green Plus icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65cde7d5fe78a54970c7984e_Green-Plus.svg)[Home](/)/Research/[Zero Day Discovery](/security-advisories)/CVE-2019-9144: Uncontrolled recursion loop in Exiv2::(anonymous namespace)::BigTiffImage::printIFD( ) - exiv2-0.27
## CVE-2019-9144: Uncontrolled recursion loop in Exiv2::(anonymous namespace)::BigTiffImage::printIFD( ) - exiv2-0.27

Vulnerability ReportsFebruary 25, 2019![Profile Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65a91b500b759f07aaa89823_Blog%20Author%20DP%20Placeholder.png)

Jason Franscisco

### Uncontrolled recursion loop in Exiv2::(anonymous namespace)::BigTiffImage::printIFD( ) - exiv2-0.27

Loginsoft-2018-1096

February 25, 2019

##### CVE Number

CVE-2019-9144

##### CWE

CWE-400: Uncontrolled Resource Consumption

##### Product Details

Exiv2 is a C++ library and a command line utility to read, write, delete and modify Exif, IPTC, XMP and ICC image metadata.

â**URL:**<https://github.com/Exiv2/exiv2>

##### Vulnerable Versions

0.27

##### Vulnerability Details

We observed that there is an infinite loop generating recursively at Uncontrolled recursion loop in `Exiv2::(anonymous namespace)::BigTiffImage::printIFD( )` in file `bigtiffimage.cpp`.The same be triggered by sending a crafted file to the exiv2 binary. It allows an attacker to cause Denial of Service (Segmentation fault) or possibly have unspecified other impact.

##### SYNOPSIS

In progress

##### Vulnerable code

```

{
                                       // tag is an IFD
                                       io.seek(0, BasicIo::beg);  // position
                                       std::cerr << "makernote" << std::endl;
                                       printIFD(out,option,offset,depth);
                                   }

                                   io.seek(restore,BasicIo::beg); // restore
                               }
                           }
                       }

                       const uint64_t nextDirOffset = readData(dataSize_);

                       dir_offset = tooBig ? 0 : nextDirOffset;
                       out.flush();
                   } while (dir_offset != 0);

```

##### Analysis

```

{
                                       // tag is an IFD
                                       io.seek(0, BasicIo::beg);  // position
                                       std::cerr << "makernote" << std::endl;
                                       printIFD(out,option,offset,depth);
                                   }

                                   io.seek(restore,BasicIo::beg); // restore
                               }
                           }
                       }

                       const uint64_t nextDirOffset = readData(dataSize_);

                       dir_offset = tooBig ? 0 : nextDirOffset;
                       out.flush();
                   } while (dir_offset != 0);
Analysis

Program received signal SIGINT, Interrupt.
0x00007ffff62276a9 in std::__cxx11::basic_string::_M_append(char const*, unsigned long) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
[ Legend: Modified register | Code | Heap | Stack | String ]
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ registers ââââ
$rax   : 0x0000620001c10a74  â  0xbebebebebe002020
$rbx   : 0x00007fffffccfd80  â  0x0000620001c10080  â  0x2020202020202020 ("        "?)
$rcx   : 0x0
$rdx   : 0x2
$rsp   : 0x00007fffffccfa80  â  0x00007fffffccfad0  â  0x00007fffffccfeb0  â  0x00007fffffcd0290  â  0x00007fffffcd0670  â  0x00007fffffcd0a50  â  0x00007fffffcd0e30  â  0x00007fffffcd1210
$rbp   : 0x9f6
$rsi   : 0x00007ffff69f2020  â  0x0000000000000000
$rdi   : 0x0000620001c10080  â  0x2020202020202020 ("        "?)
$rip   : 0x00007ffff62276a9  â  ::_M_append(char const*, unsigned long)()
[#1] 0x7ffff681f34b â Exiv2::Internal::indent[abi:cxx11](int)(d=0x825)
[#2] 0x7ffff66eb692 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd20)
[#3] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1f)
[#4] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1e)
[#5] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1d)
[#6] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1c)
[#7] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1b)
[#8] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1a)
[#9] 0x7ffff66ebe88 â Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd19)

```

##### Tested environment

`64-bit ubuntu 16.04 LTS`

##### Proof of Concept

`exiv2 -b -u -k -p R pr $POC`

##### Timeline

Vendor Disclosure: 21-02-2019

Public Disclosure: 15-02-2019

##### Credit

Discovered by ACE Team - [Loginsoft](https://www.loginsoft.com/)

Explore Cybersecurity Platforms

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros.

Discover Lovi
## Sign up to our Newsletter

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Cybersecurity Solutions[Vulnerability Intelligence](/vulnerability-intelligence)[Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[Vulnerability & Configuration Management](/vulnerability-management-configuration)[OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[OSS - Dependancy Defence](/software-supply-chain-security/dependency-defense)[OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)[Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)[Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[Data Science &Â AI](/data-science-and-ai)[Software Development Â & Support](/software-development-and-support)[QA Automation](/qa-automation)[Staff Augmentation](/staff-augmentation)Platforms[LOVI](/lovi)[Cytellite](/cytellite)Company[Blogs](/blogs)[Reports](/reports)[About us](/about-us)[Careers](/careers)Research[Research-as-a -Service](/research-as-a-service)[Zero-Day Discovery](/security-advisories)![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22b99ceecda456b052cd_Loginsoft%20Logo%20White.svg)1-703-956-7410info@loginsoft.com[![Linkedin Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d02956967bd81ab620_LinkedIn.svg)](https://www.linkedin.com/company/loginsoft/)[![X icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d0e8e8f3e5866a563b_X.svg)](https://twitter.com/Loginsoft_Inc)[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b8dafdc42d3397ec72e17c_github-mark-white%201.svg)](https://github.com/Loginsoft-Research)Â© 2024 - Copyright[Privacy policy](/privacy-policy)

![](https://px.ads.linkedin.com/collect/?pid=562737&fmt=gif)



=== Content from github.com_baee2b7b_20250120_234752.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FExiv2%2Fexiv2%2Fissues%2F712)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FExiv2%2Fexiv2%2Fissues%2F712)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Exiv2%2Fexiv2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Exiv2](/Exiv2)
/
**[exiv2](/Exiv2/exiv2)**
Public

* [Notifications](/login?return_to=%2FExiv2%2Fexiv2) You must be signed in to change notification settings
* [Fork
  285](/login?return_to=%2FExiv2%2Fexiv2)
* [Star
   965](/login?return_to=%2FExiv2%2Fexiv2)

* [Code](/Exiv2/exiv2)
* [Issues
  149](/Exiv2/exiv2/issues)
* [Pull requests
  24](/Exiv2/exiv2/pulls)
* [Discussions](/Exiv2/exiv2/discussions)
* [Actions](/Exiv2/exiv2/actions)
* [Projects
  0](/Exiv2/exiv2/projects)
* [Wiki](/Exiv2/exiv2/wiki)
* [Security](/Exiv2/exiv2/security)
* [Insights](/Exiv2/exiv2/pulse)

Additional navigation options

* [Code](/Exiv2/exiv2)
* [Issues](/Exiv2/exiv2/issues)
* [Pull requests](/Exiv2/exiv2/pulls)
* [Discussions](/Exiv2/exiv2/discussions)
* [Actions](/Exiv2/exiv2/actions)
* [Projects](/Exiv2/exiv2/projects)
* [Wiki](/Exiv2/exiv2/wiki)
* [Security](/Exiv2/exiv2/security)
* [Insights](/Exiv2/exiv2/pulse)

# Uncontrolled recursion loop in Exiv2::(anonymous namespace)::BigTiffImage::printIFD( )  #712

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#1091](https://github.com/Exiv2/exiv2/pull/1091)Closed[Uncontrolled recursion loop in Exiv2::(anonymous namespace)::BigTiffImage::printIFD( )](#top) #712[#1091](https://github.com/Exiv2/exiv2/pull/1091)Copy linkLabels[bug](https://github.com/Exiv2/exiv2/issues?q=state%3Aopen%20label%3A%22bug%22)![@SegfaultMasters](https://avatars.githubusercontent.com/u/42465102?u=da03c64e56d570a6401fd3deb2ae3d126f804179&v=4&size=80)
## Description

![@SegfaultMasters](https://avatars.githubusercontent.com/u/42465102?u=da03c64e56d570a6401fd3deb2ae3d126f804179&v=4&size=48)[SegfaultMasters](https://github.com/SegfaultMasters)opened [on Feb 21, 2019](https://github.com/Exiv2/exiv2/issues/712#issue-412888776)

**Description** - During our research ,we Observed that an infinite uncontrolled recursion loop, at function `Exiv2::(anonymous namespace)::BigTiffImage::printIFD(` ) located in `bigtiffimage.cpp` . It allows an attacker to cause Denial of Service or possibly have unspecified other impact.

**Command** - exiv2 -b -u -k -p R pr $POC

**POC** - [REPRODUCER](https://github.com/SegfaultMasters/covering360/blob/master/Exiv2/h2?raw=true)

**Debug** -

**GDB** -

```
Program received signal SIGINT, Interrupt.
0x00007ffff62276a9 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$rax   : 0x0000620001c10a74  →  0xbebebebebe002020
$rbx   : 0x00007fffffccfd80  →  0x0000620001c10080  →  0x2020202020202020 ("        "?)
$rcx   : 0x0
$rdx   : 0x2
$rsp   : 0x00007fffffccfa80  →  0x00007fffffccfad0  →  0x00007fffffccfeb0  →  0x00007fffffcd0290  →  0x00007fffffcd0670  →  0x00007fffffcd0a50  →  0x00007fffffcd0e30  →  0x00007fffffcd1210
$rbp   : 0x9f6
$rsi   : 0x00007ffff69f2020  →  0x0000000000000000
$rdi   : 0x0000620001c10080  →  0x2020202020202020 ("        "?)
$rip   : 0x00007ffff62276a9  →  <std::__cxx11::basic_string<char,+0> add rsp, 0x8
$r8    : 0x00007fffffccfd90  →  0x0000000000000f00
$r9    : 0x9f4
$r10   : 0x00007fffffccf1e0  →  0x00007ffff6f036b3  →  <operator+0> mov r15, rax
$r11   : 0x00007fffffccf1e0  →  0x00007ffff6f036b3  →  <operator+0> mov r15, rax
$r12   : 0x00000ffffff99f84  →  0x0000000000000000
$r13   : 0x00007fffffccfc20  →  0x0000000041b58ab3
$r14   : 0x00007ffff69600a0  →  0x006e776f6e6b6e75 ("unknown"?)
$r15   : 0x00007fffffffdb20  →  0x0000000041b58ab3
$eflags: [carry PARITY adjust ZERO sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x0033 $ss: 0x002b $ds: 0x0000 $es: 0x0000 $fs: 0x0000 $gs: 0x0000
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0x00007fffffccfa80│+0x0000: 0x00007fffffccfad0  →  0x00007fffffccfeb0  →  0x00007fffffcd0290  →  0x00007fffffcd0670  →  0x00007fffffcd0a50  →  0x00007fffffcd0e30  →  0x00007fffffcd1210     ← $rsp
0x00007fffffccfa88│+0x0008: 0x00007fffffccfe80  →  0x00007ffff69600a0  →  0x006e776f6e6b6e75 ("unknown"?)
0x00007fffffccfa90│+0x0010: 0x00007fffffccfad0  →  0x00007fffffccfeb0  →  0x00007fffffcd0290  →  0x00007fffffcd0670  →  0x00007fffffcd0a50  →  0x00007fffffcd0e30  →  0x00007fffffcd1210
0x00007fffffccfa98│+0x0018: 0x00007ffff681f34b  →  <Exiv2::Internal::indent[abi:cxx11](int)+86> jmp 0x7ffff681f326 <Exiv2::Internal::indent[abi:cxx11](int)+49>
0x00007fffffccfaa0│+0x0020: 0x00000825fff99f84  →  0x0000000000000000
0x00007fffffccfaa8│+0x0028: 0x00007fffffccfd80  →  0x0000620001c10080  →  0x2020202020202020
0x00007fffffccfab0│+0x0030: 0x00007ffff69600a0  →  0x006e776f6e6b6e75 ("unknown"?)
0x00007fffffccfab8│+0x0038: 0x7ebffb45ba0eea00
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────
   0x7ffff622769e <std::__cxx11::basic_string<char,+0> mov    rdi, QWORD PTR [rbx]
   0x7ffff62276a1 <std::__cxx11::basic_string<char,+0> mov    QWORD PTR [rbx+0x8], rbp
   0x7ffff62276a5 <std::__cxx11::basic_string<char,+0> mov    BYTE PTR [rdi+rbp*1], 0x0
 → 0x7ffff62276a9 <std::__cxx11::basic_string<char,+0> add    rsp, 0x8
   0x7ffff62276ad <std::__cxx11::basic_string<char,+0> mov    rax, rbx
   0x7ffff62276b0 <std::__cxx11::basic_string<char,+0> pop    rbx
   0x7ffff62276b1 <std::__cxx11::basic_string<char,+0> pop    rbp
   0x7ffff62276b2 <std::__cxx11::basic_string<char,+0> ret
   0x7ffff62276b3 <std::__cxx11::basic_string<char,+0> nop    DWORD PTR [rax+rax*1+0x0]
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "exiv2", stopped, reason: SIGINT
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x7ffff62276a9 → std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long)()
[#1] 0x7ffff681f34b → Exiv2::Internal::indent[abi:cxx11](int)(d=0x825)
[#2] 0x7ffff66eb692 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd20)
[#3] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1f)
[#4] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1e)
[#5] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1d)
[#6] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1c)
[#7] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1b)
[#8] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd1a)
[#9] 0x7ffff66ebe88 → Exiv2::(anonymous namespace)::BigTiffImage::printIFD(this=0x61300000de80, out=@0x672ac0, option=Exiv2::kpsRecursive, dir_offset=0x80, depth=0xd19)

```
## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/Exiv2/exiv2/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cdn.prod.website-files.com_5a36c2ef_20250121_015418.html ===



