=== Content from github.com_82ea0a5b_20250121_001913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F816)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F816)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security fixes #816

 Merged

[twiss](/twiss)
merged 9 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Dec 17, 2018

 Merged

# [Security fixes](#top) #816

[twiss](/twiss)
merged 9 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Dec 17, 2018

[Conversation
7](/openpgpjs/openpgpjs/pull/816)
[Commits
9](/openpgpjs/openpgpjs/pull/816/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/816/checks)
[Files changed](/openpgpjs/openpgpjs/pull/816/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![twiss](https://avatars.githubusercontent.com/u/908303?s=60&v=4)](/twiss)

Copy link

Member

### @twiss **[twiss](/twiss)** commented [Dec 14, 2018](#issue-391192344)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [twiss](/twiss)
added 2 commits
[December 11, 2018 14:05](#commits-pushed-d4d94c6)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Remove non-AES CFB quick check](/openpgpjs/openpgpjs/pull/816/commits/d4d94c6fb720701ee79fcff54ef3b1bf7c8389bb "Remove non-AES CFB quick check")`

`[d4d94c6](/openpgpjs/openpgpjs/pull/816/commits/d4d94c6fb720701ee79fcff54ef3b1bf7c8389bb)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Validate ECC public keys](/openpgpjs/openpgpjs/pull/816/commits/cb3f6447084672610f0132cc8f0a2dddcbf2c501 "Validate ECC public keys")`

`[cb3f644](/openpgpjs/openpgpjs/pull/816/commits/cb3f6447084672610f0132cc8f0a2dddcbf2c501)`

[![sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=60&v=4)](/sanjanarajan)

**[sanjanarajan](/sanjanarajan)**
reviewed
[Dec 14, 2018](#pullrequestreview-185217315)

 [View reviewed changes](/openpgpjs/openpgpjs/pull/816/files)

[src/message.js](/openpgpjs/openpgpjs/pull/816/files#diff-5837d43f11a35b2718c13f3fe36c8d209a9be90db96b860bf5a2ef45d8e7e683)
Outdated

|  |  | } catch (err) { |
| --- | --- | --- |
|  |  | util.print\_debug\_error(err); |
|  |  | await Promise.all(privateKeys.map(async function(privateKey) { |
|  |  | const primaryUser = await privateKey.getPrimaryUser(/\* symEncryptedPacket.created, userId \*/); |

Copy link

Contributor

### @sanjanarajan **[sanjanarajan](/sanjanarajan)** [Dec 14, 2018](#discussion_r241837590)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

What does this comment mean?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @twiss **[twiss](/twiss)** [Dec 14, 2018](#discussion_r241847562)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Essentially what we should be looking at is not the current preferences of the primary user, but the preferences of the user that the message was sent to at the time that the message was sent. (...that the sender knew of -- but that part is obviously impossible.)

The comment sort of serves as a reminder to do so, but it might require adding a `toUserIds` parameter to `openpgp.decrypt` and `.decryptSessionKeys`, which is a bit weird.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @sanjanarajan **[sanjanarajan](/sanjanarajan)** [Dec 14, 2018](#discussion_r241849514)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Why can't we at least pass in the time though?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @twiss **[twiss](/twiss)** [Dec 14, 2018](#discussion_r241851525)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Actually, it turns out the `symEncryptedPacket.created` property was wishful thinking, and it doesn't exist, so we don't have the time here.

Sorry, something went wrong.

All reactions

[![sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=60&v=4)](/sanjanarajan)

**[sanjanarajan](/sanjanarajan)**
reviewed
[Dec 14, 2018](#pullrequestreview-185218463)

 [View reviewed changes](/openpgpjs/openpgpjs/pull/816/files)

[src/message.js](/openpgpjs/openpgpjs/pull/816/files#diff-5837d43f11a35b2718c13f3fe36c8d209a9be90db96b860bf5a2ef45d8e7e683)
Outdated

|  |  | await Promise.all(privateKeys.map(async function(privateKey) { |
| --- | --- | --- |
|  |  | const primaryUser = await privateKey.getPrimaryUser(/\* symEncryptedPacket.created, userId \*/); |
|  |  | let algos = [ |
|  |  | enums.symmetric.aes256, // OpenPGP.js default |

Copy link

Contributor

### @sanjanarajan **[sanjanarajan](/sanjanarajan)** [Dec 14, 2018](#discussion_r241838424)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Should we replace this with the current config value? Or perhaps add that one as well?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @twiss **[twiss](/twiss)** [Dec 14, 2018](#discussion_r241849040)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yeah, maybe. The issue is that if you change the config value, other people using the normal default will throw -- so maybe it's better to find that out quickly.

Similarly, GPG will warn even with our normal default if we send an AES256 message to someone without AES256 in the preferred keys - so maybe this is just an argument to switch to 3DES as the fallback, as the spec mandates, make that non-configurable, and then add the config value to the start of the preferred algos when generating keys (and use it for password encryption).

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @sanjanarajan **[sanjanarajan](/sanjanarajan)** [Dec 17, 2018](#discussion_r242110856)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yes, let's do that

Sorry, something went wrong.

All reactions

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/f2646c4eae5a55dd6838c151b4afe2f642dcbfbc..81daed4b2a000a4a9f1b756641e9a2c3029168ac)
the
security-fixes

branch
from
[`f2646c4`](/openpgpjs/openpgpjs/commit/f2646c4eae5a55dd6838c151b4afe2f642dcbfbc) to
[`81daed4`](/openpgpjs/openpgpjs/commit/81daed4b2a000a4a9f1b756641e9a2c3029168ac)  [Compare](/openpgpjs/openpgpjs/compare/f2646c4eae5a55dd6838c151b4afe2f642dcbfbc..81daed4b2a000a4a9f1b756641e9a2c3029168ac)
[December 14, 2018 18:50](#event-2027543042)

 [twiss](/twiss)
added 6 commits
[December 17, 2018 12:27](#commits-pushed-3b9676f)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Reject messages encrypted with a symmetric algo not in preferred algos](/openpgpjs/openpgpjs/pull/816/commits/3b9676f2e9a4984d7607a8552d884dd2365478b2 "Reject messages encrypted with a symmetric algo not in preferred algos")`

`[3b9676f](/openpgpjs/openpgpjs/pull/816/commits/3b9676f2e9a4984d7607a8552d884dd2365478b2)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Check signature public key algorithm against issuer key algorithm](/openpgpjs/openpgpjs/pull/816/commits/8720adcf65ee6ec653757329208b2e89d00707f0 "Check signature public key algorithm against issuer key algorithm")`

`[8720adc](/openpgpjs/openpgpjs/pull/816/commits/8720adcf65ee6ec653757329208b2e89d00707f0)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Always look at the same literal data packet in getText() and verify()](/openpgpjs/openpgpjs/pull/816/commits/e727097bb068e348fceba31a59cd1d660b403600 "Always look at the same literal data packet in getText() and verify()")`

`[e727097](/openpgpjs/openpgpjs/pull/816/commits/e727097bb068e348fceba31a59cd1d660b403600)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Return generic error on PKESK checksum mismatch when decrypting](/openpgpjs/openpgpjs/pull/816/commits/9b83f6fcb2a89d15494e742631b01714a26c231d "Return generic error on PKESK checksum mismatch when decrypting")`

`[9b83f6f](/openpgpjs/openpgpjs/pull/816/commits/9b83f6fcb2a89d15494e742631b01714a26c231d)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Fix CMAC of the empty string](/openpgpjs/openpgpjs/pull/816/commits/06608318d4215ff9320de9630df1848853b803fe "Fix CMAC of the empty string

This is currently never called, as EAX always adds a prefix to
the CMAC'ed message.")`
 …

`[0660831](/openpgpjs/openpgpjs/pull/816/commits/06608318d4215ff9320de9630df1848853b803fe)`

```
This is currently never called, as EAX always adds a prefix to
the CMAC'ed message.
```

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Default to RFC4880bis-mandated symmetric algos](/openpgpjs/openpgpjs/pull/816/commits/926047f0b3e55467f059f90afa85282dde5db812 "Default to RFC4880bis-mandated symmetric algos")`

`[926047f](/openpgpjs/openpgpjs/pull/816/commits/926047f0b3e55467f059f90afa85282dde5db812)`

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/81daed4b2a000a4a9f1b756641e9a2c3029168ac..bb50fb2b8e5273646b16ff3583d3d00ee01c81af)
the
security-fixes

branch
from
[`81daed4`](/openpgpjs/openpgpjs/commit/81daed4b2a000a4a9f1b756641e9a2c3029168ac) to
[`bb50fb2`](/openpgpjs/openpgpjs/commit/bb50fb2b8e5273646b16ff3583d3d00ee01c81af)  [Compare](/openpgpjs/openpgpjs/compare/81daed4b2a000a4a9f1b756641e9a2c3029168ac..bb50fb2b8e5273646b16ff3583d3d00ee01c81af)
[December 17, 2018 17:28](#event-2030894024)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Add config values to preferred algorithms](/openpgpjs/openpgpjs/pull/816/commits/804e91140a83cdc1e2d8477b690a756162fd8102 "Add config values to preferred algorithms")`

`[804e911](/openpgpjs/openpgpjs/pull/816/commits/804e91140a83cdc1e2d8477b690a756162fd8102)`

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/bb50fb2b8e5273646b16ff3583d3d00ee01c81af..804e91140a83cdc1e2d8477b690a756162fd8102)
the
security-fixes

branch
from
[`bb50fb2`](/openpgpjs/openpgpjs/commit/bb50fb2b8e5273646b16ff3583d3d00ee01c81af) to
[`804e911`](/openpgpjs/openpgpjs/commit/804e91140a83cdc1e2d8477b690a756162fd8102)  [Compare](/openpgpjs/openpgpjs/compare/bb50fb2b8e5273646b16ff3583d3d00ee01c81af..804e91140a83cdc1e2d8477b690a756162fd8102)
[December 17, 2018 17:54](#event-2030953022)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
merged commit [`b1b1994`](/openpgpjs/openpgpjs/commit/b1b19946d83da39969fdc22340e32b1d58a3f047)
into
openpgpjs:master

[Dec 17, 2018](https://github.com/openpgpjs/openpgpjs/pull/816#event-2030955836)

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
deleted the
security-fixes

branch
[December 17, 2018 17:55](#event-2030955961)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F816)

Reviewers

[![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=40&v=4)](/sanjanarajan) [sanjanarajan](/sanjanarajan)

sanjanarajan left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=52&v=4)](/twiss) [![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=52&v=4)](/sanjanarajan)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_887b10f0_20250121_001909.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797%2Fcommits%2F327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797%2Fcommits%2F327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

# Security fixes #797

 Merged

[sanjanarajan](/sanjanarajan)
merged 6 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Nov 5, 2018

[Conversation
0](/openpgpjs/openpgpjs/pull/797)
[Commits
6](/openpgpjs/openpgpjs/pull/797/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/797/checks)
[Files changed](/openpgpjs/openpgpjs/pull/797/files)

 Merged

# [Security fixes](#top) #797

 Show file tree

 Hide file tree

Changes from **1 commit**

Commits

[Show all changes

6 commits](/openpgpjs/openpgpjs/pull/797/files)
Select commit
Hold shift + click to select a range

[`327d3e5`
Only accept binary or text signatures when verifying messages

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)
[`47138ee`
Don't trust unhashed signature subpackets

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1)
[`8c97112`
Throw on critical unknown signature subpackets

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/8c971124499e9b6e5753ffcbe8e63388b6aff003)
[`8fa3aad`
Add and require primary key binding signatures on signing keys

twiss Oct 30, 2018](/openpgpjs/openpgpjs/pull/797/commits/8fa3aadea235aba8e0b8bb36f9602c6d6e12e6d8)
[`d314a20`
Don't return keys with an authorized revocation key

twiss Oct 30, 2018](/openpgpjs/openpgpjs/pull/797/commits/d314a20e0fd9261683517b55c4aede444a88f8f8)
[`9a7fe9c`
Bump S2K iteration count parameter

twiss Nov 1, 2018](/openpgpjs/openpgpjs/pull/797/commits/9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)

**File filter**

### Filter by extension

Filter by extension

.js
(4)

All 1 file type selected

---

Viewed files

[Clear filters](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

* src

  + src/message.js
    [message.js](#diff-5837d43f11a35b2718c13f3fe36c8d209a9be90db96b860bf5a2ef45d8e7e683)
* test

  + security

    - test/security/index.js
      [index.js](#diff-5b5ee61fd0e27256ce40b7add52a83b889bc1cea7a5214388bda8bc377d5a41f)
    - test/security/message\_signature\_bypass.js
      [message\_signature\_bypass.js](#diff-49b86fb70dbbedc3c2d3c416a78622e388f541f94d68f0ad3318eb5dfc7ec320)
  + test/unittests.js
    [unittests.js](#diff-5855c680d219747808661efaaf939377a52d69c36cca0ceb3850f93f607982eb)

Prev

 [Next](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1)Next commit

Only accept binary or text signatures when verifying messages

* Loading branch information

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

[twiss](/openpgpjs/openpgpjs/commits?author=twiss "View all commits by twiss")
committed
Nov 5, 2018

commit 327d3e5392a6f59a4270569d200c7f7a2bfc4cbc

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[src/message.js](#diff-5837d43f11a35b2718c13f3fe36c8d209a9be90db96b860bf5a2ef45d8e7e683 "src/message.js")

Show comments

[View file](/twiss/openpgpjs/blob/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc/src/message.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -656,7 +656,9 @@ async function createVerificationObject(signature, literalDataList, keys, date=n |
|  |  | \* @async |
|  |  | \*/ |
|  |  | export async function createVerificationObjects(signatureList, literalDataList, keys, date=new Date()) { |
|  |  | return Promise.all(signatureList.map(async function(signature) { |
|  |  | return Promise.all(signatureList.filter(function(signature) { |
|  |  | return ['text', 'binary'].includes(enums.read(enums.signature, signature.signatureType)); |
|  |  | }).map(async function(signature) { |
|  |  | return createVerificationObject(signature, literalDataList, keys, date); |
|  |  | })); |
|  |  | } |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[test/security/index.js](#diff-5b5ee61fd0e27256ce40b7add52a83b889bc1cea7a5214388bda8bc377d5a41f "test/security/index.js")

Show comments

[View file](/twiss/openpgpjs/blob/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc/test/security/index.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,3 @@ |
|  |  | describe('Security', function () { |
|  |  | require('./message\_signature\_bypass'); |
|  |  | }); |

112 changes: 112 additions & 0 deletions

112
[test/security/message\_signature\_bypass.js](#diff-49b86fb70dbbedc3c2d3c416a78622e388f541f94d68f0ad3318eb5dfc7ec320 "test/security/message_signature_bypass.js")

Show comments

[View file](/twiss/openpgpjs/blob/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc/test/security/message_signature_bypass.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,112 @@ |
|  |  | const openpgp = typeof window !== 'undefined' && window.openpgp ? window.openpgp : require('../../dist/openpgp'); |
|  |  |  |
|  |  | const { key, cleartext, util, packet: { Signature } } = openpgp; |
|  |  |  |
|  |  | const chai = require('chai'); |
|  |  | chai.use(require('chai-as-promised')); |
|  |  |  |
|  |  | const expect = chai.expect; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* public key of another user. |
|  |  | \*/ |
|  |  | const OTHERPUBKEY = ` |
|  |  | -----BEGIN PGP PUBLIC KEY BLOCK----- |
|  |  | Version: OpenPGP.js VERSION |
|  |  | Comment: https://openpgpjs.org |
|  |  |  |
|  |  | xsBNBFuqNY0BCADFUCnl03vimEQRs7mtDIp0g6tItuguhJJu1/QjXwTXUHZg |
|  |  | pZosOPkGOR1EubydjYz4kvAnZ5r9cWA4xQ96rBdvj/kIaP+oJKLB1jXwh4Ft |
|  |  | +8YT4mVU2yWLu7U2p4tSyRoM5VCDEqG64OcbZMwEdDKf8t6JTjYTtEfPfW5R |
|  |  | 4hy8NjPYOx0Jw8MG+U0aP4WA1xsMXFP/VWF1IseEcVIWKs/VroJc5Xe80QDN |
|  |  | hRtKTRVJV/wTnkao2MLcq/hgOfhO28NjnxVlX06O/XTWdElA7CCi1Zg1/BZ+ |
|  |  | r2XuuE1J2DjERfTokFzkKnMlGK9zXn0LxPnAJAIfu33/SFuAZcVu4UEJABEB |
|  |  | AAHNHVRlc3RpIFRlc3QgPHRlc3RAZXhhbXBsZS5jb20+wsB1BBABCAApBQJb |
|  |  | qjWcBgsJBwgDAgkQVSCLLRis484EFQgKAgMWAgECGQECGwMCHgEAAGNXB/4g |
|  |  | DX082p83RfMmBv8hRN1V9ruPAvlxDWNBHb5dc1Y67yrBXOLMtaSauSZKrbf1 |
|  |  | moPDHT2eoLl7cV3BQbXWp+hiMZ4W53ZFJt26Kwwwf1yVRAZME7VRNwqW0aJv |
|  |  | FKgCq7XTgJ61UYNhc31bLH0eVcfCkAExfwqZlwTWRzRSCqr0NL0XZVakJE6F |
|  |  | al1Y+uN7CEr0/vbc6uSuo0hyZwxAw+Iynd5cO9PRXSssAm4IaulSnYUd96r2 |
|  |  | l8jsa+p6ooBYPotnLQ9fdd457JMoc8jDHf4m+P9/ZiWpycCB0DgUtNw1wH2T |
|  |  | DHYf+2lfGGoA3osuHeJJfZfJujbKW5L7ZMNJ23tSzsBNBFuqNY0BB/9XKYzS |
|  |  | PdHC/dXoBC9un3YLCcUX6LMNnaQMryVONYKFE1Rt0/si9XtnIDqyBrTr3LRi |
|  |  | D+GIR+b7zCXOGkvmjztblD2P3SweCudPIbVLxePI+SfyjRs9EsMOrEPymN7U |
|  |  | u/CU7jefvNBKvvMHi1m1Ibqg/A+ZheqJ+xBjSQM88dWsY/XB/jh7PGAM0QEu |
|  |  | ezafNwlUUNnXyYRuC3P4h66OIJcDPcfaao3uAuJ/C81E8ttuws3c08kudd/A |
|  |  | szIGpPtxAakimiWVHa0ceKi3exXXjRDrufroPcV3+Gbn4J8NqcUPRhB3L3CD |
|  |  | rCivRme8qGEYh+ADPLy88SytdtCr+6W4hiQVABEBAAHCwF8EGAEIABMFAluq |
|  |  | NZ0JEFUgiy0YrOPOAhsMAABebggAxANqkwS/Ag3NQLUu/wNZMMifZAxpFIWo |
|  |  | CQQrCOU94OSsUKz8Q11yoOvsQN3T4CSL8dG5DbIucnHsx39jVeTniG6P3p9f |
|  |  | NE/lq7RtLnXjVgGYpPNNUbLcOfXaCDhmS4GEunwTsVlsmEqyfLniKLG8to5Q |
|  |  | 6f/wGPJRvYB8rgLfVGV3DCvILg/CMzkceM9ia6jDQeHHwnoFVXnlsRAgQefJ |
|  |  | rT5hVim4Wzg/5Lxt9Efry0k1ZhT0kondF1qNMv0wKxIJ+/gDNT2ZP4RIr1Kl |
|  |  | eu6a8CH841yfF0+r5RV9xOky0jxwGgcxT29c8DBoawjXu6TtJ/SP8UrscttA |
|  |  | bVLYdBmWLw== |
|  |  | =nMyV |
|  |  | -----END PGP PUBLIC KEY BLOCK-----`; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* an original unmodified message as a template. |
|  |  | \*/ |
|  |  | const ORIGINAL = ` |
|  |  | -----BEGIN PGP SIGNED MESSAGE----- |
|  |  | Hash: SHA256 |
|  |  |  |
|  |  | You owe me € 10 |
|  |  | -----BEGIN PGP SIGNATURE----- |
|  |  | Version: OpenPGP.js VERSION |
|  |  | Comment: https://openpgpjs.org |
|  |  |  |
|  |  | wsBcBAEBCAAQBQJbq0iICRBVIIstGKzjzgAAeV0H/3ZxWuEV+2PNXHR+PdxX |
|  |  | WRxjk6Zu+jjpb/iRS8IynRoe3iDaai3+iiAHM1GsHvOIBVJU6Bjx1ZyyEI0a |
|  |  | dDg/yj3LBqBW9U3AiGpsXPfuyLKYIHfPbrygEleRIQKh7+iwNmn9ScVvzJrl |
|  |  | hUurlZxx1mWbERAchwsrcZpwFCdfjJ/C9sblTxgnsm1YlYZNkf95DFtRnVO5 |
|  |  | prUuOjqJ0bA7bxg5GA4FQskRPIQ0ioZ6DyDi2IU3rdVEOs2Pc8S0EsD9K7af |
|  |  | vO5oXKiJsyUN5EXEI8kYRulP1l0kvEWVTlnY2ek1qS637RkBI+DHLcXV5Hcu |
|  |  | fhGyl7nA7UCwgsqf7ZPBhRg= |
|  |  | =nbjQ |
|  |  | -----END PGP SIGNATURE-----`; |
|  |  | async function getOtherPubKey() { |
|  |  | return (await key.readArmored(OTHERPUBKEY)).keys[0]; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The "standalone" signature signed by the victim. |
|  |  | \*/ |
|  |  | const STANDALONE\_PKT = util.b64\_to\_Uint8Array(` |
|  |  | BAIBCAAQBQJbq3MKCRBVIIstGKzjzgAAWdoIALgj7OuhuuAWr6WEvGfvkx3e |
|  |  | Fn/mg76lh2Hawxq6ryI6+kzUH+YJsG94CfLgGuh5LghZFBnlkdZS11gK87fN |
|  |  | +ifmPdSDj8fsKqSFdX1sHGwzvzBcuPt+qhtHrACCWwiiBgajIOmIczKUlX4D |
|  |  | ASBkthx0o9Qb/r3dT91zmrniIK5I0yqe34/1rsHhOAf8ds2EubupFJJqFOb1 |
|  |  | qssMWE+jBrTREoD/EH5q7un2jEGccITcVQSZCqfjHT4EL6dF/bmuggf7wV/E |
|  |  | QLXfFIJS6cZczK86XW1pGaXBKRLvQXYa/eRWHKcGlrujdFKzJYRoT6LVDk8T |
|  |  | jhAfE9q2ElqlaAvZZYw=`); |
|  |  | async function fakeSignature() { |
|  |  | // read the template and modify the text to |
|  |  | // invalidate the signature. |
|  |  | let fake = await cleartext.readArmored( |
|  |  | ORIGINAL.replace( |
|  |  | 'You owe me', |
|  |  | 'I owe you')); |
|  |  | // read the standalone signature packet |
|  |  | const tmp = new Signature(); |
|  |  | await tmp.read(STANDALONE\_PKT); |
|  |  |  |
|  |  | // replace the "text" signature with the |
|  |  | // "standalone" signature |
|  |  | fake.signature.packets[0] = tmp; |
|  |  | const faked\_armored = await fake.armor(); |
|  |  | // re-read the message to eliminate any |
|  |  | // behaviour due to cached values. |
|  |  | fake = await cleartext.readArmored(faked\_armored); |
|  |  | // faked message now verifies correctly |
|  |  | const res = await openpgp.verify({ |
|  |  | message: fake, |
|  |  | publicKeys: await getOtherPubKey(), |
|  |  | streaming: false |
|  |  | }); |
|  |  | const { signatures } = res; |
|  |  | expect(signatures).to.have.length(0); |
|  |  | } |
|  |  |  |
|  |  | it('Does not accept non-binary/text signatures', fakeSignature); |

1 change: 1 addition & 0 deletions

1
[test/unittests.js](#diff-5855c680d219747808661efaaf939377a52d69c36cca0ceb3850f93f607982eb "test/unittests.js")

Show comments

[View file](/twiss/openpgpjs/blob/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc/test/unittests.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,4 +54,5 @@ describe('Unit Tests', function () { |
|  |  | require('./crypto'); |
|  |  | require('./general'); |
|  |  | require('./worker'); |
|  |  | require('./security'); |
|  |  | }); |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sec-consult.com_fcb68771_20250121_001916.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/kritische-schwachstellen-in-openpgp-js/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities In Openpgp.js
# Multiple Vulnerabilities In Openpgp.js

Title

Multiple vulnerabilities

Product

OpenPGP.js

Vulnerable Version

<=4.2.0

Fixed Version

4.3.0

CVE Number

CVE-2019-9153, CVE-2019-9154, CVE-2019-9155

Impact

critical

Homepage

[https://openpgpjs.org](https://openpgpjs.org "https://openpgpjs.org")

Found

31.12.2018

By

Wolfgang Ettlinger (Office Vienna) | SEC Consult Vulnerability Lab

In the course of a project aimed at improving the browser plugin “Mailvelope” SEC Consult was tasked by the German Bundesamt für Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope and OpenPGP.js software. During this engagement several vulnerabilities were found, that e.g. in specific scenarios could have allowed an attacker to steal a victim’s private key.

## Vendor Description

*“This project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device. Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library). The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications. It should allow you to sign, encrypt, decrypt, and verify any kind of text – in particular e-mails – as well as managing keys.”*

Source: [https://openpgpjs.org](https://openpgpjs.org/)

## Business Recommendation

SEC Consult was tasked by the German Bundesamt für Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope browser extension as well as the parts of OpenPGP.js used by Mailvelope. During the course of this audit multiple security vulnerabilities with severities ranging from minor to critical have been identified. Some of the vulnerabilities with higher severity are published as an advisory. A more detailed description of the vulnerabilities as well as a description of other vulnerabilities found during this project can be found in the report that has been made available by the BSI:

[https://www.bsi.bund.de/[…]/Publications/Studies/Mailvelope\_Extensions/Mailvelope\_Extensions\_pdf.html](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html)

## Vulnerability Overview/description

### 1) Message Signature Bypass (CVE-2019-9153)

OpenPGP defines several types of signatures with each type carrying a different semantic. Signatures are implemented as packets and each signature packet can contain subpackets.

To indicate a message signature (e.g. a signed e-mail), the signature type “text” is used. The text signature packet verifies both its subpackets as well as the signed text.

During verification of a message signature, OpenPGP.js does not verify that the signature is of type text. An attacker could therefore construct a message that, instead of a text signature, contains a signature of another type. As the input required for the verification process depends on the signature type, an attacker could use a signature with a type that only verifies its subpackets and does not require additional input.

An attacker could construct a message that contains a valid “standalone” or “timestamp” signature packet signed by another person. OpenPGP.js would incorrectly assume this message to be signed by that person.

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

OpenPGP signature subpackets contain information related to a signature (e.g. the creation timestamp). These subpackets may appear in a “hashed” and “unhashed” subpacket container. While the information in the hashed subpackets is signed, the unhashed subpackets are not cryptographically protected. OpenPGP.js however does not distinguish between these subpackets. When parsing a signature packet, the signed information is parsed first. When the unhashed packets are read, the information from the hashed packets is overwritten.

An attacker could arbitrarily modify the contents of e.g. a key certification signature or revocation signature. As a result, the attacker could e.g. convince a victim to use an obsolete key for encryption.

### 3) Invalid Curve Attack (CVE-2019-9155)

The implementation of the Elliptic Curve Diffie-Hellman (ECDH) key exchange algorithm does not verify that the communication partner’s public key is valid (i.e. that the point lies on the elliptic curve). This causes the application to implicitly calculate the resulting secret key not based on the specified elliptic curve but rather an altered curve. By carefully choosing multiple altered curves (and therefore the resulting public key), and observing whether decryption fails, an attacker can extract the victim’s private key.

This attack requires the attacker to be able to provide multiple manipulated messages and to observe whether decryption fails.

## Proof Of Concept

### 1) Message Signature Bypass (CVE-2019-9153)

The script message\_signature\_bypass.js (see below) demonstrates this issue. The function fakeSignature reads a signed message and replaces its content. It then replaces the signature with a standalone signature of the victim.

Source code ([SEC\_Consult\_BSI\_Mailvelope-signature\_bypass.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-message_signature_bypass.txt))

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

The script unsigned\_subpackets.js demonstrates this issue. It parses an expired key and adds additional unhashed subpackets that specify a different key expiration. When this newly-created key is parsed, it can be used for encrypting messages.

Source code ([SEC\_Consult\_BSI\_Mailvelope-unsigned\_subpackets.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-unsigned_subpackets.txt))

### 3) Invalid Curve Attack (CVE-2019-9155)

The script in invalid\_curve\_attack.js demonstrates this issue. Note that since OpenPGP uses only the x-coordinate of the secret point, the oracle succeeds both when it calculates the same point as the attacker or when it calculates its inverse point. Therefore, the Chinese Remainder Theorem cannot be directly applied to the result. Instead, the script demonstrates that the remainders of the private key matches the corresponding gathered remainder. In order to fully implement this attack, an attacker could verify the results using other public key points with a non-prime order.

Source code ([SEC\_Consult\_BSI\_Mailvelope-invalid\_curve\_attack.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-invalid_curve_attack.txt))

## Vulnerable / Tested Versions

The version 4.1.2 was found to be vulnerable. The Invalid Curve attack is also viable against version 4.2.0.

## Vendor Contact Timeline

Vendor communication was conducted by the BSI as well as their contractors.

## Solution

Upgrade to the latest version of OpenPGP.js.

## Workaround

None.

## Advisory URL

[https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html](/vulnerability-lab/)

EOF Wolfgang Ettlinger / @2019

### Contact

Interested to work with the experts of SEC Consult? Send us your application.

Want to improve your own cyber security with the experts of SEC Consult?

[contact us](/contact/)[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from packetstormsecurity.com_7eab44d3_20250121_001906.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.bsi.bund.de_68bcc6b0_20250121_022703.html ===


# Navigation and service

*Go to:*

* [Content](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#content)
* [Main Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646# )
* [Search](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#search)

## Menu

* [Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#nav)

## Service menu

## Servicemenue

* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
* **English**
* [Gebär­den­sprache](DE/Service/Gebaerdensprache/gebaerdensprache_node.html)
* [Le­ichte Sprache](DE/Service/LeichteSprache/leichtesprache_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Lo­gin](Login/Login/login_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo.svg?__blob=normal&v=4)](DE/Home/home_node.html "to homepage")

[![Logo "Deutschland Digital Sicher](/_config/AdditionalLogo.svg?__blob=value&v=6)](DE/Home/home_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo-bsi-smaller.svg?__blob=normal&v=3)](DE/Home/home_node.html "to homepage")

## Main Menu

* [Das BSI](DE/Das-BSI/das-bsi_node.html "Das BSI")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Das BSI

  + [Cy­ber­na­tion Deutsch­land](DE/Das-BSI/Cybernation/cybernation_node.html)
  + [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
  + [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
  + [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
  + [Zeit­strahl](DE/Das-BSI/Zeitstrahl/BSI-Zeitstrahl_node.html)
  + [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
  + [Umwel­terk­lärung](DE/Das-BSI/Nachhaltigkeit/EMAS/umwelterklaerung_node.html "Umwelterklärung")
* [The­men](DE/Themen/themen_node.html "Themen")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### All topics

  + [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
    #### Our top themes

    - [Na­tionales IT-Lagezen­trum](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/Nationales-IT-Lagezentrum/nationales-it-lagezentrum_node.html "Nationales IT-Lagezentrum")
    - [CERT-Bund](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/CERT-Bund/cert-bund_node.html "CERT-Bund")
    - [Zusam­me­nar­beit mit Bund und Län­dern](DE/Themen/Oeffentliche-Verwaltung/Zusammenarbeit_mit_Bund_und_Laendern/bund-laender-zusammenarbeit_node.html "Zusammenarbeit mit Bund und Ländern")
    - [Sicher­heits­ber­atung](DE/Themen/Oeffentliche-Verwaltung/Sicherheitsberatung/sicherheitsberatung_node.html "Sicherheitsberatung")
    - [Min­dest­stan­dards Bund](DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/Mindeststandards_node.html "Mindeststandards")[All topics](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html)
  + [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
    #### Our top themes

    - [Threat In­tel­li­gence](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Threat-Intelligence/threat-intelligence_node.html "Threat Intelligence")
    - [IT-Sicher­heitskennze­ichen](DE/Themen/Unternehmen-und-Organisationen/IT-Sicherheitskennzeichen/it-sicherheitskennzeichen_node.html "IT-Sicherheitskennzeichen")
    - [IT-Grund­schutz](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/it-grundschutz_node.html "IT-Grundschutz")
    - [Zer­ti­fizierung und An­erken­nung](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/zertifizierung-und-anerkennung_node.html "Zertifizierung und Anerkennung")
    - [Ran­somware An­griffe](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)[All topics](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html)
  + [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
    #### Our top themes

    - [Sicher­heit beim On­li­neshop­ping](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Online-Banking-Online-Shopping-und-mobil-bezahlen/Online-Shopping/online-shopping_node.html "Sicherheit beim Onlineshopping")
    - [On­line-Ac­count ab­sich­ern](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Cyber-Sicherheitsempfehlungen/Accountschutz/accountschutz_node.html "Accountschutz")
    - [Bedro­hun­gen durch Cy­ber-Krim­inelle](DE/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/methoden-der-cyber-kriminalitaet_node.html "Methoden der Cyber-Kriminalität")
    - [E-Mail, So­cial Me­dia, Mes­sen­ger und Co.](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Onlinekommunikation/onlinekommunikation_node.html "Onlinekommunikation")
    - [Smart Me­ter­ing & Lade­in­fras­truk­tur](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Internet-der-Dinge-Smart-leben/Smart-Meter-Gateway/smart-meter-gateway_node.html "Smart-Meter-Gateway")[All topics](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html)
  + [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")
    #### Our top themes

    - [NIS-2-reg­ulierte Un­ternehmen](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html "NIS-2-regulierte Unternehmen")
    - [Ak­tuelle In­for­ma­tio­nen aus dem KRI­TIS-Fach­bere­ich](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-aktuell/kritis-aktuell_node.html "Aktuelle Informationen aus dem KRITIS-Fachbereich")
    - [KRI­TIS-FAQ](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-FAQ/kritis-faq_node.html "KRITIS-FAQ")
    - [Ser­vice für KRI­TIS-Be­treiber](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/Service-fuer-KRITIS-Betreiber/service-fuer-kritis-betreiber_node.html "Service für KRITIS-Betreiber")
    - [UP KRI­TIS](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/UP-KRITIS/up-kritis_node.html "UP KRITIS")[All topics](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### IT-Sicherheitsvorfall

  + [Ver­braucherin­nen und Ver­brauch­er](DE/IT-Sicherheitsvorfall/Buergerinnen-und-Buerger/buergerinnen-und-buerger_node.html "Verbraucherinnen und Verbraucher")
  + [Un­ternehmen](DE/IT-Sicherheitsvorfall/Unternehmen/unternehmen_node.html "Unternehmen")
  + [Kri­tis­che In­fras­truk­turen und meldepflichtige Un­ternehmen](DE/IT-Sicherheitsvorfall/Kritische-Infrastrukturen-und-meldepflichtige-Unternehmen/kritische-infrastrukturen-und-meldepflichtige-unternehmen_node.html "Kritische Infrastrukturen und meldepflichtige Unternehmen")
  + [CVD-Richtlin­ie des BSI](DE/IT-Sicherheitsvorfall/IT-Schwachstellen/it-schwachstellen_node.html "CVD-Richtlinie des BSI")
* [Kar­riere](DE/Karriere/karriere_node.html "Karriere")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Karriere

  + [Willkom­men im #TeamB­SI](DE/Karriere/Team_BSI/team_bsi_node.html "Willkommen im Team BSI")
  + [Warum BSI?](DE/Karriere/Warum_BSI/warum_BSI_node.html "Warum BSI?")
  + [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
  + [Ein­stieg](DE/Karriere/Einstieg/einstieg_node.html "Einstieg")
  + [FAQ](DE/Karriere/FAQ/faq_node.html "FAQ")
  + [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
  + [Ter­mine](DE/Karriere/Termine/termine_node.html "Termine")
  + [Kon­takt Per­son­al­gewin­nung](DE/Karriere/Kontakt/kontakt_node.html "Kontakt Personalgewinnung")
* [Ser­vice](DE/Service-Navi/service-navi_node.html "Service")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Service

  + [Presse](DE/Service-Navi/Presse/presse_node.html "Presse")
  + [Mediathek](SiteGlobals/Forms/Suche/Mediathek_Formular.html?nn=132646)
  + [Pub­lika­tio­nen](DE/Service-Navi/Publikationen/publikationen_node.html "Publikationen")
  + [Newslet­ter und So­cial Me­dia](DE/Service-Navi/Abonnements/abonnements_node.html "Newsletter und Social Media")
  + [Ve­r­anstal­tun­gen](DE/Service-Navi/Veranstaltungen/veranstaltungen_node.html "Veranstaltungen")
  + [Ver­gaben an Ex­terne](DE/Service-Navi/Vergaben-an-Externe/vergaben-an-externe_node.html "Vergaben an Externe")
  + [Die E-Rech­nung im BSI](DE/Service-Navi/Die-E-Rechnung-im-BSI/die-e-rechnung-im-bsi_node.html "Die E-Rechnung im BSI")
  + [Kosten für Leis­tun­gen des BSI](DE/Service-Navi/Hinweise-Kosten/Hinweise-Kosten_node.html "Kosten für Leistungen des BSI")
  + [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
  + [Fra­gen & Antworten](DE/Service-Navi/FAQ/faq_node.html "Fragen & Antworten")
* [![SucheOeffnen](/SiteGlobals/Frontend/Images/icons/search.svg?__blob=normal&v=3)
  ![SucheSchliessen](/SiteGlobals/Frontend/Images/icons/search-blue.svg?__blob=normal&v=3)
  SucheOeffnen](SiteGlobals/Forms/Suche/Servicesuche_Formular.html?nn=132646)

## Search

Search

### Frequently searched

* [Regulierung nach NIS-2](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html)
* [Gefährdungen durch Ransomware](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)
* [Zertifizierung Produkte & Personen (FAQ)](DE/Service-Navi/FAQ/Zertifizierung/faq_node.html)
* [Zertifizierung Common Criteria](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/Zertifizierung-von-Produkten/Zertifizierung-nach-CC/zertifizierung-nach-cc_node.html)
* [Elektronische Identitäten](DE/Themen/Oeffentliche-Verwaltung/Elektronische-Identitaeten/elektronische-identitaeten_node.html)
* [Digitaler Verbraucherschutz](DE/Themen/Verbraucherinnen-und-Verbraucher/Leistungen-und-Kooperationen/Digitaler-Verbraucherschutz/digitaler-verbraucherschutz_node.html)
* [Technische Richtlinien](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/technische-richtlinien_node.html)
* [Kritische Infrastrukturen](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [Künstliche Intelligenz](DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Kuenstliche-Intelligenz/kuenstliche-intelligenz_node.html)

![Close](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)

## You are here:

1. [to homepage](DE/Home/home_node.html "to homepage")
2. **Mailvelope Extensions Security Audit**

# Mailvelope Extensions Security Audit

**date**
30.07.2019

![Bild-Dokument für das Frontend](/SiteGlobals/Frontend/Images/kopfbereich.png?__blob=normal&v=9 "Bild-Dokument für das Frontend")

 ![Cover Mailvelope Extensions Security Audit](/SharedDocs/Bilder/EN/Publications/cover/Mailvelope_Extensions.png?__blob=normal&v=1 "Cover Mailvelope Extensions Security Audit")

SEC Consult was tasked by the Federal Office for Information Security (german abbreviated as BSI) with performing a security audit and source code review of the Mailvelope Google Chrome and Firefox Add-ons, the OpenPGP.js library as well as the GPGME-json utility. Objective of this review was to reveal common security issues and to offer suggestions for improvements. The focus of the audit was to identify:

* vulnerabilities in the cryptographic algorithms,
* routines that could cause user data compromise,
* and routines that could be abused for user monitoring.

The vulnerabilities outlined in this document are subject to a coordinated vulnerability disclosure process and the appropriate maintainers have been notified. [Most of the vulnerabilities are patched, while some uncritical vulnerabilities are not yet addressed. Passages in this report regarding unpatched vulnerabilities are hence expunged.]

The following chapter summarizes the scope and timetable of the audit, the results of the audit and outlines the measures recommended by SEC Consult.

* [PDF, 1MB download](/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.pdf?__blob=publicationFile&v=1 "Opens in new window")

# Footer

Seite drucken

## Subnavigation of all website sections

### Themen

* [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
* [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
* [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
* [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")

### Das BSI

* [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
* [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
* [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
* [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")

### Karriere

* [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
* [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
* [Studi­um und Aus­bil­dung](DE/Karriere/Einstieg/Studium-und-Ausbildung/studium-und-ausbildung_node.html "Studium und Ausbildung")

### IT-Sicherheitsvorfall

* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")

### Follow us

* [Das BSI auf Facebook](https://www.facebook.com/bsi.fuer.buerger "External link: Das BSI auf Facebook (Opens new window)")
* [Das BSI auf 'X'](https://x.com/BSI_Bund "External link: Das BSI auf X (Opens new window)")
* [BSI-Instagram](https://www.instagram.com/bsi_bund "External link: Das BSI auf Instagram (Opens new window)")
* [Das BSI auf LinkedIn](https://de.linkedin.com/company/bsibund "External link: Das BSI auf LinkedIn (Opens new window)")
* [Das BSI auf Mastodon](https://social.bund.de/%40bsi/ "External link: Das BSI auf Mastodon (Opens new window)")
* [Newsletterverwaltung](DE/Service-Navi/Abonnements/Newsletter/newsletter_node.html "Newsletterverwaltung")
* [Das BSI auf YouTube](https://www.youtube.com/channel/UC_VgLyJQsChxKfDJcdI-Tcg "External link: Das BSI auf YouTube (Opens new window)")
* [Das BSI auf Xing](https://www.xing.com/pages/bsibund "External link: Das BSI auf Xing (Opens new window)")
* [RSS](DE/Service-Navi/Abonnements/RSS/rss_node.html "RSS")

[![Logo Zertifikat IT-Grundschutz ISO 27001](/SharedDocs/Bilder/DE/BSI/Logos/Logo_Zertifizierung-ISO27001_IT-Grundschutz.svg?__blob=normal "Logo Zertifikat IT-Grundschutz ISO 27001 (Quelle: BSI)")](./DE/Service/Impressum/impressum_node.html#ISO)

* [Im­pres­sum](DE/Service/Impressum/impressum_node.html)
* [Daten­schutz](DE/Service/Datenschutz/datenschutz_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Bar­ri­ere­frei­heit](DE/Service/Barrierefreiheit/barrierefreiheit_node.html)

© Federal Office for Information Security

Top
[TOP](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#Start "Top")

## Hinweis zur Verwendung von Cookies

Das BSI speichert keine personenbezogenen Daten der Webseitenbesucher. Details in unserer [Datenschutzerklärung](DE/Service/Datenschutz/datenschutz_node.html "Datenschutz")

OK

![](https://piwik.itzbund.de/piwik.php?idsite=35&rec=1&url=https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646)



=== Content from www.bsi.bund.de_9555648f_20250121_001918.html ===


# Navigation and service

*Go to:*

* [Content](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#content)
* [Main Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646# )
* [Search](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#search)

## Menu

* [Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#nav)

## Service menu

## Servicemenue

* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
* **English**
* [Gebär­den­sprache](DE/Service/Gebaerdensprache/gebaerdensprache_node.html)
* [Le­ichte Sprache](DE/Service/LeichteSprache/leichtesprache_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Lo­gin](Login/Login/login_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo.svg?__blob=normal&v=4)](DE/Home/home_node.html "to homepage")

[![Logo "Deutschland Digital Sicher](/_config/AdditionalLogo.svg?__blob=value&v=6)](DE/Home/home_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo-bsi-smaller.svg?__blob=normal&v=3)](DE/Home/home_node.html "to homepage")

## Main Menu

* [Das BSI](DE/Das-BSI/das-bsi_node.html "Das BSI")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Das BSI

  + [Cy­ber­na­tion Deutsch­land](DE/Das-BSI/Cybernation/cybernation_node.html)
  + [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
  + [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
  + [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
  + [Zeit­strahl](DE/Das-BSI/Zeitstrahl/BSI-Zeitstrahl_node.html)
  + [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
  + [Umwel­terk­lärung](DE/Das-BSI/Nachhaltigkeit/EMAS/umwelterklaerung_node.html "Umwelterklärung")
* [The­men](DE/Themen/themen_node.html "Themen")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### All topics

  + [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
    #### Our top themes

    - [Na­tionales IT-Lagezen­trum](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/Nationales-IT-Lagezentrum/nationales-it-lagezentrum_node.html "Nationales IT-Lagezentrum")
    - [CERT-Bund](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/CERT-Bund/cert-bund_node.html "CERT-Bund")
    - [Zusam­me­nar­beit mit Bund und Län­dern](DE/Themen/Oeffentliche-Verwaltung/Zusammenarbeit_mit_Bund_und_Laendern/bund-laender-zusammenarbeit_node.html "Zusammenarbeit mit Bund und Ländern")
    - [Sicher­heits­ber­atung](DE/Themen/Oeffentliche-Verwaltung/Sicherheitsberatung/sicherheitsberatung_node.html "Sicherheitsberatung")
    - [Min­dest­stan­dards Bund](DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/Mindeststandards_node.html "Mindeststandards")[All topics](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html)
  + [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
    #### Our top themes

    - [Threat In­tel­li­gence](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Threat-Intelligence/threat-intelligence_node.html "Threat Intelligence")
    - [IT-Sicher­heitskennze­ichen](DE/Themen/Unternehmen-und-Organisationen/IT-Sicherheitskennzeichen/it-sicherheitskennzeichen_node.html "IT-Sicherheitskennzeichen")
    - [IT-Grund­schutz](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/it-grundschutz_node.html "IT-Grundschutz")
    - [Zer­ti­fizierung und An­erken­nung](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/zertifizierung-und-anerkennung_node.html "Zertifizierung und Anerkennung")
    - [Ran­somware An­griffe](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)[All topics](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html)
  + [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
    #### Our top themes

    - [Sicher­heit beim On­li­neshop­ping](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Online-Banking-Online-Shopping-und-mobil-bezahlen/Online-Shopping/online-shopping_node.html "Sicherheit beim Onlineshopping")
    - [On­line-Ac­count ab­sich­ern](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Cyber-Sicherheitsempfehlungen/Accountschutz/accountschutz_node.html "Accountschutz")
    - [Bedro­hun­gen durch Cy­ber-Krim­inelle](DE/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/methoden-der-cyber-kriminalitaet_node.html "Methoden der Cyber-Kriminalität")
    - [E-Mail, So­cial Me­dia, Mes­sen­ger und Co.](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Onlinekommunikation/onlinekommunikation_node.html "Onlinekommunikation")
    - [Smart Me­ter­ing & Lade­in­fras­truk­tur](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Internet-der-Dinge-Smart-leben/Smart-Meter-Gateway/smart-meter-gateway_node.html "Smart-Meter-Gateway")[All topics](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html)
  + [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")
    #### Our top themes

    - [NIS-2-reg­ulierte Un­ternehmen](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html "NIS-2-regulierte Unternehmen")
    - [Ak­tuelle In­for­ma­tio­nen aus dem KRI­TIS-Fach­bere­ich](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-aktuell/kritis-aktuell_node.html "Aktuelle Informationen aus dem KRITIS-Fachbereich")
    - [KRI­TIS-FAQ](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-FAQ/kritis-faq_node.html "KRITIS-FAQ")
    - [Ser­vice für KRI­TIS-Be­treiber](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/Service-fuer-KRITIS-Betreiber/service-fuer-kritis-betreiber_node.html "Service für KRITIS-Betreiber")
    - [UP KRI­TIS](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/UP-KRITIS/up-kritis_node.html "UP KRITIS")[All topics](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### IT-Sicherheitsvorfall

  + [Ver­braucherin­nen und Ver­brauch­er](DE/IT-Sicherheitsvorfall/Buergerinnen-und-Buerger/buergerinnen-und-buerger_node.html "Verbraucherinnen und Verbraucher")
  + [Un­ternehmen](DE/IT-Sicherheitsvorfall/Unternehmen/unternehmen_node.html "Unternehmen")
  + [Kri­tis­che In­fras­truk­turen und meldepflichtige Un­ternehmen](DE/IT-Sicherheitsvorfall/Kritische-Infrastrukturen-und-meldepflichtige-Unternehmen/kritische-infrastrukturen-und-meldepflichtige-unternehmen_node.html "Kritische Infrastrukturen und meldepflichtige Unternehmen")
  + [CVD-Richtlin­ie des BSI](DE/IT-Sicherheitsvorfall/IT-Schwachstellen/it-schwachstellen_node.html "CVD-Richtlinie des BSI")
* [Kar­riere](DE/Karriere/karriere_node.html "Karriere")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Karriere

  + [Willkom­men im #TeamB­SI](DE/Karriere/Team_BSI/team_bsi_node.html "Willkommen im Team BSI")
  + [Warum BSI?](DE/Karriere/Warum_BSI/warum_BSI_node.html "Warum BSI?")
  + [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
  + [Ein­stieg](DE/Karriere/Einstieg/einstieg_node.html "Einstieg")
  + [FAQ](DE/Karriere/FAQ/faq_node.html "FAQ")
  + [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
  + [Ter­mine](DE/Karriere/Termine/termine_node.html "Termine")
  + [Kon­takt Per­son­al­gewin­nung](DE/Karriere/Kontakt/kontakt_node.html "Kontakt Personalgewinnung")
* [Ser­vice](DE/Service-Navi/service-navi_node.html "Service")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Service

  + [Presse](DE/Service-Navi/Presse/presse_node.html "Presse")
  + [Mediathek](SiteGlobals/Forms/Suche/Mediathek_Formular.html?nn=132646)
  + [Pub­lika­tio­nen](DE/Service-Navi/Publikationen/publikationen_node.html "Publikationen")
  + [Newslet­ter und So­cial Me­dia](DE/Service-Navi/Abonnements/abonnements_node.html "Newsletter und Social Media")
  + [Ve­r­anstal­tun­gen](DE/Service-Navi/Veranstaltungen/veranstaltungen_node.html "Veranstaltungen")
  + [Ver­gaben an Ex­terne](DE/Service-Navi/Vergaben-an-Externe/vergaben-an-externe_node.html "Vergaben an Externe")
  + [Die E-Rech­nung im BSI](DE/Service-Navi/Die-E-Rechnung-im-BSI/die-e-rechnung-im-bsi_node.html "Die E-Rechnung im BSI")
  + [Kosten für Leis­tun­gen des BSI](DE/Service-Navi/Hinweise-Kosten/Hinweise-Kosten_node.html "Kosten für Leistungen des BSI")
  + [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
  + [Fra­gen & Antworten](DE/Service-Navi/FAQ/faq_node.html "Fragen & Antworten")
* [![SucheOeffnen](/SiteGlobals/Frontend/Images/icons/search.svg?__blob=normal&v=3)
  ![SucheSchliessen](/SiteGlobals/Frontend/Images/icons/search-blue.svg?__blob=normal&v=3)
  SucheOeffnen](SiteGlobals/Forms/Suche/Servicesuche_Formular.html?nn=132646)

## Search

Search

### Frequently searched

* [Regulierung nach NIS-2](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html)
* [Gefährdungen durch Ransomware](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)
* [Zertifizierung Produkte & Personen (FAQ)](DE/Service-Navi/FAQ/Zertifizierung/faq_node.html)
* [Zertifizierung Common Criteria](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/Zertifizierung-von-Produkten/Zertifizierung-nach-CC/zertifizierung-nach-cc_node.html)
* [Elektronische Identitäten](DE/Themen/Oeffentliche-Verwaltung/Elektronische-Identitaeten/elektronische-identitaeten_node.html)
* [Digitaler Verbraucherschutz](DE/Themen/Verbraucherinnen-und-Verbraucher/Leistungen-und-Kooperationen/Digitaler-Verbraucherschutz/digitaler-verbraucherschutz_node.html)
* [Technische Richtlinien](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/technische-richtlinien_node.html)
* [Kritische Infrastrukturen](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [Künstliche Intelligenz](DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Kuenstliche-Intelligenz/kuenstliche-intelligenz_node.html)

![Close](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)

## You are here:

1. [to homepage](DE/Home/home_node.html "to homepage")
2. **Mailvelope Extensions Security Audit**

# Mailvelope Extensions Security Audit

**date**
30.07.2019

![Bild-Dokument für das Frontend](/SiteGlobals/Frontend/Images/kopfbereich.png?__blob=normal&v=9 "Bild-Dokument für das Frontend")

 ![Cover Mailvelope Extensions Security Audit](/SharedDocs/Bilder/EN/Publications/cover/Mailvelope_Extensions.png?__blob=normal&v=1 "Cover Mailvelope Extensions Security Audit")

SEC Consult was tasked by the Federal Office for Information Security (german abbreviated as BSI) with performing a security audit and source code review of the Mailvelope Google Chrome and Firefox Add-ons, the OpenPGP.js library as well as the GPGME-json utility. Objective of this review was to reveal common security issues and to offer suggestions for improvements. The focus of the audit was to identify:

* vulnerabilities in the cryptographic algorithms,
* routines that could cause user data compromise,
* and routines that could be abused for user monitoring.

The vulnerabilities outlined in this document are subject to a coordinated vulnerability disclosure process and the appropriate maintainers have been notified. [Most of the vulnerabilities are patched, while some uncritical vulnerabilities are not yet addressed. Passages in this report regarding unpatched vulnerabilities are hence expunged.]

The following chapter summarizes the scope and timetable of the audit, the results of the audit and outlines the measures recommended by SEC Consult.

* [PDF, 1MB download](/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.pdf?__blob=publicationFile&v=1 "Opens in new window")

# Footer

Seite drucken

## Subnavigation of all website sections

### Themen

* [Ver­braucherin­nen und Ver­brauch­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
* [Un­ternehmen und Or­gan­i­sa­tio­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
* [Staat und Ver­wal­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
* [Reg­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")

### Das BSI

* [Leit­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
* [Or­gan­i­sa­tion und Auf­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
* [BSI Stan­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
* [Auf­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
* [Kon­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")

### Karriere

* [Ar­beit­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
* [Stel­lenange­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
* [Studi­um und Aus­bil­dung](DE/Karriere/Einstieg/Studium-und-Ausbildung/studium-und-ausbildung_node.html "Studium und Ausbildung")

### IT-Sicherheitsvorfall

* [IT-Sicher­heitsvor­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")

### Follow us

* [Das BSI auf Facebook](https://www.facebook.com/bsi.fuer.buerger "External link: Das BSI auf Facebook (Opens new window)")
* [Das BSI auf 'X'](https://x.com/BSI_Bund "External link: Das BSI auf X (Opens new window)")
* [BSI-Instagram](https://www.instagram.com/bsi_bund "External link: Das BSI auf Instagram (Opens new window)")
* [Das BSI auf LinkedIn](https://de.linkedin.com/company/bsibund "External link: Das BSI auf LinkedIn (Opens new window)")
* [Das BSI auf Mastodon](https://social.bund.de/%40bsi/ "External link: Das BSI auf Mastodon (Opens new window)")
* [Newsletterverwaltung](DE/Service-Navi/Abonnements/Newsletter/newsletter_node.html "Newsletterverwaltung")
* [Das BSI auf YouTube](https://www.youtube.com/channel/UC_VgLyJQsChxKfDJcdI-Tcg "External link: Das BSI auf YouTube (Opens new window)")
* [Das BSI auf Xing](https://www.xing.com/pages/bsibund "External link: Das BSI auf Xing (Opens new window)")
* [RSS](DE/Service-Navi/Abonnements/RSS/rss_node.html "RSS")

[![Logo Zertifikat IT-Grundschutz ISO 27001](/SharedDocs/Bilder/DE/BSI/Logos/Logo_Zertifizierung-ISO27001_IT-Grundschutz.svg?__blob=normal "Logo Zertifikat IT-Grundschutz ISO 27001 (Quelle: BSI)")](./DE/Service/Impressum/impressum_node.html#ISO)

* [Im­pres­sum](DE/Service/Impressum/impressum_node.html)
* [Daten­schutz](DE/Service/Datenschutz/datenschutz_node.html)
* [Nutzungs­be­din­gun­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [Bar­ri­ere­frei­heit](DE/Service/Barrierefreiheit/barrierefreiheit_node.html)

© Federal Office for Information Security

Top
[TOP](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#Start "Top")

## Hinweis zur Verwendung von Cookies

Das BSI speichert keine personenbezogenen Daten der Webseitenbesucher. Details in unserer [Datenschutzerklärung](DE/Service/Datenschutz/datenschutz_node.html "Datenschutz")

OK

![](https://piwik.itzbund.de/piwik.php?idsite=35&rec=1&url=https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646)



=== Content from openpgpjs.org_8a2bbf97_20250121_022703.html ===

![This project is supported by the Horizon 2020 Framework Programme of the European Union](images/logo-gdpr-eu-white.svg)
![OpenPGP.js Logo](images/icon_openpgpjs.png "OpenPGP.js")

## About

This project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device.
Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library).
The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications.
It should allow you to sign, encrypt, decrypt, and verify any kind of text - in particular e-mails - as well as managing keys.

This project is maintained by [Proton Mail](https://proton.me/blog/openpgpjs-email-encryption).

Contacts:

* To report security issues: [[email protected]](/cdn-cgi/l/email-protection#0370666076716a777a436c73666d73647369702d6c7164) (Please download our [PGP key](.well-known/openpgpkey/hu/t5s8ztdbon8yzntexy6oz5y48etqsnbb), either manually or using [WKD](https://wiki.gnupg.org/WKD))
* For general inquiries: [[email protected]](/cdn-cgi/l/email-protection#86e5e9e8f2e7e5f2c6e9f6e3e8f6e1f6ecf5a8e9f4e1) ([PGP key](.well-known/openpgpkey/hu/dj3498u4hyyarh35rkjfnghbjxug6b19))

## Download

[![js logo](./images/logo_js.png "Download OpenPGP.js")](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started "Download OpenPGP.js")

## Resources

* [Source code](https://github.com/openpgpjs/openpgpjs)
* [Getting started](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started)
* [API documentation](https://docs.openpgpjs.org)
* [GitHub issues](https://github.com/openpgpjs/openpgpjs/issues)
* [Wiki](https://github.com/openpgpjs/openpgpjs/wiki)
* [Twitter](https://twitter.com/openpgpjs)

## Gold Members / Supporters

[![Proton Mail logo](./images/logo_proton_mail.png "Proton Mail")
Proton Mail](https://proton.me/mail "Proton Mail")
[![globaleaks logo](./images/logo_globaleaks.png "Globaleaks")
GlobaLeaks.org](https://www.globaleaks.org "Globaleaks")
[![mailvelope logo](./images/logo_mailvelope.png "Mailvelope")
Mailvelope](https://www.mailvelope.com "Mailvelope")

## Who else is using OpenPGP.js

[![FlowCrypt logo](./images/logo_flowcrypt.jpg "PGP Encryption for Gmail")
FlowCrypt](https://flowcrypt.com/ "FlowCrypt")
[![Mymail-Crypt logo](./images/logo_mymail_crypt.jpg "Google Chrome Extension Mymail-Crypt")
Mymail-Crypt](https://chrome.google.com/webstore/detail/mymail-crypt-for-gmail/jcaobjhdnlpmopmjhijplpjhlplfkhba "Google Chrome Extension Mymail-Crypt")
[![udc logo](./images/logo_openudc.png "Universal Digital Currencies")
UDC](https://www.openudc.org/ "Universal Digital Currencies")
[![encrypto logo](./images/logo_encrypto.png "encrypt.to uses OpenPGP.js to encrypt messages and send via Rails backend")
Encrypt.to](https://encrypt.to "Encrypt To")
[![PGP Anywhere](./images/logo_pgpanywhere.png "Encrypt and decrypt PGP on the go")
PGP Anywhere](https://chrome.google.com/webstore/detail/pgp-anywhere/cdlcdnmhcodhagbmljapgbjdimjckilb "PGP Anywhere")
[![Passbolt logo](./images/logo_passbolt.png "Open source password manager for teams")
passbolt](https://www.passbolt.com "Passbolt")

## Architecture

![OpenPGP.js overview](images/overview.png)



=== Content from github.com_6a3390e4_20250121_001914.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.2.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.2.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs/tree/v4.2.0)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs/tree/v4.2.0)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

1. [Releases](/openpgpjs/openpgpjs/releases)
2. [v4.2.0](/openpgpjs/openpgpjs/releases/tag/v4.2.0)

# v4.2.0 - Security Release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/openpgpjs/openpgpjs/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.2.0)

 Loading

[View all tags](/openpgpjs/openpgpjs/tags)

![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)
[twiss](/twiss)
released this
05 Nov 14:10

[v4.2.0](/openpgpjs/openpgpjs/tree/v4.2.0)

[`a6e20d7`](/openpgpjs/openpgpjs/commit/a6e20d7abdb25c9781c5c0e568faec35fa6bbea5)

This release fixes a number of security issues. Please upgrade to the latest version as soon as possible.

* Fix Message Signature Bypass: Only accept text or binary signatures when verifying data
* Don't trust information in unhashed subpackets
* Respect "critical" flag in unrecognized signature subpackets
* Strengthen default S2K algorithm configuration
* Add and verify Primary Key Binding Signatures
* Reject keys with a Designated Revoker, as third-party key revocation is not supported by OpenPGP.js

Other changes:

* Remove bzip2 compression support (decompression is still supported) ([#798](https://github.com/openpgpjs/openpgpjs/pull/798))
* Use Web Crypto for SHA hashing ([#795](https://github.com/openpgpjs/openpgpjs/pull/795))
* Fix decryption with multiple passwords ([#792](https://github.com/openpgpjs/openpgpjs/pull/792))
* Fix unhandled promise rejection when decrypting non-MDC message ([#794](https://github.com/openpgpjs/openpgpjs/pull/794))
* Check that one-pass signatures match their corresponding signature ([#793](https://github.com/openpgpjs/openpgpjs/pull/793))
* Don't return streams in `openpgp.reformatKey()` and `openpgp.revokeKey()`
* Fix key lookup example in README.md ([#790](https://github.com/openpgpjs/openpgpjs/pull/790))

 Assets
2

 Loading

 👀
2
 adamlaska and Nillakashnillakash19 reacted with eyes emoji

All reactions

* 👀
  2 reactions

 2 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


