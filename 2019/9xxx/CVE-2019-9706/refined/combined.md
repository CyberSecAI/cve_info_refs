=== Content from bugs.debian.org_7890af56_20250120_235628.html ===

# Debian Bug report logs - #809167 cron: CVE-2019-9706: usae-after-free vulnerability

[![version graph](version.cgi?package=cron;absolute=0;height=2;fixed=cron%2F3.0pl1-133;collapse=1;found=cron%2F3.0pl1-127%2Bdeb8u1;found=cron%2F3.0pl1-124;width=2)](version.cgi?fixed=cron%2F3.0pl1-133;collapse=1;found=cron%2F3.0pl1-127%2Bdeb8u1;found=cron%2F3.0pl1-124;absolute=0;package=cron;info=1)

Package:
[cron](pkgreport.cgi?package=cron);
Maintainer for [cron](pkgreport.cgi?package=cron) is [Georges Khaznadar <georgesk@debian.org>](pkgreport.cgi?maint=georgesk%40debian.org); Source for [cron](pkgreport.cgi?package=cron) is [src:cron](pkgreport.cgi?src=cron) ([PTS](https://tracker.debian.org/pkg/cron), [buildd](https://buildd.debian.org/cron), [popcon](https://qa.debian.org/popcon.php?package=cron)).

Reported by: [Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege Escalation <orange.8361@gmail.com>](pkgreport.cgi?submitter=orange.8361%40gmail.com)

Date: Sun, 27 Dec 2015 19:00:06 UTC

Severity: important

Tags: security

Found in versions cron/3.0pl1-127+deb8u1, cron/3.0pl1-124

Fixed in version cron/3.0pl1-133

**Done:** Christian Kastner <ckk@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=809167;mbox=yes), [status mbox](bugreport.cgi?bug=809167;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=809167;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, orange@chroot.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#809167`; Package `cron`.
(Sun, 27 Dec 2015 19:00:09 GMT) ([full text](bugreport.cgi?bug=809167;msg=2), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege Escalation <orange.8361@gmail.com>`:

New Bug report received and forwarded. Copy sent to `orange@chroot.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Sun, 27 Dec 2015 19:00:10 GMT) ([full text](bugreport.cgi?bug=809167;msg=4), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=809167;msg=5), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=orange.8361%40gmail.com)
From: Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege
Escalation <orange.8361@gmail.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: cron: Cron Daemon Use-After-Free Vulnerability May Cause Local Root
Privilege Escalation
Date: Sun, 27 Dec 2015 18:57:50 +0000
```
Package: cron
Version: 3.0pl1-127+deb8u1
Severity: critical
Tags: security
Justification: root security hole

Hi Debian Security Team:

I recently started to read the source code of Cron / Crontab and I think I found a vulnerability in that.

I found that in file "database.c"
    # <http://anonscm.debian.org/cgit/pkg-cron/pkg-cron.git/tree/database.c?h=debian/3.0pl1-128>

    load_database(...)
        -> process_crontab(...)
            -> force_rescan_user(...)
                free(u);                # line 600
                ...
                link_user(new_db, u);   # line 609

"u" have been freed but still put it into link_user(...).
link_user(...) connect the freed "u" to a linked-list.

So, if the program use the "new_db" later, the program will segment fault.
Ex. In "cron.c" find_jobs(...) will use the freed "u"

And there is a condition to step into force_rescan_user(...).
In file "database.c" line 599
    if ((u->name = strdup(fname)) == NULL) {
        free(u);
        errno = ENOMEM;
    }

But I think in a low-memory machine or embedded system the condition can be ignored : )

p.s. I think other Linux distribution like ubuntu also have this vulnerablity

Above is the detail of this vulnerability.
Thanks :)

-- Package-specific info:
--- EDITOR:

--- /usr/bin/editor:
/bin/nano

--- /usr/bin/crontab:
-rwxr-sr-x 1 root crontab 36008 Jun 11  2015 /usr/bin/crontab

--- /var/spool/cron:
drwxr-xr-x 3 root root 4096 Jun  7  2015 /var/spool/cron

--- /var/spool/cron/crontabs:
drwx-wx--T 2 root crontab 4096 Dec 27 14:22 /var/spool/cron/crontabs

--- /etc/cron.d:
drwxr-xr-x 2 root root 4096 Dec 27 14:07 /etc/cron.d

--- /etc/cron.daily:
drwxr-xr-x 2 root root 4096 Dec 27 14:07 /etc/cron.daily

--- /etc/cron.hourly:
drwxr-xr-x 2 root root 4096 Dec 27 14:07 /etc/cron.hourly

--- /etc/cron.monthly:
drwxr-xr-x 2 root root 4096 Dec 27 14:07 /etc/cron.monthly

--- /etc/cron.weekly:
drwxr-xr-x 2 root root 4096 Dec 27 14:07 /etc/cron.weekly

-- System Information:
Debian Release: 8.1
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: amd64 (x86_64)

Kernel: Linux 3.16.0-4-amd64 (SMP w/1 CPU core)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)

Versions of packages cron depends on:
ii  adduser              3.113+nmu3
ii  debianutils          4.4+b1
ii  dpkg                 1.17.25
ii  init-system-helpers  1.22
ii  libc6                2.19-18
ii  libpam-runtime       1.1.8-3.1
ii  libpam0g             1.1.8-3.1
ii  libselinux1          2.3-2
ii  lsb-base             4.1+Debian13+nmu1

Versions of packages cron recommends:
pn  exim4 | postfix | mail-transport-agent  <none>

Versions of packages cron suggests:
pn  anacron        <none>
pn  checksecurity  <none>
ii  logrotate      3.8.7-1+b1

Versions of packages cron is related to:
pn  libnss-ldap   <none>
pn  libnss-ldapd  <none>
pn  libpam-ldap   <none>
pn  libpam-mount  <none>
pn  nis           <none>
pn  nscd          <none>

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#809167`; Package `cron`.
(Mon, 28 Dec 2015 22:30:03 GMT) ([full text](bugreport.cgi?bug=809167;msg=7), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Christian Kastner <ckk@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Mon, 28 Dec 2015 22:30:03 GMT) ([full text](bugreport.cgi?bug=809167;msg=9), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 809167@bugs.debian.org ([full text](bugreport.cgi?bug=809167;msg=10), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=ckk%40debian.org)
From: Christian Kastner <ckk@debian.org>
To: Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege
Escalation <orange.8361@gmail.com>, 809167@bugs.debian.org
Subject: Re: Bug#809167: cron: Cron Daemon Use-After-Free Vulnerability May
Cause Local Root Privilege Escalation
Date: Mon, 28 Dec 2015 23:27:34 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=809167;msg=10) (text/plain, inline)]
```
```
Hi,

thank you for your report. I've already spent a good amount of time
analyzing the potential impact of this flaw, but I would like to refrain
from further public comments until I have discussed this with security@d.o.

Thanks,
Christian

On 2015-12-27 19:57, Cron Daemon Use-After-Free Vulnerability May Cause
Local Root Privilege Escalation wrote:
> Package: cron
> Version: 3.0pl1-127+deb8u1
> Severity: critical
> Tags: security
> Justification: root security hole
>
>
> Hi Debian Security Team:
>
> I recently started to read the source code of Cron / Crontab and I think I found a vulnerability in that.
[...]

```
```
[[signature.asc](bugreport.cgi?att=1;bug=809167;filename=signature.asc;msg=10) (application/pgp-signature, attachment)]
```

---

**Marked as found in versions cron/3.0pl1-124.**
Request was from `Adrian Bunk <bunk@stusta.de>`
to `control@bugs.debian.org`.
(Tue, 27 Sep 2016 04:03:02 GMT) ([full text](bugreport.cgi?bug=809167;msg=12), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#809167`; Package `cron`.
(Sun, 29 Jan 2017 19:36:02 GMT) ([full text](bugreport.cgi?bug=809167;msg=14), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Sun, 29 Jan 2017 19:36:03 GMT) ([full text](bugreport.cgi?bug=809167;msg=16), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 809167@bugs.debian.org ([full text](bugreport.cgi?bug=809167;msg=17), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Christian Kastner <ckk@debian.org>
Cc: 809167@bugs.debian.org
Subject: Re: Bug#809167: cron: Cron Daemon Use-After-Free Vulnerability May
Cause Local Root Privilege Escalation
Date: Sun, 29 Jan 2017 19:32:59 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=809167;msg=17) (text/plain, inline)]
```
```
On Mon, 28 Dec 2015 23:27:34 +0100 Christian Kastner <ckk@debian.org> wrote:
> Hi,
>
> thank you for your report. I've already spent a good amount of time
> analyzing the potential impact of this flaw, but I would like to refrain
> from further public comments until I have discussed this with security@d.o.

...and the result was?

(I think this probably can be downgraded.  At least on Linux, I expect
memory allocation to either succeed or kill the program.  But this
should be fixed, anyway)

Ben.

--
Ben Hutchings
All the simple programs have been written, and all the good names
taken.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=809167;filename=signature.asc;msg=17) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#809167`; Package `cron`.
(Tue, 21 Mar 2017 19:27:12 GMT) ([full text](bugreport.cgi?bug=809167;msg=19), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent**
to `Ivo De Decker <ivodd@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Tue, 21 Mar 2017 19:27:12 GMT) ([full text](bugreport.cgi?bug=809167;msg=21), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 809167@bugs.debian.org ([full text](bugreport.cgi?bug=809167;msg=22), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=ivodd%40debian.org)
From: Ivo De Decker <ivodd@debian.org>
To: Ben Hutchings <ben@decadent.org.uk>
Cc: Christian Kastner <ckk@debian.org>, 809167@bugs.debian.org
Subject: Re: Bug#809167: cron: Cron Daemon Use-After-Free Vulnerability May
Cause Local Root Privilege Escalation
Date: Tue, 21 Mar 2017 20:26:29 +0100
```
Control: severity -1 important

Hi,

On Sun, Jan 29, 2017 at 07:32:59PM +0000, Ben Hutchings wrote:
> (I think this probably can be downgraded.  At least on Linux, I expect
> memory allocation to either succeed or kill the program.  But this
> should be fixed, anyway)

Doing so now.

Cheers,

Ivo

```

---

**Severity set to 'important' from 'critical'**
Request was from `Ivo De Decker <ivodd@debian.org>`
to `809167-submit@bugs.debian.org`.
(Tue, 21 Mar 2017 19:27:12 GMT) ([full text](bugreport.cgi?bug=809167;msg=24), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=24), [link](#23)).

---

**Reply sent**
to `Christian Kastner <ckk@debian.org>`:

You have taken responsibility.
(Mon, 11 Mar 2019 17:09:06 GMT) ([full text](bugreport.cgi?bug=809167;msg=26), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=26), [link](#25)).

---

**Notification sent**
to `Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege Escalation <orange.8361@gmail.com>`:

Bug acknowledged by developer.
(Mon, 11 Mar 2019 17:09:06 GMT) ([full text](bugreport.cgi?bug=809167;msg=28), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 809167-close@bugs.debian.org ([full text](bugreport.cgi?bug=809167;msg=29), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=ckk%40debian.org)
From: Christian Kastner <ckk@debian.org>
To: 809167-close@bugs.debian.org
Subject: Bug#809167: fixed in cron 3.0pl1-133
Date: Mon, 11 Mar 2019 17:04:03 +0000
```
Source: cron
Source-Version: 3.0pl1-133

We believe that the bug you reported is fixed in the latest version of
cron, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 809167@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Christian Kastner <ckk@debian.org> (supplier of updated cron package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Sun, 10 Mar 2019 17:49:18 +0100
Source: cron
Architecture: source
Version: 3.0pl1-133
Distribution: unstable
Urgency: medium
Maintainer: Javier Fernández-Sanguino Peña <jfs@debian.org>
Changed-By: Christian Kastner <ckk@debian.org>
Closes: [801328](bugreport.cgi?bug=801328) [809167](bugreport.cgi?bug=809167) [893575](bugreport.cgi?bug=893575) [893579](bugreport.cgi?bug=893579)
Changes:
 cron (3.0pl1-133) unstable; urgency=medium
 .
   * SECURITY: Fix bypass of /etc/cron.{allow,deny} on failure to open
     If these files exist, then they must be readable by the user executing
     crontab(1). Users will now be denied by default if they aren't.
     (LP: #1813833)
   * SECURITY: Fix for possible DoS by use-after-free
     A user reported a use-after-free condition in the cron daemon, leading to a
     possible Denial-of-Service scenario by crashing the daemon.
     (Closes: #[809167](bugreport.cgi?bug=809167))
   * SECURITY: DoS: Fix unchecked return of calloc()
     Florian Weimer discovered that a missing check for the return value of
     calloc() could crash the daemon, which could be triggered by a very
     large crontab created by a user.
   * Enforce maximum crontab line count of 1000 to prevent a malicious user
     from creating an excessivly large crontab. The daemon will log a warning
     for existing files, and crontab(1) will refuse to create new ones.
   * Add d/NEWS altering to the new 1000 lines limit.
   * Move /var/run/crond.reboot to /run/crond.reboot.
   * crontab.5: Reverse the info on tilde expansion. When setting PATH, most
     shells will not expand a tilde. Thanks, Tim Landscheidt, for the analysis.
     (Closes: #[801328](bugreport.cgi?bug=801328))
   * Fixes for numerous man page issues. Remove trailing whitespace, use proper
     escapes, etc. Thanks, Bjarni Ingi Gislason! (Closes: #[893575](bugreport.cgi?bug=893575), #[893579](bugreport.cgi?bug=893579))
   * crontab.1: Drop duplicate DIAGNOSTICS header.
   * daemon: Only support the 'x' debug option in debug builds.
Checksums-Sha1:
 ce0b9188ce385fdf5659da9a464c62ce6ce4a139 1918 cron_3.0pl1-133.dsc
 8fa1c0e52853a2b538bac04a1ccbf49d5679eb49 100791 cron_3.0pl1-133.diff.gz
 d461692639bfbd73ef67c4f2e40edf2a61ee6862 5264 cron_3.0pl1-133_source.buildinfo
Checksums-Sha256:
 d8a4fb0343d028e24d90079c82427439b65e2ed4ae90fca572e10d9984ed5934 1918 cron_3.0pl1-133.dsc
 dd542caabd039da1b3f1bbe8da271c20995e3c32caea26c058ac1d4236896506 100791 cron_3.0pl1-133.diff.gz
 761f490f47d059910df1d3c192f264433047ce8c3ac61e38da68ed3ce48dc3e0 5264 cron_3.0pl1-133_source.buildinfo
Files:
 6e4f310dad6071990f3339c82d313b24 1918 admin important cron_3.0pl1-133.dsc
 d6542f4bdf4b3b3d7601384af994f720 100791 admin important cron_3.0pl1-133.diff.gz
 df833dc4a0568c4c3390b062373b79ef 5264 admin important cron_3.0pl1-133_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQJDBAEBCgAtFiEEQZ9+mkfDq5UZ8bCjOZU6N95Os2sFAlyFRCAPHGNra0BkZWJp
YW4ub3JnAAoJEDmVOjfeTrNrxLcP/3H/ATbpLbXB49yPOZE9glbdSk2ngHWYh+ic
n2pEdmEq0yUA0g6DSwsOSWfSClPMabrU3+YiFRwk8L9uKBK5MD3HDEui3FFYcpEP
CuPSvY7b3ytWOUVjYlGWPkRidox+RA5qd43iDewHRyY3P6lIUB3l4MHiUurI1jBY
MQ/myllbNyMHTpXgJyr83rbJWz9GiUm+3nCoux0N2tfvpnYUvNd7ViNJeb+EBV2g
YAB0NiPel5/92KLkGI/rrSmtat+s2IJ3B80qn5lgM+BKqd3/Fk/wt3BUZQBZvrGE
Qf+Yvf4wMPdCMrdWjJF05SsXeI9aEr4Sa6gHlrjnZwK7JvwkGkoOShzVkqLqTj5l
qIK8J+NnDiXOfeNqpyadrLbxE9tV41xkPGNTcOSzfr8lBr/AvabK39UIkUIFiLiW
Ud6By3RJ8sgWgwtFS7WGaV+5KM9lWvvhilVUjZb4hSb+WPG/2UIntc83ZiPGQVvn
gQC35ZUMwMjVmLDe8n/3bPd5fjFL+m5Yl8W3hhUZa2MrHvf4None+f8cSj2sjJs2
qGiDEWqzH2Gb+QuYsZka8HflKKAg+BzG4qPOG09VqNNJx0btPWi1k6EyWKMAOmpY
lWcX+/BzaOeVjICcqw6bQ0hGr4C0INMs4ucynJOilPaqt+8eO185l+4cnYqUsTr6
11YWkMCF
=itJI
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'cron: CVE-2019-9706: usae-after-free vulnerability' from 'cron: Cron Daemon Use-After-Free Vulnerability May Cause Local Root Privilege Escalation'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 12 Mar 2019 16:21:02 GMT) ([full text](bugreport.cgi?bug=809167;msg=31), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=31), [link](#30)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 05 May 2019 07:28:59 GMT) ([full text](bugreport.cgi?bug=809167;msg=33), [mbox](bugreport.cgi?bug=809167;mbox=yes;msg=33), [link](#32)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=809167).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Mon Jan 20 23:56:28 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from lists.debian.org_c72659fe_20250120_235628.html ===


---

[[Date Prev](msg00028.html)][[Date Next](msg00030.html)]
[[Thread Prev](msg00028.html)][[Thread Next](msg00030.html)]
[[Date Index](maillist.html#00029)]
[[Thread Index](threads.html#00029)]

# [SECURITY] [DLA 2801-1] cron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2801-1] cron security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Sat, 30 Oct 2021 21:16:57 +0300
* *Message-id*: <[[🔎]](/msgid-search/20211030181657.GA15091%40localhost) [20211030181657.GA15091@localhost](msg00029.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2801-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
October 30, 2021                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : cron
Version        : 3.0pl1-128+deb9u2
CVE ID         : CVE-2017-9525 CVE-2019-9704 CVE-2019-9705 CVE-2019-9706
Debian Bug     : 809167

Brief introduction

CVE-2017-9525

    Fix group crontab to root escalation via postinst.

CVE-2019-9704

    A very large crontab created by a user could crash the daemon.

CVE-2019-9705

    Enforce maximum crontab line count of 10000 to prevent a malicious
    user from creating an excessivly large crontab.

CVE-2019-9706

    Fix for possible DoS by use-after-free.

Additionally, a bypass of /etc/cron.{allow,deny} on failure to open has
been fixed. If these files exist, then they must be readable by the user
executing crontab(1). Users will now be denied by default if they aren't.

For Debian 9 stretch, these problems have been fixed in version
3.0pl1-128+deb9u2.

We recommend that you upgrade your cron packages.

For the detailed security status of cron please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/cron>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmF9jBkACgkQiNJCh6LY
mLF3Aw//cnjLj14oQ/efkvNPkd7H24K5D4Ae6Zf7kbO7xN+AkWscJW1Jjk8SCq/i
VvN1XMftnc8KSXK20W9pm3guJfjdgS49gLy30Dish8p8GDzIPvdJYFb+ZNtU4f+Q
JywUZMWTlIUqqj9Wj5ceYyGYbLt+FiPdrXglb+77ubr3+lHeAYmXLQVIejqkqACn
YgZ3C8feu1xat5UPxHahuhkHvNgP87y3v+kuQhV/69zXgpeWAAOSDFULHTVI23FR
fHYrnoybhaTBTtuRrnUjBC1vantdhVGLdHa2qwQpct26txComknGVzj4adh70jtP
3k4ET+EnwC71RPS2UlbvfUZu+QpkcxoTmhmco9lhqTVLbVwBftbbB+BXPqexoS+g
AeVsDyNgkPi1njiCC88HifI0XNgH3u4z9YdJf7fSovKY/D7cirFYZu4it7p1mLiQ
73WxFzAS2MtXbZcD43CTrqXbo37hqTNny4EW2/KXqjXgaOu73E5If6mJvykop2md
aNGaBbT/5ie6eJqMnu4q7pxdLtCuAC4kF5YfXbnqYtlJ60nQQtA3UauwtBMn2cd7
+zOnb26bVA5f8tQ4h2NVXKmswDYxA9sD4qy+08mgewoN3LjQrzBeeW5kpyP78za3
sNsGAW2uniSBaNr2OwZe2qNUhtIAOCW+SiEaYsGauJvE+AIzzJY=
=/Qf3
-----END PGP SIGNATURE-----

```

---



=== Content from salsa.debian.org_ffd80e42_20250120_235700.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
40791b93**

authored
Mar 08, 2019
by
**[![Christian Kastner's avatar](https://seccdn.libravatar.org/avatar/8a3e21a79dfee415f4d1bbdcaef6649122f486af396729252f7266c5332d56a0?s=96&d=identicon&gravatarproxy=n "Christian Kastner")](/ckk)
[Christian Kastner](/ckk)**

[Browse files](/debian/cron/-/tree/40791b93f435e1dcce5d3be4273859daf3ab91b4)

### SECURITY: Fix for possible DoS by use-after-free

```

A user reported a use-after-free condition in the cron daemon, leading
to a possible Denial-of-Service scenario by crashing the daemon.

This was made possible by an erroneous removal of two return statements
in commit [1215fdad](/debian/cron/-/commit/1215fdaddba158f32b10f0cc041e634505d50cb8 "Check orphaned crontabs for adoption. Fix taken from Fedora cronie."). Re-adding these
statements resolves the issue.

Closes: #809167
```

parent
[13d44ca7](/debian/cron/-/commit/13d44ca741e1539f5612137ebaca84a0e6dc504c)

Loading

Loading

Loading

* [Changes
  1](/debian/cron/-/commit/40791b93f435e1dcce5d3be4273859daf3ab91b4)

[Hide whitespace changes](/debian/cron/-/commit/40791b93f435e1dcce5d3be4273859daf3ab91b4?action=show&controller=projects%2Fcommit&id=40791b93&namespace_id=debian&project_id=cron&w=1)
[Inline](/debian/cron/-/commit/40791b93?view=inline)
[Side-by-side](/debian/cron/-/commit/40791b93?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from lists.debian.org_8fa72611_20250120_235628.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 1723-1] cron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1723-1] cron security update
* *From*: Mike Gabriel <sunweaver@debian.org>
* *Date*: Thu, 21 Mar 2019 21:21:10 +0100
* *Message-id*: <[[🔎]](/msgid-search/20190321202107.GA19401%40minobo.das-netzwerkteam.de) [20190321202107.GA19401@minobo.das-netzwerkteam.de](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : cron
Version        : 3.0pl1-127+deb8u2
CVE ID         : CVE-2017-9525 CVE-2019-9704 CVE-2019-9705 CVE-2019-9706
Debian Bug     : 809167

Various security problems have been discovered in Debian's CRON scheduler.

CVE-2017-9525

    Fix group crontab to root escalation via the Debian package's
    postinst script as described by Alexander Peslyak (Solar Designer) in
    <http://www.openwall.com/lists/oss-security/2017/06/08/3>

CVE-2019-9704

    DoS: Fix unchecked return of calloc(). Florian Weimer discovered that
    a missing check for the return value of calloc() could crash the
    daemon, which could be triggered by a very large crontab created by a
    user.

CVE-2019-9705

    Enforce maximum crontab line count of 1000 to prevent a malicious
    user from creating an excessivly large crontab. The daemon will log a
    warning for existing files, and crontab(1) will refuse to create new
    ones.

CVE-2019-9706

    A user reported a use-after-free condition in the cron daemon,
    leading to a possible Denial-of-Service scenario by crashing the
    daemon.

For Debian 8 "Jessie", these problems have been fixed in version
3.0pl1-127+deb8u2.

We recommend that you upgrade your cron packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--

mike gabriel aka sunweaver (Debian Developer)
fon: +49 (1520) 1976 148

GnuPG Fingerprint: 9BFB AEE8 6C0A A5FF BF22  0782 9AF4 6B30 2577 1B31
mail: sunweaver@debian.org, <http://sunweavers.net>

```

**Attachment:
[signature.asc](pgpl2dB581dRm.pgp)**

*Description:* PGP signature

---


