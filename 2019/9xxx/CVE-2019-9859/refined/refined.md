- **Root cause of vulnerability:** Improper use of the `escapeshellarg` function in VestaCP. The function is used to sanitize user input before passing it to shell commands, but it is used in a way that adds an extra layer of single quotes, which can be bypassed by injecting shell commands through spaces in the input.
- **Weaknesses/vulnerabilities present:** Command injection due to improper escaping of shell arguments.
- **Impact of exploitation:** Remote command execution as root, allowing a malicious actor to gain full control of the server.
- **Attack vectors:** Authenticated users can inject shell commands through the `domain` parameter in `web\list\dns\index.php`, `web\edit\server\index.php` and `web\list\mail\index.php` files. The vulnerability is triggered by crafting a GET request with shell commands embedded within the `domain` parameter, bypassing the intended sanitization.
- **Required attacker capabilities/position:** The attacker needs to be an authenticated user of the VestaCP control panel.