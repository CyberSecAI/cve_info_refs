=== Content from research.loginsoft.com_b954e8ef_20250120_232504.html ===
[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22ba452b20ebeb6450c5_Loginsoft%20Logo%20Black.svg)](/)Services[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management](/vulnerability-management-configuration)Threat Research & Intelligence Services[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)Software Supply Chain Security Services[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)Cloud Native Security Services[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science &Â AI](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Development &Â Support](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation](/staff-augmentation)ServicesCybersecurity Solutions[![mask icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3211ce586a1a3fb192b_Vul%20Int.svg)Vulnerability Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-intelligence)[![notepad with code icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218ade7b335b90e760_Threat%20Intel.svg)Security & Threat Intelligence Integrations![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-and-threat-intelligence-integrations)[![gear icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3217b8073f736c27bcc_Vul%20COnfig.svg)Vulnerability & Configuration Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/vulnerability-management-configuration)SOFTWARE SUPPLY CHAIN SECURITY[![pin icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218abe17623f5d26ba_SCA.svg)OSS - Software Composition Analysis![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/software-composition-analysis)[![Shield icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321d9e29bda15d8af2b_Depend.svg)OSS - Dependency Defense![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/dependency-defense)[![threat person icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32192fa5d30ad6518cf_Zero%20Day.svg)OSS - Zero Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-supply-chain-security/zero-day-discovery)THREAT RESEARCH & INTELLIGENCE[![Radar icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3227b8073f736c27c37_Threat%20Intel-1.svg)Threat Intelligence![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/threat-intelligence)[![secure world icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3220e7bc0108161dfa1_Ext%20Attack.svg)External Attack Surface Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/threat-research-and-intelligence/external-attack-surface-discovery)CLOUDÂ NATIVEÂ SECURITY[![secure cloud icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321fff4e2af0d5f5709_CSPM.svg)Cloud Security Posture Management![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-security-posture-management)[![lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d3218f8825f699cfca67_Cloud%20Workload.svg)Cloud Workload Protection![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[![eye lock icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d323f945aaa8acf48859_Data%20sci.svg)Data Science & AI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/data-science-and-ai)[![person with box icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321263244d81f6c6f91_Software%20Dev.svg)Software Dev & Support![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/software-development-and-support)[![tick sticker icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d32160db9b9278e0d4a3_QA%20Automation.svg)QA Automation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/qa-automation)[![personal file icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/6620d321a69422a50f566b09_Staff%20Aug.svg)Staff Augmentation![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/staff-augmentation)Platforms[LOVI![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/lovi)[Cytellite![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/cytellite)[Research-as-a-Service](/research-as-a-service)Research[Zero-Day Discovery![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/security-advisories)[Our Research![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](https://research.loginsoft.com/)Company[Blog![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/blogs)[Reports![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/reports)[Case Studies![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/case-studies)[About us![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/about-us)[Careers![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/659d6af44c73e2c9a57888b7_Right%20Arrow.svg)](/careers)[Talk to us](/contact)[Talk to us](/contact)By using this website, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our [Privacy Policy](/privacy-policy) for more information.Accept![Green Plus icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65cde7d5fe78a54970c7984e_Green-Plus.svg)[Home](/)/Research/[Zero Day Discovery](/security-advisories)/CVE-2019-9143: Uncontrolled recursion loop in Exiv2::Image::printTiffStructure() - exiv2-0.27
## CVE-2019-9143: Uncontrolled recursion loop in Exiv2::Image::printTiffStructure() - exiv2-0.27

Vulnerability ReportsFebruary 25, 2019![Profile Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65a91b500b759f07aaa89823_Blog%20Author%20DP%20Placeholder.png)

Jason Franscisco

### Uncontrolled recursion loop in Exiv2::Image::printTiffStructure() - exiv2-0.27

Loginsoft-2018-1095

February 25, 2019

##### CVE Number

CVE-2019-9143

##### CWE

CWE-400: Uncontrolled Resource Consumption

##### Product Details

Exiv2 is a C++ library and a command line utility to read, write, delete and modify Exif, IPTC, XMP and ICC image metadata.**â**

**URL:**<https://github.com/Exiv2/exiv2>

##### Vulnerable Versions

0.27

##### Vulnerability Details

We observed that there is an infinite loop generating recursively at Exiv2::Image::printTiffStructure in file image.cpp .The same be triggered by sending a crafted file to the exiv2 binary. It allows an attacker to cause Denial of Service (Segmentation fault) or possibly have unspecified other impact.

##### SYNOPSIS

In progress

##### Vulnerable code

```

   do {
           // Read top of directory
           const int seekSuccess = !io.seek(start,BasicIo::beg);
           const long bytesRead = io.read(dir.pData_, 2);
           if (!seekSuccess || bytesRead == 0) {
               throw Error(kerCorruptedMetadata);
           }
           uint16_t   dirLength = byteSwap2(dir,0,bSwap);            bool tooBig = dirLength > 500;
           if ( tooBig ) {
               out << Internal::indent(depth) << "dirLength = " << dirLength << std::endl;
               throw Error(kerTiffDirectoryTooLarge);
           }            if ( bFirst && bPrint ) {
               out << Internal::indent(depth) << Internal::stringFormat("STRUCTURE OF TIFF FILE (%c%c): ",c,c) << io.path() << std::endl;

```

##### Analysis

```

84    ../sysdeps/unix/syscall-template.S: No such file or directory.
[ Legend: Modified register | Code | Heap | Stack | String ]
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ registers ââââ
$rax   : 0x49
$rbx   : 0x4a
$rcx   : 0x00007ffff5c172c0  â   cmp rax, 0xfffffffffffff001
$rdx   : 0x4a
$rsp   : 0x00007fffffffd338  â  0x00007ffff5b98bff  â   test rax, rax
$rbp   : 0x0000619000001480  â  "STRUCTURE OF TIFF FILE (II): id:000000,src:000553+[...]"
$rsi   : 0x0000619000001480  â  "STRUCTURE OF TIFF FILE (II): id:000000,src:000553+[...]"
$rdi   : 0x1
$rip   : 0x00007ffff5c172c0  â   cmp rax, 0xfffffffffffff001
$r8    : 0x00007ffff5ee6780  â  0x0000000100000001  â  0x0000000000000000
$r9    : 0x00007ffff7fd1780  â  0x00007ffff7fd1780  â  [loop detected]
$r10   : 0x733a706f2c333132 ("213,op:s"?)
$r11   : 0x246
$r12   : 0x4a
$r13   : 0x1
$r14   : 0x00007ffff5ee5620  â  0x00000000fbad2a84  â  0x0000000000000000
$r15   : 0x00007fffffffdb20  â  0x0000000041b58ab3
$eflags: [carry PARITY adjust ZERO sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x0033 $ss: 0x002b $ds: 0x0000 $es: 0x0000 $fs: 0x0000 $gs: 0x0000
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ stack ââââ
0x00007fffffffd338â+0x0000: 0x00007ffff5b98bff  â   test rax, rax     â $rsp
0x00007fffffffd340â+0x0008: 0x00007ffff5ee5620  â  0x00000000fbad2a84  â  0x0000000000000000
0x00007fffffffd348â+0x0010: 0x000000000000004a ("J"?)
0x00007fffffffd350â+0x0018: 0x0000619000001480  â  "STRUCTURE OF TIFF FILE (II): id:000000,src:000553+[...]"
0x00007fffffffd358â+0x0020: 0x00007fffffffd530  â  0x0000000041b58ab3
0x00007fffffffd360â+0x0028: 0x00007fffffffd960  â  0x0000000041b58ab3
0x00007fffffffd368â+0x0030: 0x00007ffff5b9a409  â   mov r13, rax
0x00007fffffffd370â+0x0038: 0x00007fffffffdb20  â  0x0000000041b58ab3
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ code:x86:64 ââââ
   0x7ffff5c172b2         mov    DWORD PTR [rbp*1+0x10750000], esp
   0x7ffff5c172b9  mov    eax, 0x1
   0x7ffff5c172be  syscall
 â 0x7ffff5c172c0  cmp    rax, 0xfffffffffffff001
   0x7ffff5c172c6  jae    0x7ffff5c172f9
   0x7ffff5c172c8  ret
   0x7ffff5c172c9        sub    rsp, 0x8
   0x7ffff5c172cd        call   0x7ffff5c350d0
   0x7ffff5c172d2        mov    QWORD PTR [rsp], rax
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ threads ââââ
[#0] Id 1, Name: "exiv2", stopped, reason: SIGINT
âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ trace ââââ
[#0] 0x7ffff5c172c0 â __write_nocancel()
[#1] 0x7ffff5b98bff â _IO_new_file_write(f=0x7ffff5ee5620 , data=0x619000001480, n=0x4a)
[#2] 0x7ffff5b9a409 â new_do_write(to_do=0x4a, data=0x619000001480 "STRUCTURE OF TIFF FILE (II): id:000000,src:000553+000213,op:splice,rep:64\n", '\276' , fp=0x7ffff5ee5620 )
[#3] 0x7ffff5b9a409 â _IO_new_do_write(fp=0x7ffff5ee5620 , data=0x619000001480 "STRUCTURE OF TIFF FILE (II): id:000000,src:000553+000213,op:splice,rep:64\n", '\276' , to_do=0x4a)
[#4] 0x7ffff5b9a81b â _IO_new_file_overflow(f=0x7ffff5ee5620 , ch=0xa)
[#5] 0x7ffff5b96533 â __GI__IO_putc(c=, fp=0x7ffff5ee5620 )
[#6] 0x7ffff6214a4a â std::ostream::put(char)()
[#7] 0x7ffff6214c3f â std::basic_ostream& std::endl(std::basic_ostream&)()
[#8] 0x7ffff673df1e â Exiv2::Image::printIFDStructure(this=0x61200000bec0, io=@0x60300000ecb0, out=@0x672ac0, option=Exiv2::kpsRecursive, start=0xff, bSwap=0x0, c=0x49, depth=0x0)
[#9] 0x7ffff673fe2a â Exiv2::Image::printTiffStructure(this=0x61200000bec0, io=@0x60300000ecb0, out=@0x672ac0, option=Exiv2::kpsRecursive, depth=0xffffffff, offset=0x0)

```

##### Tested environment

`64-bit ubuntu 16.04 LTS`

##### Proof of Concept

 `exiv2 -b -u -k -p R pr $POC`

##### Timeline

Vendor Disclosure: 21-02-2019

Public Disclosure: 15-02-2019

##### Credit

Discovered by ACE Team - [Loginsoft](https://www.loginsoft.com/)

Explore Cybersecurity Platforms

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros.

Discover Lovi
## Sign up to our Newsletter

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Cybersecurity Solutions[Vulnerability Intelligence](/vulnerability-intelligence)[Security & Threat Intelligence Integrations](/security-and-threat-intelligence-integrations)[Vulnerability & Configuration Management](/vulnerability-management-configuration)[OSS - Software Composition Analysis](/software-supply-chain-security/software-composition-analysis)[OSS - Dependancy Defence](/software-supply-chain-security/dependency-defense)[OSS - Zero-Day Discovery](/software-supply-chain-security/zero-day-discovery)[Threat Intelligence](/threat-research-and-intelligence/threat-intelligence)[External Attack Surface Discovery](/threat-research-and-intelligence/external-attack-surface-discovery)[Cloud Security Posture Management](/cloud-native-security/cloud-security-posture-management)[Cloud Workload Protection](/cloud-native-security/cloud-workload-protection-management)ITÂ Solutions[Data Science &Â AI](/data-science-and-ai)[Software Development Â & Support](/software-development-and-support)[QA Automation](/qa-automation)[Staff Augmentation](/staff-augmentation)Platforms[LOVI](/lovi)[Cytellite](/cytellite)Company[Blogs](/blogs)[Reports](/reports)[About us](/about-us)[Careers](/careers)Research[Research-as-a -Service](/research-as-a-service)[Zero-Day Discovery](/security-advisories)![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/660b22b99ceecda456b052cd_Loginsoft%20Logo%20White.svg)1-703-956-7410info@loginsoft.com[![Linkedin Icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d02956967bd81ab620_LinkedIn.svg)](https://www.linkedin.com/company/loginsoft/)[![X icon](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b777d0e8e8f3e5866a563b_X.svg)](https://twitter.com/Loginsoft_Inc)[![](https://cdn.prod.website-files.com/65952a9c6bd758cb3a53eebd/65b8dafdc42d3397ec72e17c_github-mark-white%201.svg)](https://github.com/Loginsoft-Research)Â© 2024 - Copyright[Privacy policy](/privacy-policy)

![](https://px.ads.linkedin.com/collect/?pid=562737&fmt=gif)



=== Content from cdn.prod.website-files.com_5a36c2ef_20250121_013111.html ===



