=== Content from packetstormsecurity.com_7eab44d3_20250121_000805.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUTâ›” 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from sec-consult.com_fcb68771_20250121_000810.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/kritische-schwachstellen-in-openpgp-js/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities In Openpgp.js
# Multiple Vulnerabilities In Openpgp.js

Title

Multiple vulnerabilities

Product

OpenPGP.js

Vulnerable Version

<=4.2.0

Fixed Version

4.3.0

CVE Number

CVE-2019-9153, CVE-2019-9154, CVE-2019-9155

Impact

critical

Homepage

[https://openpgpjs.org](https://openpgpjs.org "https://openpgpjs.org")

Found

31.12.2018

By

Wolfgang Ettlinger (Office Vienna) | SEC Consult Vulnerability Lab

In the course of a project aimed at improving the browser plugin â€œMailvelopeâ€ SEC Consult was tasked by the German Bundesamt fÃ¼r Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope and OpenPGP.js software. During this engagement several vulnerabilities were found, that e.g. in specific scenarios could have allowed an attacker to steal a victimâ€™s private key.

## Vendor Description

*â€œThis project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device. Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library). The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications. It should allow you to sign, encrypt, decrypt, and verify any kind of text â€“ in particular e-mails â€“ as well as managing keys.â€*

Source:Â [https://openpgpjs.org](https://openpgpjs.org/)

## Business Recommendation

SEC Consult was tasked by the German Bundesamt fÃ¼r Sicherheit in der Informationstechnik (BSI) with conducting a security audit of the Mailvelope browser extension as well as the parts of OpenPGP.js used by Mailvelope. During the course of this audit multiple security vulnerabilities with severities ranging from minor to critical have been identified. Some of the vulnerabilities with higher severity are published as an advisory. A more detailed description of the vulnerabilities as well as a description of other vulnerabilities found during this project can be found in the report that has been made available by the BSI:

[https://www.bsi.bund.de/[â€¦]/Publications/Studies/Mailvelope\_Extensions/Mailvelope\_Extensions\_pdf.html](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html)

## Vulnerability Overview/description

### 1) Message Signature Bypass (CVE-2019-9153)

OpenPGP defines several types of signatures with each type carrying a different semantic. Signatures are implemented as packets and each signature packet can contain subpackets.

To indicate a message signature (e.g. a signed e-mail), the signature type â€œtextâ€ is used. The text signature packet verifies both its subpackets as well as the signed text.

During verification of a message signature, OpenPGP.js does not verify that the signature is of type text. An attacker could therefore construct a message that, instead of a text signature, contains a signature of another type. As the input required for the verification process depends on the signature type, an attacker could use a signature with a type that only verifies its subpackets and does not require additional input.

An attacker could construct a message that contains a valid â€œstandaloneâ€ or â€œtimestampâ€ signature packet signed by another person. OpenPGP.js would incorrectly assume this message to be signed by that person.

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

OpenPGP signature subpackets contain information related to a signature (e.g. the creation timestamp). These subpackets may appear in a â€œhashedâ€ and â€œunhashedâ€ subpacket container. While the information in the hashed subpackets is signed, the unhashed subpackets are not cryptographically protected. OpenPGP.js however does not distinguish between these subpackets. When parsing a signature packet, the signed information is parsed first. When the unhashed packets are read, the information from the hashed packets is overwritten.

An attacker could arbitrarily modify the contents of e.g. a key certification signature or revocation signature. As a result, the attacker could e.g. convince a victim to use an obsolete key for encryption.

### 3) Invalid Curve Attack (CVE-2019-9155)

The implementation of the Elliptic Curve Diffie-Hellman (ECDH) key exchange algorithm does not verify that the communication partnerâ€™s public key is valid (i.e. that the point lies on the elliptic curve). This causes the application to implicitly calculate the resulting secret key not based on the specified elliptic curve but rather an altered curve. By carefully choosing multiple altered curves (and therefore the resulting public key), and observing whether decryption fails, an attacker can extract the victimâ€™s private key.

This attack requires the attacker to be able to provide multiple manipulated messages and to observe whether decryption fails.

## Proof Of Concept

### 1) Message Signature Bypass (CVE-2019-9153)

The script message\_signature\_bypass.js (see below) demonstrates this issue. The function fakeSignature reads a signed message and replaces its content. It then replaces the signature with a standalone signature of the victim.

Source code ([SEC\_Consult\_BSI\_Mailvelope-signature\_bypass.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-message_signature_bypass.txt))

### 2) Information from Unhashed Subpackets is Trusted (CVE-2019-9154)

The script unsigned\_subpackets.js demonstrates this issue. It parses an expired key and adds additional unhashed subpackets that specify a different key expiration. When this newly-created key is parsed, it can be used for encrypting messages.

Source code ([SEC\_Consult\_BSI\_Mailvelope-unsigned\_subpackets.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-unsigned_subpackets.txt))

### 3) Invalid Curve Attack (CVE-2019-9155)

The script in invalid\_curve\_attack.js demonstrates this issue. Note that since OpenPGP uses only the x-coordinate of the secret point, the oracle succeeds both when it calculates the same point as the attacker or when it calculates its inverse point. Therefore, the Chinese Remainder Theorem cannot be directly applied to the result. Instead, the script demonstrates that the remainders of the private key matches the corresponding gathered remainder. In order to fully implement this attack, an attacker could verify the results using other public key points with a non-prime order.

Source code ([SEC\_Consult\_BSI\_Mailvelope-invalid\_curve\_attack.js](https://sec-consult.com/wp-content/uploads/2019/08/SEC_Consult_BSI_Mailvelope-invalid_curve_attack.txt))

## Vulnerable / Tested Versions

The version 4.1.2 was found to be vulnerable. The Invalid Curve attack is also viable against version 4.2.0.

## Vendor Contact Timeline

Vendor communication was conducted by the BSI as well as their contractors.

## Solution

Upgrade to the latest version of OpenPGP.js.

## Workaround

None.

## AdvisoryÂ URL

[https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html](/vulnerability-lab/)

EOF Wolfgang Ettlinger / @2019

### Contact

Interested to work with the experts of SEC Consult? Send us your application.

Want to improve your own cyber security with the experts of SEC Consult?

[contact us](/contact/)[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** â€¢Â  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from openpgpjs.org_8a2bbf97_20250121_021603.html ===

![This project is supported by the Horizon 2020 Framework Programme of the European Union](images/logo-gdpr-eu-white.svg)
![OpenPGP.js Logo](images/icon_openpgpjs.png "OpenPGP.js")

## About

This project aims to provide an Open Source OpenPGP library in JavaScript so it can be used on virtually every device.
Instead of other implementations that are aimed at using native code, OpenPGP.js is meant to bypass this requirement (i.e. people will not have to install gpg on their machines in order to use the library).
The idea is to implement all the needed OpenPGP functionality in a JavaScript library that can be reused in other projects that provide browser extensions or server applications.
It should allow you to sign, encrypt, decrypt, and verify any kind of text - in particular e-mails - as well as managing keys.

This project is maintained by [Proton Mail](https://proton.me/blog/openpgpjs-email-encryption).

Contacts:

* To report security issues: [[emailÂ protected]](/cdn-cgi/l/email-protection#493a2c2a3c3b203d300926392c27392e39233a67263b2e) (Please download our [PGP key](.well-known/openpgpkey/hu/t5s8ztdbon8yzntexy6oz5y48etqsnbb), either manually or using [WKD](https://wiki.gnupg.org/WKD))
* For general inquiries: [[emailÂ protected]](/cdn-cgi/l/email-protection#aecdc1c0dacfcddaeec1decbc0dec9dec4dd80c1dcc9) ([PGP key](.well-known/openpgpkey/hu/dj3498u4hyyarh35rkjfnghbjxug6b19))

## Download

[![js logo](./images/logo_js.png "Download OpenPGP.js")](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started "Download OpenPGP.js")

## Resources

* [Source code](https://github.com/openpgpjs/openpgpjs)
* [Getting started](https://github.com/openpgpjs/openpgpjs/blob/master/README.md#getting-started)
* [API documentation](https://docs.openpgpjs.org)
* [GitHub issues](https://github.com/openpgpjs/openpgpjs/issues)
* [Wiki](https://github.com/openpgpjs/openpgpjs/wiki)
* [Twitter](https://twitter.com/openpgpjs)

## Gold Members / Supporters

[![Proton Mail logo](./images/logo_proton_mail.png "Proton Mail")
Proton Mail](https://proton.me/mail "Proton Mail")
[![globaleaks logo](./images/logo_globaleaks.png "Globaleaks")
GlobaLeaks.org](https://www.globaleaks.org "Globaleaks")
[![mailvelope logo](./images/logo_mailvelope.png "Mailvelope")
Mailvelope](https://www.mailvelope.com "Mailvelope")

## Who else is using OpenPGP.js

[![FlowCrypt logo](./images/logo_flowcrypt.jpg "PGP Encryption for Gmail")
FlowCrypt](https://flowcrypt.com/ "FlowCrypt")
[![Mymail-Crypt logo](./images/logo_mymail_crypt.jpg "Google Chrome Extension Mymail-Crypt")
Mymail-Crypt](https://chrome.google.com/webstore/detail/mymail-crypt-for-gmail/jcaobjhdnlpmopmjhijplpjhlplfkhba "Google Chrome Extension Mymail-Crypt")
[![udc logo](./images/logo_openudc.png "Universal Digital Currencies")
UDC](https://www.openudc.org/ "Universal Digital Currencies")
[![encrypto logo](./images/logo_encrypto.png "encrypt.to uses OpenPGP.js to encrypt messages and send via Rails backend")
Encrypt.to](https://encrypt.to "Encrypt To")
[![PGP Anywhere](./images/logo_pgpanywhere.png "Encrypt and decrypt PGP on the go")
PGP Anywhere](https://chrome.google.com/webstore/detail/pgp-anywhere/cdlcdnmhcodhagbmljapgbjdimjckilb "PGP Anywhere")
[![Passbolt logo](./images/logo_passbolt.png "Open source password manager for teams")
passbolt](https://www.passbolt.com "Passbolt")

## Architecture

![OpenPGP.js overview](images/overview.png)



=== Content from github.com_6a3390e4_20250121_000809.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.2.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Freleases%2Ftag%2Fv4.2.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs/tree/v4.2.0)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs/tree/v4.2.0)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

1. [Releases](/openpgpjs/openpgpjs/releases)
2. [v4.2.0](/openpgpjs/openpgpjs/releases/tag/v4.2.0)

# v4.2.0 - Security Release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/openpgpjs/openpgpjs/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.2.0)

 Loading

[View all tags](/openpgpjs/openpgpjs/tags)

![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)
[twiss](/twiss)
released this
05 Nov 14:10

[v4.2.0](/openpgpjs/openpgpjs/tree/v4.2.0)

[`a6e20d7`](/openpgpjs/openpgpjs/commit/a6e20d7abdb25c9781c5c0e568faec35fa6bbea5)

This release fixes a number of security issues. Please upgrade to the latest version as soon as possible.

* Fix Message Signature Bypass: Only accept text or binary signatures when verifying data
* Don't trust information in unhashed subpackets
* Respect "critical" flag in unrecognized signature subpackets
* Strengthen default S2K algorithm configuration
* Add and verify Primary Key Binding Signatures
* Reject keys with a Designated Revoker, as third-party key revocation is not supported by OpenPGP.js

Other changes:

* Remove bzip2 compression support (decompression is still supported) ([#798](https://github.com/openpgpjs/openpgpjs/pull/798))
* Use Web Crypto for SHA hashing ([#795](https://github.com/openpgpjs/openpgpjs/pull/795))
* Fix decryption with multiple passwords ([#792](https://github.com/openpgpjs/openpgpjs/pull/792))
* Fix unhandled promise rejection when decrypting non-MDC message ([#794](https://github.com/openpgpjs/openpgpjs/pull/794))
* Check that one-pass signatures match their corresponding signature ([#793](https://github.com/openpgpjs/openpgpjs/pull/793))
* Don't return streams in `openpgp.reformatKey()` and `openpgp.revokeKey()`
* Fix key lookup example in README.md ([#790](https://github.com/openpgpjs/openpgpjs/pull/790))

 Assets
2

 Loading

 ðŸ‘€
2
 adamlaska and Nillakashnillakash19 reacted with eyes emoji

All reactions

* ðŸ‘€
  2 reactions

 2 people reacted

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_762017c9_20250121_000808.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797%2Fcommits%2F47138eed61473e13ee8f05931119d3e10542c5e1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797%2Fcommits%2F47138eed61473e13ee8f05931119d3e10542c5e1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

# Security fixes #797

 Merged

[sanjanarajan](/sanjanarajan)
merged 6 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Nov 5, 2018

[Conversation
0](/openpgpjs/openpgpjs/pull/797)
[Commits
6](/openpgpjs/openpgpjs/pull/797/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/797/checks)
[Files changed](/openpgpjs/openpgpjs/pull/797/files)

 Merged

# [Security fixes](#top) #797

 Show file tree

 Hide file tree

Changes from **1 commit**

Commits

[Show all changes

6 commits](/openpgpjs/openpgpjs/pull/797/files)
Select commit
Hold shift + click to select a range

[`327d3e5`
Only accept binary or text signatures when verifying messages

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)
[`47138ee`
Don't trust unhashed signature subpackets

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1)
[`8c97112`
Throw on critical unknown signature subpackets

twiss Oct 29, 2018](/openpgpjs/openpgpjs/pull/797/commits/8c971124499e9b6e5753ffcbe8e63388b6aff003)
[`8fa3aad`
Add and require primary key binding signatures on signing keys

twiss Oct 30, 2018](/openpgpjs/openpgpjs/pull/797/commits/8fa3aadea235aba8e0b8bb36f9602c6d6e12e6d8)
[`d314a20`
Don't return keys with an authorized revocation key

twiss Oct 30, 2018](/openpgpjs/openpgpjs/pull/797/commits/d314a20e0fd9261683517b55c4aede444a88f8f8)
[`9a7fe9c`
Bump S2K iteration count parameter

twiss Nov 1, 2018](/openpgpjs/openpgpjs/pull/797/commits/9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)

**File filter**

### Filter by extension

Filter by extension

.js
(3)

All 1 file type selected

---

Viewed files

[Clear filters](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

* src/packet

  + src/packet/signature.js
    [signature.js](#diff-3b4c5bc5c60a9aac4c50be7c37c89fd97ab711e1831b9a1144c7541d6083d39a)
* test/security

  + test/security/index.js
    [index.js](#diff-5b5ee61fd0e27256ce40b7add52a83b889bc1cea7a5214388bda8bc377d5a41f)
  + test/security/unsigned\_subpackets.js
    [unsigned\_subpackets.js](#diff-20bbc48cf7f23f0228cde08f7c51f81df2e817c60423f53cab462d5485259b4b)

 [Prev](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)Previous commit

 [Next](/openpgpjs/openpgpjs/pull/797/commits/8c971124499e9b6e5753ffcbe8e63388b6aff003)Next commit

Don't trust unhashed signature subpackets

```
Also, export packet.Signature.prototype.read_sub_packets.
```

* Loading branch information

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

[twiss](/openpgpjs/openpgpjs/commits?author=twiss "View all commits by twiss")
committed
Nov 5, 2018

commit 47138eed61473e13ee8f05931119d3e10542c5e1

## There are no files selected for viewing

55 changes: 33 additions & 22 deletions

55
[src/packet/signature.js](#diff-3b4c5bc5c60a9aac4c50be7c37c89fd97ab711e1831b9a1144c7541d6083d39a "src/packet/signature.js")

Show comments

[View file](/twiss/openpgpjs/blob/47138eed61473e13ee8f05931119d3e10542c5e1/src/packet/signature.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -109,31 +109,12 @@ Signature.prototype.read = function (bytes) { |
|  |  | throw new Error('Version ' + this.version + ' of the signature is unsupported.'); |
|  |  | } |
|  |  |  |
|  |  | const subpackets = bytes => { |
|  |  | // Two-octet scalar octet count for following subpacket data. |
|  |  | const subpacket\_length = util.readNumber(bytes.subarray(0, 2)); |
|  |  |  |
|  |  | let i = 2; |
|  |  |  |
|  |  | // subpacket data set (zero or more subpackets) |
|  |  | while (i < 2 + subpacket\_length) { |
|  |  | const len = packet.readSimpleLength(bytes.subarray(i, bytes.length)); |
|  |  | i += len.offset; |
|  |  |  |
|  |  | this.read\_sub\_packet(bytes.subarray(i, i + len.len)); |
|  |  |  |
|  |  | i += len.len; |
|  |  | } |
|  |  |  |
|  |  | return i; |
|  |  | }; |
|  |  |  |
|  |  | this.signatureType = bytes[i++]; |
|  |  | this.publicKeyAlgorithm = bytes[i++]; |
|  |  | this.hashAlgorithm = bytes[i++]; |
|  |  |  |
|  |  | // hashed subpackets |
|  |  | i += subpackets(bytes.subarray(i, bytes.length), true); |
|  |  | i += this.read\_sub\_packets(bytes.subarray(i, bytes.length), true); |
|  |  |  |
|  |  | // A V4 signature hashes the packet body |
|  |  | // starting from its first field, the version number, through the end |
| Expand All | | @@ -145,7 +126,7 @@ Signature.prototype.read = function (bytes) { |
|  |  | const sigDataLength = i; |
|  |  |  |
|  |  | // unhashed subpackets |
|  |  | i += subpackets(bytes.subarray(i, bytes.length), false); |
|  |  | i += this.read\_sub\_packets(bytes.subarray(i, bytes.length), false); |
|  |  | this.unhashedSubpackets = bytes.subarray(sigDataLength, i); |
|  |  |  |
|  |  | // Two-octet field holding left 16 bits of signed hash value. |
| Expand Down  Expand Up | | @@ -346,7 +327,7 @@ function write\_sub\_packet(type, data) { |
|  |  |  |
|  |  | // V4 signature sub packets |
|  |  |  |
|  |  | Signature.prototype.read\_sub\_packet = function (bytes) { |
|  |  | Signature.prototype.read\_sub\_packet = function (bytes, trusted=true) { |
|  |  | let mypos = 0; |
|  |  |  |
|  |  | const read\_array = (prop, bytes) => { |
| Expand All | | @@ -359,6 +340,17 @@ Signature.prototype.read\_sub\_packet = function (bytes) { |
|  |  |  |
|  |  | // The leftwost bit denotes a "critical" packet, but we ignore it. |
|  |  | const type = bytes[mypos++] & 0x7F; |
|  |  |  |
|  |  | // GPG puts the Issuer and Signature subpackets in the unhashed area. |
|  |  | // Tampering with those invalidates the signature, so we can trust them. |
|  |  | // Ignore all other unhashed subpackets. |
|  |  | if (!trusted && ![ |
|  |  | enums.signatureSubpacket.issuer, |
|  |  | enums.signatureSubpacket.embedded\_signature |
|  |  | ].includes(type)) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | let seconds; |
|  |  |  |
|  |  | // subpacket type |
| Expand Down  Expand Up | | @@ -515,6 +507,25 @@ Signature.prototype.read\_sub\_packet = function (bytes) { |
|  |  | } |
|  |  | }; |
|  |  |  |
|  |  | Signature.prototype.read\_sub\_packets = function(bytes, trusted=true) { |
|  |  | // Two-octet scalar octet count for following subpacket data. |
|  |  | const subpacket\_length = util.readNumber(bytes.subarray(0, 2)); |
|  |  |  |
|  |  | let i = 2; |
|  |  |  |
|  |  | // subpacket data set (zero or more subpackets) |
|  |  | while (i < 2 + subpacket\_length) { |
|  |  | const len = packet.readSimpleLength(bytes.subarray(i, bytes.length)); |
|  |  | i += len.offset; |
|  |  |  |
|  |  | this.read\_sub\_packet(bytes.subarray(i, i + len.len), trusted); |
|  |  |  |
|  |  | i += len.len; |
|  |  | } |
|  |  |  |
|  |  | return i; |
|  |  | }; |
|  |  |  |
|  |  | // Produces data to produce signature on |
|  |  | Signature.prototype.toSign = function (type, data) { |
|  |  | const t = enums.signature; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[test/security/index.js](#diff-5b5ee61fd0e27256ce40b7add52a83b889bc1cea7a5214388bda8bc377d5a41f "test/security/index.js")

Show comments

[View file](/twiss/openpgpjs/blob/47138eed61473e13ee8f05931119d3e10542c5e1/test/security/index.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,4 @@ |
|  |  | describe('Security', function () { |
|  |  | require('./message\_signature\_bypass'); |
|  |  | require('./unsigned\_subpackets'); |
|  |  | }); |

95 changes: 95 additions & 0 deletions

95
[test/security/unsigned\_subpackets.js](#diff-20bbc48cf7f23f0228cde08f7c51f81df2e817c60423f53cab462d5485259b4b "test/security/unsigned_subpackets.js")

Show comments

[View file](/twiss/openpgpjs/blob/47138eed61473e13ee8f05931119d3e10542c5e1/test/security/unsigned_subpackets.js)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,95 @@ |
|  |  | const openpgp = typeof window !== 'undefined' && window.openpgp ? window.openpgp : require('../../dist/openpgp'); |
|  |  |  |
|  |  | const { key, message, enums, packet: { List, Signature } } = openpgp; |
|  |  |  |
|  |  | const chai = require('chai'); |
|  |  | chai.use(require('chai-as-promised')); |
|  |  |  |
|  |  | const expect = chai.expect; |
|  |  |  |
|  |  | /\* |
|  |  | \* This key is long expired and cannot be used for encryption. |
|  |  | \*/ |
|  |  | const INVALID\_KEY = ` |
|  |  | -----BEGIN PGP PRIVATE KEY BLOCK----- |
|  |  | Version: OpenPGP.js VERSION |
|  |  | Comment: https://openpgpjs.org |
|  |  |  |
|  |  | xcMGBDhtQ4ABB/9uAfnjiE8HLfFrk4AzYIoxISvIbqDlItn3Mk2RK4iGTaAL |
|  |  | h+hN8BrqOopgdHj5c3pTo6VDvJLieHwymdZ3d296L55zt2ichhVIgRxh20Tv |
|  |  | j0dYLKGIEWDMBKvQNoDi83eGrIeHGNjRDOipr/PD251LzwaeiNVyw8ce2Fpd |
|  |  | 1ORbC2MJU57C2appZqeMJsWPCnsHNkhxPyRGdp+vifgizi/lt2DcQ6C6EiJx |
|  |  | HV0jFDPJnb69LxKLUelRH+l/b2ZHTONu2pZwUXcFpjA5yTrSzO/kaUtGu/Cz |
|  |  | 3euQ3scEtvMXgO2R9H7halxYwyXL/PPLmgaUt1RNXGC7BZjkUW4n8qd/ABEB |
|  |  | AAH+CQMITYNkFGQHMiJgt2s69CHTfwUUZg1Yfcq8alY7GpqeH4CayWCMPI+v |
|  |  | l7kIJdl2b9N/xGnpaUMmaXJts6AtlIBLwzxg0syIfgRv4/wfrVeruJ9TfCFC |
|  |  | NbKP3lk3FZCGF0I4T1FSNvyPJ//ee1cX7U/gM7A2g5xyBFnH5d8LTUDlQjXb |
|  |  | a+BwYN2TZaFrvlWwMIU+NQa+EOiyAwXsgyQbVn2d7JsUUs/lyEG2xkWNTeqe |
|  |  | FWKJJvyDwixsxd7oobBSM6Krt2TreuelPBFQxKyaYyv81gASga9wxyfbIuTG |
|  |  | 7wAKW9i4pFMgrrIABcnNKOyeAgMDcAYXAW3eNbYDCIDL9/AuOUotPR+0pEun |
|  |  | WssAZGBM78ZlJZ1Qnbg9nT0rn4pHrFQHnBxlWyPEqj1mZ0Svc0vXHVH+8JgN |
|  |  | pwOGxo7DiF5lL/bphdFVMF2e+UPoc1efO4cpW+ZH/BOug14dJROfkrPhrUTp |
|  |  | nYu6VF9N723YVT9PDTg79E4kIzjMDvhV1odHSaxfl4VtgueYv+Bt3n2nXdME |
|  |  | XZVBXbp7jO7pTS5HsOBcModos8ZYS5RcaHPJ6H8807hFyva4GThZ744ryV8b |
|  |  | XnROoC+d/xR4ShA4f/f9QszMXZ+Xlh4IU3Ccz5PF5UiZ/nC5ho5KzJphBB53 |
|  |  | c78gjRIXeUK1Rgj2AquF3KDOjCm60oazKzXv8316ZODNJr+HVvGSKeq85z9Z |
|  |  | z/BfXUtn+PrmzHxegusZfFCpB6YAJCILsHgJ2gT8v26QF+1CJ3ngHVnSkghR |
|  |  | z64zJexeqA8ChTZnhPbHVhh5qx2hlNTofBV29LJGa/EpMykO5pZiuaSEkmZx |
|  |  | RpU+iKNYKa3U516O8f9yj+UZ5/t2SJRpT+9fro3RB4lUnt/RdkY8q2R+3owo |
|  |  | xr4sYaInfvrs3eCsmh5UtygUVARKrK84zR1UZXN0aSBUZXN0IDx0ZXN0QGV4 |
|  |  | YW1wbGUuY29tPsLAewQQAQgALwUCOG1DgAUJAAAACgYLCQcIAwIJEMwSTBo3 |
|  |  | j0N5BBUICgIDFgIBAhkBAhsDAh4BAAD2TQf+KQbrX2zO9SL5ffCK5qu2VigM |
|  |  | 0E3uF763II9vRYfXHdZtXY/8K/uBLbu2rdZHwwb/jAHEe60Qf5VjcbIMtCfA |
|  |  | khPB5JuCvW+JEsYhXplNxYka27svfWI75/cYVc/0OharKEaaPOv2F8C1k2jL |
|  |  | Sk7Az01IAJkdwmBkG6fUwupevuvpO+kUQjsHg35q8Lm7G8roCYiK7K7/JQi3 |
|  |  | K+e0ovVFvunFSORaG8jR37uT7X7KA0LHD3S7XYO0o2OJi0QKB1wN3H3FEll0 |
|  |  | bFznfdIzKKIDzGwC/zhpUMGMwsqVLb8sw/H9cr82yPoM6pXVUqnstKDlLce8 |
|  |  | Dc2vwS83Aja9iWrIEg== |
|  |  | =dvRO |
|  |  | -----END PGP PRIVATE KEY BLOCK-----`; |
|  |  |  |
|  |  | async function getInvalidKey() { |
|  |  | return (await key.readArmored(INVALID\_KEY)).keys[0]; |
|  |  | } |
|  |  | async function makeKeyValid() { |
|  |  | /\*\* |
|  |  | \* Checks if a key can be used for encryption. |
|  |  | \*/ |
|  |  | async function encryptFails(k) { |
|  |  | try { |
|  |  | await openpgp.encrypt({ |
|  |  | message: message.fromText('Hello', 'hello.txt'), |
|  |  | publicKeys: k |
|  |  | }); |
|  |  | return false; |
|  |  | } catch (e) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | const invalidkey = await getInvalidKey(); |
|  |  | // deconstruct invalid key |
|  |  | const [pubkey, puser, pusersig] = invalidkey.toPacketlist().map(i => i); |
|  |  | // create a fake signature |
|  |  | const fake = new Signature(); |
|  |  | Object.assign(fake, pusersig); |
|  |  | // extend expiration times |
|  |  | fake.keyExpirationTime = 0x7FFFFFFF; |
|  |  | fake.signatureExpirationTime = 0x7FFFFFFF; |
|  |  | // add key capability |
|  |  | fake.keyFlags[0] |= enums.keyFlags.encrypt\_communication; |
|  |  | // create modified subpacket data |
|  |  | pusersig.unhashedSubpackets = fake.write\_all\_sub\_packets(); |
|  |  | // reconstruct the modified key |
|  |  | const newlist = new List(); |
|  |  | newlist.concat([pubkey, puser, pusersig]); |
|  |  | let modifiedkey = new key.Key(newlist); |
|  |  | // re-read the message to eliminate any |
|  |  | // behaviour due to cached values. |
|  |  | modifiedkey = (await key.readArmored( |
|  |  | await modifiedkey.armor())).keys[0]; |
|  |  |  |
|  |  | expect(await encryptFails(invalidkey)).to.be.true; |
|  |  | expect(await encryptFails(modifiedkey)).to.be.true; |
|  |  | } |
|  |  |  |
|  |  | it('Does not accept unsigned subpackets', makeKeyValid); |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_61563a9f_20250121_000806.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=openpgpjs%2Fopenpgpjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openpgpjs](/openpgpjs)
/
**[openpgpjs](/openpgpjs/openpgpjs)**
Public

* [Notifications](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs) You must be signed in to change notification settings
* [Fork
  802](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)
* [Star
   5.7k](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs)

* [Code](/openpgpjs/openpgpjs)
* [Issues
  16](/openpgpjs/openpgpjs/issues)
* [Pull requests
  7](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

Additional navigation options

* [Code](/openpgpjs/openpgpjs)
* [Issues](/openpgpjs/openpgpjs/issues)
* [Pull requests](/openpgpjs/openpgpjs/pulls)
* [Discussions](/openpgpjs/openpgpjs/discussions)
* [Actions](/openpgpjs/openpgpjs/actions)
* [Wiki](/openpgpjs/openpgpjs/wiki)
* [Security](/openpgpjs/openpgpjs/security)
* [Insights](/openpgpjs/openpgpjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenpgpjs%2Fopenpgpjs%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security fixes #797

 Merged

[sanjanarajan](/sanjanarajan)
merged 6 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Nov 5, 2018

 Merged

# [Security fixes](#top) #797

[sanjanarajan](/sanjanarajan)
merged 6 commits into
[openpgpjs:master](/openpgpjs/openpgpjs/tree/master "openpgpjs/openpgpjs:master")
from
[twiss:security-fixes](/twiss/openpgpjs/tree/security-fixes "twiss/openpgpjs:security-fixes")

Nov 5, 2018

[Conversation
0](/openpgpjs/openpgpjs/pull/797)
[Commits
6](/openpgpjs/openpgpjs/pull/797/commits)
[Checks
0](/openpgpjs/openpgpjs/pull/797/checks)
[Files changed](/openpgpjs/openpgpjs/pull/797/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![twiss](https://avatars.githubusercontent.com/u/908303?s=60&v=4)](/twiss)

Copy link

Member

### @twiss **[twiss](/twiss)** commented [Nov 5, 2018](#issue-377339002)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [twiss](/twiss)
added 6 commits
[November 5, 2018 11:47](#commits-pushed-327d3e5)

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Only accept binary or text signatures when verifying messages](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc "Only accept binary or text signatures when verifying messages")`

`[327d3e5](/openpgpjs/openpgpjs/pull/797/commits/327d3e5392a6f59a4270569d200c7f7a2bfc4cbc)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Don't trust unhashed signature subpackets](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1 "Don't trust unhashed signature subpackets

Also, export packet.Signature.prototype.read_sub_packets.")`
 â€¦

`[47138ee](/openpgpjs/openpgpjs/pull/797/commits/47138eed61473e13ee8f05931119d3e10542c5e1)`

```
Also, export packet.Signature.prototype.read_sub_packets.
```

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Throw on critical unknown signature subpackets](/openpgpjs/openpgpjs/pull/797/commits/8c971124499e9b6e5753ffcbe8e63388b6aff003 "Throw on critical unknown signature subpackets")`

`[8c97112](/openpgpjs/openpgpjs/pull/797/commits/8c971124499e9b6e5753ffcbe8e63388b6aff003)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Add and require primary key binding signatures on signing keys](/openpgpjs/openpgpjs/pull/797/commits/8fa3aadea235aba8e0b8bb36f9602c6d6e12e6d8 "Add and require primary key binding signatures on signing keys

Also, fix keyFlags of signing subkeys.

Also, store Issuer Key ID and Embedded Signature in unhashed rather
than hashed subpackets.")`
 â€¦

`[8fa3aad](/openpgpjs/openpgpjs/pull/797/commits/8fa3aadea235aba8e0b8bb36f9602c6d6e12e6d8)`

```
Also, fix keyFlags of signing subkeys.

Also, store Issuer Key ID and Embedded Signature in unhashed rather
than hashed subpackets.
```

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Don't return keys with an authorized revocation key](/openpgpjs/openpgpjs/pull/797/commits/d314a20e0fd9261683517b55c4aede444a88f8f8 "Don't return keys with an authorized revocation key")`

`[d314a20](/openpgpjs/openpgpjs/pull/797/commits/d314a20e0fd9261683517b55c4aede444a88f8f8)`

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)

`[Bump S2K iteration count parameter](/openpgpjs/openpgpjs/pull/797/commits/9a7fe9cd452763506ca507bfae5b2c0a80d70c6f "Bump S2K iteration count parameter")`

`[9a7fe9c](/openpgpjs/openpgpjs/pull/797/commits/9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)`

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
[force-pushed](/openpgpjs/openpgpjs/compare/8a1a365c9942f8406bc97fe25ecf9a360269e527..9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)
the
security-fixes

branch
from
[`8a1a365`](/openpgpjs/openpgpjs/commit/8a1a365c9942f8406bc97fe25ecf9a360269e527) to
[`9a7fe9c`](/openpgpjs/openpgpjs/commit/9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)  [Compare](/openpgpjs/openpgpjs/compare/8a1a365c9942f8406bc97fe25ecf9a360269e527..9a7fe9cd452763506ca507bfae5b2c0a80d70c6f)
[November 5, 2018 10:49](#event-1945882984)

[![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=40&u=2a3239792734aaa6b2968b1bddb5202ef9e3e465&v=4)](/sanjanarajan)
[sanjanarajan](/sanjanarajan)
merged commit [`0be9113`](/openpgpjs/openpgpjs/commit/0be91133665e81d2007cdfa02cd3cf1d839ee4f1)
into
openpgpjs:master

[Nov 5, 2018](https://github.com/openpgpjs/openpgpjs/pull/797#event-1945902178)

 [![@twiss](https://avatars.githubusercontent.com/u/908303?s=40&v=4)](/twiss)
[twiss](/twiss)
deleted the
security-fixes

branch
[November 5, 2018 10:58](#event-1945902833)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenpgpjs%2Fopenpgpjs%2Fpull%2F797)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@twiss](https://avatars.githubusercontent.com/u/908303?s=52&v=4)](/twiss) [![@sanjanarajan](https://avatars.githubusercontent.com/u/6510011?s=52&v=4)](/sanjanarajan)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.bsi.bund.de_9555648f_20250121_000811.html ===


# Navigation and service

*Go to:*

* [Content](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#content)
* [Main Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646# )
* [Search](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#search)

## Menu

* [Menu](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#nav)

## Service menu

## Servicemenue

* [KonÂ­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
* **English**
* [GebÃ¤rÂ­denÂ­sprache](DE/Service/Gebaerdensprache/gebaerdensprache_node.html)
* [LeÂ­ichte Sprache](DE/Service/LeichteSprache/leichtesprache_node.html)
* [NutzungsÂ­beÂ­dinÂ­gunÂ­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [LoÂ­gin](Login/Login/login_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo.svg?__blob=normal&v=4)](DE/Home/home_node.html "to homepage")

[![Logo "Deutschland Digital Sicher](/_config/AdditionalLogo.svg?__blob=value&v=6)](DE/Home/home_node.html)

[![BSI - Federal Office for Information Security (Link to homepage)](/SiteGlobals/Frontend/Images/logo-bsi-smaller.svg?__blob=normal&v=3)](DE/Home/home_node.html "to homepage")

## Main Menu

* [Das BSI](DE/Das-BSI/das-bsi_node.html "Das BSI")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Das BSI

  + [CyÂ­berÂ­naÂ­tion DeutschÂ­land](DE/Das-BSI/Cybernation/cybernation_node.html)
  + [AufÂ­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
  + [OrÂ­ganÂ­iÂ­saÂ­tion und AufÂ­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
  + [LeitÂ­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
  + [ZeitÂ­strahl](DE/Das-BSI/Zeitstrahl/BSI-Zeitstrahl_node.html)
  + [BSI StanÂ­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
  + [UmwelÂ­terkÂ­lÃ¤rung](DE/Das-BSI/Nachhaltigkeit/EMAS/umwelterklaerung_node.html "UmwelterklÃ¤rung")
* [TheÂ­men](DE/Themen/themen_node.html "Themen")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### All topics

  + [Staat und VerÂ­walÂ­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
    #### Our top themes

    - [NaÂ­tionales IT-LagezenÂ­trum](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/Nationales-IT-Lagezentrum/nationales-it-lagezentrum_node.html "Nationales IT-Lagezentrum")
    - [CERT-Bund](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Reaktion/CERT-Bund/cert-bund_node.html "CERT-Bund")
    - [ZusamÂ­meÂ­narÂ­beit mit Bund und LÃ¤nÂ­dern](DE/Themen/Oeffentliche-Verwaltung/Zusammenarbeit_mit_Bund_und_Laendern/bund-laender-zusammenarbeit_node.html "Zusammenarbeit mit Bund und LÃ¤ndern")
    - [SicherÂ­heitsÂ­berÂ­atung](DE/Themen/Oeffentliche-Verwaltung/Sicherheitsberatung/sicherheitsberatung_node.html "Sicherheitsberatung")
    - [MinÂ­destÂ­stanÂ­dards Bund](DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/Mindeststandards_node.html "Mindeststandards")[All topics](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html)
  + [UnÂ­ternehmen und OrÂ­ganÂ­iÂ­saÂ­tioÂ­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
    #### Our top themes

    - [Threat InÂ­telÂ­liÂ­gence](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Threat-Intelligence/threat-intelligence_node.html "Threat Intelligence")
    - [IT-SicherÂ­heitskennzeÂ­ichen](DE/Themen/Unternehmen-und-Organisationen/IT-Sicherheitskennzeichen/it-sicherheitskennzeichen_node.html "IT-Sicherheitskennzeichen")
    - [IT-GrundÂ­schutz](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/it-grundschutz_node.html "IT-Grundschutz")
    - [ZerÂ­tiÂ­fizierung und AnÂ­erkenÂ­nung](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/zertifizierung-und-anerkennung_node.html "Zertifizierung und Anerkennung")
    - [RanÂ­somware AnÂ­griffe](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)[All topics](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html)
  + [VerÂ­braucherinÂ­nen und VerÂ­brauchÂ­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
    #### Our top themes

    - [SicherÂ­heit beim OnÂ­liÂ­neshopÂ­ping](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Online-Banking-Online-Shopping-und-mobil-bezahlen/Online-Shopping/online-shopping_node.html "Sicherheit beim Onlineshopping")
    - [OnÂ­line-AcÂ­count abÂ­sichÂ­ern](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Cyber-Sicherheitsempfehlungen/Accountschutz/accountschutz_node.html "Accountschutz")
    - [BedroÂ­hunÂ­gen durch CyÂ­ber-KrimÂ­inelle](DE/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/methoden-der-cyber-kriminalitaet_node.html "Methoden der Cyber-KriminalitÃ¤t")
    - [E-Mail, SoÂ­cial MeÂ­dia, MesÂ­senÂ­ger und Co.](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Onlinekommunikation/onlinekommunikation_node.html "Onlinekommunikation")
    - [Smart MeÂ­terÂ­ing & LadeÂ­inÂ­frasÂ­trukÂ­tur](DE/Themen/Verbraucherinnen-und-Verbraucher/Informationen-und-Empfehlungen/Internet-der-Dinge-Smart-leben/Smart-Meter-Gateway/smart-meter-gateway_node.html "Smart-Meter-Gateway")[All topics](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html)
  + [RegÂ­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")
    #### Our top themes

    - [NIS-2-regÂ­ulierte UnÂ­ternehmen](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html "NIS-2-regulierte Unternehmen")
    - [AkÂ­tuelle InÂ­forÂ­maÂ­tioÂ­nen aus dem KRIÂ­TIS-FachÂ­bereÂ­ich](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-aktuell/kritis-aktuell_node.html "Aktuelle Informationen aus dem KRITIS-Fachbereich")
    - [KRIÂ­TIS-FAQ](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/KRITIS-FAQ/kritis-faq_node.html "KRITIS-FAQ")
    - [SerÂ­vice fÃ¼r KRIÂ­TIS-BeÂ­treiber](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/Service-fuer-KRITIS-Betreiber/service-fuer-kritis-betreiber_node.html "Service fÃ¼r KRITIS-Betreiber")
    - [UP KRIÂ­TIS](DE/Themen/Regulierte-Wirtschaft/Kritische-Infrastrukturen/UP-KRITIS/up-kritis_node.html "UP KRITIS")[All topics](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [IT-SicherÂ­heitsvorÂ­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### IT-Sicherheitsvorfall

  + [VerÂ­braucherinÂ­nen und VerÂ­brauchÂ­er](DE/IT-Sicherheitsvorfall/Buergerinnen-und-Buerger/buergerinnen-und-buerger_node.html "Verbraucherinnen und Verbraucher")
  + [UnÂ­ternehmen](DE/IT-Sicherheitsvorfall/Unternehmen/unternehmen_node.html "Unternehmen")
  + [KriÂ­tisÂ­che InÂ­frasÂ­trukÂ­turen und meldepflichtige UnÂ­ternehmen](DE/IT-Sicherheitsvorfall/Kritische-Infrastrukturen-und-meldepflichtige-Unternehmen/kritische-infrastrukturen-und-meldepflichtige-unternehmen_node.html "Kritische Infrastrukturen und meldepflichtige Unternehmen")
  + [CVD-RichtlinÂ­ie des BSI](DE/IT-Sicherheitsvorfall/IT-Schwachstellen/it-schwachstellen_node.html "CVD-Richtlinie des BSI")
* [KarÂ­riere](DE/Karriere/karriere_node.html "Karriere")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Karriere

  + [WillkomÂ­men im #TeamBÂ­SI](DE/Karriere/Team_BSI/team_bsi_node.html "Willkommen im Team BSI")
  + [Warum BSI?](DE/Karriere/Warum_BSI/warum_BSI_node.html "Warum BSI?")
  + [ArÂ­beitÂ­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
  + [EinÂ­stieg](DE/Karriere/Einstieg/einstieg_node.html "Einstieg")
  + [FAQ](DE/Karriere/FAQ/faq_node.html "FAQ")
  + [StelÂ­lenangeÂ­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
  + [TerÂ­mine](DE/Karriere/Termine/termine_node.html "Termine")
  + [KonÂ­takt PerÂ­sonÂ­alÂ­gewinÂ­nung](DE/Karriere/Kontakt/kontakt_node.html "Kontakt Personalgewinnung")
* [SerÂ­vice](DE/Service-Navi/service-navi_node.html "Service")
  ![NavigationSchliessen](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)
  ### Service

  + [Presse](DE/Service-Navi/Presse/presse_node.html "Presse")
  + [Mediathek](SiteGlobals/Forms/Suche/Mediathek_Formular.html?nn=132646)
  + [PubÂ­likaÂ­tioÂ­nen](DE/Service-Navi/Publikationen/publikationen_node.html "Publikationen")
  + [NewsletÂ­ter und SoÂ­cial MeÂ­dia](DE/Service-Navi/Abonnements/abonnements_node.html "Newsletter und Social Media")
  + [VeÂ­rÂ­anstalÂ­tunÂ­gen](DE/Service-Navi/Veranstaltungen/veranstaltungen_node.html "Veranstaltungen")
  + [VerÂ­gaben an ExÂ­terne](DE/Service-Navi/Vergaben-an-Externe/vergaben-an-externe_node.html "Vergaben an Externe")
  + [Die E-RechÂ­nung im BSI](DE/Service-Navi/Die-E-Rechnung-im-BSI/die-e-rechnung-im-bsi_node.html "Die E-Rechnung im BSI")
  + [Kosten fÃ¼r LeisÂ­tunÂ­gen des BSI](DE/Service-Navi/Hinweise-Kosten/Hinweise-Kosten_node.html "Kosten fÃ¼r Leistungen des BSI")
  + [KonÂ­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")
  + [FraÂ­gen & Antworten](DE/Service-Navi/FAQ/faq_node.html "Fragen & Antworten")
* [![SucheOeffnen](/SiteGlobals/Frontend/Images/icons/search.svg?__blob=normal&v=3)
  ![SucheSchliessen](/SiteGlobals/Frontend/Images/icons/search-blue.svg?__blob=normal&v=3)
  SucheOeffnen](SiteGlobals/Forms/Suche/Servicesuche_Formular.html?nn=132646)

## Search

Search

### Frequently searched

* [Regulierung nach NIS-2](DE/Themen/Regulierte-Wirtschaft/NIS-2-regulierte-Unternehmen/nis-2-regulierte-unternehmen_node.html)
* [GefÃ¤hrdungen durch Ransomware](DE/Themen/Unternehmen-und-Organisationen/Cyber-Sicherheitslage/Analysen-und-Prognosen/Ransomware-Angriffe/ransomware-angriffe_node.html)
* [Zertifizierung Produkte & Personen (FAQ)](DE/Service-Navi/FAQ/Zertifizierung/faq_node.html)
* [Zertifizierung Common Criteria](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Zertifizierung-und-Anerkennung/Zertifizierung-von-Produkten/Zertifizierung-nach-CC/zertifizierung-nach-cc_node.html)
* [Elektronische IdentitÃ¤ten](DE/Themen/Oeffentliche-Verwaltung/Elektronische-Identitaeten/elektronische-identitaeten_node.html)
* [Digitaler Verbraucherschutz](DE/Themen/Verbraucherinnen-und-Verbraucher/Leistungen-und-Kooperationen/Digitaler-Verbraucherschutz/digitaler-verbraucherschutz_node.html)
* [Technische Richtlinien](DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/technische-richtlinien_node.html)
* [Kritische Infrastrukturen](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html)
* [KÃ¼nstliche Intelligenz](DE/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Kuenstliche-Intelligenz/kuenstliche-intelligenz_node.html)

![Close](/SiteGlobals/Frontend/Images/icons/close.svg?__blob=normal&v=3)

## You are here:

1. [to homepage](DE/Home/home_node.html "to homepage")
2. **Mailvelope Extensions Security Audit**

# Mailvelope Extensions Security Audit

**date**
30.07.2019

![Bild-Dokument fÃ¼r das Frontend](/SiteGlobals/Frontend/Images/kopfbereich.png?__blob=normal&v=9 "Bild-Dokument fÃ¼r das Frontend")

 ![Cover Mailvelope Extensions Security Audit](/SharedDocs/Bilder/EN/Publications/cover/Mailvelope_Extensions.png?__blob=normal&v=1 "Cover Mailvelope Extensions Security Audit")

SEC Consult was tasked by the Federal Office for Information Security (german abbreviated as BSI) with performing a security audit and source code review of the Mailvelope Google Chrome and Firefox Add-ons, the OpenPGP.js library as well as the GPGME-json utility. Objective of this review was to reveal common security issues and to offer suggestions for improvements. The focus of the audit was to identify:

* vulnerabilities in the cryptographic algorithms,
* routines that could cause user data compromise,
* and routines that could be abused for user monitoring.

The vulnerabilities outlined in this document are subject to a coordinated vulnerability disclosure process and the appropriate maintainers have been notified. [Most of the vulnerabilities are patched, while some uncritical vulnerabilities are not yet addressed. Passages in this report regarding unpatched vulnerabilities are hence expunged.]

The following chapter summarizes the scope and timetable of the audit, the results of the audit and outlines the measures recommended by SEC Consult.

* [PDF,Â 1MB download](/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.pdf?__blob=publicationFile&v=1 "Opens in new window")

# Footer

Seite drucken

## Subnavigation of all website sections

### Themen

* [VerÂ­braucherinÂ­nen und VerÂ­brauchÂ­er](DE/Themen/Verbraucherinnen-und-Verbraucher/verbraucherinnen-und-verbraucher_node.html "Verbraucherinnen und Verbraucher")
* [UnÂ­ternehmen und OrÂ­ganÂ­iÂ­saÂ­tioÂ­nen](DE/Themen/Unternehmen-und-Organisationen/unternehmen-und-organisationen_node.html "Unternehmen und Organisationen")
* [Staat und VerÂ­walÂ­tung](DE/Themen/Oeffentliche-Verwaltung/oeffentliche-verwaltung_node.html "Staat und Verwaltung")
* [RegÂ­ulierte Wirtschaft](DE/Themen/Regulierte-Wirtschaft/regulierte-wirtschaft_node.html "Regulierte Wirtschaft")

### Das BSI

* [LeitÂ­bild](DE/Das-BSI/Leitbild/leitbild_node.html "Leitbild")
* [OrÂ­ganÂ­iÂ­saÂ­tion und AufÂ­bau](DE/Das-BSI/Organisation-und-Aufbau/organisation-und-aufbau_node.html "Organisation und Aufbau")
* [BSI StanÂ­dorte](DE/Das-BSI/BSI-Standorte/bsi-standorte_node.html "BSI Standorte")
* [AufÂ­trag](DE/Das-BSI/Auftrag/auftrag_node.html)
* [KonÂ­takt](DE/Service-Navi/Kontakt/kontakt_node.html "Kontakt")

### Karriere

* [ArÂ­beitÂ­en im BSI](DE/Karriere/Arbeiten-im-BSI/arbeiten-im-bsi_node.html "Arbeiten im BSI")
* [StelÂ­lenangeÂ­bote](DE/Karriere/Stellenangebote/stellenangebot_node.html "Stellenangebote")
* [StudiÂ­um und AusÂ­bilÂ­dung](DE/Karriere/Einstieg/Studium-und-Ausbildung/studium-und-ausbildung_node.html "Studium und Ausbildung")

### IT-Sicherheitsvorfall

* [IT-SicherÂ­heitsvorÂ­fall](DE/IT-Sicherheitsvorfall/it-sicherheitsvorfall_node.html "IT-Sicherheitsvorfall")

### Follow us

* [Das BSI auf Facebook](https://www.facebook.com/bsi.fuer.buerger "External link:Â Das BSI auf Facebook (OpensÂ newÂ window)")
* [Das BSI auf 'X'](https://x.com/BSI_Bund "External link:Â Das BSI auf X (OpensÂ newÂ window)")
* [BSI-Instagram](https://www.instagram.com/bsi_bund "External link:Â Das BSI auf Instagram (OpensÂ newÂ window)")
* [Das BSI auf LinkedIn](https://de.linkedin.com/company/bsibund "External link:Â Das BSI auf LinkedIn (OpensÂ newÂ window)")
* [Das BSI auf Mastodon](https://social.bund.de/%40bsi/ "External link:Â Das BSI auf Mastodon (OpensÂ newÂ window)")
* [Newsletterverwaltung](DE/Service-Navi/Abonnements/Newsletter/newsletter_node.html "Newsletterverwaltung")
* [Das BSI auf YouTube](https://www.youtube.com/channel/UC_VgLyJQsChxKfDJcdI-Tcg "External link:Â Das BSI auf YouTube (OpensÂ newÂ window)")
* [Das BSI auf Xing](https://www.xing.com/pages/bsibund "External link:Â Das BSI auf Xing (OpensÂ newÂ window)")
* [RSS](DE/Service-Navi/Abonnements/RSS/rss_node.html "RSS")

[![Logo Zertifikat IT-Grundschutz ISO 27001](/SharedDocs/Bilder/DE/BSI/Logos/Logo_Zertifizierung-ISO27001_IT-Grundschutz.svg?__blob=normal "Logo Zertifikat IT-Grundschutz ISO 27001 (Quelle: BSI)")](./DE/Service/Impressum/impressum_node.html#ISO)

* [ImÂ­presÂ­sum](DE/Service/Impressum/impressum_node.html)
* [DatenÂ­schutz](DE/Service/Datenschutz/datenschutz_node.html)
* [NutzungsÂ­beÂ­dinÂ­gunÂ­gen](DE/Service/Nutzungsbedingungen/Nutzungsbedingungen_node.html "Nutzungsbedingungen")
* [BarÂ­riÂ­ereÂ­freiÂ­heit](DE/Service/Barrierefreiheit/barrierefreiheit_node.html)

Â© Federal Office for Information Security

Top
[TOP](SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646#Start "Top")

## Hinweis zur Verwendung von Cookies

Das BSI speichert keine personenbezogenen Daten der Webseitenbesucher. Details in unserer [DatenschutzerklÃ¤rung](DE/Service/Datenschutz/datenschutz_node.html "Datenschutz")

OK

![](https://piwik.itzbund.de/piwik.php?idsite=35&rec=1&url=https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html?nn=132646)


