```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "match": true,
    "data": {
      "root_cause": "The SMB server incorrectly handles the creation of NT Named Streams on existing objects. It fails to perform access checks when creating new streams (case 2), treating it as a new object creation (case 1) where no access checks are done. Additionally, permissions granted at handle creation persist for the handle's lifetime, and the SMB server redirects get/set attribute requests to the underlying object rather than the stream.",
      "weaknesses": [
        "Incorrect access control during NT Named Stream creation on existing objects.",
        "Lack of access checks during named stream creation on existing objects.",
        "Persistence of granted permissions for the lifetime of a handle without additional access checks.",
         "Redirection of get/set attribute requests to the underlying object instead of the named stream."
      ],
      "impact": "A user with `READ_XATTR` and `WRITE_XATTR` permissions can create a named stream, request `WRITE_DAC` on that handle, and use it to change permissions of the underlying object to gain full control. This allows for privilege escalation such as deleting files in directories, modifying existing object's permissions and propagating inheritable entries.",
      "attack_vectors": [
        "Creation of a named stream on an object",
        "Requesting `WRITE_DAC` permission on the created handle",
        "Using the handle to modify the underlying object's permissions via a \"set security information\" request."
      ],
      "required_capabilities": "Attacker must have `READ_XATTR` and `WRITE_XATTR` permissions to a file or directory. An attacker with these permissions can then create a Named Stream on the object, request `WRITE_DAC` on that handle and use it to change permissions on that underlying object, such as to grant themselves full control. The targeted server must have the SMB server enabled. If a user can create named streams on a directory, they can grant themselves `DELETE_CHILD` access to delete objects."
    }
  }
}
```