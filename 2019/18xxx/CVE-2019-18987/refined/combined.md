=== Content from phabricator.wikimedia.org_d31918d2_20250120_231120.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT237887)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T237887
# Old public versions of private filters are publicly viewable (CVE-2019-18987)Closed, Resolved[Public](/policy/explain/PHID-TASK-moye6ljg7ll35i2vewy7/view/)Actions

* [Edit Task](/maniphest/task/edit/237887/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/237887/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-moye6ljg7ll35i2vewy7/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-moye6ljg7ll35i2vewy7/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Protect as security issue](/wmf/escalate-task/237887/)
* [Award Token](/token/give/PHID-TASK-moye6ljg7ll35i2vewy7/)
* [Flag For Later](/flag/edit/PHID-TASK-moye6ljg7ll35i2vewy7/)

Assigned To

|  | [Urbanecm](/p/Urbanecm/) |
| --- | --- |

Authored By

|  | [suffusion\_of\_yellow](/p/suffusion_of_yellow/) |
| --- | --- |
| Nov 10 2019, 9:13 PM2019-11-10 21:13:56 (UTC+0) |

Tags

* [AbuseFilter](/tag/abusefilter/) [(Backlog)](/project/board/217/)
* [User-Urbanecm](/tag/user-urbanecm/) [(Blocked on others)](/project/board/2098/)
* [MW-1.35-notes (1.35.0-wmf.8; 2019-11-26)](/project/view/4333/)
* [Security](/tag/security/)
Referenced Files

|  | [F31062236: T237887.patch](/F31062236) |
| --- | --- |
| Nov 11 2019, 8:21 PM2019-11-11 20:21:45 (UTC+0) |

|  | [F31062031: T237887.patch](/F31062031) |
| --- | --- |
| Nov 11 2019, 4:25 PM2019-11-11 16:25:08 (UTC+0) |

|  | [F31061987: T237887.patch](/F31061987) |
| --- | --- |
| Nov 11 2019, 3:28 PM2019-11-11 15:28:41 (UTC+0) |

|  | [F31061931: T237887.patch](/F31061931) |
| --- | --- |
| Nov 11 2019, 2:24 PM2019-11-11 14:24:44 (UTC+0) |

|  | [F31061658: T237887.patch](/F31061658) |
| --- | --- |
| Nov 11 2019, 9:34 AM2019-11-11 09:34:54 (UTC+0) |

|  | [F31061327: T237887.patch](/F31061327) |
| --- | --- |
| Nov 10 2019, 10:16 PM2019-11-10 22:16:03 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Daimona](/p/Daimona/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

|  | [suffusion\_of\_yellow](/p/suffusion_of_yellow/) |
| --- | --- |

|  | [Urbanecm](/p/Urbanecm/) |
| --- | --- |

|  | [Zzuuzz](/p/Zzuuzz/) |
| --- | --- |

# Description

It's possible to view old, public versions of abusefilters that are currently marked private, by putting the ID of a public filter in the URL.

For example, version 22545 of private filter 1008 on enwiki was accidentally marked public, but the mistake was soon caught.

If we try to view it the "normal" way:

[https://en.wikipedia.org/wiki/Special:AbuseFilter/history/1008/item/22545](https://en.wikipedia.org/wiki/Special%3AAbuseFilter/history/1008/item/22545)

then we get an error, as expected. But if we pretend we're looking at filter 1 instead:

[https://en.wikipedia.org/wiki/Special:AbuseFilter/history/1/item/22545](https://en.wikipedia.org/wiki/Special%3AAbuseFilter/history/1/item/22545)

then we are shown the filter pattern, as if it were public. This leaves no way to fix the mistake of accidentally un-ticking the "private" box.

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Make sure provided filter id match provided history ID in history view](https://gerrit.wikimedia.org/r/c/550954) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_31](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_31) | +5 -1 |
|  | [SECURITY: Make sure provided filter id match provided history ID in history view](https://gerrit.wikimedia.org/r/c/550948) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/master) | +5 -1 |
|  | [SECURITY: Make sure provided filter id match provided history ID in history view](https://gerrit.wikimedia.org/r/c/550949) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_34](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_34) | +5 -1 |
|  | [SECURITY: Make sure provided filter id match provided history ID in history view](https://gerrit.wikimedia.org/r/c/550950) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_33](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_33) | +5 -1 |
|  | [SECURITY: Make sure provided filter id match provided history ID in history view](https://gerrit.wikimedia.org/r/c/550951) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_32](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_32) | +5 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T237887)
# Related Objects

* Mentions

Mentioned In [T238431: The filter ID in the URL is redundant when viewing an old version of a filter](/T238431)
[T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983) Mentioned Here [T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983)
### Event Timeline

[suffusion\_of\_yellow](/p/suffusion_of_yellow/) created this task.[Nov 10 2019, 9:13 PM2019-11-10 21:13:56 (UTC+0)](#5651383)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/3393470/)[Nov 10 2019, 9:13 PM2019-11-10 21:13:57 (UTC+0)](#5651392)[suffusion\_of\_yellow](/p/suffusion_of_yellow/) added a project: [AbuseFilter](/tag/abusefilter/).[Nov 10 2019, 9:14 PM2019-11-10 21:14:23 (UTC+0)](#5651396)[suffusion\_of\_yellow](/p/suffusion_of_yellow/) added a subscriber: [Zzuuzz](/p/Zzuuzz/).

[Urbanecm](/p/Urbanecm/) claimed this task.[Nov 10 2019, 10:11 PM2019-11-10 22:11:25 (UTC+0)](#5651412)[Urbanecm](/p/Urbanecm/) triaged this task as High priority.[Urbanecm](/p/Urbanecm/) subscribed.Comment Actions

Thanks for noticing this!

Restricted Application added a project: [User-Urbanecm](/tag/user-urbanecm/).  · [View Herald Transcript](/herald/transcript/3393487/)[Nov 10 2019, 10:11 PM2019-11-10 22:11:27 (UTC+0)](#5651414)

[Urbanecm](/p/Urbanecm/) moved this task from [Backlog / Other](/project/board/30/) to [Patch pending review](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[Nov 10 2019, 10:16 PM2019-11-10 22:16:03 (UTC+0)](#5651416)[Urbanecm](/p/Urbanecm/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Urbanecm](/p/Urbanecm/) added a subscriber: [Daimona](/p/Daimona/).Comment Actions

Fix is quite simple: Add a check into AbuseFilterViewEdit to make sure history ID and filter ID matches. My patch throws an exception if those two IDs doesn't match, because IIRC they should always match unless user is tampering the URL. [@Daimona](/p/Daimona/), could you review, please?

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/pxojaynrg7ityetlzket/PHID-FILE-qmffg6atf3m3qxjnz3d3/T237887.patch)

[Urbanecm](/p/Urbanecm/) moved this task from [Backlog](/project/board/2098/) to [Waiting on review](/project/board/2098/) on the [User-Urbanecm](/tag/user-urbanecm/) board.[Nov 10 2019, 10:17 PM2019-11-10 22:17:56 (UTC+0)](#5651421)[suffusion\_of\_yellow](/p/suffusion_of_yellow/) added a comment.[Nov 10 2019, 10:31 PM2019-11-10 22:31:35 (UTC+0)](#5651424)Comment Actions

[@Urbanecm](/p/Urbanecm/): That was quick! Your commit message says users can "view any version of any filter", but the problem isn't that severe. Only old *public* versions are visible, which is only a problem when filter managers tick the wrong box. At least, I get an error for:

[https://en.wikipedia.org/wiki/Special:AbuseFilter/history/1/item/22558](https://en.wikipedia.org/wiki/Special%3AAbuseFilter/history/1/item/22558)

because version 22558 of filter 1008 was correctly marked private.

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 11 2019, 9:34 AM2019-11-11 09:34:54 (UTC+0)](#5652484)Comment Actions

Thanks, updated commit message:

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/dllov3uz53fpwqf4ta62/PHID-FILE-qta6t2ohrum6a62wkz3r/T237887.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 11 2019, 1:08 PM2019-11-11 13:08:25 (UTC+0)](#5653365)Comment Actions

Geez. I've never liked that extra parameter (for the filter ID) in diff URLs. First because it's redundant. Second, because it unnecessarily complicates things. So, we should first put a stopgap in place, then I'd like to remove the parameter altogether.

Re: patch above:

> In [T237887#5651416](/T237887#5651416), [@Urbanecm](/p/Urbanecm/) wrote:
>
> My patch throws an exception if those two IDs doesn't match, because IIRC they should always match unless user is tampering the URL.

While that's \*probably\* true, I don't think it's fair to just throw an Exception which would the bubble up to the user. So, we should show a pretty error message. However, that would mean adding a new message, new code, new translations, just to remove it soon. Hence, I'd be fine with adding the $row->af\_id !== $filter case to the if just below. The error shown will be

> The filter you specified does not exist

But that's fine, if someone is just messing with the URL.

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 11 2019, 2:24 PM2019-11-11 14:24:44 (UTC+0)](#5653646)Comment Actions

[@Daimona](/p/Daimona/) Something like this?

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/fmvmgue2r7lfa65i3oqg/PHID-FILE-6czihpnzm5pamj6p3kdo/T237887.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 11 2019, 2:26 PM2019-11-11 14:26:27 (UTC+0)](#5653650)Comment Actions
> In [T237887#5653646](/T237887#5653646), [@Urbanecm](/p/Urbanecm/) wrote:
>
> [@Daimona](/p/Daimona/) Something like this?
>
> T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/fmvmgue2r7lfa65i3oqg/PHID-FILE-6czihpnzm5pamj6p3kdo/T237887.patch)

Exactly, thanks! I just forgot one thing: adding a @fixme comment right above the if, saying something like:

> @fixme Temporary stopgap for [T237887](/T237887)

Just in case that code survives for more than expected.

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 11 2019, 3:28 PM2019-11-11 15:28:41 (UTC+0)](#5653915)Comment Actions

Done

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/2o72cepbuiytkzaodr25/PHID-FILE-3ht7xd3ia7wrrmdgrmgg/T237887.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 11 2019, 3:37 PM2019-11-11 15:37:03 (UTC+0)](#5653946)Comment Actions
> In [T237887#5653915](/T237887#5653915), [@Urbanecm](/p/Urbanecm/) wrote:
>
> Done
>
> T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/2o72cepbuiytkzaodr25/PHID-FILE-3ht7xd3ia7wrrmdgrmgg/T237887.patch)

Tested, **-1** because it prevents the creation of new filters. The check should probably contain also `$filter !== 'new', and maybe $row->af\_id should be cast to int.

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 11 2019, 4:25 PM2019-11-11 16:25:08 (UTC+0)](#5654130)Comment Actions

Thanks. Changed the condition to be $history\_id && $row->af\_id !== $filter, given $history\_id is null when not present.

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/7cafjdgnbaqot57b35hj/PHID-FILE-mhz5bgvoyhx42lbj5wzu/T237887.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 11 2019, 7:48 PM2019-11-11 19:48:43 (UTC+0)](#5654634)Comment Actions
> In [T237887#5654130](/T237887#5654130), [@Urbanecm](/p/Urbanecm/) wrote:
>
> Thanks. Changed the condition to be $history\_id && $row->af\_id !== $filter, given $history\_id is null when not present.

OK, makes sense. One last nit: you should put spaces inside parentheses in the if condition, otherwise PHPCS will complain. After that is done, I'm fine with the patch.

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 11 2019, 8:21 PM2019-11-11 20:21:45 (UTC+0)](#5654683)Comment Actions

Done. Could i get one final review then please?

T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/yyhngchhyr4lwykxjcgn/PHID-FILE-lxalpugfe7nk2lnfjcqs/T237887.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 12 2019, 12:28 PM2019-11-12 12:28:06 (UTC+0)](#5655748)Comment Actions
> In [T237887#5654683](/T237887#5654683), [@Urbanecm](/p/Urbanecm/) wrote:
>
> Done. Could i get one final review then please?
>
> T237887.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/yyhngchhyr4lwykxjcgn/PHID-FILE-lxalpugfe7nk2lnfjcqs/T237887.patch)

Code is looking good, manual testing says it works, and PHPCS and phan are fine with it. So, **+2**, you can deploy whenever you want. I don't know whether I'll be available for live testing, but the links provided in the task description should suffice.

[Urbanecm](/p/Urbanecm/) moved this task from [Patch pending review](/project/board/30/) to [Pending deployment / release](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[Nov 12 2019, 12:29 PM2019-11-12 12:29:37 (UTC+0)](#5655750)[Urbanecm](/p/Urbanecm/) moved this task from [Waiting on review](/project/board/2098/) to [To deploy](/project/board/2098/) on the [User-Urbanecm](/tag/user-urbanecm/) board.[Nov 12 2019, 2:34 PM2019-11-12 14:34:05 (UTC+0)](#5656451)

[Urbanecm](/p/Urbanecm/) added a subscriber: [sbassett](/p/sbassett/).[Nov 12 2019, 6:19 PM2019-11-12 18:19:47 (UTC+0)](#5657534)Comment Actions
```
19:18 <Urbanecm> !log Deploy security patch for T237887
```

[@sbassett](/p/sbassett/) Could you do the final honours?

[Urbanecm](/p/Urbanecm/) moved this task from [To deploy](/project/board/2098/) to [Blocked on others](/project/board/2098/) on the [User-Urbanecm](/tag/user-urbanecm/) board.[Nov 12 2019, 6:20 PM2019-11-12 18:20:13 (UTC+0)](#5657539)[sbassett](/p/sbassett/) added a comment.[Nov 12 2019, 8:18 PM2019-11-12 20:18:03 (UTC+0)](#5658013)Comment Actions
> In [T237887#5657534](/T237887#5657534), [@Urbanecm](/p/Urbanecm/) wrote:
> ```
> 19:18 <Urbanecm> !log Deploy security patch for T237887
> ```
>
> [@sbassett](/p/sbassett/) Could you do the final honours?

Sure, I assume you mean 1) CVE 2) backports 3) tracking at [T234983](/T234983) and then making this task public?

[Urbanecm](/p/Urbanecm/) added a comment.[Nov 12 2019, 8:18 PM2019-11-12 20:18:39 (UTC+0)](#5658015)Comment Actions
> In [T237887#5658013](/T237887#5658013), [@sbassett](/p/sbassett/) wrote:
> > In [T237887#5657534](/T237887#5657534), [@Urbanecm](/p/Urbanecm/) wrote:
> > ```
> > 19:18 <Urbanecm> !log Deploy security patch for T237887
> > ```
> >
> > [@sbassett](/p/sbassett/) Could you do the final honours?
>
> Sure, I assume you mean 1) CVE 2) backports 3) tracking at [T234983](/T234983) and then making this task public?

Yes.

[sbassett](/p/sbassett/) added a comment.[Nov 12 2019, 8:34 PM2019-11-12 20:34:11 (UTC+0)](#5658073)Comment Actions
> In [T237887#5658015](/T237887#5658015), [@Urbanecm](/p/Urbanecm/) wrote:
> > Sure, I assume you mean 1) CVE 2) backports 3) tracking at [T234983](/T234983) and then making this task public?
>
> Yes.

Yes, will try to complete this week.

[sbassett](/p/sbassett/) mentioned this in [T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983).[Nov 12 2019, 10:42 PM2019-11-12 22:42:41 (UTC+0)](#5658595)[sbassett](/p/sbassett/) added a comment.[Nov 13 2019, 10:59 PM2019-11-13 22:59:14 (UTC+0)](#5662046)Comment Actions
> In [T237887#5653650](/T237887#5653650), [@Daimona](/p/Daimona/) wrote:
>
> Exactly, thanks! I just forgot one thing: adding a @fixme comment right above the if, saying something like:
>
> > @fixme Temporary stopgap for [T237887](/T237887)
>
> Just in case that code survives for more than expected.

[@Daimona](/p/Daimona/), [@Urbanecm](/p/Urbanecm/) - I have the backports ready to go, but I just noticed this ^ again and the comment within the patch. I wanted to *make sure* that we're fine with this living on master and any supported release branches where it will apply. I assume we are, given the nature of the comment, but I just wanted to double-check that the patch wasn't intended to be a very short-lived solution.

[Daimona](/p/Daimona/) added a comment.[Nov 14 2019, 1:39 PM2019-11-14 13:39:16 (UTC+0)](#5663634)Comment Actions
> In [T237887#5662046](/T237887#5662046), [@sbassett](/p/sbassett/) wrote:
> > In [T237887#5653650](/T237887#5653650), [@Daimona](/p/Daimona/) wrote:
> >
> > Exactly, thanks! I just forgot one thing: adding a @fixme comment right above the if, saying something like:
> >
> > > @fixme Temporary stopgap for [T237887](/T237887)
> >
> > Just in case that code survives for more than expected.
>
> [@Daimona](/p/Daimona/), [@Urbanecm](/p/Urbanecm/) - I have the backports ready to go, but I just noticed this ^ again and the comment within the patch. I wanted to *make sure* that we're fine with this living on master and any supported release branches where it will apply. I assume we are, given the nature of the comment, but I just wanted to double-check that the patch wasn't intended to be a very short-lived solution.

I'm fine with that. The only problem with that patch is that we show a somewhat generic error message ("filter doesn't exist") instead of a specific one ("IDs don't match"). However, you can only get the error if you manually mess up with the URL, so you should already know what's going on. Aside from that, the solution is not short-lived.

As I said, after the backports are merged, I'll try to remove that extra param (I still don't know what the new URL format should look like, though). If it turns out to be too hard to implement, then I'll split the IF case, and add a new message, which we can also backport if we want.

At any rate, waiting for your green light before pushing anything to gerrit.

[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[Nov 14 2019, 9:54 PM2019-11-14 21:54:32 (UTC+0)](#5665433)[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-3i567gj3nyxlew7/)" to "Public (No Login Required)".[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 9:55 PM2019-11-14 21:55:00 (UTC+0)](#5665435)Comment Actions

Change 550949 had a related patch set uploaded (by SBassett; owner: Urbanecm):

[mediawiki/extensions/AbuseFilter@REL1\_34] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550949>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Nov 14 2019, 9:55 PM2019-11-14 21:55:01 (UTC+0)](#5665436)Comment Actions

Change 550950 had a related patch set uploaded (by SBassett; owner: Urbanecm):

[mediawiki/extensions/AbuseFilter@REL1\_33] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550950>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 9:56 PM2019-11-14 21:56:03 (UTC+0)](#5665449)Comment Actions

Change 550951 had a related patch set uploaded (by SBassett; owner: Urbanecm):

[mediawiki/extensions/AbuseFilter@REL1\_32] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550951>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:04 PM2019-11-14 22:04:20 (UTC+0)](#5665494)Comment Actions

Change 550954 had a related patch set uploaded (by SBassett; owner: Urbanecm):

[mediawiki/extensions/AbuseFilter@REL1\_31] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550954>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:09 PM2019-11-14 22:09:05 (UTC+0)](#5665498)Comment Actions

Change 550951 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_32] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550951>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:09 PM2019-11-14 22:09:39 (UTC+0)](#5665499)Comment Actions

Change 550949 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_34] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550949>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:09 PM2019-11-14 22:09:42 (UTC+0)](#5665500)Comment Actions

Change 550950 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_33] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550950>

[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:15 PM2019-11-14 22:15:13 (UTC+0)](#5665517)Comment Actions

Change 550948 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@master] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550948>

[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[Nov 14 2019, 10:58 PM2019-11-14 22:58:06 (UTC+0)](#5665742)[gerritbot](/p/gerritbot/) added a comment.[Nov 14 2019, 10:59 PM2019-11-14 22:59:56 (UTC+0)](#5665749)Comment Actions

Change 550954 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_31] SECURITY: Make sure provided filter id match provided history ID in history view

<https://gerrit.wikimedia.org/r/550954>

[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added a project: [MW-1.35-notes (1.35.0-wmf.8; 2019-11-26)](/project/view/4333/).[Nov 14 2019, 11:00 PM2019-11-14 23:00:31 (UTC+0)](#5665751)[sbassett](/p/sbassett/) renamed this task from Old public versions of private filters are publicly viewable to Old public versions of private filters are publicly viewable (CVE-2019-18987).[Nov 15 2019, 4:13 PM2019-11-15 16:13:23 (UTC+0)](#5667085)[sbassett](/p/sbassett/) closed this task as Resolved.[Nov 15 2019, 4:16 PM2019-11-15 16:16:17 (UTC+0)](#5667101)[sbassett](/p/sbassett/) moved this task from [Pending deployment / release](/project/board/30/) to [Done](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.Comment Actions

Ok, backports done, CVE filed (CVE-2019-18987), tracking in [T234983](/T234983). I'm going to resolve this for now. Thanks everyone.

[Daimona](/p/Daimona/) mentioned this in [T238431: The filter ID in the URL is redundant when viewing an old version of a filter](/T238431).[Nov 15 2019, 6:15 PM2019-11-15 18:15:17 (UTC+0)](#5667606)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:53 PM2020-02-10 22:53:55 (UTC+0)](#5868195) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:14 PM2020-02-20 20:14:38 (UTC+0)](#5903894) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_ef75c685_20250120_231118.html ===




=== Content from www.mediawiki.org_8a8a9885_20250120_231120.html ===
[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/MediaWiki "Visit the main page [z]")
* [Get MediaWiki](/wiki/Download)
* [Get extensions](/wiki/Special%3AMyLanguage/Category%3AExtensions)
* [Tech blog](https://techblog.wikimedia.org/)
* [Contribute](/wiki/Special%3AMyLanguage/How_to_contribute)

Support

* [User help](/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")
* [FAQ](/wiki/Special%3AMyLanguage/Manual%3AFAQ)
* [Technical manual](/wiki/Special%3AMyLanguage/Manual%3AContents)
* [Support desk](/wiki/Project%3ASupport_desk)
* [Communication](/wiki/Special%3AMyLanguage/Communication)

Development

* [Developer portal](https://developer.wikimedia.org/)
* [Code statistics](/wiki/Development_statistics)

mediawiki.org

* [Community portal](/wiki/Project%3AHelp "About the project, what you can do, where to find things")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Translate content](/wiki/Special%3ALanguageStats)
* [Random page](/wiki/Special%3ARandom "Load a random page [x]")
* [Village pump](/wiki/Project%3AVillage_Pump)
* [Sandbox](/wiki/Project%3ASandbox)

In other languages

* [العربية](https://ar.wikipedia.org/wiki/%D9%88%D9%8A%D9%83%D9%8A%D8%A8%D9%8A%D8%AF%D9%8A%D8%A7%3A%D9%85%D8%B1%D8%B4%D8%AD_%D8%A7%D9%84%D8%A5%D8%B3%D8%A7%D8%A1%D8%A9 "ويكيبيديا:مرشح الإساءة – Arabic")
* [تۆرکجه](https://azb.wikipedia.org/wiki/%D9%88%DB%8C%DA%A9%DB%8C%E2%80%8C%D9%BE%D8%AF%DB%8C%D8%A7%3A%D8%AE%D8%A7%D8%B1%D8%A7%D8%A8%DA%A9%D8%A7%D8%B1%D9%84%DB%8C%D9%82_%D8%B3%DB%86%D8%B2%DA%AF%D9%8E%D8%AC%DB%8C_%D8%AF%D9%8E%DB%8C%DB%8C%D8%B4%D8%AF%DB%8C%D8%B1%D9%86%D9%84%D8%B1 "ویکی‌پدیا:خارابکارلیق سۆزگَجی دَییشدیرنلر – South Azerbaijani")
* [Беларуская (тарашкевіца)](https://be-tarask.wikipedia.org/wiki/%D0%92%D1%96%D0%BA%D1%96%D0%BF%D1%8D%D0%B4%D1%8B%D1%8F%3A%D0%A4%D1%96%D0%BB%D1%8C%D1%82%D0%B0%D1%80_%D1%80%D1%8D%D0%B4%D0%B0%D0%B3%D0%B0%D0%B2%D0%B0%D0%BD%D1%8C%D0%BD%D1%8F%D1%9E "Вікіпэдыя:Фільтар рэдагаваньняў – Belarusian (Taraškievica orthography)")
* [বাংলা](https://bn.wikipedia.org/wiki/%E0%A6%89%E0%A6%87%E0%A6%95%E0%A6%BF%E0%A6%AA%E0%A6%BF%E0%A6%A1%E0%A6%BF%E0%A6%AF%E0%A6%BC%E0%A6%BE%3A%E0%A6%B8%E0%A6%AE%E0%A7%8D%E0%A6%AA%E0%A6%BE%E0%A6%A6%E0%A6%A8%E0%A6%BE_%E0%A6%9B%E0%A6%BE%E0%A6%81%E0%A6%95%E0%A6%A8%E0%A6%BF "উইকিপিডিয়া:সম্পাদনা ছাঁকনি – Bangla")
* [Català](https://ca.wikipedia.org/wiki/Viquip%C3%A8dia%3AFiltre_d%27edicions "Viquipèdia:Filtre d'edicions – Catalan")
* [Čeština](https://cs.wikipedia.org/wiki/Wikipedie%3AEdita%C4%8Dn%C3%AD_filtr "Wikipedie:Editační filtr – Czech")
* [Dansk](https://da.wikipedia.org/wiki/Hj%C3%A6lp%3AMisbrugsfilter "Hjælp:Misbrugsfilter – Danish")
* [Deutsch](https://de.wikipedia.org/wiki/Wikipedia%3ABearbeitungsfilter "Wikipedia:Bearbeitungsfilter – German")
* [English](https://en.wikipedia.org/wiki/Wikipedia%3AEdit_filter "Wikipedia:Edit filter – English")
* [Español](https://es.wikipedia.org/wiki/Wikipedia%3AFiltro_de_ediciones "Wikipedia:Filtro de ediciones – Spanish")
* [فارسی](https://fa.wikipedia.org/wiki/%D9%88%DB%8C%DA%A9%DB%8C%E2%80%8C%D9%BE%D8%AF%DB%8C%D8%A7%3A%D9%BE%D8%A7%D9%84%D8%A7%DB%8C%D9%87_%D9%88%DB%8C%D8%B1%D8%A7%DB%8C%D8%B4 "ویکی‌پدیا:پالایه ویرایش – Persian")
* [Suomi](https://fi.wikipedia.org/wiki/Wikipedia%3AV%C3%A4%C3%A4rink%C3%A4ytt%C3%B6suodatin "Wikipedia:Väärinkäyttösuodatin – Finnish")
* [Français](https://fr.wikipedia.org/wiki/Wikip%C3%A9dia%3AAbuseFilter "Wikipédia:AbuseFilter – French")
* [Galego](https://gl.wikipedia.org/wiki/Wikipedia%3AFiltro_de_abusos "Wikipedia:Filtro de abusos – Galician")
* [עברית](https://he.wikipedia.org/wiki/%D7%95%D7%99%D7%A7%D7%99%D7%A4%D7%93%D7%99%D7%94%3A%D7%9E%D7%A1%D7%A0%D7%9F_%D7%94%D7%A9%D7%97%D7%AA%D7%95%D7%AA "ויקיפדיה:מסנן השחתות – Hebrew")
* [Magyar](https://hu.wikipedia.org/wiki/Wikip%C3%A9dia%3AVand%C3%A1lsz%C5%B1r%C5%91 "Wikipédia:Vandálszűrő – Hungarian")
* [Bahasa Indonesia](https://id.wikipedia.org/wiki/Wikipedia%3AFilter_penyuntingan "Wikipedia:Filter penyuntingan – Indonesian")
* [Italiano](https://it.wikipedia.org/wiki/Wikipedia%3AFiltro_anti_abusi "Wikipedia:Filtro anti abusi – Italian")
* [日本語](https://ja.wikipedia.org/wiki/Wikipedia%3A%E7%B7%A8%E9%9B%86%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC "Wikipedia:編集フィルター – Japanese")
* [한국어](https://ko.wikipedia.org/wiki/%EC%9C%84%ED%82%A4%EB%B0%B1%EA%B3%BC%3A%ED%8E%B8%EC%A7%91_%ED%95%84%ED%84%B0 "위키백과:편집 필터 – Korean")
* [Lietuvių](https://lt.wikipedia.org/wiki/Vikipedija%3AAbuse_filter "Vikipedija:Abuse filter – Lithuanian")
* [मराठी](https://mr.wikipedia.org/wiki/%E0%A4%B5%E0%A4%BF%E0%A4%95%E0%A4%BF%E0%A4%AA%E0%A5%80%E0%A4%A1%E0%A4%BF%E0%A4%AF%E0%A4%BE%3A%E0%A4%B8%E0%A4%82%E0%A4%AA%E0%A4%BE%E0%A4%A6%E0%A4%A8_%E0%A4%97%E0%A4%BE%E0%A4%B3%E0%A4%A3%E0%A5%80 "विकिपीडिया:संपादन गाळणी – Marathi")
* [नेपाली](https://ne.wikipedia.org/wiki/%E0%A4%B5%E0%A4%BF%E0%A4%95%E0%A4%BF%E0%A4%AA%E0%A4%BF%E0%A4%A1%E0%A4%BF%E0%A4%AF%E0%A4%BE%3A%E0%A4%A6%E0%A5%81%E0%A4%B0%E0%A5%81%E0%A4%AA%E0%A4%AF%E0%A5%8B%E0%A4%97_%E0%A4%9B%E0%A4%A8%E0%A5%8C%E0%A4%9F "विकिपिडिया:दुरुपयोग छनौट – Nepali")
* [Nederlands](https://nl.wikipedia.org/wiki/Wikipedia%3AMisbruikfilter "Wikipedia:Misbruikfilter – Dutch")
* [Norsk bokmål](https://no.wikipedia.org/wiki/Wikipedia%3ARedigeringsfilter "Wikipedia:Redigeringsfilter – Norwegian Bokmål")
* [Polski](https://pl.wikipedia.org/wiki/Wikipedia%3AFiltr_nadu%C5%BCy%C4%87 "Wikipedia:Filtr nadużyć – Polish")
* [Português](https://pt.wikipedia.org/wiki/Wikip%C3%A9dia%3AFiltro_de_edi%C3%A7%C3%B5es "Wikipédia:Filtro de edições – Portuguese")
* [Română](https://ro.wikipedia.org/wiki/Wikipedia%3AFiltrarea_modific%C4%83rilor "Wikipedia:Filtrarea modificărilor – Romanian")
* [Русский](https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D0%BA%D0%B8%D0%BF%D0%B5%D0%B4%D0%B8%D1%8F%3A%D0%A4%D0%B8%D0%BB%D1%8C%D1%82%D1%80_%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D0%BA "Википедия:Фильтр правок – Russian")
* [سنڌي](https://sd.wikipedia.org/wiki/%D9%88%DA%AA%D9%8A%D9%BE%D9%8A%DA%8A%D9%8A%D8%A7%3AEdit_filter "وڪيپيڊيا:Edit filter – Sindhi")
* [සිංහල](https://si.wikipedia.org/wiki/%E0%B7%80%E0%B7%92%E0%B6%9A%E0%B7%92%E0%B6%B4%E0%B7%93%E0%B6%A9%E0%B7%92%E0%B6%BA%E0%B7%8F%3A%E0%B7%83%E0%B6%82%E0%B7%83%E0%B7%8A%E0%B6%9A%E0%B6%BB%E0%B6%AB_%E0%B6%B4%E0%B7%99%E0%B6%BB%E0%B7%84%E0%B6%B1 "විකිපීඩියා:සංස්කරණ පෙරහන – Sinhala")
* [Simple English](https://simple.wikipedia.org/wiki/Wikipedia%3AChange_filter "Wikipedia:Change filter – Simple English")
* [Slovenčina](https://sk.wikipedia.org/wiki/Wikip%C3%A9dia%3AFilter_%C3%BAprav "Wikipédia:Filter úprav – Slovak")
* [Slovenščina](https://sl.wikipedia.org/wiki/Wikipedija%3AFilter_zlorab "Wikipedija:Filter zlorab – Slovenian")
* [Svenska](https://sv.wikipedia.org/wiki/Wikipedia%3ARedigeringsfilter "Wikipedia:Redigeringsfilter – Swedish")
* [ไทย](https://th.wikipedia.org/wiki/%E0%B8%A7%E0%B8%B4%E0%B8%81%E0%B8%B4%E0%B8%9E%E0%B8%B5%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%3A%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B8%81%E0%B8%A3%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82 "วิกิพีเดีย:ตัวกรองการแก้ไข – Thai")
* [Türkçe](https://tr.wikipedia.org/wiki/Vikipedi%3ADe%C4%9Fi%C5%9Fiklik_s%C3%BCzgeci "Vikipedi:Değişiklik süzgeci – Turkish")
* [Українська](https://uk.wikipedia.org/wiki/%D0%92%D1%96%D0%BA%D1%96%D0%BF%D0%B5%D0%B4%D1%96%D1%8F%3A%D0%A4%D1%96%D0%BB%D1%8C%D1%82%D1%80_%D1%80%D0%B5%D0%B4%D0%B0%D0%B3%D1%83%D0%B2%D0%B0%D0%BD%D1%8C "Вікіпедія:Фільтр редагувань – Ukrainian")
* [اردو](https://ur.wikipedia.org/wiki/%D9%88%DB%8C%DA%A9%DB%8C%D9%BE%DB%8C%DA%88%DB%8C%D8%A7%3A%D9%85%D9%82%D8%B7%D8%B1_%D8%BA%D9%84%D8%B7_%DA%A9%D8%A7%D8%B1%DB%8C "ویکیپیڈیا:مقطر غلط کاری – Urdu")
* [Tiếng Việt](https://vi.wikipedia.org/wiki/Wikipedia%3AB%E1%BB%99_l%E1%BB%8Dc_sai_ph%E1%BA%A1m "Wikipedia:Bộ lọc sai phạm – Vietnamese")
* [吴语](https://wuu.wikipedia.org/wiki/Wikipedia%3A%E9%98%B2%E6%BB%A5%E7%94%A8%E8%BF%87%E6%BB%A4%E5%99%A8 "Wikipedia:防滥用过滤器 – Wu")
* [中文](https://zh.wikipedia.org/wiki/Wikipedia%3A%E9%98%B2%E6%BB%A5%E7%94%A8%E8%BF%87%E6%BB%A4%E5%99%A8 "Wikipedia:防滥用过滤器 – Chinese")
* [粵語](https://zh-yue.wikipedia.org/wiki/Wikipedia%3A%E6%BF%AB%E7%94%A8%E9%81%8E%E6%BF%BE%E5%99%A8 "Wikipedia:濫用過濾器 – Cantonese")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q4582485#sitelinks-wikipedia "Edit interlanguage links")

[![](/static/images/icons/mediawikiwiki.svg)
![MediaWiki](/static/images/mobile/copyright/mediawikiwiki-wordmark.svg)](/wiki/MediaWiki)

[Search](/wiki/Special%3ASearch "Search MediaWiki [f]")

Search

* English

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=www.mediawiki.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Extension%3AAbuseFilter "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Extension%3AAbuseFilter "You are encouraged to log in; however, it is not mandatory [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=www.mediawiki.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Extension%3AAbuseFilter "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Extension%3AAbuseFilter "You are encouraged to log in; however, it is not mandatory [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* Beginning
* [1
  Installation](#Installation)
* [2
  Configuration](#Configuration)

  Toggle Configuration subsection
  + [2.1
    User rights](#User_rights)
  + [2.2
    Parameters](#Parameters)
  + [2.3
    Emergency throttling](#Emergency_throttling)
* [3
  Creating and managing filters](#Creating_and_managing_filters)
* [4
  API](#API)

  Toggle API subsection
  + [4.1
    list = abusefilters](#list_=_abusefilters)
  + [4.2
    list = abuselog](#list_=_abuselog)
* [5
  Possible errors](#Possible_errors)
* [6
  Integration with other extensions](#Integration_with_other_extensions)

  Toggle Integration with other extensions subsection
  + [6.1
    Adding variables for filtering](#Adding_variables_for_filtering)
  + [6.2
    Adding custom actions](#Adding_custom_actions)
  + [6.3
    Adding rule groups](#Adding_rule_groups)
* [7
  See also](#See_also)

Toggle the table of contents

# Extension:AbuseFilter

[Issue tracker](/wiki/Special%3AMyLanguage/Phabricator "Special:MyLanguage/Phabricator"): [**#AbuseFilter**](https://phabricator.wikimedia.org/tag/abusefilter/ "phab:tag/abusefilter/")

* [Extension](/wiki/Extension%3AAbuseFilter "View the subject page [c]")
* [Discussion](/wiki/Extension_talk%3AAbuseFilter "Discussion about the content page [t]")

English

* [Read](/wiki/Extension%3AAbuseFilter)
* [View source](/w/index.php?title=Extension:AbuseFilter&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/w/index.php?title=Extension:AbuseFilter&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/Extension%3AAbuseFilter)
* [View source](/w/index.php?title=Extension:AbuseFilter&action=edit)
* [View history](/w/index.php?title=Extension:AbuseFilter&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/Extension%3AAbuseFilter "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Extension%3AAbuseFilter "Recent changes in pages linked from this page [k]")
* [Upload file](//commons.wikimedia.org/wiki/Special%3AUploadWizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=Extension:AbuseFilter&oldid=6884904 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Extension:AbuseFilter&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=Extension%3AAbuseFilter&id=6884904&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fwww.mediawiki.org%2Fwiki%2FExtension%3AAbuseFilter)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fwww.mediawiki.org%2Fwiki%2FExtension%3AAbuseFilter)

Print/export

* [Create a book](/w/index.php?title=Special:Book&bookcmd=book_creator&referer=Extension%3AAbuseFilter)
* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=Extension%3AAbuseFilter&action=show-download-screen)
* [Printable version](/w/index.php?title=Extension:AbuseFilter&printable=yes "Printable version of this page [p]")

In other projects

* [Wikimedia Commons](https://commons.wikimedia.org/wiki/Commons%3AAbuse_filter)
* [Meta-Wiki](https://meta.wikimedia.org/wiki/AbuseFilter)
* [Wikibooks](https://en.wikibooks.org/wiki/Wikibooks%3AEdit_filter)
* [Wikidata](https://www.wikidata.org/wiki/Wikidata%3AAbuse_filter)
* [Wikipedia](https://en.wikipedia.org/wiki/Wikipedia%3AEdit_filter)
* [Wikivoyage](https://en.wikivoyage.org/wiki/Wikivoyage%3AAbuse_filters)
* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q4582485 "Link to connected data repository item [g]")

Appearance
move to sidebar
hide

From mediawiki.org

[Translate this page](/w/index.php?title=Special:Translate&group=page-Extension%3AAbuseFilter&action=page&filter=&action_source=translate_page "Special:Translate")Languages:

* [Bahasa Indonesia](/wiki/Extension%3AAbuseFilter/id "Extension:AbuseFilter/id (10% translated)")
* [Deutsch](/wiki/Extension%3AAbuseFilter/de "Erweiterung:Missbrauchsfilter (100% translated)")
* [Deutsch (Sie-Form)](/wiki/Extension%3AAbuseFilter/de-formal "Erweiterung:Missbrauchsfilter (17% translated)")
* English
* [Nederlands](/wiki/Extension%3AAbuseFilter/nl "Extension:AbuseFilter/nl (100% translated)")
* [Türkçe](/wiki/Extension%3AAbuseFilter/tr "Extension:AbuseFilter (82% translated)")
* [Zazaki](/wiki/Extension%3AAbuseFilter/diq "Extension:AbuseFilter/diq (3% translated)")
* [català](/wiki/Extension%3AAbuseFilter/ca "Extensió:AbuseFilter (9% translated)")
* [dansk](/wiki/Extension%3AAbuseFilter/da "Udvidelse:Misbrugfilter (19% translated)")
* [español](/wiki/Extension%3AAbuseFilter/es "Extensión:AbuseFilter (83% translated)")
* [français](/wiki/Extension%3AAbuseFilter/fr "Extension:AbuseFilter (84% translated)")
* [galego](/wiki/Extension%3AAbuseFilter/gl "Extensión:AbuseFilter (36% translated)")
* [italiano](/wiki/Extension%3AAbuseFilter/it "Estensione:AbuseFilter (3% translated)")
* [magyar](/wiki/Extension%3AAbuseFilter/hu "Kiterjesztés:AbuseFilter (26% translated)")
* [polski](/wiki/Extension%3AAbuseFilter/pl "Rozszerzenie:Filtr nadużyć (45% translated)")
* [português](/wiki/Extension%3AAbuseFilter/pt "Extension:Filtro de Abuso (22% translated)")
* [português do Brasil](/wiki/Extension%3AAbuseFilter/pt-br "Extensão:Filtro de abusos (82% translated)")
* [română](/wiki/Extension%3AAbuseFilter/ro "Extensie:AbuseFilter (40% translated)")
* [sicilianu](/wiki/Extension%3AAbuseFilter/scn "Estinzioni:AbuseFilter (6% translated)")
* [čeština](/wiki/Extension%3AAbuseFilter/cs "Rozšíření:AbuseFilter (83% translated)")
* [български](/wiki/Extension%3AAbuseFilter/bg "Extension:AbuseFilter/bg (36% translated)")
* [русский](/wiki/Extension%3AAbuseFilter/ru "Расширение: AbuseFilter (62% translated)")
* [українська](/wiki/Extension%3AAbuseFilter/uk "Розширення:Фільтр зловживань (3% translated)")
* [עברית](/wiki/Extension%3AAbuseFilter/he "הרחבה:מסנן ההשחתות (16% translated)")
* [العربية](/wiki/Extension%3AAbuseFilter/ar "Extension:مرشح الإساءة (69% translated)")
* [سنڌي](/wiki/Extension%3AAbuseFilter/sd "Extension:بدسلوڪي ڇاڻي (8% translated)")
* [فارسی](/wiki/Extension%3AAbuseFilter/fa "Extension:AbuseFilter/fa (9% translated)")
* [हिन्दी](/wiki/Extension%3AAbuseFilter/hi "Extension:दुरुपयोग फ़िल्टर (83% translated)")
* [বাংলা](/wiki/Extension%3AAbuseFilter/bn "এক্সটেনশন:অপব্যবহার ছাঁকনি (3% translated)")
* [ไทย](/wiki/Extension%3AAbuseFilter/th "ส่วนขยาย:AbuseFilter (82% translated)")
* [ភាសាខ្មែរ](/wiki/Extension%3AAbuseFilter/km "Extension:AbuseFilter/km (0% translated)")
* [中文](/wiki/Extension%3AAbuseFilter/zh "Extension:AbuseFilter (86% translated)")
* [日本語](/wiki/Extension%3AAbuseFilter/ja "Extension:AbuseFilter (83% translated)")
* [粵語](/wiki/Extension%3AAbuseFilter/yue "擴充功能:AbuseFilter (5% translated)")
* [한국어](/wiki/Extension%3AAbuseFilter/ko "확장기능:편집필터 (23% translated)")

This extension [comes with MediaWiki 1.38](/wiki/Special%3AMyLanguage/MediaWiki_1.38#Bundled_extensions "Special:MyLanguage/MediaWiki 1.38") and above. Thus you do not have to download it again. However, you still need to follow the other instructions provided.

**[MediaWiki extensions manual](/wiki/Special%3AMyLanguage/Manual%3AExtensions "Special:MyLanguage/Manual:Extensions")**
| AbuseFilter [Release status:](/wiki/Special%3AMyLanguage/Extension_status "Special:MyLanguage/Extension status") stable | |
| --- | --- |
|  | |
| **[Implementation](/wiki/Special%3AMyLanguage/Template%3AExtension#type "Special:MyLanguage/Template:Extension")** | [User activity](/wiki/Special%3AMyLanguage/Manual%3ASecurity "Special:MyLanguage/Manual:Security"), [Special page](/wiki/Special%3AMyLanguage/Manual%3ASpecial_pages "Special:MyLanguage/Manual:Special pages"), [API](/wiki/Special%3AMyLanguage/API%3AAction_API "Special:MyLanguage/API:Action API") |
| **[Description](/wiki/Special%3AMyLanguage/Template%3AExtension#description "Special:MyLanguage/Template:Extension")** | Allows specific behavior-based restrictions to be placed on wiki activity |
| **[Author(s)](/wiki/Special%3AMyLanguage/Template%3AExtension#username "Special:MyLanguage/Template:Extension")** | * [Andrew Garrett](/wiki/User%3AWerdna "User:Werdna") * [Daimona Eaytoy](/wiki/User%3ADaimona_Eaytoy "User:Daimona Eaytoy") * Marius Hoch * River Tarnell * Victor Vasiliev |
| **[Compatibility policy](/wiki/Special%3AMyLanguage/Compatibility#mediawiki_extensions "Special:MyLanguage/Compatibility")** | Snapshots releases along with MediaWiki. Master is not backward compatible. |
| [**Database changes**](/wiki/Special%3AMyLanguage/Template%3AExtension#needs-updatephp "Special:MyLanguage/Template:Extension") | Yes |
| [**Composer**](/wiki/Special%3AMyLanguage/Composer "Special:MyLanguage/Composer") | [mediawiki/abuse-filter](https://packagist.org/packages/mediawiki/abuse-filter) |
| **[Tables](/wiki/Special%3AMyLanguage/Template%3AExtension#table1 "Special:MyLanguage/Template:Extension")** | [abuse\_filter](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/abuse_filter_table "Special:MyLanguage/Extension:AbuseFilter/abuse filter table")[abuse\_filter\_action](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/abuse_filter_action_table "Special:MyLanguage/Extension:AbuseFilter/abuse filter action table")[abuse\_filter\_history](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/abuse_filter_history_table "Special:MyLanguage/Extension:AbuseFilter/abuse filter history table")[abuse\_filter\_log](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/abuse_filter_log_table "Special:MyLanguage/Extension:AbuseFilter/abuse filter log table") |
| **[License](/wiki/Special%3AMyLanguage/Template%3AExtension#license "Special:MyLanguage/Template:Extension")** | [GNU General Public License 2.0 or later](//www.gnu.org/licenses/old-licenses/gpl-2.0-standalone.html) |
| **Download** | [**Download extension**](/wiki/Special%3AExtensionDistributor/AbuseFilter "Special:ExtensionDistributor/AbuseFilter") Git [[?](/wiki/Special%3AMyLanguage/Download_from_Git "Special:MyLanguage/Download from Git")]:  * [Download Git master](https://github.com/wikimedia/mediawiki-extensions-AbuseFilter/archive/master.tar.gz) * [browse repository](https://gerrit.wikimedia.org/g/mediawiki/extensions/AbuseFilter "git:mediawiki/extensions/AbuseFilter") ([Phabricator](https://phabricator.wikimedia.org/diffusion/EABF "phab:diffusion/EABF") · [GitHub](https://github.com/wikimedia/mediawiki-extensions-AbuseFilter)) * [commit history](https://gerrit.wikimedia.org/g/mediawiki/extensions/AbuseFilter/%2Blog/master "git:mediawiki/extensions/AbuseFilter/+log/master") * [repository contributors (GitHub)](https://github.com/wikimedia/mediawiki-extensions-AbuseFilter/graphs/contributors) * [code review](https://gerrit.wikimedia.org/r/q/project%3Amediawiki/extensions/AbuseFilter "gerrit:q/project:mediawiki/extensions/AbuseFilter") |
| [Parameters](/wiki/Special%3AMyLanguage/Template%3AExtension#parameters "Special:MyLanguage/Template:Extension")  * $wgAbuseFilterConditionLimit * $wgAbuseFilterRangeBlockSize * $wgAbuseFilterAnonBlockDuration * $wgAbuseFilterLogIPMaxAge * $wgAbuseFilterCentralDB * $wgAbuseFilterDefaultWarningMessage * $wgAbuseFilterEmergencyDisableAge * $wgAbuseFilterEnableBlockedExternalDomain * $wgAbuseFilterActionRestrictions * $wgAbuseFilterActions * $wgAbuseFilterProtectedVariables * $wgAbuseFilterLogIP * $wgAbuseFilterPrivateDetailsForceReason * $wgAbuseFilterEmergencyDisableCount * $wgAbuseFilterLogPrivateDetailsAccess * $wgAbuseFilterSlowFilterRuntimeLimit * $wgAbuseFilterEmergencyDisableThreshold * $wgAbuseFilterLocallyDisabledGlobalActions * $wgAbuseFilterBlockDuration * $wgAbuseFilterDefaultDisallowMessage * $wgAbuseFilterValidGroups * $wgAbuseFilterNotificationsPrivate * $wgAbuseFilterBlockAutopromoteDuration * $wgAbuseFilterIsCentral * $wgAbuseFilterNotifications | |
| [Added rights](/wiki/Special%3AMyLanguage/Template%3AExtension#rights "Special:MyLanguage/Template:Extension")  * abusefilter-modify * abusefilter-log-detail * abusefilter-view * abusefilter-log * abusefilter-privatedetails * abusefilter-privatedetails-log * abusefilter-modify-restricted * abusefilter-revert * abusefilter-view-private * abusefilter-log-private * abusefilter-hidden-log * abusefilter-hide-log * abusefilter-modify-global * abusefilter-modify-blocked-external-domains * abusefilter-bypass-blocked-external-domains * abusefilter-access-protected-vars * abusefilter-protected-vars-log | |
| [Hooks used](/wiki/Special%3AMyLanguage/Template%3AExtension#hook "Special:MyLanguage/Template:Extension")  * [BeforeCreateEchoEvent](/wiki/Special%3AMyLanguage/Manual%3AHooks/BeforeCreateEchoEvent "Special:MyLanguage/Manual:Hooks/BeforeCreateEchoEvent") * [ChangeTagsListActive](/wiki/Special%3AMyLanguage/Manual%3AHooks/ChangeTagsListActive "Special:MyLanguage/Manual:Hooks/ChangeTagsListActive") * [CheckUserInsertChangesRow](/wiki/Special%3AMyLanguage/Manual%3AHooks/CheckUserInsertChangesRow "Special:MyLanguage/Manual:Hooks/CheckUserInsertChangesRow") * [CheckUserInsertLogEventRow](/wiki/Special%3AMyLanguage/Manual%3AHooks/CheckUserInsertLogEventRow "Special:MyLanguage/Manual:Hooks/CheckUserInsertLogEventRow") * [CheckUserInsertPrivateEventRow](/wiki/Special%3AMyLanguage/Manual%3AHooks/CheckUserInsertPrivateEventRow "Special:MyLanguage/Manual:Hooks/CheckUserInsertPrivateEventRow") * [ContributionsToolLinks](/wiki/Special%3AMyLanguage/Manual%3AHooks/ContributionsToolLinks "Special:MyLanguage/Manual:Hooks/ContributionsToolLinks") * [EditFilterMergedContent](/wiki/Special%3AMyLanguage/Manual%3AHooks/EditFilterMergedContent "Special:MyLanguage/Manual:Hooks/EditFilterMergedContent") * [GetAutoPromoteGroups](/wiki/Special%3AMyLanguage/Manual%3AHooks/GetAutoPromoteGroups "Special:MyLanguage/Manual:Hooks/GetAutoPromoteGroups") * [GetPreferences](/wiki/Special%3AMyLanguage/Manual%3AHooks/GetPreferences "Special:MyLanguage/Manual:Hooks/GetPreferences") * [HistoryPageToolLinks](/wiki/Special%3AMyLanguage/Manual%3AHooks/HistoryPageToolLinks "Special:MyLanguage/Manual:Hooks/HistoryPageToolLinks") * [JsonValidateSave](/wiki/Special%3AMyLanguage/Manual%3AHooks/JsonValidateSave "Special:MyLanguage/Manual:Hooks/JsonValidateSave") * [ListDefinedTags](/wiki/Special%3AMyLanguage/Manual%3AHooks/ListDefinedTags "Special:MyLanguage/Manual:Hooks/ListDefinedTags") * [LoadExtensionSchemaUpdates](/wiki/Special%3AMyLanguage/Manual%3AHooks/LoadExtensionSchemaUpdates "Special:MyLanguage/Manual:Hooks/LoadExtensionSchemaUpdates") * [PageDelete](/wiki/Special%3AMyLanguage/Manual%3AHooks/PageDelete "Special:MyLanguage/Manual:Hooks/PageDelete") * [PageSaveComplete](/wiki/Special%3AMyLanguage/Manual%3AHooks/PageSaveComplete "Special:MyLanguage/Manual:Hooks/PageSaveComplete") * [ParserOutputStashForEdit](/wiki/Special%3AMyLanguage/Manual%3AHooks/ParserOutputStashForEdit "Special:MyLanguage/Manual:Hooks/ParserOutputStashForEdit") * [RecentChange\_save](/wiki/Special%3AMyLanguage/Manual%3AHooks/RecentChange_save "Special:MyLanguage/Manual:Hooks/RecentChange save") * [SaveUserOptions](/wiki/Special%3AMyLanguage/Manual%3AHooks/SaveUserOptions "Special:MyLanguage/Manual:Hooks/SaveUserOptions") * [TitleMove](/wiki/Special%3AMyLanguage/Manual%3AHooks/TitleMove "Special:MyLanguage/Manual:Hooks/TitleMove") * [UndeletePageToolLinks](/wiki/Special%3AMyLanguage/Manual%3AHooks/UndeletePageToolLinks "Special:MyLanguage/Manual:Hooks/UndeletePageToolLinks") * [UploadStashFile](/wiki/Special%3AMyLanguage/Manual%3AHooks/UploadStashFile "Special:MyLanguage/Manual:Hooks/UploadStashFile") * [UploadVerifyUpload](/wiki/Special%3AMyLanguage/Manual%3AHooks/UploadVerifyUpload "Special:MyLanguage/Manual:Hooks/UploadVerifyUpload") * [UserMergeAccountFields](/wiki/Special%3AMyLanguage/Manual%3AHooks/UserMergeAccountFields "Special:MyLanguage/Manual:Hooks/UserMergeAccountFields") * [getUserPermissionsErrors](/wiki/Special%3AMyLanguage/Manual%3AHooks/getUserPermissionsErrors "Special:MyLanguage/Manual:Hooks/getUserPermissionsErrors") | |
| [Hooks provided](/wiki/Special%3AMyLanguage/Template%3AExtension#newhook "Special:MyLanguage/Template:Extension")  * [AbuseFilterAlterVariables](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterAlterVariables "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterAlterVariables") * [AbuseFilter-builder](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-builder "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-builder") * [AbuseFilter-deprecatedVariables](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-deprecatedVariables "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-deprecatedVariables") * [AbuseFilter-computeVariable](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-computeVariable "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-computeVariable") * [AbuseFilter-contentToString](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-contentToString "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-contentToString") * [AbuseFilterCustomActions](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterCustomActions "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterCustomActions") * [AbuseFilter-deprecatedVariables](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-deprecatedVariables "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-deprecatedVariables") * [AbuseFilter-filterAction](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-filterAction "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-filterAction") * [AbuseFilter-generateGenericVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateGenericVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateGenericVars") * [AbuseFilter-generateTitleVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateTitleVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateTitleVars") * [AbuseFilter-generateUserVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateUserVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateUserVars") * [AbuseFilter-generateStaticVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateStaticVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateStaticVars") * [AbuseFilterGenerateVarsForRecentChange](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterGenerateVarsForRecentChange "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterGenerateVarsForRecentChange") * [AbuseFilterGetDangerousActions](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterGetDangerousActions "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterGetDangerousActions") * [AbuseFilter-interceptVariable](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-interceptVariable "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-interceptVariable") * [AbuseFilterShouldFilterAction](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterShouldFilterAction "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterShouldFilterAction") | |
| **Quarterly downloads** | 127 (Ranked 42nd) |
| [**Public wikis using**](https://wikiapiary.com/wiki/Extension%3AAbuseFilter) | 2,939 (Ranked 186th) |
| [Translate the AbuseFilter extension](https://translatewiki.net/wiki/Special%3ATranslate/ext-abusefilter "translatewiki:Special:Translate/ext-abusefilter") if it is available at translatewiki.net | |
|
| **[Issues](/wiki/Special%3AMyLanguage/Phabricator "Special:MyLanguage/Phabricator")** | [Open tasks](https://phabricator.wikimedia.org/tag/abusefilter "phab:tag/abusefilter") · [Report a bug](https://phabricator.wikimedia.org/maniphest/task/create/?projects=AbuseFilter) |

[![](//upload.wikimedia.org/wikipedia/commons/thumb/6/6d/Coolest_Tool_Award_2020_square_logo.svg/120px-Coolest_Tool_Award_2020_square_logo.svg.png)](/wiki/File%3ACoolest_Tool_Award_2020_square_logo.svg)

AbuseFilter

[2020 Coolest Tool
Award Winner](https://meta.wikimedia.org/wiki/Coolest_Tool_Award "m:Coolest Tool Award")

in the category

Quality

The **AbuseFilter** extension allows privileged users to set specific actions to be taken when actions by users, such as edits, match certain criteria.

For example, a filter could be created to prevent unregistered users from adding external links, or to disallow edits that remove more than 2000 characters.

## Installation

* [Download](/wiki/Special%3AExtensionDistributor/AbuseFilter "Special:ExtensionDistributor/AbuseFilter") and move the extracted `AbuseFilter` folder to your `extensions/` directory.
  Developers and code contributors should install the extension [from Git](/wiki/Special%3AMyLanguage/Download_from_Git "Special:MyLanguage/Download from Git") instead, using:`cd extensions/
  git clone https://gerrit.wikimedia.org/r/mediawiki/extensions/AbuseFilter`
* Only when installing from Git, run [Composer](/wiki/Special%3AMyLanguage/Composer "Special:MyLanguage/Composer") to install PHP dependencies, by issuing `composer install --no-dev` in the extension directory. (See [T173141](https://phabricator.wikimedia.org/T173141 "phabricator:T173141") for potential complications.)
* Add the following code at the bottom of your [LocalSettings.php](/wiki/Special%3AMyLanguage/Manual%3ALocalSettings.php "Special:MyLanguage/Manual:LocalSettings.php") file:
  ```
  wfLoadExtension( 'AbuseFilter' );

  ```
* Run the **[update script](/wiki/Special%3AMyLanguage/Manual%3AUpdate.php "Special:MyLanguage/Manual:Update.php")** which will automatically create the necessary database tables that this extension needs.
* [Configure as required.](#Configuration)
* ![Yes](//upload.wikimedia.org/wikipedia/commons/thumb/f/f6/OOjs_UI_icon_check-constructive.svg/15px-OOjs_UI_icon_check-constructive.svg.png) **Done** – Navigate to [Special:Version](/wiki/Special%3AVersion "Special:Version") on your wiki to verify that the extension is successfully installed.

When installing from [Git](/wiki/Special%3AMyLanguage/Gerrit "Special:MyLanguage/Gerrit"), please note that this extension requires [Composer](/wiki/Special%3AMyLanguage/Composer "Special:MyLanguage/Composer").

So, after installation from Git change to the directory containing the extension e.g. "../extensions/AbuseFilter/" and run `composer install --no-dev`, or when updating: `composer update --no-dev`.

Alternatively as well as preferably add the line `"extensions/AbuseFilter/composer.json"` to the "composer.local.json" file in the root directory of your wiki like e.g.

```
{
	"extra": {
		"merge-plugin": {
			"include": [
				"extensions/AbuseFilter/composer.json"
			]
		}
	}
}

```

## Configuration

### User rights

Once you installed the extension, you'll have to set up the user rights in "LocalSettings.php".

User rights for AbuseFilter

| Right | Description | Notes | User groups that have this right by default | Versions |
| --- | --- | --- | --- | --- |
| abusefilter-modify | Create or modify abuse filters | Requires the `abusefilter-view` right | sysop | 1.19+ |
| abusefilter-view | View abuse filters |  | \* | 1.19+ |
| abusefilter-log | View the abuse log |  | \* | 1.19+ |
| abusefilter-log-detail | View detailed abuse log entries | Requires the `abusefilter-log` right | sysop | 1.19+ |
| abusefilter-privatedetails | View private data in the abuse log | Prior to 1.34 this right was named `abusefilter-private` - Requires the `abusefilter-log-detail` right | — | 1.19+ |
| abusefilter-modify-restricted | Modify abuse filters with restricted actions | Requires the `abusefilter-modify` right | sysop | 1.19+ |
| abusefilter-revert | Revert all changes by a given abuse filter |  | sysop | 1.19+ |
| abusefilter-view-private | View abuse filters marked as private | Requires the `abusefilter-view` right (not needed if the group already has the `abusefilter-modify` right) | sysop | 1.19+ |
| abusefilter-hide-log | Hide entries in the abuse log | Requires the `abusefilter-log` right | suppress | 1.19+ |
| abusefilter-hidden-log | View hidden abuse log entries | Requires the `abusefilter-log` right | suppress | 1.19+ |
| abusefilter-log-private | View log entries of abuse filters marked as private | Requires the `abusefilter-log` right (not needed if the group already has the `abusefilter-modify` or `abusefilter-view-private` rights) | sysop | 1.20+ |
| abusefilter-modify-global | Create or modify global abuse filters | Requires the `abusefilter-modify` right | — | 1.21+ |
| abusefilter-privatedetails-log | View the AbuseFilter private details access log | Prior to 1.34 this right was named `abusefilter-private-log` | — | 1.31+ |
| abusefilter-modify-blocked-external-domains | Create or modify what external domains are blocked from being linked |  | sysop | 1.41+ |
| abusefilter-bypass-blocked-external-domains | Bypass blocked external domains | Requires the `edit` right | bot | 1.41+ |
| abusefilter-access-protected-vars | View and create filters that use protected variables |  | sysop | 1.43+ |
| abusefilter-protected-vars-log | View logs related to accessing protected variable values |  | sysop | 1.43+ |

For example, the following sample configuration would allow sysops to do everything they want with AbuseFilter, and everyone to view the log and see public filter settings:

```
$wgGroupPermissions['sysop']['abusefilter-modify'] = true;
$wgGroupPermissions['*']['abusefilter-log-detail'] = true;
$wgGroupPermissions['*']['abusefilter-view'] = true;
$wgGroupPermissions['*']['abusefilter-log'] = true;
$wgGroupPermissions['sysop']['abusefilter-privatedetails'] = true;
$wgGroupPermissions['sysop']['abusefilter-modify-restricted'] = true;
$wgGroupPermissions['sysop']['abusefilter-revert'] = true;
$wgGroupPermissions['sysop']['abusefilter-access-protected-vars'] = true;
$wgGroupPermissions['sysop']['abusefilter-protected-vars-log'] = true;

```

Filters marked as private can only be viewed by users with either the abusefilter-modify or abusefilter-view-private permission.
Protected filters can only be created and viewed by users with the `abusefilter-access-protected-vars` permission. Logs pertaining to these filters can only be viewed by users with the `abusefilter-protected-vars-log` permission. For more information, see [Rules format](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Rules_format#Protected_variables "Special:MyLanguage/Extension:AbuseFilter/Rules format").
### Parameters

| Variable name | Default value | Description |
| --- | --- | --- |
| `$wgAbuseFilterActions` | ``` [     'throttle' => true,     'warn' => true,     'disallow' => true,     'blockautopromote' => true,     'block' => true,     'rangeblock' => false,     'degroup' => false,     'tag' => true ]  ``` | The possible actions that can be taken by abuse filters. When adding a new action, check if it is restricted in `$wgAbuseFilterActionRestrictions` and, if it is, don't forget to add the `abusefilter-modify-restricted` right to the appropriate user groups. |
| `$wgAbuseFilterConditionLimit` | ``` 1000  ``` | The maximum number of 'conditions' that can be used each time the filters are run against a change. (More complex filters require more 'conditions'). |
| `$wgAbuseFilterValidGroups` | ``` [     'default' ]  ``` | The list of "groups" filters can be divided into. By default there is only one group. Other extensions may add other groups. |
| `$wgAbuseFilterEmergencyDisableThreshold` | ``` [     'default' => 0.05 ]  ``` | Disable a filter if it matched more than 2 edits, constituting more than 5 % of the actions which were checked against the filter's group in the "observed" period (at most one day), and the filter has been changed in the last 86400 seconds (one day). See [emergency throttling](#Emergency_throttling). |
| `$wgAbuseFilterEmergencyDisableCount` | ``` [     'default' => 2 ]  ``` |
| `$wgAbuseFilterEmergencyDisableAge` | ``` [     'default' => 86400 ]  ``` |
| `$wgAbuseFilterActionRestrictions` | ``` [ 	"throttle" => false, 	"warn" => false, 	"disallow" => false, 	"blockautopromote" => true, 	"block" => true, 	"rangeblock" => true, 	"degroup" => true, 	"tag" => false ]  ``` | Users must have the "abusefilter-modify-restricted" user right as well as "abusefilter-modify" in order to create or modify filters which carry out these actions. |
| `$wgAbuseFilterNotifications` | ``` false  ``` | Allows to configure the extension to send hit notifications to Special:RecentChanges or UDP. Available options: rc, udp, rcandudp For sending changes to abuse filters to Special:RecentChanges, use `unset($wgLogRestrictions['abusefilter']);`. |
| `$wgAbuseFilterNotificationsPrivate` | ``` false  ``` | Enable notifications for private filters. |
| `$wgAbuseFilterCentralDB` | ``` null  ``` | MW 1.41+ Name of a database where global abuse filters will be stored in. Requires CentralAuth installed otherwise global filters will break on a wikifarm. |
| `$wgAbuseFilterIsCentral` | ``` false  ``` | MW 1.41+ Set this variable to true for the wiki where global AbuseFilters are stored in. Requires CentralAuth installed otherwise global filters will break on a wikifarm. |
| `$wgAbuseFilterLocallyDisabledGlobalActions` | ``` [ 	"throttle" => false, 	"warn" => false, 	"disallow" => false, 	"blockautopromote" => false, 	"block" => false, 	"rangeblock" => false, 	"degroup" => false, 	"tag" => false ]  ``` | Disallow Centralised filters from taking actions set as true in this variable. |
| `$wgAbuseFilterBlockDuration` | ``` 'indefinite'  ``` | Duration of blocks made by AbuseFilter. as of 1.31.0-wmf.25 block durations may be specified for every single filter and will override this variable. This variable is only used when enabling the block in order to preselect a default duration. |
| `$wgAbuseFilterAnonBlockDuration` | ``` null  ``` | Duration of blocks made by AbuseFilter on users who are not logged in. The value of `$wgAbuseFilterBlockDuration` will be used if this is not set. as of 1.31.0-wmf.25 block durations may be specified for every single filter and will override this variable. This variable is only used when enabling the block in order to preselect a default duration. |
| `$wgAbuseFilterBlockAutopromoteDuration` | ``` 5  ``` | Duration, in days, for which users' autopromotion is blocked by filters. |
| `$wgAbuseFilterDefaultWarningMessage` | ``` [     'default' => 'abusefilter-warning' ]  ``` | Default warning messages, per filter group |
| `$wgAbuseFilterDefaultDisallowMessage` | ``` [     'default' => 'abusefilter-disallowed' ]  ``` | Default disallow messages, per filter group |
| `$wgAbuseFilterLogIP` | ``` true  ``` | Whether to include IP in the abuse\_filter\_log |
| `$wgAbuseFilterLogIPMaxAge` | ``` 3 * 30 * 24 * 3600  ``` | Age used as cutoff when purging old IP log data. Defaults to 3 months. Used by maintenance script purgeOldLogIPData.php. |
| `$wgAbuseFilterProfileActionsCap` | ``` 10000  ``` | Number of action that determines when to reset profiling stats. |
| `$wgAbuseFilterLogPrivateDetailsAccess` | ``` false  ``` | Whether accessing private information from a filter log entry is logged. |
| `$wgAbuseFilterPrivateDetailsForceReason` | ``` false  ``` | Whether users are forced to provide a reason for accessing private information from a filter log entry. |
| `$wgAbuseFilterSlowFilterRuntimeLimit` | ``` 500  ``` | Runtime in milliseconds before a filter is considered slow. |
| `$wgAbuseFilterRangeBlockSize` | ``` [     'IPv4' => '16',     'IPv6' => '19', ]  ``` | Size of the range blocked by 'rangeblock' action. |
| `$wgAbuseFilterProtectedVariables` | ``` [ "user_unnamed_ip" ]  ``` | Array of variables that are be considered protected (limited access) and require the `abusefilter-access-protected-vars` right to use/view. |

### Emergency throttling

AbuseFilter comes with a feature that automatically throttles (disables) filters that have been edited recently and match a certain threshold of the latest actions.

This is done to prevent harmful edits on the filters to block every user that performs an action on the wiki or similar.

The condition to disable the filter depend on those variables:

* `$wgAbuseFilterEmergencyDisableThreshold` - Percent of matches over the total amount of actions in the observed period.
* `$wgAbuseFilterEmergencyDisableCount` - Count of matches of the filter in the observed period.
* `$wgAbuseFilterEmergencyDisableAge` - Age of the filter to take it into account. If the last edit of the filter is older than this number of seconds, the filter won't be throttled, unless it's already throttled.

Throttled filters can be identified in the list of filters (Special:AbuseFilter) with the state Enabled, High rate of matches.
Throttling happens silently, and there's no way to see when a filter got throttled, except when [Extension:Echo](/wiki/Special%3AMyLanguage/Extension%3AEcho "Special:MyLanguage/Extension:Echo") is installed, then a notification is sent to the user who was last to modify the filter.

When a filter gets throttled, it doesn't perform any dangerous action (actions usually restricted to special rights like blocking the user, or removing it from groups, controlled by $wgAbuseFilterActionRestrictions), and only "safe" actions are allowed (the ones that can warn or prevent the ongoing action).
Throttled filters don't get enabled automatically. To disable the throttling, you need to edit the filter.
Note that you need to actually change something from the filter: changing something from the filter's notes is sufficient.

Note that editing the filter updates its age, and can cause it to be disabled if it reaches again the conditions to be throttled in a short period since the last edit, leading to a unusable filter if your wiki has more abuse edits than legitimate ones.

## Creating and managing filters

Once the extension has been installed, filters can be created/tested/changed/deleted and the logs can be accessed from the Abuse filter management page [Special:AbuseFilter](/wiki/Special%3AAbuseFilter "Special:AbuseFilter").

* [Rules format](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Rules_format "Special:MyLanguage/Extension:AbuseFilter/Rules format") - The basics of how to write a filter
* [Actions](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Actions "Special:MyLanguage/Extension:AbuseFilter/Actions")
* [Global Rules](/wiki/Extension%3AAbuseFilter/Global "Extension:AbuseFilter/Global")
* [Guide to optimizing condition limit usage](/wiki/Extension%3AAbuseFilter/Conditions "Extension:AbuseFilter/Conditions")
* To import filters from Wikipedia: When you have installed the extension, go to [w:Special:AbuseFilter](https://en.wikipedia.org/wiki/Special%3AAbuseFilter "w:Special:AbuseFilter"), choose a filter (say [w:Special:AbuseFilter/3](https://en.wikipedia.org/wiki/Special%3AAbuseFilter/3 "w:Special:AbuseFilter/3")), then click "Export this filter to another wiki", copy the text, go to "Special:AbuseFilter/import" on your wiki, paste the text.
* [m:Small wiki toolkits/Starter kit/AbuseFilter](https://meta.wikimedia.org/wiki/Special%3AMyLanguage/Small_wiki_toolkits/Starter_kit/AbuseFilter "m:Special:MyLanguage/Small wiki toolkits/Starter kit/AbuseFilter") - A guide for small wiki communities on metawiki

## API

AbuseFilter adds two API list modules, one for details of abuse filters ("abusefilters") and one for the abuse log, since it is separate from other MediaWiki logs ("abuselog"). It is not possible to create or modify abuse filters using the API.

### list = abusefilters

List information about filters

Parameters

* `abfstartid` - The filter id to start enumerating from
* `abfendid` - The filter id to stop enumerating at
* `abfdir` - The direction in which to enumerate (older, newer)
* `abfshow` - Show only filters which meet these criteria (enabled|!enabled|deleted|!deleted|private|!private|protected|!protected)
* `abflimit` - The maximum number of filters to list
* `abfprop` - Which properties to get (id|description|pattern|actions|hits|comments|lasteditor|lastedittime|status|private)

When filters are private, some of the properties specified with `abfprop` will be missing unless you have the appropriate user rights.

Examples

List non-private abuse filters**[api.php?action=query&list=abusefilters&abfshow=!private&abfprop=id|hits](https://en.wikipedia.org/w/api.php?action=query&list=abusefilters&abfshow=!private&abfprop=id%7Chits)** [[try in ApiSandbox]](https://en.wikipedia.org/wiki/Special%3AApiSandbox#action=query&list=abusefilters&abfshow=!private&abfprop=id%7Chits)

| Result |
| --- |
| ``` {     "batchcomplete": "",     "continue": {         "abfstartid": 18,         "continue": "-||"     },     "query": {         "abusefilters": [             {                 "id": 1,                 "hits": 41430             },             {                 "id": 3,                 "hits": 957485             },             {                 "id": 5,                 "hits": 5931             },             {                 "id": 6,                 "hits": 19             },             {                 "id": 8,                 "hits": 7             },             {                 "id": 9,                 "hits": 41354             },             {                 "id": 11,                 "hits": 132971             },             {                 "id": 12,                 "hits": 139693             },             {                 "id": 14,                 "hits": 63             },             {                 "id": 15,                 "hits": 15             }         ]     } }  ``` |

### list = abuselog

List instances where actions triggered an abuse filter.

Parameters

* `aflstart` - The timestamp to start enumerating from
* `aflend` - The timestamp to stop enumerating at
* `afldir` - The direction in which to enumerate (older, newer)
* `afluser` - Show only entries where the action was attempted by a given user or IP address.
* `afltitle` - Show only entries where the action involved a given page.
* `aflfilter` - Show only entries that triggered a given filter ID
* `afllimit` - The maximum number of entries to list
* `aflprop` - Which properties to get: (ids|filter|user|ip|title|action|details|result|timestamp|hidden|revid|wiki)

Example

List instances where the abuse filter was triggered in response to actions from the user "SineBot"**[api.php?action=query&list=abuselog&afluser=SineBot&aflprop=ids](https://en.wikipedia.org/w/api.php?action=query&list=abuselog&afluser=SineBot&aflprop=ids)** [[try in ApiSandbox]](https://en.wikipedia.org/wiki/Special%3AApiSandbox#action=query&list=abuselog&afluser=SineBot&aflprop=ids)

| Result |
| --- |
| ``` {     "batchcomplete": "",     "continue": {         "aflstart": "2018-03-06T02:34:18Z",         "continue": "-||"     },     "query": {         "abuselog": [             {                 "id": 27219261,                 "filter_id": "1073"             },             {                 "id": 26938051,                 "filter_id": ""             },             {                 "id": 23388942,                 "filter_id": "1"             },             {                 "id": 22044912,                 "filter_id": ""             },             {                 "id": 22032235,                 "filter_id": ""             },             {                 "id": 22032196,                 "filter_id": ""             },             {                 "id": 21983882,                 "filter_id": ""             },             {                 "id": 20594818,                 "filter_id": "904"             },             {                 "id": 20593489,                 "filter_id": "904"             },             {                 "id": 20590442,                 "filter_id": "904"             }         ]     } }  ``` |

## Possible errors

* Some users might experience that creating new filters or modifying old filters fail and the user just gets redirected to the original page. If the Wiki is using SSL certificates, this error could possibly be because of the `[$wgServer](/wiki/Special%3AMyLanguage/Manual%3A%24wgServer "Special:MyLanguage/Manual:$wgServer")` value, which might be using "http://" instead of "https://". An indication of this error will be, the browser giving https warning for [Special:AbuseFilter](/wiki/Special%3AAbuseFilter "Special:AbuseFilter") pages. ([Topic:T23dyyih0ofjada5](/wiki/Topic%3AT23dyyih0ofjada5 "Topic:T23dyyih0ofjada5"))

## Integration with other extensions

You can integrate AbuseFilter with other extension in various ways.

### Adding variables for filtering

It is possible to add new variables, to be used in abuse filters. A list of examples [is available](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Rules_format#Variables_from_AbuseFilter "Special:MyLanguage/Extension:AbuseFilter/Rules format"). To do that, you should:

* Add a handler for the [AbuseFilter-builder](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-builder "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-builder") hook. To add a variable, you should use `$builder['vars']['variable_name'] = 'i18n-key';`, where `variable_name` is the name of the variable, and `i18n-key` is the fragment of an i18n key. The full key will be `abusefilter-edit-builder-vars-{$your_key}`.
* Add the i18n messages you chose at the previous point.
* Choose a hook handler where the variable will be computed. Depending on your use case, you could:
  + Implement the [AbuseFilter-generateTitleVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateTitleVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateTitleVars") hook; this is specifically thought for page-related variables;
  + Implement the [AbuseFilter-generateUserVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateUserVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateUserVars") hook; this is specifically thought for user-related variables;
  + Implement the [AbuseFilter-generateGenericVars](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-generateGenericVars "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-generateGenericVars") hook; this is for variables not bound to a specific page or user;
  + Implement the [AbuseFilterAlterVariables](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilterAlterVariables "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilterAlterVariables") hook; this is a bit more flexible than the other hooks, but it has a downside: your variable will not be available when examining past RecentChanges entries. If you want to implement that feature (and it's recommended to do so), you should use one of the hooks listed above, and use its third parameter (`$RCRow`).
* Inside the hook handler, there are two ways to add a variable:
  + The "direct" way is calling `$vars->setVar( 'var_name', var_value );`. This is ideal only when the value is easy and quick to compute: the value is computed even if no active filter will use it.
  + The "lazy" way is calling `$vars->setLazyLoadVar( 'var_name', 'method_name', $params );`. Here, 'method\_name' is a (unique) identifier that will be used to compute the variable (it's recommended to prefix it with the name of your extension). To register the method, you should add a handler for the [AbuseFilter-computeVariable](/wiki/Special%3AMyLanguage/Extension%3AAbuseFilter/Hooks/AbuseFilter-computeVariable "Special:MyLanguage/Extension:AbuseFilter/Hooks/AbuseFilter-computeVariable") hook; therein, you should check if the $method passed matches your 'method\_name', and if so, compute the variable. Lastly, $params is an array of parameters that you'll need to compute the variable; these are passed to the computeVariable hook handler. For an example of this, you can check out CentralAuth's `global_user_groups`.

### Adding custom actions

You can add custom action handlers, so that each filter may perform further actions.
To do that, you choose a name for the action ('my-action' from now on), and then:

* Create a class named e.g. MyAction, that should extend \MediaWiki\Extension\AbuseFilter\Consequence, which can also implement HookAborterConsequence or ConsequencesDisablerConsequence
* Add a subscriber to the AbuseFilterCustomActions hook; the subscriber should provide a callback as documented in the hook documentation, that returns an instance of the class created above, for instance:

```
class MyAction extends \MediaWiki\Extension\AbuseFilter\Consequence {
    public function run() {
        throw new \Exception( 'Write me' );
    }
}

```

```
public function onAbuseFilterCustomActions( &$actions ) {
    $actions[] = function ( \MediaWiki\Extension\AbuseFilter\Consequence\Parameters $params, array $rawParams ) : MyConsequence {
        return new MyAction( $params, $rawParams );
    };
}

```

Then you should add the following i18n messages; you can replace 'my\_action' with e.g. 'block' to see what the messages are for:

* `'abusefilter-edit-action-${my_action}'`
* `'abusefilter-action-${my_action}'`

### Adding rule groups

You can also add extra rule groups, which can be used to group existing abuse filters.
Note that, at the moment, each filter can only be in a single group ([T116642](https://phabricator.wikimedia.org/T116642 "phab:T116642")).
Currently, the only known consumer of this feature is [Extension:StructuredDiscussions](/wiki/Special%3AMyLanguage/Extension%3AStructuredDiscussions "Special:MyLanguage/Extension:StructuredDiscussions").
To do that, you should:

* Append the name of the group to `$wgAbuseFilterValidGroups`.
* Add some code to run the filters with your group. Note that AbuseFilter won't do that on its own. To do that, you should construct an `AbuseFilterRunner` object, passing in the name of your group.

## See also

* [Help:BlockedExternalDomains](/wiki/Special%3AMyLanguage/Help%3ABlockedExternalDomains "Special:MyLanguage/Help:BlockedExternalDomains")
* [Several WMF wikis where it's enabled](https://meta.wikimedia.org/wiki/Special%3AMyLanguage/AbuseFilter "m:Special:MyLanguage/AbuseFilter") (and with which configuration)

|  | This extension is being used on one or more [Wikimedia projects](https://meta.wikimedia.org/wiki/Special%3AMyLanguage/Wikimedia_projects "m:Special:MyLanguage/Wikimedia projects"). This probably means that the extension is stable and works well enough to be used by such high-traffic websites. Look for this extension's name in Wikimedia's [CommonSettings.php](https://noc.wikimedia.org/conf/highlight.php?file=CommonSettings.php) and [InitialiseSettings.php](https://noc.wikimedia.org/conf/highlight.php?file=InitialiseSettings.php) configuration files to see where it's installed. A full list of the extensions installed on a particular wiki can be seen on the wiki's [Special:Version](/wiki/Special%3AVersion "Special:Version") page. |
| --- | --- |

|  | This extension is included in the following wiki farms/hosts and/or packages:   * [Canasta](/wiki/Special%3AMyLanguage/Canasta "Special:MyLanguage/Canasta") * [Debian](/wiki/Special%3AMyLanguage/Debian_packages "Special:MyLanguage/Debian packages") * [Fandom](/wiki/Special%3AMyLanguage/Fandom "Special:MyLanguage/Fandom") * [Miraheze](/wiki/Special%3AMyLanguage/Miraheze "Special:MyLanguage/Miraheze") * [MyWikis](https://www.mywikis.com/) * [ProWiki](https://www.pro.wiki/) * [ShoutWiki](/wiki/Special%3AMyLanguage/ShoutWiki "Special:MyLanguage/ShoutWiki") * [Telepedia](https://telepedia.net/) * [wiki.gg](/wiki/Special%3AMyLanguage/wiki.gg "Special:MyLanguage/wiki.gg") * [WikiForge](https://wikiforge.net/)  This is not an authoritative list. Some wiki farms/hosts and/or packages may contain this extension even if they are not listed here. Always check with your wiki farms/hosts or bundle to confirm. |
| --- | --- |

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://www.mediawiki.org/w/index.php?title=Extension:AbuseFilter&oldid=6884904>"
[Categories](/wiki/Special%3ACategories "Special:Categories"):

* [Extensions bundled with MediaWiki 1.38](/wiki/Category%3AExtensions_bundled_with_MediaWiki_1.38 "Category:Extensions bundled with MediaWiki 1.38")
* [Stable extensions](/wiki/Category%3AStable_extensions "Category:Stable extensions")
* [User activity extensions](/wiki/Category%3AUser_activity_extensions "Category:User activity extensions")
* [Special page extensions](/wiki/Category%3ASpecial_page_extensions "Category:Special page extensions")
* [API extensions](/wiki/Category%3AAPI_extensions "Category:API extensions")
* [Extensions supporting Composer](/wiki/Category%3AExtensions_supporting_Composer "Category:Extensions supporting Composer")
* [GPL licensed extensions](/wiki/Category%3AGPL_licensed_extensions "Category:GPL licensed extensions")
* [Extensions in Wikimedia version control](/wiki/Category%3AExtensions_in_Wikimedia_version_control "Category:Extensions in Wikimedia version control")
* [BeforeCreateEchoEvent extensions](/wiki/Category%3ABeforeCreateEchoEvent_extensions "Category:BeforeCreateEchoEvent extensions")
* [ChangeTagsListActive extensions](/wiki/Category%3AChangeTagsListActive_extensions "Category:ChangeTagsListActive extensions")
* [CheckUserInsertChangesRow extensions](/wiki/Category%3ACheckUserInsertChangesRow_extensions "Category:CheckUserInsertChangesRow extensions")
* [CheckUserInsertLogEventRow extensions](/wiki/Category%3ACheckUserInsertLogEventRow_extensions "Category:CheckUserInsertLogEventRow extensions")
* [CheckUserInsertPrivateEventRow extensions](/wiki/Category%3ACheckUserInsertPrivateEventRow_extensions "Category:CheckUserInsertPrivateEventRow extensions")
* [ContributionsToolLinks extensions](/wiki/Category%3AContributionsToolLinks_extensions "Category:ContributionsToolLinks extensions")
* [EditFilterMergedContent extensions](/wiki/Category%3AEditFilterMergedContent_extensions "Category:EditFilterMergedContent extensions")
* [GetAutoPromoteGroups extensions](/wiki/Category%3AGetAutoPromoteGroups_extensions "Category:GetAutoPromoteGroups extensions")
* [GetPreferences extensions](/wiki/Category%3AGetPreferences_extensions "Category:GetPreferences extensions")
* [HistoryPageToolLinks extensions](/wiki/Category%3AHistoryPageToolLinks_extensions "Category:HistoryPageToolLinks extensions")
* [JsonValidateSave extensions](/wiki/Category%3AJsonValidateSave_extensions "Category:JsonValidateSave extensions")
* [ListDefinedTags extensions](/wiki/Category%3AListDefinedTags_extensions "Category:ListDefinedTags extensions")
* [LoadExtensionSchemaUpdates extensions](/wiki/Category%3ALoadExtensionSchemaUpdates_extensions "Category:LoadExtensionSchemaUpdates extensions")
* [PageDelete extensions](/wiki/Category%3APageDelete_extensions "Category:PageDelete extensions")
* [PageSaveComplete extensions](/wiki/Category%3APageSaveComplete_extensions "Category:PageSaveComplete extensions")
* [ParserOutputStashForEdit extensions](/wiki/Category%3AParserOutputStashForEdit_extensions "Category:ParserOutputStashForEdit extensions")
* [RecentChange save extensions](/wiki/Category%3ARecentChange_save_extensions "Category:RecentChange save extensions")
* [SaveUserOptions extensions](/wiki/Category%3ASaveUserOptions_extensions "Category:SaveUserOptions extensions")
* [TitleMove extensions](/wiki/Category%3ATitleMove_extensions "Category:TitleMove extensions")
* [UndeletePageToolLinks extensions](/wiki/Category%3AUndeletePageToolLinks_extensions "Category:UndeletePageToolLinks extensions")
* [UploadStashFile extensions](/wiki/Category%3AUploadStashFile_extensions "Category:UploadStashFile extensions")
* [UploadVerifyUpload extensions](/wiki/Category%3AUploadVerifyUpload_extensions "Category:UploadVerifyUpload extensions")
* [UserMergeAccountFields extensions](/wiki/Category%3AUserMergeAccountFields_extensions "Category:UserMergeAccountFields extensions")
* [GetUserPermissionsErrors extensions](/wiki/Category%3AGetUserPermissionsErrors_extensions "Category:GetUserPermissionsErrors extensions")
* [All extensions](/wiki/Category%3AAll_extensions "Category:All extensions")
* [Extensions requiring Composer with git](/wiki/Category%3AExtensions_requiring_Composer_with_git "Category:Extensions requiring Composer with git")
* [Extensions used on Wikimedia](/wiki/Category%3AExtensions_used_on_Wikimedia "Category:Extensions used on Wikimedia")
* [Extensions included in Canasta](/wiki/Category%3AExtensions_included_in_Canasta "Category:Extensions included in Canasta")
* [Extensions available as Debian packages](/wiki/Category%3AExtensions_available_as_Debian_packages "Category:Extensions available as Debian packages")
* [Extensions included in Fandom](/wiki/Category%3AExtensions_included_in_Fandom "Category:Extensions included in Fandom")
* [Extensions included in Miraheze](/wiki/Category%3AExtensions_included_in_Miraheze "Category:Extensions included in Miraheze")
* [Extensions included in MyWikis](/wiki/Category%3AExtensions_included_in_MyWikis "Category:Extensions included in MyWikis")
* [Extensions included in ProWiki](/wiki/Category%3AExtensions_included_in_ProWiki "Category:Extensions included in ProWiki")
* [Extensions included in ShoutWiki](/wiki/Category%3AExtensions_included_in_ShoutWiki "Category:Extensions included in ShoutWiki")
* [Extensions included in Telepedia](/wiki/Category%3AExtensions_included_in_Telepedia "Category:Extensions included in Telepedia")
* [Extensions included in wiki.gg](/wiki/Category%3AExtensions_included_in_wiki.gg "Category:Extensions included in wiki.gg")
* [Extensions included in WikiForge](/wiki/Category%3AExtensions_included_in_WikiForge "Category:Extensions included in WikiForge")
* [Spam management extensions](/wiki/Category%3ASpam_management_extensions "Category:Spam management extensions")
Hidden category:

* [Extensions with release branches compatibility policy](/wiki/Category%3AExtensions_with_release_branches_compatibility_policy "Category:Extensions with release branches compatibility policy")

* This page was last edited on 3 December 2024, at 11:42.
* Text is available under the [Creative Commons Attribution-ShareAlike License](https://creativecommons.org/licenses/by-sa/4.0/); additional terms may apply. Text in [the Help: namespace](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents) is available under the [Creative Commons CC0 License](https://creativecommons.org/publicdomain/zero/1.0/).
  By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use) and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy).

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About mediawiki.org](/wiki/Project%3AAbout)
* [Disclaimers](/wiki/Project%3AGeneral_disclaimer)
* [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/www.mediawiki.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//m.mediawiki.org/w/index.php?title=Extension:AbuseFilter&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)

Search

Search

Toggle the table of contents

Extension:AbuseFilter

Add topic


