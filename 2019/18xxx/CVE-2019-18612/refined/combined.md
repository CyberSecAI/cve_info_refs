=== Content from phabricator.wikimedia.org_339dce01_20250120_232504.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT104807)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T104807
# Older hidden versions of a currently-public AbuseFilter are exposed via diffs (CVE-2019-18612)Closed, Resolved[Public](/policy/explain/PHID-TASK-hicnr22cu7maaln7bufo/view/)Actions

* [Edit Task](/maniphest/task/edit/104807/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/104807/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-hicnr22cu7maaln7bufo/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-hicnr22cu7maaln7bufo/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Protect as security issue](/wmf/escalate-task/104807/)
* [Award Token](/token/give/PHID-TASK-hicnr22cu7maaln7bufo/)
* [Flag For Later](/flag/edit/PHID-TASK-hicnr22cu7maaln7bufo/)

Assigned To

|  | [Daimona](/p/Daimona/) |
| --- | --- |

Authored By

|  | [Luke081515](/p/Luke081515/) |
| --- | --- |
| Jul 5 2015, 3:55 PM2015-07-05 15:55:38 (UTC+0) |

Tags

* [AbuseFilter](/tag/abusefilter/) [(Backlog)](/project/board/217/)
* [Security-Extensions](/tag/security-extensions/)
* [Vuln-Infoleak](/tag/vuln-infoleak/)
* [MW-1.35-notes (1.35.0-wmf.4; 2019-10-29)](/project/view/4331/)
* [Security](/tag/security/)
Referenced Files

|  | [F30872887: T104807.patch](/F30872887) |
| --- | --- |
| Oct 21 2019, 1:41 PM2019-10-21 13:41:58 (UTC+0) |

|  | [F30864315: T104807.patch](/F30864315) |
| --- | --- |
| Oct 19 2019, 6:07 PM2019-10-19 18:07:45 (UTC+0) |

|  | [F30864146: T104807.patch](/F30864146) |
| --- | --- |
| Oct 19 2019, 5:25 PM2019-10-19 17:25:14 (UTC+0) |

|  | [F27938263: T104807.patch](/F27938263) |
| --- | --- |
| Jan 18 2019, 12:27 PM2019-01-18 12:27:59 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Ayokura](/p/Ayokura/) |
| --- | --- |

|  | [Daimona](/p/Daimona/) |
| --- | --- |

|  | [hoo](/p/hoo/) |
| --- | --- |

|  | [Krenair](/p/Krenair/) |
| --- | --- |

|  | [Luke081515](/p/Luke081515/) |
| --- | --- |

|  | [matej\_suchanek](/p/matej_suchanek/) |
| --- | --- |

[View All 11 Subscribers](/subscriptions/list/PHID-TASK-hicnr22cu7maaln7bufo/)
# Description

There is a problem with hidden abusefilters, for example: this filter is actually not hidden: [https://de.wikipedia.org/wiki/Spezial:Missbrauchsfilter/3](https://de.wikipedia.org/wiki/Spezial%3AMissbrauchsfilter/3), but older versions are hidden, for example, the last hidden version: [https://de.wikipedia.org/wiki/Spezial:Missbrauchsfilter/history/3/item/40](https://de.wikipedia.org/wiki/Spezial%3AMissbrauchsfilter/history/3/item/40), without sysop rights not visible. The version after this is not hidden, so visible for all users: [https://de.wikipedia.org/wiki/Spezial:Missbrauchsfilter/history/3/item/42](https://de.wikipedia.org/wiki/Spezial%3AMissbrauchsfilter/history/3/item/42). The problem now is, that the difference is visible for all users: [https://de.wikipedia.org/wiki/Spezial:Missbrauchsfilter/history/3/diff/prev/42](https://de.wikipedia.org/wiki/Spezial%3AMissbrauchsfilter/history/3/diff/prev/42), and also the difference beetween hidden versions: [https://de.wikipedia.org/wiki/Spezial:Missbrauchsfilter/history/3/diff/prev/40](https://de.wikipedia.org/wiki/Spezial%3AMissbrauchsfilter/history/3/diff/prev/40), so non sysops can construct the hidden version, thats the problem.

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Check visibility for each version in ViewDiff](https://gerrit.wikimedia.org/r/c/546753) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_32](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_32) | +37 -13 |
|  | [SECURITY: Check visibility for each version in ViewDiff](https://gerrit.wikimedia.org/r/c/546752) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_31](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_31) | +39 -15 |
|  | [SECURITY: Check visibility for each version in ViewDiff](https://gerrit.wikimedia.org/r/c/546754) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_33](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_33) | +37 -13 |
|  | [SECURITY: Check visibility for each version in ViewDiff](https://gerrit.wikimedia.org/r/c/546726) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [REL1\_34](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/REL1_34) | +37 -13 |
|  | [SECURITY: Check visibility for each version in ViewDiff](https://gerrit.wikimedia.org/r/c/546723) | [mediawiki/extensions/AbuseFilter](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/AbuseFilter/%2B/master) | +37 -13 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T104807)
# Related Objects

* Mentions

Mentioned In [T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983) Mentioned Here [T226945: Decide on future of running Phan tests on release branches](/T226945)
[T231966: Phan job should use composer instead of vendor for release branches ( undeclared class \Wikimedia\Equivset\Equivset )](/T231966)
[T233759: Update mediawiki/mediawiki-codesniffer for php7.3 support in release branches](/T233759)
[T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983)
### Event Timeline

[Maniphest](/maniphest/) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-kr7yqy4lz7kv3bn/)".[Jul 5 2015, 3:55 PM2015-07-05 15:55:38 (UTC+0)](#1427449)[Maniphest](/maniphest/) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-52t6nhqdukr6xdl/)".Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/806796/)[Jul 5 2015, 3:55 PM2015-07-05 15:55:38 (UTC+0)](#1427451)[Luke081515](/p/Luke081515/) created this task.[Jul 5 2015, 3:55 PM2015-07-05 15:55:38 (UTC+0)](#1427452)[Luke081515](/p/Luke081515/) triaged this task as High priority.[Luke081515](/p/Luke081515/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-l67v6j24fswcfia/)[Luke081515](/p/Luke081515/) added projects: [AbuseFilter](/tag/abusefilter/), [WMF-NDA](/tag/wmf-nda/).[Luke081515](/p/Luke081515/) changed Security from None to Other confidential issue.[Luke081515](/p/Luke081515/) edited subscribers, added: [Luke081515](/p/Luke081515/); removed: [Aklapper](/p/Aklapper/).[Krenair](/p/Krenair/) changed Security from Other confidential issue to Software security bug.[Jul 5 2015, 3:57 PM2015-07-05 15:57:16 (UTC+0)](#1427460)Restricted Application added a project: [acl\*security](/tag/acl_security/).  · [View Herald Transcript](/herald/transcript/806800/)[Jul 5 2015, 3:57 PM2015-07-05 15:57:16 (UTC+0)](#1427461)[Krenair](/p/Krenair/) removed a project: [WMF-NDA](/tag/wmf-nda/).[Jul 5 2015, 3:57 PM2015-07-05 15:57:41 (UTC+0)](#1427464)[Krenair](/p/Krenair/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-jtapdcgerrpxbrj/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-jtapdcgerrpxbrj/)".[Krenair](/p/Krenair/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-4y7u6o4tt6nsqvh/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-4y7u6o4tt6nsqvh/)".[Krenair](/p/Krenair/) renamed this task from Problem with hidden AbuseFilters, not completly hidden, difference is visible to Older hidden versions of a currently-public AbuseFilter are exposed via diffs.[Jul 5 2015, 7:44 PM2015-07-05 19:44:08 (UTC+0)](#1427893)[Krenair](/p/Krenair/) added projects: [Security-Extensions](/tag/security-extensions/), [Vuln-Infoleak](/tag/vuln-infoleak/).[Krenair](/p/Krenair/) subscribed.[hoo](/p/hoo/) subscribed.[Jul 5 2015, 8:32 PM2015-07-05 20:32:40 (UTC+0)](#1428043)[Krenair](/p/Krenair/) merged a task: Restricted Task.[Feb 23 2016, 3:24 AM2016-02-23 03:24:14 (UTC+0)](#2054018)[Krenair](/p/Krenair/) added subscribers: [Se4598](/p/Se4598/), [Ayokura](/p/Ayokura/), [Aklapper](/p/Aklapper/).[Krenair](/p/Krenair/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-dljz26vf2bokgk5/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-dljz26vf2bokgk5/)".[Feb 24 2016, 11:13 AM2016-02-24 11:13:54 (UTC+0)](#2059177)[Krenair](/p/Krenair/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-to6nncww4zdiyja/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-to6nncww4zdiyja/)".

[Daimona](/p/Daimona/) claimed this task.[Jan 18 2019, 12:27 PM2019-01-18 12:27:59 (UTC+0)](#4892041)[Daimona](/p/Daimona/) subscribed.Comment Actions

T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/oprr23usrptnnjjszigh/PHID-FILE-p6te64aw2uwzklglwino/T104807.patch)

To fix this (fairly simple) and avoid showing diff links.

[Urbanecm](/p/Urbanecm/) moved this task from [Backlog / Other](/project/board/30/) to [Patch pending review](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[Oct 19 2019, 4:52 PM2019-10-19 16:52:53 (UTC+0)](#5588684)[Urbanecm](/p/Urbanecm/) added a subscriber: [matej\_suchanek](/p/matej_suchanek/).[Urbanecm](/p/Urbanecm/) subscribed.[Oct 19 2019, 5:20 PM2019-10-19 17:20:07 (UTC+0)](#5588697)

[Urbanecm](/p/Urbanecm/) added a comment.[Oct 19 2019, 5:25 PM2019-10-19 17:25:14 (UTC+0)](#5588698)Comment Actions

T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/essc6rxazjsmf2nfetrk/PHID-FILE-ivzew35uzqim4erebgzv/T104807.patch)

Fixed conflict with newer version of code, confirmed it works locally.

[Daimona](/p/Daimona/) added a comment.[Oct 19 2019, 6:07 PM2019-10-19 18:07:45 (UTC+0)](#5588700)Comment Actions
> In [T104807#5588698](/T104807#5588698), [@Urbanecm](/p/Urbanecm/) wrote:
>
> T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/essc6rxazjsmf2nfetrk/PHID-FILE-ivzew35uzqim4erebgzv/T104807.patch)
>
> Fixed conflict with newer version of code, confirmed it works locally.

A piece was missed there, which I restored in the patch below. Plus: use canViewPrivate everywhere, order by afh\_id in a query, and add a @todo about caching for when the code will be public.

T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/ttz6dj5ddwy7b3euh5ba/PHID-FILE-ibxtdtlebbccpor2z5ti/T104807.patch)

[Urbanecm](/p/Urbanecm/) added a comment.[Oct 19 2019, 9:24 PM2019-10-19 21:24:37 (UTC+0)](#5588863)Comment Actions

Thank you Daimona. Actions are always public, so it is not necessary to hide them, I think.

[Daimona](/p/Daimona/) added a comment.[Oct 20 2019, 9:35 AM2019-10-20 09:35:18 (UTC+0)](#5589237)Comment Actions
> In [T104807#5588863](/T104807#5588863), [@Urbanecm](/p/Urbanecm/) wrote:
>
> Thank you Daimona. Actions are always public, so it is not necessary to hide them, I think.

I wouldn't be too sure about that (e.g. throttle params are a bit sensitive), but I agree that it's probably fine not to hide them. Anyway, we can think about it once the code is public.

[Daimona](/p/Daimona/) added a comment.[Oct 21 2019, 1:41 PM2019-10-21 13:41:58 (UTC+0)](#5591681)Comment Actions

T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/mhycfulnxx7sw7djh7zx/PHID-FILE-sian57xxqf7xpeirbbkw/T104807.patch)

[Daimona](/p/Daimona/) added a comment.[Oct 21 2019, 1:49 PM2019-10-21 13:49:38 (UTC+0)](#5591704)Comment Actions

Note: when viewing the diff right before the hidden version, you'll still see a "newer change" button at the bottom; clicking it will just tell you that you cannot see the revision. I guess we can make it disappear in a follow-up.

[Daimona](/p/Daimona/) added subscribers: [sbassett](/p/sbassett/), [Reedy](/p/Reedy/).[Oct 21 2019, 1:54 PM2019-10-21 13:54:07 (UTC+0)](#5591714)Comment Actions

[@sbassett](/p/sbassett/), [@Reedy](/p/Reedy/) Waiting for your green light before pushing publicly :)

[Urbanecm](/p/Urbanecm/) moved this task from [Patch pending review](/project/board/30/) to [Pending deployment / release](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[Oct 21 2019, 9:33 PM2019-10-21 21:33:39 (UTC+0)](#5593174)Comment Actions
> In [T104807#5591681](/T104807#5591681), [@Daimona](/p/Daimona/) wrote:
>
> T104807.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/mhycfulnxx7sw7djh7zx/PHID-FILE-sian57xxqf7xpeirbbkw/T104807.patch)

Deployed earlier today as-of this patch.

[sbassett](/p/sbassett/) mentioned this in [T234983: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.6/1.32.6/1.33.2)](/T234983).[Oct 21 2019, 10:00 PM2019-10-21 22:00:50 (UTC+0)](#5593253)Comment Actions
> In [T104807#5593174](/T104807#5593174), [@Urbanecm](/p/Urbanecm/) wrote:
>
> Deployed earlier today as-of this patch.

Thanks.

> In [T104807#5591714](/T104807#5591714), [@Daimona](/p/Daimona/) wrote:
>
> [@sbassett](/p/sbassett/), [@Reedy](/p/Reedy/) Waiting for your green light before pushing publicly :)

[@Daimona](/p/Daimona/) [@Urbanecm](/p/Urbanecm/) - can we give this at least a couple of days in production to assess functionality and stability? Then we can do the backports through gerrit. Also tracking in [T234983](/T234983) and will plan to request a CVE soon, though that shouldn't hold up the backports.

[Urbanecm](/p/Urbanecm/) added a comment.[Oct 22 2019, 5:49 AM2019-10-22 05:49:17 (UTC+0)](#5593735)Comment Actions
> In [T104807#5593253](/T104807#5593253), [@sbassett](/p/sbassett/) wrote:
> > In [T104807#5593174](/T104807#5593174), [@Urbanecm](/p/Urbanecm/) wrote:
> >
> > Deployed earlier today as-of this patch.
>
> Thanks.
>
> > In [T104807#5591714](/T104807#5591714), [@Daimona](/p/Daimona/) wrote:
> >
> > [@sbassett](/p/sbassett/), [@Reedy](/p/Reedy/) Waiting for your green light before pushing publicly :)
>
> [@Daimona](/p/Daimona/) [@Urbanecm](/p/Urbanecm/) - can we give this at least a couple of days in production to assess functionality and stability? Then we can do the backports through gerrit. Also tracking in [T234983](/T234983) and will plan to request a CVE soon, though that shouldn't hold up the backports.

Sure!

[Daimona](/p/Daimona/) added a comment.[Oct 22 2019, 7:58 AM2019-10-22 07:58:54 (UTC+0)](#5593937)Comment Actions
> In [T104807#5593253](/T104807#5593253), [@sbassett](/p/sbassett/) wrote:
>
> [@Daimona](/p/Daimona/) [@Urbanecm](/p/Urbanecm/) - can we give this at least a couple of days in production to assess functionality and stability? Then we can do the backports through gerrit. Also tracking in [T234983](/T234983) and will plan to request a CVE soon, though that shouldn't hold up the backports.

Sure, thanks. Can we also make this task public once the backports are on gerrit?

[Urbanecm](/p/Urbanecm/) added a comment.[Oct 22 2019, 3:54 PM2019-10-22 15:54:58 (UTC+0)](#5595805)Comment Actions

i guess so, given no sensitive things are here.

[sbassett](/p/sbassett/) added a comment.[Oct 22 2019, 6:37 PM2019-10-22 18:37:37 (UTC+0)](#5596324)Comment Actions
> In [T104807#5593937](/T104807#5593937), [@Daimona](/p/Daimona/) wrote:
>
> Sure, thanks. Can we also make this task public once the backports are on gerrit?

> In [T104807#5595805](/T104807#5595805), [@Urbanecm](/p/Urbanecm/) wrote:
>
> i guess so, given no sensitive things are here.

I'm not seeing anything on the task that would prevent it from being made public. And given that it's for a non-bundled extension, we don't have to hold the task for a mediawiki security release or anything like that. The new announcements I've been trying to do (e.g. [T234983](/T234983)) are designed to occur after backports and any other public disclosure (CVE, etc.)

[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-s4p7gvhgfa2tbh3/)" to "Public (No Login Required)".[Oct 28 2019, 8:33 PM2019-10-28 20:33:13 (UTC+0)](#5613249)[sbassett](/p/sbassett/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-vqz5bbny5jcq72k/)" to "All Users".[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 8:33 PM2019-10-28 20:33:36 (UTC+0)](#5613251)Comment Actions

Change 546723 had a related patch set uploaded (by SBassett; owner: Daimona Eaytoy):

[mediawiki/extensions/AbuseFilter@master] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546723>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Oct 28 2019, 8:33 PM2019-10-28 20:33:37 (UTC+0)](#5613252)Comment Actions

Change 546726 had a related patch set uploaded (by SBassett; owner: Daimona Eaytoy):

[mediawiki/extensions/AbuseFilter@REL1\_34] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546726>

[sbassett](/p/sbassett/) added a comment.[Oct 28 2019, 8:49 PM2019-10-28 20:49:19 (UTC+0)](#5613316)Comment Actions

Ugh, security backports conflicting with <https://gerrit.wikimedia.org/r/480069>.

[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 9:31 PM2019-10-28 21:31:32 (UTC+0)](#5613501)Comment Actions

Change 546723 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@master] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546723>

[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 9:41 PM2019-10-28 21:41:57 (UTC+0)](#5613522)Comment Actions

Change 546726 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_34] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546726>

[sbassett](/p/sbassett/) lowered the priority of this task from High to Medium.[Oct 28 2019, 9:50 PM2019-10-28 21:50:56 (UTC+0)](#5613560)[sbassett](/p/sbassett/) added a comment.Edited · [Oct 28 2019, 9:57 PM2019-10-28 21:57:01 (UTC+0)](#5613576)Comment Actions

Backports for **master** and **REL1\_34** were merged, CVE requested. It appears that for the other [supported release branches](https://www.mediawiki.org/wiki/Version_lifecycle) (1.31, 1.32, 1.33) it's just an issue of line differences for the patch. I'll try to get some additional patches uploaded to gerrit for these branches. [@Daimona](/p/Daimona/) - would you be able to review those just in case the patch isn't relevant? (I think it still is - whoops, it's not.)

[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 9:59 PM2019-10-28 21:59:21 (UTC+0)](#5613579)Comment Actions

Change 546752 had a related patch set uploaded (by SBassett; owner: SBassett):

[mediawiki/extensions/AbuseFilter@REL1\_31] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546752>

[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added a project: [MW-1.35-notes (1.35.0-wmf.4; 2019-10-29)](/project/view/4331/).[Oct 28 2019, 10:00 PM2019-10-28 22:00:58 (UTC+0)](#5613582)[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 10:01 PM2019-10-28 22:01:29 (UTC+0)](#5613585)Comment Actions

Change 546753 had a related patch set uploaded (by SBassett; owner: SBassett):

[mediawiki/extensions/AbuseFilter@REL1\_32] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546753>

[gerritbot](/p/gerritbot/) added a comment.[Oct 28 2019, 10:03 PM2019-10-28 22:03:04 (UTC+0)](#5613590)Comment Actions

Change 546754 had a related patch set uploaded (by SBassett; owner: SBassett):

[mediawiki/extensions/AbuseFilter@REL1\_33] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546754>

[gerritbot](/p/gerritbot/) added a comment.[Oct 29 2019, 4:59 AM2019-10-29 04:59:37 (UTC+0)](#5613855)Comment Actions

Change 546754 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_33] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546754>

[sbassett](/p/sbassett/) renamed this task from Older hidden versions of a currently-public AbuseFilter are exposed via diffs to Older hidden versions of a currently-public AbuseFilter are exposed via diffs (CVE-2019-18612).[Oct 29 2019, 3:51 PM2019-10-29 15:51:30 (UTC+0)](#5615785)

[Daimona](/p/Daimona/) added a comment.[Oct 29 2019, 4:58 PM2019-10-29 16:58:10 (UTC+0)](#5616226)Comment Actions

FTR: I've updated the backports for 1.31, 32, and 33 to avoid using AbuseFilter::canViewPrivate (introduced in 1.34). For the 1.31 one, I also had to upgrade PHPCS to 19.1.0 (and disable a new sniff) because older versions fail on PHP7.3 ([T233759](/T233759)).

As I've already pointed out, things would've been easier with phan running on REL branches ([T226945](/T226945) / [T231966](/T231966)).

[sbassett](/p/sbassett/) added a comment.[Oct 29 2019, 5:22 PM2019-10-29 17:22:47 (UTC+0)](#5616331)Comment Actions

[@Daimona](/p/Daimona/) - great, thanks for the help! Once the remaining backports are merged, I'll resolve this task.

[gerritbot](/p/gerritbot/) added a comment.[Oct 31 2019, 4:01 PM2019-10-31 16:01:24 (UTC+0)](#5623885)Comment Actions

Change 546752 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_31] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546752>

[gerritbot](/p/gerritbot/) added a comment.[Oct 31 2019, 4:02 PM2019-10-31 16:02:04 (UTC+0)](#5623886)Comment Actions

Change 546753 **merged** by jenkins-bot:

[mediawiki/extensions/AbuseFilter@REL1\_32] SECURITY: Check visibility for each version in ViewDiff

<https://gerrit.wikimedia.org/r/546753>

[sbassett](/p/sbassett/) closed this task as Resolved.[Oct 31 2019, 4:05 PM2019-10-31 16:05:34 (UTC+0)](#5623889)[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:59 PM2020-02-10 22:59:36 (UTC+0)](#5869779) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:17 PM2020-02-20 20:17:56 (UTC+0)](#5904807) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_782ddf6a_20250120_232503.html ===



