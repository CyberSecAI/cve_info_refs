Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2019-18347:

**Root Cause:**

*   The DAViCal CalDAV Server application does not properly validate or sanitize user-supplied input, such as email addresses, usernames, and display names.
*   The application also fails to encode user input when echoing it back within web pages.

**Weaknesses/Vulnerabilities:**

*   **Persistent Cross-Site Scripting (XSS):** Due to the lack of input validation and output encoding, an attacker can inject malicious JavaScript code into user profile fields (username, fullname) that gets stored in the database. This script is then executed when other users view pages containing the unsanitized input.

**Impact of Exploitation:**

*   **Malicious Script Execution:**  An attacker can inject and execute arbitrary JavaScript code within the context of other users' browsers.
*   **Session Hijacking:** The malicious JavaScript can access session tokens (if not protected by the HttpOnly flag) and other sensitive information stored by the browser.
*   **Account Takeover:** If the victim is an administrator, the attacker can use the XSS to change the administrator's password and gain complete control over the application.
*   **User-to-User Attacks:** As the injected JavaScript is stored in the database, one user can use it to attack other users on the same system.
*   **Combined Attacks:** The XSS vulnerability can be combined with a Cross-Site Request Forgery (CSRF) attack (CVE-2019-18346) to attack users from external websites.

**Attack Vectors:**

*   An attacker with a low-privileged account can insert the malicious XSS payload through the web-based management interface of DAViCal, specifically when editing user profiles.
*   The malicious script is injected into the username or fullname field.
*   When another user views the modified profile (or any page that displays the malicious input), the injected script executes.

**Required Attacker Capabilities/Position:**

*   The attacker needs a valid low-privileged account on the DAViCal system.
*   The attacker must be able to access the web-based management interface and edit user profiles.
*   No user interaction is required beyond a user viewing a page with the malicious payload, making exploitation easy for an attacker.

**Technical Details:**

*   The vulnerability exists because the application doesn't sanitize user input, particularly the characters `<`, `>`, and `"`.
*   The fix involves sanitizing both incoming variables and their names using `htmlspecialchars()` in the `always.php` file of DAViCal. This ensures that the HTML special characters are properly encoded to avoid execution by a browser.

**Affected Systems:**

*   DAViCal CalDAV Server versions 1.1.8 and earlier.

**Solution:**

*   Upgrade to DAViCal version 1.1.9.1 or 1.1.9.2.

**Additional Notes:**
The provided content gives a detailed technical explanation of the vulnerability and its exploitation, as well as the steps taken to fix it. It also includes a timeline of the responsible disclosure process.