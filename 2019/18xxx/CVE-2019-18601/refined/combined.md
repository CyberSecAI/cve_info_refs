=== Content from openafs.org_e283513f_20250120_235427.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
OpenAFS Security Advisory 2019-003
Topic: database server crash from unserialized data access
Issued: 22 October, 2019
Affected: OpenAFS versions 1.0 through 1.6.23, and 1.8.0 through 1.8.4
Database servers in the SVOTE\_Debug() RPC handler can encounter a
segmentation fault and crash during certain circumstances, when running in
parallel with the end of a write transaction on the database.
SUMMARY
=======
The SVOTE\_Debug() RPC handler used to implement the main udebug(1)
functionality performs unlocked accesses to a global pointer variable,
dereferencing it if the first access returns a non-NULL value. Since the
accesses are not serialized against writes, the value can change between
accesses (e.g., to become NULL), with the attempted dereference generating a
segmentation fault.
IMPACT
======
The impact of this issue can be limited by the compiler and options used to
compile the server code in question. For example, gcc on some popular linux
distributions is able to optimize the two memory accesses into a single
load, so the value being dereferenced to check the type of the transaction
will never be NULL. (It might point into freed memory, but for the memory
allocators in use on these linux systems, that memory is highly unlikely to
have been unmapped in the intervening period, so the access would merely
return bad data rather than crashing.) Other compilers/architectures do not
make this optimization, such as the Solaris cc, and the resulting binaries
are impacted.
Since the VOTE\_Debug() RPC does not require authentication, a remote
attacker can attempt to call the RPC repeatedly and overlap with the end of
a write transaction; crashes have been observed simply by running udebug(1)
in a tight loop.
AFFECTED SOFTWARE
=================
All releases of OpenAFS prior to 1.6.24 are affected, as are OpenAFS
1.8.0 through 1.8.4.
Database server processes built against LWP (instead of pthreads) are
not affected by this issue. Database server processes are built
against LWP by default in 1.6 releases, but are built against pthreads by
default in 1.8 releases.
FIXES
=====
The OpenAFS project recommends that administrators upgrade all database servers
to the 1.8.5 or 1.6.24 releases. It is necessary to restart the database server
processes in order for the fixes to take effect.
Using a firewall to block or rate-limit VOTE\_Debug() RPCs from untrusted
sources may be an adequate workaround.
DETAILS
=======
The udebug(1) utility is a debugging tool, and as such does not require
authenticated access for the RPC calls it performs. Most of its
functionality comes from the VOTE\_Debug() RPC, which was written to
prioritize speed and avoiding disruption of normal database operation over
correctness of output. Accordingly, it accesses global state without
adhering to the normal locking/serialization mechanisms for access to that
state. This means that the returned results can be incorrect or
inconsistent, but that tradeoff was part of its original design.
One of the pieces of information returned by SVOTE\_Debug() is whether there
is a current transaction on the database, and if so, whether it is a write
transaction. The current transaction is stored as a global pointer to a
transaction structure (ubik\_currentTrans), so whether or not there is an
ongoing transaction is a question of whether ubik\_currentTrans is non-NULL;
the type of transaction (read vs. write) is stored in a field in the
pointed-to structure. However, we only ever create a transaction structure
for ubik\_currentTrans in the case of a write transaction, so checking the
type stored in the transaction structure provides no value for this case!
Because SVOTE\_Debug() does not take any locks, it can run in parallel with a
running transaction, and in particular, the end of that transaction. This
means that the value of ubik\_currentTrans can change between accesses, and
thus that the state determined by the first access ("there is a current
transaction") can be invalid by the time of the second access (which
dereferences the pointer). In this case, an invalid pointer is
dereferenced, leading to a segmentation fault and application crash.
ACKNOWLEDGMENTS
===============
Thanks to Andrew Deason for the detailed report and contributed patch.
-----BEGIN PGP SIGNATURE-----
iQG3BAEBCgAdFiEE2WGV4E2ARf9BYP0XKNmm82TrdRIFAl2vjWsACgkQKNmm82Tr
dRLTfgwg1/96x8b3WpwMg4YUwE/RmFJZpKiI7/lscPcLsH3Jn4Ru72jqN5vUa9dW
6nCYLNqOeSPm0QDqQOz2bzle1HlcTYaCOoh446Y2kwGpBWicpyAm70SRkEiPgnVr
UR0XmfqIw0s5h7S98VPJYWeyOE6eQiH2pdjHsyg5duwg09e/Rvw+XBR4L4VQPlvx
JpK1Aa5V+1//n0egOhImFxFCMh6a9PBkuHsxjn9++f3TmM744qUbFM2SsW20OtTo
IaC518yt9Eoeyw84MnKdTzRVa6gNFcRq7wp8ls9t8zY46Q3aDEAnipkOo+2OVy7e
2cLAZ4t6vvRJKH1FBbA58DsNM+wDoiKJO0+3xYquRmIs0EbkOVpE99XNu7FUX7w2
c0xCobqlozhbuJIluSV/XbyETvKvQHg7MtKPcDN8Hgf7e12UxgisfcD8uOjb1Toj
bpx+Y6VX3Du/tW82lbZ5/1jXjiluDtAwDSHXLQbGO2JzAdtuSqiQNDpITXSUTwiH
rzYCDiJT9PivIg==
=s4yw
-----END PGP SIGNATURE-----


=== Content from lists.debian.org_38cf414a_20250120_235427.html ===


---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)]
[[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)]
[[Date Index](maillist.html#00002)]
[[Thread Index](threads.html#00002)]

# [SECURITY] [DLA 1982-1] openafs security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1982-1] openafs security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Wed, 6 Nov 2019 01:08:55 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/f7ffbdf4-5e2f-4e56-865f-7b7f9bc62301%40debian.org)Â [f7ffbdf4-5e2f-4e56-865f-7b7f9bc62301@debian.org](msg00002.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : openafs
Version        : 1.6.9-2+deb8u9
CVE ID         : CVE-2019-18601 CVE-2019-18602 CVE-2019-18603
Debian Bug     : 943587

Several security vulnerabilities were discovered in OpenAFS, a
distributed file system.

CVE-2019-18601

    OpenAFS is prone to denial of service from unserialized data access
    because remote attackers can make a series of VOTE_Debug RPC calls
    to crash a database server within the SVOTE_Debug RPC handler.

CVE-2019-18602

    OpenAFS is prone to an information disclosure vulnerability because
    uninitialized scalars are sent over the network to a peer.

CVE-2019-18603

    OpenAFS is prone to information leakage upon certain error
    conditions because uninitialized RPC output variables are sent over
    the network to a peer.

For Debian 8 "Jessie", these problems have been fixed in version
1.6.9-2+deb8u9.

We recommend that you upgrade your openafs packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAl3CDxdfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeSUUg/+MYSPighw/0EvL1S/VaJQlde/Epz0VSuebd8YxYKuvlxQ7m/dKfU2dtq5
AhJm0H2GRqOGCJr23CFv0g+fs8W9kYcgdZ26an2JZPV68oigSiIyMAh+W+/BYkgw
/mHXe+9KfaRbUdMermaW7ag99JYkvdKmZSfM5/v5RVum3CNSWSd0dG/qKDa/cVOs
RRTTCVtKjGhTHw46RK17z7Z7FCTPXeZu+tqvKb8K2MxhksNTHUe2+CdRmyvTj41Q
QnTUkRDlyYkIfR5HX3JmbFTzZNKHOnt9jcMxsHJXT7Oq0R08Qjc7uY0IPS09Csjz
K+UmYNwfwJRCSFJUV1UuptrZjT2YWkr7lPBwpxbuMsi4gNTZpnTn7WiAWl7Tfn2/
JXKbzA+PJDt2V+r9CWk+ACxbG1DTGChgrVRtJi/5NjczDHjJcmXd/DwBRgOObgls
ZvbHvtqySyXuX5aMxDPk0LjTb+z/Zl/8vbmYuSWS7WAIgjiurH30N3qdjRjpeS+V
pN45yioaeJqjz+6qodOiCP4pJv7OyXey/aJNAbDdOtwCzAqiV6KCkpAR7D64GUtY
6xThFrbB3AKAjZ3oQGp2czbiB9r0xIvdh6mOM+jh7rEOvwG9yW8Jvm2bzOAOwcPZ
cjTfqJQQXQ+VanocEQof0rBwR/8vxX05D8AMn/sVbVfzTeW0ZOM=
=sePJ
-----END PGP SIGNATURE-----

```

---


