Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The `trousers` package contained a flawed script in its `%posttrans` section. This script was designed to restore backup files after an update.
- The script used `mv` and `chown` commands without proper safeguards, making it vulnerable to symlink attacks.

**Weaknesses/Vulnerabilities Present:**

- **Symlink Following:** The script used `mv` to move a backup file (`.rpmsave`) back to its original location and `chown` to set the ownership of the restored file to `tss:tss`. This allowed an attacker to create a symlink with the name of the backup file pointing to an arbitrary file system location. During package update, the script would then operate on the attacker controlled file.
- Lack of input sanitization: The script did not validate the target of the symbolic link.

**Impact of Exploitation:**

- **Local Privilege Escalation:** A local user with `tss` privileges could exploit this vulnerability to gain root privileges. By creating a malicious symlink they could overwrite an arbitrary file on the system, and set it's ownership to tss, this could result in escalating privileges to root.
- **Arbitrary File Overwrite/Ownership Change:** An attacker could overwrite or modify any file on the system to which the `tss` user has write access (or is able to obtain write access via symlink).

**Attack Vectors:**

- **Local Access:** The attacker needs local access to the system as the `tss` user.
- **Symlink Creation:** The attacker creates a symbolic link where the target is the backup file with a path pointing to a sensitive file.

**Required Attacker Capabilities/Position:**

- The attacker must have a user account on the system with the `tss` user privileges.
- The attacker must have the ability to create symlinks in the `/var/lib/tpm` directory.
- The attacker needs to trigger a reinstall/update of the `trousers` package.

**Technical Details:**

- The vulnerable code was located in the `%posttrans` section of the `trousers` package's spec file.
- The script iterated through `system.data.auth` and `system.data.noauth`, which are files within the `/var/lib/tpm` directory.
- For each file, it checked if a `.rpmsave` backup existed. If so, it would move the backup to the original file location and change its owner to `tss`.
- The vulnerability arises when the attacker creates a symlink in `/var/lib/tpm` with a `.rpmsave` suffix pointing to a sensitive system file. The package reinstall/update will then restore the target of the link, which will overwrite the sensitive file and change its ownership to `tss`.

**Mitigation:**

- The vulnerability was fixed by using `mv --no-target-directory` and `chown --no-dereference` commands to prevent symlink following.
- The vulnerable section was removed in later versions.

**Additional Notes**
- The vulnerability is present in SLE-15-SP1 and openSUSE Factory.
- The vulnerability was assigned a moderate severity.
- The fix was released as part of SUSE-SU-2019:3349-1, openSUSE-SU-2020:0015-1, and openSUSE-SU-2020:0744-1.