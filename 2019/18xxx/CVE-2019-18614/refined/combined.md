=== Content from github.com_a9e8c318_20250120_232617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseemoo-lab%2Ffrankenstein%2Fblob%2Fmaster%2Fdoc%2FCVE_2019_18614.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseemoo-lab%2Ffrankenstein%2Fblob%2Fmaster%2Fdoc%2FCVE_2019_18614.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=seemoo-lab%2Ffrankenstein)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[seemoo-lab](/seemoo-lab)
/
**[frankenstein](/seemoo-lab/frankenstein)**
Public

* [Notifications](/login?return_to=%2Fseemoo-lab%2Ffrankenstein) You must be signed in to change notification settings
* [Fork
  65](/login?return_to=%2Fseemoo-lab%2Ffrankenstein)
* [Star
   441](/login?return_to=%2Fseemoo-lab%2Ffrankenstein)

* [Code](/seemoo-lab/frankenstein)
* [Issues
  7](/seemoo-lab/frankenstein/issues)
* [Pull requests
  1](/seemoo-lab/frankenstein/pulls)
* [Actions](/seemoo-lab/frankenstein/actions)
* [Projects
  0](/seemoo-lab/frankenstein/projects)
* [Security](/seemoo-lab/frankenstein/security)
* [Insights](/seemoo-lab/frankenstein/pulse)

Additional navigation options

* [Code](/seemoo-lab/frankenstein)
* [Issues](/seemoo-lab/frankenstein/issues)
* [Pull requests](/seemoo-lab/frankenstein/pulls)
* [Actions](/seemoo-lab/frankenstein/actions)
* [Projects](/seemoo-lab/frankenstein/projects)
* [Security](/seemoo-lab/frankenstein/security)
* [Insights](/seemoo-lab/frankenstein/pulse)

## Files

 master
## Breadcrumbs

1. [frankenstein](/seemoo-lab/frankenstein/tree/master)
2. /[doc](/seemoo-lab/frankenstein/tree/master/doc)
/
# CVE\_2019\_18614.md

Copy path Blame  Blame
## Latest commit

## History

[History](/seemoo-lab/frankenstein/commits/master/doc/CVE_2019_18614.md)32 lines (25 loc) · 2.02 KB master
## Breadcrumbs

1. [frankenstein](/seemoo-lab/frankenstein/tree/master)
2. /[doc](/seemoo-lab/frankenstein/tree/master/doc)
/
# CVE\_2019\_18614.md

Top
## File metadata and controls

* Preview
* Code
* Blame

32 lines (25 loc) · 2.02 KB[Raw](https://github.com/seemoo-lab/frankenstein/raw/refs/heads/master/doc/CVE_2019_18614.md)
# Device to host and host to device buffer misconfiguration (CVE-2019-18614)

## Disclosure timeline

* Found by Jiska and reported on October 29 2019 to *Cypress*.
* No new *WICED Studio* version since then, so probably unpatched, but only one evaluation board vulnerable.

## Bug description

Within classic Bluetooth, Asynchronous Connection-Less (ACL) mode is used for data transfer,
such as tethering or music streaming. Similar to Host Controller Interface (HCI) commands and events,
it is sent to the host using UART, but with a different data prefix in the H4 protocol.

Upon driver initialization by the operating system, the Bluetooth chip signals the maximum packet and
buffer size using the `HCI_Read_Buffer_Size` command (see p. 795, BT 5.2 Spec). Broadcom chips are configured for
an ACL length of 1021 bytes and 8 packets. If this buffer is exceeded, this causes a
heap overflow. It is important to note that this overflow cannot be exploited without bypassing the driver
and operating system Bluetooth stack, which requires privileged access either way.

Yet, on the *CYW20735* chip only, there is a buffer misconfiguration, which makes ACL exploitable.
The global variables `BT_ACL_HOST_TO_DEVICE_DEFAULT_SIZE` and `BT_ACL_DEVICE_TO_HOST_DEFAULT_SIZE`
are set to 384 bytes, while
the chip still signals a size of 1021 bytes to the host. Thus, just setting up a regular headset for
audio streaming as a user immediately results in a heap overflow. As the misconfiguration affects both
directions, the heap overflow can also be triggered over-the-air by sending a few *L2Ping*
packets exceeding 384 byte. When reconfiguring the buffer size in *WICED Studio 6.4*,
this **hard-bricks the evaluation board**, likely because of insufficient memory and
automatically reloading the firmware image internally.

This vulnerability stopped us from further ACL fuzzing with the emulated *CYW20735* firmware.
It is impossible to take a snapshot during music streaming or tethering before the firmware crashes.
However, the *CYW20819* firmware does not have this issue.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_894c3b84_20250121_013217.html ===
# Device to host and host to device buffer misconfiguration (CVE-2019-18614)
## Disclosure timeline
\* Found by Jiska and reported on October 29 2019 to \*Cypress\*.
\* No new \*WICED Studio\* version since then, so probably unpatched, but only one evaluation board vulnerable.
## Bug description
Within classic Bluetooth, Asynchronous Connection-Less (ACL) mode is used for data transfer,
such as tethering or music streaming. Similar to Host Controller Interface (HCI) commands and events,
it is sent to the host using UART, but with a different data prefix in the H4 protocol.
Upon driver initialization by the operating system, the Bluetooth chip signals the maximum packet and
buffer size using the `HCI\_Read\_Buffer\_Size` command (see p. 795, BT 5.2 Spec). Broadcom chips are configured for
an ACL length of 1021 bytes and 8 packets. If this buffer is exceeded, this causes a
heap overflow. It is important to note that this overflow cannot be exploited without bypassing the driver
and operating system Bluetooth stack, which requires privileged access either way.
Yet, on the \*CYW20735\* chip only, there is a buffer misconfiguration, which makes ACL exploitable.
The global variables `BT\_ACL\_HOST\_TO\_DEVICE\_DEFAULT\_SIZE` and `BT\_ACL\_DEVICE\_TO\_HOST\_DEFAULT\_SIZE`
are set to 384 bytes, while
the chip still signals a size of 1021 bytes to the host. Thus, just setting up a regular headset for
audio streaming as a user immediately results in a heap overflow. As the misconfiguration affects both
directions, the heap overflow can also be triggered over-the-air by sending a few \*L2Ping\*
packets exceeding 384 byte. When reconfiguring the buffer size in \*WICED Studio 6.4\*,
this \*\*hard-bricks the evaluation board\*\*, likely because of insufficient memory and
automatically reloading the firmware image internally.
This vulnerability stopped us from further ACL fuzzing with the emulated \*CYW20735\* firmware.
It is impossible to take a snapshot during music streaming or tethering before the firmware crashes.
However, the \*CYW20819\* firmware does not have this issue.
