=== Content from medium.com_d022f9f2_20250121_002805.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F685bf2d77d51&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Illegal Rendered at Download Feature in Several Apps (including Opera Mini) that Lead to Extension Manipulation (with RTLO)

## The story of when you download a file that looks “legitimate”, but changes when you run the file.

[![YoKo Kho](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---byline--685bf2d77d51--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--685bf2d77d51--------------------------------)

[YoKo Kho](https://medium.com/%40YoKoKho?source=post_page---byline--685bf2d77d51--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--byline--685bf2d77d51---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--685bf2d77d51--------------------------------)·9 min read·Oct 26, 2019

--

Listen

Share

بسم الله الرحمن الرحيم

**Update I (Jan 21st, 2020):** Opera has replied the email and acknowledged the reported issue. On that occasion, Opera also apologized for the delay in their response.

![]()

Response from Opera

**Update II (Feb 27th, 2020):** Opera notifies if Opera Mini 47 has been released and is being rolled out to 50%. They also offer a good HoF (I haven’t provided the information needed).

```
So, let say you download the .png file. But when you try to open it, the file will be executed as a malicious .apk file.  Yes, this happens at least in Opera Mini and few applications that have download feature.As a little note, we also added few simple bug hunting tips related this RTLO things at the end of article.
```
## I. TL;DR

Change the filename to: malicious<RTLO\_Char><fake\_ext>.<real\_ext>
For example: **malicious%E2%80%AEtxt.apk**

When the browser download feature fails to to parse the character perfectly, the filename will be changed to **maliciouskpa.txt**

Illegal Rendered with RTLO Character at Opera Mini (for Android) Download Feature

## II. Introduction

As we know, most browsers that have been developed will have features that can be used by users to download any file. But sometimes there is a problem that arise when the browser fails to parse the characters used as file names (on download feature) or as URL.

In this case, we found that there are some browsers that fail to render the RTLO characters perfectly and this issue can be used by Attacker to manipulate a filename automatically.

**2.1. Few Words about RTLO**
Honestly speaking, we cannot explain this very well from a technical point of view or standard in processing characters. However, as we know in general, the characters in this world are divided into two models, namely **left to right** and **right to left** character. The famous **right to left** readings that we know in this world is Arabic Character.

Based on several references, there is a standard method that was built to handle texts written from right to left. Basically, this allows computers to exchange information regardless of the language used.

So, in short, by using this method, the computer will recognize the characters that have been entered.

References:
• [https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/](https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/https%3A//krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/)
• <https://blog.malwarebytes.com/cybercrime/2014/01/the-rtlo-method/>

## **III. Testing Environment**

For example, let’s use Opera as a case study (because some programs ask not to release full disclosure).

And this is the environment that we use to reproduce this issue:

* **Used Device**: Asus Max Pro M1 (4/64GB)
* **Operating System**: Android 9 (May 1st, 2019 Update)
* **Opera Mini Version for Android**: 44.1.2254.142553 (built Aug 29th, 2019) - The version that we reported (since we got no response more than one month - *lets assume if it not hit the security bar from their point of view* - then we think it would be good for releasing the article).
  The latest version (Sept 19th, 2019 - 44.1.2254.143214) is also still vulnerable.
* **Update III (June 06th, 2020)**: This issue hits the security bar and Opera has fixed this problem as the information provided in the first part of this article.
## IV. Step to Reproduce

For example, the attacker wants to “send” this scenario to the victim:

* Attacker’s **original** file type is: .txt.
* Attacker’s **filename** is: malicious
* In this situation, the attacker **wants to manipulate** the extension, so the victim will see the file as an image format (which is a .png extension). From this scenario, the Attacker will give the filename with: **malicious%E2%80%AEgnp.txt**.
* When this file is downloaded by a vulnerable browser (in this case, Opera Mini), the file will be saved as: **malicioustxt.png** on the victim’s device.
* Even though this file is saved as a .png format, Android will still run it as .txt (because **the original format is** .txt, not .png).
* Of course, we can do it to others with bad impacts. Let’s say, the original extension was .apk, so we manipulated this extensions with .txt or other normal extensions.

Please kindly note, the **%E2%80%AE** character is **unicode U+202E** that used as **RTL Override** <https://www.charbase.com/202e-unicode-right-to-left-override>

## V. PoC Video

To complete the explanation, we add a simple PoC video that shows the situation:

* There are 2 files placed on GDrive, namely .txt file (on the left) and .apk (file) on the right;
* In this case, we took the direct download link. So when users want to download files, then they will see extensions that have been manipulated with RTLO characters;
* The **first situation** in the video, the user will download the .txt file but the file will be saved as png. When the **user wants to open** the downloaded file, the file **will be executed as .txt** (original format);
* The **2nd situation** in the video, the user will download the .apk file but the file will be saved as txt. Again, when **user wants to open** the downloaded file, the **file will be executed as .apk** and trying to install the program (original format).
## VI. Screenshot Details

In the screenshot below, we can see if Opera Mini renders the extension to .png for the original .txt file (the left one) and renders the extension to .txt for the real .apk file (the right one).

![]()

Download as .png (left one) and Download as .txt (right one)

When we try to open a file with **malicioustxt.png** name (the left one from the image above), Android will recognize it as a .txt file (original format).

![]()

Android recognise the File as .txt even though the name was .png

And for the file with **OMkpa.txt** name, then the Android will execute it as .apk format. We can see from the behavior of Opera that wants to install a program.

![]()

Opera Mini trying to install the Software

## VII. Reporting Timeline

Opera Mini Browser for Android:

* **Sept 10th 2019:** Reach Opera via <https://security.opera.com/report-security-issue/>. It might be a mistake to report through this line because you won’t receive any acknowledgment. We recommend that you report via “Report a problem feature” in the application:

![]()

In-App “Report a Problem” Feature

Even though you still haven’t received feedback, then at least you know that your email has reached them (because of their automation replies).

* **Sept 10th, 2019:** Opera saw the PoC video few times.
* **Sept 23rd, 2019:** Trying to contact them to ask about the situation and still not get any information. (Maybe they are really busy right now or it doesn’t hit the security bar from their point of view).
* **Note:** Previously we thought if this problem was fixed in the latest release version (September 19, 2019). But when we tried to reproduce the problem again a few days ago, we found it still vulnerable. Don’t know why it works and somehow it doesn’t.
* **Oct 30th, 2019:** Assigned as CVE-2019–18624.
* **Update I:** Jan 21st, 2020: Opera has replied the email and acknowledged the reported issue. On that occasion, Opera also apologized for the delay in their response.
* **Update II:** Feb 27th, 2020: Opera notifies if Opera Mini 47 has been released and is being rolled out to 50%. They also offer a good HoF (I haven’t provided the information needed).

*As a simple note, we also report this similar problem to one of our favorite bug bounty programs on one of the well-known platforms. And as usual, they respond and fix problems very quickly (with a nice bounty) without needing to ask their status. So far, they always respond in 1 day and improve in 5 days.*

* **July 22nd, 2019:** Reported via one of the well-known platform
* **July 24th, 2019:** apologize for the late response (because usually they only need 1 day, and this time takes 2 days — Cool, isn’t?).

And they fix the problem very quickly (in the next few days) and give a nice bounty (as usual).

On the other hand, we also report this to other programs and get a response within 9 days with good points.

## VIII. The Closing

At this write-up, I would like to say thanks to [Rafay Baloch](https://twitter.com/rafaybaloch). [From one of his write-up at 2016](https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html) (Relates to Address Bar Spoofing at Google Chrome and Firefox for Android by using the combination of IP+RTL), I could know about this RTLO things.

Another credits:

* RTLO in File Upload Feature at HackerOne: <https://hackerone.com/reports/298>
* Domain Spoofing with RTLO in Redirect Feature at HackerOne: <https://hackerone.com/reports/299403>

As an additional information, if you would like to try to reproducing the issue, then here are the affected version of Opera Mini for Android:

* Version 44.1.2254.143214 (Release Sept 19th, 2019): <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.143214-APK>
* Version 44.1.2254.142659 (Release Sept 03rd, 2019): <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142659-APK>
* Version 44.1.2254.142553 (Release Aug 29th, 2019) <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142553-APK>
## IX. Bug Hunting Tips Related to RTLO things

From this very simple article, then we could conclude if this RTLO things could become a security issue at various feature (even not every program think so, but it’s worth to try). As far as we can think at this time are:

**9.1. RTLO in filename via file upload feature**
At this situation, we could test if the upload feature at an application is vulnerable to extension manipulation or not.
Also, when we talk about “Filename” and “Upload Feature”, it doesn’t limited to only a web app, because it also possible to be “used” to Messaging, Email, and other similar application that has an ability to upload.
**Reference (HackerOne)**: <https://hackerone.com/reports/298>
**Reference (Telegram)**: <https://securelist.com/zero-day-vulnerability-in-telegram/83800/>

**9.2. RTLO in filename via cloud drive storage**
Similar with the previous one, just try to upload the file that contain RTLO name to the cloud drive storage, then see what happened.
**Reference (OX App Suite)**: <https://hackerone.com/reports/210354>

**9.3. RTLO in chat feature**
It also could be test at every application that has a chat feature inside (not just a native chat app). In its implementation, it could used to switching the extension or maybe create a fake URL, for example: *https://evil.com/RTLO/moc.rettiwt*. If vulnerable, somehow it will switch to *twitter.com/moc.live//:sptth*. (it happened at Facebook bug report chat).

In other case, it also just switch the things at the back to the front (just like the [address bar spoofing via IP+RTL](https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html) at Chrome and Firefox).
**Reference (Snapchat)**: <https://hackerone.com/reports/196222>

**9.4. RTLO in post feature**
Apart from the chat feature, we also could test this at an application that has a post feature. In the GitLab’s case, the RTLO issue works in the description field. From here, we also can conclude if this RTLO issue could works in every application that has an ability to post something such as “website address” information, post a reply, and other.
**Reference (GitLab)**: <https://gitlab.com/gitlab-org/gitlab-foss/issues/29365>

**9.5. RTLO in “warning” redirect feature**
This RTLO things also could be use to trying to spoof the domain name with the combination of normal latin (LTR) with RTLO character.
**Reference (HackerOne)**: <https://hackerone.com/reports/299403>

**9.6. RTLO in browser’s address bar**
From one of Rafay’s write-up, we could see if he successfully spoof the domain name via the combination of IP Address and RTLO character. For example: *https://evil\_IP\_Address/RTLO/google.com/login* become *google.com/login/RTLO/evil\_IP\_Address.*
**Reference (Google Chrome and Firefox for Android)**: <https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html>

**9.7. RTLO in browser’s download feature**
The example about this one has been explained at this simple write-up. Just as a note, **for “browser” things, it doesn’t limited** to only the native browser’s download feature. But also at the **in-App browser** (for example, the one that exist at **messaging app**) and also **few Password Manager Apps** (which is, mostly they also have in-App browser).
**Reference (Opera Mini for Android)**: this article or <http://firstsight.me/2019/10/illegal-rendered-at-download-feature-in-several-apps-including-opera-mini-that-lead-to-extension-manipulation-with-rtlo/>

*Follow* [*Infosec Write-ups*](https://medium.com/bugbountywriteup) *for more such awesome write-ups.*

[## InfoSec Write-ups

### A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub…

medium.com](https://medium.com/bugbountywriteup?source=post_page-----685bf2d77d51--------------------------------)[Rtlo](https://medium.com/tag/rtlo?source=post_page-----685bf2d77d51--------------------------------)[Spoofing](https://medium.com/tag/spoofing?source=post_page-----685bf2d77d51--------------------------------)[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----685bf2d77d51--------------------------------)[Infosec](https://medium.com/tag/infosec?source=post_page-----685bf2d77d51--------------------------------)[Bug Bounty Tips](https://medium.com/tag/bug-bounty-tips?source=post_page-----685bf2d77d51--------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--685bf2d77d51--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--685bf2d77d51--------------------------------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--685bf2d77d51--------------------------------)[51K Followers](/followers?source=post_page---post_publication_info--685bf2d77d51--------------------------------)·[Last published 9 hours ago](/how-i-found-s3-buckets-in-bug-bounties-501faf76c3f9?source=post_page---post_publication_info--685bf2d77d51--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[![YoKo Kho](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---post_author_info--685bf2d77d51--------------------------------)[![YoKo Kho](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](https://medium.com/%40YoKoKho?source=post_page---post_author_info--685bf2d77d51--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--post_author_info--685bf2d77d51---------------------follow_profile-----------)[## Written by YoKo Kho](https://medium.com/%40YoKoKho?source=post_page---post_author_info--685bf2d77d51--------------------------------)[1.2K Followers](https://medium.com/%40YoKoKho/followers?source=post_page---post_author_info--685bf2d77d51--------------------------------)·[34 Following](https://medium.com/%40YoKoKho/following?source=post_page---post_author_info--685bf2d77d51--------------------------------)

Independent | OSCP, CRTO, eWPTX, eCPTX | <https://twitter.com/YoKoAcc> | <https://bugcrowd.com/YokoKho> | <https://leanpub.com/bughunting101> (Bahasa) Free!

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc340b945467d&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fillegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51&user=YoKo+Kho&userId=c340b945467d&source=post_page-c340b945467d--post_author_info--685bf2d77d51---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----685bf2d77d51--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----685bf2d77d51--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----685bf2d77d51--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----685bf2d77d51--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----685bf2d77d51--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----685bf2d77d51--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----685bf2d77d51--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----685bf2d77d51--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----685bf2d77d51--------------------------------)[Teams](https://medium.com/business?source=post_page-----685bf2d77d51--------------------------------)



=== Content from firstsight.me_e37ecd8d_20250121_002803.html ===

[Skip to content](#page)

[Just Another Simple Write-Up](http://firstsight.me/)

Expand Menu

* [Home](http://firstsight.me)
* [Current Page Parent Write-Up](http://firstsight.me/category/write-up/)Toggle Child Menu
  + [Current Page Parent All Write-Up](http://firstsight.me/category/write-up/)
  + [Web Apps](http://firstsight.me/category/web-apps/)
  + [Current Page Parent Mobile Apps](http://firstsight.me/category/mobile-apps/)
  + [Desktop Apps](http://firstsight.me/category/desktop-apps/)
* [Write-Up in Bahasa](http://firstsight.me/category/write-up-in-bahasa/)
* [Unwritten PoC](http://firstsight.me/category/random-things/)
* [About Me](http://firstsight.me/2014/07/about-me/)
* [CVE-IDs](http://firstsight.me/2016/04/cve-ids-achievements/)
* [Honors / Awards](http://firstsight.me/2015/06/honors-awards/)
* [Terms of Use](http://firstsight.me/2014/07/terms-of-use/)

![](http://www.firstsight.me/wp-content/uploads/2019/12/Ilmu-adalah-Cahaya.png)
YoKo Kho
Independent | Part Time Bug Hunter | OSCP, CRTO, eWPTXv2, eCPTX | Top 50, 2018, (Q3, Q4) 2019, (Q1, Q3, Q4) 2020, (Q1, Q2, Q3, Q4) 2021, and (Q1) 2022 Bugcrowd MVP | https://bugcrowd.com/YoKoKho | https://leanpub.com/bughunting101 - Bug Hunting 101 eBook - (Bahasa) Free!

[Bug Report](http://firstsight.me/category/bug-report/) / [Mobile Apps](http://firstsight.me/category/mobile-apps/) / [Write-Up](http://firstsight.me/category/write-up/)
# CVE-2019–18624 – Illegal Rendered at Download Feature in Several Apps (including Opera Mini) that Lead to Extension Manipulation (with RTLO)

October 26, 2019

The story of when you download a file that looks “legitimate”, but changes when you run the file.

**In the name of Allah, the Most Gracious, the Most Merciful.**

---

**Update I (Jan 21st, 2020):** Opera has replied the email and acknowledged the reported issue. On that occasion, Opera also apologized for the delay in their response.

![](http://www.firstsight.me/wp-content/uploads/2020/03/Response-from-Opera-1024x513.png)

Response from Opera

**Update II (Feb 27th, 2020):** Opera notifies if Opera Mini 47 has been released and is being rolled out to 50%. They also offer a good HoF (I haven’t provided the information needed).

---

*So, let say you download the .png file. But when you try to open it, the file will be executed as a malicious .apk file.*  *Yes, this happens at least in Opera Mini and few applications that have download feature.*

*As a little note, we also added few simple bug hunting tips related this RTLO things at the end of article.*

---

### **I. TL;DR**

Change the filename to: malicious<RTLO\_Char><fake\_ext>.<real\_ext>
For example: **malicious%E2%80%AEtxt.apk**

When the browser download feature fails to to parse the character perfectly, the filename will be changed to **maliciouskpa.txt**

---

### **II. Introduction**

As we know, most browsers that have been developed will have features that can be used by users to download any file. But sometimes there is a problem that arise when the browser fails to parse the characters used as file names (on download feature) or as URL.

In this case, we found that there are some browsers that fail to render the RTLO characters perfectly and this issue can be used by Attacker to manipulate a filename automatically.

---

#### **2.1. Few Words about RTLO**

Honestly speaking, we cannot explain this very well from a technical point of view or standard in processing characters. However, as we know in general, the characters in this world are divided into two models, namely **left to right**and **right to left**character. The famous **right to left** readings that we know in this world is Arabic Character.

Based on several references, there is a standard method that was built to handle texts written from right to left. Basically, this allows computers to exchange information regardless of the language used.

So, in short, by using this method, the computer will recognize the characters that have been entered.

**References:**
• [https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/](https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/https%3A//krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/)
• <https://blog.malwarebytes.com/cybercrime/2014/01/the-rtlo-method/>

---

### **III. Testing Environment**

For example, let’s use Opera as a case study (because some programs ask not to release full disclosure).

And this is the environment that we use to reproduce this issue:

* **Device**: Asus Max Pro M1 (4/64GB)
* **Operating System**: Android 9 (May 1st, 2019 Update)
* **Opera Mini Version for Android**: 44.1.2254.142553 (built Aug 29th, 2019) – The version that we reported (since we got no response more than one month – *lets assume if it not hit the security bar from their point of view* – then we think it would be good for releasing the article).
  The latest version (Sept 19th, 2019 – 44.1.2254.143214) is also still vulnerable.
* **Update III (June 06th, 2020):** This issue hits the security bar and Opera has fixed this problem as the information provided in the first part of this article.

---

### **IV. Step to Reproduce**

For example, the attacker wants to “send” this scenario to the victim:

* Attacker’s **original** file type is: .txt.
* Attacker’s **filename** is: malicious
* In this situation, the attacker **wants to manipulate** the extension, so the victim will see the file as an image format (which is a .png extension). From this scenario, the Attacker will give the filename with: **malicious%E2%80%AEgnp.txt**.
* When this file is downloaded by a vulnerable browser (in this case, Opera Mini), the file will be saved as: **malicioustxt.png** on the victim’s device.
* Even though this file is saved as a .png format, Android will still run it as .txt (because **the original format is** .txt, not .png).
* Of course, we can do it to others with bad impacts. Let’s say, the original extension was .apk, so we manipulated this extensions with .txt or other normal extensions.

Please kindly note, the **%E2%80%AE** character is **unicode U+202E** that used as **RTL Override** <https://www.charbase.com/202e-unicode-right-to-left-override>

---

### **V. PoC Video**

To complete the explanation, we add a simple PoC video that shows the situation:

* There are 2 files placed on GDrive, namely .txt file (on the left) and .apk (file) on the right;
* In this case, we took the direct download link. So when users want to download files, then they will see extensions that have been manipulated with RTLO characters;
* The **first situation** in the video, the user will download the .txt file but the file will be saved as png. When the **user wants to open** the downloaded file, the file **will be executed as .txt** (original format);
* The **2nd situation** in the video, the user will download the .apk file but the file will be saved as txt. Again, when **user wants to open** the downloaded file, the **file will be executed as .apk** and trying to install the program (original format).

---

### **VI. Screenshot Details**

In the screenshot below, we can see if Opera Mini renders the extension to .png for the original .txt file (the left one) and renders the extension to .txt for the real .apk file (the right one).

![](http://www.firstsight.me/wp-content/uploads/2020/03/Download-as-png-left-one-and-Download-as-txt-right-one-1024x524.png)

Download as .png (left one) and Download as .txt (right one)

When we try to open a file with **malicioustxt.png** name (the left one from the image above), Android will recognize it as a .txt file (original format).

![](http://www.firstsight.me/wp-content/uploads/2020/03/Android-recognise-the-File-as-.txt-even-though-the-name-was-.png)

Android recognise the File as .txt even though the name was .png

And for the file with **OMkpa.txt** name, the Android will execute it as .apk format. We can see from the behavior of Opera that wants to install a program.

![](http://www.firstsight.me/wp-content/uploads/2020/03/Opera-Mini-Trying-to-Install-the-App.png)

Opera Mini trying to install the Software

---

### **VII. Reporting Timeline**

Opera Mini Browser for Android:

* **Sept 10th 2019:** Reach Opera via <https://security.opera.com/report-security-issue/>. It might be a mistake to report through this line because you won’t receive any acknowledgment. We recommend that you report via “Report a problem feature” in the application:

![](http://www.firstsight.me/wp-content/uploads/2020/03/In-App-Report-Problem-Feature.png)

In-App “Report a Problem” Feature

Even though you still haven’t received feedback, then at least you know that your email has reached them (because of their automation replies).

* **Sept 10th, 2019:** Opera saw the PoC video few times.
* **Sept 23rd, 2019:** Trying to contact them to ask about the situation and still not get any information. (Maybe they are really busy right now or it doesn’t hit the security bar from their point of view).
* **Note:** Previously we thought if this problem was fixed in the latest release version (September 19, 2019). But when we tried to reproduce the problem again a few days ago, we found it still vulnerable. Don’t know why it works and somehow it doesn’t.
* **Oct 30th, 2019:** Assigned as CVE-2019–18624.
* **Update I:** **Jan 21st, 2020**: Opera has replied the email and acknowledged the reported issue. On that occasion, Opera also apologized for the delay in their response.
* **Update II:** **Feb 27th, 2020**: Opera notifies if Opera Mini 47 has been released and is being rolled out to 50%. They also offer a good HoF (I haven’t provided the information needed).

![](http://www.firstsight.me/wp-content/uploads/2020/03/Response-from-Opera-1024x513.png)

Response from Opera

---

*As a simple note, we also report this similar problem to one of our favorite bug bounty programs on one of the well-known platforms. And as usual, they respond and fix problems very quickly (with a nice bounty) without needing to ask their status. So far, they always respond in 1 day and improve in 5 days.*

* **July 22nd, 2019:** Reported via one of the well-known platform
* **July 24th, 2019:** apologize for the late response (because usually they only need 1 day, and this time takes 2 days – Cool, isn’t?).

And they fix the problem very quickly (in the next few days) and give a nice bounty (as usual).

On the other hand, we also report this to other programs and get a response within 9 days with good points.

---

### **VIII. The Closing**

At this write-up, I would like to say thanks to [Rafay Baloch](https://twitter.com/rafaybaloch). [From one of his write-up at 2016](https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html) (Relates to Address Bar Spoofing at Google Chrome and Firefox for Android by using the combination of IP+RTL), I could know about this RTLO things.

Another credits:

* RTLO in File Upload Feature at HackerOne: <https://hackerone.com/reports/298>
* Domain Spoofing with RTLO in Redirect Feature at HackerOne: <https://hackerone.com/reports/299403>

As an additional information, if you would like to try to reproducing the issue, then here are the affected version of Opera Mini for Android:

* Version 44.1.2254.143214 (Release Sept 19th, 2019): <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.143214-APK>
* Version 44.1.2254.142659 (Release Sept 03rd, 2019): <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142659-APK>
* Version 44.1.2254.142553 (Release Aug 29th, 2019) <https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142553-APK>

---

### **IX. Bug Hunting Tips Related to RTLO things**

From this very simple article, then we could conclude if this RTLO things could become a security issue at various feature (even not every program think so, but it’s worth to try). As far as we can think at this time are:

#### **9.1. RTLO in filename via file upload feature**

At this situation, we could test if the upload feature at an application is vulnerable to extension manipulation or not.
Also, when we talk about “Filename” and “Upload Feature”, it doesn’t limited to only a web app, because it also possible to be “used” to Messaging, Email, and other similar application that has an ability to upload.
**Reference (HackerOne)**: <https://hackerone.com/reports/298>
**Reference (Telegram)**: <https://securelist.com/zero-day-vulnerability-in-telegram/83800/>

---

#### **9.2. RTLO in filename via cloud drive storage**

Similar with the previous one, just try to upload the file that contain RTLO name to the cloud drive storage, then see what happened.
**Reference (OX App Suite)**: <https://hackerone.com/reports/210354>

---

#### **9.3. RTLO in chat feature**

It also could be test at every application that has a chat feature inside (not just a native chat app). In its implementation, it could used to switching the extension or maybe create a fake URL, for example: *https://evil.com/RTLO/moc.rettiwt*. If vulnerable, somehow it will switch to *twitter.com/moc.live//:sptth*. (it happened at Facebook bug report chat).

In other case, it also just switch the things at the back to the front (just like the [address bar spoofing via IP+RTL](https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html) at Chrome and Firefox).
**Reference (Snapchat)**: <https://hackerone.com/reports/196222>

---

#### **9.4. RTLO in post feature**

Apart from the chat feature, we also could test this at an application that has a post feature. In the GitLab’s case, the RTLO issue works in the description field. From here, we also can conclude if this RTLO issue could works in every application that has an ability to post something such as “website address” information, post a reply, and other.
**Reference (GitLab)**: <https://gitlab.com/gitlab-org/gitlab-foss/issues/29365>

---

#### **9.5. RTLO in “warning” redirect feature**

This RTLO things also could be use to trying to spoof the domain name with the combination of normal latin (LTR) with RTLO character.
**Reference (HackerOne)**: <https://hackerone.com/reports/299403>

---

#### **9.6. RTLO in browser’s address bar**

From one of Rafay’s write-up, we could see if he successfully spoof the domain name via the combination of IP Address and RTLO character. For example: *https://evil\_IP\_Address/RTLO/google.com/login*become*google.com/login/RTLO/evil\_IP\_Address.*
**Reference (Google Chrome and Firefox for Android)**: <https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html>

---

#### **9.7. RTLO in browser’s download feature**

The example about this one has been explained at this simple write-up. Just as a note, **for “browser” things, it doesn’t limited** to only the native browser’s download feature. But also at the **in-App browser** (for example, the one that exist at **messaging app**) and also **few Password Manager Apps** (which is, mostly they also have in-App browser).
**Reference (Opera Mini for Android)**: this article or <http://firstsight.me/2019/10/illegal-rendered-at-download-feature-in-several-apps-including-opera-mini-that-lead-to-extension-manipulation-with-rtlo/>

Tags: [Android Application](http://firstsight.me/tag/android-application/)[CVE-2019-18624](http://firstsight.me/tag/cve-2019-18624/)[Opera Mini](http://firstsight.me/tag/opera-mini/)[RTLO](http://firstsight.me/tag/rtlo/)

Share

#### You may also like...

* [![](http://firstsight.me/wp-content/uploads/2019/12/Sample-of-Decoded-Request-at-One-of-Transaction-at-PayPal-520x292.png)](http://firstsight.me/2017/12/information-disclosure-at-paypal-and-xoom-paypal-acquisition-via-search-engine/)

  #### [Information Disclosure at PayPal and Xoom (PayPal Acquisition) via Simple Google Dork – 1,000 USD](http://firstsight.me/2017/12/information-disclosure-at-paypal-and-xoom-paypal-acquisition-via-search-engine/)
* [![](http://firstsight.me/wp-content/uploads/2019/12/Accessing-Passcode-via-SQLite-App-520x292.png)](http://firstsight.me/2014/07/passcode-vulnerability-on-pocket-expense/)

  #### [Insecure Data (Passcode) Storage at Pocket Expense for iOS version <= 4.5.1](http://firstsight.me/2014/07/passcode-vulnerability-on-pocket-expense/)
* [![](http://firstsight.me/wp-content/uploads/2025/01/Record-from-Archive-520x292.png)](http://firstsight.me/2025/01/understanding-stealer-logs-and-their-role-in-security-testing-a-focus-on-asset-discovery-part-2/)

  #### [Understanding Stealer Logs and Their Role in Security Testing: A Focus on Asset Discovery— Part 2 – Company Blog](http://firstsight.me/2025/01/understanding-stealer-logs-and-their-role-in-security-testing-a-focus-on-asset-discovery-part-2/)

* [**Next story** 5,000 USD XSS Issue at Avast Desktop AntiVirus for Windows (Yes, Desktop!)](http://firstsight.me/2019/10/5000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop/)
* [**Previous story** Race Condition that could Result to RCE – (A story with an App that temporary stored an uploaded file within 2 seconds before moving it to Amazon S3)](http://firstsight.me/2019/09/race-condition-that-could-result-to-rce-a-story-with-an-app-that-temporary-stored-an-uploaded-file-within-2-seconds-before-moving-it-to-amazon-s3/)

### Search

### Recent Posts

* [Understanding Stealer Logs and Their Role in Security Testing: A Focus on Asset Discovery— Part 2 – Company Blog](http://firstsight.me/2025/01/understanding-stealer-logs-and-their-role-in-security-testing-a-focus-on-asset-discovery-part-2/)
* [Bypassing iOS App Jailbreak Detection by Patching the Binary with Ghidra: Write-up of No-Escape Lab from MobileHackingLab – Company Blog](http://firstsight.me/2024/12/bypassing-ios-app-jailbreak-detection-by-patching-the-binary-with-ghidra-write-up-of-no-escape-lab-from-mobilehackinglab/)
* [Understanding Stealer Logs and Its Role in Security Testing — Part 1 – Company Blog](http://firstsight.me/2024/08/understanding-stealer-logs-and-its-role-in-security-testing-part-1/)
* [Electron-Based App Security Testing Fundamentals Part 3 (2nd Section) — Extracting and Analyzing .asar Files – Company Blog](http://firstsight.me/2024/05/electron-based-app-security-testing-fundamentals-part-3-2nd-section-extracting-and-analyzing-asar-files-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 3 (1st Section) — Extracting and Analyzing .asar Files – Company Blog](http://firstsight.me/2024/04/electron-based-app-security-testing-fundamentals-part-3-1st-section-extracting-and-analyzing-asar-files-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 2— Installing and Detecting Electron-Based Application – Company Blog](http://firstsight.me/2024/04/electron-based-app-security-testing-fundamentals-part-2-installing-and-detecting-electron-based-application-company-blog/)
* [Electron-Based App Security Testing Fundamentals Part 1 — Introduction to Electron Framework – Company Blog](http://firstsight.me/2024/03/electron-based-app-security-testing-fundamentals-part-1-introduction-to-electron-framework-company-blog/)
### Categories

* [About Me](http://firstsight.me/category/about-me/) (3)
* [Achievements](http://firstsight.me/category/achievements/) (2)
* [Bug Report](http://firstsight.me/category/bug-report/) (30)
* [Desktop Apps](http://firstsight.me/category/desktop-apps/) (8)
* [Mobile Apps](http://firstsight.me/category/mobile-apps/) (6)
* [Random Things](http://firstsight.me/category/random-things/) (8)
* [Terms of Use](http://firstsight.me/category/terms-of-use/) (1)
* [Web Apps](http://firstsight.me/category/web-apps/) (21)
* [Write-Up](http://firstsight.me/category/write-up/) (22)
* [Write-Up in Bahasa](http://firstsight.me/category/write-up-in-bahasa/) (4)

Firstsight.me © 2024. All Rights Reserved.

Powered by [WordPress](http://wordpress.org). Theme by [Alx](http://alx.media).


