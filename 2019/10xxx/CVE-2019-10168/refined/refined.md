```
{
  "cve": "CVE-2019-10168",
  "description": "The virConnectBaselineHypervisorCPU() and virConnectCompareHypervisorCPU() libvirt APIs accept an \"emulator\" argument to specify the program providing emulation for a domain. Since v1.2.19, libvirt will execute that program to probe the domain's capabilities. Read-only clients could specify an arbitrary path for this argument, causing libvirtd to execute a crafted executable with its own privileges.",
  "affected_packages": [
    "app-emulation/libvirt < 5.4.1"
  ],
  "vulnerability_details": {
    "root_cause": "The libvirt API functions `virConnectBaselineHypervisorCPU()` and `virConnectCompareHypervisorCPU()` accept an 'emulator' argument, which specifies the program to use for emulation. These functions, introduced in v1.2.19, execute the specified program to probe domain capabilities. This execution occurs even for read-only API clients.",
    "weaknesses": [
      "Unintended functionality exposed to read-only API clients",
      "Arbitrary command execution due to lack of input validation on the 'emulator' argument"
    ],
    "impact": "A local attacker with access to the libvirt socket can execute arbitrary commands with the privileges of the libvirtd daemon (which is typically root). This can lead to privilege escalation, denial of service, and the ability to manipulate or compromise virtual machines.",
    "attack_vectors": "Local access to the libvirt socket (typically `/var/run/libvirt/libvirt-sock-ro`). The attacker sends malicious input through the `virConnectBaselineHypervisorCPU()` or `virConnectCompareHypervisorCPU()` API calls.",
    "attacker_capabilities": "A local user with read-only access to the libvirt API socket.  On Red Hat Enterprise Linux 8, this vulnerability can lead to full root compromise due to use of the CAP_DAC_OVERRIDE capability flag."
  },
  "additional_notes": "This vulnerability is related to other similar vulnerabilities in libvirt that allow read-only clients to perform privileged operations (CVE-2019-10161, CVE-2019-10166, and CVE-2019-10167). The issue was resolved in libvirt versions 4.10.1 and 5.4.1. Mitigation includes restricting access to the libvirt read-only socket and upgrading affected packages."
}
```