```
{
  "vulnerability_details": {
    "root_cause": "The libvirt daemon (libvirtd) incorrectly permitted read-only clients to use the `virDomainManagedSaveDefineXML()` API. This allowed these clients to modify managed save state files, potentially leading to arbitrary command execution upon domain resume.",
    "weaknesses": [
      "Incorrect permission check on the `virDomainManagedSaveDefineXML()` API.",
      "Exposure of a privileged API to read-only clients.",
	  "Lack of proper input sanitization, allowing for modification of managed save state files which could include malicious commands."
    ],
    "impact": "A local attacker with read-only access to the libvirt socket could modify a managed save state file created by a privileged user to execute arbitrary commands when the domain is resumed. On Red Hat Enterprise Linux 8, this could lead to full root compromise due to the libvirtd binary's use of the CAP_DAC_OVERRIDE capability flag. On other versions of RHEL, privilege escalation to the 'qemu' user and denial of service are possible. The vulnerability also allows testing for the existence of files on the host and can lead to denial of service by using specific paths in `/dev` or `/proc`.",
    "attack_vectors": "Local access to the libvirt read-only socket (`/var/run/libvirt/libvirt-sock-ro`). If `listen_tcp` is enabled in `/etc/libvirt/libvirtd.conf`, network access might also be possible.",
    "attacker_capabilities": "The attacker requires local access to the libvirt read-only socket.  The attacker needs to have the ability to connect to the socket (which is normally world readable).  The attacker needs knowledge about the existence of managed save state files to exploit the vulnerability."
  }
}
```