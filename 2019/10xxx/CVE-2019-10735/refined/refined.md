The content is related to CVE-2019-10735.

**Root cause of vulnerability:**
The vulnerability stems from the way Claws Mail handles PGP/INLINE and PGP/MIME encrypted messages within a larger email body. When an attacker embeds an encrypted message within attacker-controlled text, Claws Mail decrypts the message, and if the victim replies, the decrypted plaintext is included in the reply, thus leaking the plaintext to the attacker.

**Weaknesses/vulnerabilities present:**
- **Decryption Oracle:** Claws Mail acts as a decryption oracle by decrypting PGP/INLINE and PGP/MIME messages embedded within a larger text and including the decrypted content in replies.
- **Lack of Input Sanitization/Validation:** The email client doesn't properly validate the structure of encrypted messages when embedded in a larger text body. This allows attackers to inject encrypted blocks among attacker-controlled text.
- **Downgrading PGP/MIME to PGP/INLINE:** Attackers can take PGP/MIME encrypted emails and insert them in a text/plain part of a message, forcing the user agent to interpret them as PGP/INLINE.
- **No proper detection of mixed content:** Claws Mail does not have a mechanism to differentiate the source of the text being quoted in a reply, making it difficult to determine which parts of the message were originally encrypted.

**Impact of exploitation:**
- **Plaintext Leakage:** Attackers can extract the plaintext of encrypted emails by embedding them within attacker-controlled content and inducing the victim to reply.
- **Privacy Breach:** Confidential information contained in encrypted emails can be exposed to unauthorized parties.

**Attack vectors:**
- **Email Manipulation:** The attacker crafts a malicious email with a combination of attacker-controlled text and embedded encrypted messages (PGP/INLINE or PGP/MIME).
- **Man-in-the-Middle:** The attacker may obtain encrypted messages through passive MITM attacks or by hacking the victim's mail server.
- **Social Engineering:** The attacker lures the user into replying with an email containing mixed content.

**Required attacker capabilities/position:**
- Possession of PGP/MIME or PGP/INLINE encrypted messages intended for the victim.
- Ability to craft and send emails to the victim.
- No special privilege or position is needed.