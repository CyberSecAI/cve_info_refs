## CVE-2019-10677

The provided content relates to CVE-2019-10677, which describes a Cross-Site Scripting (XSS) vulnerability in DASAN Zhone ZNID GPON 2426A EU devices.

Here's a breakdown of the vulnerability based on the provided information:

**Vulnerability Description:**

*   **Vulnerability:** Multiple Cross-Site Scripting (XSS)
*   **Location:** Web interface of DASAN Zhone ZNID GPON 2426A EU
*   **Affected Versions:**
    *   All releases of 3.0.xxx SW (on 3.0 branch)
    *   Release 3.1.349 and earlier (on 3.1 branch)
    *   Release 3.2.087 and earlier (on 3.2 branch)
    *   Release 4.1.253 and earlier (on 4.1 branch)
    *   Release 5.0.019 and earlier (on 5.0 branch)
    *   Version <= S3.1.285
    *   Alternate Version: <= S3.0.738
*   **Root Cause:** Unsanitized GET parameters in the web interface allow a remote attacker to inject arbitrary JavaScript code.

**Attack Vectors:**

*   **Reflected XSS:** Injecting malicious JavaScript via a crafted URL.
    *   Example: `http://192.168.1.1/zhndnsdisplay.cmd?fileKey=&name=%3Cscript%3Ealert(1)%3C/script%3E&interface=eth0.v1685.ppp`
*   **Stored XSS:** Injecting malicious JavaScript that is stored on the device and executed when other users access the affected functionality.
    *   Examples:
        *   `http://192.168.1.1/wlsecrefresh.wl?wl_wsc_reg=%27;alert(wpaPskKey);//` (WiFi network plaintext password)
        *   `http://192.168.1.1/wlsecrefresh.wl?wlWscCfgMethod=';alert(wpaPskKey);//` (WiFi network plaintext password)
        *   `http://192.168.1.1/wlsecrefresh.wl?wlWscCfgMethod=';alert(sessionKey);//` (CSRF token)
*   **Clickjacking:**  Using an iframe to trick a user into performing unintended actions on the device.
    *   Example: `<html><body><iframe src="http://192.168.1.1/resetrouter.html"></iframe></body></html>`

**Impact of Exploitation:**

*   Execution of arbitrary JavaScript code in the context of the user's browser.
*   Potentially stealing sensitive information, such as WiFi passwords or CSRF tokens.
*   Performing actions on behalf of the user.
*   Compromising the device.

**Attacker Capabilities:**

*   Remote attacker.
*   Ability to craft malicious URLs or web pages.
*   For Stored XSS, the attacker needs to be able to inject the malicious code into a stored data field.

**Mitigation:**

*   The vendor released a security patch on 2019-09-03.
*   Upgrade to a firmware version that is not affected by the vulnerability.

**Additional Notes:**

*   The vulnerability was discovered and reported by Adam Ziaja.
*   The information includes proof-of-concept (PoC) exploit code.
*   The report also mentions clickjacking as a separate, related vulnerability.