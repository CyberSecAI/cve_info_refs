=== Content from redmine.openinfosecfoundation.org_42abb5ea_20250120_235529.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #2902

closed

### rust/dhcp: panic in dhcp parser

Added by [Jason Ish](/users/9) [almost 6 years](/projects/suricata/activity?from=2019-03-25 "03/25/2019 03:09 PM") ago.
Updated [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:49 AM") ago.

Status:ClosedPriority:NormalAssignee:[Jason Ish](/users/9)Target version:[4.1.4](/versions/130 "04/30/2019")
Affected Versions:[4.1.3](/versions/126 "03/07/2019")Label:CVE:[2019-10052](https://nvd.nist.gov/vuln/detail/CVE-2019-10052)Git IDs:

41aab88ddc7bb593cf1be58e137af85b8bf553f5

Severity:Disclosure Date:

---

**Description**

From reporter:
```

==14370== ERROR: libFuzzer: deadly signal
...
/home/sirko/Projects/CI/fuzzing/suricata-fuzzing.2/rust/src/dhcp/parser.rs:126:23
#17 0x56083d83ff5b in suricata::dhcp::parser::parse_option::hab72aeff1560bad1 /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/<::nom::macros::named macros>:38:46
#18 0x56083d80582b in suricata::dhcp::parser::dhcp_parse::h5f41b0fc5736d132 /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/src/dhcp/parser.rs:205:22
#19 0x56083d7e4e8f in suricata::dhcp::dhcp::DHCPState::parse::h7ace958910b14aac /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/src/dhcp/dhcp.rs:146:14
#20 0x56083d72dfbc in rust_fuzzer_test_input /home/sirko/Projects/CI/fuzzing/suricata-fuzzing.2/rust/fuzz/fuzz_targets/
fuzz_dhcp.rs:7:4
#21 0x56083d9b2744 in libfuzzer_sys::test_input_wrap::_$u7b$$u7b$closure$u7d$$u7d$::h29c9181044b7489b
/home/sirko/.cargo/git/checkouts/libfuzzer-sys-e07fde05820d7bc6/4a41319/src/lib.rs:11:8
#22 0x56083d9f984d in std::panicking::try::do_call::hd66afc279650fe66
/rustc/0f88167f89fffe321590c5148f21b7d51d44388d/src/libstd/panicking.rs:293:39
#23 0x56083da0afe8 in __rust_maybe_catch_panic /rustc/0f88167f89fffe321590c5148f21b7d51d44388d/src/libpanic_abort/
lib.rs:29:4
NOTE: libFuzzer has rudimentary signal handlers.
Combine libFuzzer with AddressSanitizer or similar for better crash reports.
SUMMARY: libFuzzer: deadly signal

```

The error is from an attempt to parse len - 1 bytes without first checking that len is > 0.

---

**Related issues**
[1](/issues?issue_id=2947&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?issue_id=2947&set_filter=true&status_id=c))

|  | Copied to Suricata - [Security #2947](/issues/2947): rust/dhcp: panic in dhcp parser (master) | Closed | [Jason Ish](/users/9) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/2902?tab=history)
* [Notes](/issues/2902?tab=notes)
* [Property changes](/issues/2902?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 08:24 AM") ago

* **Copied to** *[Security #2947](/issues/2947): rust/dhcp: panic in dhcp parser (master)* added

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 12:29 PM") ago

* **Status** changed from *Assigned* to *Closed*

<https://github.com/OISF/suricata/releases/tag/suricata-4.1.4>

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 12:54 PM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#4](#note-4)
#### Updated by [Victor Julien](/users/4) [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:49 AM") ago

* **Tracker** changed from *Bug* to *Security*
* **Effort** deleted (~~*low*~~)
* **Difficulty** deleted (~~*low*~~)
* **CVE** set to *2019-10052*
* **Git IDs** updated ([diff](/journals/17307/diff?detail_id=17858 "View differences"))

Actions
Copy link

Also available in: [Atom](/issues/2902.atom)
[PDF](/issues/2902.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from redmine.openinfosecfoundation.org_e806e079_20250120_235529.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #2947

closed

### rust/dhcp: panic in dhcp parser (master)

Added by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 08:24 AM") ago.
Updated [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:49 AM") ago.

Status:ClosedPriority:NormalAssignee:[Jason Ish](/users/9)Target version:[5.0beta1](/versions/115 "04/30/2019")
Affected Versions:[4.1.3](/versions/126 "03/07/2019")Label:CVE:[2019-10052](https://nvd.nist.gov/vuln/detail/CVE-2019-10052)Git IDs:

8be4142aaf100353dcf10b4d79ff68e34b78f87c

Severity:Disclosure Date:

---

**Description**

From reporter:
```

==14370== ERROR: libFuzzer: deadly signal
...
/home/sirko/Projects/CI/fuzzing/suricata-fuzzing.2/rust/src/dhcp/parser.rs:126:23
#17 0x56083d83ff5b in suricata::dhcp::parser::parse_option::hab72aeff1560bad1 /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/<::nom::macros::named macros>:38:46
#18 0x56083d80582b in suricata::dhcp::parser::dhcp_parse::h5f41b0fc5736d132 /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/src/dhcp/parser.rs:205:22
#19 0x56083d7e4e8f in suricata::dhcp::dhcp::DHCPState::parse::h7ace958910b14aac /home/sirko/Projects/CI/fuzzing/suricata-
fuzzing.2/rust/src/dhcp/dhcp.rs:146:14
#20 0x56083d72dfbc in rust_fuzzer_test_input /home/sirko/Projects/CI/fuzzing/suricata-fuzzing.2/rust/fuzz/fuzz_targets/
fuzz_dhcp.rs:7:4
#21 0x56083d9b2744 in libfuzzer_sys::test_input_wrap::_$u7b$$u7b$closure$u7d$$u7d$::h29c9181044b7489b
/home/sirko/.cargo/git/checkouts/libfuzzer-sys-e07fde05820d7bc6/4a41319/src/lib.rs:11:8
#22 0x56083d9f984d in std::panicking::try::do_call::hd66afc279650fe66
/rustc/0f88167f89fffe321590c5148f21b7d51d44388d/src/libstd/panicking.rs:293:39
#23 0x56083da0afe8 in __rust_maybe_catch_panic /rustc/0f88167f89fffe321590c5148f21b7d51d44388d/src/libpanic_abort/
lib.rs:29:4
NOTE: libFuzzer has rudimentary signal handlers.
Combine libFuzzer with AddressSanitizer or similar for better crash reports.
SUMMARY: libFuzzer: deadly signal

```

The error is from an attempt to parse len - 1 bytes without first checking that len is > 0.

---

**Related issues**
[1](/issues?issue_id=2902&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?issue_id=2902&set_filter=true&status_id=c))

|  | Copied from Suricata - [Security #2902](/issues/2902): rust/dhcp: panic in dhcp parser | Closed | [Jason Ish](/users/9) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/2947?tab=history)
* [Notes](/issues/2947?tab=notes)
* [Property changes](/issues/2947?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 08:24 AM") ago

* **Copied from** *[Security #2902](/issues/2902): rust/dhcp: panic in dhcp parser* added

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 01:08 PM") ago

* **Status** changed from *Assigned* to *Closed*
* **Private** changed from *Yes* to *No*

<https://github.com/OISF/suricata/releases/tag/suricata-5.0.0-beta1>

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:49 AM") ago

* **Tracker** changed from *Bug* to *Security*
* **Effort** deleted (~~*low*~~)
* **Difficulty** deleted (~~*low*~~)
* **CVE** set to *2019-10052*
* **Git IDs** updated ([diff](/journals/17308/diff?detail_id=17863 "View differences"))

Actions
Copy link

Also available in: [Atom](/issues/2947.atom)
[PDF](/issues/2947.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...


