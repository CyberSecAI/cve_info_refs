=== Content from redmine.openinfosecfoundation.org_1ef888ce_20250120_232517.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #2946

closed

### decode-ethernet: heapbuffer overflow in file decode-ethernet.c (master)

Added by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 08:23 AM") ago.
Updated [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:12 AM") ago.

Status:ClosedPriority:HighAssignee:[Jason Ish](/users/9)Target version:[5.0beta1](/versions/115 "04/30/2019")
Affected Versions:Label:CVE:[2019-10056](https://nvd.nist.gov/vuln/detail/CVE-2019-10056)Git IDs:

8d7d6a96a52273dfae17c55aef7098d0d9670aba

Severity:Disclosure Date:

---

**Description**

From reporter:
```

## Input
Nearly the same as bug 2 but the type is an other, such that the DecodeEthernet(..) is executed e second time.
...
case ETHERNET_TYPE_DCE:
if (unlikely(len < ETHERNET_DCE_HEADER_LEN)) {
ENGINE_SET_INVALID_EVENT(p, DCE_PKT_TOO_SMALL);
} else {
DecodeEthernet(tv, dtv, p, pkt + ETHERNET_DCE_HEADER_LEN,
len - ETHERNET_DCE_HEADER_LEN, pq);
}
break ;
...
## Reason
If the package is exactly 28 long, in the first iteration you subtract 14 bytes. Than we have a packet length
of 14. At this point the case distinction says it is a valid packet. After that you cast the packet, but
This packet has not a type and the program will crash at the type case distinction.

```

If you proof the ethernet packets of a valid minimal max length, it would counter this types of bugs
```

```

---

**Related issues**
[1](/issues?issue_id=2887&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?issue_id=2887&set_filter=true&status_id=c))

|  | Copied from Suricata - [Security #2887](/issues/2887): decode-ethernet: heapbuffer overflow in file decode-ethernet.c | Closed | [Jason Ish](/users/9) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/2946?tab=history)
* [Notes](/issues/2946?tab=notes)
* [Property changes](/issues/2946?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 08:23 AM") ago

* **Copied from** *[Security #2887](/issues/2887): decode-ethernet: heapbuffer overflow in file decode-ethernet.c* added

ActionsCopy link
[#2](#note-2)
#### Updated by [Victor Julien](/users/4) [over 5 years](/projects/suricata/activity?from=2019-04-30 "04/30/2019 01:08 PM") ago

* **Status** changed from *Assigned* to *Closed*
* **Private** changed from *Yes* to *No*

<https://github.com/OISF/suricata/releases/tag/suricata-5.0.0-beta1>

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [over 4 years](/projects/suricata/activity?from=2020-09-01 "09/01/2020 09:12 AM") ago

* **Tracker** changed from *Bug* to *Security*
* **CVE** set to *2019-10056*
* **Git IDs** updated ([diff](/journals/17299/diff?detail_id=17832 "View differences"))

Actions
Copy link

Also available in: [Atom](/issues/2946.atom)
[PDF](/issues/2946.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...


