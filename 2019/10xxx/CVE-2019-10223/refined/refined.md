Based on the provided information, here's an analysis of CVE-2019-10223:

**Root Cause of Vulnerability:**

*   An experimental feature in `kube-state-metrics` versions 1.7.0 and 1.7.1 allowed annotations to be exposed as metrics.
*   While `kube-state-metrics` was intended to expose only metadata about Secrets, the combination of this feature with the default `kubectl` behavior inadvertently exposed the entire content of secrets within metric labels.

**Weaknesses/Vulnerabilities Present:**

*   **Information Disclosure:** The primary vulnerability is the unintentional exposure of sensitive data (specifically, the content of Kubernetes Secrets) through metric labels.
*   **Unintended Feature Behavior:** The experimental feature of exposing annotations as metrics did not adequately consider the potential for exposing sensitive information.

**Impact of Exploitation:**

*   **Confidentiality Breach:** Attackers could potentially gain access to sensitive information stored within Kubernetes secrets, such as passwords, API keys, and other credentials.
*   **Lateral Movement/Privilege Escalation:**  Compromised secrets could be leveraged to further compromise the Kubernetes cluster or other systems.

**Attack Vectors:**

*   **Metrics Scraping:** Attackers could gain access to the exposed secret data by scraping the metrics endpoint of the vulnerable `kube-state-metrics` instance. This would likely be done via a monitoring solution like Prometheus.
*   **Default `kubectl` Behavior**: The issue arises from the combination of the experimental metrics feature with how `kubectl` retrieves data, leading to the secret content being included as labels in the metrics.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the metrics endpoint exposed by `kube-state-metrics`.
*   **Access to Monitoring System**: If the metrics are already being ingested by a monitoring system, an attacker with access to that system could retrieve the exposed secrets.

**Additional Details:**

*   **Affected Versions:** `kube-state-metrics` versions 1.7.0 and 1.7.1 are vulnerable.
*   **Mitigation:**
    *   Upgrade to `kube-state-metrics` version 1.7.2, which reverts the problematic feature.
    *   Alternatively, filter out annotation metrics using the `--metric-blacklist="kube_.*_annotations"` flag.
    *   Delete historical time-series data from Prometheus that may contain leaked secrets.
*   The vulnerability was reported by Moritz S.
*  The issue is considered to have medium severity.