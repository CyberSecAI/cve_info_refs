=== Content from about.gitlab.com_821e743a_20250121_000049.html ===


# Releases

### Subscribe

Thanks for subscribing!

Search the blog

### Categories

* [All Blogs](/blog/archives.html)
* [AI/ML](/blog/categories/ai-ml/)
* [careers](/blog/categories/careers/)
* [company](/blog/categories/company/)
* [culture](/blog/categories/culture/)
* [DevOps](/blog/categories/devops/)
* [DevOps Platform](/blog/categories/devops-platform/)
* [devSecOps](/blog/categories/devsecops/)
* [devSecOps Platform](/blog/categories/devsecops-platform/)
* [engineering](/blog/categories/engineering/)
* [insights](/blog/categories/insights/)
* [news](/blog/categories/news/)
* [open source](/blog/categories/open-source/)
* [releases](/releases/categories/releases/)
* [security](/blog/categories/security/)

### Follow Us

Featured Post

[Joe Randazzo](/company/team/#jrandazzo)

Jan 16, 2025

[## GitLab 17.8 released](/releases/2025/01/16/gitlab-17-8-released/)

GitLab 17.8 released with enhanced security for container repositories, ML model experiments tracking, list deployments related to a release, Hosted runners on Linux for GitLab Dedicated, and much more!
[Read on](/releases/2025/01/16/gitlab-17-8-released/)

### Recent Posts

[![Post Image](/images/default-blog-image.png)](/releases/2025/01/15/gitlab-17-7-2-released/)
[### GitLab Patch Release: 17.7.2](/releases/2025/01/15/gitlab-17-7-2-released/)
[Mayra Cabrera](/company/team/#gitlab)

Jan 15, 2025

GitLab releases 17.7.2

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2025/01/08/patch-release-gitlab-17-7-1-released/)
[### GitLab Patch Release: 17.7.1, 17.6.3, 17.5.5](/releases/2025/01/08/patch-release-gitlab-17-7-1-released/)
[Greg Alfaro](/company/team/#gitlab)

Jan 8, 2025

Learn more about GitLab Patch Release: 17.7.1, 17.6.3, 17.5.5 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_7/17_7-cover-image.png)](/releases/2024/12/19/gitlab-17-7-released/)
[### GitLab 17.7 released](/releases/2024/12/19/gitlab-17-7-released/)
[Courtney Meddaugh](/company/team/#courtmeddaugh)

Dec 19, 2024

GitLab 17.7 released with a new Planner user role, auto-resolution policy for vulnerabilities, admin-controlled instance integration allowlists, access token rotation in the UI and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/12/11/patch-release-gitlab-17-6-2-released/)
[### GitLab Patch Release: 17.6.2, 17.5.4, 17.4.6](/releases/2024/12/11/patch-release-gitlab-17-6-2-released/)
[Costel Maxim](/company/team/#gitlab)

Dec 11, 2024

Learn more about GitLab Patch Release: 17.6.2, 17.5.4, 17.4.6 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/11/26/patch-release-gitlab-17-6-1-released/)
[### GitLab Patch Release: 17.6.1, 17.5.3, 17.4.5](/releases/2024/11/26/patch-release-gitlab-17-6-1-released/)
[Ottilia Westerlund](/company/team/#gitlab)

Nov 26, 2024

Learn more about GitLab Patch Release: 17.6.1, 17.5.3, 17.4.5 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_6/17_6-cover-image.png)](/releases/2024/11/21/gitlab-17-6-released/)
[### GitLab 17.6 released](/releases/2024/11/21/gitlab-17-6-released/)
[Magdalena Frankiewicz](/company/team/#m_frankiewicz)

Nov 21, 2024

GitLab 17.6 released with self-hosted Duo Chat in beta, adherence checks for SAST and DAST security scanners, vulnerability report grouping, model registry and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/11/13/patch-release-gitlab-17-5-2-released/)
[### GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7](/releases/2024/11/13/patch-release-gitlab-17-5-2-released/)
[Greg Myers](/company/team/#gitlab)

Nov 13, 2024

Learn more about GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/10/23/patch-release-gitlab-17-5-1-released/)
[### GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6](/releases/2024/10/23/patch-release-gitlab-17-5-1-released/)
[Kevin Morrison](/company/team/#gitlab)

Oct 23, 2024

Learn more about GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_5/17_5-cover-image.png)](/releases/2024/10/17/gitlab-17-5-released/)
[### GitLab 17.5 released](/releases/2024/10/17/gitlab-17-5-released/)
[John Crowley](/company/team/#johncrowley)

Oct 17, 2024

GitLab 17.5 released with code assistance in IDEs from GitLab Duo Quick Chat, self-hosted models for GitLab Duo Code Suggestions, export code suggestion usage events, MR conversations with GitLab Duo Chat and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/10/09/patch-release-gitlab-17-4-2-released/)
[### GitLab Critical Patch Release: 17.4.2, 17.3.5, 17.2.9](/releases/2024/10/09/patch-release-gitlab-17-4-2-released/)
[Nikhil George](/company/team/#gitlab)

Oct 9, 2024

Learn more about GitLab Critical Patch Release: 17.4.2, 17.3.5, 17.2.9 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/25/patch-release-gitlab-16-10-10-released/)
[### GitLab Critical Patch Release: 16.10.10, 16.9.11, 16.8.10, 16.7.10, 16.6.10, 16.5.10, 16.4.7, 16.3.9, 16.2.11, 16.1.8, 16.0.10](/releases/2024/09/25/patch-release-gitlab-16-10-10-released/)
[Greg Myers](/company/team/#gitlab)

Sep 25, 2024

Learn more about GitLab Critical Patch Release: 16.10.10, 16.9.11, 16.8.10, 16.7.10, 16.6.10, 16.5.10, 16.4.7, 16.3.9, 16.2.11, 16.1.8, 16.0.10 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/25/patch-release-gitlab-17-4-1-released/)
[### GitLab Patch Release: 17.4.1, 17.3.4, 17.2.8](/releases/2024/09/25/patch-release-gitlab-17-4-1-released/)
[Greg Myers](/company/team/#gitlab)

Sep 25, 2024

Learn more about GitLab Patch Release: 17.4.1, 17.3.4, 17.2.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/17_4/17_4-cover-image.png)](/releases/2024/09/19/gitlab-17-4-released/)
[### GitLab 17.4 released](/releases/2024/09/19/gitlab-17-4-released/)
[Alex Martin](/company/team/#alex_martin)

Sep 19, 2024

GitLab 17.4 released with more context-aware GitLab Duo Code Suggestions using open tabs, auto-merge when all checks pass, extension marketplace in the Web IDE, list Kubernetes resource events and much more!

[![Post Image](/images/blogimages/security-cover-new.png)](/releases/2024/09/17/patch-release-gitlab-17-3-3-released/)
[### GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8, 16.11.10](/releases/2024/09/17/patch-release-gitlab-17-3-3-released/)
[Rohit Shambhuni](/company/team/#gitlab)

Sep 17, 2024

Learn more about GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8, 16.11.10 for GitLab Community Edition (CE) and Enterprise Edition (EE).

[![Post Image](/images/default-blog-image.png)](/releases/2024/09/11/gitlab-16-11-9-released/)
[### GitLab Patch Release: 16.11.9](/releases/2024/09/11/gitlab-16-11-9-released/)
[Ahmad Tolba](/company/team/#gitlab)

Sep 11, 2024

GitLab releases 16.11.9

* Prev
* 1
* [2](/releases/categories/releases/p2/)
* [3](/releases/categories/releases/p3/)
* [Next](/releases/categories/releases/p2/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/category.html.haml)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/category.html.haml)



=== Content from gitlab.com_9d4b6b85_20250121_000050.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# Persistent XSS at Merge Request "Resolve conflicts" page using source branch name as payload

**[HackerOne report #486772](https://hackerone.com/reports/486772)** by `valis_` on 2019-01-26, assigned to `dappelt`:

**Summary:**

The vulnerability should be technically classified as a Vue client-side template injection, but since it's trivial to gain full Javascript execution from Vue expressions, it leads straight to a persistent XSS.

**Description:**

Vue template expression is injected in app/views/projects/merge\_requests/conflicts/\_submit\_form.html.haml:

```
- branch_name = link_to @merge_request.source_branch, project_tree_path(@merge_request.project, @merge_request.source_branch), class: "ref-name"
- translation =_('You can resolve the merge conflict using either the Interactive mode, by choosing %{use_ours} or %{use_theirs} buttons, or by editing the files directly. Commit these changes into %{branch_name}') % { use_ours: '<code>Use Ours</code>', use_theirs: '<code>Use Theirs</code>', branch_name: branch_name }

..
      .resolve-info
        = translation.html_safe
```

The whole #conflicts div is parsed as Vue template because there is no 'template' property and no render() method specified when creating a Vue object in app/assets/javascripts/merge\_conflicts/merge\_conflicts\_bundle.js

link\_to correctly escapes html entities, but does not protect against template injection.

Putting following payload in the source branch name will execute js code:

`{{toString.constructor('alert(/xss/)')()}}`

## Steps To Reproduce:

1. Login to Gitlab
2. Create a new project.
3. Create a text file, e.g. README on a master branch.
4. Create a new branch with a following name:

    `fix-critical-issue-long-name-{{toString.constructor('alert(/xss/)')()}}`
5. Commit a change to the first line of the README file in a newly created branch.
6. Commit a different change to the first line of the README file in a master branch to create a conflict.
7. Create a merge request for our new branch
8. Click 'Resolve conflicts'
9. You'll see a javascript alert from the executed payload:

   [![gitlab-xss.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/a8e45ec7eb5e61b2084001380d8691d02f55366d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3438363737322f3431333131392f6769746c61622d7873732e706e67)

Tested against my own gitlab instance: gitlab-ee version 11.7.0-ee.0 (Ubuntu package from packages.gitlab.com) with Chrome 71 and Firefox 64.

I did not try it at gitlab.com, but it's most likely vulnerable as well.

The payload provided above uses single quotes instead of backticks shown in the screenshot - it works exactly the same, but backticks are problematic in Markdown.

Above steps use just one account with full project access for simplicity, playing a role of both attacker and victim.

You'll find a more realistic scenario below.

### Example attack scenario:

1. Attacker has a developer-level access to a project owned by the victim.
2. Attacker creates a new branch with the xss payload as described above:

   [![gitlab-newbranch.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/774ec2fe3660a81d331fe5b1ce64a540be834c6f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3438363737322f3431333132322f6769746c61622d6e65776272616e63682e706e67)
3. Attacker creates a merge request with an intentional conflict:

   [![gitlab-newmerge.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0f436f3d96cee45faff9428b3d654b9959b139d5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3438363737322f3431333132302f6769746c61622d6e65776d657267652e706e67)
4. Attacker sends the victim (project owner) a link to the the conflict resolution page, e.g.

   <https://gitlabhost/group1/project1/merge_requests/1/conflicts>

   (the link seems completely innocent)

   or just waits for the victim to examine the new merge request by him or herself.

   Note that thanks to a truncation of the branch name at the merge request page victim is less likely to

   notice anything suspicious about the merge request, especially if the request's name, description and

   branch prefix are carefully prepared to match routine requests from the target project.

   [![gitlab-merge.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2159ee8bbbb6487a16a86ab9d38b039e240c90b6/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3438363737322f3431333132312f6769746c61622d6d657267652e706e67)
5. Victim visits conflict resolution page and xss payload executes:

   [![gitlab-xss.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/a8e45ec7eb5e61b2084001380d8691d02f55366d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3438363737322f3431333131392f6769746c61622d7873732e706e67)
6. Attacker can now perform all the actions that victim is authorized to perform.

   See 'Impact' for more details.

## Impact

Attacker can perform all the actions that victim (person reviewing merge request) is authorized to perform, including:

* full access to all victim's repositories
* adding API keys to achieve persistence
* changing victim's password through the 'Forgot my password' feature (the fact that this is possible is IMO a weakness by itself and I'll submit a separate report about that)

etc

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [gitlab-xss.png](https://h1.sec.gitlab.net/a/486772/413119/gitlab-xss.png)
* [gitlab-newmerge.png](https://h1.sec.gitlab.net/a/486772/413120/gitlab-newmerge.png)
* [gitlab-merge.png](https://h1.sec.gitlab.net/a/486772/413121/gitlab-merge.png)
* [gitlab-newbranch.png](https://h1.sec.gitlab.net/a/486772/413122/gitlab-newbranch.png)

## Links

* Security issue: <https://dev.gitlab.org/gitlab/gitlabhq/issues/2819>

Edited Feb 26, 2019 by [Paul Slaughter](/pslaughter)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


