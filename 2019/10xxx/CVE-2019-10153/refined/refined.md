## CVE-2019-10153

Based on the analyzed content, the vulnerability is related to the fence-agents package, specifically the fence_rhevm agent.

The following information has been extracted from the analyzed contents:

**Root cause of the vulnerability:**
*   Mis-handling of non-ASCII characters in guest VM comment fields.
*   The fence_rhevm agent exited with an exception when non-ASCII characters were present in a guest VM's comment or other fields.

**Weaknesses/vulnerabilities present:**
*   The fence\_rhevm agent did not properly handle UTF-8 encoding, causing issues when non-ASCII characters were encountered.

**Impact of exploitation:**
*   In cluster environments, this could lead to preventing automated recovery.
*   Denial of service to clusters of which that VM is a member.

**Attack vectors:**
*   An attacker could insert non-ASCII characters into a guest VM's comment or other fields.
*   The cluster tries to fence(stonith admin) the other node in the cluster.

**Required attacker capabilities/position:**
*   Ability to modify guest VM comment or other fields in environments using fence\_rhevm.
*   The attacker needs to be able to trigger the fencing mechanism.

**Mitigation:**
*   The upstream fix is available in: <https://github.com/ClusterLabs/fence-agents/pull/255> and <https://github.com/ClusterLabs/fence-agents/pull/272>
*   The issue has been addressed in Red Hat Enterprise Linux 7 via RHSA-2019:2037.
*   The vulnerability is fixed in fence-agents version 4.3.4

**Additional details:**
*   The issue was observed starting from RHV/Ovirt 4.2.
*   The problem was triggered when the pcs cluster tried to fence the other node in a 2-node cluster.
*   The problem was resolved by switching to UTF-8 encoding.
*   The character set used on the system might cause the issue.
*   It is possible to set an IP address in the SAN extension if the address is managed in the IdM DNS service and associated with the subject host or service principal.