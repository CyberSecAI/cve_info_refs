=== Content from github.com_c2052cc7_20250121_000732.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases%2Ftag%2Fv4.3.0-stable)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases%2Ftag%2Fv4.3.0-stable)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl/tree/v4.3.0-stable)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  54](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl/tree/v4.3.0-stable)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

1. [Releases](/wolfSSL/wolfssl/releases)
2. [v4.3.0-stable](/wolfSSL/wolfssl/releases/tag/v4.3.0-stable)

# wolfSSL release version 4.3.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.3.0-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)
released this
21 Dec 00:48

·
[13670 commits](/wolfSSL/wolfssl/compare/v4.3.0-stable...master)
to master
since this release

[v4.3.0-stable](/wolfSSL/wolfssl/tree/v4.3.0-stable)

[`3f13b49`](/wolfSSL/wolfssl/commit/3f13b49fa318fbd3216d7da36d942e7c276d3413)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

# wolfSSL Release 4.3.0 (12/20/2019)

If you have questions about this release, then feel free to contact us on our info@ address.

Release 4.3.0 of wolfSSL embedded TLS has bug fixes and new features including:

##### New Feature Additions

* Add --enable-libwebsockets option for support of libwebsockets build
* Updated support for NGINX 1.15.0 and added support for 1.16.1
* Add wc\_scrypt\_ex API which can take in iterations rather than cost
* Updates to RSA-PSS salt lengths. Macro WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER allows for discovering the salt length. Passing RSA\_PSS\_SALT\_LEN\_DISCOVER value into wc\_RsaPSS\_Verify\_ex attempts to discover salt length and can use larger salt lengths
* Additional OpenSSL compatibility API wolfSSL\_CertManagerGetCerts and wolfSSL\_X509\_STORE\_GetCerts for retrieving certificates
* Add support for 4096-bit RSA/DH operations to SP (single precision) build
* Update support for Google WebRTC to branch m79
* Adds new FREESCALE\_MQX\_5\_0 macro for MQX 5.0 support
* Adds a CMS/PKCS#7 callback for signing SignedData raw digests enabled with macro HAVE\_PKCS7\_RSA\_RAW\_SIGN\_CALLBACK and call to function wc\_PKCS7\_SetRsaSignRawDigestCb
* Add --disable-errorqueue feature to disable adding debug nodes to queue with --enable-opensslextra build
* After defining WOLFSSL\_SHUTDOWNONCE macro the function wolfSSL\_shutdown will return a specific error code of SSL\_SHUTDOWN\_ALREADY\_DONE\_E, to indicate to the application that the shutdown has already occurred
* Add AES-CCM decryption to benchmarking app bundled with wolfSSL

##### Fixes

* Fixes IAR warnings with IAR-EWARM 7.50.2
* Alignment fixes for mmCAU with AES and hashing algorithms
* Fix check for plaintext length when using Encrypt-Then-MAC
* Fix for unit tests with NGINX and debug mode
* Fix for macro names in test cases (WOLFSSL\_PUBLIC\_MP) and pkcs7.c (HAVE\_AESCCM)
* Fix for Apache want read case with BIO retry flag
* Fix for PKCS7 streaming mode that would error rather than verify bundle
* Fix for freeing mutex for X509 and wolfSSL\_EVP\_PKEY\_free, applies to OPENSSL\_EXTRA / --enable-opensslextra builds
* Fix for encrypt then MAC when re-handshaking, encrypted handshakes change over to ETM now
* Fix for curve25519 assembly optimizations with GCC + AVX2
* Fix to hang onto certificate for retrieval if using secure renegotiation and session resumption
* Fixes case where the heap hint is created before WOLFSSL\_CTX, when calling wc\_LoadStaticMemory instead of wolfSSL\_CTX\_load\_static\_memory
* Fix for setting correct return value in PKCS12 parse error case
* Reset certificate extension policy count
* Fix for memcpy with TLS I/O buffers when using staticmemory pools and loading memory as WOLFMEM\_IO\_POOL\_FIXED
* Fixes and updates for STM32 port, including additional mutex protection, AES-GCM decrypt auth tag, AES-CTR mode with CubeMX, update to OpenSTM32 project
* Fix for EVP CipherUpdate decrypt and add a test case
* DTLS fixes including; some DTLS sequence number issues in general where the sequence was incremented twice for each record and some offset values in the DTLS window checking
* Fix sp\_add to handle carries properly (--enable-sp-math build)
* Additional sanity check on OCSP response decoder
* Fix for vasprintf with Solaris and AIX builds
* Fix for missing variable declaration with --enable-scep --with-libz build
* Fix for certificate date check with async build
* Sanity check on “out” length with Base64\_Decode added
* Decode X.509 name - check input length for jurisdiction
* Additional sanity check on variable out index with DecodePolicyOID
* Fix for PKCS#12 PBKDF buffer size for buffer overflow
* TLS supported curve extension check curve name is in range before checking for disabled
* Sanity check for non TLS 1.3 cipher suite with TLS 1.3 connection
* Poly1305 AVX2 assembly optimization fix for carry with large input values
* Fixes for coverity report including null termination of test case strings and initialization of PKCS7 variables
* Fix for API visibility of wc\_ed25519\_check\_key which resolves a wolfcrypt-py install issue
* Sanity check on max ALPN length accepted
* Additional sanity check when parsing CRL’s for copying the structure, fix for bounds checking
* Additional checks on error string length for debug mode and check for null termination
* ProcessPeerCerts allocating memory for exts with OPENSSL\_EXTRA properly
* Clear the top bit when generating a serial number
* Sanity check that ASN date characters are valid ASCII characters
* Fix to add deterministic ECDSA and fix corner cases for add point.
* When getting the DH public key, initialize the P, G, and Pub pointers to NULL, then set that we own the DH parameters flag. This allows FreeSSL to correctly clean up the DH key.

##### Improvements/Optimizations

* Added configure error report with using invalid build of --enable-opensslextra and --enable-opensslcoexist together
* Update PKCS11 for determining key type given the private key type
* Update DoVerifyCallback to check verify param hostName and ipasc (--enable-opensslextra builds)
* additional null sanity checks on input arguments with QSH and Cryptocell builds
* Additional checks on RSA key added to the function wc\_CheckRsaKey
* Updates for EBSNET support, including fseek, revised macros in settings.h, and realloc support
* MISRA-C updates for SP math code
* Update to allow compiling for pwdbased/PBKDF2 with having NO\_ASN defined
* Modify KeyShare and PreSharedKey TLS 1.3 extension linked list advancement to be easier for compilers to handle
* Optimization to parsing certificate extension name strings
* Adjustment to example server -x runtime behavior when encountering an unrecoverable error case
* Remove Blake2b support from HMAC
* Adds new hash wrapper init wc\_HashInit\_ex and Adds new PBKDF2 API wc\_PBKDF2\_ex for using heap hints for custom memory pools
* Adding script to cleanup generated test files, scripts/cleanup\_testfiles.sh
* Support 20-byte serial numbers and disallow 0
* sp\_div improved to handle when a has less digits than d (--enable-sp-math build)
* When decoding a policy OID and turning it into a human readable string use snprintf()
* set the IV length of EVP AES GCM to 96-bits by default
* Allow adding CAs for root CA's over the wire that do not have the extended key usage cert\_sign set
* Added logging messages for SendAlert call and update to send alert after verify certificate callback
* updates for synchronous OCTEON support in the Sniffer
* Rework BER to DER functions to not be recursive
* Updates to find CRL by AuthKeyId
* Add a check for subject name hash after matching AKID
* Enhancement to mp\_invmod/fp\_exptmod/sp\_exptmod to handle more inputs
* Remove requirement for macro NO\_SKID when CRL use is enabled
* Improvements on XFTELL return code and MAX\_WOLFSSL\_FILE\_SIZE checking
* When checking if value is prime return NO in the case of the value 1
* Improve Cortex-M RSA/DH assembly code performance
* Additional sanity checks on arrays and buffers with OCSP

##### This release of wolfSSL includes a fix for 6 security vulnerabilities.

A fix for having an additional sanity check when parsing certificate domain names was added. This fix checks that the domain name location index is not past the maximum value before setting it. The reported issue affects users that are parsing certificates and have --enable-opensslextra (macro OPENSSL\_EXTRA), or build options that turn this on such as --enable-all, when building wolfSSL. The CVE associated with the fix is [CVE-2019-18840](https://github.com/advisories/GHSA-42mp-7xj4-8whx "CVE-2019-18840").

Fix to set a limit on the maximum size of DTLS handshake messages. By default the RFC allows for handshake message sizes of up to 2^24-1 bytes long but in typical field use cases the handshake messages are not this large. Setting a maximum size limit on the handshake message helps avoid a potential DoS attack due to memory being malloc’d. The new default max size is set to handle a certificate chain length of approximately 9, 2048 bit RSA certificates. This only effects builds that have DTLS turned on and have applications that are using DTLS.

Fix for a potential hang when ECC caching is enabled (off by default) and --enable-fastmath is used. ECC caching is off by default and is turned on in builds that are using --enable-all or --enable-fpecc. This issue does not affect builds that are using the macro WOLFSSL\_VALIDATE\_ECC\_IMPORT which turns on validating all ECC keys that are imported. To fix this potential hang case a sanity check on the input values to the internal invmod function was added.

To fix a potential fault injection attack on a wrapper function for wolfCrypt RSA signature generations an additional sanity check verifying the signature after it’s creation was added. This check is already done automatically in current versions of wolfSSL with TLS connections (internal function call of VerifyRsaSign during TLS state machine). The report only affects users making calls to the wolfCrypt function wc\_SignatureGenerateHash and does not affect current TLS use cases. Thanks to Daniel Moghimi (@danielmgmi) from Worcester Polytechnic Institute for the report.

Blinding was added for DSA signing operations. The DSA signing uses the BEEA algorithm during modular inversion of the nonce which can potentially leak the nonce through side channels such as cache and power fluctuations. The fix of adding in blinding makes the DSA signing operation more resistant to side channel attacks. Users who have turned on DSA (disabled by default) and are performing signing operations should update. Note that DSA is not used in any TLS connections. Thanks to Daniel Moghimi (@danielmgmi) from Worcester Polytechnic Institute for the report.

Fix to add additional side channel cache attack resistance to the internal ECC function wc\_ecc\_mulmod\_ex. This function by default is used with ECDSA signing operations. Users should update if performing ECDSA singing operations (server side ECC TLS connections, mutual authentication on client side) or calling wolfCrypt ECC sign functions and have the potential for outside users to perform sophisticated monitoring of the cache.Thanks to Daniel Moghimi (@danielmgmi) from Worcester Polytechnic Institute for the report.

For additional vulnerability information visit the vulnerability page at <https://www.wolfssl.com/docs/security-vulnerabilities/>

See INSTALL file for build instructions.

More info can be found on-line at <http://wolfssl.com/wolfSSL/Docs.html>

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8e3dabad_20250121_000730.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F7e391f0fd57f2ef375b1174d752a56ce34b2b190)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F7e391f0fd57f2ef375b1174d752a56ce34b2b190)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  54](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

## Commit

[Permalink](/wolfSSL/wolfssl/commit/7e391f0fd57f2ef375b1174d752a56ce34b2b190)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#2629](https://github.com/wolfSSL/wolfssl/pull/2629) from SparkiDev/dsa\_blinding

[Browse files](/wolfSSL/wolfssl/tree/7e391f0fd57f2ef375b1174d752a56ce34b2b190)
Browse the repository at this point in the history

```
Blinding for DSA sign
```

* Loading branch information

[![@toddouska](https://avatars.githubusercontent.com/u/601574?s=40&v=4)](/toddouska)

[toddouska](/wolfSSL/wolfssl/commits?author=toddouska "View all commits by toddouska")
authored
Dec 6, 2019

2 parents
[4b31a18](/wolfSSL/wolfssl/commit/4b31a180c8c46080e98dafc2b3ce1dfc15a038b5)
+
[b9a8220](/wolfSSL/wolfssl/commit/b9a82204e2fd7df7bcba15bf1d2654f206c9f6bb)

commit 7e391f0

Showing
**1 changed file**
with
**84 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

84 changes: 84 additions & 0 deletions

84
[wolfcrypt/src/dsa.c](#diff-de93f03cec00937dbe4e452456d4e70a440a54dc3b5e36988187d1e908095a4d "wolfcrypt/src/dsa.c")

Show comments

[View file](/wolfSSL/wolfssl/blob/7e391f0fd57f2ef375b1174d752a56ce34b2b190/wolfcrypt/src/dsa.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -663,6 +663,9 @@ int wc\_DsaExportKeyRaw(DsaKey\* dsa, byte\* x, word32\* xSz, byte\* y, word32\* ySz) |
|  |  | int wc\_DsaSign(const byte\* digest, byte\* out, DsaKey\* key, WC\_RNG\* rng) |
|  |  | { |
|  |  | mp\_int k, kInv, r, s, H; |
|  |  | #ifndef WOLFSSL\_MP\_INVMOD\_CONSTANT\_TIME |
|  |  | mp\_int b; |
|  |  | #endif |
|  |  | mp\_int\* qMinus1; |
|  |  | int ret = 0, sz; |
|  |  | byte buffer[DSA\_HALF\_SIZE]; |
| Expand All | | @@ -676,8 +679,14 @@ int wc\_DsaSign(const byte\* digest, byte\* out, DsaKey\* key, WC\_RNG\* rng) |
|  |  |  |
|  |  | sz = min((int)sizeof(buffer), mp\_unsigned\_bin\_size(&key->q)); |
|  |  |  |
|  |  | #ifdef WOLFSSL\_MP\_INVMOD\_CONSTANT\_TIME |
|  |  | if (mp\_init\_multi(&k, &kInv, &r, &s, &H, 0) != MP\_OKAY) |
|  |  | #else |
|  |  | if (mp\_init\_multi(&k, &kInv, &r, &s, &H, &b) != MP\_OKAY) |
|  |  | #endif |
|  |  | { |
|  |  | return MP\_INIT\_E; |
|  |  | } |
|  |  | qMinus1 = &kInv; |
|  |  |  |
|  |  | /\* NIST FIPS 186-4: B.2.2 |
| Expand Down  Expand Up | | @@ -708,6 +717,7 @@ int wc\_DsaSign(const byte\* digest, byte\* out, DsaKey\* key, WC\_RNG\* rng) |
|  |  | if (ret == 0 && mp\_add\_d(&k, 1, &k) != MP\_OKAY) |
|  |  | ret = MP\_MOD\_E; |
|  |  |  |
|  |  | #ifdef WOLFSSL\_MP\_INVMOD\_CONSTANT\_TIME |
|  |  | /\* inverse k mod q \*/ |
|  |  | if (ret == 0 && mp\_invmod(&k, &key->q, &kInv) != MP\_OKAY) |
|  |  | ret = MP\_INVMOD\_E; |
| Expand All | | @@ -734,6 +744,72 @@ int wc\_DsaSign(const byte\* digest, byte\* out, DsaKey\* key, WC\_RNG\* rng) |
|  |  |  |
|  |  | if (ret == 0 && mp\_mulmod(&s, &kInv, &key->q, &s) != MP\_OKAY) |
|  |  | ret = MP\_MULMOD\_E; |
|  |  | #else |
|  |  | /\* Blinding value |
|  |  | \* Generate b in range [1, q-1]. |
|  |  | \*/ |
|  |  | if (ret == 0) { |
|  |  | do { |
|  |  | ret = wc\_RNG\_GenerateBlock(rng, buffer, sz); |
|  |  | if (ret == 0 && mp\_read\_unsigned\_bin(&b, buffer, sz) != MP\_OKAY) |
|  |  | ret = MP\_READ\_E; |
|  |  | } while (ret == 0 && mp\_cmp(&b, qMinus1) != MP\_LT); |
|  |  | } |
|  |  | if (ret == 0 && mp\_add\_d(&b, 1, &b) != MP\_OKAY) |
|  |  | ret = MP\_MOD\_E; |
|  |  |  |
|  |  | /\* set H from sha digest \*/ |
|  |  | if (ret == 0 && mp\_read\_unsigned\_bin(&H, digest, |
|  |  | WC\_SHA\_DIGEST\_SIZE) != MP\_OKAY) { |
|  |  | ret = MP\_READ\_E; |
|  |  | } |
|  |  |  |
|  |  | /\* generate r, r = (g exp k mod p) mod q \*/ |
|  |  | if (ret == 0 && mp\_exptmod\_ex(&key->g, &k, key->q.used, &key->p, |
|  |  | &r) != MP\_OKAY) { |
|  |  | ret = MP\_EXPTMOD\_E; |
|  |  | } |
|  |  |  |
|  |  | /\* calculate s = (H + xr)/k |
|  |  | = b.(H/k.b + x.r/k.b) \*/ |
|  |  |  |
|  |  | /\* k = k.b \*/ |
|  |  | if (ret == 0 && mp\_mulmod(&k, &b, &key->q, &k) != MP\_OKAY) |
|  |  | ret = MP\_MULMOD\_E; |
|  |  |  |
|  |  | /\* kInv = 1/k.b mod q \*/ |
|  |  | if (ret == 0 && mp\_invmod(&k, &key->q, &kInv) != MP\_OKAY) |
|  |  | ret = MP\_INVMOD\_E; |
|  |  |  |
|  |  | if (ret == 0 && mp\_mod(&r, &key->q, &r) != MP\_OKAY) |
|  |  | ret = MP\_MOD\_E; |
|  |  |  |
|  |  | /\* s = x.r \*/ |
|  |  | if (ret == 0 && mp\_mul(&key->x, &r, &s) != MP\_OKAY) |
|  |  | ret = MP\_MUL\_E; |
|  |  |  |
|  |  | /\* s = x.r/k.b \*/ |
|  |  | if (ret == 0 && mp\_mulmod(&s, &kInv, &key->q, &s) != MP\_OKAY) |
|  |  | ret = MP\_MULMOD\_E; |
|  |  |  |
|  |  | /\* H = H/k.b \*/ |
|  |  | if (ret == 0 && mp\_mulmod(&H, &kInv, &key->q, &H) != MP\_OKAY) |
|  |  | ret = MP\_MULMOD\_E; |
|  |  |  |
|  |  | /\* s = H/k.b + x.r/k.b |
|  |  | = (H + x.r)/k.b \*/ |
|  |  | if (ret == 0 && mp\_add(&s, &H, &s) != MP\_OKAY) |
|  |  | ret = MP\_ADD\_E; |
|  |  |  |
|  |  | /\* s = b.(e + x.r)/k.b |
|  |  | = (e + x.r)/k \*/ |
|  |  | if (ret == 0 && mp\_mulmod(&s, &b, &key->q, &s) != MP\_OKAY) |
|  |  | ret = MP\_MULMOD\_E; |
|  |  |  |
|  |  | /\* s = (e + x.r)/k \*/ |
|  |  | if (ret == 0 && mp\_mod(&s, &key->q, &s) != MP\_OKAY) |
|  |  | ret = MP\_MOD\_E; |
|  |  | #endif |
|  |  |  |
|  |  | /\* detect zero r or s \*/ |
|  |  | if (ret == 0 && (mp\_iszero(&r) == MP\_YES || mp\_iszero(&s) == MP\_YES)) |
| Expand All | | @@ -759,6 +835,14 @@ int wc\_DsaSign(const byte\* digest, byte\* out, DsaKey\* key, WC\_RNG\* rng) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | ForceZero(buffer, sz); |
|  |  | mp\_forcezero(&kInv); |
|  |  | mp\_forcezero(&k); |
|  |  | #ifndef WOLFSSL\_MP\_INVMOD\_CONSTANT\_TIME |
|  |  | mp\_forcezero(&b); |
|  |  |  |
|  |  | mp\_clear(&b); |
|  |  | #endif |
|  |  | mp\_clear(&H); |
|  |  | mp\_clear(&s); |
|  |  | mp\_clear(&r); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7e391f0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F7e391f0fd57f2ef375b1174d752a56ce34b2b190) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


