=== Content from gist.github.com_c5533912_20250121_010604.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@CyberSecurityUP](https://avatars.githubusercontent.com/u/34966120?s=64&v=4)](/CyberSecurityUP)

# [CyberSecurityUP](/CyberSecurityUP)/**[Public CVEs (Joas Antonio)](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4)**

Last active
May 8, 2020 08:03

Show Gist options

* [Download ZIP](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/archive/0b6fa9f4170a60b4d040486786722758294c85f2.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4.js&quot;&gt;&lt;/script&gt;
* Save CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4 to your computer and use it in GitHub Desktop.

[Code](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4)
[Revisions
3](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/revisions)
[Stars
1](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4.js&quot;&gt;&lt;/script&gt;

Save CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4 to your computer and use it in GitHub Desktop.

[Download ZIP](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/archive/0b6fa9f4170a60b4d040486786722758294c85f2.zip)

 [Raw](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/raw/0b6fa9f4170a60b4d040486786722758294c85f2/Public%2520CVEs%2520%28Joas%2520Antonio%29)

[**Public CVEs (Joas Antonio)**](#file-public-cves-joas-antonio)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | CVE -2018-18405: |
| --- | --- |
|  | O jQuery v2.2.2 permite o XSS por meio de um atributo onerror criado de um elemento IMG. |
|  | Reference: https://owasp.org/www-community/attacks/xss/ - |
|  | https://www.imperva.com/learn/application-security/cross-site-scripting-xss-attacks/ - |
|  | https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/xss.md - |
|  |  |
|  |  |
|  | CVE-2019-19517: |
|  | Os dispositivos Intelbras RF1200 1.1.3 permitem que o CSRF faça a autenticação no |
|  | login.html sem a necessidade de acessar a interface de login, possibilitando força bruta e |
|  | até raspagem, conforme demonstrado pelo lançamento de um processo obsoleto. |
|  | Reference: https://www.youtube.com/watch?v=5ZQ9yIomSWA / |
|  | https://portswigger.net/web-security/csrf / |
|  | https://www.youtube.com/watch?v=13QPmRuhbhU |
|  |  |
|  | CVE-2019-19514: Os dispositivos |
|  | Ayision Ays-WR01 v28K.RPT.20161224 permitem o XSS armazenado nas configurações |
|  | básicas do repetidor por meio de um SSID. |
|  | Reference: https://www.youtube.com/watch?v=mKE0-Zij2lc - |
|  | https://www.rapid7.com/resources/ssid-xss-vulnerabilities-explained/ |
|  |  |
|  | CVE-2019-19515: Os dispositivos |
|  | Ayision Ays-WR01 v28K.RPT.20161224 permitem XSS armazenado nas configurações |
|  | sem fio. |
|  | Reference: https://www.youtube.com/watch?v=mKE0-Zij2lc / |
|  | https://www.rapid7.com/resources/ssid-xss-vulnerabilities-explained/ |
|  | Foi utilizado a mesma prova do conceito, só muda o campo de formulário aonde foi |
|  | injetado |
|  |  |
|  | CVE-2020-5517: |
|  | O CSRF no URI / login no BlueOnyx 5209R permite que um invasor acesse o painel e |
|  | execute raspagem ou outra análise. |
|  | Reference: https://portswigger.net/web-security/csrf / |
|  | https://www.youtube.com/watch?v=13QPmRuhbhU / |
|  | https://www.youtube.com/watch?v=I0W45zfnlWo / |
|  | https://www.youtube.com/watch?v=ArBndCZWwEs |
|  |  |
|  | CVE-2020-7983: |
|  | um problema de CSRF no login.asp nos dispositivos Ruckus R500 3.4.2.0.384 permite que |
|  | atacantes remotos acessem o painel de login |
|  | Reference: https://portswigger.net/web-security/csrf // |
|  | https://www.youtube.com/watch?v=4573oXpG4u4&amp;t=28s |
|  |  |
|  | CVE-2020-8033: |
|  | Os dispositivos Ruckus R500 3.4.2.0.384 permitem XSS através do campo index.asp |
|  | Device Name. |
|  | Reference: https://www.youtube.com/watch?v=myycj3nhLZ4 |
|  |  |
|  | CVE-2020-8829: O |
|  | CSRF nos dispositivos Intelbras CIP 92200 permite que um invasor acesse o painel e |
|  | execute raspagem ou outra análise. |
|  | Reference: https://www.youtube.com/watch?v=8tlOpzAZLlo / |
|  | https://portswigger.net/web-security/csrf |
|  |  |
|  | CVE-2020-8830: O CSRF no login.asp nos dispositivos Ruckus R500 permite que um invasor acesse o painel |
|  | e use scripts para executar raspagem ou outra análise através do campo SUBCA-1 na tela |
|  | Wireless Admin. |
|  | Reference: https://www.youtube.com/watch?v=zZxnOYhpmSA |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from portswigger.net_4ebaf4bd_20250121_031455.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### Cross-site request forgery (CSRF)

* [What is CSRF?](/web-security/csrf#what-is-csrf)
* [Impact](/web-security/csrf#what-is-the-impact-of-a-csrf-attack)
* [How does CSRF work?](/web-security/csrf#how-does-csrf-work)
* [XSS vs CSRF](/web-security/csrf/xss-vs-csrf)

  + [Can CSRF tokens prevent XSS attacks?](/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)
* [Constructing an attack](/web-security/csrf#how-to-construct-a-csrf-attack)
* [Delivering an exploit](/web-security/csrf#how-to-deliver-a-csrf-exploit)
* [Defences](/web-security/csrf#common-defences-against-csrf)
* [Bypassing CSRF token validation](/web-security/csrf/bypassing-token-validation)

  + [What is a CSRF token?](/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)
  + [Flaws in CSRF token validation](/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)

    - [Validation depends on request method](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)
    - [Validation depends on token being present](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)
    - [Token isn't tied to user session](/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)
    - [Token is tied to a non-session cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)
    - [Token is duplicated in a cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)
* [Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)

  + [What is a site?](/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)
  + [Site vs origin](/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)
  + [How does SameSite work?](/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)

    - [Strict restriction level](/web-security/csrf/bypassing-samesite-restrictions#strict)
    - [Lax restriction level](/web-security/csrf/bypassing-samesite-restrictions#lax)
    - [No SameSite restrictions](/web-security/csrf/bypassing-samesite-restrictions#none)
  + [Bypassing Lax restrictions using GET requests](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)
  + [Bypassing restrictions using on-site gadgets](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)
  + [Bypassing restrictions via vulnerable sibling domains](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)
  + [Bypassing Lax restrictions with newly issued cookies](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)
* [Bypassing Referer-based CSRF defenses](/web-security/csrf/bypassing-referer-based-defenses)

  + [Validation of Referer depends on header being present](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)
  + [Validation of Referer can be circumvented](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)
* [Preventing CSRF vulnerabilities](/web-security/csrf/preventing)

  + [CSRF tokens](/web-security/csrf/preventing#use-csrf-tokens)

    - [Generating](/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)
    - [Transmitting](/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)
    - [Validating](/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)
  + [Strict SameSite cookie restrictions](/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)
  + [Be wary of cross-origin, same-site attacks](/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)
* [View all CSRF labs](/web-security/all-labs#cross-site-request-forgery-csrf)

* [Web Security Academy](/web-security)
* [CSRF](/web-security/csrf)

# Cross-site request forgery (CSRF)

In this section, we'll explain what cross-site request forgery is, describe some examples of common CSRF vulnerabilities, and explain how to prevent CSRF attacks.

## What is CSRF?

Cross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform. It allows an attacker to partly circumvent the same origin policy, which is designed to prevent different websites from interfering with each other.

![CSRF](/web-security/images/cross-site%20request%20forgery.svg)
#### Labs

If you're already familiar with the basic concepts behind CSRF vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.

* [View all CSRF labs](/web-security/all-labs#cross-site-request-forgery-csrf)
## What is the impact of a CSRF attack?

In a successful CSRF attack, the attacker causes the victim user to carry out an action unintentionally. For example, this might be to change the email address on their account, to change their password, or to make a funds transfer. Depending on the nature of the action, the attacker might be able to gain full control over the user's account. If the compromised user has a privileged role within the application, then the attacker might be able to take full control of all the application's data and functionality.

## How does CSRF work?

For a CSRF attack to be possible, three key conditions must be in place:

* **A relevant action.** There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user's own password).
* **Cookie-based session handling.** Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests.
* **No unpredictable request parameters.** The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password.

For example, suppose an application contains a function that lets the user change the email address on their account. When a user performs this action, they make an HTTP request like the following:

`POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE
email=wiener@normal-user.com`

This meets the conditions required for CSRF:

* The action of changing the email address on a user's account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user's account.
* The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.
* The attacker can easily determine the values of the request parameters that are needed to perform the action.

With these conditions in place, the attacker can construct a web page containing the following HTML:

`<html>
<body>
<form action="https://vulnerable-website.com/email/change" method="POST">
<input type="hidden" name="email" value="pwned@evil-user.net" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>`

If a victim user visits the attacker's web page, the following will happen:

* The attacker's page will trigger an HTTP request to the vulnerable website.
* If the user is logged in to the vulnerable website, their browser will automatically include their session cookie in the request (assuming [SameSite cookies](/web-security/csrf#common-defences-against-csrf) are not being used).
* The vulnerable website will process the request in the normal way, treat it as having been made by the victim user, and change their email address.

#### Note

Although CSRF is normally described in relation to cookie-based session handling, it also arises in other contexts where the application automatically adds some user credentials to requests, such as HTTP Basic authentication and certificate-based authentication.

## How to construct a CSRF attack

Manually creating the HTML needed for a CSRF exploit can be cumbersome, particularly where the desired request contains a large number of parameters, or there are other quirks in the request. The easiest way to construct a CSRF exploit is using the [CSRF PoC generator](/burp/documentation/desktop/tools/engagement-tools/generate-csrf-poc) that is built in to Burp Suite Professional:

* Select a request anywhere in Burp Suite Professional that you want to test or exploit.
* From the right-click context menu, select Engagement tools / Generate CSRF PoC.
* Burp Suite will generate some HTML that will trigger the selected request (minus cookies, which will be added automatically by the victim's browser).
* You can tweak various options in the CSRF PoC generator to fine-tune aspects of the attack. You might need to do this in some unusual situations to deal with quirky features of requests.
* Copy the generated HTML into a web page, view it in a browser that is logged in to the vulnerable website, and test whether the intended request is issued successfully and the desired action occurs.

LAB
APPRENTICE
[CSRF vulnerability with no defenses](/web-security/csrf/lab-no-defenses)

## How to deliver a CSRF exploit

The delivery mechanisms for cross-site request forgery attacks are essentially the same as for reflected XSS. Typically, the attacker will place the malicious HTML onto a website that they control, and then induce victims to visit that website. This might be done by feeding the user a link to the website, via an email or social media message. Or if the attack is placed into a popular website (for example, in a user comment), they might just wait for users to visit the website.

Note that some simple CSRF exploits employ the GET method and can be fully self-contained with a single URL on the vulnerable website. In this situation, the attacker may not need to employ an external site, and can directly feed victims a malicious URL on the vulnerable domain. In the preceding example, if the request to change email address can be performed with the GET method, then a self-contained attack would look like this:

`<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">`
#### Read more

* [XSS vs CSRF](/web-security/csrf/xss-vs-csrf)
## Common defences against CSRF

Nowadays, successfully finding and exploiting CSRF vulnerabilities often involves bypassing anti-CSRF measures deployed by the target website, the victim's browser, or both. The most common defenses you'll encounter are as follows:

* **CSRF tokens** - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim.
* **SameSite cookies** - SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. As requests to perform sensitive actions typically require an authenticated session cookie, the appropriate SameSite restrictions may prevent an attacker from triggering these actions cross-site. Since 2021, Chrome enforces `Lax` SameSite restrictions by default. As this is the proposed standard, we expect other major browsers to adopt this behavior in future.
* **Referer-based validation** - Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This is generally less effective than CSRF token validation.

For a more detailed description of each of these defenses, as well as how they can potentially be bypassed, check out the following materials. These include interactive labs that let you practice what you've learned on realistic, deliberately vulnerable targets.

#### Read more

* [LABS Bypassing CSRF token validation](/web-security/csrf/bypassing-token-validation)
* [LABS Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)
* [LABS Bypassing Referer-based CSRF defenses](/web-security/csrf/bypassing-referer-based-defenses)

For details on how to properly implement these defenses in order to prevent some of these issues on your own websites, see [How to prevent CSRF vulnerabilities](/web-security/csrf/preventing)

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fcsrf)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find CSRF vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from www.youtube.com_d9657277_20250121_031454.html ===
[00:00] all right so today we're going to be
[00:02] talking about cross-site request forgery
[00:05] which is a security specific or security
[00:09] related topic oh and it's sometimes
[00:13] called by the way it goes by a lot of
[00:15] names so you'll see CSRF xsrf sometimes
[00:18] people put on sassy surf session writing
[00:21] there's a few others so just be aware
[00:23] but this is the kind of the official
[00:25] name for it so why should we learn this
[00:28] or be aware of it
[00:29] Oh wasp is a international organization
[00:34] which basically tries to provide
[00:37] security guidelines for developers
[00:39] around the world and every few years
[00:41] they publish basically like a top ten
[00:43] security concerns the 2017 one was
[00:46] actually supposed to be approved I think
[00:47] one month ago or so so and I think this
[00:50] is actually a draft but it should be
[00:51] approved very soon they had one in 2013
[00:53] that was pretty similar a couple things
[00:55] shuffled around but for the most part
[00:57] you'll see that we have some pretty
[00:59] common security exploits or potential
[01:03] vectors that attackers can use against
[01:06] developers that have been with us for
[01:07] some time now so there's three that are
[01:09] pretty well-known which are sequel
[01:10] injection or injection generally which
[01:13] is actual number one on here cross-site
[01:14] scripting or XSS which is number three
[01:16] and then cross-site request forgery does
[01:19] come in at eight here so it's definitely
[01:22] not an important one but also it doesn't
[01:25] seem to be very well known or at least
[01:27] well understood by developers so most
[01:30] developers have maybe heard of it but
[01:32] they tend to be a little more familiar
[01:32] with the inner workings of cross-site
[01:36] scripting and injection but not as much
[01:38] about cross-site request forgery there
[01:39] seems to be a lot of confusion about it
[01:42] and then lastly it's has affected a lot
[01:45] of companies and applications it's
[01:48] actually also an interesting attack in
[01:49] the sense that it's very likely that
[01:51] it's highly highly underreported because
[01:54] the as we'll see when we get a little
[01:56] further in the discussion the attack
[01:58] looks very authentic and it really does
[02:00] look like it originates from the user so
[02:02] it has the users IP address as well as a
[02:05] lot of other information like their
[02:06] cookie and so it's it's pretty nuanced
[02:09] sometimes to distinguish between a
[02:11] legitimate request
[02:13] a false one or a forged one which is
[02:15] actually why this is security exploit to
[02:17] begin with but you can see on there it's
[02:19] affected Netflix YouTube Mew torrent ING
[02:22] Direct this is just to name a few
[02:23] even Google also has been a slightly
[02:26] different kind of specific version
[02:29] called log and CSRF we probably not have
[02:31] time to cover that today but certainly
[02:33] there have been many people impacted by
[02:35] it so quick example what exactly would
[02:38] this look like this is a very basic and
[02:42] simple example there's actually two
[02:43] quick versions here so the first one is
[02:45] a get request so we're going to send
[02:49] basically a get request to some banks
[02:51] website and you can see there's some
[02:53] query strings or parameters on the end
[02:57] of that you are elder and basically we
[03:00] are trying to fraudulently move some
[03:03] money from one person's account to
[03:05] another person's account and if this
[03:09] website was vulnerable to CSRF all that
[03:12] you would need to do is manage a site
[03:14] that you could get someone to visit some
[03:16] type of malicious web site that has this
[03:19] a tag or link on it that tag if the
[03:24] person were to click that link would
[03:26] then send that get request to the bank
[03:28] and because it's the user who's actually
[03:33] doing the clicking it's actually coming
[03:35] from their computer and their cookies
[03:36] also stored on their computer so the
[03:38] website actually gets confused and think
[03:40] this is legitimate claim from the user
[03:41] and then you're out ten thousand or how
[03:44] many dollars so pretty dangerous and
[03:46] then the second version is oh and in
[03:50] addition to an a check by the way you
[03:51] could use an image tag so either one of
[03:53] those would work for post it gets
[03:54] slightly more complicated but it's
[03:56] definitely still possible to do instead
[03:59] of an image or a tag you'd have to use
[04:01] something like a form but you could of
[04:03] course hide the form and put the action
[04:05] as the target URL and then again embed
[04:09] some of those parameters in the input
[04:11] and then also the user actually wouldn't
[04:14] even have to hit the submit on your kind
[04:16] of fake form on your website because you
[04:18] could on the loading of the website you
[04:20] may be able to run a script which
[04:22] submits the form as soon as the person
[04:24] comes to your what website so pretty
[04:27] pretty
[04:27] scary stuff a quick definition from a
[04:30] wasp again basically it's an attack that
[04:33] it makes an end-user execute some type
[04:35] of action that they didn't mean to do it
[04:36] wasn't supposed to be authenticated by
[04:38] them but because of some trickery that's
[04:40] going on maybe a help of a little social
[04:42] engineering like sending someone a
[04:44] message with like a link that goes to
[04:46] some malicious web site that's typically
[04:48] how something like this can happen so
[04:51] some more specific details the type of
[04:53] the attack is called the confused deputy
[04:54] deputy it's all that means is that's
[04:57] kind of a broad class of attacks where a
[05:01] confused deputy which in this case would
[05:03] be the browser mistakes someone for
[05:06] basically someone else or something else
[05:08] and grants them privileges that they
[05:11] shouldn't have so it's actually kind of
[05:12] a specific type of privilege escalation
[05:15] and the way the way this bug works
[05:19] you're the reason it exists that I
[05:21] should say is that it basically hijacks
[05:24] the inherent browser functionality of
[05:25] automatically sending cookies to any
[05:27] domain that you currently have an active
[05:29] cookie for and also some aspects of HTTP
[05:32] specification regarding cross-origin
[05:34] requests so here's a really quick
[05:38] diagram that I got from a great blog
[05:40] post I can provide that at the end as
[05:42] well but basically this is how it would
[05:44] look
[05:45] you go to an attackers website and they
[05:48] serve you up some type of HTML and then
[05:51] in that HTML in the background it's
[05:53] hidden from the user but it actually
[05:55] sends a request has your computer sent a
[05:58] request to some other site they think
[05:59] you might happen to be logged in at
[06:01] right now
[06:01] they'll just guess so maybe a bank or
[06:03] Facebook or whatever some some website
[06:05] and your cookie will your browser will
[06:07] just say ok we're sending requested this
[06:09] domain so send along our cookie as well
[06:11] and then this is how you kind of get
[06:13] this attack to work it should be pointed
[06:16] out and I think this is kind of a point
[06:17] of a confusion that the attacker doesn't
[06:18] see the response data so it's only used
[06:22] for state changing requests and not
[06:23] reading of your information so they
[06:25] might like update your mailing address
[06:27] or they may be able to like update your
[06:30] password or do all kinds of things but
[06:32] they can't just read the information
[06:34] typically from that's coming back but
[06:37] that being said and I'll touch on this
[06:38] again at the end that's actually not
[06:40] true if your site has
[06:41] any single vulnerability at that domain
[06:43] of an XSS type so yeah again very you
[06:48] got to be very careful to watch out for
[06:49] multiple security flaws and not just the
[06:52] srf so how do we get here of course we
[06:55] want users to be able to log in and to
[06:58] do that they provide a username and
[06:59] password typically they can also provide
[07:01] a token in some instances but let's say
[07:03] username and password we of course don't
[07:04] want the user to have to supplied it on
[07:06] every page we need to kind of remember
[07:08] for some amount of time let's say 10 15
[07:10] minutes however long they're using our
[07:11] site that they're currently
[07:13] authenticated and logged in as the
[07:15] person who we just saw visit our site
[07:18] because HTTP works in a very stateless
[07:21] way so the the client and server don't
[07:24] have a consistent knowledge of what's
[07:27] going on it's kind of just like a
[07:28] pinging of messages back and forth so
[07:32] obviously many web sites want to use
[07:33] this type of login functionality so
[07:35] cookies were kind of invented or one of
[07:38] the reasons they're commonly used is for
[07:40] this functionalities to basically put
[07:42] like session information on a cookie
[07:45] another reason is relaxed origin
[07:48] policies so there is somewhat newer
[07:51] specification called cores or
[07:52] cross-origin resource sharing I believe
[07:59] it is but basically that helps govern
[08:04] XML HTTP requests which are across
[08:07] origin nature because traditionally
[08:09] those were governed by same origin
[08:11] meaning you weren't allowed to use an
[08:13] AJAX or fetch request to another origin
[08:16] if it wasn't your own so persistent
[08:21] authentication was a problem just
[08:22] referring to how kind of how do we go
[08:24] about solving that problem right so
[08:26] there's basically you have one of two
[08:29] options the first of which is kind of
[08:31] the classic or more traditional approach
[08:33] maybe which is you store some kind of
[08:35] and of course by the way a lot of these
[08:36] values are encrypted and hashed and so
[08:38] on so I'm not even covering that we
[08:39] don't have time to discuss all of that
[08:41] but the session ID that you create for
[08:44] this user can be stored on a server and
[08:48] so when the when a user comes to your
[08:50] website they send you their username and
[08:51] password you send them this session ID
[08:54] back
[08:55] and then and you tell their browser to
[08:57] set that in a cookie so now your browser
[08:59] has this cookie information with your
[09:01] session ID and now every time your
[09:02] browser goes to that site it's and if it
[09:04] has a cookie for it it will send a
[09:06] cookie along with all of its following
[09:07] or subsequent subsequent requests this
[09:12] is definitely one approach you can use
[09:14] you'll typically want to use a flag on
[09:17] the cookie called HTTP only that
[09:19] prevents the frontside code from reading
[09:24] or writing to that cookie header
[09:25] information so it's not able to access
[09:29] or kind of play with that session ID
[09:31] information and so it's not vulnerable
[09:34] to cross-site scripting attacks but it
[09:36] would still be vulnerable to cross-site
[09:38] request forgery which so we're
[09:39] discussing today the other option you
[09:41] have is to store session information on
[09:43] the client-side that has some pros and
[09:45] constitute as well that is actually no
[09:47] longer subject or acceptable to
[09:51] cross-site request forgery so I should
[09:53] clarify that CSRF is specific to cookies
[09:55] so if you're not using cookies to create
[09:58] a session or authenticate your user then
[10:00] actually you don't need as far as I'm
[10:03] aware to be concerned as much with CSRF
[10:06] but you the downside is you are so
[10:08] vulnerable now to XSS which means if you
[10:10] have any cross-site scripting
[10:11] vulnerabilities and attack or may be
[10:14] able to see a user session information
[10:17] in the browser so really quick some
[10:21] inadequate mitigation strategies that
[10:22] people have thought up in the past first
[10:24] one is referer header x' so sometimes
[10:26] people will think oh well this request
[10:28] is coming from the users computer but we
[10:30] can still see that it's this malicious
[10:32] website that's reaching out to us for
[10:34] this for requesting some source an image
[10:36] or a script or whatever it happens to be
[10:38] so let's check where this is being
[10:39] referred from the problem with that is
[10:41] there's actually not a very consistent
[10:42] implementation of refers a lot of
[10:44] browsers or proxies will just strip away
[10:46] refer information for privacy reasons so
[10:49] it's not something you can consistently
[10:51] rely upon that it will be there you're
[10:53] gonna get a lot of false positives in
[10:54] other words if you try to enforce that
[10:55] another one is HTTP verbs as we saw even
[10:59] though if your site allows get requests
[11:03] that are that are not idempotent that's
[11:08] obviously very
[11:09] bad design and makes you a little more
[11:10] vulnerable to this but even if you make
[11:12] sure all your requests that are item
[11:14] potent are posts you are still
[11:16] vulnerable to CSRF because again someone
[11:19] could use a form instead of an image
[11:20] resource to kind of attack the website
[11:24] and lastly URL rewriting would be
[11:27] putting the session ID in the URL that
[11:31] technically may be safe in certain
[11:33] situations but it's generally frowned
[11:35] upon because of course if that URL gets
[11:37] exposed in any way kind of in transit
[11:39] somehow or in some other manner their
[11:42] information would be compromised so what
[11:44] are actual legitimate mitigation
[11:46] strategies for CSRF one is real
[11:49] authentic ation so that one is basically
[11:51] just proved to me again that you're
[11:53] actually who you say you are we one of
[11:54] the early things I said was it would be
[11:56] annoying to user to have to submit user
[11:58] name and password at every single screen
[11:59] that's true but if they're doing
[12:01] something that's pretty dangerous or has
[12:03] a really big impact like I'm trying to
[12:05] transfer money out of my account or I'm
[12:07] trying to delete my account or something
[12:09] high level like that it wouldn't be as
[12:12] big of a nuisance on those types of
[12:13] requests to say you know what go ahead
[12:15] and enter your username and password
[12:16] again now or as long as it's when we
[12:20] again de nuff time to go into the
[12:21] details of this but if it's securely
[12:22] done you can do something like a CAPTCHA
[12:24] which is also a little bit harder for an
[12:27] attacker to request since they're not
[12:28] using that user's browser but probably
[12:33] the go-to method is actually to make
[12:35] unique form tokens so any form or link
[12:38] you have on your site you should have
[12:39] also these uniquely generated tokens
[12:42] that actually need to be sent it's maybe
[12:45] a little annoying to keep track of
[12:46] everything and implement but maybe sent
[12:47] on every post put or delete request and
[12:50] then you include that token in both the
[12:52] cookie header and the body of the
[12:54] message so that even if an attacker it
[12:57] can act as an imposter and has your
[12:59] cookie in the headers they will not be
[13:02] able to access the code that was running
[13:04] in the browser at the time so again
[13:06] unless you have an XSS vulnerability but
[13:09] assuming that's not the case they will
[13:11] not be able to read that secret token
[13:14] that was a value on some form let's say
[13:16] so they won't be able to impersonate you
[13:18] anymore and then you'll be able to get
[13:20] around CSRF
[13:21] lastly I would say just know your
[13:23] libraries so of course you know we're
[13:26] we're gonna use all kinds of libraries
[13:27] and frameworks as well to set websites
[13:31] up so there and Oh many of them we need
[13:35] to work with node Express and sessions
[13:37] and so on passport there's many of them
[13:39] out there but just definitely read the
[13:41] documentation and be aware of what the
[13:43] library is handling for you and what
[13:45] it's not because if it's not howling
[13:46] CSRF for you and you're not thinking
[13:48] about it then there's a very good chance
[13:50] that you could be vulnerable okay are
[13:54] there any questions
[13:56] awesome thanks so much for listening
[13:57] guys
[13:58] [Applause]
