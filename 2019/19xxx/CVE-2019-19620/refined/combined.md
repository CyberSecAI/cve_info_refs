=== Content from medium.com_9bbc9370_20250120_235206.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbfaed2be407e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40SteveJBecker%2Fsecureworks-red-cloak-local-bypass-bfaed2be407e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40SteveJBecker%2Fsecureworks-red-cloak-local-bypass-bfaed2be407e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# SecureWorks Red Cloak Local Bypass (CVE-2019–19620)

[![Steve Becker](https://miro.medium.com/v2/resize:fill:88:88/1*7W5AIl6elCifa7mKgF2_Xg.jpeg)](/%40SteveJBecker?source=post_page---byline--bfaed2be407e--------------------------------)

[Steve Becker](/%40SteveJBecker?source=post_page---byline--bfaed2be407e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbb4a342064ec&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40SteveJBecker%2Fsecureworks-red-cloak-local-bypass-bfaed2be407e&user=Steve+Becker&userId=bb4a342064ec&source=post_page-bb4a342064ec--byline--bfaed2be407e---------------------post_header-----------)

4 min read·Dec 5, 2019

--

1

Listen

Share

At the time of discovery, my (then) employer was using a suite of SecureWorks services, with a product called [Red Cloak](https://www.secureworks.com/products/red-cloak-tdr) being a core component. In short, Red Cloak is used to outsource the huge task of endpoint detection to a 24x7, high standard of quality Security Operations Center.

In August of 2019, after going some time without any alerts from Red Cloak, we wanted to double check that it was actually doing anything. I downloaded the [Mimikatz](https://github.com/gentilkiwi/mimikatz) binary without any modifications to a unique folder on the local C:\ drive of a testing endpoint. I allow-listed this folder in the other security products in the environment and removed all permissions to the folder except for my testing account, to ensure that a potential attacker could not use my tools against me. Then, I ran Mimikatz successfully — and did not receive any alerts from Red Cloak. Uh oh, what happened?

I opened a support ticket to review and we started looking at various log files. When we execute the standard ‘Red Cloak Test’ methodology, alerts were fired off no problem. We found the following screenshots in the log files that explained what was happening.

![]()

Above shows a specific module in the Red Cloak agent saying that it sees the event created for launching Chrome, and successfully ends up writing some sort of log file in the folder directory for the image launched.

![]()

Above shows the error that happened when I had removed all permissions except for my own user account. Creating the log file in the folder structure failed because the system account Red Cloak was using couldn’t write to that folder. This caused a logical bypass to happen; since this little step of the overall telemetry process failed, no alerts were made and no record of Mimikatz being executed appeared in the Red Cloak portal, only in the local log file. Which, of course, an attacker than can already modify a malicious file permission would be able to modify as well. After putting system permissions back to default, this is what happened next, and an alert was fired off:

![]()

An additional issue was discovered that to see the above log files you must have enabled verbose logging, which required a system restart to take affect. In short there, if you did not have verbose logging enabled in advance, even the local log files would not indicate an attempt to execute malicious files — or really any file with system permissions removed!

Secure Works immediately acknowledged the bug and agreed to a 90-day target fix, and requested a delay in publication until customers could update. As I understand the fix, modules are now independent of each other — if this module fails, the other modules still report and alert on activity. Essentially, this was a logic flaw in the agent’s workflow. They were mostly good about communication in regards to the fix process, but have seemed to downplay the potential severity of this bug. I do agree with the Secure Works stance that because local access is required, the potential for exploit is low. However, if you’re using Red Cloak in an environment that may be targeted by true advanced, persistent threats this could cause a high impact in those more specific situations. Considering the portrayed client base of Secure Works, this downplaying of impact is worrisome to me. (Edit: for full disclosure, the SecureWorks Counter Threat Unit sent me a numbered challenge coin as a thank you. While that is cool and appreciated, there was no bug bounty awarded, etc.)

It is not currently known what version this logic bug was introduce in, or if it existed from the start of the Red Cloak product line. However, as of Windows Agent 2.0.7.9 it is confirmed to be corrected. This agent version also allowed logging level changes without restarting. Agent 2.0.7.9 was released October 29th, in advance of the industry-accepted 90 day window. I requested a CVE for this issue to help push public awareness, in addition to this blog post, but I am frankly not sure if this meets the criteria for a CVE. \*Update: CVE-2019–19620 was assigned for this issue.\*

# So now for the tl;dr

Trivial local bypass of Secure Works Red Cloak telemetry discovered August 2019. Impact is not considered high, due to local access requirement.
Bypass occurred whenever SYSTEM permission is removed from a file or directory.
Fixed agent version released October 29th, 2019.
Blog publication and CVE request December 5th, 2019.
UPDATE: CVE-2019–19620 is assigned for this issue.
UPDATE 2: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19620> released December 6th, 2019.

![Red Cloak Agent Bypassed!]()[Security](/tag/security?source=post_page-----bfaed2be407e--------------------------------)[Secureworks](/tag/secureworks?source=post_page-----bfaed2be407e--------------------------------)[Information Security](/tag/information-security?source=post_page-----bfaed2be407e--------------------------------)[Public Discourse](/tag/public-discourse?source=post_page-----bfaed2be407e--------------------------------)[Responsible Disclosure](/tag/responsible-disclosure?source=post_page-----bfaed2be407e--------------------------------)

--

--

1

[![Steve Becker](https://miro.medium.com/v2/resize:fill:96:96/1*7W5AIl6elCifa7mKgF2_Xg.jpeg)](/%40SteveJBecker?source=post_page---post_author_info--bfaed2be407e--------------------------------)[![Steve Becker](https://miro.medium.com/v2/resize:fill:128:128/1*7W5AIl6elCifa7mKgF2_Xg.jpeg)](/%40SteveJBecker?source=post_page---post_author_info--bfaed2be407e--------------------------------)Follow[## Written by Steve Becker](/%40SteveJBecker?source=post_page---post_author_info--bfaed2be407e--------------------------------)[7 Followers](/%40SteveJBecker/followers?source=post_page---post_author_info--bfaed2be407e--------------------------------)·[2 Following](/%40SteveJBecker/following?source=post_page---post_author_info--bfaed2be407e--------------------------------)

Dad, CISSP/CISM/CISA, accused SME, wannabe foodie, wine, hockey, golf, music, travels. Available for InfoSec/IT career advice and resume review. He/him.

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----bfaed2be407e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----bfaed2be407e--------------------------------)[About](/about?autoplay=1&source=post_page-----bfaed2be407e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----bfaed2be407e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----bfaed2be407e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----bfaed2be407e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bfaed2be407e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bfaed2be407e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----bfaed2be407e--------------------------------)[Teams](/business?source=post_page-----bfaed2be407e--------------------------------)


