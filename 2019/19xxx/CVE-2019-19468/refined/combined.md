=== Content from code610.blogspot.com_959e7ba7_20250121_005823.html ===


# [code16](https://code610.blogspot.com/)

## Strony

* [Strona główna](https://code610.blogspot.com/)
* [Mini arts](https://code610.blogspot.com/p/mini-arts.html)
* [Notes Magazine](https://code610.blogspot.com/p/notes-magazine.html)
* [Found bugs](https://code610.blogspot.com/p/found.html)
* [CTFs](https://code610.blogspot.com/p/ctfs.html)
* [Contact](https://code610.blogspot.com/p/contact.html)

## piątek, 29 listopada 2019

### From 0 to 0day - quick fuzzing lesson

In most time the question(s) you're asking me [via blog](https://code610.blogspot.com/p/contact.html) or [twitter](https://twitter.com/CodySixteen) is: "how to prepare a fuzzing lab" or "how to perform an analysis of the crash we found". I decided to spent last few days for preparing a small example for you to give you the answer(s) for both of the questions. Below you will find the details. Here we go...

We will start here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhH2PvHS0pRX_CGC2v1FRNOndwbtYHI3AgBEcqTNrV_rNe5LAWQJzBJK7ehp9h7BvAmxEeC6yXKI7GyD3baWL59MxBrGHBlC4XD8zMv_Wbc_hIzoigGArQslPLhC2QAMUZv9KOC4wMpxRc/s400/01.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhH2PvHS0pRX_CGC2v1FRNOndwbtYHI3AgBEcqTNrV_rNe5LAWQJzBJK7ehp9h7BvAmxEeC6yXKI7GyD3baWL59MxBrGHBlC4XD8zMv_Wbc_hIzoigGArQslPLhC2QAMUZv9KOC4wMpxRc/s1600/01.jpg)

As you can see I started the fuzzer against the application called *Free Photo Viewer.* As far as I remember I found it [here](https://download.cnet.com/Free-Photo-Viewer/3000-18488_4-10808200.html). But first things first...

**PREPARING THE LAB:**

Depends on what you would like to do (/"fuzz") ;)

In case of webapps or web servers - sometimes I'm using [Burp Suite](https://portswigger.net/) [[1](https://code610.blogspot.com/2016/10/http-server-fuzzing-with-burp.html), [2](https://code610.blogspot.com/2019/09/crashing-fortigate-vm-621-httpd.html)]. But for [cases similar to the one we have here](https://code610.blogspot.com/p/found.html) (FreePhotoViewer) I will recommend you to install:

- clean Windows 7 (I used 32bit)

- [Immunity Debugger](https://www.immunityinc.com/products/debugger/)

- [mona.py](https://github.com/corelan/mona) from [Corelan Repository](https://github.com/corelan/)

- [HxD](https://download.cnet.com/HxD-Hex-Editor/3000-2352_4-10891068.html) (but you can use any hex editor you like)

- target app (in our case - FreePhotoViewer)

- [FOE2](https://vuls.cert.org/confluence/display/tools/FOE%2B2.1%2BWindows%2BReadme) - "Failure Observation Engine".

Installation of FOE2 should be easy but remember to read the funky manual anyway! ;)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8ZcYfQsFoN5wbhbKE6Ze6Q4Ye1mYzKRRakJF59mZi2FDYfnQaAX2bE8LS4WfaxtHdpi6fMICtbdY8IKEUAgtwuGRHw6qhhsBphaLE5OP97Brf8Wy61oIbatRLS6tmAsWxoyqNsICbEZk/s400/02.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8ZcYfQsFoN5wbhbKE6Ze6Q4Ye1mYzKRRakJF59mZi2FDYfnQaAX2bE8LS4WfaxtHdpi6fMICtbdY8IKEUAgtwuGRHw6qhhsBphaLE5OP97Brf8Wy61oIbatRLS6tmAsWxoyqNsICbEZk/s1600/02.jpg)

For example: you will find the place to edit in the source code to get some more detailed results:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj-n4jeMpKAzX7BtAm6KUyXUzR0rnIsiT-0CWqeGiecwnwu9eW6KvcrKvczc5c50wwhZxm5vXoW-Zw1be2ncyUv-dfPd1iN9z6LLaQFsP_Ge1xTEYVvOOvmSXXpeRu2qMZlk-UFicSPqKY/s400/03.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj-n4jeMpKAzX7BtAm6KUyXUzR0rnIsiT-0CWqeGiecwnwu9eW6KvcrKvczc5c50wwhZxm5vXoW-Zw1be2ncyUv-dfPd1iN9z6LLaQFsP_Ge1xTEYVvOOvmSXXpeRu2qMZlk-UFicSPqKY/s1600/03.jpg)

As you can see (red frame - cdb\_command): here you can put your favourite (Windbg) commands.

I like to add there also: *u eip-1; u eip; kb* and other similar commands. ;)

I assume that your VM LAB is prepared and FreePhotoViewer is installed. So it's time to prepare a config for the FOE2 fuzzer.

**FUZZING TARGET APP:**

Installed (target) app is located in "C:\Program Files\Free Photo Viewer":

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1BpYMiXjRKGp2oI1bOmCSBhg32ZN6pmX2hLaIYmG3X2t9ewaTS3ECgbeDF8VYoIcl1B9KIPMeNXVMQkh3alh2HYdJXUIZGXiXSDmkNWpK9s1FwVqXSKBDMqAbp8K7viephqrvaFRHy5k/s400/04.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1BpYMiXjRKGp2oI1bOmCSBhg32ZN6pmX2hLaIYmG3X2t9ewaTS3ECgbeDF8VYoIcl1B9KIPMeNXVMQkh3alh2HYdJXUIZGXiXSDmkNWpK9s1FwVqXSKBDMqAbp8K7viephqrvaFRHy5k/s1600/04.jpg)

We will need it soon.  Foe2 default installation directory is c:\FOE2\. There you will find config, seeds and results:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrsGFceHytowycTuYtmbuzQa7JDSDDcZoIJ8HKlUK6TqqObseUC_OtSe_wjokDWLXSVuiISZz3K3dCex2fknjEvWBiTD8E-q0FnFsxrX7b0k8oqmIJRcxiI0bb7mv3VWRFkYlMkUsS_5U/s400/05.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrsGFceHytowycTuYtmbuzQa7JDSDDcZoIJ8HKlUK6TqqObseUC_OtSe_wjokDWLXSVuiISZz3K3dCex2fknjEvWBiTD8E-q0FnFsxrX7b0k8oqmIJRcxiI0bb7mv3VWRFkYlMkUsS_5U/s1600/05.jpg)

Let's copy default config file (foe.yaml) to 01-freephotoviewer.yaml. Next open it and edit like it is presented on the screens below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsfz3XjBSUhb76N8c1ia3oSCWnZH-SmIvK3AREjJMgXAktI-09lKFTwhuMz9a_chYGYMhZVZeJBVLPEcwXFUP6_eEinBZzm_DBna94wIJUmW9Abn-_CBWUMJ9pIZeKDP4VtSUBJsEBJp8/s400/06.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsfz3XjBSUhb76N8c1ia3oSCWnZH-SmIvK3AREjJMgXAktI-09lKFTwhuMz9a_chYGYMhZVZeJBVLPEcwXFUP6_eEinBZzm_DBna94wIJUmW9Abn-_CBWUMJ9pIZeKDP4VtSUBJsEBJp8/s1600/06.jpg)

As you can see we are changing the name of our 'fuzzing campaign'. Next (red frame) is to place a full path to the target we want to fuzz. 3rd red frame - I just deleted NUL because we will not use any other argument.

Next thing to check in the config - location of our files. In default FOE will store all files (seeds, results) in C:\FOE2\ directory. Edit the location (path) of your 'sample' (seed) file(s):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBmZzZSF_OBRq34FLBz3tpXEwWsOSRVfxKbKbX46rGMSd_C-9j0VM8mPEfHgaprdZljb5HCiO5ozTSTJfupxxGpbXlW-Kh0Q-QV19p8Eh4h12vFkgIUjMGRxjphGKF9U6oz0E3joTwLHE/s400/07.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBmZzZSF_OBRq34FLBz3tpXEwWsOSRVfxKbKbX46rGMSd_C-9j0VM8mPEfHgaprdZljb5HCiO5ozTSTJfupxxGpbXlW-Kh0Q-QV19p8Eh4h12vFkgIUjMGRxjphGKF9U6oz0E3joTwLHE/s1600/07.jpg)

Next thing nice to check in the config is called 'Fuzzer options'. We will not discuss it today (to keep it simple;)) but you should definitely try to play the options available:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnS12ISD7RS3fza7aXa2l4RChVc4ZKIanIQPFlAuEOxX8zbiImtfkhTj3bQtnHQziBLLjwI58wiffdGk8AtNbNTRaCUGb4F_46DYWuL84UVCqT-1reQ0VochcdHpq4rBX6oxT4dDDof0A/s400/08.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnS12ISD7RS3fza7aXa2l4RChVc4ZKIanIQPFlAuEOxX8zbiImtfkhTj3bQtnHQziBLLjwI58wiffdGk8AtNbNTRaCUGb4F_46DYWuL84UVCqT-1reQ0VochcdHpq4rBX6oxT4dDDof0A/s1600/08.jpg)

So config file is ready. Now it's time to prepare a sample file. :)

In c:\foe2\seedfiles\example\ you will find a lot of files to try with FOE2. I like to get 2 or 3 (or 8 ;)) and change it a little bit in HxD. In most cases - for example I will take BMP file - I will:

- leave one original BMP file

- take a copy of it and add (for example a lot of) AAAAAA...AAAA in the end of the file

- copy original file but only header (few first lines in HxD) and then I'm adding "a lot of A's" ;)

In this case from 1 sample seed file I will have a 3 files:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgS75ZPswM-dlmhNDayPZiVm7eVrWMnqzC9Pmhpu4TNxKCsE7oja-em-UnnYxh1mVWgC0oXkFEUlKyA49OnQ72eEeqymeAE_yfhdcSfhNKQKY_5akqfYzC5JhckGRjJSKB6jd9Nn5lDjQk/s400/10.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgS75ZPswM-dlmhNDayPZiVm7eVrWMnqzC9Pmhpu4TNxKCsE7oja-em-UnnYxh1mVWgC0oXkFEUlKyA49OnQ72eEeqymeAE_yfhdcSfhNKQKY_5akqfYzC5JhckGRjJSKB6jd9Nn5lDjQk/s1600/10.jpg)

Example file (roughly;)) changed:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhV0myWvdcDrLmWb1lia6N1x0MMgw-sHozi67aAWtwOvdpo6E6uyvf6ql7_XPw_I3VPS1FQD1MSA8zd_IO36Sn1HtGuOI9r9MX8TyJ6Loe06jtMcOC5IaHtTWKoQrMhjQ6Mjo6ebnXZje0/s400/11.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhV0myWvdcDrLmWb1lia6N1x0MMgw-sHozi67aAWtwOvdpo6E6uyvf6ql7_XPw_I3VPS1FQD1MSA8zd_IO36Sn1HtGuOI9r9MX8TyJ6Loe06jtMcOC5IaHtTWKoQrMhjQ6Mjo6ebnXZje0/s1600/11.jpg)

Save the seedfile(s and your config) and run FOE2 in cmd.exe, like this:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhsFrqtnlzWSLKd-IKs_4iCX19JE9ksUGLoA3TBGgGLKO9fkVKmWuDctFmt5NqETKevM2zB0BzxcJrgc764yS00Sqyd3N6JeT_RC_aD6xQZcME1-EaBZyP8sUp18AZl6Qm2uGsMGlWcqDM/s400/09.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhsFrqtnlzWSLKd-IKs_4iCX19JE9ksUGLoA3TBGgGLKO9fkVKmWuDctFmt5NqETKevM2zB0BzxcJrgc764yS00Sqyd3N6JeT_RC_aD6xQZcME1-EaBZyP8sUp18AZl6Qm2uGsMGlWcqDM/s1600/09.jpg)

**3 DAYS LATER:**

In usual it should take no longer than few hours to find 'first crash'. But for example for Outlook[[1](https://code610.blogspot.com/2017/08/microsoft-outlook-2016-writeav.html), [2](https://code610.blogspot.com/2017/08/microsoft-outlook-2010-write-av.html)] or Access[[3](https://code610.blogspot.com/2016/07/ms-access-2010-writeav-crash.html)] it took 2 months on my small laptop to finally crash the application. ;)

Anyway... after let's say "3 days"... "you found it! There is a crash!" ;] Cool but what to do next?

Of course "depends on the crash". ;) But for most Windows cases (read: as far as I saw so far) it will be: malformed heap, SEH overflow or Unicode (SEH) overflow. Let's try to identify "the one" from our target app:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjY6M_CaJkriUOiiEUmTtXpGgEnBkHXUeI1_wZnPgH7eFWhXGBfF3erKNhPz_bptS-diyVYtqeGW07ystJxYh0S2uuEHuicRz5Ftacis6wR0NWYJmX8FIiNQpNtU7eVkjwjDPHyTzfVEtw/s400/12.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjY6M_CaJkriUOiiEUmTtXpGgEnBkHXUeI1_wZnPgH7eFWhXGBfF3erKNhPz_bptS-diyVYtqeGW07ystJxYh0S2uuEHuicRz5Ftacis6wR0NWYJmX8FIiNQpNtU7eVkjwjDPHyTzfVEtw/s1600/12.jpg)

As you can see there are 'few' bugs to check... I believe you will have some fun. ;)

Now let's open our target app in ImmunityDbg. As an argument we will use the path to the poc-file generated by FOE2. We should be somewhere here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFfEDJQiVWUxZfDnkX3t9o_fp8Seahgf4A78FeGjl6CVFQUN7JsE4fI2IMFIk5uaJfBFbiNJl6IQmwh8-9qVS7c0hVZk9tRk2YbFpATKDg21yS3Gh_OaPsdn4Rfe6An6_2hZ-HJPZNAW4/s400/13.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFfEDJQiVWUxZfDnkX3t9o_fp8Seahgf4A78FeGjl6CVFQUN7JsE4fI2IMFIk5uaJfBFbiNJl6IQmwh8-9qVS7c0hVZk9tRk2YbFpATKDg21yS3Gh_OaPsdn4Rfe6An6_2hZ-HJPZNAW4/s1600/13.jpg)

As we can see SEH is malformed, so probably we will have to exploit SEH overflow bug. Cool. :)

I used HxD to open the poc file to (hopefully) see if there will be our value from SEH chain:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjH5LsGRXXgPNBQbbkTVOkE4oWC-XZ7ueyErj8Y8_BARpEK48wbDn7Aj5UvcwvkIdHDTwOuVlWRxzLee_BeNWyY4cJUo2vzBsPAye2zv2b_aU6ogCclFXWIOGlxgU69XfL0MPsw6piYA5w/s400/14.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjH5LsGRXXgPNBQbbkTVOkE4oWC-XZ7ueyErj8Y8_BARpEK48wbDn7Aj5UvcwvkIdHDTwOuVlWRxzLee_BeNWyY4cJUo2vzBsPAye2zv2b_aU6ogCclFXWIOGlxgU69XfL0MPsw6piYA5w/s1600/14.jpg)

Great! Next step: change nSEH, right?

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkuQMkBdxEkvpKLt0MohJFY97CMd2gWUlqIpoxvJJeXswsZo_GDAdRE2_PVpCeerBQ7o-drmGfBmOc6ggYQkLUmGYnl8BCg8vyhbU77z0Vc9QlgTPGYuaieFjtxXKeW9e-ThJVVnRZryE/s400/15.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkuQMkBdxEkvpKLt0MohJFY97CMd2gWUlqIpoxvJJeXswsZo_GDAdRE2_PVpCeerBQ7o-drmGfBmOc6ggYQkLUmGYnl8BCg8vyhbU77z0Vc9QlgTPGYuaieFjtxXKeW9e-ThJVVnRZryE/s1600/15.jpg)

So far, so good. ;) Next I used *mona.py* to get POP, POP, RET:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLVVvw1uXrvs3aGCVUynhCnKmzUlou0o0uz_wcLszLklQWwoL6SR872d12iBvfPdH-abxKSwqlbkmaPso7ez73sRlUbvfD1abGJltPmtcgxBtFB5T9c9CgU_qYiYgrHnnEh6lvvH8hhy0/s400/16.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLVVvw1uXrvs3aGCVUynhCnKmzUlou0o0uz_wcLszLklQWwoL6SR872d12iBvfPdH-abxKSwqlbkmaPso7ez73sRlUbvfD1abGJltPmtcgxBtFB5T9c9CgU_qYiYgrHnnEh6lvvH8hhy0/s1600/16.jpg)

Next I restarted the target app and after initial run (F7) I added a breakpoint on the location found with "!mona seh" (ppr), for example:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbFnEbBVusv48bsg6hNcHEm3p-fnjvmKDAioaufPaK0ggi1ysxgkuiE3H_QHFqkik0BMtH0Fk-E8L6NtX9nvfdiBn_EK94F7KgU2k-8muOX8trrLIRC-KK5gAf6ZXGNExrxK_elvXZDMo/s400/17.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbFnEbBVusv48bsg6hNcHEm3p-fnjvmKDAioaufPaK0ggi1ysxgkuiE3H_QHFqkik0BMtH0Fk-E8L6NtX9nvfdiBn_EK94F7KgU2k-8muOX8trrLIRC-KK5gAf6ZXGNExrxK_elvXZDMo/s1600/17.jpg)

(After the jump to ppr value asm will change, so don't worry ;))

This was a time when the 'tricky part' started. I was sure it is 'easy overflow' and I need to change the 'poc file' simply by adding more AAAA letters... Well, nope. ;] If I added new letters - file structure was changed. :|

So the only way was to create a 'valid shellcode' with 39 characters. :)

First of all I tried to use some MsgBox shellcodes I found online but almost all of them were 'bigger than 39characters', so I failed again.

Next day ;) I realized that one time during some private talk mzer0 and [@M4tisec](https://twitter.com/M4tisec) already told me what can I do to exploit bug(s) like this one.

TL;DR: We will create a small shellcode ;] to:

- put calc.exe in memory

- run it using [WinExec](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-winexec)

Simple enough? "[We gotta try](https://www.youtube.com/watch?v=Fsi3g0Iv31A&t=933s)":

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEionKeoqytatWI_NRib15LY6MycAD1R8nOv4KpCLbSpi2UoEhyToxQhxFM6ebBSe3uR1Pj7qU23ioZGVbSF_rZTbcxxcMFBa_EmlLaNi8lfGoQNKHfm_EBK6b8I7IzRAOiLBq9_0crW-9w/s400/18.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEionKeoqytatWI_NRib15LY6MycAD1R8nOv4KpCLbSpi2UoEhyToxQhxFM6ebBSe3uR1Pj7qU23ioZGVbSF_rZTbcxxcMFBa_EmlLaNi8lfGoQNKHfm_EBK6b8I7IzRAOiLBq9_0crW-9w/s1600/18.jpg)

I played a little bit more with the target app to see what shoud I do to manipulate the flow:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjpPKACtqoRWJs9zkIqiypy6WfrC45axexB_4Gl36bfc38RCPZq2u12KtE_JmkTD-Y82uboBUE6JsVTw3mmSx883QXJ4Xbgtein5jdk3NoKWaIjsfCK4cBeZmgFzYWKCjSlA7l4RlIDy_A/s400/19.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjpPKACtqoRWJs9zkIqiypy6WfrC45axexB_4Gl36bfc38RCPZq2u12KtE_JmkTD-Y82uboBUE6JsVTw3mmSx883QXJ4Xbgtein5jdk3NoKWaIjsfCK4cBeZmgFzYWKCjSlA7l4RlIDy_A/s1600/19.jpg)

As you can see below, the file is not so long so there is a small space to put our shellcode:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2pePagq7zQPAPDOq_KJ0LcXBfDwq1TtpgQLlwTA6ahTTZ0N4pQgJziPq3dEvI8nxBUs1C0UO3ih9b0T3x8WN_ZT4qywrn1ZaGOoZtomfjj6Sd_4XRrCq618P4cVoXIWuiG-FdVonVtNc/s400/20.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2pePagq7zQPAPDOq_KJ0LcXBfDwq1TtpgQLlwTA6ahTTZ0N4pQgJziPq3dEvI8nxBUs1C0UO3ih9b0T3x8WN_ZT4qywrn1ZaGOoZtomfjj6Sd_4XRrCq618P4cVoXIWuiG-FdVonVtNc/s1600/20.jpg)
I changed 43434343 to poppopret. Next we can see that we can jump to our NOP's and CCCC-shellcode:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrXlP6KMetJk6Z_d3TYbzFCERcEDG4BAO2qOB2l3os7blHYKN0wPw5JV9cri4JX2RFcgXD8KFY6WkkPW6APaUtK6mCes2_u8GlMvzK1QBZmznE8qPEtWq4Hni2LNSOQIgmgxDsvyI5U58/s400/21.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrXlP6KMetJk6Z_d3TYbzFCERcEDG4BAO2qOB2l3os7blHYKN0wPw5JV9cri4JX2RFcgXD8KFY6WkkPW6APaUtK6mCes2_u8GlMvzK1QBZmznE8qPEtWq4Hni2LNSOQIgmgxDsvyI5U58/s1600/21.jpg)

So after a while (and a lot of reading and searching online) I created this nasty shellcode ;P

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdIYaSDBCEDm4OVINNZsK2z6aA7lOerSeGAYZVkGgxsTE8twv8c4nsSj3daIMiXXcGUDZE45dt8-IZOUmDw4JvxC1dS5lho9D6GU7x3-pysdMqsO_3kTvDsHKgGHs4m13PZAKxl4KPmqk/s400/22.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdIYaSDBCEDm4OVINNZsK2z6aA7lOerSeGAYZVkGgxsTE8twv8c4nsSj3daIMiXXcGUDZE45dt8-IZOUmDw4JvxC1dS5lho9D6GU7x3-pysdMqsO_3kTvDsHKgGHs4m13PZAKxl4KPmqk/s1600/22.jpg)

In 2nd and 3rd PUSH you will find ".exe" and "calc" (see ESP below), next is WinExec function.

Final results you will find on the screen below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWisgft2XmoK35tis3V6-IZ2UjdSU-lyH0Yzj0Lu_-dur0bCHqRLKv6Pos9WBBchmC-Ebu4os79uf1l2eLT7Ibub4NZHxVjytOGFvwK_pmvNTRSrmD0jlpQSRbf3Eh58QMvwunktuiyXM/s400/23.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWisgft2XmoK35tis3V6-IZ2UjdSU-lyH0Yzj0Lu_-dur0bCHqRLKv6Pos9WBBchmC-Ebu4os79uf1l2eLT7Ibub4NZHxVjytOGFvwK_pmvNTRSrmD0jlpQSRbf3Eh58QMvwunktuiyXM/s1600/23.jpg)

That's all ;)

I hope now it will be easier to find some new bugs. In case of any questions - feel free to mail me or ping me [@twitter](https://twitter.com/CodySixteen). ;)

If you like the post and you would like to donate (or just buy me a coffee;)) - on the top (right) you will find a Paypal button.

[See you next time! ;)](https://www.youtube.com/watch?v=XaHcjY7MVaQ)

[Cheers](https://twitter.com/CodySixteen)

Posted by

[code16](https://www.blogger.com/profile/10414695159301496862 "author profile")

at

[10:23](https://code610.blogspot.com/2019/11/from-0-to-0day-quick-fuzzing-lesson.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4457504812250871322/3640418936984128530 "Wyślij posta przez e-mail")

[Wyślij pocztą e-mail](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=3640418936984128530&target=email "Wyślij pocztą e-mail")[Wrzuć na bloga](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=3640418936984128530&target=blog "Wrzuć na bloga")[Udostępnij w X](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=3640418936984128530&target=twitter "Udostępnij w X")[Udostępnij w usłudze Facebook](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=3640418936984128530&target=facebook "Udostępnij w usłudze Facebook")[Udostępnij w serwisie Pinterest](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=3640418936984128530&target=pinterest "Udostępnij w serwisie Pinterest")

Labels:
[binary](https://code610.blogspot.com/search/label/binary),
[debug](https://code610.blogspot.com/search/label/debug),
[notes](https://code610.blogspot.com/search/label/notes),
[poc](https://code610.blogspot.com/search/label/poc),
[pwn](https://code610.blogspot.com/search/label/pwn),
[RE](https://code610.blogspot.com/search/label/RE),
[writeup](https://code610.blogspot.com/search/label/writeup)

#### 2 komentarze:

1. ![](//resources.blogblog.com/img/blank.gif)Anonimowy[2 grudnia 2019 00:17](https://code610.blogspot.com/2019/11/from-0-to-0day-quick-fuzzing-lesson.html?showComment=1575274638865#c8924581552191285032)

   "TL;DR: We will create a small shellcode ;] to:
   - put calc.exe in memory
   - run it using WinExec"

   I assume that WinExec function was in 39bytes shellcode.
   But how did you put calc.exe in memory?

   Odpowiedz[Usuń](https://www.blogger.com/delete-comment.g?blogID=4457504812250871322&postID=8924581552191285032)Odpowiedzi
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxTLkJwUjO012n0PeP9QOXHkiKVBchiASFL9T6Rad6IsRCwX5CEz_v6pEQP3C_7HRetAZ72fNNZmenletYgK1cYrMKZoAzT0KOEPKauvcQIEq3lsP873D8edyRzITkefA/s45-c/koszulka.jpg)[code16](https://www.blogger.com/profile/10414695159301496862)[2 grudnia 2019 23:10](https://code610.blogspot.com/2019/11/from-0-to-0day-quick-fuzzing-lesson.html?showComment=1575357040734#c7209292098155641525)

     Hi, in a very same way: as you can see (on screens) winexec was 'added' by editing asm in immunitydbg. so preparing a file (contains the same shellcode) should do the job.

     2nd: thanks for watching! ;)

     cheers

     [Usuń](https://www.blogger.com/delete-comment.g?blogID=4457504812250871322&postID=7209292098155641525)Odpowiedzi
     Odpowiedz
   Odpowiedz

Dodaj komentarzWczytaj więcej...

[Nowszy post](https://code610.blogspot.com/2019/12/testing-android-apps-mini-lab.html "Nowszy post")

[Starszy post](https://code610.blogspot.com/2019/11/xss-in-oracle-emps.html "Starszy post")

[Strona główna](https://code610.blogspot.com/)

Subskrybuj:
[Komentarze do posta (Atom)](https://code610.blogspot.com/feeds/3640418936984128530/comments/default)

## O mnie

[![Moje zdjęcie](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxTLkJwUjO012n0PeP9QOXHkiKVBchiASFL9T6Rad6IsRCwX5CEz_v6pEQP3C_7HRetAZ72fNNZmenletYgK1cYrMKZoAzT0KOEPKauvcQIEq3lsP873D8edyRzITkefA/s113/koszulka.jpg)](https://www.blogger.com/profile/10414695159301496862)
[code16](https://www.blogger.com/profile/10414695159301496862)

Cody Sixteen

[Wyświetl mój pełny profil](https://www.blogger.com/profile/10414695159301496862)

## Archiwum bloga

* ►
  [2024](https://code610.blogspot.com/2024/)
  (10)
  + ►
    [12](https://code610.blogspot.com/2024/12/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2024/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2024/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2024/07/)
    (2)
  + ►
    [04](https://code610.blogspot.com/2024/04/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2024/01/)
    (2)

* ►
  [2023](https://code610.blogspot.com/2023/)
  (14)
  + ►
    [12](https://code610.blogspot.com/2023/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2023/11/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2023/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2023/04/)
    (9)

* ►
  [2022](https://code610.blogspot.com/2022/)
  (16)
  + ►
    [09](https://code610.blogspot.com/2022/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2022/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2022/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2022/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2022/04/)
    (7)
  + ►
    [03](https://code610.blogspot.com/2022/03/)
    (1)
  + ►
    [02](https://code610.blogspot.com/2022/02/)
    (2)

* ►
  [2021](https://code610.blogspot.com/2021/)
  (37)
  + ►
    [12](https://code610.blogspot.com/2021/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2021/11/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2021/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2021/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2021/08/)
    (8)
  + ►
    [07](https://code610.blogspot.com/2021/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2021/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2021/05/)
    (7)
  + ►
    [04](https://code610.blogspot.com/2021/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2021/03/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2021/02/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2021/01/)
    (2)

* ►
  [2020](https://code610.blogspot.com/2020/)
  (62)
  + ►
    [12](https://code610.blogspot.com/2020/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2020/11/)
    (2)
  + ►
    [10](https://code610.blogspot.com/2020/10/)
    (1)
  + ►
    [09](https://code610.blogspot.com/2020/09/)
    (2)
  + ►
    [08](https://code610.blogspot.com/2020/08/)
    (5)
  + ►
    [07](https://code610.blogspot.com/2020/07/)
    (5)
  + ►
    [06](https://code610.blogspot.com/2020/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2020/05/)
    (5)
  + ►
    [04](https://code610.blogspot.com/2020/04/)
    (11)
  + ►
    [03](https://code610.blogspot.com/2020/03/)
    (10)
  + ►
    [02](https://code610.blogspot.com/2020/02/)
    (6)
  + ►
    [01](https://code610.blogspot.com/2020/01/)
    (7)

* ▼
  [2019](https://code610.blogspot.com/2019/)
  (97)
  + ►
    [12](https://code610.blogspot.com/2019/12/)
    (4)
  + ▼
    [11](https://code610.blogspot.com/2019/11/)
    (9)
    - [From 0 to 0day - quick fuzzing lesson](https://code610.blogspot.com/2019/11/from-0-to-0day-quick-fuzzing-lesson.html)
    - [XSS in Oracle EPMS](https://code610.blogspot.com/2019/11/xss-in-oracle-emps.html)
    - [Reading spam for a breakfast](https://code610.blogspot.com/2019/11/reading-spam-for-breakfast.html)
    - [Quick memory review - extracting secrets from Hiki...](https://code610.blogspot.com/2019/11/quick-memory-review-extracting-secrets.html)
    - [Sysinternals Suite - quick review for Windows 10](https://code610.blogspot.com/2019/11/sysinternals-suite-quick-review-for.html)
    - [Crashing EximiousSoft Logo Designer](https://code610.blogspot.com/2019/11/crashing-eximioussoft-logo-designer.html)
    - [Fool-AV-riend - Windows 10](https://code610.blogspot.com/2019/11/fool-av-riend-windows-10.html)
    - [Crashing HoneyView 5.31](https://code610.blogspot.com/2019/11/crashing-honeyview-531.html)
    - [Crashing Better JPEG](https://code610.blogspot.com/2019/11/crashing-better-jpeg.html)
  + ►
    [10](https://code610.blogspot.com/2019/10/)
    (8)
  + ►
    [09](https://code610.blogspot.com/2019/09/)
    (5)
  + ►
    [08](https://code610.blogspot.com/2019/08/)
    (20)
  + ►
    [07](https://code610.blogspot.com/2019/07/)
    (10)
  + ►
    [06](https://code610.blogspot.com/2019/06/)
    (3)
  + ►
    [05](https://code610.blogspot.com/2019/05/)
    (8)
  + ►
    [03](https://code610.blogspot.com/2019/03/)
    (15)
  + ►
    [02](https://code610.blogspot.com/2019/02/)
    (5)
  + ►
    [01](https://code610.blogspot.com/2019/01/)
    (10)

* ►
  [2018](https://code610.blogspot.com/2018/)
  (67)
  + ►
    [12](https://code610.blogspot.com/2018/12/)
    (13)
  + ►
    [11](https://code610.blogspot.com/2018/11/)
    (4)
  + ►
    [10](https://code610.blogspot.com/2018/10/)
    (3)
  + ►
    [09](https://code610.blogspot.com/2018/09/)
    (4)
  + ►
    [08](https://code610.blogspot.com/2018/08/)
    (7)
  + ►
    [07](https://code610.blogspot.com/2018/07/)
    (9)
  + ►
    [06](https://code610.blogspot.com/2018/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2018/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2018/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2018/03/)
    (7)
  + ►
    [01](https://code610.blogspot.com/2018/01/)
    (10)

* ►
  [2017](https://code610.blogspot.com/2017/)
  (58)
  + ►
    [12](https://code610.blogspot.com/2017/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2017/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2017/10/)
    (9)
  + ►
    [09](https://code610.blogspot.com/2017/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2017/08/)
    (11)
  + ►
    [07](https://code610.blogspot.com/2017/07/)
    (4)
  + ►
    [06](https://code610.blogspot.com/2017/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2017/05/)
    (10)
  + ►
    [04](https://code610.blogspot.com/2017/04/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2017/02/)
    (1)
  + ►
    [01](https://code610.blogspot.com/2017/01/)
    (6)

* ►
  [2016](https://code610.blogspot.com/2016/)
  (63)
  + ►
    [12](https://code610.blogspot.com/2016/12/)
    (2)
  + ►
    [11](https://code610.blogspot.com/2016/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2016/10/)
    (6)
  + ►
    [09](https://code610.blogspot.com/2016/09/)
    (8)
  + ►
    [08](https://code610.blogspot.com/2016/08/)
    (6)
  + ►
    [07](https://code610.blogspot.com/2016/07/)
    (12)
  + ►
    [06](https://code610.blogspot.com/2016/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2016/05/)
    (23)

## Etykiety

* [.net](https://code610.blogspot.com/search/label/.net)
* [android](https://code610.blogspot.com/search/label/android)
* [binary](https://code610.blogspot.com/search/label/binary)
* [crackme](https://code610.blogspot.com/search/label/crackme)
* [ctf](https://code610.blogspot.com/search/label/ctf)
* [debug](https://code610.blogspot.com/search/label/debug)
* [docker](https://code610.blogspot.com/search/label/docker)
* [drones](https://code610.blogspot.com/search/label/drones)
* [enlil](https://code610.blogspot.com/search/label/enlil)
* [FortiGate](https://code610.blogspot.com/search/label/FortiGate)
* [fuzz](https://code610.blogspot.com/search/label/fuzz)
* [infrastructure](https://code610.blogspot.com/search/label/infrastructure)
* [malware](https://code610.blogspot.com/search/label/malware)
* [notes](https://code610.blogspot.com/search/label/notes)
* [pentest](https://code610.blogspot.com/search/label/pentest)
* [poc](https://code610.blogspot.com/search/label/poc)
* [pwn](https://code610.blogspot.com/search/label/pwn)
* [RE](https://code610.blogspot.com/search/label/RE)
* [web](https://code610.blogspot.com/search/label/web)
* [writeup](https://code610.blogspot.com/search/label/writeup)

|  |  |
| --- | --- |

Motyw Okno obrazu. Obsługiwane przez usługę [Blogger](https://www.blogger.com).


