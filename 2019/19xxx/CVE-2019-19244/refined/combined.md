=== Content from cert-portal.siemens.com_3ea5bb4b_20250121_000649.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-389290: Third-Party Component Vulnerabilities in SINEC INS

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 9.8

2022-03-08
2022-03-08
V1.0

SUMMARY

71 vulnerabilities in third-party components as Node.js, cURL, SQLite, CivetWeb and DNS(ISC BIND)
could allow an attacker to interfere with the affected product in various ways.

Siemens has released an update for SINEC INS and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SINEC INS:
All versions < V1.0.1.1

Update to V1.0.1.1 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109806100/

WORKAROUNDS AND MITIGATIONS

Siemens has not identiﬁed any additional speciﬁc workarounds or mitigations. Please follow the General
Security Recommendations.

Product speciﬁc mitigations can be found in the section Affected Products and Solution.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

SINEC INS (Infrastructure Network Services) is a web-based application that combines various network
services in one tool. This simpliﬁes installation and administration of all network services relevant for
industrial networks.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

SSA-389290

© Siemens 2022

Page 1 of 21

Siemens Security Advisory by Siemens ProductCERT

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2019-19242

SQLite 3.30.1 mishandles pExpr->y.pTab, as demonstrated by the TK_COLUMN case in
sqlite3ExprCodeTarget in expr.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2019-19244

Select in select.c in SQLite 3.30.1 allows a crash if a sub-select uses both DISTINCT and window
functions, and also has certain ORDER BY usage.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2019-19317

lookupName in resolve.c in SQLite 3.30.1 omits bits from the colUsed bitmask in the case of a
generated column, which allows attackers to cause a denial of service or possibly have unspeciﬁed
other impact.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-681: Incorrect Conversion between Numeric Types

Vulnerability CVE-2019-19603

SQLite 3.30.1 mishandles certain SELECT statements with a nonexistent VIEW, leading to an
application crash.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2019-19645

alter.c in SQLite through 3.30.1 allows attackers to trigger inﬁnite recursion via certain types of
self-referential views in conjunction with ALTER TABLE statements.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-674: Uncontrolled Recursion

SSA-389290

© Siemens 2022

Page 2 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-19646

pragma.c in SQLite through 3.30.1 mishandles NOT NULL in an integrity_check PRAGMA command
in certain cases of generated columns.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-754: Improper Check for Unusual or Exceptional Conditions

Vulnerability CVE-2019-19880

exprListAppendList in window.c in SQLite 3.30.1 allows attackers to trigger an invalid pointer derefer-
ence because constant integer values in ORDER BY clauses of window deﬁnitions are mishandled.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2019-19923

ﬂattenSubquery in select.c in SQLite 3.30.1 mishandles certain uses of SELECT DISTINCT involving
a LEFT JOIN in which the right-hand side is a view. This can cause a NULL pointer dereference (or
incorrect results).

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2019-19924

SQLite 3.30.1 mishandles certain parser-tree rewriting, related to expr.c, vdbeaux.c, and window.c.
This is caused by incorrect sqlite3WindowRewrite() error handling.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-755: Improper Handling of Exceptional Conditions

Vulnerability CVE-2019-19925

zipﬁleUpdate in ext/misc/zipﬁle.c in SQLite 3.30.1 mishandles a NULL pathname during an update of
a ZIP archive.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-434: Unrestricted Upload of File with Dangerous Type

Vulnerability CVE-2019-19926

multiSelect in select.c in SQLite 3.30.1 mishandles certain errors during parsing, as demonstrated by
errors from sqlite3WindowRewrite() calls. NOTE: this vulnerability exists because of an incomplete ﬁx
for CVE-2019-19880.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-389290

© Siemens 2022

Page 3 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-1971

The X.509 GeneralName type is a generic type for representing different types of names. One of those
name types is known as EDIPartyName. OpenSSL provides a function GENERAL_NAME_cmp which
compares different instances of a GENERAL_NAME to see if they are equal or not. This function
behaves incorrectly when both GENERAL_NAMEs contain an EDIPARTYNAME. A NULL pointer
dereference and a crash may occur leading to a possible denial of service attack. OpenSSL itself uses
the GENERAL_NAME_cmp function for two purposes: 1) Comparing CRL distribution point names
between an available CRL and a CRL distribution point embedded in an X509 certiﬁcate 2) When
verifying that a timestamp response token signer matches the timestamp authority name (exposed via
the API functions TS_RESP_verify_response and TS_RESP_verify_token) If an attacker can control
both items being compared then that attacker could trigger a crash. For example if the attacker can
trick a client or server into checking a malicious certiﬁcate against a malicious CRL then this may occur.
Note that some applications automatically download CRLs based on a URL embedded in a certiﬁcate.
This checking happens prior to the signatures on the certiﬁcate and CRL being veriﬁed. OpenSSL’s
s_server, s_client and verify tools have support for the “-crl_download” option which implements
automatic CRL downloading and this attack has been demonstrated to work against those tools. Note
that an unrelated bug means that affected versions of OpenSSL cannot parse or construct correct
encodings of EDIPARTYNAME. However it is possible to construct a malformed EDIPARTYNAME that
OpenSSL’s parser will accept and hence trigger this attack. All OpenSSL 1.1.1 and 1.0.2 versions are
affected by this issue. Other OpenSSL releases are out of support and have not been checked. Fixed
in OpenSSL 1.1.1i (Affected 1.1.1-1.1.1h). Fixed in OpenSSL 1.0.2x (Affected 1.0.2-1.0.2w).

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2020-7774

This affects the package y18n before 3.2.2, 4.0.1 and 5.0.5. PoC by po6ix: const y18n = re-
quire(‘y18n’)(); y18n.setLocale(‘proto’); y18n.updateLocale({polluted: true}); console.log(polluted); //
true

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-915: Improperly Controlled Modiﬁcation of Dynamically-
Determined Object Attributes

Vulnerability CVE-2020-8169

The libcurl library versions 7.62.0 to and including 7.70.0 are vulnerable to an information disclosure
vulnerability that can lead to a partial password being leaked over the network and to the DNS server(s).

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

SSA-389290

© Siemens 2022

Page 4 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-8177

curl 7.20.0 through 7.70.0 is vulnerable to improper restriction of names for ﬁles and other resources
that can lead too overwriting a local ﬁle when the -J ﬂag is used.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.1
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C
CWE-74: Improper Neutralization of Special Elements in Output
Used by a Downstream Component (‘Injection’)

Vulnerability CVE-2020-8231

Due to use of a dangling pointer, libcurl 7.29.0 through 7.71.1 can use the wrong connection when
sending data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2020-8265

Node.js versions before 10.23.1, 12.20.1, 14.15.4, 15.5.1 are vulnerable to a use-after-free bug
in its TLS implementation. When writing to a TLS enabled socket, node::StreamBase::Write calls
node::TLSWrap::DoWrite with a freshly allocated WriteWrap object as ﬁrst argument. If the DoWrite
method does not return an error, this object is passed back to the caller as part of a StreamWriteResult
structure. This may be exploited to corrupt memory leading to a Denial of Service or potentially other
exploits.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2020-8284

A malicious server can use the FTP PASV response to trick curl 7.73.0 and earlier into connecting
back to a given IP address and port, and this way potentially make curl extract information about
services that are otherwise private and not disclosed, for example doing port scanning and service
banner extractions.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2020-8285

curl 7.21.0 to and including 7.73.0 is vulnerable to uncontrolled recursion due to a stack overﬂow issue
in FTP wildcard match parsing.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-674: Uncontrolled Recursion

SSA-389290

© Siemens 2022

Page 5 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-8286

The libcurl library versions 7.41.0 to and including 7.73.0 are vulnerable to an improper check for
certiﬁcate revocation due to insufﬁcient veriﬁcation of the OCSP response. This vulnerability could
allow an attacker to pass a revoked certiﬁcate as valid.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C
CWE-295: Improper Certiﬁcate Validation

Vulnerability CVE-2020-8287

Node.js versions before 10.23.1, 12.20.1, 14.15.4, 15.5.1 allow two copies of a header ﬁeld in an
HTTP request (for example, two Transfer-Encoding header ﬁelds). In this case, Node.js identiﬁes the
ﬁrst header ﬁeld and ignores the second. This can lead to HTTP Request Smuggling.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C
CWE-444: Inconsistent Interpretation of HTTP Requests (‘HTTP
Request Smuggling’)

Vulnerability CVE-2020-8625

BIND servers are vulnerable if they are running an affected version and are conﬁgured to use GSS-
TSIG features. In a conﬁguration which uses BIND’s default settings the vulnerable code path is
not exposed, but a server can be rendered vulnerable by explicitly setting valid values for the tkey-
gssapi-keytab or tkey-gssapi-credentialconﬁguration options. Although the default conﬁguration is not
vulnerable, GSS-TSIG is frequently used in networks where BIND is integrated with Samba, as well
as in mixed-server environments that combine BIND servers with Active Directory domain controllers.
The most likely outcome of a successful exploitation of the vulnerability is a crash of the named
process. However, remote code execution, while unproven, is theoretically possible. Affects: BIND
9.5.0 -> 9.11.27, 9.12.0 -> 9.16.11, and versions BIND 9.11.3-S1 -> 9.11.27-S1 and 9.16.8-S1 ->
9.16.11-S1 of BIND Supported Preview Edition. Also release versions 9.17.0 -> 9.17.1 of the BIND
9.17 development branch

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-120: Buffer Copy without Checking Size of Input (‘Classic
Buffer Overﬂow’)

Vulnerability CVE-2020-9327

In SQLite 3.31.1, isAuxiliaryVtabOperator allows attackers to trigger a NULL pointer dereference and
segmentation fault because of generated column optimizations.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-389290

© Siemens 2022

Page 6 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-11655

SQLite through 3.31.1 allows attackers to cause a denial of service (segmentation fault) via a mal-
formed window-function query because the AggInfo object’s initialization is mishandled.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-665: Improper Initialization

Vulnerability CVE-2020-11656

In SQLite through 3.31.1, the ALTER TABLE implementation has a use-after-free, as demonstrated by
an ORDER BY clause that belongs to a compound SELECT statement.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2020-13630

ext/fts3/fts3.c in SQLite before 3.32.0 has a use-after-free in fts3EvalNextRow, related to the snippet
feature.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.0
CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2020-13631

SQLite before 3.32.0 allows a virtual table to be renamed to the name of one of its shadow tables,
related to alter.c and build.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-13632

ext/fts3/fts3_snippet.c in SQLite before 3.32.0 has a NULL pointer dereference via a crafted matchinfo()
query.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2020-13871

SQLite 3.32.2 has a use-after-free in resetAccumulator in select.c because the parse tree rewrite for
window functions is too late.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

SSA-389290

© Siemens 2022

Page 7 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-15358

In SQLite before 3.32.3, select.c mishandles query-ﬂattener optimization, leading to a multiSelec-
tOrderBy heap overﬂow because of misuse of transitive properties for constant propagation.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2020-27304

The CivetWeb web library does not validate uploaded ﬁlepaths when running on an OS other
than Windows, when using the built-in HTTP form-based ﬁle upload mechanism, via the
mg_handle_form_request API. Web applications that use the ﬁle upload form handler, and use
parts of the user-controlled ﬁlename in the output path, are susceptible to directory traversal

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-22:
Improper Limitation of a Pathname to a Restricted
Directory (‘Path Traversal’)

Vulnerability CVE-2021-3449

An OpenSSL TLS server may crash if sent a maliciously crafted renegotiation ClientHello message
from a client. If a TLSv1.2 renegotiation ClientHello omits the signature_algorithms extension (where
it was present in the initial ClientHello), but includes a signature_algorithms_cert extension then a
NULL pointer dereference will result, leading to a crash and a denial of service attack. A server is only
vulnerable if it has TLSv1.2 and renegotiation enabled (which is the default conﬁguration). OpenSSL
TLS clients are not impacted by this issue. All OpenSSL 1.1.1 versions are affected by this issue.
Users of these versions should upgrade to OpenSSL 1.1.1k. OpenSSL 1.0.2 is not impacted by this
issue. Fixed in OpenSSL 1.1.1k (Affected 1.1.1-1.1.1j).

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-389290

© Siemens 2022

Page 8 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-3450

The X509_V_FLAG_X509_STRICT ﬂag enables additional security checks of the certiﬁcates present
in a certiﬁcate chain.
It is not set by default. Starting from OpenSSL version 1.1.1h a check to
disallow certiﬁcates in the chain that have explicitly encoded elliptic curve parameters was added
as an additional strict check. An error in the implementation of this check meant that the result of a
previous check to conﬁrm that certiﬁcates in the chain are valid CA certiﬁcates was overwritten. This
effectively bypasses the check that non-CA certiﬁcates must not be able to issue other certiﬁcates. If a
“purpose” has been conﬁgured then there is a subsequent opportunity for checks that the certiﬁcate is
a valid CA. All of the named “purpose” values implemented in libcrypto perform this check. Therefore,
where a purpose is set the certiﬁcate chain will still be rejected even when the strict ﬂag has been
used. A purpose is set by default in libssl client and server certiﬁcate veriﬁcation routines, but it can
be overridden or removed by an application. In order to be affected, an application must explicitly
set the X509_V_FLAG_X509_STRICT veriﬁcation ﬂag and either not set a purpose for the certiﬁcate
veriﬁcation or, in the case of TLS client or server applications, override the default purpose. OpenSSL
versions 1.1.1h and newer are affected by this issue. Users of these versions should upgrade to
OpenSSL 1.1.1k. OpenSSL 1.0.2 is not impacted by this issue. Fixed in OpenSSL 1.1.1k (Affected
1.1.1h-1.1.1j).

CVSS v3.1 Base Score
CVSS Vector
CWE

7.4
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
CWE-295: Improper Certiﬁcate Validation

Vulnerability CVE-2021-3672

A ﬂaw was found in c-ares library, where a missing input validation check of host names returned by
DNS (Domain Name Servers) can lead to output of wrong hostnames which might potentially lead to
Domain Hijacking. The highest threat from this vulnerability is to conﬁdentiality and integrity as well as
system availability.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.6
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-79:
Improper Neutralization of Input During Web Page
Generation (‘Cross-site Scripting’)

Vulnerability CVE-2021-3711

In order to decrypt SM2 encrypted data an application is expected to call the API function
EVP_PKEY_decrypt(). Typically an application will call this function twice. The ﬁrst time, on en-
try, the “out” parameter can be NULL and, on exit, the “outlen” parameter is populated with the buffer
size required to hold the decrypted plaintext. The application can then allocate a sufﬁciently sized
buffer and call EVP_PKEY_decrypt() again, but this time passing a non-NULL value for the “out”
parameter. A bug in the implementation of the SM2 decryption code means that the calculation of
the buffer size required to hold the plaintext returned by the ﬁrst call to EVP_PKEY_decrypt() can
be smaller than the actual size required by the second call. This can lead to a buffer overﬂow when
EVP_PKEY_decrypt() is called by the application a second time with a buffer that is too small. A
malicious attacker who is able present SM2 content for decryption to an application could cause
attacker chosen data to overﬂow the buffer by up to a maximum of 62 bytes altering the contents of
other data held after the buffer, possibly changing application behaviour or causing the application
to crash. The location of the buffer is application dependent but is typically heap allocated. Fixed in
OpenSSL 1.1.1l (Affected 1.1.1-1.1.1k).

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-120: Buffer Copy without Checking Size of Input (‘Classic
Buffer Overﬂow’)

SSA-389290

© Siemens 2022

Page 9 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-3712

ASN.1 strings are represented internally within OpenSSL as an ASN1_STRING structure which
contains a buffer holding the string data and a ﬁeld holding the buffer length. This contrasts with
normal C strings which are repesented as a buffer for the string data which is terminated with a NUL
(0) byte. Although not a strict requirement, ASN.1 strings that are parsed using OpenSSL’s own “d2i”
functions (and other similar parsing functions) as well as any string whose value has been set with the
ASN1_STRING_set() function will additionally NUL terminate the byte array in the ASN1_STRING
structure. However, it is possible for applications to directly construct valid ASN1_STRING structures
which do not NUL terminate the byte array by directly setting the “data” and “length” ﬁelds in the
ASN1_STRING array. This can also happen by using the ASN1_STRING_set0() function. Numerous
OpenSSL functions that print ASN.1 data have been found to assume that the ASN1_STRING
byte array will be NUL terminated, even though this is not guaranteed for strings that have been
directly constructed. Where an application requests an ASN.1 structure to be printed, and where
that ASN.1 structure contains ASN1_STRINGs that have been directly constructed by the application
without NUL terminating the “data” ﬁeld, then a read buffer overrun can occur. The same thing can
also occur during name constraints processing of certiﬁcates (for example if a certiﬁcate has been
directly constructed by the application instead of loading it via the OpenSSL parsing functions, and
the certiﬁcate contains non NUL terminated ASN1_STRING structures).
It can also occur in the
X509_get1_email(), X509_REQ_get1_email() and X509_get1_ocsp() functions. If a malicious actor
can cause an application to directly construct an ASN1_STRING and then process it through one of
the affected OpenSSL functions then this issue could be hit. This might result in a crash (causing
a Denial of Service attack). It could also result in the disclosure of private memory contents (such
as private keys, or sensitive plaintext). Fixed in OpenSSL 1.1.1l (Affected 1.1.1-1.1.1k). Fixed in
OpenSSL 1.0.2za (Affected 1.0.2-1.0.2y).

CVSS v3.1 Base Score
CVSS Vector
CWE

7.4
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

Vulnerability CVE-2021-22876

curl 7.1.1 to and including 7.75.0 is vulnerable to an “Exposure of Private Personal Information to an
Unauthorized Actor” by leaking credentials in the HTTP Referer: header. libcurl does not strip off user
credentials from the URL when automatically populating the Referer: HTTP request header ﬁeld in
outgoing HTTP requests, and therefore risks leaking sensitive data to the server that is the target of
the second HTTP request.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2021-22883

Node.js before 10.24.0, 12.21.0, 14.16.0, and 15.10.0 is vulnerable to a denial of service attack when
too many connection attempts with an ‘unknownProtocol’ are established. This leads to a leak of ﬁle
descriptors. If a ﬁle descriptor limit is conﬁgured on the system, then the server is unable to accept
new connections and prevent the process also from opening, e.g. a ﬁle. If no ﬁle descriptor limit is
conﬁgured, then this lead to an excessive memory usage and cause the system to run out of memory.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-400: Uncontrolled Resource Consumption

SSA-389290

© Siemens 2022

Page 10 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-22884

Node.js before 10.24.0, 12.21.0, 14.16.0, and 15.10.0 is vulnerable to DNS rebinding attacks as the
whitelist includes “localhost6”. When “localhost6” is not present in /etc/hosts, it is just an ordinary
domain that is resolved via DNS, i.e., over network. If the attacker controls the victim’s DNS server
or can spoof its responses, the DNS rebinding protection can be bypassed by using the “localhost6”
domain. As long as the attacker uses the “localhost6” domain, they can still apply the attack described
in CVE-2018-7160.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-22890

curl 7.63.0 to and including 7.75.0 includes vulnerability that allows a malicious HTTPS proxy to MITM
a connection due to bad handling of TLS 1.3 session tickets. When using a HTTPS proxy and TLS 1.3,
libcurl can confuse session tickets arriving from the HTTPS proxy but work as if they arrived from the
remote server and then wrongly “short-cut” the host handshake. When confusing the tickets, a HTTPS
proxy can trick libcurl to use the wrong session ticket resume for the host and thereby circumvent
the server TLS certiﬁcate check and make a MITM attack to be possible to perform unnoticed. Note
that such a malicious HTTPS proxy needs to provide a certiﬁcate that curl will accept for the MITMed
server for an attack to work - unless curl has been told to ignore the server certiﬁcate check.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-290: Authentication Bypass by Spooﬁng

Vulnerability CVE-2021-22897

curl 7.61.0 through 7.76.1 suffers from exposure of data element to wrong session due to a mistake
in the code for CURLOPT_SSL_CIPHER_LIST when libcurl is built to use the Schannel TLS library.
The selected cipher set was stored in a single “static” variable in the library, which has the surprising
side-effect that if an application sets up multiple concurrent transfers, the last one that sets the ciphers
will accidentally control the set used by all transfers. In a worst-case scenario, this weakens transport
security signiﬁcantly.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-668: Exposure of Resource to Wrong Sphere

Vulnerability CVE-2021-22898

curl 7.7 through 7.76.1 suffers from an information disclosure when the -t command line option, known
as CURLOPT_TELNETOPTIONS in libcurl, is used to send variable=content pairs to TELNET servers. Due
to a ﬂaw in the option parser for sending NEW_ENV variables, libcurl could be made to pass on
uninitialized data from a stack based buffer to the server, resulting in potentially revealing sensitive
internal information to the server using a clear-text network protocol.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-909: Missing Initialization of Resource

SSA-389290

© Siemens 2022

Page 11 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-22901

curl 7.75.0 through 7.76.1 suffers from a use-after-free vulnerability resulting in already freed memory
being used when a TLS 1.3 session ticket arrives over a connection. A malicious server can use
this in rare unfortunate circumstances to potentially reach remote code execution in the client. When
libcurl at run-time sets up support for TLS 1.3 session tickets on a connection using OpenSSL, it
stores pointers to the transfer in-memory object for later retrieval when a session ticket arrives. If
the connection is used by multiple transfers (like with a reused HTTP/1.1 connection or multiplexed
HTTP/2 connection) that ﬁrst transfer object might be freed before the new session is established on
that connection and then the function will access a memory buffer that might be freed. When using
that memory, libcurl might even call a function pointer in the object, making it possible for a remote
code execution if the server could somehow manage to get crafted memory content into the correct
place in memory.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2021-22918

Node.js before 16.4.1, 14.17.2, 12.22.2 is vulnerable to an out-of-bounds read when uv__idna_toascii()
is used to convert strings to ASCII. The pointer p is read and increased without checking whether it
is beyond pe, with the latter holding a pointer to the end of the buffer. This can lead to information
disclosures or crashes. This function can be triggered via uv_getaddrinfo().

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

Vulnerability CVE-2021-22921

Node.js before 16.4.1, 14.17.2, and 12.22.2 is vulnerable to local privilege escalation attacks under
certain conditions on Windows platforms. More speciﬁcally, improper conﬁguration of permissions in
the installation directory allows an attacker to perform two different escalation attacks: PATH and DLL
hijacking.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-732: Incorrect Permission Assignment for Critical Resource

Vulnerability CVE-2021-22922

When curl is instructed to download content using the metalink feature, thecontents is veriﬁed against
a hash provided in the metalink XML ﬁle.The metalink XML ﬁle points out to the client how to get
the same contentfrom a set of different URLs, potentially hosted by different servers and theclient
can then download the ﬁle from one or several of them. In a serial orparallel manner.If one of the
servers hosting the contents has been breached and the contentsof the speciﬁc ﬁle on that server is
replaced with a modiﬁed payload, curlshould detect this when the hash of the ﬁle mismatches after a
completeddownload. It should remove the contents and instead try getting the contentsfrom another
URL. This is not done, and instead such a hash mismatch is onlymentioned in text and the potentially
malicious content is kept in the ﬁle ondisk.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-354: Improper Validation of Integrity Check Value

SSA-389290

© Siemens 2022

Page 12 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-22923

When curl is instructed to get content using the metalink feature, and a user name and password are
used to download the metalink XML ﬁle, those same credentials are then subsequently passed on to
each of the servers from which curl will download or try to download the contents from. Often contrary
to the user’s expectations and intentions and without telling the user it happened.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-522: Insufﬁciently Protected Credentials

Vulnerability CVE-2021-22924

libcurl keeps previously used connections in a connection pool for subsequent transfers to reuse, if
one of them matches the setup. Due to errors in the logic, the conﬁg matching function did not take
‘issuercert’ into account and it compared the involved paths case insensitively,which could lead to
libcurl reusing wrong connections. File paths are, or can be, case sensitive on many systems but not
all, and can even vary depending on used ﬁle systems. The comparison also didn’t include the ‘issuer
cert’ which a transfer can set to qualify how to verify the server certiﬁcate.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-706: Use of Incorrectly-Resolved Name or Reference

Vulnerability CVE-2021-22925

curl supports the -t command line option, known as CURLOPT_TELNETOPTIONSin libcurl. This rarely
used option is used to send variable=content pairs toTELNET servers.Due to ﬂaw in the option parser
for sending NEW_ENV variables, libcurlcould be made to pass on uninitialized data from a stack based
buffer to theserver. Therefore potentially revealing sensitive internal information to theserver using
a clear-text network protocol.This could happen because curl did not call and use sscanf() correctly
whenparsing the string provided by the application.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-908: Use of Uninitialized Resource

Vulnerability CVE-2021-22926

libcurl-using applications can ask for a speciﬁc client certiﬁcate to be used in a transfer. This is done
with the CURLOPT_SSLCERT option (--cert with the command line tool).When libcurl is built to use the
macOS native TLS library Secure Transport, an application can ask for the client certiﬁcate by name
or with a ﬁle name - using the same option. If the name exists as a ﬁle, it will be used instead of by
name.If the appliction runs with a current working directory that is writable by other users (like /tmp), a
malicious user can create a ﬁle name with the same name as the app wants to use by name, and
thereby trick the application to use the ﬁle based cert instead of the one referred to by name making
libcurl send the wrong client certiﬁcate in the TLS connection handshake.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-295: Improper Certiﬁcate Validation

SSA-389290

© Siemens 2022

Page 13 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-22930

Node.js before 16.6.0, 14.17.4, and 12.22.4 is vulnerable to a use after free attack where an attacker
might be able to exploit the memory corruption, to change process behavior.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2021-22931

Node.js before 16.6.0, 14.17.4, and 12.22.4 is vulnerable to Remote Code Execution, XSS, Application
crashes due to missing input validation of host names returned by Domain Name Servers in Node.js
dns library which can lead to output of wrong hostnames (leading to Domain Hijacking) and injection
vulnerabilities in applications using the library.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-22939

If the Node.js https API was used incorrectly and “undeﬁned” was in passed for the “rejectUnauthorized”
parameter, no error was returned and connections to servers with an expired certiﬁcate would have
been accepted.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-295: Improper Certiﬁcate Validation

Vulnerability CVE-2021-22940

Node.js before 16.6.1, 14.17.5, and 12.22.5 is vulnerable to a use after free attack where an attacker
might be able to exploit the memory corruption, to change process behavior.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2021-22945

When sending data to an MQTT server, libcurl <= 7.73.0 and 7.78.0 could in some circumstances
erroneously keep a pointer to an already freed memory area and both use that again in a subsequent
call to send data and also free it again.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.1
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H/E:P/RL:O/RC:C
CWE-415: Double Free

SSA-389290

© Siemens 2022

Page 14 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-22946

A user can tell curl >= 7.20.0 and <= 7.78.0 to require a successful upgrade to TLS when speaking
to an IMAP, POP3 or FTP server (--ssl-reqd on the command line orCURLOPT_USE_SSL set to
CURLUSESSL_CONTROL or CURLUSESSL_ALL withlibcurl). This requirement could be bypassed if the
server would return a properly crafted but perfectly legitimate response.This ﬂaw would then make curl
silently continue its operations withoutTLS contrary to the instructions and expectations, exposing
possibly sensitive data in clear text over the network.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-319: Cleartext Transmission of Sensitive Information

Vulnerability CVE-2021-22947

When curl >= 7.20.0 and <= 7.78.0 connects to an IMAP or POP3 server to retrieve data using
STARTTLS to upgrade to TLS security, the server can respond and send back multiple responses at
once that curl caches. curl would then upgrade to TLS but not ﬂush the in-queue of cached responses
but instead continue using and trustingthe responses it got before the TLS handshake as if they were
authenticated.Using this ﬂaw, it allows a Man-In-The-Middle attacker to ﬁrst inject the fake responses,
then pass-through the TLS trafﬁc from the legitimate server and trick curl into sending data back to
the user thinking the attacker’s injected data comes from the TLS-protected server.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-345: Insufﬁcient Veriﬁcation of Data Authenticity

Vulnerability CVE-2021-23362

The package hosted-git-info before 3.0.8 are vulnerable to Regular Expression Denial of Service
(ReDoS) via regular expression shortcutMatch in the fromUrl function in index.js. The affected regular
expression exhibits polynomial worst-case time complexity.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-23840

Calls to EVP_CipherUpdate, EVP_EncryptUpdate and EVP_DecryptUpdate may overﬂow the output
length argument in some cases where the input length is close to the maximum permissable length for
an integer on the platform. In such cases the return value from the function call will be 1 (indicating
success), but the output length value will be negative. This could cause applications to behave
incorrectly or crash. OpenSSL versions 1.1.1i and below are affected by this issue. Users of these
versions should upgrade to OpenSSL 1.1.1j. OpenSSL versions 1.0.2x and below are affected by this
issue. However OpenSSL 1.0.2 is out of support and no longer receiving public updates. Premium
support customers of OpenSSL 1.0.2 should upgrade to 1.0.2y. Other users should upgrade to 1.1.1j.
Fixed in OpenSSL 1.1.1j (Affected 1.1.1-1.1.1i). Fixed in OpenSSL 1.0.2y (Affected 1.0.2-1.0.2x).

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overﬂow or Wraparound

SSA-389290

© Siemens 2022

Page 15 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-25214

In BIND 9.8.5 -> 9.8.8, 9.9.3 -> 9.11.29, 9.12.0 -> 9.16.13, and versions BIND 9.9.3-S1 -> 9.11.29-S1
and 9.16.8-S1 -> 9.16.13-S1 of BIND 9 Supported Preview Edition, as well as release versions 9.17.0
-> 9.17.11 of the BIND 9.17 development branch, when a vulnerable version of named receives a
malformed IXFR triggering the ﬂaw described above, the named process will terminate due to a failed
assertion the next time the transferred secondary zone is refreshed.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-617: Reachable Assertion

Vulnerability CVE-2021-25215

In BIND 9.0.0 -> 9.11.29, 9.12.0 -> 9.16.13, and versions BIND 9.9.3-S1 -> 9.11.29-S1 and 9.16.8-S1
-> 9.16.13-S1 of BIND Supported Preview Edition, as well as release versions 9.17.0 -> 9.17.11 of the
BIND 9.17 development branch, when a vulnerable version of named receives a query for a record
triggering the ﬂaw described above, the named process will terminate due to a failed assertion check.
The vulnerability affects all currently maintained BIND 9 branches (9.11, 9.11-S, 9.16, 9.16-S, 9.17) as
well as all other versions of BIND 9.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-617: Reachable Assertion

Vulnerability CVE-2021-25216

In BIND 9.5.0 -> 9.11.29, 9.12.0 -> 9.16.13, and versions BIND 9.11.3-S1 -> 9.11.29-S1 and 9.16.8-S1
-> 9.16.13-S1 of BIND Supported Preview Edition, as well as release versions 9.17.0 -> 9.17.1 of
the BIND 9.17 development branch, BIND servers are vulnerable if they are running an affected
version and are conﬁgured to use GSS-TSIG features. In a conﬁguration which uses BIND’s default
settings the vulnerable code path is not exposed, but a server can be rendered vulnerable by explicitly
setting values for the tkey-gssapi-keytab or tkey-gssapi-credential conﬁguration options. Although
the default conﬁguration is not vulnerable, GSS-TSIG is frequently used in networks where BIND
is integrated with Samba, as well as in mixed-server environments that combine BIND servers with
Active Directory domain controllers. For servers that meet these conditions, the ISC SPNEGO
implementation is vulnerable to various attacks, depending on the CPU architecture for which BIND
was built: For named binaries compiled for 64-bit platforms, this ﬂaw can be used to trigger a buffer
over-read, leading to a server crash. For named binaries compiled for 32-bit platforms, this ﬂaw can
be used to trigger a server crash due to a buffer overﬂow and possibly also to achieve remote code
execution. We have determined that standard SPNEGO implementations are available in the MIT and
Heimdal Kerberos libraries, which support a broad range of operating systems, rendering the ISC
implementation unnecessary and obsolete. Therefore, to reduce the attack surface for BIND users,
we will be removing the ISC SPNEGO implementation in the April releases of BIND 9.11 and 9.16 (it
had already been dropped from BIND 9.17). We would not normally remove something from a stable
ESV (Extended Support Version) of BIND, but since system libraries can replace the ISC SPNEGO
implementation, we have made an exception in this case for reasons of stability and security.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-617: Reachable Assertion

SSA-389290

© Siemens 2022

Page 16 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-25219

In BIND 9.3.0 -> 9.11.35, 9.12.0 -> 9.16.21, and versions 9.9.3-S1 -> 9.11.35-S1 and 9.16.8-S1 ->
9.16.21-S1 of BIND Supported Preview Edition, as well as release versions 9.17.0 -> 9.17.18 of the
BIND 9.17 development branch, exploitation of broken authoritative servers using a ﬂaw in response
processing can cause degradation in BIND resolver performance. The way the lame cache is currently
designed makes it possible for its internal data structures to grow almost inﬁnitely, which may cause
signiﬁcant delays in client query processing.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-27290

ssri 5.2.2-8.0.0, ﬁxed in 8.0.1, processes SRIs using a regular expression which is vulnerable to a
denial of service. Malicious SRIs could take an extremely long time to process, leading to denial of
service. This issue only affects consumers using the strict option.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2021-32803

The npm package “tar” (aka node-tar) before versions 6.1.2, 5.0.7, 4.4.15, and 3.2.3 has an arbitrary
File Creation/Overwrite vulnerability via insufﬁcient symlink protection. node-tar aims to guarantee
that any ﬁle whose location would be modiﬁed by a symbolic link is not extracted. This is, in part,
achieved by ensuring that extracted directories are not symlinks. Additionally, in order to prevent
unnecessary stat calls to determine whether a given path is a directory, paths are cached when
directories are created. This logic was insufﬁcient when extracting tar ﬁles that contained both a
directory and a symlink with the same name as the directory. This order of operations resulted in the
directory being created and added to the node-tar directory cache. When a directory is present in the
directory cache, subsequent calls to mkdir for that directory are skipped. However, this is also where
node-tar checks for symlinks occur. By ﬁrst creating a directory, and then replacing that directory
with a symlink, it was thus possible to bypass node-tar symlink checks on directories, essentially
allowing an untrusted tar ﬁle to symlink into an arbitrary location and subsequently extracting arbitrary
ﬁles into that location, thus allowing arbitrary ﬁle creation and overwrite. This issue was addressed in
releases 3.2.3, 4.4.15, 5.0.7 and 6.1.2.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C
Improper Limitation of a Pathname to a Restricted
CWE-22:
Directory (‘Path Traversal’)

SSA-389290

© Siemens 2022

Page 17 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-32804

The npm package “tar” (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14, and 3.3.2 has a arbitrary File
Creation/Overwrite vulnerability due to insufﬁcient absolute path sanitization. node-tar aims to prevent
extraction of absolute ﬁle paths by turning absolute paths into relative paths when the preservePaths
ﬂag is not set to true. This is achieved by stripping the absolute path root from any absolute ﬁle paths
contained in a tar ﬁle. For example /home/user/.bashrc would turn into home/user/.bashrc. This
logic was insufﬁcient when ﬁle paths contained repeated path roots such as ////home/user/.bashrc.
node-tar would only strip a single path root from such paths. When given an absolute ﬁle path with
repeating path roots, the resulting path (e.g. ///home/user/.bashrc) would still resolve to an absolute
path, thus allowing arbitrary ﬁle creation and overwrite. This issue was addressed in releases 3.2.2,
4.4.14, 5.0.6 and 6.1.1. Users may work around this vulnerability without upgrading by creating a
custom onentry method which sanitizes the entry.path or a filter method which removes entries
with absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803 which
ﬁxes a similar bug in later versions of tar.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H/E:P/RL:O/RC:C
CWE-22:
Improper Limitation of a Pathname to a Restricted
Directory (‘Path Traversal’)

Vulnerability CVE-2021-37701

The npm package “tar” (aka node-tar) before versions 4.4.16, 5.0.8, and 6.1.7 has an arbitrary ﬁle
creation/overwrite and arbitrary code execution vulnerability. node-tar aims to guarantee that any ﬁle
whose location would be modiﬁed by a symbolic link is not extracted. This is, in part, achieved by
ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary
stat calls to determine whether a given path is a directory, paths are cached when directories are
created. This logic was insufﬁcient when extracting tar ﬁles that contained both a directory and a
symlink with the same name as the directory, where the symlink and directory names in the archive
entry used backslashes as a path separator on posix systems. The cache checking logic used both
\ and / characters as path separators, however \ is a valid ﬁlename character on posix systems.
By ﬁrst creating a directory, and then replacing that directory with a symlink, it was thus possible to
bypass node-tar symlink checks on directories, essentially allowing an untrusted tar ﬁle to symlink
into an arbitrary location and subsequently extracting arbitrary ﬁles into that location, thus allowing
arbitrary ﬁle creation and overwrite. Additionally, a similar confusion could arise on case-insensitive
ﬁlesystems. If a tar archive contained a directory at FOO, followed by a symbolic link named foo, then
on case-insensitive ﬁle systems, the creation of the symbolic link would remove the directory from
the ﬁlesystem, but not from the internal directory cache, as it would not be treated as a cache hit.
A subsequent ﬁle entry within the FOO directory would then be placed in the target of the symbolic
link, thinking that the directory had already been created. These issues were addressed in releases
4.4.16, 5.0.8 and 6.1.7. The v3 branch of node-tar has been deprecated and did not receive patches
for these issues. If you are still using a v3 release we recommend you update to a more recent version
of node-tar. If this is not possible, a workaround is available in the referenced GHSA-9r2w-394v-53qc.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.6
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-59:
Improper Link Resolution Before File Access (‘Link
Following’)

SSA-389290

© Siemens 2022

Page 18 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-37712

The npm package “tar” (aka node-tar) before versions 4.4.18, 5.0.10, and 6.1.9 has an arbitrary ﬁle
creation/overwrite and arbitrary code execution vulnerability. node-tar aims to guarantee that any ﬁle
whose location would be modiﬁed by a symbolic link is not extracted. This is, in part, achieved by
ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary
stat calls to determine whether a given path is a directory, paths are cached when directories are
created. This logic was insufﬁcient when extracting tar ﬁles that contained both a directory and a
symlink with names containing unicode values that normalized to the same value. Additionally, on
Windows systems, long path portions would resolve to the same ﬁle system entities as their 8.3 “short
path” counterparts. A specially crafted tar archive could thus include a directory with one form of the
path, followed by a symbolic link with a different string that resolves to the same ﬁle system entity,
followed by a ﬁle using the ﬁrst form. By ﬁrst creating a directory, and then replacing that directory
with a symlink that had a different apparent name that resolved to the same entry in the ﬁlesystem, it
was thus possible to bypass node-tar symlink checks on directories, essentially allowing an untrusted
tar ﬁle to symlink into an arbitrary location and subsequently extracting arbitrary ﬁles into that location,
thus allowing arbitrary ﬁle creation and overwrite. These issues were addressed in releases 4.4.18,
5.0.10 and 6.1.9. The v3 branch of node-tar has been deprecated and did not receive patches for
these issues. If you are still using a v3 release we recommend you update to a more recent version of
node-tar. If this is not possible, a workaround is available in the referenced GHSA-qq89-hq3f-393p.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.6
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-59:
Improper Link Resolution Before File Access (‘Link
Following’)

Vulnerability CVE-2021-37713

The npm package “tar” (aka node-tar) before versions 4.4.18, 5.0.10, and 6.1.9 has an arbitrary ﬁle
creation/overwrite and arbitrary code execution vulnerability. node-tar aims to guarantee that any ﬁle
whose location would be outside of the extraction target directory is not extracted. This is, in part,
accomplished by sanitizing absolute paths of entries within the archive, skipping archive entries that
contain .. path portions, and resolving the sanitized paths against the extraction target directory. This
logic was insufﬁcient on Windows systems when extracting tar ﬁles that contained a path that was not
an absolute path, but speciﬁed a drive letter different from the extraction target, such as C:some\path.
If the drive letter does not match the extraction target, for example D:\extraction\dir, then the result
of path.resolve(extractionDirectory, entryPath) would resolve against the current working
directory on the C: drive, rather than the extraction target directory. Additionally, a .. portion of the
path could occur immediately after the drive letter, such as C:../foo, and was not properly sanitized
by the logic that checked for .. within the normalized and split portions of the path. This only affects
users of node-tar on Windows systems. These issues were addressed in releases 4.4.18, 5.0.10 and
6.1.9. The v3 branch of node-tar has been deprecated and did not receive patches for these issues.
If you are still using a v3 release we recommend you update to a more recent version of node-tar.
There is no reasonable way to work around this issue without performing the same path normalization
procedures that node-tar now does. Users are encouraged to upgrade to the latest patched versions
of node-tar, rather than attempt to sanitize paths themselves.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.6
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-22:
Improper Limitation of a Pathname to a Restricted
Directory (‘Path Traversal’)

SSA-389290

© Siemens 2022

Page 19 of 21

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2021-39134

@npmcli/arborist, the library that calculates dependency trees and manages the node_modules
folder hierarchy for the npm command line interface, aims to guarantee that package dependency con-
tracts will be met, and the extraction of package contents will always be performed into the expected
folder. This is, in part, accomplished by resolving dependency speciﬁers deﬁned in package.json man-
ifests for dependencies with a speciﬁc name, and nesting folders to resolve conﬂicting dependencies.
When multiple dependencies differ only in the case of their name, Arborist’s internal data structure saw
them as separate items that could coexist within the same level in the node_modules hierarchy. How-
ever, on case-insensitive ﬁle systems (such as macOS and Windows), this is not the case. Combined
with a symlink dependency such as file:/some/path, this allowed an attacker to create a situation in
which arbitrary contents could be written to any location on the ﬁlesystem. For example, a package
pwn-a could deﬁne a dependency in their package.json ﬁle such as "foo": "file:/some/path". An-
other package, pwn-b could deﬁne a dependency such as FOO: "file:foo.tgz". On case-insensitive
ﬁle systems, if pwn-a was installed, and then pwn-b was installed afterwards, the contents of foo.tgz
would be written to /some/path, and any existing contents of /some/path would be removed. Anyone
using npm v7.20.6 or earlier on a case-insensitive ﬁlesystem is potentially affected. This is patched in
@npmcli/arborist 2.8.2 which is included in npm v7.20.7 and above.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-61: UNIX Symbolic Link (Symlink) Following

Vulnerability CVE-2021-39135

@npmcli/arborist, the library that calculates dependency trees and manages the node_modules
folder hierarchy for the npm command line interface, aims to guarantee that package dependency
contracts will be met, and the extraction of package contents will always be performed into the
expected folder. This is accomplished by extracting package contents into a project’s node_modules
folder. If the node_modules folder of the root project or any of its dependencies is somehow replaced
with a symbolic link, it could allow Arborist to write package dependencies to any arbitrary location on
the ﬁle system. Note that symbolic links contained within package artifact contents are ﬁltered out, so
another means of creating a node_modules symbolic link would have to be employed. 1. A preinstall
script could replace node_modules with a symlink. (This is prevented by using --ignore-scripts.)
2. An attacker could supply the target with a git repository, instructing them to run npm install
--ignore-scripts in the root. This may be successful, because npm install --ignore-scripts is
typically not capable of making changes outside of the project directory, so it may be deemed safe.
This is patched in @npmcli/arborist 2.8.2 which is included in npm v7.20.7 and above. For more
information including workarounds please see the referenced GHSA-gmw6-94gg-2rc2.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-61: UNIX Symbolic Link (Symlink) Following

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

SSA-389290

© Siemens 2022

Page 20 of 21

Siemens Security Advisory by Siemens ProductCERT

HISTORY DATA

V1.0 (2022-03-08):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-389290

© Siemens 2022

Page 21 of 21



=== Content from usn.ubuntu.com_318cf47b_20250121_000650.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4205-1: SQLite vulnerabilities

2 December 2019

Several security issues were fixed in SQLite.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.10](/security/notices?release=eoan)
* [Ubuntu 19.04](/security/notices?release=disco)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [sqlite3](/security/cves?package=sqlite3) - C library that implements an SQL database engine

## Details

It was discovered that SQLite incorrectly handled certain schemas.

An attacker could possibly use this issue to cause a denial of service.

This issue only affected Ubuntu 12.04 ESM. ([CVE-2018-8740](/security/CVE-2018-8740))

It was discovered that SQLite incorrectly handled certain schemas.

An attacker could possibly use this issue to cause a denial of service.

This issue only affected Ubuntu 16.04 LTS, Ubuntu 18.04 LTS and Ubuntu 19.04.

([CVE-2019-16168](/security/CVE-2019-16168))

It was discovered that SQLite incorrectly handled certain schemas.

An attacker could possibly use this issue to mishandles some expressions.

This issue only affected Ubuntu 19.04 and Ubuntu 19.10. ([CVE-2019-19242](/security/CVE-2019-19242))

It was discovered that SQLite incorrectly handled certain queries.

An attacker could possibly use this issue to execute arbitrary code.

This issue only affected Ubuntu 19.04 and Ubuntu 19.10. ([CVE-2019-19244](/security/CVE-2019-19244))

It was discovered that SQLite incorrectly handled certain SQL commands.

An attacker could possibly use this issue to execute arbitrary code.

This issue only affected Ubuntu 19.04. ([CVE-2019-5018](/security/CVE-2019-5018))

It was discovered that SQLite incorrectly handled certain commands. An

attacker could possibly use this issue to execute arbitrary code.

([CVE-2019-5827](/security/CVE-2019-5827))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.10

* [libsqlite3-0](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.29.0-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.29.0-2ubuntu0.1)
* [sqlite3](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.29.0-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.29.0-2ubuntu0.1)

##### Ubuntu 19.04

* [libsqlite3-0](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.27.2-2ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.27.2-2ubuntu0.2)
* [sqlite3](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.27.2-2ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.27.2-2ubuntu0.2)

##### Ubuntu 18.04

* [libsqlite3-0](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.22.0-1ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.22.0-1ubuntu0.2)
* [sqlite3](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.22.0-1ubuntu0.2](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.22.0-1ubuntu0.2)

##### Ubuntu 16.04

* [libsqlite3-0](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.11.0-1ubuntu1.3](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.11.0-1ubuntu1.3)
* [sqlite3](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.11.0-1ubuntu1.3](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.11.0-1ubuntu1.3)

##### Ubuntu 12.04

* [libsqlite3-0](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.7.9-2ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.7.9-2ubuntu1.4)
* [sqlite3](https://launchpad.net/ubuntu/%2Bsource/sqlite3)
  -
  [3.7.9-2ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/sqlite3/3.7.9-2ubuntu1.4)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2018-8740](/security/CVE-2018-8740)
* [CVE-2019-16168](/security/CVE-2019-16168)
* [CVE-2019-19242](/security/CVE-2019-19242)
* [CVE-2019-19244](/security/CVE-2019-19244)
* [CVE-2019-5018](/security/CVE-2019-5018)
* [CVE-2019-5827](/security/CVE-2019-5827)

## Related notices

* [USN-4394-1](/security/notices/USN-4394-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_dfb6d129_20250121_000650.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlite%2Fsqlite%2Fcommit%2Fe59c562b3f6894f84c715772c4b116d7b5c01348)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlite%2Fsqlite%2Fcommit%2Fe59c562b3f6894f84c715772c4b116d7b5c01348)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sqlite%2Fsqlite)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sqlite](/sqlite)
/
**[sqlite](/sqlite/sqlite)**
Public

* [Notifications](/login?return_to=%2Fsqlite%2Fsqlite) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fsqlite%2Fsqlite)
* [Star
   7.2k](/login?return_to=%2Fsqlite%2Fsqlite)

* [Code](/sqlite/sqlite)
* [Pull requests
  12](/sqlite/sqlite/pulls)
* [Actions](/sqlite/sqlite/actions)
* [Security](/sqlite/sqlite/security)
* [Insights](/sqlite/sqlite/pulse)

Additional navigation options

* [Code](/sqlite/sqlite)
* [Pull requests](/sqlite/sqlite/pulls)
* [Actions](/sqlite/sqlite/actions)
* [Security](/sqlite/sqlite/security)
* [Insights](/sqlite/sqlite/pulse)

## Commit

[Permalink](/sqlite/sqlite/commit/e59c562b3f6894f84c715772c4b116d7b5c01348)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix a crash that could occur if a sub-select that uses both DISTINCT …

[Browse files](/sqlite/sqlite/tree/e59c562b3f6894f84c715772c4b116d7b5c01348)
Browse the repository at this point in the history

```
…and window functions also used an ORDER BY that is the same as its select list.

FossilOrigin-Name: bcdd66c1691955c697f3d756c2b035acfe98f6aad72e90b0021bab6e9023b3ba
```

* Loading branch information

dan
committed
Nov 22, 2019

1 parent
[c398c65](/sqlite/sqlite/commit/c398c65bee850b6b8f24a44852872a27f114535d)

commit e59c562

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**23 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* manifest
  [manifest](#diff-05b3abf2579a5eb66403cd78be557fd860633a1fe2103c7642030defe32c657f)
* manifest.uuid
  [manifest.uuid](#diff-b74c70bf78a28472b10dfc642d3d3c99ff0a2eca821d0be6fdd9232147b57bde)
* src

  + src/select.c
    [select.c](#diff-a81a695ad8b5a69af392acb29f87f942ce878f4c7349731874190ce14a99d54d)
* test

  + test/window1.test
    [window1.test](#diff-c01814f38790d94f687df72fd4d6375376652542280362d6ebf38519b20cec38)

## There are no files selected for viewing

16 changes: 8 additions & 8 deletions

16
[manifest](#diff-05b3abf2579a5eb66403cd78be557fd860633a1fe2103c7642030defe32c657f "manifest")

Show comments

[View file](/sqlite/sqlite/blob/e59c562b3f6894f84c715772c4b116d7b5c01348/manifest)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | C Revise\sthe\sSQLITE\_OPEN\_NOFOLLOW\sso\sthat\sit\sactually\suses\sO\_NOFOLLOW\sin\sthe\nopen()\ssystem\scall.\s\sThis\sbacks\sout\sthe\sSQLITE\_ACCESS\_SYMLINK\svalue\sbut\sadds\nthe\snew\sSQLITE\_OK\_SYMLINK\sreturn\scode\sfrom\sthe\sxFullPathname\smethod\sof\s\nsqlite3\_vfs\swhen\sthat\sroutine\sresolves\ssymbolic\slinks.\sO\_NOFOLLOW\sis\salways\nincluded\sin\sopen()\ssystem\scalls\sfor\sjournal\sfiles. |
|  |  | D 2019-11-22T00:42:01.486 |
|  |  | C Fix\sa\scrash\sthat\scould\soccur\sif\sa\ssub-select\sthat\suses\sboth\sDISTINCT\sand\swindow\sfunctions\salso\sused\san\sORDER\sBY\sthat\sis\sthe\ssame\sas\sits\sselect\slist. |
|  |  | D 2019-11-22T10:14:01.691 |
|  |  | F .fossil-settings/empty-dirs dbb81e8fc0401ac46a1491ab34a7f2c7c0452f2f06b54ebb845d024ca8283ef1 |
|  |  | F .fossil-settings/ignore-glob 35175cdfcf539b2318cb04a9901442804be81cd677d8b889fcc9149c21f239ea |
|  |  | F LICENSE.md df5091916dbb40e6e9686186587125e1b2ff51f022cc334e886c19a0e9982724 |
| Expand Down  Expand Up | | @@ -526,7 +526,7 @@ F src/printf.c 9be6945837c839ba57837b4bc3af349eba630920fa5532aa518816defe42a7d4 |
|  |  | F src/random.c 80f5d666f23feb3e6665a6ce04c7197212a88384 |
|  |  | F src/resolve.c 023397b50d09a3587a15169b713342e2d595ab29e14e54fd8f4a86b76c461d21 |
|  |  | F src/rowset.c d977b011993aaea002cab3e0bb2ce50cf346000dff94e944d547b989f4b1fe93 |
|  |  | F src/select.c 50ccaf5fc3566b897fd3090b63bd60605f2f3f38ac5709fda6c482510d71aa6c |
|  |  | F src/select.c f403b7bd2304d4dfd5ad2614cc0ad3386a97af707922882bdabba4c14ce12975 |
|  |  | F src/shell.c.in 4a3a9e1c11847b1904f2b01d087af1c052f660902755abab457cab1756817ded |
|  |  | F src/sqlite.h.in 4fe42f27a7be44586bbd94f49f2b097ef8a1053c747d82f135456c7f5381c85a |
|  |  | F src/sqlite3.rc 5121c9e10c3964d5755191c80dd1180c122fc3a8 |
| Expand Down  Expand Up | | @@ -1711,7 +1711,7 @@ F test/win32heap.test 10fd891266bd00af68671e702317726375e5407561d859be1aa04696f2 |
|  |  | F test/win32lock.test fbf107c91d8f5512be5a5b87c4c42ab9fdd54972 |
|  |  | F test/win32longpath.test 169c75a3b2e43481f4a62122510210c67b08f26d |
|  |  | F test/win32nolock.test ac4f08811a562e45a5755e661f45ca85892bdbbc |
|  |  | F test/window1.test e88f674b5de9d3bd2787bc1ff22e8c04c10c7e9773212f3c3c3396cb8dccb096 |
|  |  | F test/window1.test 60ba11fb64122c57dfd423a5f9483fb446cc27ed5cf5526152a0decdc9a761fa |
|  |  | F test/window2.tcl 66db96fd9fd202bc31ee7f8ce7904cb469564864cff3f74e009bfef8102333f4 |
|  |  | F test/window2.test af2a001ded703bb8f2474fb0edfef170d5aba00f5c1f2aa9f65935b5da13df90 |
|  |  | F test/window3.tcl acea6e86a4324a210fd608d06741010ca83ded9fde438341cb978c49928faf03 |
| Expand Down  Expand Up | | @@ -1850,7 +1850,7 @@ F vsixtest/vsixtest.tcl 6a9a6ab600c25a91a7acc6293828957a386a8a93 |
|  |  | F vsixtest/vsixtest.vcxproj.data 2ed517e100c66dc455b492e1a33350c1b20fbcdc |
|  |  | F vsixtest/vsixtest.vcxproj.filters 37e51ffedcdb064aad6ff33b6148725226cd608e |
|  |  | F vsixtest/vsixtest\_TemporaryKey.pfx e5b1b036facdb453873e7084e1cae9102ccc67a0 |
|  |  | P ac080432b480062507452d3cdbe6c0f759e6f95b65d9862e0462017405ab2b8e |
|  |  | R b32992f83d3fe313532417046634561a |
|  |  | U drh |
|  |  | Z 3c868f0a98a5c208f527ca2b91cdb564 |
|  |  | P 6a64fb6a2da6c98f1e87b55ad5689967e1db4eae2e08345471d95e28cd567e0f |
|  |  | R 6a5d6072626d6501ea14c356f9dce16a |
|  |  | U dan |
|  |  | Z 0f63dd080b5a1fb6658b32eaaaf6aa19 |

2 changes: 1 addition & 1 deletion

2
[manifest.uuid](#diff-b74c70bf78a28472b10dfc642d3d3c99ff0a2eca821d0be6fdd9232147b57bde "manifest.uuid")

Show comments

[View file](/sqlite/sqlite/blob/e59c562b3f6894f84c715772c4b116d7b5c01348/manifest.uuid)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1 +1 @@ |
|  |  | 6a64fb6a2da6c98f1e87b55ad5689967e1db4eae2e08345471d95e28cd567e0f |
|  |  | bcdd66c1691955c697f3d756c2b035acfe98f6aad72e90b0021bab6e9023b3ba |

1 change: 1 addition & 0 deletions

1
[src/select.c](#diff-a81a695ad8b5a69af392acb29f87f942ce878f4c7349731874190ce14a99d54d "src/select.c")

Show comments

[View file](/sqlite/sqlite/blob/e59c562b3f6894f84c715772c4b116d7b5c01348/src/select.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6064,6 +6064,7 @@ int sqlite3Select( |
|  |  | \*/ |
|  |  | if( (p->selFlags & (SF\_Distinct|SF\_Aggregate))==SF\_Distinct |
|  |  | && sqlite3ExprListCompare(sSort.pOrderBy, pEList, -1)==0 |
|  |  | && p->pWin==0 |
|  |  | ){ |
|  |  | p->selFlags &= ~SF\_Distinct; |
|  |  | pGroupBy = p->pGroupBy = sqlite3ExprListDup(db, pEList, 0); |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[test/window1.test](#diff-c01814f38790d94f687df72fd4d6375376652542280362d6ebf38519b20cec38 "test/window1.test")

Show comments

[View file](/sqlite/sqlite/blob/e59c562b3f6894f84c715772c4b116d7b5c01348/test/window1.test)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1243,4 +1243,17 @@ do\_catchsql\_test 32.10 { |
|  |  | ALTER TABLE a0 RENAME TO S; |
|  |  | } {1 {error in view a: 1st ORDER BY term does not match any column in the result set}} |
|  |  |  |
|  |  | reset\_db |
|  |  | do\_execsql\_test 33.1 { |
|  |  | CREATE TABLE t1(aa, bb); |
|  |  | INSERT INTO t1 VALUES(1, 2); |
|  |  | INSERT INTO t1 VALUES(5, 6); |
|  |  | CREATE TABLE t2(x); |
|  |  | INSERT INTO t2 VALUES(1); |
|  |  | } |
|  |  | do\_execsql\_test 33.2 { |
|  |  | SELECT (SELECT DISTINCT sum(aa) OVER() FROM t1 ORDER BY 1), x FROM t2 |
|  |  | ORDER BY 1; |
|  |  | } {6 1} |
|  |  |  |
|  |  | finish\_test |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e59c562`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlite%2Fsqlite%2Fcommit%2Fe59c562b3f6894f84c715772c4b116d7b5c01348) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


