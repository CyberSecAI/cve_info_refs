=== Content from wiki.freepbx.org_fe606437_20250120_232050.html ===


[![Custom logo](/wiki/download/attachments/32967/atl.site.logo?version=1&modificationDate=1697746375069&cacheVersion=1&api=v2)![Custom icon](/wiki/download/attachments/32967/atl.site.logo?version=1&modificationDate=1697746375069&cacheVersion=1&api=v2)](/wiki)Sangoma Documentation[Sangoma Documentation Home](/wiki/spaces/DocHome/overview?mode=global)SpacesTeamsApps[Templates](/wiki/templates)Create[![](/wiki/download/attachments/8454147/FP?version=2&modificationDate=1706705584550&cacheVersion=1&api=v2)
## FreePBX Open Source](/wiki/spaces/FP/overview?homepageId=8454359)

* [All content](/wiki/spaces/FP/pages)
* [Space settings](/wiki/spaces/FP/settings/home)

Shortcuts

* [Sangoma Phone Desktop Client for FreePBX](https://sangomakb.atlassian.net/wiki/spaces/SS1/pages/31129864/Sangoma%2BPhone%2BDesktop%2BClient)[Sangoma Phone Desktop Client for FreePBX](https://sangomakb.atlassian.net/wiki/spaces/SS1/pages/31129864/Sangoma%2BPhone%2BDesktop%2BClient) This trigger is hidden
* [Sangoma Talk Mobile for FreePBX](https://sangomakb.atlassian.net/wiki/spaces/SS1/pages/31130054/Sangoma%2BTalk%2BMobile)[Sangoma Talk Mobile for FreePBX](https://sangomakb.atlassian.net/wiki/spaces/SS1/pages/31130054/Sangoma%2BTalk%2BMobile) This trigger is hidden

ContentResults will update as you type.

* [•FreePBX OpenSource Project](/wiki/spaces/FP/pages/9699329/FreePBX%2BOpenSource%2BProject)
* FreePBX Open Source User Guides
* FreePBX Open Source Release Notes
* FreePBX Open Source Technical Notes & Resources
* FreePBX Open Source Compliance Notes
* FreePBX Open Source Video Guides

# FreePBX Open Source Project

## Welcome to the main repository for the FreePBX Open Source project

Search our help articles

Return to <https://sangomakb.atlassian.net/wiki/spaces/DocHome>

Return to <https://help.sangoma.com/>

### Return to [Documentation Home](/wiki/spaces/DocHome) I Return to [Sangoma Support](https://help.sangoma.com/)

{"serverDuration": 10, "requestCorrelationId": "2aa6c249189548ccade1e19aefa42658"}


=== Content from community.freepbx.org_debec1e3_20250120_232047.html ===


![FreePBX Community Forums](data:image/svg;base64...)
Loading

[FreePBX Community Forums](/)

# [FreePBX Security Vulnerability SEC-2019-001](/t/freepbx-security-vulnerability-sec-2019-001/62772)

[FreePBX](/c/freepbx/security/76)

[Security](/c/freepbx/security/76)

[bug](https://community.freepbx.org/tag/bug)

[jsmith](https://community.freepbx.org/u/jsmith)
(Jared K Smith)

November 20, 2019, 8:01pm

1

Sangoma was recently made aware of a significant security vulnerability affecting the administrator web interface for current versions of FreePBX and PBXact. Sangoma has published updated FreePBX and PBXact modules (for the “framework” module) to our mirror servers, and they should be available to you now. Many modern FreePBX systems are set to automatically apply security updates, but we *STRONGLY* encourage you to check all of your FreePBX systems to make sure that they have updated to the new version. To do this, please go to Admin -> Module Admin and make sure the “FreePBX Framework” is greater than or equal to one of the following versions:

For FreePBX/PBXact 13: v13.0.197.14

For FreePBX/PBXact 14: v14.0.13.12

For FreePBX/PBXact 15: v15.0.16.27

You may also check the version of the modules from the Linux command-line on your FreePBX/PBXact system by running “fwconsole ma list” and looking at the version of the “framework” module.

While keeping your system up to date is critical in preventing security issues, we also encourage all FreePBX and PBXAct users to follow strong security practices, such as limiting exposure of your FreePBX or PBXact Admin GUI whenever possible.

We would like to publicly thank those who reported this issue to us in a responsible manner. This responsible disclosure allowed us to prepare updates and make them available before public disclosure of the vulnerability, so that FreePBX users can secure their systems.

More details on the vulnerability are available on the FreePBX wiki at [https://wiki.freepbx.org/display/FOP/2019-11-20+Remote+Admin+Authentication+Bypass](https://wiki.freepbx.org/display/FOP/2019-11-20%2BRemote%2BAdmin%2BAuthentication%2BBypass)

3 Likes

[Sec-2019-001](https://community-old.freepbx.org/t/sec-2019-001/62732/8)

[billsimon](https://community.freepbx.org/u/billsimon)
(Bill Simon)

November 20, 2019, 8:10pm

3

Under what circumstances can intrusion take place, and how can FreePBX administrators tell if their system has already been had?

I’m not asking for public description of the specific attack vector, but the “More details” link lacks actual details.

1 Like

[mattf](https://community.freepbx.org/u/mattf)
(Matthew Fredrickson)

November 20, 2019, 8:37pm

4

Hey Bill,

Due to the concerning nature of the exploit, we’re trying to keep the details of the attack vector from getting leaked. It’s safe to say that if you have a system that has the admin portal exposed to the open internet, you should take precautions to verify that nothing is amiss, such as auditing admin and user accounts and verifying that they are in order (no suspicious new accounts, etc). Also, it never hurts to reset your upstream SIP provider credentials/password in case you’re using username/password auth with them.

Finally, it might not hurt to clear the php session tokens and force a login from all users again (depending on how deeply you’d like to go through this process).

You can do that at an ssh console with the following command:

`rm -f /var/lib/php/session/*`

Hope that helps a bit, and sorry to have to break the bad news.

Matthew Fredrickson

1 Like

[ausip](https://community.freepbx.org/u/ausip)
(Paul Mitchener)

November 20, 2019, 8:53pm

5

HI [@mattf](/u/mattf)

I wasn’t after specifics, just an idea of what the exploit relates to, which you have explained well enough.

Based on the timing, It sounds like we have fell victim to this exploit. The extension that was compromised had a random password on it that I would not have used. This was a red flag for me. Luckily we caught the exploit before they spent too much on calls to Morroco.

We had already blocked web access to the admin portal. As all extension secrets are visible from the admin UI, I am guessing it’s probably best that we go and reset all the passwords.

I will also have a look for any new users in the Admin Panel.

Thanks for the explanation.

[FreerPBXer](https://community.freepbx.org/u/FreerPBXer)
(FreerPBXer)

November 20, 2019, 9:03pm

6

Is there a way to have the UCP accessible and not the admin portal? If so, can someone post a link with directions?

[jgiebler](https://community.freepbx.org/u/jgiebler)
(Jameson G)

November 20, 2019, 9:11pm

7

Thanks [@mattf](/u/mattf)

Just to confirm…

If we did not have the Admin Portal (Port 443 on the FreePBX servers in our case) accessible to the open web, we probably didn’t have anything malicious happen… unless it came from an inside device with access to port 443 on the FreePBX Servers.

Can you confirm that is a correct understanding?

For us, we only have the Standard SIP ports and the Media Ports Open to the web. The SIP ports are limited to inbound access only from our specific Provider IPs.

Thank you

[mattf](https://community.freepbx.org/u/mattf)
(Matthew Fredrickson)

November 20, 2019, 9:29pm

8

That is correct. If you didn’t have the admin portal accessible on the open web, the only attacker that might be of concern is someone operating inside your network, and for most people that means you’re safe ![:slight_smile:](//community.freepbx.org/images/emoji/twitter/slight_smile.png?v=6 ":slight_smile:")

Matthew Fredrickson

[jgiebler](https://community.freepbx.org/u/jgiebler)
(Jameson G)

November 20, 2019, 9:40pm

9

Thanks for the quick response [@mattf](/u/mattf)

That is very helpful to have confirmed.

[moussa854](https://community.freepbx.org/u/moussa854)
(Moussa)

November 20, 2019, 10:24pm

10

Do you have sensitive information that can be leaked from the UCP? Have you notice any change in passwords? unusual call destinations?

[cyberdocwi](https://community.freepbx.org/u/cyberdocwi)
(cyberdocwi)

November 21, 2019, 12:56am

11

Thank you Sangoma for jumping on this right away. I can also appreciate the desire to also keep the attack methodology under wraps.

I have taken a look at the Linux side of the logging: secure, messages, that sort of thing, but am wondering if an audit trail exists to tell who accessed and who was denied the login screen. Is there a simple log file somewhere that I am missing that would show if anyone was able to access via the fault?

Thanks,

Christian

[moussa854](https://community.freepbx.org/u/moussa854)
(Moussa)

November 21, 2019, 1:51am

12

I wrote few scripts that pulls the information from the logs. The logs get rotated and the scripts will not help with old incidents.

This one will pull all IPs that accessed the server

> sudo cat /var/log/httpd/access\_log | awk ‘{print $1}’ | sort -n | uniq | sort -nr | head -20

This one will pull the IPs that get denied

> sudo cat /var/log/httpd/error\_log | grep denied |cut -f 10 -d ’ '| sed ‘s/.{7}$//’ | sort | uniq | sort -nr | more
>
> sudo cat /var/log/secure | grep “Failed password” | grep -E -o “([0-9]{1,3}[.]){3}[0-9]{1,3}” | cut -f 11 -d ’ '| sort | uniq | tr ‘\n’ ’ ’ | sort -nr
>
> sudo cat /var/log/secure | grep “authentication failures” |cut -f 16 -d ’ ’ |cut -f 2 -d = | sort | uniq | tr ‘\n’ ’ ’ | sort -nr

This one will pull the IPs for the endpoints that registered to your server

> sudo cat /var/log/asterisk/full | grep “@” | grep -E -o “([0-9]{1,3}[.]){3}[0-9]{1,3}” | sort | uniq | sort -nr

This is how I put them to work. If there is an unusual activity I get an email and I act on it.

![](https://community.freepbx.org/letter_avatar_proxy/v4/letter/m/0ea827/48.png)
[[HOW-TO] Monitor and Set Email Alert For Unauthorized Access to FreePBX (Centos) Server](https://community.freepbx.org/t/how-to-monitor-and-set-email-alert-for-unauthorized-access-to-freepbx-centos-server/59420/3) [General Help](/c/general-help/38)
> [dicko](https://community.freepbx.org/u/dicko) mentioned in a post that the access\_log has the information of who access what and when. Looking around I was able to write this script that will do the purpose of monitoring users’ access by IP. In my situation, I have limited IP that I access the FreePBX from. Hence, this script should do it for me.
> #!/bin/bash
> email="myemail@yahoo.com"
> myips=("IP1" "IP2" "IP3" "IP4")
> accessip=`sudo cat /var/log/httpd/access\_log | awk '{print $1}' | sort -n | uniq | sort -nr | head -20`
> deniedip=`sudo…

logwatch is another way to look at who accessed your server and from where

![](https://a.fsdn.com/con/img/sandiego/logo-180x180.png)
[SourceForge](https://sourceforge.net/projects/logwatch/)

### [Logwatch](https://sourceforge.net/projects/logwatch/)

Download Logwatch for free. Logwatch is a customizable log analysis system. Logwatch parses through your system's logs and creates a report analyzing areas that you specify.

[VoIPTek](https://community.freepbx.org/u/VoIPTek)
(VoIPTek)

November 21, 2019, 3:15am

13

While we are getting a little off-topic with this post, I wanted to share my approach to the notification aspect since it was a part of the conversation here.

I use this from within .bashrc and I populate the file ssh\_known\_ips with you guessed it, the IP’s we know about, in order to reduce the amount of email. The server name will get auto-populated.

SSERVER=`hostname | perl -p -e 's/(.*?)\..*/$1/'`

SUBJECT=“Root Login Alert: $SSERVER”

NOTIFY\_EMAIL="SENDTOMYEMAIL@MYEMAIL.COM"

[ -f /ibin/conf/ssh\_known\_ips ] && source /ibin/conf/ssh\_known\_ips

loginip=`echo $SSH_CLIENT | awk '{print $1}'`

authorized=false;

function message {

echo “${msgheader}`hostname`”

echo “----------------------------------------------”

echo “Login IP: $loginip”

echo "Login User: `whoami`"

echo "Date-Time: `date`"

echo “----------------------------------------------”

}

for ip in $KNOWN\_IPS; do

if [ “$loginip” == “$ip” ]; then

authorized=true;

msgheader=“Authorized Login to Server:”

fi

done

if [ ! “$authorized” == “true” ];then

msgheader=“Unauthorized Login to Server:”

message|mail -s “$SUBJECT” “$NOTIFY\_EMAIL” #Unauthorized

#person logged in…

fi

My IP file format is like this:

KNOWN\_IPS="

38.38.38.1 #-- My House

48.48.48.2 #-- Server XYZ

50.51.52.53 #-- Some other IP

"

[jsmith](https://community.freepbx.org/u/jsmith)
(Jared K Smith)
Closed

November 22, 2019, 10:15am

14

This topic was automatically closed 31 hours after the last reply. New replies are no longer allowed.

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.freepbx.org/policies/)
* [Privacy Policy](https://www.freepbx.org/policies/)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from www.freepbx.org_0e636578_20250120_232051.html ===


[Skip to content](#content "Skip to content")
Main Menu

* [Portal](https://portal.sangoma.com/)
* [Training & Support](https://www.freepbx.org/support/)
* [Security](https://github.com/FreePBX/security-reporting/security)
* [Partner](https://www.freepbx.org/partners/)
* [Contact Us](https://www.freepbx.org/contact/)

 Search

Search

 Close this search box.

[![FreePBX - Let Freedom Ring](https://www.freepbx.org/wp-content/uploads/Sangoma_FreePBX_Logo_RGB_hori-pos-e1588854523908-300x100.png)](https://www.freepbx.org)

* [Getting Started](https://www.freepbx.org/get-started/)
* [Download](https://www.freepbx.org/downloads/)
* [FreePBX 17](https://www.freepbx.org/freepbx17/)
* [Community](https://www.freepbx.org/community/)
  + [Blog](https://www.freepbx.org/blog/)
  + [Wiki](https://sangomakb.atlassian.net/wiki/spaces/FP)
  + [Forums](https://community.freepbx.org/)
  + [Events](https://www.freepbx.org/events/)
* [Products](https://www.freepbx.org/store/)
  + [Cloud & Hosting](https://www.freepbx.org/hosted-freepbx/)
  + [Add-On Modules](https://www.freepbx.org/add-ons/)
  + [Certified Appliances](https://www.freepbx.org/appliances/)
  + [IP Phones & Softphones](https://www.freepbx.org/ip-phones/)
  + [Analog & PRI Connectivity](https://www.freepbx.org/analog-pri-connectivity/)
  + [SIP Trunking](https://www.freepbx.org/sip-trunking/)
  + [Video Conferencing](https://sangoma.com/products-and-solutions/business-collaboration/video-conferencing)
  + [VoIP Security](https://www.sangoma.com/voip-security/session-border-controllers/)
  + [OEM Program](https://www.freepbx.org/oem-program/)
  + [Official Merch Store](https://teespring.com/stores/sangoma)
* [PBXact](https://www.freepbx.org/pbxact/)
  + [PBXact Cloud](https://pbxact.cloud/)
  + [PBXact Features](https://www.freepbx.org/pbxact-features/)
  + [PBXact Packages](https://www.freepbx.org/pbxact-packages/)
  + [PBXact Appliances](https://www.freepbx.org/pbxact-appliances/)

 Menu

* [Getting Started](https://www.freepbx.org/get-started/)
* [Download](https://www.freepbx.org/downloads/)
* [FreePBX 17](https://www.freepbx.org/freepbx17/)
* [Community](https://www.freepbx.org/community/)
  + [Blog](https://www.freepbx.org/blog/)
  + [Wiki](https://sangomakb.atlassian.net/wiki/spaces/FP)
  + [Forums](https://community.freepbx.org/)
  + [Events](https://www.freepbx.org/events/)
* [Products](https://www.freepbx.org/store/)
  + [Cloud & Hosting](https://www.freepbx.org/hosted-freepbx/)
  + [Add-On Modules](https://www.freepbx.org/add-ons/)
  + [Certified Appliances](https://www.freepbx.org/appliances/)
  + [IP Phones & Softphones](https://www.freepbx.org/ip-phones/)
  + [Analog & PRI Connectivity](https://www.freepbx.org/analog-pri-connectivity/)
  + [SIP Trunking](https://www.freepbx.org/sip-trunking/)
  + [Video Conferencing](https://sangoma.com/products-and-solutions/business-collaboration/video-conferencing)
  + [VoIP Security](https://www.sangoma.com/voip-security/session-border-controllers/)
  + [OEM Program](https://www.freepbx.org/oem-program/)
  + [Official Merch Store](https://teespring.com/stores/sangoma)
* [PBXact](https://www.freepbx.org/pbxact/)
  + [PBXact Cloud](https://pbxact.cloud/)
  + [PBXact Features](https://www.freepbx.org/pbxact-features/)
  + [PBXact Packages](https://www.freepbx.org/pbxact-packages/)
  + [PBXact Appliances](https://www.freepbx.org/pbxact-appliances/)

# Category: FreePBX News

## [Get AI Transcription Superpowers with Scribe for FreePBX](https://www.freepbx.org/get-ai-transcription-superpowers-with-scribe-for-freepbx/)

If you’re looking to level up your call analytics game, let me introduce you to your new AI best friend: Scribe for FreePBX. This handy commercial module for FreePBX and PBXact acts like a personal assistant specializing in transcription services, making it easier than ever to extract insights from your audio files. What’s Scribe Got

[Read More »](https://www.freepbx.org/get-ai-transcription-superpowers-with-scribe-for-freepbx/)

## [PBXact 17 – General Availability Announcement](https://www.freepbx.org/pbxact-17-general-availability-announcement/)

Hello Everyone, Since the announcement of FreePBX 17 GA, we’ve been pleased to witness its steady and growing adoption. As the FreePBX 17 install base expands, our team diligently conducts additional development and QA for PBXact, the commercially supported PBX system built on Asterisk and FreePBX. We are excited to announce the completion of our

[Read More »](https://www.freepbx.org/pbxact-17-general-availability-announcement/)

## [Takeaways from the FreePBX 17 Survey](https://www.freepbx.org/takeaways-from-freepbx-17-survey/)

At FreePBX, we value the voice of our community. We recently got some great feedback from our FreePBX 17 Experience Survey, which gave us awesome insights into the features and improvements our users want. We believe in transparency, so we’d like to share the key responses and suggestions that resonated with us.   From technical

[Read More »](https://www.freepbx.org/takeaways-from-freepbx-17-survey/)

## [Election Winning Calls and Texts: Campaigning with FreePBX 17](https://www.freepbx.org/election-winning-calls-and-texts-campaigning-with-freepbx-17/)

Ready to win your campaign this November? New this election year is the cloud-native release of the popular open source FreePBX virtual phone system, bringing together cutting-edge telephone calling features that you can privately customize in less time at significantly lower price points than one-size-fits-all competitors. Seasoned politicians know that last minute automated calls and

[Read More »](https://www.freepbx.org/election-winning-calls-and-texts-campaigning-with-freepbx-17/)

## [10 Ways to Support FreePBX](https://www.freepbx.org/10-ways-to-support-freepbx/)

The FreePBX project flourishes with the help of its community. Whether you’re a developer, writer, tester, or enthusiastic user, your contributions matter. By participating, you not only enhance the project, but also become part of a dynamic community committed to advancing open-source telephony solutions. With the launch of FreePBX 17, there’s no better time to

[Read More »](https://www.freepbx.org/10-ways-to-support-freepbx/)

Page1
[Page2](https://www.freepbx.org/category/blog/page/2/)
[Page3](https://www.freepbx.org/category/blog/page/3/)
[Page4](https://www.freepbx.org/category/blog/page/4/)
[Page5](https://www.freepbx.org/category/blog/page/5/)

* [Contact](https://www.freepbx.org/contact/)
* [Terms of Use & Policies](/wp-content/uploads/FreePBX-Terms-of-Use.pdf)
* [Documentation](https://sangomakb.atlassian.net/wiki/spaces/FP/)

* [Contact](https://www.freepbx.org/contact/)
* [Terms of Use & Policies](/wp-content/uploads/FreePBX-Terms-of-Use.pdf)
* [Documentation](https://sangomakb.atlassian.net/wiki/spaces/FP/)

Copyright © 2025 Sangoma Technologies. FreePBX is a Registered Trademark of Sangoma Technologies. All rights reserved.

[Twitter](https://twitter.com/FreePBX)

[Facebook-f](http://facebook.com/freepbx)

[Linkedin](https://www.linkedin.com/showcase/freepbx/)

[Vimeo](https://vimeo.com/sangoma/)

### Start typing and press enter to search

Search...

Scroll to Top


