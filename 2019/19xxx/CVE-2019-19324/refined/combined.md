=== Content from github.com_62c0b8c5_20250120_232319.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fpull%2F29)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fpull%2F29)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=xmidt-org%2Fcjwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmidt-org](/xmidt-org)
/
**[cjwt](/xmidt-org/cjwt)**
Public

* [Notifications](/login?return_to=%2Fxmidt-org%2Fcjwt) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Fxmidt-org%2Fcjwt)
* [Star
   16](/login?return_to=%2Fxmidt-org%2Fcjwt)

* [Code](/xmidt-org/cjwt)
* [Issues
  2](/xmidt-org/cjwt/issues)
* [Pull requests
  0](/xmidt-org/cjwt/pulls)
* [Actions](/xmidt-org/cjwt/actions)
* [Projects
  0](/xmidt-org/cjwt/projects)
* [Security](/xmidt-org/cjwt/security)
* [Insights](/xmidt-org/cjwt/pulse)

Additional navigation options

* [Code](/xmidt-org/cjwt)
* [Issues](/xmidt-org/cjwt/issues)
* [Pull requests](/xmidt-org/cjwt/pulls)
* [Actions](/xmidt-org/cjwt/actions)
* [Projects](/xmidt-org/cjwt/projects)
* [Security](/xmidt-org/cjwt/security)
* [Insights](/xmidt-org/cjwt/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fxmidt-org%2Fcjwt%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fxmidt-org%2Fcjwt%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Correct return codes and eliminiate silent failure #29

 Merged

[shilpa24balaji](/shilpa24balaji)
merged 2 commits into
[master](/xmidt-org/cjwt/tree/master "xmidt-org/cjwt:master")
from
[correct-return-codes-and-eliminiate-silent-failure](/xmidt-org/cjwt/tree/correct-return-codes-and-eliminiate-silent-failure "xmidt-org/cjwt:correct-return-codes-and-eliminiate-silent-failure")

Nov 25, 2019

 Merged

# [Correct return codes and eliminiate silent failure](#top) #29

[shilpa24balaji](/shilpa24balaji)
merged 2 commits into
[master](/xmidt-org/cjwt/tree/master "xmidt-org/cjwt:master")
from
[correct-return-codes-and-eliminiate-silent-failure](/xmidt-org/cjwt/tree/correct-return-codes-and-eliminiate-silent-failure "xmidt-org/cjwt:correct-return-codes-and-eliminiate-silent-failure")

Nov 25, 2019

[Conversation
2](/xmidt-org/cjwt/pull/29)
[Commits
2](/xmidt-org/cjwt/pull/29/commits)
[Checks
0](/xmidt-org/cjwt/pull/29/checks)
[Files changed](/xmidt-org/cjwt/pull/29/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![schmidtw](https://avatars.githubusercontent.com/u/698825?s=60&v=4)](/schmidtw)

Copy link

Member

### @schmidtw **[schmidtw](/schmidtw)** commented [Nov 22, 2019](#issue-526910181)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [schmidtw](/schmidtw)
added 2 commits
[November 21, 2019 13:38](#commits-pushed-c1cb5d9)

[![@schmidtw](https://avatars.githubusercontent.com/u/698825?s=40&v=4)](/schmidtw)

`[Correct the documentation and tests to clarify the actual failure cod…](/xmidt-org/cjwt/pull/29/commits/c1cb5d9bac5e925dcaeeea1f9ab9f67c2f2f8c16 "Correct the documentation and tests to clarify the actual failure codes for cjwt_decode().  Additionally identify and error on an unsupported algorithm instead of assigning the value to be none.  For existing consumers the functionality is the same if they discarded and ignored the alg=none.  If consumers assumed this would result in an error, then the behavior is aligned to that expectation.")`
 …

`[c1cb5d9](/xmidt-org/cjwt/pull/29/commits/c1cb5d9bac5e925dcaeeea1f9ab9f67c2f2f8c16)`

```
…es for cjwt_decode(). Additionally identify and error on an unsupported algorithm instead of assigning the value to be none. For existing consumers the functionality is the same if they discarded and ignored the alg=none. If consumers assumed this would result in an error, then the behavior is aligned to that expectation.
```

[![@schmidtw](https://avatars.githubusercontent.com/u/698825?s=40&v=4)](/schmidtw)

`[Update the changelog.](/xmidt-org/cjwt/pull/29/commits/ec138080cd526b4c7b343d4a31dd1443639488b3 "Update the changelog.")`

`[ec13808](/xmidt-org/cjwt/pull/29/commits/ec138080cd526b4c7b343d4a31dd1443639488b3)`

 [![@schmidtw](https://avatars.githubusercontent.com/u/698825?s=40&v=4)](/schmidtw)
[schmidtw](/schmidtw)
requested review from
[shilpa24balaji](/shilpa24balaji) and
[bill1600](/bill1600)
[November 22, 2019 00:04](#event-2821584297)

[![@codecov-io](https://avatars.githubusercontent.com/u/8655789?s=80&u=4694f03b321aa2287d9fe05155adcddb23272e81&v=4)](/codecov-io)

Copy link

### **[codecov-io](/codecov-io)** commented [Nov 22, 2019](#issuecomment-557328545) • edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=h1) Report Merging [#29](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=desc) into [master](https://codecov.io/gh/xmidt-org/cjwt/commit/c68ceb4cdea5288d07a44577acbc5726f710eb8e?src=pr&el=desc) will **increase** coverage by `0.45%`. The diff coverage is `84.61%`.  [Impacted file tree graph](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=tree)  ``` @@            Coverage Diff             @@ ##           master      #29      +/-   ## ========================================== + Coverage   75.11%   75.56%   +0.45%      ==========================================   Files           2        2                 Lines         442      442               ========================================== + Hits          332      334       +2      + Misses        110      108       -2 ```  | Flag | Coverage Δ |  | | --- | --- | --- | | #unittests | `75.56% <84.61%> (+0.45%)` | ⬆️ |   | [Impacted Files](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=tree) | Coverage Δ |  | | --- | --- | --- | | [tests/test\_cjwt.c](https://codecov.io/gh/xmidt-org/cjwt/pull/29/diff?src=pr&el=tree#diff-dGVzdHMvdGVzdF9jand0LmM=) | `81.48% <66.66%> (ø)` | ⬆️ | | [src/cjwt.c](https://codecov.io/gh/xmidt-org/cjwt/pull/29/diff?src=pr&el=tree#diff-c3JjL2Nqd3QuYw==) | `74.23% <90%> (+0.55%)` | ⬆️ |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=continue).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta) `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=footer). Last update [c68ceb4...ec13808](https://codecov.io/gh/xmidt-org/cjwt/pull/29?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments). |

All reactions

Sorry, something went wrong.

[![@bill1600](https://avatars.githubusercontent.com/u/17832014?s=80&v=4)](/bill1600)

Copy link

Collaborator

### **[bill1600](/bill1600)** commented [Nov 25, 2019](#issuecomment-558356866)

| I see we are not accepting algorithm none. In that case, this looks good to mw |
| --- |

All reactions

Sorry, something went wrong.

[![@shilpa24balaji](https://avatars.githubusercontent.com/u/6973022?s=40&v=4)](/shilpa24balaji)
[shilpa24balaji](/shilpa24balaji)
merged commit [`9304d3e`](/xmidt-org/cjwt/commit/9304d3e94242c1a6df77b21bde0e949392e1040a)
into
master

[Nov 25, 2019](https://github.com/xmidt-org/cjwt/pull/29#event-2829807332)

 [![@schmidtw](https://avatars.githubusercontent.com/u/698825?s=40&v=4)](/schmidtw)
[schmidtw](/schmidtw)
deleted the
correct-return-codes-and-eliminiate-silent-failure

branch
[May 21, 2021 23:42](#event-4781686285)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fpull%2F29)

Reviewers

[![@shilpa24balaji](https://avatars.githubusercontent.com/u/6973022?s=40&v=4)](/shilpa24balaji) [shilpa24balaji](/shilpa24balaji)

 Awaiting requested review from shilpa24balaji

[![@bill1600](https://avatars.githubusercontent.com/u/17832014?s=40&v=4)](/bill1600) [bill1600](/bill1600)

 Awaiting requested review from bill1600

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@schmidtw](https://avatars.githubusercontent.com/u/698825?s=52&v=4)](/schmidtw) [![@codecov-io](https://avatars.githubusercontent.com/u/8655789?s=52&v=4)](/codecov-io) [![@bill1600](https://avatars.githubusercontent.com/u/17832014?s=52&v=4)](/bill1600) [![@shilpa24balaji](https://avatars.githubusercontent.com/u/6973022?s=52&v=4)](/shilpa24balaji)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d6a4509a_20250120_232318.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fcommit%2F9304d3e94242c1a6df77b21bde0e949392e1040a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fcommit%2F9304d3e94242c1a6df77b21bde0e949392e1040a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xmidt-org%2Fcjwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmidt-org](/xmidt-org)
/
**[cjwt](/xmidt-org/cjwt)**
Public

* [Notifications](/login?return_to=%2Fxmidt-org%2Fcjwt) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Fxmidt-org%2Fcjwt)
* [Star
   16](/login?return_to=%2Fxmidt-org%2Fcjwt)

* [Code](/xmidt-org/cjwt)
* [Issues
  2](/xmidt-org/cjwt/issues)
* [Pull requests
  0](/xmidt-org/cjwt/pulls)
* [Actions](/xmidt-org/cjwt/actions)
* [Projects
  0](/xmidt-org/cjwt/projects)
* [Security](/xmidt-org/cjwt/security)
* [Insights](/xmidt-org/cjwt/pulse)

Additional navigation options

* [Code](/xmidt-org/cjwt)
* [Issues](/xmidt-org/cjwt/issues)
* [Pull requests](/xmidt-org/cjwt/pulls)
* [Actions](/xmidt-org/cjwt/actions)
* [Projects](/xmidt-org/cjwt/projects)
* [Security](/xmidt-org/cjwt/security)
* [Insights](/xmidt-org/cjwt/pulse)

## Commit

[Permalink](/xmidt-org/cjwt/commit/9304d3e94242c1a6df77b21bde0e949392e1040a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#29](https://github.com/xmidt-org/cjwt/pull/29) from xmidt-org/correct-return-codes-and-elimin…

[Browse files](/xmidt-org/cjwt/tree/9304d3e94242c1a6df77b21bde0e949392e1040a)
Browse the repository at this point in the history

```
…iate-silent-failure

Correct return codes and eliminiate silent failure
```

* Loading branch information

[![@shilpa24balaji](https://avatars.githubusercontent.com/u/6973022?s=40&v=4)](/shilpa24balaji)

[shilpa24balaji](/xmidt-org/cjwt/commits?author=shilpa24balaji "View all commits by shilpa24balaji")
authored
Nov 25, 2019

2 parents
[c68ceb4](/xmidt-org/cjwt/commit/c68ceb4cdea5288d07a44577acbc5726f710eb8e)
+
[ec13808](/xmidt-org/cjwt/commit/ec138080cd526b4c7b343d4a31dd1443639488b3)

commit 9304d3e

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**98 additions**
and
**92 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* src

  + src/cjwt.c
    [cjwt.c](#diff-06f043560e17e2bc76d5c351f1c3a974b374ae897b85584dd1af52111b322a75)
  + src/cjwt.h
    [cjwt.h](#diff-66784cbd20b73e89e0686664882c647646b92339b2060c1a86989046325fe7d0)
* tests

  + inputs

    - tests/inputs/jwtbadalg.txt
      [jwtbadalg.txt](#diff-4e42314fa69c516d698ed3c3c0da6a798513b9bd5e1192bfe70e3d85ff9f9f17)
  + tests/test\_cjwt.c
    [test\_cjwt.c](#diff-bf0f0eb14a72f1243b43cef03a0f4e9a986cab23c84c83b5440ded90d4b5c6de)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/xmidt-org/cjwt/blob/9304d3e94242c1a6df77b21bde0e949392e1040a/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,10 +7,13 @@ and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0. |
|  |  | ## [Unreleased] |
|  |  | ### Added |
|  |  | - Valgrind checking and fixes. |
|  |  | - Algorithms that are unsupported now are not mapped to alg=none to prevent untrusted |
|  |  | accidental acceptance of JWT. |
|  |  |  |
|  |  | ### Changed |
|  |  | - Fixed memory leaks. |
|  |  | - Updated the CONTRIBUTION document. |
|  |  | - Updated the cjwt\_decode() documentation to be accurate and consistent. |
|  |  |  |
|  |  | ## [1.0.1] |
|  |  | ### Added |
| Expand Down | |  |

35 changes: 18 additions & 17 deletions

35
[src/cjwt.c](#diff-06f043560e17e2bc76d5c351f1c3a974b374ae897b85584dd1af52111b322a75 "src/cjwt.c")

Show comments

[View file](/xmidt-org/cjwt/blob/9304d3e94242c1a6df77b21bde0e949392e1040a/src/cjwt.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -117,16 +117,6 @@ int cjwt\_alg\_str\_to\_enum( const char \*alg\_str ) |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | static cjwt\_alg\_t \_\_cjwt\_alg\_str\_to\_enum( const char \*alg\_str ) |
|  |  | { |
|  |  | int alg = cjwt\_alg\_str\_to\_enum (alg\_str); |
|  |  |  |
|  |  | if (alg >= 0) |
|  |  | return alg; |
|  |  | else |
|  |  | return alg\_none; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | inline static void cjwt\_delete\_child\_json( cJSON\* j, const char\* s ) |
|  |  | { |
| Expand Down  Expand Up | | @@ -357,12 +347,14 @@ static int cjwt\_verify\_signature( cjwt\_t \*p\_jwt, char \*p\_in, const char \*p\_sign |
|  |  | if( sz\_signed != out\_size ) { |
|  |  | cjwt\_info( "Signature length mismatch: enc %d, signature %d\n", |
|  |  | ( int )sz\_signed, ( int )out\_size ); |
|  |  | ret = -1; |
|  |  | ret = EINVAL; |
|  |  | goto err\_match; |
|  |  | } |
|  |  |  |
|  |  | ret = CRYPTO\_memcmp( |
|  |  | ( unsigned char\* )signed\_out, ( unsigned char\* )signed\_dec, out\_size ); |
|  |  | if( 0 != CRYPTO\_memcmp(signed\_out, signed\_dec, out\_size) ) { |
|  |  | ret = EINVAL; |
|  |  | } |
|  |  |  |
|  |  | err\_match: |
|  |  | free( signed\_dec ); |
|  |  | err\_decode: |
| Expand All | | @@ -384,7 +376,8 @@ static int cjwt\_update\_payload( cjwt\_t \*p\_cjwt, char \*p\_decpl ) |
|  |  | cJSON \*j\_payload = cJSON\_Parse( ( char\* )p\_decpl ); |
|  |  |  |
|  |  | if( !j\_payload ) { |
|  |  | return ENOMEM; |
|  |  | // The data is probably not json vs. memory allocation error. |
|  |  | return EINVAL; |
|  |  | } |
|  |  |  |
|  |  | //extract data |
| Expand Down  Expand Up | | @@ -562,6 +555,7 @@ static int cjwt\_update\_payload( cjwt\_t \*p\_cjwt, char \*p\_decpl ) |
|  |  | } |
|  |  |  |
|  |  | static int cjwt\_update\_header( cjwt\_t \*p\_cjwt, char \*p\_dechead ) |
|  |  | // The data is probably not json vs. memory allocation error. |
|  |  | { |
|  |  | if( !p\_cjwt || !p\_dechead ) { |
|  |  | return EINVAL; |
| Expand All | | @@ -571,7 +565,8 @@ static int cjwt\_update\_header( cjwt\_t \*p\_cjwt, char \*p\_dechead ) |
|  |  | cJSON \*j\_header = cJSON\_Parse( ( char\* )p\_dechead ); |
|  |  |  |
|  |  | if( !j\_header ) { |
|  |  | return ENOMEM; |
|  |  | // The data is probably not json vs. memory allocation error. |
|  |  | return EINVAL; |
|  |  | } |
|  |  |  |
|  |  | cjwt\_info( "Json = %s\n", cJSON\_Print( j\_header ) ); |
| Expand All | | @@ -586,7 +581,14 @@ static int cjwt\_update\_header( cjwt\_t \*p\_cjwt, char \*p\_dechead ) |
|  |  | cJSON\* j\_alg = cJSON\_GetObjectItem( j\_header, "alg" ); |
|  |  |  |
|  |  | if( j\_alg ) { |
|  |  | p\_cjwt->header.alg = \_\_cjwt\_alg\_str\_to\_enum( j\_alg->valuestring ); |
|  |  | int alg; |
|  |  |  |
|  |  | alg = cjwt\_alg\_str\_to\_enum( j\_alg->valuestring ); |
|  |  | if( -1 == alg ) { |
|  |  | cJSON\_Delete( j\_header ); |
|  |  | return ENOTSUP; |
|  |  | } |
|  |  | p\_cjwt->header.alg = alg; |
|  |  | } |
|  |  |  |
|  |  | //destroy cJSON object |
| Expand Down  Expand Up | | @@ -711,7 +713,6 @@ int cjwt\_decode( const char \*encoded, unsigned int options, cjwt\_t \*\*jwt, |
|  |  | int ret = 0; |
|  |  | char \*payload, \*signature; |
|  |  | ( void )options; //suppressing unused parameter warning |
|  |  | ( void ) options; |
|  |  |  |
|  |  | //validate inputs |
|  |  | if( !encoded || !jwt ) { |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[src/cjwt.h](#diff-66784cbd20b73e89e0686664882c647646b92339b2060c1a86989046325fe7d0 "src/cjwt.h")

Show comments

[View file](/xmidt-org/cjwt/blob/9304d3e94242c1a6df77b21bde0e949392e1040a/src/cjwt.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,7 +93,7 @@ typedef struct { |
|  |  | \* The function to use to decode and validate a JWT. |
|  |  | \* |
|  |  | \* @note This function allocates memory associated with the output jwt that |
|  |  | \* must be freed. cjwt\_destroy() must be called to destry the object |
|  |  | \* must be freed. cjwt\_destroy() must be called to destroy the object |
|  |  | \* when we are done with it. |
|  |  | \* |
|  |  | \* @note This function does not |
| Expand All | | @@ -105,10 +105,10 @@ typedef struct { |
|  |  | \* @param key [IN] the public key to use for validating the signature |
|  |  | \* @param key\_len [IN] the length of the key in bytes |
|  |  | \* |
|  |  | \* @retval  0 successful |
|  |  | \* @retval -1 invalid jwt format |
|  |  | \* @retval -2 mismatched key |
|  |  | \* ... etc |
|  |  | \* @retval 0  successful |
|  |  | \* @retval EINVAL invalid jwt format or mismatched key |
|  |  | \* @retval ENOMEM unable to allocate needed memory |
|  |  | \* @retval ENOTSUP unsupported algorithm |
|  |  | \*/ |
|  |  | int cjwt\_decode( const char \*encoded, unsigned int options, cjwt\_t \*\*jwt, |
|  |  | const uint8\_t \*key, size\_t key\_len ); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[tests/inputs/jwtbadalg.txt](#diff-4e42314fa69c516d698ed3c3c0da6a798513b9bd5e1192bfe70e3d85ff9f9f17 "tests/inputs/jwtbadalg.txt")

Show comments

[View file](/xmidt-org/cjwt/blob/9304d3e94242c1a6df77b21bde0e949392e1040a/tests/inputs/jwtbadalg.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1 @@ |
|  |  | eyAiYWxnIjogImludmFsaWQiLCAidHlwIjogIkpXVCIgfQ.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV\_adQssw5c |

141 changes: 71 additions & 70 deletions

141
[tests/test\_cjwt.c](#diff-bf0f0eb14a72f1243b43cef03a0f4e9a986cab23c84c83b5440ded90d4b5c6de "tests/test_cjwt.c")

Show comments

[View file](/xmidt-org/cjwt/blob/9304d3e94242c1a6df77b21bde0e949392e1040a/tests/test_cjwt.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,79 +29,80 @@ |
|  |  | #include "../src/cjwt.h" |
|  |  |  |
|  |  | typedef struct { |
|  |  | bool expected; |
|  |  | int expected; |
|  |  | const char \*jwt\_file\_name; |
|  |  | bool is\_key\_in\_file; |
|  |  | const char \*key; |
|  |  | const char \*decode\_test\_name; |
|  |  | } test\_case\_t; |
|  |  |  |
|  |  | test\_case\_t test\_list[] = { |
|  |  | {true, "jwtn.txt", false, "", "No Alg claims on on"}, |
|  |  | {true, "jwtnx.txt", false, "", "No Alg claims off on"}, |
|  |  | {true, "jwtny.txt", false, "", "No Alg claims off off"}, |
|  |  | {false, "jwtia.txt", false, "test\_passwd1", "HS256 invalid jwt"}, |
|  |  | {false, "jwtib.txt", false, "test\_passwd1", "HS256 invalid jwt"}, |
|  |  | //{false, "jwtic.txt", false, "test\_passwd1", "HS256 invalid jwt"}, /\*TBD \*/ //FAILED test after modifying verify\_signature logic |
|  |  | {false, "jwtid.txt", false, "test\_passwd1", "HS256 invalid jwt"}, |
|  |  | {false, "jwtie.txt", false, "test\_passwd1", "HS256 invalid jwt"}, |
|  |  | {false, "jwtif.txt", false, "test\_passwd1", "HS256 invalid jwt"}, |
|  |  | {true, "jwt1.txt", false, "test\_passwd1", "HS256 claims on on"}, |
|  |  | {false, "jwt1.txt", false, "test\_passbad", "HS256 claims on on"}, |
|  |  | {true, "jwt2.txt", false, "test\_passwd2", "HS384 claims on on"}, |
|  |  | {false, "jwt2.txt", false, "test\_passbad", "HS384 claims on on"}, |
|  |  | {true, "jwt3.txt", false, "test\_passwd3", "HS512 claims on on"}, |
|  |  | {false, "jwt3.txt", false, "test\_passbad", "HS512 claims on on"}, |
|  |  | {true, "jwt5.txt", true, "pubkey5.pem", "RS384 claims on on"}, |
|  |  | {false, "jwt5.txt", true, "badkey4.pem", "RS384 claims on on"}, |
|  |  | {true, "jwt4.txt", true, "pubkey4.pem", "RS256 claims on on"}, |
|  |  | {false, "jwt4.txt", true, "badkey4.pem", "RS256 claims on on"}, |
|  |  | {true, "jwt6.txt", true, "pubkey6.pem", "RS512 claims on on"}, |
|  |  | {false, "jwt6.txt", true, "badkey6.pem", "RS512 claims on on"}, |
|  |  | {true, "jwt1x.txt", false, "test\_passwd1", "HS256 claims off on"}, |
|  |  | {false, "jwt1x.txt", false, "test\_prasswd1", "HS256 claims off on"}, |
|  |  | {true, "jwt2x.txt", false, "test\_passwd2", "HS384 claims off on"}, |
|  |  | {false, "jwt2x.txt", false, "twest\_passwd2", "HS384 claims off on"}, |
|  |  | {true, "jwt3x.txt", false, "test\_passwd3", "HS512 claims off on"}, |
|  |  | {false, "jwt3x.txt", false, "test\_passwd3...", "HS512 claims off on"}, |
|  |  | {true, "jwt4x.txt", true, "pubkey4.pem", "RS256 claims off on"}, |
|  |  | {false, "jwt4x.txt", true, "pubkey5.pem", "RS256 claims off on"}, |
|  |  | {true, "jwt5x.txt", true, "pubkey5.pem", "RS384 claims off on"}, |
|  |  | {false, "jwt5x.txt", true, "badkey5.pem", "RS384 claims off on"}, |
|  |  | {true, "jwt6x.txt", true, "pubkey6.pem", "RS512 claims off on"}, |
|  |  | {false, "jwt6x.txt", true, "badkey6.pem", "RS512 claims off on"}, |
|  |  | {true, "jwt1y.txt", false, "test\_passwd1", "HS256 claims off off"}, |
|  |  | {false, "jwt1y.txt", false, "tast\_passwd1", "HS256 claims off off"}, |
|  |  | {true, "jwt2y.txt", false, "test\_passwd2", "HS384 claims off off"}, |
|  |  | {false, "jwt2y.txt", false, "test..passwd2", "HS384 claims off off"}, |
|  |  | {true, "jwt3y.txt", false, "test\_passwd3", "HS512 claims off off"}, |
|  |  | {false, "jwt3y.txt", false, "tteesstt\_passwd3", "HS512 claims off off"}, |
|  |  | {true, "jwt4y.txt", true, "pubkey4.pem", "RS256 claims off off"}, |
|  |  | {false, "jwt4y.txt", true, "badkey4.pem", "RS256 claims off off"}, |
|  |  | {true, "jwt5y.txt", true, "pubkey5.pem", "RS384 claims off off"}, |
|  |  | {false, "jwt5y.txt", true, "pubkey6.pem", "RS384 claims off off"}, |
|  |  | {true, "jwt6y.txt", true, "pubkey6.pem", "RS512 claims off off"}, |
|  |  | {false, "jwt6y.txt", true, "pubkey5.pem", "RS512 claims off off"}, |
|  |  | {true, "jwt1l.txt", false, "test\_passwd1", "HS256 claims long"}, |
|  |  | {false, "jwt1l.txt", false, "test\_keyword1", "HS256 claims long"}, |
|  |  | {true, "jwt2l.txt", false, "test\_passwd2", "HS384 claims long"}, |
|  |  | {false, "jwt2l.txt", false, "test\_passwd1", "HS384 claims long"}, |
|  |  | {true, "jwt3l.txt", false, "test\_passwd3", "HS512 claims long"}, |
|  |  | {false, "jwt3l.txt", false, "passwd3", "HS512 claims long"}, |
|  |  | {true, "jwt4l.txt", true, "pubkey4.pem", "RS256 claims long"}, |
|  |  | {false, "jwt4l.txt", true, "badkey4.pem", "RS256 claims long"}, |
|  |  | {true, "jwt5l.txt", true, "pubkey5.pem", "RS384 claims long"}, |
|  |  | {false, "jwt5l.txt", true, "badkey5.pem", "RS384 claims long"}, |
|  |  | {true, "jwt6l.txt", true, "pubkey6.pem", "RS512 claims long"}, |
|  |  | {false, "jwt6l.txt", true, "badkey6.pem", "RS512 claims long"}, |
|  |  | {true, "jwt2.txt", false, "test\_passwd2", "HS384 claims on on"}, |
|  |  | {true, "jwt3.txt", false, "test\_passwd3", "HS512 claims on on"}, |
|  |  | {true, "jwt8\_hs256.txt", true, "key8\_hs256.pem", "HS256 claims on on"}, |
|  |  | {true, "jwt9\_hs384.txt", true, "key9\_hs384.pem", "HS384 claims on on"}, |
|  |  | {true, "jwt10\_hs512.txt", true, "key10\_hs512.pem", "HS512 claims on on"}, |
|  |  | {false, "jwt11.txt", false, "incorrect\_key", "RS256 claims all"}, |
|  |  | {false, "jwt12.txt", false, "incorrect\_key", "RS256 claims all"}, |
|  |  | {false, "jwt13.txt", false, "incorrect\_key", "RS256 claims all"} |
|  |  | { 0, "jwtn.txt", false, "", "No Alg claims on on" }, |
|  |  | { 0, "jwtnx.txt", false, "", "No Alg claims off on" }, |
|  |  | { 0, "jwtny.txt", false, "", "No Alg claims off off" }, |
|  |  | { EINVAL, "jwtia.txt", false, "test\_passwd1", "HS256 invalid jwt" }, |
|  |  | { EINVAL, "jwtib.txt", false, "test\_passwd1", "HS256 invalid jwt" }, |
|  |  | // { EINVAL, "jwtic.txt", false, "test\_passwd1", "HS256 invalid jwt" }, /\*TBD \*/ //FAILED test after modifying verify\_signature logic |
|  |  | { EINVAL, "jwtid.txt", false, "test\_passwd1", "HS256 invalid jwt" }, |
|  |  | { EINVAL, "jwtie.txt", false, "test\_passwd1", "HS256 invalid jwt" }, |
|  |  | { EINVAL, "jwtif.txt", false, "test\_passwd1", "HS256 invalid jwt" }, |
|  |  | { 0, "jwt1.txt", false, "test\_passwd1", "HS256 claims on on" }, |
|  |  | { EINVAL, "jwt1.txt", false, "test\_passbad", "HS256 claims on on" }, |
|  |  | { 0, "jwt2.txt", false, "test\_passwd2", "HS384 claims on on" }, |
|  |  | { EINVAL, "jwt2.txt", false, "test\_passbad", "HS384 claims on on" }, |
|  |  | { 0, "jwt3.txt", false, "test\_passwd3", "HS512 claims on on" }, |
|  |  | { EINVAL, "jwt3.txt", false, "test\_passbad", "HS512 claims on on" }, |
|  |  | { 0, "jwt5.txt", true, "pubkey5.pem", "RS384 claims on on" }, |
|  |  | { EINVAL, "jwt5.txt", true, "badkey4.pem", "RS384 claims on on" }, |
|  |  | { 0, "jwt4.txt", true, "pubkey4.pem", "RS256 claims on on" }, |
|  |  | { EINVAL, "jwt4.txt", true, "badkey4.pem", "RS256 claims on on" }, |
|  |  | { 0, "jwt6.txt", true, "pubkey6.pem", "RS512 claims on on" }, |
|  |  | { EINVAL, "jwt6.txt", true, "badkey6.pem", "RS512 claims on on" }, |
|  |  | { 0, "jwt1x.txt", false, "test\_passwd1", "HS256 claims off on" }, |
|  |  | { EINVAL, "jwt1x.txt", false, "test\_prasswd1", "HS256 claims off on" }, |
|  |  | { 0, "jwt2x.txt", false, "test\_passwd2", "HS384 claims off on" }, |
|  |  | { EINVAL, "jwt2x.txt", false, "twest\_passwd2", "HS384 claims off on" }, |
|  |  | { 0, "jwt3x.txt", false, "test\_passwd3", "HS512 claims off on" }, |
|  |  | { EINVAL, "jwt3x.txt", false, "test\_passwd3...", "HS512 claims off on" }, |
|  |  | { 0, "jwt4x.txt", true, "pubkey4.pem", "RS256 claims off on" }, |
|  |  | { EINVAL, "jwt4x.txt", true, "pubkey5.pem", "RS256 claims off on" }, |
|  |  | { 0, "jwt5x.txt", true, "pubkey5.pem", "RS384 claims off on" }, |
|  |  | { EINVAL, "jwt5x.txt", true, "badkey5.pem", "RS384 claims off on" }, |
|  |  | { 0, "jwt6x.txt", true, "pubkey6.pem", "RS512 claims off on" }, |
|  |  | { EINVAL, "jwt6x.txt", true, "badkey6.pem", "RS512 claims off on" }, |
|  |  | { 0, "jwt1y.txt", false, "test\_passwd1", "HS256 claims off off" }, |
|  |  | { EINVAL, "jwt1y.txt", false, "tast\_passwd1", "HS256 claims off off" }, |
|  |  | { 0, "jwt2y.txt", false, "test\_passwd2", "HS384 claims off off" }, |
|  |  | { EINVAL, "jwt2y.txt", false, "test..passwd2", "HS384 claims off off" }, |
|  |  | { 0, "jwt3y.txt", false, "test\_passwd3", "HS512 claims off off" }, |
|  |  | { EINVAL, "jwt3y.txt", false, "tteesstt\_passwd3", "HS512 claims off off" }, |
|  |  | { 0, "jwt4y.txt", true, "pubkey4.pem", "RS256 claims off off" }, |
|  |  | { EINVAL, "jwt4y.txt", true, "badkey4.pem", "RS256 claims off off" }, |
|  |  | { 0, "jwt5y.txt", true, "pubkey5.pem", "RS384 claims off off" }, |
|  |  | { EINVAL, "jwt5y.txt", true, "pubkey6.pem", "RS384 claims off off" }, |
|  |  | { 0, "jwt6y.txt", true, "pubkey6.pem", "RS512 claims off off" }, |
|  |  | { EINVAL, "jwt6y.txt", true, "pubkey5.pem", "RS512 claims off off" }, |
|  |  | { 0, "jwt1l.txt", false, "test\_passwd1", "HS256 claims long" }, |
|  |  | { EINVAL, "jwt1l.txt", false, "test\_keyword1", "HS256 claims long" }, |
|  |  | { 0, "jwt2l.txt", false, "test\_passwd2", "HS384 claims long" }, |
|  |  | { EINVAL, "jwt2l.txt", false, "test\_passwd1", "HS384 claims long" }, |
|  |  | { 0, "jwt3l.txt", false, "test\_passwd3", "HS512 claims long" }, |
|  |  | { EINVAL, "jwt3l.txt", false, "passwd3", "HS512 claims long" }, |
|  |  | { 0, "jwt4l.txt", true, "pubkey4.pem", "RS256 claims long" }, |
|  |  | { EINVAL, "jwt4l.txt", true, "badkey4.pem", "RS256 claims long" }, |
|  |  | { 0, "jwt5l.txt", true, "pubkey5.pem", "RS384 claims long" }, |
|  |  | { EINVAL, "jwt5l.txt", true, "badkey5.pem", "RS384 claims long" }, |
|  |  | { 0, "jwt6l.txt", true, "pubkey6.pem", "RS512 claims long" }, |
|  |  | { EINVAL, "jwt6l.txt", true, "badkey6.pem", "RS512 claims long" }, |
|  |  | { 0, "jwt2.txt", false, "test\_passwd2", "HS384 claims on on" }, |
|  |  | { 0, "jwt3.txt", false, "test\_passwd3", "HS512 claims on on" }, |
|  |  | { 0, "jwt8\_hs256.txt", true, "key8\_hs256.pem", "HS256 claims on on" }, |
|  |  | { 0, "jwt9\_hs384.txt", true, "key9\_hs384.pem", "HS384 claims on on" }, |
|  |  | { 0, "jwt10\_hs512.txt", true, "key10\_hs512.pem", "HS512 claims on on" }, |
|  |  | { EINVAL, "jwt11.txt", false, "incorrect\_key", "RS256 claims all" }, |
|  |  | { EINVAL, "jwt12.txt", false, "incorrect\_key", "RS256 claims all" }, |
|  |  | { EINVAL, "jwt13.txt", false, "incorrect\_key", "RS256 claims all" }, |
|  |  | { ENOTSUP, "jwtbadalg.txt", false, "incorrect\_key", "Invalid/unsupported alg." } |
|  |  | }; |
|  |  |  |
|  |  | #define \_NUM\_TEST\_CASES ( sizeof(test\_list) / sizeof(test\_case\_t) ) |
| Expand Down  Expand Up | | @@ -161,7 +162,7 @@ void test\_case (unsigned \_i ) |
|  |  | const char \*jwt\_fname; |
|  |  | const char \*key\_str; |
|  |  | const char \*decode\_test\_name; |
|  |  | bool expected; |
|  |  | int expected; |
|  |  | int key\_len; |
|  |  | ssize\_t jwt\_bytes; |
|  |  | int result = 0; |
| Expand Down  Expand Up | | @@ -207,16 +208,16 @@ void test\_case (unsigned \_i ) |
|  |  | result = jwt\_bytes; |
|  |  | } |
|  |  |  |
|  |  | if( expected == ( result == 0 ) ) { |
|  |  | if( expected == result ) { |
|  |  | printf( "--- PASSED: %s\n", decode\_test\_name ); |
|  |  | pass\_cnt += 1; |
|  |  | } else { |
|  |  | printf( "--- FAILED: %s\n", decode\_test\_name ); |
|  |  | printf( "\e[01;31m--- FAILED: %s (%d != %d)\e[00m\n", decode\_test\_name, expected, result ); |
|  |  | fail\_cnt += 1; |
|  |  | } |
|  |  |  |
|  |  | cjwt\_destroy( &jwt ); |
|  |  | CU\_ASSERT\_EQUAL ( expected, ( result == 0 ) ); |
|  |  | CU\_ASSERT ( expected == result ); |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9304d3e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmidt-org%2Fcjwt%2Fcommit%2F9304d3e94242c1a6df77b21bde0e949392e1040a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


