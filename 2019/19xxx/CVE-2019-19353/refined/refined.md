```
{
  "cve": "CVE-2019-19353",
  "description": "The vulnerability details that when a Dockerfile alters the permissions of it’s own `/etc/passwd` file, it allows for any user (within that container) to escalate to root.\n\nFor example, take the following Dockerfile from the Jenkins image:\n\n```\nRUN /usr/local/bin/install-jenkins-core-plugins.sh /opt/openshift/base-plugins.txt && \\\n    rmdir /var/log/jenkins && \\\n    chmod 664 /etc/passwd && \\\n    chmod -R 775 /etc/alternatives && \\\n    chmod -R 775 /var/lib/alternatives && \\\n    chmod -R 775 /usr/lib/jvm && \\\n    chmod 775 /usr/bin && \\\n    chmod 775 /usr/lib/jvm-exports && \\\n    chmod 775 /usr/share/man/man1 && \\\n    mkdir -p /var/lib/origin && \\\n    chmod 775 /var/lib/origin && \\\n    chown -R 1001:0 /opt/openshift && \\\n```\n\nAs discussed previously, `chmod 664 /etc/passwd` not only allows the random user’s data to be added to the `/etc/passwd` file, but also allows any process from within that container to modify `/etc/passwd`.",
  "affected_products": [
    "operator-framework/hive"
   ],
  "root_cause": "The container image modifies the permissions of /etc/passwd to be group writable. This allows any user within the container to modify the /etc/passwd file.",
  "vulnerabilities": [
    "Incorrect permissions on `/etc/passwd`",
    "Privilege escalation within the container."
  ],
  "impact": "An attacker with access to the container can modify `/etc/passwd` to add a new root user and escalate their privileges within the container.",
  "attack_vectors": [
     "Attacker gains access to a running container instance"
  ],
   "attacker_capabilities": "The attacker needs to have the ability to execute commands inside the container. By default, OpenShift runs containers in a restricted security context, blocking `SETUID` and `SETGID` syscalls. However, the vulnerability can be exploited by adding a new root user to the `/etc/passwd` file and then switching to that user.",
    "additional_notes": "While OpenShift's restricted SCC mitigates direct host access, this vulnerability still represents a privilege escalation within the container, increasing the attack surface. The fix involves relying on CRI-O to insert random user information into `/etc/passwd` or utilizing `nss_wrapper` for local user mapping."
}
```