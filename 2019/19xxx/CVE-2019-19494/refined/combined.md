=== Content from cablehaunt.com_f90f4ae0_20250120_233017.html ===




=== Content from github.com_4ae8bc97_20250120_233021.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLyrebirds%2Fsagemcom-fast-3890-exploit)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLyrebirds%2Fsagemcom-fast-3890-exploit)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Lyrebirds%2Fsagemcom-fast-3890-exploit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Lyrebirds](/Lyrebirds)
/
**[sagemcom-fast-3890-exploit](/Lyrebirds/sagemcom-fast-3890-exploit)**
Public

* [Notifications](/login?return_to=%2FLyrebirds%2Fsagemcom-fast-3890-exploit) You must be signed in to change notification settings
* [Fork
  49](/login?return_to=%2FLyrebirds%2Fsagemcom-fast-3890-exploit)
* [Star
   220](/login?return_to=%2FLyrebirds%2Fsagemcom-fast-3890-exploit)

[220
stars](/Lyrebirds/sagemcom-fast-3890-exploit/stargazers) [49
forks](/Lyrebirds/sagemcom-fast-3890-exploit/forks) [Branches](/Lyrebirds/sagemcom-fast-3890-exploit/branches) [Tags](/Lyrebirds/sagemcom-fast-3890-exploit/tags) [Activity](/Lyrebirds/sagemcom-fast-3890-exploit/activity)
 [Star](/login?return_to=%2FLyrebirds%2Fsagemcom-fast-3890-exploit)

 [Notifications](/login?return_to=%2FLyrebirds%2Fsagemcom-fast-3890-exploit) You must be signed in to change notification settings

* [Code](/Lyrebirds/sagemcom-fast-3890-exploit)
* [Issues
  3](/Lyrebirds/sagemcom-fast-3890-exploit/issues)
* [Pull requests
  0](/Lyrebirds/sagemcom-fast-3890-exploit/pulls)
* [Actions](/Lyrebirds/sagemcom-fast-3890-exploit/actions)
* [Projects
  0](/Lyrebirds/sagemcom-fast-3890-exploit/projects)
* [Security](/Lyrebirds/sagemcom-fast-3890-exploit/security)
* [Insights](/Lyrebirds/sagemcom-fast-3890-exploit/pulse)

Additional navigation options

* [Code](/Lyrebirds/sagemcom-fast-3890-exploit)
* [Issues](/Lyrebirds/sagemcom-fast-3890-exploit/issues)
* [Pull requests](/Lyrebirds/sagemcom-fast-3890-exploit/pulls)
* [Actions](/Lyrebirds/sagemcom-fast-3890-exploit/actions)
* [Projects](/Lyrebirds/sagemcom-fast-3890-exploit/projects)
* [Security](/Lyrebirds/sagemcom-fast-3890-exploit/security)
* [Insights](/Lyrebirds/sagemcom-fast-3890-exploit/pulse)

# Lyrebirds/sagemcom-fast-3890-exploit

    master[Branches](/Lyrebirds/sagemcom-fast-3890-exploit/branches)[Tags](/Lyrebirds/sagemcom-fast-3890-exploit/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[31 Commits](/Lyrebirds/sagemcom-fast-3890-exploit/commits/master/) | | |
| [static](/Lyrebirds/sagemcom-fast-3890-exploit/tree/master/static "static") | | [static](/Lyrebirds/sagemcom-fast-3890-exploit/tree/master/static "static") |  |  |
| [README.md](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/README.md "README.md") | | [README.md](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/README.md "README.md") |  |  |
| [VULNERABLE.md](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/VULNERABLE.md "VULNERABLE.md") | | [VULNERABLE.md](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/VULNERABLE.md "VULNERABLE.md") |  |  |
| [exploit.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/exploit.py "exploit.py") | | [exploit.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/exploit.py "exploit.py") |  |  |
| [exploit.raw](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/exploit.raw "exploit.raw") | | [exploit.raw](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/exploit.raw "exploit.raw") |  |  |
| [remote.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/remote.py "remote.py") | | [remote.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/remote.py "remote.py") |  |  |
| [reverseshell.c](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/reverseshell.c "reverseshell.c") | | [reverseshell.c](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/reverseshell.c "reverseshell.c") |  |  |
| [utf8TestScript.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/utf8TestScript.py "utf8TestScript.py") | | [utf8TestScript.py](/Lyrebirds/sagemcom-fast-3890-exploit/blob/master/utf8TestScript.py "utf8TestScript.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# Sagemcom Fast 3890 exploit

This exploit uses the [Cable Haunt vulnerability](https://cablehaunt.com) to pop a shell on the Sagemcom F@ST 3890 (50.10.19\*) cable modem, from local network access. Firmware version 50.10.21 or newer should be secure against Cable Haunt. This Proof of concept has specifically been designed to only work locally to limit the potential for malicious purposes. Another POC that creates a reverse shell to an external connection for the Technicolor TC7230 is available [here](https://github.com/Lyrebirds/technicolor-tc7230-exploit).

A list of known vulnerable modems can be found on <https://cablehaunt.com/#faq-am-i-affected>.

## How it works

The exploit.py serves a website, that when visited, sends a malicious WebSocket request to the cable modem.
This request overflows the return address and accompanying registers in the Spectrum Analyzer of the cable modem, and uses a ROP-chain to start listening for a TCP connection on port 1337.
The ROP-chain is constructed and commented in `static/exploitSagemcom.js`.
The exploit.py server then sends the exploit.raw file over this TCP connection which will then be executed by the modem.
The exploit.raw file is reverseshell.c compiled to MIPS architecture (see below how).
Reverseshell.c is a shell written explicitly for this modem. The shell listens for commands to be run in the eCos shell on the cable modem and redirect STDOUT to the TCP connection.

You can find a video explaining the exploit here: <https://www.youtube.com/watch?v=5FM9mS5ck3Y>

## Running the exploit

**Note: Windows 10 is not currently supported, you must use a Linux based OS**

Install pwntools and flask for python3 and run `python exploit.py`.
Now go to <http://127.0.0.1:8080> in your browser, to exploit the modem.
Firefox will not work for this, as the WebSocket version used is not compatible.

Now an interactive shell should pop in your terminal running the python script.
If you exit the shell, the modem needs to be rebooted to start a new shell.

## Building your own payload

If you want to compile your own payload you can grab the toolchain from [aeolus](https://github.com/Broadcom/aeolus) and run the following command:

```
/<toolchain Path>/gnutools/mipsisa32-elf/bin/mipsisa32-elf-gcc -O3 -c ./reverseshell.c -o ./reverseshell.o && /<toolchain Path>/toolchains/gnutools/mipsisa32-elf/bin/mipsisa32-elf-objcopy -O binary reverseshell.o exploit.raw

```

# Exploiting other modems

You can build and exploit any modem vulnerable to Cable Haunt using this technique.
We recommend reading the [techincal report](https://github.com/Lyrebirds/Cable-Haunt-Report/releases/latest/download/report.pdf) before trying to write your own ROP-chain.
Go to [Cable Haunt](https://cablehaunt.com) for a list of known vulnerable cable modems.

### Building the ROP chain

First, you will need the firmware for the cable modem you're going to exploit.
Then, reverse engineer the firmware to find the addresses of the relevant function for building the exploit such as socket(), bind(), accept(), listen(), recv() and connect() for a shell.
Then [Ropper](https://github.com/sashs/Ropper) can be used to find gadgets using the following command:

```
python Ropper.py --type all --all --badbytes 00c0c1f5f6f7f8f9fafbfcfdfeff2c -r -a MIPSBE -I 0x80004000 --console -f <firmware path>

```

### Unreachable gadgets

Not all gadgets can be reached, as gadgets are just addresses sent as raw bytes and not all bytes can be sent as a WebSocket request with text frames.
For instance, the address 0x8080a864 can not directly be inserted in a WebSocket text frame, as it is not a valid UTF-8 character. The address 0xf28080a864 can however be inserted, as 0xf2 means start new UTF-8 symbol with 0x8080a864 as the trailing bytes.
The following bytes cannot be present in any address used because of the utf-8 specification: 0x00, 0xc0,0xc1,0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff, 0x2c. Other restrictions also exists which will soon be explained further in our report.
For now, you can read and use `utf8TestScript.py` to test if an address if reachable.

### Custom payload

You can use the process described above to compile your own payload for new cable modem but remember that the payload must not return! If it returns, the process will look for a return address on the smashed stack and crash.

## Extracting firmware from Cable Modems

For most modems, you will need a way to access the eCos shell to extract the firmware or extracting it directly from the flash chip.
These firmwares are usually packed in a format called [ProgramStore](https://github.com/jclehner/bcm2-utils/blob/master/FIRMWARE.md)
If the serial console is not working try running: (might only work if coax cable is disconnected or not provisioned)

```
snmpset -v2c -c private 192.168.0.1 1.3.6.1.4.1.4413.2.2.2.1.9.1.2.1.0 i 2
snmpset -v2c -c private 192.168.0.1 1.3.6.1.4.1.4413.2.2.2.1.9.1.2.1.0 i 0
snmpset -v2c -c private 192.168.0.1 1.3.6.1.4.1.4413.2.2.2.1.9.1.2.1.0 i 2

```

Then the shell should be accessible, and bcm2-utils can make it easy to extract it using this shell.
When reversing the extracted firmware the load/base address is (as far as we have seen) always 0x80004000.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/Lyrebirds/sagemcom-fast-3890-exploit/activity)
[Custom properties](/Lyrebirds/sagemcom-fast-3890-exploit/custom-properties)
### Stars

[**220**
stars](/Lyrebirds/sagemcom-fast-3890-exploit/stargazers)
### Watchers

[**16**
watching](/Lyrebirds/sagemcom-fast-3890-exploit/watchers)
### Forks

[**49**
forks](/Lyrebirds/sagemcom-fast-3890-exploit/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FLyrebirds%2Fsagemcom-fast-3890-exploit&report=Lyrebirds+%28user%29)

## [Releases](/Lyrebirds/sagemcom-fast-3890-exploit/releases)

No releases published

## [Packages 0](/orgs/Lyrebirds/packages?repo_name=sagemcom-fast-3890-exploit)

No packages published

## [Contributors 7](/Lyrebirds/sagemcom-fast-3890-exploit/graphs/contributors)

## Languages

* [JavaScript
  65.5%](/Lyrebirds/sagemcom-fast-3890-exploit/search?l=javascript)
* [Python
  21.6%](/Lyrebirds/sagemcom-fast-3890-exploit/search?l=python)
* [C
  11.9%](/Lyrebirds/sagemcom-fast-3890-exploit/search?l=c)
* [HTML
  1.0%](/Lyrebirds/sagemcom-fast-3890-exploit/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


