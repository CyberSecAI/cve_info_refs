```
{
  "cve": "CVE-2019-19577",
  "description": "When running on AMD systems with an IOMMU, Xen attempted to dynamically adapt the number of levels of pagetables (the pagetable height) in the IOMMU according to the guest's address space size. The code to select and update the height had several bugs. Notably, the update was done without taking a lock which is necessary for safe operation.",
  "affected_versions": [
    "All versions of Xen with IOMMU support are vulnerable."
  ],
  "vulnerability_details": {
    "root_cause": "The code to select and update the height of pagetables in the IOMMU was done without taking a lock, leading to a race condition when the data structures are modified.",
    "weaknesses": [
      "Race condition",
      "Improper synchronization"
    ],
    "impact": "A malicious guest administrator can cause Xen to access data structures while they are being modified, causing Xen to crash. Privilege escalation is thought to be very difficult but cannot be ruled out. Additionally, there is a potential memory leak of 4kb per guest boot, under memory pressure.",
    "attack_vectors": [
      "Malicious HVM guest administrator."
    ],
     "required_capabilities": "The attacker needs to be a malicious guest administrator with control of an HVM guest on a Xen hypervisor running on AMD CPUs with an IOMMU and with PCI pass-through enabled."
  },
  "additional_notes": "Only Xen on AMD CPUs is vulnerable. Xen running on Intel CPUs is not vulnerable. ARM systems are not vulnerable. Only systems where guests are given direct access to physical devices are vulnerable. Systems which do not use PCI pass-through are not vulnerable. Only HVM guests can exploit the vulnerability. PV and PVH guests cannot."
}
```