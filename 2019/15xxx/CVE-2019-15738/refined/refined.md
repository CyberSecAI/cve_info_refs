- **Root cause of vulnerability**: The email notification sent when an issue is closed via a merge request includes a reference to the merge request without validating if the user has permission to access it.
- **Weaknesses/vulnerabilities present**: Information disclosure. The vulnerability lies in the `emails_helper.rb` file, specifically at line 91, where the system fails to validate user permissions before including a merge request reference in an email notification.
- **Impact of exploitation**: Unauthorized users, such as guests in private projects or non-project members in public/internal projects, can learn the ID of a merge request even if they lack permissions to access the repository. This discloses information about internal activities and development processes.
- **Attack vectors**: By simply being tagged in an issue that is later closed by a merge request, the attacker would receive the notification via email.
- **Required attacker capabilities/position**: The attacker must be a guest in a private project, or a non-project user in a public/internal project where repository access is limited to project members. They also need to be notified about an issue (e.g. by being tagged in it) that is later closed by a merge request.