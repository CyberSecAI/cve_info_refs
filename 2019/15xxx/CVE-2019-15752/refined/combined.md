=== Content from packetstormsecurity.com_f8f03e9a_20250120_232831.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from medium.com_72a7f591_20250120_232832.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2fd8450b478e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40mrmrogan%2Felevation-of-privilege-in-docker-for-windows-2fd8450b478e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40mrmrogan%2Felevation-of-privilege-in-docker-for-windows-2fd8450b478e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Elevation of Privilege in Docker for Windows

[![M R](https://miro.medium.com/v2/resize:fill:88:88/0*_2mbkiCrLk03M9Hg.)](/%40mrmrogan?source=post_page---byline--2fd8450b478e--------------------------------)

[M R](/%40mrmrogan?source=post_page---byline--2fd8450b478e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0635f9f897c&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40mrmrogan%2Felevation-of-privilege-in-docker-for-windows-2fd8450b478e&user=M+R&userId=d0635f9f897c&source=post_page-d0635f9f897c--byline--2fd8450b478e---------------------post_header-----------)

3 min read·Aug 23, 2019

--

Listen

Share

In the modern security landscape, researchers often look for complicated bugs and interesting container breakouts, but we often lose sight of the simple bugs. Inside Windows, the folder C:\ProgramData\ and its sub-folders by default are writable by all users. This means if any process that runs as admin or a high privilege user executes anything in ProgramData that doesn’t have the right access controls, then any user can escalate privilege on that machine.

I found this bug and reported this bug on July 5th, 2019. Docker fixed it in their August release.

If you look in ProcMon, you can see that Docker had a lot of interesting file read calls when Docker started:

![]()

Notice that docker was looking for docker-credential-wincred.\* and unpigz.\*

This was interesting because since it was attempting to read a file that did not exist in a ton of file formats, and these all looked like executable file formats. I then opened up PowerShell to just check the access controls:

![]()

Yes! It uses the default Windows access controls on that folder!

The first attempt was to drop an executable that would open calculator called unpigz.exe inside that folder. This failed. The reason for this is the docker desktop for Windows program will look for that file, but not execute it. I didn’t know that unpigz was a Linux only tool. The code that causes this is in here <https://github.com/moby/moby/blob/de640c9f4932d851316a0a72470c4d3446f6f5ac/pkg/archive/archive.go#L165>

The second attempt was to replace ‘docker-credential-wincred.exe’. This worked when the Docker application started and whenever Docker attempted to authenticate! The command ‘docker login’ will find and execute this exe file. I was making calculator run on my machine by typing ‘docker login’ for fun and profit all day.

![]()

Folder permissions are important

This is a very simple mistake to make, and can lead to a bad bug. A lot of computer security is just remembering to cross your T’s and dot your I’s. The lesson is to always check your access controls, especially where you load your executable from.

This could have been particularly useful for an attacker to go from minor threat on a machine with limited access, to a full admin. If you were running Docker on a Windows server, it would have let an attacker run code as an admin. Also, since many developers load Docker on their machines, an attacker could potentially use this to escalate privileges on a machine inside a corporate network that you only had limited access on.

Update as of 08/28/2019: This has the CVE ID of CVE-2019–15752 [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1575](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15752)2

[Docker](/tag/docker?source=post_page-----2fd8450b478e--------------------------------)[Hacking](/tag/hacking?source=post_page-----2fd8450b478e--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----2fd8450b478e--------------------------------) Unlisted

--

--

[![M R](https://miro.medium.com/v2/resize:fill:96:96/0*_2mbkiCrLk03M9Hg.)](/%40mrmrogan?source=post_page---post_author_info--2fd8450b478e--------------------------------)[![M R](https://miro.medium.com/v2/resize:fill:128:128/0*_2mbkiCrLk03M9Hg.)](/%40mrmrogan?source=post_page---post_author_info--2fd8450b478e--------------------------------)Follow[## Written by M R](/%40mrmrogan?source=post_page---post_author_info--2fd8450b478e--------------------------------)[4 Followers](/%40mrmrogan/followers?source=post_page---post_author_info--2fd8450b478e--------------------------------)·[3 Following](/%40mrmrogan/following?source=post_page---post_author_info--2fd8450b478e--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----2fd8450b478e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----2fd8450b478e--------------------------------)[About](/about?autoplay=1&source=post_page-----2fd8450b478e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2fd8450b478e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----2fd8450b478e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----2fd8450b478e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2fd8450b478e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2fd8450b478e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----2fd8450b478e--------------------------------)[Teams](/business?source=post_page-----2fd8450b478e--------------------------------)



=== Content from lists.apache.org_61b941f8_20250120_232832.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.


