=== Content from github.com_bfb2104e_20250121_022551.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0a72bca1c773fae50171d8c27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0a72bca1c773fae50171d8c27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  78](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS on timeline ([CVE-2019-15074](https://github.com/advisories/GHSA-gg4j-279j-22ph "CVE-2019-15074"))

[Browse files](/mantisbt/mantisbt/tree/9cee1971c498bbe0a72bca1c773fae50171d8c27)
Browse the repository at this point in the history

```
Kamran Saifullah reported a stored cross-site scripting (XSS)
vulnerability in Timeline, allowing execution of arbitrary code (if CSP
settings permit it) after uploading an attachment with a crafted
filename. The code is executed for any user having visibility to the
issue, whenever My View Page is displayed.

Prevent the attack by sanitizing the filename before display.

Fixes #25995
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 15, 2019

1 parent
[a613613](/mantisbt/mantisbt/commit/a6136137478a7c285648ff7bfd67e5b0f027c76a)

commit 9cee197

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/classes/IssueAttachmentTimelineEvent.class.php](#diff-895b99ac1c5aefcba943e61144b857acc3cbfddc9a6be398fc2e59e7cfb591fe "core/classes/IssueAttachmentTimelineEvent.class.php")

Show comments

[View file](/mantisbt/mantisbt/blob/9cee1971c498bbe0a72bca1c773fae50171d8c27/core/classes/IssueAttachmentTimelineEvent.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -73,7 +73,7 @@ public function html() { |
|  |  | . sprintf( lang\_get( $t\_string ), |
|  |  | prepare\_user\_name( $this->user\_id ), |
|  |  | $t\_bug\_link, |
|  |  | $this->filename |
|  |  | string\_html\_specialchars( $this->filename ) |
|  |  | ) |
|  |  | . '</div>'; |
|  |  | $t\_html .= $this->html\_end(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9cee197`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0a72bca1c773fae50171d8c27) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_df6cf55f_20250121_022552.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D47905)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | KamranSaifullah |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1553 seconds



=== Content from github.com_b8f3fc4a_20250121_022550.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-gg4j-279j-22ph)

**CVE-2019-15074**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-gg4j-279j-22ph)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2019-15074](/advisories/GHSA-gg4j-279j-22ph)

## The Timeline feature in my\_view\_page.php in MantisBT...

Critical severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Apr 4, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-gg4j-279j-22ph/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The Timeline feature in my\_view\_page.php in MantisBT through 2.21.1 has a stored cross-site scripting (XSS) vulnerability, allowing execution of arbitrary code (if CSP settings permit it) after uploading an attachment with a crafted filename. The code is executed for any user having visibility to the issue, whenever My View Page is displayed.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2019-15074>
* [mantisbt/mantisbt@9cee197](https://github.com/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27)
* <https://mantisbt.org/bugs/view.php?id=25995>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2019-15074)
Aug 21, 2019

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Apr 4, 2024

### Severity

Critical

9.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.412%
 (74th percentile)

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### CVE ID

CVE-2019-15074

### GHSA ID

GHSA-gg4j-279j-22ph

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-gg4j-279j-22ph/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_97431a3e_20250121_022553.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  78](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS on timeline ([CVE-2019-15074](https://github.com/advisories/GHSA-gg4j-279j-22ph "CVE-2019-15074"))

[Browse files](/mantisbt/mantisbt/tree/9cee1971c498bbe0a72bca1c773fae50171d8c27)
Browse the repository at this point in the history

```
Kamran Saifullah reported a stored cross-site scripting (XSS)
vulnerability in Timeline, allowing execution of arbitrary code (if CSP
settings permit it) after uploading an attachment with a crafted
filename. The code is executed for any user having visibility to the
issue, whenever My View Page is displayed.

Prevent the attack by sanitizing the filename before display.

Fixes #25995
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 15, 2019

1 parent
[a613613](/mantisbt/mantisbt/commit/a6136137478a7c285648ff7bfd67e5b0f027c76a)

commit 9cee197

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/classes/IssueAttachmentTimelineEvent.class.php](#diff-895b99ac1c5aefcba943e61144b857acc3cbfddc9a6be398fc2e59e7cfb591fe "core/classes/IssueAttachmentTimelineEvent.class.php")

Show comments

[View file](/mantisbt/mantisbt/blob/9cee1971c498bbe0a72bca1c773fae50171d8c27/core/classes/IssueAttachmentTimelineEvent.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -73,7 +73,7 @@ public function html() { |
|  |  | . sprintf( lang\_get( $t\_string ), |
|  |  | prepare\_user\_name( $this->user\_id ), |
|  |  | $t\_bug\_link, |
|  |  | $this->filename |
|  |  | string\_html\_specialchars( $this->filename ) |
|  |  | ) |
|  |  | . '</div>'; |
|  |  | $t\_html .= $this->html\_end(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9cee197`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9cee1971c498bbe0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_4281130c_20250121_001743.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D25995)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=25995)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0025995 | mantisbt | security | public | 2019-08-14 03:44 | 2019-08-25 07:07 |
|  | | | | | |
|
| Reporter | [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | immediate | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 2.13.0 |  | | | |
| Target Version | 2.21.2 | Fixed in Version | 2.21.2 |  | |
|  | | | | | |
|
| Summary | 0025995: CVE-2019-15074: Stored XSS Vulnerability in Timeline | | | | |
| Description | Hi,  I am Kamran Saifullah an independent security researcher. I have found a vulnerability which is affecting the current version of MantisHub.  The issue is Stored Cross Site Scripting Vulnerability. We can add the attachments with the issue but if an attacker tried to inject javascript in the name of the attachment. The error will be prompted every time user logs into the account and/or tries to refresh the page. It is also possible to steal the user's cookies as well.  Screenshot is attached! | | | | |
| Steps To Reproduce | 1. Create an Issue 2. Go to that Issue 3. Create a file with name ("><img src=x onerror=prompt(1);>) with .jpg 4. Attach the file with the issue. 5. Go to the home page. 6. An error will prompt every time page is refreshed and/or user is logged into the account. | | | | |
| Additional Information | none | | | | |
| Tags | No tags attached. | | | | |
| Attached Files | [unnamed.jpg](file_download.php?file_id=8649&type=bug) (83,581 bytes)      [unnamed.jpg](file_download.php?file_id=8649&type=bug) (83,581 bytes) | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=25995&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=25995&graph=dependency)

| related to | [0023161](view.php?id=23161) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | Show File Attachment events in Timeline |
| --- | --- | --- | --- | --- |
| related to | [0026078](view.php?id=26078) | closed | [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) | CVE-2019-15539: Stored XSS on Project Documentation |

#### Activities

| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2019-08-14 14:49  developer    [~0062572](view.php?id=25995#c62572 "Direct link to note") | [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) I don't have time to provide a proper fix, but changing line 76 of IssueAttachmentTimelineEvent.class.php to something like the following line should fix the issue  ```                 string_html_specialchars ( $this->filename ) ``` |
| --- | --- |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2019-08-14 15:00  developer    [~0062573](view.php?id=25995#c62573 "Direct link to note") | [@KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905) thanks for reporting the issue.  When using standard MantisBT the issue should just occur when using browsers that don't support CSP headers.  [@vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081) maybe MantisHub is another story as you might have changed CSP headers. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 04:07  developer    [~0062578](view.php?id=25995#c62578 "Direct link to note") | Thanks for the heads up [@atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111), not sure how I missed that one yesterday. I'll look into it.  [@KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905) thanks for your research and letting us know about this issue. Did you already reserve a CVE for this ? If so, let me know the ID; otherwise I'll take care of it, and let me know how you would like to be credited for the finding. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 04:31  developer    [~0062579](view.php?id=25995#c62579 "Direct link to note") | 3. Create a file with name ("><img src=x onerror=prompt(1);>) with .jpg  As a side note, creating such a file is not possible under Windows, as `\ / : * ? " < > |` are not valid characters for file names. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 04:43  developer    [~0062580](view.php?id=25995#c62580 "Direct link to note") | Introduced by [MantisBT master 1f608f6b](/bugs/plugin.php?page=Source/view&id=24029) as part of [0023161](/bugs/view.php?id=23161 "[closed] Show File Attachment events in Timeline") |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2019-08-15 04:51  developer    [~0062581](view.php?id=25995#c62581 "Direct link to note") | not sure how I missed that one yesterday  Maybe because the issue has been reported in project `Plugin - Time Tracking`. I moved to `mantisbt` |
|  | |
| [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)   [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)  2019-08-15 05:09  reporter    [~0062582](view.php?id=25995#c62582 "Direct link to note") | [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) no i haven't received any CVE you can proceed and yes you can credit me for that. Looking forward. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 05:09  developer    [~0062583](view.php?id=25995#c62583 "Direct link to note") | The attached patch fixes the issue. [@KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905) waiting for your confirmation about the CVE ([0025995:0062578](/bugs/view.php?id=25995#c62578 "0025995: [2019-08-15 04:07] dregad")).   [0001-Fix-XSS-on-timeline.patch](file_download.php?file_id=8652&type=bug) (1,295 bytes)    ``` From a61c38bda5bc77e74477f7e9e42cc10c2082adaa Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Thu, 15 Aug 2019 10:53:18 +0200 Subject: [PATCH] Fix XSS on timeline (CVE-2019-xxxx)  Kamran Saifullah reported a stored cross-site scripting (XSS) vulnerability in Timeline, allowing execution of arbitrary code (if CSP settings permit it) after uploading an attachment with a crafted filename. The code is executed for any user having visibility to the issue, whenever My View Page is displayed.  Prevent the attack by sanitizing the filename before display.  Fixes #25995 ---  core/classes/IssueAttachmentTimelineEvent.class.php | 2 +-  1 file changed, 1 insertion(+), 1 deletion(-)  diff --git a/core/classes/IssueAttachmentTimelineEvent.class.php b/core/classes/IssueAttachmentTimelineEvent.class.php index 8e0425df4..2a6123d87 100644 --- a/core/classes/IssueAttachmentTimelineEvent.class.php +++ b/core/classes/IssueAttachmentTimelineEvent.class.php @@ -73,7 +73,7 @@ class IssueAttachmentTimelineEvent extends TimelineEvent {  			. sprintf( lang_get( $t_string ),  				prepare_user_name( $this->user_id ),  				$t_bug_link, -				$this->filename +				string_html_specialchars( $this->filename )  			)  			. '</div>';  		$t_html .= $this->html_end(); --  2.19.1.windows.1   ```   [0001-Fix-XSS-on-timeline.patch](file_download.php?file_id=8652&type=bug) (1,295 bytes) |
|  | |
| [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)   [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)  2019-08-15 05:09  reporter    [~0062584](view.php?id=25995#c62584 "Direct link to note") | [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) no i haven't received any CVE you can proceed and yes you can credit me for that. Looking forward.  Thank you [@atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) and the team for the quick fix :D |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 05:10  developer    [~0062585](view.php?id=25995#c62585 "Direct link to note") | cross-post... OK I'll take care of it. |
|  | |
| [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)   [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)  2019-08-15 05:11  reporter    [~0062586](view.php?id=25995#c62586 "Direct link to note")  Last edited: 2019-08-15 05:15 | Thank you [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784), i will surely be waiting :)) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 08:12  developer    [~0062587](view.php?id=25995#c62587 "Direct link to note") | CVE Request 741408 sent to MITRE |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 10:26  developer    [~0062594](view.php?id=25995#c62594 "Direct link to note") | CVE-2019-15074 assigned. |
|  | |
| [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)   [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)  2019-08-15 12:39  reporter    [~0062595](view.php?id=25995#c62595 "Direct link to note") | Thank you very much [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)! The CVE shows that it has been assigned/reserved and is not populated yet. Right? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2019-08-15 12:59  developer    [~0062596](view.php?id=25995#c62596 "Direct link to note") | That's correct. I will inform MITRE to make it public, once we've released 2.21.2 with the patch. Considering the severity of the bug, it gives our users a chance to update their systems before the CVE goes out. |
|  | |
| [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)   [KamranSaifullah](https://mantisbt.org/bugs/view_user_page.php?id=47905)  2019-08-15 13:00  reporter    [~0062597](view.php?id=25995#c62597 "Direct link to note") | That's great! This is my first ever CVE. Thank [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) :D |
|  | |

#### Related Changesets

| MantisBT: master-2.21 9cee1971  2019-08-15 00:53  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=24692) [Diff](https://github.com/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27) | Fix XSS on timeline (CVE-2019-15074) | | Affected Issues[0025995](/bugs/view.php?id=25995 "[closed] CVE-2019-15074: Stored XSS Vulnerability in Timeline") |
| --- | --- | --- | --- |
| mod - core/classes/IssueAttachmentTimelineEvent.class.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/9cee1971c498bbe0a72bca1c773fae50171d8c27) [File](https://github.com/mantisbt/mantisbt/blob/9cee1971c498bbe0a72bca1c773fae50171d8c27/core/classes/IssueAttachmentTimelineEvent.class.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.3429 seconds



=== Content from mantisbt.org_7b46b536_20250121_022552.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1487 seconds


