- **Root cause of vulnerability:** The Kubernetes integration is vulnerable to a DNS rebind attack.
- **Weaknesses/vulnerabilities present:** The application validates the provided API URL by resolving the DNS and checking the IP address. However, when the actual connection is made, the DNS can resolve to a different (potentially internal or restricted) IP address, bypassing SSRF protections.
- **Impact of exploitation:** SSRF protections are bypassed, allowing attackers to make connections to internal services and potentially map the network based on error messages returned when a port is open or closed.
- **Attack vectors:** An attacker sets up a malicious DNS server that initially resolves a provided API URL to a valid IP address during validation, and then resolves the same URL to an internal or restricted IP address when the actual connection is made.
- **Required attacker capabilities/position:** The attacker needs to be able to create a malicious DNS server and provide a controlled domain name, such as `rebind.gtest.dev` in this example, as the API URL when creating a Kubernetes cluster integration within GitLab. The attacker also needs to have a GitLab account with permission to create Kubernetes clusters.