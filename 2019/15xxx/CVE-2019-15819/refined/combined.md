=== Content from wordpress.org_2fde2c0b_20250120_231308.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Restaurant Reservations

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fnd-restaurant-reservations&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fnd-restaurant-reservations&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/nd-restaurant-reservations_fc6e4c.svg)
# nd-restaurant-reservations

By [Nicdark](https://nicdark.com)

* [Details](https://wordpress.org/plugins/nd-restaurant-reservations/#description)
* [Reviews](https://wordpress.org/plugins/nd-restaurant-reservations/#reviews)
* [Development](https://wordpress.org/plugins/nd-restaurant-reservations/#developers)

[Support](https://wordpress.org/support/plugin/nd-restaurant-reservations/)

## Description

This plugin has been closed as of March 7, 2024 and is not available for download. Reason: Security Issue.

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“Restaurant Reservations” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/9f88118a65e13eba3579ff7c2202192cebbe5ba643e201a9872f958ec5f573de?s=32&d=mm&r=g)

[Translate “Restaurant Reservations” into your language.](https://translate.wordpress.org/projects/wp-plugins/nd-restaurant-reservations)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/nd-restaurant-reservations/), check out the [SVN repository](https://plugins.svn.wordpress.org/nd-restaurant-reservations/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/nd-restaurant-reservations/) by [RSS](https://plugins.trac.wordpress.org/log/nd-restaurant-reservations/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.0**
* Last updated **11 months ago**
* Active installations **N/A**
* WordPress version **4.5 or higher**
* Tested up to **6.3.5**
* [Advanced View](https://wordpress.org/plugins/nd-restaurant-reservations/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from blog.nintechnet.com_354df291_20250120_231307.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Privilege escalation vulnerability in WordPress ND Restaurant Reservations plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [August 9, 2019 - 8:02pm [+0700]September 19, 2019 - 4:48am [+0700]](https://blog.nintechnet.com/privilege-escalation-vulnerability-in-wordpress-nd-restaurant-reservations-plugin/)

The WordPress [ND Restaurant Reservations](https://wordpress.org/plugins/nd-restaurant-reservations/) plugin, which has 300+ active installations, was prone to a critical vulnerability that would allow an unauthenticated user to modify the settings of WordPress and to take over the blog and its database.

> Note that this vulnerability is similar to the [ND Shortcodes For Visual Composer](https://blog.nintechnet.com/privilege-escalation-vulnerability-in-wordpress-nd-shortcodes-for-visual-composer-plugin/) plugin vulnerability, except that it does not require the blog to be using one of the author’s themes, i.e., all active installations are vulnerable.

### Reference

CVE-2019-15819

### Unauthenticated options change

In version <=1.3, the plugin registers the `nd_rst_import_settings_php_function` action via both the `wp_ajax_*` and `wp_ajax_nopriv_*` hooks in the ‘nd-restaurant-reservations/inc/admin/7-import-export/index.php’ script:

```

add_action( 'wp_ajax_nd_rst_import_settings_php_function', 'nd_rst_import_settings_php_function' );
add_action( 'wp_ajax_nopriv_nd_rst_import_settings_php_function', 'nd_rst_import_settings_php_function' );

```

The `wp_ajax_*` hook allows logged-in users to access WordPress AJAX functions while the `wp_ajax_nopriv_*` hooks allows unauthenticated users to perform the same action. In ND Restaurant Reservations, the AJAX request is sent to the ‘nd\_rst\_import\_settings\_php\_function’ function used to import the plugin settings:

```

function nd_rst_import_settings_php_function() {

  //recover datas
  $nd_rst_value_import_settings = $_GET['nd_rst_value_import_settings'];

  $nd_rst_import_settings_result = '';

  if ( $nd_rst_value_import_settings != '' ) {

    $nd_rst_array_options = explode("[nd_rst_end_option]", $nd_rst_value_import_settings);

    foreach ($nd_rst_array_options as $nd_rst_array_option) {

      $nd_rst_array_single_option = explode("[nd_rst_option_value]", $nd_rst_array_option);
      $nd_rst_option = $nd_rst_array_single_option[0];
      $nd_rst_new_value = $nd_rst_array_single_option[1];
      $nd_rst_new_value = str_replace("[SHARP]","#",$nd_rst_new_value);

      if ( $nd_rst_new_value != '' ){
        $nd_rst_update_result = update_option($nd_rst_option,$nd_rst_new_value);

```

The `$_GET['nd_rst_value_import_settings']` payload will be passed on, unverified, to the `update_option` function. Because there’s no capability check and the function is accessible to anyone, an unauthenticated user can change the blog settings, for instance the site URL, the admin email address, user roles and capabilities, or give administrator privilege to any new registered user.

### Timeline

The vulnerability was discovered and reported to the wordpress.org team on July 24, 2019.

### Recommendations

Update as soon as possible if you are using version 1.3 or below.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this type of vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Privilege%20escalation%20vulnerability%20in%20WordPress%20ND%20Restaurant%20Reservations%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fprivilege-escalation-vulnerability-in-wordpress-nd-restaurant-reservations-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fprivilege-escalation-vulnerability-in-wordpress-nd-restaurant-reservations-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Privilege%20escalation%20vulnerability%20in%20WordPress%20ND%20Restaurant%20Reservations%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fprivilege-escalation-vulnerability-in-wordpress-nd-restaurant-reservations-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Unauthenticated options change in WordPress Login or Logout Menu Item plugin.](https://blog.nintechnet.com/unauthenticated-options-change-in-wordpress-login-or-logout-menu-item-plugin/)[Next Unauthenticated option changes in WordPress Simple 301 Redirects Addon Bulk Uploader plugin.](https://blog.nintechnet.com/unauthenticated-option-changes-in-wordpress-simple-301-redirects-addon-bulk-uploader-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


