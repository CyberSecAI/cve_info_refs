=== Content from git.pengutronix.de_d11cb28c_20250121_010818.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [barebox](/cgit/barebox/) | master next |
| --- | --- | --- |
| barebox master repository | Pengutronix |

| [summary](/cgit/barebox/?h=next)[refs](/cgit/barebox/refs/?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)[log](/cgit/barebox/log/fs/nfs.c?h=next)[tree](/cgit/barebox/tree/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)[commit](/cgit/barebox/commit/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)[diff](/cgit/barebox/diff/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)[stats](/cgit/barebox/stats/fs/nfs.c?h=next) | log msg author committer range |
| --- | --- |

path: [root](/cgit/barebox/commit/?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)/[fs](/cgit/barebox/commit/fs?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)/[nfs.c](/cgit/barebox/commit/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sascha Hauer <s.hauer@pengutronix.de> | 2019-09-02 09:42:15 +0200 |
| --- | --- | --- |
| committer | Sascha Hauer <s.hauer@pengutronix.de> | 2019-09-02 09:46:14 +0200 |
| commit | [574ce994016107ad8ab0f845a785f28d7eaa5208](/cgit/barebox/commit/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208) ([patch](/cgit/barebox/patch/fs/nfs.c?id=574ce994016107ad8ab0f845a785f28d7eaa5208)) | |
| tree | [e818867ab42c04710977a613d5865e5078fb7c5a](/cgit/barebox/tree/?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208) /[fs/nfs.c](/cgit/barebox/tree/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208) | |
| parent | [84986ca024462058574432b5483f4bf9136c538d](/cgit/barebox/commit/fs/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d) ([diff](/cgit/barebox/diff/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208&id2=84986ca024462058574432b5483f4bf9136c538d)) | |
| download | [barebox-574ce994016107ad8ab0f845a785f28d7eaa5208.tar.gz](/cgit/barebox/snapshot/barebox-574ce994016107ad8ab0f845a785f28d7eaa5208.tar.gz) | |

fs: nfs: Fix possible buffer overflownfs\_readlink\_req() interprets a 32bit value directly received from the
network as length argument to memcpy() without any boundary checking.
Clamp the copy size at the end of the incoming packet.
Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
[Diffstat](/cgit/barebox/diff/?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208) (limited to 'fs/nfs.c')

| -rw-r--r-- | [fs/nfs.c](/cgit/barebox/diff/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/fs/nfs.c b/fs/nfs.cindex d606ccd1e9..0ad07aa3f2 100644--- a/[fs/nfs.c](/cgit/barebox/tree/fs/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)+++ b/[fs/nfs.c](/cgit/barebox/tree/fs/nfs.c?h=next&id=574ce994016107ad8ab0f845a785f28d7eaa5208)@@ -1023,6 +1023,10 @@ static int nfs\_readlink\_req(struct nfs\_priv \*npriv, struct nfs\_fh \*fh, p = nfs\_read\_post\_op\_attr(p, NULL);  len = ntoh32(net\_read\_uint32(p)); /\* new path length \*/++ len = max\_t(unsigned int, len,+ nfs\_packet->len - sizeof(struct rpc\_reply) - sizeof(uint32\_t));+ p++;  \*target = xzalloc(len + 1); |
| --- |

If you are a bot and scrape our website and ignore robots.txt we block your /20 or /48
[beebeebee](/hp).


