=== Content from mitogen.networkgenomics.com_31685f13_20250121_000126.html ===


* [Mitogen](index.html)
* [Mitogen for Ansible](ansible_detailed.html)
* Release Notes
  + [In progress (unreleased)](#in-progress-unreleased)
  + [v0.3.21 (2025-01-20)](#v0-3-21-2025-01-20)
  + [v0.3.20 (2025-01-07)](#v0-3-20-2025-01-07)
  + [v0.3.19 (2024-12-02)](#v0-3-19-2024-12-02)
  + [v0.3.18 (2024-11-07)](#v0-3-18-2024-11-07)
  + [v0.3.17 (2024-11-07)](#v0-3-17-2024-11-07)
  + [v0.3.16 (2024-11-05)](#v0-3-16-2024-11-05)
  + [v0.3.15 (2024-10-28)](#v0-3-15-2024-10-28)
  + [v0.3.14 (2024-10-16)](#v0-3-14-2024-10-16)
  + [v0.3.13 (2024-10-09)](#v0-3-13-2024-10-09)
  + [v0.3.12 (2024-10-07)](#v0-3-12-2024-10-07)
  + [v0.3.11 (2024-09-30)](#v0-3-11-2024-09-30)
  + [v0.3.10 (2024-09-20)](#v0-3-10-2024-09-20)
  + [v0.3.9 (2024-08-13)](#v0-3-9-2024-08-13)
  + [v0.3.8 (2024-07-30)](#v0-3-8-2024-07-30)
  + [v0.3.7 (2024-04-08)](#v0-3-7-2024-04-08)
  + [v0.3.6 (2024-04-04)](#v0-3-6-2024-04-04)
  + [v0.3.5 (2024-03-17)](#v0-3-5-2024-03-17)
  + [v0.3.4 (2023-07-02)](#v0-3-4-2023-07-02)
  + [v0.3.3 (2022-06-03)](#v0-3-3-2022-06-03)
  + [v0.3.2 (2022-01-12)](#v0-3-2-2022-01-12)
  + [v0.3.1 (unreleased)](#v0-3-1-unreleased)
  + [v0.3.0 (2021-11-24)](#v0-3-0-2021-11-24)
  + [v0.2.10 (2021-11-24)](#v0-2-10-2021-11-24)
  + [v0.2.9 (2019-11-02)](#v0-2-9-2019-11-02)
  + [v0.2.8 (2019-08-18)](#v0-2-8-2019-08-18)
  + [v0.2.7 (2019-05-19)](#v0-2-7-2019-05-19)
  + [v0.2.6 (2019-03-06)](#v0-2-6-2019-03-06)
  + [v0.2.5 (2019-02-14)](#v0-2-5-2019-02-14)
  + [v0.2.4 (2019-02-10)](#v0-2-4-2019-02-10)
  + [v0.2.3 (2018-10-23)](#v0-2-3-2018-10-23)
  + [v0.2.2 (2018-07-26)](#v0-2-2-2018-07-26)
  + [v0.2.1 (2018-07-10)](#v0-2-1-2018-07-10)
  + [v0.2.0 (2018-07-09)](#v0-2-0-2018-07-09)
* [Contributors](contributors.html)
* [How Mitogen Works](howitworks.html)
* [API Reference](api.html)
* [Getting Started](getting_started.html)
* [Examples](examples.html)
* [Internal API Reference](internals.html)

[Star](https://github.com/mitogen-hq/mitogen/)

# Release Notes[¶](#release-notes "Permalink to this headline")

To avail of fixes in an unreleased version, please download a ZIP file
[directly from GitHub](https://github.com/mitogen-hq/mitogen/).

## In progress (unreleased)[¶](#in-progress-unreleased "Permalink to this headline")

## v0.3.21 (2025-01-20)[¶](#v0-3-21-2025-01-20 "Permalink to this headline")

* [#1209](https://github.com/mitogen-hq/mitogen/issues/1209) docs: Fix Netlify build of website
* [#1216](https://github.com/mitogen-hq/mitogen/issues/1216) `ansible_mitogen`: Add all ansible\_freeipa modules to
  the always-fork list.
* [#766](https://github.com/mitogen-hq/mitogen/issues/766) `ansible_mitogen`: Fix “”could not recover task\_vars”
  and “get\_with\_context\_result object has no attribute \_create\_control\_path”
  when using `kubectl`, `netconf`, or `network_cli` connection plugins.

## v0.3.20 (2025-01-07)[¶](#v0-3-20-2025-01-07 "Permalink to this headline")

* [#1079](https://github.com/mitogen-hq/mitogen/issues/1079) `ansible_mitogen`: Fix [wait\_for\_connection module](https://docs.ansible.com/ansible/latest/modules/wait_for_connection_module.html)
  timeout with templated `ansible_python_interpreter`
* [#1079](https://github.com/mitogen-hq/mitogen/issues/1079) `ansible_mitogen`: Fix templated python interpreter
  with meta: reset\_connection
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated connection timeout
  (e.g. `ansible_timeout`).
* [#740](https://github.com/mitogen-hq/mitogen/issues/740) `ansible_mitogen`: Respect `interpreter_python`
  in `ansible.cfg` and `ANSIBLE_PYTHON_INTERPRETER` environment variable.

## v0.3.19 (2024-12-02)[¶](#v0-3-19-2024-12-02 "Permalink to this headline")

* [#1129](https://github.com/mitogen-hq/mitogen/issues/1129) `ansible_mitogen`: Ansible 11 support

## v0.3.18 (2024-11-07)[¶](#v0-3-18-2024-11-07 "Permalink to this headline")

* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated become method
  (e.g. `ansible_become_method`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated become flag
  (e.g. `ansible_become_method`, `become` keyword).

## v0.3.17 (2024-11-07)[¶](#v0-3-17-2024-11-07 "Permalink to this headline")

* [#1182](https://github.com/mitogen-hq/mitogen/issues/1182) CI: Fix incorrect world readable/writable file permissions
  on SSH key `mitogen__has_sudo_pubkey.key` during Ansible tests.
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated SSH private key file
  (e.g. `ansible_private_key_file`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated SSH host key checking
  (e.g. `ansible_host_key_checking`, `ansible_ssh_host_key_checking`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated host address
  (e.g. `ansible_host`, `ansible_ssh_host`)
* [#1184](https://github.com/mitogen-hq/mitogen/issues/1184) Test templated SSH host key checking in task vars

## v0.3.16 (2024-11-05)[¶](#v0-3-16-2024-11-05 "Permalink to this headline")

* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated become executable
  (e.g. `become_exe`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated become executable
  arguments (e.g. `become_flags`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Templated ssh executable
  (`ansible_ssh_executable`).
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Fixed templated connection options
  during a `meta: reset_connection` task.
* [#1129](https://github.com/mitogen-hq/mitogen/issues/1129) CI: Migrated macOS 12 runners to macOS 13, due to EOL.

## v0.3.15 (2024-10-28)[¶](#v0-3-15-2024-10-28 "Permalink to this headline")

* [#905](https://github.com/mitogen-hq/mitogen/issues/905) `ansible_mitogen`: Support templated SSH command
  arguments (e.g. `ansible_ssh_args`, `ansible_ssh_extra_args`).
* [#692](https://github.com/mitogen-hq/mitogen/issues/692) tests: Fix and re-enable several sudo tests
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Support templated become password
  (e.g. `ansible_become_pass`, `ansible_sudo_pass`)

## v0.3.14 (2024-10-16)[¶](#v0-3-14-2024-10-16 "Permalink to this headline")

* [#1159](https://github.com/mitogen-hq/mitogen/issues/1159) CI: Reduce number of Jobs by parameterizing Mitogen Docker
  SSH tests
* [#1083](https://github.com/mitogen-hq/mitogen/issues/1083) `ansible_mitogen`: Support templated become username.

## v0.3.13 (2024-10-09)[¶](#v0-3-13-2024-10-09 "Permalink to this headline")

* [#1138](https://github.com/mitogen-hq/mitogen/issues/1138) CI: Complete migration from Azure DevOps Pipelines to
  GitHub Actions
* [#1116](https://github.com/mitogen-hq/mitogen/issues/1116) `ansible_mitogen`: Support for templated variable
  ansible\_ssh\_user.
* [#978](https://github.com/mitogen-hq/mitogen/issues/978) `ansible_mitogen`: Support templated Ansible SSH port.
* [#1073](https://github.com/mitogen-hq/mitogen/issues/1073) Python 3.13 support

## v0.3.12 (2024-10-07)[¶](#v0-3-12-2024-10-07 "Permalink to this headline")

* [#1106](https://github.com/mitogen-hq/mitogen/issues/1106) `ansible_mitogen`: Support for ansible\_ssh\_password
  connection variable, and templated SSH connection password.
* [#1136](https://github.com/mitogen-hq/mitogen/issues/1136) tests: Improve Ansible fail\_msg formatting.
* [#1137](https://github.com/mitogen-hq/mitogen/issues/1137) tests: Ignore inventory files of inactive tests & benchmarks
* [#1138](https://github.com/mitogen-hq/mitogen/issues/1138) CI: Add re-actors/alls-green GitHub Actions job to simplify
  branch protections configuration.

## v0.3.11 (2024-09-30)[¶](#v0-3-11-2024-09-30 "Permalink to this headline")

* [#1127](https://github.com/mitogen-hq/mitogen/issues/1127) `mitogen`: Consolidate mitogen backward compatibility
  fallbacks and polyfills into `mitogen.core`
* [#1127](https://github.com/mitogen-hq/mitogen/issues/1127) `ansible_mitogen`: Remove backward compatibility
  fallbacks for Python 2.4 & 2.5.
* [#1127](https://github.com/mitogen-hq/mitogen/issues/1127) `ansible_mitogen`: Remove fallback imports for Ansible
  releases before 2.10
* [#1127](https://github.com/mitogen-hq/mitogen/issues/1127) `ansible_mitogen`: Consolidate Python 2 & 3
  compatibility
* [#1128](https://github.com/mitogen-hq/mitogen/issues/1128) CI: Start migration from Azure DevOps to GitHub Actions

## v0.3.10 (2024-09-20)[¶](#v0-3-10-2024-09-20 "Permalink to this headline")

* [#950](https://github.com/mitogen-hq/mitogen/issues/950) Fix Solaris/Illumos/SmartOS compatibility with become
* [#1087](https://github.com/mitogen-hq/mitogen/issues/1087) Fix `mitogen.core.StreamError` when Ansible template
  module is called with a `dest:` filename that has an extension
* [#1110](https://github.com/mitogen-hq/mitogen/issues/1110) Fix `mitogen.core.StreamError` when Ansible copy
  module is called with a file larger than 124 kibibytes
  (`ansible_mitogen.connection.Connection.SMALL_FILE_LIMIT`)
* [#905](https://github.com/mitogen-hq/mitogen/issues/905) Initial support for templated `ansible_ssh_args`,
  `ansible_ssh_common_args`, and `ansible_ssh_extra_args` variables.
  NB: play or task scoped variables will probably still fail.
* [#694](https://github.com/mitogen-hq/mitogen/issues/694) CI: Fixed a race condition and some resource leaks causing
  some of intermittent failures when running the test suite.

## v0.3.9 (2024-08-13)[¶](#v0-3-9-2024-08-13 "Permalink to this headline")

* [#1097](https://github.com/mitogen-hq/mitogen/issues/1097) Respect ansible\_facts.discovered\_interpreter\_python when
  executing non new-style modules (e.g. JSONARGS style, WANT\_JSON style).
* [#1074](https://github.com/mitogen-hq/mitogen/issues/1074) Support Ansible 10 (ansible-core 2.17)

## v0.3.8 (2024-07-30)[¶](#v0-3-8-2024-07-30 "Permalink to this headline")

* [#952](https://github.com/mitogen-hq/mitogen/issues/952) Fix Ansible –ask-become-pass, add test coverage
* [#957](https://github.com/mitogen-hq/mitogen/issues/957) Fix Ansible exception when executing against 10s of hosts
  “ValueError: filedescriptor out of range in select()”
* [#1066](https://github.com/mitogen-hq/mitogen/issues/1066) Support Ansible ansible\_host\_key\_checking & ansible\_ssh\_host\_key\_checking
* [#1090](https://github.com/mitogen-hq/mitogen/issues/1090) CI: Migrate macOS integration tests to macOS 12, drop Python 2.7 jobs

## v0.3.7 (2024-04-08)[¶](#v0-3-7-2024-04-08 "Permalink to this headline")

* [#1021](https://github.com/mitogen-hq/mitogen/issues/1021) Support for Ansible 8 (ansible-core 2.15)
* tests: Replace uses of `include:` & `import:`, unsupported in Ansible 9
* [#1053](https://github.com/mitogen-hq/mitogen/issues/1053) Support for Ansible 9 (ansible-core 2.16)

## v0.3.6 (2024-04-04)[¶](#v0-3-6-2024-04-04 "Permalink to this headline")

* [#974](https://github.com/mitogen-hq/mitogen/issues/974) Support Ansible 7
* [#1046](https://github.com/mitogen-hq/mitogen/issues/1046) Raise [`TypeError`](https://docs.python.org/3/library/exceptions.html#TypeError "(in Python v3.13)") in `<mitogen.util.cast()>()`
  when casting a string subtype to bytes() or str() fails. This is
  potentially an API breaking change. Failures previously passed silently.
* [#1046](https://github.com/mitogen-hq/mitogen/issues/1046) Add `<ansible_mitogen.util.cast()>()`, to cast
  `ansible.utils.unsafe_proxy.AnsibleUnsafe` objects in Ansible 7+.

## v0.3.5 (2024-03-17)[¶](#v0-3-5-2024-03-17 "Permalink to this headline")

* [#987](https://github.com/mitogen-hq/mitogen/issues/987) Support Python 3.11
* [#885](https://github.com/mitogen-hq/mitogen/issues/885) Fix [`PermissionError`](https://docs.python.org/3/library/exceptions.html#PermissionError "(in Python v3.13)") in [`importlib`](https://docs.python.org/3/library/importlib.html#module-importlib "(in Python v3.13)") when
  becoming an unprivileged user with Python 3.x
* [#1033](https://github.com/mitogen-hq/mitogen/issues/1033) Support [PEP 451](https://peps.python.org/pep-0451/),
  required by Python 3.12
* [#1033](https://github.com/mitogen-hq/mitogen/issues/1033) Support Python 3.12

## v0.3.4 (2023-07-02)[¶](#v0-3-4-2023-07-02 "Permalink to this headline")

* [#929](https://github.com/mitogen-hq/mitogen/issues/929) Support Ansible 6 and ansible-core 2.13
* [#832](https://github.com/mitogen-hq/mitogen/issues/832) Fix runtime error when using the ansible.builtin.dnf module multiple times
* [#925](https://github.com/mitogen-hq/mitogen/issues/925) `ansible_mitogen.connection.Connection` no longer tries to close the
  connection on destruction. This is expected to reduce cases of mitogen.core.Error: An attempt
  was made to enqueue a message with a Broker that has already exitted. However it may result in
  resource leaks.
* [#659](https://github.com/mitogen-hq/mitogen/issues/659) Removed `mitogen.compat.simplejson`, not needed with Python 2.7+, contained Python 3.x syntax errors
* [#983](https://github.com/mitogen-hq/mitogen/issues/983) CI: Removed PyPI faulthandler requirement from tests
* [#1001](https://github.com/mitogen-hq/mitogen/issues/1001) CI: Fixed Debian 9 & 11 tests

## v0.3.3 (2022-06-03)[¶](#v0-3-3-2022-06-03 "Permalink to this headline")

* [#906](https://github.com/mitogen-hq/mitogen/issues/906) Support packages dynamically inserted into sys.modules, e.g. distro >= 1.7.0 as ansible.module\_utils.distro.
* [#918](https://github.com/mitogen-hq/mitogen/issues/918) Support Python 3.10
* [#920](https://github.com/mitogen-hq/mitogen/issues/920) Support Ansible [podman](https://docs.ansible.com/ansible/latest/plugins/connection/podman.html) connection plugin
* [#836](https://github.com/mitogen-hq/mitogen/issues/836) [`mitogen.utils.with_router()`](api.html#mitogen.utils.with_router "mitogen.utils.with_router") decorator preserves the docstring in addition to the name.
* [#936](https://github.com/mitogen-hq/mitogen/issues/936) [fetch module](https://docs.ansible.com/ansible/latest/modules/fetch_module.html) no longer emits [DEPRECATION WARNING]: The ‘\_remote\_checksum()’ method is deprecated.

## v0.3.2 (2022-01-12)[¶](#v0-3-2-2022-01-12 "Permalink to this headline")

* [#891](https://github.com/mitogen-hq/mitogen/issues/891) Correct Framework :: Ansible Trove classifier

## v0.3.1 (unreleased)[¶](#v0-3-1-unreleased "Permalink to this headline")

* [#874](https://github.com/mitogen-hq/mitogen/issues/874) Support for Ansible 5 (ansible-core 2.12)
* [#774](https://github.com/mitogen-hq/mitogen/issues/774) Fix bootstrap failures on macOS 11.x and 12.x, involving Python 2.7 wrapper
* [#834](https://github.com/mitogen-hq/mitogen/issues/834) Support for Ansible 3 and 4 (ansible-core 2.11)
* [#869](https://github.com/mitogen-hq/mitogen/issues/869) Continuous Integration tests are now run with Tox
* [#869](https://github.com/mitogen-hq/mitogen/issues/869) Continuous Integration tests now cover CentOS 6 & 8, Debian 9 & 11, Ubuntu 16.04 & 20.04
* [#860](https://github.com/mitogen-hq/mitogen/issues/860) Add initial support for podman connection (w/o Ansible support yet)
* [#873](https://github.com/mitogen-hq/mitogen/issues/873) python -c … first stage no longer uses `platform`` to detect the macOS release
* [#876](https://github.com/mitogen-hq/mitogen/issues/876) python -c … first stage no longer contains tab characters, to reduce size
* [#878](https://github.com/mitogen-hq/mitogen/issues/878) Continuous Integration tests now correctly perform comparisons of 2 digit versions
* [#878](https://github.com/mitogen-hq/mitogen/issues/878) Kubectl connector fixed with Ansible 2.10 and above

## v0.3.0 (2021-11-24)[¶](#v0-3-0-2021-11-24 "Permalink to this headline")

This release separates itself from the v0.2.X releases. Ansible’s API changed too much to support backwards compatibility so from now on, v0.2.X releases will be for Ansible < 2.10 and v0.3.X will be for Ansible 2.10+.
[See here for details](https://github.com/mitogen-hq/mitogen/pull/715#issuecomment-750697248).

* [#827](https://github.com/mitogen-hq/mitogen/issues/827) NewStylePlanner: detect ansible\_collections imports
* [#770](https://github.com/mitogen-hq/mitogen/issues/770) better check for supported Ansible version
* [#731](https://github.com/mitogen-hq/mitogen/issues/731) ansible 2.10 support
* [#652](https://github.com/mitogen-hq/mitogen/issues/652) support for ansible collections import hook
* [#847](https://github.com/mitogen-hq/mitogen/issues/847) Removed historic Continuous Integration reverse shell

## v0.2.10 (2021-11-24)[¶](#v0-2-10-2021-11-24 "Permalink to this headline")

* [#597](https://github.com/mitogen-hq/mitogen/issues/597) mitogen does not support Ansible 2.8 Python interpreter detection
* [#655](https://github.com/mitogen-hq/mitogen/issues/655) wait\_for\_connection gives errors
* [#672](https://github.com/mitogen-hq/mitogen/issues/672) cannot perform relative import error
* [#673](https://github.com/mitogen-hq/mitogen/issues/673) mitogen fails on RHEL8 server with bash /usr/bin/python: No such file or directory
* [#676](https://github.com/mitogen-hq/mitogen/issues/676) mitogen fail to run playbook without “/usr/bin/python” on target host
* [#716](https://github.com/mitogen-hq/mitogen/issues/716) fetch fails with “AttributeError: ‘ShellModule’ object has no attribute ‘tmpdir’”
* [#756](https://github.com/mitogen-hq/mitogen/issues/756) ssh connections with check\_host\_keys=’accept’ would
  timeout, when using recent OpenSSH client versions.
* [#758](https://github.com/mitogen-hq/mitogen/issues/758) fix initilialisation of callback plugins in test suite, to address a KeyError in
  `ansible.plugins.callback.CallbackBase.v2_runner_on_start()`
* [#775](https://github.com/mitogen-hq/mitogen/issues/775) Test with Python 3.9
* [#775](https://github.com/mitogen-hq/mitogen/issues/775) Add msvcrt to the default module deny list

## v0.2.9 (2019-11-02)[¶](#v0-2-9-2019-11-02 "Permalink to this headline")

This release contains minimal changes required for Ansible 2.9.

* [#633](https://github.com/mitogen-hq/mitogen/issues/633): [meta: reset\_connection](https://docs.ansible.com/ansible/latest/modules/meta_module.html) could fail to reset
  a connection when `become: true` was set on the playbook.
* [#660](https://github.com/mitogen-hq/mitogen/issues/660): Ansible 2.9 is supported.

### Thanks![¶](#thanks "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by

[Can Ozokur](https://github.com/canozokur/) and
[Olexandr Minzak](https://github.com/bizlevel/).

## v0.2.8 (2019-08-18)[¶](#v0-2-8-2019-08-18 "Permalink to this headline")

This release includes Ansible 2.8 and SELinux support, fixes for two deadlocks,
and major internal design overhauls in preparation for future functionality.

### Enhancements[¶](#enhancements "Permalink to this headline")

* [#556](https://github.com/mitogen-hq/mitogen/issues/556),
  [#587](https://github.com/mitogen-hq/mitogen/issues/587): Ansible 2.8 is supported.
  [Become plugins](https://docs.ansible.com/ansible/latest/plugins/become.html) ([#631](https://github.com/mitogen-hq/mitogen/issues/631)) and
  [interpreter discovery](https://docs.ansible.com/ansible/latest/reference_appendices/interpreter_discovery.html) ([#630](https://github.com/mitogen-hq/mitogen/issues/630))
  are not yet handled.
* [#419](https://github.com/mitogen-hq/mitogen/issues/419), [#470](https://github.com/mitogen-hq/mitogen/issues/470): file descriptor usage is approximately
  halved, as it is no longer necessary to separately manage read and write
  sides to work around a design problem.
* [#419](https://github.com/mitogen-hq/mitogen/issues/419): setup for all connections happens almost entirely on one
  thread, reducing contention and context switching early in a run.
* [#419](https://github.com/mitogen-hq/mitogen/issues/419): Connection setup is better pipelined, eliminating some
  network round-trips. Most infrastructure is in place to support future
  removal of the final round-trips between a target booting and receiving
  function calls.
* [#595](https://github.com/mitogen-hq/mitogen/pull/595): the [`buildah()`](api.html#mitogen.parent.Router.buildah "mitogen.parent.Router.buildah") connection method
  is available to manipulate [Buildah](https://buildah.io/) containers, and
  is exposed to Ansible as the [buildah connection plug-in](https://docs.ansible.com/ansible/latest/plugins/connection/buildah.html).
* [#615](https://github.com/mitogen-hq/mitogen/issues/615): a modified [fetch module](https://docs.ansible.com/ansible/latest/modules/fetch_module.html) implements streaming transfer
  even when `become` is active, avoiding excess CPU and memory spikes, and
  improving performance. A representative copy of two 512 MiB files drops from
  55.7 seconds to 6.3 seconds, with peak memory usage dropping from 10.7 GiB to
  64.8 MiB. [1](#i615)
* [Operon](https://networkgenomics.com/operon/) no longer requires a custom
  library installation, both Ansible and Operon are supported by a single
  Mitogen release.
* The `MITOGEN_CPU_COUNT` variable shards the connection multiplexer into
  per-CPU workers. This may improve throughput for large runs involving file
  transfer, and is required for future functionality. One multiplexer starts by
  default, to match existing behaviour.
* [d6faff06](https://github.com/mitogen-hq/mitogen/commit/d6faff06), [807cbef9](https://github.com/mitogen-hq/mitogen/commit/807cbef9), [e93762b3](https://github.com/mitogen-hq/mitogen/commit/e93762b3),
  [50bfe4c7](https://github.com/mitogen-hq/mitogen/commit/50bfe4c7): locking is avoided on hot paths, and some locks are
  released before waking a thread that must immediately acquire the same lock.

### Mitogen for Ansible[¶](#mitogen-for-ansible "Permalink to this headline")

* [#363](https://github.com/mitogen-hq/mitogen/issues/363): fix an obscure race matching *Permission denied* errors from
  some versions of [su(1)](https://man7.org/linux/man-pages/man1/su.1.html) running on heavily loaded machines.
* [#410](https://github.com/mitogen-hq/mitogen/issues/410): Uses of [unix(7)](https://man7.org/linux/man-pages/man7/unix.7.html) sockets are replaced with
  traditional [pipe(7)](https://man7.org/linux/man-pages/man7/pipe.7.html) pairs when SELinux is detected, to work around
  a broken heuristic in common SELinux policies that prevents inheriting
  [unix(7)](https://man7.org/linux/man-pages/man7/unix.7.html) sockets across privilege domains.
* [#467](https://github.com/mitogen-hq/mitogen/issues/467): an incompatibility running Mitogen under [Molecule](https://ansible.readthedocs.io/projects/molecule/) was resolved.
* [#547](https://github.com/mitogen-hq/mitogen/issues/547), [#598](https://github.com/mitogen-hq/mitogen/issues/598): fix a deadlock during initialization of
  connections, `async` tasks, tasks using custom `module_utils`,
  `mitogen_task_isolation: fork` modules, and modules present on an internal
  blacklist. This would manifest as a timeout or hang, was easily hit, had been
  present since 0.2.0, and likely impacted many users.
* [#549](https://github.com/mitogen-hq/mitogen/issues/549): the open file limit is increased to the permitted hard
  limit. It is common for distributions to ship with a higher hard limit than
  the default soft limit, allowing *“too many open files”* errors to be avoided
  more often in large runs without user intervention.
* [#558](https://github.com/mitogen-hq/mitogen/issues/558), [#582](https://github.com/mitogen-hq/mitogen/issues/582): on Ansible 2.3 a directory was
  unconditionally deleted after the first module belonging to an action plug-in
  had executed, causing the [unarchive module](https://docs.ansible.com/ansible/latest/modules/unarchive_module.html) to fail.
* [#578](https://github.com/mitogen-hq/mitogen/issues/578): the extension could crash while rendering an error due to an
  incorrect format string.
* [#590](https://github.com/mitogen-hq/mitogen/issues/590): the importer can handle modules that replace themselves in
  [`sys.modules`](https://docs.python.org/3/library/sys.html#sys.modules "(in Python v3.13)") with completely unrelated modules during import, as in
  the case of Ansible 2.8 `ansible.module_utils.distro`.
* [#591](https://github.com/mitogen-hq/mitogen/issues/591): the working directory is reset between tasks to ensure
  [`os.getcwd()`](https://docs.python.org/3/library/os.html#os.getcwd "(in Python v3.13)") cannot fail, in the same way `AnsibleModule`
  resets it during initialization. However this restore happens before the
  module executes, ensuring code that calls [`os.getcwd()`](https://docs.python.org/3/library/os.html#os.getcwd "(in Python v3.13)") prior to
  `AnsibleModule` initialization, such as the Ansible 2.7
  [pip module](https://docs.ansible.com/ansible/latest/modules/pip_module.html), cannot fail due to the actions of a prior task.
* [#593](https://github.com/mitogen-hq/mitogen/issues/593): the SSH connection method exposes
  `mitogen_ssh_keepalive_interval` and `mitogen_ssh_keepalive_count`
  variables, and the default timeout for an SSH server has been increased from
  15\*3 seconds to 30\*10 seconds.
* [#600](https://github.com/mitogen-hq/mitogen/issues/600): functionality to reflect changes to `/etc/environment` did
  not account for Unicode file contents. The file may now use any single byte
  encoding.
* [#602](https://github.com/mitogen-hq/mitogen/issues/602): connection configuration is more accurately inferred for
  [meta: reset\_connection](https://docs.ansible.com/ansible/latest/modules/meta_module.html), the [synchronize module](https://docs.ansible.com/ansible/latest/modules/synchronize_module.html), and for
  any action plug-ins that establish additional connections.
* [#598](https://github.com/mitogen-hq/mitogen/issues/598), [#605](https://github.com/mitogen-hq/mitogen/issues/605): fix a deadlock managing a shared counter
  used for load balancing, present since 0.2.4.
* [#615](https://github.com/mitogen-hq/mitogen/issues/615): streaming is implemented for the [fetch module](https://docs.ansible.com/ansible/latest/modules/fetch_module.html) and other
  actions that transfer files from targets to the controller. Previously files
  were sent in one message, requiring them to fit in RAM and be smaller than an
  internal message size sanity check. Transfers from controller to targets have
  been streaming since 0.2.0.
* [7ae926b3](https://github.com/mitogen-hq/mitogen/commit/7ae926b3): the [lineinfile module](https://docs.ansible.com/ansible/latest/modules/lineinfile_module.html) leaked writable temporary
  file descriptors between Ansible 2.7.0 and 2.8.2. When [lineinfile](https://docs.ansible.com/ansible/latest/modules/lineinfile_module.html)
  created or modified a script, and that script was later executed, the
  execution could fail with “*text file busy*”. Temporary descriptors are now
  tracked and cleaned up on exit for all modules.

### Core Library[¶](#core-library "Permalink to this headline")

* Log readability is improving and many [`repr()`](https://docs.python.org/3/library/functions.html#repr "(in Python v3.13)") strings are more
  descriptive. The old pseudo-function-call format is migrating to
  readable output where possible. For example, *“Stream(ssh:123).connect()”*
  might be written *“connecting to ssh:123”*.
* In preparation for reducing default log output, many messages are delivered
  to per-component loggers, including messages originating from children,
  enabling [`logging`](https://docs.python.org/3/library/logging.html#module-logging "(in Python v3.13)") aggregation to function as designed. An importer
  message like:

  ```
  12:00:00 D mitogen.ctx.remotehost mitogen: loading module "foo"

  ```

  Might instead be logged to the `mitogen.importer.[remotehost]` logger:

  ```
  12:00:00 D mitogen.importer.[remotehost] loading module "foo"

  ```

  Allowing a filter or handler for `mitogen.importer` to select that logger
  in every process. This introduces a small risk of leaking memory in
  long-lived programs, as logger objects are internally persistent.
* `bytearray()` was removed from the list of supported serialization types.
  It was never portable between Python versions, unused, and never made much
  sense to support.
* [#170](https://github.com/mitogen-hq/mitogen/issues/170): to improve subprocess
  management and asynchronous connect, a `TimerList`
  interface is available, accessible as `Broker.timers` in an
  asynchronous context.
* [#419](https://github.com/mitogen-hq/mitogen/issues/419): the internal
  `Stream` has been refactored into many new classes,
  modularizing protocol behaviour, output buffering, line-oriented input
  parsing, option handling and connection management. Connection setup is
  internally asynchronous, laying most groundwork for fully asynchronous
  connect, proxied Ansible become plug-ins, and in-process SSH.
* [#169](https://github.com/mitogen-hq/mitogen/issues/169),
  [#419](https://github.com/mitogen-hq/mitogen/issues/419): zombie subprocess reaping
  has vastly improved, by using timers to efficiently poll for a child to exit,
  and delaying shutdown while any subprocess remains. Polling avoids
  process-global configuration such as a SIGCHLD handler, or
  [`signal.set_wakeup_fd()`](https://docs.python.org/3/library/signal.html#signal.set_wakeup_fd "(in Python v3.13)") available in modern Python.
* [#256](https://github.com/mitogen-hq/mitogen/issues/256), [#419](https://github.com/mitogen-hq/mitogen/issues/419): most [`os.dup()`](https://docs.python.org/3/library/os.html#os.dup "(in Python v3.13)") use was eliminated,
  along with most manual file descriptor management. Descriptors are trapped in
  [`os.fdopen()`](https://docs.python.org/3/library/os.html#os.fdopen "(in Python v3.13)") objects at creation, ensuring a leaked object will close
  itself, and ensuring every descriptor is fused to a closed flag, preventing
  historical bugs where a double close could destroy unrelated descriptors.
* [#533](https://github.com/mitogen-hq/mitogen/issues/533): routing accounts for
  a race between a parent (or cousin) sending a message to a child via an
  intermediary, where the child had recently disconnected, and
  [`DEL_ROUTE`](howitworks.html#mitogen.core.DEL_ROUTE "mitogen.core.DEL_ROUTE") propagating from the intermediary
  to the sender, informing it that the child no longer exists. This condition
  is detected at the intermediary and a [dead message](howitworks.html#is-dead) is
  returned to the sender.

  Previously since the intermediary had already removed its route for the
  child, the *route messages upwards* rule would be triggered, causing the
  message (with a privileged [src\_id/auth\_id](howitworks.html#stream-protocol)) to be
  sent upstream, resulting in a `bad auth_id` error logged at the first
  upstream parent, and a possible hang due to a request message being dropped.
* [#586](https://github.com/mitogen-hq/mitogen/issues/586): fix import of
  [`__main__`](https://docs.python.org/3/library/__main__.html#module-__main__ "(in Python v3.13)") on later versions of Python 3 when running from the
  interactive console.
* [#606](https://github.com/mitogen-hq/mitogen/issues/606): fix example code on the
  documentation front page.
* [#612](https://github.com/mitogen-hq/mitogen/issues/612): fix various errors
  introduced by stream refactoring.
* [#615](https://github.com/mitogen-hq/mitogen/issues/615): when routing fails to
  deliver a message for some reason other than the sender cannot or should not
  reach the recipient, and no reply-to address is present on the message,
  instead send a [dead message](howitworks.html#is-dead) to the original recipient. This
  ensures a descriptive message is delivered to a thread sleeping on the reply
  to a function call, where the reply might be dropped due to exceeding the
  maximum configured message size.
* [#624](https://github.com/mitogen-hq/mitogen/issues/624): the number of threads used for a child’s automatically
  initialized service thread pool has been reduced from 16 to 2. This may drop
  to 1 in future, and become configurable via a `Router` option.
* [a5536c35](https://github.com/mitogen-hq/mitogen/commit/a5536c35): avoid quadratic
  buffer management when logging lines received from a child’s redirected
  standard IO.
* [49a6446a](https://github.com/mitogen-hq/mitogen/commit/49a6446a): the
  `empty()` methods of `Latch`,
  `Receiver` and `Select` are
  obsoleted by a more general `size()` method. `empty()` will be
  removed in 0.3
* [ecc570cb](https://github.com/mitogen-hq/mitogen/commit/ecc570cb): previously
  `mitogen.select.Select.add()` would enqueue one wake event when adding an
  existing receiver, latch or subselect that contained multiple buffered items,
  causing `get()` calls to block or fail even though data existed to return.
* [5924af15](https://github.com/mitogen-hq/mitogen/commit/5924af15): *[security]*
  unidirectional routing, where contexts may optionally only communicate with
  parents and never siblings (so that air-gapped networks cannot be
  unintentionally bridged) was not inherited when a child was initiated
  directly from another child. This did not effect Ansible, since the
  controller initiates any new child used for routing, only forked tasks are
  initiated by children.

### Thanks![¶](#id2 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Andreas Hubert](https://github.com/peshay),
[Anton Markelov](https://github.com/strangeman),
[Dan](https://github.com/dsgnr),
[Dave Cottlehuber](https://github.com/dch),
[Denis Krienbühl](https://github.com/href),
[El Mehdi CHAOUKI](https://github.com/elmchaouki),
[Florent Dutheil](https://github.com/fdutheil),
[James Hogarth](https://github.com/hogarthj),
[Jordan Webb](https://github.com/jordemort),
[Julian Andres Klode](https://github.com/julian-klode),
[Marc Hartmayer](https://github.com/marc1006),
[Nigel Metheringham](https://github.com/nigelm),
[Orion Poplawski](https://github.com/opoplawski),
[Pieter Voet](https://github.com/pietervoet/),
[Stefane Fermigier](https://github.com/sfermigier),
[Szabó Dániel Ernő](https://github.com/r3ap3rpy),
[Ulrich Schreiner](https://github.com/ulrichSchreiner),
[Vincent S. Cojot](https://github.com/ElCoyote27),
[yen](https://github.com/antigenius0910),
[Yuki Nishida](https://github.com/yuki-nishida-exa),
[@alexhexabeam](https://github.com/alexhexabeam),
[@DavidVentura](https://github.com/DavidVentura),
[@dbiegunski](https://github.com/dbiegunski),
[@ghp-rr](https://github.com/ghp-rr),
[@migalsp](https://github.com/migalsp),
[@rizzly](https://github.com/rizzly),
[@SQGE](https://github.com/SQGE), and
[@tho86](https://github.com/tho86).

Footnotes

[1](#id1)

Peak RSS of controller and target as measured with `/usr/bin/time
-v ansible-playbook -c local` using the reproduction supplied in
[#615](https://github.com/mitogen-hq/mitogen/issues/615).

## v0.2.7 (2019-05-19)[¶](#v0-2-7-2019-05-19 "Permalink to this headline")

This release primarily exists to add a descriptive error message when running
on Ansible 2.8, which is not yet supported.

### Fixes[¶](#fixes "Permalink to this headline")

* [#557](https://github.com/mitogen-hq/mitogen/issues/557): fix a crash when running
  on machines with high CPU counts.
* [#570](https://github.com/mitogen-hq/mitogen/issues/570): the [firewalld module](https://docs.ansible.com/ansible/latest/modules/firewalld_module.html) internally caches a dbus name that
  changes across [firewalld](https://docs.ansible.com/ansible/latest/modules/firewalld_module.html) restarts, causing a failure if the
  service is restarted between [firewalld](https://docs.ansible.com/ansible/latest/modules/firewalld_module.html) module invocations.
* [#575](https://github.com/mitogen-hq/mitogen/issues/575): fix a crash when
  rendering an error message to indicate no usable temporary directories could
  be found.
* [#576](https://github.com/mitogen-hq/mitogen/issues/576): fix a crash during
  startup on SuSE Linux 11, due to an incorrect version compatibility check in
  the Mitogen code.
* [#581](https://github.com/mitogen-hq/mitogen/issues/581): a
  `mitogen_mask_remote_name` Ansible variable is exposed, to allow masking
  the username, hostname and process ID of `ansible-playbook` running on the
  controller machine.
* [#587](https://github.com/mitogen-hq/mitogen/issues/587): display a friendly
  message when running on an unsupported version of Ansible, to cope with
  potential influx of 2.8-related bug reports.

### Thanks![¶](#id3 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Orion Poplawski](https://github.com/opoplawski),
[Thibaut Barrère](https://github.com/thbar),
[@Moumoutaru](https://github.com/Moumoutaru), and
[@polski-g](https://github.com/polski-g).

## v0.2.6 (2019-03-06)[¶](#v0-2-6-2019-03-06 "Permalink to this headline")

### Fixes[¶](#id5 "Permalink to this headline")

* [#542](https://github.com/mitogen-hq/mitogen/issues/542): some versions of OS X
  ship a default Python that does not support [`select.poll()`](https://docs.python.org/3/library/select.html#select.poll "(in Python v3.13)"). Restore the
  0.2.3 behaviour of defaulting to Kqueue in this case, but still prefer
  [`select.poll()`](https://docs.python.org/3/library/select.html#select.poll "(in Python v3.13)") if it is available.
* [#545](https://github.com/mitogen-hq/mitogen/issues/545): an optimization
  introduced in [#493](https://github.com/mitogen-hq/mitogen/issues/493) caused a
  64-bit integer to be assigned to a 32-bit field on ARM 32-bit targets,
  causing runs to fail.
* [#548](https://github.com/mitogen-hq/mitogen/issues/548): mitogen\_via= could fail
  when the selected transport was set to `smart`.
* [#550](https://github.com/mitogen-hq/mitogen/issues/550): avoid some broken
  TTY-related ioctl() calls on Windows Subsystem for Linux 2016 Anniversary
  Update.
* [#554](https://github.com/mitogen-hq/mitogen/issues/554): third party Ansible
  action plug-ins that invoked `_make_tmp_path()` repeatedly could trigger
  an assertion failure.
* [#555](https://github.com/mitogen-hq/mitogen/issues/555): work around an old idiom
  that reloaded [`sys`](https://docs.python.org/3/library/sys.html#module-sys "(in Python v3.13)") in order to change the interpreter’s default encoding.
* [ffae0355](https://github.com/mitogen-hq/mitogen/commit/ffae0355): needless
  information was removed from the documentation and installation procedure.

### Core Library[¶](#id6 "Permalink to this headline")

* [#535](https://github.com/mitogen-hq/mitogen/issues/535): to support function calls
  on a service pool from another thread, `mitogen.select.Select`
  additionally permits waiting on `mitogen.core.Latch`.
* [#535](https://github.com/mitogen-hq/mitogen/issues/535):
  `mitogen.service.Pool.defer` allows any function to be enqueued for
  the thread pool from another thread.
* [#535](https://github.com/mitogen-hq/mitogen/issues/535): a new
  `mitogen.os_fork` module provides a [`os.fork()`](https://docs.python.org/3/library/os.html#os.fork "(in Python v3.13)") wrapper that pauses
  thread activity during fork. On Python<2.6, `mitogen.core.Broker` and
  `mitogen.service.Pool` automatically record their existence so that a
  [`os.fork()`](https://docs.python.org/3/library/os.html#os.fork "(in Python v3.13)") monkey-patch can automatically pause them for any attempt to
  start a subprocess.
* [ca63c26e](https://github.com/mitogen-hq/mitogen/commit/ca63c26e):
  `mitogen.core.Latch.put()`’s obj argument was made optional.

### Thanks![¶](#id7 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Fabian Arrotin](https://github.com/arrfab),
[Giles Westwood](https://github.com/gilesw),
[Matt Layman](https://github.com/mblayman),
[Percy Grunwald](https://github.com/percygrunwald),
[Petr Enkov](https://github.com/enkov),
[Tony Finch](https://github.com/fanf2),
[@elbunda](https://github.com/elbunda), and
[@zyphermonkey](https://github.com/zyphermonkey).

## v0.2.5 (2019-02-14)[¶](#v0-2-5-2019-02-14 "Permalink to this headline")

### Fixes[¶](#id8 "Permalink to this headline")

* [#511](https://github.com/mitogen-hq/mitogen/issues/511),
  [#536](https://github.com/mitogen-hq/mitogen/issues/536): changes in 0.2.4 to
  repair `delegate_to` handling broke default `ansible_python_interpreter`
  handling. Test coverage was added.
* [#532](https://github.com/mitogen-hq/mitogen/issues/532): fix a race in the service
  used to propagate Ansible modules, that could easily manifest when starting
  asynchronous tasks in a loop.
* [#536](https://github.com/mitogen-hq/mitogen/issues/536): changes in 0.2.4 to
  support Python 2.4 interacted poorly with modules that imported
  `simplejson` from a controller that also loaded an incompatible newer
  version of `simplejson`.
* [#537](https://github.com/mitogen-hq/mitogen/issues/537): a swapped operator in the
  CPU affinity logic meant 2 cores were reserved on 1<n<4 core machines, rather
  than 1 core as desired. Test coverage was added.
* [#538](https://github.com/mitogen-hq/mitogen/issues/538): the source distribution
  includes a `LICENSE` file.
* [#539](https://github.com/mitogen-hq/mitogen/issues/539): log output is no longer
  duplicated when the Ansible `log_path` setting is enabled.
* [#540](https://github.com/mitogen-hq/mitogen/issues/540): the `stderr` stream of
  async module invocations was previously discarded.
* [#541](https://github.com/mitogen-hq/mitogen/issues/541): Python error logs
  originating from the `boto` package are quiesced, and only appear in
  `-vvv` output. This is since EC2 modules may trigger errors during normal
  operation, when retrying transiently failing requests.
* [748f5f67](https://github.com/mitogen-hq/mitogen/commit/748f5f67),
  [21ad299d](https://github.com/mitogen-hq/mitogen/commit/21ad299d),
  [8ae6ca1d](https://github.com/mitogen-hq/mitogen/commit/8ae6ca1d),
  [7fd0d349](https://github.com/mitogen-hq/mitogen/commit/7fd0d349):
  the `ansible_ssh_host`, `ansible_ssh_user`, `ansible_user`,
  `ansible_become_method`, and `ansible_ssh_port` variables more correctly
  match typical behaviour when `mitogen_via=` is active.
* [2a8567b4](https://github.com/mitogen-hq/mitogen/commit/2a8567b4): fix a race
  initializing a child’s service thread pool on Python 3.4+, due to a change in
  locking scheme used by the Python import mechanism.

### Thanks![¶](#id9 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Carl George](https://github.com/carlwgeorge),
[Guy Knights](https://github.com/knightsg), and
[Josh Smift](https://github.com/jbscare).

## v0.2.4 (2019-02-10)[¶](#v0-2-4-2019-02-10 "Permalink to this headline")

### Mitogen for Ansible[¶](#id10 "Permalink to this headline")

This release includes a huge variety of important fixes and new optimizations.
It is 35% faster than 0.2.3 on a synthetic 64 target run that places heavy load
on the connection multiplexer.

#### Enhancements[¶](#id11 "Permalink to this headline")

* [#76](https://github.com/mitogen-hq/mitogen/issues/76),
  [#351](https://github.com/mitogen-hq/mitogen/issues/351),
  [#352](https://github.com/mitogen-hq/mitogen/issues/352): disconnect propagation
  has improved, allowing Ansible to cancel waits for responses from abruptly
  disconnected targets. This ensures a task will reliably fail rather than
  hang, for example on network failure or EC2 instance maintenance.
* [#369](https://github.com/mitogen-hq/mitogen/issues/369),
  [#407](https://github.com/mitogen-hq/mitogen/issues/407): `Connection.reset()`
  is implemented, allowing [meta: reset\_connection](https://docs.ansible.com/ansible/latest/modules/meta_module.html) to shut
  down the remote interpreter as documented, and improving support for the
  [reboot module](https://docs.ansible.com/ansible/latest/modules/reboot_module.html).
* [09aa27a6](https://github.com/mitogen-hq/mitogen/commit/09aa27a6): the
  `mitogen_host_pinned` strategy wraps the `host_pinned` strategy
  introduced in Ansible 2.7.
* [#477](https://github.com/mitogen-hq/mitogen/issues/477): Python 2.4 is fully
  supported by the core library and tested automatically, in any parent/child
  combination of 2.4, 2.6, 2.7 and 3.6 interpreters.
* [#477](https://github.com/mitogen-hq/mitogen/issues/477): Ansible 2.3 is fully
  supported and tested automatically. In combination with the core library
  Python 2.4 support, this allows Red Hat Enterprise Linux 5 targets to be
  managed with Mitogen. The `simplejson` package need not be installed on
  such targets, as is usually required by Ansible.
* [#412](https://github.com/mitogen-hq/mitogen/issues/412): to simplify diagnosing
  connection configuration problems, Mitogen ships a `mitogen_get_stack`
  action that is automatically added to the action plug-in path. See
  [The mitogen\_get\_stack Action](ansible_detailed.html#mitogen-get-stack) for more information.
* [152effc2](https://github.com/mitogen-hq/mitogen/commit/152effc2),
  [bd4b04ae](https://github.com/mitogen-hq/mitogen/commit/bd4b04ae): a CPU affinity
  policy was added for Linux controllers, reducing latency and SMP overhead on
  hot paths exercised for every task. This yielded a 19% speedup in a 64-target
  job composed of many short tasks, and should easily be visible as a runtime
  improvement in many-host runs.
* [2b44d598](https://github.com/mitogen-hq/mitogen/commit/2b44d598): work around a
  defective caching mechanism by pre-heating it before spawning workers. This
  saves 40% runtime on a synthetic repetitive task.
* [0979422a](https://github.com/mitogen-hq/mitogen/commit/0979422a): an expensive
  dependency scanning step was redundantly invoked for every task,
  bottlenecking the connection multiplexer.
* [eaa990a97](https://github.com/mitogen-hq/mitogen/commit/eaa990a97): a new
  `mitogen_ssh_compression` variable is supported, allowing Mitogen’s default
  SSH compression to be disabled. SSH compression is a large contributor to CPU
  usage in many-target runs, and severely limits file transfer. On a “shell:
  hostname” task repeated 500 times, Mitogen requires around 800 bytes per
  task with compression, rising to 3 KiB without. File transfer throughput
  rises from ~25MiB/s when enabled to ~200MiB/s when disabled.
* [#260](https://github.com/mitogen-hq/mitogen/issues/260),
  [a18a083c](https://github.com/mitogen-hq/mitogen/commit/a18a083c): brokers no
  longer wait for readiness indication to transmit, and instead assume
  transmission will succeed. As this is usually true, one loop iteration and
  two poller reconfigurations are avoided, yielding a significant reduction in
  interprocess round-trip latency.
* [#415](https://github.com/mitogen-hq/mitogen/issues/415), [#491](https://github.com/mitogen-hq/mitogen/issues/491), [#493](https://github.com/mitogen-hq/mitogen/issues/493): the interface employed
  for in-process queues changed from [kqueue(2)](https://man.freebsd.org/cgi/man.cgi?query=kqueue) /
  [epoll(7)](https://man7.org/linux/man-pages/man7/epoll.7.html) to [poll(2)](https://man7.org/linux/man-pages/man2/poll.2.html), which requires no setup or
  teardown, yielding a 38% latency reduction for inter-thread communication.

#### Fixes[¶](#id12 "Permalink to this headline")

* [#251](https://github.com/mitogen-hq/mitogen/issues/251),
  [#359](https://github.com/mitogen-hq/mitogen/issues/359),
  [#396](https://github.com/mitogen-hq/mitogen/issues/396),
  [#401](https://github.com/mitogen-hq/mitogen/issues/401),
  [#404](https://github.com/mitogen-hq/mitogen/issues/404),
  [#412](https://github.com/mitogen-hq/mitogen/issues/412),
  [#434](https://github.com/mitogen-hq/mitogen/issues/434),
  [#436](https://github.com/mitogen-hq/mitogen/issues/436),
  [#465](https://github.com/mitogen-hq/mitogen/issues/465): connection delegation and
  `delegate_to:` handling suffered a major regression in 0.2.3. The 0.2.2
  behaviour has been restored, and further work has been made to improve the
  compatibility of connection delegation’s configuration building methods.
* [#323](https://github.com/mitogen-hq/mitogen/issues/323),
  [#333](https://github.com/mitogen-hq/mitogen/issues/333): work around a Windows
  Subsystem for Linux bug that caused tracebacks to appear during shutdown.
* [#334](https://github.com/mitogen-hq/mitogen/issues/334): the SSH method
  tilde-expands private key paths using Ansible’s logic. Previously the path
  was passed unmodified to SSH, which expanded it using [`pwd.getpwnam()`](https://docs.python.org/3/library/pwd.html#pwd.getpwnam "(in Python v3.13)").
  This differs from [`os.path.expanduser()`](https://docs.python.org/3/library/os.path.html#os.path.expanduser "(in Python v3.13)"), which uses the `HOME`
  environment variable if it is set, causing behaviour to diverge when Ansible
  was invoked across user accounts via `sudo`.
* [#364](https://github.com/mitogen-hq/mitogen/issues/364): file transfers from
  controllers running Python 2.7.2 or earlier could be interrupted due to a
  forking bug in the [`tempfile`](https://docs.python.org/3/library/tempfile.html#module-tempfile "(in Python v3.13)") module.
* [#370](https://github.com/mitogen-hq/mitogen/issues/370): the Ansible [reboot module](https://docs.ansible.com/ansible/latest/modules/reboot_module.html) is supported.
* [#373](https://github.com/mitogen-hq/mitogen/issues/373): the LXC and LXD methods print a useful hint on failure, as
  no useful error is normally logged to the console by these tools.
* [#374](https://github.com/mitogen-hq/mitogen/issues/374),
  [#391](https://github.com/mitogen-hq/mitogen/issues/391): file transfer and module
  execution from 2.x controllers to 3.x targets was broken due to a regression
  caused by refactoring, and compounded by [#426](https://github.com/mitogen-hq/mitogen/issues/426).
* [#400](https://github.com/mitogen-hq/mitogen/issues/400): work around a threading
  bug in the AWX display callback when running with high verbosity setting.
* [#409](https://github.com/mitogen-hq/mitogen/issues/409): the setns method was
  silently broken due to missing tests. Basic coverage was added to prevent a
  recurrence.
* [#409](https://github.com/mitogen-hq/mitogen/issues/409): the LXC and LXD methods
  support `mitogen_lxc_path` and `mitogen_lxc_attach_path` variables to
  control the location of third pary utilities.
* [#410](https://github.com/mitogen-hq/mitogen/issues/410): the sudo method supports
  the SELinux `--type` and `--role` options.
* [#420](https://github.com/mitogen-hq/mitogen/issues/420): if a `Connection`
  was constructed in the Ansible top-level process, for example while executing
  `meta: reset_connection`, resources could become undesirably shared in
  subsequent children.
* [#426](https://github.com/mitogen-hq/mitogen/issues/426): an oversight while
  porting to Python 3 meant no automated 2->3 tests were running. A significant
  number of 2->3 bugs were fixed, mostly in the form of Unicode/bytes
  mismatches.
* [#429](https://github.com/mitogen-hq/mitogen/issues/429): the `sudo` method can
  now recognize internationalized password prompts.
* [#362](https://github.com/mitogen-hq/mitogen/issues/362),
  [#435](https://github.com/mitogen-hq/mitogen/issues/435): the previous fix for slow
  Python 2.x subprocess creation on Red Hat caused newly spawned children to
  have a reduced open files limit. A more intrusive fix has been added to
  directly address the problem without modifying the subprocess environment.
* [#397](https://github.com/mitogen-hq/mitogen/issues/397),
  [#454](https://github.com/mitogen-hq/mitogen/issues/454): the previous approach to
  handling modern Ansible temporary file cleanup was too aggressive, and could
  trigger early finalization of Cython-based extension modules, leading to
  segmentation faults.
* [#499](https://github.com/mitogen-hq/mitogen/issues/499): the `allow_same_user`
  Ansible configuration setting is respected.
* [#527](https://github.com/mitogen-hq/mitogen/issues/527): crashes in modules are
  trapped and reported in a manner that matches Ansible. In particular, a
  module crash no longer leads to an exception that may crash the corresponding
  action plug-in.
* [dc1d4251](https://github.com/mitogen-hq/mitogen/commit/dc1d4251): the [synchronize module](https://docs.ansible.com/ansible/latest/modules/synchronize_module.html) could fail with the Docker
  transport due to a missing attribute.
* [599da068](https://github.com/mitogen-hq/mitogen/commit/599da068): fix a race
  when starting async tasks, where it was possible for the controller to
  observe no status file on disk before the task had a chance to write one.
* [2c7af9f04](https://github.com/mitogen-hq/mitogen/commit/2c7af9f04): Ansible
  modules were repeatedly re-transferred. The bug was hidden by the previously
  mandatorily enabled SSH compression.

### Core Library[¶](#id13 "Permalink to this headline")

* [#76](https://github.com/mitogen-hq/mitogen/issues/76): routing records the
  destination context IDs ever received on each stream, and when disconnection
  occurs, propagates [`mitogen.core.DEL_ROUTE`](howitworks.html#mitogen.core.DEL_ROUTE "mitogen.core.DEL_ROUTE") messages towards every
  stream that ever communicated with the disappearing peer, rather than simply
  towards parents. Conversations between nodes anywhere in the tree receive
  [`mitogen.core.DEL_ROUTE`](howitworks.html#mitogen.core.DEL_ROUTE "mitogen.core.DEL_ROUTE") when either participant disconnects, allowing
  receivers to wake with `mitogen.core.ChannelError`, even when one
  participant is not a parent of the other.
* [#109](https://github.com/mitogen-hq/mitogen/issues/109),
  [57504ba6](https://github.com/mitogen-hq/mitogen/commit/57504ba6): newer Python 3
  releases explicitly populate [`sys.meta_path`](https://docs.python.org/3/library/sys.html#sys.meta_path "(in Python v3.13)") with importer internals,
  causing Mitogen to install itself at the end of the importer chain rather
  than the front.
* [#310](https://github.com/mitogen-hq/mitogen/issues/310): support has returned for
  trying to figure out the real source of non-module objects installed in
  [`sys.modules`](https://docs.python.org/3/library/sys.html#sys.modules "(in Python v3.13)"), so they can be imported. This is needed to handle syntax
  sugar used by packages like `plumbum`.
* [#349](https://github.com/mitogen-hq/mitogen/issues/349): an incorrect format
  string could cause large stack traces when attempting to import built-in
  modules on Python 3.
* [#387](https://github.com/mitogen-hq/mitogen/issues/387),
  [#413](https://github.com/mitogen-hq/mitogen/issues/413): dead messages include an
  optional reason in their body. This is used to cause
  `mitogen.core.ChannelError` to report far more useful diagnostics at
  the point the error occurs that previously would have been buried in debug
  log output from an unrelated context.
* [#408](https://github.com/mitogen-hq/mitogen/issues/408): a variety of fixes were
  made to restore Python 2.4 compatibility.
* [#399](https://github.com/mitogen-hq/mitogen/issues/399),
  [#437](https://github.com/mitogen-hq/mitogen/issues/437): ignore a
  [`DeprecationWarning`](https://docs.python.org/3/library/exceptions.html#DeprecationWarning "(in Python v3.13)") to avoid failure of the `su` method on Python
  3.7.
* [#405](https://github.com/mitogen-hq/mitogen/issues/405): if an oversized message
  is rejected, and it has a `reply_to` set, a dead message is returned to the
  sender. This ensures function calls exceeding the configured maximum size
  crash rather than hang.
* [#406](https://github.com/mitogen-hq/mitogen/issues/406):
  `mitogen.core.Broker` did not call `mitogen.core.Poller.close()`
  during shutdown, leaking the underlying poller FD in masters and parents.
* [#406](https://github.com/mitogen-hq/mitogen/issues/406): connections could leak
  FDs when a child process failed to start.
* [#288](https://github.com/mitogen-hq/mitogen/issues/288),
  [#406](https://github.com/mitogen-hq/mitogen/issues/406),
  [#417](https://github.com/mitogen-hq/mitogen/issues/417): connections could leave
  FD wrapper objects that had not been closed lying around to be closed during
  garbage collection, causing reused FD numbers to be closed at random moments.
* [#411](https://github.com/mitogen-hq/mitogen/issues/411): the SSH method typed
  “`y`” rather than the requisite “`yes`” when check\_host\_keys=”accept”
  was configured. This would lead to connection timeouts due to the hung
  response.
* [#414](https://github.com/mitogen-hq/mitogen/issues/414),
  [#425](https://github.com/mitogen-hq/mitogen/issues/425): avoid deadlock of forked
  children by reinitializing the `mitogen.service` pool lock.
* [#416](https://github.com/mitogen-hq/mitogen/issues/416): around 1.4KiB of memory
  was leaked on every RPC, due to a list of strong references keeping alive any
  handler ever registered for disconnect notification.
* [#418](https://github.com/mitogen-hq/mitogen/issues/418): the
  `mitogen.parent.iter_read()` helper would leak poller FDs, because
  execution of its [`finally`](https://docs.python.org/3/reference/compound_stmts.html#finally "(in Python v3.13)") block was delayed on Python 3. Now
  callers explicitly close the generator when finished.
* [#422](https://github.com/mitogen-hq/mitogen/issues/422): the fork method could
  fail to start if [`sys.stdout`](https://docs.python.org/3/library/sys.html#sys.stdout "(in Python v3.13)") was opened in block buffered mode, and
  buffered data was pending in the parent prior to fork.
* [#438](https://github.com/mitogen-hq/mitogen/issues/438): a descriptive error is
  logged when stream corruption is detected.
* [#439](https://github.com/mitogen-hq/mitogen/issues/439): descriptive errors are
  raised when attempting to invoke unsupported function types.
* [#444](https://github.com/mitogen-hq/mitogen/issues/444): messages regarding
  unforwardable extension module are no longer logged as errors.
* [#445](https://github.com/mitogen-hq/mitogen/issues/445): service pools unregister
  the `mitogen.core.CALL_SERVICE` handle at shutdown, ensuring any
  outstanding messages are either processed by the pool as it shuts down, or
  have dead messages sent in reply to them, preventing peer contexts from
  hanging due to a forgotten buffered message.
* [#446](https://github.com/mitogen-hq/mitogen/issues/446): given thread A calling
  `mitogen.core.Receiver.close()`, and thread B, C, and D sleeping in
  `mitogen.core.Receiver.get()`, previously only one sleeping thread would
  be woken with `mitogen.core.ChannelError` when the receiver was
  closed. Now all threads are woken per the docstring.
* [#447](https://github.com/mitogen-hq/mitogen/issues/447): duplicate attempts to
  invoke `mitogen.core.Router.add_handler()` cause an error to be raised,
  ensuring accidental re-registration of service pools are reported correctly.
* [#448](https://github.com/mitogen-hq/mitogen/issues/448): the import hook
  implementation now raises [`ModuleNotFoundError`](https://docs.python.org/3/library/exceptions.html#ModuleNotFoundError "(in Python v3.13)") instead of
  [`ImportError`](https://docs.python.org/3/library/exceptions.html#ImportError "(in Python v3.13)") in Python 3.6 and above, to cope with an upcoming
  version of the [`subprocess`](https://docs.python.org/3/library/subprocess.html#module-subprocess "(in Python v3.13)") module requiring this new subclass to be
  raised.
* [#453](https://github.com/mitogen-hq/mitogen/issues/453): the loggers used in
  children for standard IO redirection have propagation disabled, preventing
  accidental reconfiguration of the [`logging`](https://docs.python.org/3/library/logging.html#module-logging "(in Python v3.13)") package in a child from
  setting up a feedback loop.
* [#456](https://github.com/mitogen-hq/mitogen/issues/456): a descriptive error is
  logged when `mitogen.core.Broker.defer()` is called after the broker has
  shut down, preventing new messages being enqueued that will never be sent,
  and subsequently producing a program hang.
* [#459](https://github.com/mitogen-hq/mitogen/issues/459): the beginnings of a
  `mitogen.master.Router.get_stats()` call has been added. The initial
  statistics cover the module loader only.
* [#462](https://github.com/mitogen-hq/mitogen/issues/462): Mitogen could fail to
  open a PTY on broken Linux systems due to a bad interaction between the glibc
  `grantpt()` function and an incorrectly mounted `/dev/pts` filesystem.
  Since correct group ownership is not required in most scenarios, when this
  problem is detected, the PTY is allocated and opened directly by the library.
* [#479](https://github.com/mitogen-hq/mitogen/issues/479): Mitogen could fail to
  import [`__main__`](https://docs.python.org/3/library/__main__.html#module-__main__ "(in Python v3.13)") on Python 3.4 and newer due to a breaking change in
  the [`pkgutil`](https://docs.python.org/3/library/pkgutil.html#module-pkgutil "(in Python v3.13)") API. The program’s main script is now handled specially.
* [#481](https://github.com/mitogen-hq/mitogen/issues/481): the version of sudo
  that shipped with CentOS 5 replaced itself with the program to be executed,
  and therefore did not hold any child PTY open on our behalf. The child
  context is updated to preserve any PTY FD in order to avoid the kernel
  sending SIGHUP early during startup.
* [#523](https://github.com/mitogen-hq/mitogen/issues/523): the test suite didn’t
  generate a code coverage report if any test failed.
* [#524](https://github.com/mitogen-hq/mitogen/issues/524): Python 3.6+ emitted a
  [`DeprecationWarning`](https://docs.python.org/3/library/exceptions.html#DeprecationWarning "(in Python v3.13)") for `mitogen.utils.run_with_router()`.
* [#529](https://github.com/mitogen-hq/mitogen/issues/529): Code coverage of the
  test suite was not measured across all Python versions.
* [16ca111e](https://github.com/mitogen-hq/mitogen/commit/16ca111e): handle OpenSSH
  7.5 permission denied prompts when `~/.ssh/config` rewrites are present.
* [9ec360c2](https://github.com/mitogen-hq/mitogen/commit/9ec360c2): a new
  `mitogen.core.Broker.defer_sync()` utility function is provided.
* [f20e0bba](https://github.com/mitogen-hq/mitogen/commit/f20e0bba):
  `mitogen.service.FileService.register_prefix()` permits granting
  unprivileged access to whole filesystem subtrees, rather than single files at
  a time.
* [8f85ee03](https://github.com/mitogen-hq/mitogen/commit/8f85ee03):
  `mitogen.core.Router.myself()` returns a `mitogen.core.Context`
  referring to the current process.
* [824c7931](https://github.com/mitogen-hq/mitogen/commit/824c7931): exceptions
  raised by the import hook were updated to include probable reasons for
  a failure.
* [57b652ed](https://github.com/mitogen-hq/mitogen/commit/57b652ed): a stray import
  meant an extra roundtrip and ~4KiB of data was wasted for any context that
  imported `mitogen.parent`.

### Thanks![¶](#id14 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Alex Willmer](https://github.com/moreati),
[Andreas Krüger](https://github.com/woopstar),
[Anton Stroganov](https://github.com/Aeon),
[Berend De Schouwer](https://github.com/berenddeschouwer),
[Brian Candler](https://github.com/candlerb),
[dsgnr](https://github.com/dsgnr),
[Duane Zamrok](https://github.com/dewthefifth),
[Eric Chang](https://github.com/changchichung),
[Gerben Meijer](https://github.com/infernix),
[Guy Knights](https://github.com/knightsg),
[Jesse London](https://github.com/jesteria),
[Jiří Vávra](https://github.com/Houbovo),
[Johan Beisser](https://github.com/jbeisser),
[Jonathan Rosser](https://github.com/jrosser),
[Josh Smift](https://github.com/jbscare),
[Kevin Carter](https://github.com/cloudnull),
[Mehdi](https://github.com/mehdisat7),
[Michael DeHaan](https://github.com/mpdehaan),
[Michal Medvecky](https://github.com/michalmedvecky),
[Mohammed Naser](https://github.com/mnaser/),
[Peter V. Saveliev](https://github.com/svinota/),
[Pieter Avonts](https://github.com/pieteravonts/),
[Ross Williams](https://github.com/overhacked/),
[Sergey](https://github.com/LuckySB/),
[Stéphane](https://github.com/sboisson/),
[Strahinja Kustudic](https://github.com/kustodian),
[Tom Parker-Shemilt](https://github.com/palfrey/),
[Younès HAFRI](https://github.com/yhafri),
[@killua-eu](https://github.com/killua-eu),
[@myssa91](https://github.com/myssa91),
[@ohmer1](https://github.com/ohmer1),
[@s3c70r](https://github.com/s3c70r/),
[@syntonym](https://github.com/syntonym/),
[@trim777](https://github.com/trim777/),
[@whky](https://github.com/whky/), and
[@yodatak](https://github.com/yodatak/).

## v0.2.3 (2018-10-23)[¶](#v0-2-3-2018-10-23 "Permalink to this headline")

### Mitogen for Ansible[¶](#id17 "Permalink to this headline")

#### Enhancements[¶](#id18 "Permalink to this headline")

* [#315](https://github.com/mitogen-hq/mitogen/pull/315),
  [#392](https://github.com/mitogen-hq/mitogen/issues/392): Ansible 2.6 and 2.7 are
  supported.
* [#321](https://github.com/mitogen-hq/mitogen/issues/321), [#336](https://github.com/mitogen-hq/mitogen/issues/336): temporary file handling was simplified,
  undoing earlier damage caused by compatibility fixes, improving 2.6
  compatibility, and avoiding two network roundtrips for every related action
  ([assemble](https://docs.ansible.com/ansible/latest/modules/assemble_module.html), [aws\_s3](https://docs.ansible.com/ansible/latest/modules/aws_s3_module.html), [copy](https://docs.ansible.com/ansible/latest/modules/copy_module.html),
  [patch](https://docs.ansible.com/ansible/latest/modules/patch_module.html), [script](https://docs.ansible.com/ansible/latest/modules/script_module.html), [template](https://docs.ansible.com/ansible/latest/modules/template_module.html),
  [unarchive](https://docs.ansible.com/ansible/latest/modules/unarchive_module.html), [uri](https://docs.ansible.com/ansible/latest/modules/uri_module.html)). See [Temporary Files](ansible_detailed.html#ansible-tempfiles) for a
  complete description.
* [#376](https://github.com/mitogen-hq/mitogen/pull/376), [#377](https://github.com/mitogen-hq/mitogen/pull/377): the `kubectl` connection type is now
  supported. Contributed by Yannig Perré.
* [084c0ac0](https://github.com/mitogen-hq/mitogen/commit/084c0ac0): avoid a roundtrip in [copy](https://docs.ansible.com/ansible/latest/modules/copy_module.html) and
  [template](https://docs.ansible.com/ansible/latest/modules/template_module.html) due to an unfortunate default.
* [7458dfae](https://github.com/mitogen-hq/mitogen/commit/7458dfae): avoid a
  roundtrip when transferring files smaller than 124KiB. Copy and template
  actions are now 2-RTT, reducing runtime for a 20-iteration template loop over
  a 250 ms link from 30 seconds to 10 seconds compared to v0.2.2, down from 120
  seconds compared to vanilla.
* [#337](https://github.com/mitogen-hq/mitogen/issues/337): To avoid a scaling
  limitation, a PTY is no longer allocated for an SSH connection unless the
  configuration specifies a password.
* [d62e6e2a](https://github.com/mitogen-hq/mitogen/commit/d62e6e2a): many-target
  runs executed the dependency scanner redundantly due to missing
  synchronization, wasting significant runtime in the connection multiplexer.
  In one case work was reduced by 95%, which may manifest as faster runs.
* [5189408e](https://github.com/mitogen-hq/mitogen/commit/5189408e): threads are
  cooperatively scheduled, minimizing [GIL](https://en.wikipedia.org/wiki/Global_interpreter_lock) contention, and
  reducing context switching by around 90%. This manifests as an overall
  improvement, but is easily noticeable on short many-target runs, where
  startup overhead dominates runtime.
* The [faulthandler](https://faulthandler.readthedocs.io/) module is
  automatically activated if it is installed, simplifying debugging of hangs.
  See [Diagnosing Hangs](ansible_detailed.html#diagnosing-hangs) for details.
* The `MITOGEN_DUMP_THREAD_STACKS` environment variable’s value now indicates
  the number of seconds between stack dumps. See [Diagnosing Hangs](ansible_detailed.html#diagnosing-hangs) for
  details.

#### Fixes[¶](#id19 "Permalink to this headline")

* [#251](https://github.com/mitogen-hq/mitogen/issues/251),
  [#340](https://github.com/mitogen-hq/mitogen/issues/340): Connection Delegation
  could establish connections to the wrong target when `delegate_to:` is
  present.
* [#291](https://github.com/mitogen-hq/mitogen/issues/291): when Mitogen had
  previously been installed using `pip` or `setuptools`, the globally
  installed version could conflict with a newer version bundled with an
  extension that had been installed using the documented steps. Now the bundled
  library always overrides over any system-installed copy.
* [#324](https://github.com/mitogen-hq/mitogen/issues/324): plays with a
  [custom module\_utils](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-module-utils-path)
  would fail due to fallout from the Python 3 port and related tests being
  disabled.
* [#331](https://github.com/mitogen-hq/mitogen/issues/331): the connection
  multiplexer subprocess always exits before the main Ansible process, ensuring
  logs generated by it do not overwrite the user’s prompt when `-vvv` is
  enabled.
* [#332](https://github.com/mitogen-hq/mitogen/issues/332): support a new
  [`sys.excepthook()`](https://docs.python.org/3/library/sys.html#sys.excepthook "(in Python v3.13)")-based module exit mechanism added in Ansible 2.6.
* [#338](https://github.com/mitogen-hq/mitogen/issues/338): compatibility: changes to
  `/etc/environment` and `~/.pam_environment` made by a task are reflected
  in the runtime environment of subsequent tasks. See
  [Process Environment Emulation](ansible_detailed.html#ansible-process-env) for a complete description.
* [#343](https://github.com/mitogen-hq/mitogen/issues/343): the sudo `--login`
  option is supported.
* [#344](https://github.com/mitogen-hq/mitogen/issues/344): connections no longer
  fail when the controller’s login username contains slashes.
* [#345](https://github.com/mitogen-hq/mitogen/issues/345): the `IdentitiesOnly
  yes` option is no longer supplied to OpenSSH by default, better matching
  Ansible’s behaviour.
* [#355](https://github.com/mitogen-hq/mitogen/issues/355): tasks configured to run
  in an isolated forked subprocess were forked from the wrong parent context.
  This meant built-in modules overridden via a custom `module_utils` search
  path may not have had any effect.
* [#362](https://github.com/mitogen-hq/mitogen/issues/362): to work around a slow
  algorithm in the [`subprocess`](https://docs.python.org/3/library/subprocess.html#module-subprocess "(in Python v3.13)") module, the maximum number of open files
  in processes running on the target is capped to 512, reducing the work
  required to start a subprocess by >2000x in default CentOS configurations.
* [#397](https://github.com/mitogen-hq/mitogen/issues/397): recent Mitogen master
  versions could fail to clean up temporary directories in a number of
  circumstances, and newer Ansibles moved to using [`atexit`](https://docs.python.org/3/library/atexit.html#module-atexit "(in Python v3.13)") to effect
  temporary directory cleanup in some circumstances.
* [b9112a9c](https://github.com/mitogen-hq/mitogen/commit/b9112a9c),
  [2c287801](https://github.com/mitogen-hq/mitogen/commit/2c287801): OpenSSH 7.5
  permission denied prompts are now recognized. Contributed by Alex Willmer.
* A missing check caused an exception traceback to appear when using the
  `ansible` command-line tool with a missing or misspelled module name.
* Ansible since >=2.7 began importing [`__main__`](https://docs.python.org/3/library/__main__.html#module-__main__ "(in Python v3.13)") from
  `ansible.module_utils.basic`, causing an error during execution, due to
  the controller being configured to refuse network imports outside the
  `ansible.*` namespace. Update the target implementation to construct a stub
  [`__main__`](https://docs.python.org/3/library/__main__.html#module-__main__ "(in Python v3.13)") module to satisfy the otherwise seemingly vestigial import.

### Core Library[¶](#id20 "Permalink to this headline")

* A new `mitogen.parent.CallChain` class abstracts safe pipelining of
  related function calls to a target context, cancelling the chain if an
  exception occurs.
* [#305](https://github.com/mitogen-hq/mitogen/issues/305): fix a long-standing minor
  race relating to the logging framework, where *no route for Message..*
  would frequently appear during startup.
* [#313](https://github.com/mitogen-hq/mitogen/issues/313):
  `mitogen.parent.Context.call()` was documented as capable of accepting
  static methods. While possible on Python 2.x the result is ugly, and in every
  case it should be trivial to replace with a classmethod. The documentation
  was fixed.
* [#337](https://github.com/mitogen-hq/mitogen/issues/337): to avoid a scaling
  limitation, a PTY is no longer allocated for each OpenSSH client if it can be
  avoided. PTYs are only allocated if a password is supplied, or when
  host\_key\_checking=accept. This is since Linux has a default of 4096 PTYs
  (`kernel.pty.max`), while OS X has a default of 127 and an absolute maximum
  of 999 (`kern.tty.ptmx_max`).
* [#339](https://github.com/mitogen-hq/mitogen/issues/339): the LXD connection method
  was erroneously executing LXC Classic commands.
* [#345](https://github.com/mitogen-hq/mitogen/issues/345): the SSH connection method
  allows optionally disabling `IdentitiesOnly yes`.
* [#356](https://github.com/mitogen-hq/mitogen/issues/356): if the master Python
  process does not have [`sys.executable`](https://docs.python.org/3/library/sys.html#sys.executable "(in Python v3.13)") set, the default Python
  interpreter used for new children on the local machine defaults to
  `"/usr/bin/python"`.
* [#366](https://github.com/mitogen-hq/mitogen/issues/366),
  [#380](https://github.com/mitogen-hq/mitogen/issues/380): attempts by children to
  import [`__main__`](https://docs.python.org/3/library/__main__.html#module-__main__ "(in Python v3.13)") where the main program module lacks an execution guard
  are refused, and an error is logged. This prevents a common and highly
  confusing error when prototyping new scripts.
* [#371](https://github.com/mitogen-hq/mitogen/pull/371): the LXC connection method
  uses a more compatible method to establish an non-interactive session.
  Contributed by Brian Candler.
* [af2ded66](https://github.com/mitogen-hq/mitogen/commit/af2ded66): add
  `mitogen.fork.on_fork()` to allow non-Mitogen managed process forks to
  clean up Mitogen resources in the child.
* [d6784242](https://github.com/mitogen-hq/mitogen/commit/d6784242): the setns method
  always resets `HOME`, `SHELL`, `LOGNAME` and `USER` environment
  variables to an account in the target container, defaulting to `root`.
* [830966bf](https://github.com/mitogen-hq/mitogen/commit/830966bf): the UNIX
  listener no longer crashes if the peer process disappears in the middle of
  connection setup.

### Thanks![¶](#id21 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
bug reports, testing, features and fixes in this release contributed by
[Alex Russu](https://github.com/alexrussu),
[Alex Willmer](https://github.com/moreati),
[atoom](https://github.com/atoom),
[Berend De Schouwer](https://github.com/berenddeschouwer),
[Brian Candler](https://github.com/candlerb),
[Dan Quackenbush](https://github.com/danquack),
[dsgnr](https://github.com/dsgnr),
[Jesse London](https://github.com/jesteria),
[John McGrath](https://github.com/jmcgrath207),
[Jonathan Rosser](https://github.com/jrosser),
[Josh Smift](https://github.com/jbscare),
[Luca Nunzi](https://github.com/0xlc),
[Orion Poplawski](https://github.com/opoplawski),
[Peter V. Saveliev](https://github.com/svinota/),
[Pierre-Henry Muller](https://github.com/pierrehenrymuller),
[Pierre-Louis Bonicoli](https://github.com/jesteria),
[Prateek Jain](https://github.com/prateekj201),
[RedheatWei](https://github.com/RedheatWei),
[Rick Box](https://github.com/boxrick),
[nikitakazantsev12](https://github.com/nikitakazantsev12),
[Tawana Musewe](https://github.com/tbtmuse),
[Timo Beckers](https://github.com/ti-mo), and
[Yannig Perré](https://github.com/yannig).

## v0.2.2 (2018-07-26)[¶](#v0-2-2-2018-07-26 "Permalink to this headline")

### Mitogen for Ansible[¶](#id31 "Permalink to this headline")

* [#291](https://github.com/mitogen-hq/mitogen/issues/291): `ansible_*_interpreter`
  variables are parsed using a restrictive shell-like syntax, supporting a
  common idiom where `ansible_python_interpreter` is set to `/usr/bin/env
  python`.
* [#299](https://github.com/mitogen-hq/mitogen/issues/299): fix the `network_cli`
  connection type when the Mitogen strategy is active. Mitogen cannot help
  network device connections, however it should still be possible to use device
  connections while Mitogen is active.
* [#301](https://github.com/mitogen-hq/mitogen/pull/301): variables like `$HOME` in
  the `remote_tmp` setting are evaluated correctly.
* [#303](https://github.com/mitogen-hq/mitogen/pull/303): the [Doas](ansible_detailed.html#doas) become method
  is supported. Contributed by [Mike Walker](https://github.com/napkindrawing).
* [#309](https://github.com/mitogen-hq/mitogen/issues/309): fix a regression to
  process environment cleanup, caused by the change in v0.2.1 to run local
  tasks with the correct environment.
* [#317](https://github.com/mitogen-hq/mitogen/issues/317): respect the verbosity
  setting when writing to Ansible’s `log_path`, if it is enabled. Child log
  filtering was also incorrect, causing the master to needlessly wake many
  times. This nets a 3.5% runtime improvement running against the local
  machine.
* The `mitogen_ssh_debug_level` variable is supported, permitting SSH debug
  output to be included in Mitogen’s `-vvv` output when both are specified.

### Core Library[¶](#id32 "Permalink to this headline")

* [#291](https://github.com/mitogen-hq/mitogen/issues/291): the `python_path`
  parameter may specify an argument vector prefix rather than a string program
  path.
* [#300](https://github.com/mitogen-hq/mitogen/issues/300): the broker could crash on OS X during shutdown due to
  scheduled [kqueue(2)](https://man.freebsd.org/cgi/man.cgi?query=kqueue) filter changes for
  descriptors that were closed before the IO loop resumes. As a temporary
  workaround, kqueue’s bulk change feature is not used.
* [#303](https://github.com/mitogen-hq/mitogen/pull/303): the [Doas](ansible_detailed.html#doas) become method
  is now supported. Contributed by [Mike Walker](https://github.com/napkindrawing).
* [#307](https://github.com/mitogen-hq/mitogen/issues/307): SSH login banner output
  containing the word ‘password’ is no longer confused for a password prompt.
* [#319](https://github.com/mitogen-hq/mitogen/issues/319): SSH connections would
  fail immediately on Windows Subsystem for Linux, due to use of TCSAFLUSH
  with [`termios.tcsetattr()`](https://docs.python.org/3/library/termios.html#termios.tcsetattr "(in Python v3.13)"). The flag is omitted if WSL is detected.
* [#320](https://github.com/mitogen-hq/mitogen/issues/320): The OS X poller
  could spuriously wake up due to ignoring an error bit set on events returned
  by the kernel, manifesting as a failure to read from an unrelated descriptor.
* [#342](https://github.com/mitogen-hq/mitogen/issues/342): The `network_cli`
  connection type would fail due to a missing internal SSH plugin method.
* Standard IO forwarding accidentally configured the replacement `stdout` and
  `stderr` write descriptors as non-blocking, causing subprocesses that
  generate more output than kernel buffer space existed to throw errors. The
  write ends are now configured as blocking.
* When `mitogen.core.enable_profiling()` is active, `mitogen.service`
  threads are profiled just like other threads.
* The `ssh_debug_level` parameter is supported, permitting SSH debug output
  to be redirected to a Mitogen logger when specified.
* Debug logs containing command lines are printed with the minimal quoting and
  escaping required.

### Thanks![¶](#id34 "Permalink to this headline")

Mitogen would not be possible without the support of users. A huge thanks for
the bug reports and pull requests in this release contributed by
[Alex Russu](https://github.com/alexrussu),
[Andy Freeland](https://github.com/rouge8),
[Ayaz Ahmed Khan](https://github.com/ayaz),
[Colin McCarthy](https://github.com/colin-mccarthy),
[Dan Quackenbush](https://github.com/danquack),
[Duane Zamrok](https://github.com/dewthefifth),
[Gonzalo Servat](https://github.com/gservat),
[Guy Knights](https://github.com/knightsg),
[Josh Smift](https://github.com/jbscare),
[Mark Janssen](https://github.com/sigio),
[Mike Walker](https://github.com/napkindrawing),
[Orion Poplawski](https://github.com/opoplawski),
[falbanese](https://github.com/falbanese),
[Tawana Musewe](https://github.com/tbtmuse), and
[Zach Swanson](https://github.com/zswanson).

## v0.2.1 (2018-07-10)[¶](#v0-2-1-2018-07-10 "Permalink to this headline")

### Mitogen for Ansible[¶](#id43 "Permalink to this headline")

* [#297](https://github.com/mitogen-hq/mitogen/issues/297): compatibility: local
  actions set their working directory to that of their defining playbook, and
  inherit a process environment as if they were executed as a subprocess of the
  forked task worker.

## v0.2.0 (2018-07-09)[¶](#v0-2-0-2018-07-09 "Permalink to this headline")

Mitogen 0.2.x is the inaugural feature-frozen branch eligible for fixes only,
except for problem areas listed as in-scope below. While stable from a
development perspective, it should still be considered “beta” at least for the
initial releases.

**In Scope**

* Python 3.x performance improvements
* Subprocess reaping improvements
* Major documentation improvements
* PyPI/packaging improvements
* Test suite improvements
* Replacement CI system to handle every supported OS
* Minor deviations from vanilla Ansible behaviour
* Ansible `raw` action support

The goal is a *tick/tock* model where even-numbered series are a maturation of
the previous unstable series, and unstable series are released on PyPI with
`--pre` enabled. The API and user visible behaviour should remain unchanged
within a stable series.

### Mitogen for Ansible[¶](#id44 "Permalink to this headline")

* Support for Ansible 2.3 - 2.7.x and any mixture of Python 2.6, 2.7 or 3.6 on
  controller and target nodes.
* Drop-in support for many Ansible connection types.
* Preview of Connection Delegation feature.
* Built-in file transfer compatible with connection delegation.

### Core Library[¶](#id45 "Permalink to this headline")

* Synchronous connection establishment via OpenSSH, sudo, su, Docker, LXC and
  FreeBSD Jails, local subprocesses and [`os.fork()`](https://docs.python.org/3/library/os.html#os.fork "(in Python v3.13)"). Parallel connection
  setup is possible using multiple threads. Connections may be used from one or
  many threads after establishment.
* UNIX masters and children, with Linux, MacOS, FreeBSD, NetBSD, OpenBSD and
  Windows Subsystem for Linux explicitly supported.
* Automatic tests covering Python 2.6, 2.7 and 3.6 on Linux only.



=== Content from github.com_49ffbce6_20250121_000124.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmitogen-hq%2Fmitogen%2Fcommit%2F5924af1566763e48c42028399ea0cd95c457b3dc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmitogen-hq%2Fmitogen%2Fcommit%2F5924af1566763e48c42028399ea0cd95c457b3dc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mitogen-hq%2Fmitogen)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mitogen-hq](/mitogen-hq)
/
**[mitogen](/mitogen-hq/mitogen)**
Public

* [Notifications](/login?return_to=%2Fmitogen-hq%2Fmitogen) You must be signed in to change notification settings
* [Fork
  199](/login?return_to=%2Fmitogen-hq%2Fmitogen)
* [Star
   2.4k](/login?return_to=%2Fmitogen-hq%2Fmitogen)

* [Code](/mitogen-hq/mitogen)
* [Issues
  257](/mitogen-hq/mitogen/issues)
* [Pull requests
  33](/mitogen-hq/mitogen/pulls)
* [Actions](/mitogen-hq/mitogen/actions)
* [Wiki](/mitogen-hq/mitogen/wiki)
* [Security](/mitogen-hq/mitogen/security)
* [Insights](/mitogen-hq/mitogen/pulse)

Additional navigation options

* [Code](/mitogen-hq/mitogen)
* [Issues](/mitogen-hq/mitogen/issues)
* [Pull requests](/mitogen-hq/mitogen/pulls)
* [Actions](/mitogen-hq/mitogen/actions)
* [Wiki](/mitogen-hq/mitogen/wiki)
* [Security](/mitogen-hq/mitogen/security)
* [Insights](/mitogen-hq/mitogen/pulse)

## Commit

[Permalink](/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[security] core: undirectional routing wasn't respected in some cases

[Browse files](/mitogen-hq/mitogen/tree/5924af1566763e48c42028399ea0cd95c457b3dc)
Browse the repository at this point in the history

```
When creating a context using Router.method(via=somechild),
unidirectional mode was set on the new child correctly, however if the
child were to call Router.method(), due to a typing mistake the new
child would start without it.

This doesn't impact the Ansible extension, as only forked tasks are
started directly by children, and they are not responsible for routing
messages.

Add test so it can't happen again.
```

* Loading branch information

[![@dw](https://avatars.githubusercontent.com/u/2315?s=40&v=4)](/dw)

[dw](/mitogen-hq/mitogen/commits?author=dw "View all commits by dw")
committed
Aug 8, 2019

1 parent
[436a4b3](/mitogen-hq/mitogen/commit/436a4b3b3cfc6f901c66fe79b4f0828149a4312e)

commit 5924af1

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**36 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* mitogen

  + mitogen/core.py
    [core.py](#diff-8f0a6fb372971dba4b744c4a57f419d1f52f423b6c286c6a80b640ece85fd8b6)
* tests

  + tests/router\_test.py
    [router\_test.py](#diff-91c3546b6ab4a15f81c30fe38150088f63d145139506b79cca81cb3f4616c05f)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[mitogen/core.py](#diff-8f0a6fb372971dba4b744c4a57f419d1f52f423b6c286c6a80b640ece85fd8b6 "mitogen/core.py")

Show comments

[View file](/mitogen-hq/mitogen/blob/5924af1566763e48c42028399ea0cd95c457b3dc/mitogen/core.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3623,7 +3623,7 @@ def \_setup\_master(self): |
|  |  | self.broker = Broker(activate\_compat=False) |
|  |  | self.router = Router(self.broker) |
|  |  | self.router.debug = self.config.get('debug', False) |
|  |  | self.router.undirectional = self.config['unidirectional'] |
|  |  | self.router.unidirectional = self.config['unidirectional'] |
|  |  | self.router.add\_handler( |
|  |  | fn=self.\_on\_shutdown\_msg, |
|  |  | handle=SHUTDOWN, |
| Expand Down | |  |

48 changes: 35 additions & 13 deletions

48
[tests/router\_test.py](#diff-91c3546b6ab4a15f81c30fe38150088f63d145139506b79cca81cb3f4616c05f "tests/router_test.py")

Show comments

[View file](/mitogen-hq/mitogen/blob/5924af1566763e48c42028399ea0cd95c457b3dc/tests/router_test.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,9 +1,11 @@ |
|  |  | import sys |
|  |  | import time |
|  |  | import zlib |
|  |  |  |
|  |  | import unittest2 |
|  |  |  |
|  |  | import testlib |
|  |  | import mitogen.core |
|  |  | import mitogen.master |
|  |  | import mitogen.parent |
|  |  | import mitogen.utils |
| Expand Down  Expand Up | | @@ -341,22 +343,42 @@ def test\_previously\_alive\_context\_returns\_dead(self): |
|  |  | )) |
|  |  |  |
|  |  |  |
|  |  | def test\_siblings\_cant\_talk(router): |
|  |  | l1 = router.local() |
|  |  | l2 = router.local() |
|  |  | logs = testlib.LogCapturer() |
|  |  | logs.start() |
|  |  |  |
|  |  | try: |
|  |  | l2.call(ping\_context, l1) |
|  |  | except mitogen.core.CallError: |
|  |  | e = sys.exc\_info()[1] |
|  |  |  |
|  |  | msg = mitogen.core.Router.unidirectional\_msg % ( |
|  |  | l2.context\_id, |
|  |  | l1.context\_id, |
|  |  | ) |
|  |  | assert msg in str(e) |
|  |  | assert 'routing mode prevents forward of ' in logs.stop() |
|  |  |  |
|  |  |  |
|  |  | @mitogen.core.takes\_econtext |
|  |  | def test\_siblings\_cant\_talk\_remote(econtext): |
|  |  | mitogen.parent.upgrade\_router(econtext) |
|  |  | test\_siblings\_cant\_talk(econtext.router) |
|  |  |  |
|  |  |  |
|  |  | class UnidirectionalTest(testlib.RouterMixin, testlib.TestCase): |
|  |  | def test\_siblings\_cant\_talk(self): |
|  |  | def test\_siblings\_cant\_talk\_master(self): |
|  |  | self.router.unidirectional = True |
|  |  | l1 = self.router.local() |
|  |  | l2 = self.router.local() |
|  |  | logs = testlib.LogCapturer() |
|  |  | logs.start() |
|  |  | e = self.assertRaises(mitogen.core.CallError, |
|  |  | lambda: l2.call(ping\_context, l1)) |
|  |  | test\_siblings\_cant\_talk(self.router) |
|  |  |  |
|  |  | msg = self.router.unidirectional\_msg % ( |
|  |  | l2.context\_id, |
|  |  | l1.context\_id, |
|  |  | ) |
|  |  | self.assertTrue(msg in str(e)) |
|  |  | self.assertTrue('routing mode prevents forward of ' in logs.stop()) |
|  |  | def test\_siblings\_cant\_talk\_parent(self): |
|  |  | # ensure 'unidirectional' attribute is respected for contexts started |
|  |  | # by children. |
|  |  | self.router.unidirectional = True |
|  |  | parent = self.router.local() |
|  |  | parent.call(test\_siblings\_cant\_talk\_remote) |
|  |  |  |
|  |  | def test\_auth\_id\_can\_talk(self): |
|  |  | self.router.unidirectional = True |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 4 comments on commit `5924af1`

[![@greysteil](https://avatars.githubusercontent.com/u/1144873?s=80&v=4)](/greysteil)

Copy link

### @greysteil **[greysteil](/greysteil)** commented on `[5924af1](/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc)` [Aug 20, 2019](#commitcomment-34758483)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for the fix on this [@dw](https://github.com/dw).

I'm on the security team at GitHub and we were notified that a CVE was published for this vulnerability yesterday. I'd love to know:

1. did you publish that CVE or did someone else?
2. did you consider creating a Security Advisory in GitHub for this vulnerability? (They're new, if you've never heard of them...!)

Any feedback you can give on how GitHub can help in dealing with security-related issues would be very appreciated. You can reach me on greysteil@github.com if you'd rather not leave a public comment.

Sorry, something went wrong.

All reactions

[![@dw](https://avatars.githubusercontent.com/u/2315?s=80&v=4)](/dw)

Copy link

Member

Author

### @dw **[dw](/dw)** commented on `[5924af1](/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc)` [Aug 20, 2019](#commitcomment-34759041) via email

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi Grey!
I'm a little perplexed by the CVE assignment, to be honest, and have opened
a dispute. It appears to have been registered possibly within an hour of
cutting the release, I have no idea by who, but the 99% of the hits on
Twitter for the new release are now about the CVE
No advisory, because there is no vulnerability. Nobody was using that mode
except the Ansible extension, and its use was already covered by tests.
Moral of the story: don't tag changelog entries with [security]!
…
On Tue, 20 Aug 2019 at 13:52, Grey Baker \*\*\*@\*\*\*.\*\*\*> wrote:
Thanks for the fix on this [@dw](https://github.com/dw) <<https://github.com/dw>>.
I'm on the security team at GitHub and we were notified that a CVE was
published for this vulnerability yesterday. I'd love to know:
1. did you publish that CVE or did someone else?
2. did you consider creating a Security Advisory in GitHub for this
vulnerability? (They're new, if you've never heard of them...!)
Any feedback you can give on how GitHub can help in dealing with
security-related issues would be very appreciated. You can reach me on
\*\*\*@\*\*\*.\*\*\* if you'd rather not leave a public comment.
—
You are receiving this because you were mentioned.
Reply to this email directly, view it on GitHub
<[5924af1?email\_source=notifications&email\_token=AAAASC45UEIMJCQTDP2V5A3QFPSHNA5CNFSM4INV7VMKYY3PNVWWK3TUL52HS4DFVVBW63LNNF2EG33NNVSW45FKMNXW23LFNZ2F62LEZYBBEX2T#commitcomment-34758483](https://github.com/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc?email_source=notifications&email_token=AAAASC45UEIMJCQTDP2V5A3QFPSHNA5CNFSM4INV7VMKYY3PNVWWK3TUL52HS4DFVVBW63LNNF2EG33NNVSW45FKMNXW23LFNZ2F62LEZYBBEX2T#commitcomment-34758483)>,
or mute the thread
<<https://github.com/notifications/unsubscribe-auth/AAAASC3UWU6TPZQN2QJCQQLQFPSHNANCNFSM4INV7VMA>>
.

Sorry, something went wrong.

All reactions

[![@greysteil](https://avatars.githubusercontent.com/u/1144873?s=80&v=4)](/greysteil)

Copy link

### @greysteil **[greysteil](/greysteil)** commented on `[5924af1](/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc)` [Aug 20, 2019](#commitcomment-34759297)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Ack, that sucks, and isn't the first time we've heard that feedback.

CVE issuance is a big marketing tool for some companies, and in some cases employees are incentivised to get them assigned and skip parts of the process (like informing the maintainer...).

One thing we're planning at GitHub is to become a CVE-issuing entity (a CNA) ourselves, which should allow us to help improve the process and guard against situations like this. In the meantime I'll ping our vulnerability curation team and see what we can do about removing / flagging this in our database.

Sorry, something went wrong.

All reactions

[![@dw](https://avatars.githubusercontent.com/u/2315?s=80&v=4)](/dw)

Copy link

Member

Author

### @dw **[dw](/dw)** commented on `[5924af1](/mitogen-hq/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc)` [Aug 20, 2019](#commitcomment-34759755)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's possible the package gets more attention because it is in multiple downstream package repositories nowadays, I hadn't considered people might be watching the changelog in this way. I assumed it might have been an enthusiastic user who filed it, not sure. No harm done in any case, just a curious amount of unfortunate noise to round off many months of hard work :)

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmitogen-hq%2Fmitogen%2Fcommit%2F5924af1566763e48c42028399ea0cd95c457b3dc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


