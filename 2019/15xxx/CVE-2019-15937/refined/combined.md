=== Content from git.pengutronix.de_e73ab44e_20250121_004026.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [barebox](/cgit/barebox/) | master next |
| --- | --- | --- |
| barebox master repository | Pengutronix |

| [summary](/cgit/barebox/?h=next)[refs](/cgit/barebox/refs/?h=next&id=84986ca024462058574432b5483f4bf9136c538d)[log](/cgit/barebox/log/net/nfs.c?h=next)[tree](/cgit/barebox/tree/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)[commit](/cgit/barebox/commit/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)[diff](/cgit/barebox/diff/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)[stats](/cgit/barebox/stats/net/nfs.c?h=next) | log msg author committer range |
| --- | --- |

path: [root](/cgit/barebox/commit/?h=next&id=84986ca024462058574432b5483f4bf9136c538d)/[net](/cgit/barebox/commit/net?h=next&id=84986ca024462058574432b5483f4bf9136c538d)/[nfs.c](/cgit/barebox/commit/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sascha Hauer <s.hauer@pengutronix.de> | 2019-09-02 09:42:15 +0200 |
| --- | --- | --- |
| committer | Sascha Hauer <s.hauer@pengutronix.de> | 2019-09-02 09:42:45 +0200 |
| commit | [84986ca024462058574432b5483f4bf9136c538d](/cgit/barebox/commit/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d) ([patch](/cgit/barebox/patch/net/nfs.c?id=84986ca024462058574432b5483f4bf9136c538d)) | |
| tree | [aa618622e32e209fbe66fabaa95780e322cfb343](/cgit/barebox/tree/?h=next&id=84986ca024462058574432b5483f4bf9136c538d) /[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d) | |
| parent | [3dc45020a9dd75af628bc0eca07465b2a4c7378f](/cgit/barebox/commit/net/nfs.c?h=next&id=3dc45020a9dd75af628bc0eca07465b2a4c7378f) ([diff](/cgit/barebox/diff/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d&id2=3dc45020a9dd75af628bc0eca07465b2a4c7378f)) | |
| download | [barebox-84986ca024462058574432b5483f4bf9136c538d.tar.gz](/cgit/barebox/snapshot/barebox-84986ca024462058574432b5483f4bf9136c538d.tar.gz) | |

net: nfs: Fix possible buffer overflownfs\_readlink\_reply() interprets a 32bit value directly received from the
network as length argument to memcpy() without any boundary checking.
Clamp the copy size at the end of the incoming packet.
Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
[Diffstat](/cgit/barebox/diff/?h=next&id=84986ca024462058574432b5483f4bf9136c538d) (limited to 'net/nfs.c')

| -rw-r--r-- | [net/nfs.c](/cgit/barebox/diff/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/net/nfs.c b/net/nfs.cindex 0a3021994a..63573098d7 100644--- a/[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=3dc45020a9dd75af628bc0eca07465b2a4c7378f)+++ b/[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=84986ca024462058574432b5483f4bf9136c538d)@@ -502,7 +502,7 @@ static int nfs\_readlink\_reply(unsigned char \*pkt, unsigned len) { uint32\_t \*data; char \*path;- int rlen;+ unsigned int rlen; int ret;  ret = rpc\_check\_reply(pkt, 1);@@ -515,6 +515,9 @@ static int nfs\_readlink\_reply(unsigned char \*pkt, unsigned len)  rlen = ntohl(net\_read\_uint32(data)); /\* new path length \*/ + rlen = max\_t(unsigned int, rlen,+ len - sizeof(struct rpc\_reply) - sizeof(uint32\_t));+ data++; path = (char \*)data; |
| --- |

If you are a bot and scrape our website and ignore robots.txt we block your /20 or /48
[beebeebee](/hp).


