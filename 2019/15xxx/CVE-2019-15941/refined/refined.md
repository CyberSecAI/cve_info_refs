Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from a missing check in the Lemonldap::NG web SSO system regarding OpenID Connect (OIDC) authorization codes. Specifically, the system does not verify if an authorization code was issued to the authenticated client (relying party).

**Weaknesses/Vulnerabilities:**

*   **Lack of Authorization Code Binding:** The core issue is the absence of a mechanism to tie authorization codes to their respective relying parties. This allows an attacker to use an authorization code intended for one relying party to gain access to a different relying party.
*   **OIDC Specification Violation:** Lemonldap::NG does not adhere to the OpenID Connect specification's requirement to ensure the authorization code was issued to the authenticated client.

**Impact of Exploitation:**

*   **Authorization Bypass:** Attackers can bypass access controls on OIDC services. They can obtain authorization codes for a less restricted relying party and then use them to access a more restricted relying party, effectively bypassing the intended authorization rules.
*   **Access to Restricted Resources:**  This could allow unauthorized users to access resources or functionalities that they should not have access to, potentially leading to data breaches, privilege escalation or other malicious actions.
*   **Vulnerable if no Redirect URIs:** The vulnerability is present when the less restrictive relying party does not have any declared redirect URIs.

**Attack Vectors:**

1.  **Configuration:** The system needs to have two OIDC relaying parties configured: one with less restrictions (e.g. allowed to all users) and another with more restrictions (e.g. restricted to admins).
2.  **Code Acquisition:** An attacker first needs to obtain an OIDC authorization code for the less restricted relying party.
3.  **Redirection URI Manipulation:** The attacker uses the redirect URI of the more restricted relying party when obtaining the authorization code for the less restricted party.
4.  **Code Reuse:** The attacker then presents the authorization code from the less restricted party to the more restricted relying party to gain unauthorized access.

**Required Attacker Capabilities/Position:**

*   The attacker must be able to interact with the OIDC authorization endpoint.
*   The attacker does not need to have admin privileges. Any valid user account would be sufficient for the initial step to acquire the code from the less restricted relying party.

**Additional Notes:**

*   The fix involves storing the client\_id in the code session and verifying it before issuing an access token.
*   The vulnerability exists in Lemonldap-NG versions prior to 2.0.2+ds-7+deb10u2, specifically in the 2.0.0 version.