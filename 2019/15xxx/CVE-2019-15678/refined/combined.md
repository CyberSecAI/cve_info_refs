=== Content from lists.debian.org_4abf0c4b_20250121_011223.html ===


---

[[Date Prev](msg00027.html)][[Date Next](msg00029.html)]
[[Thread Prev](msg00027.html)][[Thread Next](msg00029.html)]
[[Date Index](maillist.html#00028)]
[[Thread Index](threads.html#00028)]

# [SECURITY] [DLA 2045-1] tightvnc security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2045-1] tightvnc security update
* *From*: Mike Gabriel <sunweaver@debian.org>
* *Date*: Sat, 21 Dec 2019 17:03:14 +0100
* *Message-id*: <[[🔎]](/msgid-search/20191221160312.bfszj4fjip6efjdp%40minobo.das-netzwerkteam.de) [20191221160312.bfszj4fjip6efjdp@minobo.das-netzwerkteam.de](msg00028.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : tightvnc
Version        : 1.3.9-6.5+deb8u1
CVE ID         : CVE-2014-6053 CVE-2018-7225 CVE-2019-8287 CVE-2018-20021
                 CVE-2018-20022 CVE-2019-15678 CVE-2019-15679 CVE-2019-15680
                 CVE-2019-15681
Debian Bug     : 945364

Several vulnerabilities have recently been discovered in TightVNC 1.x, an
X11 based VNC server/viewer application for Windows and Unix.

CVE-2014-6053

    The rfbProcessClientNormalMessage function in rfbserver.c in TightVNC
    server did not properly handle attempts to send a large amount of
    ClientCutText data, which allowed remote attackers to cause a denial
    of service (memory consumption or daemon crash) via a crafted message
    that was processed by using a single unchecked malloc.

CVE-2018-7225

    rfbProcessClientNormalMessage() in rfbserver.c did not sanitize
    msg.cct.length, leading to access to uninitialized and potentially
    sensitive data or possibly unspecified other impact (e.g., an integer
    overflow) via specially crafted VNC packets.

CVE-2019-8287

    TightVNC code contained global buffer overflow in HandleCoRREBBP
    macro function, which could potentially have result in code
    execution. This attack appeared to be exploitable via network
    connectivity.

    (aka CVE-2018-20020/libvncserver)

CVE-2018-20021

    TightVNC in vncviewer/rfbproto.c contained a CWE-835: Infinite loop
    vulnerability. The vulnerability allowed an attacker to consume
    an excessive amount of resources like CPU and RAM.

CVE-2018-20022

    TightVNC's vncviewer contained multiple weaknesses CWE-665: Improper
    Initialization vulnerability in VNC client code that allowed
    attackers to read stack memory and could be abused for information
    disclosure. Combined with another vulnerability, it could be used to
    leak stack memory layout and in bypassing ASLR.

CVE-2019-15678

    TightVNC code version contained heap buffer overflow in
    rfbServerCutText handler, which could have potentially resulted in
    code execution. This attack appeared to be exploitable via network
    connectivity.

    (partially aka CVE-2018-20748/libvnvserver)

CVE-2019-15679

    TightVNC's vncviewer code contained a heap buffer overflow in
    InitialiseRFBConnection function, which could have potentially
    resulted in code execution. This attack appeared to be exploitable
    via network connectivity.

    (partially aka CVE-2018-20748/libvnvserver)

CVE-2019-15680

    TightVNC's vncviewer code contained a null pointer dereference in
    HandleZlibBPP function, which could have resulted in Denial of System
    (DoS). This attack appeared to be exploitable via network
    connectivity.

CVE-2019-15681

    TightVNC contained a memory leak (CWE-655) in VNC server code, which
    allowed an attacker to read stack memory and could have been abused
    for information disclosure. Combined with another vulnerability, it
    could have been used to leak stack memory and bypass ASLR. This
    attack appeared to be exploitable via network connectivity.

For Debian 8 "Jessie", these problems have been fixed in version
1.3.9-6.5+deb8u1.

We recommend that you upgrade your tightvnc packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--

mike gabriel aka sunweaver (Debian Developer)
fon: +49 (1520) 1976 148

GnuPG Fingerprint: 9BFB AEE8 6C0A A5FF BF22  0782 9AF4 6B30 2577 1B31
mail: sunweaver@debian.org, <http://sunweavers.net>

```

**Attachment:
[signature.asc](pgpigFw7L4jMj.pgp)**

*Description:* PGP signature

---



=== Content from us-cert.cisa.gov_a6109c0f_20250121_011225.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Siemens Products using TightVNC (Update A)

Last RevisedMay 11, 2021
Alert CodeICSA-20-343-08

## 1. EXECUTIVE SUMMARY

**--------- Begin Update A Part 1 of 5 ---------**

This advisory was previously released with a set of Siemens products considered to be affected. Following further investigation by the Siemens’ team, it was determined all products previously advised are not affected by any vulnerability listed in this advisory or Siemens Security Advisory SSA-478893

* Vendor: Siemens
* Equipment: SIMATIC ITC Industrial Thin Clients, SIMATIC WinCC Runtime Advanced/Professional, SIMATIC HMI Panels, SIPLUS extreme products

**--------- End Update A Part 1 of 5 ---------**

## 2. UPDATE INFORMATION

This updated advisory is a follow-up to the original advisory titled ICSA-20-343-08 Siemens Products using TightVNC that was published December 8, 2020, to the ICS webpage on us-cert.cisa.gov.

## 3. RISK EVALUATION

**--------- Begin Update A Part 2 of 5 ---------**

All products listed in the original advisory associated with ICSA-20-343-08 Siemens Products using TightVNC are unaffected by TightVNC vulnerabilities.

**--------- End Update A Part 2 of 5 ---------**

## 4. TECHNICAL DETAILS

### 4.1 AFFECTED PRODUCTS

**--------- Begin Update A Part 3 of 5 ---------**

Vulnerabilities in TightVNC (v1.X), a remote-control software package, do not affect the following Siemens products. The previous version of this advisory stated the following products were affected:

* SIMATIC HMI Comfort Outdoor Panels 7” and 15” (including SIPLUS variants): All versions prior to Version 16 update 3
* SIMATIC HMI Comfort Panel 4” to 22” (including SIPLUS variants): All versions prior to Version 16 update 3
* SIMATIC HMI KTP Mobile Panels KTP400F, KTP700, KTP700F, KTP900 and KTP900F: All versions prior to Version 16 update 3
* SIMATIC ITC1500 v3.1: All versions
* SIMATIC ITC1500 v3.1 PRO: All versions
* SIMATIC ITC1900 v3.1: All versions
* SIMATIC ITC1900 v3.1 Pro: All versions
* SIMATIC ITC2200 v3.1: All versions
* SIMATIC ITC2200 v3.1 PRO: All versions
* SIMATIC WinCC Runtime Advanced: All versions prior to Version 16 update 3
* SIMATIC WinCC Runtime Professional: All version prior to Version 16 update 3

**--------- End Update A Part 3 of 5 ---------**

### 4.2 VULNERABILITY OVERVIEW

#### 4.2.1    [HEAP-BASED BUFFER OVERFLOW CWE-122](https://cwe.mitre.org/data/definitions/122.html)

TightVNC code Version 1.3.10 contains a heap buffer overflow in rfbServerCutText handler, which can potentially result in code execution. The attack appears to be exploitable via network connectivity.

[CVE-2019-15678](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-15678) has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)).

#### 4.2.2    [HEAP-BASED BUFFER OVERFLOW CWE-122](https://cwe.mitre.org/data/definitions/122.html)

TightVNC code Version 1.3.10 contains a heap buffer overflow in InitialiseRFBConnection function, which can potentially result in code execution. This attack appears to be exploitable via network connectivity.

[CVE-2019-15679](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-15679) has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)).

#### 4.2.3    [NULL POINTER DEREFERENCE CWE-476](https://cwe.mitre.org/data/definitions/476.html)

TightVNC code Version 1.3.10 contains a null pointer dereference in HandleZlibBPP function, which could result in a denial-of-service. This attack appears to be exploitable via network connectivity.

[CVE-2019-15680](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-15680) has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)).

#### 4.2.4    [BUFFER COPY WITHOUT CHECKING SIZE OF INPUT ('CLASSIC BUFFER OVERFLOW') CWE-120](https://cwe.mitre.org/data/definitions/120.html)

TightVNC code Version 1.3.10 contains a global buffer overflow in HandleCoRREBBP macro function, which can potentially result in code execution. This appears to be exploitable via network connectivity.

[CVE-2019-8287](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-8287) has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)).

### 4.3 BACKGROUND

* **CRITICAL INFRASTRUCTURE SECTORS:** Chemical, Critical Manufacturing, Energy, Food and Agriculture, Water and Wastewater Systems
* **COUNTRIES/AREAS DEPLOYED:** Worldwide
* **COMPANY HEADQUARTERS LOCATION:** Germany

### 4.4 RESEARCHER

**--------- Begin Update A Part 4 of 5 ---------**

Siemens reported this update information to CISA.

**--------- End Update A Part 4 of 5 ---------**

## 5. MITIGATIONS

**--------- Begin Update A Part 5 of 5 ---------**

This advisory was previously released with a set of Siemens products considered to be affected. Following further investigation by the Siemens’ team, it was determined all products previously advised are not affected by any vulnerability listed in this advisory.

As a general security measure, Siemens strongly recommends protecting network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the environment according to the [Siemens operational guidelines for industrial security](https://cert-portal.siemens.com/operational-guidelines-industrial-security.pdf) and following the recommendations in the product manuals.

For additional information, please refer to Siemens Security Advisory [SSA-478893](https://cert-portal.siemens.com/productcert/pdf/ssa-478893.pdf)

[Contact Siemens](https://www.siemens.com/cert/advisories) or further inquiries on its security vulnerabilities.

**--------- End Update A Part 5 of 5 ---------**

ISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

CISA also provides a section for [control systems security recommended practices](https://us-cert.cisa.gov/ics/recommended-practices) on the ICS webpage on [us-cert.cisa.gov](https://us-cert.cisa.gov/ics). Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies](https://us-cert.cisa.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf).

Additional mitigation guidance and recommended practices are publicly available on the [ICS webpage on us-cert.cisa.gov](https://us-cert.cisa.gov/ics) in the Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](https://us-cert.cisa.gov/ics/tips/ICS-TIP-12-146-01B).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Vendor

* Siemens

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-20-343-08); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from cert-portal.siemens.com_7ea1872e_20250121_011222.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-478893: TightVNC Vulnerabilities in Industrial Products (Revoked)

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 9.8

2020-12-08
2021-05-11
V1.1

SUMMARY

Multiple TightVNC (V1.x) vulnerabilities could allow remote code execution and Denial-of-Service attacks
under certain conditions.

Siemens has previously released this advisory containing a set of products that were considered to
be affected. Through Siemens’ continuous investigation processes it was identiﬁed that all products
previously advised are not affected by any vulnerability listed in this advisory.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SIMATIC HMI Comfort Outdoor Panels 7" & 15"
(incl. SIPLUS variants):
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC HMI Comfort Panels 4"
(incl. SIPLUS variants):
No version

- 22"

This product is not affected by any vulnerability
listed in this advisory

SIMATIC HMI KTP Mobile Panels KTP400F,
KTP700, KTP700F, KTP900 and KTP900F:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC1500 V3.1 PRO:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC1500 V3.1:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC1900 V3.1 PRO:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC1900 V3.1:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC2200 V3.1 PRO:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC ITC2200 V3.1:
No version

This product is not affected by any vulnerability
listed in this advisory

SSA-478893

© Siemens 2021

Page 1 of 4

Siemens Security Advisory by Siemens ProductCERT

SIMATIC WinCC Runtime Advanced:
No version

This product is not affected by any vulnerability
listed in this advisory

SIMATIC WinCC Runtime Professional:
No version

This product is not affected by any vulnerability
listed in this advisory

WORKAROUNDS AND MITIGATIONS

Siemens has not identiﬁed any speciﬁc mitigations or workarounds. Please follow General Security
Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

SIMATIC ITC Industrial Thin Clients represent powerful control terminals with high-resolution wide-screen
touch displays in 12, 15, 19 and 22 inch formats.

SIMATIC WinCC Runtime Advanced/Professional is a visualization runtime platform used for operator
control and monitoring of machines and plants.

SIMATIC HMI Panels are used for operator control and monitoring of machines and plants.

SIPLUS extreme products are designed for reliable operation under extreme conditions and are based on
SIMATIC, LOGO!, SITOP, SINAMICS, SIMOTION, SCALANCE or other devices. SIPLUS devices use the
same ﬁrmware as the product they are based on.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

SSA-478893

© Siemens 2021

Page 2 of 4

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-15678

TightVNC code version 1.3.10 contains heap buffer overﬂow in rfbServerCutText handler, which can
potentially result in code execution. This attack appear to be exploitable via network connectivity.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-122: Heap-based Buffer Overﬂow

Vulnerability CVE-2019-15679

TightVNC code version 1.3.10 contains heap buffer overﬂow in InitialiseRFBConnection function, which
can potentially result in code execution. This attack appear to be exploitable via network connectivity.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-122: Heap-based Buffer Overﬂow

Vulnerability CVE-2019-15680

TightVNC code version 1.3.10 contains null pointer dereference in HandleZlibBPP function, which
could result in a Denial-of-Service (DoS). This attack appear to be exploitable via network connectivity.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2019-8287

TightVNC code version 1.3.10 contains global buffer overﬂow in HandleCoRREBBP macro function,
which can potentially result in code execution. This attack appear to be exploitable via network
connectivity.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-120: Buffer Copy without Checking Size of Input (‘Classic
Buffer Overﬂow’)

ADDITIONAL INFORMATION

Listed vulnerabilities are part of a Kaspersky report. See VNC vulnerability research for related security
advisories and additional information on the vulnerabilities.

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

SSA-478893

© Siemens 2021

Page 3 of 4

Siemens Security Advisory by Siemens ProductCERT

HISTORY DATA

V1.0 (2020-12-08):
V1.1 (2021-05-11):

Publication Date
Errata - Revoked advisory

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-478893

© Siemens 2021

Page 4 of 4



=== Content from www.openwall.com_a1c759d7_20250121_011225.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <9396dbd0a417440abe9bbb830e7b612f@kaspersky.com>
Date: Mon, 10 Dec 2018 12:48:43 +0000
From: Pavel Cheremushkin <Pavel.Cheremushkin@...persky.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: libvnc and tightvnc vulnerabilities

Hello,

LibVNC is a cross-platform library to implement programs that use RFB (remote frame buffer protocol). Although, on its Github page (<https://github.com/LibVNC/libvncserver>) it is stated that libvnc is designed to implement server-side software, it also has functionality to implement a VNC client. Due to the fact that many ICS vendors use open source VNC products I would like to drag some attention to the VNC products because they have some problems that should be fixed asap.

During recent research of libvnc I managed to discover few vulnerabilities (11 in total) which affect products that are using libvncserver and libvncclient (<https://github.com/LibVNC/libvncserver/issues?utf8=%E2%9C%93&q=is%3Aissue+author%3Apaulcher>). There are a couple of issues left to the next release of libvnc (<https://github.com/LibVNC/libvncserver/milestone/4>), but the packages, that I have recently reviewed still didn't patch vulnerabilities that were found quite some time ago. Meanwhile, an issue that has been found by @ateska (<https://github.com/LibVNC/libvncserver/issues/211>) is critical, affects VirtualBox and probably every multithreading VNC server that is based on libvnc and it is still not patched after almost a year.

At first, I thought that these issues were inside the code that was written by libvnc developers, by this wasn't exactly the case. Some of them (i.e. buffer overflow inside heap structure in CoRRE handler <https://github.com/LibVNC/libvncserver/issues/250>) were inside vulnerable code written by AT&T Laboratories in 1999 and got copy-pasted by many software developers (you can see it by trying to find HandleCoRREBPP function in Github search), as well by LibVNC and TightVNC  developers. LibVNC contributors managed to fix all security issues that I have reported to them so far. Also I tried to report these vulnerabilities in TightVNC software version 1.3.10 (which is used, for example, in latest Ubuntu "xtightvncviewer" package) to GlavSoft company, who are authors of the TightVNC software:

```
1. global buffer overflow in corre.c
    In `vnc_unixsrc/vncviewer/corre.c` inside the `HandleCoRREBPP` function global buffer overflow occurs due to the lack of size check.
    `buffer` is defined in rfbproto.c:96 as ```char buffer[640*480];```. Inside `HandleCoRREBPP` function data is being read to the buffer `ReadFromRFBServer(buffer, hdr.nSubrects * (4 + (BPP / 8))` where `hdr.nSubrects` is 32-bit unsigned integer controlled by remote user.

2. heap buffer overflow in rfbServerCutText handler
    Heap buffer overflow in `rfbServerCutText` handler inside `HandleRFBServerMessage` happens due to the malloc argument unsigned integer overflow on line rfbproto.c:1220. Suppose msg.sct.length equals 0xffffffff, then `malloc(msg.sct.length+1);` = `malloc(0);` will allocate small heap chunk of size 0x10. But `msg.sct.length` = 0xffffffff bytes may be read in this chunk on line 1222 (`ReadFromRFBServer(serverCutText, msg.sct.length)`).

3. heap buffer overflow in InitialiseRFBConnection function
    Heap buffer overflow `InitialiseRFBConnection` function happens due to the malloc argument unsigned integer overflow on line rfbproto.c:307. Because of the integer overflow `malloc` function will allocate small heap chunk of size 0x10 and 0xffffffff bytes will be read into the chunk by ReadFromRFBServer function.

4. null-ptr dereference in `zlib.c`
    Because malloc result is not checked after allocation on line zlib.c:56 null pointer dereference is possible if malloc argument is too big and malloc fill fail to allocate memory Allocation of raw buffer : `raw_buffer = (char*) malloc( raw_buffer_size );`, next usage of raw_buffer is on line 68
```

But GlavSoft representative politely declined to patch the 1.X version of TightVNC software, because it doesn't bring any income to the company. They are currently developing TightVNC 2.X, which is not affected by GPL licenses in third-party code. This is the exact answer of the GlavSoft representative (in Russian):

К сожалению, как коммерческой организации, нам совершенно нерентабельно заниматься TightVNC 1.x, т.к. оно содержит чужой GPL-код и поэтому мы не имеем возможность предлагать этот код под другими лицензиями. А техподдержка в случае с TightVNC никогда не приносила нам сколь-нибудь существенного дохода. Поэтому, увы, версии 1.x нам совсем неинтересны.

That being said, package maintainers should probably patch these vulnerabilities by themselves if they want to continue supporting TightVNC 1.X packages in their repositories.

These bugs are so obvious and I still cannot believe that they haven't been already found by anyone else. So please tell me if these issues have been already discovered before, but remained unpatched for some reason.

Best Regards,
Pavel Cheremushkin
Security Researcher| ICS CERT Vulnerability Research Group | Kaspersky Lab
39A bld.2 Leningradskoye Highway, Moscow 125212, Russia | www.kaspersky.com<<http://www.kaspersky.com/>>,www.securelist.com<<http://www.securelist.com/>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


