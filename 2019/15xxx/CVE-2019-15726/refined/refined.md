- **Root cause of vulnerability**: The vulnerability is caused by a lack of proper sanitization or validation of user-provided URLs used in markdown image tags within GitLab snippets. This allows an attacker to embed an image tag with a URL that points to an external server they control.
- **Weaknesses/vulnerabilities present**: Cross-site request forgery (CSRF) leading to IP address disclosure. Specifically, the markdown parser does not prevent embedding external URLs that can trigger requests to attacker-controlled servers.
- **Impact of exploitation**: The attacker can steal the IP addresses of users who view the crafted snippet. The attacker can then log the IP address when the user's browser makes a request for the embedded image. This could expose the user's geographical location and potentially enable further attacks.
- **Attack vectors**: The attack vector involves crafting a malicious GitLab snippet containing an image tag with a URL that points to an external server controlled by the attacker. When a user views the snippet, their browser will attempt to load the image from the attacker's server, thus leaking their IP address to the attacker.
- **Required attacker capabilities/position**: The attacker needs to be a GitLab user able to create and edit snippets. They also need a server under their control to log the requests made by the victims' browsers. The attacker does not need any special privileges.