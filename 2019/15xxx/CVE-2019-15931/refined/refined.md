```text
RELATED
```

### Vulnerability Report for Solismed v3.3SP1

The document provides detailed information on multiple vulnerabilities found in Solismed version 3.3SP1, an electronic medical records (EMR) application.

#### Vulnerabilities

1.  **Directory Traversal**
    *   **CVE ID**: CVE-2019-15931
    *   **Security Risk**: Medium
    *   **Impact**: Arbitrary file write to application web root
    *   **Access Vector**: Remote
    *   **Details**:
        *   The `target_folder` parameter in the `/gui/file_upload.php` endpoint is vulnerable to directory traversal.
        *   By modifying the parameter to arbitrary locations within the web root, an attacker could control where the file was uploaded
    *   **Attack Vector**:
        *   Modify the `target_folder` parameter in the `/gui/file_upload.php` endpoint to control the upload location.
    *   **Exploitation**:
        *   An attacker could upload a PHP web shell into the `/webroot` directory, resulting in remote code execution.
    *   **Affected Parameter**: `target_folder` in `/gui/file_upload.php`
    *   **Additional Location**: `/index_body.php` (Multiple parameters wherever filenames are present)
2.  **Insecure File Upload**
    *   **CVE ID**: CVE-2019-15936
    *   **Security Risk**: Critical
    *   **Impact**: Code execution
    *   **Access Vector**: Remote
    *   **Details**:
        *   The `/gui/file_upload.php` endpoint does not require authentication or authorization.
        *   Relies on client-side controls to restrict dangerous file types.
        *   Direct `POST` request containing a PHP web shell can bypass client-side controls, leading to remote code execution (RCE).
    *   **Attack Vector**:
        *   Send a direct `POST` request to `/gui/file_upload.php` with a PHP web shell.
    *   **Exploitation**:
        *   The application processes the request, responds with a `200` OK message, and executes the uploaded PHP web shell.
    *   **Affected Endpoint**: `/gui/file_upload.php`
3.  **Local File Inclusion (LFI)**
    *   **CVE ID**: CVE-2019-16246
    *   **Security Risk**: Critical
    *   **Impact**: Code execution
    *   **Access Vector**: Remote
    *   **Details**:
        *   The `/gui/file_viewer.php` endpoint is vulnerable to LFI.
        *   Appending file paths to the `uploaded_filename` parameter processes the targeted file.
    *   **Attack Vector**:
        *   Append file paths to the `uploaded_filename` parameter in `/gui/file_viewer.php`.
    *   **Exploitation**:
        *   The application attempts to display the local file in a Google Docs file viewer, leading to disclosure of arbitrary files and potentially code execution if PHP files are included.
    *   **Affected Parameter**: `uploaded_filename` in `/gui/file_viewer.php`
4.  **SQL Injection**
    *   **CVE ID**: CVE-2019-15933
    *   **Security Risk**: High
    *   **Impact**: Information disclosure
    *   **Access Vector**: Remote
    *   **Details**:
        *   Multiple instances of SQL injection exist.
        *   The `/schedule/loaders/check_datetime.php` endpoint is vulnerable.
    *   **Attack Vector**:
        *   Inject SQL commands in the `date` parameter of `/schedule/loaders/check_datetime.php`.
    *   **Exploitation**:
        *   Exfiltration of the entire Solismed application database, including PII and medical records.
    *   **Affected Parameter**: `date` in `/schedule/loaders/check_datetime.php`
    *   **Additional Affected Locations**:
        *   `/finance/sales/load_details.php` (parameter: `payment_id`)
        *   `/index.php?loginaction=login` (Referer header)
        *   `/schedule/loaders/*` (Multiple parameters)
5.  **Cross-site Scripting (XSS)**
    *   **CVE ID**: CVE-2019-15935
    *   **Security Risk**: High
    *   **Impact**: Escalation of privileges & Information disclosure
    *   **Access Vector**: Remote
    *   **Details**:
        *   Systemic XSS, including stored and reflected XSS.
        *   Stored XSS can be exploited by low-privilege patient users to affect staff and administrators.
        *   Reflected XSS can be exploited by unauthenticated users.
    *   **Attack Vector**:
        *   Inject XSS payloads in patient address fields (stored XSS).
        *   Craft malicious links with JavaScript in the `patient_id` parameter (reflected XSS).
    *   **Exploitation**:
        *   Obtain sensitive personal information, such as Social Security numbers.
        *   Obtain valid login credentials.
        *   Chain with CSRF and Insecure File Upload for remote code execution.
    *   **Affected Locations**: Systemic; multiple locations throughout the application.
6.  **Cross-Site Request Forgery (CSRF)**
    *   **CVE ID**: CVE-2019-15934
    *   **Security Risk**: High
    *   **Impact**: Escalation of privileges
    *   **Access Vector**: Remote
    *   **Details**:
        *   Systemic CSRF can be exploited to create back-doored users or change passwords.
    *   **Attack Vector**:
        *   Create an externally hosted phishing page that forces users to send `POST` requests to the Solismed application.
    *   **Exploitation**:
        *   Gain remote code execution through a chain of vulnerabilities (CSRF => XSS => Incorrect Access Controls => Insecure File Upload).
    *   **Mitigation**:
        *   Implement CSRF tokens to validate requests.
7.  **Incorrect Access Controls**
    *   **CVE ID**: CVE-2019-15932
    *   **Security Risk**: High
    *   **Impact**: Information disclosure & Escalation of privileges
    *   **Access Vector**: Remote
    *   **Details**:
        *   Systemic incorrect access controls expose application functionality and data.
        *   Allows exploitation of Insecure File Upload and SQL injection from unauthenticated attackers.
        *   Allows low-privilege users to escalate to system administrator.
    *   **Attack Vector**:
        *   Directly access endpoints without authentication.
        *   Send a direct request to the `role` update endpoint to escalate privileges.
    *   **Exploitation**:
        *   Exposure of sensitive data such as patient lists and medical records.
        *   Privilege escalation to system administrator.
    *   **Affected Endpoints**: Systemic; multiple endpoints throughout the application.
8.  **Insecure Cryptographic Storage**
    *   **CVE ID**: CVE-2019-17428
    *   **Security Risk**: Medium
    *   **Impact**: Information disclosure & Arbitrary actions forced on behalf of user
    *   **Access Vector**: Local
    *   **Details**:
        *   Improper implementation of AES encryption to protect stored data within the SQL database.
    *   **Attack Vector**:
        *   Insert encrypted data into fields displayed by the UI to trigger decryption.
    *   **Exploitation**:
        *   Decryption of all encrypted data within the SQL database due to a hard-coded AES key.
9.  **User Interface Redress (Clickjacking)**
    *   **CVE ID**: CVE-2019-15930
    *   **Security Risk**: Low
    *   **Impact**: Arbitrary actions forced on behalf of the user
    *   **Access Vector**: Remote
    *   **Details**:
        *   Lacks application framing protections, allowing the application to be framed within a phishing page.
    *   **Attack Vector**:
        *   Frame the Solismed application in a phishing page that includes a CSRF payload.
    *   **Exploitation**:
        *   Force the execution of XSS vulnerabilities, leading to code execution on the underlying server.

#### Product Information

*   **Product Vendor**: Intesync, LLC
*   **Product Name**: Solismed
*   **Affected Version**: Version 3.3SP1 (earlier versions presumed vulnerable)
*   **Official Website**: <https://www.solismed.com/>

#### Impact

The discovered vulnerabilities can lead to complete compromise of the Solismed application server and the data contained within, including medical records, Social Security numbers, and other PII. Exploitation can occur from the context of an unauthenticated attacker without direct access to the application.

#### Solution

*   Update to version 3.5.
*   Implement strong network firewall rules to restrict incoming and outgoing connections outside the local area network.