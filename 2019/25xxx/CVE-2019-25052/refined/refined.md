Based on the provided information, this content relates to CVE-2019-25052.

**Root Cause:**
The vulnerability stems from the ability to directly call "update" and "final" crypto functions with inconsistent or malformed data, bypassing the intended initialization sequence. This occurs because the state of the crypto context (`tee_cryp_state`) was not properly set after initialization functions, allowing direct access to "update" and "final" functions.

**Weaknesses:**
- Improper state management of the crypto context. Specifically, the `CRYP_STATE_INITIALIZED` was not being set after the `syscall_*_init` functions, which resulted in the ability to call "update" and "final" functions directly without the necessary initialization.

**Impact:**
-  Directly calling "update" and "final" functions could lead to asserts, causing a crash.
-  The crash could potentially leak sensitive information.

**Attack Vectors:**
- A fuzzer tool was used to trigger the vulnerability, implying that malformed or inconsistent input data can be crafted to directly access the vulnerable functions.
- The vulnerability is triggered through the `syscall_hash_update`, `syscall_hash_final`, `tee_svc_cipher_update_helper`, `syscall_authenc_update_aad`, `syscall_authenc_update_payload`, `syscall_authenc_enc_final` and `syscall_authenc_dec_final` functions.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to provide inconsistent or malformed data to the crypto functions.
- The attacker needs to interact with the system's syscall interface that calls the vulnerable crypto functions.

**Additional details:**
- The fix involves setting the state of the crypto context to `CRYP_STATE_INITIALIZED` at the end of all `syscall_*_init` functions.
- A check for the correct state has been added at the beginning of all "update" and "final" functions to prevent direct access without proper initialization.
- The vulnerability was reported by Riscure and the fix was introduced in version 3.7.0 of OP-TEE.