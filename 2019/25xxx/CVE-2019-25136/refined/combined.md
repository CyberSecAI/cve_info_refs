=== Content from bugzilla.mozilla.org_61340a59_20250121_031529.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1577107)
* [XML](/show_bug.cgi?ctype=xml&id=1577107)

Closed
[Bug 1577107](/show_bug.cgi?id=1577107)
(CVE-2019-11757)

Opened 5 years ago
Closed 5 years ago

# Use After Free in IndexedDB

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Use After Free in IndexedDB

## Categories

### (Core :: Storage: IndexedDB, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Storage%3A%20IndexedDB#Storage%3A%20IndexedDB)

Storage: IndexedDB
▾

Core :: Storage: IndexedDB
[IndexedDB](https://w3c.github.io/IndexedDB/) implementation, exposed through self.indexedDB.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20IndexedDB&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20IndexedDB&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Storage%3A%20IndexedDB)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla71

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox69 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified) |
| firefox71 | [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 | 70+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox68 |  | wontfix |
| firefox69 |  | wontfix |
| firefox70 | + | verified |
| firefox71 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: zhanjiasong45, Assigned: sg)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7c2ab46d52baf496dec7a3c0eeaa4a3e?d=mm&size=40)  [sg](/user_profile?user_id=642231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3c10788660c0b5ff64ab9183c51c1882?d=mm&size=40)  [zhanjiasong45](/user_profile?user_id=615701)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-11757

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3489536_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files)

| [IndexedDB\_UAF.html](/attachment.cgi?id=9088647)  [5 years ago](#c0)  [zhanjiasong45](/user_profile?user_id=615701)   1.09 KB, text/html |  | [Details](/attachment.cgi?id=9088647&action=edit) |
| --- | --- | --- |
| [ASan.txt](/attachment.cgi?id=9088648)  [5 years ago](#c1)  [zhanjiasong45](/user_profile?user_id=615701)   27.54 KB, text/plain |  | [Details](/attachment.cgi?id=9088648&action=edit) |
| [Bug 1577107 - Avoid following the prototype chain](/attachment.cgi?id=9089977)  [5 years ago](#c6)  [Yaron Tausky [:ytausky]](/user_profile?user_id=621888)   47 bytes, text/x-phabricator-request | abillings : [sec-approval+](#a1028761_280903 "5 years ago") | [Details](/attachment.cgi?id=9089977&action=edit) | [Review](/attachment.cgi?id=9089977) |
| [Bug 1577107 - Avoid following the prototype chain r=lizzard](/attachment.cgi?id=9098748)  [5 years ago](#c18)  [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)   47 bytes, text/x-phabricator-request | lizzard : [approval-mozilla-esr68+](#c24 "5 years ago") | [Details](/attachment.cgi?id=9098748&action=edit) | [Review](/attachment.cgi?id=9098748) |
| [Bug 1577107 - Avoid following the prototype chain r=lizzard](/attachment.cgi?id=9098749)  [5 years ago](#c19)  [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)   47 bytes, text/x-phabricator-request | lizzard : [approval-mozilla-beta+](#c25 "5 years ago") | [Details](/attachment.cgi?id=9098749&action=edit) | [Review](/attachment.cgi?id=9098749) |
| [verification logs](/attachment.cgi?id=9099582)  [5 years ago](#c35)  [Daniel Bodea [:danibodea]](/user_profile?user_id=616104)   24.16 KB, text/plain |  | [Details](/attachment.cgi?id=9099582&action=edit) |
| [advisory.txt](/attachment.cgi?id=9100571)  [5 years ago](#c38)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   263 bytes, text/plain |  | [Details](/attachment.cgi?id=9100571&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1577107#c0)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1577107&comment_id=14327578 "1 revision") |
|  | |

Attached file
[IndexedDB\_UAF.html](attachment.cgi?id=9088647)
— [Details](attachment.cgi?id=9088647&action=edit)

```
void IDBObjectStore::AppendIndexUpdateInfo(
    int64_t aIndexID, const KeyPath& aKeyPath, bool aUnique, bool aMultiEntry,
    const nsCString& aLocale, JSContext* aCx, JS::Handle<JS::Value> aVal,
    nsTArray<IndexUpdateInfo>& aUpdateInfoArray, ErrorResult& aRv) {
  const bool localeAware = !aLocale.IsEmpty();

  if (!aMultiEntry) {
	...
    return;
  }

  JS::Rooted<JS::Value> val(aCx);
  if (NS_FAILED(aKeyPath.ExtractKeyAsJSVal(aCx, aVal, val.address()))) {
    return;
  }

  bool isArray;
  if (!JS_IsArrayObject(aCx, val, &isArray)) {
    IDB_REPORT_INTERNAL_ERR();
    aRv.Throw(NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR);
    return;
  }
  if (isArray) {
    JS::Rooted<JSObject*> array(aCx, &val.toObject());
    uint32_t arrayLength;
    if (NS_WARN_IF(!JS_GetArrayLength(aCx, array, &arrayLength))) {
      IDB_REPORT_INTERNAL_ERR();
      aRv.Throw(NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR);
      return;
    }

    for (uint32_t arrayIndex = 0; arrayIndex < arrayLength; arrayIndex++) {
      JS::Rooted<JS::Value> arrayItem(aCx);
      if (NS_WARN_IF(!JS_GetElement(aCx, array, arrayIndex, &arrayItem))) {	//	JS_GetElement can trigger js getter, call deleteIndex here will free `aLocale`.
        IDB_REPORT_INTERNAL_ERR();
        aRv.Throw(NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR);
        return;
      }

      Key value;
      auto result = value.SetFromJSVal(aCx, arrayItem, aRv);
      if (!result.Is(Ok, aRv) || value.IsUnset()) {
        // Not a value we can do anything with, ignore it.
        aRv.SuppressException();
        continue;
      }

      IndexUpdateInfo* updateInfo = aUpdateInfoArray.AppendElement();
      updateInfo->indexId() = aIndexID;
      updateInfo->value() = value;
      if (localeAware) {
        auto result =
            value.ToLocaleBasedKey(updateInfo->localizedValue(), aLocale, aRv);//	UAF occurs!
        if (NS_WARN_IF(!result.Is(Ok, aRv))) {
          if (result.Is(Invalid, aRv)) {
            aRv.Throw(NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR);
          }
          return;
        }
      }
    }
  } else {
	...
  }
}

```
Flags: sec-bounty?

|  | [zhanjiasong45](/user_profile?user_id=615701)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1577107#c1)• 5 years ago |
|  | |

Attached file
[ASan.txt](attachment.cgi?id=9088648)
— [Details](attachment.cgi?id=9088648&action=edit)

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1577107#c2)• 5 years ago |
|  | |

Andrew, can you take a look at this? Thanks!

Group: firefox-core-security → core-securityComponent: Security → DOM: IndexedDBFlags: needinfo?(bugmail)Product: Firefox → Core

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a1006_159069)• 5 years ago |

Group: core-security → dom-core-security

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1577107#c3)• 5 years ago |
|  | |

This is very similar to [bug 1501152](/show_bug.cgi?id=1501152 "VERIFIED FIXED - Use after free in KeyPath::ExtractKey"), with content execution triggered from another place.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1577107#c4)• 5 years ago |
|  | |

Assigning to Yaron given his experience on the other bug. Given that we've landed other security bug fixes in this area, I think it makes sense to prioritize this above the other bugs discussed at yesterday's team meeting.

Assignee: nobody → ytauskyStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(bugmail)Priority: -- → P1

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a34460_406194)• 5 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1577107#c5)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1577107&comment_id=14337305 "1 revision") |
|  | |

[Tracking Requested - why for this release] sec-high

[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1577107#c6)• 5 years ago |
|  | |

Attached file
[Bug 1577107 - Avoid following the prototype chain](attachment.cgi?id=9089977)
— [Details](attachment.cgi?id=9089977&action=edit)

With this commit we no longer follow the value's prototype chain when

creating index updates in IndexedDB.

|  | [Jan Varga [:janv]](/user_profile?user_id=8340) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1577107#c7)• 5 years ago |
|  | |

So, this is very similar to "patch for spidermonkey" in [bug 1501152](/show_bug.cgi?id=1501152 "VERIFIED FIXED - Use after free in KeyPath::ExtractKey").

I think we should convert all these IndexedDB\_UAF.html tests to unit tests so they can run automatically (once all patches landed on all supported branches). I remember I already converted some of them, I'll try to find them.

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1577107#c8)• 5 years ago |
|  | |

All instances of this pattern (getting an element only if it's an own attribute) can be traced back to 2-3 places in the spec; in this case, this is an inlined implementation of a particular step of a spec algorithm. Ideally we should have one piece of code corresponding to each spec algorithm, but in the interest of fixing the problem fast first, patching it up like this is probably better.

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1577107#c9)• 5 years ago |
|  | |

Comment on [attachment 9089977](/attachment.cgi?id=9089977 "Bug 1577107 - Avoid following the prototype chain") [[details]](/attachment.cgi?id=9089977&action=edit "Bug 1577107 - Avoid following the prototype chain")

[Bug 1577107](/show_bug.cgi?id=1577107 "VERIFIED FIXED - Use After Free in IndexedDB") - Avoid following the prototype chain

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It's an easily triggered UAF, not sure how easy it is to exploit.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Backporting should be straightforward.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions; a similar fix was already applied elsewhere.
[Attachment #9089977](/attachment.cgi?id=9089977&action=edit "Bug 1577107 - Avoid following the prototype chain") -
Flags: sec-approval?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a557353_451704)• 5 years ago |

[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a558462_75935)• 5 years ago |

[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1577107#c10)• 5 years ago |
|  | |

sec-approval+ for checkin on September 24, 3 weeks into the new cycle. This is to limit the exposure somewhat.

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][checkin on 9/24/19]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a1028761_280903)• 5 years ago |

[Attachment #9089977](/attachment.cgi?id=9089977&action=edit "Bug 1577107 - Avoid following the prototype chain") -
Flags: sec-approval? → sec-approval+

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a1388143_646284)• 5 years ago |

Assignee: ytausky → sgiesecke

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a2520217_642231)• 5 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1577107#c11)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/e91773704fbd766da1e8657b2a579713c0c54a75>

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a2529909_258347)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][checkin on 9/24/19] → [reporter-external] [client-bounty-form] [verif?]

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1577107#c12)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1577107&comment_id=14386803 "1 revision") |
|  | |

Backed out for wpt crashes/assertions on clone-before-keypath-eval.html:

<https://hg.mozilla.org/integration/autoland/rev/13d8012af41b777b5461397598ba7f3d6b8c0d71>

Push with failure: <https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&selectedJob=268596129&resultStatus=superseded%2Cretry%2Cusercancel%2Ctestfailed%2Cbusted%2Cexception&revision=e91773704fbd766da1e8657b2a579713c0c54a75>

Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=268596129&repo=autoland>

```
[task 2019-09-26T16:28:20.125Z] 16:28:20     INFO - TEST-START | /IndexedDB/clone-before-keypath-eval.html
[task 2019-09-26T16:28:20.126Z] 16:28:20     INFO - Closing window 26
[task 2019-09-26T16:28:21.178Z] 16:28:21     INFO - Browser not responding, setting status to CRASH
[task 2019-09-26T16:28:22.460Z] 16:28:22     INFO - mozcrash Downloading symbols from: https://queue.taskcluster.net/v1/task/RsRqLQswS1uDjn06swtXiA/artifacts/public/build/target.crashreporter-symbols.zip
[task 2019-09-26T16:28:25.927Z] 16:28:25     INFO - mozcrash Copy/paste: /builds/worker/workspace/build/linux64-minidump_stackwalk /tmp/tmpYJTIAQ/09c443ad-2fbf-2bcf-07db-1f60e6b59b36.dmp /tmp/tmpQuJkN2
[task 2019-09-26T16:28:30.387Z] 16:28:30     INFO - mozcrash Saved minidump as /builds/worker/workspace/build/blobber_upload_dir/09c443ad-2fbf-2bcf-07db-1f60e6b59b36.dmp
[task 2019-09-26T16:28:30.391Z] 16:28:30     INFO - mozcrash Saved app info as /builds/worker/workspace/build/blobber_upload_dir/09c443ad-2fbf-2bcf-07db-1f60e6b59b36.extra
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - PROCESS-CRASH | /IndexedDB/clone-before-keypath-eval.html | application crashed [@ js::RunScript(JSContext*, js::RunState&)]
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Crash dump filename: /tmp/tmpYJTIAQ/09c443ad-2fbf-2bcf-07db-1f60e6b59b36.dmp
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Operating system: Android
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -                   0.0.0 Linux 3.10.0+ #260 SMP PREEMPT Fri May 19 12:48:14 PDT 2017 x86_64
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - CPU: amd64
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -      family 6 model 6 stepping 3
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -      4 CPUs
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - GPU: UNKNOWN
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Crash reason:  SIGSEGV /SEGV_MAPERR
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Crash address: 0x0
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Process uptime: not available
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO - Thread 11 (crashed)
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -  0  libxul.so!js::RunScript(JSContext*, js::RunState&) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 396 + 0x11]
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     rax = 0x0000743134af5c52   rdx = 0x0000000000000000
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     rcx = 0x00007431373934c8   rbx = 0x00007431298df800
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     rsi = 0x0000743137cb4338   rdi = 0x000074312c72a000
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     rbp = 0x0000743137cb4370   rsp = 0x0000743137cb4320
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -      r8 = 0x0000000000000000    r9 = 0x0000000000000000
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     r10 = 0x00007431298df800   r11 = 0x000074312abcbcd4
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     r12 = 0x0000743137cb4450   r13 = 0x000074312c72a000
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     r14 = 0x0000743137cb43e0   r15 = 0xfffe000000000000
[task 2019-09-26T16:28:30.490Z] 16:28:30     INFO -     rip = 0x000074313322eca5
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     Found by: given as instruction pointer in context
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -  1  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 592 + 0xb]
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb4440
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rsp = 0x0000743137cb4380   r12 = 0x0000743137cb4450
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r15 = 0xfffe000000000000   rip = 0x000074313324861c
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -  2  libxul.so!js::CallGetter(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::MutableHandle<JS::Value>) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 761 + 0x9a]
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb44b0
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rsp = 0x0000743137cb4450   r12 = 0x00000a0d66b65ee8
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r13 = 0x0000095d2bd0b401   r14 = 0x0000743137cb4630
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r15 = 0x000074312c72a000   rip = 0x000074313324961f
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -  3  libxul.so!js::NativeGetProperty(JSContext*, JS::Handle<js::NativeObject*>, JS::Handle<JS::Value>, JS::Handle<JS::PropertyKey>, JS::MutableHandle<JS::Value>) [NativeObject.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 2618 + 0xee0]
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rbx = 0x00000a0d66b65e78   rbp = 0x0000743137cb45a0
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rsp = 0x0000743137cb44c0   r12 = 0x00000a0d66b65ee8
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r13 = 0x0000095d2bd0b401   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r15 = 0x0000743137cb4630   rip = 0x000074313342b015
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -  4  libxul.so!WriteStructuredClone(JSContext*, JS::Handle<JS::Value>, JSStructuredCloneData*, JS::StructuredCloneScope, JS::CloneDataPolicy, JSStructuredCloneCallbacks const*, void*, JS::Value const&) [StructuredClone.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 631 + 0x4eb]
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rbx = 0x0000743137cb46c0   rbp = 0x0000743137cb49c0
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     rsp = 0x0000743137cb45b0   r12 = 0x00000ba8de1f8740
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r13 = 0x0000743137cb46d8   r14 = 0x0000743134af83b3
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     r15 = 0xfffe000000000000   rip = 0x00007431334ac0bd
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.491Z] 16:28:30     INFO -  5  libxul.so!JS_StructuredClone(JSContext*, JS::Handle<JS::Value>, JS::MutableHandle<JS::Value>, JSStructuredCloneCallbacks const*, void*) [StructuredClone.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 3075 + 0x76]
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb4af0
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rsp = 0x0000743137cb49d0   r12 = 0x000074313669e798
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x0000743137cb4b20
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r15 = 0x0000743134b2b800   rip = 0x00007431334b52db
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -  6  libxul.so!mozilla::dom::IDBObjectStore::ValueWrapper::Clone(JSContext*) [IDBObjectStore.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 2508 + 0x15]
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rbx = 0x000074312c72a001   rbp = 0x0000743137cb4b40
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rsp = 0x0000743137cb4b00   r12 = 0x0000743137cb5040
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x0000743137cb5040
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r15 = 0x0000743137cb5018   rip = 0x000074313241ef14
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -  7  libxul.so!mozilla::dom::IDBObjectStore::AddOrPut(JSContext*, mozilla::dom::IDBObjectStore::ValueWrapper&, JS::Handle<JS::Value>, bool, bool, mozilla::ErrorResult&) [IDBObjectStore.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1509 + 0x1c3]
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rbx = 0x000074312c72a000   rbp = 0x0000743137cb4fe0
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rsp = 0x0000743137cb4b50   r12 = 0x0000743137cb5040
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x000074312a2f9580
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r15 = 0x0000743137cb5018   rip = 0x000074313241f2c9
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -  8  libxul.so!mozilla::dom::IDBObjectStore_Binding::put(JSContext*, JS::Handle<JSObject*>, mozilla::dom::IDBObjectStore*, JSJitMethodCallArgs const&) [IDBObjectStoreBinding.cpp: : 478 + 0x31]
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rbx = 0x000074312c72a000   rbp = 0x0000743137cb5090
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rsp = 0x0000743137cb4ff0   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r13 = 0x0000743137cb5040   r14 = 0x0000743137cb50f0
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r15 = 0x000074312a2f9580   rip = 0x0000743131eb0443
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -  9  libxul.so!bool mozilla::dom::binding_detail::GenericMethod<mozilla::dom::binding_detail::NormalThisPolicy, mozilla::dom::binding_detail::ThrowExceptions>(JSContext*, unsigned int, JS::Value*) [BindingUtils.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 3250 + 0x11]
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rbx = 0x0000743131eb033f   rbp = 0x0000743137cb5130
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     rsp = 0x0000743137cb50a0   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r13 = 0x0000000000000136   r14 = 0x00007431365ffd58
[task 2019-09-26T16:28:30.492Z] 16:28:30     INFO -     r15 = 0x000074312c72a000   rip = 0x0000743131ec8057
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO - 10  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 551 + 0x186]
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb5200
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     rsp = 0x0000743137cb5140   r12 = 0x0000743137cb5340
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     r13 = 0x00000a0d66b6e780   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     r15 = 0x0000743137cb5188   rip = 0x000074313324821b
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO - 11  libxul.so!Interpret(JSContext*, js::RunState&) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 624 + 0x7]
[task 2019-09-26T16:28:30.493Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb56e0
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb5210   r12 = 0x0000000066b54b80
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0x000074312bdd5168   r14 = 0x00007431367910b0
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0xfffdffffffffffff   rip = 0x000074313323df20
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 12  libxul.so!js::RunScript(JSContext*, js::RunState&) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 424 + 0xb]
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbx = 0x0000000000000140   rbp = 0x0000743137cb5740
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb56f0   r12 = 0x00000a0d66b54b80
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x0000743137cb57b0
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0x0000743137cb57c8   rip = 0x000074313322ea79
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 13  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 592 + 0xb]
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb5810
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb5750   r12 = 0x0000743137cb58b8
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0xfffe000000000000   rip = 0x000074313324861c
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 14  libxul.so!js::jit::InvokeFunction(JSContext*, JS::Handle<JSObject*>, bool, bool, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) [VMFunctions.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 260 + 0x37]
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb5970
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb5820   r12 = 0x0000743137cb5900
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0xfffe000000000000   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0x0000000000000001   rip = 0x00007431337fccd1
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 15  libxul.so!js::jit::InvokeFromInterpreterStub(JSContext*, js::jit::InterpreterStubExitFrameLayout*) [VMFunctions.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 289 + 0x10]
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb59d0
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb5980   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0x0000743137cb6618   r14 = 0x0000743137cb5a20
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0x0000743137cb5bc8   rip = 0x00007431337fd081
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 16  0x3901bae78e04
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbx = 0x00003901bae78dd0   rbp = 0x0000743137cb5a30
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rsp = 0x0000743137cb59e0   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r13 = 0x0000743137cb6618   r14 = 0x0000743129c4153a
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     r15 = 0x0000743137cb5bc8   rip = 0x00003901bae78e04
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO - 17  0x7431297232f0
[task 2019-09-26T16:28:30.494Z] 16:28:30     INFO -     rbp = 0x0000743137cb5ad8   rsp = 0x0000743137cb5a40
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rip = 0x00007431297232f0
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 18  0x3901bae7848f
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbp = 0x0000743137cb5b50   rsp = 0x0000743137cb5ae8
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rip = 0x00003901bae7848f
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 19  libxul.so!js::jit::MaybeEnterJit(JSContext*, js::RunState&) [Jit.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 200 + 0x16f]
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbp = 0x0000743137cb6020   rsp = 0x0000743137cb5b60
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rip = 0x00007431339bdb88
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 20  libxul.so!js::RunScript(JSContext*, js::RunState&) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 409 + 0xb]
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbx = 0x0000000000000100   rbp = 0x0000743137cb6080
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rsp = 0x0000743137cb6030   r12 = 0x00000a0d66b49400
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x0000743137cb60f0
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r15 = 0x0000743137cb6108   rip = 0x000074313322ea33
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 21  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 592 + 0xb]
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb6150
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rsp = 0x0000743137cb6090   r12 = 0x0000743137cb65c8
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r15 = 0x0000000000000000   rip = 0x000074313324861c
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 22  libxul.so!js::fun_apply(JSContext*, unsigned int, JS::Value*) [JSFunction.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1184 + 0x33]
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb6680
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rsp = 0x0000743137cb6160   r12 = 0x0000743137cb6af0
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r13 = 0xfffdffffffffffff   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r15 = 0x0000743137cb6610   rip = 0x0000743133399bda
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO - 23  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 551 + 0x186]
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb6750
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     rsp = 0x0000743137cb6690   r12 = 0x0000743137cb6820
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r13 = 0x00000ba8de1d2140   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     r15 = 0x0000743137cb66d8   rip = 0x000074313324821b
[task 2019-09-26T16:28:30.495Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO - 24  libxul.so!js::jit::DoCallFallback(JSContext*, js::jit::BaselineFrame*, js::jit::ICCall_Fallback*, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) [BaselineIC.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 3229 + 0xa]
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb6a90
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rsp = 0x0000743137cb6760   r12 = 0x000000000000004f
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     r13 = 0x0000743129cc7e6d   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     r15 = 0x00007431298d53d0   rip = 0x00007431337d3dfc
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO - 25  0x3901bae7a798
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rbx = 0x00003901bae85868   rbp = 0x0000743137cb6b10
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rsp = 0x0000743137cb6aa0   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     r13 = 0x0000743137cb7278   r14 = 0x0000743129cc7e6d
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     r15 = 0x0000743137cb6c78   rip = 0x00003901bae7a798
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO - 26  0x7431298d53d0
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rbp = 0x0000743137cb6b98   rsp = 0x0000743137cb6b20
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rip = 0x00007431298d53d0
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO - 27  0x3901bae7848f
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rbp = 0x0000743137cb6c00   rsp = 0x0000743137cb6ba8
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     rip = 0x00003901bae7848f
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.496Z] 16:28:30     INFO - 28  libxul.so!js::jit::MaybeEnterJit(JSContext*, js::RunState&) [Jit.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 200 + 0x16f]
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rbp = 0x0000743137cb70d0   rsp = 0x0000743137cb6c10
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rip = 0x00007431339bdb88
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO - 29  libxul.so!js::RunScript(JSContext*, js::RunState&) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 409 + 0xb]
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rbx = 0x00000000000000c0   rbp = 0x0000743137cb7130
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rsp = 0x0000743137cb70e0   r12 = 0x00000a0d66b54820
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x0000743137cb71a0
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     r15 = 0x0000743137cb71b8   rip = 0x000074313322ea33
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO - 30  libxul.so!js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) [Interpreter.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 592 + 0xb]
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rbx = 0x00007431298df800   rbp = 0x0000743137cb7200
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     rsp = 0x0000743137cb7140   r12 = 0x0000743137cb7228
[task 2019-09-26T16:28:30.497Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x000074312c72a000
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r15 = 0xfffe000000000000   rip = 0x000074313324861c
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO - 31  libxul.so!JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) [jsapi.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 2728 + 0x37]
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb72e0
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rsp = 0x0000743137cb7210   r12 = 0x0000743137cb74f0
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x0000000000000001
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r15 = 0x0000743137cb7350   rip = 0x00007431335b0484
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO - 32  libxul.so!mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JS::Value>, mozilla::dom::Event&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) [EventHandlerBinding.cpp: : 267 + 0x15]
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rbx = 0x0000743137cb7350   rbp = 0x0000743137cb7400
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rsp = 0x0000743137cb72f0   r12 = 0x0000743137cb7338
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r13 = 0x000074312c72a000   r14 = 0x000074312a4c2d80
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r15 = 0x000074312c72a068   rip = 0x0000743131d99c08
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO - 33  libxul.so!mozilla::JSEventHandler::HandleEvent(mozilla::dom::Event*) [JSEventHandler.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 205 + 0x1c]
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rbx = 0x0000743137cb74f0   rbp = 0x0000743137cb7740
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rsp = 0x0000743137cb7410   r12 = 0x000074312a4c2d80
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r13 = 0x0000000080004000   r14 = 0xfff9800000000000
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r15 = 0x000074312a44dfb0   rip = 0x000074313203ddd4
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO - 34  libxul.so!mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener*, mozilla::dom::Event*, mozilla::dom::EventTarget*) [EventListenerManager.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1039 + 0xc]
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rbx = 0x000074312a4ca641   rbp = 0x0000743137cb7970
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rsp = 0x0000743137cb7750   r12 = 0x000074312aca0a60
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r13 = 0x000074312a44dfb0   r14 = 0x000074312a4ca641
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     r15 = 0x000074312a4ca640   rip = 0x000074313202ed0d
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO - 35  libxul.so!mozilla::EventListenerManager::HandleEventInternal(nsPresContext*, mozilla::WidgetEvent*, mozilla::dom::Event**, mozilla::dom::EventTarget*, nsEventStatus*, bool) [EventListenerManager.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1231 + 0x12]
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rbx = 0x000074312a4e34c0   rbp = 0x0000743137cb7b50
[task 2019-09-26T16:28:30.498Z] 16:28:30     INFO -     rsp = 0x0000743137cb7980   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312a310990   r14 = 0x000074312a4c6238
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x0000743136db2ca0   rip = 0x000074313202f4ea
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 36  libxul.so!mozilla::EventTargetChainItem::HandleEvent(mozilla::EventChainPostVisitor&, mozilla::ELMCreationDetector&) [EventDispatcher.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 349 + 0xc]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x000074312b89c008   rbp = 0x0000743137cb7b80
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb7b60   r12 = 0x0000000000000001
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x0000743137cb7d50   r14 = 0x0000743137cb7d38
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x000074312b89c050   rip = 0x000074313202a9a0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 37  libxul.so!mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback*, mozilla::ELMCreationDetector&) [EventDispatcher.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 551 + 0x12]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb7c80
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb7b90   r12 = 0x0000000000000001
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x0000743137cb7d50   r14 = 0x0000743137cb7d20
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x000074312b89c008   rip = 0x000074313202a491
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 38  libxul.so!mozilla::EventDispatcher::Dispatch(nsISupports*, nsPresContext*, mozilla::WidgetEvent*, mozilla::dom::Event*, nsEventStatus*, mozilla::EventDispatchingCallback*, nsTArray<mozilla::dom::EventTarget*>*) [EventDispatcher.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1045 + 0x5]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x000074312aca0a60   rbp = 0x0000743137cb7fa0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb7c90   r12 = 0x000074312a44dfb0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x0000743137cb7ff4   r14 = 0x0000000000000000
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x0000743137cb7d50   rip = 0x000074313202b707
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 39  libxul.so!mozilla::EventDispatcher::DispatchDOMEvent(nsISupports*, mozilla::WidgetEvent*, mozilla::dom::Event*, nsPresContext*, nsEventStatus*) [EventDispatcher.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 0 + 0xb]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x000074312a4e34c0   rbp = 0x0000743137cb7fe0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb7fb0   r12 = 0x000074312aca0a60
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312a44dfb0   r14 = 0x0000743137cb7ff4
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x0000000000000000   rip = 0x000074313202c8a5
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 40  libxul.so!mozilla::DOMEventTargetHelper::DispatchEvent(mozilla::dom::Event&, mozilla::dom::CallerType, mozilla::ErrorResult&) [DOMEventTargetHelper.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 166 + 0xc]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x000074312a44dfb0   rbp = 0x0000743137cb8020
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb7ff0   r12 = 0x0000743137cb8098
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312a44dfb0   r14 = 0x0000743137cb8030
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x0000000000000001   rip = 0x000074313201efa3
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 41  libxul.so!mozilla::dom::EventTarget::DispatchEvent(mozilla::dom::Event&, mozilla::ErrorResult&) [EventTarget.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 184 + 0x16]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x0000743137cb8030   rbp = 0x0000743137cb8050
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb8030   r12 = 0x0000743137cb8098
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312a44dfb0   r14 = 0x000074312a44dfb0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x000074312aca0a60   rip = 0x0000743132032292
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 42  libxul.so!mozilla::dom::indexedDB::(anonymous namespace)::DispatchSuccessEvent(mozilla::dom::indexedDB::(anonymous namespace)::ResultHelper*, mozilla::dom::Event*) [ActorsChild.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 767 + 0xb]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x0000000000000000   rbp = 0x0000743137cb8160
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb8060   r12 = 0x0000743137cb8098
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312a44dfb0   r14 = 0x000074312a44dfb0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r15 = 0x000074312aca0a60   rip = 0x0000743132417989
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO - 43  libxul.so!mozilla::dom::indexedDB::BackgroundFactoryRequestChild::Recv__delete__(mozilla::dom::indexedDB::FactoryRequestResponse const&) [ActorsChild.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1646 + 0x1c]
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rbx = 0x0000743137cb8188   rbp = 0x0000743137cb81f0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     rsp = 0x0000743137cb8170   r12 = 0x000074312a49d8f0
[task 2019-09-26T16:28:30.499Z] 16:28:30     INFO -     r13 = 0x000074312b825100   r14 = 0x000074312a4ec3e0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r15 = 0x000074312a49d8e0   rip = 0x0000743132417c9a
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO - 44  libxul.so!non-virtual thunk to mozilla::dom::indexedDB::BackgroundFactoryRequestChild::Recv__delete__(mozilla::dom::indexedDB::FactoryRequestResponse const&) [ActorsChild.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 0 + 0xd]
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rbx = 0x000074312a33ac08   rbp = 0x0000743137cb8200
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rsp = 0x0000743137cb8200   r12 = 0x000074312a49d8f0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r13 = 0x000074312b825100   r14 = 0x000074312a49d8f0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r15 = 0x000074312a33ac10   rip = 0x0000743132417d19
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO - 45  libxul.so!mozilla::dom::indexedDB::PBackgroundIDBFactoryRequestChild::OnMessageReceived(IPC::Message const&) [PBackgroundIDBFactoryRequestChild.cpp: : 128 + 0xd]
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rbx = 0x000074312a33ac08   rbp = 0x0000743137cb82f0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rsp = 0x0000743137cb8210   r12 = 0x000074312a49d8f0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r13 = 0x000074312b825100   r14 = 0x000074312a49d8f0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r15 = 0x000074312a33ac10   rip = 0x00007431312ec412
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO - 46  libxul.so!mozilla::ipc::PBackgroundChild::OnMessageReceived(IPC::Message const&) [PBackgroundChild.cpp: : 5876 + 0x10]
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rbx = 0x000074312a33ac08   rbp = 0x0000743137cb8cf0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rsp = 0x0000743137cb8300   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r13 = 0x000074312b825100   r14 = 0x0000743137cb8318
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r15 = 0x000074312b825040   rip = 0x0000743131266485
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO - 47  libxul.so!mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) [MessageChannel.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 2185 + 0x9]
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rbx = 0x0000000000000001   rbp = 0x0000743137cb8df0
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     rsp = 0x0000743137cb8d00   r12 = 0x0000000000000000
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r13 = 0x000074312b825100   r14 = 0x000074312a33ac08
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     r15 = 0x000074312b8277a0   rip = 0x00007431311618d3
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.500Z] 16:28:30     INFO - 48  libxul.so!mozilla::ipc::MessageChannel::MessageTask::Run() [MessageChannel.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1985 + 0xee]
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rbx = 0x000074312a33abb0   rbp = 0x0000743137cb8e30
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rsp = 0x0000743137cb8e00   r12 = 0x000074312a33ac08
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r13 = 0x00000000ffffffff   r14 = 0x000074312b82a200
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r15 = 0x000074312b825100   rip = 0x000074313116216a
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO - 49  libxul.so!mozilla::SchedulerGroup::Runnable::Run() [SchedulerGroup.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 295 + 0xa]
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rbx = 0x000074312a42fd00   rbp = 0x0000743137cb8eb0
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rsp = 0x0000743137cb8e40   r12 = 0x0000000000000001
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r13 = 0x00000000ffffffff   r14 = 0x000074312a42fd00
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r15 = 0x0000743136d3a120   rip = 0x0000743130dcc4c8
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO - 50  libxul.so!nsThread::ProcessNextEvent(bool, bool*) [nsThread.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 1225 + 0x9]
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rbx = 0x0000743137cb8f10   rbp = 0x0000743137cb9400
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     rsp = 0x0000743137cb8ec0   r12 = 0x0000000000000001
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r13 = 0x00000000ffffffff   r14 = 0x000074312a42fd00
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     r15 = 0x0000743136d3a120   rip = 0x0000743130dd80ff
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.501Z] 16:28:30     INFO - 51  libxul.so!NS_ProcessNextEvent(nsIThread*, bool) [nsThreadUtils.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 486 + 0x10]
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rbx = 0x0000743137cb941f   rbp = 0x0000743137cb9430
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rsp = 0x0000743137cb9410   r12 = 0x0000743136d084e0
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x0000743137cb9578
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r15 = 0x0000000000000000   rip = 0x0000743130dd9631
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO - 52  libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) [MessagePump.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 88 + 0x7]
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rbx = 0x0000743136d084c0   rbp = 0x0000743137cb9470
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rsp = 0x0000743137cb9440   r12 = 0x0000743136d084e0
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r13 = 0x0000000000000000   r14 = 0x0000743137cb9578
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r15 = 0x0000000000000000   rip = 0x0000743131163866
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO - 53  libxul.so!MessageLoop::Run() [message_loop.cc:e91773704fbd766da1e8657b2a579713c0c54a75 : 290 + 0xc]
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rbx = 0x0000743137cb9488   rbp = 0x0000743137cb94b0
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     rsp = 0x0000743137cb9480   r12 = 0x0000000000000d37
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r13 = 0x0000743136d18040   r14 = 0x0000743136d3a120
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     r15 = 0x0000743136d40000   rip = 0x0000743131135bdf
[task 2019-09-26T16:28:30.502Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO - 54  libxul.so!nsBaseAppShell::Run() [nsBaseAppShell.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 137 + 0xd]
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rbx = 0x0000743136d72a80   rbp = 0x0000743137cb94d0
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rsp = 0x0000743137cb94c0   r12 = 0x0000000000000d37
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r13 = 0x0000743136d18040   r14 = 0x0000743136d3a120
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r15 = 0x0000743136d40000   rip = 0x00007431326229ed
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO - 55  libxul.so!XRE_RunAppShell() [nsEmbedFunctions.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 934 + 0x6]
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rbx = 0x0000743137cb94e8   rbp = 0x0000743137cb9500
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rsp = 0x0000743137cb94e0   r12 = 0x0000000000000d37
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r13 = 0x0000743136d18040   r14 = 0x000000000000000e
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r15 = 0x0000743136d40000   rip = 0x000074313314bc90
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO - 56  libxul.so!MessageLoop::Run() [message_loop.cc:e91773704fbd766da1e8657b2a579713c0c54a75 : 290 + 0xc]
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rbx = 0x0000743137cb9518   rbp = 0x0000743137cb9540
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rsp = 0x0000743137cb9510   r12 = 0x0000000000000d37
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r13 = 0x0000743136d18040   r14 = 0x000000000000000e
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     r15 = 0x0000743136d40000   rip = 0x0000743131135bdf
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO - 57  libxul.so!XRE_InitChildProcess(int, char**, XREChildData const*) [nsEmbedFunctions.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 769 + 0x5]
[task 2019-09-26T16:28:30.503Z] 16:28:30     INFO -     rbx = 0x0000743136d40000   rbp = 0x0000743137cb9760
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     rsp = 0x0000743137cb9550   r12 = 0x0000000000000d37
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     r13 = 0x0000743136d18040   r14 = 0x000000000000000e
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     r15 = 0x0000743136d40000   rip = 0x000074313314bb38
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO - 58  libmozglue.so!Java_org_mozilla_gecko_mozglue_GeckoLoader_nativeRun [APKOpen.cpp:e91773704fbd766da1e8657b2a579713c0c54a75 : 380 + 0x8]
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     rbx = 0x0000000000000010   rbp = 0x0000743137cb97e0
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     rsp = 0x0000743137cb9770   r12 = 0x000000000000002a
[task 2019-09-26T16:28:30.504Z] 16:28:30     INFO -     r13 = 0x0000000000000011   r14 = 0x0000000000000011
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     r15 = 0x0000743136d18040   rip = 0x00007431370452b4
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO - 59  base.odex + 0x8fb033
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     rbx = 0x0000743145bb0200   rbp = 0x0000743137cb98b8
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     rsp = 0x0000743137cb97f0   r12 = 0x0000743137cb9a40
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     r13 = 0x0000743153775ad8   r14 = 0x0000743137cb9c50
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     r15 = 0x0000743137cb9c50   rip = 0x00007431385b6033
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     Found by: call frame info
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO - 60  0x743137cb9c50
[task 2019-09-26T16:28:30.505Z] 16:28:30     INFO -     rbp = 0x0000743137cb9c50   rsp = 0x0000743137cb98c8
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO -     rip = 0x0000743137cb9c50
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO -     Found by: previous frame's frame pointer
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO - 61  dalvik-LinearAlloc (deleted) + 0x6ad8
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO -     rbp = 0x0000743137cb9c50   rsp = 0x0000743137cb98d0
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO -     rip = 0x0000743153775ad8
[task 2019-09-26T16:28:30.506Z] 16:28:30     INFO -     Found by: stack scanning

[...]

```
Flags: needinfo?(sgiesecke)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1577107#c13)• 5 years ago |
|  | |

I fixed the issue with wpt, and updated the patch. I am not sure if (and how) I need to re-request sec-approval. If it's not necessary, it can be checked in again.

Flags: needinfo?(sgiesecke) → needinfo?(aryx.bugmail)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a2849946_642231)• 5 years ago |

Type: task → defect

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1577107#c14)• 5 years ago |
|  | |

Relanded, not asked for new security review as only an assertion got removed:

<https://hg.mozilla.org/integration/autoland/rev/dddb97ff7ed9140ec0934f723f4446e3ada0067d>

Flags: needinfo?(aryx.bugmail)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1577107#c15)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/dddb97ff7ed9>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla71

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1577107#c16)• 5 years ago |
|  | |

Looks like this will need a rebased patch for Beta and ESR68 uplift. Please attach rebased patches and request approval on them when you're able. Thanks!

Flags: needinfo?(sgiesecke)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1577107#c17)• 5 years ago |
|  | |

I'd like to be able to land this before Monday for the beta 13 build. Following up in email.

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1577107#c18)• 5 years ago |
|  | |

Attached file
[Bug 1577107 - Avoid following the prototype chain r=lizzard](attachment.cgi?id=9098748)
— [Details](attachment.cgi?id=9098748&action=edit)

With this commit we no longer follow the value's prototype chain when

creating index updates in IndexedDB.

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1577107#c19)• 5 years ago |
|  | |

Attached file
[Bug 1577107 - Avoid following the prototype chain r=lizzard](attachment.cgi?id=9098749)
— [Details](attachment.cgi?id=9098749&action=edit)

With this commit we no longer follow the value's prototype chain when

creating index updates in IndexedDB.

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1577107#c20)• 5 years ago |
|  | |

@lizzard: I submitted uplifted patches to esr68 and beta. I put you in as a reviewer. I am not sure if that is correct. Is there anything else I need to do?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1577107#c21)• 5 years ago |
|  | |

Click on the "Details" link for one of those patches, then set the dropdown "approval-mozilla-beta" to "?" and fill out the form. Do the same for approval-mozilla-esr68. More info at <https://wiki.mozilla.org/Release_Management/Uplift_rules>

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1577107#c22)• 5 years ago |
|  | |

Comment on [attachment 9098748](/attachment.cgi?id=9098748 "Bug 1577107 - Avoid following the prototype chain r=lizzard") [[details]](/attachment.cgi?id=9098748&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard")

[Bug 1577107](/show_bug.cgi?id=1577107 "VERIFIED FIXED - Use After Free in IndexedDB") - Avoid following the prototype chain r=lizzard

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Security hazard due to possible use-after-free when using IndexedDB
* **Fix Landed on Version**: 71
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Unlikely to cause regressions; a similar fix was already applied elsewhere & backporting from 71 was straightforward.
* **String or UUID changes made by this patch**:
Flags: needinfo?(sgiesecke)
[Attachment #9098748](/attachment.cgi?id=9098748&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard") -
Flags: approval-mozilla-esr68?

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1577107#c23)• 5 years ago |
|  | |

Comment on [attachment 9098749](/attachment.cgi?id=9098749 "Bug 1577107 - Avoid following the prototype chain r=lizzard") [[details]](/attachment.cgi?id=9098749&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard")

[Bug 1577107](/show_bug.cgi?id=1577107 "VERIFIED FIXED - Use After Free in IndexedDB") - Avoid following the prototype chain r=lizzard

### Beta/Release Uplift Approval Request

* **User impact if declined**: Unlikely to cause regressions; a similar fix was already applied elsewhere & backporting from 71 was straightforward.
* **Is this code covered by automated tests?**: Unknown
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Unlikely to cause regressions; a similar fix was already applied elsewhere & backporting from 71 was straightforward.
* **String changes made/needed**:
[Attachment #9098749](/attachment.cgi?id=9098749&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard") -
Flags: approval-mozilla-beta?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1577107#c24)• 5 years ago |
|  | |

Comment on [attachment 9098748](/attachment.cgi?id=9098748 "Bug 1577107 - Avoid following the prototype chain r=lizzard") [[details]](/attachment.cgi?id=9098748&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard")

[Bug 1577107](/show_bug.cgi?id=1577107 "VERIFIED FIXED - Use After Free in IndexedDB") - Avoid following the prototype chain r=lizzard

Fix for sec-high issue, OK for uplift for esr

[Attachment #9098748](/attachment.cgi?id=9098748&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1577107#c25)• 5 years ago |
|  | |

Comment on [attachment 9098749](/attachment.cgi?id=9098749 "Bug 1577107 - Avoid following the prototype chain r=lizzard") [[details]](/attachment.cgi?id=9098749&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard")

[Bug 1577107](/show_bug.cgi?id=1577107 "VERIFIED FIXED - Use After Free in IndexedDB") - Avoid following the prototype chain r=lizzard

OK for beta 13.

[Attachment #9098749](/attachment.cgi?id=9098749&action=edit "Bug 1577107 - Avoid following the prototype chain r=lizzard") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1577107#c26)• 5 years ago |
|  | |

Checkin needed for patches into beta and esr68

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1577107#c27)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/e23bdede4881>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1577107#c28)• 5 years ago |
| uplift | |

It's not necessary to set `checkin-needed` for uplifts, code sheriffs have queries to find bugs with patches approved for those branches and where the bug status is not equivalent to `fixed`.

<https://hg.mozilla.org/releases/mozilla-beta/rev/1fcbe302034f>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3476344_258347)• 5 years ago |

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1577107#c29)• 5 years ago |
| backout | |

Backed out from ESR68 for bustage.

<https://hg.mozilla.org/releases/mozilla-esr68/rev/70802ae403a2c5c47bb44633742e96029de9cee0>

<https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=270062118&repo=mozilla-esr68&lineNumber=23023>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)Flags: needinfo?(sgiesecke)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1577107#c30)• 5 years ago |
|  | |

Also backed out from beta for build bustage in dom/indexedDB/IDBObjectStore.cpp:

<https://hg.mozilla.org/releases/mozilla-beta/rev/932c858be1c00881b81c258df8e61c6176eea8c3>

Push with failures: <https://treeherder.mozilla.org/#/jobs?repo=mozilla-beta&group_state=expanded&selectedJob=270062813&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel%2Cretry%2Csuperseded&revision=5a6c32dc7d49ef8922c414470f05525c59e7a649>

Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=270062813&repo=mozilla-beta>

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1577107#c31)• 5 years ago |
|  | |

AFAICT both branches need s/aRv->Throw/aRv.Throw/ in a couple of places to account for the 71-only <https://hg.mozilla.org/mozilla-central/rev/83c0ae8b929be92758f591016e4f0a97a4f4307d>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1577107#c32)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/34ec5064e263>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/4bf60541a4852a1eb212c4c6522f747a776b1448>

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1577107#c33)• 5 years ago |
|  | |

I fixed the issue. While I have not been able to build esr68 locally due to some toolchain issues, I built and successfully ran the IndexedDB tests for beta. Sorry for not checking this before.

Flags: needinfo?(sgiesecke)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3489536_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3546156_458188)• 5 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3562552_553429)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1577107#c34)• 5 years ago |
|  | |

I have reproduced a tab crash by opening the test page in [comment 0](/show_bug.cgi?id=1577107#c0 "VERIFIED FIXED - Use After Free in IndexedDB"):

<https://bugzilla.mozilla.org/attachment.cgi?id=9088647>

Reproduced on Nightly v71.0a1 (2019-09-29) (64-bit) asan debug build.

Logs:

"

[12380, Main Thread] WARNING: dependent window created without a parent: file z:/build/build/src/toolkit/components/startup/nsAppStartup.cpp, line 631

++DOCSHELL 0000123BF85BB080 == 1 [pid = 12380] [id = {bd4aa018-f4ca-4269-8110-5df9a1b9bef7}]

++DOMWINDOW == 1 (00001233F84BEB00) [pid = 12380] [serial = 1] [outer = 0000000000000000]

++DOMWINDOW == 2 (0000123BF85BBA80) [pid = 12380] [serial = 2] [outer = 00001233F84BEB00]

[12380, Main Thread] WARNING: NS\_ENSURE\_TRUE(root) failed: file z:/build/build/src/layout/base/nsDocumentViewer.cpp, line 3168

++DOCSHELL 0000123BF884FF80 == 2 [pid = 12380] [id = {dc219f95-cccb-4d45-b656-b5ee05ac0e10}]

++DOMWINDOW == 3 (00001233F8773F80) [pid = 12380] [serial = 3] [outer = 0000000000000000]

++DOMWINDOW == 4 (0000123BF8850480) [pid = 12380] [serial = 4] [outer = 00001233F8773F80]

[12380, Main Thread] WARNING: NS\_ENSURE\_TRUE(root) failed: file z:/build/build/src/layout/base/nsDocumentViewer.cpp, line 3168

[12380, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/extensions/spellcheck/src/mozPersonalDictionary.cpp, line 208

[12380, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[12380, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

--DOCSHELL 0000123BF884FF80 == 1 [pid = 12380] [id = {dc219f95-cccb-4d45-b656-b5ee05ac0e10}] [url = chrome://mozapps/content/profile/createProfileWizard.xul]

--DOCSHELL 0000123BF85BB080 == 0 [pid = 12380] [id = {bd4aa018-f4ca-4269-8110-5df9a1b9bef7}] [url = chrome://mozapps/content/profile/profileSelection.xul]

--DOMWINDOW == 3 (0000123BF8850480) [pid = 12380] [serial = 4] [outer = 0000000000000000] [url = about:blank]

--DOMWINDOW == 2 (0000123BF85BBA80) [pid = 12380] [serial = 2] [outer = 0000000000000000] [url = about:blank]

--DOMWINDOW == 1 (00001233F84BEB00) [pid = 12380] [serial = 1] [outer = 0000000000000000] [url = chrome://mozapps/content/profile/profileSelection.xul]

--DOMWINDOW == 0 (00001233F8773F80) [pid = 12380] [serial = 3] [outer = 0000000000000000] [url = chrome://mozapps/content/profile/createProfileWizard.xul]

[13428, Main Thread] WARNING: Cannot lock remote start mutex: file z:/build/build/src/toolkit/components/remote/nsRemoteService.cpp, line 74

[13428, Main Thread] WARNING: CheckLinkStatus called on main thread! No check performed. Assuming link is up, status is unknown.: file z:/build/build/src/netwerk/system/win32/nsNotifyAddrListener.cpp, line 662

[13428, Main Thread] WARNING: Workers don't support the 'mem.mem.' preference!: file z:/build/build/src/dom/workers/RuntimeService.cpp, line 544

[12380, Main Thread] WARNING: XPCOM objects created/destroyed from static ctor/dtor: file z:/build/build/src/xpcom/base/nsTraceRefcnt.cpp, line 198

nsStringStats

=> mAllocCount: 30678

=> mReallocCount: 0

=> mFreeCount: 30677 -- LEAKED 1 !!!

=> mShareCount: 40519

=> mAdoptCount: 293

=> mAdoptFreeCount: 293

=> Process ID: 12380, Thread ID: 8044

1570543868012 addons.webextension.screenshots@mozilla.org WARN Loading extension 'screenshots@mozilla.org': Reading manifest: Invalid extension permission: mozillaAddons

1570543868022 addons.webextension.screenshots@mozilla.org WARN Loading extension 'screenshots@mozilla.org': Reading manifest: Invalid extension permission: telemetry

1570543868032 addons.webextension.screenshots@mozilla.org WARN Loading extension 'screenshots@mozilla.org': Reading manifest: Invalid extension permission: resource://pdf.js/

1570543868042 addons.webextension.screenshots@mozilla.org WARN Loading extension 'screenshots@mozilla.org': Reading manifest: Invalid extension permission: about:reader\*

[13428, GMPThread] WARNING: Failed to delete GMP storage directory: file z:/build/build/src/dom/media/gmp/GMPServiceParent.cpp, line 1573

++DOCSHELL 000012233E20F380 == 1 [pid = 13428] [id = {7fc05208-c83e-47f7-b92c-9d99debb13ed}]

++DOMWINDOW == 1 (0000121B3E0C8A80) [pid = 13428] [serial = 1] [outer = 0000000000000000]

++DOMWINDOW == 2 (000012233E230580) [pid = 13428] [serial = 2] [outer = 0000121B3E0C8A80]

[13428, Main Thread] WARNING: Unable to read system value: 'aValue > 0', file z:/build/build/src/xpcom/base/nsSystemInfo.cpp, line 1011

[13428, Main Thread] WARNING: 'mIndex >= Count()', file z:/build/build/src/xpcom/ds/nsStringEnumerator.cpp, line 202

++DOCSHELL 000012233E514580 == 2 [pid = 13428] [id = {8cec69a3-91da-4200-a6f2-04ca28f5a499}]

++DOMWINDOW == 3 (0000121B3E16B000) [pid = 13428] [serial = 3] [outer = 0000000000000000]

++DOMWINDOW == 4 (000012233E514F80) [pid = 13428] [serial = 4] [outer = 0000121B3E16B000]

[13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80520012: file z:/build/build/src/toolkit/profile/nsProfileLock.cpp, line 579

++DOCSHELL 000012233E6B4E80 == 3 [pid = 13428] [id = {bf3c61d7-dd2e-4088-90aa-caf9cc41fd71}]

++DOMWINDOW == 5 (0000121B3E2B4D80) [pid = 13428] [serial = 5] [outer = 0000000000000000]

++DOCSHELL 000012233E6C9880 == 4 [pid = 13428] [id = {b27d6a98-14d6-4de0-ac13-7364cd2ef0a7}]

++DOMWINDOW == 6 (0000121B3E2D9180) [pid = 13428] [serial = 6] [outer = 0000000000000000]

++DOCSHELL 000012233E7D2D80 == 5 [pid = 13428] [id = {960eee2a-eba5-45e4-b658-933d902d8d14}]

++DOMWINDOW == 7 (0000121B3E33F700) [pid = 13428] [serial = 7] [outer = 0000000000000000]

++DOMWINDOW == 8 (000012233E7D3780) [pid = 13428] [serial = 8] [outer = 0000121B3E33F700]

++DOMWINDOW == 9 (000012233E811F80) [pid = 13428] [serial = 9] [outer = 0000121B3E33F700]

[Parent 13428, Main Thread] WARNING: Need BrowserChild to get the nativeWindow from!: file z:/build/build/src/widget/PuppetWidget.cpp, line 1090

[Parent 13428, Main Thread] WARNING: Need BrowserChild to get the nativeWindow from!: file z:/build/build/src/widget/PuppetWidget.cpp, line 1090

[Parent 13428, Main Thread] WARNING: Need BrowserChild to get the nativeWindow from!: file z:/build/build/src/widget/PuppetWidget.cpp, line 1090

[Parent 13428, Main Thread] WARNING: Need BrowserChild to get the nativeWindow from!: file z:/build/build/src/widget/PuppetWidget.cpp, line 1090

++DOMWINDOW == 10 (000012233E927780) [pid = 13428] [serial = 10] [outer = 0000121B3E2B4D80]

++DOMWINDOW == 11 (000012233E928680) [pid = 13428] [serial = 11] [outer = 0000121B3E2D9180]

++DOCSHELL 000012233E9A0180 == 6 [pid = 13428] [id = {f89aa666-2623-49d3-99e5-92c333c2bcda}]

++DOMWINDOW == 12 (0000121B3E57A880) [pid = 13428] [serial = 12] [outer = 0000000000000000]

++DOMWINDOW == 13 (000012233E9A0B80) [pid = 13428] [serial = 13] [outer = 0000121B3E57A880]

[Parent 13428, Main Thread] WARNING: This method is lossy. Use GetCanonicalPath !: file z:/build/build/src/xpcom/io/nsLocalFileWin.cpp, line 3201

[Parent 13428, Main Thread] WARNING: This method is lossy. Use GetCanonicalPath !: file z:/build/build/src/xpcom/io/nsLocalFileWin.cpp, line 3201

[Parent 13428, Main Thread] WARNING: This method is lossy. Use GetCanonicalPath !: file z:/build/build/src/xpcom/io/nsLocalFileWin.cpp, line 3201

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/netwerk/cache/nsCacheService.cpp, line 169

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/dom/base/ThirdPartyUtil.cpp, line 416

++DOMWINDOW == 14 (000012233EB2DE80) [pid = 13428] [serial = 14] [outer = 0000121B3E57A880]

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/dom/base/ThirdPartyUtil.cpp, line 416

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 232: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 502

[Parent 13428, Main Thread] WARNING: Failed to retarget HTML data delivery to the parser thread.: file z:/build/build/src/parser/html/nsHtml5StreamParser.cpp, line 1142

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Main Thread] WARNING: Failed to get base domain!: file z:/build/build/src/ipc/glue/BackgroundUtils.cpp, line 364

[Parent 13428, Main Thread] WARNING: Suboptimal indexes for the SQL statement 0x12153e0f7740 (<http://mzl.la/1FuID0j>).: file z:/build/build/src/storage/mozStoragePrivateHelpers.cpp, line 108

[Parent 13428, Main Thread] WARNING: '!workerClassifier', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 785

--DOCSHELL 000012233E20F380 == 5 [pid = 13428] [id = {7fc05208-c83e-47f7-b92c-9d99debb13ed}] [url = chrome://gfxsanity/content/sanityparent.html]

--DOMWINDOW == 13 (000012233E9A0B80) [pid = 13428] [serial = 13] [outer = 0000000000000000] [url = about:blank]

--DOMWINDOW == 12 (000012233E7D3780) [pid = 13428] [serial = 8] [outer = 0000000000000000] [url = about:blank]

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/netwerk/url-classifier/UrlClassifierCommon.cpp, line 298

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 693

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 314

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 555

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 773

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/netwerk/url-classifier/UrlClassifierCommon.cpp, line 298

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 693

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 314

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 555

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 773

[Parent 13428, Main Thread] ###!!! ASSERTION: Should be called only when this is the only edit action of the operation unless mutation event listener nests some operations: '!mPlaceholderBatch', file z:/build/build/src/editor/libeditor/TextEditor.cpp, line 893

[Parent 13428, Main Thread] ###!!! ASSERTION: Should be called only when this is the only edit action of the operation unless mutation event listener nests some operations: '!mPlaceholderBatch', file z:/build/build/src/editor/libeditor/TextEditor.cpp, line 893

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/netwerk/url-classifier/UrlClassifierCommon.cpp, line 298

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 693

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 314

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 555

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 773

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

[Parent 13428, Gecko\_IOThread] WARNING: pipe error: 109: file z:/build/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_win.cc, line 341

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

console.warn: LoginManager: "searchLogins: `formActionOrigin` or `httpRealm` is recommended"

[Parent 13428, QuotaManager IO] WARNING: '!outputStream', file z:/build/build/src/dom/quota/ActorsParent.cpp, line 2326

[Parent 13428, QuotaManager IO] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/dom/quota/ActorsParent.cpp, line 8138

[Parent 13428, QuotaManager IO] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/dom/quota/ActorsParent.cpp, line 7999

[Parent 13428, QuotaManager IO] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/dom/quota/ActorsParent.cpp, line 7909

[Parent 13428, Jump List] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80520012: file z:/build/build/src/widget/windows/WinUtils.cpp, line 1346

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file z:/build/build/src/netwerk/url-classifier/UrlClassifierCommon.cpp, line 298

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 693

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 314

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 555

[Parent 13428, Main Thread] WARNING: 'NS\_FAILED(rv)', file z:/build/build/src/netwerk/url-classifier/AsyncUrlChannelClassifier.cpp, line 773

[Parent 13428, Main Thread] WARNING: IPC message discarded: actor cannot send: file z:/build/build/src/ipc/glue/ProtocolUtils.cpp, line 481

[Parent 13428, Main Thread] WARNING: IPC message discarded: actor cannot send: file z:/build/build/src/ipc/glue/ProtocolUtils.cpp, line 481

[Parent 13428, Main Thread] WARNING: IPC message discarded: actor cannot send: file z:/build/build/src/ipc/glue/ProtocolUtils.cpp, line 481

++DOCSHELL 000012233F797B80 == 6 [pid = 13428] [id = {44fe383d-e2f6-4cdc-8424-132771b704d2}]

++DOMWINDOW == 13 (0000121B3FFDB300) [pid = 13428] [serial = 15] [outer = 0000000000000000]

++DOMWINDOW == 14 (000012233E1C7F80) [pid = 13428] [serial = 16] [outer = 0000121B3FFDB300]

[Parent 13428, Gecko\_IOThread] WARNING: file z:/build/build/src/ipc/chromium/src/base/process\_util\_win.cc, line 160

++DOMWINDOW == 15 (000012233E5ED380) [pid = 13428] [serial = 17] [outer = 0000121B3FFDB300]

--DOMWINDOW == 14 (000012233E1C7F80) [pid = 13428] [serial = 16] [outer = 0000000000000000] [url = about:blank]

++DOCSHELL 000012233F67A680 == 7 [pid = 13428] [id = {7d2c8e49-3bf2-45f8-8391-d1cdae9993e2}]

++DOMWINDOW == 15 (0000121B3EABA700) [pid = 13428] [serial = 18] [outer = 0000000000000000]

++DOMWINDOW == 16 (000012233F67BA80) [pid = 13428] [serial = 19] [outer = 0000121B3EABA700]

[Parent 13428, Main Thread] WARNING: NS\_ENSURE\_TRUE(root) failed: file z:/build/build/src/layout/base/nsDocumentViewer.cpp, line 3168

"

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1577107#c35)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1577107&comment_id=14411554 "1 revision") |
|  | |

Attached file
[verification logs](attachment.cgi?id=9099582)
— [Details](attachment.cgi?id=9099582&action=edit)

I have verified the fix in Nightly v71.0a1 (2019-10-08) (64-bit) by the same method (opening the test page in [comment 0](/show_bug.cgi?id=1577107#c0 "VERIFIED FIXED - Use After Free in IndexedDB") and clicking the "Click Me" button. Verification was performed on Windows 10 x64.

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3565885_616104)• 5 years ago |

[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=verified)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1577107#c36)• 5 years ago |
|  | |

Furthermore, I have reproduced the crash on Beta v70.0b12 and verified the fix in Beta v70.0b13 build ID: 20191007220302.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1577107#c37)• 5 years ago |
|  | |

I have reproduced the crash in ESR v68.1.0esr and Verified the fix on ESR.2.0esr build ID: 20191007162922, taken from here:

<https://tools.taskcluster.net/index/gecko.v2.mozilla-esr68.pushdate.2019.10.07.20191007162922.firefox/win32-opt>

I deem this bug verified.

Status: RESOLVED → VERIFIED
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3567635_616104)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3759908_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main70+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a3785545_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main70+] → [reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1577107#c38)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9100571)
— [Details](attachment.cgi?id=9100571&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a4700574_578488)• 5 years ago |

Alias: CVE-2019-11757

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a24362778_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577107#a150109375_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1577107&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [zhanjiasong45](/user_profile?user_id=615701)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250121_031530.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_8922780a_20250121_010631.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-34

## Security vulnerabilities fixed in - Firefox 70

Announced
October 22, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 70

**Note:** We have updated this advisory on June 26, 2020 to include CVE-2020-12412 and on March 20, 2023 to include CVE-2019-25136, which were fixed in Firefox 70 but not recognized or acknowledged immediately.

#### [#CVE-2018-6156: Heap buffer overflow in FEC processing in WebRTC](#CVE-2018-6156)

Reporter
Google Project Zero
Impact
high
##### Description

Incorrect derivation of a packet length in WebRTC caused heap corruption via a crafted video file. This resulted in a potentially exploitable crash.

##### References

* [Bug 1480088](https://bugzilla.mozilla.org/show_bug.cgi?id=1480088)

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When storing a value in IndexedDB, the value's prototype chain is followed and it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-25136: Invalid styles allowed from content processes](#CVE-2019-25136)

Reporter
Emilio Cobos Álvarez
Impact
high
##### Description

A compromised child process could have injected XBL Bindings into privileged CSS rules, resulting in arbitrary code execution and a sandbox escape.

##### References

* [Bug 1530709](https://bugzilla.mozilla.org/show_bug.cgi?id=1530709)

#### [#CVE-2020-12412: Address bar spoof using history navigation and blocked ports](#CVE-2020-12412)

Reporter
Adrian Karolak from ING Tech Poland
Impact
moderate
##### Description

By navigating a tab using the history API, an attacker could cause the address bar to display the incorrect domain (with the https:// scheme, a blocked port number such as '1', and without a lock icon) while controlling the page contents.

##### References

* [Bug 1528587](https://bugzilla.mozilla.org/show_bug.cgi?id=1528587)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters, enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11765: Incorrect permissions could be granted to a website](#CVE-2019-11765)

Reporter
Paul Theriault
Impact
moderate
##### Description

A compromised content process could send a message to the parent process that would cause the 'Click to Play' permission prompt to be shown. However, due to lack of validation from the parent process, if the user accepted the permission request an attacker-controlled permission would be granted rather than the 'Click to Play' permission.

##### References

* [Bug 1562582](https://bugzilla.mozilla.org/show_bug.cgi?id=1562582)

#### [#CVE-2019-17000: CSP bypass using object tag with data: URI](#CVE-2019-17000)

Reporter
Yangzheng Li
Impact
moderate
##### Description

An object tag with a data URI did not correctly inherit the document's Content Security Policy. This allowed a CSP bypass in a cross-origin frame if the document's policy explicitly allowed `data:` URIs.

##### References

* [Bug 1441468](https://bugzilla.mozilla.org/show_bug.cgi?id=1441468)

#### [#CVE-2019-17001: CSP bypass using object tag when script-src 'none' is specified](#CVE-2019-17001)

Reporter
Matheus Vrech
Impact
moderate
##### Description

A Content-Security-Policy that blocks in-line scripts could be bypassed using an object tag to execute JavaScript in the protected document (cross-site scripting). This is a separate bypass from CVE-2019-17000.
*Note: This flaw only affected Firefox 69 and was not present in earlier versions.*

##### References

* [Bug 1587976](https://bugzilla.mozilla.org/show_bug.cgi?id=1587976)

#### [#CVE-2019-17002: upgrade-insecure-requests was not being honored for links dragged and dropped](#CVE-2019-17002)

Reporter
Kevin Brosnan
Impact
low
##### Description

If `upgrade-insecure-requests` was specified in the Content Security Policy, and a link was dragged and dropped from that page, the link was not upgraded to https.

##### References

* [Bug 1561056](https://bugzilla.mozilla.org/show_bug.cgi?id=1561056)

#### [#CVE-2019-11764: Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250121_031530.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_4b2a2d61_20250121_010631.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1530709)
* [XML](/show_bug.cgi?ctype=xml&id=1530709)

Closed
[Bug 1530709](/show_bug.cgi?id=1530709)
(CVE-2019-25136)

Opened 6 years ago
Closed 5 years ago

# Use CSSOM to insert rules in SelectParentHelper.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Use CSSOM to insert rules in SelectParentHelper.

## Categories

### (Core :: Layout: Form Controls, enhancement, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout%3A%20Form%20Controls#Layout%3A%20Form%20Controls)

Layout: Form Controls
▾

Core :: Layout: Form Controls

Issues with the layout and appearance of HTML form controls, such as buttons, date/time pickers, select elements, and textareas.

Example bugs:

* datepicker remains visible after tabbing out of date input field
* the filename field of <input type=file> renders incorrectly in vertical writing mode with dir=rtl

Specifications covered:

* HTML (§ Forms)

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Form%20Controls&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Form%20Controls&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout%3A%20Form%20Controls)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

enhancement

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla71

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox69 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) |
| firefox71 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox69 |  | wontfix |
| firefox70 |  | fixed |
| firefox71 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: emilio, Assigned: freddy, Mentored)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1375476](/show_bug.cgi?id=1375476 "VERIFIED FIXED - [e10s] Properly style <option> elements in the parent process UI (support CSS on Select Options)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[semmle-analysis](/show_bug.cgi?id=1458117 "RESOLVED FIXED - [Meta] tracking for bugs found with Semmle")

Dependency [tree](/showdependencytree.cgi?id=1530709&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1530709)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, csectype-sandbox-escape, sec-high, Whiteboard: [post-critsmash-triage][adv-main70+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-25136

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main70+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a18650038_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio](/attachment.cgi?id=9089019)  [5 years ago](#c1)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c12 "5 years ago") | [Details](/attachment.cgi?id=9089019&action=edit) | [Review](/attachment.cgi?id=9089019) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1530709#c0)• 6 years ago |
|  | |

It would avoid CSS surprises in IPC messages from a potentially compromised content process.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a895_546716)• 6 years ago |

Mentor: emilioPriority: -- → P3

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1530709#c1)• 5 years ago |
|  | |

Attached file
[Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio](attachment.cgi?id=9089019)
— [Details](attachment.cgi?id=9089019&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1530709#c2)• 5 years ago |
|  | |

Turns out there's another flow from child->parent for the `insertRule` call in `populateChildren` (currently at line 435).

Blocks: [semmle-analysis](/show_bug.cgi?id=1458117 "RESOLVED FIXED - [Meta] tracking for bugs found with Semmle")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1530709#c3)• 5 years ago |
|  | |

checkin-needed assuming this is going to be green like its predecessors :)

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=7cddf2c44ba44ece99e8e241d511c5b1fecfb289>

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1530709#c4)• 5 years ago |
|  | |

Pushed by rmaries@mozilla.com:

<https://hg.mozilla.org/integration/autoland/rev/1b54dc70e042>

Restrict styles to known selectors and single rules per message r=emilio

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Arthur Iakab [arthur\_iakab]](/user_profile?user_id=600605) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1530709#c5)• 5 years ago |
|  | |

Backed out changeset 1b54dc70e042 ([bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.")) for causing browser-chrome failures on browser\_selectpopup\_colors.js CLOSED TREE

Backout revision <https://hg.mozilla.org/integration/autoland/rev/86eb37e35690fc467ec6a583e7b9681418a14260>

Failed push <https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedJob=264770622&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunning%2Cpending%2Crunnable&revision=1b54dc70e04270f601ab01861a15e8836cc57926&searchStr=bc>

Failure logs <https://treeherder.mozilla.org/logviewer.html#?job_id=264770622&repo=autoland>

<https://treeherder.mozilla.org/logviewer.html#?job_id=264778744&repo=autoland>

Frederik can you please take a look?

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1530709#c6)• 5 years ago |
|  | |

One of the failures is probably due to background-image being left out of SUPPORTED\_PROPERTIES, when it might in fact be required due to the manual override in <https://searchfox.org/mozilla-central/rev/e5327b05c822cdac24e233afa37d72c0552dbbaf/toolkit/actors/SelectParent.jsm#104>

However, this can't be fixed by just allowing background-image, as the `color` value might break out of the linear-gradient() function and start a new url() thing. I'll have to think some more on how to fix this.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1530709#c7)• 5 years ago |
|  | |

OK, so I think this needs to go through a parser to be actually safe from escaping. I tried writing into `cssRules[0]["background-color"]` and then reading out of it again, to get some meaningful color back, but that actually just returns whatever has been written in. Nothing we can use safely within `linear-gradient()`.

If I had a dummy HTML element, I could assign to `dummy.style.color` and read out of it again. - That does work.

I fear it could be too costly to do so, so maybe you can think of a smarter thing emilio? I also see you have a lot of pending needinfos. Feel free to redirect me!

Flags: needinfo?(fbraun) → needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1530709#c8)• 5 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #7](/show_bug.cgi?id=1530709#c7 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper."))

> OK, so I think this needs to go through a parser to be actually safe from escaping. I tried writing into `cssRules[0]["background-color"]` and then reading out of it again, to get some meaningful color back, but that actually just returns whatever has been written in. Nothing we can use safely within `linear-gradient()`.

That is an oversight. `cssRules[0]["background-color"]` is not the right thing to set. That's just setting a random property in the object, which is why it's not doing the right thing.

You need to use `cssRules[0].style["background-color"]`, which will do what you want.

Flags: needinfo?(emilio)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17205973_428608)• 5 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1530709#c9)• 5 years ago |
|  | |

Pushed by csabou@mozilla.com:

<https://hg.mozilla.org/integration/autoland/rev/15163b51d8f1>

Restrict styles to known selectors and single rules per message r=emilio

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Narcis Beleuzu [:NarcisB]](/user_profile?user_id=600627) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1530709#c10)• 5 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/15163b51d8f1>

Status: NEW → RESOLVEDClosed: 5 years ago
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla71

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17270100_575867)• 5 years ago |

Assignee: nobody → fbraun

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1530709#c11)• 5 years ago |
|  | |

Comment on [attachment 9089019](/attachment.cgi?id=9089019 "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") [[details]](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio")

[Bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.") - Restrict styles to known selectors and single rules per message r=emilio

### Beta/Release Uplift Approval Request

* **User impact if declined**: risk of styling bugs in the browser chrome (parent process)
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: fix uses a different (safer) API. Functionality & logic is the same. The tests confirm it's working.
* **String changes made/needed**: None
[Attachment #9089019](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") -
Flags: approval-mozilla-beta?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17423603_428608)• 5 years ago |

Group: core-securityKeywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17430340_159069)• 5 years ago |

Group: core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17536106_75935)• 5 years ago |

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=unaffected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1530709#c12)• 5 years ago |
|  | |

Comment on [attachment 9089019](/attachment.cgi?id=9089019 "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") [[details]](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio")

[Bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.") - Restrict styles to known selectors and single rules per message r=emilio

Fixes a CSS bug which can potentially lead to incorrect styling in the parent process. Approved for 70.0b8.

[Attachment #9089019](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1530709#c13)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/c97e152648be55d4daef8239bafa288aeb797f0e>

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a18650028_458188)• 5 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a18650038_458188)• 5 years ago |

Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a19543786_578488)• 5 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main70+][adv-main70-rollup]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a20648021_578488)• 5 years ago |

Whiteboard: [post-critsmash-triage][adv-main70+][adv-main70-rollup] → [post-critsmash-triage][adv-main70+][adv-main70+r]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a40145057_1689)• 5 years ago |

Group: core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1530709#c14)• 2 years ago |
|  | |

Turns out this was an exploitable vulnerability that was used in the wild. Details are available here: <https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/>

Alias: CVE-2019-25136Whiteboard: [post-critsmash-triage][adv-main70+][adv-main70+r] → [post-critsmash-triage][adv-main70+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1530709#c15)• 2 years ago |
|  | |

Also, because we know this was a sandbox escape, I'm retroactively bumping it to sec-high

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a128153246_1689)• 2 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1530709#c16)• 2 years ago |
|  | |

We never established a "regressor" because this was more of a hardening effort than a vulnerability fix when it started. Without knowing the regressor, marking old versions as "unaffected" was premature. If we had known then what we know now we would have pushed to take it on the ESR, but at the time it was not filed as a severe vulnerability and ESR patching is conservative.

According to [analysis from the Google TAG](https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/) (see the "Heliconia Files" section) this was exploited in versions Fx64-Fx68 at least.

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=unaffected) → [?](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=%3F)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a128157984_75935)• 2 years ago |

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
You need to [log in](/show_bug.cgi?id=1530709&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frederik Braun [:freddy]](/user_profile?user_id=428608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from blog.google_05a859c9_20250121_031531.html ===


[{"model": "blogsurvey.survey", "pk": 5, "fields": {"name": "Sentiment Change - All Articles - Nov 2024", "survey\_id": "sentiment-change-all-articles-nov-2024\_241031", "scroll\_depth\_trigger": 75, "previous\_survey": null, "display\_rate": 50, "thank\_message": "Thank you!", "thank\_emoji": "✅", "questions": "[{\"id\": \"c32a4772-5575-4985-814a-afd8d15d5d6d\", \"type\": \"simple\_question\", \"value\": {\"question\": \"After reading this article, how has your perception of Google changed?\", \"responses\": [{\"id\": \"cb111cda-60ba-4ac5-8260-17c5326e485b\", \"type\": \"item\", \"value\": \"Gotten better\"}, {\"id\": \"d8864abb-689a-4b52-b021-449af0b0a7c6\", \"type\": \"item\", \"value\": \"Gotten worse\"}, {\"id\": \"f169d98d-1731-4efc-be90-3cd379a2a63e\", \"type\": \"item\", \"value\": \"Stayed the same\"}, {\"id\": \"701d8c63-affe-4f44-85f0-71538a310d65\", \"type\": \"item\", \"value\": \"Don't know\"}]}}]", "target\_article\_pages": true}}]

[Updates from Threat Analysis Group (TAG)](https://blog.google/threat-analysis-group)

New details on commercial spyware vendor Variston

Share
[Twitter](https://twitter.com/intent/tweet?text=New%20details%20on%20commercial%20spyware%20vendor%20Variston%20%40google&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[Facebook](https://www.facebook.com/sharer/sharer.php?caption=New%20details%20on%20commercial%20spyware%20vendor%20Variston&u=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/&title=New%20details%20on%20commercial%20spyware%20vendor%20Variston)
Mail

Copy link

[Threat Analysis Group](https://blog.google/threat-analysis-group/)
# New details on commercial spyware vendor Variston

Nov 30, 2022

·

[[read-time]] min read

Share
[Twitter](https://twitter.com/intent/tweet?text=New%20details%20on%20commercial%20spyware%20vendor%20Variston%20%40google&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[Facebook](https://www.facebook.com/sharer/sharer.php?caption=New%20details%20on%20commercial%20spyware%20vendor%20Variston&u=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/&title=New%20details%20on%20commercial%20spyware%20vendor%20Variston)
Mail

Copy link

Heliconia exploitation frameworks capable of deploying spyware

Clement Lecigne
Threat Analysis Group

Benoit Sevens
Threat Analysis Group

Share
[Twitter](https://twitter.com/intent/tweet?text=New%20details%20on%20commercial%20spyware%20vendor%20Variston%20%40google&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[Facebook](https://www.facebook.com/sharer/sharer.php?caption=New%20details%20on%20commercial%20spyware%20vendor%20Variston&u=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/)
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/&title=New%20details%20on%20commercial%20spyware%20vendor%20Variston)
Mail

Copy link

---

---

Threat Analysis Group (TAG) has been tracking the activities of commercial spyware vendors for years, using our research to improve the safety and security of Google’s products and share intelligence with our industry peers. TAG’s research underscores that the commercial surveillance industry is thriving and has expanded significantly in recent years, creating risk for Internet users around the globe. Commercial spyware puts advanced surveillance capabilities in the hands of governments who use them to spy on journalists, human rights activists, political opposition and dissidents. Google and TAG are committed to disrupting these threats, protecting users, and raising awareness of the risks posed by the growing commercial spyware industry.

Continuing this work, today, we’re sharing findings on an exploitation framework with likely ties to Variston IT, a company in Barcelona, Spain that claims to be a provider of custom security solutions. Their Heliconia framework exploits n-day vulnerabilities in Chrome, Firefox and Microsoft Defender and provides all the tools necessary to deploy a payload to a target device. Google, Microsoft and Mozilla fixed the affected vulnerabilities in 2021 and early 2022. While we have not detected active exploitation, based on the research below, it appears likely these were utilized as zero-days in the wild. TAG has created detections in Safe Browsing to warn users when they attempt to navigate to dangerous sites or download dangerous files. To ensure full protection against Heliconia and other exploits, it’s essential to keep Chrome and other software fully up-to-date.

TAG became aware of the Heliconia framework when Google received an anonymous submission to the Chrome bug reporting program. The submitter filed three bugs, each with instructions and an archive that contained source code. They used unique names in the bug reports including, “Heliconia Noise,” “Heliconia Soft” and “Files.” TAG analyzed the submissions and found they contained frameworks for deploying exploits in the wild and a script in the source code included clues pointing to the possible developer of the exploitation frameworks, Variston IT.

The exploitation frameworks, listed below, included mature source code capable of deploying exploits for Chrome, Windows Defender and Firefox. Although the vulnerabilities are now patched, we assess it is likely the exploits were used as 0-days before they were fixed.

* **Heliconia Noise:** a web framework for deploying an exploit for a Chrome renderer bug followed by a sandbox escape
* **Heliconia Soft:** a web framework that deploys a PDF containing a Windows Defender exploit
* **Files:** a set of Firefox exploits for Linux and Windows.

Below, we share our findings on the exploitation frameworks and how they work. This analysis was done in collaboration with our colleagues, Ivan Fratric and Maddie Stone from Project Zero, and Stephen Röttger from the V8 Security Team.

### Heliconia Noise

Heliconia Noise is a web framework for deploying a Chrome renderer exploit, followed by a Chrome sandbox escape and agent installation. A manifest file in the source code provides a product description:

![image of a manifest file in source code](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Windows_10...Medium_Integrity.width-100.format-webp.webp)

The Chrome renderer exploit supports Chrome versions 90.0.4430.72 (April 2021) to 91.0.4472.106 (June 2021). It takes advantage of a V8 deoptimizer bug [fixed](https://bugs.chromium.org/p/chromium/issues/detail?id=1228036) in August 2021. As is currently normal for internally found Chrome bugs, no CVE was assigned.

The source code contains references to a sandbox escape called chrome-sbx-gen. This component was maintained in a separate Git submodule, and was not present in the obtained source code.

To obfuscate the JavaScript code, the framework uses minobf, likely a custom tool that was also not included in the source code.

Heliconia Noise includes a pre-commit cleaning script that leaks the name of the company that likely develops this project, Variston IT. The script, shown below, checks that binaries produced by the framework do not contain sensitive strings such as “Variston,” developer aliases or server names. Variston Information Technology is a small company based in Barcelona that describes itself as offering “tailor made Information Security Solutions.”

Pre-commit cleaning script commented with "project name," "developer names," and "company name."

![image of code](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/6DG5bkHnJTZxuWX.width-100.format-webp.webp)

Heliconia Noise is configurable using a JSON file that enables customers to set various parameters, including:

* attackExecution: maximum number of times to serve the exploit
* expiration: server does not work after this date
* redirectUrl: redirect URL in case of a failed exploit or disallowed visitor
* targetValidator: custom rules specifying when visitors are considered valid targets
* dnsMirrors: mirrors where the iframe is fetched from

The framework runs a Flask web server to host the exploit chain. A full infection performs requests to six different web endpoints during the different stages of the exploit chain:

**Stage 1: Remote code execution (RCE)**

* index.py: the landing page
* iframe.py: the iframe that runs the RCE exploit
* wasm.py: a dummy WebAssembly (Wasm) module

**Stage 2: Sandbox escape**

* sbx.py: the sandbox escape shellcode

**Stage 3: Post-exploitation**

* launcher.py: the agent launcher
* agent.py: the agent

The file names for each endpoint are randomized during server deployment, except for the first endpoint, which is served by a URL specified in the configuration file.

The framework allows setting parameters to validate visitors of the web server. Customers can configure target validations based on user agent, client country, client IP, and a client identifier used to track individual visitors. If any of the validation checks fail, the user is redirected to the preconfigured redirect URL.

### Heliconia Noise Infection Chain

**Stage 1: Remote code execution**

The infection chain starts with a client visiting the landing page URL defined in the configuration file. If the validation checks succeed, the landing page is served and 2 cookies are set:

* A cookie with name wp\_blog and value 1 to detect and redirect recurring visitors.
* A “client identifier” cookie with:
  + A name that is randomly generated during server deployment and is constant for the entire deployment (referred to as cookie\_client\_identifier and formatted [A-Za-z]{16})
  + A value that is uniquely generated per visitor (referred to as cid and in [UUID format](https://en.wikipedia.org/wiki/Universally_unique_identifier#Format)).

The JavaScript in the landing page then creates an iframe for every mirror configured in the configuration file. The iframe URLs have the following format:

<url>/<iframe\_url>?<cookie\_client\_identifier>=<cid>

The <iframe\_url> string is a random path formatted [a-f0-9]{16}.

The main script communicates with the iframes through messages using the postMessage method.

The iframes in their turn launch web workers that run exploit code. Communication with the workers happens again through messages.

Once the exploit obtains an arbitrary read and write primitive, a dummy Wasm module is fetched as a method for creating a memory area with read-write-execute permissions. The URL format is similar to the iframe URL above.

The Wasm area is then overwritten with the stage 1 shellcode. This shellcode is executed via a call from JavaScript to the exported Wasm function hello().

The first time the stage 1 shellcode is called it resolves the address of chrome.dll, VirtualAlloc, NdrServerCall2 and the ntdll timestamp. It also allocates memory for the upcoming sandbox escape shellcode. The resulting information is returned to the JavaScript.

**Stage 2: Sandbox escape**

The JavaScript then fetches the sandbox escape shellcode from a URL with a format similar to the iframe and Wasm URL, but with 5 extra GET parameters which are used by the server to prepare the sandbox escape shellcode:

* address of VirtualAlloc function
* address of NdrServerCall2 function
* address of chrome.dll
* address of the allocated memory for the sandbox escape
* timestamp of ntdll

The fetched sandbox escape is written to the previously allocated memory. It is executed via a second call to the stage 1 shellcode, which now calls into the sandbox escape shellcode.

Since TAG did not have access to the chrome-sbx-gen module, we do not have specific details on how the sandbox escape works.

**Stage 3: Post-exploitation**

After a successful sandbox escape, the launcher is executed. The goal of the launcher is to launch the (final) agent. The launcher is served as a DLL that is prepended with a PE loader shellcode.

The launcher has its own configuration, which contains following fields of interest:

* URL to retrieve the agent
* Path on the system to store data
* If the agent should be dropped to disk
* Filename of the agent on disk

The configuration is stored as an RC4 encrypted tar archive in the binary. The launcher fetches and runs the agent, and based on the exit code of the agent, it can uninstall the agent, upgrade it, run it again or exit.

The agent\_simple provided in this archive is a dummy agent and it randomly selects the exit code. In a real deployment, we believe the customer using the framework may provide their own agent, or the agent may be part of a different project.

### Heliconia Soft

Heliconia Soft is a web framework that deploys a PDF containing a Windows Defender exploit. It exploits CVE-2021-42298, a bug in the JavaScript engine of Microsoft Defender Malware Protection that was fixed in November 2021. The manifest in the source code describes Heliconia Soft as:

![A description of Heliconia Soft in the manifest in the source code.](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Windows_Chrome...SYSTEM_integrity.width-100.format-webp.webp)

The exploit achieves SYSTEM privileges with a single vulnerability and the only action required by the user is to download a PDF, which triggers a scan by Windows Defender.

The Heliconia Soft framework sets up an infection chain with two endpoints on the web server:

* index.py: the weaponized PDF file
* agent.py: the agent

In the first stage, a PDF is served when a user visits the attack URL. The PDF contains some decoy content, plus JavaScript that contains the exploit. Like Heliconia Noise, it uses the custom JavaScript obfuscator minobf. The framework code performs checks to confirm that common exploit strings (“spray”, “leak”, “addr”, etc.) are not present in the obfuscated JavaScript. The framework inserts the PE loader shellcode and the launcher DLL as strings in the exploit JavaScript.

The PE loader is similar to the one described above for Heliconia Noise. The launcher also has the same functionality, with a few notable differences. The launcher tries to “defuse” the exploit PDF by replacing the JavaScript in the PDF with spaces, likely to protect the exploit code from forensics. Similar to Heliconia Noise, the launcher retrieves the agent from a configured URL, runs it and acts based on its exit code.

A dummy agent agent\_simple is provided in the archive. As with Heliconia Noise, we believe the framework is likely designed for the customer to replace the dummy agent with their own agent.

### Heliconia Files

The “Files” package contained a fully documented Firefox exploit chain for Windows and Linux. For remote code execution it exploits [CVE-2022-26485](https://www.mozilla.org/en-US/security/advisories/mfsa2022-09/#CVE-2022-26485), a use after free vulnerability in the XSLT processor that was reported in March 2022 as being exploited in the wild. TAG assesses that the Heliconia Files package likely exploited this RCE vulnerability since at least 2019, well before the bug was publicly known and patched. The Heliconia exploit is effective against Firefox versions 64 to 68, suggesting it may have been in use as early as December 2018 when version 64 was first released. Additionally, when Mozilla patched the vulnerability, the exploit code in their [bug report](https://bugzilla.mozilla.org/show_bug.cgi?id=1758062) shared striking similarities with the Heliconia exploit, including the same variable names and markers. These overlaps suggest the exploit author is the same for both the Heliconia exploit and the sample exploit code Mozilla shared when they patched the bug.

The sandbox escape is specific to the Windows version of Firefox and was [fixed](https://bugzilla.mozilla.org/show_bug.cgi?id=1530709) without a CVE in September 2019. The vulnerability abused the fact that user-controlled CSS values can be rendered inside the privileged content process using the Forms:ShowDropDown IPC. Code execution is achieved by injecting [XBL bindings](https://en.wikipedia.org/wiki/XBL) to resolve Windows APIs and call WinExec. The exploit code spawns a new calculator, and unlike the other Heliconia frameworks, does not include a launcher capability or dummy agent.

### Conclusion

TAG's research has shown the proliferation of commercial surveillance and the extent to which commercial spyware vendors have developed capabilities that were previously only available to governments with deep pockets and technical expertise. The growth of the spyware industry puts users at risk and makes the Internet less safe, and while surveillance technology may be legal under national or international laws, they are often used in harmful ways to conduct digital espionage against a range of groups. These abuses represent a serious risk to online safety which is why Google and TAG will continue to take action against, and publish research about, the commercial spyware industry.

POSTED IN:

* [Threat Analysis Group](https://blog.google/threat-analysis-group/%20)
* [Safety & Security](https://blog.google/technology/safety-security/%20)

### Related stories

* [![Gmail Holiday Scams](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Gmail_Holiday_Scams.max-1200x416.format-webp.webp)

  Gmail
  #### Email scams surge over the holiday — here’s how Gmail keeps you safe

  By
  Andy Wen

   Dec 18, 2024](https://blog.google/products/gmail/gmail-holidays-2024-spam-scam/)
* [Threat Analysis Group
  #### TAG Bulletin: Q4 2024

  This bulletin includes coordinated influence operation campaigns terminated on our platforms in Q4 2024. It was last updated on December 17, 2024.OctoberWe terminated 11…

  By
  Billy Leonard

   Dec 17, 2024](https://blog.google/threat-analysis-group/tag-bulletin-q4-2024/)
* [![Trust&Safety_Family Survey_Blog Header_R1](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/TrustSafety_Family_Survey_Blog.max-1200x416.format-webp.webp)

  Families
  #### 4 ways parents are keeping their children safer online

  By
  Amanda Storey

   Nov 25, 2024](https://blog.google/technology/families/4-ways-parents-are-keeping-their-children-safer-online/)
* [![Hero_3](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Hero_3_nPtRuS0.max-1200x416.format-webp.webp)

  Safety & Security
  #### A new way we’re helping others track frauds and scams online

  By
  Laurie Richardson

   Nov 14, 2024](https://blog.google/technology/safety-security/a-new-way-were-helping-others-track-frauds-and-scams-online/)
* [![Hero_1](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Hero_1_Jv3Ej8x.max-1200x416.format-webp.webp)

  Public Policy
  #### A safer internet: policy recommendations for fighting scams and fraud together

  By
  Markham Erickson

   Nov 14, 2024](https://blog.google/outreach-initiatives/public-policy/a-safer-internet-policy-recommendations-for-fighting-scams-and-fraud-together/)
* [![23263_BRS_SAIF Blog Header_Design_Opt-4](https://storage.googleapis.com/gweb-uniblog-publish-prod/images/23263_BRS_SAIF_Blog_Header_Des.max-1200x416.format-webp.webp)

  Safety & Security
  #### SAIF Risk Assessment: A new tool to help secure AI systems across industry

  By
  Heather Adkins

  &
  Phil Venables

   Oct 24, 2024](https://blog.google/technology/safety-security/google-ai-saif-risk-assessment/)
* .

* [Privacy](https://policies.google.com/privacy)
* [Terms](https://policies.google.com/terms)
* [About Google](https://about.google/)
* [Google Products](https://about.google/products/)

* [Help](https://support.google.com)
* Bahasa Indonesia (Indonesia)

  Deutsch

  English

  English (Africa)

  English (Australia)

  English (Canada)

  English (India)

  English (MENA)

  Español (España)

  Español (Latinoamérica)

  Français (Canada)

  Français (France)

  Italiano

  Nederlands (Nederland)

  Polski

  Português (Brasil)

  Türkçe (Türkiye)

  Česko (Čeština)

  اللغة العربية (MENA)

  中文 (台灣)

  日本語 (日本)

  한국어


