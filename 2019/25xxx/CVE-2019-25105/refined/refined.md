Based on the provided commit message, this commit addresses a reflected XSS vulnerability in `fileman.php`.

**Root cause of vulnerability:**
The vulnerability stems from the direct usage of user-supplied input (`$_GET['secret']`) within the HTML output without proper sanitization. Specifically, the `secret` parameter from the URL is directly embedded in the HTML output when the `secret` is not found in the database, leading to a reflected XSS vulnerability.

**Weaknesses/vulnerabilities present:**
- Reflected Cross-Site Scripting (XSS)
- Lack of proper sanitization of user-supplied input.

**Impact of exploitation:**
An attacker can inject malicious JavaScript code into the `secret` parameter. When a victim visits the crafted URL, the injected script will execute within the victim's browser, potentially leading to:
    - Session hijacking
    - Defacement of the website
    - Redirection to malicious websites
    - Stealing sensitive user information (though the commit message mentions a lack of cookies or local storage that could be exploited.)

**Attack vectors:**
- By crafting a malicious URL with the `secret` parameter containing JavaScript code.

**Required attacker capabilities/position:**
- The attacker needs to be able to craft a URL with a malicious `secret` parameter and entice a victim to click on it.
- No special privileges or access are needed; anyone can send a crafted URL.

The fix involves using `htmlspecialchars()` to sanitize the `secret` parameter before it's included in the HTML output, which prevents the execution of malicious scripts.
Additionally the database query was updated to also use `escape_string()`