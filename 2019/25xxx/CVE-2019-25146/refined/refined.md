## CVE-2019-25146

The provided texts describe a Stored Cross-Site Scripting (XSS) vulnerability in the DELUCKS SEO WordPress plugin, versions 2.1.7 and earlier.

**Root Cause:** The `saveSettings()` function in the plugin lacks proper input sanitization and output escaping. Additionally, there were no capability checks to restrict access to the settings page.

**Weaknesses/Vulnerabilities Present:**

*   Stored Cross-Site Scripting (XSS)
*   Missing capability checks
*   Lack of input sanitization
*   Lack of output escaping
*   Cross-Site Request Forgery (CSRF) due to missing nonce check

**Impact of Exploitation:**

*   Arbitrary JavaScript code execution in the victim's browser.
*   Cookie stealing, leading to account compromise.
*   Website defacement.
*   Redirection of users to malicious sites.

**Attack Vectors:**

*   An unauthenticated attacker can inject malicious JavaScript code into the plugin's settings via a crafted HTTP POST request to the `admin-post.php` endpoint.
*   The injected script is then stored in the WordPress database (`options > dpc_basic_metadata`) and reflected on all pages where the plugin's settings are displayed.

**Required Attacker Capabilities/Position:**

*   The attacker does not need to be authenticated.
*   The attacker needs to be able to send HTTP POST requests to the WordPress `admin-post.php` endpoint.

**Mitigation:**

*   Update to version 2.1.8 or later. The update includes a nonce check (`wp_nonce_field`) and capability checks to prevent unauthorized access to the settings page.