- **Root cause of vulnerability**: The `render_data_or_redirect` and `fallback_render` methods in `app/controllers/devise_token_auth/omniauth_callbacks_controller.rb` use untrusted input (specifically the `message` and `auth_origin_url` parameters) to build redirects and render error messages.
- **Weaknesses/vulnerabilities present**:
    - Reflected Cross-Site Scripting (XSS) via the `message` parameter.
    - Open Redirect via the `auth_origin_url` parameter.
- **Impact of exploitation**:
    - **XSS**: An unauthenticated attacker can craft a URL that, when visited by a user, executes malicious JavaScript in the user's browser. This could lead to session hijacking, data theft, or other malicious actions performed in the context of the victim's session.
    - **Open Redirect**: An unauthenticated attacker can craft a URL that redirects the user to a malicious site. This can be used for phishing attacks or to launch further attacks.
- **Attack vectors**: Crafted URLs with malicious payloads in the `message` and `auth_origin_url` parameters passed to the `/omniauth/failure` endpoint.
- **Required attacker capabilities/position**: The attacker needs to be able to craft URLs and trick users into clicking on them (or use other methods to get users to make a request to the crafted URL). The attacker does not need to be authenticated to exploit these vulnerabilities.