Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The primary vulnerability lies in the implementation of REST API authentication in the ptarmigan project. Specifically, the commit `37fd8f9` introduces an API token for authentication. The issue is not the introduction of the token itself but the fact that this token, by default, is set to the easily guessable value of "ptarmigan".

**Weaknesses/vulnerabilities present:**
- **Hardcoded default API Token:** The commit introduces a default API token value of `"ptarmigan"` in the `.env-sample` file, `ptarmapi/src/config/ptarmigan.ts`, and in the scripts (`addfinal.sh`, `htlcchanged.sh`). If the user doesn't change the default token, an attacker can easily authenticate and potentially access or manipulate the ptarmigan REST API.
- **Insufficient Security:** Relying on a single, easily guessed token for authentication is a major security flaw. 
- **Lack of Secure Token Generation:**  There is no mechanism for generating a unique or secure token.

**Impact of exploitation:**
- **Unauthorized access:** An attacker who knows or guesses the default API token (`ptarmigan`) can bypass the authentication and send requests to the REST API.
- **Data manipulation:** Depending on the API endpoints, the attacker could potentially manipulate data, trigger unwanted actions, or cause denial of service by sending malicious requests.

**Attack vectors:**
- **Network-based attack:** An attacker needs to be able to send HTTP requests to the ptarmigan API server.
- **Exploiting the default token:** An attacker exploits the knowledge of the default API token and uses it in the `Authorization` header of the HTTP requests.

**Required attacker capabilities/position:**
- **Network access:** The attacker needs to have network connectivity to the ptarmigan API server.
- **Knowledge of the default API token:** The attacker needs to know or guess the default API token, which, in this case, is easily predictable ("ptarmigan").

**Additional Details:**
- The changes in the provided commit also adds the  `passport-http-bearer` library and introduces the `AuthModule`, `AuthService`, and `HttpStrategy` to handle the authentication based on the API token. This is a normal and expected step to include API authentication, however, due to the easily guessable default token, it is not considered secure.
- The commit adds the API token to the `.env-sample` file and the config file, and updates the scripts (`addfinal.sh`, `htlcchanged.sh`) to include the `Authorization` header.
- The changes to `main.ts`  show that the apiToken is logged to the console as well, which might leak the token if logs are not protected.

In summary, the vulnerability stems from the insecure default API token, which allows unauthorized access to the ptarmigan API.