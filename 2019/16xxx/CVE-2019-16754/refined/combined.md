=== Content from github.com_26030b6f_20250120_232759.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F12293)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F12293)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  393](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# asymcute: Fix null pointer dereference #12293

 Merged

[miri64](/miri64)
merged 1 commit into
[RIOT-OS:master](/RIOT-OS/RIOT/tree/master "RIOT-OS/RIOT:master")
from
[nmeum:pr/asymcute\_nullptr\_dereference](/nmeum/RIOT/tree/pr/asymcute_nullptr_dereference "nmeum/RIOT:pr/asymcute_nullptr_dereference")

Sep 24, 2019

 Merged

# [asymcute: Fix null pointer dereference](#top) #12293

[miri64](/miri64)
merged 1 commit into
[RIOT-OS:master](/RIOT-OS/RIOT/tree/master "RIOT-OS/RIOT:master")
from
[nmeum:pr/asymcute\_nullptr\_dereference](/nmeum/RIOT/tree/pr/asymcute_nullptr_dereference "nmeum/RIOT:pr/asymcute_nullptr_dereference")

Sep 24, 2019

[Conversation
1](/RIOT-OS/RIOT/pull/12293)
[Commits
1](/RIOT-OS/RIOT/pull/12293/commits)
[Checks
0](/RIOT-OS/RIOT/pull/12293/checks)
[Files changed](/RIOT-OS/RIOT/pull/12293/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![nmeum](https://avatars.githubusercontent.com/u/2326560?s=60&v=4)](/nmeum)

Copy link

Member

### @nmeum **[nmeum](/nmeum)** commented [Sep 24, 2019](#issue-497586987) • edited Loading

### Contribution description

This PR fixes various null pointer dereferences in `asymcute`. All of

these are due to the assumption that `req->arg` is always non-NULL.

Since an attacker can spoof mqtt replies this is not neccessarly the

case.

This assumption is made at various places in the code. I only tested

this with `MQTTSN_SUBACK` messages (`_on_suback` function) but the same

issue should apply to any function accessing `req->arg` without checking

for `NULL`.

### Testing procedure

My tap setup is as follows:

```
4: tap0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 72:f3:e4:fd:13:9c brd ff:ff:ff:ff:ff:ff
    inet6 fe80::70f3:e4ff:fefd:139c/64 scope link
       valid_lft forever preferred_lft forever

```

On `native`:

```
$ make -C `examples/asymcute_mqttsn` all-valgrind
$ make -C `examples/asymcute_mqttsn` term-valgrind
main(): This is RIOT! (Version: UNKNOWN (builddir: /root/RIOT))
Asymcute MQTT-SN example application

Type 'help' to get started and have a look at the README.md for more information.
> connect myclient [fe80::70f3:e4ff:fefd:139c]:2342

```

Before the connect request timesout spoof a reply using:

```
printf CBMAAAIAAAA= | base64 -d | \
	busybox nc -p 2342 -u 'fe80::70f3:e4ff:fefd:139d%tap0' 49152

```

`49152` should be the default ephemeral port. The packet must have the

server address as source address and the server port as source port.

**Expected result:** The packet should be rejected.

**Actual result:** Segmentation fault + invalid read of size 4.

### Impact

The null pointer dereference should result in a crash on most

platforms. Thereby allowing a denial of service. The attacker must be

able to spoof a MQTT response which is easy as the ephemeral port is not

picked at random. Additionally, the attacker needs to know a pending

MQTT MsgId, however, those aren't picked at random either and there are

only `2^8` possible values.

Sorry, something went wrong.

All reactions

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&v=4)](/nmeum)

`[asymcute: don't make the assumption that req->arg is non-NULL](/RIOT-OS/RIOT/pull/12293/commits/30e4823e946949befe74ef94bc48fe43958c28a6 "asymcute: don't make the assumption that req->arg is non-NULL

This fixes a denial of service where an attacker would be able to cause
a NULL pointer dereference by sending a spoofed packet. This attack only
requires knowledge about pending message ids.")`
 …

`[30e4823](/RIOT-OS/RIOT/pull/12293/commits/30e4823e946949befe74ef94bc48fe43958c28a6)`

```
This fixes a denial of service where an attacker would be able to cause
a NULL pointer dereference by sending a spoofed packet. This attack only
requires knowledge about pending message ids.
```

 [![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
requested a review
from [haukepetersen](/haukepetersen)
[September 24, 2019 10:20](#event-2657499324)

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
added
[Area: network](/RIOT-OS/RIOT/labels/Area%3A%20network)
Area: Networking
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)
labels
[Sep 24, 2019](#event-2657499682)

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
modified the milestones:
[Release 2020.01](/RIOT-OS/RIOT/milestone/29),
[Release 2019.10](/RIOT-OS/RIOT/milestone/28)
[Sep 24, 2019](#event-2657499860)

[![@benpicco](https://avatars.githubusercontent.com/u/1301112?s=40&v=4)](/benpicco)
[benpicco](/benpicco)
added
the
[CI: ready for build](/RIOT-OS/RIOT/labels/CI%3A%20ready%20for%20build)
If set, CI server will compile all applications for all available boards for the labeled PR
label
[Sep 24, 2019](#event-2657702630)

[![miri64](https://avatars.githubusercontent.com/u/675644?s=60&v=4)](/miri64)

**[miri64](/miri64)**
approved these changes
[Sep 24, 2019](#pullrequestreview-292512599)

 [View reviewed changes](/RIOT-OS/RIOT/pull/12293/files/30e4823e946949befe74ef94bc48fe43958c28a6)

Copy link

Member

### @miri64 **[miri64](/miri64)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ACK. Tested as described. Checking if the values are NULL also makes sense to me.

Sorry, something went wrong.

All reactions

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
merged commit [`71680a6`](/RIOT-OS/RIOT/commit/71680a6265ac868787fbde2adc70e5cf41650332)
into
RIOT-OS:master

[Sep 24, 2019](https://github.com/RIOT-OS/RIOT/pull/12293#event-2658531703)

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)
[nmeum](/nmeum)
mentioned this pull request
[Jan 17, 2020](#ref-pullrequest-551566768)

[Add AFL-based fuzzing setup for network modules
#13157](/RIOT-OS/RIOT/pull/13157)
 Merged

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)
[nmeum](/nmeum)
mentioned this pull request
[Jan 31, 2020](#ref-pullrequest-558255481)

[gnrc\_sock\_udp: choose random ephemeral port
#13253](/RIOT-OS/RIOT/pull/13253)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F12293)

Reviewers

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&v=4)](/miri64) [miri64](/miri64)

miri64 approved these changes

[![@haukepetersen](https://avatars.githubusercontent.com/u/620834?s=40&v=4)](/haukepetersen) [haukepetersen](/haukepetersen)

 Awaiting requested review from haukepetersen

Assignees

No one assigned

Labels

[Area: network](/RIOT-OS/RIOT/labels/Area%3A%20network)
Area: Networking
[CI: ready for build](/RIOT-OS/RIOT/labels/CI%3A%20ready%20for%20build)
If set, CI server will compile all applications for all available boards for the labeled PR
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)

Projects

None yet

Milestone

 [**Release 2019.10**](/RIOT-OS/RIOT/milestone/28 "Release 2019.10")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=52&v=4)](/nmeum) [![@miri64](https://avatars.githubusercontent.com/u/675644?s=52&v=4)](/miri64) [![@benpicco](https://avatars.githubusercontent.com/u/1301112?s=52&v=4)](/benpicco)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


