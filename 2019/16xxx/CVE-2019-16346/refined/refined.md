The provided content relates to CVE-2019-16346.

**Root cause of vulnerability:**
The vulnerability is a heap-based buffer overflow in the `WritePixel` function of the `ngiflib` library. This occurs during the processing of interlaced GIF images. The issue stems from incorrect handling of the current Y-coordinate (`curY`) during deinterlacing, which leads to out-of-bounds writes to the allocated buffer.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflow in the `WritePixel` function.
- Out-of-bounds write due to incorrect `curY` calculation when processing interlaced GIF images.

**Impact of exploitation:**
- The heap-based buffer overflow can lead to arbitrary code execution, denial of service, or other unspecified impacts.

**Attack vectors:**
- The vulnerability can be triggered by processing a specially crafted interlaced GIF file. The attacker provides a malicious GIF file.

**Required attacker capabilities/position:**
- The attacker needs to be able to supply a malicious GIF file to a program using the vulnerable `ngiflib` library.

**Additional details:**
- The issue is located in `ngiflib.c` at line 123 in the `WritePixel` function and also affects `WritePixels` at line 249, during interlaced GIF decoding. The provided ASAN output highlights the overflow.
- The fix, introduced by commit `37d939a6f511d16d4c95678025c235fe62e6417a`, addresses the incorrect deinterlacing logic, specifically the handling of `curY`. The fix adjusts how `curY` is calculated and when the `pass` variable is incremented during the different interlacing passes.
- A Proof of Concept (POC) file, `poc13-WritePixel-heapoverflow` is mentioned, which can trigger the vulnerability.