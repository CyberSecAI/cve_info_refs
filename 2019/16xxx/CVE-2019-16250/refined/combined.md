=== Content from blog.nintechnet.com_6219c17a_20250121_001516.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Settings change and CSS injection in WordPress Ocean Extra plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [July 5, 2019 - 1:10am [+0700]December 15, 2019 - 10:08pm [+0700]](https://blog.nintechnet.com/settings-change-and-css-injection-in-wordpress-ocean-extra-plugin/)

*Last revision: July 18, 2019*

The popular WordPress [Ocean Extra plugin](https://wordpress.org/plugins/ocean-extra/), which has over 400,000 active installations, was prone to settings change and CSS injection vulnerabilities that could allow an unauthenticated attacker to modify some WordPress settings and inject CSS code in order to deface the blog.

The vulnerable code is located in the “includes/wizard/wizard.php” script.

```

add_action('admin_init', array($this, 'ocean_wizard_setup'), 99);

```

We have seen with the [zero-day vulnerability in WordPress Easy WP SMTP](https://blog.nintechnet.com/critical-0day-vulnerability-fixed-in-wordpress-easy-wp-smtp-plugin/) plugin a few weeks ago that the `admin_init` hook can be triggered by unauthenticated users as well (via the admin-ajax.php and admin-post.php scripts).

In Ocean Extra, it is used to call “ocean\_wizard\_setup”, located line 198:

```

public function ocean_wizard_setup() {
   if (empty($_GET['page']) || 'owp_setup' !== $_GET['page']) { // WPCS: CSRF ok, input var ok.
      return;
   }
   $default_steps = array(
      'welcome' => array(
         'name' => __('Welcome', 'ocean-extra'),
         'view' => array($this, 'ocean_welcome'),
      ),
      'demo' => array(
         'name' => __('Choosing Demo', 'ocean-extra'),
         'view' => array($this, 'ocean_demo_setup'),
      ),
      'customize' => array(
         'name' => __('Customize', 'ocean-extra'),
         'view' => array($this, 'ocean_customize_setup'),
       ),
       'ready' => array(
         'name' => __('Ready', 'ocean-extra'),
         'view' => array($this, 'ocean_ready_setup'),
       )
    );
    $this->steps = apply_filters('owp_setup_wizard_steps', $default_steps);
    $this->step = isset($_GET['step']) ? sanitize_key($_GET['step']) : current(array_keys($this->steps)); // WPCS: CSRF ok, input var ok.

```

This function checks if `$_GET['page']` is set and equal to ‘owp\_setup’. It checks the value of `$_GET['step']` as well, which can be ‘welcome’, ‘demo’, ‘customize’ or ‘ready’ and will call the matching function found in the `$default_steps` array.

‘customize’ will call the ‘ocean\_customize\_setup()’ function, located line 547:

```

/**
 * Step 3 customize step
 */
public function ocean_customize_setup() {

   if (isset($_POST['save_step']) && !empty($_POST['save_step'])) {
      $this->save_ocean_customize();
   }

```

The function checks if `$_POST['save_step']` is set and then calls ‘save\_ocean\_customize’ located line 713:

```

/**
 * Save Info In Step3
 */
public function save_ocean_customize() {
   if (isset($_POST['ocean-logo']))
      set_theme_mod('custom_logo', $_POST['ocean-logo']);

   if (isset($_POST['ocean-retina-logo']))
      set_theme_mod('ocean_retina_logo', $_POST['ocean-retina-logo']);

   if (isset($_POST['ocean-site-title']))
      update_option('blogname', $_POST['ocean-site-title']);

   if (isset($_POST['ocean-tagline']))
      update_option('blogdescription', $_POST['ocean-tagline']);

   if (isset($_POST['ocean-favicon']))
      update_option('site_icon', $_POST['ocean-favicon']);

   if (isset($_POST['ocean-primary-color']))
      set_theme_mod('ocean_primary_color', $_POST['ocean-primary-color']);

   if (isset($_POST['ocean-hover-primary-color']))
      set_theme_mod('ocean_hover_primary_color', $_POST['ocean-hover-primary-color']);

   if (isset($_POST['ocean-main-border-color']))
      set_theme_mod('ocean_main_border_color', $_POST['ocean-main-border-color']);

   if (isset($_POST['ocean-links-color']))
      set_theme_mod('ocean_links_color', $_POST['ocean-links-color']);

   if (isset($_POST['ocean-links-hover-color']))
      set_theme_mod('ocean_links_color_hover', $_POST['ocean-links-hover-color']);

   wp_safe_redirect($this->get_next_step_link());
   exit;
}

```

All functions lack capability check which means that an unauthenticated user can modify the three WordPress `blogname`, `blogdescription` and `site_icon` settings, and can also inject CSS code, including remote content such as external style sheets or remote images, into the blog pages and posts because the user input is not verified either. They also lack [security nonces](https://codex.wordpress.org/WordPress_Nonces) to protect against CSRF attacks.

Although it is not possible to inject HTML or PHP code because the CSS data will be passed on to the [wp\_strip\_all\_tags](https://codex.wordpress.org/Function_Reference/wp_strip_all_tags) function that will remove HTML and PHP tags when the page is loading, it is still extremely easy to deface a site: with a small 300-byte POST payload, one could turn 400,000+ blogs into this, for instance:

![](../wp-content/uploads/2019/07/wapuu.png)

A few other functions in the plugin also lack capability check, input sanitization and security nonces.

### Proof of Concept

```
$ curl 'http://example.org/wp-admin/admin-post.php?page=owp_setup&step=customize' --data 'ocean-site-title=My+Changed+Title&ocean-tagline=My+Changed+Description&ocean-links-hover-color=%238224e3;}body{background-image:url(https://wapu.us/wp-content/uploads/2019/02/wcb19_wapuu_@1x-540x612.png);background-repeat:no-repeat;background-position:100px}#primary{display:none}&save_step=save_step'
```
### Timeline

The vulnerability was discovered and reported to the wordpress.org team on July 3rd, 2019.

### Recommendations

Update as soon as possible if you have version 1.5.8 or below installed.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Settings%20change%20and%20CSS%20injection%20in%20WordPress%20Ocean%20Extra%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fsettings-change-and-css-injection-in-wordpress-ocean-extra-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fsettings-change-and-css-injection-in-wordpress-ocean-extra-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Settings%20change%20and%20CSS%20injection%20in%20WordPress%20Ocean%20Extra%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fsettings-change-and-css-injection-in-wordpress-ocean-extra-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Stored XSS and CSV injection vulnerabilities in WordPress Shortlinks by Pretty Links plugin.](https://blog.nintechnet.com/stored-xss-and-csv-injection-vulnerabilities-in-wordpress-shortlinks-by-pretty-links-plugin/)[Next Unauthenticated Stored XSS in WordPress Coming Soon Page and Maintenance Mode plugin.](https://blog.nintechnet.com/unauthenticated-stored-xss-in-wordpress-coming-soon-page-and-maintenance-mode-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


