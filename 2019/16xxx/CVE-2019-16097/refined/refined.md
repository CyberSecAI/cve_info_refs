### CVE-2019-16097
Based on the provided content, here's a breakdown of the vulnerability described:

**Root Cause:**
- The vulnerability lies in the `/api/users` endpoint of Harbor, specifically during user registration.
- The `POST` request to `/api/users` did not properly validate the `has_admin_role` parameter during user creation.

**Weaknesses/Vulnerabilities:**
- **Missing Authorization Check:** The API endpoint allowed any user, even a non-admin, to set the `has_admin_role` parameter to `true` when creating a new user.
- **Insecure Deserialization:** The code directly deserialized user data from the POST request, including the `has_admin_role` field, without proper sanitization or authorization checks.
- **Lack of Input Validation:** There was no validation to ensure that a non-admin user could not create an admin account.

**Impact of Exploitation:**
- **Privilege Escalation:** An unauthenticated attacker could create a new user with administrative privileges, effectively gaining full control over the Harbor registry.
- **Data Breach:** Attackers can download all private projects and inspect them.
- **Data Manipulation:** Attackers can delete all images in the registry or poison the registry by replacing its images with their own, potentially injecting malware, crypto miners, or other malicious content.
- **Account Compromise:** Attackers can create new admin accounts, further enabling persistent access and control.

**Attack Vectors:**
- **HTTP POST Request:** Attacker sends a malicious `POST` request to the `/api/users` endpoint with `has_admin_role` set to `true`.
- **Network Access:** Requires network access to the Harbor instance.

**Required Attacker Capabilities/Position:**
- **No authentication required:** The attacker does not need an existing account on the Harbor instance.
- **Network access:**  The attacker needs network access to reach the Harbor server.
- **Basic knowledge of HTTP requests:** The attacker needs to be able to craft and send an HTTP POST request.

**Additional Notes:**
- The vulnerability was present in Harbor versions 1.7.0 to 1.8.2.
- Patches were released in versions 1.7.6 and 1.8.3 which included a fix that prevents non-admin users from creating an admin user.
- A workaround is to disable self-registration in Harbor.
- Unit 42 identified 1,300 vulnerable internet-facing Harbor instances during their scan.
- VMware Cloud Foundation and VMware Harbor Container Registry for PCF were also impacted by this vulnerability.