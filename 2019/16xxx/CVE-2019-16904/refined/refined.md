- **Root cause of vulnerability:** The application fails to properly sanitize or filter user-provided input when handling previously used passwords, specifically within the "previous password field". This allows an attacker to inject malicious code into the application's data storage.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The vulnerability exists due to lack of input sanitization and proper encoding in the previous passwords field.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code within the context of the victim's browser. This can lead to various malicious activities such as:
    - Session hijacking (stealing cookies).
    - Defacement of the application.
    - Redirecting the victim to malicious websites.
    - Performing actions on behalf of the victim.
- **Attack vectors:**
    - The attacker crafts a malicious XSS payload (e.g., `"><img src=x onerror=prompt(1)>`) and sets it as a password when creating a new item.
    - The payload is stored in the "previous passwords" field.
    - When the item is edited or viewed, and the stored history of passwords is accessed, the payload is executed in the user's browser.
    - The XSS payload will also be executed when viewing the change history.
- **Required attacker capabilities/position:** An attacker needs to have the ability to create a new item in the application. Sharing of the item to an admin can result in admin cookie being compromised.