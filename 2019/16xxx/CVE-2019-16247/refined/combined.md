=== Content from code610.blogspot.com_88c61ef6_20250121_000257.html ===


# [code16](https://code610.blogspot.com/)

## Strony

* [Strona główna](https://code610.blogspot.com/)
* [Mini arts](https://code610.blogspot.com/p/mini-arts.html)
* [Notes Magazine](https://code610.blogspot.com/p/notes-magazine.html)
* [Found bugs](https://code610.blogspot.com/p/found.html)
* [CTFs](https://code610.blogspot.com/p/ctfs.html)
* [Contact](https://code610.blogspot.com/p/contact.html)

## poniedziałek, 9 września 2019

### Crashing DCISoft - 1.21

[Last time](https://code610.blogspot.com/2018/12/crashing-dcisoft.html) I tried to run a quick fuzz against DCISoft. This time I'll try to achieve similar results for latest version - 1.21. Here we go...

We will start here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRGyOR_M6a87g1VZMHAm48sDIiOmdEFrRlHqST5zFOaojbs9yZZfGXNF0OJHMr13Nl6fnzsQoA1bC13vKyi7Yg3ukwdup8mgIBbQDZvjoL4CELYJIgV6tL9zxZlcLBEqzNAqAHJXVZ8XQ/s400/00.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRGyOR_M6a87g1VZMHAm48sDIiOmdEFrRlHqST5zFOaojbs9yZZfGXNF0OJHMr13Nl6fnzsQoA1bC13vKyi7Yg3ukwdup8mgIBbQDZvjoL4CELYJIgV6tL9zxZlcLBEqzNAqAHJXVZ8XQ/s1600/00.jpg)

Details:

**---<windbg>---**

Microsoft (R) Windows Debugger Version 6.11.0001.404 X86
Copyright (c) Microsoft Corporation. All rights reserved.

CommandLine: "C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\DCISoft.exe" C:\sf\_1b626a533fce746074ce56f7fc88dbd4-1.dci
(...)
Executable search path is:
ModLoad: 00400000 00523000   image00400000
(...)
ModLoad: 01420000 01485000   C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\MSVCP60.dll
ModLoad: 01850000 018e0000   C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\IFD9507.dll
ModLoad: 01420000 01485000   C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\MSVCP60.dll
ModLoad: 01850000 018cd000   C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\MOD01C.dll
ModLoad: 01420000 01485000   C:\Program Files\Delta Industrial Automation\Communication\DCISoft 1.21\MSVCP60.dll
(...)
(830.e1c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=8541e0c8 ebx=ffffffff ecx=21506277 edx=8541e0c8 esi=001329c4 edi=10028000
eip=1000343b esp=0012d2b0 ebp=0012fb88 iopl=0         ov up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010a02
CommLib!CCommLib::SetSerializeData+0x1b:
1000343b f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

0:000> r;kb;g;r;kb;!exploitable -v;q
eax=8541e0c8 ebx=ffffffff ecx=21506277 edx=8541e0c8 esi=001329c4 edi=10028000
eip=1000343b esp=0012d2b0 ebp=0012fb88 iopl=0         ov up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010a02
CommLib!CCommLib::SetSerializeData+0x1b:
1000343b f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

ChildEBP RetAddr  Args to Child
WARNING: Stack unwind information not available. Following frames may be wrong.
0012fb88 00414973 003d8648 019ce710 0012fbf8 CommLib!CCommLib::SetSerializeData+0x1b
0012fbb0 00408451 003d8648 00000000 00000013 image00400000+0x14973
0012fbf8 00407781 00222638 0048fb50 00000080 image00400000+0x8451
0012fec8 73d3cf74 00000000 0022268e 00000000 image00400000+0x7781
0012ff88 755f1174 7ffda000 0012ffd4 76f6b3f5 MFC42!Ordinal1576+0x49
0012ff94 76f6b3f5 7ffda000 65001262 00000000 kernel32!BaseThreadInitThunk+0x12
0012ffd4 76f6b3c8 00421d66 7ffda000 00000000 ntdll!RtlInitializeExceptionChain+0x63
0012ffec 00000000 00421d66 7ffda000 00000000 ntdll!RtlInitializeExceptionChain+0x36

(830.e1c): Access violation - code c0000005 (!!! second chance !!!)
eax=8541e0c8 ebx=ffffffff ecx=21506277 edx=8541e0c8 esi=001329c4 edi=10028000
eip=1000343b esp=0012d2b0 ebp=0012fb88 iopl=0         ov up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010a02
CommLib!CCommLib::SetSerializeData+0x1b:
1000343b f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

ChildEBP RetAddr  Args to Child
WARNING: Stack unwind information not available. Following frames may be wrong.
0012fb88 00414973 003d8648 019ce710 0012fbf8 CommLib!CCommLib::SetSerializeData+0x1b
0012fbb0 00408451 003d8648 00000000 00000013 image00400000+0x14973
0012fbf8 00407781 00222638 0048fb50 00000080 image00400000+0x8451
0012fec8 73d3cf74 00000000 0022268e 00000000 image00400000+0x7781
0012ff88 755f1174 7ffda000 0012ffd4 76f6b3f5 MFC42!Ordinal1576+0x49
0012ff94 76f6b3f5 7ffda000 65001262 00000000 kernel32!BaseThreadInitThunk+0x12
0012ffd4 76f6b3c8 00421d66 7ffda000 00000000 ntdll!RtlInitializeExceptionChain+0x63
0012ffec 00000000 00421d66 7ffda000 00000000 ntdll!RtlInitializeExceptionChain+0x36

!exploitable 1.6.0.0
HostMachine\HostUser
Executing Processor Architecture is x86
Debuggee is in User Mode
Debuggee is a live user mode debugging session on the local machine
Event Type: Exception
Exception Faulting Address: 0x10028000
Second Chance Exception Type: STATUS\_ACCESS\_VIOLATION (0xC0000005)
Exception Sub-Type: Write Access Violation

Faulting Instruction:1000343b rep movs dword ptr es:[edi],dword ptr [esi]

Exception Hash (Major/Minor): 0xdeff4c9d.0xda8adb89

 Hash Usage : Stack Trace:
Major+Minor : CommLib!CCommLib::SetSerializeData+0x1b
Major+Minor : image00400000+0x14973
Major+Minor : image00400000+0x8451
Major+Minor : image00400000+0x7781
Major+Minor : MFC42!Ordinal1576+0x49
Minor       : kernel32!BaseThreadInitThunk+0x12
Excluded    : ntdll!RtlInitializeExceptionChain+0x63
Excluded    : ntdll!RtlInitializeExceptionChain+0x36
Instruction Address: 0x000000001000343b

Description: User Mode Write AV
Short Description: WriteAV
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at CommLib!CCommLib::SetSerializeData+0x000000000000001b (Hash=0xdeff4c9d.0xda8adb89)

User mode write access violations that are not near NULL are exploitable.

**---</windbg>---**

There are already other (36 so far ;)) crashes [waiting](https://github.com/c610/tmp/blob/master/dcisoft-1.21-exp-0xdeff4c9d.0xda8adb89.zip) to investigate so maybe later I'll update this post. ;)

(Similar) "[sample files](https://github.com/c610/tmp/)" you can find at my [github](https://github.com/c610/).

In case of any questions/comments - you know how to find me.

See you next time!

[Cheers](https://twitter.com/CodySixteen)

Posted by

[code16](https://www.blogger.com/profile/10414695159301496862 "author profile")

at

[15:16](https://code610.blogspot.com/2019/09/crashing-dcisoft-121.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4457504812250871322/1142761634222200565 "Wyślij posta przez e-mail")

[Wyślij pocztą e-mail](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1142761634222200565&target=email "Wyślij pocztą e-mail")[Wrzuć na bloga](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1142761634222200565&target=blog "Wrzuć na bloga")[Udostępnij w X](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1142761634222200565&target=twitter "Udostępnij w X")[Udostępnij w usłudze Facebook](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1142761634222200565&target=facebook "Udostępnij w usłudze Facebook")[Udostępnij w serwisie Pinterest](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=1142761634222200565&target=pinterest "Udostępnij w serwisie Pinterest")

Labels:
[debug](https://code610.blogspot.com/search/label/debug),
[fuzz](https://code610.blogspot.com/search/label/fuzz),
[infrastructure](https://code610.blogspot.com/search/label/infrastructure),
[poc](https://code610.blogspot.com/search/label/poc)

#### Brak komentarzy:

#### Prześlij komentarz

[Nowszy post](https://code610.blogspot.com/2019/09/crashing-fortigate-vm-621-httpd.html "Nowszy post")

[Starszy post](https://code610.blogspot.com/2019/09/crashing-omegon-fluid-technology-2.html "Starszy post")

[Strona główna](https://code610.blogspot.com/)

Subskrybuj:
[Komentarze do posta (Atom)](https://code610.blogspot.com/feeds/1142761634222200565/comments/default)

## O mnie

[![Moje zdjęcie](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxTLkJwUjO012n0PeP9QOXHkiKVBchiASFL9T6Rad6IsRCwX5CEz_v6pEQP3C_7HRetAZ72fNNZmenletYgK1cYrMKZoAzT0KOEPKauvcQIEq3lsP873D8edyRzITkefA/s113/koszulka.jpg)](https://www.blogger.com/profile/10414695159301496862)
[code16](https://www.blogger.com/profile/10414695159301496862)

Cody Sixteen

[Wyświetl mój pełny profil](https://www.blogger.com/profile/10414695159301496862)

## Archiwum bloga

* ►
  [2024](https://code610.blogspot.com/2024/)
  (10)
  + ►
    [12](https://code610.blogspot.com/2024/12/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2024/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2024/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2024/07/)
    (2)
  + ►
    [04](https://code610.blogspot.com/2024/04/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2024/01/)
    (2)

* ►
  [2023](https://code610.blogspot.com/2023/)
  (14)
  + ►
    [12](https://code610.blogspot.com/2023/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2023/11/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2023/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2023/04/)
    (9)

* ►
  [2022](https://code610.blogspot.com/2022/)
  (16)
  + ►
    [09](https://code610.blogspot.com/2022/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2022/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2022/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2022/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2022/04/)
    (7)
  + ►
    [03](https://code610.blogspot.com/2022/03/)
    (1)
  + ►
    [02](https://code610.blogspot.com/2022/02/)
    (2)

* ►
  [2021](https://code610.blogspot.com/2021/)
  (37)
  + ►
    [12](https://code610.blogspot.com/2021/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2021/11/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2021/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2021/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2021/08/)
    (8)
  + ►
    [07](https://code610.blogspot.com/2021/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2021/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2021/05/)
    (7)
  + ►
    [04](https://code610.blogspot.com/2021/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2021/03/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2021/02/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2021/01/)
    (2)

* ►
  [2020](https://code610.blogspot.com/2020/)
  (62)
  + ►
    [12](https://code610.blogspot.com/2020/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2020/11/)
    (2)
  + ►
    [10](https://code610.blogspot.com/2020/10/)
    (1)
  + ►
    [09](https://code610.blogspot.com/2020/09/)
    (2)
  + ►
    [08](https://code610.blogspot.com/2020/08/)
    (5)
  + ►
    [07](https://code610.blogspot.com/2020/07/)
    (5)
  + ►
    [06](https://code610.blogspot.com/2020/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2020/05/)
    (5)
  + ►
    [04](https://code610.blogspot.com/2020/04/)
    (11)
  + ►
    [03](https://code610.blogspot.com/2020/03/)
    (10)
  + ►
    [02](https://code610.blogspot.com/2020/02/)
    (6)
  + ►
    [01](https://code610.blogspot.com/2020/01/)
    (7)

* ▼
  [2019](https://code610.blogspot.com/2019/)
  (97)
  + ►
    [12](https://code610.blogspot.com/2019/12/)
    (4)
  + ►
    [11](https://code610.blogspot.com/2019/11/)
    (9)
  + ►
    [10](https://code610.blogspot.com/2019/10/)
    (8)
  + ▼
    [09](https://code610.blogspot.com/2019/09/)
    (5)
    - [Crashing WebAccess/HMI Designer 2.1.9.31](https://code610.blogspot.com/2019/09/crashing-webaccesshmi-designer-21931.html)
    - [Crashing FortiGate VM 6.2.1 - httpd](https://code610.blogspot.com/2019/09/crashing-fortigate-vm-621-httpd.html)
    - [Crashing DCISoft - 1.21](https://code610.blogspot.com/2019/09/crashing-dcisoft-121.html)
    - [Crashing Omegon Fluid Technology 2](https://code610.blogspot.com/2019/09/crashing-omegon-fluid-technology-2.html)
    - [PicoCTF 2013 - rop3](https://code610.blogspot.com/2019/09/picoctf-2013-rop3.html)
  + ►
    [08](https://code610.blogspot.com/2019/08/)
    (20)
  + ►
    [07](https://code610.blogspot.com/2019/07/)
    (10)
  + ►
    [06](https://code610.blogspot.com/2019/06/)
    (3)
  + ►
    [05](https://code610.blogspot.com/2019/05/)
    (8)
  + ►
    [03](https://code610.blogspot.com/2019/03/)
    (15)
  + ►
    [02](https://code610.blogspot.com/2019/02/)
    (5)
  + ►
    [01](https://code610.blogspot.com/2019/01/)
    (10)

* ►
  [2018](https://code610.blogspot.com/2018/)
  (67)
  + ►
    [12](https://code610.blogspot.com/2018/12/)
    (13)
  + ►
    [11](https://code610.blogspot.com/2018/11/)
    (4)
  + ►
    [10](https://code610.blogspot.com/2018/10/)
    (3)
  + ►
    [09](https://code610.blogspot.com/2018/09/)
    (4)
  + ►
    [08](https://code610.blogspot.com/2018/08/)
    (7)
  + ►
    [07](https://code610.blogspot.com/2018/07/)
    (9)
  + ►
    [06](https://code610.blogspot.com/2018/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2018/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2018/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2018/03/)
    (7)
  + ►
    [01](https://code610.blogspot.com/2018/01/)
    (10)

* ►
  [2017](https://code610.blogspot.com/2017/)
  (58)
  + ►
    [12](https://code610.blogspot.com/2017/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2017/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2017/10/)
    (9)
  + ►
    [09](https://code610.blogspot.com/2017/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2017/08/)
    (11)
  + ►
    [07](https://code610.blogspot.com/2017/07/)
    (4)
  + ►
    [06](https://code610.blogspot.com/2017/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2017/05/)
    (10)
  + ►
    [04](https://code610.blogspot.com/2017/04/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2017/02/)
    (1)
  + ►
    [01](https://code610.blogspot.com/2017/01/)
    (6)

* ►
  [2016](https://code610.blogspot.com/2016/)
  (63)
  + ►
    [12](https://code610.blogspot.com/2016/12/)
    (2)
  + ►
    [11](https://code610.blogspot.com/2016/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2016/10/)
    (6)
  + ►
    [09](https://code610.blogspot.com/2016/09/)
    (8)
  + ►
    [08](https://code610.blogspot.com/2016/08/)
    (6)
  + ►
    [07](https://code610.blogspot.com/2016/07/)
    (12)
  + ►
    [06](https://code610.blogspot.com/2016/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2016/05/)
    (23)

## Etykiety

* [.net](https://code610.blogspot.com/search/label/.net)
* [android](https://code610.blogspot.com/search/label/android)
* [binary](https://code610.blogspot.com/search/label/binary)
* [crackme](https://code610.blogspot.com/search/label/crackme)
* [ctf](https://code610.blogspot.com/search/label/ctf)
* [debug](https://code610.blogspot.com/search/label/debug)
* [docker](https://code610.blogspot.com/search/label/docker)
* [drones](https://code610.blogspot.com/search/label/drones)
* [enlil](https://code610.blogspot.com/search/label/enlil)
* [FortiGate](https://code610.blogspot.com/search/label/FortiGate)
* [fuzz](https://code610.blogspot.com/search/label/fuzz)
* [infrastructure](https://code610.blogspot.com/search/label/infrastructure)
* [malware](https://code610.blogspot.com/search/label/malware)
* [notes](https://code610.blogspot.com/search/label/notes)
* [pentest](https://code610.blogspot.com/search/label/pentest)
* [poc](https://code610.blogspot.com/search/label/poc)
* [pwn](https://code610.blogspot.com/search/label/pwn)
* [RE](https://code610.blogspot.com/search/label/RE)
* [web](https://code610.blogspot.com/search/label/web)
* [writeup](https://code610.blogspot.com/search/label/writeup)

|  |  |
| --- | --- |

Motyw Okno obrazu. Obsługiwane przez usługę [Blogger](https://www.blogger.com).


