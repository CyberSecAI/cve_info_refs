=== Content from www.liferay.com_c3eb7868_20250121_001253.html ===

Navigation

* [Skip to Content](#main-content)

 [Skip to Content](#content)

 [Skip to Footer](#footer)

 Liferay Sites

Sites

[Liferay Learn](https://learn.liferay.com)

[Community](https://liferay.dev)

[Customer Portal](https://support.liferay.com)

[Partner Portal](https://partner.liferay.com)

[Marketplace](https://marketplace.liferay.com)

Resources for:

[Partners](https://www.liferay.com/partners)

[Customers](https://www.liferay.com/customers)

[Developers](https://www.liferay.com/developers)

EN (US)

* [中文](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=zh_CN)
* English
* [Français](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=fr_FR)
* [Deutsch](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=de_DE)
* [Italiano](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=it_IT)
* [日本語](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=ja_JP)
* [Português](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=pt_BR)
* [Español](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=es_ES)

  Account

[Create An Account](https://login.liferay.com/signin/register)  [Sign In](https://www.liferay.com/c/portal/login?p_l_id=233425056)

  Menu   Close
  Product

Digital Experience Platform

[Platform Overview All the flexibility you need to create the exact solutions you want.](https://www.liferay.com/platform)

[Offerings Launch and manage your solutions faster in the cloud with deployment options that suit your business.](https://www.liferay.com/offerings)

[Start a Pre-Built Trial Begin experiencing the power and flexibility of Liferay SaaS and build a Liferay solution within minutes.](https://www.liferay.com/free-trial/pre-built-trial)

Capabilities

[AI Accelerate content creation, streamline operations, and deliver context-intelligent assistance with integrated AI.](https://www.liferay.com/capabilities/artificial-intelligence)

[Sites Quickly build and deliver personalized, branded digital experiences anywhere.](https://www.liferay.com/capabilities/sites)

[Content Management System Enable business users to create, publish, and manage content, pages, and multimedia across different channels faster.](https://www.liferay.com/capabilities/content-management-systems)

[Commerce Increase orders with enriching product information, easy ordering tools, and product recommendations.](https://www.liferay.com/capabilities/commerce)

[Personalization Deliver more personalized and relevant content through enhanced segmentation, AI-generated recommendations, and A/B testing.](https://www.liferay.com/capabilities/personalization)

[All Capabilities See all of our out-of-the-box capabilities for creating digital solutions faster.](https://www.liferay.com/capabilities)

Featured

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Product Info What's New with Liferay DXP](/whats-new)

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Product Info Liferay DXP Features List](https://www.liferay.com/resources/product-info/Liferay%2BDXP%2BFeatures%2BList)

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Blog Behind the Code: The Evolution of the Plugin Model](https://www.liferay.com/blog/liferay-experience/the-evolution-of-the-plugin-model)

  Solutions

Solutions

[Enterprise Websites Drive new opportunities by providing prospects with an engaging digital experience.](https://www.liferay.com/solutions/enterprise-websites)

[Customer Portals Make customers and internal teams more efficient by automating processes and centralizing resources in one place.](https://www.liferay.com/solutions/customer-portals)

[Digital Commerce Grow revenue, simplify buying, and encourage repeat orders with a site that makes it easy to do business with you.](https://www.liferay.com/solutions/digital-commerce)

[Intranets Increase internal efficiency and productivity with a single solution.](https://www.liferay.com/solutions/intranets)

[Supplier Portals Simplify supplier management through a single interface that increases visibility into processes and improves collaboration.](https://www.liferay.com/solutions/supplier-portals)

[Partner Portals Enhance collaboration and simplify operations for both partners and internal teams.](https://www.liferay.com/solutions/partner-portals)

Industries

[Energy & Utilities Create customer-serving solutions that maintain compliance with changing regulations.](https://www.liferay.com/industries/energy-and-utilities)

[Public Sector Simplify government interactions with secure, personalized, and cost-effective experiences.](https://www.liferay.com/industries/public-sector)

[Manufacturing Digitize processes to empower customers, support suppliers, and increase employees productivity.](https://www.liferay.com/industries/manufacturing)

[Financial Sector Offer enterprise-grade solutions for retail and commercial banking, wealth management, and credit unions.](https://www.liferay.com/industries/financial-services)

[Healthcare Personalize your digital services, optimize operations, and improve patient and employee outcomes.](https://www.liferay.com/industries/healthcare)

[All Industries See how industry leaders deploy Liferay solutions in different industries.](https://www.liferay.com/industries)

  Resources

Learn

[Resource Library Equip yourself with the latest industry and product knowledge.](https://www.liferay.com/resources)

[Case Studies See how Liferay has helped its customers succeed across many industries.](https://www.liferay.com/resources/case-studies)

[Blog Stay up-to-date on the latest digital insights and trends.](https://www.liferay.com/blog)

[Documentation and Videos Practical resources for mastering Liferay.](https://learn.liferay.com)

Connect

[Events Join thought leaders and peers for the latest insights and trends.](https://www.liferay.com/events)

[Partner Directory Find a partner to help you integrate and implement Liferay solutions.](https://www.liferay.com/partners/directory)

[Community Contribute and collaborate with our open source community.](https://liferay.dev)

[Contact Us Have a question? Let us help you!](https://www.liferay.com/contact-us)

Featured

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Ebook Conquering 7 Hurdles of Digitalization: How Liferay DXP Empowers Companies](/resources/ebooks/Conquering%2B7%2BHurdles%2Bof%2BDigitalization%3A%2BHow%2BLiferay%2BDXP%2BEmpowers%2BCompanies)

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Case Study Škoda Auto’s Intranet Serves 40,000 Employees with Personalized Experiences](https://www.liferay.com/web/guest/resources/case-studies/skoda-auto)

 [![](https://www-prd.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Blog Demystifying AI - An Introduction for Enterprises](https://www.liferay.com/blog/current-experiences/demystifying-ai-an-introduction-for-enterprises)

  Services

Services

[Subscription Services Access professional support, management tools and more enterprise-level care from Liferay.](https://www.liferay.com/subscription-services)

[Consulting Gain extensive product and development knowledge from experts to maximize your ROI.](https://www.liferay.com/consulting)

[Customer Success Build better solutions faster with guided journeys that take you from novice to expert.](https://learn.liferay.com)

  Company

Company

[About Us Learn how a group of "nerds" took an open-source project and turned it into an Enterprise platform.](https://www.liferay.com/company/our-story)

[Locations Ready to support global customers with 24 offices across 19 countries.](https://www.liferay.com/locations)

[Careers Be part of a team that helps individuals and organizations reach their full potential.](https://www.liferay.com/careers)

[Press Releases Read the latest news about Liferay's industry-leading products and solutions.](https://www.liferay.com/press-releases)

[Contact Us Have a question? Let us help you!](https://www.liferay.com/contact-us)

Featured

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Ebook Build Digital Experiences Your Way - with Liferay](https://www.liferay.com/resources/ebooks/Build%2BDigital%2BExperiences%2BYour%2BWay%2B%E2%80%93%2Bwith%2BLiferay)

 [![](https://www.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Blog 7 Reasons Why Our Customers Choose Liferay DXP](https://www.liferay.com/blog/liferay-experience/7-reasons-why-our-customers-choose-liferay-dxp)

 [![](https://www-prd.liferay.com/documents/10182/506366755/Background+Gradient+with+Waves.svg/09b0cc0a-bc6b-3d2f-6373-b1008bf6e72f?t=1701295280538)
Blog 16 Awesome Web Portal Examples](https://www.liferay.com/blog/current-experiences/16-awesome-web-portal-examples)

[Contact Sales](/contact-sales)

# Liferay Community Downloads

### Liferay Portal

Build your project on the community supported Liferay Portal CE which is designed for smaller, non-critical deployments and contributing to Liferay development.

### Liferay Commerce

Build your commerce project with a suite of B2B and B2C features built from the ground up. Now comes bundled with Liferay Portal CE.

#### Liferay Portal | Liferay Commerce

Liferay POrtal 7.4 GA129  | Liferay Commerce 4.0 GA129 | December 9, 2024

 Docker Image Bundled with Tomcat (tar.gz) Bundled with Tomcat (7-zip) Portal JavaDocs Portal Source Files Other files
Download

Note: We recommend using Liferay's published Docker Image. [Getting started with a Docker Image](https://learn.liferay.com/dxp/latest/en/getting-started/starting-with-a-docker-image.html)
 Older versions are available on [Docker Hub](https://hub.docker.com/r/liferay/portal) and [GitHub](https://github.com/liferay/liferay-portal/releases).
 [Portal and Commerce Release Highlights](https://liferay.dev/blogs/-/blogs/liferay-portal-7-4-ga129-and-liferay-commerce-4-0-ga129-release)

Note: Older versions are available on [GitHub](https://github.com/liferay/liferay-portal/releases).
 [Portal and Commerce Release Highlights](https://liferay.dev/blogs/-/blogs/liferay-portal-7-4-ga35-and-liferay-commerce-4-0-ga35-release)

Note: Older versions are available on [GitHub](https://github.com/liferay/liferay-portal/releases).
 [Portal and Commerce Release Highlights](https://liferay.dev/blogs/-/blogs/liferay-portal-7-4-ga3-and-liferay-commerce-4-0-ga3-release)

Note: Older versions are available on [GitHub](https://github.com/liferay/liferay-portal/releases).
 [Portal and Commerce Release Highlights](https://liferay.dev/blogs/-/blogs/liferay-portal-7-4-ga3-and-liferay-commerce-4-0-ga3-release)

Note: Older versions are available on [GitHub](https://github.com/liferay/liferay-portal/releases).
 [Portal and Commerce Release Highlights](https://liferay.dev/blogs/-/blogs/liferay-portal-7-4-ga3-and-liferay-commerce-4-0-ga3-release)

[Portal Installation Instructions](https://learn.liferay.com/dxp/latest/en/installation-and-upgrades/installing-liferay.html)

 [Commerce Installation Instructions](https://learn.liferay.com/commerce/latest/en/installation-and-upgrades/installation-overview.html)

 [Try the enterprise supported Liferay DXP for 30 days](https://www.liferay.com/products/dxp/30-day-trial)

## Enhance Your Platform With Our Product Suite

Asset 2

#### Liferay IDE

The official set of Eclipse plugins supporting development for the Liferay Portal application platform.

 [Learn More](https://liferay.dev/-/ide)

#### Liferay Faces

Get support for JavaServer Faces (JSF) standard within Liferay.

 [Learn More](https://liferay.dev/-/faces)

### Learn more about the open source license for Liferay Portal Community Edition (CE).

 [View the license](/downloads/ce-license)

### Learn more about setup and configuration, find documentation, join the community and get to work!

 [Getting started](/community/welcome/dashboard)

EN (US)

* English (United States)
* [中文](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=zh_CN)
* [Français](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=fr_FR)
* [Deutsch](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=de_DE)
* [Italiano](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=it_IT)
* [日本語](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=ja_JP)
* [Português (Brasil)](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=pt_BR)
* [Español](/c/portal/update_language?p_l_id=233425056&redirect=%2Fdownloads-community&languageId=es_ES)

1400 Montefino Avenue
 Diamond Bar, CA 91765
 USA
 +1-877-LIFERAY

[Liferay DXP](/platform)

[Capabilities](/capabilities)

[Solutions](/solutions)

[Industries](/industries)

[What's New](/whats-new)

[Request a Demo](/request-a-demo)

[Resources](/resources)

[Resource Library](/resources)

[Subscription Services](/subscription-services)

[Apps Marketplace](https://marketplace.liferay.com)

[Free Trial](/free-trial)

[Company](/company/our-story)

[Press Releases](/press-releases)

[Careers](/careers)

[Locations](/locations)

[Our Story](/company/our-story)

[Expand & Connect](https://liferay.dev)

[Community](https://liferay.dev)

[Contact Us](/contact-us)

 [Sign In/Create Account](https://www.liferay.com/c/portal/login?p_l_id=233425056)

Built on Liferay Digital Experience Platform

© 2025 Liferay Inc. All Rights Reserved

[Trust Center](/trust-center)

[Accessibility](/accessibility-compliance/digital-experience-platform)

[Legal](/legal)

[Compliance](/trust-center/general-compliance)

[Privacy Policy](/privacy-policy)

Hidden



=== Content from portal.liferay.dev_6b38aebb_20250121_022009.html ===

[Skip to Main Content](#main-content)

[![](/documents/d/guest/logo-svg?download=true)](/)

* [Ask](https://liferay.dev/ask)
* [Blogs](https://liferay.dev/blogs)
* [Chat](https://join.slack.com/t/liferay-community/shared_invite/zt-2qrjrge9d-Ex3aZNesXlNfgtRQjKnidQ)
* [Download](https://www.liferay.com/downloads-community)
* [Feedback](https://liferay.dev/feedback)
* [Help](https://liferay.dev/help)
* [Learn](https://learn.liferay.com)
* [Projects](https://liferay.dev/projects)
* [/dev/24](https://liferay.dev/twentyfour)
* [Log In](https://liferay.dev/c/portal/login?p_l_id=119785690)

# Known Vulnerabilities

* [Overview](https://liferay.dev/portal/security/overview)
* [Reporting Security Issues](https://liferay.dev/portal/security/reporting)
* [Known Vulnerabilities](https://liferay.dev/portal/security/known-vulnerabilities)
* [Hall of Fame](https://liferay.dev/portal/security/hall-of-fame)

#### Releases

* [Liferay Portal 7.4](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753902)

* [Liferay Portal 7.3](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753907)

* [Liferay Portal 7.2](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753910)

* [Liferay Portal 7.1](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753913)

* [Liferay Portal 7.0](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753931)

* [Liferay Portal 6.2 CE](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121753958)

* [Liferay Faces](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121606740)

* [Liferay DXP 7.4](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121810441)

* [Liferay DXP 7.3](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121810438)

* [Liferay DXP 7.2](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121810148)

* [LIferay DXP 7.1](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121810145)

* [LIferay DXP 7.0](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/121810668)

* [Liferay DXP 2024 Q3](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/123105535)

* [Liferay DXP 2024 Q2](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/122736692)

* [Liferay DXP 2024 Q1](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/122477174)

* [Liferay DXP 2023.Q4](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/122393446)

* [Liferay DXP 2023.Q3](https://liferay.dev:443/portal/security/known-vulnerabilities/-/categories/122393443)

CST-7111 RCE via JSON deserialization

### Description

Liferay Portal 7.1.0 and earlier is vulnerable to remote code execution (RCE) via deserialization of JSON data.

### Severity

Severity 1

### Fixed Version(s)

* [Liferay Portal 7.1.1](http://sourceforge.net/projects/lportal/files/Liferay%20Portal/7.1.1%20GA2/)
* [March 2020 source patch for Liferay Portal 7.0.6](https://github.com/community-security-team/liferay-portal/compare/7.0.6-ga7...7.0.6-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](/learn/security/patching) page.
* [March 2020 source patch for Liferay Portal 6.2.5](https://github.com/community-security-team/liferay-portal/compare/6.2.5-ga6...6.2.5-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](/learn/security/patching) page.

### Notes

This vulnerability has been assigned CVE-2019-16891

### Acknowledgments

This issue was reported by Markus Wulftange

Publication date: Wed, 21 Nov 2018 08:19:00 +0000

*Security advisories for Liferay's enterprise offerings (e.g., Liferay DXP) are only listed here since 2023. Historial advisories are availabe in the [Help Center](https://help.liferay.com/hc/en-us/articles/360016700231-Security-Overview).*

* Community
* [Ask](/ask)
* [Events](https://www.liferay.com/events)
* [Learn](/learn)
* [Meet](/meet)

* Company
* [Blogs](/blogs/)
* [Careers](https://www.liferay.com/careers)
* [Download](/download)
* [Open Source](/open-source)

* Feedback
* Contact Us

Copyright © 2025 [Liferay, Inc](http://liferay.com)

Powered by [Liferay Portal CE™](http://portal.liferay.dev)

Hidden

We use cookies to deliver personalized content, analyze trends, administer the site, track user movements on the site, and collect demographic information about our user base as a whole. Accept all cookies for the best possible experience on our website or manage your preferences.
[Visit our Privacy Policy](https://www.liferay.com/privacy-policy)

Configuration

Accept All

Decline All



=== Content from substack.com_c219863c_20250121_022026.html ===

# [Dappsec Blog](/)

SubscribeSign in
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMore
# From PostAuth RCE to PreAuth RCE on Liferay Portal

### The post presents a discovery about CVE-2019-16891 that allows exploiting this vulnerability on Liferay Portal without authentication as everyone knows.

[![](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)](https://substack.com/%40dappsec)[Dappsec](https://substack.com/%40dappsec)Dec 20, 20222
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
## About CVE-2019-16891

### References

* [The public announcement of Liferay](https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cst-7111)

> Liferay Portal 7.1.0 and earlier is vulnerable to remote code execution (RCE) via deserialization of JSON data.

* [NVD database](https://nvd.nist.gov/vuln/detail/CVE-2019-16891)

According to NVD database, CVE-2019-16891 has a CVSS score of 8.8

because it requires an account on Liferay to exploit successfully.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Facf716fe-c946-44a8-ac40-b4aecf2185ad_1034x685.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/acf716fe-c946-44a8-ac40-b4aecf2185ad_1034x685.png)

Privileges Required (PR): Low

* [Analysis from VNPT Cyber Immunity](https://sec.vnpt.vn/2019/09/liferay-deserialization-json-deserialization-part-4/)

### The root cause

Liferay [overridden](https://github.com/liferay/liferay-portal/blob/6.2.x/portal-impl/src/com/liferay/portal/json/JSONFactoryImpl.java#L177) `deserialize` func when implementing `JSONFactoryImpl` class from `com.liferay.portal.kernel.json.JSONFactory`

```
@Override
	public Object deserialize(String json) {
		try {
			return _jsonSerializer.fromJSON(json);
		}
```

We can see the actual deserialization issue is deeper:

1. `deserialize()` call `fromJSON()`
2. `fromJSON()` call `unmarshall()` : <https://github.com/Servoy/jabsorb/blob/master/src/org/jabsorb/JSONSerializer.java#L262>
3. So the vulnerability is inside `org.jabsorb.JSONSerializer` library.

Liferay Team was fixed in 2018 by implementing `getClassFromHint` to whitelist during deserialization.

* <https://github.com/liferay/liferay-portal/blame/master/portal-impl/src/com/liferay/portal/json/jabsorb/serializer/LiferayJSONSerializer.java#L68-L82>

## Found Second Vulnerable Endpoint

After determining the root cause. I searched the source code for locations using the `deserialize` function with the keyword `JSONFactoryUtil.deserialize`. A sufficient condition for successful exploiting is that the parameter passed to `JSONFactoryUtil.deserialize` is taint from user input.

And this is the location I found: <https://github.com/liferay/liferay-portal/blob/6.2.x/portal-impl/src/com/liferay/portal/action/PortletURLAction.java#L167:L172>

The endpoint is map to Portlet URL feature (turn off by default) and here is the endpoint that can be successfully called without authentication:

### PoC

```
POST /c/portal/portlet_url HTTP/1.1
Host: liferay.victim.example.com
User-Agent: Mozilla/5.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://liferay.victim.example.com
Connection: close
Referer: http://liferay.victim.example.com

parameterMap={"Json payload for deserialization in here!"}
```
[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/e02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)
## Detect vulnerable Liferay Portal instance

* `GET /c/portal/portlet_url` return 200 status code

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F2d0b2e76-b6e9-4d8f-a8c3-6a637952705c_582x155.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/2d0b2e76-b6e9-4d8f-a8c3-6a637952705c_582x155.png)

* Version <= 7.1.0

## Conclusion

* New CVSS score: 9.8 - Critical (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1>)
* Upgrade Liferay Portal (<https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cst-7111>)

  + **Liferay Portal 7.1:** There is no patch available for Liferay Portal 7.1.0. Instead, users should upgrade to [Liferay Portal 7.1 CE GA2 (7.1.1)](http://sourceforge.net/projects/lportal/files/Liferay%20Portal/7.1.1%20GA2/) or later.
  + **Liferay Portal 7.0**: Source patch for Liferay Portal 7.0 GA7 (7.0.6) is available on [GitHub](https://github.com/community-security-team/liferay-portal/compare/7.0.6-ga7...7.0.6-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](https://liferay.dev/learn/security/patching) page.
  + **Liferay Portal 6.2**: Source patch for Liferay Portal 6.2 GA6 (6.2.5) is available on [GitHub](https://github.com/community-security-team/liferay-portal/compare/6.2.5-ga6...6.2.5-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](https://liferay.dev/learn/security/patching) page.

## Update

* 12/21/2022: [NVD rescored CVSS to 9.8 for this vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2019-16891#VulnChangeHistorySection)
* 12/27/2022: [MITRE added my advisory to the References](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16891)

[About me on Twitter](https://twitter.com/lnlinh31)

Thanks for reading DappSec Blog! Subscribe for free to receive new posts and support my work.

Subscribe2
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
#### Discussion about this post

CommentsRestacks![](https://substackcdn.com/image/fetch/w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-light.png)TopLatest

No posts

Ready for more?

Subscribe© 2025 dappsec[Privacy](https://substack.com/privacy) ∙ [Terms](https://substack.com/tos) ∙ [Collection notice](https://substack.com/ccpa#personal-data-collected) [Start Writing](https://substack.com/signup?utm_source=substack&utm_medium=web&utm_content=footer)[Get the app](https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&utm_content=web-footer-button)[Substack](https://substack.com) is the home for great culture
#### Share

Copy linkFacebookEmailNotesMore

This site requires JavaScript to run correctly. Please [turn on JavaScript](https://enable-javascript.com/) or unblock scripts



=== Content from twitter.com_e7f715cb_20250121_022010.html ===



=== Content from liferay.dev_55294b1d_20250121_022011.html ===

[Skip to Main Content](#main-content)

[![](/documents/d/guest/logo-svg?download=true)](/)

* [Ask](https://liferay.dev/en/ask)
* [Blogs](https://liferay.dev/en/blogs)
* [Chat](https://join.slack.com/t/liferay-community/shared_invite/zt-2qrjrge9d-Ex3aZNesXlNfgtRQjKnidQ)
* [Download](https://www.liferay.com/downloads-community)
* [Feedback](https://liferay.dev/en/feedback)
* [Help](https://liferay.dev/en/help)
* [Learn](https://learn.liferay.com)
* [Projects](https://liferay.dev/en/projects)
* [/dev/24](https://liferay.dev/en/twentyfour)
* [Log In](https://liferay.dev/en/c/portal/login?p_l_id=119785692)

# Security Overview

* [Overview](https://liferay.dev/en/portal/security/overview)
* [Reporting Security Issues](https://liferay.dev/en/portal/security/reporting)
* [Known Vulnerabilities](https://liferay.dev/en/portal/security/known-vulnerabilities)
* [Hall of Fame](https://liferay.dev/en/portal/security/hall-of-fame)

# Patching

The Community Security Team (CST) produces source patches that apply to the latest releases of Liferay Portal Community Edition.  The CST will not produce patches for older releases, so it is important that CE users be using the latest CE releases if they want to get easy-to-apply fixes for critical security fixes.

## Source patches

Source patches are essentially the output of `git diff` (which is itself related to the output of the unix `diff` command).

By virtue of the CST maintaining separate branches for each fix (along with a separate cumulative branch), generating patches using github is trivial.  Each source patch can be downloaded and applied to a copy of the Liferay Portal source code from the latest released version, using either `git apply` (if you have a proper git clone of the Liferay source) or the unix `patch` command if you just have a basic Liferay Portal source tree.

If you use the patch command on Windows or Linux, be aware that the line ending differences between OS's might cause trouble (Mac OS X seems to handle it with no special procedures).  You may need to use tools to convert line endings, such as dos2unix, before the source patches can be applied.  Read below for specific instructions for your operating system.

* [Linux](#Linux)
* [Mac OS X](#Mac_20_OS_20_X)
* [Windows](#Windows)

If you use git, run:

```
cd $LIFERAY_SRC_HOME ; git apply name-of-downloaded-patch-file
```

If you don't use git, and just have a basic Liferay Portal source tree (e.g. by downloading a raw .zip file from Github), then you can use the unix patch command:

```
patch -p1 < name-of-downloaded-patch-file
```
It is recommended that you [download the source from Github](https://github.com/liferay/liferay-portal/tags).  If you have downloaded the source code from SourceForge.net, be aware that SourceForge code sometimes contains Windows-style line endings, and you may need to first convert them to unix-style line endings using something like:

`cd $LIFERAY_SRC_HOME; find . -type f  -exec dos2unix {} \;`

The [`dos2unix`](http://en.wikipedia.org/wiki/Unix2dos) tool may be installed by default on your Linux distribution, or you may need to install it first (using apt-get, pkg, deb, yum, etc).

If you use git, run:

```
cd $LIFERAY_SRC_HOME ; git apply name-of-downloaded-patch-file
```

If you don't use git, and just have a basic Liferay Portal source tree (e.g. by downloading a raw .zip file from Github), then you can use the unix patch command:

```
patch -p1 < name-of-downloaded-patch-file
```

Depending on which tool(s) you are using, you can either use [`git apply`](http://git-scm.com/docs/git-apply) *(this is the recommended method if you are using git, some tools supply a bash-like shell tool)*, or consult your git tool's manual on how to apply patch files.

If you don't use git, and just have a basic Liferay Portal source tree (e.g. by downloading a raw .zip file from Github), then you can use the [GNU patch command for Windows](http://gnuwin32.sourceforge.net/packages/patch.htm):

```
patch.exe -p1 < name-of-downloaded-patch-file
```

**Once the source patches have been applied, the Liferay Portal's source code will need to be re-compiled to generate binaries.**

* Community
* [Ask](/ask)
* [Events](https://www.liferay.com/events)
* [Learn](/learn)
* [Meet](/meet)

* Company
* [Blogs](/blogs/)
* [Careers](https://www.liferay.com/careers)
* [Download](/download)
* [Open Source](/open-source)

* Feedback
* Contact Us

Copyright © 2025 [Liferay, Inc](http://liferay.com)

Powered by [Liferay Portal CE™](http://portal.liferay.dev)

Hidden

We use cookies to deliver personalized content, analyze trends, administer the site, track user movements on the site, and collect demographic information about our user base as a whole. Accept all cookies for the best possible experience on our website or manage your preferences.
[Visit our Privacy Policy](https://www.liferay.com/privacy-policy)

Configuration

Accept All

Decline All



=== Content from dappsec.substack.com_5d4864aa_20250121_001250.html ===

# [Dappsec Blog](/)

SubscribeSign in
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMore
# From PostAuth RCE to PreAuth RCE on Liferay Portal

### The post presents a discovery about CVE-2019-16891 that allows exploiting this vulnerability on Liferay Portal without authentication as everyone knows.

[![](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)](https://substack.com/%40dappsec)[Dappsec](https://substack.com/%40dappsec)Dec 20, 20222
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
## About CVE-2019-16891

### References

* [The public announcement of Liferay](https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cst-7111)

> Liferay Portal 7.1.0 and earlier is vulnerable to remote code execution (RCE) via deserialization of JSON data.

* [NVD database](https://nvd.nist.gov/vuln/detail/CVE-2019-16891)

According to NVD database, CVE-2019-16891 has a CVSS score of 8.8

because it requires an account on Liferay to exploit successfully.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Facf716fe-c946-44a8-ac40-b4aecf2185ad_1034x685.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/acf716fe-c946-44a8-ac40-b4aecf2185ad_1034x685.png)

Privileges Required (PR): Low

* [Analysis from VNPT Cyber Immunity](https://sec.vnpt.vn/2019/09/liferay-deserialization-json-deserialization-part-4/)

### The root cause

Liferay [overridden](https://github.com/liferay/liferay-portal/blob/6.2.x/portal-impl/src/com/liferay/portal/json/JSONFactoryImpl.java#L177) `deserialize` func when implementing `JSONFactoryImpl` class from `com.liferay.portal.kernel.json.JSONFactory`

```
@Override
	public Object deserialize(String json) {
		try {
			return _jsonSerializer.fromJSON(json);
		}
```

We can see the actual deserialization issue is deeper:

1. `deserialize()` call `fromJSON()`
2. `fromJSON()` call `unmarshall()` : <https://github.com/Servoy/jabsorb/blob/master/src/org/jabsorb/JSONSerializer.java#L262>
3. So the vulnerability is inside `org.jabsorb.JSONSerializer` library.

Liferay Team was fixed in 2018 by implementing `getClassFromHint` to whitelist during deserialization.

* <https://github.com/liferay/liferay-portal/blame/master/portal-impl/src/com/liferay/portal/json/jabsorb/serializer/LiferayJSONSerializer.java#L68-L82>

## Found Second Vulnerable Endpoint

After determining the root cause. I searched the source code for locations using the `deserialize` function with the keyword `JSONFactoryUtil.deserialize`. A sufficient condition for successful exploiting is that the parameter passed to `JSONFactoryUtil.deserialize` is taint from user input.

And this is the location I found: <https://github.com/liferay/liferay-portal/blob/6.2.x/portal-impl/src/com/liferay/portal/action/PortletURLAction.java#L167:L172>

The endpoint is map to Portlet URL feature (turn off by default) and here is the endpoint that can be successfully called without authentication:

### PoC

```
POST /c/portal/portlet_url HTTP/1.1
Host: liferay.victim.example.com
User-Agent: Mozilla/5.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://liferay.victim.example.com
Connection: close
Referer: http://liferay.victim.example.com

parameterMap={"Json payload for deserialization in here!"}
```
[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/e02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)
## Detect vulnerable Liferay Portal instance

* `GET /c/portal/portlet_url` return 200 status code

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F2d0b2e76-b6e9-4d8f-a8c3-6a637952705c_582x155.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/2d0b2e76-b6e9-4d8f-a8c3-6a637952705c_582x155.png)

* Version <= 7.1.0

## Conclusion

* New CVSS score: 9.8 - Critical (<https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1>)
* Upgrade Liferay Portal (<https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cst-7111>)

  + **Liferay Portal 7.1:** There is no patch available for Liferay Portal 7.1.0. Instead, users should upgrade to [Liferay Portal 7.1 CE GA2 (7.1.1)](http://sourceforge.net/projects/lportal/files/Liferay%20Portal/7.1.1%20GA2/) or later.
  + **Liferay Portal 7.0**: Source patch for Liferay Portal 7.0 GA7 (7.0.6) is available on [GitHub](https://github.com/community-security-team/liferay-portal/compare/7.0.6-ga7...7.0.6-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](https://liferay.dev/learn/security/patching) page.
  + **Liferay Portal 6.2**: Source patch for Liferay Portal 6.2 GA6 (6.2.5) is available on [GitHub](https://github.com/community-security-team/liferay-portal/compare/6.2.5-ga6...6.2.5-cumulative.patch). Details for working with source patches can be found on the [Patching Liferay Portal](https://liferay.dev/learn/security/patching) page.

## Update

* 12/21/2022: [NVD rescored CVSS to 9.8 for this vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2019-16891#VulnChangeHistorySection)
* 12/27/2022: [MITRE added my advisory to the References](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16891)

[About me on Twitter](https://twitter.com/lnlinh31)

Thanks for reading DappSec Blog! Subscribe for free to receive new posts and support my work.

Subscribe2
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fe02b9348-ac4c-4cc6-9822-af5f374a49fc_1205x789.png)![](https://substackcdn.com/image/fetch/w_18,h_18,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0552a2d4-33f0-49f9-8ca6-325da0d4a358_578x610.png)Dappsec BlogFrom PostAuth RCE to PreAuth RCE on Liferay Portal](https://substack.com/home/post/p-91339019?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
#### Discussion about this post

CommentsRestacks![](https://substackcdn.com/image/fetch/w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-light.png)TopLatest

No posts

Ready for more?

Subscribe© 2025 dappsec[Privacy](https://substack.com/privacy) ∙ [Terms](https://substack.com/tos) ∙ [Collection notice](https://substack.com/ccpa#personal-data-collected) [Start Writing](https://substack.com/signup?utm_source=substack&utm_medium=web&utm_content=footer)[Get the app](https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&utm_content=web-footer-button)[Substack](https://substack.com) is the home for great culture
#### Share

Copy linkFacebookEmailNotesMore

This site requires JavaScript to run correctly. Please [turn on JavaScript](https://enable-javascript.com/) or unblock scripts


