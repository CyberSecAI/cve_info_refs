=== Content from launchpad.net_f09f2e04_20250121_032018.html ===

[Log in / Register](https://launchpad.net/~alexmurray/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~alexmurray)

## [Alex Murray](https://launchpad.net/~alexmurray)

* Overview
* [Code](https://code.launchpad.net/~alexmurray)
* [Bugs](https://bugs.launchpad.net/~alexmurray)
* [Blueprints](https://blueprints.launchpad.net/~alexmurray)
* [Translations](https://translations.launchpad.net/~alexmurray)
* [Answers](https://answers.launchpad.net/~alexmurray)

Ubuntu Security Tech Lead for Canonical and in my spare time developer of Hardware Sensors Indicator (indicator-sensors) and a bunch of other software bits (mainly Emacs related)

See <https://github.com/alexmurray>

* [Related packages](https://launchpad.net/~alexmurray/%2Brelated-packages)
* [Related projects](https://launchpad.net/~alexmurray/%2Brelated-projects)

## User information

Launchpad Id:
alexmurray

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-24

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of Build Daemon Maintainers](https://launchpadlibrarian.net/1558154/buildd-maint.png "Member of Build Daemon Maintainers")](/~launchpad-buildd-admins)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of Docky Users](https://launchpadlibrarian.net/51321694/docky14.png "Member of Docky Users")](/~docky-users)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Launchpad Users](https://launchpadlibrarian.net/600856618/Canonical_Launchpad_icon_14px.png "Member of Launchpad Users")](/~launchpad-users)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of Mactel Support Community](https://launchpadlibrarian.net/12126197/Logo_14.png "Member of Mactel Support Community")](/~mactel-support-community)
[![Icon of Mactel Support](https://launchpadlibrarian.net/12039822/appleubuntu_14.png "Member of Mactel Support")](/~mactel-support)
[![Icon of MOTU SWAT](https://launchpadlibrarian.net/5609742/sword16x16.png "Member of MOTU SWAT")](/~motu-swat)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu BugSquad](https://launchpadlibrarian.net/1812570/bugsquad.png "Member of Ubuntu BugSquad")](/~bugsquad)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu Drivers](https://launchpadlibrarian.net/1546355/hobbyhorse.gif "Member of Ubuntu Drivers")](/~ubuntu-drivers)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)
[![Icon of Ubuntu Sponsors](https://launchpadlibrarian.net/40794090/minitools.png "Member of Ubuntu Sponsors")](/~ubuntu-sponsors)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

88E9530BCBDDC200517B5EB0F498D2D9DE7DAD9C

SSH keys:

[alex.murray@canonical.com](%2Bsshkeys)

Time zone:

Australia/Adelaide
(UTC+1030)

Karma:
[29591](https://launchpad.net/~alexmurray/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**amurray**
 on
**irc.canonical.com**

![IRC](/@@/social-irc "IRC")
**amurray**
 on
**irc.libera.chat**

![Matrix](/@@/social-matrix "Matrix") [**@alexmurray:ubuntu.com**](https://matrix.to//#/@alexmurray:ubuntu.com)

## Personal package archives

| [adduser updated to enable private homedirs by default](/~alexmurray/%2Barchive/ubuntu/adduser-private-homedirs) |
| --- |
| [apparmor-4.0.0-alpha2-for-mantic](/~alexmurray/%2Barchive/ubuntu/apparmor-4.0.0-alpha2-for-mantic) |
| [apparmor-4.0.0-alpha2-for-mantic-take2](/~alexmurray/%2Barchive/ubuntu/apparmor-4.0.0-alpha2-for-mantic-take2) |
| [AppArmor Prompting Demo](/~alexmurray/%2Barchive/ubuntu/apparmor-prompting) |
| [docker-test](/~alexmurray/%2Barchive/ubuntu/docker-test) |
| [Emacs](/~alexmurray/%2Barchive/ubuntu/emacs) |
| [Test PPA for Emacs backports](/~alexmurray/%2Barchive/ubuntu/emacs-test) |
| [gcc-stack-clash-and-cf-protection](/~alexmurray/%2Barchive/ubuntu/gcc-stack-clash-and-cf-protection) |
| [gcc-stack-clash-protection](/~alexmurray/%2Barchive/ubuntu/gcc-stack-clash-protection) |
| [gcc-stack-clash-protection2](/~alexmurray/%2Barchive/ubuntu/gcc-stack-clash-protection2) |
| [global](/~alexmurray/%2Barchive/ubuntu/global) |
| [PPA for indicator-sensors](/~alexmurray/%2Barchive/ubuntu/indicator-sensors) |
| [Indicator Sensors Daily PPA](/~alexmurray/%2Barchive/ubuntu/indicator-sensors-daily) |
| [iptables-mantic](/~alexmurray/%2Barchive/ubuntu/iptables-mantic) |
| [iptables-mantic-i386](/~alexmurray/%2Barchive/ubuntu/iptables-mantic-i386) |
| [libchamplain](/~alexmurray/%2Barchive/ubuntu/libchamplain) |
| [clamav 1.0 transition test](/~alexmurray/%2Barchive/ubuntu/libclamav11) |
| [LP1765304](/~alexmurray/%2Barchive/ubuntu/lp1765304) |
| [LP1784964](/~alexmurray/%2Barchive/ubuntu/lp1784964) |
| [LP1862158](/~alexmurray/%2Barchive/ubuntu/lp1862158) |
| [lp1876055](/~alexmurray/%2Barchive/ubuntu/lp1876055) |
| [LP1877633](/~alexmurray/%2Barchive/ubuntu/lp1877633) |
| [lp1973322](/~alexmurray/%2Barchive/ubuntu/lp1973322) |
| [lp1989309](/~alexmurray/%2Barchive/ubuntu/lp1989309) |
| [lp2016042](/~alexmurray/%2Barchive/ubuntu/lp2016042) |
| [lp2036128](/~alexmurray/%2Barchive/ubuntu/lp2036128) |
| [PPA for Alex Murray](/~alexmurray/%2Barchive/ubuntu/ppa) |
| [radare2](/~alexmurray/%2Barchive/ubuntu/radare2) |
| [test](/~alexmurray/%2Barchive/ubuntu/test) |

* [View source package recipes](https://code.launchpad.net/~alexmurray/%2Brecipes)
* [View snap packages](https://launchpad.net/~alexmurray/%2Bsnaps)

## [All memberships](https://launchpad.net/~alexmurray/%2Bparticipation) Latest memberships

| [Ubuntu Sponsors](/~ubuntu-sponsors)  Joined on 2023-11-09 | |
| --- | --- |
| [MOTU SWAT](/~motu-swat)  Joined on 2023-05-15 | |
| [Ubuntu Technical Board](/~techboard)  Joined on 2022-12-17 | |
| [Bileto Announcement List](/~bileto-announce)  Joined on 2022-02-22 | |
| [Ubuntu BugSquad](/~bugsquad)  Joined on 2021-11-29 | |

## [Recent activities](https://launchpad.net/~alexmurray/%2Bkarma) Most active in

| [review-tools](/review-tools) |  |  |  |  |
| --- | --- | --- | --- | --- |
| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |  |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |  |
| [Ubuntu](/ubuntu) |  |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_68c22b16_20250121_011241.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[extplorer package](https://launchpad.net/ubuntu/%2Bsource/extplorer)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/extplorer)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/extplorer)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/extplorer)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/extplorer)

# extplorer package exposes /usr/ (and /etc/extplorer/) directory over HTTP

Bug #1822013 reported by
[Alex Murray](https://launchpad.net/~alexmurray)
on 2019-03-28

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [extplorer (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer "Latest release: 2.1.0b6+dfsg.3-4+deb7u5ubuntu0.16.04.1, uploaded to main on 2017-08-29 23:30:40.767826+00:00 by Steve Beattie (sbeattie), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

Ubuntu security vulnerability report: "extplorer" package exposes /usr/ (and /etc/extplorer/) directory over HTTP

=================================================================================================================

OVERVIEW

--------

Author: Sander Bos

Author's e-mail address: sbos \_at\_ sbosnet \_dot\_ nl

Author's website: www.sbosnet.nl

CVE identifier(s): requested

Date: 2019-03-28

Report version: 1

SUMMARY

-------

The Ubuntu "extplorer" package unintendedly exposes the system's /usr/

directory to the world over HTTP. Authenticating to the eXtplorer

application is not needed to exploit this flaw (but the directory should

not be accessible to authenticated clients either).

In addition, and not needing authentication to the application either,

a less severe vulnerability exists in the package missing a .htaccess

file provided by the upstream application, potentially leading to files

in /etc/extplorer/ (the config/ subdirectory in the application directory)

being accessible over HTTP.

Vulnerability impact types include data leakage, information disclosure,

and potential remote code execution on the eXtplorer server.

Both vulnerabilities exist in a patch file from the package, not in the

upstream code.

Fixes should be implemented as an Ubuntu package update or otherwise

manually by server administrators on systems on which the extplorer

package is installed.

Any CMS projects, web appliances, et cetera that include eXtplorer,

especially when directly based upon the Debian or Ubuntu package, should

also check to see if they are vulnerable as well.

DESCRIPTION

-----------

eXtplorer is a PHP based web file explorer and manager [1].

The application was initially packaged for Debian, and got included in

Ubuntu as well. Currently the package is no longer available in Debian,

but still present in some releases of Ubuntu [2].

The upstream eXtplorer application contains several embedded libraries.

As explained in the debian/README.Debian and debian/README.sources

files in the package, several of those libraries were removed as part

of the package creation and replaced by symbolic links to OS package

versions of those libraries. These symbolic links got created in

the eXtplorer application directory by a Makefile patch file called

debian/patches/debian-changes-2.1.0b6+dfsg-1, which later got renamed

to debian/patches/adds-a-makefile.patch [3].

One of the symbolic links created by the patch file points to the system's

/usr/ directory, to make it possible for the application to access files

under that directory (e.g., library files from dependency packages).

However, by doing so it was overlooked that this symbolic link, i.e.,

the complete /usr/ directory, gets accessible over HTTP. This applies

even outside of the context of eXtplorer: logging into eXtplorer is not

needed to access the directory (which does not mean that it is intended

for users logged into eXtplorer to be able to access the directory;

they shouldn't be able to do so either).

The Makefile file created by the package patch file works by setting

multiple variables including the following (line numbers prepended):

9 +APP\_NAME=extplorer

    [...]

 59 +DESTDIR?=""

 60 +D\_APP\_DIR?=$(DESTDIR)/usr/share/$(APP\_NAME)

Later the file creates symbolic links within the eXtplorer application

directory, with the first one being the problematic symbolic link pointing

to the system's /usr/ directory:

95 + ##################################################################

 96 + # Link the embedded libraries with their OS packaged replacement #

 97 + ##################################################################

 98 + # Strange behavior of the app

 99 + ln -s ../.. $(D\_APP\_DIR)/usr

This inadvertently makes the /usr/ directory world-accessible over HTTP,

via <http://<host>/extplorer/usr/>.

A second, less severe and more theoretical, security vulnerability exists

in the following code:

43 +CONF\_FILES=conf.php index.html mimes.php

    [...]

 61 +D\_CONF\_DIR?=$(DESTDIR)/etc/$(APP\_NAME)

    [...]

135 + ##############################################

136 + # Manage the config folder in /etc/extplorer #

137 + ##############################################

138 + @for i in $(CONF\_FILES) ; do $(INSTALL) -m $(PHP\_RIGHTS) config/$$i $(D\_CONF\_DIR)/$$i ; done

139 + @ln -s /etc/extplorer $(D\_APP\_DIR)/config

Here, the "config/" subdirectory present in the upstream eXtplorer

application sources gets replaced by a symbolic link to the

/etc/extplorer/ directory, also being created by the package. However,

an equivalent replacement file for the config/.htaccess file created by

the upstream sources, containing "deny from all" to prevent files in

the directory from being retrieved over HTTP, does not get created in

/etc/extplorer/ by the package.

This could lead to files in /etc/extplorer/ becoming accessible over HTTP,

via <<http://host/extplorer/config/><filename>>, where this in fact should

not be possible. Additional web server configuration might be required

however to allow the .htaccess file's contents to take into effect, which

means such instructions could best be added to the package installation

instructions as well (instructions to enable the include/.htaccess file,

which exists in the application directory in the upstream code as well

as in the package, are not provided either by the way).

VULNERABILITY IMPACT

--------------------

With the vulnerabilities listed above the /usr/ system directory, as well

as the /etc/extplorer/ directory, gets accessible over HTTP. Essentially

this means anyone in the world could access files and directories in

those directories over HTTP. It should be explicitly noted that eXtplorer

authentication is not required for this (but accessing these directories

this way is not intended for authenticated eXtplorer users either).

A requirement factor is that following symbolic links should be enabled

in the web server configuration. This is the default for Apache 2.4

though, which in Ubuntu 14.04 LTS and Ubuntu 16.04 LTS by default gets

installed as a dependency of the extplorer package.

File names in /usr/ should be either guessed or known to exist by

the attacker. However, this is not the case if directory listings are

enabled in the web browser (which is not the default in Apache). Thus,

enabled directory listings would make the vulnerability more severe.

For /etc/extplorer/ file names should be guessed or known to exist

both with and without directory listings enabled, due to this directory

containing an index.html file.

The /usr/ directory itself may, and by default does, contain symbolic

links to other directories which in turn can be "recursively"

followed as well. Real world examples of this are symbolic links

in /usr/lib/ssl/ pointing to files and directories in /etc/ssl/, for

example /usr/lib/ssl/private pointing to /etc/ssl/private/ (although

that target directory, which may contain private SSL keys, is most

likely and by default not accessible to the web server due to its file

system permissions).

Generic vulnerability impact types include data leakage, information

disclosure, and potentially remote code execution on the web server by for

example executing PHP, CGI, or other types of executables or executable

scripts present below /usr/ or one of its symbolic links. In case such

scripts take parameters / arguments the executable commands become more

dynamic, possibly leading to arbitrary remote code execution. Also,

directories like /usr/src/ and /usr/local/ might contain site-specific

data which might be of a sensitive nature.

As a particular example of information disclosure, system reconnaissance

can be performed to gain system information then to be used for further

exploitation. Retrievable information includes the installed OS type and

release (e.g., via /usr/lib/os-release), system hardware architecture type

(e.g., via /usr/lib/\*-linux-gnu/), install status of packages (that is,

whether or not a package / program is installed / present) and package

versions / patch status of installed packages including the kernel,

glibc, and systemd (e.g., via /usr/share/doc/), and installed (and thus,

possibly enabled) Apache modules (via /usr/lib/apache2/modules).

PROOF OF CONCEPT (PoC)

----------------------

The following steps could be performed to demonstrate the vulnerabilities

on a default installation of Ubuntu 16.04 LTS:

1. Install the "extplorer" package (this will also install the Apache

   web server, via dependencies);

2. add "Alias /extplorer /usr/share/extplorer" to the Apache configuration

   (as explained in the debian/README.Debian file from the extplorer

   package), and reload the Apache configuration;

3. use plain HTTP requests from an HTTP client system (see examples below)

   to abuse the existence of the following symbolic links created by

   the package on the server:

root@ubuntu1604:~# file /usr/share/extplorer/usr /usr/share/extplorer/config

      /usr/share/extplorer/usr: symbolic link to ../..

      /usr/share/extplorer/config: symbolic link to /etc/extplorer

Abuse of the second symbolic link is possible due to the package

   not creating the /etc/extplorer/.htaccess file provided by

   the upstream sources as /usr/share/extplorer/config/.htaccess

   (in comparison: a similar file created by the upstream sources,

   /usr/share/extplorer/include/.htaccess, does get created by the

   package as also shown below):

root@ubuntu1604:~# ls /etc/extplorer/.htaccess /usr/share/extplorer/include/.htaccess

      ls: cannot access '/etc/extplorer/.htaccess': No such file or directory

      /usr/share/extplorer/include/.htaccess

Examples of step 3 for the /usr/ symbolic link vulnerability:

Access the /usr/ directory over HTTP, returning a "403 Forbidden"

HTTP status code indicating presence of the extplorer/usr symbolic link

(i.e., the vulnerability existing) but directory listings disabled on the

web server (in comparison: a "404 Not Found" HTTP status code would be

given if the symbolic link vulnerability did not exist, and a "200 OK"

HTTP status code would be returned in case the symbolic link existed

and directory listings were enabled on the web server):

$ curl -Is 'http://<host>/extplorer/usr/' | head -n 1

HTTP/1.1 403 Forbidden

Determine the OS type and version of the host:

$ curl -s 'http://<host>/extplorer/usr/lib/os-release' | head -n 2

NAME="Ubuntu"

VERSION="16.04.6 LTS (Xenial Xerus)"

Retrieve the /etc/ssl/openssl.cnf file of the host (first following the

extplorer/usr symbolic link to /usr/, and then "recursively" following the

/usr/lib/ssl/openssl.cnf symbolic link pointing to /etc/ssl/openssl.cnf):

$ curl -s 'http://<host>/extplorer/usr/lib/ssl/openssl.cnf' | head -n 4

#

# OpenSSL example configuration file.

# This is mostly being used for generation of certificate requests.

#

Determine the patch status of the installed kernel package, in this

example showing the kernel not being up-to-date with the most recent

package repository version (e.g., the update for USN-3910-1 [4], being

fixed by package version 4.4.0.143.151, is not installed):

$ curl -s 'http://<host>/extplorer/usr/share/doc/linux-generic/changelog.gz' | gzip -d | head -n 1

linux-meta (4.4.0.142.148) xenial; urgency=medium

Example of step 3 for the /etc/extplorer/ vulnerability:

Access the index.html file under /etc/extplorer/ (this file does prevent

directory listings, but would nonetheless not be accessible in case the

/etc/extplorer/.htaccess from the upstream sources would be in place

(and enabled through the web server configuration)):

$ curl -s "http://<host>/extplorer/config/index.html"

<html><body bgcolor="#FFFFFF"></body></html>

VULNERABLE UBUNTU RELEASES / PACKAGE VERSIONS

---------------------------------------------

The vulnerability was introduced in the initial Debian extplorer package

version, version 2.1.0b6+dfsg-1, from 2010 [5]. Consequently, all former

and current Debian and Ubuntu extplorer package versions beginning with

this first package version from 2010 have been vulnerable.

Currently, the following supported Ubuntu versions with their respective

extplorer package versions are vulnerable:

Ubuntu 16.04 LTS: 2.1.0b6+dfsg.3-4+deb7u5ubuntu0.16.04.1

Ubuntu 14.04 LTS: 2.1.0b6+dfsg.3-4+deb7u5build0.14.04.1

Ubuntu 12.04 ESM: 2.1.0b6+dfsg.3-2

(Note: the package version listed for Ubuntu 12.04 ESM is actually the

version from Ubuntu 12.04 LTS; an unchecked assumption is made here that

the version in Ubuntu 12.04 ESM did not change since 12.04 LTS became

12.04 ESM.)

In addition to OS package versions any CMS projects, web appliances,

et cetera that may have eXtplorer included should also check their code.

For instance, eXtplorer can / may be installed as part of Joomla! [6],

and older versions of the TurnKey GNU/Linux File Server appliance

contained eXtplorer as well [7].

PROPOSED FIXES / WORKAROUNDS

----------------------------

Several potential fixes / workarounds are provided here. These should be

implemented as an Ubuntu package update, and / or implemented manually

by server administrators on systems on which the extplorer package

is installed (for example in case the Ubuntu package will not receive

a fix, or in case it will simply get removed from the Ubuntu package

repositories).

In defining on how to fix the /usr/ symbolic link issue, it should

first be investigated for what exact purpose(s) the symbolic link gets

created by the package (i.e., what exact files under extplorer/usr/

are used by eXtplorer). The package does not give a clear indication

about this. It is noteworthy though that the upstream application code

does not contain an extplorer/usr/ subdirectory, which indicates that

the symbolic link was not created as a replacement for such directory

(as is the case with the "extplorer/config" symbolic link for example,

which replaces the upstream extplorer/config/ directory).

The following possibilities for fixes / workarounds can be considered:

1. Remove the Makefile patch lines that create the extplorer/usr

   symbolic link, and create an updated package which also removes such

   existing symbolic link on systems that already have the package

   installed. This may however break certain aspects within the eXtplorer

   application, as the symbolic link was created by the package maintainer

   with a purpose (/var/log/apache2/error.log on the server may give

   clues about breakages).

2. Replace the single, high-level, generic /usr/ symbolic link and

   break it down into multiple, narrowed down, lower level symbolic

   links to the specific directories under /usr/ which are used by the

   application (e.g., directories under /usr/share/javascript/).

3. Edit the web server configuration to deny access to the

   /usr/share/extplorer/usr/ directory. This will then however also apply

   to subdirectories under /usr/, which means overriding exclusions should

   be made to still allow requests to specific lower level directories

   under /usr/share/extplorer/usr/ (i.e., /usr/) which are used in HTTP

   client requests by the application (e.g., specific directories under

   /usr/share/javascript/).

4. Deny following of symbolic links within the application directory

   in the web server configuration (e.g., "Options -FollowSymLinks"

   in Apache). This however will also make lower level subdirectories

   under /usr/share/extplorer/usr/ (i.e., /usr/) inaccessible (leading to

   web server errors), as well as will make requests to extplorer/config

   and extplorer/ftp\_tmp (both implemented as symbolic links created by

   the package, replacing equally named directories from the upstream

   sources) fail. The exact implications should thus be considered

   thoroughly, and possibly additional changes should be made to the

   package as well to resolve those implications.

5. Update (re-package) the package based on a more recent upstream source

   version, then obviously without creating the /usr/ symbolic link (and

   implementing an alternative approach for extplorer/usr if that path

   is in fact, and still, needed). A package update is also needed

   since both the Ubuntu 14.04 LTS as well as the Ubuntu 16.04 LTS

   extplorer packages do not work properly out-of-the-box, for example

   due to PHP errors (shown by /var/log/apache2/error.log on the server).

   On Ubuntu 16.04 LTS, which has PHP 7, extplorer/index.php even fails

   right away with a "PHP Fatal warning" due to a call to the undefined

   "set\_magic\_quotes\_runtime()" function (which was removed in PHP 7 [8]).

   Updating the Ubuntu 16.04 LTS package to at least eXtplorer version

   2.1.9, which has PHP 7 support [9], might make the application

   functioning again.

6. Provide an updated package without actual changes but showing a

   clear warning to the server administrator regarding the vulnerability

   of the /usr/ directory being exposed to the world (as well as note

   that in the Makefile patch file). This option could be implemented

   in case the vulnerability turns out not to be fixable on itself.

7. Remove the package from the Ubuntu 14.04 LTS and Ubuntu 16.04 LTS

   package repositories. This option could be implemented in case the

   vulnerability turns out not to be fixable on itself, and would prevent

   new vulnerable installations (but obviously not fix the issue on

   existing installations). It would also make sense since the package

   does not seem to work out-of-the box properly, specifically in the

   case of Ubuntu 16.04 LTS having PHP 7 and the package version of the

   application not having PHP 7 support. Another rationale for this

   option is that the package has already been removed from newer Ubuntu

   releases (as well as newer Debian versions), probably for a reason.

For the issue of .htaccess missing in /etc/extplorer/, the proposed fix

(whether or not combined with a package update based on a more recent

upstream source version) is to let the package (re-)create the file (with

proper permissions). In addition, installation instructions for enabling

the file's content (e.g., "AllowOverride Limit" in Apache), as well as the

same for the extplorer/include/.htaccess file for which such instructions

are missing as well, could best be added to the installation instructions

(for example in the "Setting-up" section in the debian/README.Debian

file, which already contains instructions on adding

"Alias /extplorer /usr/share/extplorer" to the Apache configuration).

REFERENCES

----------

[1] <<https://www.extplorer.net/>>

[2] <<https://packages.ubuntu.com/search?keywords=extplorer>>

[3] <[https://bazaar.launchpad.net/~ubuntu-branches/debian/sid/extplorer/sid/view/head:/debian/patches/adds-a-makefile.patch](https://bazaar.launchpad.net/~ubuntu-branches/debian/sid/extplorer/sid/view/head%3A/debian/patches/adds-a-makefile.patch)> (note: outdated, cloned, repository)

[4] <<https://usn.ubuntu.com/3910-1/>>

[5] <<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=561872>>

[6] <<https://extensions.joomla.org/extension/extplorer/>>

[7] <<https://www.turnkeylinux.org/docs/fileserver>>: "[...] previous versions used eXtplorer for the Web interface"

[8] <<https://www.php.net/manual/en/function.set-magic-quotes-runtime.php>>

[9] <<https://www.extplorer.net/news/19>>

TIMELINE

========

2019-03-28: initial report version (version 1) sent to the Ubuntu Security Team, along with CVE identifier request

CREDIT

======

Sander Bos discovered, analysed, and reported the vulnerabilities

described in this report. Credits are welcomed in documentation relating

to these vulnerabilities including commit messages, releases, patches,

and security advisories.

## CVE References

* [2019-7305](/bugs/cve/2019-7305 "Information Exposure vulnerability in...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2019-04-01: |  |  | [#1](/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/comments/1) |
| --- | --- | --- | --- |

This issue has been assigned CVE-2019-7305

This issue has been assigned CVE-2019-7305

[Alex Murray (alexmurray)](https://launchpad.net/~alexmurray)
on 2019-04-02

| **information type**: | Private Security → Public Security |
| --- | --- |

[Eduardo Barretto (ebarretto)](https://launchpad.net/~ebarretto)
on 2019-06-12

| Changed in extplorer (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/extplorer/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/extplorer/%2Bbug/1822013/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


