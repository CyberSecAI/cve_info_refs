=== Content from packetstormsecurity.com_cc386465_20250121_011119.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from blog.thehive-project.org_941c50cf_20250121_011120.html ===

[Skip to content](#content)
[![TheHive Project](https://blog.thehive-project.org/wp-content/uploads/2017/05/logo-thehive_cortex-v4-13.png)](https://blog.thehive-project.org/)

[TheHive Project](https://blog.thehive-project.org/)

Open Source, Free and Scalable Cyber Threat Intelligence & Security Incident Response Solutions

Menu

* [Home](https://blog.thehive-project.org/)
* [About](https://thehive-project.org)
* [Twitter](https://www.twitter.com/thehive_project)

# UnshortenLink, SSRF and Cortex-Analyzers 1.15.2

[Jérôme Leonard](https://blog.thehive-project.org/author/jeromeleonardwp/ "Posts by Jérôme Leonard")
[Analyzers](https://blog.thehive-project.org/category/analyzers/), [Announcement](https://blog.thehive-project.org/category/announcement/), [Cortex](https://blog.thehive-project.org/category/cortex/), [Responders](https://blog.thehive-project.org/category/responders/), [Security Advisory](https://blog.thehive-project.org/category/security-advisory/)
February 11, 2019

We urge our fellow fighters of cybercrime and funny and not-so-funny animals-in-disguise, to update their Cortex analyzers to the latest [1.15.2](https://github.com/TheHive-Project/Cortex-Analyzers/issues?q=is%3Aclosed+milestone%3A1.15.2) version which plugs a serious vulnerability in the [*Unshortenlink*](https://github.com/TheHive-Project/CortexDocs/blob/master/analyzer_requirements.md#unshortenlink) analyzer and fixes several bugs.

#### Unshortenlink Vulnerability

On Jan 24, Alexandre Basquin discovered a [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery) vulnerability in the *Unshortenlink* 1.0 analyzer. By exploiting it, an attacker which has access to a Cortex instance with an `analyze` role can scan the ports of localhost and possibly of all the hosts reachable by Cortex. This could be automated through Cortex4py by making repetitive calls to the API and thus scanning multiple ports & hosts. In essence, the attacker can perform reconnaissance thanks to *Unshortenlink* and gain knowledge on which ports are open and which aren’t.

Version 1.1 of *Unshortenlink*, included in Cortex-Analyzers 1.15.2, plugs this vulnerability by disabling submissions containing IPs & ports. Only URLs are now accepted.

#### Bug Fixes

Additionally, Cortex-Analyzers 1.15.2 corrects the following bugs:

* #[416](https://github.com/TheHive-Project/Cortex-Analyzers/issues/416): the *Mailer* responder now supports UTF-8 encoding.
* #[410](https://github.com/TheHive-Project/Cortex-Analyzers/issues/410): remove wrapping of the results produced by *crt.sh* as a list which ends up breaking the output of the report template. Contributed by [Thomas Kastner](https://github.com/sprungknoedl).
* #[409](https://github.com/TheHive-Project/Cortex-Analyzers/issues/409): `enum` is not required for Python 3.4+ to make the *MISP Search* analyzer work.
* #[408](https://github.com/TheHive-Project/Cortex-Analyzers/issues/408): FileInfo’s *Manalyze* plugin did not work after *Manalyze* renamed `plugin_btcaddress` to `plugin_cryptoaddress`.
* #[406](https://github.com/TheHive-Project/Cortex-Analyzers/issues/406): fix a broken link in the Cymon\_Check\_IP report, submitted by [Manabu Niseki](https://github.com/ninoseki).
* #[313](https://github.com/TheHive-Project/Cortex-Analyzers/issues/313): fix wrong file handling in OTXQuery.

#### How to Update your Analyzers?

To update your analyzers to version 1.15.2, please read the [Updating](https://github.com/TheHive-Project/CortexDocs/blob/master/installation/install-guide.md#updating) section of the Cortex installation guide.

Since the version numbers of few analyzers have changed, you’ll need to connect as an `orgadmin` to Cortex to refresh the analyzer list, disabling old ones and enabling the new versions.

#### TheHive Report Templates

If you are using TheHive, you must import the new report templates in your instance as follows:

* [download the updated package](https://dl.bintray.com/cert-bdf/thehive/report-templates.zip)
* log in TheHive using an administrator account
* go to `Admin` > `Report templates` menu
* click on `Import templates` button and select the downloaded package

#### Wait a Minute! Where’s the Blog Post about 1.15.1?

Good catch! There was no blog post about Cortex-Analyzers 1.15.1. Call us lazy but there was nothing Earth-shattering, pole-shifting in that release. Nonetheless, here are a list of fixes included in that release and from which you’ll inherit automatically if you update 1.15.0 to 1.15.2 directly:

* #[402](https://github.com/TheHive-Project/Cortex-Analyzers/issues/402): Malwares analyzer code relied on functionality that’s only available in Python 3.7+. It has been fixed to work with 3.4 and up thanks to the work of [Arcuri Davide](https://github.com/dadokkio).
* #[404](https://github.com/TheHive-Project/Cortex-Analyzers/issues/404): fixes a bad folder renaming in the *HIBP* (Have I Been Pwned) analyzer.
* #[398](https://github.com/TheHive-Project/Cortex-Analyzers/pull/398): MISP Search analyzer wouldn’t run without the `enum` dependency. Contributed by [Mars Huang](https://github.com/yojo3000%EF%BB%BF). Later improved in 1.15.2 (see above).

#### No Luck Luke?

If something does not work as expected, keep calm and ask on our [user forum](https://groups.google.com/a/thehive-project.org/forum/#!forum/users), reach out to fellow users on [Gitter](https://gitter.im/TheHive-Project/TheHive), or send us an email at support@thehive-project.org.

### Share this:

* [Twitter](https://blog.thehive-project.org/2019/02/11/unshortenlink-ssrf-and-cortex-analyzers-1-15-2/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.thehive-project.org/2019/02/11/unshortenlink-ssrf-and-cortex-analyzers-1-15-2/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

* Tagged
* [Alexandre Basquin](https://blog.thehive-project.org/tag/alexandre-basquin/)
* [Analysis](https://blog.thehive-project.org/tag/analysis/)
* [Analysis Engine](https://blog.thehive-project.org/tag/analysis-engine/)
* [Analyzer](https://blog.thehive-project.org/tag/analyzer/)
* [Analyzers](https://blog.thehive-project.org/tag/analyzers/)
* [Bug](https://blog.thehive-project.org/tag/bug/)
* [Cortex](https://blog.thehive-project.org/tag/cortex/)
* [crt.sh](https://blog.thehive-project.org/tag/crt-sh/)
* [CTI](https://blog.thehive-project.org/tag/cti/)
* [Cyber Threat Intelligence](https://blog.thehive-project.org/tag/cyber-threat-intelligence/)
* [DFIR](https://blog.thehive-project.org/tag/dfir/)
* [Digital Forensics](https://blog.thehive-project.org/tag/digital-forensics/)
* [FileInfo](https://blog.thehive-project.org/tag/fileinfo/)
* [FOSS](https://blog.thehive-project.org/tag/foss/)
* [Free](https://blog.thehive-project.org/tag/free/)
* [Have I Been Pwned](https://blog.thehive-project.org/tag/have-i-been-pwned/)
* [Incident Response](https://blog.thehive-project.org/tag/incident-response/)
* [Mailer](https://blog.thehive-project.org/tag/mailer/)
* [Malware Information Sharing Platform](https://blog.thehive-project.org/tag/malware-information-sharing-platform/)
* [Malwares](https://blog.thehive-project.org/tag/malwares/)
* [Manabu Niseki](https://blog.thehive-project.org/tag/manabu-niseki/)
* [Manalyze](https://blog.thehive-project.org/tag/manalyze/)
* [MISP](https://blog.thehive-project.org/tag/misp/)
* [Open Source](https://blog.thehive-project.org/tag/open-source/)
* [Patch](https://blog.thehive-project.org/tag/patch/)
* [Python](https://blog.thehive-project.org/tag/python/)
* [Python2](https://blog.thehive-project.org/tag/python2/)
* [Python3](https://blog.thehive-project.org/tag/python3/)
* [Responder](https://blog.thehive-project.org/tag/responder/)
* [Responders](https://blog.thehive-project.org/tag/responders/)
* [Scala](https://blog.thehive-project.org/tag/scala/)
* [Scanning](https://blog.thehive-project.org/tag/scanning/)
* [Security](https://blog.thehive-project.org/tag/security/)
* [Security Events](https://blog.thehive-project.org/tag/security-events/)
* [Security Incidents](https://blog.thehive-project.org/tag/security-incidents/)
* [Security Operations Center](https://blog.thehive-project.org/tag/security-operations-center/)
* [Security Orchestration Automation & Response](https://blog.thehive-project.org/tag/security-orchestration-automation-response/)
* [Security Vulnerability](https://blog.thehive-project.org/tag/security-vulnerability/)
* [SOAR](https://blog.thehive-project.org/tag/soar/)
* [SSRF](https://blog.thehive-project.org/tag/ssrf/)
* [Thomas Kastner](https://blog.thehive-project.org/tag/thomas-kastner/)
* [Unshortenlink](https://blog.thehive-project.org/tag/unshortenlink/)
* [Update](https://blog.thehive-project.org/tag/update/)
* [Vulnerability](https://blog.thehive-project.org/tag/vulnerability/)

![](https://0.gravatar.com/avatar/cd972c03910d93b92716dce36144ee9ffd9d9bd3a6cf8542cf3167e36b3854f3?s=80&d=identicon&r=G)
## Published by Jérôme Leonard

[View all posts by Jérôme Leonard](https://blog.thehive-project.org/author/jeromeleonardwp/)

**Published**
February 11, 2019

## Post navigation

[Previous Post TheHive 3.3-RC2, Hot out of the Oven](https://blog.thehive-project.org/2019/02/10/thehive-3-3-rc2-hot-out-of-the-oven/)[Next Post The Dockerization Will not be Televised](https://blog.thehive-project.org/2019/02/14/the-dockerization-will-not-be-televised/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) TheHive Project](https://blog.thehive-project.org)

  Join 56 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.thehive-project.org%252F2019%252F02%252F11%252Funshortenlink-ssrf-and-cortex-analyzers-1-15-2%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) TheHive Project](https://blog.thehive-project.org)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.thehive-project.org%252F2019%252F02%252F11%252Funshortenlink-ssrf-and-cortex-analyzers-1-15-2%252F)
  + [Copy shortlink](https://wp.me/p850ZE-1dG)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.thehive-project.org/2019/02/11/unshortenlink-ssrf-and-cortex-analyzers-1-15-2/)
  + [View post in Reader](https://wordpress.com/read/blogs/119406150/posts/4692)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)


