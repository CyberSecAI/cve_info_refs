- **Root cause of vulnerability:** The KaTeX library, used for rendering math in Markdown, allows the use of the `\href` command with `javascript:` links, which are not sanitized, leading to the execution of arbitrary JavaScript code.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The vulnerability exists due to insufficient input sanitization in the KaTeX library when rendering Markdown with the `\href` command.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code into GitLab's Markdown that will be executed when a user clicks on a crafted link, potentially leading to data theft, session hijacking, or other malicious actions.
- **Attack vectors:** By injecting a `\href` tag with a `javascript:` URI into a markdown comment, snippet, or other user-editable field.
- **Required attacker capabilities/position:** The attacker needs to be able to post content to a markdown field, and the victim needs to click on the crafted link.