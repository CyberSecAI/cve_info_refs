=== Content from lists.debian.org_1244bfac_20250120_232712.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3376-1] svgpp security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3376-1] svgpp security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Sat, 1 Apr 2023 18:15:18 +0200
* *Message-id*: <[[üîé]](/msgid-search/20230401161722.EA68B4A02B0%40localhost.localdomain)¬†[20230401161722.EA68B4A02B0@localhost.localdomain](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3376-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
March 31, 2023                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : svgpp
Version        : 1.2.3+dfsg1-6+deb10u1
CVE ID         : CVE-2019-6245 CVE-2019-6247 CVE-2021-44960

Multiple security issues were discovered in svgpp: a C++ library for parsing and
rendering Scalable Vector Graphics (SVG) files.

CVE-2021-44960
   The XMLDocument::getRoot function in the renderDocument function handled the
   XMLDocument object improperly. Specifically, it returned a null pointer
   prematurely at the second if statement, resulting in a null pointer
   reference behind the renderDocument function.

CVE-2019-6245 and CVE-2019-6247:
   issues were discovered in Anti-Grain Geometry (AGG) within the function
   agg::cell_aa::not_equal. Since svgpp is a header-only library, the issue is
   only transitive in theory. As a result, only a dependency version hardening
   has been added to the control file.

For Debian 10 buster, these problems have been fixed in version
1.2.3+dfsg1-6+deb10u1.

We recommend that you upgrade your svgpp packages.

For the detailed security status of svgpp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/svgpp>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmQoWJMACgkQ0+Fzg8+n
/wb9exAAl1LsKmtRibU1i6ffoQQkdzYr++yGd/4HP6IgU6DGn7/1mWMZOI5sRqVr
Xf7/aIO/E90LhflKQlLD9U/CIVRv1I8IoOnx+FzgO04sbAhgStE95BK8G2ecWQFj
f2oSFEnLcpS3V1Axad5WQGTfzphKCUMbN9o3McFvirhYQIPyKTGQrf0OopYK/bYA
SHNLuIP4MpasTcdjCpEXWCO6HqM7hhRYxxKf5oWhJtCuP3WfIL2P5sdrYr4ZevSj
8snonvzqK4DCLIDy/N0XIwDuKfotFl9h42fmqJbHKNdBu1jaLYL8xqkgu6/NyvTf
MiqJRA/JS3AG1yYv58R0/tOmJcIigCbSFE3TPvHSLmVeIAMQdfdVaS1Nq/NO5405
/ouj4lQhFSklh5WkhnJQp9F9tA/dICTMGcoY8OZUhY07Jp3OPHqOCIXC1+q2gwd2
baBTiUNE0rVs726mLZoghKnGNugsWSCOjLJWDq5zAXlWo6XCzEwkwEZR5Ge8wATd
i69ZORt5O5DsPmfFSGpKyplr/VAmgHrUzUxusiNcpBTVJ6Ips4jGRZ8u6VRh6+dE
5Lsqg3CZo9YGnnH/kmOLni7iBb4pbml97MmjG90QH8q2QaAgQ/32S5v756dBSWdc
uXX2Yh29CxXOnhdEsgzcnkIrbNfzXgjBKX1X4ucFA9UlZyxZAxI=
=Ogx9
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_a18b4d51_20250120_232712.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsvgpp%2Fsvgpp%2Fissues%2F70)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsvgpp%2Fsvgpp%2Fissues%2F70)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=svgpp%2Fsvgpp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[svgpp](/svgpp)
/
**[svgpp](/svgpp/svgpp)**
Public

* [Notifications](/login?return_to=%2Fsvgpp%2Fsvgpp) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fsvgpp%2Fsvgpp)
* [Star
   559](/login?return_to=%2Fsvgpp%2Fsvgpp)

* [Code](/svgpp/svgpp)
* [Issues
  25](/svgpp/svgpp/issues)
* [Pull requests
  0](/svgpp/svgpp/pulls)
* [Actions](/svgpp/svgpp/actions)
* [Projects
  0](/svgpp/svgpp/projects)
* [Wiki](/svgpp/svgpp/wiki)
* [Security](/svgpp/svgpp/security)
* [Insights](/svgpp/svgpp/pulse)

Additional navigation options

* [Code](/svgpp/svgpp)
* [Issues](/svgpp/svgpp/issues)
* [Pull requests](/svgpp/svgpp/pulls)
* [Actions](/svgpp/svgpp/actions)
* [Projects](/svgpp/svgpp/projects)
* [Wiki](/svgpp/svgpp/wiki)
* [Security](/svgpp/svgpp/security)
* [Insights](/svgpp/svgpp/pulse)

# 4 bugs found in svgpp¬†#70

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[4 bugs found in svgpp](#top)#70Copy link![@ghost](https://github.com/ghost.png?size=80)
## Description

![@ghost](https://github.com/ghost.png?size=48)[ghost](/ghost)opened [on Jan 12, 2019](https://github.com/svgpp/svgpp/issues/70#issue-398546864)
### bug1: an oob-read bug

**description**

A type confusion bug lead to out-of-bound read in src/demo/svgpp\_agg\_render. buffer.pixfmt() should return a reference to pixfmt\_alpha\_blend\_rgba but instead return some struct that look like a long+string. That is why it crashes when it simply get the member stride. This bug may be used in info-leak.

**poc**

<https://drive.google.com/open?id=1J1jMmXyUyDNfDnAG2I8u7DsFirFo2eSD>

**asan**

<https://drive.google.com/open?id=1ZRbEzqun8BkGdXsRAG6tKsjd7v2gWbnV>

**details**

The crash happened in src/demo/svgpp\_agg\_render

<https://github.com/svgpp/svgpp/blob/master/src/demo/render/svgpp_render.cpp#L1705>

Looks like type confusion. buffer.pixfmt() should return a reference to pixfmt\_alpha\_blend\_rgba but instead return some struct that look like a long+string. That is why it crashes when it simply get the member stride

This is a out of bound read bug.

### bug2: a heap-buffer-overflow bug

**description**

An heap buffer overflow bug in svgpp\_agg\_render which may lead to code excution. In the render\_scanlines\_aa\_solid function, the blend\_hline function is called repeatedly multiple times. blend\_hline is equivalent to the process of loop writing. Each call will write a piece of heap data, and multiple calls will overwrite the data in the heap.

**poc**

<https://drive.google.com/open?id=1f4Eh4ozzTwQ3jqWAONuam0rl_YO5io6l>

**asan**

<https://drive.google.com/open?id=1l906xNqzpjNKxNkVMHRJsBHYQRSOIuFE>

**details**

here is a heap overflow here, the specific function call process is as follows:

ClipBuffer::ClipBuffer(clip\_buffer.cpp) ---------------->

render\_scanlines\_aa\_solid(agg\_renderer\_scanline.h)------Multiple calls in a loop------> blend\_hline(agg\_renderer\_base.h) ------------>

blend\_hline(agg\_pixfmt\_gray.h)

In the render\_scanlines\_aa\_solid function, the blend\_hline function is called repeatedly multiple times.

blend\_hline is equivalent to the process of loop writing. Each call will write a piece of heap data, and multiple calls will overwrite the data in the heap.

[svgpp/third\_party/agg/include/agg\_pixfmt\_gray.h](https://github.com/svgpp/svgpp/blob/a33934adf6c4105f668f4348f2fa0eac72b46328/third_party/agg/include/agg_pixfmt_gray.h#L281)

Line 281
in
[a33934a](/svgpp/svgpp/commit/a33934adf6c4105f668f4348f2fa0eac72b46328)

|  | void blend\_hline(int x, int y, |
| --- | --- |

In the render\_scanlines\_aa\_solid function, there is no explicit restriction on the 'for' loop. After calling blend\_hline multiple times, it causes a heap overflow.

This bug is also found in agg\_pixfmt\_rgb.h, agg\_pixfmt\_rgb\_packed.h, agg\_pixfmt\_rgba.h, agg\_pixfmt\_transposer.h.
### bug3: a stack overflow bug

**description**

in the function agg::cell\_aa::not\_equal, dx is assigned to (x2 - x1). if dx >= dx\_limit, which is (16384 << poly\_subpixel\_shift). This function will call itself recursively.

There will be a sitaution when (x2 - x1) always bigger than dx\_limit during the recursion

Thats how the stack-overflow happened. This bug mat lead to code execution.

**poc**

<https://drive.google.com/open?id=1Ejzmnrk6WhUMQT6O6qfRy0dGF82kgl5X>

**asan**

<https://drive.google.com/open?id=17gPhe2-zJLSOFyx4PmpWdx1jeRYcvK2s>

**details**

in the function agg::cell\_aa::not\_equal

```
 template<class Cell>
    void rasterizer_cells_aa<Cell>::line(int x1, int y1, int x2, int y2)
    {
        enum dx_limit_e { dx_limit = 16384 << poly_subpixel_shift };

        int dx = x2 - x1;

        if(dx >= dx_limit || dx <= -dx_limit)
        {
            int cx = (x1 + x2) >> 1;
            int cy = (y1 + y2) >> 1;
            line(x1, y1, cx, cy);
            line(cx, cy, x2, y2);
        }

int dy = y2 - y1;

```

dx is assigned to (x2 - x1)

if dx >= dx\_limit, which is (16384 << poly\_subpixel\_shift). This function will call itself recursively.

There will be a sitaution when (x2 - x1) always bigger than dx\_limit during the recursion

Thats how the stack-overflow happened.

### bug4: a oob-read bug

**description**

After callng gil::get\_color function in the boost library, the return code is used as an address.

Thus it caused an Violation Access. This may lead to an out-of-bound read.

**poc**

<https://drive.google.com/open?id=1o1EqHQ6sjY68IRH24yokqYqgTMHSOqe6>

**asan**

<https://drive.google.com/open?id=1gYkV4ql71p6xN43aBa3JxBxLAwsprkEh>

**details**

```
gil::get_color(result, gil::green_t())
      = gil_detail::blend_channel_fn<BlendModeTag, typename gil::color_element_type<Color, gil::green_t>::type>()(
        gil::get_color(pixa, gil::green_t()), gil::get_color(pixb, gil::green_t()),
alpha_a, alpha_b);

```

After callng gil::get\_color function in the boost library, the return code is used as an address.

Thus it caused an Violation Access.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from wiki.debian.org_8d48714b_20250121_013239.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Espa√±ol](/es/LTS) - [Fran√ßais](/fr/LTS) - [Italiano](/it/LTS) - [ÌïúÍµ≠Ïñ¥](/ko/LTS) - [Portugu√™s](/pt/LTS) - [Portugu√™s (Brasil)](/pt_BR/LTS) - [–†—É—Å—Å–∫–∏–π](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).


