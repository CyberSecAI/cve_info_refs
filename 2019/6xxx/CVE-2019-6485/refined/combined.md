=== Content from github.com_29e4d0ef_20250120_234549.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftls-attacker%2FTLS-Padding-Oracles)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftls-attacker%2FTLS-Padding-Oracles)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=tls-attacker%2FTLS-Padding-Oracles)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tls-attacker](/tls-attacker)
/
**[TLS-Padding-Oracles](/tls-attacker/TLS-Padding-Oracles)**
Public

* [Notifications](/login?return_to=%2Ftls-attacker%2FTLS-Padding-Oracles) You must be signed in to change notification settings
* [Fork
  15](/login?return_to=%2Ftls-attacker%2FTLS-Padding-Oracles)
* [Star
   124](/login?return_to=%2Ftls-attacker%2FTLS-Padding-Oracles)

New TLS Padding Oracles

[124
stars](/tls-attacker/TLS-Padding-Oracles/stargazers) [15
forks](/tls-attacker/TLS-Padding-Oracles/forks) [Branches](/tls-attacker/TLS-Padding-Oracles/branches) [Tags](/tls-attacker/TLS-Padding-Oracles/tags) [Activity](/tls-attacker/TLS-Padding-Oracles/activity)
 [Star](/login?return_to=%2Ftls-attacker%2FTLS-Padding-Oracles)

 [Notifications](/login?return_to=%2Ftls-attacker%2FTLS-Padding-Oracles) You must be signed in to change notification settings

* [Code](/tls-attacker/TLS-Padding-Oracles)
* [Issues
  0](/tls-attacker/TLS-Padding-Oracles/issues)
* [Pull requests
  0](/tls-attacker/TLS-Padding-Oracles/pulls)
* [Actions](/tls-attacker/TLS-Padding-Oracles/actions)
* [Projects
  0](/tls-attacker/TLS-Padding-Oracles/projects)
* [Security](/tls-attacker/TLS-Padding-Oracles/security)
* [Insights](/tls-attacker/TLS-Padding-Oracles/pulse)

Additional navigation options

* [Code](/tls-attacker/TLS-Padding-Oracles)
* [Issues](/tls-attacker/TLS-Padding-Oracles/issues)
* [Pull requests](/tls-attacker/TLS-Padding-Oracles/pulls)
* [Actions](/tls-attacker/TLS-Padding-Oracles/actions)
* [Projects](/tls-attacker/TLS-Padding-Oracles/projects)
* [Security](/tls-attacker/TLS-Padding-Oracles/security)
* [Insights](/tls-attacker/TLS-Padding-Oracles/pulse)

# tls-attacker/TLS-Padding-Oracles

    master[Branches](/tls-attacker/TLS-Padding-Oracles/branches)[Tags](/tls-attacker/TLS-Padding-Oracles/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[16 Commits](/tls-attacker/TLS-Padding-Oracles/commits/master/) | | |
| [img](/tls-attacker/TLS-Padding-Oracles/tree/master/img "img") | | [img](/tls-attacker/TLS-Padding-Oracles/tree/master/img "img") |  |  |
| [README.md](/tls-attacker/TLS-Padding-Oracles/blob/master/README.md "README.md") | | [README.md](/tls-attacker/TLS-Padding-Oracles/blob/master/README.md "README.md") |  |  |
| [TlsPaddingOracleScanning.pdf](/tls-attacker/TLS-Padding-Oracles/blob/master/TlsPaddingOracleScanning.pdf "TlsPaddingOracleScanning.pdf") | | [TlsPaddingOracleScanning.pdf](/tls-attacker/TLS-Padding-Oracles/blob/master/TlsPaddingOracleScanning.pdf "TlsPaddingOracleScanning.pdf") |  |  |
| View all files | | |

## Repository files navigation

* README
# TLS Padding Oracles

The TLS protocol provides encryption, data integrity, and authentication on the modern Internet. Despite the protocol’s importance, currently-deployed TLS versions use obsolete cryptographic algorithms which have been broken using various attacks. One prominent class of such attacks is CBC padding oracle attacks. These attacks allow an adversary to decrypt TLS traffic by observing different server behaviors which depend on the validity of CBC padding.

We evaluated the Alexa Top Million Websites for CBC padding oracle vulnerabilities in TLS implementations and revealed vulnerabilities in 1.83% of them, detecting nearly 100 different vulnerabilities. These padding oracles stem from subtle differences in server behavior, such as responding with different TLS alerts, or with different TCP header flags.
We suspect the subtlety of different server responses is the reason these padding oracles were not detected previously.

## Full Technical Paper

Robert Merget, Juraj Somorovsky, Nimrod Aviram, Craig Young, Janis Fliegenschmidt, Jörg Schwenk, Yuval Shavitt: *Scalable Scanning and Automatic Classification of TLS Padding Oracle Vulnerabilities.* USENIX Security 2019

[Link](https://www.usenix.org/system/files/sec19-merget.pdf)

## Presentations

* Blackhat Asia 2019. Zombie POODLE, GOLDENDOODLE, and How TLSv1.3 Can Save Us All. [website](https://www.blackhat.com/asia-19/), [slides](http://i.blackhat.com/asia-19/Fri-March-29/bh-asia-Young-Zombie-Poodle-Goldendoodle-and-How-TLSv13-Can-Save-Us-All.pdf)
* Summer School on real-world crypto and privacy 2019. Scalable Scanning and Automatic Classification of TLS Padding Oracle Vulnerabilities. [website](https://summerschool-croatia.cs.ru.nl/2019/), [slides](https://summerschool-croatia.cs.ru.nl/2019/slides/somorovsky1.pdf)

## Who Is Affected?

Since the identification of different vendors is fairly difficult and requires the cooperation of the scanned websites, a lot of our vulnerabilities are not attributed yet. On this Github page, we collect the current status of the responsible disclosure process and give an overview of the revealed vulnerabilities.

The currently identified and fixed vulnerabilities are:

* OpenSSL. CVE-2019-1559. [OpenSSL Security Advisory: 0-byte record padding oracle](https://www.openssl.org/news/secadv/20190226.txt)
* Citrix. CVE-2019-6485. [TLS Padding Oracle Vulnerability in Citrix Application Delivery Controller (ADC) and NetScaler Gateway](https://support.citrix.com/article/CTX240139).
* F5. CVE-2019-6593. [TMM TLS virtual server vulnerability CVE-2019-6593](https://support.f5.com/csp/article/K10065173).
* SonicWall SonicOs. CVE-2019-7477. [SonicOS & SonicOSv CBC Cipher TLS Padding Vulnerability](https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2019-0003).
* Oracle HTTP Server. [Oracle Critical Patch Update Advisory - July 2019](https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html)

The disclosure process is still running with a handful of vendors. Some of them consider to disable or even completely remove CBC cipher suites from their products.

## Recommendations for TLS Implementations Developers

If you are developing a TLS implementation, this is obviously a good reminder to review your CBC code and make sure it does not expose a padding oracle; obviously, this is easier said than done.
We therefore invite developers of TLS implementations to contact us in this matter. We will evaluate your implementation and if you are vulnerable, work with you to understand the nature of the vulnerability ([contact](https://www.nds.ruhr-uni-bochum.de/chair/people/merget/)).

You can now also use our [TLS-Scanner](https://github.com/RUB-NDS/TLS-Scanner) directly to evaluate your implementation. TLS-Scanner also includes a vulnerability fingerprint, which allows you to detect the underlying vulnerable implementation, see an example below.

[![TLS vulnerability fingerprint](https://github.com/RUB-NDS/TLS-Padding-Oracles/raw/master/img/fingerprint.png)](https://github.com/RUB-NDS/TLS-Padding-Oracles/blob/master/img/fingerprint.png)

If you find a vulnerable implementation, which is not known to our tool, please contact us.

## Background

### Cipher Block Chaining (CBC) mode of operation

The CBC mode of operation allows one to encrypt plaintexts of arbitrary length with block ciphers like AES or 3DES. In CBC mode, each plaintext block is XOR’ed to the previous ciphertext block before being encrypted by the block cipher. We simply refer to [Wikipedia](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#CBC) for more information.

Padding oracle attacks exploit the CBC malleability. The problem of CBC is that it allows an attacker to perform meaningful plaintext modifications without knowing the symmetric key. More concretely, it allows an attacker to flip a specific plaintext bit by flipping a bit in the previous ciphtertext block. This CBC property has already been exploited in many attacks, for example, most recently in the [Efail attack](https://efail.de/).

### CBC and its usage in the TLS record layer

In order to protect messages (records) exchanged between TLS peers, it is possible to use different cryptographic primitives. One of them is a MAC combined with AES in CBC mode of operation. Unfortunately, TLS decided to use the MAC-then-PAD-then-Encrypt mechanism, which means that the encryptor first computes a MAC over the plaintext, then pads the message to achieve a multiple of block length, and finally uses AES-CBC to encrypt the ciphertext.

For example, if we want to encrypt five bytes of data and use HMAC-SHA (with 20 bytes long output), we end up with two blocks. The second block needs to be padded with 7 bytes 0x06.
[![Validly formatted MAC and padding](https://github.com/RUB-NDS/TLS-Padding-Oracles/raw/master/img/valid-mac-padding.png)](https://github.com/RUB-NDS/TLS-Padding-Oracles/blob/master/img/valid-mac-padding.png)

### Padding oracle attacks

In 2002, Vaudenay showed that revealing padding failures after message decryption could have severe consequences for the security of the application. Since the CBC malleability allows an attacker to flip arbitrary message bytes, the attacker is also able to modify specific padding bytes. If the application decrypts the modified message and reports problems related to padding validity, the attacker is able to learn the underlying plaintext. We refer to [this explanation by Erlend Oftedal](https://www.youtube.com/watch?v=VQRHSecu_aw&feature=youtu.be&t=1033) for more details.

In TLS, the attack is a bit more complex because the targeted TLS connection is always closed once invalid padding is triggered. Nevertheless, the vulnerability is practically exploitable in [BEAST](https://nerdoholic.org/uploads/dergln/beast_part2/ssl_jun21.pdf) scenarios and allows the attacker to decrypt repeated secrets like session cookies.

Therefore, it is very important that the TLS implementations do not reveal any information about padding validity. This includes different TLS alerts, connection states, or even timing behavior.

## Vulnerability Details

### OpenSSL (CVE-2019-1559)

With the help of the Amazon security team, we identified a vulnerability which was mostly found on Amazon servers and Amazon Web Services (AWS). Hosts affected by this vulnerability immediately respond to most records with BAD\_RECORD\_MAC and CLOSE\_NOTIFY alerts, and then close the connection. However, if the hosts encounter a zero-length record with valid padding and a MAC present, they do not immediately close the TCP connection, regardless of the validity of the MAC. Instead, they keep the connection alive for more than 4 seconds after sending the CLOSE\_NOTIFY alert. This difference in behavior is easily observable over the network. Note that the MAC value does not need to be correct for triggering this timeout, it is sufficient to create valid padding which causes the decrypted data to be of zero length.

Further investigations revealed that the Amazon servers were running an implementation which uses the OpenSSL 1.0.2 API. In some cases, the function calls to the API return different error codes depending on whether a MAC or padding error occurred. The Amazon application then takes different code paths based on these error codes, and the different paths result in an observable difference in the TCP layer. The vulnerable behavior only occurs when AES-NI is not used.

### Citrix (CVE-2019-6485)

The vulnerable Citrix implementations first check the last padding byte and then verify the MAC. If the MAC is invalid, the server closes the connection. This is done with either a connection timeout or an RST, depending on the validity of the remaining padding bytes. However, if the MAC is valid, the server checks whether all other remaining padding bytes are correct. If they are not, the server responds with a BAD\_RECORD\_MAC and an RST (if they are valid, the record is well-formed and is accepted). This behavior can be exploited with an attack similar to POODLE.

## FAQ

### Can these vulnerabilities be exploited?

Yes, but exploitation is fairly difficult. If you use one of the above implementations, you should still make sure you have patched.

To be more specific, the attack can be exploited in [BEAST](https://nerdoholic.org/uploads/dergln/beast_part2/ssl_jun21.pdf) scenarios. There are two prerequisites for the attack. First, the attacker must be able to run a script in the victim's browser which sends requests to a vulnerable website. This can be achieved tempting the victim to visit a malicious website. Second, the attacker must be able to modify requests sent by the browser and observe the server behavior. The second prerequisite is much harder to achieve, because the attacker must be an active Man-in-the-Middle.

### Have these vulnerabilities actually been exploited?

We have no reason to believe these vulnerabilities have been exploited in the wild so far.

### I used a vulnerable implementation. Do I need to revoke my certificate?

No, this attack does not recover the server's private key.

### Do I need to update my browser?

No. These are server-side vulnerabilities, and can only be fixed by deploying a fix on the server.

### How many implementations are vulnerable?

Our Alexa scans identified more than 90 different server behaviors triggered in our padding oracle scans. Some of them will probably be caused by outdated servers. However, we assume many of the newest servers will need fixes.

### How is this related to previous research?

In 2002, Vaudenay presented an
[attack](https://link.springer.com/content/pdf/10.1007/3-540-46035-7_35.pdf)
which targets messages encrypted with the CBC mode of operation. The attack exploits the malleability of the CBC mode, which allows altering the ciphertext such that specific cleartext bits are flipped, without knowledge of the encryption key. The attack requires a server that decrypts a message and responds with 1 or 0 based on the message validity. This behavior essentially provides the attacker with a cryptographic oracle which can be used to mount an adaptive chosen-ciphertext attack. The attacker exploits this behavior to decrypt messages by executing adaptive queries. Vaudenay exploited a specific form of vulnerable behavior, where implementations validate the CBC padding structure and respond with 1 or 0 accordingly.

This class of attacks has been termed padding oracle attacks. Different types of CBC padding oracles have been used to break the confidentiality of TLS connections. These include
[Lucky Thirteen](http://www.isg.rhul.ac.uk/tls/TLStiming.pdf),
[Lucky Microseconds](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.738.4741&rep=rep1&type=pdf),
[Lucky 13 Strikes Back](http://v.wpi.edu/wp-content/uploads/Papers/Publications/asiaccs2015_lucky.pdf),
and [Ronen et al](https://eprint.iacr.org/2018/747.pdf).

Another important attack is [POODLE](https://www.openssl.org/~bodo/ssl-poodle.pdf) (Padding Oracle On Downgraded Legacy Encryption) which targets SSLv3 and its specific padding scheme. In SSLv3 only the last padding byte is checked. Möller, Duong and Kotowicz exploited this behavior and showed that for implementation it is necessary to correctly verify *all* padding bytes. Similar behaviors were found in several TLS implementations.

### How is it possible that such an old vulnerability is still present in 2019?

Writing this code correctly is very hard, even for experts.
For example, in one instance experts have introduced
[a severe form of this vulnerability](https://www.nds.ruhr-uni-bochum.de/media/nds/veroeffentlichungen/2016/10/19/tls-attacker-ccs16.pdf)
while attempting to patch the code to eliminate it.

Identifying these vulnerabilities is also hard since some of them only manifest under a combination of specific conditions. For example, the OpenSSL vulnerability only manifests in OpenSSL version 1.0.2, only for non-stitched [1] cipher suites, when AES-NI is not used.
It also requires subtle interactions between external code that calls the OpenSSL API, and the OpenSSL code itself.

We take this opportunity to suggest deprecating CBC cipher suites in TLS altogether.

[1]: Stitched ciphersuites is an OpenSSL term for optimised implementations of certain commonly used ciphersuites.
See [here](https://software.intel.com/en-us/articles/improving-openssl-performance) for more details.

### Why are you not submitting your findings via BugBounty websites?

We tried to get in contact with security teams via common BugBounty sites but had very bad experiences. Man-in-the-Middle attacks are usually out of scope for most website owners, and security teams did not know how to deal with this kind of issue. We lost a lot of "Points" on Hackerone and BugCrowd for reporting such issues (with the intention to learn the vendor) and learned absolutely nothing by doing this. All in all a very frustrating experience. We hope that our new approach of disclosure is more useful to get in contact with developers and vendors.

### Can this attack be used against Bitcoin?

No. This attack is based on the vulnerability present in the Cipher Block Chaining (CBC) mode of operation. Bitcoin does not use CBC. However, if you are a blockchain designer, we strongly recommend you to evaluate the security of your block chaining technology and, especially, its padding scheme.

### Do you have a name or a logo for this vulnerability?

No. Sorry, not this time.

## About

New TLS Padding Oracles

### Resources

[Readme](#readme-ov-file)

[Activity](/tls-attacker/TLS-Padding-Oracles/activity)
[Custom properties](/tls-attacker/TLS-Padding-Oracles/custom-properties)
### Stars

[**124**
stars](/tls-attacker/TLS-Padding-Oracles/stargazers)
### Watchers

[**14**
watching](/tls-attacker/TLS-Padding-Oracles/watchers)
### Forks

[**15**
forks](/tls-attacker/TLS-Padding-Oracles/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ftls-attacker%2FTLS-Padding-Oracles&report=tls-attacker+%28user%29)

## [Releases](/tls-attacker/TLS-Padding-Oracles/releases)

No releases published

## [Packages 0](/orgs/tls-attacker/packages?repo_name=TLS-Padding-Oracles)

No packages published

## [Contributors 2](/tls-attacker/TLS-Padding-Oracles/graphs/contributors)

* [![@jurajsomorovsky](https://avatars.githubusercontent.com/u/6516684?s=64&v=4)](https://github.com/jurajsomorovsky)
  [**jurajsomorovsky**
  Juraj Somorovsky](https://github.com/jurajsomorovsky)
* [![@nimia](https://avatars.githubusercontent.com/u/1431313?s=64&v=4)](https://github.com/nimia)
  [**nimia**
  Nimrod Aviram](https://github.com/nimia)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openssl.org_cf1ea3b1_20250121_015154.html ===
OpenSSL Security Advisory [26 February 2019]
============================================
0-byte record padding oracle (CVE-2019-1559)
============================================
Severity: Moderate
If an application encounters a fatal protocol error and then calls
SSL\_shutdown() twice (once to send a close\_notify, and once to receive one) then
OpenSSL can respond differently to the calling application if a 0 byte record is
received with invalid padding compared to if a 0 byte record is received with an
invalid MAC. If the application then behaves differently based on that in a way
that is detectable to the remote peer, then this amounts to a padding oracle
that could be used to decrypt data.
In order for this to be exploitable "non-stitched" ciphersuites must be in use.
Stitched ciphersuites are optimised implementations of certain commonly used
ciphersuites. Also the application must call SSL\_shutdown() twice even if a
protocol error has occurred (applications should not do this but some do
anyway). AEAD ciphersuites are not impacted.
This issue does not impact OpenSSL 1.1.1 or 1.1.0.
OpenSSL 1.0.2 users should upgrade to 1.0.2r.
This issue was discovered by Juraj Somorovsky, Robert Merget and Nimrod Aviram,
with additional investigation by Steven Collison and Andrew Hourselt. It was
reported to OpenSSL on 10th December 2018.
Note: Advisory updated to make it clearer that AEAD ciphersuites are not impacted.
Note
====
OpenSSL 1.0.2 and 1.1.0 are currently only receiving security updates. Support
for 1.0.2 will end on 31st December 2019. Support for 1.1.0 will end on 11th
September 2019. Users of these versions should upgrade to OpenSSL 1.1.1.
References
==========
URL for this Security Advisory:
https://www.openssl.org/news/secadv/20190226.txt
Note: the online version of the advisory may be updated with additional details
over time.
For details of OpenSSL severity classifications please see:
https://www.openssl.org/policies/secpolicy.html

