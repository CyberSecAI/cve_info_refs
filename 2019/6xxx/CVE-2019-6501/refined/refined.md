```
{
  "CVE-2019-6501": {
    "description": "QEMU: scsi-generic: possible OOB access while handling inquiry request",
    "root_cause": "An out-of-bounds read/write access issue was found in the way QEMU handled inquiry requests coming from a guest in `scsi_handle_inquiry_reply()`. Specifically, the code did not properly check the allocation length of a SCSI request against the size of the VPD page list. This could result in a guest user/process corrupting a byte of QEMU process memory.",
    "weaknesses": [
      "Out-of-bounds read/write"
    ],
    "impact": "A guest user/process could use this flaw to corrupt a byte of QEMU process memory, potentially leading to a crash or other undefined behavior.",
    "attack_vectors": [
      "A malicious guest can send a crafted inquiry request to the SCSI device.",
      "The vulnerability is reachable through the network."
    ],
    "required_capabilities": "The attacker needs to have a user/process inside a guest VM with the ability to send SCSI commands.",
     "additional_details": "The issue is related to how QEMU handles the VPD (Vital Product Data) page list. When the allocation length of a SCSI request is shorter than the size of the VPD page list, `page_idx` is used blindly to index into `r->buf` in `scsi_handle_inquiry_reply`. Although stores in the insertion sort are protected against overflows, reads and the final store of `0xb0` are not. This could lead to an out-of-bounds write or read."
  }
}
```