```
{
  "CVE-2019-6724": {
    "related_content": [
      {
        "source": "blog.mirch.io_8ffe6fc6_20250121_032045.html",
        "vulnerability": {
          "root_cause": "The Barracuda VPN client, prior to version 5.0.2.7, loads libraries from a path that can be influenced by an environment variable (OPENSSL_ENGINES).",
          "weaknesses": [
            "Uncontrolled search path for libraries",
             "Privileged process loads libraries from user-controlled path"
          ],
          "impact": "Arbitrary code execution as root.",
          "attack_vector": "Local. A low-privileged user can set the OPENSSL_ENGINES environment variable to point to a malicious library. When the privileged `barracudavpn` binary is executed, it loads this malicious library, resulting in arbitrary code execution with root privileges.",
          "attacker_capabilities": "The attacker needs to have local access to the system and the ability to set environment variables."
        }
      },
      {
        "source": "campus.barracuda.com_e56b723f_20250121_011311.html",
         "vulnerability": {
          "details": "Fix of a moderate security vulnerability (CVE-2019-6724) where under certain circumstances a local privilege escalation attack was possible. [BNNGF-57654]",
           "impact": "Local privilege escalation"
         }
      },
      {
        "source": "campus.barracuda.com_8c5c91b3_20250121_011307.html",
          "vulnerability": {
          "details": "Fix of a moderate security vulnerability (CVE-2019-6724) where under certain circumstances a local privilege escalation attack was possible. [BNNGF-57654]",
           "impact": "Local privilege escalation"
         }
      },
      {
        "source": "blog.mirch.io_d193e501_20250121_032056.html",
         "vulnerability": {
          "root_cause": "The Barracuda VPN client, prior to version 5.0.2.7, loads libraries from a path that can be influenced by an environment variable (OPENSSL_ENGINES).",
          "weaknesses": [
             "Uncontrolled search path for libraries",
             "Privileged process loads libraries from user-controlled path"
          ],
          "impact": "Arbitrary code execution as root.",
          "attack_vector": "Local. A low-privileged user can set the OPENSSL_ENGINES environment variable to point to a malicious library. When the privileged `barracudavpn` binary is executed, it loads this malicious library, resulting in arbitrary code execution with root privileges.",
          "attacker_capabilities": "The attacker needs to have local access to the system and the ability to set environment variables."
         }
      },
       {
        "source": "github.com_f5d98d86_20250121_032058.html",
         "vulnerability": {
           "details": "This is the proof-of-concept code, written in shell script, to exploit the CVE-2019-6724. It shows how to create a malicious library (`libcavium.so` or `libcavium.dylib` depending on the OS) and set the `OPENSSL_ENGINES` environment variable to load this library when `barracudavpn` is executed. The malicious library contains a `woot` function that executes a shell as root, achieving privilege escalation.",
           "impact": "Arbitrary code execution as root.",
           "attack_vector": "Local. The script sets the `OPENSSL_ENGINES` environment variable, creates a malicious library and then attempts to execute the affected application.",
           "attacker_capabilities": "The attacker needs to have local access to the system, ability to execute the shell script, create a directory and compile code."
        }
      }
    ],
      "summary": "The Barracuda VPN Client for Linux, macOS, and OpenBSD prior to version 5.0.2.7 is vulnerable to a local privilege escalation. The barracudavpn component, a privileged process, attempts to load a library which path can be controlled through the OPENSSL_ENGINES environment variable. By setting this variable to a malicious library a local unprivileged attacker can execute arbitrary code as root."
  }
}
```