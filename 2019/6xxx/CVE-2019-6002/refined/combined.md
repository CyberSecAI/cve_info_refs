=== Content from github.com_8af98a61_20250121_024214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F422)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F422)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=line%2Fcentraldogma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[line](/line)
/
**[centraldogma](/line/centraldogma)**
Public

* [Notifications](/login?return_to=%2Fline%2Fcentraldogma) You must be signed in to change notification settings
* [Fork
  121](/login?return_to=%2Fline%2Fcentraldogma)
* [Star
   609](/login?return_to=%2Fline%2Fcentraldogma)

* [Code](/line/centraldogma)
* [Issues
  153](/line/centraldogma/issues)
* [Pull requests
  16](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

Additional navigation options

* [Code](/line/centraldogma)
* [Issues](/line/centraldogma/issues)
* [Pull requests](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fline%2Fcentraldogma%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fline%2Fcentraldogma%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix XSS on a search feature #422

 Merged

[trustin](/trustin)
merged 3 commits into
[line:master](/line/centraldogma/tree/master "line/centraldogma:master")
from
[ikhoon:xss](/ikhoon/centraldogma/tree/xss "ikhoon/centraldogma:xss")

Jul 26, 2019

 Merged

# [Fix XSS on a search feature](#top) #422

[trustin](/trustin)
merged 3 commits into
[line:master](/line/centraldogma/tree/master "line/centraldogma:master")
from
[ikhoon:xss](/ikhoon/centraldogma/tree/xss "ikhoon/centraldogma:xss")

Jul 26, 2019

[Conversation
12](/line/centraldogma/pull/422)
[Commits
3](/line/centraldogma/pull/422/commits)
[Checks
0](/line/centraldogma/pull/422/checks)
[Files changed](/line/centraldogma/pull/422/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ikhoon](https://avatars.githubusercontent.com/u/1866157?s=60&v=4)](/ikhoon)

Copy link

Contributor

### @ikhoon **[ikhoon](/ikhoon)** commented [Jul 23, 2019](#issue-471472054) ‚Ä¢ edited Loading

Motivation:

XSS issue was reported by Line Security Team

Modifications:

* Encode html on error notification message.
* Invalid search query returns `Bad Request` instead of `Internal Server Error`.
* Replace `jGitRepository` into `parent.name() + '/' + name`

  to prevent exposure of a full file system path on the error message.

Result:

Enhanced security

Sorry, something went wrong.

All reactions

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
requested review from
[minwoox](/minwoox) and
[trustin](/trustin)
as [code owners](/line/centraldogma/blob/c76b431888ae961a1097360b3d65e8dcace50dc5/.github/CODEOWNERS#L3)
[July 23, 2019 03:43](#event-2501708334)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
added
the
[defect](/line/centraldogma/labels/defect)
label
[Jul 23, 2019](#event-2501717038)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
added this to the [0.40.2](/line/centraldogma/milestone/32) milestone
[Jul 23, 2019](#event-2501717203)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&v=4)](/ikhoon)

`[Fix XSS on a search feature](/line/centraldogma/pull/422/commits/4b0cebb4216caedd733300b97a20de2ac529e940 "Fix XSS on a search feature

Motivation:
XSS issue is reported by Line Security Team

Modification:
* Sanitize html on error notification message.
* Invalid search query returns `Bad Request` instead of Internal Server Error.
* Replace `jGitRepository` into `parent.name() + '/' + name`
  to prevent exposure of a full file system path on the error message.

Result:
Enhanced security")`
 ‚Ä¶

`[4b0cebb](/line/centraldogma/pull/422/commits/4b0cebb4216caedd733300b97a20de2ac529e940)`

```
Motivation:
XSS issue is reported by Line Security Team

Modification:
* Sanitize html on error notification message.
* Invalid search query returns `Bad Request` instead of Internal Server Error.
* Replace `jGitRepository` into `parent.name() + '/' + name`
  to prevent exposure of a full file system path on the error message.

Result:
Enhanced security
```

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/7846985aa42f06f23f4893fd6a78dfe3e32c413b..4b0cebb4216caedd733300b97a20de2ac529e940)
the
xss

branch
from
[`7846985`](/line/centraldogma/commit/7846985aa42f06f23f4893fd6a78dfe3e32c413b) to
[`4b0cebb`](/line/centraldogma/commit/4b0cebb4216caedd733300b97a20de2ac529e940)  [Compare](/line/centraldogma/compare/7846985aa42f06f23f4893fd6a78dfe3e32c413b..4b0cebb4216caedd733300b97a20de2ac529e940)
[July 23, 2019 03:52](#event-2501719196)

[![@stypr](https://avatars.githubusercontent.com/u/6625978?s=80&u=bd666145c809a25757ae83f9a6a793fd08dd1c46&v=4)](/stypr)

Copy link

### **[stypr](/stypr)** commented [Jul 23, 2019](#issuecomment-514066516) ‚Ä¢ edited Loading

| I think `ngSanitize` is good enough as a quick fix. But as I mentioned earlier, It would be better off to encode the text from the notification message itself.  This patch can still load tags like image, etc., but seems to filter out harmful attributes well. Also, it blocks `/`, therefore not able to load external domain  For example: <https://centraldogma/#/projects/a'%22%3E%3Cimg%20src=1%3E> |
| --- |

All reactions

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 23, 2019](#issuecomment-514101877)

| [@stypr](https://github.com/stypr) [The notification UI library](https://github.com/alexcrack/angular-ui-notification#usage) we are using is able to embed HTML. I just tried to remove harm tag from HTML on error display to keep the flexibility of HTML. But I agree that sanitized HTML is still dangerous. I will fix it to encode all the notification text. |
| --- |

All reactions

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&v=4)](/ikhoon)

`[Address comments by](/line/centraldogma/pull/422/commits/69c66987d9c35da81c65c5a3e7a2c021682fbe45 "Address comments by @stypr & fix broken tests") [@stypr](https://github.com/stypr) [& fix broken tests](/line/centraldogma/pull/422/commits/69c66987d9c35da81c65c5a3e7a2c021682fbe45 "Address comments by @stypr & fix broken tests")`

`[69c6698](/line/centraldogma/pull/422/commits/69c66987d9c35da81c65c5a3e7a2c021682fbe45)`

[![@stypr](https://avatars.githubusercontent.com/u/6625978?s=80&u=bd666145c809a25757ae83f9a6a793fd08dd1c46&v=4)](/stypr)

Copy link

### **[stypr](/stypr)** commented [Jul 23, 2019](#issuecomment-514155105)

| Code seems good to go. Built and tested it too. Test Code seems to work fine now. malicious tag is not rendered anymore. |
| --- |

All reactions

Sorry, something went wrong.

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jul 23, 2019](#issuecomment-514159973) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=h1) Report Merging [#422](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=desc) into [master](https://codecov.io/gh/line/centraldogma/commit/d650417c3f38e2bff68a843bf89f6af55e845d91?src=pr&el=desc) will **increase** coverage by `0.06%`. The diff coverage is `0%`.  [Impacted file tree graph](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=tree)  ``` @@             Coverage Diff              @@ ##             master     #422      +/-   ## ============================================ + Coverage     69.23%   69.29%   +0.06%      - Complexity     2975     2978       +3      ============================================   Files           319      319                 Lines         12204    12206       +2        Branches       1300     1300               ============================================ + Hits           8449     8458       +9      + Misses         2936     2926      -10      - Partials        819      822       +3 ```  | [Impacted Files](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=tree) | Coverage Œî | Complexity Œî |  | | --- | --- | --- | --- | | [...internal/storage/repository/git/GitRepository.java](https://codecov.io/gh/line/centraldogma/pull/422/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvc3RvcmFnZS9yZXBvc2l0b3J5L2dpdC9HaXRSZXBvc2l0b3J5LmphdmE=) | `80.79% <0%> (+0.31%)` | `147 <0> (+1)` | ‚¨ÜÔ∏è | | [...internal/replication/ZooKeeperCommandExecutor.java](https://codecov.io/gh/line/centraldogma/pull/422/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvcmVwbGljYXRpb24vWm9vS2VlcGVyQ29tbWFuZEV4ZWN1dG9yLmphdmE=) | `78.23% <0%> (-0.49%)` | `60% <0%> (√∏)` |  | | [...rp/centraldogma/server/metadata/MigrationUtil.java](https://codecov.io/gh/line/centraldogma/pull/422/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvbWV0YWRhdGEvTWlncmF0aW9uVXRpbC5qYXZh) | `78.62% <0%> (+2.29%)` | `28% <0%> (+1%)` | ‚¨ÜÔ∏è | | [...rage/repository/git/CacheableCompareTreesCall.java](https://codecov.io/gh/line/centraldogma/pull/422/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvc3RvcmFnZS9yZXBvc2l0b3J5L2dpdC9DYWNoZWFibGVDb21wYXJlVHJlZXNDYWxsLmphdmE=) | `51.51% <0%> (+3.03%)` | `6% <0%> (+1%)` | ‚¨ÜÔ∏è | | [...server/internal/thrift/CentralDogmaExceptions.java](https://codecov.io/gh/line/centraldogma/pull/422/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvdGhyaWZ0L0NlbnRyYWxEb2dtYUV4Y2VwdGlvbnMuamF2YQ==) | `63.63% <0%> (+13.63%)` | `2% <0%> (√∏)` | ‚¨áÔ∏è |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=continue).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta) `Œî = absolute <relative> (impact)`, `√∏ = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=footer). Last update [d650417...7d35e01](https://codecov.io/gh/line/centraldogma/pull/422?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments). |

All reactions

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 23, 2019](#issuecomment-514162573) ‚Ä¢ edited Loading

| [@stypr](https://github.com/stypr) Thank for fast reviewing and feedback.  As we have talked in slack chat, unfortunately, we don‚Äôt have test codes and suits for frontend yet. Thanks for the manual test. |
| --- |

All reactions

Sorry, something went wrong.

[![@stypr](https://avatars.githubusercontent.com/u/6625978?s=80&u=bd666145c809a25757ae83f9a6a793fd08dd1c46&v=4)](/stypr)

Copy link

### **[stypr](/stypr)** commented [Jul 24, 2019](#issuecomment-514506680)

| As we have talked in slack chat, unfortunately, we don‚Äôt have test codes and suits for frontend yet. Thanks for the manual test.  For now, I think it should be ok to approach with the current process. we can decide later about making test cases for frontend side. |
| --- |

All reactions

Sorry, something went wrong.

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
reviewed
[Jul 25, 2019](#pullrequestreview-266514278)

 [View reviewed changes](/line/centraldogma/pull/422/files)

[site/src/sphinx/known-issues.rst](/line/centraldogma/pull/422/files#diff-24b3f732864f82fd37ee452b29c6e6d34d88288a85a9d7d92d09bf6c4ecc26a3)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/d35bb7973f41fed39c30785f11c68d0199f09f0c..db45de154e5261cf7b4d3d6349134be344930f13)
the
xss

branch
2 times, most recently
from
[`d35bb79`](/line/centraldogma/commit/d35bb7973f41fed39c30785f11c68d0199f09f0c) to
[`db45de1`](/line/centraldogma/commit/db45de154e5261cf7b4d3d6349134be344930f13)  [Compare](/line/centraldogma/compare/d35bb7973f41fed39c30785f11c68d0199f09f0c..db45de154e5261cf7b4d3d6349134be344930f13)
[July 25, 2019 09:48](#event-2508943614)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
approved these changes
[Jul 25, 2019](#pullrequestreview-266537269)

 [View reviewed changes](/line/centraldogma/pull/422/files)

Copy link

Member

### @trustin **[trustin](/trustin)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks, [@ikhoon](https://github.com/ikhoon) !

Sorry, something went wrong.

All reactions

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/9f011ca49e564ff47388f5a66428e1f81d19e6c5..2f572500f7a08c8670450b5fe4dceec75f514469)
the
xss

branch
2 times, most recently
from
[`9f011ca`](/line/centraldogma/commit/9f011ca49e564ff47388f5a66428e1f81d19e6c5) to
[`2f57250`](/line/centraldogma/commit/2f572500f7a08c8670450b5fe4dceec75f514469)  [Compare](/line/centraldogma/compare/9f011ca49e564ff47388f5a66428e1f81d19e6c5..2f572500f7a08c8670450b5fe4dceec75f514469)
[July 25, 2019 12:12](#event-2509296859)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&v=4)](/ikhoon)

`[Add documentation for '](/line/centraldogma/pull/422/commits/7d35e01937a0ffb58bf024c66d66d28f8df0d9e4 "Add documentation for 'CVE-2019-6002'")[CVE-2019-6002](https://github.com/advisories/GHSA-9599-89x2-g4w2 "CVE-2019-6002")['](/line/centraldogma/pull/422/commits/7d35e01937a0ffb58bf024c66d66d28f8df0d9e4 "Add documentation for 'CVE-2019-6002'")`

`[7d35e01](/line/centraldogma/pull/422/commits/7d35e01937a0ffb58bf024c66d66d28f8df0d9e4)`

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/2f572500f7a08c8670450b5fe4dceec75f514469..7d35e01937a0ffb58bf024c66d66d28f8df0d9e4)
the
xss

branch
from
[`2f57250`](/line/centraldogma/commit/2f572500f7a08c8670450b5fe4dceec75f514469) to
[`7d35e01`](/line/centraldogma/commit/7d35e01937a0ffb58bf024c66d66d28f8df0d9e4)  [Compare](/line/centraldogma/compare/2f572500f7a08c8670450b5fe4dceec75f514469..7d35e01937a0ffb58bf024c66d66d28f8df0d9e4)
[July 26, 2019 02:48](#event-2511322259)

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
approved these changes
[Jul 26, 2019](#pullrequestreview-266976072)

 [View reviewed changes](/line/centraldogma/pull/422/files/7d35e01937a0ffb58bf024c66d66d28f8df0d9e4)

Copy link

Contributor

### @minwoox **[minwoox](/minwoox)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks, [@ikhoon](https://github.com/ikhoon)!

Sorry, something went wrong.

All reactions

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=40&u=d9bb1bad1efcfdabaff1a411d81ae4692c6a8700&v=4)](/trustin)
[trustin](/trustin)
merged commit [`25fcbbd`](/line/centraldogma/commit/25fcbbd098f69236b115f27c6b6de6b4e44f3103)
into
line:master

[Jul 26, 2019](https://github.com/line/centraldogma/pull/422#event-2511613421)

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
deleted the
xss

branch
[April 8, 2021 12:50](#event-4568475646)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F422)

Reviewers

[![@stypr](https://avatars.githubusercontent.com/u/6625978?s=40&v=4)](/stypr) [stypr](/stypr)

stypr left review comments

[![@minwoox](https://avatars.githubusercontent.com/u/25103250?s=40&v=4)](/minwoox) [minwoox](/minwoox)

minwoox approved these changes

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=40&v=4)](/trustin) [trustin](/trustin)

trustin approved these changes

Assignees

No one assigned

Labels

[defect](/line/centraldogma/labels/defect)

Projects

None yet

Milestone

 [**0.41.0**](/line/centraldogma/milestone/32 "0.41.0")

Development

Successfully merging this pull request may close these issues.

4 participants

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=52&v=4)](/ikhoon) [![@stypr](https://avatars.githubusercontent.com/u/6625978?s=52&v=4)](/stypr) [![@trustin](https://avatars.githubusercontent.com/u/173918?s=52&v=4)](/trustin) [![@minwoox](https://avatars.githubusercontent.com/u/25103250?s=52&v=4)](/minwoox)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from jvn.jp_011754d4_20250121_003346.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2019/07/31¬†¬†Last Updated:2019/07/31
# JVN#94889214 Central Dogma vulnerable to cross-site scripting

## Overview

Central Dogma contains a cross-site scripting vulnerability.

## Products Affected

* Central Dogma 0.17.0 to 0.40.1

## Description

Central Dogma provided by LINE Corporation contains a cross-site scripting vulnerability ([CWE-79](//cwe.mitre.org/data/definitions/79.html)).

## Impact

An arbitrary script may be executed on the user's web browser.

## Solution

**Update the Software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| LINE Corporation | [Welcome to Central Dogma √¢¬Ä¬î Central Dogma 0.40.1 documentation](https://line.github.io/centraldogma/) |
|  | [GitHub - line/centraldogma: Highly-available version-controlled service configuration repository based on Git, ZooKeeper and HTTP/2](https://github.com/line/centraldogma) |
|  | [Fix XSS on a search feature by ikhoon √Ç¬∑ Pull Request #422 √Ç¬∑ line/centraldogma √Ç¬∑ GitHub](https://github.com/line/centraldogma/pull/422) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
Base Score:
6.1

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:N/I:P/A:N
Base Score:
4.3

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

LINE Corporation reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and LINE Corporation coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2019-6002](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6002) |
| JVN iPedia | [JVNDB-2019-000050](https://jvndb.jvn.jp/jvndb/JVNDB-2019-000050) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2019 JPCERT/CC and IPA. All rights reserved.



=== Content from github.com_a35c5ae7_20250121_003347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Freleases%2Ftag%2Fcentraldogma-0.41.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Freleases%2Ftag%2Fcentraldogma-0.41.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=line%2Fcentraldogma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[line](/line)
/
**[centraldogma](/line/centraldogma)**
Public

* [Notifications](/login?return_to=%2Fline%2Fcentraldogma) You must be signed in to change notification settings
* [Fork
  121](/login?return_to=%2Fline%2Fcentraldogma)
* [Star
   609](/login?return_to=%2Fline%2Fcentraldogma)

* [Code](/line/centraldogma/tree/centraldogma-0.41.0)
* [Issues
  153](/line/centraldogma/issues)
* [Pull requests
  16](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

Additional navigation options

* [Code](/line/centraldogma/tree/centraldogma-0.41.0)
* [Issues](/line/centraldogma/issues)
* [Pull requests](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

1. [Releases](/line/centraldogma/releases)
2. [centraldogma-0.41.0](/line/centraldogma/releases/tag/centraldogma-0.41.0)

# centraldogma-0.41.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/line/centraldogma/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...centraldogma-0.41.0)

 Loading

[View all tags](/line/centraldogma/tags)

![@trustin](https://avatars.githubusercontent.com/u/173918?s=40&v=4)
[trustin](/trustin)
released this
26 Jul 07:23

[centraldogma-0.41.0](/line/centraldogma/tree/centraldogma-0.41.0)

[`d844eb0`](/line/centraldogma/commit/d844eb0868c16b15e29348b4e09defe0ec522860)

This commit was signed with the committer‚Äôs **verified signature**.

[![](https://avatars.githubusercontent.com/u/173918?s=64&v=4)](/trustin)
[trustin](/trustin)
Trustin Lee

GPG key ID: 96FB9DB219F3338D

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

### New features

* Server
  + Repositories and projects that were removed by a user will now be purged (i.e. deleted permanently) after a week (or configured duration). [#416](https://github.com/line/centraldogma/pull/416)
  + You can also purge a removed repository or project manually. [#416](https://github.com/line/centraldogma/pull/416)
* Client
  + (Java) Added `CentralDogma.purgeProject()` and `CentralDogma.purgeRepository()` [#416](https://github.com/line/centraldogma/pull/416)

### Security fixes

* Server
  + Fixed DOM based cross-site scripting (XSS) [#422](https://github.com/line/centraldogma/pull/422)
    - See [CVE-2019-6002](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6002) for more information.

### Bug fixes

* Server
  + Invalid search query does not cause `500 Internal Server Error` anymore. [#422](https://github.com/line/centraldogma/pull/422)

### Dependencies

* Armeria 0.88.0 -> 0.89.0

 Assets
3

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from jvndb.jvn.jp_523f7895_20250121_024207.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2019/10/04

| [[Japanese]](/ja/contents/2019/JVNDB-2019-000050.html) | |
| --- | --- |
| JVNDB-2019-000050 | |
| Central Dogma vulnerable to cross-site scripting | |
| Overview | |
| Central Dogma provided by LINE Corporation contains a cross-site scripting vulnerability (CWE-79). | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [6.1](/cvss/en/v3.html#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) (Medium) [IPA¬†Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Changed * Confidentiality Impact: Low * Integrity Impact: Low * Availability Impact: None  **CVSS V2 Severity:Base Metrics [4.3](/cvss/en/v2.html#AV:N/AC:M/Au:N/C:N/I:P/A:N) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Medium * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None | |
| Affected Products | |
|  | |
| LINE Corporation  * Central Dogma 0.17.0 to 0.40.1 | |
|  | |
| Impact | |
| An arbitrary script may be executed on the user's web browser. | |
| Solution | |
| [Update the Software] | |
| Vendor Information | |
| LINE Corporation  * GitHub : [GitHub - line/centraldogma: Highly-available version-controlled service configuration repository based on Git, ZooKeeper and HTTP/2](https://github.com/line/centraldogma) * GitHub :  [Fix XSS on a search feature by ikhoon - Pull Request #422 - line/centraldogma - GitHub](https://github.com/line/centraldogma/pull/422) * LINE : [Welcome to Central Dogma - Central Dogma 0.40.1 documentation](https://line.github.io/centraldogma/) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Cross-site¬†Scripting(CWE-79)](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE79) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2019-6002](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6002) | |
| References | |
| 1. JVN : [JVN#94889214](https://jvn.jp/en/jp/JVN94889214/index.html) 2. National Vulnerability Database (NVD) : [CVE-2019-6002](https://nvd.nist.gov/vuln/detail/CVE-2019-6002) | |
| Revision History | |
| * [2019/07/31] * [2019/10/04] | |

| --- | |
| --- | --- |
| Date Public | 2019/07/31 |
| Date First Published | 2019/07/31 |
| Date Last Updated | 2019/10/04 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright ¬© 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from github.com_6c763d2f_20250121_024212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F416)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F416)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=line%2Fcentraldogma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[line](/line)
/
**[centraldogma](/line/centraldogma)**
Public

* [Notifications](/login?return_to=%2Fline%2Fcentraldogma) You must be signed in to change notification settings
* [Fork
  121](/login?return_to=%2Fline%2Fcentraldogma)
* [Star
   609](/login?return_to=%2Fline%2Fcentraldogma)

* [Code](/line/centraldogma)
* [Issues
  153](/line/centraldogma/issues)
* [Pull requests
  16](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

Additional navigation options

* [Code](/line/centraldogma)
* [Issues](/line/centraldogma/issues)
* [Pull requests](/line/centraldogma/pulls)
* [Discussions](/line/centraldogma/discussions)
* [Actions](/line/centraldogma/actions)
* [Security](/line/centraldogma/security)
* [Insights](/line/centraldogma/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fline%2Fcentraldogma%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fline%2Fcentraldogma%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Automatic purging of removed repositories and projects #416

 Merged

[trustin](/trustin)
merged 2 commits into
[line:master](/line/centraldogma/tree/master "line/centraldogma:master")
from
[ikhoon:purge](/ikhoon/centraldogma/tree/purge "ikhoon/centraldogma:purge")

Jul 24, 2019

 Merged

# [Automatic purging of removed repositories and projects](#top) #416

[trustin](/trustin)
merged 2 commits into
[line:master](/line/centraldogma/tree/master "line/centraldogma:master")
from
[ikhoon:purge](/ikhoon/centraldogma/tree/purge "ikhoon/centraldogma:purge")

Jul 24, 2019

[Conversation
139](/line/centraldogma/pull/416)
[Commits
2](/line/centraldogma/pull/416/commits)
[Checks
0](/line/centraldogma/pull/416/checks)
[Files changed](/line/centraldogma/pull/416/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ikhoon](https://avatars.githubusercontent.com/u/1866157?s=60&v=4)](/ikhoon)

Copy link

Contributor

### @ikhoon **[ikhoon](/ikhoon)** commented [Jul 5, 2019](#issue-464492785) ‚Ä¢ edited Loading

Motivation:

The repositories and projects that were removed by users just renamed with having the suffix of `.removed`.

If the number of deleted files increases, it takes up a lot of disk space.

We can reduce wasted disk space by permanently deleting files which are older than configured.

Modifications:

* Add `PurgeProjectCommand` and `PurgeRepositoryCommand` and their thrift, rest api.
* Add `markForPurge()` and `purgeMarked()` method to mark and permanently delete a project or a repository directory.
* Add `PurgeSchedulingService` and `PurgeSchedulingServicePlugin` to purge automitically.
  + When the scheduler get started, it cleans up purged projects and repositories

    which were not deleted before.
* Add a new configuration `maxRemovedRepositoryAgeMillis` and update its documentation.
  + Setting 0 to `maxRemovedRepositoryAgeMillis` means disable the automatic purging.
* Record removal time into `removal.timestamp` file when a project/repository is removed.
* Change return type of `Set<String> listRemove()` into

  `Map<String, Instant> listRemoved()` to get a removal timestamp.

Result:

* A user who has permission can purge a repository or a project on demand.
* Removed repositories and projects are pursed automatically.

Fixes [#47](https://github.com/line/centraldogma/issues/47)

Sorry, something went wrong.

 üéâ
1
 minwoox reacted with hooray emoji

All reactions

* üéâ
  1 reaction

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
added
the
[new feature](/line/centraldogma/labels/new%20feature)
label
[Jul 5, 2019](#event-2461873373)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
added this to the [0.40.2](/line/centraldogma/milestone/32) milestone
[Jul 5, 2019](#event-2461873382)

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
requested review from
[trustin](/trustin) and
[minwoox](/minwoox)
[July 5, 2019 07:00](#event-2461873388)

[![@CLAassistant](https://avatars.githubusercontent.com/u/11571300?s=80&u=04709ab66059d1fb5246ce2d47bd3bc44e639ee0&v=4)](/CLAassistant)

Copy link

### **[CLAassistant](/CLAassistant)** commented [Jul 5, 2019](#issuecomment-508653337) ‚Ä¢ edited Loading

| [CLA assistant check](https://cla-assistant.io/line/centraldogma?pullRequest=416) All committers have signed the CLA. |
| --- |

All reactions

Sorry, something went wrong.

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/ec093b578fdcf5782bcbfb418efdbedbbdeb038f..aee115551e65715901e6be035941603ea16f1540)
the
purge

branch
4 times, most recently
from
[`ec093b5`](/line/centraldogma/commit/ec093b578fdcf5782bcbfb418efdbedbbdeb038f) to
[`aee1155`](/line/centraldogma/commit/aee115551e65715901e6be035941603ea16f1540)  [Compare](/line/centraldogma/compare/ec093b578fdcf5782bcbfb418efdbedbbdeb038f..aee115551e65715901e6be035941603ea16f1540)
[July 5, 2019 07:36](#event-2461945009)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 5, 2019](#pullrequestreview-258255506)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogma.java](/line/centraldogma/pull/416/files#diff-7867a8956450706a35bebb5adc549000e2c4810541fd1cdce8b1797e20202adf)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogma.java](/line/centraldogma/pull/416/files#diff-7867a8956450706a35bebb5adc549000e2c4810541fd1cdce8b1797e20202adf)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogma.java](/line/centraldogma/pull/416/files#diff-7867a8956450706a35bebb5adc549000e2c4810541fd1cdce8b1797e20202adf)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogma.java](/line/centraldogma/pull/416/files#diff-7867a8956450706a35bebb5adc549000e2c4810541fd1cdce8b1797e20202adf)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/internal/storage/StoragePurgeService.java](/line/centraldogma/pull/416/files#diff-56405858cf84d686f6b6d73e97c7cb58dfc59d75930857b507edd881d41cfc6a)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/storage/StorageManager.java](/line/centraldogma/pull/416/files#diff-fa5f93862c2ba57bd3cd48fcf9d08107b37e28a2fba320015758bd728c56e61e)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/aee115551e65715901e6be035941603ea16f1540..090202333532dcdfb84b1dc040faa252879cf160)
the
purge

branch
from
[`aee1155`](/line/centraldogma/commit/aee115551e65715901e6be035941603ea16f1540) to
[`0902023`](/line/centraldogma/commit/090202333532dcdfb84b1dc040faa252879cf160)  [Compare](/line/centraldogma/compare/aee115551e65715901e6be035941603ea16f1540..090202333532dcdfb84b1dc040faa252879cf160)
[July 5, 2019 07:57](#event-2461992088)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 5, 2019](#issuecomment-508679319)

| Thanks for fast feedback! [@trustin](https://github.com/trustin) üòä I will fix it soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 5, 2019](#issuecomment-508720618) ‚Ä¢ edited Loading

| Had chat with [@trustin](https://github.com/trustin) regarding the strategy of purging scheduler.   * If scheduler receives a directory, delete the directory in order in a single thread. * When scheduler started, scan `.purged` directories and rescheduling them * Automatically purge old projects and repositories which were removed by using [current purging scheduler implementation](https://github.com/line/centraldogma/pull/416/files#diff-e3bb9ea78f820637a7452d39d75bb583R56). |
| --- |

All reactions

Sorry, something went wrong.

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/06a99977519724cfda7929484a80e314b90505b8..bcad7978db47649f45319aefe31421e3bca01905)
the
purge

branch
from
[`06a9997`](/line/centraldogma/commit/06a99977519724cfda7929484a80e314b90505b8) to
[`bcad797`](/line/centraldogma/commit/bcad7978db47649f45319aefe31421e3bca01905)  [Compare](/line/centraldogma/compare/06a99977519724cfda7929484a80e314b90505b8..bcad7978db47649f45319aefe31421e3bca01905)
[July 9, 2019 08:45](#event-2468585586)

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jul 9, 2019](#issuecomment-509555550) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=h1) Report Merging [#416](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=desc) into [master](https://codecov.io/gh/line/centraldogma/commit/c76b431888ae961a1097360b3d65e8dcace50dc5?src=pr&el=desc) will **increase** coverage by `0.09%`. The diff coverage is `72.1%`.  [Impacted file tree graph](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=tree)  ``` @@             Coverage Diff              @@ ##             master     #416      +/-   ## ============================================ + Coverage     69.16%   69.25%   +0.09%      - Complexity     2901     2975      +74      ============================================   Files           315      319       +4        Lines         11892    12204     +312        Branches       1273     1300      +27      ============================================ + Hits           8225     8452     +227      - Misses         2879     2929      +50      - Partials        788      823      +35 ```  | [Impacted Files](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=tree) | Coverage Œî | Complexity Œî |  | | --- | --- | --- | --- | | [...rp/centraldogma/server/storage/StorageManager.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvc3RvcmFnZS9TdG9yYWdlTWFuYWdlci5qYXZh) | `100% <√∏> (√∏)` | `1 <0> (√∏)` | ‚¨áÔ∏è | | [...com/linecorp/centraldogma/client/CentralDogma.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-Y2xpZW50L2phdmEvc3JjL21haW4vamF2YS9jb20vbGluZWNvcnAvY2VudHJhbGRvZ21hL2NsaWVudC9DZW50cmFsRG9nbWEuamF2YQ==) | `44.44% <√∏> (√∏)` | `7 <0> (√∏)` | ‚¨áÔ∏è | | [...r/internal/storage/project/SafeProjectManager.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvc3RvcmFnZS9wcm9qZWN0L1NhZmVQcm9qZWN0TWFuYWdlci5qYXZh) | `43.24% <0%> (-6.76%)` | `10 <0> (√∏)` |  | | [...erver/internal/thrift/CentralDogmaServiceImpl.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvdGhyaWZ0L0NlbnRyYWxEb2dtYVNlcnZpY2VJbXBsLmphdmE=) | `74.87% <100%> (+0.62%)` | `63 <5> (+3)` | ‚¨ÜÔ∏è | | [...ogma/server/command/StandaloneCommandExecutor.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvY29tbWFuZC9TdGFuZGFsb25lQ29tbWFuZEV4ZWN1dG9yLmphdmE=) | `85.33% <100%> (+2.25%)` | `37 <4> (+6)` | ‚¨ÜÔ∏è | | [...raldogma/server/internal/api/ProjectServiceV1.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvYXBpL1Byb2plY3RTZXJ2aWNlVjEuamF2YQ==) | `92.3% <100%> (+1%)` | `14 <2> (+1)` | ‚¨ÜÔ∏è | | [...necorp/centraldogma/server/CentralDogmaConfig.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvQ2VudHJhbERvZ21hQ29uZmlnLmphdmE=) | `80.41% <100%> (+0.56%)` | `43 <1> (+2)` | ‚¨ÜÔ∏è | | [...ecorp/centraldogma/server/command/CommandType.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvY29tbWFuZC9Db21tYW5kVHlwZS5qYXZh) | `100% <100%> (√∏)` | `3 <0> (√∏)` | ‚¨áÔ∏è | | [.../com/linecorp/centraldogma/server/PluginGroup.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvUGx1Z2luR3JvdXAuamF2YQ==) | `83.33% <100%> (√∏)` | `11 <2> (√∏)` | ‚¨áÔ∏è | | [...nternal/storage/project/DefaultProjectManager.java](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree#diff-c2VydmVyL3NyYy9tYWluL2phdmEvY29tL2xpbmVjb3JwL2NlbnRyYWxkb2dtYS9zZXJ2ZXIvaW50ZXJuYWwvc3RvcmFnZS9wcm9qZWN0L0RlZmF1bHRQcm9qZWN0TWFuYWdlci5qYXZh) | `100% <100%> (√∏)` | `9 <4> (√∏)` | ‚¨áÔ∏è | | ... and [25 more](https://codecov.io/gh/line/centraldogma/pull/416/diff?src=pr&el=tree-more) |  |  |  |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=continue).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta) `Œî = absolute <relative> (impact)`, `√∏ = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=footer). Last update [c76b431...e807b73](https://codecov.io/gh/line/centraldogma/pull/416?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments). |

All reactions

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 9, 2019](#issuecomment-509564209) ‚Ä¢ edited Loading

| I will improve the test coverage. ü§® |
| --- |

All reactions

Sorry, something went wrong.

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/f3466408bf532c3a73fe1eeeb37dc0e0b619d268..506a08dff9b28980f53c7fea39202b0c6181425a)
the
purge

branch
5 times, most recently
from
[`f346640`](/line/centraldogma/commit/f3466408bf532c3a73fe1eeeb37dc0e0b619d268) to
[`506a08d`](/line/centraldogma/commit/506a08dff9b28980f53c7fea39202b0c6181425a)  [Compare](/line/centraldogma/compare/f3466408bf532c3a73fe1eeeb37dc0e0b619d268..506a08dff9b28980f53c7fea39202b0c6181425a)
[July 10, 2019 01:45](#event-2471102486)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 10, 2019](#pullrequestreview-259846785)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...r/src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgeService.java](/line/centraldogma/pull/416/files#diff-f02a382e2cfe76489ed19833d016b38c78a828bd15582778457707a0fffbf028)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/d2b2d154e55c2c762ce4ec3da0ede4baa5325870..e94bedea8373d27c0993275a4d4a9543744c6a87)
the
purge

branch
5 times, most recently
from
[`d2b2d15`](/line/centraldogma/commit/d2b2d154e55c2c762ce4ec3da0ede4baa5325870) to
[`e94bede`](/line/centraldogma/commit/e94bedea8373d27c0993275a4d4a9543744c6a87)  [Compare](/line/centraldogma/compare/d2b2d154e55c2c762ce4ec3da0ede4baa5325870..e94bedea8373d27c0993275a4d4a9543744c6a87)
[July 15, 2019 03:43](#event-2481715190)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 15, 2019](#pullrequestreview-261634534)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

[...src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgingService.java](/line/centraldogma/pull/416/files#diff-ed0a2d6c896fac986dd25fce5064845b711fdc91f6b2b273969da3a7c0fa48a6)
Outdated

Show resolved

Hide resolved

[...src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgingService.java](/line/centraldogma/pull/416/files#diff-ed0a2d6c896fac986dd25fce5064845b711fdc91f6b2b273969da3a7c0fa48a6)
Outdated

Show resolved

Hide resolved

[...src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgingService.java](/line/centraldogma/pull/416/files#diff-ed0a2d6c896fac986dd25fce5064845b711fdc91f6b2b273969da3a7c0fa48a6)
Outdated

Show resolved

Hide resolved

[...src/main/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgingService.java](/line/centraldogma/pull/416/files#diff-ed0a2d6c896fac986dd25fce5064845b711fdc91f6b2b273969da3a7c0fa48a6)
Outdated

Show resolved

Hide resolved

[...in/java/com/linecorp/centraldogma/server/internal/storage/ScheduledPurgingServicePlugin.java](/line/centraldogma/pull/416/files#diff-a2868f4e8473f3727568345fca4fc878f5f15795c16e625be6cbebdf759aba63)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/963ec39d6451d1f1c67dd5bbee99d8579a3a0324..0e2f309205a4930a7144d877add7e4b0bf7c37e4)
the
purge

branch
from
[`963ec39`](/line/centraldogma/commit/963ec39d6451d1f1c67dd5bbee99d8579a3a0324) to
[`0e2f309`](/line/centraldogma/commit/0e2f309205a4930a7144d877add7e4b0bf7c37e4)  [Compare](/line/centraldogma/compare/963ec39d6451d1f1c67dd5bbee99d8579a3a0324..0e2f309205a4930a7144d877add7e4b0bf7c37e4)
[July 15, 2019 09:27](#event-2482282397)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 15, 2019](#pullrequestreview-261723742)

 [View reviewed changes](/line/centraldogma/pull/416/files)

Copy link

Member

### @trustin **[trustin](/trustin)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

* It seems to me that `listPurge()` and `clear()` are always used together. How about merging them into a single public method (`purgeMarked()`), so that there's no chance of specifying a bad name when calling `clear()`? `PurgeSchedulingService.cleanPurgedFiles()` would be way more simplified as well.
* How about renaming `StorageManager.purge()` to `markForPurge()`, because it does not purge immediately?

Sorry, something went wrong.

 üëç
1
 ikhoon reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 16, 2019](#pullrequestreview-262169350)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/storage/StorageManager.java](/line/centraldogma/pull/416/files#diff-fa5f93862c2ba57bd3cd48fcf9d08107b37e28a2fba320015758bd728c56e61e)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/storage/StorageManager.java](/line/centraldogma/pull/416/files#diff-fa5f93862c2ba57bd3cd48fcf9d08107b37e28a2fba320015758bd728c56e61e)

Show resolved

Hide resolved

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 16, 2019](#pullrequestreview-262283568)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...in/java/com/linecorp/centraldogma/server/internal/storage/project/DefaultProjectManager.java](/line/centraldogma/pull/416/files#diff-ba3320370bda7e734532753feb09d328bf9762563bfa261f1498fcc6d628395b)
Outdated

Show resolved

Hide resolved

[.../test/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingServiceTest.java](/line/centraldogma/pull/416/files#diff-9707f3c318e935f6f91ea1f255803af3f35cbd01c30191d261fc75367a85631f)

Show resolved

Hide resolved

[...m/linecorp/centraldogma/server/internal/storage/repository/git/GitRepositoryManagerTest.java](/line/centraldogma/pull/416/files#diff-5436943b0fb94925685df48ec33d1b72739f111c4ba3c169c05d2b46b5127683)
Outdated

Show resolved

Hide resolved

[.../com/linecorp/centraldogma/server/internal/storage/repository/DefaultMetaRepositoryTest.java](/line/centraldogma/pull/416/files#diff-40198af78601336c3d2c0ba03716b891b38a2d7006385f9878d04b18fc09bb8a)
Outdated

Show resolved

Hide resolved

[.../test/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingServiceTest.java](/line/centraldogma/pull/416/files#diff-9707f3c318e935f6f91ea1f255803af3f35cbd01c30191d261fc75367a85631f)
Outdated

Show resolved

Hide resolved

[...ng-internal/src/main/java/com/linecorp/centraldogma/testing/internal/ProjectManagerRule.java](/line/centraldogma/pull/416/files#diff-e1933ae859607b407781927052312d4ed93ed53b2939e749be85a92aea736dee)
Outdated

Show resolved

Hide resolved

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 17, 2019](#issuecomment-512108735) ‚Ä¢ edited Loading

| We have discussed that:   * Asynchronous purging logic could crash replication just in case:  ``` 1. createProject(foo) 2. removeProject(foo) 3. purgeProject(foo) 3.1 purgeWoker.execute(() -> {     deleteFile(foo)  // this runs asynchronously and `foo.purge` has not been deleted yet }) 4. createProject(foo) -> success 5. removeProject(foo) -> success 6. purgeProject(foo)  -> fail when `foo.purge` still exists.   ```  * Change removal timestamp logging strategy   1. Write removal timestamp to a file in a project/repository directory before renaming the name of project/repository into `{name}.removed`   2. Don't use `removal()` in `ProjectMetadata` or `RepositoryMetadata`, but judge based on the timestamp which was written in `1)`.   Thanks. [@trustin](https://github.com/trustin) üòÄ |
| --- |

All reactions

Sorry, something went wrong.

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/445c824310787e4690bc34602c338f6396ec3e26..9e86a592915fe8ace2d1fcde408e24596a096c1c)
the
purge

branch
6 times, most recently
from
[`445c824`](/line/centraldogma/commit/445c824310787e4690bc34602c338f6396ec3e26) to
[`9e86a59`](/line/centraldogma/commit/9e86a592915fe8ace2d1fcde408e24596a096c1c)  [Compare](/line/centraldogma/compare/445c824310787e4690bc34602c338f6396ec3e26..9e86a592915fe8ace2d1fcde408e24596a096c1c)
[July 19, 2019 02:54](#event-2494582155)

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
requested changes
[Jul 22, 2019](#pullrequestreview-264574849)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)
Outdated

Show resolved

Hide resolved

2 hidden conversations

Load more‚Ä¶

[.../src/main/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingService.java](/line/centraldogma/pull/416/files#diff-920da907117cabeb1249c4e6b31ec67133e5a7971b1481372e642fa4d09c0c34)
Outdated

Show resolved

Hide resolved

[.../src/main/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingService.java](/line/centraldogma/pull/416/files#diff-920da907117cabeb1249c4e6b31ec67133e5a7971b1481372e642fa4d09c0c34)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/metadata/MetadataService.java](/line/centraldogma/pull/416/files#diff-dc8a031ec8b91f16d76b42e152e9c3be8dd07b6f77bea922030074acc78ce78e)
Outdated

Show resolved

Hide resolved

[server/src/main/resources/META-INF/services/com.linecorp.centraldogma.server.plugin.Plugin](/line/centraldogma/pull/416/files#diff-fe94a785b24fad0cb8e8d041f8d38b15ed33458dc4d4e38f77829feea21e13ec)
Outdated

Show resolved

Hide resolved

[server/src/test/java/com/linecorp/centraldogma/server/internal/api/auth/PermissionTest.java](/line/centraldogma/pull/416/files#diff-f91ea827d382a7d287210c6b9b72ba05ebebe50c8a26bbb684ad7685a88669a0)
Outdated

Show resolved

Hide resolved

[![trustin](https://avatars.githubusercontent.com/u/173918?s=60&v=4)](/trustin)

**[trustin](/trustin)**
approved these changes
[Jul 22, 2019](#pullrequestreview-264640402)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=80&u=d9bb1bad1efcfdabaff1a411d81ae4692c6a8700&v=4)](/trustin)

Copy link

Member

### **[trustin](/trustin)** commented [Jul 22, 2019](#issuecomment-513675502)

| Thanks for your patience and nice work, [@ikhoon](https://github.com/ikhoon) üëç |
| --- |

 üòÑ
1
 ikhoon reacted with laugh emoji

All reactions

* üòÑ
  1 reaction

Sorry, something went wrong.

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&v=4)](/ikhoon)

`[Automatic purging of removed repositories and projects](/line/centraldogma/pull/416/commits/c9a9b3183c892d40284ade89e1fe7124522a8cdd "Automatic purging of removed repositories and projects

Motivation:
The repositories and projects that were removed by users just renamed with having the suffix of `.removed`.
If the number of deleted files increases, it takes up a lot of disk space.
We can reduce wasted disk space by permanently deleting files which are older than configured.

Modifications:
* Add `PurgeProjectCommand` and `PurgeRepositoryCommand` and their thrift, rest api.
* Add `markForPurge()` and `purgeMarked()` method to mark and permanently delete a project or a repository directory.
* Add `PurgeSchedulingService` and `PurgeSchedulingServicePlugin` to purge automitically.
  * When the scheduler get started, it cleans up purged projects and repositories
    which were not deleted before.
* Add a new configuration `maxRemovedRepositoryAgeMillis` and update its documentation.
  * Setting 0 to `maxRemovedRepositoryAgeMillis` means disable the automatic purging.
* Record removal time into `removal.timestamp` file when a project/repository is removed.
* Change return type of `Set<String> listRemove()` into
  `Map<String, Instant> listRemoved()` to get a removal timestamp.

Result:
* A user who has permission can purge a repository or a project on demand.
* Removed repositories and projects are pursed automatically.

Fixes #47")`
 ‚Ä¶

`[c9a9b31](/line/centraldogma/pull/416/commits/c9a9b3183c892d40284ade89e1fe7124522a8cdd)`

```
Motivation:
The repositories and projects that were removed by users just renamed with having the suffix of `.removed`.
If the number of deleted files increases, it takes up a lot of disk space.
We can reduce wasted disk space by permanently deleting files which are older than configured.

Modifications:
* Add `PurgeProjectCommand` and `PurgeRepositoryCommand` and their thrift, rest api.
* Add `markForPurge()` and `purgeMarked()` method to mark and permanently delete a project or a repository directory.
* Add `PurgeSchedulingService` and `PurgeSchedulingServicePlugin` to purge automitically.
  * When the scheduler get started, it cleans up purged projects and repositories
    which were not deleted before.
* Add a new configuration `maxRemovedRepositoryAgeMillis` and update its documentation.
  * Setting 0 to `maxRemovedRepositoryAgeMillis` means disable the automatic purging.
* Record removal time into `removal.timestamp` file when a project/repository is removed.
* Change return type of `Set<String> listRemove()` into
  `Map<String, Instant> listRemoved()` to get a removal timestamp.

Result:
* A user who has permission can purge a repository or a project on demand.
* Removed repositories and projects are pursed automatically.

Fixes [line#47](https://github.com/line/centraldogma/issues/47)
```

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/33f35b188e259989203aa5b11cfaacdd8e502cda..c9a9b3183c892d40284ade89e1fe7124522a8cdd)
the
purge

branch
from
[`33f35b1`](/line/centraldogma/commit/33f35b188e259989203aa5b11cfaacdd8e502cda) to
[`c9a9b31`](/line/centraldogma/commit/c9a9b3183c892d40284ade89e1fe7124522a8cdd)  [Compare](/line/centraldogma/compare/33f35b188e259989203aa5b11cfaacdd8e502cda..c9a9b3183c892d40284ade89e1fe7124522a8cdd)
[July 23, 2019 06:02](#event-2501882592)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=80&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)

Copy link

Contributor

Author

### **[ikhoon](/ikhoon)** commented [Jul 23, 2019](#issuecomment-514066927)

| the PR description has updated. |
| --- |

All reactions

Sorry, something went wrong.

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
reviewed
[Jul 24, 2019](#pullrequestreview-265760204)

 [View reviewed changes](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd)

[...java-armeria/src/main/java/com/linecorp/centraldogma/client/armeria/ArmeriaCentralDogma.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-ac190319b1852ef26e5650f642adeec9196e3350d8ab184011f3cb2899e5b92d)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/command/Command.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-1a93d3f6a4471cb57349dbfb3e14030638839ae1707bfd05d69a67e0d00eec13)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/command/Command.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-1a93d3f6a4471cb57349dbfb3e14030638839ae1707bfd05d69a67e0d00eec13)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/DirectoryBasedStorageManager.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-9762ba843e5cf66b675e74d00758486de9373f640ba479d4e48ed052b2e5f06f)

|  |  | Instant readRemoval(File file) { |
| --- | --- | --- |
|  |  | final File removal = new File(file, REMOVAL\_TIMESTAMP\_NAME); |
|  |  | if (!removal.exists()) { |
|  |  | return Instant.ofEpochMilli(file.lastModified()); |

Copy link

Contributor

### @minwoox **[minwoox](/minwoox)** [Jul 24, 2019](#discussion_r306609122)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Question: what `file.lastModified()` returns when the file does not exist?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @ikhoon **[ikhoon](/ikhoon)** [Jul 24, 2019](#discussion_r306617176) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

If a file has `.removed` postfix but no `REMOVAL_TIMESTAMP`, it is regarded as an old removed file. We use `lastModified()` to determine the removal time for keeping backward compatibility.

Because old removed files don't have `REMOVAL_TIMESTAMP` before deploying this new purge logic.

Sorry, something went wrong.

All reactions

3 hidden conversations

Load more‚Ä¶

[.../src/main/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingService.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-920da907117cabeb1249c4e6b31ec67133e5a7971b1481372e642fa4d09c0c34)
Outdated

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingServicePlugin.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-15f55a5a00a62b3a74be0257aa2d54f2f0956d53a33bd77bb5cd63695f5b3cbc)

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/metadata/MetadataService.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-dc8a031ec8b91f16d76b42e152e9c3be8dd07b6f77bea922030074acc78ce78e)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/plugin/PluginContext.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-786315aa959dccd603abf4b33e5613f33fea232b6a69f13a04d81c783ac37af8)
Outdated

Show resolved

Hide resolved

[server/src/main/java/com/linecorp/centraldogma/server/storage/StorageManager.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-fa5f93862c2ba57bd3cd48fcf9d08107b37e28a2fba320015758bd728c56e61e)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/33410ec385aad3f9a4a11b5b11300b3d70aa0f3e..408b7659ef3d94a1286f22c3183fd19bead89d25)
the
purge

branch
2 times, most recently
from
[`33410ec`](/line/centraldogma/commit/33410ec385aad3f9a4a11b5b11300b3d70aa0f3e) to
[`408b765`](/line/centraldogma/commit/408b7659ef3d94a1286f22c3183fd19bead89d25)  [Compare](/line/centraldogma/compare/33410ec385aad3f9a4a11b5b11300b3d70aa0f3e..408b7659ef3d94a1286f22c3183fd19bead89d25)
[July 24, 2019 06:27](#event-2505227625)

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
reviewed
[Jul 24, 2019](#pullrequestreview-265813152)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[.../src/main/java/com/linecorp/centraldogma/server/internal/storage/PurgeSchedulingService.java](/line/centraldogma/pull/416/files/c9a9b3183c892d40284ade89e1fe7124522a8cdd#diff-920da907117cabeb1249c4e6b31ec67133e5a7971b1481372e642fa4d09c0c34)

Show resolved

Hide resolved

[...ain/java/com/linecorp/centraldogma/server/internal/mirror/DefaultMirroringServicePlugin.java](/line/centraldogma/pull/416/files#diff-3621a9c7a17c5dd1312da9cabe1854c0d51f7ae3b9777ab177a71160ce2ec2a0)
Outdated

Show resolved

Hide resolved

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
reviewed
[Jul 24, 2019](#pullrequestreview-265814104)

 [View reviewed changes](/line/centraldogma/pull/416/files)

[...java-armeria/src/main/java/com/linecorp/centraldogma/client/armeria/ArmeriaCentralDogma.java](/line/centraldogma/pull/416/files#diff-ac190319b1852ef26e5650f642adeec9196e3350d8ab184011f3cb2899e5b92d)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/408b7659ef3d94a1286f22c3183fd19bead89d25..4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d)
the
purge

branch
from
[`408b765`](/line/centraldogma/commit/408b7659ef3d94a1286f22c3183fd19bead89d25) to
[`4a3f1e5`](/line/centraldogma/commit/4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d)  [Compare](/line/centraldogma/compare/408b7659ef3d94a1286f22c3183fd19bead89d25..4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d)
[July 24, 2019 06:32](#event-2505237476)

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
reviewed
[Jul 24, 2019](#pullrequestreview-265814544)

 [View reviewed changes](/line/centraldogma/pull/416/files)

Copy link

Contributor

### @minwoox **[minwoox](/minwoox)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

one more nit. üòâ

Sorry, something went wrong.

All reactions

[server/src/main/java/com/linecorp/centraldogma/server/CentralDogmaBuilder.java](/line/centraldogma/pull/416/files#diff-aecb87259c037808a9c8db79d01d9f5d9496d8f516ff58f2d2dcdeb776439cb2)
Outdated

Show resolved

Hide resolved

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d..95f20661a05517737c0d3c46167a6f1c5017a4a9)
the
purge

branch
from
[`4a3f1e5`](/line/centraldogma/commit/4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d) to
[`95f2066`](/line/centraldogma/commit/95f20661a05517737c0d3c46167a6f1c5017a4a9)  [Compare](/line/centraldogma/compare/4a3f1e588a16ef2f21c9f3a1d83410ee1545c96d..95f20661a05517737c0d3c46167a6f1c5017a4a9)
[July 24, 2019 06:55](#event-2505282036)

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&v=4)](/ikhoon)

`[Address comments by](/line/centraldogma/pull/416/commits/e807b7355caa5ac5b44a256abab4e8514c830f6a "Address comments by @minwoox") [@minwoox](https://github.com/minwoox)`

`[e807b73](/line/centraldogma/pull/416/commits/e807b7355caa5ac5b44a256abab4e8514c830f6a)`

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
[force-pushed](/line/centraldogma/compare/95f20661a05517737c0d3c46167a6f1c5017a4a9..e807b7355caa5ac5b44a256abab4e8514c830f6a)
the
purge

branch
from
[`95f2066`](/line/centraldogma/commit/95f20661a05517737c0d3c46167a6f1c5017a4a9) to
[`e807b73`](/line/centraldogma/commit/e807b7355caa5ac5b44a256abab4e8514c830f6a)  [Compare](/line/centraldogma/compare/95f20661a05517737c0d3c46167a6f1c5017a4a9..e807b7355caa5ac5b44a256abab4e8514c830f6a)
[July 24, 2019 07:07](#event-2505307384)

[![minwoox](https://avatars.githubusercontent.com/u/25103250?s=60&v=4)](/minwoox)

**[minwoox](/minwoox)**
approved these changes
[Jul 24, 2019](#pullrequestreview-265831096)

 [View reviewed changes](/line/centraldogma/pull/416/files/e807b7355caa5ac5b44a256abab4e8514c830f6a)

Copy link

Contributor

### @minwoox **[minwoox](/minwoox)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for your hard work, [@ikhoon](https://github.com/ikhoon)!

Sorry, something went wrong.

All reactions

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=40&u=d9bb1bad1efcfdabaff1a411d81ae4692c6a8700&v=4)](/trustin)
[trustin](/trustin)
merged commit [`d650417`](/line/centraldogma/commit/d650417c3f38e2bff68a843bf89f6af55e845d91)
into
line:master

[Jul 24, 2019](https://github.com/line/centraldogma/pull/416#event-2505349721)

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=80&u=d9bb1bad1efcfdabaff1a411d81ae4692c6a8700&v=4)](/trustin)

Copy link

Member

### **[trustin](/trustin)** commented [Jul 24, 2019](#issuecomment-514513932)

| üéâ Great job! |
| --- |

All reactions

Sorry, something went wrong.

 [![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=40&u=6f856980034741483b90900b7f5144e1185492dd&v=4)](/ikhoon)
[ikhoon](/ikhoon)
deleted the
purge

branch
[October 8, 2020 05:31](#event-3853555386)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fline%2Fcentraldogma%2Fpull%2F416)

Reviewers

[![@minwoox](https://avatars.githubusercontent.com/u/25103250?s=40&v=4)](/minwoox) [minwoox](/minwoox)

minwoox approved these changes

[![@trustin](https://avatars.githubusercontent.com/u/173918?s=40&v=4)](/trustin) [trustin](/trustin)

trustin approved these changes

Assignees

No one assigned

Labels

[new feature](/line/centraldogma/labels/new%20feature)

Projects

None yet

Milestone

 [**0.41.0**](/line/centraldogma/milestone/32 "0.41.0")

Development

Successfully merging this pull request may close these issues.

 [Automatic purging of removed repositories and projects](https://github.com/line/centraldogma/issues/47)

4 participants

[![@ikhoon](https://avatars.githubusercontent.com/u/1866157?s=52&v=4)](/ikhoon) [![@CLAassistant](https://avatars.githubusercontent.com/u/11571300?s=52&v=4)](/CLAassistant) [![@trustin](https://avatars.githubusercontent.com/u/173918?s=52&v=4)](/trustin) [![@minwoox](https://avatars.githubusercontent.com/u/25103250?s=52&v=4)](/minwoox)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


