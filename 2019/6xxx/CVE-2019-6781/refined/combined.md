=== Content from gitlab.com_26947b01_20250121_005331.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# Hyperlink Injection on Email Notifications

* Title: Hyperlink Injection on Email Notifications
* Types: Unvalidated / Open Redirect
* Link: <https://hackerone.com/reports/167630>
* Date: 2016-09-11 15:59:29 -0400
* By: corb3nik

Details:

## Description

A user can change their name to a URL in order to send notification emails containing malicious hyperlinks.

Using this vulnerability, an attacker can abuse the Gitlab email system to send malicious emails to any user.

## Steps to Reproduce

Let's assume that an attacker would like to compromise the system of the user john@doe.com (john@doe.com is not a Gitlab user).

```
Create a Gitlab account with the email john@doe.com
Navigate to https://gitlab.com/profile
Change your name to http://evilsite.com
Change your password
```

The user john@doe.com will receive a legitimate Gitlab email containing a potentially malicious URL.
This issue will occur with other notifications too like adding a new email address through <https://gitlab.com/profile/emails>.

## Consequences

This permits users to send malicious/phishing links to potential clients. It could also have an effect on how spam filters treat Gitlab.com emails.

---

Timeline:

2016-09-12 11:27 (-0400): [@rspeicher](/rspeicher "Robert Speicher") (comment)
[@Corb3nik](/Corb3nik "Corb3nik") Thank you for the report.

1. What email client is this? I think this would require that the client autolinks URL-like text, since we don't do any kind of linking for the name ourselves.
2. The default configuration for GitLab requires that users confirm their email address before they can sign in. This would prevent an attacker from signing up with the victim's email address and then changing their name to something malicious.

---

2016-09-12 13:43 (-0400): [@Corb3nik](/Corb3nik "Corb3nik") (comment)
[@rspeicher](/rspeicher "Robert Speicher") Thank you for the quick response.

I have checked the source code of the emails I received and you're right, it is the mail client that adds the clickable links.

With that said, I have tested this behaviour on two mail clients: MailMate and Gmail.

Since Gmail behaves this way, I would still suggest proceeding with this report as it affects a wide audience.

As for your second point, you are correct; my mistake. I have found an alternative though :

1. Create a Gitlab account.
2. Browse to <https://gitlab.com/profile/emails>.
3. Add the email address of the victim.
4. Browse to <https://gitlab.com/profile/notifications>.
5. Change the notification email to the victim's email.
6. Set the `Global notification level` to `Watch`
7. Browse to <https://gitlab.com/profile/emails> and add a new email address.

The victim email will now receive a notification with the malicious URL.

---

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


