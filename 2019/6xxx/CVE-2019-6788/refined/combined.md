=== Content from gitlab.com_d1ac1cea_20250121_004703.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# Alias GitHub/Bitbucket Cloud OAuth2 callback URLs to prevent covert redirections

From <https://gitlab.com/gitlab-com/gl-infra/production/issues/662>, we have an issue where we can't securely share the same OAuth2 application among GitHub logins and imports because the callback URLs are different:

* `/users/auth/github/callback`
* `/import/github/callback`

The same goes for Bitbucket.

Either we have to put these callbacks under the same URL structure (e.g. `/callbacks/oauth/github/` for `/callbacks/oauth/github/import` and `/callbacks/oauth/github/login`), or we have to split the OAuth2 credentials into 2 different applications.

On the infra side, it should be possible to use a separate subdomain (e.g. `oauth.gitlab.com`) to handle all OAuth2 callbacks, but that seems like a separate issue.

Edited Jan 22, 2019 by [Stan Hu](/stanhu)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


