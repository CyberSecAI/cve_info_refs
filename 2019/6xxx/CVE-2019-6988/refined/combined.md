=== Content from github.com_e1c0b84a_20250121_001341.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F1178)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F1178)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  466](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  33](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# memory exhauted and hangs long time when use 64bit opj\_decompress (CVE-2019-6988)Â #1178

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[memory exhauted and hangs long time when use 64bit opj\_decompress (CVE-2019-6988)](#top)#1178Copy link![@yanxxd](https://avatars.githubusercontent.com/u/29699531?u=495bc7b047ddb31dcbca62783db5b3d8fc9948a0&v=4&size=80)
## Description

![@yanxxd](https://avatars.githubusercontent.com/u/29699531?u=495bc7b047ddb31dcbca62783db5b3d8fc9948a0&v=4&size=48)[yanxxd](https://github.com/yanxxd)opened [on Jan 17, 2019](https://github.com/uclouvain/openjpeg/issues/1178#issue-400311428)

I found a problem which will cause memory is exhausted, and program hang for 8 minutes. My test server had 112GB of memory. This can cause denial of service.

### Steps to Reproduce

1. Download and unzip [POC.zip]

   [POC.zip](https://github.com/uclouvain/openjpeg/files/2769058/POC.zip)
2. Run `opj_decompress -i POC -o /tmp/1.png`
3. When I test it use 32bit opj\_decompress with asan, the following is the output information

```
===========================================
The extension of this file is incorrect.
FOUND p:16. SHOULD BE .j2k or .jpc or .j2c
===========================================

[INFO] Start to read j2k main header (0).
[WARNING] Unknown marker
[WARNING] Unknown marker
[WARNING] Cannot take in charge mct data within multiple MCT records
[WARNING] Unknown marker
[ERROR] Unknown progression order in COD marker
[WARNING] Unknown marker
[WARNING] Cannot take in charge mct data within multiple MCT records
[WARNING] Unknown marker
[ERROR] Unknown progression order in COD marker
[WARNING] Unknown marker
[WARNING] Cannot take in charge mct data within multiple MCT records
[WARNING] Unknown marker
[ERROR] Unknown progression order in COD marker
[WARNING] Unknown marker
[INFO] Main header has been correctly decoded.
[INFO] No decoded area parameters, set the decoded area to the whole image
=================================================================
==26110==ERROR: AddressSanitizer: allocator is out of memory trying to allocate 0x2f4ad890 bytes
    #0 0x81083a5 in calloc /soft/clang/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:155:3
    #1 0xf7dda139 in opj_calloc ./openjpeg/src/lib/openjp2/opj_malloc.c:204:12
    #2 0xf7d7685c in opj_tcd_init_tile ./openjpeg/src/lib/openjp2/tcd.c:1111:56
    #3 0xf7d87c0f in opj_tcd_init_decode_tile ./openjpeg/src/lib/openjp2/tcd.c:1184:12
    #4 0xf793a827 in opj_j2k_decode_tiles ./openjpeg/src/lib/openjp2/j2k.c:10717:19
    #5 0xf785ba1c in opj_j2k_exec ./openjpeg/src/lib/openjp2/j2k.c:8105:33

```
### Analysis

1. Alloc too much big memory.
2. Maybe too many cycles

### System Configuration

* version: git commit [51f097e](https://github.com/uclouvain/openjpeg/commit/51f097e6d5754ddae93e716276fe8176b44ec548)
* Environment: Ubuntu 16.04.3 TLS
* Memery Size: 112GB
* component: 64bit opj\_decompress

These vulnerabilities have been found with a more efficient version of the AFL fuzzer.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from avatars.githubusercontent.com_b53b150c_20250121_022105.html ===
ï¿½ï¿½ï¿½ï¿½ ï¿½  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222ï¿½ï¿½  P P" ï¿½ï¿½ï¿½          
   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½       
  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½
(ï¿½ï¿½
(ï¿½ØŒï¿½@
ï¿½ï¿½"sï¿½ï¿½ï¿½ï¿½cï¿½ m\*Bdpï¿½ c^ï¿½á¯‡Ö‰ï¿½ï¿½ï¿½ï¿½b^ï¿½ï¿½Ä«9?J ï¿½ï¿½ï¿½iR(ï¿½gw8UQï¿½Oï¿½2ï¿½Nï¿½= K$Eï¿½ï¿½$DÈ»ï¿½Uaï¿½tï¿½qï¿½ï¿½=ï¿½ï¿½oï¿½Zï¿½ï¿½ï¿½bOpHï¿½Aï¿½hï¿½\*ï¿½cï¿½ï¿½ï¿½Tï¿½\*rï¿½:ï¿½zVï¿½ï¿½ï¿½ï¿½gUï¿½xdpXï¿½nï¿½ï¿½ &ï¿½ï¿½ï¿½Yï¿½Ëï¿½d$#0ï¿½8ï¿½~ï¿½Fï¿½4ï¿½ï¿½Ý®ï¿½=ï¿½6;kPï¿½ï¿½ï¿½Uï¿½.ï¿½Gï¿½
7.wï¿½ï¿½ï¿½ï¿½;sï¿½;ï¿½-\*ï¿½ jWï¿½17ï¿½ï¿½. rï¿½ï¿½}Gï¿½ï¿½ï¿½ yï¿½ï¿½tï¿½Rï¿½Ú”ï¿½q\*ï¿½ï¿½&ï¿½ï¿½dï¿½ï¿½r:`T-ï¿½ï¿½mï¿½ï¿½
ï¿½Dï¿½\ï¿½ï¿½ï¿½?pÃ“ß¿ï¿½A%ï¿½qkï¿½i;ï¿½\*C ï¿½U[ï¿½vÙžHï¿½ï¿½ßƒÒ®ï¿½jï¿½ï¿½ï¿½ï¿½ï¿½%ï¿½I/ï¿½Eï¿½,ad9ï¿½ï¿½ï¿½ ï¿½lP×‡-lï¿½%h5-wIï¿½B 6ï¿½~c+`m8ï¿½9ï¿½ï¿½U[ï¿½\_xï¿½ï¿½,ï¿½ï¿½Jï¿½ï¿½%Aï¿½7ï¿½pï¿½}k7ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½|Ë§ï¿½/ï¿½L0ï¿½zï¿½ï¿½=Gï¿½Wï¿½SPï¿½ï¿½ï¿½ï¿½,Jï¿½ï¿½nï¿½['ï¿½ gï¿½ï¿½ï¿½ [ï¿½ï¿½ï¿½ekï¿½5ï¿½ï¿½lï¿½+ï¿½.ï¿½2ï¿½ï¿½}qï¿½ï¿½GjÏ¶ï¿½Vï¿½ï¿½ï¿½iï¿½Ñ¥eï¿½ï¿½ï¿½ï¿½ï¿½ï¿½08ï¿½ï¿½ï¿½Zï¿½ï¿½]Zï¿½ï¿½
ï¿½4ï¿½3|ï¿½yï¿½ï¿½ï¿½ï¿½ï¿½E
 ï¿½8 ï¿½{
Lï¿½Vï¿½ï¿½ï¿½Uï¿½ï¿½F}kï¿½[mTï¿½ï¿½B!ï¿½ï¿½4Ä’Ä»ï¿½3ï¿½sï¿½ï¿½?yï¿½ï¿½\*jIy\*+,(ï¿½ï¿½ï¿½ t#ï¿½8ï¿½qï¿½4ï¿½ORI5ï¿½<ï¿½ï¿½mï¿½ï¿½6ï¿½ï¿½Hd]ï¿½b{c=ï¿½ï¿½Y'Ãšï¿½
ï¿½ï¿½Oï¿½Mï¿½ï¿½ï¿½sï¿½ï¿½ï¿½ ï¿½\_Âï¿½iwï¿½sÂšzï¿½ï¿½GMï¿½Xï¿½xï¿½ï¿½`Iï¿½Mï¿½ï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½Ä¬ï¿½Sï¿½ï¿½Ê½ï¿½;
Ry-ï¿½ï¿½-ï¿½ï¿½ï¿½ï¿½äŒ•8\*ï¿½ï¿½ï¿½ï¿½ï¿½Dï¿½
M$ï¿½qw\*ï¿½ï¿½ï¿½ï¿½ï¿½Nï¿½gï¿½ï¿½8ï¿½ï¿½ï¿½ï¿½Ý¤ï¿½ï¿½mï¿½ï¿½>ï¿½ï¿½rzï¿½ ï¿½ï¿½Qï¿½Uï¿½L
ï¿½ï¿½1'ï¿½sï¿½0\*0Pï¿½ï¿½=O<{W{wefu<Hï¿½ï¿½ï¿½Hwï¿½Tï¿½ï¿½o`oAï¿½@ï¿½ï¿½ï¿½iqCï¿½G6ï¿½ï¿½?08ï¿½ï¿½ï¿½ï¿½ <ï¿½Wï¿½ï¿½ï¿½ï¿½(ï¿½VUhUï¿½ï¿½$ï¿½ï¿½ï¿½Ê³ï¿½ï¿½4%ï¿½Ô¤ï¿½ï¿½$#ï¿½ï¿½ï¿½ï¿½Ttï¿½?\*ï¿½/--ï¿½ï¿½"eï¿½9ï¿½Ï¦Ooz ï¿½$sï¿½ï¿½ï¿½F:ï¿½tPï¿½Õ®ï¿½ï¿½pï¿½ï¿½ï¿½9 vÏ¥E&ï¿½u#ï¿½ï¿½2ï¿½ï¿½Aï¿½Zï¿½ ï¿½ï¿½slï¿½bï¿½×œï¿½ï¿½ï¿½ï¿½Sï¿½ëš•ï¿½ï¿½È—rï¿½ï¿½~GrTï¿½ï¿½ï¿½{ï¿½uï¿½>ï¿½wqxnï¿½|HNI^\*ï¿½ï¿½&bï¿½!$ï¿½ï¿½ï¿½Pï¿½wpï¿½gï¿½Ö£gg9bM6ï¿½ ï¿½ï¿½
