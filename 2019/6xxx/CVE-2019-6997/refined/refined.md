```
CVE-2019-6997
```

**Root Cause:** System notes and markdown fields in issues referencing merge requests reveal the merge request title in the tooltip to guest users who do not have access to the merge requests.

**Weaknesses/Vulnerabilities:**
*   Insufficient permission checks in the markdown rendering pipeline. Merge request references are rendered for guest users without verifying if they have access to the merge requests.

**Impact of Exploitation:** Guest users can enumerate merge requests and read their titles, even in private projects where they should not have access.

**Attack Vectors:**
1.  A developer user creates an issue and a merge request. The merge request description references the issue. A guest user opens the issue and sees a system note indicating that the issue is referenced by the merge request. Hovering over the system note reveals the merge request title.
2.  A guest user creates an issue and includes a reference to a merge request in the issue description using markdown syntax (e.g., `[!1]`). The merge request link is rendered, and the tooltip shows the merge request title.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be a guest user of a private project.
*   The project must have at least one merge request.
*   Another user (e.g., developer) must have created either: an issue where a system note references a merge request, or the guest user must be able to create an issue that references a merge request.