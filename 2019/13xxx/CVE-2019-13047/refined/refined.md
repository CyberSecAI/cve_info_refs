```
{
  "Root cause of vulnerability": "The vulnerability lies in the `sysfunc` system call, specifically `TOARU_SYS_FUNC_SETHEAP`, which allows a user to set the heap address to an arbitrary value. This allows mapping kernel memory into the user-space heap. By finding the `current_process` variable in kernel space and mapping its location into the user's address space, the attacker can modify the `user` and `real_user` values of the current process structure to `0`, effectively granting root privileges to the user.",
  "Weaknesses/vulnerabilities present": [
    "Arbitrary Kernel Memory Mapping: The `TOARU_SYS_FUNC_SETHEAP` syscall allows user-space programs to set their heap to any address, including kernel memory.",
    "Lack of access control on process struct: The process struct with user and real_user id's is accessible and modifiable."
  ],
  "Impact of exploitation": "The attacker gains root privileges, allowing them to execute arbitrary code with full system access.",
  "Attack vectors": "Local execution of the exploit on a vulnerable system.",
  "Required attacker capabilities/position": "The attacker needs to be able to execute code on a vulnerable system. This is typically a local attacker but can also be a remote attacker with the ability to execute code."
}
```