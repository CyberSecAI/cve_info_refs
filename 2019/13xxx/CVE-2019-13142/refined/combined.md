=== Content from posts.specterops.io_3daea44f_20250120_233143.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff18c52b8be0c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2019–13142: Razer Surround 1.1.63.0 EoP

[![Matt Nelson](https://miro.medium.com/v2/resize:fill:88:88/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---byline--f18c52b8be0c--------------------------------)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---byline--f18c52b8be0c--------------------------------)

[Matt Nelson](https://medium.com/%40enigma0x3?source=post_page---byline--f18c52b8be0c--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--byline--f18c52b8be0c---------------------post_header-----------)

Published in[Posts By SpecterOps Team Members](https://posts.specterops.io/?source=post_page---byline--f18c52b8be0c--------------------------------)·5 min read·Jul 5, 2019

--

Listen

Share

**Version:** Razer Surround 1.1.63.0
**Operating System tested on:** Windows 10 1803 (x64)
**Vulnerability:** Razer Surround Elevation of Privilege through Insecure folder/file permissions

**Purpose**
 I hope that this post serves as a motivator for folks who see vulnerability research as an intimidating area to get started in. While this bug can be considered simple, the primary purpose of this post is to outline the methodology behind how to get started and what to look for. Additionally, I’d like it to serve as a reminder to not discount the low hanging fruit, no matter how large the organization.

**Brief Description:**
[Razer Surround](https://www.razer.com/7.1-surround-sound) installs a service named “RzSurroundVADStreamingService” that runs as SYSTEM. This service runs “RzSurroundVADStreamingService.exe” out of “C:\ProgramData\Razer\Synapse\Devices\Razer Surround\Driver”. The permissions on RzSurroundVADStreamingService.exe and “C:\ProgramData\Razer\Synapse\Devices\Razer Surround\Driver” allow for overwriting the service binary with a malicious one, resulting in elevation of privilege to SYSTEM.

**Identification and Exploitation**
 When doing vulnerability research, picking a target to go after can be challenging. Hunting for bugs in large software platforms can be intimidating as there is an assumption that all vulnerabilities are complex and take a special skill set to identify. I’d like to use this vulnerability as an example as to why the act of hunting for vulnerabilities isn’t as hard as it sounds.

You may ask, why Razer? How do you identify a piece of software to begin hunting for vulnerabilities in? The answer is simple: Investigate what interests you. In this case, I own various Razer products. It is hard to ignore the urge to look when you use a product and the software associated with it every day.

When looking for vulnerabilities, there is often a common workflow that I follow once the software of interest is installed. This stage involves analyzing the potential attack surface that the target software has exposed. I typically start with the basics and then resort to dynamic/static analysis if needed. The things I typically look for initially are:

1. Installed services (both the service permissions and the service executable/path permission)
2. Named pipes (and their ACLs)
3. Log file permissions in folders like C:\ProgramData
4. Network sockets
5. DCOM servers and hosted interfaces

As far as tooling goes, I mostly stick to [Process Monitor](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon) and [James Forshaw’](https://twitter.com/tiraniddo)s [NTObjectManager](https://github.com/googleprojectzero/sandbox-attacksurface-analysis-tools/tree/master/NtObjectManager) project.

In the instance of Razer Surround, I began by checking what privileged processes the software uses by looking at the process list. This revealed that “RzSurroundVADStreamingService.exe” was running as “NT AUTHORITY\SYSTEM”. The next step was to figure out how that process was being started. Given the name of the process has “service” in it, that is a good starting point. To verify, it was easy enough to do “Get-Service \*Rz\*” in Powershell, which returned all of the services with “Rz” in the name. This led me to the “RzSurroundVadStreamingService” system service with the ImagePath set to the executable of interest. After dumping the ImagePath, the location of the service executable stood out as it was running out of “C:\ProgramData\Razer\Synapse\Devices\Razer Surround\Driver\”

![]()

ImagePath for “RzSurroundVADStreamingService”

Why is this interesting? By default, “BUILTIN\Users” have “GenericWrite” access to C:\ProgramData:

![]()

C:\ProgramData permissions

A very common error that software developers make is not properly locking down the permissions of any created subfolders in C:\ProgramData. If an installer simply creates a folder in C:\ProgramData, that folder and any subfolders will have inherited permissions of C:\ProgramData, which include the “GenericWrite” access right for “BUILTIN\Users”.

Improper file and folder permissions were the culprit in this case as “Everyone” was eventually granted “FullControl” over any files in “C:\ProgramData\Razer\Synapse\Devices\Razer Surround\Driver”

![]()

Access rights for the service executable folder

As previously noted, this path is where the “RzSurroundVADStreamingService” ImagePath for the service executable was pointing to. Given a low privileged user has “FullControl” over the folder and included files, it is possible to just replace the service executable for the “RzSurroundVADStreamingService” system service:

![]()

Overwriting the service executable

Once the payload is copied, rebooting the host will cause the service to start the new executable as SYSTEM. In this instance, the new service executable will start cmd.exe as SYSTEM:

![]()

Copied payload running as SYSTEM

Razer fixed this vulnerability by moving “RzSurroundVADStreamingService.exe” and the associated dependencies to a secured location in “C:\Program Files (x86)\Razer”.

**Disclosure Timeline**
 As committed as SpecterOps is to [transparency](/a-push-toward-transparency-c385a0dd1e34) , we acknowledge the speed at which attackers adopt new offensive techniques once they are made public. This is why prior to publicization of a new bug or offensive technique, we regularly inform the respective vendor of the issue, supply ample time to mitigate the issue, and notify select, trusted vendors in order to ensure that detections can be delivered to their customers as quickly as possible.

* March 20th, 2019 — Initial report sent to Razer
* March 21st, 2019 — Report acknowledgement received from Razer
* April 30th, 2019–30 days after initial report
* May 2nd, 2019 — Razer provided a fixed build to test
* May 2nd, 2019 — Fix was verified
* May 20th, 2019–60 days after initial report
* June 6th, 2019 — Reached out to Razer for a timeframe regarding a public fix
* June 6th, 2019 — Razer informed me a fix should be live, but verification from the development team was needed
* June 7th, 2019 — Informed Razer that a fix wasn’t available on the site or via Surround’s update mechanism
* June 10th, 2019 — Razer informed me that there had been some internal confusion and that a fix was going live the end of June
* June 11th, 2019 — Informed Razer I would hold off on disclosure until the fix is live
* June 20th, 2019–90 days after initial report, extension granted
* July 1st, 2019 — Razer informed me that a note is out to the development team regarding when the fix would be pushed live
* July 5th, 2019 — Fix published

-Matt N.

*Originally published at* [*http://enigma0x3.net*](https://enigma0x3.net/2019/07/05/cve-2019-13142-razer-surround-1-1-63-0-eop/) *on July 5, 2019.*

[Security](https://medium.com/tag/security?source=post_page-----f18c52b8be0c--------------------------------)[Security Vulnerabilities](https://medium.com/tag/security-vulnerabilities?source=post_page-----f18c52b8be0c--------------------------------)[Razer](https://medium.com/tag/razer?source=post_page-----f18c52b8be0c--------------------------------)

--

--

[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:96:96/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---post_publication_info--f18c52b8be0c--------------------------------)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:128:128/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---post_publication_info--f18c52b8be0c--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&collection=Posts+By+SpecterOps+Team+Members&collectionId=f05f8696e3cc&source=post_page---post_publication_info--f18c52b8be0c---------------------follow_profile-----------)[## Published in Posts By SpecterOps Team Members](https://posts.specterops.io/?source=post_page---post_publication_info--f18c52b8be0c--------------------------------)[4.91K Followers](/followers?source=post_page---post_publication_info--f18c52b8be0c--------------------------------)·[Last published 3 days ago](/introducing-bloodhound-cli-7dfaf82e2df8?source=post_page---post_publication_info--f18c52b8be0c--------------------------------)

Posts from SpecterOps team members on various topics relating information security

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&collection=Posts+By+SpecterOps+Team+Members&collectionId=f05f8696e3cc&source=post_page---post_publication_info--f18c52b8be0c---------------------follow_profile-----------)[![Matt Nelson](https://miro.medium.com/v2/resize:fill:96:96/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---post_author_info--f18c52b8be0c--------------------------------)[![Matt Nelson](https://miro.medium.com/v2/resize:fill:128:128/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---post_author_info--f18c52b8be0c--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--post_author_info--f18c52b8be0c---------------------follow_profile-----------)[## Written by Matt Nelson](https://medium.com/%40enigma0x3?source=post_page---post_author_info--f18c52b8be0c--------------------------------)[1.5K Followers](https://medium.com/%40enigma0x3/followers?source=post_page---post_author_info--f18c52b8be0c--------------------------------)·[56 Following](https://medium.com/%40enigma0x3/following?source=post_page---post_author_info--f18c52b8be0c--------------------------------)

Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | <http://github.com/enigma0x3>

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fcve-2019-13142-razer-surround-1-1-63-0-eop-f18c52b8be0c&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--post_author_info--f18c52b8be0c---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----f18c52b8be0c--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----f18c52b8be0c--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----f18c52b8be0c--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----f18c52b8be0c--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----f18c52b8be0c--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----f18c52b8be0c--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f18c52b8be0c--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f18c52b8be0c--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----f18c52b8be0c--------------------------------)[Teams](https://medium.com/business?source=post_page-----f18c52b8be0c--------------------------------)


