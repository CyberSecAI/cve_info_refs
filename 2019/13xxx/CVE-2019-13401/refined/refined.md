```
## CVE-2019-13401 - FCM-MB40 CSRF in Multiple Scripts
### Summary
The FortiCam FCM-MB40's `/cgi-bin/` web directory contains CGI scripts that are vulnerable to cross-site request forgery (CSRF). This vulnerability allows an attacker to trick a logged-in "admin" user's browser into forging requests, which can reconfigure the FCM-MB40 in any way that the "admin" user is authorized to do through the web interface.

### Details
**Vulnerability:** CSRF vulnerability in the FortiCam FCM-MB40 firmware version v1.2.0.0.
**Root Cause:** The web interface uses GET parameters to influence the deviceâ€™s configuration without CSRF protection.

**Attack Vector:** An attacker who knows the IP address of an FCM-MB40 can trick an "admin" user into opening a crafted webpage, leading the browser to make unauthorized configuration changes on behalf of the "admin" user.

**Impact:** An attacker can perform actions such as:
*   Changing the admin password
*   Adding a new admin account
*   Restarting the camera
*   Configuring an FTP server for the camera to send footage to
*   Disabling scheduled recording
*   Upgrading firmware
*   Changing the camera hostname

**Exploitation:**

The provided HTML code demonstrates how this vulnerability can be exploited to achieve Remote Command Execution (RCE) by leveraging CVE-2019-13398. The steps are as follows:

1.  The victim (admin user) is logged into the FCM-MB40.
2.  The victim is tricked into opening a malicious HTML page.
3.  The HTML page uses JavaScript to send a request to `camctrl_save_profile.cgi` to inject a reverse shell command into `/cgi-bin/ddns.cgi` via the `name` parameter.
4.  Another request is sent to `ddns.cgi`, which executes the injected reverse shell command, giving the attacker root access.

**Example URL:** `http://192.168.1.20/cgi-bin/date.cgi?system_hostname=NewHostname`

### Recommended Remediations
*   All web application parameters used to modify device state should be required to be sent as POST parameters.
*   POST requests should be protected by implementing CSRF protection, such as dynamic secret tokens.
```