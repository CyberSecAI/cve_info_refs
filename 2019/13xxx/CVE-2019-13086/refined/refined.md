- **Root cause of vulnerability**: The `HTTP_USER_AGENT` field from the user's request is inserted directly into an SQL query without any sanitization or validation when logging failed login attempts.
- **Weaknesses/vulnerabilities present**: Time-based blind SQL injection vulnerability. The lack of input sanitization allows for arbitrary SQL code injection via the `HTTP_USER_AGENT` header.
- **Impact of exploitation**: An attacker can dump the entire database without needing to log in. This includes sensitive information like usernames, passwords, and other data stored in the database.
- **Attack vectors**: By crafting a malicious `HTTP_USER_AGENT` string in the request header and removing the `csrf_csz` parameter, an attacker can trigger the vulnerable code path, inject SQL queries, and use time-based techniques to extract data.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the login page of the vulnerable application (`http://website/cszcms-1.2.2/member/login/check`). No authentication is required, allowing remote exploitation. They need to be able to manipulate the `HTTP_USER_AGENT` header.