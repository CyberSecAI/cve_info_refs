The provided content relates to CVE-2019-13351.

**Root cause of vulnerability:**
A double close on the same file descriptor (fd) within the `jack2` library, specifically in `posix/JackSocket.cpp`. This occurs due to a race condition between the audio engine thread and the udev thread when sound devices are re-enumerated.

**Weaknesses/vulnerabilities present:**
- Double close vulnerability
- Race condition

**Impact of exploitation:**
- Crashes in applications using the `jack2` library (e.g., Kodi)
- Potential unintended information disclosure in multithreaded programs depending on the timing of the second close.

**Attack vectors:**
The vulnerability is triggered by a udev event, specifically when sound devices get re-enumerated. In the specific case described in the issue, turning on a TV and receiver that triggers udev events, and consequently triggers the vulnerability in `jack2` due to the ALSA jack plugin being enabled by default.

**Required attacker capabilities/position:**
- No direct attacker action is required, the vulnerability is triggered by normal system operations, specifically when sound devices are re-enumerated due to udev events. The attacker would need to be in a position where they could trigger the events needed to cause the race condition and trigger the double close.

**Additional details:**
- The vulnerability has been present in `jack2` since at least version 1.9.1 (2009).
- The fix involves resetting the socket file descriptor (`fSocket`) to -1 after closing it on an error to prevent a subsequent double close.
- The issue manifests as an assertion failure in `libudev` due to the EBADF error resulting from the double close.
- The issue can be difficult to reproduce consistently due to the nature of the race condition.
- The vulnerability is present within the `jack2` library and affects applications using it like Kodi.