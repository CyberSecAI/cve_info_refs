=== Content from github.com_bdd33436_20250121_004005.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapriorit%2Fpentesting%2Fblob%2Fmaster%2Fbugs%2Firfanview%2F0x00000000000249c6.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapriorit%2Fpentesting%2Fblob%2Fmaster%2Fbugs%2Firfanview%2F0x00000000000249c6.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=apriorit%2Fpentesting)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apriorit](/apriorit)
/
**[pentesting](/apriorit/pentesting)**
Public

* [Notifications](/login?return_to=%2Fapriorit%2Fpentesting) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fapriorit%2Fpentesting)
* [Star
   6](/login?return_to=%2Fapriorit%2Fpentesting)

* [Code](/apriorit/pentesting)
* [Issues
  1](/apriorit/pentesting/issues)
* [Pull requests
  0](/apriorit/pentesting/pulls)
* [Actions](/apriorit/pentesting/actions)
* [Projects
  0](/apriorit/pentesting/projects)
* [Security](/apriorit/pentesting/security)
* [Insights](/apriorit/pentesting/pulse)

Additional navigation options

* [Code](/apriorit/pentesting)
* [Issues](/apriorit/pentesting/issues)
* [Pull requests](/apriorit/pentesting/pulls)
* [Actions](/apriorit/pentesting/actions)
* [Projects](/apriorit/pentesting/projects)
* [Security](/apriorit/pentesting/security)
* [Insights](/apriorit/pentesting/pulse)

## Files

 master
## Breadcrumbs

1. [pentesting](/apriorit/pentesting/tree/master)
2. /[bugs](/apriorit/pentesting/tree/master/bugs)
3. /[irfanview](/apriorit/pentesting/tree/master/bugs/irfanview)
/
# 0x00000000000249c6.md

Copy path Blame  Blame
## Latest commit

## History

[History](/apriorit/pentesting/commits/master/bugs/irfanview/0x00000000000249c6.md)97 lines (89 loc) · 6.21 KB master
## Breadcrumbs

1. [pentesting](/apriorit/pentesting/tree/master)
2. /[bugs](/apriorit/pentesting/tree/master/bugs)
3. /[irfanview](/apriorit/pentesting/tree/master/bugs/irfanview)
/
# 0x00000000000249c6.md

Top
## File metadata and controls

* Preview
* Code
* Blame

97 lines (89 loc) · 6.21 KB[Raw](https://github.com/apriorit/pentesting/raw/refs/heads/master/bugs/irfanview/0x00000000000249c6.md)
# IrfanView 4.52 - Exploitable - User Mode Write AV starting at image00400000+0x00000000000249c6 (Hash=0xf71acf8d.0x0999f838)

[![](https://camo.githubusercontent.com/bfcd5b4fe3a917e3189e1a8365ce6b2a590fc21ba6c9511b447d47ec4f435764/68747470733a2f2f692e696d6775722e636f6d2f67315777514a6a2e706e67)](https://camo.githubusercontent.com/bfcd5b4fe3a917e3189e1a8365ce6b2a590fc21ba6c9511b447d47ec4f435764/68747470733a2f2f692e696d6775722e636f6d2f67315777514a6a2e706e67)

## The bug

```
Microsoft (R) Windows Debugger Version 10.0.18362.1 X86
Copyright (c) Microsoft Corporation. All rights reserved.

CommandLine: "z:\s\apr\blackhat\tools\irfan\i_view32.exe" "z:\s\apr\blackhat\crashes_reproduce\irfan\s3\crashes_20190326220014\id_000002_00.pcx"
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\atlmfc.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\concurrency.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\cpp_rest.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\stl.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\Windows.Data.Json.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\Windows.Devices.Geolocation.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\Windows.Devices.Sensors.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\Windows.Media.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\windows.natvis'
NatVis script successfully loaded from 'c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\Visualizers\winrt.natvis'

************* Path validation summary **************
Response                         Time (ms)     Location
Deferred                                       SRV*z:\s\symbols*http://msdl.microsoft.com/download/symbols
Deferred                                       srv*z:\s\symbols*\\vmware-host\Shared Folders\s\symbols*http://msdl.microsoft.com/download/symbols
Deferred                                       srv*z:\s\symbols*https://msdl.microsoft.com/download/symbols
Symbol search path is: SRV*z:\s\symbols*http://msdl.microsoft.com/download/symbols;srv*z:\s\symbols*\\vmware-host\Shared Folders\s\symbols*http://msdl.microsoft.com/download/symbols;srv*z:\s\symbols*https://msdl.microsoft.com/download/symbols
Executable search path is:
ModLoad: 00400000 005d7000   image00400000
ModLoad: 77a20000 77bb0000   ntdll.dll
Page heap: pid 0xCE0: page heap enabled with flags 0x3.
ModLoad: 71790000 717f4000   C:\Windows\SysWOW64\verifier.dll
Page heap: pid 0xCE0: page heap enabled with flags 0x3.
ModLoad: 772d0000 773b0000   C:\Windows\SysWOW64\KERNEL32.DLL
ModLoad: 76d00000 76ee4000   C:\Windows\SysWOW64\KERNELBASE.dll
ModLoad: 76a70000 76bfd000   C:\Windows\SysWOW64\USER32.dll
ModLoad: 74300000 74317000   C:\Windows\SysWOW64\win32u.dll
ModLoad: 75ac0000 75ae2000   C:\Windows\SysWOW64\GDI32.dll
ModLoad: 76ef0000 77054000   C:\Windows\SysWOW64\gdi32full.dll
ModLoad: 77410000 7748d000   C:\Windows\SysWOW64\msvcp_win.dll
ModLoad: 74320000 7443d000   C:\Windows\SysWOW64\ucrtbase.dll
ModLoad: 74440000 7578a000   C:\Windows\SysWOW64\SHELL32.dll
ModLoad: 73860000 73a64000   C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.706_none_42f0d9a244e0990d\COMCTL32.dll
ModLoad: 77060000 7711f000   C:\Windows\SysWOW64\msvcrt.dll
ModLoad: 03f20000 03fdf000   C:\Windows\SysWOW64\msvcrt.dll
ModLoad: 77230000 77269000   C:\Windows\SysWOW64\cfgmgr32.dll
ModLoad: 75dc0000 7601c000   C:\Windows\SysWOW64\combase.dll
ModLoad: 77490000 77518000   C:\Windows\SysWOW64\shcore.dll
ModLoad: 75cf0000 75db0000   C:\Windows\SysWOW64\RPCRT4.dll
ModLoad: 03f20000 03fe0000   C:\Windows\SysWOW64\RPCRT4.dll
ModLoad: 76450000 76a0a000   C:\Windows\SysWOW64\windows.storage.dll
ModLoad: 758c0000 75938000   C:\Windows\SysWOW64\advapi32.dll
ModLoad: 742e0000 74300000   C:\Windows\SysWOW64\SspiCli.dll
ModLoad: 75b40000 75b84000   C:\Windows\SysWOW64\sechost.dll
ModLoad: 742d0000 742da000   C:\Windows\SysWOW64\CRYPTBASE.dll
ModLoad: 77670000 776c8000   C:\Windows\SysWOW64\bcryptPrimitives.dll
ModLoad: 771e0000 77225000   C:\Windows\SysWOW64\shlwapi.dll
ModLoad: 77870000 7787f000   C:\Windows\SysWOW64\kernel.appcore.dll
ModLoad: 77880000 77898000   C:\Windows\SysWOW64\profapi.dll
ModLoad: 75af0000 75b35000   C:\Windows\SysWOW64\powrprof.dll
ModLoad: 77120000 77128000   C:\Windows\SysWOW64\FLTLIB.DLL
ModLoad: 75790000 757b6000   C:\Windows\SysWOW64\IMM32.DLL
ModLoad: 737c0000 7383c000   C:\Windows\SysWOW64\uxtheme.dll
ModLoad: 77520000 77663000   C:\Windows\SysWOW64\MSCTF.dll
ModLoad: 77140000 771d6000   C:\Windows\SysWOW64\OLEAUT32.dll
ModLoad: 734e0000 73503000   C:\Windows\SysWOW64\dwmapi.dll
ModLoad: 73440000 734bd000   C:\Windows\SysWOW64\TextInputFramework.dll
ModLoad: 73150000 731db000   C:\Windows\SysWOW64\CoreMessaging.dll
ModLoad: 731e0000 7343d000   C:\Windows\SysWOW64\CoreUIComponents.dll
ModLoad: 73120000 73149000   C:\Windows\SysWOW64\ntmarta.dll
ModLoad: 73040000 73116000   C:\Windows\SysWOW64\wintypes.dll
ModLoad: 0a240000 0a316000   C:\Windows\SysWOW64\wintypes.dll
(ce0.954): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000001 ecx=00000000 edx=00000000 esi=0af7b000 edi=00000000
eip=004249c6 esp=0019e1c0 ebp=00000001 iopl=0         nv up ei pl nz ac pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010216
image00400000+0x249c6:
004249c6 8806            mov     byte ptr [esi],al          ds:002b:0af7b000=??
0:000> $<z:\s\apr\office\crashes\cmd.txt
0:000> .load msec.dll
0:000> kb
 # ChildEBP RetAddr  Args to Child
WARNING: Stack unwind information not available. Following frames may be wrong.
00 0019e208 004a4628 0af5c050 3f000000 0059dab0 image00400000+0x249c6
01 00000000 00000000 00000000 00000000 00000000 image00400000+0xa4628
0:000> !exploitable

!exploitable 1.6.0.0
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at image00400000+0x00000000000249c6 (Hash=0xf71acf8d.0x0999f838)

User mode write access violations that are not near NULL are exploitable.

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


