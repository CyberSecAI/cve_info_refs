=== Content from github.com_f6b76a18_20250120_232029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsungjungk%2Ffp-scanner-hacking)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsungjungk%2Ffp-scanner-hacking)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=sungjungk%2Ffp-scanner-hacking)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sungjungk](/sungjungk)
/
**[fp-scanner-hacking](/sungjungk/fp-scanner-hacking)**
Public

* [Notifications](/login?return_to=%2Fsungjungk%2Ffp-scanner-hacking) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fsungjungk%2Ffp-scanner-hacking)
* [Star
   3](/login?return_to=%2Fsungjungk%2Ffp-scanner-hacking)

[3
stars](/sungjungk/fp-scanner-hacking/stargazers) [0
forks](/sungjungk/fp-scanner-hacking/forks) [Branches](/sungjungk/fp-scanner-hacking/branches) [Tags](/sungjungk/fp-scanner-hacking/tags) [Activity](/sungjungk/fp-scanner-hacking/activity)
 [Star](/login?return_to=%2Fsungjungk%2Ffp-scanner-hacking)

 [Notifications](/login?return_to=%2Fsungjungk%2Ffp-scanner-hacking) You must be signed in to change notification settings

* [Code](/sungjungk/fp-scanner-hacking)
* [Issues
  0](/sungjungk/fp-scanner-hacking/issues)
* [Pull requests
  0](/sungjungk/fp-scanner-hacking/pulls)
* [Actions](/sungjungk/fp-scanner-hacking/actions)
* [Projects
  0](/sungjungk/fp-scanner-hacking/projects)
* [Security](/sungjungk/fp-scanner-hacking/security)
* [Insights](/sungjungk/fp-scanner-hacking/pulse)

Additional navigation options

* [Code](/sungjungk/fp-scanner-hacking)
* [Issues](/sungjungk/fp-scanner-hacking/issues)
* [Pull requests](/sungjungk/fp-scanner-hacking/pulls)
* [Actions](/sungjungk/fp-scanner-hacking/actions)
* [Projects](/sungjungk/fp-scanner-hacking/projects)
* [Security](/sungjungk/fp-scanner-hacking/security)
* [Insights](/sungjungk/fp-scanner-hacking/pulse)

# sungjungk/fp-scanner-hacking

    master[Branches](/sungjungk/fp-scanner-hacking/branches)[Tags](/sungjungk/fp-scanner-hacking/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[23 Commits](/sungjungk/fp-scanner-hacking/commits/master/) | | |
| [.gitignore](/sungjungk/fp-scanner-hacking/blob/master/.gitignore ".gitignore") | | [.gitignore](/sungjungk/fp-scanner-hacking/blob/master/.gitignore ".gitignore") |  |  |
| [Makefile](/sungjungk/fp-scanner-hacking/blob/master/Makefile "Makefile") | | [Makefile](/sungjungk/fp-scanner-hacking/blob/master/Makefile "Makefile") |  |  |
| [README.md](/sungjungk/fp-scanner-hacking/blob/master/README.md "README.md") | | [README.md](/sungjungk/fp-scanner-hacking/blob/master/README.md "README.md") |  |  |
| [de-obfuscator.c](/sungjungk/fp-scanner-hacking/blob/master/de-obfuscator.c "de-obfuscator.c") | | [de-obfuscator.c](/sungjungk/fp-scanner-hacking/blob/master/de-obfuscator.c "de-obfuscator.c") |  |  |
| [de-obfuscator.h](/sungjungk/fp-scanner-hacking/blob/master/de-obfuscator.h "de-obfuscator.h") | | [de-obfuscator.h](/sungjungk/fp-scanner-hacking/blob/master/de-obfuscator.h "de-obfuscator.h") |  |  |
| View all files | | |

## Repository files navigation

* README
# Multiple Vulnerabilities in U.are.U 4500 Fingerprint Reader and its Linux/Windows Drivers

* Cleartext transmission of sensitive information (e.g., encryption key)
* Use of insufficiently random values when generating initialization vector

# Basic Operation

When a user try to use fingerprint authentication, a user might touch a finger on the fingerprint reader device.
Just after the capturing fingerprint, the driver generates an initialization vector, and sends it to the reader device.
The device makes a key for image obfuscation and do obfuscate the fingerprint image using provided initialization vector and the key.
After then, the obfuscated fingerprint image and the key are transferred to the driver.
Finally, the driver can de-obfuscate the image using provided key from the device and initialization vector that was held before.

# Vulnerabilities

[CVE-2019-12813] Key used for obfuscating fingerprint image exhibits cleartext when fingerprint scanner device transfers a fingerprint image, that is just scanned, to the driver.

* Key should remain encrypted during transfer operation
* CWE-319: Cleartext Transmission of Sensitive Information

[CVE-2019-13603, CVE-2019-13621] Initialization vector used for generating keystream is the same sequence of numbers each time.

In Windows, U.are.U 4500 Fingerprint Reader Windows Biometric Framework (WBF) 5.0.0.5 driver even has a statically coded initialization vector.

In Linux, libfprint 0.99 driver uses predictable initialization vector, that are generated by 'rand()' in libc by default.

* Initialization vector should also be in no predictable pattern
* CWE-330: Use of Insufficiently Random Values

Unfortunately, it does not comply the above criteria.

# Attack Vector

An attacker who sniffs an encrypted fingerprint image can easily decrypt that image using the key and initialization vector.
Here, the key used for obfuscating the fingerprint image exhibit cleartext when the fingerprint scanner device transfers a fingerprint image to the driver.
The initialization vector can be also extrapolated since it has been a statically coded or predictable random value.

# Timeline

2019-03-23: The issue has been identified, documented and reported to the vendor. -> no answer

2019-04-18: The issue has been reported to CERT/CC.

2019-04-19: CERT/CC have contacted the vendor and demanded immediate return with a reasonable timeline where the vendor will provide patch information. -> fail to respond

2019-05-04, 2019-05-29: CERT/CC have re-contacted the vendor and re-demanded a prompt response and providing a timeline for full mitigation of this vulnerability. -> fail to respond again

2019-06-13: CERT/CC have recommended choosing a target date for public disclosure and proceeding with disclosure.

2019-06-13: CVE-2019-12813 has been assigned.

2019-07-15: CVE-2019-13603 has been assigned.

2019-07-17: CVE-2019-13621 has been assigned.

# How to build

You require the following to build this project:

* glib-2.0

# Demo video

It is a PoC for de-obfuscating encrypted fingerprint image.

* Using cleartext key & initialization vector after MITMing fingerprint reader device
  + In Windows:

    [![Video Label](https://camo.githubusercontent.com/923705f023a223055529debc4901acc273bb5aa4460108d82ba7c3df558d15ab/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f7745584a4479454f61744d2f302e6a7067)](https://youtu.be/wEXJDyEOatM%3D0s)
  + In Linux:

    [![Video Label](https://camo.githubusercontent.com/64e1ad6df02242d51042d3c4487595af0d3add4d3675f5a8ab0847e8c32df54c/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f47726972657a32786561732f302e6a7067)](https://youtu.be/Grirez2xeast%3D0s)
* Using cleartext key & reproducible initialization vector
  + In Windows (U.are.U 4500 Fingerprint Reader WBF 5.0.0.5):

    [![Video Label](https://camo.githubusercontent.com/be08d8190e5c97e21121897acbbff3e5d788e0603c1efa5918fcc65f71451300/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f672d6b4935503448464e302f302e6a7067)](https://youtu.be/g-kI5P4HFN0%3D0s)
  + In Linux (libfprint 0.99):

    [![Video Label](https://camo.githubusercontent.com/01807c9d6b1c2c2cf2ad2353f5525fde088a527a7e86d3144a30763d3b3e12a8/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f5479485256766b4443486f2f302e6a7067)](https://youtu.be/TyHRVvkDCHo%3D0s)

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/sungjungk/fp-scanner-hacking/activity)
### Stars

[**3**
stars](/sungjungk/fp-scanner-hacking/stargazers)
### Watchers

[**2**
watching](/sungjungk/fp-scanner-hacking/watchers)
### Forks

[**0**
forks](/sungjungk/fp-scanner-hacking/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsungjungk%2Ffp-scanner-hacking&report=sungjungk+%28user%29)

## [Releases](/sungjungk/fp-scanner-hacking/releases)

No releases published

## [Packages 0](/users/sungjungk/packages?repo_name=fp-scanner-hacking)

No packages published

## Languages

* [C
  96.7%](/sungjungk/fp-scanner-hacking/search?l=c)
* [Makefile
  3.3%](/sungjungk/fp-scanner-hacking/search?l=makefile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


