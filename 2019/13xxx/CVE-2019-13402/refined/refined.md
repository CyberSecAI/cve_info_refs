```
{
  "CVE-2019-13402": {
    "related": true,
    "summary": "The FortiCam FCM-MB40’s factory reset functionality, initiated through pressing the physical factory reset button, or initiated through software, does not reset all aspects of the system to the factory state.",
    "details": "If low level access is gained to a FortiCam MB40, and filesystem modifications are made, these are not reverted when the device owner executes the factory reset function. The factory reset function is implemented in `/usr/sbin/default.sh` and `/usr/apache/htdocs/cgi-bin/admin/hardfactorydefault.cgi`. Both of these scripts reset some configuration parameters.  Combined with the previously disclosed vulnerability (CVE-2019-13398) regarding remote command execution, any user which is able to gain access to the camera is able to implant a backdoor executable on the camera which will execute whenever the camera starts, giving the attacker persistent root access to the camera. For example, a user could sell the camera on to a second owner, or the camera could be tampered with in transit to its final destination. After executing the factory reset function, a backdoor previously installed, such as a malicious cron entry or changed root password, is not removed. The only way that a user which doesn’t trust their supply chain is able to restore the device to factory defaults is to perform a firmware upgrade, however in order to perform a firmware upgrade the user must first connect the untrusted device to their network.",
    "root_cause": "The factory reset function does not fully restore the device to its original state.",
    "weaknesses": [
      "Insufficient factory reset",
       "Improper Initialisation (CWE-665)"
    ],
    "impact": "An adversary with temporary access to the device could implant a backdoor account or service which would not be removed when undertaking a factory reset, leading to persistent root access.",
    "attack_vectors": [
      "Physical access to the device.",
      "Remote access through other vulnerabilities (e.g., CVE-2019-13398)"
    ],
    "required_capabilities": "The attacker needs temporary access to the device to modify the file system."
  }
}
```