=== Content from launchpad.net_69620b9d_20250121_020600.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[flightcrew package](https://launchpad.net/ubuntu/%2Bsource/flightcrew)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/flightcrew)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/flightcrew)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/flightcrew)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/flightcrew)

# flightcrew 0.7.2+dfsg-6ubuntu0.1 source package in Ubuntu

## Changelog

```
flightcrew (0.7.2+dfsg-6ubuntu0.1) xenial-security; urgency=medium

  * SECURITY UPDATE: NULL pointer dereference (DoS) when processing crafted
    EPUB file
    - debian/patches/CVE-2019-13032-1.patch: prevent segfault from malformed
      opf items in GetRelativePathToNcx()
    - debian/patches/CVE-2019-13032-2.patch: prevent segfault from malformed
      opf items in GetRelativePathsToXhtmlDocuments()
    - CVE-2019-13032
  * SECURITY UPDATE: Zip Slip directory traversal when processing a crafted
    EPUB file
    - debian/patches/CVE-2019-13241-1.patch: try to make extracting epbs safer
    - debian/patches/CVE-2019-13241-2.patch: further harden zip extraction to
      always be safe
    - debian/patches/CVE-2019-13241-3.patch: harden further by throwing
      exception
    - CVE-2019-13241
  * SECURITY UPDATE: Infinite loop leading to DoS and resource consumption
    - debian/patches/CVE-2019-13453.patch: Prevent infinite loop in zipios
      library by checking for EOF
    - CVE-2019-13453

 -- Mike Salvatore <email address hidden>  Mon, 01 Jul 2019 15:30:43 -0400
```

## Upload details

Uploaded by:
[Mike Salvatore](/~mikesalvatore)
on 2019-07-11

Uploaded to:
[Xenial](/ubuntu/xenial)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any all

Section:
text

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |
| [Xenial](/ubuntu/xenial) | updates | on 2019-07-15 | universe | misc |
| [Xenial](/ubuntu/xenial) | security | on 2019-07-15 | universe | misc |

## Builds

[Xenial](/ubuntu/xenial):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257338)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[arm64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257339)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257340)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257341)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257342)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ppc64el](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257343)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[s390x](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17257344)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [flightcrew\_0.7.2+dfsg.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1/flightcrew_0.7.2%2Bdfsg.orig.tar.gz) | 498.9 KiB | e65a3f639fd601c008b1e1f4c434098dbb1628839a6f8614a3b69d47aa057d1d |
| [flightcrew\_0.7.2+dfsg-6ubuntu0.1.debian.tar.xz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1/flightcrew_0.7.2%2Bdfsg-6ubuntu0.1.debian.tar.xz) | 10.5 KiB | 8aa969321dee3dcb0547ac37df8e4679d78dc64ef66b4405eba6db3107cf459e |
| [flightcrew\_0.7.2+dfsg-6ubuntu0.1.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1/flightcrew_0.7.2%2Bdfsg-6ubuntu0.1.dsc) | 2.2 KiB | 0564411cfdf1ae7f6a91c6d78aafcdb8d86df4fbd27b1e99069cea2c134aa699 |

### Available diffs

* [diff from 0.7.2+dfsg-6 (in Debian) to 0.7.2+dfsg-6ubuntu0.1](http://launchpadlibrarian.net/432697491/flightcrew_0.7.2%2Bdfsg-6_0.7.2%2Bdfsg-6ubuntu0.1.diff.gz) (3.7 KiB)

[View changes file](http://launchpadlibrarian.net/432697396/flightcrew_0.7.2%2Bdfsg-6ubuntu0.1_source.changes)

## Binary packages built by this source

[flightcrew](/ubuntu/xenial/%2Bpackage/flightcrew):
C++ epub validator

FlightCrew is an epub validator written in C++. It is used by sigil

 to validate epub files, and may be generally useful for other epub

 creation utilities.

[flightcrew-dbgsym](/ubuntu/xenial/%2Bpackage/flightcrew-dbgsym):
debug symbols for package flightcrew

FlightCrew is an epub validator written in C++. It is used by sigil

 to validate epub files, and may be generally useful for other epub

 creation utilities.

[libflightcrew-dev](/ubuntu/xenial/%2Bpackage/libflightcrew-dev):
C++ library development filesfor epub validation

FlightCrew is an epub validator written in C++. It is used by sigil

 to validate epub files, and may be generally useful for other epub

 creation utilities.

 .

 This package contains the development headers.

[libflightcrew0v5](/ubuntu/xenial/%2Bpackage/libflightcrew0v5):
C++ library for epub validation

FlightCrew is an epub validator written in C++. It is used by sigil

 to validate epub files, and may be generally useful for other epub

 creation utilities.

 .

 This package contains the shared library.

[libflightcrew0v5-dbgsym](/ubuntu/xenial/%2Bpackage/libflightcrew0v5-dbgsym):
debug symbols for package libflightcrew0v5

FlightCrew is an epub validator written in C++. It is used by sigil

 to validate epub files, and may be generally useful for other epub

 creation utilities.

 .

 This package contains the shared library.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_f9868921_20250121_020559.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSigil-Ebook%2Fflightcrew%2Fissues%2F53)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSigil-Ebook%2Fflightcrew%2Fissues%2F53)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Sigil-Ebook%2Fflightcrew)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jul 28, 2023. It is now read-only.

[Sigil-Ebook](/Sigil-Ebook)
/
**[flightcrew](/Sigil-Ebook/flightcrew)**
Public archive

* [Notifications](/login?return_to=%2FSigil-Ebook%2Fflightcrew) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2FSigil-Ebook%2Fflightcrew)
* [Star
   35](/login?return_to=%2FSigil-Ebook%2Fflightcrew)

* [Code](/Sigil-Ebook/flightcrew)
* [Issues
  0](/Sigil-Ebook/flightcrew/issues)
* [Pull requests
  0](/Sigil-Ebook/flightcrew/pulls)
* [Actions](/Sigil-Ebook/flightcrew/actions)
* [Projects
  0](/Sigil-Ebook/flightcrew/projects)
* [Security](/Sigil-Ebook/flightcrew/security)
* [Insights](/Sigil-Ebook/flightcrew/pulse)

Additional navigation options

* [Code](/Sigil-Ebook/flightcrew)
* [Issues](/Sigil-Ebook/flightcrew/issues)
* [Pull requests](/Sigil-Ebook/flightcrew/pulls)
* [Actions](/Sigil-Ebook/flightcrew/actions)
* [Projects](/Sigil-Ebook/flightcrew/projects)
* [Security](/Sigil-Ebook/flightcrew/security)
* [Insights](/Sigil-Ebook/flightcrew/pulse)

This repository has been archived by the owner on Jul 28, 2023. It is now read-only.

# Null Pointer Dereference #53

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Null Pointer Dereference](#top)#53Copy link![@mssalvatore](https://avatars.githubusercontent.com/u/19957806?u=ab617379f51ef77736da7dc9f449b721be47a94e&v=4&size=80)
## Description

![@mssalvatore](https://avatars.githubusercontent.com/u/19957806?u=ab617379f51ef77736da7dc9f449b721be47a94e&v=4&size=48)[mssalvatore](https://github.com/mssalvatore)opened [on Jun 26, 2019](https://github.com/Sigil-Ebook/flightcrew/issues/53#issue-461041671)

**Summary**

An issue was discovered in FlightCrew v0.9.2 and earlier. A NULL pointer dereference occurs in GetRelativePathToNcx() when a null pointer is passed to xc::XMLUri::isValidURI().

**Details**

If the package.opf contains `<item>` elements without "href" attributes, then the variable "href" is set to an empty string on [ValidateEpub.cpp:118](https://github.com/Sigil-Ebook/flightcrew/blob/1847f8901ae892182490d06795ba1f9339bfa743/src/FlightCrew/Framework/ValidateEpub.cpp#L118). On [ValidateEpub.cpp:121](https://github.com/Sigil-Ebook/flightcrew/blob/1847f8901ae892182490d06795ba1f9339bfa743/src/FlightCrew/Framework/ValidateEpub.cpp#L121), "toX(href)" is called which returns a NULL pointer if href is empty. This pointer is then passed to xc::XMLUri::isValidURI() which dereferences it, causing a segmentation fault.

In the attached null\_ptr.zip, you'll see that the href attributes in EPUB/package.opf have been replaced by the attribute "malformed".

**Impact**

This vulnerability has very little security impact for Sigil users, but may be used as a Denial of Service attack against third-party software that uses FlightCrew as a library.

**Steps to reproduce**

1. Download the attached "null\_ptr.zip"
2. On a linux system, process "null\_ptr.zip" using flightcrew-cli.

   `flightcrew-cli --input-file null_ptr.zip`

At this point, flightcrew-cli will segfault.

[null\_ptr.zip](https://github.com/Sigil-Ebook/flightcrew/files/3330816/null_ptr.zip)

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from salvatoresecurity.com_ff691593_20250120_235835.html ===

[![](https://salvatoresecurity.com/wp-content/uploads/2022/02/2020_headshot_small.jpeg)](https://salvatoresecurity.com/)
## [Mike Salvatore's Blog](https://salvatoresecurity.com "Mike Salvatore's Blog")

### A blog about cybersecurity

* [Blog](https://salvatoresecurity.com)
  + [Development](https://salvatoresecurity.com/category/dev/)
  + [Editorials](https://salvatoresecurity.com/category/editorials/)
  + [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)
* [About Me](https://salvatoresecurity.com/about/)

# Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 1 of 3)

June 24, 2019

This is the first in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day. This post discusses the steps leading up to the discovery of the first vulnerability. The first vulnerability is the least impactful of the three, but they get progressively more interesting.

## Introduction

I had been working at [Canonical](https://canonical.com/) on the [Ubuntu Security Team](https://wiki.ubuntu.com/SecurityTeam) for about a year when I decided to try my hand at vulnerability research. All day long, I investigated vulnerabilities that were reported against packages in Ubuntu. I thought it would be interesting to discover one myself. I was surprised by how quickly I found not one, but three vulnerabilities ([CVE-2019-13032](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13032), [CVE-2019-13453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13453), and [CVE-2019-13241](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13241)).

New vulnerabilities are discovered every day by fuzzing applications. Fuzzing is the process of providing a program with random or semi-random input and observing what happens; a fuzzer is a tool that automates this process. (You can read more about fuzzing [here](https://www.owasp.org/index.php/Fuzzing).) In order to increase the likelihood of discovering a vulnerability, I had decided to take the following approach:

1. Search through the Ubuntu package archive and select an application that looks like it might be simple to fuzz. I didn’t have a ton of free time to devote to this project, so I didn’t want to take on anything overly complicated.
2. Search the [Ubuntu CVE Tracker](https://people.canonical.com/~ubuntu-security/cve/) to see if any vulnerabilities had previously been found in the selected application. If CVEs had already been reported, I’d be less likely to discover new vulnerabilities.
3. Use [american fuzzy lop (AFL)](http://lcamtuf.coredump.cx/afl/) to fuzz the package. Using a fuzzer would allow me to work smarter, not harder.

After a few minutes of searching through the Ubuntu archive I came across [FlightCrew](https://github.com/Sigil-Ebook/flightcrew), an EPUB validator. FlightCrew can be run as a stand-alone application or as plugin for [Sigil Ebook](https://sigil-ebook.com) or used as a library by third-party software. FlightCrew provides a command line utility for validating EPUB files, making it simple to fuzz. All I had to do was compile it using the AFL compiler, find some [sample EPUB files](https://github.com/IDPF/epub3-samples), and sit back and let the fuzzer do all the work. Within minutes, I had discovered the first vulnerability: a [NULL pointer dereference](https://www.owasp.org/index.php/Null_Dereference).

![](https://i0.wp.com/salvatoresecurity.com/wp-content/uploads/2019/06/flightcrew-afl-1-1.png?resize=641%2C557&ssl=1)

AFL status

## Vulnerability Analysis

It turns out that EPUBs are just ZIP archives that contain a specific set of files. To understand what might be causing FlightCrew to crash, I extracted both the original EPUB and the fuzzed EPUB. Then, I used [Meld](https://meldmerge.org/) to compare the contents of the archives.

![](https://i0.wp.com/salvatoresecurity.com/wp-content/uploads/2019/06/meld_vulnerabile_file-1.png?resize=700%2C104&ssl=1)

Diff of original and fuzzed EPUB files

Interesting! The `href` attribute of the item elements had been corrupted, as had the `itemref` element. I fired up gdbtui (one of my favorite debugging tools) and dove in.

#### src/Xerces/Xercesc/util/XMLUri.cpp

```
// NOTE: no check for NULL value of uriStr (caller responsiblilty)
bool XMLUri::isValidURI(const XMLUri* const baseURI
                       , const XMLCh* const uriStr
                       , bool bAllowSpaces/*=false*/)
{
    // get a trimmed version of uriStr
    // uriStr will NO LONGER be used in this function.
    const XMLCh* trimmedUriSpec = uriStr;

    while (XMLChar1_0::isWhitespace(*trimmedUriSpec))
        trimmedUriSpec++;

```

The actual NULL pointer dereference occurs within the embedded copy of [Xerces-C++](https://xerces.apache.org/xerces-c/) — a validating XML parser — on line 2027. The comment at the top of this method states that it is the caller’s responsibility to check whether or not `uriStr` is NULL.

#### src/FlightCrew/Framework/ValidatEpub.cpp

```
fs::path GetRelativePathToNcx( const xc::DOMDocument &opf )
{
    std::vector< xc::DOMElement* > items = xe::GetElementsByQName(
        opf, QName( "item", OPF_XML_NAMESPACE ) );

    foreach( xc::DOMElement* item, items )
    {
        std::string href       = fromX( item->getAttribute( toX( "href" )       ) );
        std::string media_type = fromX( item->getAttribute( toX( "media-type" ) ) );

        if ( xc::XMLUri::isValidURI( true, toX( href ) ) &&
             media_type == NCX_MIME )
        {
            return Util::Utf8PathToBoostPath( Util::UrlDecode( href ) );
        }
    }

    return fs::path();
}
```

Working our way up the stack, we can see that `href` is initialized on line 118. Using gdbtui, I found that `href` was an empty string. This makes sense, as the fuzzed EPUB file contains no href elements. We can see on line 121 that `href` is passed into `toX()`, and the result is then passed to `xc::XMLUri::isValidURI()`.

#### src/XercesExtensions/ToXercesStringConverter.h

```
#define toX( str ) XercesExt::ToXercesStringConverter( (str) ).XercesString()
```
#### src/XercesExtensions/ToXercesStringConverter.cpp

```
ToXercesStringConverter::ToXercesStringConverter( const char* const utf8_string )
{
    if ( utf8_string )
    {
        size_t string_length = strlen( utf8_string );

        if ( string_length > 0 )
        {
            xc::TranscodeFromStr transcoder(
                (const XMLByte*) utf8_string, string_length, "UTF-8" );

            m_XercesString = transcoder.adopt();
        }

        else
        {
            m_XercesString = NULL;
        }
    }

    else
    {
        m_XercesString = NULL;
    }
}
...
const XMLCh* ToXercesStringConverter::XercesString() const
{
    return m_XercesString;
}

```

Here is where it all comes together: It turns out that `toX()` is a macro that calls the function `ToXercesStringConverter::ToXercesStringConverter()`. We can see on line 51 that, if the input string has a zero length, this function will set the pointer `m_XercesString` to NULL. The `ToXercesStringConverter::XecesString()` function simply returns `m_XercesString`. This NULL pointer is passed to `xc::XMLUri::isValidURI()` without being checked, resulting in a NULL pointer dereference.

## Security Impact

This vulnerability is not particularly concerning within the context of Sigil and FlightCrew. While it fulfills the letter of the law and thereby qualifies as a security vulnerability — it’s a memory corruption error that degrades availability — it doesn’t really have any security impact. If my EPUB editor were to crash I might be mildly inconvenienced, but I wouldn’t feel that a security violation had occurred; applications crash all the time. While the security impact to Sigil may be minimal, to consider this crash only within the context of Sigil and FlightCrew is to miss the bigger picture.

When assessing the security risk of this bug, it’s important to consider two factors:

1. FlightCrew exists within an open source ecosystem where anyone may integrate it, in whole or in part, into their own software. As FlightCrew can function as a library or standalone EPUB validator — as used in [check-all-the-things](https://github.com/collab-qa/check-all-the-things) — bugs in FlightCrew can affect third-party software packages that depend on it.
2. FlightCrew is a validator. Its sole purpose is to accept and properly handle malformed input.

Third-party users of FlightCrew will have the expectation that they can provide it with malformed input without crashing their applications. Such crashes in these third-party applications may have greater security impact than in FlightCrew alone. For these reasons, I submitted this vulnerability to [MITRE](https://cve.mitre.org/) so it could be assigned a CVE.

## Remediation

As of July 15, 2019, Ubuntu users have access to a patched version of FlightCrew 0.7.2. Other FlightCrew users can apply the following patches and rebuild:

* <https://github.com/Sigil-Ebook/flightcrew/commit/c75c100218ed5c0e7652947051e28b54a75212ae>
* <https://github.com/Sigil-Ebook/flightcrew/commit/b4f4a70f604ddcb4e8e343aa0e690764fc46d780>

## Disclosure Timeline

A NULL pointer dereference vulnerability is discovered, with the help of american fuzzy lop.

Upstream developers are notified via a secure channel. A CRD of July 22, 2019 is proposed.

Upstream developers respond, requesting that the issue be made public on GitHub. Upstream developers patch the vulnerability the same day.

[CVE-2019-13032](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13032) is assigned to this vulnerability by MITRE.

## Further Reading

[Part 2](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-2-of-3/) and [Part 3](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-3-of-3/) of this series chronicle the next two vulnerabilities that I discovered while fuzzing FlightCrew.

**CVE:** <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13032>

**GitHub issue:** <https://github.com/Sigil-Ebook/flightcrew/issues/53>

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)



=== Content from usn.ubuntu.com_8c64b7c3_20250120_235836.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4055-1: flightcrew vulnerabilities

15 July 2019

Several security issues were fixed in FlightCrew.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.04](/security/notices?release=disco)
* [Ubuntu 18.10](/security/notices?release=cosmic)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [flightcrew](/security/cves?package=flightcrew) - C++ epub validator and plugin for Sigil

## Details

Mike Salvatore discovered that FlightCrew improperly handled certain

malformed EPUB files. An attacker could potentially use this vulnerability

to cause a denial of service. ([CVE-2019-13032](/security/CVE-2019-13032))

Mike Salvatore discovered that FlightCrew mishandled certain malformed EPUB

files. An attacker could use this vulnerability to write arbitrary files to

the filesystem. ([CVE-2019-13241](/security/CVE-2019-13241))

Mike Salvatore discovered that the version of Zipios included in FlightCrew

mishandled certain malformed ZIP files. An attacker could use this vulnerability

to cause a denial of service or consume system resources. ([CVE-2019-13453](/security/CVE-2019-13453))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.04

* [flightcrew](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-13ubuntu0.19.04.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-13ubuntu0.19.04.1)
* [libflightcrew0v5](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-13ubuntu0.19.04.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-13ubuntu0.19.04.1)

##### Ubuntu 18.10

* [flightcrew](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-12ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-12ubuntu0.1)
* [libflightcrew0v5](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-12ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-12ubuntu0.1)

##### Ubuntu 18.04

* [flightcrew](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-10ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-10ubuntu0.1)
* [libflightcrew0v5](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-10ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-10ubuntu0.1)

##### Ubuntu 16.04

* [flightcrew](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-6ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1)
* [libflightcrew0v5](https://launchpad.net/ubuntu/%2Bsource/flightcrew)
  -
  [0.7.2+dfsg-6ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/flightcrew/0.7.2%2Bdfsg-6ubuntu0.1)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2019-13032](/security/CVE-2019-13032)
* [CVE-2019-13241](/security/CVE-2019-13241)
* [CVE-2019-13453](/security/CVE-2019-13453)

## Related notices

* [USN-4057-1](/security/notices/USN-4057-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from salvatoresecurity.com_a9c95cbd_20250121_020557.html ===

[![](https://salvatoresecurity.com/wp-content/uploads/2022/02/2020_headshot_small.jpeg)](https://salvatoresecurity.com/)
## [Mike Salvatore's Blog](https://salvatoresecurity.com "Mike Salvatore's Blog")

### A blog about cybersecurity

* [Blog](https://salvatoresecurity.com)
  + [Development](https://salvatoresecurity.com/category/dev/)
  + [Editorials](https://salvatoresecurity.com/category/editorials/)
  + [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)
* [About Me](https://salvatoresecurity.com/about/)

# Vulnerability Research

## [The Many Perils of /tmp](https://salvatoresecurity.com/the-many-perils-of-tmp/)

November 29, 2020

You may not know this, but creating and using files in /tmp is dangerous.“ Why?” you ask. Well, /tmp is world readable and world writable, meaning that any user on the system may read or write to it. Therefore, when an application creates files in /tmp, it must take special care to create those files … [[Read more…]](https://salvatoresecurity.com/the-many-perils-of-tmp/)

Posted in: [Application Security](https://salvatoresecurity.com/category/appsec/), [Development](https://salvatoresecurity.com/category/dev/), [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Spotting /tmp Related Vulnerabilities with TmpWatcher](https://salvatoresecurity.com/spotting-tmp-related-vulnerabilities-with-tmpwatcher/)

September 9, 2020

Did you know that misuse of the /tmp directory is one of the most common security flaws? If you search mitre for the keyword “tmp”, you’ll find a plethora of vulnerabilities (529 at the time of this writing). Because /tmp is a world-writable directory, applications need to be very careful about how they create and … [[Read more…]](https://salvatoresecurity.com/spotting-tmp-related-vulnerabilities-with-tmpwatcher/)

Posted in: [Development](https://salvatoresecurity.com/category/dev/), [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Exploiting Race Conditions with strace](https://salvatoresecurity.com/exploiting-race-conditions-with-strace/)

January 24, 2020

As a security professional and hobbyist, I often deal with security vulnerabilities that are caused by race conditions. By their very nature, race conditions are nondeterministic, which makes them hard to diagnose, difficult to reproduce, and tedious to debug. They can cause serious security vulnerabilities and go quietly undetected for years. Once a race condition … [[Read more…]](https://salvatoresecurity.com/exploiting-race-conditions-with-strace/)

Posted in: [Development](https://salvatoresecurity.com/category/dev/), [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Zip Slip in NLTK (CVE-2019-14751)](https://salvatoresecurity.com/zip-slip-in-nltk-cve-2019-14751/)

August 20, 2019

Description Natural Language Toolkit (NLTK) prior to version 3.4.5 is vulnerable to a directory traversal, allowing attackers to write arbitrary files via a ../ (dot dot slash) in an NLTK package (ZIP archive) that is mishandled during extraction. Vulnerability Analysis NLTK data packages provide linguistic data sets for use in natural language processing. These data … [[Read more…]](https://salvatoresecurity.com/zip-slip-in-nltk-cve-2019-14751/)

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Zip Slip in Sigil (CVE-2019-14452)](https://salvatoresecurity.com/zip-slip-in-sigil-cve-2019-14452/)

August 3, 2019

This article details my discovery of CVE-2019-14452.

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 3 of 3)](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-3-of-3/)

July 12, 2019

This is the third part in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day.

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 2 of 3)](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-2-of-3/)

July 12, 2019

This is the second in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day.

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)

## [Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 1 of 3)](https://salvatoresecurity.com/fun-with-fuzzers-or-how-i-discovered-three-vulnerabilities-part-1-of-3/)

June 24, 2019

This is the first in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day.

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)



=== Content from salvatoresecurity.com_44d9db74_20250121_020558.html ===

[![](https://salvatoresecurity.com/wp-content/uploads/2022/02/2020_headshot_small.jpeg)](https://salvatoresecurity.com/)
## [Mike Salvatore's Blog](https://salvatoresecurity.com "Mike Salvatore's Blog")

### A blog about cybersecurity

* [Blog](https://salvatoresecurity.com)
  + [Development](https://salvatoresecurity.com/category/dev/)
  + [Editorials](https://salvatoresecurity.com/category/editorials/)
  + [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)
* [About Me](https://salvatoresecurity.com/about/)

# Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 2 of 3)

July 12, 2019

This is the second in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day. If you haven’t already, you can go back and read the [first installment](https://salvatoresecurity.com/fun-with-fuzzers-or-how-i-discovered-three-vulnerabilities-part-1-of-3/).

## Introduction

I was surprised when [american fuzzy lop (AFL)](http://lcamtuf.coredump.cx/afl/) quickly found the [first vulnerability](https://salvatoresecurity.com/fun-with-fuzzers-or-how-i-discovered-three-vulnerabilities-part-1-of-3/) in [FlightCrew](https://github.com/Sigil-Ebook/flightcrew), so you can imagine my elation when it turned up the second in under two hours. This time, instead of a crash, AFL found that FlightCrew hung when it was provided with certain input. I fired up gdbtui and began to investigate.

![](https://i0.wp.com/salvatoresecurity.com/wp-content/uploads/2019/06/flightcrew-afl-with-hangs.png?resize=644%2C556&ssl=1)

AFL status

## Vulnerability Analysis

Upon examining the backtrace, it quickly became apparent that the issue was not in FlightCrew itself, but within [Zipios](http://zipios.sourceforge.net/), a third-party library for handling ZIP files. FlightCrew includes a copy of the complete source code from Zipios v0.1.5.9.

In order to understand the root cause of this bug, a brief explanation of the ZIP archive structure is in order. ZIP archives consist of local file headers, file data, and the central directory. Additional metadata is also present but is not pertinent to this discussion.

![](https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/ZIP-64_Internal_Layout.svg/800px-ZIP-64_Internal_Layout.svg.png)

[ZIP File Format](https://en.wikipedia.org/wiki/Zip_%28file_format%29)

For each file within the ZIP archive, the central directory contains a “central directory header.” The last field of a central directory header is an “offset” that points to the position of the file’s “local header.” Together, the central directory and local file headers contain the information necessary to extract file data from the ZIP archive.

![](https://i0.wp.com/users.cs.jmu.edu/buchhofp/forensics/formats/pkzip-images/central-file-header.png?w=700&ssl=1)

[Central Directory Header](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

In the fuzzed ZIP file, the “Offset of local header” field has been changed so that its value is larger than the size of the archive. We can see by examining the code that this leads to an infinite loop.

The central directory is read by the function `ZipFile::readCentralDirectory()`, which reads each central directory header. It then calls `ZipFile::confirmLocalHeaders()`.

#### src/zipios/src/zipfile.cpp

```
bool ZipFile::confirmLocalHeaders( istream &_zipfile ) {
  Entries::const_iterator it ;
  ZipCDirEntry *ent ;
  int inconsistencies = 0 ;
  ZipLocalEntry zlh ;
  for ( it = _entries.begin() ; it != _entries.end() ; it++ ) {
    ent = static_cast< ZipCDirEntry * >( (*it).get()  ) ;
    _vs.vseekg( _zipfile, ent->getLocalHeaderOffset(), ios::beg ) ;
    _zipfile >> zlh ;
    if ( ! _zipfile || zlh != *ent ) {
      inconsistencies++ ;
      _zipfile.clear() ;
    }
  }
  return ! inconsistencies ;
}

```

The call to `ent->getLocalHeaderoffset()` returns the unchecked local header offset value. Because the local header offset is greater than the size of the file, the call to `vseekg()` on line 180 seeks to the end of the file, setting the eofbit error state flag for `_zipfile`. An overloaded `>>` operator is then called on line 181.

#### src/zipios/src/ziphead.cpp

```
std::istream& operator>> ( std::istream &is, ZipCDirEntry &zcdh ) {
  zcdh._valid = false ; // set to true upon successful completion.
  if ( ! is )
    return is ;

  if ( zcdh.signature != readUint32( is ) ) {
    // put stream in error state and return
    is.setstate ( std::ios::failbit ) ;
    return is ;
  }
```
#### src/zipios/zipios++/zipheadio.h

```
inline uint32 readUint32 ( istream &is ) {
  static const int buf_len = sizeof ( uint32 ) ;
  unsigned char buf [ buf_len ] ;
  int rsf = 0 ;
  while ( rsf < buf_len ) {
    is.read ( reinterpret_cast< char * >( buf ) + rsf, buf_len - rsf ) ;
    rsf += static_cast< int >( is.gcount () ) ;
  }
  return  ztohl ( buf ) ;
}

```

Because the previous call to `vgseek()` caused `is` to seek to the end of the file, the call to `is.read()` on line 83 of zipheadio.h fails. Since `is` is at the end of the file, there are no more bytes to read. The call to `is.gcount()` returns 0, and line 84 is, therefore, logically equivalent to `rsf = rsf + 0`. As neither `rsf` nor `is` ever changes, the while loop’s condition on line 82 will never be true, resulting in an infinite loop.

## Security Impact

Users of the Zipios library (v0.1.5.9 and earlier) are vulnerable to a denial of service (DoS) attack. As this DoS is caused by an infinite loop, exploitation of this vulnerability can also lead to [uncontrolled resource consumption](https://cwe.mitre.org/data/definitions/400.html).

The latest version of Zipios (v2.2.1.0) is not vulnerable. Other versions of Zipios have not been analyzed.

## Remediation

This issue is resolved in [v0.1.7](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/0.1.7/) of Zipios. It is recommended that Zipios users upgrade to [v0.1.7](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/0.1.7/) or [v2.2.0](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/2.2.0/) if possible.

As of July 15, 2019, Ubuntu users have access to a patched version of Zipios v0.1.5.9, as well as a patched version of FlightCrew.

Other Zipios and FlightCrew users can apply the following patch and rebuild: <https://sourceforge.net/p/zipios/code-git/ci/96e26640573410709bb863b8916a8216f4c6a546/tree/infinite_loop.patch>

## Disclosure Timeline

American fuzzy lop discovers that FlightCrew hangs when provided with certain malformed input due to a bug in the Zipios library.

Zipios upstream developers are notified via a secure channel. Upstream developers respond, stating that there is no support for v0.1.5.9 of the Zipios.

A patch is developed by Mike Salvatore and submitted to the upstream developers for review.

The [patch](https://sourceforge.net/p/zipios/code-git/ci/96e26640573410709bb863b8916a8216f4c6a546/tree/infinite_loop.patch) is modified by [Alexis Wilke](https://www.m2osw.com/) and accepted upstream.

[CVE-2019-13453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13453) is assigned to this vulnerability by MITRE.

## Further Reading

[Part 3](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-3-of-3/) of this series chronicles the next vulnerability that I discovered while analyzing FlightCrew.

**CVE:** <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13453>

**Zipios announcement:** <https://sourceforge.net/p/zipios/news/2019/07/version-017-cve-/>

**ZIP file structure:**

* <https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html>
* <https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT>
* [https://en.wikipedia.org/wiki/Zip\_(file\_format)](https://en.wikipedia.org/wiki/Zip_%28file_format%29)

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)



=== Content from salvatoresecurity.com_a70b5462_20250121_020600.html ===

[![](https://salvatoresecurity.com/wp-content/uploads/2022/02/2020_headshot_small.jpeg)](https://salvatoresecurity.com/)
## [Mike Salvatore's Blog](https://salvatoresecurity.com "Mike Salvatore's Blog")

### A blog about cybersecurity

* [Blog](https://salvatoresecurity.com)
  + [Development](https://salvatoresecurity.com/category/dev/)
  + [Editorials](https://salvatoresecurity.com/category/editorials/)
  + [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)
* [About Me](https://salvatoresecurity.com/about/)

# Fun with Fuzzers: How I Discovered Three Vulnerabilities (Part 2 of 3)

July 12, 2019

This is the second in a three-part series that chronicles how I discovered three vulnerabilities over the course of a day. If you haven’t already, you can go back and read the [first installment](https://salvatoresecurity.com/fun-with-fuzzers-or-how-i-discovered-three-vulnerabilities-part-1-of-3/).

## Introduction

I was surprised when [american fuzzy lop (AFL)](http://lcamtuf.coredump.cx/afl/) quickly found the [first vulnerability](https://salvatoresecurity.com/fun-with-fuzzers-or-how-i-discovered-three-vulnerabilities-part-1-of-3/) in [FlightCrew](https://github.com/Sigil-Ebook/flightcrew), so you can imagine my elation when it turned up the second in under two hours. This time, instead of a crash, AFL found that FlightCrew hung when it was provided with certain input. I fired up gdbtui and began to investigate.

![](https://i0.wp.com/salvatoresecurity.com/wp-content/uploads/2019/06/flightcrew-afl-with-hangs.png?resize=644%2C556&ssl=1)

AFL status

## Vulnerability Analysis

Upon examining the backtrace, it quickly became apparent that the issue was not in FlightCrew itself, but within [Zipios](http://zipios.sourceforge.net/), a third-party library for handling ZIP files. FlightCrew includes a copy of the complete source code from Zipios v0.1.5.9.

In order to understand the root cause of this bug, a brief explanation of the ZIP archive structure is in order. ZIP archives consist of local file headers, file data, and the central directory. Additional metadata is also present but is not pertinent to this discussion.

![](https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/ZIP-64_Internal_Layout.svg/800px-ZIP-64_Internal_Layout.svg.png)

[ZIP File Format](https://en.wikipedia.org/wiki/Zip_%28file_format%29)

For each file within the ZIP archive, the central directory contains a “central directory header.” The last field of a central directory header is an “offset” that points to the position of the file’s “local header.” Together, the central directory and local file headers contain the information necessary to extract file data from the ZIP archive.

![](https://i0.wp.com/users.cs.jmu.edu/buchhofp/forensics/formats/pkzip-images/central-file-header.png?w=700&ssl=1)

[Central Directory Header](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

In the fuzzed ZIP file, the “Offset of local header” field has been changed so that its value is larger than the size of the archive. We can see by examining the code that this leads to an infinite loop.

The central directory is read by the function `ZipFile::readCentralDirectory()`, which reads each central directory header. It then calls `ZipFile::confirmLocalHeaders()`.

#### src/zipios/src/zipfile.cpp

```
bool ZipFile::confirmLocalHeaders( istream &_zipfile ) {
  Entries::const_iterator it ;
  ZipCDirEntry *ent ;
  int inconsistencies = 0 ;
  ZipLocalEntry zlh ;
  for ( it = _entries.begin() ; it != _entries.end() ; it++ ) {
    ent = static_cast< ZipCDirEntry * >( (*it).get()  ) ;
    _vs.vseekg( _zipfile, ent->getLocalHeaderOffset(), ios::beg ) ;
    _zipfile >> zlh ;
    if ( ! _zipfile || zlh != *ent ) {
      inconsistencies++ ;
      _zipfile.clear() ;
    }
  }
  return ! inconsistencies ;
}

```

The call to `ent->getLocalHeaderoffset()` returns the unchecked local header offset value. Because the local header offset is greater than the size of the file, the call to `vseekg()` on line 180 seeks to the end of the file, setting the eofbit error state flag for `_zipfile`. An overloaded `>>` operator is then called on line 181.

#### src/zipios/src/ziphead.cpp

```
std::istream& operator>> ( std::istream &is, ZipCDirEntry &zcdh ) {
  zcdh._valid = false ; // set to true upon successful completion.
  if ( ! is )
    return is ;

  if ( zcdh.signature != readUint32( is ) ) {
    // put stream in error state and return
    is.setstate ( std::ios::failbit ) ;
    return is ;
  }
```
#### src/zipios/zipios++/zipheadio.h

```
inline uint32 readUint32 ( istream &is ) {
  static const int buf_len = sizeof ( uint32 ) ;
  unsigned char buf [ buf_len ] ;
  int rsf = 0 ;
  while ( rsf < buf_len ) {
    is.read ( reinterpret_cast< char * >( buf ) + rsf, buf_len - rsf ) ;
    rsf += static_cast< int >( is.gcount () ) ;
  }
  return  ztohl ( buf ) ;
}

```

Because the previous call to `vgseek()` caused `is` to seek to the end of the file, the call to `is.read()` on line 83 of zipheadio.h fails. Since `is` is at the end of the file, there are no more bytes to read. The call to `is.gcount()` returns 0, and line 84 is, therefore, logically equivalent to `rsf = rsf + 0`. As neither `rsf` nor `is` ever changes, the while loop’s condition on line 82 will never be true, resulting in an infinite loop.

## Security Impact

Users of the Zipios library (v0.1.5.9 and earlier) are vulnerable to a denial of service (DoS) attack. As this DoS is caused by an infinite loop, exploitation of this vulnerability can also lead to [uncontrolled resource consumption](https://cwe.mitre.org/data/definitions/400.html).

The latest version of Zipios (v2.2.1.0) is not vulnerable. Other versions of Zipios have not been analyzed.

## Remediation

This issue is resolved in [v0.1.7](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/0.1.7/) of Zipios. It is recommended that Zipios users upgrade to [v0.1.7](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/0.1.7/) or [v2.2.0](https://sourceforge.net/projects/zipios/files/zipios%2B%2B/2.2.0/) if possible.

As of July 15, 2019, Ubuntu users have access to a patched version of Zipios v0.1.5.9, as well as a patched version of FlightCrew.

Other Zipios and FlightCrew users can apply the following patch and rebuild: <https://sourceforge.net/p/zipios/code-git/ci/96e26640573410709bb863b8916a8216f4c6a546/tree/infinite_loop.patch>

## Disclosure Timeline

American fuzzy lop discovers that FlightCrew hangs when provided with certain malformed input due to a bug in the Zipios library.

Zipios upstream developers are notified via a secure channel. Upstream developers respond, stating that there is no support for v0.1.5.9 of the Zipios.

A patch is developed by Mike Salvatore and submitted to the upstream developers for review.

The [patch](https://sourceforge.net/p/zipios/code-git/ci/96e26640573410709bb863b8916a8216f4c6a546/tree/infinite_loop.patch) is modified by [Alexis Wilke](https://www.m2osw.com/) and accepted upstream.

[CVE-2019-13453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13453) is assigned to this vulnerability by MITRE.

## Further Reading

[Part 3](https://salvatoresecurity.com/fun-with-fuzzers-how-i-discovered-three-vulnerabilities-part-3-of-3/) of this series chronicles the next vulnerability that I discovered while analyzing FlightCrew.

**CVE:** <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13453>

**Zipios announcement:** <https://sourceforge.net/p/zipios/news/2019/07/version-017-cve-/>

**ZIP file structure:**

* <https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html>
* <https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT>
* [https://en.wikipedia.org/wiki/Zip\_(file\_format)](https://en.wikipedia.org/wiki/Zip_%28file_format%29)

Posted in: [Vulnerability Research](https://salvatoresecurity.com/category/vuln-research/)


