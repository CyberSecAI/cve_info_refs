=== Content from www.twistlock.com_c7571b92_20250121_010218.html ===

AI-SPM is generally available to all Prisma® Cloud users as we continue the rollout of Secure AI by Design product portfolio.
[Let's go!](/prisma/cloud/ai-spm)![x close icon to close mobile navigation]()[![prisma logo]()](/)![magnifying glass search icon to open search field]()

* [Why Prisma Cloud](/prisma/whyprisma)
* Products
* Solutions
* Environments
* [Product Tour](/prisma/cloud/explore-prisma-cloud)
* Resources

* [Request a Trial](/prisma/request-a-prisma-cloud-trial)
![Palo Alto Networks logo icon](/etc/clientlibs/clean/imgs/logo-default.svg)![white arrow icon pointing left to return to main Palo Alto Networks site](/etc/clientlibs/clean/imgs/arrow-right-white.svg)Search
All

* [Tech Docs](https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25)
Close search modal
Your browser does not support HTML5 video.
# See the Future of Real-Time Cloud Security

###### THE ULTIMATE CYBERSECURITY TRANSFORMATION EVENT

###### | 1-HOUR VIRTUAL SUMMIT | FEB 19-20

* [Count me in](https://start.paloaltonetworks.com/symphony2025)
Your browser does not support HTML5 video.
CODE TO CLOUDTM SECURITY
# The future of cloud security is Precision AI™.

Rollout of our new Secure AI by Design product portfolio has begun!

* [Learn more](/prisma/cloud/ai-spm)

* [AI-SPM is now generally available](https://www.paloaltonetworks.com/blog/prisma-cloud/ai-spm/)
## RECOMMENDED

[![GigaOm report](/content/dam/pan/en_US/images/prisma/thumbnail-gigaom-report-supply-chain-security.png)
### Leader in Software Supply Chain Security

Read the report](https://start.paloaltonetworks.com/gigaom-radar-for-software-supply-chain-security-report.html)[![O’REILLY E-BOOK](/content/dam/pan/en_US/images/prisma/pc-ebook-cnapp-oreilly-hp-tile_180x180.jpg)
### Securing cloud-native applications: A comprehensive guide to CNAPPs

Get your guide](https://start.paloaltonetworks.com/oreilly-cnapp-cloud-security-foundations.html)[![GigaOm](/content/dam/pan/en_US/images/prisma/cloud/PC-GigaOn-CNAPP-24-hp-thumbnail-180x180.png)
### Cloud Security Leader in First-Ever CNAPP Report

Read the report](https://start.paloaltonetworks.com/gigaom-cnapp-report.html)[![Learn expert strategies in safeguarding your AI-powered apps.](/content/dam/pan/en_US/images/prisma/cloud/pc-od-webinar-nov-understanding-the-ai-ecosystem_hp-tile_180x180.jpg)
### Understanding the AI Ecosystem: How to Secure AI-Powered Applications

Watch now](https://start.paloaltonetworks.com/securing-ai-applications-webinar.html)[![DSPM and DDR]()
### Securing the Data and AI Landscape with DSPM and DDR

Watch now](https://start.paloaltonetworks.com/securing-the-data-and-ai-landscape-with-dspm-and-ddrs-on-demand-webinar.html)[![Defending Your AI Future eBook]()
### Defending Your AI Future with Prisma Cloud

Read the eBook](https://start.paloaltonetworks.com/defending-your-ai-future-with-prisma-cloud.html)[![Cloud Copilot logo]()
### Meet the Prisma Cloud Copilot

Watch now](https://www.youtube.com/watch?v=r22ofg9R3j8)[![cloud security logo]()
### Measure the True Value of Cloud Security.

Get custom report](https://tei.forrester.com/go/paloalto/prismacloud/index.html?lang=en-us)Today’s ChallengesProduct PortfolioProven SuccessIndustry ValidationResourcesEngage with Us[Today’s Challenges](#challenges)[Product Portfolio](#portfolio)[Proven Success](#success)[Industry Validation](#industry)[Resources](#resources)[Engage with Us](#nextSteps)
Your browser does not support the video tag.
## AI is moving faster than teams can scale.

## Making your cloud complex and vulnerable.

## Secure it all with

Prisma Cloud

The Code to Cloud platform that
 secures apps from design to runtime.

![cortex default]()![cortex]()![xsoar]()![]()![xdr]()CODE TO CLOUD PLATFORM
## Secure every stage of the application lifecycle.

Prioritize and eliminate risks across code/build, infrastructure and
runtime.

CODE
## Ship secure code by design.

Developer-friendly code security fixes risks before they
reach runtime.

[IaC Security](/prisma/cloud/infrastructure-as-code-security)[CI/CD Security](/content/pan/en_US/prisma/cloud/ci-cd-security.html)[Secrets Security](/prisma/cloud/secrets-security)[Software Composition Analysis (SCA)](/prisma/cloud/software-composition-analysis) INFRASTRUCTURE
## Protect the application infrastructure.

Protect the entire stack and harden the cloud estate.

[Cloud Security Posture Management](/prisma/cloud/cloud-security-posture-management)[API
Visibility](/prisma/cloud/api-security)[Cloud Infrastructure Entitlement Management](/prisma/cloud/cloud-infrastructure-entitlement-mgmt)[Agentless Workload Scanning](/prisma/cloud/vulnerability-management)Runtime
## Block advanced attacks in real time.

Stop active attacks with in-line protection and

defense-in-depth.

[Threat Detection](/prisma/cloud/cloud-threat-detection)[Serverless Security](/prisma/cloud/serverless-security)[Host Security](/prisma/cloud/host-security)[Web Application and API Security](/prisma/cloud/web-application-API-security)dive deeper
## Take an up-close look at the Code to Cloud Platform powered by Precision AI.

PRISMA CLOUD
## Eliminate risk across the application lifecycle.

Prioritize and fix security flaws in code during software development, detect and block untrusted images before deployment and protect cloud apps from zero-day threats at runtime.

[![Eliminate risk across the application lifecycle]()](/content/dam/pan/en_US/images/cnapp-24/cloud_platform_dashboard.png)

![See more]()
### See more

Prisma® Cloud analyzes 1T events every 24 hours to deliver unparalleled visibility and keep security teams steps ahead of attacks.

![Stop more]()
### Stop more

Prisma Cloud utilizes Precision AI to detect 1.5M new attacks every day.

![Respond faster]()
### Respond faster

Prisma Cloud helps you immediately take the right actions with guided investigations and response.

[![Secure your AI-powered applications.]()](/content/dam/pan/en_US/images/cnapp-24/ai-spm_secure_ai_powered_applications.png)
AI SPM
## Secure your AI-powered applications.

Gain visibility and control of the data you use for training, the integrity of your AI models and the access to your deployed models. Identify and prioritize model risk, secure data across model resources and protect the AI application ecosystem.

[Learn more](/prisma/cloud/ai-spm)
AI-powered risk insights
## Rapidly prioritize risk with AI.

For every threat, quickly understanding what’s reachable and how best to fix it is paramount. Prisma Cloud employs AI-powered risk prioritization to analyze the blast radius from at-risk assets, enabling your teams to uncover complex risks with ease.

[![Rapidly prioritize risk with AI.]()](/content/dam/pan/en_US/images/cnapp-24/ai_powered_risk_insights_full.png)

Prisma Cloud COPILOT
## Don’t just ask. Act.

Eliminate the need for specialized expertise. Simply have a conversation and get the answers you need, fast. Prisma Cloud Copilot analyzes vast amounts of data from code to cloud to help you fix faster and prevent breaches — all with a single click.

[Meet the Prisma Cloud Copilot](https://bcove.video/3yirjPK) ![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)
## See how customers are putting our trusted, AI-powered platform to work.

 [See all customer stories](/prisma/cloud/customer-stories)
### 01Global Atlantic Financial group

![Global Atlantic Financial group]()play video

This leading U.S. financial group used Prisma Cloud to consolidate visibility in their diverse multicloud environment.

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)

“Prisma Cloud empowers our organization to seamlessly scale with an array of cloud-native capabilities to maintain a formidable cybersecurity posture.”

Chris Bogaards, AVP, IT Information Security

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)
### 02Fortune 500

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

* 35%

  faster time to patch vulnerabilities
* 90%

  reduction in management overhead
* 0

  cloud breaches in runtime

[Read the full story](/customers/securing-the-online-retailer-of-the-future-with-prisma-cloud-compute) ![Fortune 500]()
### 03Pexa Icon

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

* 89%

  market reach
* 40

  upstream providers
* 4x

  increase in footprint since day one

[Read the full story](/customers/pexa-relies-on-prisma-cloud-for-timely-threat-detection-and-mitigation) ![Pexa Icon]()
## Industry recognized. Constantly innovating.

### 9x Cloud Security Leaderopen

#### GigaOm Logo GigaOm Radar for CNAPPs

#### Forrester Logo Forrester Wave: Cloud Workload Security

#### Frost & Sullivan Logo Frost & Sullivan CNAPP Radar

#### GigaOm Logo GigaOm Radar for Policy as Code

#### GigaOm Logo GigaOm Radar for Cloud Infrastructure Entitlement Management

#### GigaOm Logo GigaOm Radar for CSPM

#### GigaOm Logo GigaOm Radar for Container Security

#### GigaOm Logo GigaOm Radar for Data Security Posture Management

#### GigaOm Logo GigaOm Radar for Software Supply Chain Security

## Secure your network with trusted resources.

[View all](/resources)[ANALYST REPORT
### Forrester Total Economic Impact™ Study Of Prisma Cloud

![Forrester Total Economic Impact™ Study Of Prisma Cloud]()](/prisma/forrester-tei-study-prisma-cloud)[GUIDE
### Securing the Data Landscape with DSPM and DDR

![Securing the Data Landscape with DSPM and DDR]()](/resources/guides/dspm-ddr-big-guide)[WEBINAR
### Protecting Data and AI in 2024: What CISOs Need to Know

![Protecting Data and AI in 2024]()](https://start.paloaltonetworks.com/PrismaCloud-DSPM-on-demand-Webinar-Protecting-Data-and-AI-in-2024-What-CISOs-Need-to-Know.html)[RESEARCH REPORT
### The State of Cloud-Native Security Report

![The State of Cloud-Native Security Report]()](/state-of-cloud-native-security)PrevNext
## Ready to meet youwhere you are.

Executives
Specialists
Partners
Customers
![Ignite on tour logo]()
### Ignite on Tour

Meet decision makers, experts and practitioners for a day of hands-on learning, strategy building and networking.

[Attend our global roadshow](https://register.paloaltonetworks.com/igniteontour)![man coding]()
### Under Attack? We’re Here.

Unit 42® Incident Response explains the breach, works with you to contain and remedy it, and gets you back to business.

[Our experts are standing by](https://start.paloaltonetworks.com/contact-unit42.html)![Executives in board room]()
### Executive Briefing Center

Get a customized plan to see how our platforms, threat intelligence and expert services help you secure the way forward.

[Plan a collaborative discussion](/about-us/executive-briefing-program)![woman on laptop]()
### Product Demo Center

Visit the demo center to see solution experts walk you through our comprehensive cybersecurity portfolio in action.

[Take our products for a spin](/demos)![specialist]()
### Events Around the World

Browse all scheduled SecOps global events by cybersecurity technology interest, industry, region, use case and more.

[Join us in-person or online](https://events.paloaltonetworks.com/#security-automation-events)![get started]()
#### Future-proof your Security

Meet the trusted, proven and awarded products that make a positive difference in your security and business outcomes.

[Get to know our products](/get-started)![typing on laptop]()
### Partner Portal

Don’t try to tackle security challenges alone. Tap into the world’s most interoperable cloud and AI security platform.

[Log into our partner interface](/partners/nextwave-partner-portal-login)![man thinking]()
### Become a Partner

Be part of a global community of world-class innovators committed to making security breaches a thing of the past.

[Apply to our partner community](https://paloaltonetworks.my.site.com/NextWavePartnerProgram/s/partnerregistration?type=becomepartner)![technicians collaborating]()
### Managed Services Program

Provide managed security services that reduce cost, increase average revenue per customer and maximize market reach.

[Experience specialized tech](/partners/managed-security-services-provider-program)![Customer login]()
### Customer Login

Security, performance and ease of use: Three qualities our customers like most about our cybersecurity products.

[Sign in or create an account](https://support.paloaltonetworks.com/SupportAccount/MyAccount)![Education and training]()
### Education and Training

Expand your wisdom and skills with world-class training, certification and accreditation, including digital learning.

[Learn from security experts](/services/education)![Customer success tools]()
### Customer Success Tools

Guidance, oversight and 24/7 support from cybersecurity experts to help expedite your setup and initial configuration.

[Make the most of our resources](/services/customer-success)
## Get the latest news, invites to events, and threat alerts

Enter your email now to subscribe!Sign up

By submitting this form, you agree to our
[Terms of Use](/legal-notices/terms-of-use)
and acknowledge our
[Privacy Statement](/legal-notices/privacy).

Sign up
## Products and Services

* [Network Security Platform](/network-security)
* [CLOUD DELIVERED SECURITY SERVICES](/network-security/security-subscriptions)
* [Advanced Threat Prevention](/network-security/advanced-threat-prevention)
* [Advanced WildFire](/network-security/advanced-wildfire)
* [DNS Security](/network-security/advanced-dns-security)
* [Data Loss Prevention](/network-security/enterprise-data-loss-prevention)
* [IoT Security](/network-security/enterprise-iot-security)
* [Next-Generation Firewalls](/network-security/next-generation-firewall)
* [Hardware Firewalls](/network-security/next-generation-firewall-hardware)
* [Strata Cloud Manager](/network-security/strata-cloud-manager)
* [SECURE ACCESS SERVICE EDGE](/sase)
* [Prisma Access](/sase/access)
* [Prisma SD-WAN](/sase/sd-wan)
* [Autonomous Digital Experience Management](/sase/adem)
* [Cloud Access Security Broker](/sase/next-gen-casb)
* [Zero Trust Network Access](/sase/ztna)

* [Code to Cloud Platform](/prisma/whyprisma)
* [Prisma Cloud](/prisma/cloud)

* [AI-Driven Security Operations Platform](/cortex)
* [Cortex XDR](/cortex/cortex-xdr)
* [Cortex XSOAR](/cortex/cortex-xsoar)
* [Cortex Xpanse](/cortex/cortex-xpanse)
* [Cortex XSIAM](/cortex/cortex-xsiam)
* [External Attack Surface Protection](/cortex/cortex-xpanse/attack-surface-management)
* [Security Automation](/cortex/security-operations-automation)
* [Threat Prevention, Detection & Response](/cortex/detection-and-response)

* [Threat Intel and Incident Response Services](/unit42)
* [Proactive Assessments](/unit42/assess)
* [Incident Response](/unit42/respond)
* [Transform Your Security Strategy](/unit42/transform)
* [Discover Threat Intelligence](/unit42/threat-intelligence-partners)
## Company

* [About Us](/about-us)
* [Careers](https://jobs.paloaltonetworks.com/en/)
* [Contact Us](/company/contact-sales)
* [Corporate Responsiblity](/about-us/corporate-responsibility)
* [Customers](/customers)
* [Investor Relations](https://investors.paloaltonetworks.com/)
* [Location](/about-us/locations)
* [Newsroom](/company/newsroom)
## Popular Links

* [Blog](/blog/)
* [Communities](/communities)
* [Content Library](/resources)
* [Cyberpedia](/cyberpedia)
* [Event Center](https://events.paloaltonetworks.com/)
* [Manage Email Preferences](https://start.paloaltonetworks.com/preference-center)
* [Products A-Z](/products/products-a-z)
* [Product Certifications](/legal-notices/trust-center/compliance)
* [Report a Vulnerability](/security-disclosure)
* [Sitemap](/sitemap)
* [Tech Docs](https://docs.paloaltonetworks.com/)
* [Unit 42](https://unit42.paloaltonetworks.com/)
* [Do Not Sell or Share My Personal Information](https://panwedd.exterro.net/portal/dsar.htm?target=panwedd)
![PAN logo]()

* [Privacy](/legal-notices/privacy)
* [Trust Center](/legal-notices/trust-center)
* [Terms of Use](/legal-notices/terms-of-use)
* [Documents](/legal)

Copyright © 2025 Palo Alto Networks. All Rights Reserved

* [![Youtube]()](https://www.youtube.com/user/paloaltonetworks)
* [![Twitter]()](https://twitter.com/PaloAltoNtwks)
* [![Facebook]()](https://www.facebook.com/PaloAltoNetworks/)
* [![LinkedIn]()](https://www.linkedin.com/company/palo-alto-networks)
* [![Podcast]()](https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/)
* ENSelect your language


=== Content from github.com_95b959a4_20250121_010218.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnats-io%2Fnats-server%2Fpull%2F1053)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnats-io%2Fnats-server%2Fpull%2F1053)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=nats-io%2Fnats-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nats-io](/nats-io)
/
**[nats-server](/nats-io/nats-server)**
Public

* [Notifications](/login?return_to=%2Fnats-io%2Fnats-server) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fnats-io%2Fnats-server)
* [Star
   16.3k](/login?return_to=%2Fnats-io%2Fnats-server)

* [Code](/nats-io/nats-server)
* [Issues
  364](/nats-io/nats-server/issues)
* [Pull requests
  50](/nats-io/nats-server/pulls)
* [Discussions](/nats-io/nats-server/discussions)
* [Actions](/nats-io/nats-server/actions)
* [Projects
  0](/nats-io/nats-server/projects)
* [Security](/nats-io/nats-server/security)
* [Insights](/nats-io/nats-server/pulse)

Additional navigation options

* [Code](/nats-io/nats-server)
* [Issues](/nats-io/nats-server/issues)
* [Pull requests](/nats-io/nats-server/pulls)
* [Discussions](/nats-io/nats-server/discussions)
* [Actions](/nats-io/nats-server/actions)
* [Projects](/nats-io/nats-server/projects)
* [Security](/nats-io/nats-server/security)
* [Insights](/nats-io/nats-server/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnats-io%2Fnats-server%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnats-io%2Fnats-server%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [FIXED] Check of maxpayload could be bypassed if size overruns int32 #1053

 Merged

[kozlovic](/kozlovic)
merged 1 commit into
[master](/nats-io/nats-server/tree/master "nats-io/nats-server:master")
from
[mpay\_overrun](/nats-io/nats-server/tree/mpay_overrun "nats-io/nats-server:mpay_overrun")

Jul 1, 2019

 Merged

# [[FIXED] Check of maxpayload could be bypassed if size overruns int32](#top) #1053

[kozlovic](/kozlovic)
merged 1 commit into
[master](/nats-io/nats-server/tree/master "nats-io/nats-server:master")
from
[mpay\_overrun](/nats-io/nats-server/tree/mpay_overrun "nats-io/nats-server:mpay_overrun")

Jul 1, 2019

[Conversation
6](/nats-io/nats-server/pull/1053)
[Commits
1](/nats-io/nats-server/pull/1053/commits)
[Checks
0](/nats-io/nats-server/pull/1053/checks)
[Files changed](/nats-io/nats-server/pull/1053/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kozlovic](https://avatars.githubusercontent.com/u/13736691?s=60&v=4)](/kozlovic)

Copy link

Member

### @kozlovic **[kozlovic](/kozlovic)** commented [Jul 1, 2019](#issue-462903477) • edited Loading

One could craft a PUB protocol to cause server to panic. This can

happen if the size in the PUB protocol overruns an int32.

(note that if authorization is enabled, the user would need to

authenticate first, limiting the impact).

Thank you to Aviv Sasson and Ariel Zelivansky from Twistlock

for the security report!

Signed-off-by: Ivan Kozlovic ivan@synadia.com

Sorry, something went wrong.

All reactions

 [![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)
[kozlovic](/kozlovic)
requested a review
from [derekcollison](/derekcollison)
[July 1, 2019 20:45](#event-2452397231)

[![derekcollison](https://avatars.githubusercontent.com/u/90097?s=60&v=4)](/derekcollison)

**[derekcollison](/derekcollison)**
reviewed
[Jul 1, 2019](#pullrequestreview-256554571)

 [View reviewed changes](/nats-io/nats-server/pull/1053/files)

Copy link

Member

### @derekcollison **[derekcollison](/derekcollison)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Checking on int32 -> int64 cast removing negative bit.

Also should credit TL for report.

Sorry, something went wrong.

All reactions

[server/client.go](/nats-io/nats-server/pull/1053/files#diff-9d8f319f7ce4c3c7f8faba5806e81f577540e3612406164bb27d2bb53431bee9)

Show resolved

Hide resolved

[![derekcollison](https://avatars.githubusercontent.com/u/90097?s=60&v=4)](/derekcollison)

**[derekcollison](/derekcollison)**
requested changes
[Jul 1, 2019](#pullrequestreview-256559883)

 [View reviewed changes](/nats-io/nats-server/pull/1053/files)

Copy link

Member

### @derekcollison **[derekcollison](/derekcollison)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&v=4)](/kozlovic)

`[[FIXED] Check of maxpayload could be bypassed if size overruns int32](/nats-io/nats-server/pull/1053/commits/156511bba720279595c7585971d58259d5f94012 "[FIXED] Check of maxpayload could be bypassed if size overruns int32

One could craft a PUB protocol to cause server to panic. This can
happen if the size in the PUB protocol overruns an int32.

(note that if authorization is enabled, the user would need to
authenticate first, limiting the impact).

Thank you to Aviv Sasson and Ariel Zelivansky from Twistlock
for the security report!

Signed-off-by: Ivan Kozlovic <ivan@synadia.com>")`
 …

`[156511b](/nats-io/nats-server/pull/1053/commits/156511bba720279595c7585971d58259d5f94012)`

```
One could craft a PUB protocol to cause server to panic. This can
happen if the size in the PUB protocol overruns an int32.

(note that if authorization is enabled, the user would need to
authenticate first, limiting the impact).

Thank you to Aviv Sasson and Ariel Zelivansky from Twistlock
for the security report!

Signed-off-by: Ivan Kozlovic <ivan@synadia.com>
```

 [![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)
[kozlovic](/kozlovic)
[force-pushed](/nats-io/nats-server/compare/eccd3d0868ba7cc2cc2179067404bb249f5a0a71..156511bba720279595c7585971d58259d5f94012)
the
mpay\_overrun

branch
from
[`eccd3d0`](/nats-io/nats-server/commit/eccd3d0868ba7cc2cc2179067404bb249f5a0a71) to
[`156511b`](/nats-io/nats-server/commit/156511bba720279595c7585971d58259d5f94012)  [Compare](/nats-io/nats-server/compare/eccd3d0868ba7cc2cc2179067404bb249f5a0a71..156511bba720279595c7585971d58259d5f94012)
[July 1, 2019 21:07](#event-2452448063)

[![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=80&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)

Copy link

Member

Author

### **[kozlovic](/kozlovic)** commented [Jul 1, 2019](#issuecomment-507426714)

| Added to commit log reference to people from Twistlock that reported the security issue. |
| --- |

All reactions

Sorry, something went wrong.

[![derekcollison](https://avatars.githubusercontent.com/u/90097?s=60&v=4)](/derekcollison)

**[derekcollison](/derekcollison)**
approved these changes
[Jul 1, 2019](#pullrequestreview-256564659)

 [View reviewed changes](/nats-io/nats-server/pull/1053/files/156511bba720279595c7585971d58259d5f94012)

[![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)
[kozlovic](/kozlovic)
merged commit [`a171864`](/nats-io/nats-server/commit/a171864ae7dfe122da40eb5fadd9838a4425a011)
into
master

[Jul 1, 2019](https://github.com/nats-io/nats-server/pull/1053#event-2452495874)

 [![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)
[kozlovic](/kozlovic)
deleted the
mpay\_overrun

branch
[July 1, 2019 21:27](#event-2452496041)

[![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=40&u=c7b2ef3ae21f8bccf663bd6eb15220a2377da071&v=4)](/kozlovic)
[kozlovic](/kozlovic)
mentioned this pull request
[Jun 1, 2020](#ref-pullrequest-628781930)

[Avoid parsing large sizes for messages
#1441](/nats-io/nats-server/pull/1441)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnats-io%2Fnats-server%2Fpull%2F1053)

Reviewers

[![@derekcollison](https://avatars.githubusercontent.com/u/90097?s=40&v=4)](/derekcollison) [derekcollison](/derekcollison)

derekcollison approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@kozlovic](https://avatars.githubusercontent.com/u/13736691?s=52&v=4)](/kozlovic) [![@derekcollison](https://avatars.githubusercontent.com/u/90097?s=52&v=4)](/derekcollison)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


