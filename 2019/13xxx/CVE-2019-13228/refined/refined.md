```json
{
  "cveMetadata": {
    "cveId": "CVE-2019-13228",
    "description": "PLACEHOLDER - Implement CVE description retrieval",
    "date": "2024-01-20T23:32:38.325Z"
  },
  "matches": [
    {
      "match": true,
      "sourceContent": "CVE-2019-13228) similarly in `BootDoctor::fix()` the fixed path\n  `/tmp/repo.iso` is created and the fixed directory /tmp/.deepin-clone\n  is used. The same concerns as in 1) and 3) apply. By winning a race\n  condition to replace the `/tmp/repo.iso` symlink by an attacker\n  controlled iso file further privilege escalation may be possible.",
      "vulnerabilityDetails": {
        "rootCause": "The application `deepin-clone` uses a fixed path `/tmp/repo.iso` in the `BootDoctor::fix()` function to download an ISO file.",
        "vulnerability": "Symlink Attack",
        "impact": "An unprivileged user can prepare a symlink attack to create or overwrite files. By winning a race condition to replace the `/tmp/repo.iso` symlink by an attacker controlled ISO file, further privilege escalation may be possible.",
        "attackVector": "Local Access",
        "attackerCapabilities": "An unprivileged local user can create a symlink at `/tmp/repo.iso` pointing to an arbitrary file and then trigger the vulnerable code path.",
        "affectedFunction": "BootDoctor::fix()"
      }
    },
    {
      "match": true,
      "sourceContent": "deepin-clone before 1.1.3 uses a fixed path /tmp/repo.iso in the BootDoctor::fix() function to download an ISO file, and follows symlinks there. An unprivileged user can prepare a symlink attack there to create or overwrite files. The content is not attacker controlled. By winning a race condition to replace the /tmp/repo.iso symlink by an attacker controlled ISO file, further privilege escalation may be possible.\n\nExternal References:\n\n<https://bugzilla.suse.com/show_bug.cgi?id=1130388>",
      "vulnerabilityDetails": {
        "rootCause": "The application `deepin-clone` uses a fixed path `/tmp/repo.iso` in the `BootDoctor::fix()` function to download an ISO file and follows symlinks there.",
        "vulnerability": "Symlink Attack",
        "impact": "An unprivileged user can prepare a symlink attack there to create or overwrite files. By winning a race condition to replace the `/tmp/repo.iso` symlink by an attacker controlled ISO file, further privilege escalation may be possible.",
        "attackVector": "Local Access",
        "attackerCapabilities": "An unprivileged local user can create a symlink at `/tmp/repo.iso` pointing to an arbitrary file and then trigger the vulnerable code path.",
        "affectedFunction": "BootDoctor::fix()"
      }
    },
    {
      "match": true,
      "sourceContent": "  This has been moved to /var/cache/deepin-clone. /var/cache is usually only writable by root. Should handle this attack vector.",
      "vulnerabilityDetails": {
        "mitigation": "The vulnerability was mitigated by moving the affected file to `/var/cache/deepin-clone`, which is generally only writable by root."
      }
    },
    {
      "match": true,
      "sourceContent": " bool BootDoctor::fix(const QString &partDevice)\n {\n }\n {\n  const QStringList &tmp_paths = QStandardPaths::standardLocations(QStandardPaths::TempLocation);\n  const QString tmp_dir = (tmp_paths.isEmpty() ? \"/tmp\" : tmp_paths.first()) + \"/.deepin-clone\";\n  const QString tmp_dir = \"/var/cache/deepin-clone\";",
      "vulnerabilityDetails": {
        "patch": "The patch changes the temporary directory from `/tmp/.deepin-clone` to `/var/cache/deepin-clone`."
      }
    }
  ]
}
```