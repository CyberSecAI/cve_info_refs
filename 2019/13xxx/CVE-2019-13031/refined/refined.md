## CVE-2019-13031

Based on the provided information, the content is related to CVE-2019-13031.

### Root cause of the vulnerability:
The Perl module `XML::LibXML` is initialized without options that would prevent the use of external entities. This occurs in `lemonldap-ng-common/lib/Lemonldap/NG/Common/Notifications/XML.pm` and `lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Lib/Notifications/XML.pm`.

### Weakness/vulnerability:
XML External Entity (XXE) injection.

### Impact of exploitation:
A remote, unauthenticated attacker can exploit this vulnerability to:
*   Exfiltrate server files.
*   Potentially perform denial of service, server-side request forgery, or port scanning (as mentioned in the Debian security advisory).

### Attack vector:
The attacker crafts a malicious XML payload that includes an external entity definition. This payload is sent to the LemonLDAP::NG server, which parses the XML and attempts to resolve the external entity. This can be done via the Notification server either in JSON or XML formats

### Required attacker capabilities/position:
The attacker needs to be able to send XML data to the LemonLDAP::NG server's notification endpoint. The attacker does not need to be authenticated.

### Limitations:
* If the extracted file contains “\n” characters: the parser will fail with “invalid URI” error and the exploit did not work.
* If the file is too long: the parser will fail with “Entity reference loop” error and the exploit did not work.
* A firewall restricting outbound traffic can block external DTD retrieval.

### Remediation:
A fix prohibiting external entities has been deployed in v2.0.5 and v1.9.20.