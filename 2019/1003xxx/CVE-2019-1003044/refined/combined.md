=== Content from www.openwall.com_ca00b2d3_20250120_232342.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2019/04/02/1) [[<thread-prev]](../../../2019/03/25/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <65BCED7D-3903-40C3-97C7-27E0BF1E7A48@beckweb.net>
Date: Thu, 28 Mar 2019 19:53:45 +0100
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Re: Multiple vulnerabilities in Jenkins plugins

> On 25. Mar 2019, at 16:09, Daniel Beck <ml@...kweb.net> wrote:
>
> SECURITY-1353
> Sandbox projection in the Script Security and Pipeline: Groovy Plugins
> could be circumvented through methods supporting type casts and type
> coercion. This allowed attackers to invoke constructors for arbitrary types.

CVE-2019-1003040 (Script Security) and CVE-2019-1003041 (Pipeline: Groovy)

> SECURITY-1361
> Lockable Resources Plugin did not properly escape resource names in
> generated JavaScript code, thus leading to a cross-site scripting (XSS)
> vulnerability.

CVE-2019-1003042

> SECURITY-976
> [Slack Notification Plugin] did not perform permission checks on a method
> implementing form validation. This allowed users with Overall/Read access
> to Jenkins to connect to an attacker-specified URL using attacker-specified
> credentials IDs obtained through another method, capturing credentials
> stored in Jenkins.

CVE-2019-1003043

> Additionally, this form validation method did not require POST requests,
> resulting in a cross-site request forgery vulnerability.

CVE-2019-1003044

> SECURITY-846
> ECS Publisher Plugin stored the API token unencrypted in jobs' config.xml
> files and its global configuration file on the Jenkins master. This token
> could be viewed by users with Extended Read permission, or access to the
> master file system.

CVE-2019-1003045

> SECURITY-992
> A missing permission check in multiple form validation methods in Fortify
> on Demand Uploader Plugin allowed users with Overall/Read permission to
> initiate a connection test to an attacker-specified server.

CVE-2019-1003047

> Additionally, the form validation methods did not require POST requests,
> resulting in a CSRF vulnerability.

CVE-2019-1003046

> SECURITY-1089
> PRQA Plugin stored a password unencrypted in its global configuration file
> on the Jenkins master. This password could be viewed by users with access
> to the master file system.

CVE-2019-1003048

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from plugins.jenkins.io_98769808_20250121_012954.html ===

# Slack Notification

How to install

* [Documentation](/slack/)
* [Releases](/slack/releases/)
* [Issues](/slack/issues/)
* [Dependencies](/slack/dependencies/)
* [Health Score](/slack/healthscore/)

[![Build Status](https://camo.githubusercontent.com/783c3a77102f8d137559853a5380cb9123c080b5a3eb7b657a46a560efc8e5ca/68747470733a2f2f63692e6a656e6b696e732e696f2f6275696c645374617475732f69636f6e3f6a6f623d506c7567696e732f736c61636b2d706c7567696e2f6d6173746572)](https://ci.jenkins.io/job/Plugins/job/slack-plugin/job/master/) [![Jenkins Plugin](https://camo.githubusercontent.com/4cd34a5256a48e6b6b3db2122506ef581236177802dcd1d73fbe441541f0400c/68747470733a2f2f696d672e736869656c64732e696f2f6a656e6b696e732f706c7567696e2f762f736c61636b2e737667)](https://plugins.jenkins.io/slack) [![GitHub release](https://camo.githubusercontent.com/ff003d49c807451d778f93809ddaf6864cfebc318ddef4ecfc4d1a3b7534605b/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f6a656e6b696e7363692f736c61636b2d706c7567696e2e7376673f6c6162656c3d72656c65617365)](https://github.com/jenkinsci/slack-plugin/releases/latest) [![Jenkins Plugin Installs](https://camo.githubusercontent.com/6c78d8f6e69c4a472a5dd4234f5d8cf2732d070d7349ead050f02af93906b715/68747470733a2f2f696d672e736869656c64732e696f2f6a656e6b696e732f706c7567696e2f692f736c61636b2e7376673f636f6c6f723d626c7565)](https://plugins.jenkins.io/slack)

Provides Jenkins notification integration with Slack or Slack compatible applications like [RocketChat](https://rocket.chat/) and [Mattermost](https://about.mattermost.com/).

## Install Instructions for Slack

1. Get a Slack account: <https://slack.com/>
2. Install this plugin on your Jenkins server:

   1. From the Jenkins homepage navigate to `Manage Jenkins`
   2. Navigate to `Manage Plugins`,
   3. Change the tab to `Available`,
   4. Search for `slack`,
   5. Check the box next to install.

[![image](https://cdn.jsdelivr.net/gh/jenkinsci/slack-plugin@master/docs/plugin-manager-search.png)](https://github.com/jenkinsci/slack-plugin/blob/master/docs/plugin-manager-search.png)

3. Continue to the next section to create your Slack app.

### Creating your app

1. Go to <https://api.slack.com/apps> and click "Create New App".
2. Click `From an app manifest`
3. Select your workspace
4. Delete the example manifest that Slack provides
5. Click YAML
6. Paste the following into the text box:

```
display_information:
  name: Jenkins
features:
  bot_user:
    display_name: Jenkins
    always_online: true
oauth_config:
  scopes:
    bot:
      - channels:read
      - chat:write
      - chat:write.customize
      - files:write
      - reactions:write
      - users:read
      - users:read.email
      - groups:read
settings:
  org_deploy_enabled: false
  socket_mode_enabled: false
  token_rotation_enabled: false
```

7. Click "Next"
8. Click "Create"
9. Click "Install App to Workspace"
10. Click "Allow"
11. Click "OAuth & Permissions" in the sidebar
12. Copy the "Bot User OAuth Access Token"
13. *On Jenkins*: Find the Slack configuration in "Manage Jenkins → System".
    1. *On Jenkins*: Click "Add" to create a new "Secret text" Credential with the bot user token.
    2. *On Jenkins*: Select the new "Secret text" in the dropdown.
    3. *On Jenkins*: Add a default channel (this can be removed after validating the connection works).
    4. *On Jenkins*: Tick the "Custom slack app bot user" option.
14. Invite the Jenkins bot user into the Slack channel(s) you wish to be notified in.
15. *On Jenkins*: Click test connection. A message will be sent to the default channel / default member.

### Notify for all jobs

If you want to configure a notification to be sent to Slack for **all jobs**, you may want to also consider installing an additional plugin called [Global Slack Notifier plugin](https://plugins.jenkins.io/global-slack-notifier).

### Pipeline job

```
slackSend color: "good", message: "Message from Jenkins Pipeline"

```

Additionally you can pass attachments or blocks (requires [bot user](#plugin-content-bot-user-mode)) in order to send complex messages, for example:

Attachments:

```
def attachments = [
  [
    text: 'I find your lack of faith disturbing!',
    fallback: 'Hey, Vader seems to be mad at you.',
    color: '#ff0000'
  ]
]

slackSend(channel: "#general", attachments: attachments)
```

Blocks (this feature requires a '[bot user](#plugin-content-bot-user-mode)' and a custom slack app):

```
blocks = [
	[
		"type": "section",
		"text": [
			"type": "mrkdwn",
			"text": "Hello, Assistant to the Regional Manager Dwight! *Michael Scott* wants to know where you'd like to take the Paper Company investors to dinner tonight.\n\n *Please select a restaurant:*"
		]
	],
    [
		"type": "divider"
	],
	[
		"type": "section",
		"text": [
			"type": "mrkdwn",
			"text": "*Farmhouse Thai Cuisine*\n:star::star::star::star: 1528 reviews\n They do have some vegan options, like the roti and curry, plus they have a ton of salad stuff and noodles can be ordered without meat!! They have something for everyone here"
		],
		"accessory": [
			"type": "image",
			"image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/c7ed05m9lC2EmA3Aruue7A/o.jpg",
			"alt_text": "alt text for image"
		]
	]
]

slackSend(channel: "#general", blocks: blocks)
```

For more information about slack messages see [Slack Messages Api](https://api.slack.com/docs/messages), [Slack attachments Api](https://api.slack.com/docs/message-attachments) and [Block kit](https://api.slack.com/block-kit)

Note: the attachments API is classified as legacy, with blocks as the replacement (but blocks are only supported when using a bot user through a custom slack app).

#### File upload

You can upload files to slack with this plugin:

```
node {
  sh "echo hey > blah.txt"
  slackUploadFile filePath: "*.txt", initialComment:  "HEY HEY"
}
```

This feature requires [botUser](#plugin-content-bot-user-mode) mode.

##### File upload to a user channel

You can upload files to a user channel by messaging the user first and then using the channel ID from the message response:

```
node {
  sh "echo hey > blah.txt"
  def slackResponse = slackSend channel: '$userId', message: 'Hey', sendAsText: true
  slackUploadFile filePath: "*.txt", channel: slackResponse.channelId
}
```

#### Threads Support

You can send a message and create a thread on that message using the pipeline step. The step returns an object which you can use to retrieve the thread ID. Send new messages with that thread ID as the target channel to create a thread. All messages of a thread should use the same thread ID.

Example:

```
def slackResponse = slackSend(channel: "cool-threads", message: "Here is the primary message")
slackSend(channel: slackResponse.threadId, message: "Thread reply #1")
slackSend(channel: slackResponse.threadId, message: "Thread reply #2")
```

This feature requires [botUser](#plugin-content-bot-user-mode) mode.

Messages that are posted to a thread can also optionally be broadcasted to the channel. Set `replyBroadcast: true` to do so. For example:

```
def slackResponse = slackSend(channel: "ci", message: "Started build")
slackSend(channel: slackResponse.threadId, message: "Build still in progress")
slackSend(
    channel: slackResponse.threadId,
    replyBroadcast: true,
    message: "Build failed. Broadcast to channel for better visibility."
)
```

If you wish to upload a file to a thread, you can do so by specifying the channel, and the timestamp of the thread you want to add the file to, separated by a colon. For example:

```
def slackResponse = slackSend(channel: "cool-threads", message: "Here is the primary message")
sh "echo hey > blah.txt"
slackUploadFile(channel: "cool-threads:" + slackResponse.ts, filePath: "*.txt", initialComment:  "A file, inside a thread.")
```

#### Update Messages

You can update the content of a previously sent message using the pipeline step. The step returns an object which you can use to retrieve the timestamp and channelId NOTE: The slack API requires the channel ID for `chat.update` calls.

Example:

```
def slackResponse = slackSend(channel: "updating-stuff", message: "Here is the primary message")
slackSend(channel: slackResponse.channelId, message: "Update message now", timestamp: slackResponse.ts)
```

This feature requires [botUser](#plugin-content-bot-user-mode) mode.

#### Emoji Reactions

Add an emoji reaction to a previously-sent message like this:

Example:

```
def slackResponse = slackSend(channel: "emoji-demo", message: "Here is the primary message")
slackResponse.addReaction("thumbsup")
```

[![image](https://cdn.jsdelivr.net/gh/jenkinsci/slack-plugin@master/docs/emoji-reaction.png)](https://github.com/jenkinsci/slack-plugin/blob/master/docs/emoji-reaction.png)

You can remove an emoji reaction to a previously-sent message like this:

Example:

```
def slackResponse = slackSend(channel: "emoji-demo", message: "Here is the primary message")
slackResponse.addReaction("thumbsup")
// ... do some stuff
slackResponse.removeReaction("thumbsup")
```

This may only work reliably in channels (as opposed to private messages) due to [limitations in the Slack API](https://api.slack.com/methods/chat.postMessage) (See "Post to an IM channel").

This does not currently work in a situation where Jenkins is restarted between sending the initial message and adding the reaction. If this is something you need, please file an issue.

This feature requires [botUser](#plugin-content-bot-user-mode) mode and the `reactions:write` API scope.

#### Unfurling Links

You can allow link unfurling if you send the message as text. This only works in a text message, as attachments cannot be unfurled.

Example:

```
slackSend(channel: "news-update", message: "https://www.nytimes.com", sendAsText: true)
```

#### User Id Look Up

There are two pipeline steps available to help with user id look up.

A user id can be resolved from a user's email address with the `slackUserIdFromEmail` step.

Example:

```
def userId = slackUserIdFromEmail('spengler@ghostbusters.example.com')
slackSend(color: "good", message: "<@$userId> Message from Jenkins Pipeline")
```

A list of user ids can be resolved against the set of changeset commit authors with the `slackUserIdsFromCommitters` step.

Example:

```
def userIds = slackUserIdsFromCommitters()
def userIdsString = userIds.collect { "<@$it>" }.join(' ')
slackSend(color: "good", message: "$userIdsString Message from Jenkins Pipeline")
```

This feature requires [botUser](#plugin-content-bot-user-mode) mode and the `users:read` and `users:read.email` API scopes.

#### Colors

*Warning: This functionality is not supported if you are using the `blocks` layout mode*

Any hex triplet (i.e. `'#AA1100'`) can be used for the color of the message. There are also three builtin color options:

| Name | Color |
| --- | --- |
| `good` | green |
| `warning` | yellow |
| `danger` | red |

### Freestyle job

1. Configure it in your Jenkins job (and optionally as global configuration) and **add it as a Post-build action**.

## Security

Use Jenkins Credentials and a credential ID to configure the Slack integration token. It is a security risk to expose your integration token using the previous *Integration Token* setting.

Create a new ***Secret text*** credential:

[![image](https://cloud.githubusercontent.com/assets/983526/17971588/6c26dfa0-6aa9-11e6-808c-3e139446e013.png)](https://cloud.githubusercontent.com/assets/983526/17971588/6c26dfa0-6aa9-11e6-808c-3e139446e013.png)

Select that credential as the value for the ***Credential*** field:

[![image](https://cdn.jsdelivr.net/gh/jenkinsci/slack-plugin@master/docs/global-config.png)](https://github.com/jenkinsci/slack-plugin/blob/master/docs/global-config.png)

## Direct Message

You can send messages to channels or you can notify individual users via their slackbot. In order to notify an individual user, use the syntax `@user_id` in place of the project channel. Mentioning users by display name may work, but it is not unique and will not work if it is an ambiguous match.

## User Mentions

Use the syntax `<@user_id>` in a message to mention users directly. See [User Id Look Up](#plugin-content-user-id-look-up) for pipeline steps to help with user id look up.

## Configuration as code

This plugin supports configuration as code Add to your yaml file:

```
credentials:
  system:
    domainCredentials:
      - credentials:
          - string:
              scope: GLOBAL
              id: slack-token
              secret: '${SLACK_TOKEN}'
              description: Slack token

unclassified:
  slackNotifier:
    teamDomain: <your-slack-workspace-name> # i.e. your-company (just the workspace name not the full url)
    tokenCredentialId: slack-token
    botUser: true
```

For more details see the configuration as code plugin documentation: <https://github.com/jenkinsci/configuration-as-code-plugin#getting-started>

## Troubleshooting connection failure

When testing the connection, you may see errors like:

```
    WARNING j.p.slack.StandardSlackService#publish: Response Code: 404

```

There's a couple of things to try:

### Have you enabled bot user mode?

If you've ticked `Custom slack app bot user` then try unticking it, that mode is for when you've created a custom app and installed it to your workspace instead of the default Jenkins app made by Slack

### Have you set the override URL?

If you've entered something into `Override url` then try clearing it out, that field is only needed for slack compatible apps like mattermost.

### Enable additional logging

Add a [log recorder](https://support.cloudbees.com/hc/en-us/articles/204880580-How-do-I-create-a-logger-in-Jenkins-for-troubleshooting-and-diagnostic-information-) for the [StandardSlackService](https://github.com/jenkinsci/slack-plugin/blob/master/src/main/java/jenkins/plugins/slack/StandardSlackService.java) class this should give you additional details on what's going on.

If you still can't figure it out please raise an issue with as much information as possible about your config and any relevant logs.

## Developer instructions

Install Maven and JDK.

```
$ mvn -version | grep -v home
Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-10T08:41:47-08:00)
Java version: 1.7.0_79, vendor: Oracle Corporation
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "4.4.0-65-generic", arch: "amd64", family: "unix"
```

Run unit tests

```
mvn test
```

Create an HPI file to install in Jenkins (HPI file will be in `target/slack.hpi`).

```
mvn clean package
```

##### Version: 751.v2e44153c8fe1

Released: 4 months agoRequires Jenkins 2.440.3ID: slack
##### Installed on 14.1% of controllers

[View detailed version information](https://old.stats.jenkins.io/pluginversions/slack.html)
##### Links

[GitHub](https://github.com/jenkinsci/slack-plugin)[Open issues (Github)](https://github.com/jenkinsci/slack-plugin/issues)[Report an issue (Github)](https://github.com/jenkinsci/slack-plugin/issues/new/choose)[Open issues (Jira)](https://issues.jenkins.io/issues/?jql=resolution%20is%20EMPTY%20and%20component%3D18321)[Report an issue (Jira)](https://www.jenkins.io/participate/report-issue/redirect/#18321/slack)[Pipeline Step Reference](https://www.jenkins.io/doc/pipeline/steps/slack)[Extension Points](https://www.jenkins.io/doc/developer/extensions/slack)[Javadoc](https://javadoc.jenkins.io/plugin/slack)
##### Labels

[Build Notifiers](/ui/search/?labels=notifier)[slack](/ui/search/?labels=slack)
##### Maintainers

[Tim Jacomb](/ui/search/?query=timja)[Joseph Petersen](/ui/search/?query=jetersen)
##### Help us improve this page!

To propose a change submit a pull request to [the plugin page](https://github.com/jenkinsci/slack-plugin) on GitHub.
##### Previous Security Warnings

* ###### [CSRF vulnerability and missing permission checks allowed capturing credentials](https://jenkins.io/security/advisory/2019-03-25/#SECURITY-976)

  + Affects version 2.19 and earlier
![tracker](https://jenkins-matomo.do.g4v.dev/piwik.php?idsite=1&rec=1&url=https://plugins.jenkins.io//slack/)



=== Content from jenkins.io_209a60f3_20250120_232343.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2019-03-25

This advisory announces vulnerabilities in the following Jenkins deliverables:

* [Codebeamer Test Results Trend Updater
  Plugin](https://plugins.jenkins.io/codebeamer-result-trend-updater)
* [Digital.ai App Management Publisher
  Plugin](https://plugins.jenkins.io/ease-plugin)
* [ECS publisher
  Plugin](https://plugins.jenkins.io/ecs-publisher)
* [Fortify on Demand
  Plugin](https://plugins.jenkins.io/fortify-on-demand-uploader)
* [Helix QAC
  Plugin](https://plugins.jenkins.io/prqa-plugin)
* [Lockable Resources
  Plugin](https://plugins.jenkins.io/lockable-resources)
* [Pipeline: Groovy
  Plugin](https://plugins.jenkins.io/workflow-cps)
* [Script Security
  Plugin](https://plugins.jenkins.io/script-security)
* [Slack Notification
  Plugin](https://plugins.jenkins.io/slack)

## Descriptions

### Sandbox bypass in Script Security Plugin and Pipeline: Groovy Plugin

**SECURITY-1353
/
CVE-2019-1003040 (Script Security) and CVE-2019-1003041 (Pipeline: Groovy)**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Affected plugins:
[`script-security`](https://plugins.jenkins.io/script-security)
,

[`workflow-cps`](https://plugins.jenkins.io/workflow-cps)**

**Description:**

Sandbox protection in the Script Security and Pipeline: Groovy Plugins could be circumvented through methods supporting type casts and type coercion.
This allowed attackers to invoke constructors for arbitrary types.

Script Security and Pipeline: Groovy have been hardened to prevent these methods of bypassing sandbox protection.

### XSS vulnerability in Lockable Resources Plugin

**SECURITY-1361
/
CVE-2019-1003042**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

**Affected plugin:
[`lockable-resources`](https://plugins.jenkins.io/lockable-resources)**

**Description:**

Lockable Resources Plugin did not properly escape resource names in generated JavaScript code, thus leading to a cross-site scripting (XSS) vulnerability.

The plugin now properly escapes resource names in its scripts.

### CSRF vulnerability and missing permission checks in Slack Notification Plugin allowed capturing credentials

**SECURITY-976
/
CVE-2019-1003043 (missing permission check) and CVE-2019-1003044 (CSRF)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`slack`](https://plugins.jenkins.io/slack)**

**Description:**

Slack Notification Plugin did not perform permission checks on a method implementing form validation.
This allowed users with Overall/Read access to Jenkins to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

Additionally, this form validation method did not require POST requests, resulting in a cross-site request forgery vulnerability.

This form validation method now requires POST requests and Overall/Administer (for global configuration) or Item/Configure permissions (for job configuration).

### ECS Publisher Plugin stored and displayed API token in plain text

**SECURITY-846
/
CVE-2019-1003045**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`ecs-publisher`](https://plugins.jenkins.io/ecs-publisher)**

**Description:**

ECS Publisher Plugin stored the API token unencrypted in jobs' `config.xml` files and its global configuration file on the Jenkins controller.
This token could be viewed by users with Extended Read permission, or access to the Jenkins controller file system.

Additionally, the API token was not masked from view using a password form field.

The plugin now stores the API token encrypted in the configuration files on disk and no longer transfers it to users viewing the configuration form in plain text.

### SSRF vulnerability due to missing permission check in Fortify on Demand Uploader Plugin

**SECURITY-992
/
CVE-2019-1003046 (CSRF) and CVE-2019-1003047 (missing permission check)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Affected plugin:
[`fortify-on-demand-uploader`](https://plugins.jenkins.io/fortify-on-demand-uploader)**

**Description:**

A missing permission check in multiple form validation methods in Fortify on Demand Uploader Plugin allowed users with Overall/Read permission to initiate a connection test to an attacker-specified server.

Additionally, the form validation methods did not require POST requests, resulting in a CSRF vulnerability.

The form validation methods now require POST requests and perform a permission check.

### PRQA Plugin stored password in plain text

**SECURITY-1089
/
CVE-2019-1003048**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`prqa-plugin`](https://plugins.jenkins.io/prqa-plugin)**

**Description:**

PRQA Plugin stored a password unencrypted in its global configuration file on the Jenkins controller.
This password could be viewed by users with access to the Jenkins controller file system.

The plugin now stores the password encrypted in the configuration files on disk.

### Codebeamer Test Results Trend Updater Plugin stored password in plain text

**SECURITY-1086**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`codebeamer-result-trend-updater`](https://plugins.jenkins.io/codebeamer-result-trend-updater)**

**Description:**

Codebeamer Test Results Trend Updater Plugin stored username and password in its configuration unencrypted in jobs' `config.xml` files on the Jenkins controller.
This password could be viewed by users with Extended Read permission, or access to the Jenkins controller file system.

The plugin now integrates with [Credentials Plugin](https://plugins.jenkins.io/credentials).

### Unprivileged users with Overall/Read access were able to enumerate credential IDs in Arxan MAM Publisher Plugin

**SECURITY-1328**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`ease-plugin`](https://plugins.jenkins.io/ease-plugin)**

**Description:**

Arxan MAM Publisher Plugin provides a list of applicable credential IDs to allow administrators configuring the plugin to select the one to use.

This functionality did not check permissions, allowing any user with Overall/Read permission to get a list of valid credentials IDs.
Those could be used as part of an attack to capture the credentials using another vulnerability.

An enumeration of credentials IDs in this plugin now requires Overall/Administer permission.

## Severity

* SECURITY-846:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-976:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-992:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)
* SECURITY-1086:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1089:
  [Low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1328:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-1353:
  [High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-1361:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

## Affected Versions

* **Codebeamer Test Results Trend Updater
  Plugin**
  up to and including
  1.1.3
* **Digital.ai App Management Publisher
  Plugin**
  up to and including
  2.1
* **ECS publisher
  Plugin**
  up to and including
  1.0.0
* **Fortify on Demand
  Plugin**
  up to and including
  3.0.10
* **Helix QAC
  Plugin**
  up to and including
  3.1.0
* **Lockable Resources
  Plugin**
  up to and including
  2.4
* **Pipeline: Groovy
  Plugin**
  up to and including
  2.64
* **Script Security
  Plugin**
  up to and including
  1.55
* **Slack Notification
  Plugin**
  up to and including
  2.19

## Fix

* **Codebeamer Test Results Trend Updater
  Plugin**
  should be updated to version
  1.1.4
* **Digital.ai App Management Publisher
  Plugin**
  should be updated to version
  2.2
* **ECS publisher
  Plugin**
  should be updated to version
  1.0.1
* **Fortify on Demand
  Plugin**
  should be updated to version
  3.0.11
* **Helix QAC
  Plugin**
  should be updated to version
  3.1.2
* **Lockable Resources
  Plugin**
  should be updated to version
  2.5
* **Pipeline: Groovy
  Plugin**
  should be updated to version
  2.65
* **Script Security
  Plugin**
  should be updated to version
  1.56
* **Slack Notification
  Plugin**
  should be updated to version
  2.20

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Anthony Weems, Praetorian**
  for
  SECURITY-1353
* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-1328
* **Jesper den Boer**
  for
  SECURITY-1361
* **Viktor Gazdag**
  for
  SECURITY-846, SECURITY-976, SECURITY-992, SECURITY-1086, SECURITY-1089


