=== Content from gitlab.com_05350b5e_20250121_010315.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ee' was moved to 'gitlab-org/gitlab'. Please update any links and bookmarks that may still have the old path.

# bypass MR approval count by exploiting Race condition in merge request approval

**[HackerOne report #470309](https://hackerone.com/reports/470309)** by `flashdisk` on 2018-12-20, assigned to `asaba`:

Hi,

**Description:**

I found a race condition issue when a user approves a merge request he can set a number of developers to approve the merge request in order to merge it, but this can be bypassed by firing the following HTTP request using multiple threads in parallel

```
POST /[user_name]/{project}/merge_requests/3/approvals HTTP/1.1
Host: gitlab.com
Connection: close

```

as an example at one of my projects I was able to approve the project twice as you see here:

[![racecond1.PNG](data:image/gif;base64...)](https://user-content.gitlab-static.net/9af7e317fae60be7429a46d7f43b8d666371fdf1/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30646134623163642d613630332d343837322d396539382d6365636530623565396436642f72616365636f6e64312e504e47)

# Fix

add a lock on this endpoint when a user can approve a merge request.

thanks!

## Impact

Race condition in merge request approval

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [racecond1.PNG](https://h1.sec.gitlab.net/a/0da4b1cd-a603-4872-9e98-cece0b5e9d6d/racecond1.PNG)

Edited May 07, 2019 by [Alexander Dietrich](/adietrich)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


