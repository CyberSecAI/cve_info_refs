The provided content describes an authority control and information disclosure vulnerability in ThinkAdmin v4.0.

- **Root cause:** The admin's cookie does not become invalid immediately after the admin changes their password. It remains valid until the end of its lifecycle.
- **Vulnerability:**
  - Lack of proper session invalidation after a password change.
  - Information disclosure via cookie reuse.
- **Impact:** An attacker who has obtained the admin's cookie can maintain access to the managed system even after the admin changes their password.
- **Attack vector:**
  1.  Attacker obtains the admin's cookie.
  2.  Admin changes their password.
  3.  Attacker reuses the stolen cookie to access the system.
- **Attacker capabilities:** The attacker needs to obtain a valid admin cookie. After that, the attacker can use the cookie to access the system even after the password has been changed.
- **Mitigation:** The provided patch invalidates the session (`session('id', null); session_destroy();`) after a password change, forcing the user to log in again.