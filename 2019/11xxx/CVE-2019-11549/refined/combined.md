=== Content from gitlab.com_bacca64a_20250120_231425.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# Failed mirror password leak in production.log and web GUI

**[HackerOne report #493735](https://hackerone.com/reports/493735)** by `j-jam` on 2019-02-10, assigned to `estrike`:

## Summary

A maintainer of a project has the ability to mirror a repository. After creating a mirror using the git URL format (git://) and entering a password, this password is leaked in plain text if there is a problem updating the mirror. It is also written in plain text in the GitLab server production log: ***/var/log/gitlab/gitlab-rails/production.log***

## PoC Setup

Local install of the latest version of GitLab on Ubuntu 18.04 LTS x64. Using **testuser1** as the user account on the **testuser-secret** private project

## PoC

-Login as testuser1 and navigate to the testuser1-secret project, select the ***Repository*** option from the **Settings** menu and then **Mirror a repository**. Enter in the following details:

```
Git repository URL: git://testuser1@192.168.0.16/testuser1/testuser1-secret.git
Mirror direction: push
Authentication method: password
Password: passwordleak
```

Click on **Mirror repository**

[![image1-repo_setup.PNG](data:image/gif;base64...)](https://user-content.gitlab-static.net/057c07f2729e63a633e6191679a1a5013502487d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439333733352f3432313632362f696d616765312d7265706f5f73657475702e504e47)

-Once the mirror is created, you will see the Git url has the password masked. Click on the update icon and a red box with **Error** written in it will appear. Hover over this box and the Git url will be highlighted in the error message with the password in plaintext

[![image2-passwordleak.PNG](data:image/gif;base64...)](https://user-content.gitlab-static.net/481ebf2ea9f70283ab0c3abe9f0e739bd5a7ef08/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439333733352f3432313632372f696d616765322d70617373776f72646c65616b2e504e47)

**Note.** I assume the repo has failed to mirror as I specified an existing project or it was because I was using a private IP address

-On the GitLab server, access the following log and you will see the password has been written in plaintext there as well: /var/log/gitlab/gitlab-rails/production.log

[![image3-logfile.PNG](data:image/gif;base64...)](https://user-content.gitlab-static.net/468dc83ba718590395d1f3b6d0e6d2009d24e701/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439333733352f3432313632382f696d616765332d6c6f6766696c652e504e47)

Note. The password is also written in plaintext in the ***gitlaly/current*** and ***/sidekiq/current*** logs as well

-It should also be noted that when importing a new project via URL, and if there is an issue with connecting to a remote repository with authentication, the password is leaked again in plaintext but only in the ***/var/log/gitlab/gitaly/current*** log. If you would like further screenshots or a PoC with this then let me know.

## Impact

The impact of this vulnerability is that other maintainer level users can view a password of a faulty mirror that could have been set by another maintainer. The passwords are also now accessible to whomever has the necessary access to the GitLab server log files. The log files will most likely also be shipped to a central syslog server for analysis in most Enterprise environments, thus exposing the password there as well.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image1-repo\_setup.PNG](https://h1.sec.gitlab.net/a/493735/421626/image1-repo_setup.PNG)
* [image2-passwordleak.PNG](https://h1.sec.gitlab.net/a/493735/421627/image2-passwordleak.PNG)
* [image3-logfile.PNG](https://h1.sec.gitlab.net/a/493735/421628/image3-logfile.PNG)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


