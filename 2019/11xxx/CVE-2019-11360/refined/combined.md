=== Content from it-solutions-neef.de_54f1e8e4_20250121_021102.html ===


* [Startseite](/ "Startseite")
* [Leistungen](/leistungen.html "Leistungen")
  + [Security Check](/securitycheck.html "Security Check")
  + [Vorträge & Live-Hacks](/livehacks.html "Vorträge & Live-Hacks")
  + [Testimonials](/testimonials.html "Testimonials")
* [Referenzen](/referenzen.html "Referenzen")
* [Kontakt](/kontakt.html "Kontakt")
* [DE](/lang/de_DE)
* [EN](/lang/en_EN)

* [Startseite](/ "Startseite")
* [Leistungen](/leistungen.html "Leistungen")
  + [Security Check](/securitycheck.html "Security Check")
  + [Vorträge & Live-Hacks](/livehacks.html "Vorträge & Live-Hacks")
* [Referenzen](/referenzen.html "Referenzen")
* [Kontakt](/kontakt.html "Kontakt")
* [Impressum](/impressum.html "Impressum")
* [DE](/lang/de_DE)
* [EN](/lang/en_EN)

## Datenschutz

---

#### Allgemeine Hinweise

Auf dieser Seite erfahren Sie, was mit Ihren personenbezogenen Daten passiert, wenn Sie eine unserer Webseiten abrufen. Wir erläutern, welche Daten wir erheben und wofür wir diese nutzen. Unter personenbezogenen Daten werden alle Daten verstanden, mit denen Sie persönlich identifiziert werden können.

Vorab muss angemerkt werden, dass trotz technischer Affinität es Betreibers, Sicherheitslücken im Internet existieren und die Datenübertragung beeinträchtigen können. Deswegen kann ein lückenloser Schutz der Daten keineswegs garantiert werden.

Dennoch liegt der bestmögliche Schutz Ihrer persönlicher Daten uns sehr nahe. Sie können von uns erwarten, dass wir mit Ihren Daten sorgfältig und sensibel umgehen, sowie nach bestem Wissen und Gewissen für eine hohe Datensicherheit sorgen. Die Daten werden mit den folgend beschriebenen Methoden und Umfängen verarbeitet.

In Fällen, bei denen wir auf externe Webseiten verlinken, haben wir nach einem Klick keinen Einfluss mehr auf die Datenverarbeitung durch die verlinkte Webseite. Die Verarbeitung der ggf. weitergegeben Daten (z.B. URL im Referrer) unterliegt dem Datenschutz der Dritten.

##### Verantwortliche Stelle

Verantwortlich für die Datenverarbeitung auf den Webseiten der IT Solutions Neef ist der im Impressum genannte Webseitenbetreiber.

##### Änderungen des Datenschutzhinweises

Wir halten diese Informationsseite zum Datenschutz immer auf dem aktuellen Stand. Deshalb kann es sein, dass wir den Datenschutzhinweis an veränderte Rahmenbedingungen tatsächlicher oder gesetzlicher Art anpassen. Diese Anpassungen werden mit Nutzung unserer Internetseiten akzeptiert.

#### Welche Daten erheben wir und warum?

Im Folgenden möchten wir erläutern und begründen, welche Daten wir erheben und weshalb wir die zuvor genannten Daten verarbeiten.

##### Leistungserbringung

Generell erheben wir nur Daten, wenn wir eine Leistung gegenüber Ihnen erbringen. Darunter verstehen wir bereits die Auslieferung der Webseite (auf die von Ihnen geschickte Anfrage) an Ihr Endgerät bis hin zu den von uns angebotenen Dienstleistungen. Diese Daten werden ausschließlich für diese Zwecke verwendet.

##### Steuerrechtliche Angelegenheiten

Sollten Sie Kunde unserer Dienstleistungen sein oder werden, so sind wir z.B. aus steuerrechtlichen und finanzrechtlichen Gründen angehalten, die Informationen über Sie zu verarbeiten und aufzubewahren. Diese Daten umfassen die notwendigen Daten für die Ausstellung einer korrekten Rechnung, sowie die zur Leistung nötigen, individuellen Informationen:

* Name und Adresse
* E-Mail und Telefon
* USt-ID und SteuerNr (falls vorhande)
* Informationen zur Leistung und dem Leistungszeitraum

##### Technischer Betrieb

Für den technischen Betrireb einer Webseite werden unweigerlich personenbezogene Daten verarbeitet. Darunter fallen beispielsweise:

* IP-Adresse
* Uhrzeit der Anfrage
* Informationen zum Browser
* Abgerufene Ressource
* Cookies

Diese Informationen werden für den technischen Betrieb eines Webservers benötigt und dabei verarbeitet. IP-Adressen werden in den Logdateien anonymisiert. Cookies sind notwendig, um Sessions zu ermöglichen (z.B. authentifizierter Bereich) oder um Statistiken zu erheben (siehe Abschnitt "Analyse und Erstellung von Statistiken"). Andernfalls werden diese Informationen in Bezug auf die IT-Sicherheit verarbeit (siehe folgender Abschnitt).

In manchen Fällen ist es uns nicht möglich, alle Ressourcen einer Webseite durch uns auszuliefern, sodass diese Ressourcen von externen Dienstleistern abgerufen werden müssen. Dies kann nicht zur Anzeige nötige Dateien beinhalten (z.B. CSS/Javascripts/Fonts), sondern auch durch Median in Form von Fotos, Videos, Audio oder technische Maßnahmen, wie CAPTCHAs (z.B. Youtube / Instagramm / Flickr / Google ReCaptcha ). Häufig sind diese Ressourcen auf Ihrem System bereits gecached, sodass keine erneute Abfrage nötig ist. Anderfalls werden an diese Anbieter durch Ihren Browser Ihre Informationen (wie z.B. IP-Adresse / Browser-Informationen / Referrer / Cookies ) übermittelt.

* Google: <https://www.google.com/policies/privacy/>
* Youtube: <https://www.google.de/intl/de/policies/privacy>

Die Nutzung dieser Drittanbieter geschieht auf Basis des berechtigten Interesses des Seitenbetreibers, um eine ansprechende Darstellung bzw. Sicherheit der Seite zu gewährleisten.
##### IT-Sicherheit

Zu teilen ist es notwendig, dass personenbezogene Daten unter dem Aspekt der IT-Sicherheit erhoben werden. Dies ist z.B. nötig, um Angriffe auf unsere Systeme zu erkennen, zu verhindern und auszuwerten. Dafür müssen z.B. IP-Adressen oder die abgefragten Ressourcen (URLs) für einen kurzen Zeitraum gespeichert und analyisiert werden. Diese Daten werden nach Möglichkeit miniert und schnellstmöglich vernichtet, sofern sie nicht für rechtliche Schritte von Bedeutung sind und dafür aufbewahrt werden müssen. Diese Abwägung ist nötig, um den bestmöglichen Schutz der bestehenden Daten zu gewährleisten.

##### Analyse und Erstellung von Statistiken

Wir nutzen die OpenSource Software "Matomo", um Statistiken und Analysen über unsere Seitenaufrufe erstellen zu können. Diese basieren unter anderem auf folgenden Informationen, die von Ihrem Browser an die Webseite geschickt werden:

* IP-Adresse (anonymisiert)
* Browserkennung
* Referrer
* Uhrzeit

Eine ausführliche Liste von Parametern wird auf [der Seite der Entwickler](https://matomo.org/faq/general/faq_18254/) aufgelistet.
Diese Werte können Sie in Ihrem Browser frei wählen. Zwar ist es mit diesen Daten uns nicht möglich, Sie eindeutig indifizieren zu können, trotzdem haben Sie folgend die Möglichkeit der Erfassung zu widersprechen:

##### Kommentare und Interaktivität

Ein wichtiger Bestandteil von einigen Webseiten ist die Möglichkeit des Wissensaustausches. Dafür werden u.a. Kommentarfunktionen verwendet, bei denen ein Nutzer unter Angabe von Kontaktmöglichkeiten (z.B. Email/Name) einen Kommentar verfassen können. Zu diesen Daten speichern wir aus sicherheitstechnischen Gründen die IP-Adresse des Verfassers, um ggf. rechtswidrige Kommentare löschen und verfolgen zu können. Kommentarverfasser sollten sich im Klaren sein, dass diese Informationen entsprechend auf diesen Seiten veröffentlicht und somit "weitergegeben" werden können.

Im Fall von DISQUS wird nur bestehende Funktionalität des Anbieters zurückgegriffen, und keine Daten durch uns selbst verarbeitet. Diese Verarbeitung (Registrierung eines Accounts / Verfassen und veröffentlichen eines Kommentars) geschieht lediglich auf Seite des Anbieters, womit auf dessen Datenschutzbestimmungen verweisen möchten.
#### Wie schützen wir Ihre Daten?

Durch den Einsatz technischer und organisatorischer Maßnahmen sorgen für dafür, dass das hohe Maß an Datensicherheit erzielt werden kann.
##### Verschlüsselung

Die von uns betriebenen Webseiten werden in den meisten Fällen standardmäßig mit einem verschlüsselten Übertragungskanal (SSL/TLS) übermittelt. Somit sind die übertragenen Daten auf dem Transportweg vor dem Zugriff Dritter geschützt.

Des Weiteren werden die Daten, soweit technisch und nutzungsbedingt zumutbar, auf verschlüsselten Datenträgern gespeichert.

##### Zugriff nur durch Befugte

Darüber hinaus sorgen wir dafür, dass Zugriff nur durch berechtige Personen erfolgt, und dieser so gering wie nur nötig ausfällt.

#### Ihre Rechte

Sie haben jederzeit das Recht, eine Auskunft, Löschung, Berichtigung oder Einschränkung der Verarbeitung Ihrer Daten zu verlangen. Genauso können Sie Daten im Rahmen der Datenübertragbarkeit verlangen, oder sich bei einer Aufsichtsbehörde beschweren. Bitte kontaktieren Sie uns unter einer der im Impressum oder auf der Kontaktseite genannten Kontaktmöglichkeiten, um Ihre Rechte gegenüber von uns einzufordern.

[Kontakt](#tab2 "Kontakt")
[Vcard](#tab3 "Vcard")

* | IT Solutions Neef | |
  | --- | --- |
  |  | |
  | Sebastian Neef | |
  | E-mail: | sne@it-solutions-neef.de |
  | Mobil: | +4917693205364 |
  | Fax: | +493013880671 |
  | Straße: | Langhansstr. 137 |
  | Ort: | 13086 Berlin |
  | Land: | Deutschland |
  | LinkedIn: | [LinkedIn Profil](https://www.linkedin.com/in/sebastian-neef/) |
  | Xing: | [Xing Profil](https://www.xing.com/profiles/Sebastian_Neef2) |
  | Twitter: | [Twitter Profil](https://twitter.com/gehaxelt) |
* ![](/imgs/qrcode.png "Vcard von Sebastian Neef")

---

[Impressum](/impressum.html "Impressum")
[Datenschutz](/datenschutz.html "Datenschutz")

[Nach oben](#logo "Nach oben")



=== Content from 0day.work_79c7a180_20250121_000215.html ===

[![Blog Logo](https://0day.work/content/images/2016/01/0day-1.png)](https://0day.work)
##### Sebastian Neef - 0day.work

---

* [Home](https://0day.work/)
* [Contact](https://0day.work/contact/)
* [@0daywork](https://twitter.com/0daywork)
* [@gehaxelt](https://twitter.com/gehaxelt)
* [Impressum](https://it-solutions-neef.de/impressum.html)
* [Datenschutz](https://it-solutions-neef.de/datenschutz.html)

 [home](/)

---

# CVE-2019-11360: BufferOverflow in iptables-restore v1.8.2

This blogpost is about a BufferOverflow vulnerability which I found by fuzzing `iptables-restore` using AFL in March, 2019. It was fixed by the netfilter team in April 2019 and was assigned CVE-2019-11360 by MTIRE.

# Fuzzing iptables-restore

Back in March I somehow came up with the idea of fuzzing iptables. I thought using `iptables-restore` as the target binary would be a good idea, because I could use AFL to supply iptables rules files to it.

You can save your current rules with `iptables-save > /tmp/rules` and restore them later (i.e. on boot) using `iptables-restore /tmp/rules`.

The test harness consisted of two such rules files that I took from my laptop and a server that I own. As iptables is the user-interface to the kernel's netfilter subsystem, the source code is open source and can be downloaded from [the git.netfilter.org repository](https://git.netfilter.org/iptables/).

To be honest, I can't remember for how long the master and slave AFL instance was fuzzing on my fuzzing-VM, but I think it was not longer than 1-2 weeks until the first crash showed up.

# BufferOverflow in add\_param\_to\_argv

I downloaded the crash file and used GDB to run it against the AFL-instrumented `iptables-restore` binary. The crash occurred in the function `add_param_to_argv` in `iptables/xshared.c`.

Having the source code, I started looking at the function and trying to understand why the crash occurred and if it was exploitable.

The vulnerable code [can be found in iptables v1.8.2](https://git.netfilter.org/iptables/tree/iptables/xshared.c?h=v1.8.2) and looks like this:

```
void add_param_to_argv(char *parsestart, int line)
{
	int quote_open = 0, escaped = 0, param_len = 0;
	char param_buffer[1024], *curchar;

	/* After fighting with strtok enough, here's now
	 * a 'real' parser. According to Rusty I'm now no
	 * longer a real hacker, but I can live with that */

	for (curchar = parsestart; *curchar; curchar++) {
		if (quote_open) {
			if (escaped) {
				param_buffer[param_len++] = *curchar;
				escaped = 0;
				continue;
			} else if (*curchar == '\\') {
				escaped = 1;
				continue;
			} else if (*curchar == '"') {
				quote_open = 0;
				*curchar = '"';
			} else {
				param_buffer[param_len++] = *curchar;
				continue;
			}
		} else {
			if (*curchar == '"') {
				quote_open = 1;
				continue;
			}
		}

		switch (*curchar) {
		case '"':
			break;
		case ' ':
		case '\t':
		case '\n':
			if (!param_len) {
				/* two spaces? */
				continue;
			}
			break;
		default:
			/* regular character, copy to buffer */
			param_buffer[param_len++] = *curchar;

			if (param_len >= sizeof(param_buffer))
				xtables_error(PARAMETER_PROBLEM,
					      "Parameter too long!");
			continue;
		}

		param_buffer[param_len] = '\0';

		/* check if table name specified */
		if ((param_buffer[0] == '-' &&
		     param_buffer[1] != '-' &&
		     strchr(param_buffer, 't')) ||
		    (!strncmp(param_buffer, "--t", 3) &&
		     !strncmp(param_buffer, "--table", strlen(param_buffer)))) {
			xtables_error(PARAMETER_PROBLEM,
				      "The -t option (seen in line %u) cannot be used in %s.\n",
				      line, xt_params->program_name);
		}

		add_argv(param_buffer, 0);
		param_len = 0;
	}
}

```

The function is part of the argument parsing process of iptables, i.e. `-p tcp --dport "<some-argument-here>"`. It uses a fixed `param_buffer[1024]` on the stack and overflowing it leads to the crash.

A motivated reader will take a 5-minute break to look at the code and find the BoF himself ;-)

The `for`-loop goes over all characters of the string that is passed to the function through `char *parsestart`. In the lower part there is a `switch` blck which will match different characters and conduct a bounds check in the `default:` branch. If an argument is longer than the 1024-bytes `param_buffer`, then an error is thrown and the BoF prevented.

However, the upper part of the `for`-loop checks if an argument is quoted. If the `*curchar` equals `"` then `quote_open` is set to `1` in the `else` branch and the loop starts over (`continue`). In the next iteration, it will enter the `if (quote_open)` branch. As long as no matching `"` is found, the loop will stay in the upper part due to the `continue` statements:

```
    param_buffer[param_len++] = *curchar;
    continue;

```

That means that it will never reach the bounds check in the lower part and copy as many characters as the `*parsestart` has to the stack, thereby overflowing the `param_buffer` and allowing an attacker to rewrite the stack.

# Proof of Concept

I started minifying the AFL-generated crash file and managed to create the following PoC iptables file which overwrites `RIP` with `0x414141414141`:

```
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p tcp --dport "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaafdaafeaaffaafgaafhaafiaafjaafkaaflaafmaafnaafoaafpaafqaafraafsaaftaafuaafvaafwaafxaafyaafzaagbaagcaagdaageaagfaaggaaghaagiaagjaagkaaglaagmaagnaagoaagpaagqaagraagsaagtaaguaagvaagwaagxaagyaagzaahbaahcaahdaaheaahfaahgaahhaahiaahjaahkaahBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBAAAAAA"
COMMIT

```

![poc](https://0day.work/content/images/2019/07/poc.png)

One could argue that the severity of the issue is not high, because one already needs root privileges to run `iptables-restore` in a standard debian setup. So if an attacker is capable of running `iptables-restore`, then she already can do more harm to your system anyway. If an administrator can be convinced to apply unknown iptables rules files, then her system is most likely already compromised.

Furthermore, I had to disable all well-known security features like `NX`, `Canaries` and `PIE` to build this PoC. This means, that building a real-world exploit probably takes much more effort and/or is quite hard:

```
$> checksec -f /usr/bin/iptables-restore
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH	Symbols		FORTIFY	Fortified	Fortifiable  FILE
Full RELRO      Canary found      NX enabled    PIE enabled     No RPATH   No RUNPATH   No Symbols      Yes	7		12	/usr/bin/iptables-restore

```

All in all, I believe that this vulnerability can only be used for academic/educational purposes and has no particular real-world impact. [I'd really appreciate if you prove me wrong ;-)]

# Patch

As iptables is open source, I decided to try and come up with a patch myself. I took the easiest and most obvious approach of simply doing a bounds check at the beginning of the loop:

```
fuzz@fuzzing:~/fuzzing/iptables/pkg-iptables/iptables# diff -Naur xshared.c.old xshared.c
--- xshared.c.old       2019-04-13 20:50:07.871158901 +0100
+++ xshared.c   2019-04-13 20:42:59.216774862 +0100
@@ -443,6 +443,10 @@
         * longer a real hacker, but I can live with that */

        for (curchar = parsestart; *curchar; curchar++) {
+               if (param_len >= sizeof(param_buffer))
+                               xtables_error(PARAMETER_PROBLEM,
+                                             "Parameter too long!");
+
                if (quote_open) {
                        if (escaped) {
                                param_buffer[param_len++] = *curchar;
@@ -479,10 +483,6 @@
                default:
                        /* regular character, copy to buffer */
                        param_buffer[param_len++] = *curchar;
-                       if (param_len >= sizeof(param_buffer))
-                               xtables_error(PARAMETER_PROBLEM,
-                                             "Parameter too long!");
-
                        continue;
                }

```

I sent the patch to Pablo in hopes to make his life easier. The netfilter team decided to completely rewrite my patch and, regarding to my more proficient C-developer friends, make it more readable.

The final patch can be found [in their git repo](https://git.netfilter.org/iptables/commit/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) and looks like this:

```
diff --git a/iptables/xshared.c b/iptables/xshared.c
index fb186fb1..36a2ec5f 100644
--- a/iptables/xshared.c
+++ b/iptables/xshared.c
@@ -433,10 +433,24 @@ void save_argv(void)
 	}
 }

+struct xt_param_buf {
+	char	buffer[1024];
+	int 	len;
+};
+
+static void add_param(struct xt_param_buf *param, const char *curchar)
+{
+	param->buffer[param->len++] = *curchar;
+	if (param->len >= sizeof(param->buffer))
+		xtables_error(PARAMETER_PROBLEM,
+			      "Parameter too long!");
+}
+
 void add_param_to_argv(char *parsestart, int line)
 {
-	int quote_open = 0, escaped = 0, param_len = 0;
-	char param_buffer[1024], *curchar;
+	int quote_open = 0, escaped = 0;
+	struct xt_param_buf param = {};
+	char *curchar;

 	/* After fighting with strtok enough, here's now
 	 * a 'real' parser. According to Rusty I'm now no
@@ -445,7 +459,7 @@ void add_param_to_argv(char *parsestart, int line)
 	for (curchar = parsestart; *curchar; curchar++) {
 		if (quote_open) {
 			if (escaped) {
-				param_buffer[param_len++] = *curchar;
+				add_param(&param, curchar);
 				escaped = 0;
 				continue;
 			} else if (*curchar == '\\') {
@@ -455,7 +469,7 @@ void add_param_to_argv(char *parsestart, int line)
 				quote_open = 0;
 				*curchar = '"';
 			} else {
-				param_buffer[param_len++] = *curchar;
+				add_param(&param, curchar);
 				continue;
 			}
 		} else {
@@ -471,36 +485,32 @@ void add_param_to_argv(char *parsestart, int line)
 		case ' ':
 		case '\t':
 		case '\n':
-			if (!param_len) {
+			if (!param.len) {
 				/* two spaces? */
 				continue;
 			}
 			break;
 		default:
 			/* regular character, copy to buffer */
-			param_buffer[param_len++] = *curchar;
-
-			if (param_len >= sizeof(param_buffer))
-				xtables_error(PARAMETER_PROBLEM,
-					      "Parameter too long!");
+			add_param(&param, curchar);
 			continue;
 		}

-		param_buffer[param_len] = '\0';
+		param.buffer[param.len] = '\0';

 		/* check if table name specified */
-		if ((param_buffer[0] == '-' &&
-		     param_buffer[1] != '-' &&
-		     strchr(param_buffer, 't')) ||
-		    (!strncmp(param_buffer, "--t", 3) &&
-		     !strncmp(param_buffer, "--table", strlen(param_buffer)))) {
+		if ((param.buffer[0] == '-' &&
+		     param.buffer[1] != '-' &&
+		     strchr(param.buffer, 't')) ||
+		    (!strncmp(param.buffer, "--t", 3) &&
+		     !strncmp(param.buffer, "--table", strlen(param.buffer)))) {
 			xtables_error(PARAMETER_PROBLEM,
 				      "The -t option (seen in line %u) cannot be used in %s.\n",
 				      line, xt_params->program_name);
 		}

-		add_argv(param_buffer, 0);
-		param_len = 0;
+		add_argv(param.buffer, 0);
+		param.len = 0;
 	}
 }

```
# Timeline

* 03/05/2019 - Report sent to netfilter's coreteam mailing list
* 03/22/2019 - Resent email to Pablo Neira Ayuso, because it was somehow lost
* 04/17/2019 - Provided the netfilter team an initial patch / diff
* 04/XX/2019 - MITRE assigned CVE-2019-11360
* 04/22/2019 - Pablo rewrites and posts the patch for review
* 04/30/2019 - Patch is merged into iptables-restore
* ??/??/???? - iptables v.1.8.3 released
* 07/11/2019 - Blogpost published

-=-

---

© 2025 [Sebastian Neef - 0day.work](https://0day.work) All rights reserved.

Coder Ghost Theme created by [Milos Bejda](https://www.mbejda.com)

Proudly published with [Ghost](https://ghost.org)

![](//piwik.neef.it/piwik.php?idsite=10&rec=1)



=== Content from twitter.com_433b2e32_20250121_021101.html ===



=== Content from it-solutions-neef.de_0d193865_20250121_021102.html ===


* [Startseite](/ "Startseite")
* [Leistungen](/leistungen.html "Leistungen")
  + [Security Check](/securitycheck.html "Security Check")
  + [Vorträge & Live-Hacks](/livehacks.html "Vorträge & Live-Hacks")
  + [Testimonials](/testimonials.html "Testimonials")
* [Referenzen](/referenzen.html "Referenzen")
* [Kontakt](/kontakt.html "Kontakt")
* [DE](/lang/de_DE)
* [EN](/lang/en_EN)

* [Startseite](/ "Startseite")
* [Leistungen](/leistungen.html "Leistungen")
  + [Security Check](/securitycheck.html "Security Check")
  + [Vorträge & Live-Hacks](/livehacks.html "Vorträge & Live-Hacks")
* [Referenzen](/referenzen.html "Referenzen")
* [Kontakt](/kontakt.html "Kontakt")
* [Impressum](/impressum.html "Impressum")
* [DE](/lang/de_DE)
* [EN](/lang/en_EN)

## Impressum

---

Angaben gemäß § 5 TMG:

* ##### IT Solutions Neef
* Freiberufl. Medieninformatiker
* USt-IdNr: DE285524609
* Sebastian Neef
* Langhansstr. 137
* 13086 Berlin

### Kontakt:

| Mobil: | +4917693205364 |
| --- | --- |
| E-mail: | sne@it-solutions-neef.de |

### Grafik

Die Grafik "Websecurity" auf der Startseite wurde von [Marvin Heidenstedt](http://www.heidenstedt.org/impressum/) erstellt.

### Design

Diese Webseite wurde von Dipl. Designer Rodolfo Ricalo gestaltet.

### Haftungsausschluss

**Haftung für Inhalte**

Die Inhalte unserer Seiten wurden mit größter Sorgfalt erstellt. Für die Richtigkeit, Vollständigkeit und Aktualität der Inhalte können wir jedoch keine Gewähr übernehmen. Als Diensteanbieter sind wir gemäß § 7 Abs.1 TMG für eigene Inhalte auf diesen Seiten nach den allgemeinen Gesetzen verantwortlich. Nach §§ 8 bis 10 TMG sind wir als Diensteanbieter jedoch nicht verpflichtet, übermittelte oder gespeicherte fremde Informationen zu überwachen oder nach Umständen zu forschen, die auf eine rechtswidrige Tätigkeit hinweisen. Verpflichtungen zur Entfernung oder Sperrung der Nutzung von Informationen nach den allgemeinen Gesetzen bleiben hiervon unberührt. Eine diesbezügliche Haftung ist jedoch erst ab dem Zeitpunkt der Kenntnis einer konkreten Rechtsverletzung möglich. Bei Bekanntwerden von entsprechenden Rechtsverletzungen werden wir diese Inhalte umgehend entfernen.

**Haftung für Links**

Unser Angebot enthält Links zu externen Webseiten Dritter, auf deren Inhalte wir keinen Einfluss haben. Deshalb können wir für diese fremden Inhalte auch keine Gewähr übernehmen. Für die Inhalte der verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber der Seiten verantwortlich. Die verlinkten Seiten wurden zum Zeitpunkt der Verlinkung auf mögliche Rechtsverstöße überprüft. Rechtswidrige Inhalte waren zum Zeitpunkt der Verlinkung nicht erkennbar. Eine permanente inhaltliche Kontrolle der verlinkten Seiten ist jedoch ohne konkrete Anhaltspunkte einer Rechtsverletzung nicht zumutbar. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Links umgehend entfernen.

**Urheberrecht**

Die durch die Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem deutschen Urheberrecht. Die Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung außerhalb der Grenzen des Urheberrechtes bedürfen der schriftlichen Zustimmung des jeweiligen Autors bzw. Erstellers. Downloads und Kopien dieser Seite sind nur für den privaten, nicht kommerziellen Gebrauch gestattet. Soweit die Inhalte auf dieser Seite nicht vom Betreiber erstellt wurden, werden die Urheberrechte Dritter beachtet. Insbesondere werden Inhalte Dritter als solche gekennzeichnet. Sollten Sie trotzdem auf eine Urheberrechtsverletzung aufmerksam werden, bitten wir um einen entsprechenden Hinweis. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Inhalte umgehend entfernen.

**Datenschutz**

Die Nutzung unserer Webseite ist in der Regel ohne Angabe personenbezogener Daten möglich. Soweit auf unseren Seiten personenbezogene Daten (beispielsweise Name, Anschrift oder eMail-Adressen) erhoben werden, erfolgt dies, soweit möglich, stets auf freiwilliger Basis. Diese Daten werden ohne Ihre ausdrückliche Zustimmung nicht an Dritte weitergegeben.

Wir weisen darauf hin, dass die Datenübertragung im Internet (z.B. bei der Kommunikation per E-Mail) Sicherheitslücken aufweisen kann. Ein lückenloser Schutz der Daten vor dem Zugriff durch Dritte ist nicht möglich.

Der Nutzung von im Rahmen der Impressumspflicht veröffentlichten Kontaktdaten durch Dritte zur Übersendung von nicht ausdrücklich angeforderter Werbung und Informationsmaterialien wird hiermit ausdrücklich widersprochen. Die Betreiber der Seiten behalten sich ausdrücklich rechtliche Schritte im Falle der unverlangten Zusendung von Werbeinformationen, etwa durch Spam-Mails, vor.

*Quelle: [Disclaimer eRecht24](http://www.e-recht24.de/muster-disclaimer.htm), [Datenschutzerklärung Twitter](http://twitter.com/privacy)*

[Kontakt](#tab2 "Kontakt")
[Vcard](#tab3 "Vcard")

* | IT Solutions Neef | |
  | --- | --- |
  |  | |
  | Sebastian Neef | |
  | E-mail: | sne@it-solutions-neef.de |
  | Mobil: | +4917693205364 |
  | Fax: | +493013880671 |
  | Straße: | Langhansstr. 137 |
  | Ort: | 13086 Berlin |
  | Land: | Deutschland |
  | LinkedIn: | [LinkedIn Profil](https://www.linkedin.com/in/sebastian-neef/) |
  | Xing: | [Xing Profil](https://www.xing.com/profiles/Sebastian_Neef2) |
  | Twitter: | [Twitter Profil](https://twitter.com/gehaxelt) |
* ![](/imgs/qrcode.png "Vcard von Sebastian Neef")

---

[Impressum](/impressum.html "Impressum")
[Datenschutz](/datenschutz.html "Datenschutz")

[Nach oben](#logo "Nach oben")



=== Content from git.netfilter.org_2d9ba1ac_20250121_000226.html ===


| [cgit logo](/) | [index](/) : [iptables](/iptables/ "iptables") | master |
| --- | --- | --- |
| iptables tree | pablo@netfilter.org |

| [summary](/iptables/)[refs](/iptables/refs/?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)[log](/iptables/log/iptables/xshared.c)[tree](/iptables/tree/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)[commit](/iptables/commit/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)[diff](/iptables/diff/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)[stats](/iptables/stats/iptables/xshared.c) | log msg author committer range |
| --- | --- |

path: [root](/iptables/commit/?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)/[iptables](/iptables/commit/iptables?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)/[xshared.c](/iptables/commit/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2019-04-22 23:17:27 +0200 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2019-04-30 14:10:35 +0200 |
| commit | [2ae1099a42e6a0f06de305ca13a842ac83d4683e](/iptables/commit/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) ([patch](/iptables/patch/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)) | |
| tree | [1c42c3112552b610b8a775b51631902b613d2d5d](/iptables/tree/?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) /[iptables/xshared.c](/iptables/tree/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) | |
| parent | [4000b4cf2ea3826ea6f777e400cc5353ac89563c](/iptables/commit/iptables/xshared.c?id=4000b4cf2ea3826ea6f777e400cc5353ac89563c) ([diff](/iptables/diff/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e&id2=4000b4cf2ea3826ea6f777e400cc5353ac89563c)) | |

xshared: check for maximum buffer length in add\_param\_to\_argv()Bail out if we go over the boundary, based on patch from Sebastian.
Reported-by: Sebastian Neef <contact@0day.work>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/iptables/diff/?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) (limited to 'iptables/xshared.c')

| -rw-r--r-- | [iptables/xshared.c](/iptables/diff/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e) | 46 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 28 insertions, 18 deletions

| diff --git a/iptables/xshared.c b/iptables/xshared.cindex fb186fb1..36a2ec5f 100644--- a/[iptables/xshared.c](/iptables/tree/iptables/xshared.c?id=4000b4cf2ea3826ea6f777e400cc5353ac89563c)+++ b/[iptables/xshared.c](/iptables/tree/iptables/xshared.c?id=2ae1099a42e6a0f06de305ca13a842ac83d4683e)@@ -433,10 +433,24 @@ void save\_argv(void) } } +struct xt\_param\_buf {+ char buffer[1024];+ int len;+};++static void add\_param(struct xt\_param\_buf \*param, const char \*curchar)+{+ param->buffer[param->len++] = \*curchar;+ if (param->len >= sizeof(param->buffer))+ xtables\_error(PARAMETER\_PROBLEM,+ "Parameter too long!");+}+ void add\_param\_to\_argv(char \*parsestart, int line) {- int quote\_open = 0, escaped = 0, param\_len = 0;- char param\_buffer[1024], \*curchar;+ int quote\_open = 0, escaped = 0;+ struct xt\_param\_buf param = {};+ char \*curchar;  /\* After fighting with strtok enough, here's now \* a 'real' parser. According to Rusty I'm now no@@ -445,7 +459,7 @@ void add\_param\_to\_argv(char \*parsestart, int line) for (curchar = parsestart; \*curchar; curchar++) { if (quote\_open) { if (escaped) {- param\_buffer[param\_len++] = \*curchar;+ add\_param(&param, curchar); escaped = 0; continue; } else if (\*curchar == '\\') {@@ -455,7 +469,7 @@ void add\_param\_to\_argv(char \*parsestart, int line) quote\_open = 0; \*curchar = '"'; } else {- param\_buffer[param\_len++] = \*curchar;+ add\_param(&param, curchar); continue; } } else {@@ -471,36 +485,32 @@ void add\_param\_to\_argv(char \*parsestart, int line) case ' ': case '\t': case '\n':- if (!param\_len) {+ if (!param.len) { /\* two spaces? \*/ continue; } break; default: /\* regular character, copy to buffer \*/- param\_buffer[param\_len++] = \*curchar;-- if (param\_len >= sizeof(param\_buffer))- xtables\_error(PARAMETER\_PROBLEM,- "Parameter too long!");+ add\_param(&param, curchar); continue; } - param\_buffer[param\_len] = '\0';+ param.buffer[param.len] = '\0';  /\* check if table name specified \*/- if ((param\_buffer[0] == '-' &&- param\_buffer[1] != '-' &&- strchr(param\_buffer, 't')) ||- (!strncmp(param\_buffer, "--t", 3) &&- !strncmp(param\_buffer, "--table", strlen(param\_buffer)))) {+ if ((param.buffer[0] == '-' &&+ param.buffer[1] != '-' &&+ strchr(param.buffer, 't')) ||+ (!strncmp(param.buffer, "--t", 3) &&+ !strncmp(param.buffer, "--table", strlen(param.buffer)))) { xtables\_error(PARAMETER\_PROBLEM, "The -t option (seen in line %u) cannot be used in %s.\n", line, xt\_params->program\_name); } - add\_argv(param\_buffer, 0);- param\_len = 0;+ add\_argv(param.buffer, 0);+ param.len = 0; } } |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.0](https://git-scm.com/)) at 2025-01-21 00:02:26 +0000


