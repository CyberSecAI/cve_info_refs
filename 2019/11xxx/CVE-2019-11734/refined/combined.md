=== Content from bugzilla.mozilla.org_c53432c3_20250121_025958.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1564481)
* [XML](/show_bug.cgi?ctype=xml&id=1564481)

Closed
[Bug 1564481](/show_bug.cgi?id=1564481)
(CVE-2019-11747)

Opened 6 years ago
Closed 6 years ago

# "Forget This Site" can override HSTS Preload List

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Forget This Site" can override HSTS Preload List

## Categories

### (Core :: Security: PSM, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20PSM#Security%3A%20PSM)

Security: PSM
▾

Core :: Security: PSM
The TLS configuration layer between Gecko and NSS. Handles certificate discovery, verification, and revocation checking.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20PSM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20PSM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20PSM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

68 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla70

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | [69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox69 | [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=verified) |
| firefox70 | [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 | 69+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox68 |  | wontfix |
| firefox69 | + | verified |
| firefox70 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: thenlich+bugmoz, Assigned: keeler)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [keeler](/user_profile?user_id=349244)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0b40ec03f7ea9e7d69f1cc10dc18af29?d=mm&size=40)  [thenlich+bugmoz](/user_profile?user_id=191487)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [keeler](/user_profile?user_id=349244)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1119778](/show_bug.cgi?id=1119778 "VERIFIED FIXED - Forget about this site does not clear HSTS setting")

## Details

### (Keywords: sec-low, Whiteboard: [psm-assigned][post-critsmash-triage][adv-main69+][adv-esr68.1+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-11747

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[psm-assigned][post-critsmash-triage][adv-main69+][adv-esr68.1+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs](/attachment.cgi?id=9078220)  [6 years ago](#c7)  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c16 "6 years ago") | [Details](/attachment.cgi?id=9078220&action=edit) | [Review](/attachment.cgi?id=9078220) |
| --- | --- | --- |
| [patch for esr68](/attachment.cgi?id=9079194)  [6 years ago](#c15)  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)   31.16 KB, patch | RyanVM : [approval-mozilla-esr68+](#c19 "6 years ago") | [Details](/attachment.cgi?id=9079194&action=edit) | [Diff](/attachment.cgi?id=9079194&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1564481&attachment=9079194) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1564481#c0)• 6 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

1. Opened a HSTS website (which was not in HSTS preload list) with Firefox 67
2. Get the domain included in HSTS preload list for Firefox 68
3. Upgrading to Firefox 68
4. Remove website from history ("Forget This Site")
5. Restart browser
6. Open http:// connection to the website

Actual results:

Connection is over http (unencrypted)

SiteSecurityServiceState.txt before step 4:

henlich.de:HSTS 1 18086 1594223236082,1,1,2

SiteSecurityServiceState.txt after step 5:

henlich.de:HSTS 1 18086 0,2,0,0

Expected results:

Connection should be upgraded to https, because domain is on HSTS preload list

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a1731_159069)• 6 years ago |

Component: Untriaged → Data SanitizationFlags: needinfo?(jhofmann)Product: Firefox → Toolkit

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1564481#c1)• 6 years ago |
|  | |

Seems to work on more domains:

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

1. Open the URL <https://hstspreload.org/> in Firefox 68
2. Remove this website from history ("Forget This Site")
3. Restart browser
4. Open <http://hstspreload.org/>

Actual results:

Connection is over http (unencrypted)

Expected results:

Connection should be upgraded to https, because domain is on HSTS preload list

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a137874_191487)• 6 years ago |

See Also: → [1119778](/show_bug.cgi?id=1119778 "VERIFIED FIXED - Forget about this site does not clear HSTS setting")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1564481#c2)• 6 years ago |
|  | |

jc: is HSTS and the pre-load of it part of the crypto team? or general "DOM: Security".

I'm surprised this overrides the pre-load list. Is that dynamically loaded from remote settings now? Maybe it regenerates after a period if you remove it in this way and that's "good enough"?

Group: firefox-core-security → dom-core-securityComponent: Data Sanitization → Security: PSMFlags: needinfo?(jjones)Product: Toolkit → Core

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1564481#c3)• 6 years ago |
|  | |

Looks like `ClearDataService.jsm` calls `nsISiteSecurityService.removeState`. I think the documentation is unclear about what this function actually does. Furthermore, it looks like it does the wrong thing. Currently it makes it so the given host is not considered HSTS (or HPKP), whereas what we actually want is to remove any indication that the user has interacted with that host, which for preloaded hosts means they will still be considered HSTS/HPKP.

Assignee: nobody → dkeelerFlags: needinfo?(jjones)Flags: needinfo?(jhofmann)Priority: -- → P1Whiteboard: [psm-assigned]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a191282_575867)• 6 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1564481#c4)• 6 years ago |
|  | |

Thanks for taking this, it would be great if we could have tests in the cleardata module that verify this.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1564481#c5)• 6 years ago |
|  | |

I'm going to call this sec-low, since it requires specific user action.

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1564481#c6)• 6 years ago |
|  | |

To reiterate: As described on <https://blog.mozilla.org/security/2012/11/01/preloading-hsts/> only under very specific circumstances should the browser behave as if the host were not on the preload list (max-age=0 --> knockout value). Manually removing a single website from history (<https://support.mozilla.org/en-US/kb/delete-browsing-search-download-history-firefox#w_remove-a-single-website-from-your-history>) is clearly not one of them - hence this bug.

Hopefully there are no other (exploitable) ways to trigger this behavior (which would allow an attacker to effectively disable HSTS preloading).

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1564481#c7)• 6 years ago |
|  | |

Attached file
[bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs](attachment.cgi?id=9078220)
— [Details](attachment.cgi?id=9078220&action=edit)

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1564481#c8)• 6 years ago |
|  | |

Side note:

parameter maxAge in nsSiteSecurityService::SetHSTSState() is defined as int64\_t, but called with uint64\_t maxAge.

ExpireTimeFromMaxAge() takes max-age value from header, casts it to int64\_t, multiplies by 1000, and adds it to timestamp in milliseconds.

There is potential for integer overflow (HSTS standard places no upper limit on max-age). A very large max-age is valid, should not result in expiry time in past, nor which is shorter than the largest max-age value which does not overflow.

HPKP is similar, but mitigated by the fact that max-age is capped at pref setting "security.cert\_pinning.max\_max\_age\_seconds".

Not sure what happens with negative values, e.g. "max-age=-1" (an invalid value), but this should be rejected.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1564481#c9)• 6 years ago |
|  | |

[Tracking Requested - why for this release]:

While this is sec-low, it seems worth tracking for ESR 68, as it is a problematic security hole.

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1564481#c10)• 6 years ago |
|  | |

(In reply to Thomas Henlich from [comment #8](/show_bug.cgi?id=1564481#c8 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List"))

> There is potential for integer overflow (HSTS standard places no upper limit on max-age). A very large max-age is valid, should not result in expiry time in past, nor which is shorter than the largest max-age value which does not overflow.
>
> [...]
>
> Not sure what happens with negative values, e.g. "max-age=-1" (an invalid value), but this should be rejected.

These are good tests to add. If not in this bug, then we should open a follow-on.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1564481#c11)• 6 years ago |
|  | |

Thanks - I filed [bug 1566558](/show_bug.cgi?id=1566558 "NEW - be more careful about integer type sizes in nsSiteSecurityService") (note that negative values are already rejected).

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1564481#c12)• 6 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/8c4446751c4ed37e1e3b3aa56ce20de7caffcf55>

<https://hg.mozilla.org/mozilla-central/rev/8c4446751c4e>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 6 years ago
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla70

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1564481#c13)• 6 years ago |
|  | |

Please nominate this for Beta & ESR68 approval when you get a chance.

[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox69](/buglist.cgi?f1=cf_tracking_firefox69&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B)Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1564481#c14)• 6 years ago |
|  | |

Comment on [attachment 9078220](/attachment.cgi?id=9078220 "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs") [[details]](/attachment.cgi?id=9078220&action=edit "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs")

[bug 1564481](/show_bug.cgi?id=1564481 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List") - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs

### Beta/Release Uplift Approval Request

* **User impact if declined**: Users that use "forget about this site" could temporarily disable HSTS for preloaded sites.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: 1. Visit a site on the HSTS preload list (e.g. <https://www.python.org>)

2. Open up the history panel (ctrl + h)
3. Find and select the site, right-click on it, select "forget about this site"
4. Wait a few seconds for that to finish
5. Close Firefox
6. Check that the SiteSecurityServiceState.txt file in the profile directory doesn't have an HSTS entry for that site in it ("www.python.org" in this case)

* **List of other uplifts needed**: none
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change is fairly localized, small, and it has test coverage.
* **String changes made/needed**: none
Flags: needinfo?(dkeeler)
[Attachment #9078220](/attachment.cgi?id=9078220&action=edit "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs") -
Flags: approval-mozilla-beta?

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a803515_349244)• 6 years ago |

Flags: qe-verify+

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1564481#c15)• 6 years ago |
|  | |

Attached patch

[patch for esr68](attachment.cgi?id=9079194&action=diff)
— [Details](attachment.cgi?id=9079194&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1564481&attachment=9079194)

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Users could temporarily disable HSTS for sites on the preload list if they use the "forget about this site" feature (there's also a bit of a privacy issue in that the user's profile can retain state from sites they told Firefox to "forget").
* **User impact if declined**: ^
* **Fix Landed on Version**: 70
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Small, localized change, has tests.
* **String or UUID changes made by this patch**: none
[Attachment #9079194](/attachment.cgi?id=9079194&action=edit "patch for esr68") -
Flags: approval-mozilla-esr68?

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a829148_553429)• 6 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1564481#c16)• 6 years ago |
|  | |

Comment on [attachment 9078220](/attachment.cgi?id=9078220 "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs") [[details]](/attachment.cgi?id=9078220&action=edit "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs")

[bug 1564481](/show_bug.cgi?id=1564481 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List") - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs

Avoids HSTS circumvention via the "Forget about this site" option. Approved for 69.0b7.

[Attachment #9078220](/attachment.cgi?id=9078220&action=edit "bug 1564481 - reset HSTS/HPKP state to factory settings rather than storing knockout entries for preloaded sites r?jcj,KevinJacobs") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1564481#c17)• 6 years ago |
|  | |

Reproduced this issue on Windows 10 with Nightly 70.0a1 from 07/15/2019.

Confirm the fix on latest Nightly 70.0a1, build ID 20190721215935. Verified on Window 10 x64, Mac OS 10.13.6 and Ubuntu 18.04.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=verified)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1564481#c18)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/fea8c86cd0d3>

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1564481#c19)• 5 years ago |
|  | |

Comment on [attachment 9079194](/attachment.cgi?id=9079194 "patch for esr68") [[details]](/attachment.cgi?id=9079194&action=edit "patch for esr68") [[diff]](/attachment.cgi?id=9079194&action=diff "patch for esr68") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1564481&attachment=9079194)
patch for esr68
Approved for 68.1esr also.
[Attachment #9079194](/attachment.cgi?id=9079194&action=edit "patch for esr68") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1564481#c20)• 5 years ago |
|  | |

Looks like the ESR68 patch needs rebasing, however.

Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1564481#c21)• 5 years ago |
| uplift | |

I'm confused - is this not landed on esr68 as <https://hg.mozilla.org/releases/mozilla-esr68/rev/030b03a32913becfdd6ba580d058a9f95ed478bf> ?

Flags: needinfo?(dkeeler)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1564481#c22)• 5 years ago |
|  | |

Yes, it landed with that. Sorry for not updating the bug.

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a2299383_458188)• 5 years ago |

Whiteboard: [psm-assigned] → [psm-assigned][post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1564481#c23)• 5 years ago |
|  | |

Verified as fixed on Beta 69.0b11 on Window 10 x64, Mac OS 10.13.6 and Ubuntu 18.04.

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=verified)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1564481#c24)• 5 years ago |
|  | |

Tested this bug on latest ESR 68.0.2esr, build ID 20190813155538 on Windows 10 and the issue is still reproducible. I followed the STR from [comment 14](/show_bug.cgi?id=1564481#c14 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List") and after step 6 the SiteSecurityServiceState.txt file in the profile directory contains a line with "www.python.org".

Am I missing any setting or something should go different on the ESR build?

Please note that I have retested on latest Beta 69.0b13 and here the bug is fixed.

Flags: needinfo?(dkeeler)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1564481#c25)• 5 years ago |
|  | |

This is fixed in 68.1esr, not 68.0.2esr.

Flags: needinfo?(dkeeler) → needinfo?(brindusa.tot)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1564481#c26)• 5 years ago |
|  | |

Thank you Ryan for clarification. Confirm the fix on esr build 68.1.0esr, build id 20190814122844.

Status: RESOLVED → VERIFIED
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(brindusa.tot)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a3742842_280903)• 5 years ago |

Alias: CVE-2019-11747Whiteboard: [psm-assigned][post-critsmash-triage] → [psm-assigned][post-critsmash-triage][adv-main69+][adv-esr68.1+]

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a4844749_191487)• 5 years ago |

Group: core-security

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a4844782_191487)• 5 years ago |

CC list accessible: falseNot accessible to reporter

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1564481#c27)• 5 years ago |
|  | |

(I'm assuming the sec group / CC list restrictions were accidental, as the person who filed it removed access to the bug from themselves, so I'm reverting them.)

Group: core-securityCC list accessible: trueAccessible to reporter

|  | [Thomas Henlich](/user_profile?user_id=191487)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1564481#c28)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #27](/show_bug.cgi?id=1564481#c27 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List"))

> (I'm assuming the sec group / CC list restrictions were accidental, as the person who filed it removed access to the bug from themselves, so I'm reverting them.)

My mistake. I intended to remove access restrictions but got confused and still can't figure it out. (Since Security Advisory 2019-25 is out there is no need to keep this confidential any more.)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1564481#c29)• 5 years ago |
|  | |

(In reply to Thomas Henlich from [comment #28](/show_bug.cgi?id=1564481#c28 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List"))

> (In reply to :Gijs (he/him) from [comment #27](/show_bug.cgi?id=1564481#c27 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List"))
>
> > (I'm assuming the sec group / CC list restrictions were accidental, as the person who filed it removed access to the bug from themselves, so I'm reverting them.)
>
> My mistake. I intended to remove access restrictions but got confused and still can't figure it out. (Since Security Advisory 2019-25 is out there is no need to keep this confidential any more.)

I'm afraid you likely don't have bugzilla privileges to alter which security groups the bug belongs to yourself.

esr60 is still supported until the next 68 esr release; I think we normally keep the bug hidden until there are no more supported releases with the problem. Al, can you confirm?

Flags: needinfo?(abillings)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1564481#c30)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #29](/show_bug.cgi?id=1564481#c29 "VERIFIED FIXED - \"Forget This Site\" can override HSTS Preload List"))

> I'm afraid you likely don't have bugzilla privileges to alter which security groups the bug belongs to yourself.

And, in fact, this is a purposeful decision. We generally open up bugs no less than 45 or 60 days following a release without a reason to do so sooner.

> esr60 is still supported until the next 68 esr release; I think we normally keep the bug hidden until there are no more supported releases with the problem. Al, can you confirm?

This is correct. We still support products affected by this bug. The soonest it will be opened is after the *next* full release of Firefox when 70 ships.

Flags: needinfo?(abillings)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1564481#a28653261_1689)• 5 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1564481&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_3d00b529_20250121_005026.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Mon Jan 20 2025 16:50:26 PST

* **Bug ID:**
  1352875,
  1536227,
  1557208,
  1560641

---

| [ID](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1560641](/show_bug.cgi?id=1560641 "RESOLVED FIXED - Intermittent mozrunner-startup | <test-name> | application crashed [@ nsWindow::LayerViewSupport::OnDetach(already_AddRefed<mozilla::Runnable>)::{lambda()#1}::operator()() const]") |  | [Intermittent mozrunner-startup | <test-name> | application crashed [@ nsWindow::LayerViewSupport::OnDetach(already\_AddRefed<mozilla::Runnable>)::{lambda()#1}::operator()() const]](/show_bug.cgi?id=1560641) | Core Graveyard | Widget: Android | etoop | RESO | FIXE | 2021-11-04 |
| [1557208](/show_bug.cgi?id=1557208 "RESOLVED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/LinkedList.h:288:12 in isInList") |  | [AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/LinkedList.h:288:12 in isInList](/show_bug.cgi?id=1557208) | Core | Graphics: WebRender | nical.bugzilla | RESO | FIXE | 2021-11-05 |
| [1352875](/show_bug.cgi?id=1352875 "RESOLVED FIXED - Crash in std::map<T>::_Try_emplace<T> called from TextureClientRecycleAllocator::CreateOrRecycle()") |  | [Crash in std::map<T>::\_Try\_emplace<T> called from TextureClientRecycleAllocator::CreateOrRecycle()](/show_bug.cgi?id=1352875) | Core | Graphics: Layers | nical.bugzilla | RESO | FIXE | 2020-12-18 |
| [1536227](/show_bug.cgi?id=1536227 "VERIFIED FIXED - Crash in [@ nsTArray_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]") |  | [Crash in [@ nsTArray\_Impl<T>::RemoveElement<T>(class `anonymous namespace'::ParentImpl\*& const, const class nsDefaultComparator<T>& const) | mozilla::a11y::DocAccessibleParent::RecvHideEvent]](/show_bug.cgi?id=1536227) | Core | Disability Access AP | jteh | VERI | FIXE | 2020-06-05 |

4 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1352875%2C1536227%2C1557208%2C1560641 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1352875%2C1536227%2C1557208%2C1560641&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |



=== Content from www.mozilla.org_bc08579c_20250121_005027.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-25

## Security vulnerabilities fixed in Firefox 69

Announced
September 3, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 69

#### [#CVE-2019-11751: Malicious code execution through command line parameters](#CVE-2019-11751)

Reporter
Ping Fan (Zetta) Ke of VXRL working with iDefense Labs
Impact
critical
##### Description

Logging-related command line parameters are not properly sanitized when Firefox is launched by another program, such as when a user clicks on malicious links in a chat application. This can be used to write a log file to an arbitrary location such as the Windows 'Startup' folder.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1572838](https://bugzilla.mozilla.org/show_bug.cgi?id=1572838)

#### [#CVE-2019-11746: Use-after-free while manipulating video](#CVE-2019-11746)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while manipulating video elements if the body is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1564449](https://bugzilla.mozilla.org/show_bug.cgi?id=1564449)

#### [#CVE-2019-11744: XSS by breaking out of title and textarea elements using innerHTML](#CVE-2019-11744)

Reporter
Rakesh Mane
Impact
high
##### Description

Some HTML elements, such as `<title>` and `<textarea>`, can contain literal angle brackets without treating them as markup. It is possible to pass a literal closing tag to `.innerHTML` on these elements, and subsequent content after that will be parsed as if it were outside the tag. This can lead to XSS if a site does not filter user input as strictly for these elements as it does for other elements.

##### References

* [Bug 1562033](https://bugzilla.mozilla.org/show_bug.cgi?id=1562033)

#### [#CVE-2019-11742: Same-origin policy violation with SVG filters and canvas to steal cross-origin images](#CVE-2019-11742)

Reporter
Paul Stone
Impact
high
##### Description

A same-origin policy violation occurs allowing the theft of cross-origin images through a combination of SVG filters and a `<canvas>` element due to an error in how same-origin policy is applied to cached image content. The resulting same-origin policy violation could allow for data theft.

##### References

* [Bug 1559715](https://bugzilla.mozilla.org/show_bug.cgi?id=1559715)

#### [#CVE-2019-11736: File manipulation and privilege escalation in Mozilla Maintenance Service](#CVE-2019-11736)

Reporter
Seb Patane
Impact
high
##### Description

The Mozilla Maintenance Service does not guard against files being hardlinked to another file in the `updates` directory, allowing for the replacement of local files, including the Maintenance Service executable, which is run with privileged access. Additionally, there was a race condition during checks for junctions and symbolic links by the Maintenance Service, allowing for potential local file and directory manipulation to be undetected in some circumstances. This allows for potential privilege escalation by a user with unprivileged local access.
*Note: These attacks requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1551913](https://bugzilla.mozilla.org/show_bug.cgi?id=1551913)
* [Bug 1552206](https://bugzilla.mozilla.org/show_bug.cgi?id=1552206)

#### [#CVE-2019-11753: Privilege escalation with Mozilla Maintenance Service in custom Firefox installation location](#CVE-2019-11753)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Firefox installer allows Firefox to be installed to a custom user writable location, leaving it unprotected from manipulation by unprivileged users or malware. If the Mozilla Maintenance Service is manipulated to update this unprotected location and the updated maintenance service in the unprotected location has been altered, the altered maintenance service can run with elevated privileges during the update process due to a lack of integrity checks. This allows for privilege escalation if the executable has been replaced locally.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1574980](https://bugzilla.mozilla.org/show_bug.cgi?id=1574980)

#### [#CVE-2019-11752: Use-after-free while extracting a key value in IndexedDB](#CVE-2019-11752)

Reporter
Zhanjia Song
Impact
high
##### Description

It is possible to delete an IndexedDB key value and subsequently try to extract it during conversion. This results in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1501152](https://bugzilla.mozilla.org/show_bug.cgi?id=1501152)

#### [#CVE-2019-9812: Sandbox escape through Firefox Sync](#CVE-2019-9812)

Reporter
Niklas Baumstark via TrendMicro's Zero Day Initiative
Impact
high
##### Description

Given a compromised sandboxed content process due to a separate vulnerability, it is possible to escape that sandbox by loading `accounts.firefox.com` in that process and forcing a log-in to a malicious Firefox Sync account. Preference settings that disable the sandbox are then synchronized to the local machine and the compromised browser would restart without the sandbox if a crash is triggered.

##### References

* [Bug 1538008](https://bugzilla.mozilla.org/show_bug.cgi?id=1538008)
* [Bug 1538015](https://bugzilla.mozilla.org/show_bug.cgi?id=1538015)

#### [#CVE-2019-11741: Isolate addons.mozilla.org and accounts.firefox.com](#CVE-2019-11741)

Reporter
Niklas Baumstark via TrendMicro's Zero Day Initiative
Impact
high
##### Description

A compromised sandboxed content process can perform a Universal Cross-site Scripting (UXSS) attack on content from any site it can cause to be loaded in the same process. Because `addons.mozilla.org` and `accounts.firefox.com` have close ties to the Firefox product, malicious manipulation of these sites within the browser can potentially be used to modify a user's Firefox configuration. These two sites will now be isolated into their own process and not allowed to be loaded in a standard content process.

##### References

* [Bug 1539595](https://bugzilla.mozilla.org/show_bug.cgi?id=1539595)

#### [#CVE-2019-11743: Cross-origin access to unload event attributes](#CVE-2019-11743)

Reporter
Yoav Weiss
Impact
moderate
##### Description

Navigation events were not fully adhering to the W3C's "Navigation-Timing Level 2" draft specification in some instances for the `unload` event, which restricts access to detailed timing attributes to only be same-origin. This resulted in potential cross-origin information exposure of history through timing side-channel attacks.

##### References

* [Bug 1560495](https://bugzilla.mozilla.org/show_bug.cgi?id=1560495)
* [Navigation-Timing Level 2 specification](https://w3c.github.io/navigation-timing)

#### [#CVE-2019-11748: Persistence of WebRTC permissions in a third party context](#CVE-2019-11748)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

WebRTC in Firefox will honor persisted permissions given to sites for access to microphone and camera resources even when in a third-party context. In light of recent high profile vulnerabilities in other software, a decision was made to no longer persist these permissions. This avoids the possibility of trusted WebRTC resources being invisibly embedded in web content and abusing permissions previously given by users. Users will now be prompted for permissions on each use.

##### References

* [Bug 1564588](https://bugzilla.mozilla.org/show_bug.cgi?id=1564588)

#### [#CVE-2019-11749: Camera information available without prompting using getUserMedia](#CVE-2019-11749)

Reporter
Andreas Pehrson
Impact
moderate
##### Description

A vulnerability exists in WebRTC where malicious web content can use probing techniques on the `getUserMedia` API using constraints to reveal device properties of cameras on the system without triggering a user prompt or notification. This allows for the potential fingerprinting of users.

##### References

* [Bug 1565374](https://bugzilla.mozilla.org/show_bug.cgi?id=1565374)

#### [#CVE-2019-5849: Out-of-bounds read in Skia](#CVE-2019-5849)

Reporter
Zhen Zhou of NSFOCUS Security Team
Impact
moderate
##### Description

An out-of-bounds read vulnerability exists in the Skia graphics library, allowing for the possible leaking of data from memory.

##### References

* [Bug 1555838](https://bugzilla.mozilla.org/show_bug.cgi?id=1555838)

#### [#CVE-2019-11750: Type confusion in Spidermonkey](#CVE-2019-11750)

Reporter
Qixun Zhao of Qihoo 360 Vulcan Team
Impact
moderate
##### Description

A type confusion vulnerability exists in Spidermonkey, which results in a non-exploitable crash.

##### References

* [Bug 1568397](https://bugzilla.mozilla.org/show_bug.cgi?id=1568397)

#### [#CVE-2019-11737: Content security policy directives ignore port and path if host is a wildcard](#CVE-2019-11737)

Reporter
Xiaoyin Liu
Impact
low
##### Description

If a wildcard ('\*') is specified for the host in Content Security Policy (CSP) directives, any port or path restriction of the directive will be ignored, leading to CSP directives not being properly applied to content.

##### References

* [Bug 1388015](https://bugzilla.mozilla.org/show_bug.cgi?id=1388015)

#### [#CVE-2019-11738: Content security policy bypass through hash-based sources in directives](#CVE-2019-11738)

Reporter
Wladimir Palant
Impact
low
##### Description

If a Content Security Policy (CSP) directive is defined that uses a hash-based source that takes the empty string as input, execution of any `javascript:` URIs will be allowed. This could allow for malicious JavaScript content to be run, bypassing CSP permissions.

##### References

* [Bug 1452037](https://bugzilla.mozilla.org/show_bug.cgi?id=1452037)

#### [#CVE-2019-11747: 'Forget about this site' removes sites from pre-loaded HSTS list](#CVE-2019-11747)

Reporter
Thomas Henlich
Impact
low
##### Description

The "Forget about this site" feature in the History pane is intended to remove all saved user data that indicates a user has visited a site. This includes removing any HTTP Strict Transport Security (HSTS) settings received from sites that use it. Due to a bug, sites on the pre-load list also have their HSTS setting removed. On the next visit to that site if the user specifies an `http:` URL rather than secure `https:` they will not be protected by the pre-loaded HSTS setting. After that visit the site's HSTS setting will be restored.

##### References

* [Bug 1564481](https://bugzilla.mozilla.org/show_bug.cgi?id=1564481)

#### [#CVE-2019-11734: Memory safety bugs fixed in Firefox 69](#CVE-2019-11734)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Randell Jesup, Philipp, Cosmin Sabou, and Natalia Csoregi reported memory safety bugs present in Firefox 68. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 69](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1352875%2C1557208%2C1560641)

#### [#CVE-2019-11758: Potentially exploitable crash due to 360 Total Security](#CVE-2019-11758)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developer Philipp reported a memory safety bug present in Firefox 68 when 360 Total Security was installed. This bug showed evidence of memory corruption in the accessibility engine and we presume that with enough effort that it could be exploited to run arbitrary code.

##### References

* [Bug 1536227](https://bugzilla.mozilla.org/show_bug.cgi?id=1536227)

#### [#CVE-2019-11735: Memory safety bugs fixed in Firefox 69 and Firefox ESR 68.1](#CVE-2019-11735)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Mikhail Gavrilov, Tyson Smith, Marcia Knous, Tom Ritter, Philipp, and Bob Owens reported memory safety bugs present in Firefox 68 and Firefox ESR 68. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 69 and Firefox ESR 68.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1561404%2C1561484%2C1568047%2C1561912%2C1565744%2C1568858%2C1570358)

#### [#CVE-2019-11740: Memory safety bugs fixed in Firefox 69, Firefox ESR 68.1, and Firefox ESR 60.9](#CVE-2019-11740)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Tyson Smith and Nathan Froyd reported memory safety bugs present in Firefox 68, Firefox ESR 68, and Firefox 60.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 69, Firefox ESR 68.1, and Firefox ESR 60.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1563133%2C1573160)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


