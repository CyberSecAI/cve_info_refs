```
{
  "CVE-2019-12210": {
    "Description": "In Yubico pam-u2f 1.0.7, when configured with debug and a custom debug log file is set using debug_file, that file descriptor is not closed when a new process is spawned. This leads to the file descriptor being inherited into the child process; the child process can then read from and write to it. This can leak sensitive information and also, if written to, be used to fill the disk or plant misinformation.",
    "Root cause": "The pam_u2f module, when configured to use a custom debug log file, does not set the close-on-exec flag on the file descriptor. This causes the file descriptor to be inherited by child processes spawned by the PAM-aware application.",
    "Weaknesses": [
      "File descriptor leak: The file descriptor for the custom debug log file is not closed before the module calls exec, which leads to the descriptor being inherited by child processes.",
       "Improper file descriptor handling: The module does not set the close-on-exec flag, which prevents the file descriptor from being leaked to child processes."
    ],
    "Impact": "A child process of an application using pam_u2f can read from and write to the inherited file descriptor, potentially leading to sensitive information disclosure, disk filling, or misinformation planting.",
    "Attack vectors": [
      "Exploiting the file descriptor leak requires that the pam_u2f debug option with debug_file is enabled. A malicious program can inherit the file descriptor and manipulate the log.",
       "Specifically, an attacker who can authenticate to the system using pam_u2f can then, by using a suid binary, potentially inherit the file descriptor. This allows a local attacker to write data to the specified debug file."
    ],
     "Required attacker capabilities/position": "An attacker needs to be able to authenticate using pam_u2f, and then execute some kind of binary which inherits the file descriptors opened by the pam module. This requires a local attacker with valid credentials on the system.",
    "Additional details": "The vulnerability can be triggered when the debug option is enabled in pam_u2f and a custom debug log file is specified using debug_file. The pam module will open the specified debug file in append mode but does not set the close-on-exec flag, and will not close the file descriptor before spawning child processes. The vulnerability exists in pam-u2f version 1.0.7."
  }
}
```