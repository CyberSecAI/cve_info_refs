- **Root cause of vulnerability:** The TTLock Smart Lock fails to properly revoke access permissions when a guest user's network connection is disabled, leading to a state inconsistency between the app and the lock.
- **Weaknesses/vulnerabilities present:**
    - Inconsistent state management: The lock's access control doesn't immediately reflect revocations when network connectivity is lost.
    - Lack of real-time revocation: The system relies on network connectivity to update access permissions, leaving a window of opportunity for unauthorized access.
    - Insufficient Bluetooth access control: The lock allows Bluetooth control even after access has been revoked, provided the user disconnected from the network before the revocation was sent by the lock owner.
- **Impact of exploitation:** A revoked guest user can continue to control the lock (lock/unlock) via Bluetooth, even though their access should have been terminated. This bypasses access control mechanisms.
- **Attack vectors:**
    - The attacker (revoked guest user) disables network access on their device, leaving only Bluetooth enabled.
    - The attacker attempts to control the lock via Bluetooth after their access was revoked.
- **Required attacker capabilities/position:**
    - The attacker must be a guest user of the lock.
    - The attacker must be granted access to the lock initially.
    - The attacker must have network connectivity to initially access the lock.
    - The attacker must have Bluetooth capability.
    - The attacker must disconnect from the network before the lock receives the revocation command.