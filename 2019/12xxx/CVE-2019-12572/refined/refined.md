```
{
  "vulnerability": {
    "CVE": "CVE-2019-12572",
    "summary": "The PIA Windows service (pia-service.exe) loads the OpenSSL library, which attempts to load the C:\\etc\\ssl\\openssl.cnf configuration file. A low privileged user can create this file and a malicious OpenSSL engine library, leading to arbitrary code execution as SYSTEM when the service starts.",
    "root_cause": "The OPENSSLDIR parameter was set to a path (C:\\etc\\ssl) that a low-privileged user can modify or create during the build of the OpenSSL libraries used by PIA.",
    "weaknesses": [
      "Insecure OPENSSLDIR configuration allowing low-privileged users to control the location of the openssl.cnf file.",
      "Unvalidated loading of external OpenSSL engine libraries specified within a configuration file."
    ],
    "impact": "Arbitrary code execution as SYSTEM.",
    "attack_vector": "Local file system manipulation.",
    "attacker_capabilities": "The attacker needs to be an authenticated local user with low privileges and be able to create files and directories in the root of the C drive. Reboot of the system or restart of the service is required.",
    "details": "The vulnerability occurs because the PIA Windows service loads the OpenSSL library from C:\\Program Files\\Private Internet Access\\libeay32.dll, which then tries to load the configuration file located at C:\\etc\\ssl\\openssl.cnf. Because low-privileged users can create directories under C:\\, they can create the 'etc\\ssl' folder and the openssl.cnf file, which, if configured maliciously, can lead to loading a malicious OpenSSL engine library. The vulnerability is triggered when the service starts up. The provided exploit creates a malicious DLL, ‘woot.dll’, and configures openssl.cnf to load this DLL as an OpenSSL engine. Upon service start, this DLL executes code to create a local administrator account named 'woot'. The OPENSSLDIR is set to “/etc/ssl”, which translates to c:\\etc\\ssl on Windows."
  }
}
```