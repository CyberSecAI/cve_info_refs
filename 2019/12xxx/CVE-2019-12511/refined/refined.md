```text
RELATED
```

### Vulnerability Details for CVE-2019-12511

**Title:** System command injection via SOAP API

**Source:** Independent Security Evaluators (ISE) SOHOpelessly Broken 2.0 report

**Affected Device:** NETGEAR Nighthawk X10 R9000

**Vulnerability:** System command injection

**Root Cause:** The SOAP API performs numerous calls to a shell, some of which contain user input. User input passes through "`AdvancedQoS:1#GetCurrentBandwidthByMAC`" via the "`NewDeviceMAC`" element without sufficient sanitization.

**Attack Vector:** By exploiting the command injection vulnerability in the SOAP API, an attacker can gain an interactive root shell.

**Prerequisites:**
1.  QoS and Advanced QoS services must be enabled.
2.  Authentication is required, but can be bypassed with the X-Forwarded-For bypass.

**Vulnerability Chains:**

1.  **X-Forwarded-For Authentication Bypass:** The "`X-Forwarded-For`" HTTP header is interpreted by the application, overriding the client's IP address. The device whitelists requests from its own IP address, allowing internal API use without authentication. This combination allows bypassing authentication checks on the SOAP API.
2.  **Enable QoS and Advanced QoS:** Using the authentication bypass, an attacker can enable QoS and Advanced QoS via SOAP requests.
3.  **Command Injection:** Inject commands via the "`NewDeviceMAC`" element in the "`AdvancedQoS:1#GetCurrentBandwidthByMAC`" SOAP API call.

**Limitations:**

*   No more than 17 characters may be used.
*   At least one colon must be included to prevent mangling.
*   A single-quote and meta-character must be used to break out of the existing command.
*   Parent command remnants after the injection point must be dealt with.
*   The payload must be in all-caps.

**Exploitation:** Despite the limitations, the report provides a fully-functional proof-of-concept (PoC) capable of spawning an unauthenticated bind shell on port 8383.

**Mitigation Bypass:** Even if the attacker is not on the LAN, the attack may be performed remotely via DNS rebinding.