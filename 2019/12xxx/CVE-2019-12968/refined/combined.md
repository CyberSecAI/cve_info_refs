=== Content from bitbucket.org_b5db6ee6_20250120_234604.html ===




=== Content from zandronum.com_4d35739c_20250120_234604.html ===

[![Zandronum](/res/Header_Nav_Trans.png)](/)

* [About](/)
* [Wiki](http://wiki.zandronum.com)
* [The Team](/credits)
* [Tracker](/tracker)
* [Forums](/forum)

* [Downloads](/download)

[Chat on our Discord Server](https://discord.gg/8QqxCBR)
[Get the latest version: 3.1
for Windows](/downloads/zandronum3.1-win32-installer.exe)

| Anonymous | [Login](/tracker/login_page.php?return=%2Ftracker%2Fview.php%3Fid%3D3660) | [Signup for a new account](/tracker/signup_page.php) | 2025-01-20 23:46 UTC | Project: All Projects Doomseeker Site Zandronum  [RSS](https://zandronum.com/tracker/issues_rss.php) |
| --- | --- | --- |

| [My View](/tracker/my_view_page.php) | [View Issues](/tracker/view_all_bug_page.php) | [Change Log](/tracker/changelog_page.php) | [Roadmap](/tracker/roadmap_page.php) | [Doomseeker Issue Support Ranking](/tracker/plugin.php?page=GaugeSupport/issue_ranking) | [Rules](/tracker/plugin.php?page=Rules/rules) | [My Account](/tracker/account_page.php) |  |
| --- | --- |

| View Issue Details [ [Jump to Notes](#bugnotes) ] | | | | [ [Issue History](view.php?id=3660&history=1#history) ] [ [Print](print_bug_page.php?bug_id=3660) ] | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| 0003660 | Doomseeker | [All Projects] Security | public | 2019-06-12 00:41 | 2019-07-31 15:19 |
|  | | | | | |
| Reporter | Pol M |  | | | |
| Assigned To | Pol M |  | | | |
| Priority | normal | Severity | crash | Reproducibility | have not tried |
| Status | closed | Resolution | fixed |  | |
| Platform |  | OS | OpenBSD | OS Version |  |
| Product Version | 1.2 |  | | | |
| Target Version |  | Fixed in Version | 1.3 |  | |
|  | | | | | |
| Summary | 0003660: SRB2 plugin: Mangled memory values (runtime crashes) | | | | |
| Description | [0003499:0020738](/tracker/view.php?id=3499#c20738 "0003499: [2019-06-09 21:03] Pol M"):  ***Quote from Pol M***I'm cross-posting relevant information related to SRB2, this comes from this [pr](https://bitbucket.org/Doomseeker/doomseeker/pull-requests/74/more-openbsd-issues-3654-the-srb2-thingy#comment-105023015):  Well, working on OpenBSD without the srb2 thing is a pain because 1/5 of the tries end up with a crash caused by srb2 (heck, pretty much all runtime crashes come from that, except for the exit crash). I decided to check for sizes across multiple platforms, and all of them have a header size of 84, and the final header has a size of 0. For some reason, in OpenBSD it has random gigantic sizes (1919905893, 1802265971, 1297293506, 1802265971 for example (in decimal)). All the instances encountered were over 0x0FFFFFFF with plenty of room, and while the header size may vary in the future, it won’t even get close to that.  The rest of the values (id, type, room) also get mangled: 0x35303239, 0x00000000 and 0x875b5553 vs the expected 0x32330000, 0x10000000, 0x000000ce, but I can’t tell how useful this info is.  [...]  I’ve been able to compile and run SRB2 without problems, and I can play online games. So, while probably OpenBSD is not supported, it can be used to play SRB2. | | | | |
|  | | | | | |
| Attached Files |  | | | | |
| |  |  |  |  | | --- | --- | --- | --- | | | | | | |

| - Relationships | |
| --- | --- |
| | parent of | [0003665](view.php?id=3665) | closed |  | Missing CVE Identifier for issue [0003660](/tracker/view.php?id=3660 "[closed] SRB2 plugin: Mangled memory values (runtime crashes)") (remote denial of service in SRB2 engine plugin) | | --- | --- | --- | --- | --- | | related to | [0003499](view.php?id=3499) | assigned | [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) | Port Doomseeker to OpenBSD | | |

| + Relationships |
| --- |

| -  Notes | |
| --- | --- |
| [User avatar](http://site.gravatar.com) ([0020755)](view.php?id=3660#c20755 "Direct link to note") [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) (developer)  2019-06-12 20:27 | This has been addressed. [commit](https://bitbucket.org/Doomseeker/doomseeker/commits/ae456aac888cb794ea3292f7f99cb87d6b22a555) Marking as needs testing |
|  | |
| [User avatar](http://site.gravatar.com) ([0020756)](view.php?id=3660#c20756 "Direct link to note") [Zalewa](https://zandronum.com/tracker/view_user_page.php?id=34) (developer)  2019-06-13 14:51 | This is still just a quick fix that will work most of the time but not at all times. When programming the plugin I've never assumed that the master server will be malicious - while this is not the case here, it essentially is from Doomseeker's perspective as the packets arrive mangled for some reason. The code should be more defensive to prevent malicious packets from crashing the program - always.  What will happen if the header.length is below the current threshold but still incorrect? This could be easily simulated even on a non-BSD system by hardcoding header.length = 0xffffff. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020762)](view.php?id=3660#c20762 "Direct link to note") [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) (developer)  2019-06-13 17:23 | Now that I think about it, we know the size based on the standard. It's: [code=src/plugins/srb2/srb2masterclient.cpp:138] QDataStream &operator>>(QDataStream &stream, ServerPayload &server) {     DataStreamOperatorWrapper out = DataStreamOperatorWrapper(&stream);      out.readRaw(16); // Header full of zeros.     server.rawIp(out.readRaw(16));     server.rawPort(out.readRaw(8));     server.name = Srb2::asciiOnly(out.readRaw(32));     server.room = out.readQInt32();     server.version = out.readRaw(8);      return stream; };  so that'd be 16+16+8+32+4+8=84 #quick maths. We could define a static and constant value in the ServerPayload class. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020764)](view.php?id=3660#c20764 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-06-14 04:13 edited on: 2019-06-14 04:14 | ***Quote from Zalewa***When programming the plugin I've never assumed that the master server will be malicious - while this is not the case here, it essentially is from Doomseeker's perspective as the packets arrive mangled for some reason. The code should be more defensive to prevent malicious packets from crashing the program - always.   If you know this to be an issue for other plugins, please report new issue(s) (for every affected plugin). Thanks. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020765)](view.php?id=3660#c20765 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-06-14 04:16 | On the note that this is remote denial of service, do we need to address this as a security issue with a CVE Identifier? |
|  | |
| [User avatar](http://site.gravatar.com) ([0020769)](view.php?id=3660#c20769 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-06-18 23:56 | (Increasing issue priority per comment [0003660:0020765](/tracker/view.php?id=3660#c20765 "0003660: [2019-06-14 04:16] WubTheCaptain") above.) |
|  | |
| [User avatar](http://site.gravatar.com) ([0020790)](view.php?id=3660#c20790 "Direct link to note") [Zalewa](https://zandronum.com/tracker/view_user_page.php?id=34) (developer)  2019-06-21 14:56 edited on: 2019-06-21 14:56 | The PR is merged here:'<https://bitbucket.org/Doomseeker/doomseeker/commits/b9a90f1f56e704c5cbeefe83da2f9ce939920278> [[^](https://bitbucket.org/Doomseeker/doomseeker/commits/b9a90f1f56e704c5cbeefe83da2f9ce939920278)]'  SRB2 servers are still being listed correctly (and SRB2Kart incorrectly) on Windows so I assume it works, however I'll put it into "needs to be tested" state just in case if someone wants to verify on the BSD platform where the problems were first encountered.  As far as CVE goes - that's bureaucracy and I don't feel like doing it.  Mangled packet problems that may or may not exist in other areas of the program are out of scope for this issue. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020792)](view.php?id=3660#c20792 "Direct link to note") [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) (developer)  2019-06-21 15:05 | Just to make this clear, this issue has nothing to do with the srb2kart player packages, the srb2kart playerlist is still brocken. It's an issue on their, it will be fixed in the next release and has already been patched. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020793)](view.php?id=3660#c20793 "Direct link to note") [Zalewa](https://zandronum.com/tracker/view_user_page.php?id=34) (developer)  2019-06-21 15:06 | Of course, by stating that SRB2Kart still works incorrectly I meant that this is expected. :) |
|  | |
| [User avatar](http://site.gravatar.com) ([0020795)](view.php?id=3660#c20795 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-06-21 21:13 | ***Quote from Zalewa***As far as CVE goes - that's bureaucracy and I don't feel like doing it.   I feel like giving it a try. Tracked as [0003665](/tracker/view.php?id=3665 "[closed] Missing CVE Identifier for issue #0003660 (remote denial of service in SRB2 engine plugin)").  It would be preferable to have a version bump for the SRB2 engine plugin, I'd guess. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020842)](view.php?id=3660#c20842 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-06-28 08:27 | Can you reproduce the issue in OP with compiler optimizations turned off (-O0 flag)? (I believe CMake's debug builds also disable optimizations.) |
|  | |
| [User avatar](http://site.gravatar.com) ([0020945)](view.php?id=3660#c20945 "Direct link to note") [WubTheCaptain](https://zandronum.com/tracker/view_user_page.php?id=874) (reporter)  2019-07-30 10:51 edited on: 2019-07-30 10:52 | FYI, this was mentioned to be "fixed" in Doomseeker 1.3 changelogs.  ***Quote***SRB2: Discard master server header replies that don't have the expected length declaration, thus preventing crashes when trying to read them. ([0003660](/tracker/view.php?id=3660 "[closed] SRB2 plugin: Mangled memory values (runtime crashes)")) |
|  | |
| [User avatar](http://site.gravatar.com) ([0020948)](view.php?id=3660#c20948 "Direct link to note") [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) (developer)  2019-07-30 11:13 edited on: 2019-07-31 15:19 | It is resolved, the reason this is open is because you asked for confirmation under a desired enviorment, which I cannot provide due to OpenBSD all of a sudden crashing Doomseeker at start since 6.5. I'll eventually find a workaround, I'm suspicious of the qt5 library.  EDIT: Turns out it was pledge all along. I'll be adding even more permissions. EDIT2: Confirmed to work, no crashes from the plugin under unnatural header sizes. |
|  | |
| [User avatar](http://site.gravatar.com) ([0020957)](view.php?id=3660#c20957 "Direct link to note") [Pol M](https://zandronum.com/tracker/view_user_page.php?id=926) (developer)  2019-07-31 15:19 | Moving directly to closed due to this being part of the 1.3 release. |
|  | |

| +  Notes | |
| --- | --- |

**Issue Community Support**
| **This issue is already marked as resolved.If you feel that is not the case, please reopen it and explain why.** | |
| Supporters: | No one explicitly supports this issue yet. |
| Opponents: | No one explicitly opposes this issue yet. |



=== Content from bitbucket.org_22b6d3ae_20250120_234604.html ===




=== Content from bitbucket.org_2a6e2bab_20250120_234603.html ===



