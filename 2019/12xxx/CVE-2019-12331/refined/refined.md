```
{
  "related": true,
  "summary": "The vulnerability is an XML External Entity (XXE) injection in PhpSpreadsheet versions prior to 1.8.0. It stems from the improper handling of XML parsing, specifically when processing the sheet1.xml file within an XLSX document. The vulnerability can be exploited by double encoding the XML payload to UTF-7, which bypasses the string check for '<!ENTITY', allowing an attacker to inject malicious XML entities.",
  "details": [
    {
      "type": "Root cause of vulnerability",
      "detail": "The root cause lies in the insufficient security measures applied to XML parsing within PhpSpreadsheet. The vulnerability is caused by a bypass of the intended fix for CVE-2018-19277. The fix intended to decode XML to UTF-8 but failed to prevent double encoded XML payloads using UTF-7. Additionally, the entity loader is disabled using `libxml_disable_entity_loader()` before security check, but is re-enabled before xml parsing."
    },
    {
      "type": "Weaknesses/vulnerabilities present",
      "detail": "The primary vulnerability is an XML External Entity (XXE) injection, which allows an attacker to include external entities within the XML documents. This can lead to various security issues, including denial-of-service (DoS), information disclosure, and potentially remote code execution if the parser is processing data from an untrusted source."
    },
    {
      "type": "Impact of exploitation",
      "detail": "Successful exploitation could allow an attacker to perform actions such as denial-of-service, information disclosure, or, in specific environments, remote code execution, by loading external DTDs."
    },
    {
      "type": "Attack vectors",
      "detail": "The attack vector involves crafting a malicious XLSX file containing a specially crafted sheet1.xml payload that exploits the XML parsing vulnerability. This payload includes an external entity definition that instructs the XML parser to fetch a remote DTD file."
    },
    {
      "type": "Required attacker capabilities/position",
      "detail": "An attacker needs to be able to create a malicious xlsx file with specific XML content. The attacker also needs to trick the user to open/parse this document."
    }
  ],
  "references": [
    "https://herolab.usd.de/en/security-advisories/usd-2019-0046/",
    "https://github.com/PHPOffice/PhpSpreadsheet/commit/0e6238c69e863b58aeece61e48ea032696c6dccd",
        "https://github.com/PHPOffice/PhpSpreadsheet/issues/1043",
        "https://phpspreadsheet.readthedocs.io/"
  ]
}
```