=== Content from seclists.org_b547ed8c_20250121_004241.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#50)
[![Next](/images/right-icon-16x16.png)](51)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#50)
[![Next](/images/right-icon-16x16.png)](1)

![](/shared/images/nst-icons.svg#search)

# [SYSS-2019-016] SquirrelMail script filter bypass/XSS (update)

---

*From*: Moritz Bechler <moritz.bechler () syss de>

*Date*: Thu, 25 Jul 2019 14:39:13 +0200

---

```
Advisory ID: SYSS-2019-016 (update 1)
Product: SquirrelMail
Manufacturer: The SquirrelMail Project
Affected Version(s): 1.4.22, SVN
Tested Version(s): SVN
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2019-04-17
Solution Date: 2019-07-24
Public Disclosure: 2019-07-01
CVE Reference: CVE-2019-12970
Author of Advisory: Moritz Bechler, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

SquirrelMail is a open-source webmail package.

The manufacturer describes the product as follows (see [1]):

"SquirrelMail is a standards-based webmail package written in PHP.
It includes built-in pure PHP support for the IMAP and SMTP protocols,
and all pages render in pure HTML 4.0 (with no JavaScript required)
for maximum compatibility across browsers.
It has very few requirements and is very easy to configure and install.
SquirrelMail has all the functionality you would want from an email
client, including strong MIME support, address books, and folder
manipulation."

Due to insufficient HTML sanitization, SquirrelMail is vulnerable to
Cross-Site-Scripting when viewing HTML mails.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

When viewing e-mails in HTML mode (not active by default) SquirrelMail
applies a custom sanitization step in an effort to remove possibly
malicious script and other content from the viewed e-mail.

Due to improper handling of RCDATA and RAWTEXT type elements, the HTML
parser used in this process shows differences compared to real user
agent behavior. Exploiting these differences JavaScript code can be
introduced which is not removed.

Due to the blacklisting nature of this mechnanism, multiple such element
types are allowed and not correctly handled, including the elements
<noembed>, <noframes>, <noscript> and <textarea>.

When using a construction like

<noembed>
<p title="</noembed><img src=x onerror=alert(1)>"></p>
</noembed>

SquirrelMail's parser will consider the included <img> tag as part
of the title attribute and therefore does not sanitize its contents.

However, correctly parsing this, the <noembed> element ends at the
first closing tag and the <img> tag is actual content.

This allows having otherwise forbidden elements and attributes,
including ones containing malicious JavaScript code.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

Send an HTML e-mail to a victim user:

attacker> mail -a "Content-type: text/html" -s "My little pony" \
        victim () example com <<EOD
<html><head></head><body>
<noscript>
<p title="</noscript><img src=x onerror=alert(1)>"></p>
</noscript>
</body></html>
EOD

Viewing the recieved e-mail in HTML format the following HTML code
is produced. This code is interpreted by common browsers in a way
that the <img> tag with its onerror handler is a regular tag,
and the embedded JavaScript code is executed.

<!-- begin sanitized html -->
<div class="bodyclass"><noscript><p title="</noscript>
<img src="SquirrelMail_files/x.html" onerror="alert(1)">"&gt;<p></p>
</div>

<!-- end sanitized html -->

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update to 1.4.23-svn/1.5.2-svn.
Disable HTML viewing of messages.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2019-04-03: Vulnerability discovered
2019-04-17: Vulnerability reported to manufacturer
2019-05-03: No response, second attempt to contact manufacturer
2019-07-01: No response, public disclosure of vulnerability
2019-07-21: Initial contact by developers
2019-07-24: Issue has been fixed, original reports were lost due to
            misconfiguration of security contact address

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for SquirrelMail
    <http://squirrelmail.org/>
[2] SySS Security Advisory SYSS-2019-016

<https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-016.txt>
[3] SySS Responsible Disclosure Policy
    <https://www.syss.de/en/news/responsible-disclosure-policy/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Moritz Bechler of SySS GmbH.

E-Mail: moritz.bechler () syss de
Public Key:
<https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Bechler.asc>
Key ID: 0x768EFE2BB3E53DDA
Key Fingerprint: 2C8F F101 9D77 BDE6 465E  CCC2 768E FE2B B3E5 3DDA

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: <http://creativecommons.org/licenses/by/3.0/deed.en>

```

**Attachment:
[smime.p7s](att-50/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

---

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#50)
[![Next](/images/right-icon-16x16.png)](51)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#50)
[![Next](/images/right-icon-16x16.png)](1)

### Current thread:

* [[SYSS-2019-016] SquirrelMail script filter bypass/XSS](0) *Moritz Bechler (Jul 01)*
  + **[SYSS-2019-016] SquirrelMail script filter bypass/XSS (update)** *Moritz Bechler (Jul 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.syss.de_aedd0b02_20250121_004242.html ===




=== Content from packetstormsecurity.com_013ef3fd_20250121_004238.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUTâ›” 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from seclists.org_a153620c_20250121_004241.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

![Previous](/images/left-icon-16x16.png)
[By Date](date.html#0)
[![Next](/images/right-icon-16x16.png)](1)

![Previous](/images/left-icon-16x16.png)
[By Thread](index.html#0)
[![Next](/images/right-icon-16x16.png)](50)

![](/shared/images/nst-icons.svg#search)

# [SYSS-2019-016] SquirrelMail script filter bypass/XSS

---

*From*: Moritz Bechler <moritz.bechler () syss de>

*Date*: Mon, 1 Jul 2019 09:51:33 +0200

---

```
Advisory ID: SYSS-2019-016
Product: SquirrelMail
Manufacturer: The SquirrelMail Project
Affected Version(s): 1.4.22, SVN
Tested Version(s): SVN
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2019-04-17
Solution Date: N/A
Public Disclosure: 2019-07-01
CVE Reference: CVE-2019-12970
Author of Advisory: Moritz Bechler, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

SquirrelMail is a open-source webmail package.

The manufacturer describes the product as follows (see [1]):

"SquirrelMail is a standards-based webmail package written in PHP.
It includes built-in pure PHP support for the IMAP and SMTP protocols,
and all pages render in pure HTML 4.0 (with no JavaScript required)
for maximum compatibility across browsers.
It has very few requirements and is very easy to configure and install.
SquirrelMail has all the functionality you would want from an email
client, including strong MIME support, address books, and folder
manipulation."

Due to insufficient HTML sanitization SquirrelMail is vulnerable to
Cross-Site-Scripting when viewing HTML mails.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

When viewing e-mails in HTML mode (not active by default) SquirrelMail
applies a custom sanitization step in an effort to remove possibly
malicious script and other content from the viewed e-mail.

Due to improper handling of RCDATA and RAWTEXT type elements, the HTML
parser used in this process shows differences compared to real user
agent behavior. Exploiting these differences JavaScript code can be
introduced which is not removed.

Due to the blacklisting nature of this mechnanism multiple such element
types are allowed and not correctly handled, including the elements
noembed, noframes, noscript and textarea.

When using a construction like

<noembed>
<p title="</noembed><img src=x onerror=alert(1)>"></p>
</noembed>

SquirrelMail's parser will consider the included <img> tag as part
of the title attribute and therefore does not sanitize it's contents.

However, correctly parsing this, the <noembed> element ends at the
first closing tag and the <img> tag is actual content.

This allows having otherwise forbidden elements and attributes,
including ones containing malicious JavaScript code.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

Send a HTML email to a victim user:

attacker> mail -a "Content-type: text/html" -s "My little pony" \
        victim () example com <<EOD
<html><head></head><body>
<noscript>
<p title="</noscript><img src=x onerror=alert(1)>"></p>
</noscript>
</body></html>
EOD

Viewing the recieved e-mail in HTML format the following HTML code
is produced. This code is interpreted by common browsers in a way
that the <img> tag with it's onerror handler is a regular tag,
and the embedded JavaScript code is executed.

<!-- begin sanitized html -->
<div class="bodyclass"><noscript><p title="</noscript>
<img src="SquirrelMail_files/x.html" onerror="alert(1)">"&gt;<p></p>
</div>

<!-- end sanitized html -->

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Avoid Squirrelmail, as it appears to be unmaintained.
Disable HTML viewing of messages.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2019-04-03: Vulnerability discovered
2019-04-17: Vulnerability reported to manufacturer
2019-05-03: No response, second attempt to contact manufacturer
2019-07-01: No response, public disclosure of vulnerability

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for SquirrelMail
    <http://squirrelmail.org/>
[2] SySS Security Advisory SYSS-2019-016

<https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-016.txt>
[3] SySS Responsible Disclosure Policy
    <https://www.syss.de/en/news/responsible-disclosure-policy/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Moritz Bechler of SySS GmbH.

E-Mail: moritz.bechler () syss de
Public Key:
<https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Bechler.asc>
Key ID: 0x768EFE2BB3E53DDA
Key Fingerprint: 2C8F F101 9D77 BDE6 465E  CCC2 768E FE2B B3E5 3DDA

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: <http://creativecommons.org/licenses/by/3.0/deed.en>

```

**Attachment:
[signature.asc](att-0/signature_asc.bin)**

*Description:* OpenPGP digital signature

---

![Previous](/images/left-icon-16x16.png)
[By Date](date.html#0)
[![Next](/images/right-icon-16x16.png)](1)

![Previous](/images/left-icon-16x16.png)
[By Thread](index.html#0)
[![Next](/images/right-icon-16x16.png)](50)

### Current thread:

* **[SYSS-2019-016] SquirrelMail script filter bypass/XSS** *Moritz Bechler (Jul 01)*
  + [[SYSS-2019-016] SquirrelMail script filter bypass/XSS (update)](50) *Moritz Bechler (Jul 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.debian.org_284a8756_20250121_004239.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 1868-1] squirrelmail security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1868-1] squirrelmail security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Thu, 1 Aug 2019 14:55:45 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20190801125545.p5jbtdavqlerreqz%40mail.beuc.net)Â [20190801125545.p5jbtdavqlerreqz@mail.beuc.net](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : squirrelmail
Version        : 2:1.4.23~svn20120406-2+deb8u4
CVE ID         : CVE-2019-12970

A XSS vulnerability was discovered in SquirrelMail.  Due to improper
handling of RCDATA and RAWTEXT type elements, the built-in
sanitization mechanism can be bypassed.  Malicious script content from
HTML e-mails can be executed within the application context via
crafted use of (for example) a NOEMBED, NOFRAMES, NOSCRIPT, or
TEXTAREA element.

For Debian 8 "Jessie", this problem has been fixed in version
2:1.4.23~svn20120406-2+deb8u4.

We recommend that you upgrade your squirrelmail packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEQic8GuN/xDR88HkSj/HLbo2JBZ8FAl1C4F8ACgkQj/HLbo2J
BZ/kBggAmwy9ffidiiylbERfzs/mMJS+5vQvAN3UomC30ZyHSXkQp1gWFxxWmAUG
bEyP7tvjqvRZRy69Ltmn1YIDrL7Vp5/Ub4ese6Jq3KO905mwjaA67Yy5EizQNluf
CITss1tlGTIq9ip1khYWomFmv25gwDpwyKVP/LCR4gtdTlCsAeq7sdAgGpkJG/Rv
ZSkS4USD6vnNJuyVDwERGYTYdo2A795DlRB/OI9mV4kwtOl0Xxpl/z0X0I/3USP5
sOZNW1w022/J4pwcoqR7hFsU5f2nNu04YdxUfAs7uh0qBoAJxxcGJNHBhjMUqlt7
GJJYlyZw1XfvVU5n5ToQCTsFMLqe5w==
=RxBX
-----END PGP SIGNATURE-----

```

---


