=== Content from bugs.debian.org_f1d8e847_20250121_001118.html ===

# Debian Bug report logs - #939937 libapreq2: CVE-2019-12412: Remotely exploitable null pointer dereference bug

[![version graph](version.cgi?absolute=0;height=2;found=libapreq2%2F2.13-5;fixed=libapreq2%2F2.13-6;fixed=libapreq2%2F2.13-7~deb10u1;fixed=libapreq2%2F2.13-7~deb9u1;package=libapreq2-3;width=2;collapse=1)](version.cgi?fixed=libapreq2%2F2.13-6;fixed=libapreq2%2F2.13-7~deb10u1;fixed=libapreq2%2F2.13-7~deb9u1;collapse=1;package=libapreq2-3;info=1;absolute=0;found=libapreq2%2F2.13-5)

Package:
[libapreq2-3](pkgreport.cgi?package=libapreq2-3);
Maintainer for [libapreq2-3](pkgreport.cgi?package=libapreq2-3) is [Debian QA Group <packages@qa.debian.org>](pkgreport.cgi?maint=packages%40qa.debian.org); Source for [libapreq2-3](pkgreport.cgi?package=libapreq2-3) is [src:libapreq2](pkgreport.cgi?src=libapreq2) ([PTS](https://tracker.debian.org/pkg/libapreq2), [buildd](https://buildd.debian.org/libapreq2), [popcon](https://qa.debian.org/popcon.php?package=libapreq2)).

Reported by: [Max Kellermann <max@blarg.de>](pkgreport.cgi?submitter=max%40blarg.de)

Date: Tue, 10 Sep 2019 10:33:02 UTC

Severity: *grave*

Tags: security, upstream

Found in version libapreq2/2.13-5

Fixed in versions libapreq2/2.13-6, libapreq2/2.13-7~deb10u1, libapreq2/2.13-7~deb9u1

**Done:** Salvatore Bonaccorso <carnil@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=939937;mbox=yes), [status mbox](bugreport.cgi?bug=939937;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=939937;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Steinar H. Gunderson <sesse@debian.org>`:

`Bug#939937`; Package `libapreq2-3`.
(Tue, 10 Sep 2019 10:33:03 GMT) ([full text](bugreport.cgi?bug=939937;msg=2), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Max Kellermann <max@blarg.de>`:

New Bug report received and forwarded. Copy sent to `Steinar H. Gunderson <sesse@debian.org>`.
(Tue, 10 Sep 2019 10:33:04 GMT) ([full text](bugreport.cgi?bug=939937;msg=4), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=5), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=max%40blarg.de)
From: Max Kellermann <max@blarg.de>
To: submit@bugs.debian.org
Subject: Remotely exploitable null pointer dereference bug
Date: Tue, 10 Sep 2019 12:23:04 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=939937;msg=5) (text/plain, inline)]
```
```
Package: libapreq2-3
Version: 2.13-5+b3
Severity: grave

libapreq's multipart parser can be made dereference the null pointer
by issuing a simple CURL command:

 curl <http://a/b> -F 'foo=bar;type=multipart/dummy'

This POSTs a "multipart/form-data" body where one part has the
Content-Type "multipart/dummy" (i.e. a nested "multipart"), which
enables this branch:

 if (ct != NULL && strncmp(ct, "multipart/", 10) == 0) {

 <https://github.com/apache/apreq/blob/v2_13/library/parser_multipart.c#L401>

Later, this calls create_multipart_context() and dereferences the
returned pointer (without checking it):

 next_ctx = create_multipart_context(...
 next_ctx->param_name = "";

 <https://github.com/apache/apreq/blob/v2_13/library/parser_multipart.c#L409-L414>

The function create_multipart_context() however can return NULL if
there is no "boundary" attribute.  And omitting "boundary" is what my
CURL command does.

With this simple exploit, I can remotely crash any process which uses
libapreq2 only by issuing an invalid nested "multipart" body.  Since
this bug is remotely exploitable, I decided to set "grave" severity.

This bug affects all libapreq2 versions ever shipped in Debian, and
was introduced by SVN commit 227276 in 2005.  Prior to this commit,
there was a NULL check, but the commit removed it:

 <http://svn.apache.org/viewvc/httpd/apreq/trunk/library/parser_multipart.c?r1=227276&r2=227275&pathrev=227276>

The attached patch fixes the bug by re-adding the NULL check.

```
```
[[apreq2_nested_multipart_null_dereference.patch](bugreport.cgi?att=1;bug=939937;filename=apreq2_nested_multipart_null_dereference.patch;msg=5) (text/x-diff, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Steinar H. Gunderson <sesse@debian.org>`:

`Bug#939937`; Package `libapreq2-3`.
(Wed, 11 Sep 2019 10:45:10 GMT) ([full text](bugreport.cgi?bug=939937;msg=7), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Max Kellermann <max@blarg.de>`:

Extra info received and forwarded to list. Copy sent to `Steinar H. Gunderson <sesse@debian.org>`.
(Wed, 11 Sep 2019 10:45:10 GMT) ([full text](bugreport.cgi?bug=939937;msg=9), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 939937@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=10), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=max%40blarg.de)
From: Max Kellermann <max@blarg.de>
To: 939937@bugs.debian.org
Subject: Re: Bug#939937: Acknowledgement (Remotely exploitable null pointer
dereference bug)
Date: Wed, 11 Sep 2019 12:36:03 +0200
```
I committed my patch to libapreq's Subversion repository:

 <http://svn.apache.org/viewvc?view=revision&revision=1866760>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Steinar H. Gunderson <sesse@debian.org>`:

`Bug#939937`; Package `libapreq2-3`.
(Thu, 12 Sep 2019 08:54:07 GMT) ([full text](bugreport.cgi?bug=939937;msg=12), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `"Steinar H. Gunderson" <sesse@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Steinar H. Gunderson <sesse@debian.org>`.
(Thu, 12 Sep 2019 08:54:07 GMT) ([full text](bugreport.cgi?bug=939937;msg=14), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 939937@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=15), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=sesse%40debian.org)
From: "Steinar H. Gunderson" <sesse@debian.org>
To: Max Kellermann <max@blarg.de>, 939937@bugs.debian.org
Subject: Re: Bug#939937: Acknowledgement (Remotely exploitable null pointer
dereference bug)
Date: Thu, 12 Sep 2019 10:14:23 +0200
```
On Wed, Sep 11, 2019 at 12:36:03PM +0200, Max Kellermann wrote:
> I committed my patch to libapreq's Subversion repository:
>
>  <http://svn.apache.org/viewvc?view=revision&revision=1866760>

Thanks! I'll make an upload to unstable when I get the time, but I guess the
security team should do one for stable. TBH I don't know how this process
works currently; perhaps security-team@ should be involved?

/* Steinar */
--
Homepage: <https://www.sesse.net/>

```

---

**Reply sent**
to `sesse@debian.org (Steinar H. Gunderson)`:

You have taken responsibility.
(Sun, 15 Sep 2019 17:09:11 GMT) ([full text](bugreport.cgi?bug=939937;msg=17), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=17), [link](#16)).

---

**Notification sent**
to `Max Kellermann <max@blarg.de>`:

Bug acknowledged by developer.
(Sun, 15 Sep 2019 17:09:11 GMT) ([full text](bugreport.cgi?bug=939937;msg=19), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 939937-close@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=20), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=sesse%40debian.org)
From: sesse@debian.org (Steinar H. Gunderson)
To: 939937-close@bugs.debian.org
Subject: Bug#939937: fixed in libapreq2 2.13-6
Date: Sun, 15 Sep 2019 17:04:36 +0000
```
Source: libapreq2
Source-Version: 2.13-6

We believe that the bug you reported is fixed in the latest version of
libapreq2, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 939937@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Steinar H. Gunderson <sesse@debian.org> (supplier of updated libapreq2 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 15 Sep 2019 18:26:40 +0200
Source: libapreq2
Binary: libapache2-mod-apreq2 libapache2-mod-apreq2-dbgsym libapache2-request-perl libapache2-request-perl-dbgsym libapreq2-3 libapreq2-3-dbgsym libapreq2-dev libapreq2-doc
Architecture: source amd64 all
Version: 2.13-6
Distribution: unstable
Urgency: high
Maintainer: Steinar H. Gunderson <sesse@debian.org>
Changed-By: Steinar H. Gunderson <sesse@debian.org>
Description:
 libapache2-mod-apreq2 - generic Apache request library - Apache module
 libapache2-request-perl - generic Apache request library - Perl modules
 libapreq2-3 - generic Apache request library
 libapreq2-dev - generic Apache request library - development files
 libapreq2-doc - generic Apache request library - documentation
Closes: [939937](bugreport.cgi?bug=939937)
Changes:
 libapreq2 (2.13-6) unstable; urgency=high
 .
   * 05-nested-multipart-null-dereference.patch: New patch by
     Max Kellermann, fixes a NULL pointer dereference bug with nested
     multipart form submission. (Closes: #[939937](bugreport.cgi?bug=939937))
Checksums-Sha1:
 36d1ac87dacf867c4277776b2ee108a23485870e 2144 libapreq2_2.13-6.dsc
 b0801caba43ebbed669fd13ad4e9ef7b41f990d7 8920 libapreq2_2.13-6.debian.tar.xz
 df6bea9420ae4dd9d312a23ce79b190dc2e9eae5 31268 libapache2-mod-apreq2-dbgsym_2.13-6_amd64.deb
 5d238d45a467fc14fd65467c3a81614f40208f42 56336 libapache2-mod-apreq2_2.13-6_amd64.deb
 cb9f97a753dc496b09a6d3dcc7a39f45dc350f0b 350128 libapache2-request-perl-dbgsym_2.13-6_amd64.deb
 8bd91f384edcaebbc0d9a8c433619ee646d3d8dc 69136 libapache2-request-perl_2.13-6_amd64.deb
 149fc2892cb888f231624936c026e572cf602802 84532 libapreq2-3-dbgsym_2.13-6_amd64.deb
 3bd7950dbc1dc3a17a16ab519ab34d4e1bac89e7 41192 libapreq2-3_2.13-6_amd64.deb
 305167fa7622fd2b376dea1d7eb4a48aad216b63 60432 libapreq2-dev_2.13-6_amd64.deb
 fe508ad63bc6a2316c70ba8f1ccf2970affe9da2 147712 libapreq2-doc_2.13-6_all.deb
 43e940fb5148afba3cc5c71c25b3469be5ebbb40 9620 libapreq2_2.13-6_amd64.buildinfo
Checksums-Sha256:
 9c9acc1751f14401c39bd279e6df268ce0999c45c4c3738359a0debbcc1a2e73 2144 libapreq2_2.13-6.dsc
 c45c882393b4f3989a449d7ed57b446f4e8d6b7015fc481d45f0d46368b8292d 8920 libapreq2_2.13-6.debian.tar.xz
 b2773e9f1fc589528943697be881e2c48b0ceb3b7df4607a45fc3add31c54f01 31268 libapache2-mod-apreq2-dbgsym_2.13-6_amd64.deb
 a1bcb19e5c2e1a37e54bcb51ce85744e85f2e23a2aaf8fe7f4a64766df11faee 56336 libapache2-mod-apreq2_2.13-6_amd64.deb
 224e766de6002a639d26852ebd83ae027d8273f92782409f1259f42d08832b60 350128 libapache2-request-perl-dbgsym_2.13-6_amd64.deb
 1200fd39b0cfc1770a5ad8b0c2e519e63b1ac93cef754bd3ae3bc9116520308e 69136 libapache2-request-perl_2.13-6_amd64.deb
 3fad854a32bacc26b7765140e9e1a859abd888eecfe513a36d0e4cfa0ee4503a 84532 libapreq2-3-dbgsym_2.13-6_amd64.deb
 71fd4702e2d0eb7af643fa6bda33fd6202ab41ebd6f72cce287c3c96153dc32f 41192 libapreq2-3_2.13-6_amd64.deb
 96701985596a0066e63444e3604868365338f9315aab9e79c6ab877b21c9e7a2 60432 libapreq2-dev_2.13-6_amd64.deb
 0c9c745e0a0db149bc23b703936ed364b7d2a9d3fbfac0bba46c29543d0e7265 147712 libapreq2-doc_2.13-6_all.deb
 672e2fed00ce49c9bbc9fed77c9112163bc3f2e0ec6377d1357f9024e1ee1ed9 9620 libapreq2_2.13-6_amd64.buildinfo
Files:
 59a36bfd879a768906c37fbc63f6e23f 2144 perl optional libapreq2_2.13-6.dsc
 7a3263d561c1c6bae73729f0b07fc346 8920 perl optional libapreq2_2.13-6.debian.tar.xz
 69517dd6f82b24b6a7b5c5e6c0d64b46 31268 debug optional libapache2-mod-apreq2-dbgsym_2.13-6_amd64.deb
 a24aff6e189a3c331c5b838be0a10bd2 56336 web optional libapache2-mod-apreq2_2.13-6_amd64.deb
 9e51dd678f7dd305fad87981550ce38a 350128 debug optional libapache2-request-perl-dbgsym_2.13-6_amd64.deb
 560b7f28273d014a4bc69c10d7aab4c6 69136 perl optional libapache2-request-perl_2.13-6_amd64.deb
 41ff57956fb9d9e61bb6b774c923b8a6 84532 debug optional libapreq2-3-dbgsym_2.13-6_amd64.deb
 1c88b102977699d1fce8658ee4fe0742 41192 libs optional libapreq2-3_2.13-6_amd64.deb
 13f0e6f30987a9903757ce2c64909f13 60432 libdevel optional libapreq2-dev_2.13-6_amd64.deb
 85e0b15adab155f267208697fadcbdc5 147712 doc optional libapreq2-doc_2.13-6_all.deb
 6466c223b4eaebaa7c8a3ae6e9ef6e63 9620 perl optional libapreq2_2.13-6_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwukAT/AowY5OrduDf2F1YXeXj3YFAl1+aUMACgkQf2F1YXeX
j3YSUhAAq5c6s8MPnBc0AFmmK0z/DLuoz0S3P6E50tqY4c45QAGoS6hUwPz3oEmM
7NYQoP9BuH1By7GCaSVVQgR9j7IP7JnhO+2Npe+meqvz4z5oj5mglu0djA1I8HZV
8Yt8EMPwZH8Wg1SGxp/epR4r7l1kZBcuTdB6TKLXss+TfR5sencIfCMsw58jTpuZ
KxLaX12kPKu6lApbZAIYtA2wn3RB1zbPwrsHPyj7GCe5lakMhpDgKBFGwmnwXp5F
2AdI3bxq/I/2doRTVtwf2U8OnmraNZJN1fjcQivyZhVLBG3rsA1pNPp115E8CbaK
ojBpxFjVpSjov2kh1jHlNqgx0d6zw6EWqQN2WX+ZXFGcMbsi6p5+y2k2SL5I7sGA
cYwDq4i2T1nM8QcnAlr0wYifxXVYBtqdvajuITIE0MtvxxKlAnPKATrf5iJhqpoY
7gbwzUi7mgsU6KHqRFSmkiLH/T5iYNMxadqwt9bFgRfRweX/qEZiQxGxKDTJbNre
wq27q29GenusSoErCmPfFznx0ps9RbBejEzTFx4sY6mdoCm+kOn+FOQFoQ3CAWBJ
tIZ18eQZmqUlPEmtE8aH7vakGkliXn5+AEdPR1qR8zLyFBd6WRnz0+4gXmP1zen3
yR8hdHDzIhYeJkwef5FDVvN9RnE8I4Lp20dNn+mczTxmzvqg1VY=
=Seid
-----END PGP SIGNATURE-----

```

---

**Added tag(s) upstream and security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sun, 15 Sep 2019 20:51:03 GMT) ([full text](bugreport.cgi?bug=939937;msg=22), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=22), [link](#21)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Steinar H. Gunderson <sesse@debian.org>`:

`Bug#939937`; Package `libapreq2-3`.
(Mon, 30 Sep 2019 10:51:09 GMT) ([full text](bugreport.cgi?bug=939937;msg=24), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Steinar H. Gunderson <sesse@debian.org>`.
(Mon, 30 Sep 2019 10:51:09 GMT) ([full text](bugreport.cgi?bug=939937;msg=26), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 939937@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=27), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Max Kellermann <max@blarg.de>, 939937@bugs.debian.org
Cc: Apache Security Team <security@apache.org>
Subject: Re: Bug#939937: Remotely exploitable null pointer dereference bug
Date: Mon, 30 Sep 2019 12:49:00 +0200
```
Hi

On Tue, Sep 10, 2019 at 12:23:04PM +0200, Max Kellermann wrote:
> Package: libapreq2-3
> Version: 2.13-5+b3
> Severity: grave
>
> libapreq's multipart parser can be made dereference the null pointer
> by issuing a simple CURL command:
>
>  curl <http://a/b> -F 'foo=bar;type=multipart/dummy'
>
> This POSTs a "multipart/form-data" body where one part has the
> Content-Type "multipart/dummy" (i.e. a nested "multipart"), which
> enables this branch:
>
>  if (ct != NULL && strncmp(ct, "multipart/", 10) == 0) {
>
>  <https://github.com/apache/apreq/blob/v2_13/library/parser_multipart.c#L401>
>
> Later, this calls create_multipart_context() and dereferences the
> returned pointer (without checking it):
>
>  next_ctx = create_multipart_context(...
>  next_ctx->param_name = "";
>
>  <https://github.com/apache/apreq/blob/v2_13/library/parser_multipart.c#L409-L414>
>
> The function create_multipart_context() however can return NULL if
> there is no "boundary" attribute.  And omitting "boundary" is what my
> CURL command does.
>
> With this simple exploit, I can remotely crash any process which uses
> libapreq2 only by issuing an invalid nested "multipart" body.  Since
> this bug is remotely exploitable, I decided to set "grave" severity.
>
> This bug affects all libapreq2 versions ever shipped in Debian, and
> was introduced by SVN commit 227276 in 2005.  Prior to this commit,
> there was a NULL check, but the commit removed it:
>
>  <http://svn.apache.org/viewvc/httpd/apreq/trunk/library/parser_multipart.c?r1=227276&r2=227275&pathrev=227276>
>
> The attached patch fixes the bug by re-adding the NULL check.

This issue has been assigned [CVE-2019-12412](https://security-tracker.debian.org/tracker/CVE-2019-12412).

Regards,
Salvatore

```

---

**Changed Bug title to 'libapreq2: CVE-2019-12412: Remotely exploitable null pointer dereference bug' from 'Remotely exploitable null pointer dereference bug'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 01 Oct 2019 21:15:06 GMT) ([full text](bugreport.cgi?bug=939937;msg=29), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=29), [link](#28)).

---

**Reply sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

You have taken responsibility.
(Sat, 05 Oct 2019 12:36:10 GMT) ([full text](bugreport.cgi?bug=939937;msg=31), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=31), [link](#30)).

---

**Notification sent**
to `Max Kellermann <max@blarg.de>`:

Bug acknowledged by developer.
(Sat, 05 Oct 2019 12:36:11 GMT) ([full text](bugreport.cgi?bug=939937;msg=33), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=33), [link](#32)).

---

[Message #34](#34) received at 939937-close@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=34), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=34), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 939937-close@bugs.debian.org
Subject: Bug#939937: fixed in libapreq2 2.13-7~deb10u1
Date: Sat, 05 Oct 2019 12:32:09 +0000
```
Source: libapreq2
Source-Version: 2.13-7~deb10u1

We believe that the bug you reported is fixed in the latest version of
libapreq2, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 939937@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Salvatore Bonaccorso <carnil@debian.org> (supplier of updated libapreq2 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 02 Oct 2019 09:46:50 +0200
Source: libapreq2
Architecture: source
Version: 2.13-7~deb10u1
Distribution: buster-security
Urgency: high
Maintainer: Steinar H. Gunderson <sesse@debian.org>
Changed-By: Salvatore Bonaccorso <carnil@debian.org>
Closes: [939937](bugreport.cgi?bug=939937)
Changes:
 libapreq2 (2.13-7~deb10u1) buster-security; urgency=high
 .
   * Non-maintainer upload by the Security Team.
   * Rebuild for buster-security
 .
 libapreq2 (2.13-7) unstable; urgency=high
 .
   * Source-only upload.
 .
 libapreq2 (2.13-6) unstable; urgency=high
 .
   * 05-nested-multipart-null-dereference.patch: New patch by
     Max Kellermann, fixes a NULL pointer dereference bug with nested
     multipart form submission. (Closes: #[939937](bugreport.cgi?bug=939937))
Checksums-Sha1:
 2c77b40002e13295b22daa82264870408de700b8 2331 libapreq2_2.13-7~deb10u1.dsc
 db3761625a62230147896b47e9b047660b20ba28 891320 libapreq2_2.13.orig.tar.gz
 30babdb0bc3527a97f742631642920de659a9cfd 9012 libapreq2_2.13-7~deb10u1.debian.tar.xz
Checksums-Sha256:
 1c91e8fb71bd32fdff89048f0188c99609aa61dd66d3b5b6317bc5ea8281b31d 2331 libapreq2_2.13-7~deb10u1.dsc
 5731e6833b32d88e4a5c690e45ddf20fcf969ce3da666c5627d775e92da0cf6e 891320 libapreq2_2.13.orig.tar.gz
 0fdc1ac3c39298b0bfde87c029da18b03f4324286b7e0ae4f3dfd80eda271f43 9012 libapreq2_2.13-7~deb10u1.debian.tar.xz
Files:
 a8345356b8271a3b4af133a7c0208bab 2331 perl optional libapreq2_2.13-7~deb10u1.dsc
 c11fb0861aa84dcc6cd0f0798b045eee 891320 perl optional libapreq2_2.13.orig.tar.gz
 fb53572ea8e1a907719fb231ff014611 9012 perl optional libapreq2_2.13-7~deb10u1.debian.tar.xz

-----BEGIN PGP SIGNATURE-----

iQKmBAEBCgCQFiEERkRAmAjBceBVMd3uBUy48xNDz0QFAl2UWBpfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQSHGNhcm5pbEBk
ZWJpYW4ub3JnAAoJEAVMuPMTQ89EDwYP/3BkbWN3WWOMRN0n+bMsa4LYkaqIiJOH
J3MJwEW701qARTCzKV6VsYfUEM99qt6oazAobFGoDF9ivd0sXwz5w0SvFga0Z4X1
BFQFO1N1KLgm18gHTvo3s6SLECCHYs3+mnU0lVV7M/kpT1qOnrliT/emLzuByOLq
yDgTmLHE3A+PlV18LKOjV1Rq+BXPEldj796DJB4EC7cvVYxR72W7yr0rAGaVAhQu
6uvvrEDwvjeQ7o7Ru9y0I3jvAah5Tx/vJPpY7HDWMmQn/CtMyVescj43EkE6GH73
oO9TP1w9t3vnb4og0Ibz3Npg/nCKvQFic+bat4hHyZlgRDenVIlGLo429LwxpSDR
xtqLWMg5RRlUmcZPDlmJV2/NzTdNw7d51GA0UisTL5DKt33Q/4R84Pkf1v9fshnc
EGObv8FT3RguVxSGPcdY9uEPe5fNI6kXPc+5NEEsTU0j6u1vNIqIbaByFLt4E0WX
LnFJmnyxGSMD1Sji/A/tZSSOG8mkF2F7c0L4k9pHnR/AX0uZUGrxIb7aMsE4AtlA
H7Z36TOw9USMJ+4KJ2J+CNWP+7KdWZ081uNs6AQCh9EUfnXmEjeskF8qvbim5Z8K
xSoHgB/UqYWsK66d0IvjXTFRBb/Pmou4dUnVMnOeqMI4FAYOUQDQhx2YAeiTXmqH
ihnxKJrZgJ3u
=5HrO
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

You have taken responsibility.
(Sat, 05 Oct 2019 12:36:13 GMT) ([full text](bugreport.cgi?bug=939937;msg=36), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=36), [link](#35)).

---

**Notification sent**
to `Max Kellermann <max@blarg.de>`:

Bug acknowledged by developer.
(Sat, 05 Oct 2019 12:36:13 GMT) ([full text](bugreport.cgi?bug=939937;msg=38), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=38), [link](#37)).

---

[Message #39](#39) received at 939937-close@bugs.debian.org ([full text](bugreport.cgi?bug=939937;msg=39), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=39), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 939937-close@bugs.debian.org
Subject: Bug#939937: fixed in libapreq2 2.13-7~deb9u1
Date: Sat, 05 Oct 2019 12:32:52 +0000
```
Source: libapreq2
Source-Version: 2.13-7~deb9u1

We believe that the bug you reported is fixed in the latest version of
libapreq2, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 939937@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Salvatore Bonaccorso <carnil@debian.org> (supplier of updated libapreq2 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 02 Oct 2019 10:53:50 +0200
Source: libapreq2
Architecture: source
Version: 2.13-7~deb9u1
Distribution: stretch-security
Urgency: high
Maintainer: Steinar H. Gunderson <sesse@debian.org>
Changed-By: Salvatore Bonaccorso <carnil@debian.org>
Closes: [939937](bugreport.cgi?bug=939937)
Changes:
 libapreq2 (2.13-7~deb9u1) stretch-security; urgency=high
 .
   * Non-maintainer upload by the Security Team.
   * Rebuild for stretch-security
 .
 libapreq2 (2.13-7) unstable; urgency=high
 .
   * Source-only upload.
 .
 libapreq2 (2.13-6) unstable; urgency=high
 .
   * 05-nested-multipart-null-dereference.patch: New patch by
     Max Kellermann, fixes a NULL pointer dereference bug with nested
     multipart form submission. (Closes: #[939937](bugreport.cgi?bug=939937))
Checksums-Sha1:
 fb9bda368151f86f2a59b471c14ed157d21cecd1 2327 libapreq2_2.13-7~deb9u1.dsc
 1f20e789369ed52cf2dc159d4fa40cd889d736ab 9016 libapreq2_2.13-7~deb9u1.debian.tar.xz
Checksums-Sha256:
 2baf0523c5b9128ea1c768aac153c8f38bf3ca387efc5c4b8bdf6885d8e7d7c7 2327 libapreq2_2.13-7~deb9u1.dsc
 04c28d460b6a1ace036c3651fe810b102a5505f33f3bbbe6f34696fed488ecef 9016 libapreq2_2.13-7~deb9u1.debian.tar.xz
Files:
 172369e0344031c4ae0d792027a43df5 2327 perl optional libapreq2_2.13-7~deb9u1.dsc
 f4bb9f0645800bd501d0e1c9561b886f 9016 perl optional libapreq2_2.13-7~deb9u1.debian.tar.xz

-----BEGIN PGP SIGNATURE-----

iQKmBAEBCgCQFiEERkRAmAjBceBVMd3uBUy48xNDz0QFAl2UZ6xfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQSHGNhcm5pbEBk
ZWJpYW4ub3JnAAoJEAVMuPMTQ89Erl8P/3teTxim2/svIp7MobTsYyK1B3rL4gnO
ZGePw22VSvjg6Mi4mbvB+aNZMl73k3CRW4e2/vCD7TA3wcCtEa+MK7hAPY48He9n
VQDcIib1O2v2ZTFmUgUPRWghr4ehIqQJbsqrVFoUkILll55R83JnqCSgu4E58Erw
e3a8qyIOEypjebz4i+uXwhD/8U92okiaui/hPwCOS/Z7GdVOnoF0k41qOGqmlsr+
kaxpz/ZnzjmmipPKMMMlOEbDRTFsYWxJ+169U6tJgoaEdpSemTkRN8wSF1DE35J9
1l+4mIwAZzK082m90vnGMwlfKeglFzF1zaF6nTklB2awY+pS74oO5L1Q0Yf6/28T
OAcvJmB8mBd70a0JRkI7tt6aG9VOgZ4hWsBiWd5/xDHBqv/utnzzm7+TH+CDwZlJ
Z6Xcf4mmePi0sXSPO1ni5VWaWQuxHx3V61r5E7rbh0haUnEM/le90vQvevbSELv5
Ol2JaU+7miDrIjw9O9iIsLavI8KBB0I9ra+WmovbfK1SEVvou5Dxe3g6f/R6BqO6
mMwEN4tX0CTlrdxiqZTNir5T4MTAjRBtve74TqNQzE87WPEH/+3ZxfdQROLkh/Fa
43ZKYcZXDsPHyw+bUgjmMopBjOks921OceCcwMTBL1Ry8+gMb4JyfTn3awSI+3dR
1pQo1vg4sguN
=bS9M
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 17 Nov 2019 07:26:23 GMT) ([full text](bugreport.cgi?bug=939937;msg=41), [mbox](bugreport.cgi?bug=939937;mbox=yes;msg=41), [link](#40)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=939937).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 21 00:11:18 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from lists.apache.org_0e733f0d_20250121_001119.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from security-tracker.debian.org_f059f2f1_20250121_021853.html ===

# CVE-2019-12412

| **Name** | CVE-2019-12412 |
| --- | --- |
| **Description** | A flaw in the libapreq2 v2.07 to v2.13 multipart parser can deference a null pointer leading to a process crash. A remote attacker could send a request causing a process crash which could lead to a denial of service attack. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2019-12412) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2019-12412); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2019-12412), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2019-12412), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2019-12412), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2019-12412), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-12412), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2019-12412), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2019-12412), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2019-12412)/[CVE](https://www.suse.com/security/cve/CVE-2019-12412/), GitHub [advisories](https://github.com/advisories?query=CVE-2019-12412)/[code](https://github.com/search?type=Code&q=%22CVE-2019-12412%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2019-12412%22), [web search](https://duckduckgo.com/html?q=%22CVE-2019-12412%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-1944-1](/tracker/DLA-1944-1), [DSA-4541-1](/tracker/DSA-4541-1) |
| **Debian Bugs** | [939937](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=939937) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libapreq2](/tracker/source-package/libapreq2) ([PTS](https://tracker.debian.org/pkg/libapreq2)) | bullseye | 2.13-7+deb11u1 | fixed |
|  | sid, trixie | 2.17-7 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libapreq2](/tracker/source-package/libapreq2) | source | jessie | 2.13-4+deb8u1 |  | [DLA-1944-1](/tracker/DLA-1944-1) |  |
| [libapreq2](/tracker/source-package/libapreq2) | source | stretch | 2.13-7~deb9u1 |  | [DSA-4541-1](/tracker/DSA-4541-1) |  |
| [libapreq2](/tracker/source-package/libapreq2) | source | buster | 2.13-7~deb10u1 |  | [DSA-4541-1](/tracker/DSA-4541-1) |  |
| [libapreq2](/tracker/source-package/libapreq2) | source | (unstable) | 2.13-6 |  |  | [939937](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=939937) |

## Notes

```
<https://svn.apache.org/r1866760>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


