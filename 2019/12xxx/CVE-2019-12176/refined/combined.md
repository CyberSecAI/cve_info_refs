=== Content from huskersec.com_4b84b178_20250120_235708.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc93471ff87c8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Privilege Escalation via HTC VIVEPORT Desktop

[![Joshua Arnold](https://miro.medium.com/v2/resize:fill:88:88/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://medium.com/%40huskersec?source=post_page---byline--c93471ff87c8--------------------------------)[![huskersec](https://miro.medium.com/v2/resize:fill:48:48/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://huskersec.com/?source=post_page---byline--c93471ff87c8--------------------------------)

[Joshua Arnold](https://medium.com/%40huskersec?source=post_page---byline--c93471ff87c8--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bac6a463626&operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&user=Joshua+Arnold&userId=1bac6a463626&source=post_page-1bac6a463626--byline--c93471ff87c8---------------------post_header-----------)

Published in[huskersec](https://huskersec.com/?source=post_page---byline--c93471ff87c8--------------------------------)·4 min read·May 24, 2019

--

Listen

Share

On the hunt for privilege escalation paths, I decided to take a look at my own gaming computer to see if any of the software I’ve installed over the years would provide for a nice, simple path to SYSTEM. [This](https://twitter.com/enigma0x3/status/1108595493800546304) Tweet from Matt Nelson intrigued my curiosity to look at my own gaming system. Also, thanks to @FuzzySec for his popular Windows privilege escalation [guide](https://www.fuzzysecurity.com/tutorials/16.html). I’ll first preface this and say that these issues were in no way hard to find. It merely just took someone with a little curiosity to look in the right place.

To summarize, I was able to identify insecure service permissions (CVE-2019–12176) and a DLL hijacking opportunity (CVE-2019–12177) due to insecure directory permissions affecting the VIVEPORT Desktop software installation. We’ll go ahead and begin with the first issue, insecure service permissions. Using the Sysinternals Suite AccessChk tool, I was able to use the following commands to identify two services with the SERVICE\_CHANGE\_CONFIG permission:

![]()

AccessChk permissions result for HTC Account Service

![]()

AccessChk permissions result for ViveportDesktopService

Quick note, I already knew these two services were installed and that’s why I specified the exact service names in the above commands. However, you could always tell AccessChk to search across all services by specifying a \* instead of the specific service.

Moving on, Microsoft describes the SERVICE\_CHANGE\_CONFIG permission in the following screenshot and [here](https://docs.microsoft.com/en-us/windows/desktop/services/service-security-and-access-rights):

![]()

SERVICE\_CHANGE\_CONFIG description

As we can see, we’ve identified some serious issues in the way that these two services are configured, especially considering Microsoft states that the permission “should be granted to only administrators.” Essentially, the output from AccessChk has told us that “Authenticated Users” have the ability to “change the executable file that the system runs.” Since many services are configured to execute as Local System, if the vulnerable service is reconfigured to execute a command or execute a malicious executable, the command or executable will be ran in the context of Local System, resulting in successful privilege escalation.

To test out our newly-found privesc path, I ensured I was logged on as a regular user and then executed the commands in the following screenshots:

![]()

Reconfiguring the HTC Account Service to add a new user, admin1

![]()

Reconfiguring the HTC Account Service to add the admin1 user to the Administrators group

![]()

Reconfiguring the ViveportDesktopService to add a new user, admin2

![]()

Reconfiguring the ViveportDesktopService to add the admin2 user to the Administrators group

Above, both the HTC Account Service and ViveportDesktopService were successfully reconfigured to add new users to the system and to the Administrators group, thus, elevating our privileges from a regular user to that of an administrator.

Next, we’ll take a look at the DLL hijack due to insecure directory permissions identified while looking into the VIVEPORT Desktop installation. First, I’d like to thank Matt Nelson for [this](https://posts.specterops.io/razer-synapse-3-elevation-of-privilege-6d2802bd0585) post, in which he details a privilege escalation in Razer Synapse software. His post got me thinking and kind of guided me down a path to look at images that are loaded by VIVEPORT services when they’re started and from where. Somewhat following his process and methodology, I used the Sysinternals Suite tool, Process Monitor, to determine images that are loaded by the ViveportDesktopService when the service is started. In the following screenshot, we can see the vita\_update\_requester\_api64.dll is loaded when the service is started:

![]()

Load Image operation by ViveportDesktopService.exe

Checking access to the folder where the above DLL is loaded from, it was determined that users have FullControl over the folder:

![]()

Identifying all users have FullControl over the folder where the DLL is loaded from

Leveraging these permissions, MSFvenom was used to quickly generate a DLL that, once loaded, would execute a reverse shell back to my attacker host:

![]()

Generating a malicious reverse shell DLL with MSFvenom

With a perfect, malicious payload ready to go, the DLL was copied to the directory where the legitimate DLL, vita\_update\_requester\_api64.dll, is loaded from:

![]()

Malicious DLL copy and execute

Once the service was started, the reverse shell was received on the attacker system and privileges were verified by running the whoami command:

![]()

Successful reverse shell and verification of privileges

By taking advantage of the vulnerabilities described above, escalation of privileges from a regular user to that of an administrator or SYSTEM was able to take place.

To close this out, I just wanted to quickly say that these issues were disclosed to HTC once identified and that HTC worked quickly to fix both vulnerabilities. As of the release of this post, the VIVEPORT Desktop software has been updated to remediate both issues. Thanks for reading and happy hacking!

**References**

<https://twitter.com/enigma0x3/status/1108595493800546304>

<https://www.fuzzysecurity.com/tutorials/16.html>

<https://docs.microsoft.com/en-us/windows/desktop/services/service-security-and-access-rights>

<https://posts.specterops.io/razer-synapse-3-elevation-of-privilege-6d2802bd0585>

[Privilege Escalation](https://medium.com/tag/privilege-escalation?source=post_page-----c93471ff87c8--------------------------------)[Sysinternals](https://medium.com/tag/sysinternals?source=post_page-----c93471ff87c8--------------------------------)[HTC](https://medium.com/tag/htc?source=post_page-----c93471ff87c8--------------------------------)[Viveport](https://medium.com/tag/viveport?source=post_page-----c93471ff87c8--------------------------------)

--

--

[![huskersec](https://miro.medium.com/v2/resize:fill:96:96/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://huskersec.com/?source=post_page---post_publication_info--c93471ff87c8--------------------------------)[![huskersec](https://miro.medium.com/v2/resize:fill:128:128/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://huskersec.com/?source=post_page---post_publication_info--c93471ff87c8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fhuskersec&operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&collection=huskersec&collectionId=24915e773f6a&source=post_page---post_publication_info--c93471ff87c8---------------------follow_profile-----------)[## Published in huskersec](https://huskersec.com/?source=post_page---post_publication_info--c93471ff87c8--------------------------------)[12 Followers](/followers?source=post_page---post_publication_info--c93471ff87c8--------------------------------)·[Last published May 24, 2019](/privilege-escalation-via-htc-viveport-desktop-c93471ff87c8?source=post_page---post_publication_info--c93471ff87c8--------------------------------)

Infosec Stuffs

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fhuskersec&operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&collection=huskersec&collectionId=24915e773f6a&source=post_page---post_publication_info--c93471ff87c8---------------------follow_profile-----------)[![Joshua Arnold](https://miro.medium.com/v2/resize:fill:96:96/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://medium.com/%40huskersec?source=post_page---post_author_info--c93471ff87c8--------------------------------)[![Joshua Arnold](https://miro.medium.com/v2/resize:fill:128:128/1*_z_xY4dKLvWSoEvFUaESow.jpeg)](https://medium.com/%40huskersec?source=post_page---post_author_info--c93471ff87c8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bac6a463626&operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&user=Joshua+Arnold&userId=1bac6a463626&source=post_page-1bac6a463626--post_author_info--c93471ff87c8---------------------follow_profile-----------)[## Written by Joshua Arnold](https://medium.com/%40huskersec?source=post_page---post_author_info--c93471ff87c8--------------------------------)[10 Followers](https://medium.com/%40huskersec/followers?source=post_page---post_author_info--c93471ff87c8--------------------------------)·[2 Following](https://medium.com/%40huskersec/following?source=post_page---post_author_info--c93471ff87c8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bac6a463626&operation=register&redirect=https%3A%2F%2Fhuskersec.com%2Fprivilege-escalation-via-htc-viveport-desktop-c93471ff87c8&user=Joshua+Arnold&userId=1bac6a463626&source=post_page-1bac6a463626--post_author_info--c93471ff87c8---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c93471ff87c8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c93471ff87c8--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----c93471ff87c8--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c93471ff87c8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c93471ff87c8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c93471ff87c8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c93471ff87c8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c93471ff87c8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c93471ff87c8--------------------------------)[Teams](https://medium.com/business?source=post_page-----c93471ff87c8--------------------------------)


