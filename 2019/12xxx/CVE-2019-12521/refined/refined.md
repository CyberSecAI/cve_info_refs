```
{
  "CVE-2019-12521": {
    "description": "An issue was discovered in Squid through 4.7. When Squid is parsing ESI, it keeps the ESI elements in ESIContext. ESIContext contains a buffer for holding a stack of ESIElements. When a new ESIElement is parsed, it is added via addStackElement. addStackElement has a check for the number of elements in this buffer, but it's off by 1, leading to a Heap Overflow of 1 element. The overflow is within the same structure so it can't affect adjacent memory blocks, and thus just leads to a crash while processing.",
    "root_cause": "Incorrect buffer handling in `addStackElement` function when processing ESI responses, leading to a heap overflow.",
    "vulnerabilities": [
      "Heap overflow"
    ],
    "impact": "Denial of service. While processing ESI, the heap overflow leads to a crash of the Squid process.",
    "attack_vector": "Network. A remote server delivering specific ESI response syntax triggers the overflow.",
        "attacker_capabilities": "Attacker needs to control the server that is sending ESI responses or have control over the transmission channel."
  }
}
```