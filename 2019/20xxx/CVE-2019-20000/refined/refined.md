- **Root cause of vulnerability:** A Time-of-Check-Time-of-Use (TOCTOU) race condition exists within the malware scan function of BullGuard Premium Protection.
- **Weaknesses/vulnerabilities present:** The vulnerability is a TOCTOU race condition. The malware scan function checks for a file, and then some time later, it uses it to delete the file. This gap allows an attacker to manipulate the file between the check and the use. Specifically, an attacker can create a symbolic link, which is used as a file name, to point to a privileged file after the initial malware scan check, and before the actual delete action is performed.
- **Impact of exploitation:** Successful exploitation allows an attacker to delete arbitrary files with elevated privileges.
- **Attack vectors:** The attack vector involves manipulating the file system during the malware scan process, specifically by replacing the scanned malware file with a symbolic link to a target file.
- **Required attacker capabilities/position:** The attacker needs the ability to modify the file system in a way that replaces the originally scanned malware file with a symbolic link to a file that the attacker wants to delete. The attacker needs to be able to trigger a malware scan and then manipulate the target file between the scan and the actual file deletion. The attacker needs to have some level of access to the system so they can debug and modify the application during runtime.