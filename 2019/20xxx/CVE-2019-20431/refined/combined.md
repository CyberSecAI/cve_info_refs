=== Content from wiki.lustre.org_293b18ba_20250120_235109.html ===


# Lustre 2.12.3 Changelog

From Lustre Wiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

**Server support for kernels:**

* RHEL 7.7 (3.10.0-1062.1.1.el7)

**Client support for unpatched kernels:**

* RHEL 7.7 (3.10.0-1062.1.1.el7)
* SLES12 SP4 (4.12.14-95.29.1)
* Ubuntu 18.04 (4.15.0-64)

**Recommended e2fsprogs version:**

* v1.45.2.wc1-0

**Interoperability Support:**

* Clients & Servers: Latest 2.10.X and Latest 2.11.X

## Issues fixed between 2.12.2 and 2.12.3

 **New Feature**

* [LU-11297](https://jira.whamcloud.com/browse/LU-11297): Need to align LNet routing with Multi-Rail and LNet health

 **Improvement**

* [LU-9625](https://jira.whamcloud.com/browse/LU-9625): remove "lfs ls" and "lfs cp" and references
* [LU-10258](https://jira.whamcloud.com/browse/LU-10258): lfs mirror command to open fd on component
* [LU-10885](https://jira.whamcloud.com/browse/LU-10885): enable flock by default
* [LU-11233](https://jira.whamcloud.com/browse/LU-11233): gcc8 support
* [LU-11285](https://jira.whamcloud.com/browse/LU-11285): don't stop on the first blocked lock in ldlm\_reprocess\_queue()
* [LU-11296](https://jira.whamcloud.com/browse/LU-11296): page cache cleanup improvement on lock flush
* [LU-11355](https://jira.whamcloud.com/browse/LU-11355): Add Lustre trim support
* [LU-11830](https://jira.whamcloud.com/browse/LU-11830): Quiet compiler warnings on ARM
* [LU-11838](https://jira.whamcloud.com/browse/LU-11838): Support linux kernel version 4.18
* [LU-11845](https://jira.whamcloud.com/browse/LU-11845): Support encrypted ZFS volumes
* [LU-11963](https://jira.whamcloud.com/browse/LU-11963): Add nonrotational flag to obd\_statfs
* [LU-12045](https://jira.whamcloud.com/browse/LU-12045): Ability to split test script execution into parts
* [LU-12090](https://jira.whamcloud.com/browse/LU-12090): Create an lfs command to remove files by FID
* [LU-12093](https://jira.whamcloud.com/browse/LU-12093): CAP\_SYS\_RESOURCE capability check overhead
* [LU-12270](https://jira.whamcloud.com/browse/LU-12270): Support linux kernel version 4.19
* [LU-12331](https://jira.whamcloud.com/browse/LU-12331): hardened usercopy whitelisting
* [LU-12516](https://jira.whamcloud.com/browse/LU-12516): volatile file creation in .lustre/fid/
* [LU-12553](https://jira.whamcloud.com/browse/LU-12553): polling mode for changelog driver
* [LU-12621](https://jira.whamcloud.com/browse/LU-12621): o2iblnd QP sizing -EINVAL retries
* [LU-12789](https://jira.whamcloud.com/browse/LU-12789): Mellanox MOFED 4.7 support.
* [LU-12802](https://jira.whamcloud.com/browse/LU-12802): racer test stucks after test finishes
* [LU-12825](https://jira.whamcloud.com/browse/LU-12825): Build MOFED 4.7

 **Bug**

* [LU-8047](https://jira.whamcloud.com/browse/LU-8047): optimize ll\_md\_blocking\_ast() for a failed lock
* [LU-10094](https://jira.whamcloud.com/browse/LU-10094): sanity test\_17f: 'ls' fails with "ls: reading directory \*: Input/output error"
* [LU-10100](https://jira.whamcloud.com/browse/LU-10100): sanity test\_27a: setstripe failed with "error on ioctl 0x8008669a for '\*' (3): Invalid argument"
* [LU-10717](https://jira.whamcloud.com/browse/LU-10717): several conf-sanity tests failed: FAIL: start mgs failed
* [LU-11359](https://jira.whamcloud.com/browse/LU-11359): racer test 1 times out with client hung in dir\_create.sh, ls, … and MDS in ldlm\_completion\_ast()
* [LU-11403](https://jira.whamcloud.com/browse/LU-11403): lov\_io\_init\_empty() Page fault on a file without stripes
* [LU-11426](https://jira.whamcloud.com/browse/LU-11426): 2/2 Olafs agree: changelog entries are emitted out of order
* [LU-11453](https://jira.whamcloud.com/browse/LU-11453): sanity test 184a: Basic layout swap panics on Power8
* [LU-11485](https://jira.whamcloud.com/browse/LU-11485): MDS allows "lfs setstripe" to mark last mirror as stale
* [LU-11537](https://jira.whamcloud.com/browse/LU-11537): Fix assertion: osd\_trans\_exec\_op()) ASSERTION( !ldiskfs\_track\_declares\_assert )
* [LU-11542](https://jira.whamcloud.com/browse/LU-11542): Race between imp\_state and imp\_invalid
* [LU-11566](https://jira.whamcloud.com/browse/LU-11566): sanity test\_60aa: llog\_print\_cb()) not enough space for print log records
* [LU-11617](https://jira.whamcloud.com/browse/LU-11617): lockdep exposed a possible deadlock in chlg\_open()
* [LU-11634](https://jira.whamcloud.com/browse/LU-11634): sanityn/test\_77 improvements
* [LU-11672](https://jira.whamcloud.com/browse/LU-11672): improving lru\_max\_age policy when lru resize is disabled
* [LU-11675](https://jira.whamcloud.com/browse/LU-11675): Don't allow new HSM requests during CDT\_INIT
* [LU-11678](https://jira.whamcloud.com/browse/LU-11678): sanity-quota test 1 fails with 'user write success, but expect EDQUOT'
* [LU-11690](https://jira.whamcloud.com/browse/LU-11690): LBUG with very wide striping: lod\_ea\_store\_resize()) ASSERTION( round <= lov\_mds\_md\_size(2000, (0x0BD30000 | 0x0BD0))
* [LU-11721](https://jira.whamcloud.com/browse/LU-11721): "lfs df -i" prints used blocks percentage instead of inodes
* [LU-11729](https://jira.whamcloud.com/browse/LU-11729): ARM: sanity test\_810: BAD WRITE CHECKSUM with adler
* [LU-11742](https://jira.whamcloud.com/browse/LU-11742): ERROR: RPATH is not allowed
* [LU-11743](https://jira.whamcloud.com/browse/LU-11743): lctl pool operations cannot be run on separate MGS system
* [LU-11755](https://jira.whamcloud.com/browse/LU-11755): Remove redundant LASSERT() in ns\_is\_{client,server}()
* [LU-11756](https://jira.whamcloud.com/browse/LU-11756): kib\_conn leak
* [LU-11760](https://jira.whamcloud.com/browse/LU-11760): formatted OST recognition change
* [LU-11761](https://jira.whamcloud.com/browse/LU-11761): blocked MDT mount and high cpu usage from lodXXXX\_recYYYY threads
* [LU-11771](https://jira.whamcloud.com/browse/LU-11771): bad output in target\_handle\_reconnect: Recovery already passed deadline 71578:57
* [LU-11796](https://jira.whamcloud.com/browse/LU-11796): Remove LASSERT(r0->lo\_nr <= lov\_targets\_nr(dev)) in maintenance branches
* [LU-11816](https://jira.whamcloud.com/browse/LU-11816): LNet Health: Correct timeout defaults
* [LU-11851](https://jira.whamcloud.com/browse/LU-11851): kernel BUG at ...ldiskfs/htree\_lock.c:665
* [LU-11873](https://jira.whamcloud.com/browse/LU-11873): sanity test\_801a: FAIL: (2) unexpected barrier status 'expired'
* [LU-11925](https://jira.whamcloud.com/browse/LU-11925): Attributes not updated after open+append and write to archived,released file
* [LU-11946](https://jira.whamcloud.com/browse/LU-11946): configure --enable-dist fails if libyaml-devel or zlib-devel are not installed
* [LU-12017](https://jira.whamcloud.com/browse/LU-12017): Truncate vs setxattr deadlock with DoM
* [LU-12034](https://jira.whamcloud.com/browse/LU-12034): env allocation in ptlrpc\_set\_wait() causes slowdown on the client
* [LU-12080](https://jira.whamcloud.com/browse/LU-12080): LNet Health: references left on eq
* [LU-12095](https://jira.whamcloud.com/browse/LU-12095): ocd\_connect\_flags are wrong during reconnect
* [LU-12098](https://jira.whamcloud.com/browse/LU-12098): changelog\_deregister appears not to reliably clear all changelog entries
* [LU-12120](https://jira.whamcloud.com/browse/LU-12120): LustreError: 15069:0:(tgt\_grant.c:561:tgt\_grant\_incoming()) LBUG
* [LU-12131](https://jira.whamcloud.com/browse/LU-12131): Improve GSS/SSK handling in Lustre test suite
* [LU-12152](https://jira.whamcloud.com/browse/LU-12152): lnetctl export corrupts memory on routers
* [LU-12165](https://jira.whamcloud.com/browse/LU-12165): Enable quota enforcement crashed kernel
* [LU-12166](https://jira.whamcloud.com/browse/LU-12166): Tests if ZFS backend project supported is broken
* [LU-12169](https://jira.whamcloud.com/browse/LU-12169): Assertion on mdc\_pack\_name
* [LU-12178](https://jira.whamcloud.com/browse/LU-12178): MDS deadlock with 2.12.0 (quotas?)
* [LU-12195](https://jira.whamcloud.com/browse/LU-12195): sanity/43 and sanityn/14 fail on local setups
* [LU-12199](https://jira.whamcloud.com/browse/LU-12199): md's are not detached from uncommitted messages that have health check performed on them
* [LU-12225](https://jira.whamcloud.com/browse/LU-12225): jobid\_get\_from\_cache stalled on spin\_lock(&pidmap->jp\_lock)
* [LU-12229](https://jira.whamcloud.com/browse/LU-12229): ost-pools test 1j fails with 'test\_1j returned 1'
* [LU-12232](https://jira.whamcloud.com/browse/LU-12232): replay-ost-single test 6 fails with *space grew after dd: before:13442048 after\_dd:13442048*
* [LU-12248](https://jira.whamcloud.com/browse/LU-12248): sanity test\_418: df and lfs df inodes output mismatch
* [LU-12264](https://jira.whamcloud.com/browse/LU-12264): The lnet peer discovery queue (lnet\_peer.lp\_dc\_pendq) is susceptible to concurrent manipulation
* [LU-12267](https://jira.whamcloud.com/browse/LU-12267): sanity test\_103a: some ACL tests fail with SELinux enforced
* [LU-12282](https://jira.whamcloud.com/browse/LU-12282): Pass IB\_OPTIONS to debian rules doesn't work
* [LU-12309](https://jira.whamcloud.com/browse/LU-12309): write fails with -EOPNOTSUPP with zfs 0.8.0-rc5 using 0.7.x pool
* [LU-12314](https://jira.whamcloud.com/browse/LU-12314): Add Missing Description to sanity test 258a
* [LU-12323](https://jira.whamcloud.com/browse/LU-12323): save\_stack\_trace\_tsk is not exported on arm architectures
* [LU-12324](https://jira.whamcloud.com/browse/LU-12324): zero transno on transaction commit
* [LU-12342](https://jira.whamcloud.com/browse/LU-12342): lsvcgss config file overwritten on update
* [LU-12343](https://jira.whamcloud.com/browse/LU-12343): osc\_lock.c:687:osc\_ldlm\_weigh\_ast()) LBUG
* [LU-12350](https://jira.whamcloud.com/browse/LU-12350): sanity-flr test\_33: file content error: expected: ost1, actual: ost2
* [LU-12361](https://jira.whamcloud.com/browse/LU-12361): cp --sparse doesn't work correctly in
* [LU-12374](https://jira.whamcloud.com/browse/LU-12374): client went down w/ panic during lustre\_rmmod
* [LU-12375](https://jira.whamcloud.com/browse/LU-12375): lnet should start after opa service
* [LU-12381](https://jira.whamcloud.com/browse/LU-12381): o2iblnd uses wrong IB interface
* [LU-12382](https://jira.whamcloud.com/browse/LU-12382): Deadloop on tiny write
* [LU-12383](https://jira.whamcloud.com/browse/LU-12383): lfs project inhert difference between ldiskfs and zfs
* [LU-12385](https://jira.whamcloud.com/browse/LU-12385): 2.12.2: IOR read testing reliably inducing LNetError: Timed out RDMA with ...@o2ib1 (6): c: 0, oc: 0, rc: 63
* [LU-12387](https://jira.whamcloud.com/browse/LU-12387): l\_tunedisk does not properly handle multipath devices
* [LU-12394](https://jira.whamcloud.com/browse/LU-12394): lctl get\_param llite.lfs\*.extents\_stats only displays first two buckets
* [LU-12395](https://jira.whamcloud.com/browse/LU-12395): Failed dependencies while installing lustre-client-tests and lustre-iokit rpms on RHEL 8.0 client
* [LU-12399](https://jira.whamcloud.com/browse/LU-12399): sanity test\_420: FAIL: incorrect perms on /mnt/lustre/d420.sanity/testdir/testfile
* [LU-12401](https://jira.whamcloud.com/browse/LU-12401): Various issues with checksum calculation for Kerberos and SSK
* [LU-12447](https://jira.whamcloud.com/browse/LU-12447): Fedora28 Lustre client build failure
* [LU-12456](https://jira.whamcloud.com/browse/LU-12456): kernel update [RHEL8.0 4.18.0-80.4.2.el8\_0]
* [LU-12457](https://jira.whamcloud.com/browse/LU-12457): support for RHEL 7.7
* [LU-12458](https://jira.whamcloud.com/browse/LU-12458): kernel update [RHEL7.6 3.10.0-957.21.3.el7]
* [LU-12478](https://jira.whamcloud.com/browse/LU-12478): RHEL8 packaging
* [LU-12479](https://jira.whamcloud.com/browse/LU-12479): gcc8 warnings
* [LU-12485](https://jira.whamcloud.com/browse/LU-12485): (osd\_handler.c:2146:osd\_object\_release()) ASSERTION( !(o->oo\_destroyed == 0 && o->oo\_inode && o->oo\_inode->i\_nlink == 0) ) faile
* [LU-12491](https://jira.whamcloud.com/browse/LU-12491): large-scale: crash in lu\_env\_remove() RIP: memcmp+0x9/0x50
* [LU-12494](https://jira.whamcloud.com/browse/LU-12494): kernel update [SLES12 SP4 4.12.14-95.19.1]
* [LU-12498](https://jira.whamcloud.com/browse/LU-12498): kernel update [SLES12 SP3 4.4.180-94.97.1]
* [LU-12501](https://jira.whamcloud.com/browse/LU-12501): lfs df can never return
* [LU-12510](https://jira.whamcloud.com/browse/LU-12510): mds server hangs cv\_wait\_common
* [LU-12539](https://jira.whamcloud.com/browse/LU-12539): Pass --with-o2ib option along when building deb packages
* [LU-12559](https://jira.whamcloud.com/browse/LU-12559): Reconnecting from idle exposes import in IMP\_NEW state, resulting in EIO
* [LU-12566](https://jira.whamcloud.com/browse/LU-12566): GPF when umounting client
* [LU-12569](https://jira.whamcloud.com/browse/LU-12569): IBLND\_CREDITS\_HIGHWATER does not check connection queue depth
* [LU-12570](https://jira.whamcloud.com/browse/LU-12570): sanity test 134a crash with SSK in use
* [LU-12575](https://jira.whamcloud.com/browse/LU-12575): lbuild: build MOFED on el8
* [LU-12581](https://jira.whamcloud.com/browse/LU-12581): Slab object "Freechain corrupt" on client
* [LU-12586](https://jira.whamcloud.com/browse/LU-12586): truncate to start of uninstantiated PFL component silently fails
* [LU-12589](https://jira.whamcloud.com/browse/LU-12589): sanity test\_102a: setfattr: /mnt/lustre/f102a.sanity: Numerical result out of range
* [LU-12590](https://jira.whamcloud.com/browse/LU-12590): Lustre lustre\_msg\_hdr\_size\_v2() bug
* [LU-12600](https://jira.whamcloud.com/browse/LU-12600): Lustre tgt\_brw\_write() bug
* [LU-12602](https://jira.whamcloud.com/browse/LU-12602): Lustre mdt\_getxattr\_pack\_reply() bug
* [LU-12603](https://jira.whamcloud.com/browse/LU-12603): Lustre ldlm\_request\_cancel() bug
* [LU-12604](https://jira.whamcloud.com/browse/LU-12604): Lustre mdt\_file\_secctx\_unpack() bug
* [LU-12605](https://jira.whamcloud.com/browse/LU-12605): Lustre target\_handle\_connect() bug
* [LU-12608](https://jira.whamcloud.com/browse/LU-12608): kernel update [RHEL7.6 3.10.0-957.27.2.el7]
* [LU-12612](https://jira.whamcloud.com/browse/LU-12612): Lustre osd\_bufs\_get() bug
* [LU-12613](https://jira.whamcloud.com/browse/LU-12613): Lustre lustre\_msg\_string() bug
* [LU-12614](https://jira.whamcloud.com/browse/LU-12614): Lustre ldlm\_cancel\_hpreq\_check() bug
* [LU-12615](https://jira.whamcloud.com/browse/LU-12615): Lustre mdt\_object\_remote() bug
* [LU-12620](https://jira.whamcloud.com/browse/LU-12620): kernel update [RHEL8.0 4.18.0-80.7.1.el8\_0]
* [LU-12626](https://jira.whamcloud.com/browse/LU-12626): Attempt to create existing net returns EINVAL
* [LU-12650](https://jira.whamcloud.com/browse/LU-12650): get\_root\_path() filesystem name compare error that leads to fid2path fail
* [LU-12657](https://jira.whamcloud.com/browse/LU-12657): sanity/103 and sanityn/25 fail with 4.18 kernel
* [LU-12660](https://jira.whamcloud.com/browse/LU-12660): kernel update [SLES12 SP4 4.12.14-95.29.1]
* [LU-12690](https://jira.whamcloud.com/browse/LU-12690): error handling of ll\_och\_fill()
* [LU-12705](https://jira.whamcloud.com/browse/LU-12705): build fails on power9 client
* [LU-12724](https://jira.whamcloud.com/browse/LU-12724): kernel update [RHEL7.7 3.10.0-1062.1.1.el7]
* [LU-12755](https://jira.whamcloud.com/browse/LU-12755): CPU soft lockup on mkfs.lustre
* [LU-12777](https://jira.whamcloud.com/browse/LU-12777): conf-sanity test 103 fails with ‘set mdt quota type failed’
* [LU-12790](https://jira.whamcloud.com/browse/LU-12790): LustreError: 96800:0:(jobid.c:103:jobid\_get\_from\_environ()) jobid: get 'PBS\_JOBID' failed: rc = -75

 **Task**

* [LU-10171](https://jira.whamcloud.com/browse/LU-10171): define pct(a,b) once

 **Technical task**

* [LU-10777](https://jira.whamcloud.com/browse/LU-10777): DoM performance is bad with FIO write
* [LU-11478](https://jira.whamcloud.com/browse/LU-11478): LNet: discovery sequence numbers could be misleading
* [LU-12163](https://jira.whamcloud.com/browse/LU-12163): Fix cpt confusion
* [LU-12201](https://jira.whamcloud.com/browse/LU-12201): LNet: detach response tracker
* [LU-12249](https://jira.whamcloud.com/browse/LU-12249): LNet Health: list corruption
* [LU-12254](https://jira.whamcloud.com/browse/LU-12254): lnet: correct discovery event queue release
* [LU-12339](https://jira.whamcloud.com/browse/LU-12339): LNet Health: selecting loopback interface for sending
* [LU-12344](https://jira.whamcloud.com/browse/LU-12344): LNet Health: tweak health errors

Retrieved from "[http://wiki.lustre.org/index.php?title=Lustre\_2.12.3\_Changelog&oldid=4938](https://wiki.lustre.org/index.php?title=Lustre_2.12.3_Changelog&oldid=4938)"
[Category](/Special%3ACategories "Special:Categories"):

* [Releases](/Category%3AReleases "Category:Releases")

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=Lustre+2.12.3+Changelog "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/Lustre_2.12.3_Changelog "View the content page [c]")
* [Discussion](/index.php?title=Talk:Lustre_2.12.3_Changelog&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/Lustre_2.12.3_Changelog)
* [View source](/index.php?title=Lustre_2.12.3_Changelog&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=Lustre_2.12.3_Changelog&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

### Lustre Wiki Links

* [Wiki Main Page](/Main_Page)
* [Lustre Website](http://www.lustre.org)
* [FAQ](/Frequently_Asked_Questions)
* [How To](/How_To)
* [Development](/Development)
* [Projects](/Projects)
* [Testing](/Testing)
* [Mailing Lists and IRC](/Mailing_Lists_and_IRC)
* [Benchmarking](/Category%3ABenchmarking)
* [Monitoring](/Category%3AMonitoring)
* [ZFS](/Category%3AZFS)

### MediaWiki Links

* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

### Tools

* [What links here](/Special%3AWhatLinksHere/Lustre_2.12.3_Changelog "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/Lustre_2.12.3_Changelog "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=Lustre_2.12.3_Changelog&oldid=4938 "Permanent link to this revision of this page")
* [Page information](/index.php?title=Lustre_2.12.3_Changelog&action=info "More information about this page")

* This page was last edited on 7 October 2024, at 05:45.
* Content is available under [Creative Commons Attribution-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-sa/4.0/) unless otherwise noted.

* [Privacy policy](/Lustre_Wiki%3APrivacy_policy)
* [About Lustre Wiki](/Lustre_Wiki%3AAbout)
* [Disclaimers](/Lustre_Wiki%3AGeneral_disclaimer)

* [![Creative Commons Attribution-ShareAlike 4.0 International License](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)](http://creativecommons.org/licenses/by-sa/4.0/)
* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from lustre.org_1ab5140c_20250120_235108.html ===


![Print Logo](https://www.lustre.org/wp-content/themes/lustre-opensfs/library/images/opensfs-lustre-logo.png)

[Lustre](https://www.lustre.org)

Toggle navigation

* [Welcome](https://www.lustre.org/)
* [Get Started](https://www.lustre.org/getting-started-with-lustre/)
* [Download](https://www.lustre.org/download/)
* [Documentation](https://www.lustre.org/documentation/)
* [Development](https://www.lustre.org/development/)
* [News](https://www.lustre.org/latest-news/)
* [About](https://www.lustre.org/about/)

# [Welcome to the official home of the Lustre® filesystem](https://www.lustre.org/ "Welcome to the official home of the Lustre® filesystem")

The Lustre® file system is an open-source, parallel file system that supports many requirements of leadership class HPC simulation environments. Whether you’re a member of our diverse development community or considering the Lustre file system as a parallel file system solution, these pages offer a wealth of resources and support to meet your needs.

## Events

* [Lustre Administrators and Developers Workshop (LAD) 2024](https://www.eofs.eu/index.php/events/lad-24/)

## What’s Here?

* Here’s how to [get started with the Lustre file system](https://lustre.org/getting-started-with-lustre), with links to the [documentation](https://lustre.org/documentation), and information on how to [download](https://lustre.org/download) the Lustre software.
* The [Releases Roadmap](https://lustre.org/roadmap/) outlines the community’s schedule of releases and main features.
* The [Development](https://lustre.org/development) page describes how you can participate in the advancement of the Lustre file system by joining the development activities currently taking place, including code development, testing, filing bugs, and benchmarking.
* [Latest News](https://lustre.org/latest-news) about Lustre developments, summarized in the top box on the right.
* Lustre community [mailing lists](https://lustre.org/mailing-lists/).
* Learn more [about Lustre](https://lustre.org/about).

## Wiki

The [Lustre Wiki](http://wiki.lustre.org/) contains pages with information addressing a variety of Lustre topics:

* [Administration](http://wiki.lustre.org/Category%3AAdministration) :: [Architecture](http://wiki.lustre.org/Category%3AArchitecture) :: [Benchmarking](http://wiki.lustre.org/Category%3ABenchmarking) :: [Development](http://wiki.lustre.org/Category%3ADevelopment) :: [Events](http://wiki.lustre.org/Category%3AEvents) ::

  [FAQ](http://wiki.lustre.org/Category%3AFAQ) :: [Features](http://wiki.lustre.org/Category%3AFeatures) :: [Howto](http://wiki.lustre.org/Category%3AHowto) ::  [Internals](http://wiki.lustre.org/Category%3AInternals) :: [LNET](http://wiki.lustre.org/Category%3ALNET) :: [Monitoring](http://wiki.lustre.org/Category%3AMonitoring) ::

  [Organizations](http://wiki.lustre.org/Category%3AOrganizations) :: [Releases](http://wiki.lustre.org/Category%3AReleases) :: [Testing](http://wiki.lustre.org/Category%3ATesting) :: [Training](http://wiki.lustre.org/Category%3ATraining) :: [Tools](http://wiki.lustre.org/Category%3ATools) :: [ZFS](http://wiki.lustre.org/Category%3AZFS)

## Releases

* Current Maintenance Release
  + [Lustre 2.15.5](http://wiki.lustre.org/Lustre_2.15.5_Changelog) released [June 28, 2024](https://www.lustre.org/lustre-2-15-5-released/)
* Current Major Release
  + [Lustre 2.16.0](http://wiki.lustre.org/Release_2.16.0) released [November 8, 2024](https://www.lustre.org/lustre-2-16-0-released/)
* Major Release Under Development
  + [Lustre 2.17.0](http://wiki.lustre.org/Release_2.17.0)

 [![](https://lustre.org/wp-content/uploads/2015/03/OpenSFS_logo_light_background_240x90.png)](http://www.opensfs.org)

  [![](https://lustre.org/wp-content/uploads/2015/03/EOFS_Logo_final1.jpg)](http://www.eofs.org)

#### Latest News

* [Lustre 2.15.6 released](https://www.lustre.org/lustre-2-15-6-released/)
* [Lustre 2.16.1 released](https://www.lustre.org/lustre-2-16-1-released/)
* [Lustre 2.16.0 released](https://www.lustre.org/lustre-2-16-0-released/)
* [Lustre 2.15.5 released](https://www.lustre.org/lustre-2-15-5-released/)

## Lustre Links

* [Download Lustre](http://lustre.org/download/)
* [Releases Roadmap](http://lustre.org/roadmap/)
* [Release Information](http://wiki.lustre.org/Lustre_Release_Information)
* [Get started with Lustre](http://lustre.org/getting-started-with-lustre/)
* [Mailing Lists](http://lustre.org/mailing-lists/)
* [Read Documentation](http://lustre.org/documentation/)
* [Submit an Issue](https://jira.whamcloud.com/)
* [Lustre Wiki](http://wiki.lustre.org/)

[OpenSFS](http://www.opensfs.org)
[EOFS](http://www.eofs.eu)

© 2025 OpenSFS and EOFS.

All rights reserved.

#### About Lustre

* [About Lustre](https://www.lustre.org/about/)
* [Lustre Roadmap](https://www.lustre.org/roadmap/)
* [Release Information](http://wiki.lustre.org/Lustre_Release_Information)
* [Terms & Conditions](https://www.lustre.org/terms-conditions/)
* [Privacy Policy](https://www.lustre.org/privacy-policy/)

#### Run Lustre

* [Download Lustre](https://www.lustre.org/download/)
* [Getting Started](https://www.lustre.org/getting-started-with-lustre/)
* [Documentation](https://www.lustre.org/documentation/)
* [Lustre Wiki](http://wiki.lustre.org/)

#### Get Involved

* [Lustre Development](https://www.lustre.org/development/)
* [Lustre Development Wiki](http://wiki.lustre.org/Development)
* [Join a Mailing List](https://www.lustre.org/mailing-lists/)
* [Submit an Issue](https://jira.whamcloud.com/)
* [Working Groups](https://www.lustre.org/mailing-lists/)

#### News

* [Latest News](https://www.lustre.org/latest-news/)

The Lustre® trademark is jointly owned by [OpenSFS](http://www.opensfs.org/) and [EOFS](http://www.eofs.eu).



=== Content from jira.whamcloud.com_35a232e9_20250120_235111.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FLU-12612)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![](/s/-iur68z/940029/1pkn20a/_/jira-logo-scaled.png)Whamcloud Community JIRA](https://jira.whamcloud.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-094/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-094/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FLU-12612)

![Uploaded image for project: 'Lustre'](https://jira.whamcloud.com/secure/projectavatar?pid=10000&avatarId=10011)

1. [Lustre](/browse/LU)
2. [LU-12612](/browse/LU-12612)

# Lustre osd\_bufs\_get() bug

Add NodeResolvedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=11303&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [Lustre 2.13.0](/issues/?jql=project+%3D+LU+AND+fixVersion+%3D+%22Lustre+2.13.0%22 "Lustre 2.13.0 "), [Lustre 2.12.3](/issues/?jql=project+%3D+LU+AND+fixVersion+%3D+%22Lustre+2.12.3%22 "Lustre 2.12.3 ")
* **Affects Version/s:**
  None
* **Labels:**
  None

* **Severity:**
  3
* **Rank (Obsolete):**
  9223372036854775807

#### Description

In the latest version of lustre file system, ptlrpc module has a out-of-access bug due to the lack of validation for specific fields of packets sent by client.

The kernel panic:

```
[  926.531595] BUG: unable to handle kernel paging request at 000000001ebe8010
[  926.533844] IP: [<ffffffffc0826783>] lu_context_key_get+0x13/0x30 [obdclass]
[  926.536063] PGD 8000000424360067 PUD 42865d067 PMD 0
[  926.538060] Oops: 0000 [#1] SMP
[  926.539857] Modules linked in: ofd(OE) ost(OE) osp(OE) mdd(OE) lod(OE) mdt(OE) lfsck(OE) mgs(OE) osd_ldiskfs(OE) lquota(OE) ldiskfs(OE) loop lustre(OE) obdecho(OE) mgc(OE) lov(OE) mdc(OE) osc(OE) lmv(OE) fid(OE) fld(OE) ptlrpc(OE) obdclass(OE) crc_t10dif crct10dif_generic ksocklnd(OE) lnet(OE) libcfs(OE) dm_flakey dm_mod nfit libnvdimm iosf_mbi crc32_pclmul ghash_clmulni_intel aesni_intel lrw gf128mul ppdev glue_helper ablk_helper cryptd virtio_balloon joydev parport_pc parport i2c_piix4 pcspkr ip_tables ext4 mbcache jbd2 ata_generic pata_acpi virtio_net virtio_console virtio_blk cirrus drm_kms_helper syscopyarea sysfillrect sysimgblt fb_sys_fops ttm crct10dif_pclmul crct10dif_common drm ata_piix libata crc32c_intel serio_raw virtio_pci virtio_ring virtio drm_panel_orientation_quirks floppy
[  926.558093] CPU: 2 PID: 3308 Comm: ll_ost_io00_002 Kdump: loaded Tainted: G           OE  ------------   3.10.0-957.10.1.el7_lustre.x86_64 #1
[  926.562313] Hardware name: Alibaba Cloud Alibaba Cloud ECS, BIOS 3288b3c 04/01/2014
[  926.564575] task: ffff8911ac64b0c0 ti: ffff8911847ec000 task.ti: ffff8911847ec000
[  926.566820] RIP: 0010:[<ffffffffc0826783>]  [<ffffffffc0826783>] lu_context_key_get+0x13/0x30 [obdclass]
[  926.569301] RSP: 0018:ffff8911847ef9e8  EFLAGS: 00010246
[  926.571339] RAX: 0000000000000016 RBX: 0000000000039594 RCX: 000000000000021d
[  926.573536] RDX: 000000000000021d RSI: ffffffffc0f9f180 RDI: 000000001ebe8000
[  926.575719] RBP: ffff8911847efa38 R08: ffff891184040000 R09: 0000000000000001
[  926.577890] R10: 0000000000000001 R11: ffff89118cbdc1a0 R12: 0000000000000000
[  926.580035] R13: ffff891189a48a00 R14: 0000000000000000 R15: ffff891184040000
[  926.582180] FS:  0000000000000000(0000) GS:ffff8911bfd00000(0000) knlGS:0000000000000000
[  926.584424] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  926.586446] CR2: 000000001ebe8010 CR3: 00000004287fe000 CR4: 00000000003606e0
[  926.588588] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  926.590725] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  926.592836] Call Trace:
[  926.594522]  [<ffffffffc0f71cc3>] ? osd_bufs_get+0x203/0x800 [osd_ldiskfs]
[  926.596608]  [<ffffffffc1376af2>] ? ofd_preprw+0x422/0x1160 [ofd]
[  926.598618]  [<ffffffffc0696394>] ? cfs_trace_unlock_tcd+0x34/0x90 [libcfs]
[  926.600681]  [<ffffffffa2966e92>] ? mutex_lock+0x12/0x2f
[  926.602572]  [<ffffffffc069cfa7>] ? libcfs_debug_msg+0x57/0x80 [libcfs]
[  926.604578]  [<ffffffffa22cbadb>] ? __wake_up_common+0x5b/0x90
[  926.606557]  [<ffffffffc0a73384>] ? ptlrpc_main+0xbb4/0x20f0 [ptlrpc]
[  926.608575]  [<ffffffffc0a727d0>] ? ptlrpc_register_service+0xfa0/0xfa0 [ptlrpc]
[  926.610621]  [<ffffffffa22c1ba0>] ? insert_kthread_work+0x40/0x40
[  926.612531] Code: 00 04 00 e8 f0 67 e7 ff 48 c7 c7 00 aa 88 c0 e8 c4 00 e7 ff 0f 1f 40 00 0f 1f 44 00 00 48 63 46 20 48 3b 34 c5 a0 30 8b c0 75 09 <48> 8b 57 10 48 8b 04 c2 c3 55 48 89 e5 e8 aa f9 02 00 90 66 2e
[  926.618057] RIP  [<ffffffffc0826783>] lu_context_key_get+0x13/0x30 [obdclass]
[  926.620212]  RSP <ffff8911847ef9e8>
[  926.621918] CR2: 000000001ebe8010

```

In function osd\_bufs\_get() of osd\_ldiskfs module, there is no check about the value len, which is derived from the Nio buffer section of the packet sent by client, and cause a out-of-access bug in osd\_map\_remote\_to\_local() function.

```

static int osd_bufs_get(const struct lu_env *env, struct dt_object *dt, loff_t pos, ssize_t len,
                       struct niobuf_local *lnb, enum dt_bufs_type rw)
{
        :
        osd_map_remote_to_local(pos, len, &npages, lnb);
        :
}

```

#### Attachments

#### Issue Links

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=11303&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[LU-12605](/browse/LU-12605)
Lustre target\_handle\_connect() bug

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Resolved

#### Activity

#### People

Assignee:

![bzzz](https://jira.whamcloud.com/secure/useravatar?size=small&avatarId=10122)
Alex Zhuravlev

Reporter:

![yunye.ry](https://jira.whamcloud.com/secure/useravatar?size=small&avatarId=10122)
Alibaba Cloud (Inactive)

Votes:
0
Vote for this issue

Watchers:
6
Start watching this issue

#### Dates

Created:

30/Jul/19 11:15 AM

Updated:

28/Sep/19 6:57 AM

Resolved:

25/Sep/19 1:03 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for DataDirect Network. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from review.whamcloud.com_3c5449f0_20250120_235111.html ===



