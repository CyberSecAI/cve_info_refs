## CVE-2019-20933

Based on the provided information, here's a breakdown of the vulnerability:

**Description:** Incorrect validation of JWT tokens in InfluxDB could lead to authentication bypass.

**Root Cause:** The `authenticate` function in `services/httpd/handler.go` within InfluxDB does not properly check if the `SharedSecret` configuration option is empty when using Bearer Authentication. This allows an attacker to use a JWT token with an empty shared secret to bypass authentication.

**Vulnerability:**
*   **Weakness**: Missing check for empty `SharedSecret` when using JWT Bearer Authentication.
*   **Impact**: Authentication Bypass. An attacker can gain unauthorized access to InfluxDB by using a JWT token without a valid shared secret.

**Attack Vector:**

1.  The attacker crafts a JWT token.
2.  The attacker sends a request to the InfluxDB server with the crafted JWT token in the `Authorization` header (Bearer Authentication).
3.  If the InfluxDB server is configured with an empty `SharedSecret`, the server will incorrectly validate the token, granting the attacker access.

**Required Capabilities:**

*   The attacker needs to be able to send HTTP requests to the InfluxDB server.
*   The attacker needs to know that the InfluxDB instance is configured to use JWT Bearer Authentication with an empty `SharedSecret`.

**Affected Versions:**

*   Debian stretch: influxdb before version 1.1.1+dfsg1-4+deb9u1
*   Debian buster: influxdb before version 1.6.4-1+deb10u1

**Mitigation:**

*   Upgrade to a patched version of InfluxDB.
*   Ensure that a strong, non-empty `SharedSecret` is configured when using JWT Bearer Authentication.

**Additional details:**

*   The issue was reported on GitHub as issue #12927.
*   The fix was implemented by adding a check for an empty `SharedSecret` in the `authenticate` function. If the `SharedSecret` is empty, authentication will fail.
*   The commit that fixed the issue is 761b557315ff9c1642cf3b0e5797cd3d983a24c0.