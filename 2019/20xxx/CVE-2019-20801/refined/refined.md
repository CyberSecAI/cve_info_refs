The provided content describes two vulnerabilities in the Documents iOS file manager app by Readdle:

1.  **Cross-Site Scripting (XSS)**

    *   **Root Cause:** The application improperly displays user-controllable data in the current directory path above the file list, allowing for the execution of arbitrary JavaScript code.
    *   **Weakness:** Lack of proper sanitization/escaping of user-supplied input (directory names) when rendering the web page.
    *   **Attack Vector:** An attacker can create a directory with a malicious JavaScript payload embedded in its name.  The victim then needs to navigate to this directory within the Documents app's HTTP server interface in a browser.
    *   **Exploitation Steps:**
        1.  The attacker creates a malicious directory with an XSS payload in its name. To make the attack more convincing, the malicious directory can be packaged inside a ZIP archive along with a decoy file (e.g., a .docx file, which Documents cannot open).
        2.  The attacker sends the ZIP archive to the victim (e.g., via email).
        3.  The victim saves the attachment in Documents, unpacks it, and may try to open the decoy file, prompting them to use the HTTP server feature.
        4.  The victim opens a browser, navigates to the Documents HTTP server, and enters the directory from the archive, triggering the XSS payload.
    *   **Impact:** An attacker can gain full control over the affected web page within the origin. The provided proof-of-concept steals files from the Documents app by reading the list of files and directories, recursively going through them and sending them to the attacker's server.
    *   **Attacker Capabilities:** Requires the ability to send a file to the victim and convince them to use the HTTP server feature and navigate to the malicious directory. The attacker also needs a server to host the malicious JavaScript and receive the stolen files.

2.  **Lack of Authorization**

    *   **Root Cause:** The Documents app's WebSocket interface for accessing photos lacks authentication.  The `GET /rdwifidrive/web_socket_url` endpoint, which provides the WebSocket URL, doesn't require a `Session-Id` header.  The WebSocket communication itself also does not enforce authentication.
    *   **Weakness:** Missing authentication checks on the WebSocket endpoint and communication.
    *   **Attack Vector:** An attacker can connect to the WebSocket without authentication and retrieve paths to photos stored in the "Photo Albums" directory.  The attacker can then download these photos using the retrieved paths, as the photo retrieval endpoint also lacks authentication. The `Access-Control-Allow-Origin: *` header makes the application additionally vulnerable to CSRF.
    *   **Exploitation Steps:**
        1.  The attacker prepares a malicious website that:
            1.  Gets the WebSocket URL from the Documents app.
            2.  Connects to the WebSocket and retrieves photo paths.
            3.  Downloads photos using the retrieved paths.
            4.  Sends the downloaded photos to the attacker's server.
        2.  The attacker tricks the victim into opening the malicious website.
    *   **Impact:** An attacker can steal photos from the victim's device.
    *   **Attacker Capabilities:**  The attacker needs to host a malicious website and trick the victim into visiting it while the Documents app's HTTP server is running. The attacker needs to know or guess the IP address of the device running the Documents app.  If the victim uses tethering, the IP address is consistently `172.20.10.1`.

    The vulnerabilities were reported to Readdle and fixed in an update.

    This content provides more detail than a typical CVE description.