Based on the provided information, here's an analysis of CVE-2019-20387:

**Root cause of vulnerability:**
- A heap-based buffer over-read in the `repodata_schema2id` function within `repodata.c` of the libsolv library.

**Weaknesses/vulnerabilities present:**
- The vulnerability arises when the length of the last schema in `data->schemadata` is less than the length of the input schema being compared.
- The `memcmp` function attempts to read beyond the allocated buffer for the schema data, leading to a heap-based buffer over-read.

**Impact of exploitation:**
-  A read overflow occurs, potentially leading to denial of service or other unspecified impacts. The provided information does not go into the specifics beyond a read overflow.

**Attack vectors:**
- The vulnerability can be triggered by manipulating the schema data, specifically by providing a last schema with length less than the input schema.
- The `repodata_schema2id` function is involved in the schema comparison process, which implies that the vulnerability exists in the component that is responsible for handling and comparing schemas.

**Required attacker capabilities/position:**
- An attacker needs to be able to control or influence the schema data being processed by the `repodata_schema2id` function.
- The attacker does not need to be local, as the attack vector involves data manipulation, it can be triggered by remote input.

**Additional details:**
- The vulnerability was fixed in libsolv version `0.6.5-1+deb8u1` for Debian 8 "Jessie".
- The fix involves adding a length check before the `memcmp` call to ensure that the read operation does not go beyond the buffer bounds.
- The commit diff shows the added length check using: `(data->schemata[cid] + len <= data->schemadatalen)` before calling `memcmp`.