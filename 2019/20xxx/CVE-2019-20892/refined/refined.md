```
{
  "CVE-2019-20892": {
    "related_content": [
      {
        "source": "bugs.launchpad.net_4604914f_20250120_231123.html",
        "vulnerability": {
          "root_cause": "A double free error occurs within the snmpd daemon when handling bulkget requests using the SNMPv3 protocol, specifically when the operation encounters an error.",
          "weaknesses": [
            "Double free vulnerability in the `usm_free_usmStateReference` function of the net-snmp library."
          ],
          "impact": "The snmpd daemon crashes due to the double free error, causing a denial of service (DoS).",
          "attack_vectors": "The vulnerability can be triggered remotely by sending a crafted SNMPv3 `snmpbulkget` request.",
          "attacker_capabilities": "An attacker needs to be an authenticated user with the ability to send `snmpbulkget` requests using the SNMPv3 protocol."
        },
          "patches": [
              "move-securityStateRef-into-free_securityStateRef.patch",
              "prevent-snmpv3-bulkget-errors-double-free.patch",
              "fix-usmStateReference-free.patch",
              "unexport-struct-usmStateReference.patch",
              "introduce-refcount-usmStateReference.patch"
          ]
      },
        {
          "source": "usn.ubuntu.com_c345e1e7_20250120_231127.html",
          "vulnerability": {
            "root_cause": "A double-free bug exists in the snmpd server.",
              "weaknesses": [
              "Double-free vulnerability."
            ],
            "impact": "An authenticated user can cause a denial-of-service (DoS) by sending a crafted request to the server.",
            "attack_vectors": "Crafted SNMPv3 request.",
            "attacker_capabilities": "Authenticated user."
          },
           "packages": [
              "libsnmp-base",
              "libsnmp-perl",
              "libsnmp35",
              "snmpd"
          ]
        },
      {
        "source": "github.com_6f104bbe_20250120_231126.html",
          "vulnerability": {
              "root_cause": "The patch introduces a reference count in `struct usmStateReference` to fix a double free issue.",
            "weaknesses": [
              "Double free."
            ],
              "impact": "The patch fixes the double free vulnerability",
              "attack_vectors": "SNMPv3 bulkget requests can trigger the double free",
              "attacker_capabilities": "An attacker must be able to send a crafted snmpv3 bulkget request"
           },
           "patches": [
               "Introduce a reference count in `struct usmStateReference`"
           ]
      },
      {
        "source": "security.gentoo.org_fc108255_20250120_231126.html",
        "vulnerability": {
          "root_cause": "Multiple vulnerabilities discovered in Net-SNMP.",
          "weaknesses": [
             "Unspecified vulnerabilities"
          ],
          "impact": "The worst of which could result in privilege escalation. Specific impact details are not provided in the source.",
          "attack_vectors": "Local and Remote exploitation.",
           "attacker_capabilities": "Not Specified"
         },
          "affected_versions": "< 5.8.1_pre1"
      },
      {
        "source": "launchpad.net_3ce3bb9a_20250121_011516.html",
        "vulnerability": {
          "root_cause": "Fixes a segmentation fault that occurs when using the SNMPv3 protocol with snmpbulkget.",
            "weaknesses": [
            "Double-free vulnerability"
          ],
            "impact": "The fix prevents a segmentation fault and service crash when using snmpv3 with snmpbulkget.",
            "attack_vectors": "Crafted SNMPv3 bulkget requests",
            "attacker_capabilities": "Authenticated users"
        },
        "patches":[
              "move-securityStateRef-into-free_securityStateRef.patch",
              "prevent-snmpv3-bulkget-errors-double-free.patch",
              "fix-usmStateReference-free.patch",
              "unexport-struct-usmStateReference.patch",
              "introduce-refcount-usmStateReference.patch"
          ]
      },
      {
        "source": "www.openwall.com_c0054a9d_20250120_231122.html",
        "vulnerability": {
          "root_cause": "Double free in `usm_free_usmStateReference` in snmplib/snmpusm.c via an SNMPv3 GetBulk request.",
          "weaknesses": [
            "Double-free vulnerability in usm_free_usmStateReference function"
          ],
          "impact": "Denial of Service (DoS) due to a crash.",
          "attack_vectors": "Remote, via a crafted SNMPv3 GetBulk request.",
          "attacker_capabilities": "An authenticated user can trigger this by sending an `snmpbulkget` command"
        }
      },
        {
            "source": "bugzilla.redhat.com_e2b1019d_20250120_231125.html",
              "vulnerability": {
              "root_cause": "The `net-snmpd` service experiences a double free or corruption error after upgrading the net-snmp package, especially when started by systemd",
              "weaknesses": [
                "Double free or corruption error"
              ],
                "impact": "The `net-snmpd` service crashes after some time with a `double free or corruption (fasttop)` error. This causes the service to exit with a core dump resulting in denial of service",
                "attack_vectors": "Not explicitly specified, but it appears to be triggered by normal SNMP requests that expose the underlying bug.",
                "attacker_capabilities": "Not specified, but occurs during normal operation of SNMP when started by systemd"
            }
        }
    ],
    "summary": "The vulnerability is a double-free issue in the `usm_free_usmStateReference` function of the Net-SNMP library. It is triggered by a crafted SNMPv3 bulkget request, leading to a crash of the `snmpd` service and thus a denial of service. The vulnerability exists in multiple Linux distributions due to backported patches, even if not present in upstream releases. Patches involve introducing a reference count in the `usmStateReference` structure and consolidating the check of the securityStateRef pointer in a free function.",
      "affected_versions": "Prior to 5.8.1.pre1",
    "cvss_base_score": "8.8",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe": "CWE-415",
    "products": [
      "net-snmp"
    ]
  }
}
```