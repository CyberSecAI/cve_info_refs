```json
{
  "vulnerability": {
    "cve": "CVE-2019-20048",
    "description": "Alcatel-Lucent Omnivista 8770 post-auth RCE",
    "details": "The Alcatel-Lucent Omnivista 8770 suffers from an authenticated remote code execution vulnerability. By default, the installation also listens on port 389. By connecting to port 389 with the leaked credentials, one can edit the whole ldap tree including seeing and modifying the hashed password `AdminNmc` user which is the administrator of the PHP web interface. By using the newly obtained credentials it should not be a problem to upload a PHP file as an asset of an existing template.",
    "affected_products": [
      "OmniVista 8770"
    ],
    "affected_versions": [
      "Before 4.1.12"
    ],
    "fixed_versions": [
      "4.1.12",
      "4.2"
    ],
    "attack_vector": "Remote",
    "attack_complexity": "Skilled",
    "privileges_required": "Authenticated",
    "user_interaction": "None",
    "scope": "System",
    "confidentiality_impact": "High",
    "integrity_impact": "High",
    "availability_impact": "High",
    "root_cause": "The code use the `COM` native PHP module to run some shell commands in order to get the LDAP bind credentials, which in this case are of \"cn=directory manager\" that is the administrator user of the instance. The password is encoded with a simple reversible algorithm we'll see below. Then the data is secured in the user session, which is stored server side.While this code is bad, and the whole idea of putting the cleartext credentials in the registry doesn't make sense to me, the real problem is a webserver configuration: all user session files are stored in a public directory! So by just starting a session and getting the respective session file it is possible to get the credentials.",
    "weaknesses": [
      "Remote administrative password disclosure",
      "Authenticated remote code execution vulnerability"
    ],
    "impact": "Remote access / Disrupt service (denial of service)",
    "remediation": "Upgrade to version 4.1.12 or 4.2"
  }
}
```