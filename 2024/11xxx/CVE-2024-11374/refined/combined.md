=== Content from plugins.trac.wordpress.org_cbae2b59_20250114_195331.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ftwchat%2Ftags%2F4.0.3%2Fclasses%2FAddon_controller.class.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/twchat/tags/4.0.3/classes/Addon_controller.class.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/twchat/tags/4.0.3/classes/Addon_controller.class.php)

---

# [source:](/browser?order=name "Go to repository root") [twchat](/browser/twchat?order=name "View twchat")/[tags](/browser/twchat/tags?order=name "View tags")/[4.0.3](/browser/twchat/tags/4.0.3?order=name "View 4.0.3")/[classes](/browser/twchat/tags/4.0.3/classes?order=name "View classes")/[Addon\_controller.class.php](/browser/twchat/tags/4.0.3/classes/Addon_controller.class.php?order=name "View Addon_controller.class.php")

View diff against:

View revision:

| [Last change](/changeset/2994689/twchat/tags/4.0.3/classes/Addon_controller.class.php "View differences") on this file was [2994689](/changeset/2994689/ "View changeset 2994689"), checked in by rezaplus, [14 months ago](/timeline?from=2023-11-12T13%3A08%3A12Z&precision=second "See timeline at 11/12/2023 01:08:12 PM") |
| --- |
| update to 4.0.4 |
| **File size:** 23.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* Add-ons controller class |
| [5](#L5) | \* load activated add-ons |
| [6](#L6) | \* This class show add-ons page in wordpress admin menu |
| [7](#L7) | \* Handle add-ons actions like activate, deactivate |
| [8](#L8) | \* |
| [9](#L9) | \* @package TWChat |
| [10](#L10) | \* @since 4.0.0 |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | namespace twchat\classes; |
| [14](#L14) |  |
| [15](#L15) | // Exit if accessed directly |
| [16](#L16) | if (!defined('ABSPATH')) { |
| [17](#L17) | exit; |
| [18](#L18) | } |
| [19](#L19) |  |
| [20](#L20) | class Addon\_controller |
| [21](#L21) | { |
| [22](#L22) | /\*\* |
| [23](#L23) | \* Add-ons page name |
| [24](#L24) | \* @var string |
| [25](#L25) | \*/ |
| [26](#L26) | public $addonsPage = 'TWChat\_addons'; |
| [27](#L27) |  |
| [28](#L28) | /\*\* |
| [29](#L29) | \* Add-ons api url |
| [30](#L30) | \* @var string |
| [31](#L31) | \*/ |
| [32](#L32) | private $addonsApiUrl = 'https://hooks.rellaco.com/hook/addons/v1/?plugin=twchat'; |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Installed add-ons list who installed in wordpress as plugin or located in twchat add-ons folder |
| [36](#L36) | \* @var array |
| [37](#L37) | \*/ |
| [38](#L38) | public $installed\_addons = array(); |
| [39](#L39) | /\*\* |
| [40](#L40) | \* activated add-ons list who activated in wordpress as plugin or located in twchat add-ons folder |
| [41](#L41) | \* @var array |
| [42](#L42) | \*/ |
| [43](#L43) | public $activated\_addons = array(); |
| [44](#L44) |  |
| [45](#L45) | /\*\* |
| [46](#L46) | \* constructor of addons class |
| [47](#L47) | \* |
| [48](#L48) | \* @var void |
| [49](#L49) | \*/ |
| [50](#L50) | public function \_\_construct() |
| [51](#L51) | { |
| [52](#L52) | $this->get\_installed\_addons(); // get installed add-ons |
| [53](#L53) | $this->get\_activated\_addons(); // get activated add-ons |
| [54](#L54) | $this->load\_activated\_addons(); // load local activated add-ons |
| [55](#L55) | add\_action('plugins\_loaded', array($this, 'load\_addons\_ls'), 10); |
| [56](#L56) | add\_action('admin\_menu', array($this, 'add\_addons\_page'), 10); // register addons page |
| [57](#L57) | add\_action('admin\_enqueue\_scripts', array($this, 'load\_scripts')); // load scripts and styles |
| [58](#L58) | } |
| [59](#L59) |  |
| [60](#L60) | /\*\* |
| [61](#L61) | \* load activated add-ons |
| [62](#L62) | \* NOTE: |
| [63](#L63) | \* Add-ons main file name is same as add-on folder name. |
| [64](#L64) | \* Add-ons main file must be located in add-on folder. |
| [65](#L65) | \* |
| [66](#L66) | \* this function load only local and activated add-ons. as a result, external add-ons not loaded here. |
| [67](#L67) | \* external add-ons loaded in own plugin file. |
| [68](#L68) | \* |
| [69](#L69) | \* @var void |
| [70](#L70) | \*/ |
| [71](#L71) | public function load\_activated\_addons() |
| [72](#L72) | { |
| [73](#L73) | foreach ($this->activated\_addons as $addon) { |
| [74](#L74) | $addon\_path = TWCHAT\_ADDONS\_PATH . $addon . '/' . $addon . '.php'; |
| [75](#L75) | if (file\_exists($addon\_path) && is\_readable($addon\_path)) { |
| [76](#L76) | include\_once $addon\_path; |
| [77](#L77) | } |
| [78](#L78) | } |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | /\*\* |
| [82](#L82) | \* Register add-ons page in wordpress admin menu |
| [83](#L83) | \* |
| [84](#L84) | \* @var void |
| [85](#L85) | \*/ |
| [86](#L86) | public function add\_addons\_page() |
| [87](#L87) | { |
| [88](#L88) | add\_submenu\_page( |
| [89](#L89) | 'twchat', |
| [90](#L90) | \_\_('Add-ons', 'twchatlang'), |
| [91](#L91) | \_\_('Add-ons', 'twchatlang'), |
| [92](#L92) | 'manage\_options', |
| [93](#L93) | $this->addonsPage, |
| [94](#L94) | array($this, 'displayAddonsPage'), |
| [95](#L95) | 20, |
| [96](#L96) | ); |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) |  |
| [100](#L100) |  |
| [101](#L101) | /\*\* |
| [102](#L102) | \* add-ons page callback function - display add-ons page |
| [103](#L103) | \* |
| [104](#L104) | \* @var html |
| [105](#L105) | \*/ |
| [106](#L106) | public function displayAddonsPage() |
| [107](#L107) | { |
| [108](#L108) | $action = $this->handleAddonActions(); // get action from url - thid variable is used in addons.php template |
| [109](#L109) | $addons = $this->generateAddonsDetails($this->getAddons\_from\_API\_OR\_DB()); |
| [110](#L110) |  |
| [111](#L111) | include\_once TWCHAT\_TEMPLATES\_PATH . 'admin/addons.php'; |
| [112](#L112) | if (empty($addons)) { |
| [113](#L113) | TWChat\_notice(\_\_('Something went wrong. Please try again later. if problem persists, contact support.', 'twchatlang'), 'error', false, array('text' => \_\_('Support', 'twchatlang'), 'url' => 'https://rellaco.com/support/', 'target' => '\_blank')); |
| [114](#L114) | } |
| [115](#L115) | } |
| [116](#L116) |  |
| [117](#L117) | /\*\* |
| [118](#L118) | \* Get add-ons list from api or database if exists |
| [119](#L119) | \* |
| [120](#L120) | \* @var void |
| [121](#L121) | \*/ |
| [122](#L122) | public function getAddons\_from\_API\_OR\_DB() |
| [123](#L123) | { |
| [124](#L124) | // get addons list from database |
| [125](#L125) | $addons = get\_option('twchat\_addons\_list'); |
| [126](#L126) | // if addons list exists in database and not expired, get addons list from database |
| [127](#L127) | if (isset($addons['addons']) && isset($addons['expired\_date']) && $addons['expired\_date'] > date('Y-m-d H:i:s') && TWCH\_DEV\_MODE == false) { |
| [128](#L128) | $result = $addons; |
| [129](#L129) | } else { // if addons list not exists in database or expired, get addons list from api |
| [130](#L130) | $result = $this->fetchAddonsDetailsFromAPI(); |
| [131](#L131) | if (isset($result['addons'])) { // save addons list in database if exists |
| [132](#L132) | update\_option('twchat\_addons\_list', $result); |
| [133](#L133) | } |
| [134](#L134) | } |
| [135](#L135) | return isset($result['addons']) ? $result['addons'] : array(); |
| [136](#L136) | } |
| [137](#L137) |  |
| [138](#L138) | /\*\* |
| [139](#L139) | \* Get installed add-ons list from wordpress plugins folder and twchat add-ons folder |
| [140](#L140) | \* |
| [141](#L141) | \* @var array |
| [142](#L142) | \*/ |
| [143](#L143) | public function get\_installed\_addons() |
| [144](#L144) | { |
| [145](#L145) | $internalAddonsDir = TWCHAT\_ADDONS\_PATH; |
| [146](#L146) |  |
| [147](#L147) | if (!is\_dir($internalAddonsDir) || !is\_readable($internalAddonsDir)) { |
| [148](#L148) | // Add appropriate error handling or logging here |
| [149](#L149) | return false; |
| [150](#L150) | } |
| [151](#L151) |  |
| [152](#L152) | // Get internal add-ons - add-ons installed as part of TWChat |
| [153](#L153) | $internalAddons = scandir($internalAddonsDir); |
| [154](#L154) |  |
| [155](#L155) | // Remove . and .. |
| [156](#L156) | $internalAddons = array\_diff($internalAddons, ['.', '..']); |
| [157](#L157) |  |
| [158](#L158) | // Get external add-ons - add-ons installed as plugins |
| [159](#L159) | $externalAddons = $this->get\_external\_addons(); |
| [160](#L160) | $externalAddonNames = array\_map(function ($addon) { |
| [161](#L161) | return basename($addon, '.php'); |
| [162](#L162) | }, array\_keys($externalAddons)); |
| [163](#L163) |  |
| [164](#L164) | // Merge internal and external add-ons |
| [165](#L165) | $installedAddons = array\_merge($internalAddons, $externalAddonNames); |
| [166](#L166) |  |
| [167](#L167) | // Reorganize the array |
| [168](#L168) | $installedAddons = array\_values($installedAddons); |
| [169](#L169) |  |
| [170](#L170) | $this->installed\_addons = $installedAddons; |
| [171](#L171) |  |
| [172](#L172) | return $installedAddons; |
| [173](#L173) | } |
| [174](#L174) |  |
| [175](#L175) |  |
| [176](#L176) | /\*\* |
| [177](#L177) | \* Handle addon actions and return the result |
| [178](#L178) | \* |
| [179](#L179) | \* @return mixed|false The result of the action or false if no action is performed |
| [180](#L180) | \*/ |
| [181](#L181) | public function handleAddonActions() |
| [182](#L182) | { |
| [183](#L183) | $result = false; |
| [184](#L184) |  |
| [185](#L185) | if (isset($\_GET['twchat\_activate\_addon'])) { |
| [186](#L186) | $result = $this->activate\_addon($\_GET['twchat\_activate\_addon']); |
| [187](#L187) | } |
| [188](#L188) | if (isset($\_GET['twchat\_deactivate\_addon'])) { |
| [189](#L189) | $result = $this->deactivate\_addon($\_GET['twchat\_deactivate\_addon']); |
| [190](#L190) | } |
| [191](#L191) |  |
| [192](#L192) | // Remove action from URL without reloading the page |
| [193](#L193) | if (isset($\_GET['reload']) && $\_GET['reload'] === 'true' && isset($\_GET['result'])) { |
| [194](#L194) | $this->notice\_action\_result($\_GET['result']); |
| [195](#L195) | $url = remove\_query\_arg( |
| [196](#L196) | ['reload', 'result', 'twchat\_activate\_addon', 'twchat\_deactivate\_addon'] |
| [197](#L197) | ); |
| [198](#L198) | echo "<script>history.replaceState({}, '', '$url');</script>"; |
| [199](#L199) | } elseif ($result !== false) { |
| [200](#L200) | wp\_redirect(admin\_url('admin.php?page=' . $this->addonsPage . '&reload=true&result=' . $result)); |
| [201](#L201) | exit; |
| [202](#L202) | } |
| [203](#L203) |  |
| [204](#L204) | return $result; |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) |  |
| [208](#L208) | /\*\* |
| [209](#L209) | \* Notice result of action in add-ons page |
| [210](#L210) | \* |
| [211](#L211) | \* @param string $result |
| [212](#L212) | \* @return void |
| [213](#L213) | \*/ |
| [214](#L214) | public function notice\_action\_result($result) |
| [215](#L215) | { |
| [216](#L216) | switch ($result) { |
| [217](#L217) | case 'activated': |
| [218](#L218) | $message = sprintf(\_\_('Congratulations! Add-on activated successfully. <b> Configure it from %s.</b>', 'twchatlang'), '<a href="' . admin\_url('admin.php?page=TWChat\_settings') . '">' . \_\_('TWChat Settings', 'twchatlang') . '</a>'); |
| [219](#L219) | $type = 'success'; |
| [220](#L220) | break; |
| [221](#L221) | case 'deactivated': |
| [222](#L222) | $message = \_\_('Add-on deactivated successfully.', 'twchatlang'); |
| [223](#L223) | $type = 'success'; |
| [224](#L224) | break; |
| [225](#L225) | case 'not\_installed': |
| [226](#L226) | $message = \_\_('Add-on not installed.', 'twchatlang'); |
| [227](#L227) | $type = 'error'; |
| [228](#L228) | break; |
| [229](#L229) | case 'already\_activated': |
| [230](#L230) | $message = \_\_('Add-on already activated.', 'twchatlang'); |
| [231](#L231) | $type = 'warning'; |
| [232](#L232) | break; |
| [233](#L233) | case 'already\_deactivated': |
| [234](#L234) | $message = \_\_('Add-on already deactivated.', 'twchatlang'); |
| [235](#L235) | $type = 'warning'; |
| [236](#L236) | break; |
| [237](#L237) | case 'not\_found': |
| [238](#L238) | $message = \_\_('Add-on not found.', 'twchatlang'); |
| [239](#L239) | $type = 'error'; |
| [240](#L240) | break; |
| [241](#L241) | case 'error': |
| [242](#L242) | $message = \_\_('Error, Please try again later.', 'twchatlang'); |
| [243](#L243) | $type = 'error'; |
| [244](#L244) | break; |
| [245](#L245) | default: |
| [246](#L246) | $message = ''; |
| [247](#L247) | $type = ''; |
| [248](#L248) | break; |
| [249](#L249) | } |
| [250](#L250) | if (!empty($message)) { |
| [251](#L251) | TWChat\_notice($message, $type); |
| [252](#L252) | } |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) |  |
| [256](#L256) | /\*\* |
| [257](#L257) | \* get list of activated addons from database |
| [258](#L258) | \* |
| [259](#L259) | \*/ |
| [260](#L260) | public function get\_activated\_addons() |
| [261](#L261) | { |
| [262](#L262) | $this->activated\_addons = get\_option('twchat\_activated\_addons', array()); |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | /\*\* |
| [266](#L266) | \* check addon activation status |
| [267](#L267) | \* |
| [268](#L268) | \* @param string $addon |
| [269](#L269) | \* @return boolean true if addon is activated, false if not activated |
| [270](#L270) | \*/ |
| [271](#L271) | public function is\_activated($addon) |
| [272](#L272) | { |
| [273](#L273) | return in\_array($addon, $this->activated\_addons) ? true : false; |
| [274](#L274) | } |
| [275](#L275) |  |
| [276](#L276) | /\*\* |
| [277](#L277) | \* check addon installation status |
| [278](#L278) | \* |
| [279](#L279) | \* @param string $addon |
| [280](#L280) | \* @return boolean true if addon is installed, false if not installed |
| [281](#L281) | \*/ |
| [282](#L282) | public function is\_installed($addon) |
| [283](#L283) | { |
| [284](#L284) | // check if add-on exists |
| [285](#L285) | return in\_array($addon, $this->installed\_addons) ? true : false; |
| [286](#L286) | } |
| [287](#L287) |  |
| [288](#L288) | /\*\* |
| [289](#L289) | \* Generate addons details array from api response |
| [290](#L290) | \* |
| [291](#L291) | \* @param array $addons\_list The list of addons |
| [292](#L292) | \* @return array The addons list with button details added |
| [293](#L293) | \*/ |
| [294](#L294) | public function generateAddonsDetails($addons\_list) |
| [295](#L295) | { |
| [296](#L296) | // If addons list is empty, return an empty array |
| [297](#L297) | if (empty($addons\_list)) { |
| [298](#L298) | return []; |
| [299](#L299) | } |
| [300](#L300) |  |
| [301](#L301) | foreach ($addons\_list as $key => $addon) { |
| [302](#L302) | $is\_installed = $this->is\_installed($key); |
| [303](#L303) | $is\_activated = $this->is\_activated($key); |
| [304](#L304) | $button\_details = $this->prepareAddonButtonData($is\_installed, $is\_activated, $key, $addon); |
| [305](#L305) |  |
| [306](#L306) | $addons\_list[$key]['button'] = [ |
| [307](#L307) | 'text' => $button\_details['text'], |
| [308](#L308) | 'class' => $button\_details['class'], |
| [309](#L309) | 'link' => $button\_details['link'], |
| [310](#L310) | 'target' => $button\_details['target'], |
| [311](#L311) | 'PriceDetails' => $button\_details['PriceDetails'], |
| [312](#L312) | ]; |
| [313](#L313) |  |
| [314](#L314) | $addons\_list[$key]['infoButton'] = [ |
| [315](#L315) | 'text' => \_\_('More Details', 'twchatlang'), |
| [316](#L316) | 'link' => $addon['Doc'], |
| [317](#L317) | ]; |
| [318](#L318) |  |
| [319](#L319) | $addons\_list[$key]['PriceDetails'] = ''; |
| [320](#L320) |  |
| [321](#L321) | if (strtolower($addon['PricingModel']) == 'paid' && $this->is\_installed($key)) { |
| [322](#L322) | $ls\_status = $this->get\_ls\_data($key, 'status'); |
| [323](#L323) | if ($ls\_status) { |
| [324](#L324) | $addons\_list[$key]['ls'] = [ |
| [325](#L325) | 'status' => $ls\_status == 'active' ? \_\_('Active', 'twchatlang') : \_\_('Please activate your license key.', 'twchatlang'), |
| [326](#L326) | 'link' => admin\_url('admin.php?page=' . $key . '&referral=' . $this->addonsPage), |
| [327](#L327) | 'color' => $ls\_status == 'active' ? 'green' : '#e40003', |
| [328](#L328) | ]; |
| [329](#L329) | } else { |
| [330](#L330) | $addons\_list[$key]['ls'] = [ |
| [331](#L331) | 'status' => \_\_('Please activate your license key.', 'twchatlang'), |
| [332](#L332) | 'link' => admin\_url('admin.php?page=' . $key . '&referral=' . $this->addonsPage), |
| [333](#L333) | 'color' => '#e40003', |
| [334](#L334) | ]; |
| [335](#L335) | } |
| [336](#L336) | } |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) | return $addons\_list; |
| [340](#L340) | } |
| [341](#L341) |  |
| [342](#L342) |  |
| [343](#L343) |  |
| [344](#L344) | /\*\* |
| [345](#L345) | \* Prepare the data for the add-on button. |
| [346](#L346) | \* |
| [347](#L347) | \* @param bool   $isInstalled   Whether the add-on is installed in WordPress or TWChat. |
| [348](#L348) | \* @param bool   $isActivated   Whether the add-on is activated in WordPress. |
| [349](#L349) | \* @param string $key           The add-on key. |
| [350](#L350) | \* @param array  $addon         The add-on details. |
| [351](#L351) | \* |
| [352](#L352) | \* @return array The add-on button details. |
| [353](#L353) | \*/ |
| [354](#L354) | public function prepareAddonButtonData($isInstalled, $isActivated, $key, $addon = array()) |
| [355](#L355) | { |
| [356](#L356) | if ($isInstalled) { |
| [357](#L357) | if ($addon['Type'] == 'External' && !is\_plugin\_active($key . '/' . $key . '.php')) { |
| [358](#L358) | // External add-on not activated in WordPress |
| [359](#L359) | $text = \_\_('Activate in WordPress', 'twchatlang'); |
| [360](#L360) | $class = 'button button-primary'; |
| [361](#L361) | $link = admin\_url('plugins.php/?s=TWChat'); |
| [362](#L362) | $target = '\_self'; |
| [363](#L363) | $priceDetails = $addon['PricingModel'] == 'Free' ? 'Free Add-on' : \_\_('Paid Add-on', 'twchatlang'); |
| [364](#L364) | } else { |
| [365](#L365) | if ($isActivated) { |
| [366](#L366) | // Add-on installed and activated in WordPress |
| [367](#L367) | $text = \_\_('Deactivate', 'twchatlang'); |
| [368](#L368) | $class = 'button button-secondary'; |
| [369](#L369) | $link = "?page=$this->addonsPage&twchat\_deactivate\_addon=" . $key; |
| [370](#L370) | $target = '\_self'; |
| [371](#L371) | $priceDetails = $addon['PricingModel'] == 'Free' ? 'Free Add-on' : \_\_('Paid Add-on', 'twchatlang'); |
| [372](#L372) | } else { |
| [373](#L373) | // Add-on installed but not activated in TWChat |
| [374](#L374) | $text = \_\_('Activate', 'twchatlang'); |
| [375](#L375) | $class = 'button button-primary'; |
| [376](#L376) | $link = "?page=$this->addonsPage&twchat\_activate\_addon=" . $key; |
| [377](#L377) | $target = '\_self'; |
| [378](#L378) | $priceDetails = $addon['PricingModel'] == 'Free' ? 'Free Add-on' : \_\_('Paid Add-on', 'twchatlang'); |
| [379](#L379) | } |
| [380](#L380) | } |
| [381](#L381) | } else { |
| [382](#L382) | // Add-on not installed in WordPress or TWChat |
| [383](#L383) | if ($addon['PricingModel'] == 'Free') { |
| [384](#L384) | // Free add-on |
| [385](#L385) | $text = \_\_('Download', 'twchatlang'); |
| [386](#L386) | $class = 'button button-primary'; |
| [387](#L387) | $link = $addon['Url']; |
| [388](#L388) | $target = '\_blank'; |
| [389](#L389) | $priceDetails = 'Free Add-on'; |
| [390](#L390) | } else { |
| [391](#L391) | // Paid add-on |
| [392](#L392) | $text = \_\_('Purchase & Install', 'twchatlang'); |
| [393](#L393) | $class = 'button button-primary'; |
| [394](#L394) | $link = $addon['Url']; |
| [395](#L395) | $target = '\_blank'; |
| [396](#L396) | $priceDetails = \_\_('Paid Add-on', 'twchatlang'); |
| [397](#L397) | } |
| [398](#L398) | } |
| [399](#L399) |  |
| [400](#L400) | return array( |
| [401](#L401) | 'text' => $text, |
| [402](#L402) | 'class' => $class, |
| [403](#L403) | 'link' => $link, |
| [404](#L404) | 'target' => $target, |
| [405](#L405) | 'PriceDetails' => $priceDetails, |
| [406](#L406) | ); |
| [407](#L407) | } |
| [408](#L408) |  |
| [409](#L409) |  |
| [410](#L410) |  |
| [411](#L411) | /\*\* |
| [412](#L412) | \* Request the add-ons list from the API. |
| [413](#L413) | \* |
| [414](#L414) | \* @return array The add-ons list. |
| [415](#L415) | \*/ |
| [416](#L416) | public function fetchAddonsDetailsFromAPI() |
| [417](#L417) | { |
| [418](#L418) | $bearer = 'Bearer ' . 'YOUR\_BEARER\_TOKEN'; |
| [419](#L419) |  |
| [420](#L420) | // Prepare the headers for the API request |
| [421](#L421) | $headers = array( |
| [422](#L422) | 'Authorization' => $bearer, |
| [423](#L423) | ); |
| [424](#L424) |  |
| [425](#L425) | // Send a GET request to the add-ons API |
| [426](#L426) | $response = wp\_remote\_get($this->addonsApiUrl, array( |
| [427](#L427) | 'headers' => $headers, |
| [428](#L428) | )); |
| [429](#L429) |  |
| [430](#L430) | // Check if the API request encountered an error |
| [431](#L431) | if (is\_wp\_error($response)) { |
| [432](#L432) | // Error occurred, return an empty array |
| [433](#L433) | return array(); |
| [434](#L434) | } |
| [435](#L435) |  |
| [436](#L436) | // Check if the API response is successful (status code 200) |
| [437](#L437) | if ($response['response']['code'] !== 200) { |
| [438](#L438) | // Error occurred, return an empty array |
| [439](#L439) | return array(); |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | // Parse the response body as JSON |
| [443](#L443) | $addons\_list = json\_decode($response['body'], true); |
| [444](#L444) |  |
| [445](#L445) | return $addons\_list; |
| [446](#L446) | } |
| [447](#L447) |  |
| [448](#L448) | /\*\* |
| [449](#L449) | \* Get TWChat external addons from the installed plugins |
| [450](#L450) | \* |
| [451](#L451) | \* @return array The list of TWChat external addons |
| [452](#L452) | \*/ |
| [453](#L453) | public function get\_external\_addons() |
| [454](#L454) | { |
| [455](#L455) | // Check if the 'get\_plugins' function exists, require plugin.php if not |
| [456](#L456) | if (!function\_exists('get\_plugins')) { |
| [457](#L457) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [458](#L458) | } |
| [459](#L459) |  |
| [460](#L460) | $twchat\_plugins = array(); // Initialize an empty array for TWChat addons |
| [461](#L461) | $plugins = get\_plugins(); // Get all installed plugins |
| [462](#L462) |  |
| [463](#L463) | // Loop through each installed plugin and filter out TWChat addons |
| [464](#L464) | foreach ($plugins as $key => $plugin) { |
| [465](#L465) | if (strpos($key, 'twchat\_addon\_') !== false) { |
| [466](#L466) | $twchat\_plugins[$key] = $plugin; |
| [467](#L467) | } |
| [468](#L468) | } |
| [469](#L469) |  |
| [470](#L470) | return $twchat\_plugins; // Return the list of TWChat external addons |
| [471](#L471) | } |
| [472](#L472) |  |
| [473](#L473) |  |
| [474](#L474) | /\*\* |
| [475](#L475) | \* Activate an addon |
| [476](#L476) | \* |
| [477](#L477) | \* @param string $addon The addon to activate |
| [478](#L478) | \* @return string The activation result |
| [479](#L479) | \*/ |
| [480](#L480) | public function activate\_addon($addon) |
| [481](#L481) | { |
| [482](#L482) | if (!in\_array($addon, $this->installed\_addons)) { |
| [483](#L483) | return 'not\_installed'; // Addon is not installed |
| [484](#L484) | } |
| [485](#L485) | if (in\_array($addon, $this->activated\_addons)) { |
| [486](#L486) | return 'already\_activated'; // Addon is already activated |
| [487](#L487) | } |
| [488](#L488) |  |
| [489](#L489) | if ($this->checkRequirements($addon, true) !== true) { |
| [490](#L490) | return; // Addon requirements are not met |
| [491](#L491) | } |
| [492](#L492) |  |
| [493](#L493) | $this->lsHandler($addon); |
| [494](#L494) |  |
| [495](#L495) |  |
| [496](#L496) | // Activate the addon |
| [497](#L497) | $this->activated\_addons[] = $addon; |
| [498](#L498) |  |
| [499](#L499) | // Update the activated addons list |
| [500](#L500) | update\_option('twchat\_activated\_addons', $this->activated\_addons); |
| [501](#L501) |  |
| [502](#L502) | return 'activated'; // Addon activated successfully |
| [503](#L503) | } |
| [504](#L504) |  |
| [505](#L505) | /\*\* |
| [506](#L506) | \* Deactivate an addon |
| [507](#L507) | \* |
| [508](#L508) | \* @param string $addon The addon to deactivate |
| [509](#L509) | \* @return string The deactivation result |
| [510](#L510) | \*/ |
| [511](#L511) | public function deactivate\_addon($addon) |
| [512](#L512) | { |
| [513](#L513) | if (!in\_array($addon, $this->installed\_addons)) { |
| [514](#L514) | return 'not\_installed'; // Addon is not installed |
| [515](#L515) | } |
| [516](#L516) | if (!in\_array($addon, $this->activated\_addons)) { |
| [517](#L517) | return 'already\_deactivated'; // Addon is already deactivated |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | // Deactivate the addon |
| [521](#L521) | $this->activated\_addons = array\_diff($this->activated\_addons, array($addon)); |
| [522](#L522) |  |
| [523](#L523) | // Update the activated addons list |
| [524](#L524) | update\_option('twchat\_activated\_addons', $this->activated\_addons); |
| [525](#L525) |  |
| [526](#L526) | return 'deactivated'; // Addon deactivated successfully |
| [527](#L527) | } |
| [528](#L528) |  |
| [529](#L529) | // get addons data |
| [530](#L530) | public function get\_addons\_data() |
| [531](#L531) | { |
| [532](#L532) | $addons\_data = get\_option('twchat\_addons\_list'); |
| [533](#L533) | if (!$addons\_data) { |
| [534](#L534) | return false; |
| [535](#L535) | } |
| [536](#L536) | return $addons\_data; |
| [537](#L537) | } |
| [538](#L538) |  |
| [539](#L539) | // get ls data |
| [540](#L540) | public function get\_ls\_data($addon, $key = false) |
| [541](#L541) | { |
| [542](#L542) | $ls\_data = get\_option($addon . '\_ls\_data'); |
| [543](#L543) |  |
| [544](#L544) | if (!$ls\_data) { |
| [545](#L545) | return false; |
| [546](#L546) | } |
| [547](#L547) |  |
| [548](#L548) | if (!$key) { |
| [549](#L549) | return $ls\_data; |
| [550](#L550) | } |
| [551](#L551) |  |
| [552](#L552) | if (isset($ls\_data[$key])) { |
| [553](#L553) | return $ls\_data[$key]; |
| [554](#L554) | } |
| [555](#L555) |  |
| [556](#L556) | return false; |
| [557](#L557) | } |
| [558](#L558) |  |
| [559](#L559) | /\*\* |
| [560](#L560) | \* Check the addon requirements |
| [561](#L561) | \* |
| [562](#L562) | \* @param string $addon The addon to check |
| [563](#L563) | \* @param bool $checkVersion Whether to check the addon version or not |
| [564](#L564) | \* @return bool Whether the requirements are met or not |
| [565](#L565) | \*/ |
| [566](#L566) | public function checkRequirements($addon, $checkVersion = false) |
| [567](#L567) | { |
| [568](#L568) | // Get addon data |
| [569](#L569) | $addonData = $this->get\_addons\_data(); |
| [570](#L570) |  |
| [571](#L571) | if (!$addonData) { |
| [572](#L572) | twchat\_notice(\_\_('Something went wrong, please try again later.', 'twchatlang'), 'error'); |
| [573](#L573) | exit; |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | // Get addon requirements |
| [577](#L577) | $requiredPlugins = $addonData['addons'][$addon]['requires'] ?? false; |
| [578](#L578) |  |
| [579](#L579) | $passed = true; |
| [580](#L580) |  |
| [581](#L581) | // Check if required plugins are active |
| [582](#L582) | if ($requiredPlugins) { |
| [583](#L583) | foreach ($requiredPlugins as $plugin => $version) { |
| [584](#L584) | // If plugin has '/', it's an internal addon |
| [585](#L585) | if (strpos($plugin, '/')) { |
| [586](#L586) | // Get addon name |
| [587](#L587) | $internalAddon = explode('/', $plugin)[1]; |
| [588](#L588) |  |
| [589](#L589) | // Check if the addon is active |
| [590](#L590) | if (!in\_array($internalAddon, $this->activated\_addons)) { |
| [591](#L591) | twchat\_notice(sprintf(\_\_('%s add-on is required to activate this add-on. Please activate it first.', 'twchatlang'), $internalAddon), 'error'); |
| [592](#L592) | $passed = false; |
| [593](#L593) | } |
| [594](#L594) |  |
| [595](#L595) | // If version is set, check if the version is compatible |
| [596](#L596) | if (isset($version) && $checkVersion) { |
| [597](#L597) | $installedVersion = get\_plugin\_data(TWCHAT\_ADDONS\_PATH . $internalAddon . '/' . $internalAddon . '.php')['Version']; |
| [598](#L598) | // die(var\_dump(version\_compare($installedVersion, $version, '<=')).' '.$installedVersion.' '.$version); |
| [599](#L599) | if (version\_compare($installedVersion, $version, '<=')) { |
| [600](#L600) | twchat\_notice(sprintf(\_\_('%s add-on version %s or higher is required to activate this add-on. Please update it first.', 'twchatlang'), $internalAddon, $version), 'error'); |
| [601](#L601) | $passed = false; |
| [602](#L602) | } |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) | continue; |
| [606](#L606) | } |
| [607](#L607) |  |
| [608](#L608) | // Check if plugin is active |
| [609](#L609) | if (!is\_plugin\_active($plugin . '/' . $plugin . '.php')) { |
| [610](#L610) | twchat\_notice(sprintf(\_\_('%s plugin is required to activate this add-on. Please install and activate it first.', 'twchatlang'), $plugin), 'error'); |
| [611](#L611) | $passed = false; |
| [612](#L612) | continue; |
| [613](#L613) | } |
| [614](#L614) |  |
| [615](#L615) | // If version is set, check if the version is compatible |
| [616](#L616) | if (isset($version) && $checkVersion) { |
| [617](#L617) | $installedVersion = get\_plugin\_data(WP\_PLUGIN\_DIR . '/' . $plugin . '/' . $plugin . '.php')['Version']; |
| [618](#L618) | if (version\_compare($installedVersion, $version, '<=')) { |
| [619](#L619) | twchat\_notice(sprintf(\_\_('%s plugin version %s or higher is required to activate this add-on. Please update it first.', 'twchatlang'), $plugin, $version), 'error'); |
| [620](#L620) | $passed = false; |
| [621](#L621) | } |
| [622](#L622) | } |
| [623](#L623) | } |
| [624](#L624) | } |
| [625](#L625) |  |
| [626](#L626) | return $passed; |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) |  |
| [630](#L630) | /\*\* |
| [631](#L631) | \* ls handler |
| [632](#L632) | \* |
| [633](#L633) | \* @param string $addon The addon to handle |
| [634](#L634) | \* |
| [635](#L635) | \*/ |
| [636](#L636) | public function lsHandler($addon) |
| [637](#L637) | { |
| [638](#L638) | // get addon data |
| [639](#L639) | $addon\_data = $this->get\_addons\_data(); |
| [640](#L640) | $ls\_data = $this->get\_ls\_data($addon, 'status'); |
| [641](#L641) | if (!$addon\_data) { |
| [642](#L642) | twchat\_notice(\_\_('Something went wrong, please try again later.', 'twchatlang'), 'error'); |
| [643](#L643) | exit; |
| [644](#L644) | } |
| [645](#L645) |  |
| [646](#L646) | foreach ($addon\_data['addons'] as $key => $value) { |
| [647](#L647) | if ($key == $addon) { |
| [648](#L648) | if (isset($value['PricingModel'])) { |
| [649](#L649) | if (strtolower($value['PricingModel']) != 'paid') { |
| [650](#L650) | return; |
| [651](#L651) | } |
| [652](#L652) | } else { |
| [653](#L653) | return; |
| [654](#L654) | } |
| [655](#L655) | } |
| [656](#L656) | } |
| [657](#L657) |  |
| [658](#L658) | if (!$ls\_data || $ls\_data != 'active') { |
| [659](#L659) | wp\_redirect(admin\_url('admin.php?page=' . $\_GET['twchat\_activate\_addon'] . '&referral=' . $this->addonsPage)); |
| [660](#L660) | exit; |
| [661](#L661) | } |
| [662](#L662) | } |
| [663](#L663) |  |
| [664](#L664) | /\*\* |
| [665](#L665) | \* load addon ls |
| [666](#L666) | \* |
| [667](#L667) | \* @var void |
| [668](#L668) | \*/ |
| [669](#L669) | public function load\_addons\_ls() |
| [670](#L670) | { |
| [671](#L671) | $addons = $this->get\_addons\_data(); |
| [672](#L672) | if (!$addons) { |
| [673](#L673) | return; |
| [674](#L674) | } |
| [675](#L675) |  |
| [676](#L676) | foreach ($addons['addons'] as $key => $value) { |
| [677](#L677) | if (isset($value['PricingModel'])) { |
| [678](#L678) | if (strtolower($value['PricingModel']) == 'paid') { |
| [679](#L679) | $ls\_data = $this->get\_ls\_data($key, 'status'); |
| [680](#L680) | // check if addon is not active |
| [681](#L681) | if (!$ls\_data || $ls\_data != 'active') { |
| [682](#L682) | if (in\_array($key, $this->activated\_addons)) { |
| [683](#L683) | $this->deactivate\_addon($key); |
| [684](#L684) | } |
| [685](#L685) | } |
| [686](#L686) | // load addon ls |
| [687](#L687) | $addon\_path = WP\_PLUGIN\_DIR . '/' . $key . '/includes/addon.php'; |
| [688](#L688) | if (file\_exists($addon\_path) && is\_readable($addon\_path)) { |
| [689](#L689) | include\_once $addon\_path; |
| [690](#L690) | } |
| [691](#L691) | } |
| [692](#L692) | } |
| [693](#L693) | } |
| [694](#L694) | } |
| [695](#L695) |  |
| [696](#L696) |  |
| [697](#L697) | /\*\* |
| [698](#L698) | \* Load style for addons panel by twchat\_load\_scripts helper function |
| [699](#L699) | \* @return void |
| [700](#L700) | \*/ |
| [701](#L701) | public function load\_scripts() |
| [702](#L702) | { |
| [703](#L703) | // Load CSS |
| [704](#L704) | twchat\_load\_scripts( |
| [705](#L705) | 'css', // Type: CSS |
| [706](#L706) | 'twchat-addons-panel', // Handle for the stylesheet |
| [707](#L707) | TWCHAT\_ASSETS\_URL . '/css/twchat\_addons\_panel.css', // URL to the CSS file |
| [708](#L708) | array(), |
| [709](#L709) | array('twchat\_page\_TWChat\_addons'), |
| [710](#L710) | TWCH\_VERSION // Version number of the TWChat plugin |
| [711](#L711) | ); |
| [712](#L712) | } |
| [713](#L713) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/twchat/tags/4.0.3/classes/Addon_controller.class.php?format=txt)
* [Original Format](/export/3222464/twchat/tags/4.0.3/classes/Addon_controller.class.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_cb396e9f_20250114_195333.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# TWChat – Send or receive messages from users <= 4.0.4 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   TWChat – Send or receive messages from users <= 4.0.4 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11374](https://www.cve.org/CVERecord?id=CVE-2024-11374) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | December 6, 2024 |
| Last Updated | December 7, 2024 |
| Researcher | [vgo0](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dale-mavers) |

### Description

The TWChat – Send or receive messages from users plugin for WordPress is vulnerable to Reflected Cross-Site Scripting due to the use of remove\_query\_arg without appropriate escaping on the URL in all versions up to, and including, 4.0.4. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/twchat/tags/4.0.3/classes/Addon_controller.class.php#L198)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftwchat%2Ftwchat-send-or-receive-messages-from-users-404-reflected-cross-site-scripting&t=TWChat%20%E2%80%93%20Send%20or%20receive%20messages%20from%20users%20%3C%3D%204.0.4%20-%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftwchat%2Ftwchat-send-or-receive-messages-from-users-404-reflected-cross-site-scripting&text=TWChat%20%E2%80%93%20Send%20or%20receive%20messages%20from%20users%20%3C%3D%204.0.4%20-%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ftwchat%2Ftwchat-send-or-receive-messages-from-users-404-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for TWChat – Send or receive messages from users

#### [TWChat – Send or receive messages from users](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/twchat)

| Software Type | Plugin |
| --- | --- |
| Software Slug | twchat [(view on wordpress.org)](https://wordpress.org/plugins/twchat) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 4.0.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


