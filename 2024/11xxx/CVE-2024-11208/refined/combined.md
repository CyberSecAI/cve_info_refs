=== Content from ibb.co_feb1b805_20250114_221955.html ===

[![ImgBB](//simgbb.com/images/logo.png)](https://imgbb.com)

* About
  + [Plugin](https://imgbb.com/plugin)
  + [API](https://api.imgbb.com/)
  + [Terms of service](https://imgbb.com/tos)
  + [Privacy](https://imgbb.com/privacy)
  + [Contact](https://imgbb.com/contact)

* [Upload](https://imgbb.com/upload)
* [Sign in](https://imgbb.com/login)

![1](https://i.ibb.co/R9W5PHq/1.png)

* [![2](https://i.ibb.co/kmZLd4t/2.png)](https://ibb.co/kmZLd4t)
* [![1](https://i.ibb.co/1LxSK2k/1.png)](https://ibb.co/1LxSK2k)

[Like](https://imgbb.com/login)
Share

[![arthur-souza223](//simgbb.com/avatar/Xrh2rZVJpxBN.png)](https://arthur-souza223.imgbb.com/)
[**arthur-souza223**](https://arthur-souza223.imgbb.com/)

319 views

# [1](https://ibb.co/1LxSK2k)

Added to [SESSÃO NAO EXPIRA](https://ibb.co/album/J3qVDz) — 2 months ago

Embed codes

* Embed codes

#### Direct links

#### Image link

copy

#### Full image (linked)

#### HTML

copy

#### BBCode

copy

#### Thumbnail image (linked)

#### HTML

copy

#### BBCode

copy

Share

\_\_privacy\_notes\_\_

Link

copy



=== Content from gist.github.com_f39db425_20250114_221953.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@0xArthurSouza](https://avatars.githubusercontent.com/u/61798441?s=64&v=4)](/0xArthurSouza)

# [0xArthurSouza](/0xArthurSouza)/**[Session Token Does Not Expire Upon Logout.md](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e)** Secret

Created
November 5, 2024 00:31

Show Gist options

* [Download ZIP](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e/archive/b6d9a647abd973cb6e58b1aa932944879a5a515b.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e.js&quot;&gt;&lt;/script&gt;
* Save 0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e to your computer and use it in GitHub Desktop.

[Code](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e)
[Revisions
2](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e.js&quot;&gt;&lt;/script&gt;

Save 0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e to your computer and use it in GitHub Desktop.

[Download ZIP](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e/archive/b6d9a647abd973cb6e58b1aa932944879a5a515b.zip)

 [Raw](/0xArthurSouza/ce3b89887b03cc899d5e8cb6e472b04e/raw/b6d9a647abd973cb6e58b1aa932944879a5a515b/Session%2520Token%2520Does%2520Not%2520Expire%2520Upon%2520Logout.md)

[**Session Token Does Not Expire Upon Logout.md**](#file-session-token-does-not-expire-upon-logout-md)

## **Affected Version:**

* **Apereo CAS**: 6.6.x
* [apereo/cas: Apereo CAS - Identity & Single Sign On for all earthlings and beyond.](https://github.com/apereo/cas)

## **Vulnerability Information:**

* **Vulnerability Type:** Session Token Does Not Expire After Logout
* **Status:** Unpatched

## **Vulnerable Endpoint:**

* **Path:** `/login?service=`

## **Vulnerability Description:**

The web application has a security flaw in its authentication system, allowing session tokens to remain valid even after a user logs out. This means that, even after the session is terminated and the user has exited the system, the authentication token associated with the user can still be used to access protected resources.

When session tokens remain valid after the user logs out, even temporarily, it creates a security gap that can be exploited by malicious attackers. The direct impact of this flaw is that attackers may use these unexpired session tokens to continue accessing protected resources in the application, even without the legitimate user’s permission. This can lead to a range of adverse consequences, such as unauthorized access to sensitive information, manipulation of critical data, or even the execution of malicious actions on behalf of the legitimate user.

---

## **Proof of Concept (PoC):**

During the login process, various requests are made to list account data using session cookies. It was observed that, after logging out, the session cookies do not expire correctly, allowing account data access requests to still be executed.

<https://ibb.co/1LxSK2k>

<https://ibb.co/kmZLd4t>

## **Impact:**

* **Session Hijacking:** Attackers could exploit active session tokens to access accounts, impersonating users after they log out.
* **Unauthorized Access:** Persisting session tokens allow attackers to retain access to restricted areas without needing re-authentication.
* **Data Exposure:** Sensitive data may be exposed to unauthorized users who can continue to access a session post-logout.
* **Non-Compliance with Security Standards:** Regulations often require active session termination upon logout, and failure to do so may result in compliance issues.
* **Reputational Damage:** Users may lose trust in the application’s security, perceiving the logout process as ineffective.

---

## **Mitigation Recommendations:**

* **Session Invalidation on Logout:** Ensure that the session token is invalidated server-side immediately upon user logout, making it unusable for future requests.
* **Token Expiration and Rotation:** Use short-lived session tokens and rotate them frequently to limit the risk of token reuse.
* **Secondary Logout Verification:** Use a secondary verification mechanism (e.g., token blacklist) to ensure that the token cannot be reused after logout.
* **Automatic Session Timeout:** Implement automatic session expiration after a set period of inactivity to limit the lifespan of any active session.
* **Regular Security Audits and Testing:** Perform security assessments to confirm that session tokens are securely managed and expired correctly upon logout across all user scenarios.

---

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xArthurSouza%2Fce3b89887b03cc899d5e8cb6e472b04e)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


