=== Content from www.wordfence.com_273ba815_20250114_211405.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# dejure.org Vernetzungsfunktion <= 1.97.5 - Cross-Site Request Forgery to Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   dejure.org Vernetzungsfunktion <= 1.97.5 - Cross-Site Request Forgery to Stored Cross-Site Scripting

6.1

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11417](https://www.cve.org/CVERecord?id=CVE-2024-11417) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | December 11, 2024 |
| Last Updated | December 13, 2024 |
| Researcher | [SOPROBRO](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/soprobro-2) |

### Description

The dejure.org Vernetzungsfunktion plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 1.97.5. This is due to missing or incorrect nonce validation on the djo\_einstellungen\_menue() function. This makes it possible for unauthenticated attackers to update settings and inject malicious web scripts via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3206444%40dejureorg-vernetzungsfunktion&new=3206444%40dejureorg-vernetzungsfunktion&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fdejureorg-vernetzungsfunktion%2Fdejureorg-vernetzungsfunktion-1975-cross-site-request-forgery-to-stored-cross-site-scripting&t=dejure.org%20Vernetzungsfunktion%20%3C%3D%201.97.5%20-%20Cross-Site%20Request%20Forgery%20to%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fdejureorg-vernetzungsfunktion%2Fdejureorg-vernetzungsfunktion-1975-cross-site-request-forgery-to-stored-cross-site-scripting&text=dejure.org%20Vernetzungsfunktion%20%3C%3D%201.97.5%20-%20Cross-Site%20Request%20Forgery%20to%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fdejureorg-vernetzungsfunktion%2Fdejureorg-vernetzungsfunktion-1975-cross-site-request-forgery-to-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for dejure.org Vernetzungsfunktion

#### [dejure.org Vernetzungsfunktion](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/dejureorg-vernetzungsfunktion)

| Software Type | Plugin |
| --- | --- |
| Software Slug | dejureorg-vernetzungsfunktion [(view on wordpress.org)](https://wordpress.org/plugins/dejureorg-vernetzungsfunktion) |
| Patched? | Yes |
| Remediation | Update to version 1.98.0, or a newer patched version |
| Affected Version | * <= 1.97.5 |
| Patched Version | * 1.98.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_048fa1c7_20250114_211403.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fdejureorg-vernetzungsfunktion%2Ftrunk%2Fdejure.org-vernetzung.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php?rev=3207438 "Revision 3207438")
* Next Revision →
* [Blame](/browser/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php)

---

# [source:](/browser?order=name "Go to repository root") [dejureorg-vernetzungsfunktion](/browser/dejureorg-vernetzungsfunktion?order=name "View dejureorg-vernetzungsfunktion")/[trunk](/browser/dejureorg-vernetzungsfunktion/trunk?order=name "View trunk")/[dejure.org-vernetzung.php](/browser/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php?order=name "View dejure.org-vernetzung.php")

View diff against:

View revision:

| [Last change](/changeset/3207439/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php "View differences") on this file was [3207439](/changeset/3207439/ "View changeset 3207439"), checked in by dejure.org, [5 weeks ago](/timeline?from=2024-12-13T08%3A36%3A47Z&precision=second "See timeline at 12/13/2024 08:36:47 AM") |
| --- |
| Bumped version to 1.98.1. Added version info to readme.txt. |
| **File size:** 18.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Plugin Name:       dejure.org Vernetzungsfunktion |
| [4](#L4) | \* Plugin URI:        https://dejure.org/vernetzung.html |
| [5](#L5) | \* Description:       Diese Erweiterung verlinkt automatisch zitierte <strong>Gesetze und Rechtsprechung</strong> (Aktenzeichen und Fundstellen) mit den Inhalten von dejure.org. <strong><a href="options-general.php?page=dejure.org-vernetzung.php">Einstellungen</a></strong> |
| [6](#L6) | \* Version:           1.98.1 |
| [7](#L7) | \* Requires at least: 6.0 |
| [8](#L8) | \* Requires PHP:      7.4 |
| [9](#L9) | \* Author:            dejure.org |
| [10](#L10) | \* Author URI:        https://dejure.org/ |
| [11](#L11) | \* License:           GPL v2 or later |
| [12](#L12) | \* License URI:       https://www.gnu.org/licenses/gpl-2.0.html |
| [13](#L13) | \*/ |
| [14](#L14) |  |
| [15](#L15) | /\*  Copyright 2024  dejure.org  (email : info@dejure.org) |
| [16](#L16) |  |
| [17](#L17) | This program is free software; you can redistribute it and/or modify |
| [18](#L18) | it under the terms of the GNU General Public License, version 2, as |
| [19](#L19) | published by the Free Software Foundation. |
| [20](#L20) |  |
| [21](#L21) | This program is distributed in the hope that it will be useful, |
| [22](#L22) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [23](#L23) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [24](#L24) | GNU General Public License for more details. |
| [25](#L25) |  |
| [26](#L26) | You should have received a copy of the GNU General Public License |
| [27](#L27) | along with this program; if not, write to the Free Software |
| [28](#L28) | Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
| [29](#L29) | \*/ |
| [30](#L30) |  |
| [31](#L31) | defined('ABSPATH') or die("No script kiddies please!"); |
| [32](#L32) |  |
| [33](#L33) | define('DJO\_VERSION', '1.98.1'); |
| [34](#L34) |  |
| [35](#L35) | apply\_filters('plugin\_locale', 'de\_DE'); |
| [36](#L36) |  |
| [37](#L37) | function djo\_install() { |
| [38](#L38) | if (defined('ABSPATH') && is\_admin()) { |
| [39](#L39) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [40](#L40) | } |
| [41](#L41) |  |
| [42](#L42) | update\_option('djo\_cache\_prefix', 'djo\_'.wp\_rand()); |
| [43](#L43) | } |
| [44](#L44) |  |
| [45](#L45) | function djo\_uninstall() { |
| [46](#L46) | require\_once(ABSPATH.'wp-admin/includes/upgrade.php'); |
| [47](#L47) |  |
| [48](#L48) | delete\_option('djo\_cache\_prefix'); |
| [49](#L49) | delete\_option('djo\_einstellungen'); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | function djo\_update\_db\_check() { |
| [53](#L53) | if (get\_option('djo\_cache\_prefix') == '') { |
| [54](#L54) | djo\_install(); |
| [55](#L55) | } |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) |  |
| [59](#L59) | function djo\_init() { |
| [60](#L60) | global $djo\_nutzerdaten; |
| [61](#L61) | $djo\_nutzerdaten = djo\_hole\_einstellungen(); |
| [62](#L62) | } |
| [63](#L63) | add\_action('init', 'djo\_init'); |
| [64](#L64) | function djo\_cache\_leeren() { |
| [65](#L65) | update\_option('djo\_cache\_prefix', 'djo\_'.wp\_rand()); |
| [66](#L66) | } |
| [67](#L67) |  |
| [68](#L68) | function djo\_zwischenspeicherung() { |
| [69](#L69) | global $djo\_vernetzung\_in\_cache\_schreiben; |
| [70](#L70) | if (empty($djo\_vernetzung\_in\_cache\_schreiben)) { |
| [71](#L71) | return; |
| [72](#L72) | } |
| [73](#L73) | if (is\_array($djo\_vernetzung\_in\_cache\_schreiben)) { |
| [74](#L74) | foreach ($djo\_vernetzung\_in\_cache\_schreiben as $vernetzung) { |
| [75](#L75) | $key = get\_option('djo\_cache\_prefix') . '\_' . strlen($vernetzung[0]) . '-' . substr(md5($vernetzung[0]), 0, -1-strlen(strlen($vernetzung[0]))); |
| [76](#L76) | if ($vernetzung[0] == $vernetzung[1]) { |
| [77](#L77) | $text = '<!-- idem -->'; |
| [78](#L78) | } else { |
| [79](#L79) | $text = $vernetzung[1]; |
| [80](#L80) | } |
| [81](#L81) | set\_transient($key, $text, 172800); |
| [82](#L82) | } |
| [83](#L83) | } |
| [84](#L84) | unset($djo\_vernetzung\_in\_cache\_schreiben); |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | function vernetzen\_ueber\_dejure\_org($ausgangstext, $parameter = array()) { |
| [88](#L88) | // Moegliche Parameter: Anbieterkennung / Dokumentkennung / target / class / AktenzeichenIgnorieren / zeitlimit\_in\_sekunden |
| [89](#L89) | global $djo\_vernetzung\_erfolgt; |
| [90](#L90) | $djo\_vernetzung\_erfolgt = 0; |
| [91](#L91) | $uebergabe = 'Originaltext='.urlencode($ausgangstext); |
| [92](#L92) | foreach ($parameter as $option => $wert) { |
| [93](#L93) | if ($option == 'zeitlimit\_in\_sekunden') { |
| [94](#L94) | $zeitlimit\_in\_sekunden = $wert; |
| [95](#L95) | } else { |
| [96](#L96) | $uebergabe .= '&'.urlencode($option).'='.urlencode($wert); |
| [97](#L97) | } |
| [98](#L98) | } |
| [99](#L99) | if (empty($zeitlimit\_in\_sekunden)) { |
| [100](#L100) | $zeitlimit\_in\_sekunden = 2; |
| [101](#L101) | } |
| [102](#L102) | $home\_url = preg\_replace('#^https?://#', '', home\_url()); |
| [103](#L103) |  |
| [104](#L104) | $headers = [ |
| [105](#L105) | 'User-Agent' => $home\_url.' (Wordpress-Vernetzung '.DJO\_VERSION.')', |
| [106](#L106) | 'Content-Type' => 'application/x-www-form-urlencoded', |
| [107](#L107) | 'Content-Length' => strlen($uebergabe), |
| [108](#L108) | ]; |
| [109](#L109) | $args = [ |
| [110](#L110) | 'body' => $uebergabe, |
| [111](#L111) | 'headers' => $headers, |
| [112](#L112) | 'user-agent' => $home\_url.' (Wordpress-Vernetzung '.DJO\_VERSION.')', |
| [113](#L113) | 'timeout' => $zeitlimit\_in\_sekunden, |
| [114](#L114) | 'blocking' => true, |
| [115](#L115) | 'data\_format' => 'body' |
| [116](#L116) | ]; |
| [117](#L117) | $response = wp\_remote\_post('https://rechtsnetz.dejure.org/dienste/vernetzung/vernetzen', $args); |
| [118](#L118) | if (is\_wp\_error($response)) { |
| [119](#L119) | return $ausgangstext; |
| [120](#L120) | } |
| [121](#L121) | $rueckgabe = wp\_remote\_retrieve\_body($response); |
| [122](#L122) |  |
| [123](#L123) | if (strlen($rueckgabe) < strlen($ausgangstext)) { |
| [124](#L124) | return $ausgangstext; |
| [125](#L125) | } |
| [126](#L126) | $djo\_vernetzung\_erfolgt = 1; |
| [127](#L127) | return $rueckgabe; |
| [128](#L128) | } |
| [129](#L129) |  |
| [130](#L130) | function vernetzen\_ueber\_cache($ausgangstext) { |
| [131](#L131) | $temp = null; |
| [132](#L132) | $key = get\_option('djo\_cache\_prefix') . '\_' . strlen($ausgangstext) . '-' . substr(md5($ausgangstext), 0, -1-strlen(strlen($ausgangstext)));; |
| [133](#L133) | $rueckgabe = get\_transient($key); |
| [134](#L134) | if (!empty($rueckgabe)) { |
| [135](#L135) | $temp = $rueckgabe; |
| [136](#L136) | if ($temp == '<!-- idem -->') { |
| [137](#L137) | return $ausgangstext; |
| [138](#L138) | } |
| [139](#L139) | } |
| [140](#L140) | return $temp; |
| [141](#L141) | } |
| [142](#L142) |  |
| [143](#L143) | function djo\_vernetzen($text) { |
| [144](#L144) | global $djo\_nutzerdaten; |
| [145](#L145) | if (!preg\_match("/§|&sect;|&#167;|Artikel|Art\.|[\/\.] ?[0-9][0-9](?![0-9\/])| [0-9][0-9]?[\/\.] ?[0-9][0-9](?![0-9\.])| [A-Z]+ [0-9][0-9]\. ?[0-9]|[0-9][0-9],/", $text) || preg\_match("/<!-- \*ohnedjo \*-->/", $text)) { |
| [146](#L146) | return $text; |
| [147](#L147) | } |
| [148](#L148) | // Folgende Zeile durch Entfernung der "//" aktivieren, falls aufgrund eines vorgeschalteten Plugins erforderlich |
| [149](#L149) | // $text = preg\_replace("/<span class=\"caps\">([^<]\*)<\/span>/", "\\1", $text); # Sonderbehandlung fuer vorgeschaltete Plugins, die einen besonderen Span-Bereich um aufeinanderfolgede Großbuchstaben eingefuegt haben (wird meist nicht benoetigt und wirkt sich auch negativ auf Suchmaschinenerfassung aus) |
| [150](#L150) | $ergebnis = vernetzen\_ueber\_cache($text); |
| [151](#L151) | if (empty($ergebnis)) { |
| [152](#L152) | $arr\_parameter = array( |
| [153](#L153) | 'Anbieterkennung'               => urlencode($djo\_nutzerdaten['kontaktmail'].'|'.get\_bloginfo('name')), |
| [154](#L154) | 'format'                                => $djo\_nutzerdaten['linkstil'], |
| [155](#L155) | 'target'                                => $djo\_nutzerdaten['linkziel'], |
| [156](#L156) | 'class'                                 => $djo\_nutzerdaten['class'], |
| [157](#L157) | 'buzer'                                 => $djo\_nutzerdaten['buzer'], |
| [158](#L158) | 'ohnehtags'                             => $djo\_nutzerdaten['ohnehtags'], |
| [159](#L159) | 'version'                               => 'wordpress-'.DJO\_VERSION, |
| [160](#L160) | 'zeitlimit\_in\_sekunden' => $djo\_nutzerdaten['zeitlimit\_in\_sekunden'], |
| [161](#L161) | 'Schema'                                => 'https', |
| [162](#L162) | ); |
| [163](#L163) | $ergebnis = vernetzen\_ueber\_dejure\_org($text, $arr\_parameter); |
| [164](#L164) | $ergebnis = integritaetskontrolle\_und\_cache($text, $ergebnis); |
| [165](#L165) | } |
| [166](#L166) | return $ergebnis; |
| [167](#L167) | } |
| [168](#L168) |  |
| [169](#L169) | function integritaetskontrolle\_und\_cache($ausgangstext, $neuertext) { |
| [170](#L170) | global $djo\_vernetzung\_in\_cache\_schreiben, $djo\_vernetzung\_erfolgt; |
| [171](#L171) | if (preg\_replace("/<a href=\"https?:\/\/dejure.org\/[^>]\*>([^<]\*)<\/a>/i", "\\1", trim($ausgangstext)) == preg\_replace("/<a href=\"https?:\/\/dejure.org\/[^>]\*>([^<]\*)<\/a>/i", "\\1", trim($neuertext))) { |
| [172](#L172) | $djo\_vernetzung\_in\_cache\_schreiben[] = array($ausgangstext, $neuertext, $djo\_vernetzung\_erfolgt); // Vorbereitet: Serververbindungsproblem in die DB schreiben |
| [173](#L173) | djo\_zwischenspeicherung(); |
| [174](#L174) | return $neuertext; |
| [175](#L175) | } else { |
| [176](#L176) | return $ausgangstext; |
| [177](#L177) | } |
| [178](#L178) | } |
| [179](#L179) |  |
| [180](#L180) | function djo\_hole\_einstellungen() { |
| [181](#L181) | global $djo\_nutzerdaten\_; |
| [182](#L182) | if (is\_array($djo\_nutzerdaten\_)) { |
| [183](#L183) | return $djo\_nutzerdaten\_; |
| [184](#L184) | } |
| [185](#L185) | $djo\_nutzerdaten\_tmp = get\_option('djo\_einstellungen'); |
| [186](#L186) | $kommentarhinweis\_vorbelegung = 'Hinweis: Gesetzes- und Rechtsprechungszitate werden automatisch <a href="https://dejure.org/vernetzung.html" target="\_blank">über dejure.org verlinkt</a>'; |
| [187](#L187) | if (!empty($djo\_nutzerdaten\_tmp) && !is\_array($djo\_nutzerdaten\_tmp)) { |
| [188](#L188) | $djo\_nutzerdaten\_ = unserialize($djo\_nutzerdaten\_tmp); |
| [189](#L189) | } elseif (is\_array($djo\_nutzerdaten\_tmp) && isset($djo\_nutzerdaten\_tmp['kontaktmail'])) { |
| [190](#L190) | $djo\_nutzerdaten\_ = $djo\_nutzerdaten\_tmp; |
| [191](#L191) | } else { |
| [192](#L192) | $djo\_nutzerdaten\_['kontaktmail']                        = get\_bloginfo('admin\_email'); //Vorbelegung: E-Mail-Adresse des Admin |
| [193](#L193) | $djo\_nutzerdaten\_['newsletter']                         = 'nein'; |
| [194](#L194) | $djo\_nutzerdaten\_['linkziel']                           = ''; |
| [195](#L195) | $djo\_nutzerdaten\_['class']                                      = ''; |
| [196](#L196) | $djo\_nutzerdaten\_['linkstil']                           = 'weit'; |
| [197](#L197) | $djo\_nutzerdaten\_['kommentarhinweis']           = $kommentarhinweis\_vorbelegung; |
| [198](#L198) | $djo\_nutzerdaten\_['buzer']                                      = 0; |
| [199](#L199) | $djo\_nutzerdaten\_['ohnehtags']                          = 0; |
| [200](#L200) | $djo\_nutzerdaten\_['zeitlimit\_in\_sekunden']      = 2; |
| [201](#L201) | update\_option('djo\_einstellungen', serialize($djo\_nutzerdaten\_)); |
| [202](#L202) | } |
| [203](#L203) | $djo\_nutzerdaten\_['kommentarhinweis\_vorbelegung'] = $kommentarhinweis\_vorbelegung; |
| [204](#L204) | return $djo\_nutzerdaten\_; |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) | function djo\_einstellungen\_menue() { |
| [208](#L208) | global $djo\_nutzerdaten; |
| [209](#L209) | if (isset($\_POST['Submit']) && check\_admin\_referer( 'djo\_settings')): |
| [210](#L210) | $djo\_nutzerdaten = array ( |
| [211](#L211) | 'kontaktmail'                   => (isset($\_POST['kontaktmail']) ? sanitize\_text\_field(wp\_unslash($\_POST['kontaktmail'])) : ''), |
| [212](#L212) | 'newsletter'                    => (isset($\_POST['newsletter']) ? sanitize\_text\_field(wp\_unslash($\_POST['newsletter'])) : 'nein'), |
| [213](#L213) | 'linkziel'                              => (isset($\_POST['linkziel']) ? sanitize\_text\_field(wp\_unslash($\_POST['linkziel'])) : ''), |
| [214](#L214) | 'linkziel\_neu'                  => (isset($\_POST['linkziel\_neu']) ? sanitize\_text\_field(wp\_unslash($\_POST['linkziel\_neu'])) : ''), |
| [215](#L215) | 'class'                                 => (isset($\_POST['class']) ? sanitize\_text\_field(wp\_unslash($\_POST['class'])) : ''), |
| [216](#L216) | 'linkstil'                              => (isset($\_POST['linkstil']) ? sanitize\_text\_field(wp\_unslash($\_POST['linkstil'])) : 'weit'), |
| [217](#L217) | 'kommentarhinweis'              => (isset($\_POST['kommentarhinweis']) ? sanitize\_text\_field(wp\_unslash($\_POST['kommentarhinweis'])) : ''), |
| [218](#L218) | 'buzer'                                 => (empty($\_POST['buzer'])) ? 0 : 1, |
| [219](#L219) | 'ohnehtags'                             => (empty($\_POST['ohnehtags'])) ? 0 : 1, |
| [220](#L220) | 'zeitlimit\_in\_sekunden' => (isset($\_POST['zeitlimit\_in\_sekunden']) ? sanitize\_text\_field(wp\_unslash($\_POST['zeitlimit\_in\_sekunden'])) : 2), |
| [221](#L221) | ); |
| [222](#L222) | if ($djo\_nutzerdaten['linkziel'] == 'neu') { |
| [223](#L223) | $djo\_nutzerdaten['linkziel'] = $djo\_nutzerdaten['linkziel\_neu']; |
| [224](#L224) | } else { |
| [225](#L225) | $djo\_nutzerdaten['linkziel\_neu'] = ''; |
| [226](#L226) | } |
| [227](#L227) | update\_option('djo\_einstellungen', serialize($djo\_nutzerdaten)); |
| [228](#L228) | if (!empty($\_POST['cache\_leeren']) && $\_POST['cache\_leeren'] == 'ja') { |
| [229](#L229) | djo\_cache\_leeren(); |
| [230](#L230) | $djo\_cache\_geleert\_hinweis = 'Cache geleert. Alle Beitr&auml;ge, Seiten und Kommentare werden, wenn sie jeweils angezeigt werden, neu verlinkt.'; |
| [231](#L231) | } else { |
| [232](#L232) | $djo\_cache\_geleert\_hinweis = 'Die &Auml;nderungen gelten f&uuml;r k&uuml;nftige Inhalte. Wenn sie auch auf bestehende Inhalte angewandt werden sollen, speichern Sie die Einstellungen bitte mit der Option "Cache leeren".'; |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | ?> |
| [236](#L236) | <div class="updated"> |
| [237](#L237) | <p><strong><?php esc\_html\_e('Einstellungen gespeichert.', 'dejureorg-vernetzungsfunktion') ?></strong></p> |
| [238](#L238) | <p><?php echo esc\_html($djo\_cache\_geleert\_hinweis); ?></p> |
| [239](#L239) | <a href="javascript:history.back()">Zur&uuml;ck</a> |
| [240](#L240) | </div> |
| [241](#L241) | <?php |
| [242](#L242) | else: |
| [243](#L243) | $djo\_nutzerdaten = djo\_hole\_einstellungen(); |
| [244](#L244) |  |
| [245](#L245) | ?> |
| [246](#L246) | </style> |
| [247](#L247) | <div class="wrap"> |
| [248](#L248) | <h2><?php echo esc\_html\_e('dejure.org-Rechtsvernetzung - Einstellungen', 'dejureorg-vernetzungsfunktion'); ?></h2> |
| [249](#L249) | <br /> |
| [250](#L250) | <form name="djo\_einstellungen" method="post" action=""> |
| [251](#L251) | <?php wp\_nonce\_field( 'djo\_settings' ); ?> |
| [252](#L252) | <input type="hidden" name="action" value="update" /> |
| [253](#L253) | <input type="hidden" name="page\_options" value="djo\_nutzerdaten" /> |
| [254](#L254) | <fieldset class="options" style="padding:10px; background-color:#ffffe5; border:1px solid #e6e1a6;"> |
| [255](#L255) | <legend><h3><?php echo esc\_html\_e('Angaben zur Kommunikation mit dejure.org', 'dejureorg-vernetzungsfunktion'); ?></h3></legend> |
| [256](#L256) | <table cellspacing="2" cellpadding="5" class="editform"> |
| [257](#L257) | <tr valign="baseline"> |
| [258](#L258) | <th style="text-align:left;" scope="row"><?php esc\_html\_e('Name des Blogs:', 'dejureorg-vernetzungsfunktion') ?></th> |
| [259](#L259) | <td><strong><?php echo esc\_html(get\_bloginfo('name')); ?></strong></td> |
| [260](#L260) | </tr> |
| [261](#L261) | <tr valign="baseline"> |
| [262](#L262) | <th style="text-align:left;" scope="row"><?php esc\_html\_e('Kontakt-E-Mail-Adresse', 'dejureorg-vernetzungsfunktion') ?>:</th> |
| [263](#L263) | <td><input name="kontaktmail" type="text" id="kontaktmail" |
| [264](#L264) | value="<?php echo esc\_attr($djo\_nutzerdaten['kontaktmail']); ?>" size="50" /> |
| [265](#L265) | <br /><br /> |
| [266](#L266) | <input type="checkbox" name="newsletter" value="ja"<?php if ($djo\_nutzerdaten['newsletter'] == 'ja') echo esc\_attr(' checked');?>> |
| [267](#L267) | Bei Neuigkeiten zur dejure.org-Vernetzungsfunktion m&ouml;chte ich per E-Mail informiert werden. |
| [268](#L268) | <br /><br /> |
| [269](#L269) | Diese Informationen werden im Rahmen der Serverkommunikation jeweils an dejure.org &uuml;bertragen und dienen im &uuml;brigen nur der Kommunikation bei technischen Problemen. <strong>Die Weitergabe der Daten an Dritte sowie eine Verwendung f&uuml;r Werbezwecke o.&auml;. ist ausgeschlossen!</strong> |
| [270](#L270) | </td> |
| [271](#L271) | </tr> |
| [272](#L272) | </table> |
| [273](#L273) | </fieldset> |
| [274](#L274) | <br /> |
| [275](#L275) | <fieldset class="options" style="padding:10px; background-color:#eee; border:1px solid #ddd;"> |
| [276](#L276) | <legend><h3><?php esc\_html\_e('Einstellungen zur Vernetzungsfunktion', 'dejureorg-vernetzungsfunktion') ?></h3></legend> |
| [277](#L277) | <p style="padding:3px; background-color:#ffffe5; border:1px solid #e6e1a6;">(&Auml;nderungen werden f&uuml;r bestehende Beitr&auml;ge nur wirksam, wenn der Vernetzungs-Cache geleert wird: <input type="checkbox" name="cache\_leeren" value="ja"> Cache leeren)</p> |
| [278](#L278) | <table cellspacing="2" cellpadding="5" class="editform"> |
| [279](#L279) | <tr valign="baseline"> |
| [280](#L280) | <th style="text-align:left;" scope="row">Links &ouml;ffnen:</th> |
| [281](#L281) | <td><input type="radio" name="linkziel" value=""<?php if ($djo\_nutzerdaten["linkziel"] == "") echo esc\_attr(" checked"); ?>> im gleichen Fenster</td> |
| [282](#L282) | </tr> |
| [283](#L283) | <tr valign="baseline"> |
| [284](#L284) | <th scope="row"></th> |
| [285](#L285) | <td><input type="radio" name="linkziel" value="\_blank"<?php if ($djo\_nutzerdaten["linkziel"] == "\_blank") echo esc\_attr(" checked"); ?>> in neuem Fenster</td> |
| [286](#L286) | </tr> |
| [287](#L287) | <tr valign="baseline"> |
| [288](#L288) | <th scope="row"></th> |
| [289](#L289) | <td><input type="radio" name="linkziel" id="linkziel2" value="neu"<?php |
| [290](#L290) | if ($djo\_nutzerdaten['linkziel'] != '' && $djo\_nutzerdaten['linkziel'] != '\_blank') echo esc\_attr(' checked'); |
| [291](#L291) | ?>> in Fenster mit dem Namen <input name="linkziel\_neu" type="text" id="linkziel\_neu" onfocus="document.getElementById('linkziel2').checked='true'" |
| [292](#L292) | value="<?php |
| [293](#L293) | if ($djo\_nutzerdaten['linkziel'] != '\_blank') echo esc\_attr($djo\_nutzerdaten['linkziel']); |
| [294](#L294) | ?>" size="20"/></td> |
| [295](#L295) | </tr> |
| [296](#L296) | <tr><td>&nbsp;</td><td></td></tr> |
| [297](#L297) | <tr valign="baseline"> |
| [298](#L298) | <th style="text-align:left;" scope="row">CSS-Klasse f&uuml;r dejure.org-Links:</th> |
| [299](#L299) | <td><input name="class" type="text" id="class" value="<?php echo esc\_attr($djo\_nutzerdaten["class"]); ?>" size="25" /> |
| [300](#L300) | <br /> |
| [301](#L301) | <strong>Hinweis:</strong> Im Normalfall kann das Feld leergelassen werden. Links zu dejure.org werden dann nicht anders als sonstige Links angezeigt.<br />Die Klasse muss, wenn noch nicht vorhanden, im Blog definiert werden.</td> |
| [302](#L302) | </tr> |
| [303](#L303) | <tr><td>&nbsp;</td><td></td></tr> |
| [304](#L304) | <tr valign="baseline"> |
| [305](#L305) | <th style="text-align:left;" scope="row">Stil der dejure.org-Links:</th> |
| [306](#L306) | <td><input type="radio" name="linkstil" value="schmal"<?php |
| [307](#L307) | if ($djo\_nutzerdaten['linkstil'] == 'schmal') echo esc\_attr(' checked'); |
| [308](#L308) | ?>> nur die Nummern der Vorschriften verlinken (Bsp.: &sect; <u>242</u> BGB; &sect;&sect; <u>278</u>, <u>254</u> BGB) |
| [309](#L309) | <br /> |
| [310](#L310) | <input type="radio" name="linkstil" value="weit"<?php |
| [311](#L311) | if ($djo\_nutzerdaten['linkstil'] != 'schmal') echo esc\_attr(' checked'); |
| [312](#L312) | ?>> m&ouml;glichst lange Verlinkung (Bsp.: <u>&sect; 242 BGB</u>; <u>&sect;&sect; 278</u>, <u>254 BGB</u>) <span style="background-color:#e7f7d3;">[Vorgabe]</span></td> |
| [313](#L313) | </tr> |
| [314](#L314) | <tr><td>&nbsp;</td><td></td></tr> |
| [315](#L315) | <th style="text-align:left;" scope="row">Gesetzesumfang:</th> |
| [316](#L316) | <td><input type="checkbox" name="buzer" value="1"<?php if ($djo\_nutzerdaten['buzer'] == 1) echo esc\_attr(' checked');?>> Zu <a href="http://buzer.de">buzer.de</a> verlinken f&uuml;r Gesetze, die bei dejure.org nicht vorhanden sind |
| [317](#L317) | </tr> |
| [318](#L318) | <tr><td>&nbsp;</td><td></td></tr> |
| [319](#L319) | <th style="text-align:left;" scope="row">&Uuml;berschriften ausschlie&szlig;en:</th> |
| [320](#L320) | <td><input type="checkbox" name="ohnehtags" value="1"<?php if ($djo\_nutzerdaten['ohnehtags'] == 1) echo esc\_attr(' checked');?>> Keine Vernetzung innerhalb von &Uuml;berschriften (h1 bis h9) |
| [321](#L321) | </tr> |
| [322](#L322) | <tr><td>&nbsp;</td><td></td></tr> |
| [323](#L323) | <tr valign="baseline"> |
| [324](#L324) | <th style="text-align:left;" scope="row">Maximale Wartezeit f&uuml;r Serverkommunikation:</th> |
| [325](#L325) | <td><input name="zeitlimit\_in\_sekunden" type="text" id="zeitlimit\_in\_sekunden" value="<?php echo esc\_attr($djo\_nutzerdaten["zeitlimit\_in\_sekunden"]); ?>" size="3" /> Sekunden <span style="background-color:#e7f7d3;">[empfohlen: 2]</span> |
| [326](#L326) | <br /> |
| [327](#L327) | <strong>Hinweis:</strong> Die Kommunikation dauert nur bei sehr gro&szlig;en Seiten l&auml;nger als 1 Sekunde.<br />Eine leichte Verz&ouml;gerung aufgrund der Serverkommunikation tritt wegen des eingebauten Caches nur sporadisch auf.</td> |
| [328](#L328) | </tr> |
| [329](#L329) | <tr><td>&nbsp;</td><td></td></tr> |
| [330](#L330) | <tr valign="baseline"> |
| [331](#L331) | <th style="text-align:left;" scope="row">Diskussion:</th> |
| [332](#L332) | <td>Vor das Editierfeld folgenden Hinweis ausgeben (kein Hinweis, wenn leer): |
| [333](#L333) | <br /> |
| [334](#L334) | <textarea cols="60" rows="3" name="kommentarhinweis"><?php |
| [335](#L335) | echo esc\_html(htmlspecialchars($djo\_nutzerdaten['kommentarhinweis'])); |
| [336](#L336) | ?></textarea> |
| [337](#L337) | <br /> |
| [338](#L338) | <button type="submit" onclick="document.forms.djo\_einstellungen.kommentarhinweis.value='<?php |
| [339](#L339) | echo esc\_attr($djo\_nutzerdaten['kommentarhinweis\_vorbelegung']); |
| [340](#L340) | ?>'; return false;">Vorbelegung</button> |
| [341](#L341) | </td> |
| [342](#L342) | </tr> |
| [343](#L343) |  |
| [344](#L344) | </table> |
| [345](#L345) | </fieldset> |
| [346](#L346) | <p class="submit"> |
| [347](#L347) | <input type="submit" name="Submit" class="button button-primary" |
| [348](#L348) | value="<?php esc\_attr\_e('Einstellungen speichern', 'dejureorg-vernetzungsfunktion') ?> &raquo;" /> |
| [349](#L349) | </p> |
| [350](#L350) | </form> |
| [351](#L351) | </div> |
| [352](#L352) | <?php |
| [353](#L353) | endif; |
| [354](#L354) | } |
| [355](#L355) |  |
| [356](#L356) | function djo\_einstellungen() { |
| [357](#L357) | add\_options\_page(\_\_('dejure.org', 'dejureorg-vernetzungsfunktion'),\_\_('dejure.org', 'dejureorg-vernetzungsfunktion'), 'manage\_options', 'dejure.org-vernetzung', 'djo\_einstellungen\_menue'); |
| [358](#L358) | } |
| [359](#L359) |  |
| [360](#L360) | function djo\_kommentar\_editierhinweis() { |
| [361](#L361) | global $djo\_nutzerdaten; |
| [362](#L362) | echo ' |
| [363](#L363) | <script language="javascript"> |
| [364](#L364) | djo\_kommentarhinweis = "'.esc\_js(str\_replace('"', '\"', $djo\_nutzerdaten['kommentarhinweis'])).'" |
| [365](#L365) | if (djo\_kommentarhinweis != "" && document.getElementById("commentform")) { |
| [366](#L366) | djo\_editierhinweis = document.createElement("p") |
| [367](#L367) | djo\_editierhinweis.innerHTML = djo\_kommentarhinweis |
| [368](#L368) | document.getElementById("commentform").parentNode.insertBefore(djo\_editierhinweis, document.getElementById("commentform")) |
| [369](#L369) | } |
| [370](#L370) | </script>'; |
| [371](#L371) | } |
| [372](#L372) |  |
| [373](#L373) | if (is\_admin()) { |
| [374](#L374) | register\_activation\_hook(\_\_FILE\_\_, 'djo\_install'); |
| [375](#L375) | register\_deactivation\_hook(\_\_FILE\_\_, 'djo\_uninstall'); |
| [376](#L376) | register\_uninstall\_hook(\_\_FILE\_\_, 'djo\_uninstall' ); |
| [377](#L377) |  |
| [378](#L378) | add\_action('admin\_menu', 'djo\_einstellungen'); |
| [379](#L379) | } |
| [380](#L380) | add\_action('plugins\_loaded', 'djo\_update\_db\_check'); |
| [381](#L381) |  |
| [382](#L382) | add\_filter('the\_content', 'djo\_vernetzen'); |
| [383](#L383) | add\_filter('comment\_text', 'djo\_vernetzen'); |
| [384](#L384) | add\_filter('shutdown', 'djo\_zwischenspeicherung'); |
| [385](#L385) | add\_action('comment\_form', 'djo\_kommentar\_editierhinweis'); |
| [386](#L386) |  |
| [387](#L387) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php?format=txt)
* [Original Format](/export/3222479/dejureorg-vernetzungsfunktion/trunk/dejure.org-vernetzung.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


