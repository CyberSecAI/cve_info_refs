=== Content from www.wordfence.com_ab1fba94_20250115_093817.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# ScanCircle <= 2.9.2 - Authenticated (Contributor+) Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   ScanCircle <= 2.9.2 - Authenticated (Contributor+) Stored Cross-Site Scripting

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11439](https://www.cve.org/CVERecord?id=CVE-2024-11439) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | December 17, 2024 |
| Last Updated | December 18, 2024 |
| Researcher | [zakaria](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/zaki-zaki) |

### Description

The ScanCircle plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'scancircle' shortcode in all versions up to, and including, 2.9.2 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/scancircle/trunk/scancircle.php)
* [wordpress.org](https://wordpress.org/plugins/scancircle/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3202428%40scancircle&new=3202428%40scancircle&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscancircle%2Fscancircle-292-authenticated-contributor-stored-cross-site-scripting&t=ScanCircle%20%3C%3D%202.9.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscancircle%2Fscancircle-292-authenticated-contributor-stored-cross-site-scripting&text=ScanCircle%20%3C%3D%202.9.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscancircle%2Fscancircle-292-authenticated-contributor-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for ScanCircle

#### [ScanCircle](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/scancircle)

| Software Type | Plugin |
| --- | --- |
| Software Slug | scancircle [(view on wordpress.org)](https://wordpress.org/plugins/scancircle) |
| Patched? | Yes |
| Remediation | Update to version 2.9.3, or a newer patched version |
| Affected Version | * <= 2.9.2 |
| Patched Version | * 2.9.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_8f0ba16f_20250115_093814.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3202428%2540scancircle%26old%3D3202428%2540scancircle)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3198225/scancircle "Changeset 3198225 for scancircle")
* Next Change →

---

# Changeset [3202428](/changeset/3202428 "Show full changeset") for [scancircle](/browser/scancircle?rev=3202428 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/04/2024 01:09:24 PM
([6 weeks](/timeline?from=2024-12-04T13%3A09%3A24Z&precision=second "See timeline at 12/04/2024 01:09:24 PM") ago)

Author:
aklaren
Message:

Restricted the IFRAME attributes to prevent possible abuse of event attributes for cross-site scripting

Location:
[scancircle](/browser/scancircle?rev=3202428)
Files:

1 added
2 edited
2 copied

* [tags/2.9.3](/browser/scancircle/tags/2.9.3?rev=3202428 "Show entry in browser")
  (added)
* [tags/2.9.3/readme.txt](/browser/scancircle/tags/2.9.3/readme.txt?rev=3202428 "Show entry in browser")
  (copied)
  *(copied from [scancircle/trunk/readme.txt](/browser/scancircle/trunk/readme.txt?rev=3198225 "Show original file (revision 3198225)"))*
  ([3 diffs](#file1 "Show differences"))
* [tags/2.9.3/scancircle.php](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428 "Show entry in browser")
  (copied)
  *(copied from [scancircle/trunk/scancircle.php](/browser/scancircle/trunk/scancircle.php?rev=3198225 "Show original file (revision 3198225)"))*
  ([6 diffs](#file2 "Show differences"))
* [trunk/readme.txt](/browser/scancircle/trunk/readme.txt?rev=3202428 "Show entry in browser")
  (modified)
  ([3 diffs](#file3 "Show differences"))
* [trunk/scancircle.php](/browser/scancircle/trunk/scancircle.php?rev=3202428 "Show entry in browser")
  (modified)
  ([6 diffs](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [scancircle/tags/2.9.3/readme.txt](/changeset/3202428/scancircle/tags/2.9.3/readme.txt "Show the changeset 3202428 restricted to scancircle/tags/2.9.3/readme.txt")

  | [r3198225](/browser/scancircle/trunk/readme.txt?rev=3198225#L4 "Show revision 3198225 of this file in browser") | [r3202428](/browser/scancircle/tags/2.9.3/readme.txt?rev=3202428#L4 "Show revision 3202428 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 2.5 |
  | 5 | 5 | Tested up to: 6.7 |
  | 6 |  | Stable tag: 2.9.~~2~~ |
  |  | 6 | Stable tag: 2.9.3 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 | 8 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/scancircle/trunk/readme.txt?rev=3198225#L39) | […](/browser/scancircle/tags/2.9.3/readme.txt?rev=3202428#L39) |  |
  | 39 | 39 |  |
  | 40 | 40 | == Changelog == |
  |  | 41 | = 2.9.3 - 2024-12-03 = |
  |  | 42 | \* Restricted [scancircle\_results] attributes to prevent abuse of event attributes in IFRAME |
  |  | 43 |  |
  | 41 | 44 | = 2.9.2 - 2024-11-27 = |
  | 42 | 45 | \* Fixed incomplete update of version number |
  | […](/browser/scancircle/trunk/readme.txt?rev=3198225#L86) | […](/browser/scancircle/tags/2.9.3/readme.txt?rev=3202428#L89) |  |
  | 86 | 89 |  |
  | 87 | 90 | == Upgrade Notice == |
  |  | 91 | = 2.9.3 == |
  |  | 92 | \* Update to avoid abuse of event attributes in IFRAME |
  |  | 93 |  |
  | 88 | 94 | = 2.9.2 == |
  | 89 | 95 | \* Update to show correct version number |
* ## [scancircle/tags/2.9.3/scancircle.php](/changeset/3202428/scancircle/tags/2.9.3/scancircle.php "Show the changeset 3202428 restricted to scancircle/tags/2.9.3/scancircle.php")

  | [r3198225](/browser/scancircle/trunk/scancircle.php?rev=3198225#L4 "Show revision 3198225 of this file in browser") | [r3202428](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L4 "Show revision 3202428 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/scancircle |
  | 5 | 5 | \* Description: Shortcode for the scan widget on ScanCircle partner websites. Only for registered ScanCircle partners. |
  | 6 |  | \* Version: 2.9.~~2~~ |
  |  | 6 | \* Version: 2.9.3 |
  | 7 | 7 | \* Note: IMPORTANT \*\*\* always keep this version number in sync with the one in the function below \*\*\* |
  | 8 | 8 | \* Author: Arnoud Klaren |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L12) | […](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L12) |  |
  | 12 | 12 | function scancircle\_widget( $atts ) { |
  | 13 | 13 | // \*\*\* IMPORTANT: always keep this version number in sync with the one in the header above \*\*\* |
  | 14 |  | $version = '2.9.~~2~~'; |
  |  | 14 | $version = '2.9.3'; |
  | 15 | 15 | $options = '?plugin=WordPress'.$version; |
  | 16 | 16 | $partner = ''; |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L34) | […](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L34) |  |
  | 34 | 34 | break; |
  | 35 | 35 | case 'https': |
  | 36 |  | if($val === '0') ~~$secure = '';~~ |
  |  | 36 | if($val === '0') { $secure = ''; } |
  | 37 | 37 | break; |
  | 38 | 38 | case 'env': |
  | 39 |  | if(str\_starts\_with($val, '/')) ~~$val = $env.$val;~~ |
  |  | 39 | if(str\_starts\_with($val, '/')) { $val = $env.$val; } |
  | 40 | 40 | if(!preg\_match( '`^(com|eu)(\/[a-z0-9]+)?$`', $val)) { |
  | 41 | 41 | return scancircle\_error('Env parameter should be in the format [TLD][/ENV]'); |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L49) | […](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L49) |  |
  | 49 | 49 | if(preg\_match( '/[^a-z]/i', $key)) { |
  | 50 | 50 | // invalid key names are returned as '0' |
  | 51 |  | if($key == '0') return scancircle\_error('Invalid key name detected'); |
  |  | 51 | if($key == '0') { |
  |  | 52 | return scancircle\_error('Invalid key name detected'); |
  |  | 53 | } |
  | 52 | 54 | return scancircle\_error('Only alpha characters supported in key names: '.$key); |
  | 53 | 55 | } |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L59) | […](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L61) |  |
  | 59 | 61 | } |
  | 60 | 62 |  |
  | 61 |  | if(!$partner) return scancircle\_error('Partner parameter missing'); |
  |  | 63 | if(!$partner) { |
  |  | 64 | return scancircle\_error('Syntax: [scancircle partner="PARTNER-CODE" OPTIONS]'); |
  |  | 65 | } |
  | 62 | 66 |  |
  | 63 | 67 | wp\_enqueue\_script('scancircle-script', |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L92) | […](/browser/scancircle/tags/2.9.3/scancircle.php?rev=3202428#L96) |  |
  | 92 | 96 | $param = strtolower($val); |
  | 93 | 97 | break; |
  | 94 |  | default: |
  | 95 |  | if(preg\_match( '/[^a-z]/i', $key)) { |
  | 96 |  | // invalid key names are returned as '0' |
  | 97 |  | if($key == '0') return scancircle\_error('Invalid key name detected'); |
  | 98 |  | return scancircle\_error('Only alpha characters supported in key names: '.$key); |
  | 99 |  | } |
  |  | 98 | case 'width': |
  |  | 99 | case 'height': |
  |  | 100 | case 'name': |
  |  | 101 | case 'loading': |
  |  | 102 | case 'id': |
  |  | 103 | case 'class': |
  |  | 104 | case 'style': |
  |  | 105 | case 'tabindex': |
  |  | 106 | case 'title': |
  |  | 107 | case 'draggable': |
  | 100 | 108 | if($val !== sanitize\_text\_field(str\_replace('"', '', $val))) { |
  | 101 | 109 | return scancircle\_error('Invalid characters detected in parameter: '.$key); |
  | 102 | 110 | } |
  | 103 |  | if(!in\_array(strtolower($key), array('src', 'srcdoc'))) { |
  | 104 |  | $attribs .= ' '.strtolower($key).'="'. htmlentities($val).'"'; |
  | 105 |  | } |
  |  | 111 | $attribs .= ' '.strtolower($key).'="'. htmlentities($val).'"'; |
  |  | 112 | break; |
  |  | 113 | default: |
  |  | 114 | return scancircle\_error('Unsupported attribute: '.$key); |
  | 106 | 115 | } |
  | 107 | 116 | } |
  | 108 |  | if(!$partner || !$param) return scancircle\_error('Syntax: [scancircle\_results partner="PARTNER-CODE" param="URL-PARAMETER" IFRAME-ATTRIBUTES]'); |
  | 109 |  | if(!isset($\_GET[$param])) return scancircle\_error('Missing URL-parameter: '.$param); |
  | 110 |  | if(!filter\_var($url = $\_GET[$param], FILTER\_VALIDATE\_URL)) return scancircle\_error('Invalid URL: '.htmlentities($url)); |
  | 111 |  | if(!preg\_match('/^https?:\/\/'.$partner.'\.scancircle\.(com|eu)\//i', $url)) return scancircle\_error('Only valid for ScanCircle URLs for partner: '.$partner); |
  |  | 117 | if(!$partner || !$param) { |
  |  | 118 | return scancircle\_error('Syntax: [scancircle\_results partner="PARTNER-CODE" param="URL-PARAMETER" IFRAME-ATTRIBUTES]'); |
  |  | 119 | } |
  |  | 120 | if(!isset($\_GET[$param])) { |
  |  | 121 | return scancircle\_error('Missing URL-parameter: '.$param); |
  |  | 122 | } |
  |  | 123 | if(!filter\_var($url = $\_GET[$param], FILTER\_VALIDATE\_URL)) { |
  |  | 124 | return scancircle\_error('Invalid URL: '.htmlentities($url)); |
  |  | 125 | } |
  |  | 126 | if(!preg\_match('/^https?:\/\/'.$partner.'\.scancircle\.(com|eu)\//i', $url)) { |
  |  | 127 | return scancircle\_error('Only valid for ScanCircle URLs for partner: '.$partner); |
  |  | 128 | } |
  | 112 | 129 | return '<iframe src="'.$url.'"'.$attribs.'></iframe>'; |
  | 113 | 130 | } |
* ## [scancircle/trunk/readme.txt](/changeset/3202428/scancircle/trunk/readme.txt "Show the changeset 3202428 restricted to scancircle/trunk/readme.txt")

  | [r3198225](/browser/scancircle/trunk/readme.txt?rev=3198225#L4 "Show revision 3198225 of this file in browser") | [r3202428](/browser/scancircle/trunk/readme.txt?rev=3202428#L4 "Show revision 3202428 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 2.5 |
  | 5 | 5 | Tested up to: 6.7 |
  | 6 |  | Stable tag: 2.9.~~2~~ |
  |  | 6 | Stable tag: 2.9.3 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 | 8 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/scancircle/trunk/readme.txt?rev=3198225#L39) | […](/browser/scancircle/trunk/readme.txt?rev=3202428#L39) |  |
  | 39 | 39 |  |
  | 40 | 40 | == Changelog == |
  |  | 41 | = 2.9.3 - 2024-12-03 = |
  |  | 42 | \* Restricted [scancircle\_results] attributes to prevent abuse of event attributes in IFRAME |
  |  | 43 |  |
  | 41 | 44 | = 2.9.2 - 2024-11-27 = |
  | 42 | 45 | \* Fixed incomplete update of version number |
  | […](/browser/scancircle/trunk/readme.txt?rev=3198225#L86) | […](/browser/scancircle/trunk/readme.txt?rev=3202428#L89) |  |
  | 86 | 89 |  |
  | 87 | 90 | == Upgrade Notice == |
  |  | 91 | = 2.9.3 == |
  |  | 92 | \* Update to avoid abuse of event attributes in IFRAME |
  |  | 93 |  |
  | 88 | 94 | = 2.9.2 == |
  | 89 | 95 | \* Update to show correct version number |
* ## [scancircle/trunk/scancircle.php](/changeset/3202428/scancircle/trunk/scancircle.php "Show the changeset 3202428 restricted to scancircle/trunk/scancircle.php")

  | [r3198225](/browser/scancircle/trunk/scancircle.php?rev=3198225#L4 "Show revision 3198225 of this file in browser") | [r3202428](/browser/scancircle/trunk/scancircle.php?rev=3202428#L4 "Show revision 3202428 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/scancircle |
  | 5 | 5 | \* Description: Shortcode for the scan widget on ScanCircle partner websites. Only for registered ScanCircle partners. |
  | 6 |  | \* Version: 2.9.~~2~~ |
  |  | 6 | \* Version: 2.9.3 |
  | 7 | 7 | \* Note: IMPORTANT \*\*\* always keep this version number in sync with the one in the function below \*\*\* |
  | 8 | 8 | \* Author: Arnoud Klaren |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L12) | […](/browser/scancircle/trunk/scancircle.php?rev=3202428#L12) |  |
  | 12 | 12 | function scancircle\_widget( $atts ) { |
  | 13 | 13 | // \*\*\* IMPORTANT: always keep this version number in sync with the one in the header above \*\*\* |
  | 14 |  | $version = '2.9.~~2~~'; |
  |  | 14 | $version = '2.9.3'; |
  | 15 | 15 | $options = '?plugin=WordPress'.$version; |
  | 16 | 16 | $partner = ''; |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L34) | […](/browser/scancircle/trunk/scancircle.php?rev=3202428#L34) |  |
  | 34 | 34 | break; |
  | 35 | 35 | case 'https': |
  | 36 |  | if($val === '0') ~~$secure = '';~~ |
  |  | 36 | if($val === '0') { $secure = ''; } |
  | 37 | 37 | break; |
  | 38 | 38 | case 'env': |
  | 39 |  | if(str\_starts\_with($val, '/')) ~~$val = $env.$val;~~ |
  |  | 39 | if(str\_starts\_with($val, '/')) { $val = $env.$val; } |
  | 40 | 40 | if(!preg\_match( '`^(com|eu)(\/[a-z0-9]+)?$`', $val)) { |
  | 41 | 41 | return scancircle\_error('Env parameter should be in the format [TLD][/ENV]'); |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L49) | […](/browser/scancircle/trunk/scancircle.php?rev=3202428#L49) |  |
  | 49 | 49 | if(preg\_match( '/[^a-z]/i', $key)) { |
  | 50 | 50 | // invalid key names are returned as '0' |
  | 51 |  | if($key == '0') return scancircle\_error('Invalid key name detected'); |
  |  | 51 | if($key == '0') { |
  |  | 52 | return scancircle\_error('Invalid key name detected'); |
  |  | 53 | } |
  | 52 | 54 | return scancircle\_error('Only alpha characters supported in key names: '.$key); |
  | 53 | 55 | } |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L59) | […](/browser/scancircle/trunk/scancircle.php?rev=3202428#L61) |  |
  | 59 | 61 | } |
  | 60 | 62 |  |
  | 61 |  | if(!$partner) return scancircle\_error('Partner parameter missing'); |
  |  | 63 | if(!$partner) { |
  |  | 64 | return scancircle\_error('Syntax: [scancircle partner="PARTNER-CODE" OPTIONS]'); |
  |  | 65 | } |
  | 62 | 66 |  |
  | 63 | 67 | wp\_enqueue\_script('scancircle-script', |
  | […](/browser/scancircle/trunk/scancircle.php?rev=3198225#L92) | […](/browser/scancircle/trunk/scancircle.php?rev=3202428#L96) |  |
  | 92 | 96 | $param = strtolower($val); |
  | 93 | 97 | break; |
  | 94 |  | default: |
  | 95 |  | if(preg\_match( '/[^a-z]/i', $key)) { |
  | 96 |  | // invalid key names are returned as '0' |
  | 97 |  | if($key == '0') return scancircle\_error('Invalid key name detected'); |
  | 98 |  | return scancircle\_error('Only alpha characters supported in key names: '.$key); |
  | 99 |  | } |
  |  | 98 | case 'width': |
  |  | 99 | case 'height': |
  |  | 100 | case 'name': |
  |  | 101 | case 'loading': |
  |  | 102 | case 'id': |
  |  | 103 | case 'class': |
  |  | 104 | case 'style': |
  |  | 105 | case 'tabindex': |
  |  | 106 | case 'title': |
  |  | 107 | case 'draggable': |
  | 100 | 108 | if($val !== sanitize\_text\_field(str\_replace('"', '', $val))) { |
  | 101 | 109 | return scancircle\_error('Invalid characters detected in parameter: '.$key); |
  | 102 | 110 | } |
  | 103 |  | if(!in\_array(strtolower($key), array('src', 'srcdoc'))) { |
  | 104 |  | $attribs .= ' '.strtolower($key).'="'. htmlentities($val).'"'; |
  | 105 |  | } |
  |  | 111 | $attribs .= ' '.strtolower($key).'="'. htmlentities($val).'"'; |
  |  | 112 | break; |
  |  | 113 | default: |
  |  | 114 | return scancircle\_error('Unsupported attribute: '.$key); |
  | 106 | 115 | } |
  | 107 | 116 | } |
  | 108 |  | if(!$partner || !$param) return scancircle\_error('Syntax: [scancircle\_results partner="PARTNER-CODE" param="URL-PARAMETER" IFRAME-ATTRIBUTES]'); |
  | 109 |  | if(!isset($\_GET[$param])) return scancircle\_error('Missing URL-parameter: '.$param); |
  | 110 |  | if(!filter\_var($url = $\_GET[$param], FILTER\_VALIDATE\_URL)) return scancircle\_error('Invalid URL: '.htmlentities($url)); |
  | 111 |  | if(!preg\_match('/^https?:\/\/'.$partner.'\.scancircle\.(com|eu)\//i', $url)) return scancircle\_error('Only valid for ScanCircle URLs for partner: '.$partner); |
  |  | 117 | if(!$partner || !$param) { |
  |  | 118 | return scancircle\_error('Syntax: [scancircle\_results partner="PARTNER-CODE" param="URL-PARAMETER" IFRAME-ATTRIBUTES]'); |
  |  | 119 | } |
  |  | 120 | if(!isset($\_GET[$param])) { |
  |  | 121 | return scancircle\_error('Missing URL-parameter: '.$param); |
  |  | 122 | } |
  |  | 123 | if(!filter\_var($url = $\_GET[$param], FILTER\_VALIDATE\_URL)) { |
  |  | 124 | return scancircle\_error('Invalid URL: '.htmlentities($url)); |
  |  | 125 | } |
  |  | 126 | if(!preg\_match('/^https?:\/\/'.$partner.'\.scancircle\.(com|eu)\//i', $url)) { |
  |  | 127 | return scancircle\_error('Only valid for ScanCircle URLs for partner: '.$partner); |
  |  | 128 | } |
  | 112 | 129 | return '<iframe src="'.$url.'"'.$attribs.'></iframe>'; |
  | 113 | 130 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3202428)
* [Zip Archive](?format=zip&new=3202428)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_52f3fbe4_20250115_093815.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

ScanCircle

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fscancircle&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fscancircle&locale=en_US)

Search plugins

![](https://ps.w.org/scancircle/assets/banner-772x250.png?rev=790915)
![](https://ps.w.org/scancircle/assets/icon-256x256.png?rev=983606)
# ScanCircle

By Arnoud Klaren

[Download](https://downloads.wordpress.org/plugin/scancircle.2.9.3.zip)

* [Details](https://wordpress.org/plugins/scancircle/#description)
* [Reviews](https://wordpress.org/plugins/scancircle/#reviews)
* [Installation](https://wordpress.org/plugins/scancircle/#installation)
* [Development](https://wordpress.org/plugins/scancircle/#developers)

[Support](https://wordpress.org/support/plugin/scancircle/)

## Description

Only for registered ScanCircle partners. See the [ScanCircle partner program](https://www.scancircle.com/en/scancircle/partner-program).

Login to your ScanCircle partner page and select the Scan Widget tab to generate the required ScanCircle shortcode and copy/paste it into your post.

## Screenshots

* [![](https://ps.w.org/scancircle/assets/screenshot-1.jpg?rev=1310460)](https://ps.w.org/scancircle/assets/screenshot-1.jpg?rev=1310460)

  Scan widget wizard to generate the shortcode with the options you need.

## Installation

Manual installation:

1. Upload the folder `scancircle` to the `/wp-content/plugins/` directory
2. Activate the `scancircle` plugin through the ‘Plugins’ menu in WordPress
3. Place the `[scancircle ...]` or `[scancircle_results ...]` shortcode in your pages/posts

## FAQ

### How can I change the styling of the scan button or the text?

See [this post](https://www.scancircle.com/forum/showthread.php?tid=154) in the ScanCircle partner forum

### What is the [scancircle\_results …] shortcode for?

Using this shortcode, you can show the results in an IFRAME on your own website.

1. Set the “Own results page” to e.g. https://domain.com/results?language=%s&advice=%s&reference=%s

2. On this page include the shortcode [scancircle\_results partner=”PARTNER-CODE” param=”URL-PARAMETER” IFRAME-ATTRIBUTES], where

– PARTNER-CODE is your partner code (this prevents cross site scripting with non-ScanCircle URLs: only http(s)://PARNER-CODE.scancircle.com/… allowed)

– URL-PARAMETER is the name of the URL parameter containing the results URL (in this example “advice”)

– IFRAME-ATTRIBUTES are optional IFRAME attributes (e.g. width=”X” height=”Y” class=”Z”)

### Can I use the shortcodes in a template?

Yes, but you need the do\_shortcode function as in: <?php echo do\_shortcode(‘[scancircle…]’); ?>>

## Reviews

![](https://secure.gravatar.com/avatar/b6c12c3e10de96dfbc2665e189ab83bed1d0e0e0ca3e51f7e4c834510d24d2a4?s=60&d=retro&r=g)
### [superb](https://wordpress.org/support/topic/superb-303/)

[Earnie Rhyker](https://profiles.wordpress.org/rhyker2u/ "Posts by Earnie Rhyker")
September 3, 2016
1 reply

excellent widget, excellent features, and very helpful/supportive developer.

[Read all 2 reviews](https://wordpress.org/support/plugin/scancircle/reviews/)
## Contributors & Developers

“ScanCircle” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/0c32dddd23ef196e82f739c9942b7ff71b4e14b3df8936daa12844be07c55c65?s=32&d=mm&r=g) [Arnoud Klaren](https://profiles.wordpress.org/aklaren/)

[Translate “ScanCircle” into your language.](https://translate.wordpress.org/projects/wp-plugins/scancircle)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/scancircle/), check out the [SVN repository](https://plugins.svn.wordpress.org/scancircle/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/scancircle/) by [RSS](https://plugins.trac.wordpress.org/log/scancircle/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 2.9.3 – 2024-12-03

* Restricted [scancircle\_results] attributes to prevent abuse of event attributes in IFRAME

#### 2.9.2 – 2024-11-27

* Fixed incomplete update of version number

#### 2.9.1 – 2024-11-27

* Fixed small issue to retrieve plugin version

#### 2.9 – 2024-11-27

* Added various input validations due to possible security issue reported by Wordfence in CVE-2024-11439 (thanks to zakaria)
* Removed deprecated `[phpvar]` shortcode

#### 2.0 – 2020-07-23

* Added shortcode [scancircle\_results partner=”PARTNER-CODE” param=”URL-PARAMETERS” IFRAME-ATTRIBUTES]

#### 1.43 – 2018-11-14

* Load ScanCircle JavaScript using wp\_enqueue\_script to ensure jQuery is loaded (if needed)

#### 1.32 – 2015-12-16

* Generalized the plugin to cater for future options so new options do not require a new version of the plugin.
* The `[phpvar]` shortcode has been deprecated as there are standard ways and plugins to do this (functionality will remain for the time being)

#### 1.31 – 2015-11-02

* For some reason, version 1.27 actually still used v1.24. Updated version number to force a new update and updated support to WP4.3.1.

#### 1.27 – 2015-03-23

* Changed `https` option to load scancircle.js using HTTPS by default unless https=0 is specified. Link to partner environment always uses HTTP (only used if JavaScript is not loaded correctly)

#### 1.24 – 2014-10-13

* Load scancircle.js and/or link to partner environment using https, `https` option added to select which: 2=both, 1=JavaScript only, 0=none (default)

#### 1.23 – 2014-08-04

* `category` option added to indicate the purpose of the scan page and/or reference code, entered data will be prepended to the reference code (separated by a colon)

#### 1.20 – 2013-11-18

* `inputs` option added to support multiple input fields (names separated by semicolon), entered data will be joined (separated by semicolons)
* `validation` option added to check input field for required data, e-mail address, phone number, any regular expression or using a custom function
* `require` option now deprecated (converted to `prompt` option and `validation="required"` for backward compatibility)
* `jquery` option added to run script when document.ready (mainly for Joomla web sites which requires tag in header)

#### 1.19 – 2013-11-04

* Added `[phpvar]` shortcode to retrieve the PHP superglobals $\_GET, $\_POST and $\_SERVER
* Required to get the value of URL parameters, post variables, initiating web pages, etc.
* Added because they may be needed for ScanCircle and I could not find an easy way or simple plugin to achieve this

#### 1.18 – 2013-10-07

* First release

## Meta

* Version **2.9.3**
* Last updated **1 month ago**
* Active installations **80+**
* WordPress version **2.5 or higher**
* Tested up to **6.7.1**
* Tags [button](https://wordpress.org/plugins/tags/button/)[scan](https://wordpress.org/plugins/tags/scan/)[shortcode](https://wordpress.org/plugins/tags/shortcode/)[widget](https://wordpress.org/plugins/tags/widget/)
* [Advanced View](https://wordpress.org/plugins/scancircle/advanced/)

## Ratings

5 out of 5 stars.

* [2 5-star reviews
  5 stars

  2](https://wordpress.org/support/plugin/scancircle/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/scancircle/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/scancircle/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/scancircle/reviews/?filter=2)
* [0 1-star reviews
  1 star

  0](https://wordpress.org/support/plugin/scancircle/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/scancircle/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/scancircle/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/0c32dddd23ef196e82f739c9942b7ff71b4e14b3df8936daa12844be07c55c65?s=32&d=mm&r=g) [Arnoud Klaren](https://profiles.wordpress.org/aklaren/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/scancircle/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_ee77c5a2_20250115_093810.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fscancircle%2Ftrunk%2Fscancircle.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/scancircle/trunk/scancircle.php?rev=3198225 "Revision 3198225")
* Next Revision →
* [Blame](/browser/scancircle/trunk/scancircle.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/scancircle/trunk/scancircle.php)

---

# [source:](/browser?order=name "Go to repository root") [scancircle](/browser/scancircle?order=name "View scancircle")/[trunk](/browser/scancircle/trunk?order=name "View trunk")/[scancircle.php](/browser/scancircle/trunk/scancircle.php?order=name "View scancircle.php")

View diff against:

View revision:

| [Last change](/changeset/3202428/scancircle/trunk/scancircle.php "View differences") on this file was [3202428](/changeset/3202428/ "View changeset 3202428"), checked in by aklaren, [6 weeks ago](/timeline?from=2024-12-04T13%3A09%3A24Z&precision=second "See timeline at 12/04/2024 01:09:24 PM") |
| --- |
| Restricted the IFRAME attributes to prevent possible abuse of event attributes for cross-site scripting |
| **File size:** 4.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Plugin Name: ScanCircle |
| [4](#L4) | \* Plugin URI: https://wordpress.org/plugins/scancircle |
| [5](#L5) | \* Description: Shortcode for the scan widget on ScanCircle partner websites. Only for registered ScanCircle partners. |
| [6](#L6) | \* Version: 2.9.3 |
| [7](#L7) | \* Note: IMPORTANT \*\*\* always keep this version number in sync with the one in the function below \*\*\* |
| [8](#L8) | \* Author: Arnoud Klaren |
| [9](#L9) | \*/ |
| [10](#L10) | add\_shortcode('scancircle', 'scancircle\_widget'); |
| [11](#L11) |  |
| [12](#L12) | function scancircle\_widget( $atts ) { |
| [13](#L13) | // \*\*\* IMPORTANT: always keep this version number in sync with the one in the header above \*\*\* |
| [14](#L14) | $version = '2.9.3'; |
| [15](#L15) | $options = '?plugin=WordPress'.$version; |
| [16](#L16) | $partner = ''; |
| [17](#L17) | $language = 'en'; |
| [18](#L18) | $secure = 's'; |
| [19](#L19) | $env = 'com'; |
| [20](#L20) | $deps = array(); |
| [21](#L21) | foreach($atts as $key => $val) { |
| [22](#L22) | switch(strtolower($key)) { |
| [23](#L23) | case 'partner': |
| [24](#L24) | if(preg\_match('/[^a-z0-9]/i', $val)) { |
| [25](#L25) | return scancircle\_error('Only alphanumerical characters supported in partner parameter'); |
| [26](#L26) | } |
| [27](#L27) | $partner = strtolower($val); |
| [28](#L28) | break; |
| [29](#L29) | case 'language': |
| [30](#L30) | if(preg\_match('/[^a-z]/i', $val)) { |
| [31](#L31) | return scancircle\_error('Only alpha characters supported in language parameter'); |
| [32](#L32) | } |
| [33](#L33) | $language = strtolower($val); |
| [34](#L34) | break; |
| [35](#L35) | case 'https': |
| [36](#L36) | if($val === '0') { $secure = ''; } |
| [37](#L37) | break; |
| [38](#L38) | case 'env': |
| [39](#L39) | if(str\_starts\_with($val, '/')) { $val = $env.$val; } |
| [40](#L40) | if(!preg\_match( '`^(com|eu)(\/[a-z0-9]+)?$`', $val)) { |
| [41](#L41) | return scancircle\_error('Env parameter should be in the format [TLD][/ENV]'); |
| [42](#L42) | } |
| [43](#L43) | $env = $val; |
| [44](#L44) | break; |
| [45](#L45) | case 'speedometer': |
| [46](#L46) | $deps[] = 'jquery'; |
| [47](#L47) | // do not break |
| [48](#L48) | default: |
| [49](#L49) | if(preg\_match( '/[^a-z]/i', $key)) { |
| [50](#L50) | // invalid key names are returned as '0' |
| [51](#L51) | if($key == '0') { |
| [52](#L52) | return scancircle\_error('Invalid key name detected'); |
| [53](#L53) | } |
| [54](#L54) | return scancircle\_error('Only alpha characters supported in key names: '.$key); |
| [55](#L55) | } |
| [56](#L56) | if($val !== sanitize\_text\_field(str\_replace('"', '', $val))) { |
| [57](#L57) | return scancircle\_error('Invalid characters detected in parameter: '.$key); |
| [58](#L58) | } |
| [59](#L59) | $options .= '&amp;'.$key.'='.rawurlencode($val); |
| [60](#L60) | } |
| [61](#L61) | } |
| [62](#L62) |  |
| [63](#L63) | if(!$partner) { |
| [64](#L64) | return scancircle\_error('Syntax: [scancircle partner="PARTNER-CODE" OPTIONS]'); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | wp\_enqueue\_script('scancircle-script', |
| [68](#L68) | "http$secure://$partner.scancircle.$env/$language/scancircle.js$options", |
| [69](#L69) | $deps, NULL, true); |
| [70](#L70) |  |
| [71](#L71) | return <<< EOL |
| [72](#L72) | <div id="scancircle"> |
| [73](#L73) | <a href="http://$partner.scancircle.$env/$language/scan" id="scancircle\_button" title="ScanCircle Scan">ScanCircle</a> |
| [74](#L74) | </div> |
| [75](#L75) | EOL; |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | add\_shortcode('scancircle\_results', 'scancircle\_results'); |
| [79](#L79) |  |
| [80](#L80) | function scancircle\_results( $atts ) { |
| [81](#L81) | $partner = ''; |
| [82](#L82) | $param = ''; |
| [83](#L83) | $attribs = ''; |
| [84](#L84) | foreach($atts as $key => $val) { |
| [85](#L85) | switch(strtolower($key)) { |
| [86](#L86) | case 'partner': |
| [87](#L87) | if(preg\_match( '/[^a-z0-9]/i', $val)) { |
| [88](#L88) | return scancircle\_error('Only alphanumerical characters supported in partner parameter'); |
| [89](#L89) | } |
| [90](#L90) | $partner = strtolower($val); |
| [91](#L91) | break; |
| [92](#L92) | case 'param': |
| [93](#L93) | if(preg\_match( '/[^a-z]/i', $val)) { |
| [94](#L94) | return scancircle\_error('Only alpha characters supported in param parameter'); |
| [95](#L95) | } |
| [96](#L96) | $param = strtolower($val); |
| [97](#L97) | break; |
| [98](#L98) | case 'width': |
| [99](#L99) | case 'height': |
| [100](#L100) | case 'name': |
| [101](#L101) | case 'loading': |
| [102](#L102) | case 'id': |
| [103](#L103) | case 'class': |
| [104](#L104) | case 'style': |
| [105](#L105) | case 'tabindex': |
| [106](#L106) | case 'title': |
| [107](#L107) | case 'draggable': |
| [108](#L108) | if($val !== sanitize\_text\_field(str\_replace('"', '', $val))) { |
| [109](#L109) | return scancircle\_error('Invalid characters detected in parameter: '.$key); |
| [110](#L110) | } |
| [111](#L111) | $attribs .= ' '.strtolower($key).'="'. htmlentities($val).'"'; |
| [112](#L112) | break; |
| [113](#L113) | default: |
| [114](#L114) | return scancircle\_error('Unsupported attribute: '.$key); |
| [115](#L115) | } |
| [116](#L116) | } |
| [117](#L117) | if(!$partner || !$param) { |
| [118](#L118) | return scancircle\_error('Syntax: [scancircle\_results partner="PARTNER-CODE" param="URL-PARAMETER" IFRAME-ATTRIBUTES]'); |
| [119](#L119) | } |
| [120](#L120) | if(!isset($\_GET[$param])) { |
| [121](#L121) | return scancircle\_error('Missing URL-parameter: '.$param); |
| [122](#L122) | } |
| [123](#L123) | if(!filter\_var($url = $\_GET[$param], FILTER\_VALIDATE\_URL)) { |
| [124](#L124) | return scancircle\_error('Invalid URL: '.htmlentities($url)); |
| [125](#L125) | } |
| [126](#L126) | if(!preg\_match('/^https?:\/\/'.$partner.'\.scancircle\.(com|eu)\//i', $url)) { |
| [127](#L127) | return scancircle\_error('Only valid for ScanCircle URLs for partner: '.$partner); |
| [128](#L128) | } |
| [129](#L129) | return '<iframe src="'.$url.'"'.$attribs.'></iframe>'; |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | function scancircle\_error($msg) { |
| [133](#L133) | return '\*\*\*ERROR ScanCircle shortcode: '.sanitize\_text\_field($msg).' \*\*\*'; |
| [134](#L134) | } |
| [135](#L135) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/scancircle/trunk/scancircle.php?format=txt)
* [Original Format](/export/3222726/scancircle/trunk/scancircle.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


