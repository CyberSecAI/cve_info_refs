=== Content from www.wordfence.com_38d71cfb_20250114_181850.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Email Subscription Popup <= 1.2.22 - Authenticated (Contributor+) Stored Cross-Site Scripting via print\_email\_subscribe\_form Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Email Subscription Popup <= 1.2.22 - Authenticated (Contributor+) Stored Cross-Site Scripting via print\_email\_subscribe\_form Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11195](https://www.cve.org/CVERecord?id=CVE-2024-11195) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | November 18, 2024 |
| Last Updated | November 19, 2024 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The Email Subscription Popup plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's print\_email\_subscribe\_form shortcode in all versions up to, and including, 1.2.22 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/email-subscribe/tags/1.2.22/wp-email-subscription.php#L2860)
* [wordpress.org](https://wordpress.org/plugins/email-subscribe/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3189989/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1222-authenticated-contributor-stored-cross-site-scripting-via-print-email-subscribe-form-shortcode&t=Email%20Subscription%20Popup%20%3C%3D%201.2.22%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20print_email_subscribe_form%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1222-authenticated-contributor-stored-cross-site-scripting-via-print-email-subscribe-form-shortcode&text=Email%20Subscription%20Popup%20%3C%3D%201.2.22%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20print_email_subscribe_form%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1222-authenticated-contributor-stored-cross-site-scripting-via-print-email-subscribe-form-shortcode "LinkedIn")
Email

## Vulnerability Details for Email Subscription Popup

#### [Email Subscription Popup](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/email-subscribe)

| Software Type | Plugin |
| --- | --- |
| Software Slug | email-subscribe [(view on wordpress.org)](https://wordpress.org/plugins/email-subscribe) |
| Patched? | Yes |
| Remediation | Update to version 1.2.23, or a newer patched version |
| Affected Version | * <= 1.2.22 |
| Patched Version | * 1.2.23 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_a5f4cbe2_20250114_181847.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3189989)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3189988 "Changeset 3189988")
* [Next Changeset](/changeset/3189990 "Changeset 3189990") →

---

# Changeset 3189989

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/16/2024 06:19:09 AM
([2 months](/timeline?from=2024-11-16T06%3A19%3A09Z&precision=second "See timeline at 11/16/2024 06:19:09 AM") ago)

Author:
nik00726
Message:

Fixed vulnerability Cross-Site Scripting reported by Wordfence

Location:
[email-subscribe](/browser/email-subscribe?rev=3189989)
Files:

37 added
1 edited

* [tags/1.2.23](/browser/email-subscribe/tags/1.2.23?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/css](/browser/email-subscribe/tags/1.2.23/css?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/css/styles.css](/browser/email-subscribe/tags/1.2.23/css/styles.css?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/css/subscribe-popup.css](/browser/email-subscribe/tags/1.2.23/css/subscribe-popup.css?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/css/wp-email-subscription-popup.css](/browser/email-subscribe/tags/1.2.23/css/wp-email-subscription-popup.css?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images](/browser/email-subscribe/tags/1.2.23/images?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/1378845314\_001\_06.gif](/browser/email-subscribe/tags/1.2.23/images/1378845314_001_06.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/1378845578\_Error.png](/browser/email-subscribe/tags/1.2.23/images/1378845578_Error.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/300x250-animated.gif](/browser/email-subscribe/tags/1.2.23/images/300x250-animated.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/300x250.gif](/browser/email-subscribe/tags/1.2.23/images/300x250.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/300x250.png](/browser/email-subscribe/tags/1.2.23/images/300x250.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/AjaxLoader.gif](/browser/email-subscribe/tags/1.2.23/images/AjaxLoader.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/ajax-loader.gif](/browser/email-subscribe/tags/1.2.23/images/ajax-loader.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/asc.png](/browser/email-subscribe/tags/1.2.23/images/asc.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/blue-bg.jpg](/browser/email-subscribe/tags/1.2.23/images/blue-bg.jpg?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/calendar.gif](/browser/email-subscribe/tags/1.2.23/images/calendar.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/close-buttons-sprite.png](/browser/email-subscribe/tags/1.2.23/images/close-buttons-sprite.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/desc.png](/browser/email-subscribe/tags/1.2.23/images/desc.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/divi\_300x250.jpg](/browser/email-subscribe/tags/1.2.23/images/divi_300x250.jpg?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/envelope.png](/browser/email-subscribe/tags/1.2.23/images/envelope.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/g-suite-promo-code-4.png](/browser/email-subscribe/tags/1.2.23/images/g-suite-promo-code-4.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/gsuite\_promo.png](/browser/email-subscribe/tags/1.2.23/images/gsuite_promo.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/paypaldonate.jpg](/browser/email-subscribe/tags/1.2.23/images/paypaldonate.jpg?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box](/browser/email-subscribe/tags/1.2.23/images/vl-box?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box/controls.png](/browser/email-subscribe/tags/1.2.23/images/vl-box/controls.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box/loading.gif](/browser/email-subscribe/tags/1.2.23/images/vl-box/loading.gif?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box/player\_play.png](/browser/email-subscribe/tags/1.2.23/images/vl-box/player_play.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box/playico.png](/browser/email-subscribe/tags/1.2.23/images/vl-box/playico.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/images/vl-box/playico2.png](/browser/email-subscribe/tags/1.2.23/images/vl-box/playico2.png?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/js](/browser/email-subscribe/tags/1.2.23/js?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/js/jqueryValidate.js](/browser/email-subscribe/tags/1.2.23/js/jqueryValidate.js?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/js/subscribe-popup.js](/browser/email-subscribe/tags/1.2.23/js/subscribe-popup.js?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/js/wp-email-subscription-popup-js.js](/browser/email-subscribe/tags/1.2.23/js/wp-email-subscription-popup-js.js?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/languages](/browser/email-subscribe/tags/1.2.23/languages?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/languages/email-subscribe.pot](/browser/email-subscribe/tags/1.2.23/languages/email-subscribe.pot?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/readme.txt](/browser/email-subscribe/tags/1.2.23/readme.txt?rev=3189989 "Show entry in browser")
  (added)
* [tags/1.2.23/wp-email-subscription.php](/browser/email-subscribe/tags/1.2.23/wp-email-subscription.php?rev=3189989 "Show entry in browser")
  (added)
* [trunk/readme.txt](/browser/email-subscribe/trunk/readme.txt?rev=3189989 "Show entry in browser")
  (modified)
  ([2 diffs](#file37 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [email-subscribe/trunk/readme.txt](/changeset/3189989/email-subscribe/trunk/readme.txt "Show the changeset 3189989 restricted to email-subscribe/trunk/readme.txt")

  | [r3126385](/browser/email-subscribe/trunk/readme.txt?rev=3126385#L4 "Show revision 3126385 of this file in browser") | [r3189989](/browser/email-subscribe/trunk/readme.txt?rev=3189989#L4 "Show revision 3189989 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Donate link: http://www.i13websolution.com/donate\_for\_mass\_email.php |
  | 5 | 5 | Requires at least:3.0 |
  | 6 |  | Tested up to:6.~~6~~ |
  | 7 |  | Version:1.2.2~~2~~ |
  | 8 |  | Stable tag:1.2.2~~2~~ |
  |  | 6 | Tested up to:6.7 |
  |  | 7 | Version:1.2.23 |
  |  | 8 | Stable tag:1.2.23 |
  | 9 | 9 | License:GPLv2 or later |
  | 10 | 10 | License URI:http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/email-subscribe/trunk/readme.txt?rev=3126385#L169) | […](/browser/email-subscribe/trunk/readme.txt?rev=3189989#L169) |  |
  | 169 | 169 |  |
  | 170 | 170 | == Changelog == |
  |  | 171 |  |
  |  | 172 | = 1.2.23 = |
  |  | 173 |  |
  |  | 174 | \* Fixed vulnerability Cross-Site Scripting reported by Wordfence |
  | 171 | 175 |  |
  | 172 | 176 | = 1.2.22 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3189989)
* [Zip Archive](?format=zip&new=3189989)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_32473ffe_20250114_181846.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Femail-subscribe%2Ftags%2F1.2.22%2Fwp-email-subscription.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/email-subscribe/tags/1.2.22/wp-email-subscription.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/email-subscribe/tags/1.2.22/wp-email-subscription.php)

---

# [source:](/browser?order=name "Go to repository root") [email-subscribe](/browser/email-subscribe?order=name "View email-subscribe")/[tags](/browser/email-subscribe/tags?order=name "View tags")/[1.2.22](/browser/email-subscribe/tags/1.2.22?order=name "View 1.2.22")/[wp-email-subscription.php](/browser/email-subscribe/tags/1.2.22/wp-email-subscription.php?order=name "View wp-email-subscription.php")

View diff against:

View revision:

| [Last change](/changeset/3070998/email-subscribe/tags/1.2.22/wp-email-subscription.php "View differences") on this file was [3070998](/changeset/3070998/ "View changeset 3070998"), checked in by nik00726, [9 months ago](/timeline?from=2024-04-15T16%3A13%3A06Z&precision=second "See timeline at 04/15/2024 04:13:06 PM") |
| --- |
| Added option to print email subscribe form via shortcode |
| **File size:** 186.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: email subscription popup |
| [4](#L4) | Plugin URI:https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/ |
| [5](#L5) | Author URI:https://www.i13websolution.com/ |
| [6](#L6) | Description: This is beautiful email subscription modal popup plugin for wordpress.Each time new user visit your site user will see modal popup for email subscription.Even you can setup email subscription form by widget. |
| [7](#L7) | Author:I Thirteen Web Solution |
| [8](#L8) | Version:1.2.22 |
| [9](#L9) | Text Domain:email-subscribe |
| [10](#L10) | Domain Path: /languages |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | add\_action('admin\_menu', 'email\_subscription\_popup\_admin\_menu'); |
| [14](#L14) | //add\_action( 'admin\_init', 'email\_subscription\_popup\_admin\_admin\_init' ); |
| [15](#L15) | register\_activation\_hook(\_\_FILE\_\_, 'install\_email\_subscription\_popup\_admin'); |
| [16](#L16) | register\_deactivation\_hook(\_\_FILE\_\_, 'es\_email\_subscribe\_remove\_access\_capabilities'); |
| [17](#L17) | add\_action('wp\_enqueue\_scripts', 'email\_subscription\_popup\_load\_styles\_and\_js'); |
| [18](#L18) | if (!is\_admin()) { |
| [19](#L19) | add\_action('wp\_footer', 'addModalPopupHtmlToWpFooter'); |
| [20](#L20) | } |
| [21](#L21) | add\_action('wp\_head', 'unsubscribe\_user\_func'); |
| [22](#L22) | add\_action('wp\_ajax\_getEmailTemplate', 'getEmailTemplate'); |
| [23](#L23) | add\_action('widgets\_init', 'nksnewslettersubscriberSet'); |
| [24](#L24) | add\_action('wp\_ajax\_store\_email', 'store\_email\_callback'); |
| [25](#L25) | add\_action('wp\_ajax\_nopriv\_store\_email', 'store\_email\_callback'); |
| [26](#L26) | add\_action('plugins\_loaded', 'load\_lang\_for\_email\_subscription\_popup'); |
| [27](#L27) | add\_filter('widget\_text', 'do\_shortcode'); |
| [28](#L28) | add\_filter('wp\_default\_editor', 'force\_default\_editor\_email\_subscriber'); |
| [29](#L29) | add\_filter('user\_has\_cap', 'es\_email\_subscribe\_admin\_cap\_list', 10, 4); |
| [30](#L30) | add\_shortcode('print\_email\_subscribe\_form', 'print\_email\_subscribe\_form\_func'); |
| [31](#L31) |  |
| [32](#L32) | function force\_default\_editor\_email\_subscriber() { |
| [33](#L33) | //allowed: tinymce, html |
| [34](#L34) | return 'tinymce'; |
| [35](#L35) | } |
| [36](#L36) |  |
| [37](#L37) | function load\_lang\_for\_email\_subscription\_popup() { |
| [38](#L38) |  |
| [39](#L39) | load\_plugin\_textdomain('email-subscribe', false, basename(dirname(\_\_FILE\_\_)) . '/languages/'); |
| [40](#L40) | add\_filter('map\_meta\_cap', 'map\_es\_email\_subscribe\_meta\_caps', 10, 4); |
| [41](#L41) | } |
| [42](#L42) |  |
| [43](#L43) | function es\_email\_subscribe\_admin\_cap\_list($allcaps, $caps, $args, $user) { |
| [44](#L44) |  |
| [45](#L45) |  |
| [46](#L46) | if (!in\_array('administrator', $user->roles)) { |
| [47](#L47) |  |
| [48](#L48) | return $allcaps; |
| [49](#L49) | } else { |
| [50](#L50) |  |
| [51](#L51) | if (!isset($allcaps['es\_email\_subscribe\_settings'])) { |
| [52](#L52) |  |
| [53](#L53) | $allcaps['es\_email\_subscribe\_settings'] = true; |
| [54](#L54) | } |
| [55](#L55) |  |
| [56](#L56) | if (!isset($allcaps['es\_email\_subscribe\_view\_subscribers'])) { |
| [57](#L57) |  |
| [58](#L58) | $allcaps['es\_email\_subscribe\_view\_subscribers'] = true; |
| [59](#L59) | } |
| [60](#L60) | if (!isset($allcaps['es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'])) { |
| [61](#L61) |  |
| [62](#L62) | $allcaps['es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'] = true; |
| [63](#L63) | } |
| [64](#L64) | if (!isset($allcaps['es\_email\_subscribe\_send\_email\_to\_all\_subscribers'])) { |
| [65](#L65) |  |
| [66](#L66) | $allcaps['es\_email\_subscribe\_send\_email\_to\_all\_subscribers'] = true; |
| [67](#L67) | } |
| [68](#L68) | if (!isset($allcaps['es\_email\_subscribe\_delete\_subscribers'])) { |
| [69](#L69) |  |
| [70](#L70) | $allcaps['es\_email\_subscribe\_delete\_subscribers'] = true; |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | if (!isset($allcaps['es\_email\_subscribe\_view\_unsubscribers'])) { |
| [74](#L74) |  |
| [75](#L75) | $allcaps['es\_email\_subscribe\_view\_unsubscribers'] = true; |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | if (!isset($allcaps['es\_email\_subscribe\_delete\_unsubscribers'])) { |
| [79](#L79) |  |
| [80](#L80) | $allcaps['es\_email\_subscribe\_delete\_unsubscribers'] = true; |
| [81](#L81) | } |
| [82](#L82) |  |
| [83](#L83) | if (!isset($allcaps['es\_email\_subscribe\_re\_subscriber\_unsubscribers'])) { |
| [84](#L84) |  |
| [85](#L85) | $allcaps['es\_email\_subscribe\_re\_subscriber\_unsubscribers'] = true; |
| [86](#L86) | } |
| [87](#L87) | if (!isset($allcaps['es\_email\_subscribe\_view\_shortcode'])) { |
| [88](#L88) |  |
| [89](#L89) | $allcaps['es\_email\_subscribe\_view\_shortcode'] = true; |
| [90](#L90) | } |
| [91](#L91) | } |
| [92](#L92) |  |
| [93](#L93) | return $allcaps; |
| [94](#L94) | } |
| [95](#L95) |  |
| [96](#L96) | function map\_es\_email\_subscribe\_meta\_caps(array $caps, $cap, $user\_id, array $args) { |
| [97](#L97) |  |
| [98](#L98) |  |
| [99](#L99) | if (!in\_array($cap, array( |
| [100](#L100) | 'es\_email\_subscribe\_settings', |
| [101](#L101) | 'es\_email\_subscribe\_view\_subscribers', |
| [102](#L102) | 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers', |
| [103](#L103) | 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers', |
| [104](#L104) | 'es\_email\_subscribe\_delete\_subscribers', |
| [105](#L105) | 'es\_email\_subscribe\_view\_unsubscribers', |
| [106](#L106) | 'es\_email\_subscribe\_delete\_unsubscribers', |
| [107](#L107) | 'es\_email\_subscribe\_re\_subscriber\_unsubscribers', |
| [108](#L108) | 'es\_email\_subscribe\_view\_shortcode', |
| [109](#L109) | ), true)) { |
| [110](#L110) |  |
| [111](#L111) | return $caps; |
| [112](#L112) | } |
| [113](#L113) |  |
| [114](#L114) |  |
| [115](#L115) |  |
| [116](#L116) |  |
| [117](#L117) | $caps = array(); |
| [118](#L118) |  |
| [119](#L119) | switch ($cap) { |
| [120](#L120) |  |
| [121](#L121) | case 'es\_email\_subscribe\_settings': |
| [122](#L122) | $caps[] = 'es\_email\_subscribe\_settings'; |
| [123](#L123) | break; |
| [124](#L124) |  |
| [125](#L125) | case 'es\_email\_subscribe\_view\_subscribers': |
| [126](#L126) | $caps[] = 'es\_email\_subscribe\_view\_subscribers'; |
| [127](#L127) | break; |
| [128](#L128) |  |
| [129](#L129) | case 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers': |
| [130](#L130) | $caps[] = 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'; |
| [131](#L131) | break; |
| [132](#L132) |  |
| [133](#L133) | case 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers': |
| [134](#L134) | $caps[] = 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers'; |
| [135](#L135) | break; |
| [136](#L136) |  |
| [137](#L137) | case 'es\_email\_subscribe\_delete\_subscribers': |
| [138](#L138) | $caps[] = 'es\_email\_subscribe\_delete\_subscribers'; |
| [139](#L139) | break; |
| [140](#L140) |  |
| [141](#L141) | case 'es\_email\_subscribe\_view\_unsubscribers': |
| [142](#L142) | $caps[] = 'es\_email\_subscribe\_view\_unsubscribers'; |
| [143](#L143) | break; |
| [144](#L144) |  |
| [145](#L145) | case 'es\_email\_subscribe\_delete\_unsubscribers': |
| [146](#L146) | $caps[] = 'es\_email\_subscribe\_delete\_unsubscribers'; |
| [147](#L147) | break; |
| [148](#L148) |  |
| [149](#L149) | case 'es\_email\_subscribe\_re\_subscriber\_unsubscribers': |
| [150](#L150) | $caps[] = 'es\_email\_subscribe\_re\_subscriber\_unsubscribers'; |
| [151](#L151) | break; |
| [152](#L152) |  |
| [153](#L153) | case 'es\_email\_subscribe\_view\_shortcode': |
| [154](#L154) | $caps[] = 'es\_email\_subscribe\_view\_shortcode'; |
| [155](#L155) | break; |
| [156](#L156) |  |
| [157](#L157) | default: |
| [158](#L158) |  |
| [159](#L159) | $caps[] = 'do\_not\_allow'; |
| [160](#L160) | break; |
| [161](#L161) | } |
| [162](#L162) |  |
| [163](#L163) |  |
| [164](#L164) | return apply\_filters('es\_email\_subscribe\_meta\_caps', $caps, $cap, $user\_id, $args); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | function es\_email\_subscribe\_add\_access\_capabilities() { |
| [168](#L168) |  |
| [169](#L169) | // Capabilities for all roles. |
| [170](#L170) | $roles = array('administrator'); |
| [171](#L171) | foreach ($roles as $role) { |
| [172](#L172) |  |
| [173](#L173) | $role = get\_role($role); |
| [174](#L174) | if (empty($role)) { |
| [175](#L175) | continue; |
| [176](#L176) | } |
| [177](#L177) |  |
| [178](#L178) |  |
| [179](#L179) | if (!$role->has\_cap('es\_email\_subscribe\_settings')) { |
| [180](#L180) |  |
| [181](#L181) | $role->add\_cap('es\_email\_subscribe\_settings'); |
| [182](#L182) | } |
| [183](#L183) |  |
| [184](#L184) | if (!$role->has\_cap('es\_email\_subscribe\_view\_subscribers')) { |
| [185](#L185) |  |
| [186](#L186) | $role->add\_cap('es\_email\_subscribe\_view\_subscribers'); |
| [187](#L187) | } |
| [188](#L188) |  |
| [189](#L189) |  |
| [190](#L190) | if (!$role->has\_cap('es\_email\_subscribe\_send\_email\_to\_selected\_subscribers')) { |
| [191](#L191) |  |
| [192](#L192) | $role->add\_cap('es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'); |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | if (!$role->has\_cap('es\_email\_subscribe\_send\_email\_to\_all\_subscribers')) { |
| [196](#L196) |  |
| [197](#L197) | $role->add\_cap('es\_email\_subscribe\_send\_email\_to\_all\_subscribers'); |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | if (!$role->has\_cap('es\_email\_subscribe\_delete\_subscribers')) { |
| [201](#L201) |  |
| [202](#L202) | $role->add\_cap('es\_email\_subscribe\_delete\_subscribers'); |
| [203](#L203) | } |
| [204](#L204) |  |
| [205](#L205) | if (!$role->has\_cap('es\_email\_subscribe\_view\_unsubscribers')) { |
| [206](#L206) |  |
| [207](#L207) | $role->add\_cap('es\_email\_subscribe\_view\_unsubscribers'); |
| [208](#L208) | } |
| [209](#L209) |  |
| [210](#L210) | if (!$role->has\_cap('es\_email\_subscribe\_delete\_unsubscribers')) { |
| [211](#L211) |  |
| [212](#L212) | $role->add\_cap('es\_email\_subscribe\_delete\_unsubscribers'); |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | if (!$role->has\_cap('es\_email\_subscribe\_re\_subscriber\_unsubscribers')) { |
| [216](#L216) |  |
| [217](#L217) | $role->add\_cap('es\_email\_subscribe\_re\_subscriber\_unsubscribers'); |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if (!$role->has\_cap('es\_email\_subscribe\_view\_shortcode')) { |
| [221](#L221) |  |
| [222](#L222) | $role->add\_cap('es\_email\_subscribe\_view\_shortcode'); |
| [223](#L223) | } |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | $user = wp\_get\_current\_user(); |
| [227](#L227) | $user->get\_role\_caps(); |
| [228](#L228) | } |
| [229](#L229) |  |
| [230](#L230) | function es\_email\_subscribe\_remove\_access\_capabilities() { |
| [231](#L231) |  |
| [232](#L232) | global $wp\_roles; |
| [233](#L233) |  |
| [234](#L234) | if (!isset($wp\_roles)) { |
| [235](#L235) | $wp\_roles = new WP\_Roles(); |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | if (isset($wp\_roles) && $wp\_roles != NULL && is\_object($wp\_roles) && 0 > count($wp\_roles->roles)) { |
| [239](#L239) |  |
| [240](#L240) | foreach ($wp\_roles->roles as $role => $details) { |
| [241](#L241) | $role = $wp\_roles->get\_role($role); |
| [242](#L242) | if (empty($role)) { |
| [243](#L243) | continue; |
| [244](#L244) | } |
| [245](#L245) |  |
| [246](#L246) | $role->remove\_cap('es\_email\_subscribe\_settings'); |
| [247](#L247) | $role->remove\_cap('es\_email\_subscribe\_view\_subscribers'); |
| [248](#L248) | $role->remove\_cap('es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'); |
| [249](#L249) | $role->remove\_cap('es\_email\_subscribe\_send\_email\_to\_all\_subscribers'); |
| [250](#L250) | $role->remove\_cap('es\_email\_subscribe\_delete\_subscribers'); |
| [251](#L251) | $role->remove\_cap('es\_email\_subscribe\_view\_unsubscribers'); |
| [252](#L252) | $role->remove\_cap('es\_email\_subscribe\_delete\_unsubscribers'); |
| [253](#L253) | $role->remove\_cap('es\_email\_subscribe\_re\_subscriber\_unsubscribers'); |
| [254](#L254) | $role->remove\_cap('es\_email\_subscribe\_view\_shortcode'); |
| [255](#L255) | } |
| [256](#L256) | } |
| [257](#L257) |  |
| [258](#L258) | // Refresh current set of capabilities of the user, to be able to directly use the new caps. |
| [259](#L259) | $user = wp\_get\_current\_user(); |
| [260](#L260) | $user->get\_role\_caps(); |
| [261](#L261) | } |
| [262](#L262) |  |
| [263](#L263) | function nksnewslettersubscriberSet() { |
| [264](#L264) |  |
| [265](#L265) | register\_widget('nksnewslettersubscriber'); |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) | function install\_email\_subscription\_popup\_admin() { |
| [269](#L269) |  |
| [270](#L270) |  |
| [271](#L271) | global $wpdb; |
| [272](#L272) | $table\_name = $wpdb->prefix . "nl\_subscriptions"; |
| [273](#L273) | $table\_name2 = $wpdb->prefix . "newsletters\_management"; |
| [274](#L274) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [275](#L275) |  |
| [276](#L276) | $sql = "CREATE TABLE IF NOT EXISTS  " . $table\_name . " ( |
| [277](#L277) | `id` int(10) unsigned NOT NULL AUTO\_INCREMENT, |
| [278](#L278) | `name` varchar(200) NOT NULL, |
| [279](#L279) | `email` varchar(250) NOT NULL, |
| [280](#L280) | `subscribed\_on` datetime NOT NULL, |
| [281](#L281) | `is\_subscribed` tinyint(1) NOT NULL DEFAULT '1', |
| [282](#L282) | `unsubs\_key` varchar(100) NOT NULL, |
| [283](#L283) | PRIMARY KEY  (id) |
| [284](#L284) | ) $charset\_collate;"; |
| [285](#L285) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [286](#L286) | dbDelta($sql); |
| [287](#L287) |  |
| [288](#L288) | $wp\_news\_letter\_settings = array( |
| [289](#L289) | 'newsletter\_show\_on' => 'any', |
| [290](#L290) | 'newsletter\_cookie' => '1', |
| [291](#L291) | 'heading' => 'Subscribe to our newsletter', |
| [292](#L292) | 'subheading' => 'Want to be notified when our article is published? Enter your email address and name below to be the first to know.', |
| [293](#L293) | 'email' => 'Email', |
| [294](#L294) | 'name' => 'Name', |
| [295](#L295) | 'submitbtn' => 'SIGN UP FOR NEWSLETTER NOW', |
| [296](#L296) | 'requiredfield' => 'This field is required.', |
| [297](#L297) | 'iinvalidemail' => 'Please enter valid email address.', |
| [298](#L298) | 'wait' => 'Please wait...', |
| [299](#L299) | 'invalid\_request' => 'Invalid request.', |
| [300](#L300) | 'email\_exist' => 'This email is already exist.', |
| [301](#L301) | 'success' => 'You have successfully subscribed to our Newsletter!', |
| [302](#L302) | 'outgoing\_email\_limit' => '150', |
| [303](#L303) | 'unsubscribe\_message' => 'You have successfully unsubscribed from email newsletter.Thank you...', |
| [304](#L304) | 'show\_name\_field' => '1', |
| [305](#L305) | 'show\_agreement' => '0', |
| [306](#L306) | 'agreement\_text' => 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>', |
| [307](#L307) | 'agreement\_error' => 'Please read and agree to our terms & conditions.', |
| [308](#L308) | 'additional\_css' => '' |
| [309](#L309) | ); |
| [310](#L310) |  |
| [311](#L311) | $existingopt = get\_option('wp\_news\_letter\_settings'); |
| [312](#L312) | if (!is\_array($existingopt)) { |
| [313](#L313) |  |
| [314](#L314) | update\_option('wp\_news\_letter\_settings', $wp\_news\_letter\_settings); |
| [315](#L315) | } else { |
| [316](#L316) |  |
| [317](#L317) | $flag = false; |
| [318](#L318) | if (!isset($existingopt['unsubscribe\_message'])) { |
| [319](#L319) |  |
| [320](#L320) | $flag = true; |
| [321](#L321) | $existingopt['unsubscribe\_message'] = 'You have successfully unsubscribed from email newsletter.Thank you...'; |
| [322](#L322) | } |
| [323](#L323) | if (!isset($existingopt['show\_name\_field'])) { |
| [324](#L324) |  |
| [325](#L325) | $flag = true; |
| [326](#L326) | $existingopt['show\_name\_field'] = '1'; |
| [327](#L327) | } |
| [328](#L328) |  |
| [329](#L329) | if (!isset($existingopt['show\_agreement'])) { |
| [330](#L330) |  |
| [331](#L331) | $flag = true; |
| [332](#L332) | $existingopt['show\_agreement'] = '0'; |
| [333](#L333) | } |
| [334](#L334) |  |
| [335](#L335) | if (!isset($existingopt['agreement\_text'])) { |
| [336](#L336) |  |
| [337](#L337) | $flag = true; |
| [338](#L338) | $existingopt['agreement\_text'] = 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>'; |
| [339](#L339) | } |
| [340](#L340) |  |
| [341](#L341) | if (!isset($existingopt['agreement\_error'])) { |
| [342](#L342) |  |
| [343](#L343) | $flag = true; |
| [344](#L344) | $existingopt['agreement\_error'] = 'Please read and agree to our terms & conditions.'; |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | if (!isset($existingopt['additional\_css'])) { |
| [348](#L348) | $flag = true; |
| [349](#L349) | $existingopt['additional\_css'] = ''; |
| [350](#L350) | } |
| [351](#L351) |  |
| [352](#L352) | if ($flag == true) { |
| [353](#L353) |  |
| [354](#L354) | update\_option('wp\_news\_letter\_settings', $existingopt); |
| [355](#L355) | } |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | es\_email\_subscribe\_add\_access\_capabilities(); |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | function email\_subscription\_popup\_admin\_menu() { |
| [362](#L362) |  |
| [363](#L363) |  |
| [364](#L364) | $hook\_suffix = add\_menu\_page(\_\_('Email Subscription', 'email-subscribe'), \_\_('Email Subscription', 'email-subscribe'), 'es\_email\_subscribe\_settings', 'email\_subscription\_popup', 'email\_subscription\_popup\_admin\_options'); |
| [365](#L365) | $hook\_suffix = add\_submenu\_page('email\_subscription\_popup', \_\_('Email Subscription Form Setting', 'email-subscribe'), \_\_('Email Subscription Form Setting', 'email-subscribe'), 'es\_email\_subscribe\_settings', 'email\_subscription\_popup', 'email\_subscription\_popup\_admin\_options'); |
| [366](#L366) | $hook\_suffix\_subscriber = add\_submenu\_page('email\_subscription\_popup', \_\_('Manage Subscribers', 'email-subscribe'), \_\_('Manage Subscribers', 'email-subscribe'), 'es\_email\_subscribe\_view\_subscribers', 'email\_subscription\_popup\_subscribers\_management', 'massEmailToEmail\_Subscriber\_Func'); |
| [367](#L367) | $hook\_suffix\_unsubscriber = add\_submenu\_page('email\_subscription\_popup', \_\_('Unsubscribers List', 'email-subscribe'), \_\_('Unsubscribers List', 'email-subscribe'), 'es\_email\_subscribe\_view\_unsubscribers', 'Newssletter-Email-Unsubscriber', 'email\_subscription\_unsubscribers\_func'); |
| [368](#L368) | $hook\_suffix\_shortcode= add\_submenu\_page('email\_subscription\_popup', \_\_('Email Subscribe Form Shortcode', 'email-subscribe'), \_\_('Email Subscribe Form Shortcode', 'email-subscribe'), 'es\_email\_subscribe\_view\_shortcode', 'Newssletter-Email-Shortcode', 'email\_subscription\_shortcode\_func'); |
| [369](#L369) |  |
| [370](#L370) | add\_action('load-' . $hook\_suffix, 'email\_subscription\_popup\_admin\_admin\_init'); |
| [371](#L371) | add\_action('load-' . $hook\_suffix\_subscriber, 'email\_subscription\_popup\_admin\_admin\_init'); |
| [372](#L372) | add\_action('load-' . $hook\_suffix\_unsubscriber, 'email\_subscription\_popup\_admin\_admin\_init'); |
| [373](#L373) | add\_action('load-' . $hook\_suffix\_shortcode, 'email\_subscription\_popup\_admin\_admin\_init'); |
| [374](#L374) | } |
| [375](#L375) |  |
| [376](#L376) | function email\_subscription\_popup\_admin\_admin\_init() { |
| [377](#L377) |  |
| [378](#L378) |  |
| [379](#L379) | wp\_enqueue\_style('email-subscribe-admin-css', plugins\_url('/css/styles.css', \_\_FILE\_\_)); |
| [380](#L380) | wp\_enqueue\_script('jquery'); |
| [381](#L381) | wp\_enqueue\_script('email-subscribe-jquery.validate', plugins\_url('/js/jqueryValidate.js', \_\_FILE\_\_)); |
| [382](#L382) | } |
| [383](#L383) |  |
| [384](#L384) | function unsubscribe\_user\_func() { |
| [385](#L385) |  |
| [386](#L386) |  |
| [387](#L387) | if (isset($\_GET) and isset($\_GET['action']) and isset($\_GET['unsc'])) { |
| [388](#L388) |  |
| [389](#L389) | if (trim($\_GET['unsc']) != '') { |
| [390](#L390) |  |
| [391](#L391) | $unsubscriberEmail = trim(urldecode($\_GET['unsc'])); |
| [392](#L392) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [393](#L393) | $wp\_news\_letter\_settings = stripslashes\_deep($wp\_news\_letter\_settings); |
| [394](#L394) | $unsubscriberEmail = sanitize\_text\_field($unsubscriberEmail); |
| [395](#L395) | $unsubscriberEmail = esc\_html($unsubscriberEmail); |
| [396](#L396) |  |
| [397](#L397) | global $wpdb; |
| [398](#L398) | $query = $wpdb->prepare('SELECT \* FROM ' . $wpdb->prefix . 'nl\_subscriptions where unsubs\_key = %s', array($unsubscriberEmail)); |
| [399](#L399) | $myrow = $wpdb->get\_row($query); |
| [400](#L400) |  |
| [401](#L401) | if (is\_object($myrow)) { |
| [402](#L402) |  |
| [403](#L403) | $key = md5(uniqid(rand(), true)); |
| [404](#L404) |  |
| [405](#L405) | $wpdb->update( |
| [406](#L406) | $wpdb->prefix . 'nl\_subscriptions', |
| [407](#L407) | array( |
| [408](#L408) | 'is\_subscribed' => 0, // column & new value |
| [409](#L409) | 'unsubs\_key' => $key // column & new value |
| [410](#L410) | ), |
| [411](#L411) | array( |
| [412](#L412) | 'unsubs\_key' => $unsubscriberEmail, // where clause(s) |
| [413](#L413) | ), |
| [414](#L414) | array( |
| [415](#L415) | '%d', |
| [416](#L416) | '%s' |
| [417](#L417) | ), |
| [418](#L418) | array( |
| [419](#L419) | '%s' |
| [420](#L420) | ) |
| [421](#L421) | ); |
| [422](#L422) |  |
| [423](#L423) | echo "<script>alert('" . $wp\_news\_letter\_settings['unsubscribe\_message'] . "')</script>"; |
| [424](#L424) | $url = get\_bloginfo('url'); |
| [425](#L425) | echo "<script>window.location.href='" . $url . "';</script>"; |
| [426](#L426) | exit; |
| [427](#L427) | } |
| [428](#L428) | } |
| [429](#L429) | } |
| [430](#L430) | } |
| [431](#L431) |  |
| [432](#L432) | function email\_subscription\_unsubscribers\_func() { |
| [433](#L433) |  |
| [434](#L434) |  |
| [435](#L435) | $selfpage = wp\_get\_referer(); |
| [436](#L436) |  |
| [437](#L437) | $action = ''; |
| [438](#L438) | if (isset($\_REQUEST['action'])) { |
| [439](#L439) | $action = $\_REQUEST['action']; |
| [440](#L440) | } |
| [441](#L441) | ?> |
| [442](#L442) |  |
| [443](#L443) | <?php |
| [444](#L444) | switch ($action) { |
| [445](#L445) |  |
| [446](#L446) | default: |
| [447](#L447) |  |
| [448](#L448) | if (isset($\_POST['deleteEmails'])) { |
| [449](#L449) |  |
| [450](#L450) | if (!check\_admin\_referer('action\_resubscribe\_add\_edit', 'resubscribe\_and\_delete\_subsciber')) { |
| [451](#L451) |  |
| [452](#L452) | wp\_die('Security check fail'); |
| [453](#L453) | } |
| [454](#L454) |  |
| [455](#L455) | if (!current\_user\_can('es\_email\_subscribe\_delete\_unsubscribers')) { |
| [456](#L456) |  |
| [457](#L457) | wp\_die(\_\_("Access Denied", "video-grid")); |
| [458](#L458) | } |
| [459](#L459) |  |
| [460](#L460) | global $wpdb; |
| [461](#L461) | $subscribersSelectedEmails = $\_POST['ckboxs']; |
| [462](#L462) | $mass\_email\_queue = get\_option('mass\_email\_queue\_news\_subscriber'); |
| [463](#L463) | foreach ($subscribersSelectedEmails as $em) { |
| [464](#L464) |  |
| [465](#L465) | $em = htmlentities(strip\_tags(sanitize\_email($em)), ENT\_QUOTES); |
| [466](#L466) | if ($em != "") { |
| [467](#L467) |  |
| [468](#L468) | $query = "delete from  " . $wpdb->prefix . "nl\_subscriptions where email='$em'"; |
| [469](#L469) | $wpdb->query($query); |
| [470](#L470) | if (is\_array($mass\_email\_queue)) { |
| [471](#L471) |  |
| [472](#L472) | $key = (int) array\_search($em, $mass\_email\_queue); |
| [473](#L473) | if (array\_search($em, $mass\_email\_queue) >= 0) { |
| [474](#L474) |  |
| [475](#L475) | unset($mass\_email\_queue[$key]); |
| [476](#L476) | } |
| [477](#L477) | } |
| [478](#L478) | } |
| [479](#L479) | } |
| [480](#L480) |  |
| [481](#L481) | update\_option('mass\_email\_subscribers\_succ', \_\_('Selected subscribers deleted successfully.', 'email-subscribe')); |
| [482](#L482) | update\_option('mass\_email\_queue\_news\_subscriber', $mass\_email\_queue); |
| [483](#L483) | } else if (isset($\_POST['resubscribe'])) { |
| [484](#L484) |  |
| [485](#L485) |  |
| [486](#L486) | if (!check\_admin\_referer('action\_resubscribe\_add\_edit', 'resubscribe\_and\_delete\_subsciber')) { |
| [487](#L487) |  |
| [488](#L488) | wp\_die('Security check fail'); |
| [489](#L489) | } |
| [490](#L490) |  |
| [491](#L491) | if (!current\_user\_can('es\_email\_subscribe\_re\_subscriber\_unsubscribers')) { |
| [492](#L492) |  |
| [493](#L493) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [494](#L494) | } |
| [495](#L495) |  |
| [496](#L496) | global $wpdb; |
| [497](#L497) | $subscribersSelectedEmails = $\_POST['ckboxs']; |
| [498](#L498) | foreach ($subscribersSelectedEmails as $em) { |
| [499](#L499) |  |
| [500](#L500) | $em = htmlentities(strip\_tags(sanitize\_email($em)), ENT\_QUOTES); |
| [501](#L501) | if ($em != "") { |
| [502](#L502) |  |
| [503](#L503) | $query = "update " . $wpdb->prefix . "nl\_subscriptions set is\_subscribed=1  where email='$em'"; |
| [504](#L504) | $wpdb->query($query); |
| [505](#L505) | } |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | update\_option('mass\_email\_subscribers\_succ', \_\_('Selected subscribers successfully re-subscribed.', 'email-subscribe')); |
| [509](#L509) | } |
| [510](#L510) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [511](#L511) | $url = str\_replace("\\", "/", $url); |
| [512](#L512) |  |
| [513](#L513) | if (!current\_user\_can('es\_email\_subscribe\_view\_unsubscribers')) { |
| [514](#L514) |  |
| [515](#L515) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [516](#L516) | } |
| [517](#L517) | ?> |
| [518](#L518) | <div style="width: 100%;"> |
| [519](#L519) | <div style="float:left;width:65%;" > |
| [520](#L520) |  |
| [521](#L521) | <?php |
| [522](#L522) | global $wpdb; |
| [523](#L523) |  |
| [524](#L524) | $query = "SELECT \* from " . $wpdb->prefix . "nl\_subscriptions where is\_subscribed=0 "; |
| [525](#L525) | $queryCount = "SELECT count(\*) from " . $wpdb->prefix . "nl\_subscriptions where is\_subscribed=0 "; |
| [526](#L526) |  |
| [527](#L527) | if (isset($\_GET['searchuser']) and $\_GET['searchuser'] != '') { |
| [528](#L528) |  |
| [529](#L529) | $term = sanitize\_text\_field(urldecode(esc\_sql($\_GET['searchuser']))); |
| [530](#L530) | $query .= "  and ( name like '%$term%' or email like '%$term%'  )  "; |
| [531](#L531) | $queryCount .= "  and ( name like '%$term%' or email like '%$term%'  )  "; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) |  |
| [535](#L535) |  |
| [536](#L536) | $totalRecordForQuery = $wpdb->get\_var($queryCount); |
| [537](#L537) | $selfPage = wp\_get\_referer() . '?page=Newssletter-Email-Unsubscriber'; |
| [538](#L538) | global $wp\_rewrite; |
| [539](#L539) |  |
| [540](#L540) | $rows\_per\_page = 10; |
| [541](#L541) | if (isset($\_GET['setPerPage']) and $\_GET['setPerPage'] != "") { |
| [542](#L542) |  |
| [543](#L543) | $rows\_per\_page = intval($\_GET['setPerPage']); |
| [544](#L544) | } |
| [545](#L545) |  |
| [546](#L546) |  |
| [547](#L547) | $current = (isset($\_GET['entrant'])) ? (intval($\_GET['entrant'])) : 1; |
| [548](#L548) | $pagination\_args = array( |
| [549](#L549) | 'base' => @add\_query\_arg('entrant', '%#%'), |
| [550](#L550) | 'format' => '', |
| [551](#L551) | 'total' => ceil($totalRecordForQuery / $rows\_per\_page), |
| [552](#L552) | 'current' => $current, |
| [553](#L553) | 'show\_all' => false, |
| [554](#L554) | 'type' => 'plain', |
| [555](#L555) | ); |
| [556](#L556) |  |
| [557](#L557) | $selfpage = wp\_get\_referer(); |
| [558](#L558) |  |
| [559](#L559) | if ($totalRecordForQuery > 0) { |
| [560](#L560) | ?> |
| [561](#L561) | <?php |
| [562](#L562) | $SuccMsg = get\_option('mass\_email\_subscribers\_succ'); |
| [563](#L563) | update\_option('mass\_email\_subscribers\_succ', ''); |
| [564](#L564) |  |
| [565](#L565) | $errMsg = get\_option('mass\_email\_subscribers\_err'); |
| [566](#L566) | update\_option('mass\_email\_subscribers\_err', ''); |
| [567](#L567) | ?> |
| [568](#L568) |  |
| [569](#L569) |  |
| [570](#L570) | <?php if ($SuccMsg != "") { |
| [571](#L571) | echo "<div class='notice notice-success is-dismissible'><p>"; |
| [572](#L572) | echo $SuccMsg; |
| [573](#L573) | echo "</p></div>"; |
| [574](#L574) | $SuccMsg = ""; |
| [575](#L575) | } ?> |
| [576](#L576) | <?php if ($errMsg != "") { |
| [577](#L577) | echo "<div class='notice notice-error is-dismissible' ><p>"; |
| [578](#L578) | \_e($errMsg); |
| [579](#L579) | echo "</p></div>"; |
| [580](#L580) | $errMsg = ""; |
| [581](#L581) | } ?> |
| [582](#L582) |  |
| [583](#L583) | <h3><?php echo \_\_('Unsubscribers', 'email-subscribe'); ?> </h3> |
| [584](#L584) | <?php |
| [585](#L585) | $order\_by = 'name'; |
| [586](#L586) | $order\_pos = "asc"; |
| [587](#L587) | $setacrionpage = 'admin.php?page=Newssletter-Email-Unsubscriber'; |
| [588](#L588) |  |
| [589](#L589) | if (isset($\_GET['entrant']) and $\_GET['entrant'] != "") { |
| [590](#L590) | $setacrionpage .= '&entrant=' . intval($\_GET['entrant']); |
| [591](#L591) | } |
| [592](#L592) |  |
| [593](#L593) | if (isset($\_GET['setPerPage']) and $\_GET['setPerPage'] != "") { |
| [594](#L594) | $setacrionpage .= '&setPerPage=' . intval($\_GET['setPerPage']); |
| [595](#L595) | } |
| [596](#L596) |  |
| [597](#L597) | $seval = ""; |
| [598](#L598) | if (isset($\_GET['searchuser']) and $\_GET['searchuser'] != "") { |
| [599](#L599) | $seval = esc\_html($\_GET['searchuser']); |
| [600](#L600) | } |
| [601](#L601) |  |
| [602](#L602) | $search\_term\_ = ''; |
| [603](#L603) | if (isset($\_GET['searchuser'])) { |
| [604](#L604) |  |
| [605](#L605) | $search\_term\_ = '&searchuser=' . urlencode(sanitize\_text\_field($\_GET['searchuser'])); |
| [606](#L606) | } |
| [607](#L607) |  |
| [608](#L608) | if (isset($\_GET['order\_by'])) { |
| [609](#L609) |  |
| [610](#L610) | $order\_by = trim($\_GET['order\_by']); |
| [611](#L611) | } |
| [612](#L612) |  |
| [613](#L613) | if (isset($\_GET['order\_pos'])) { |
| [614](#L614) |  |
| [615](#L615) | $order\_pos = trim($\_GET['order\_pos']); |
| [616](#L616) | } |
| [617](#L617) |  |
| [618](#L618) | $order\_by = sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [619](#L619) | $order\_pos = sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [620](#L620) | $setacrionpage = esc\_html($setacrionpage); |
| [621](#L621) | ?> |
| [622](#L622) | <div style="padding-top:5px;padding-bottom:5px"><b><?php echo \_\_('Search User', 'email-subscribe'); ?>: </b><input type="text" value="<?php echo $seval; ?>" id="searchuser" name="searchuser">&nbsp;<input type='submit'  value='Search Unsubscribers' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp;<input type='submit'  value='Reset Search' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" ></div> |
| [623](#L623) | <script type="text/javascript" > |
| [624](#L624) | function SearchredirectTO() { |
| [625](#L625) | var redirectto = '<?php echo $setacrionpage; ?>'; |
| [626](#L626) | var searchval = jQuery('#searchuser').val(); |
| [627](#L627) | redirectto = redirectto + '&searchuser=' + jQuery.trim(encodeURIComponent(searchval)) + '&entrant=1'; |
| [628](#L628) | window.location.href = redirectto; |
| [629](#L629) | } |
| [630](#L630) | function ResetSearch() { |
| [631](#L631) |  |
| [632](#L632) | var redirectto = '<?php echo $setacrionpage; ?>'; |
| [633](#L633) | window.location.href = redirectto; |
| [634](#L634) | } |
| [635](#L635) | </script> |
| [636](#L636) | <form method="post" action="" id="sendemail" name="sendemail"> |
| [637](#L637) | <input type="hidden" value="sendEmailForm" name="action" id="action"> |
| [638](#L638) |  |
| [639](#L639) | <table class="widefat fixed" cellspacing="0" style="width:97% !important" > |
| [640](#L640) | <thead> |
| [641](#L641) | <tr> |
| [642](#L642) | <?php if ($order\_by == "email" and $order\_pos == "asc"): ?> |
| [643](#L643) |  |
| [644](#L644) | <th> |
| [645](#L645) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [646](#L646) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a> |
| [647](#L647) | </th> |
| [648](#L648) | <?php else: ?> |
| [649](#L649) | <?php if ($order\_by == "email"): ?> |
| [650](#L650) | <th> |
| [651](#L651) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [652](#L652) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a> |
| [653](#L653) | </th> |
| [654](#L654) | <?php else: ?> |
| [655](#L655) | <th> |
| [656](#L656) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [657](#L657) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?></a> |
| [658](#L658) | </th> |
| [659](#L659) | <?php endif; ?> |
| [660](#L660) | <?php endif; ?> |
| [661](#L661) |  |
| [662](#L662) | <?php if ($order\_by == "name" and $order\_pos == "asc"): ?> |
| [663](#L663) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [664](#L664) | <?php else: ?> |
| [665](#L665) | <?php if ($order\_by == "name"): ?> |
| [666](#L666) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [667](#L667) | <?php else: ?> |
| [668](#L668) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?></a></th> |
| [669](#L669) | <?php endif; ?> |
| [670](#L670) | <?php endif; ?> |
| [671](#L671) |  |
| [672](#L672) |  |
| [673](#L673) | </tr> |
| [674](#L674) | </thead> |
| [675](#L675) |  |
| [676](#L676) | <tfoot> |
| [677](#L677) | <tr> |
| [678](#L678) | <th scope="col" id="name" class="manage-column column-name" style=""><input onclick="chkAll(this)" type="checkbox" name="chkallfooter" id='chkallfooter'>&nbsp;<?php echo \_\_('Select All Emails', 'email-subscribe'); ?></th> |
| [679](#L679) | <th scope="col" id="name" class="manage-column column-name" style=""><?php echo \_\_('Name', 'email-subscribe'); ?></th> |
| [680](#L680) |  |
| [681](#L681) |  |
| [682](#L682) | </tr> |
| [683](#L683) | </tfoot> |
| [684](#L684) |  |
| [685](#L685) | <tbody id="the-list" class="list:cat"> |
| [686](#L686) | <?php |
| [687](#L687) | $offset = ($current - 1) \* $rows\_per\_page; |
| [688](#L688) | $query .= " order by $order\_by $order\_pos"; |
| [689](#L689) | $query .= " limit $offset, $rows\_per\_page"; |
| [690](#L690) | $emails = $wpdb->get\_results($query, ARRAY\_A); |
| [691](#L691) |  |
| [692](#L692) | foreach ($emails as $vemail) { |
| [693](#L693) |  |
| [694](#L694) | if ($vemail != null) { |
| [695](#L695) |  |
| [696](#L696) | $userId = $vemail['id']; |
| [697](#L697) | $name = sanitize\_text\_field($vemail['name']); |
| [698](#L698) | $email = sanitize\_email($vemail['email']); |
| [699](#L699) |  |
| [700](#L700) | $checked = ""; |
| [701](#L701) |  |
| [702](#L702) | echo"<tr class='iedit alternate'> |
| [703](#L703) | <td  class='name column-name' style='border:1px solid #DBDBDB;padding-left:13px;'><input type='checkBox' name='ckboxs[]' $checked  value='" . esc\_attr($email) . "'>&nbsp;" . esc\_attr($email) . "</td>"; |
| [704](#L704) | echo "<td  class='name column-name' style='border:1px solid #DBDBDB;'> " . stripslashes($name) . "</td>"; |
| [705](#L705) | echo "</tr>"; |
| [706](#L706) | } |
| [707](#L707) | } |
| [708](#L708) | ?> |
| [709](#L709) | </tbody> |
| [710](#L710) | </table> |
| [711](#L711) | <table> |
| [712](#L712) | <tr> |
| [713](#L713) | <td> |
| [714](#L714) | <?php |
| [715](#L715) | if ($totalRecordForQuery > 0) { |
| [716](#L716) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [717](#L717) | echo paginate\_links($pagination\_args); |
| [718](#L718) | echo "</div>"; |
| [719](#L719) | } |
| [720](#L720) | ?> |
| [721](#L721) |  |
| [722](#L722) | </td> |
| [723](#L723) | <td> |
| [724](#L724) | <b>&nbsp;&nbsp;<?php echo \_\_('Per Page', 'email-subscribe'); ?> : </b> |
| [725](#L725) | <?php |
| [726](#L726) | $setPerPageadmin = 'admin.php?page=Newssletter-Email-Unsubscriber'; |
| [727](#L727) | $setPerPageadmin .= '&setPerPage='; |
| [728](#L728) | ?> |
| [729](#L729) | <select name="setPerPage" onchange="document.location.href = '<?php echo $setPerPageadmin; ?>' + this.options[this.selectedIndex].value + ''"> |
| [730](#L730) | <option <?php if ($rows\_per\_page == "10"): ?>selected="selected"<?php endif; ?>  value="10">10</option> |
| [731](#L731) | <option <?php if ($rows\_per\_page == "20"): ?>selected="selected"<?php endif; ?> value="20">20</option> |
| [732](#L732) | <option <?php if ($rows\_per\_page == "30"): ?>selected="selected"<?php endif; ?>value="30">30</option> |
| [733](#L733) | <option <?php if ($rows\_per\_page == "40"): ?>selected="selected"<?php endif; ?> value="40">40</option> |
| [734](#L734) | <option <?php if ($rows\_per\_page == "50"): ?>selected="selected"<?php endif; ?> value="50">50</option> |
| [735](#L735) | <option <?php if ($rows\_per\_page == "60"): ?>selected="selected"<?php endif; ?> value="60">60</option> |
| [736](#L736) | <option <?php if ($rows\_per\_page == "70"): ?>selected="selected"<?php endif; ?> value="70">70</option> |
| [737](#L737) | <option <?php if ($rows\_per\_page == "80"): ?>selected="selected"<?php endif; ?> value="80">80</option> |
| [738](#L738) | <option <?php if ($rows\_per\_page == "90"): ?>selected="selected"<?php endif; ?> value="90">90</option> |
| [739](#L739) | <option <?php if ($rows\_per\_page == "100"): ?>selected="selected"<?php endif; ?> value="100">100</option> |
| [740](#L740) | <option <?php if ($rows\_per\_page == "500"): ?>selected="selected"<?php endif; ?> value="500">500</option> |
| [741](#L741) | <option <?php if ($rows\_per\_page == "1000"): ?>selected="selected"<?php endif; ?> value="1000">1000</option> |
| [742](#L742) | <option <?php if ($rows\_per\_page == "2000"): ?>selected="selected"<?php endif; ?> value="2000">2000</option> |
| [743](#L743) | <option <?php if ($rows\_per\_page == "3000"): ?>selected="selected"<?php endif; ?> value="3000">3000</option> |
| [744](#L744) | <option <?php if ($rows\_per\_page == "4000"): ?>selected="selected"<?php endif; ?> value="4000">4000</option> |
| [745](#L745) | <option <?php if ($rows\_per\_page == "5000"): ?>selected="selected"<?php endif; ?> value="5000">5000</option> |
| [746](#L746) | </select> |
| [747](#L747) | </td> |
| [748](#L748) | </tr> |
| [749](#L749) | </table> |
| [750](#L750) | <table> |
| [751](#L751) | <tr> |
| [752](#L752) | <td class='name column-name' style='padding-top:15px;padding-left:10px;'> |
| [753](#L753) |  |
| [754](#L754) | <script type="text/javascript"> |
| [755](#L755) | function sendEmailToAll(obj) { |
| [756](#L756) |  |
| [757](#L757) | var txt; |
| [758](#L758) | var r = confirm("<?php echo \_\_('It is not recommaded to send email to all at once as there is always hosting server limit for send emails hourly basis. Most of hosting providers allow 250 emails per hour. Please upgrade to pro version and use cron job newsletter to send email automatically. Do you still want to continue ?', 'email-subscribe'); ?>"); |
| [759](#L759) | if (r == true) { |
| [760](#L760) | return true; |
| [761](#L761) | } else { |
| [762](#L762) | return false; |
| [763](#L763) | } |
| [764](#L764) |  |
| [765](#L765) |  |
| [766](#L766) | } |
| [767](#L767) | </script> |
| [768](#L768) | <?php wp\_nonce\_field('action\_resubscribe\_add\_edit', 'resubscribe\_and\_delete\_subsciber'); ?> |
| [769](#L769) | <input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_('Re-subscribe selected subscribers', 'email-subscribe'); ?>' name='resubscribe' class='button-primary' id='resubscribe' >&nbsp;&nbsp;<input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_('Delete Selected Subscribers', 'email-subscribe'); ?>' name='deleteEmails' class='button-primary' id='deleteEmails' ></td> |
| [770](#L770) | </tr> |
| [771](#L771) |  |
| [772](#L772) | </table> |
| [773](#L773) | </form> |
| [774](#L774) |  |
| [775](#L775) |  |
| [776](#L776) | <?php |
| [777](#L777) | } else { |
| [778](#L778) | echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3>' . \_\_('No Email Unsubscribers Found', 'email-subscribe') . '</h3></div></center>'; |
| [779](#L779) | } |
| [780](#L780) | ?> |
| [781](#L781) | </div> |
| [782](#L782) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [783](#L783) |  |
| [784](#L784) | <div class="postbox"> |
| [785](#L785) | <center><h3 class="hndle"><span></span><?php echo \_\_('New AI based DIVI Theme', 'email-subscribe'); ?></h3> </center> |
| [786](#L786) | <div class="inside"> |
| [787](#L787) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url('images/divi\_300x250.jpg', \_\_FILE\_\_); ?>" width="250" height="250"></a></center> |
| [788](#L788) |  |
| [789](#L789) | <div style="margin:10px 5px"> |
| [790](#L790) |  |
| [791](#L791) | </div> |
| [792](#L792) | </div></div> |
| [793](#L793) | <div class="postbox"> |
| [794](#L794) | <center><h3 class="hndle"><span></span><?php echo \_\_('Google For Business', 'email-subscribe'); ?></h3> </center> |
| [795](#L795) | <div class="inside"> |
| [796](#L796) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="" height="250" border="0"></a></center> |
| [797](#L797) | <div style="margin:10px 5px"> |
| [798](#L798) | </div> |
| [799](#L799) | </div></div> |
| [800](#L800) |  |
| [801](#L801) | </div> |
| [802](#L802) | <div class="clear"></div> |
| [803](#L803) |  |
| [804](#L804) | <?php |
| [805](#L805) | break; |
| [806](#L806) | } |
| [807](#L807) | ?> |
| [808](#L808) | <script type="text/javascript" > |
| [809](#L809) |  |
| [810](#L810) | jQuery("input[name='ckboxs[]']").click(function () { |
| [811](#L811) | uncheckedmanagement(this); |
| [812](#L812) |  |
| [813](#L813) | }); |
| [814](#L814) |  |
| [815](#L815) | function uncheckedmanagement(elementset) { |
| [816](#L816) |  |
| [817](#L817) | //alert(jQuery(this).is(':checked')); |
| [818](#L818) |  |
| [819](#L819) | if (jQuery("#uncheckedemails").length > 0) { |
| [820](#L820) |  |
| [821](#L821) | var hiddenvals = jQuery("#uncheckedemails").val(); |
| [822](#L822) |  |
| [823](#L823) | } else |
| [824](#L824) | hiddenvals = "|||"; |
| [825](#L825) |  |
| [826](#L826) | var emailval = jQuery(elementset).val(); |
| [827](#L827) | var emailsUn = hiddenvals.split('|||'); |
| [828](#L828) |  |
| [829](#L829) | if (jQuery(elementset).is(':checked')) { |
| [830](#L830) |  |
| [831](#L831) | if (jQuery.isArray(emailsUn) == true) { |
| [832](#L832) |  |
| [833](#L833) | emailsUn.splice(jQuery.inArray(emailval, emailsUn), 1); |
| [834](#L834) | var strconvert = emailsUn.join('|||'); |
| [835](#L835) | jQuery("#uncheckedemails").val(strconvert); |
| [836](#L836) |  |
| [837](#L837) | } else { |
| [838](#L838) |  |
| [839](#L839) | var addtohidden = emailval.toString() + '|||'; |
| [840](#L840) | jQuery("#uncheckedemails").val(addtohidden); |
| [841](#L841) | } |
| [842](#L842) |  |
| [843](#L843) | } else { |
| [844](#L844) |  |
| [845](#L845) | if (jQuery.isArray(emailsUn) == true) { |
| [846](#L846) |  |
| [847](#L847) | if (jQuery.inArray(emailval, emailsUn) <= 0) { |
| [848](#L848) | emailsUn.push(emailval); |
| [849](#L849) | var strconvert = emailsUn.join('|||'); |
| [850](#L850) | jQuery("#uncheckedemails").val(strconvert); |
| [851](#L851) | } |
| [852](#L852) |  |
| [853](#L853) | } else { |
| [854](#L854) | var addtohidden = emailval.toString() + '|||'; |
| [855](#L855) | jQuery("#uncheckedemails").val(addtohidden); |
| [856](#L856) |  |
| [857](#L857) | } |
| [858](#L858) | } |
| [859](#L859) |  |
| [860](#L860) |  |
| [861](#L861) | } |
| [862](#L862) |  |
| [863](#L863) | function chkAll(id) { |
| [864](#L864) |  |
| [865](#L865) | if (id.name == 'chkallfooter') { |
| [866](#L866) |  |
| [867](#L867) | var chlOrnot = id.checked; |
| [868](#L868) | document.getElementById('chkallHeader').checked = chlOrnot; |
| [869](#L869) |  |
| [870](#L870) | } else if (id.name == 'chkallHeader') { |
| [871](#L871) |  |
| [872](#L872) | var chlOrnot = id.checked; |
| [873](#L873) | document.getElementById('chkallfooter').checked = chlOrnot; |
| [874](#L874) |  |
| [875](#L875) | } |
| [876](#L876) |  |
| [877](#L877) | if (id.checked) { |
| [878](#L878) |  |
| [879](#L879) | var objs = document.getElementsByName("ckboxs[]"); |
| [880](#L880) |  |
| [881](#L881) | for (var i = 0; i < objs.length; i++) |
| [882](#L882) | { |
| [883](#L883) | objs[i].checked = true; |
| [884](#L884) | uncheckedmanagement(objs[i]); |
| [885](#L885) | } |
| [886](#L886) |  |
| [887](#L887) |  |
| [888](#L888) | } else { |
| [889](#L889) |  |
| [890](#L890) | var objs = document.getElementsByName("ckboxs[]"); |
| [891](#L891) |  |
| [892](#L892) | for (var i = 0; i < objs.length; i++) |
| [893](#L893) | { |
| [894](#L894) | objs[i].checked = false; |
| [895](#L895) | uncheckedmanagement(objs[i]); |
| [896](#L896) | } |
| [897](#L897) | } |
| [898](#L898) | } |
| [899](#L899) |  |
| [900](#L900) | function validateSendEmailAndDeleteEmail(idobj) { |
| [901](#L901) |  |
| [902](#L902) | var objs = document.getElementsByName("ckboxs[]"); |
| [903](#L903) | var ischkBoxChecked = false; |
| [904](#L904) | for (var i = 0; i < objs.length; i++) { |
| [905](#L905) | if (objs[i].checked == true) { |
| [906](#L906) |  |
| [907](#L907) | ischkBoxChecked = true; |
| [908](#L908) | break; |
| [909](#L909) | } |
| [910](#L910) |  |
| [911](#L911) | } |
| [912](#L912) |  |
| [913](#L913) | if (ischkBoxChecked == false) |
| [914](#L914) | { |
| [915](#L915) | if (idobj.name == 'resubscribe') { |
| [916](#L916) |  |
| [917](#L917) | alert('<?php echo \_\_('Please select atleast one email.', 'email-subscribe'); ?>'); |
| [918](#L918) | return false; |
| [919](#L919) |  |
| [920](#L920) | } else if (idobj.name == 'deleteEmails') |
| [921](#L921) | { |
| [922](#L922) | alert('<?php echo \_\_('Please select atleast one email to delete.', 'email-subscribe'); ?>') |
| [923](#L923) | return false; |
| [924](#L924) | } |
| [925](#L925) | } else { |
| [926](#L926) |  |
| [927](#L927) | if (idobj.name == 'deleteEmails') { |
| [928](#L928) |  |
| [929](#L929) |  |
| [930](#L930) | var r = confirm("<?php echo \_\_('Are you sure to delete selected subscribers ?', 'email-subscribe'); ?>"); |
| [931](#L931) | if (r == true) { |
| [932](#L932) | return true; |
| [933](#L933) | } else { |
| [934](#L934) |  |
| [935](#L935) | return false; |
| [936](#L936) | } |
| [937](#L937) |  |
| [938](#L938) | } |
| [939](#L939) |  |
| [940](#L940) |  |
| [941](#L941) | } |
| [942](#L942) |  |
| [943](#L943) | } |
| [944](#L944) |  |
| [945](#L945) | </script> |
| [946](#L946) |  |
| [947](#L947) | <?php |
| [948](#L948) | } |
| [949](#L949) |  |
| [950](#L950) | function email\_subscription\_popup\_load\_styles\_and\_js() { |
| [951](#L951) |  |
| [952](#L952) | wp\_register\_style('wp-email-subscription-popup', plugins\_url('/css/wp-email-subscription-popup.css', \_\_FILE\_\_), array(), '1.2.11'); |
| [953](#L953) | wp\_register\_script('wp-email-subscription-popup-js', plugins\_url('/js/wp-email-subscription-popup-js.js', \_\_FILE\_\_), array('jquery'), '1.2.11'); |
| [954](#L954) | wp\_register\_script('subscribe-popup', plugins\_url('/js/subscribe-popup.js', \_\_FILE\_\_), array('jquery'), '1.2.15'); |
| [955](#L955) | wp\_register\_style('subscribe-popup', plugins\_url('/css/subscribe-popup.css', \_\_FILE\_\_), array(), '1.2.11'); |
| [956](#L956) | } |
| [957](#L957) |  |
| [958](#L958) | function addModalPopupHtmlToWpFooter() { |
| [959](#L959) |  |
| [960](#L960) |  |
| [961](#L961) | $imgUrl = plugin\_dir\_url(\_\_FILE\_\_) . "images/"; |
| [962](#L962) |  |
| [963](#L963) | $loader = $imgUrl . 'AjaxLoader.gif'; |
| [964](#L964) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [965](#L965) | $wp\_news\_letter\_settings = stripslashes\_deep($wp\_news\_letter\_settings); |
| [966](#L966) |  |
| [967](#L967) | wp\_enqueue\_script('jquery'); |
| [968](#L968) | wp\_enqueue\_style('wp-email-subscription-popup'); |
| [969](#L969) | wp\_enqueue\_script('wp-email-subscription-popup-js'); |
| [970](#L970) | wp\_enqueue\_script('subscribe-popup'); |
| [971](#L971) | wp\_enqueue\_style('subscribe-popup'); |
| [972](#L972) |  |
| [973](#L973) | ob\_start(); |
| [974](#L974) | ?> |
| [975](#L975) | <div class="overlay\_i13" id="mainoverlayDiv" ></div> |
| [976](#L976) |  |
| [977](#L977) | <div class="mydiv" id='formFormEmail' style="display:none" > |
| [978](#L978) | <div class="container\_n"> |
| [979](#L979) |  |
| [980](#L980) | <form id="newsletter\_signup" name="newsletter\_signup"> |
| [981](#L981) |  |
| [982](#L982) |  |
| [983](#L983) | <div class="header"> |
| [984](#L984) | <div class="AjaxLoader"><img src="<?php echo $loader; ?>"/><?php echo $wp\_news\_letter\_settings['wait']; ?></div> |
| [985](#L985) | <div id="myerror\_msg" class="myerror\_msg"></div> |
| [986](#L986) | <div id="mysuccess\_msg" class="mysuccess\_msg"></div> |
| [987](#L987) |  |
| [988](#L988) | <h3><?php echo $wp\_news\_letter\_settings['heading']; ?></h3> |
| [989](#L989) |  |
| [990](#L990) | <div class="subheading"><?php echo $wp\_news\_letter\_settings['subheading']; ?></div> |
| [991](#L991) |  |
| [992](#L992) | </div> |
| [993](#L993) |  |
| [994](#L994) | <div class="sep"></div> |
| [995](#L995) |  |
| [996](#L996) | <div class="inputs"> |
| [997](#L997) |  |
| [998](#L998) | <input type="email" class="textfield"  onblur="restoreInput(this, '<?php echo $wp\_news\_letter\_settings['email']; ?>')" onfocus="return clearInput(this, '<?php echo $wp\_news\_letter\_settings['email']; ?>');"  value="<?php echo $wp\_news\_letter\_settings['email']; ?>" name="youremail" id="youremail"  /> |
| [999](#L999) | <div style="clear:both"></div> |
| [1000](#L1000) | <div class="errorinput"></div> |
| [1001](#L1001) | <?php if ($wp\_news\_letter\_settings['show\_name\_field']): ?> |
| [1002](#L1002) | <input type="text" class="textfield" id="yourname" onblur="restoreInput(this, '<?php echo $wp\_news\_letter\_settings['name']; ?>')" onfocus="return clearInput(this, '<?php echo $wp\_news\_letter\_settings['name']; ?>');"  value="<?php echo $wp\_news\_letter\_settings['name']; ?>" name="yourname" /> |
| [1003](#L1003) | <div style="clear:both"></div> |
| [1004](#L1004) | <div class="errorinput"></div> |
| [1005](#L1005) | <?php endif; ?> |
| [1006](#L1006) | <?php if ($wp\_news\_letter\_settings['show\_agreement']): ?> |
| [1007](#L1007) | <input type="checkbox"  id="chkagreeornot" value="1" name="chkagreeornot" style="display:inline" /><span class="agree\_term"> <?php echo html\_entity\_decode($wp\_news\_letter\_settings['agreement\_text']); ?></span> |
| [1008](#L1008) | <div style="clear:both"></div> |
| [1009](#L1009) | <div class="errorinput"></div> |
| [1010](#L1010) | <?php endif; ?> |
| [1011](#L1011) | <a id="submit\_newsletter"  onclick="submit\_newsletter();" name="submit\_newsletter"><?php echo $wp\_news\_letter\_settings['submitbtn']; ?></a> |
| [1012](#L1012) |  |
| [1013](#L1013) | </div> |
| [1014](#L1014) |  |
| [1015](#L1015) | </form> |
| [1016](#L1016) |  |
| [1017](#L1017) | </div> |
| [1018](#L1018) | </div> |
| [1019](#L1019) | <script type='text/javascript'> |
| [1020](#L1020) |  |
| [1021](#L1021) | var htmlpopup = ''; |
| [1022](#L1022) |  |
| [1023](#L1023) | function clearInput(source, initialValue) { |
| [1024](#L1024) |  |
| [1025](#L1025) | if (source.value.toUpperCase() == initialValue.toUpperCase()) |
| [1026](#L1026) | source.value = ''; |
| [1027](#L1027) |  |
| [1028](#L1028) | return false; |
| [1029](#L1029) | } |
| [1030](#L1030) |  |
| [1031](#L1031) | function restoreInput(source, initialValue) { |
| [1032](#L1032) | if (source.value == '') |
| [1033](#L1033) | source.value = initialValue; |
| [1034](#L1034) |  |
| [1035](#L1035) | return false; |
| [1036](#L1036) | } |
| [1037](#L1037) |  |
| [1038](#L1038) |  |
| [1039](#L1039) |  |
| [1040](#L1040) |  |
| [1041](#L1041) | function submit\_newsletter() { |
| [1042](#L1042) |  |
| [1043](#L1043) | var emailAdd = jQuery.trim(jQuery("#youremail").val()); |
| [1044](#L1044) | var yourname = jQuery.trim(jQuery("#yourname").val()); |
| [1045](#L1045) |  |
| [1046](#L1046) | var returnval = false; |
| [1047](#L1047) | var isvalidName = false; |
| [1048](#L1048) | var isvalidEmail = false; |
| [1049](#L1049) | var is\_agreed = false; |
| [1050](#L1050) | if (jQuery('#yourname').length > 0) { |
| [1051](#L1051) |  |
| [1052](#L1052) | var yourname = jQuery.trim(jQuery("#yourname").val()); |
| [1053](#L1053) | if (yourname != "" && yourname != null && yourname.toLowerCase() != '<?php echo $wp\_news\_letter\_settings['name']; ?>'.toLowerCase()) { |
| [1054](#L1054) |  |
| [1055](#L1055) | var element = jQuery("#yourname").next().next(); |
| [1056](#L1056) | isvalidName = true; |
| [1057](#L1057) | jQuery(element).html(''); |
| [1058](#L1058) | } else { |
| [1059](#L1059) | var element = jQuery("#yourname").next().next(); |
| [1060](#L1060) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield']; ?></div>'); |
| [1061](#L1061) | // emailAdd=false; |
| [1062](#L1062) |  |
| [1063](#L1063) | } |
| [1064](#L1064) |  |
| [1065](#L1065) | } else { |
| [1066](#L1066) |  |
| [1067](#L1067) | isvalidName = true; |
| [1068](#L1068) |  |
| [1069](#L1069) | } |
| [1070](#L1070) |  |
| [1071](#L1071) | if (emailAdd != "") { |
| [1072](#L1072) |  |
| [1073](#L1073) |  |
| [1074](#L1074) | var element = jQuery("#youremail").next().next(); |
| [1075](#L1075) | if (emailAdd.toLowerCase() == '<?php echo $wp\_news\_letter\_settings['email']; ?>'.toLowerCase()) { |
| [1076](#L1076) |  |
| [1077](#L1077) | jQuery(element).html('<div  class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield']; ?></div>'); |
| [1078](#L1078) | isvalidEmail = false; |
| [1079](#L1079) | } else { |
| [1080](#L1080) |  |
| [1081](#L1081) | var JsRegExPatern = /^\w+([-+.']\w+)\*@\w+([-.]\w+)\*\.\w+([-.]\w+)\*$/ |
| [1082](#L1082) |  |
| [1083](#L1083) | if (JsRegExPatern.test(emailAdd)) { |
| [1084](#L1084) |  |
| [1085](#L1085) | isvalidEmail = true; |
| [1086](#L1086) | jQuery(element).html(''); |
| [1087](#L1087) |  |
| [1088](#L1088) | } else { |
| [1089](#L1089) |  |
| [1090](#L1090) | var element = jQuery("#youremail").next().next(); |
| [1091](#L1091) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['iinvalidemail']; ?></div>'); |
| [1092](#L1092) | isvalidEmail = false; |
| [1093](#L1093) |  |
| [1094](#L1094) | } |
| [1095](#L1095) |  |
| [1096](#L1096) | } |
| [1097](#L1097) |  |
| [1098](#L1098) | } else { |
| [1099](#L1099) |  |
| [1100](#L1100) | var element = jQuery("#yourname").next().next(); |
| [1101](#L1101) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield']; ?></div>'); |
| [1102](#L1102) | isvalidEmail = false; |
| [1103](#L1103) |  |
| [1104](#L1104) | } |
| [1105](#L1105) |  |
| [1106](#L1106) | if (jQuery('#chkagreeornot').length > 0) { |
| [1107](#L1107) |  |
| [1108](#L1108) | if (jQuery("#chkagreeornot").is(':checked')) { |
| [1109](#L1109) |  |
| [1110](#L1110) | var element = jQuery("#chkagreeornot").next().next(); |
| [1111](#L1111) | jQuery(element).html(''); |
| [1112](#L1112) | is\_agreed = true; |
| [1113](#L1113) | } else { |
| [1114](#L1114) |  |
| [1115](#L1115) |  |
| [1116](#L1116) | var element = jQuery("#chkagreeornot").next().next(); |
| [1117](#L1117) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['agreement\_error']; ?></div>'); |
| [1118](#L1118) | is\_agreed = false; |
| [1119](#L1119) |  |
| [1120](#L1120) | } |
| [1121](#L1121) | } else { |
| [1122](#L1122) |  |
| [1123](#L1123) | is\_agreed = true; |
| [1124](#L1124) | } |
| [1125](#L1125) |  |
| [1126](#L1126) |  |
| [1127](#L1127) | if (isvalidName == true && isvalidEmail == true && is\_agreed == true) { |
| [1128](#L1128) |  |
| [1129](#L1129) | jQuery(".AjaxLoader").show(); |
| [1130](#L1130) | jQuery('#mysuccess\_msg').html(''); |
| [1131](#L1131) | jQuery('#mysuccess\_msg').hide(); |
| [1132](#L1132) | jQuery('#myerror\_msg').html(''); |
| [1133](#L1133) | jQuery('#myerror\_msg').hide(); |
| [1134](#L1134) |  |
| [1135](#L1135) | var name = ""; |
| [1136](#L1136) | if (jQuery('#yourname').length > 0) { |
| [1137](#L1137) |  |
| [1138](#L1138) | name = jQuery("#yourname").val(); |
| [1139](#L1139) | } |
| [1140](#L1140) | var nonce = '<?php echo wp\_create\_nonce('newsletter-nonce'); ?>'; |
| [1141](#L1141) | var url = '<?php echo plugin\_dir\_url(\_\_FILE\_\_); ?>'; |
| [1142](#L1142) | var email = jQuery("#youremail").val(); |
| [1143](#L1143) | var str = "action=store\_email&email=" + email + '&name=' + name + '&is\_agreed=' + is\_agreed + '&sec\_string=' + nonce; |
| [1144](#L1144) | jQuery.ajax({ |
| [1145](#L1145) | type: "POST", |
| [1146](#L1146) | url: '<?php echo admin\_url('admin-ajax.php'); ?>', |
| [1147](#L1147) | data: str, |
| [1148](#L1148) | async: true, |
| [1149](#L1149) | success: function (msg) { |
| [1150](#L1150) | if (msg != '') { |
| [1151](#L1151) |  |
| [1152](#L1152) | var result = msg.split("|"); |
| [1153](#L1153) | if (result[0] == 'success') { |
| [1154](#L1154) |  |
| [1155](#L1155) | jQuery(".AjaxLoader").hide(); |
| [1156](#L1156) | jQuery('#mysuccess\_msg').html(result[1]); |
| [1157](#L1157) | jQuery('#mysuccess\_msg').show(); |
| [1158](#L1158) |  |
| [1159](#L1159) | setTimeout(function () { |
| [1160](#L1160) |  |
| [1161](#L1161) | jQuery.fancybox\_ns.close(); |
| [1162](#L1162) |  |
| [1163](#L1163) |  |
| [1164](#L1164) |  |
| [1165](#L1165) | }, 2000); |
| [1166](#L1166) |  |
| [1167](#L1167) | } else { |
| [1168](#L1168) | jQuery(".AjaxLoader").hide(); |
| [1169](#L1169) | jQuery('#myerror\_msg').html(result[1]); |
| [1170](#L1170) | jQuery('#myerror\_msg').show(); |
| [1171](#L1171) | } |
| [1172](#L1172) |  |
| [1173](#L1173) | } |
| [1174](#L1174) |  |
| [1175](#L1175) | } |
| [1176](#L1176) | }); |
| [1177](#L1177) |  |
| [1178](#L1178) | } |
| [1179](#L1179) |  |
| [1180](#L1180) |  |
| [1181](#L1181) |  |
| [1182](#L1182) |  |
| [1183](#L1183) |  |
| [1184](#L1184) | } |
| [1185](#L1185) |  |
| [1186](#L1186) |  |
| [1187](#L1187) | <?php $intval = uniqid('interval\_'); ?> |
| [1188](#L1188) |  |
| [1189](#L1189) | var <?php echo $intval; ?> = setInterval(function () { |
| [1190](#L1190) |  |
| [1191](#L1191) | if (document.readyState === 'complete') { |
| [1192](#L1192) |  |
| [1193](#L1193) | clearInterval(<?php echo $intval; ?>); |
| [1194](#L1194) | /\* if ( jQuery.browser.msie && jQuery.browser.version >= 9 ) |
| [1195](#L1195) | { |
| [1196](#L1196) | jQuery.support.noCloneEvent = true |
| [1197](#L1197) | }\*/ |
| [1198](#L1198) |  |
| [1199](#L1199) | var htmlpopup = jQuery("#formFormEmail").html(); |
| [1200](#L1200) | jQuery("#formFormEmail").remove(); |
| [1201](#L1201) |  |
| [1202](#L1202) | jQuery('body').on('click', '.shownewsletterbox', function () { |
| [1203](#L1203) |  |
| [1204](#L1204) | jQuery.fancybox\_ns({ |
| [1205](#L1205) |  |
| [1206](#L1206) | 'overlayColor': '#000000', |
| [1207](#L1207) | 'hideOnOverlayClick': false, |
| [1208](#L1208) | 'padding': 10, |
| [1209](#L1209) | 'autoScale': true, |
| [1210](#L1210) | 'showCloseButton': true, |
| [1211](#L1211) | 'content': htmlpopup, |
| [1212](#L1212) | 'transitionIn': 'fade', |
| [1213](#L1213) | 'transitionOut': 'elastic', |
| [1214](#L1214) | 'width': 560, |
| [1215](#L1215) | 'height': 360 |
| [1216](#L1216) | }); |
| [1217](#L1217) |  |
| [1218](#L1218) | }); |
| [1219](#L1219) |  |
| [1220](#L1220) | <?php if ($wp\_news\_letter\_settings['newsletter\_show\_on'] == 'any'): ?> |
| [1221](#L1221) |  |
| [1222](#L1222) |  |
| [1223](#L1223) | jQuery(document).ready(function () { |
| [1224](#L1224) |  |
| [1225](#L1225) | if (readCookie('newsLatterPopup') == null) { |
| [1226](#L1226) |  |
| [1227](#L1227) | setTimeout(function () { |
| [1228](#L1228) |  |
| [1229](#L1229) | jQuery.fancybox\_ns({ |
| [1230](#L1230) |  |
| [1231](#L1231) | 'overlayColor': '#000000', |
| [1232](#L1232) | 'hideOnOverlayClick': false, |
| [1233](#L1233) | 'padding': 10, |
| [1234](#L1234) | 'autoScale': true, |
| [1235](#L1235) | 'showCloseButton': true, |
| [1236](#L1236) | 'content': htmlpopup, |
| [1237](#L1237) | 'transitionIn': 'fade', |
| [1238](#L1238) | 'transitionOut': 'elastic', |
| [1239](#L1239) | 'width': 560, |
| [1240](#L1240) | 'height': 360 |
| [1241](#L1241) | }); |
| [1242](#L1242) |  |
| [1243](#L1243) |  |
| [1244](#L1244) | createCookie('newsLatterPopup', 'donotshow', <?php echo $wp\_news\_letter\_settings['newsletter\_cookie']; ?>); |
| [1245](#L1245) |  |
| [1246](#L1246) | }, 1500); |
| [1247](#L1247) |  |
| [1248](#L1248) |  |
| [1249](#L1249) | } |
| [1250](#L1250) | }); |
| [1251](#L1251) | <?php elseif ($wp\_news\_letter\_settings['newsletter\_show\_on'] == 'home'): ?> |
| [1252](#L1252) | <?php if (is\_front\_page()): ?> |
| [1253](#L1253) |  |
| [1254](#L1254) | jQuery(document).ready(function () { |
| [1255](#L1255) |  |
| [1256](#L1256) | if (readCookie('newsLatterPopup') == null) { |
| [1257](#L1257) |  |
| [1258](#L1258) |  |
| [1259](#L1259) | jQuery.fancybox\_ns({ |
| [1260](#L1260) |  |
| [1261](#L1261) | 'overlayColor': '#000000', |
| [1262](#L1262) | 'hideOnOverlayClick': false, |
| [1263](#L1263) | 'padding': 10, |
| [1264](#L1264) | 'autoScale': true, |
| [1265](#L1265) | 'showCloseButton': true, |
| [1266](#L1266) | 'content': htmlpopup, |
| [1267](#L1267) | 'transitionIn': 'fade', |
| [1268](#L1268) | 'transitionOut': 'elastic', |
| [1269](#L1269) | 'width': 560, |
| [1270](#L1270) | 'height': 360 |
| [1271](#L1271) | }); |
| [1272](#L1272) |  |
| [1273](#L1273) |  |
| [1274](#L1274) | createCookie('newsLatterPopup', 'donotshow', <?php echo $wp\_news\_letter\_settings['newsletter\_cookie']; ?>); |
| [1275](#L1275) |  |
| [1276](#L1276) | } |
| [1277](#L1277) | }); |
| [1278](#L1278) |  |
| [1279](#L1279) | <?php endif; ?> |
| [1280](#L1280) | <?php endif; ?> |
| [1281](#L1281) |  |
| [1282](#L1282) |  |
| [1283](#L1283) | } |
| [1284](#L1284) | }, 100); |
| [1285](#L1285) |  |
| [1286](#L1286) |  |
| [1287](#L1287) | </script> |
| [1288](#L1288) |  |
| [1289](#L1289) | <style> |
| [1290](#L1290) | <?php echo html\_entity\_decode($wp\_news\_letter\_settings['additional\_css'], ENT\_QUOTES); ?> |
| [1291](#L1291) | </style> |
| [1292](#L1292) |  |
| [1293](#L1293) | <?php |
| [1294](#L1294) | $output = ob\_get\_clean(); |
| [1295](#L1295) | echo $output; |
| [1296](#L1296) | } |
| [1297](#L1297) |  |
| [1298](#L1298) | function email\_subscription\_popup\_admin\_options() { |
| [1299](#L1299) |  |
| [1300](#L1300) | if (isset($\_POST['btnsave'])) { |
| [1301](#L1301) |  |
| [1302](#L1302) | if (!check\_admin\_referer('action\_settings\_add\_edit', 'add\_edit\_nonce')) { |
| [1303](#L1303) |  |
| [1304](#L1304) | wp\_die('Security check fail'); |
| [1305](#L1305) | } |
| [1306](#L1306) |  |
| [1307](#L1307) | if (!current\_user\_can('es\_email\_subscribe\_settings')) { |
| [1308](#L1308) |  |
| [1309](#L1309) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [1310](#L1310) | } |
| [1311](#L1311) |  |
| [1312](#L1312) | $newsletter\_show\_on = 'none'; |
| [1313](#L1313) | $newsletter\_cookie = 0; |
| [1314](#L1314) | if (isset($\_POST['newsletter\_show\_on'])) { |
| [1315](#L1315) |  |
| [1316](#L1316) | $newsletter\_show\_on = htmlentities(strip\_tags($\_POST['newsletter\_show\_on']), ENT\_QUOTES); |
| [1317](#L1317) | if ($newsletter\_show\_on == 'home') |
| [1318](#L1318) | $newsletter\_cookie = htmlentities(strip\_tags($\_POST['cookieTimeUpUniqueHomePage']), ENT\_QUOTES); |
| [1319](#L1319) | else if ($newsletter\_show\_on == 'any') |
| [1320](#L1320) | $newsletter\_cookie = htmlentities(strip\_tags($\_POST['cookieTimeUpUniqueAnyPage']), ENT\_QUOTES); |
| [1321](#L1321) | } |
| [1322](#L1322) |  |
| [1323](#L1323) | $options = array(); |
| [1324](#L1324) | $options['newsletter\_cookie'] = intval($newsletter\_cookie); |
| [1325](#L1325) | $options['newsletter\_show\_on'] = sanitize\_text\_field($newsletter\_show\_on); |
| [1326](#L1326) | $options['heading'] = trim(htmlentities(sanitize\_text\_field($\_POST['heading']), ENT\_QUOTES)); |
| [1327](#L1327) | $options['subheading'] = trim(htmlentities(sanitize\_textarea\_field($\_POST['subheading']), ENT\_QUOTES)); |
| [1328](#L1328) | $options['email'] = trim(htmlentities(sanitize\_text\_field($\_POST['email']), ENT\_QUOTES)); |
| [1329](#L1329) | $options['name'] = trim(htmlentities(sanitize\_text\_field($\_POST['name']), ENT\_QUOTES)); |
| [1330](#L1330) | $options['submitbtn'] = trim(htmlentities(sanitize\_text\_field($\_POST['submitbtn']), ENT\_QUOTES)); |
| [1331](#L1331) | $options['requiredfield'] = trim(htmlentities(sanitize\_text\_field($\_POST['requiredfield']), ENT\_QUOTES)); |
| [1332](#L1332) | $options['iinvalidemail'] = trim(htmlentities(sanitize\_text\_field($\_POST['iinvalidemail']), ENT\_QUOTES)); |
| [1333](#L1333) | $options['wait'] = trim(htmlentities(sanitize\_text\_field($\_POST['wait']), ENT\_QUOTES)); |
| [1334](#L1334) | $options['invalid\_request'] = trim(htmlentities(sanitize\_text\_field($\_POST['invalid\_request']), ENT\_QUOTES)); |
| [1335](#L1335) | $options['email\_exist'] = trim(htmlentities(sanitize\_text\_field($\_POST['email\_exist']), ENT\_QUOTES)); |
| [1336](#L1336) | $options['success'] = trim(htmlentities(sanitize\_text\_field($\_POST['success']), ENT\_QUOTES)); |
| [1337](#L1337) | $options['unsubscribe\_message'] = trim(htmlentities(sanitize\_text\_field($\_POST['unsubscribe\_message']), ENT\_QUOTES)); |
| [1338](#L1338) | $options['show\_name\_field'] = trim(htmlentities(sanitize\_text\_field($\_POST['show\_name\_field']), ENT\_QUOTES)); |
| [1339](#L1339) | $options['show\_agreement'] = trim(htmlentities(sanitize\_text\_field($\_POST['show\_agreement']), ENT\_QUOTES)); |
| [1340](#L1340) | $options['agreement\_text'] = trim(htmlentities(strip\_tags(stripslashes($\_POST['agreement\_text']), '<a><b><p><strong><em><i>'), ENT\_QUOTES)); |
| [1341](#L1341) | $options['agreement\_error'] = trim(htmlentities(sanitize\_text\_field($\_POST['agreement\_error']), ENT\_QUOTES)); |
| [1342](#L1342) | $options['additional\_css'] = trim(htmlentities(strip\_tags($\_POST['additional\_css']), ENT\_QUOTES)); |
| [1343](#L1343) |  |
| [1344](#L1344) | $settings = update\_option('wp\_news\_letter\_settings', $options); |
| [1345](#L1345) | $email\_subscription\_popup\_messages = array(); |
| [1346](#L1346) | $email\_subscription\_popup\_messages['type'] = 'succ'; |
| [1347](#L1347) | $email\_subscription\_popup\_messages['message'] = 'Settings saved successfully.'; |
| [1348](#L1348) | update\_option('email\_subscription\_popup\_messages', $email\_subscription\_popup\_messages); |
| [1349](#L1349) | } |
| [1350](#L1350) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [1351](#L1351) |  |
| [1352](#L1352) | if (!isset($wp\_news\_letter\_settings['unsubscribe\_message'])) { |
| [1353](#L1353) |  |
| [1354](#L1354) | $wp\_news\_letter\_settings['unsubscribe\_message'] = 'You have successfully unsubscribed from email newsletter.Thank you...'; |
| [1355](#L1355) | } |
| [1356](#L1356) |  |
| [1357](#L1357) | if (!isset($wp\_news\_letter\_settings['subscribe\_message'])) { |
| [1358](#L1358) |  |
| [1359](#L1359) | $wp\_news\_letter\_settings['subscribe\_message'] = 'You have successfully subscribed for email newsletter.Thank you...'; |
| [1360](#L1360) | } |
| [1361](#L1361) |  |
| [1362](#L1362) | if (!isset($wp\_news\_letter\_settings['show\_name\_field'])) { |
| [1363](#L1363) |  |
| [1364](#L1364) | $wp\_news\_letter\_settings['show\_name\_field'] = '1'; |
| [1365](#L1365) | } |
| [1366](#L1366) |  |
| [1367](#L1367) | if (!isset($wp\_news\_letter\_settings['show\_agreement'])) { |
| [1368](#L1368) |  |
| [1369](#L1369) | $wp\_news\_letter\_settings['show\_agreement'] = '0'; |
| [1370](#L1370) | } |
| [1371](#L1371) |  |
| [1372](#L1372) |  |
| [1373](#L1373) | if (!isset($wp\_news\_letter\_settings['agreement\_text'])) { |
| [1374](#L1374) |  |
| [1375](#L1375) |  |
| [1376](#L1376) | $wp\_news\_letter\_settings['agreement\_text'] = 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>'; |
| [1377](#L1377) | } |
| [1378](#L1378) |  |
| [1379](#L1379) | if (!isset($wp\_news\_letter\_settings['agreement\_error'])) { |
| [1380](#L1380) |  |
| [1381](#L1381) | $wp\_news\_letter\_settings['agreement\_error'] = 'Please read and agree to our terms & conditions.'; |
| [1382](#L1382) | } |
| [1383](#L1383) |  |
| [1384](#L1384) |  |
| [1385](#L1385) | if (!isset($wp\_news\_letter\_settings['additional\_css'])) { |
| [1386](#L1386) |  |
| [1387](#L1387) | $wp\_news\_letter\_settings['additional\_css'] = ''; |
| [1388](#L1388) | } |
| [1389](#L1389) |  |
| [1390](#L1390) | $wp\_news\_letter\_settings = stripslashes\_deep($wp\_news\_letter\_settings); |
| [1391](#L1391) |  |
| [1392](#L1392) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [1393](#L1393) | ?> |
| [1394](#L1394) | <style type=""> |
| [1395](#L1395) | .fieldsetAdmin { |
| [1396](#L1396) | margin: 10px 0px; |
| [1397](#L1397) | padding: 10px; |
| [1398](#L1398) | border: 1px solid rgb(221, 221, 221); |
| [1399](#L1399) | font-size: 15px; |
| [1400](#L1400) | } |
| [1401](#L1401) | .fieldsetAdmin legend { |
| [1402](#L1402) | font-weight: bold; |
| [1403](#L1403) | color: #222222; |
| [1404](#L1404) |  |
| [1405](#L1405) | } |
| [1406](#L1406) | </style> |
| [1407](#L1407) | <div style="width: 100%;"> |
| [1408](#L1408) | <div style="float:left;width:65%;"> |
| [1409](#L1409) | <div class="wrap"> |
| [1410](#L1410) |  |
| [1411](#L1411) | <?php |
| [1412](#L1412) | $messages = get\_option('email\_subscription\_popup\_messages'); |
| [1413](#L1413) | $type = ''; |
| [1414](#L1414) | $message = ''; |
| [1415](#L1415) | if (isset($messages['type']) and $messages['type'] != "") { |
| [1416](#L1416) |  |
| [1417](#L1417) | $type = $messages['type']; |
| [1418](#L1418) | $message = $messages['message']; |
| [1419](#L1419) | } |
| [1420](#L1420) |  |
| [1421](#L1421) |  |
| [1422](#L1422) | if ($type == 'err') { |
| [1423](#L1423) | echo "<div class='notice notice-error is-dismissible'><p>"; |
| [1424](#L1424) | echo $message; |
| [1425](#L1425) | echo "</p></div>"; |
| [1426](#L1426) | } else if ($type == 'succ') { |
| [1427](#L1427) | echo "<div class='notice notice-success is-dismissible'><p>"; |
| [1428](#L1428) | echo $message; |
| [1429](#L1429) | echo "</p></div>"; |
| [1430](#L1430) | } |
| [1431](#L1431) |  |
| [1432](#L1432) |  |
| [1433](#L1433) | update\_option('email\_subscription\_popup\_messages', array()); |
| [1434](#L1434) | ?> |
| [1435](#L1435) | <table><tr><td> |
| [1436](#L1436) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [1437](#L1437) | <div id="fb-root"></div> |
| [1438](#L1438) | <script>(function (d, s, id) { |
| [1439](#L1439) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [1440](#L1440) | if (d.getElementById(id)) |
| [1441](#L1441) | return; |
| [1442](#L1442) | js = d.createElement(s); js.id = id; |
| [1443](#L1443) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [1444](#L1444) | fjs.parentNode.insertBefore(js, fjs); |
| [1445](#L1445) | }(document, 'script', 'facebook-jssdk'));</script> |
| [1446](#L1446) | </td> |
| [1447](#L1447) | <td> |
| [1448](#L1448) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [1449](#L1449) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [1450](#L1450) | </a> |
| [1451](#L1451) | </td> |
| [1452](#L1452) | </tr> |
| [1453](#L1453) | </table> |
| [1454](#L1454) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [1455](#L1455) |  |
| [1456](#L1456) | <h2><?php echo \_\_('Settings', 'email-subscribe'); ?></h2> |
| [1457](#L1457) | <br> |
| [1458](#L1458) | <div id="poststuff"> |
| [1459](#L1459) | <div id="post-body" class="metabox-holder columns-2"> |
| [1460](#L1460) | <div id="post-body-content"> |
| [1461](#L1461) | <form method="post" action="" id="subscriptionFrmsettiings" name="subscriptionFrmsettiings" > |
| [1462](#L1462) | <fieldset class="fieldsetAdmin"> |
| [1463](#L1463) | <legend><?php echo \_\_('Email Lightbox Popup Settings', 'email-subscribe'); ?></legend> |
| [1464](#L1464) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1465](#L1465) | <h3><label><?php echo \_\_('Show Modal Popup On', 'email-subscribe'); ?></label></h3> |
| [1466](#L1466) | <div class="inside"> |
| [1467](#L1467) | <table> |
| [1468](#L1468) | <tr> |
| [1469](#L1469) | <td> |
| [1470](#L1470) | <table> |
| [1471](#L1471) | <tr> |
| [1472](#L1472) | <td style="vertical-align: top"> |
| [1473](#L1473) | <input type="radio" name="newsletter\_show\_on" id="unique\_home\_page" value="home" style="width:10px"> |
| [1474](#L1474) | </td> |
| [1475](#L1475) | <td> |
| [1476](#L1476) | <b><?php echo \_\_('Show newsletter modal popup on unique request only on home page', 'email-subscribe'); ?></b> |
| [1477](#L1477) | <br/> |
| [1478](#L1478) | <div id="cookTimeHomepageRequest" style="display:none"> |
| [1479](#L1479) | <?php echo \_\_('Cookie Time :', 'email-subscribe'); ?> |
| [1480](#L1480) | <input style="width:50px" type="text" size="5" name="cookieTimeUpUniqueHomePage" value="<?php echo $wp\_news\_letter\_settings['newsletter\_cookie']; ?>"  id="cookieTimeUpUniqueHomePage"/> <?php echo \_\_('In Days', 'email-subscribe'); ?> |
| [1481](#L1481) | <div style="clear:both"></div> |
| [1482](#L1482) | <div></div> |
| [1483](#L1483) | </div> |
| [1484](#L1484) | <script> |
| [1485](#L1485) |  |
| [1486](#L1486) | jQuery("#unique\_home\_page").click(function () { |
| [1487](#L1487) |  |
| [1488](#L1488) | jQuery("#cookTimeAnypageRequest").hide(); |
| [1489](#L1489) | jQuery("#cookTimeHomepageRequest").show(); |
| [1490](#L1490) | }); |
| [1491](#L1491) | </script> |
| [1492](#L1492) | </td> |
| [1493](#L1493) | </tr> |
| [1494](#L1494) |  |
| [1495](#L1495) | <tr> |
| [1496](#L1496) | <td style="vertical-align: top"> |
| [1497](#L1497) | <input type="radio" name="newsletter\_show\_on" id="unique\_any" value="any" style="width:10px"> |
| [1498](#L1498) | </td> |
| [1499](#L1499) | <td> |
| [1500](#L1500) | <b><?php echo \_\_('Show newsletter modal popup on unique request for any page', 'email-subscribe'); ?></b> |
| [1501](#L1501) | <br/> |
| [1502](#L1502) | <div id="cookTimeAnypageRequest" style="display:none"> |
| [1503](#L1503) | <?php echo \_\_('Cookie Time :', 'email-subscribe'); ?> |
| [1504](#L1504) | <input style="width:50px" type="text" size="5" name="cookieTimeUpUniqueAnyPage" value="<?php echo $wp\_news\_letter\_settings['newsletter\_cookie']; ?>" id="cookieTimeUpUniqueAnyPage"/> <?php echo \_\_('In Days', 'email-subscribe'); ?> |
| [1505](#L1505) | <div style="clear:both"></div> |
| [1506](#L1506) | <div></div> |
| [1507](#L1507) | </div> |
| [1508](#L1508) | <script> |
| [1509](#L1509) |  |
| [1510](#L1510) | jQuery("#unique\_any").click(function () { |
| [1511](#L1511) | jQuery("#cookTimeHomepageRequest").hide(); |
| [1512](#L1512) | jQuery("#cookTimeAnypageRequest").show(); |
| [1513](#L1513) |  |
| [1514](#L1514) | }); |
| [1515](#L1515) | </script> |
| [1516](#L1516) |  |
| [1517](#L1517) | </td> |
| [1518](#L1518) | </tr> |
| [1519](#L1519) | <tr> |
| [1520](#L1520) | <td style="vertical-align: top"> |
| [1521](#L1521) | <input  type="radio" name="newsletter\_show\_on" value="none" id="show\_none" style="width:10px"> |
| [1522](#L1522) |  |
| [1523](#L1523) | </td> |
| [1524](#L1524) | <td> |
| [1525](#L1525) | <b><?php echo \_\_('No, I will use my custom link', 'email-subscribe'); ?></b> |
| [1526](#L1526) | <script> |
| [1527](#L1527) |  |
| [1528](#L1528) | jQuery("#show\_none").click(function () { |
| [1529](#L1529) | jQuery("#cookTimeHomepageRequest").hide(); |
| [1530](#L1530) | jQuery("#cookTimeAnypageRequest").hide(); |
| [1531](#L1531) |  |
| [1532](#L1532) | }); |
| [1533](#L1533) | </script> |
| [1534](#L1534) | </td> |
| [1535](#L1535) | </tr> |
| [1536](#L1536) | <tr> |
| [1537](#L1537) | <td> |
| [1538](#L1538) |  |
| [1539](#L1539) |  |
| [1540](#L1540) | </td> |
| [1541](#L1541) | <td> |
| [1542](#L1542) | <br/> |
| [1543](#L1543) | <b><?php echo \_\_('To show Newsletter modal Popup On Custom Link Click Use', 'email-subscribe'); ?> <i>shownewsletterbox</i> css class</b> |
| [1544](#L1544) | <br/> |
| [1545](#L1545) | <br/> |
| [1546](#L1546) | <b><?php echo \_\_('Example :', 'email-subscribe'); ?> </b> |
| [1547](#L1547) | <pre><?php echo htmlspecialchars('<a href="#" class="shownewsletterbox">Subscribe to Newsletter</a>'); ?></pre> |
| [1548](#L1548) | </td> |
| [1549](#L1549) |  |
| [1550](#L1550) | </tr> |
| [1551](#L1551) |  |
| [1552](#L1552) | </table> |
| [1553](#L1553) | <hr/> |
| [1554](#L1554) | <table> |
| [1555](#L1555) | <tr> |
| [1556](#L1556) | <td class="label" style="width:35%"> |
| [1557](#L1557) | <h3 style="font-size: 13px"><label for="show\_name\_field"><?php echo \_\_('Show Name Field In Newsletter Popup ?', 'email-subscribe'); ?> <span class="required">\*</span></label></h3> |
| [1558](#L1558) | </td> |
| [1559](#L1559) | <td class="value" style="width:65%"> |
| [1560](#L1560) | <select id="show\_name\_field" name="show\_name\_field" class="select"> |
| [1561](#L1561) | <option value=""><?php echo \_\_('Select', 'email-subscribe'); ?></option> |
| [1562](#L1562) | <option <?php if ($wp\_news\_letter\_settings['show\_name\_field'] == '1'): ?> selected="selected" <?php endif; ?>  value="1" ><?php echo \_\_('Yes', 'email-subscribe'); ?></option> |
| [1563](#L1563) | <option <?php if ($wp\_news\_letter\_settings['show\_name\_field'] == '0'): ?> selected="selected" <?php endif; ?>  value="0"><?php echo \_\_('No', 'email-subscribe'); ?></option> |
| [1564](#L1564) | </select> |
| [1565](#L1565) | <div style="clear:both"></div> |
| [1566](#L1566) | <div class="error\_label"></div> |
| [1567](#L1567) | </td> |
| [1568](#L1568) | </tr> |
| [1569](#L1569) | <tr> |
| [1570](#L1570) | <td class="label" style="width:35%"> |
| [1571](#L1571) | <h3 style="font-size: 13px"><label for="show\_agreement"><?php echo \_\_('Show Checkbox For Terms and Conditions Agreement', 'email-subscribe'); ?> <span class="required">\*</span></label></h3> |
| [1572](#L1572) | </td> |
| [1573](#L1573) | <td class="value" style="width:65%"> |
| [1574](#L1574) | <select id="show\_agreement" name="show\_agreement" class="select"> |
| [1575](#L1575) | <option value=""><?php echo \_\_('Select', 'email-subscribe'); ?></option> |
| [1576](#L1576) | <option <?php if ($wp\_news\_letter\_settings['show\_agreement'] == '1'): ?> selected="selected" <?php endif; ?>  value="1" ><?php echo \_\_('Yes', 'email-subscribe'); ?></option> |
| [1577](#L1577) | <option <?php if ($wp\_news\_letter\_settings['show\_agreement'] == '0'): ?> selected="selected" <?php endif; ?>  value="0"><?php echo \_\_('No', 'email-subscribe'); ?></option> |
| [1578](#L1578) | </select> |
| [1579](#L1579) | <div style="clear:both"></div> |
| [1580](#L1580) | <div class="error\_label"></div> |
| [1581](#L1581) | </td> |
| [1582](#L1582) | </tr> |
| [1583](#L1583) | <tr> |
| [1584](#L1584) | <td class="label" style="width:35%"> |
| [1585](#L1585) | <h3 style="font-size: 13px"><label for="agreement\_text"><?php echo \_\_('Agreement Text', 'email-subscribe'); ?> <span class="required">\*</span></label></h3> |
| [1586](#L1586) | </td> |
| [1587](#L1587) | <td class="value" style="width:65%"> |
| [1588](#L1588) | <textarea name="agreement\_text" id="agreement\_text" style="width: 100%;height: 74px;"><?php echo html\_entity\_decode($wp\_news\_letter\_settings['agreement\_text']); ?></textarea> |
| [1589](#L1589) | <div style="clear:both;font-size: 12px;color:black"><?php echo \_\_('Replace # with your Terms of Service and Privacy Policy full Url.', 'email-subscribe'); ?></div> |
| [1590](#L1590) | <div class="error\_label"></div> |
| [1591](#L1591) | </td> |
| [1592](#L1592) | </tr> |
| [1593](#L1593) | </table> |
| [1594](#L1594) | <div style="clear:both"></div> |
| [1595](#L1595) | <div></div> |
| [1596](#L1596) |  |
| [1597](#L1597) | </td> |
| [1598](#L1598) | </tr> |
| [1599](#L1599) | </table> |
| [1600](#L1600) | <div style="clear:both"></div> |
| [1601](#L1601) | <script> |
| [1602](#L1602) | <?php if ($wp\_news\_letter\_settings['newsletter\_show\_on'] == 'any'): ?> |
| [1603](#L1603) | jQuery('#unique\_any').trigger('click'); |
| [1604](#L1604) | <?php elseif ($wp\_news\_letter\_settings['newsletter\_show\_on'] == 'home'): ?> |
| [1605](#L1605) | jQuery('#unique\_home\_page').trigger('click'); |
| [1606](#L1606) | <?php else: ?> |
| [1607](#L1607) | jQuery("#show\_none").trigger('click'); |
| [1608](#L1608) | <?php endif; ?> |
| [1609](#L1609) | </script> |
| [1610](#L1610) | </div> |
| [1611](#L1611) | </div> |
| [1612](#L1612) |  |
| [1613](#L1613) | </fieldset> |
| [1614](#L1614) | <fieldset class="fieldsetAdmin"> |
| [1615](#L1615) | <legend><?php echo \_\_('Subscription Form Settings Messages & Label Settings', 'email-subscribe'); ?></legend> |
| [1616](#L1616) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1617](#L1617) | <h3><label><?php echo \_\_('Heading', 'email-subscribe'); ?></label></h3> |
| [1618](#L1618) | <div class="inside"> |
| [1619](#L1619) | <table> |
| [1620](#L1620) | <tr> |
| [1621](#L1621) | <td> |
| [1622](#L1622) | <input type="text" id="heading" size="50" name="heading" value="<?php echo $wp\_news\_letter\_settings['heading']; ?>" style="width:550px;"> |
| [1623](#L1623) | <div style="clear:both"></div> |
| [1624](#L1624) | <div></div> |
| [1625](#L1625) | </td> |
| [1626](#L1626) | </tr> |
| [1627](#L1627) | </table> |
| [1628](#L1628) | <div style="clear:both"></div> |
| [1629](#L1629) | </div> |
| [1630](#L1630) | </div> |
| [1631](#L1631) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1632](#L1632) | <h3><label><?php echo \_\_('Subheading', 'email-subscribe'); ?></label></h3> |
| [1633](#L1633) | <div class="inside"> |
| [1634](#L1634) | <table> |
| [1635](#L1635) | <tr> |
| [1636](#L1636) | <td> |
| [1637](#L1637) | <textarea id="subheading" style="width:550px;height:60px" size="50" name="subheading" ><?php echo $wp\_news\_letter\_settings['subheading']; ?></textarea> |
| [1638](#L1638) | <div style="clear:both"></div> |
| [1639](#L1639) | <div></div> |
| [1640](#L1640) | </td> |
| [1641](#L1641) | </tr> |
| [1642](#L1642) | </table> |
| [1643](#L1643) | <div style="clear:both"></div> |
| [1644](#L1644) | </div> |
| [1645](#L1645) | </div> |
| [1646](#L1646) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1647](#L1647) | <h3><label><?php echo \_\_('Email Label', 'email-subscribe'); ?></label></h3> |
| [1648](#L1648) | <div class="inside"> |
| [1649](#L1649) | <table> |
| [1650](#L1650) | <tr> |
| [1651](#L1651) | <td> |
| [1652](#L1652) | <input type="text" id="email" size="50" name="email" value="<?php echo $wp\_news\_letter\_settings['email']; ?>" style="width:550px;"> |
| [1653](#L1653) | <div style="clear:both"></div> |
| [1654](#L1654) | <div></div> |
| [1655](#L1655) | </td> |
| [1656](#L1656) | </tr> |
| [1657](#L1657) | </table> |
| [1658](#L1658) | <div style="clear:both"></div> |
| [1659](#L1659) | </div> |
| [1660](#L1660) | </div> |
| [1661](#L1661) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1662](#L1662) | <h3><label><?php echo \_\_('Name Label', 'email-subscribe'); ?></label></h3> |
| [1663](#L1663) | <div class="inside"> |
| [1664](#L1664) | <table> |
| [1665](#L1665) | <tr> |
| [1666](#L1666) | <td> |
| [1667](#L1667) | <input type="text" id="name" size="50" name="name" value="<?php echo $wp\_news\_letter\_settings['name']; ?>" style="width:550px;"> |
| [1668](#L1668) | <div style="clear:both"></div> |
| [1669](#L1669) | <div></div> |
| [1670](#L1670) | </td> |
| [1671](#L1671) | </tr> |
| [1672](#L1672) | </table> |
| [1673](#L1673) | <div style="clear:both"></div> |
| [1674](#L1674) | </div> |
| [1675](#L1675) | </div> |
| [1676](#L1676) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1677](#L1677) | <h3><label><?php echo \_\_('Submit Button Label', 'email-subscribe'); ?></label></h3> |
| [1678](#L1678) | <div class="inside"> |
| [1679](#L1679) | <table> |
| [1680](#L1680) | <tr> |
| [1681](#L1681) | <td> |
| [1682](#L1682) | <input type="text" id="submitbtn" size="50" name="submitbtn" value="<?php echo $wp\_news\_letter\_settings['submitbtn']; ?>" style="width:550px;"> |
| [1683](#L1683) | <div style="clear:both"></div> |
| [1684](#L1684) | <div></div> |
| [1685](#L1685) | </td> |
| [1686](#L1686) | </tr> |
| [1687](#L1687) | </table> |
| [1688](#L1688) | <div style="clear:both"></div> |
| [1689](#L1689) | </div> |
| [1690](#L1690) | </div> |
| [1691](#L1691) | </fieldset> |
| [1692](#L1692) | <fieldset class="fieldsetAdmin"> |
| [1693](#L1693) | <legend><?php echo \_\_('Errors & validation Messages Settings', 'email-subscribe'); ?></legend> |
| [1694](#L1694) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1695](#L1695) | <h3><label><?php echo \_\_('Required Field Message', 'email-subscribe'); ?></label></h3> |
| [1696](#L1696) | <div class="inside"> |
| [1697](#L1697) | <table> |
| [1698](#L1698) | <tr> |
| [1699](#L1699) | <td> |
| [1700](#L1700) | <input type="text" id="requiredfield" size="50" name="requiredfield" value="<?php echo $wp\_news\_letter\_settings['requiredfield']; ?>" style="width:550px;"> |
| [1701](#L1701) | <div style="clear:both"></div> |
| [1702](#L1702) | <div></div> |
| [1703](#L1703) | </td> |
| [1704](#L1704) | </tr> |
| [1705](#L1705) | </table> |
| [1706](#L1706) | <div style="clear:both"></div> |
| [1707](#L1707) | </div> |
| [1708](#L1708) | </div> |
| [1709](#L1709) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1710](#L1710) | <h3><label><?php echo \_\_('Invalid Email Message', 'email-subscribe'); ?></label></h3> |
| [1711](#L1711) | <div class="inside"> |
| [1712](#L1712) | <table> |
| [1713](#L1713) | <tr> |
| [1714](#L1714) | <td> |
| [1715](#L1715) | <input type="text" id="iinvalidemail" size="50" name="iinvalidemail" value="<?php echo $wp\_news\_letter\_settings['iinvalidemail']; ?>" style="width:550px;"> |
| [1716](#L1716) | <div style="clear:both"></div> |
| [1717](#L1717) | <div></div> |
| [1718](#L1718) | </td> |
| [1719](#L1719) | </tr> |
| [1720](#L1720) | </table> |
| [1721](#L1721) | <div style="clear:both"></div> |
| [1722](#L1722) | </div> |
| [1723](#L1723) | </div> |
| [1724](#L1724) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1725](#L1725) | <h3><label><?php echo \_\_('Invalid Request Message', 'email-subscribe'); ?></label></h3> |
| [1726](#L1726) | <div class="inside"> |
| [1727](#L1727) | <table> |
| [1728](#L1728) | <tr> |
| [1729](#L1729) | <td> |
| [1730](#L1730) | <input type="text" id="invalid\_request" size="50" name="invalid\_request" value="<?php echo $wp\_news\_letter\_settings['invalid\_request']; ?>" style="width:550px;"> |
| [1731](#L1731) | <div style="clear:both"></div> |
| [1732](#L1732) | <div></div> |
| [1733](#L1733) | </td> |
| [1734](#L1734) | </tr> |
| [1735](#L1735) | </table> |
| [1736](#L1736) | <div style="clear:both"></div> |
| [1737](#L1737) | </div> |
| [1738](#L1738) | </div> |
| [1739](#L1739) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1740](#L1740) | <h3><label><?php echo \_\_('Email Exist Message', 'email-subscribe'); ?></label></h3> |
| [1741](#L1741) | <div class="inside"> |
| [1742](#L1742) | <table> |
| [1743](#L1743) | <tr> |
| [1744](#L1744) | <td> |
| [1745](#L1745) | <input type="text" id="email\_exist" size="50" name="email\_exist" value="<?php echo $wp\_news\_letter\_settings['email\_exist']; ?>" style="width:550px;"> |
| [1746](#L1746) | <div style="clear:both"></div> |
| [1747](#L1747) | <div></div> |
| [1748](#L1748) | </td> |
| [1749](#L1749) | </tr> |
| [1750](#L1750) | </table> |
| [1751](#L1751) | <div style="clear:both"></div> |
| [1752](#L1752) | </div> |
| [1753](#L1753) | </div> |
| [1754](#L1754) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1755](#L1755) | <h3><label><?php echo \_\_('Agreement Error', 'email-subscribe'); ?></label></h3> |
| [1756](#L1756) | <div class="inside"> |
| [1757](#L1757) | <table> |
| [1758](#L1758) | <tr> |
| [1759](#L1759) | <td> |
| [1760](#L1760) | <input type="text" id="agreement\_error" size="50" name="agreement\_error" value="<?php echo $wp\_news\_letter\_settings['agreement\_error']; ?>" style="width:550px;"> |
| [1761](#L1761) | <div style="clear:both"></div> |
| [1762](#L1762) | <div></div> |
| [1763](#L1763) | </td> |
| [1764](#L1764) | </tr> |
| [1765](#L1765) | </table> |
| [1766](#L1766) | <div style="clear:both"></div> |
| [1767](#L1767) | </div> |
| [1768](#L1768) | </div> |
| [1769](#L1769) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1770](#L1770) | <h3><label><?php echo \_\_('Success Message', 'email-subscribe'); ?></label></h3> |
| [1771](#L1771) | <div class="inside"> |
| [1772](#L1772) | <table> |
| [1773](#L1773) | <tr> |
| [1774](#L1774) | <td> |
| [1775](#L1775) | <input type="text" id="success" size="50" name="success" value="<?php echo $wp\_news\_letter\_settings['success']; ?>" style="width:550px;"> |
| [1776](#L1776) | <div style="clear:both"></div> |
| [1777](#L1777) | <div></div> |
| [1778](#L1778) | </td> |
| [1779](#L1779) | </tr> |
| [1780](#L1780) | </table> |
| [1781](#L1781) | <div style="clear:both"></div> |
| [1782](#L1782) | </div> |
| [1783](#L1783) | </div> |
| [1784](#L1784) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1785](#L1785) | <h3><label><?php echo \_\_('Unsubscribe Message', 'email-subscribe'); ?></label></h3> |
| [1786](#L1786) | <div class="inside"> |
| [1787](#L1787) | <table> |
| [1788](#L1788) | <tr> |
| [1789](#L1789) | <td> |
| [1790](#L1790) | <input type="text" id="unsubscribe\_message" size="50" name="unsubscribe\_message" value="<?php echo $wp\_news\_letter\_settings['unsubscribe\_message']; ?>" style="width:550px;"> |
| [1791](#L1791) | <div style="clear:both"></div> |
| [1792](#L1792) | <div></div> |
| [1793](#L1793) | </td> |
| [1794](#L1794) | </tr> |
| [1795](#L1795) | </table> |
| [1796](#L1796) | <div style="clear:both"></div> |
| [1797](#L1797) | </div> |
| [1798](#L1798) | </div> |
| [1799](#L1799) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1800](#L1800) | <h3><label><?php echo \_\_('Wait Message', 'email-subscribe'); ?></label></h3> |
| [1801](#L1801) | <div class="inside"> |
| [1802](#L1802) | <table> |
| [1803](#L1803) | <tr> |
| [1804](#L1804) | <td> |
| [1805](#L1805) | <input type="text" id="wait" size="50" name="wait" value="<?php echo $wp\_news\_letter\_settings['wait']; ?>" style="width:550px;"> |
| [1806](#L1806) | <div style="clear:both"></div> |
| [1807](#L1807) | <div></div> |
| [1808](#L1808) | </td> |
| [1809](#L1809) | </tr> |
| [1810](#L1810) | </table> |
| [1811](#L1811) | <div style="clear:both"></div> |
| [1812](#L1812) | </div> |
| [1813](#L1813) | </div> |
| [1814](#L1814) | </fieldset> |
| [1815](#L1815) | <fieldset class="fieldsetAdmin"> |
| [1816](#L1816) | <legend><?php echo \_\_('Additional CSS', 'email-subscribe'); ?></legend> |
| [1817](#L1817) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1818](#L1818) | <h3><label><?php echo \_\_('Add CSS', 'email-subscribe'); ?></label></h3> |
| [1819](#L1819) | <div class="inside"> |
| [1820](#L1820) | <table> |
| [1821](#L1821) | <tr> |
| [1822](#L1822) | <td> |
| [1823](#L1823) | <textarea style="width:550px;height:200px" id="additional\_css" size="50" name="additional\_css" ><?php echo $wp\_news\_letter\_settings['additional\_css']; ?></textarea> |
| [1824](#L1824) | <div style="clear:both;font-size: 12px;color:black"><?php echo \_\_("Don't, use style tag. Just add css", 'email-subscribe'); ?></div> |
| [1825](#L1825) | <div></div> |
| [1826](#L1826) | </td> |
| [1827](#L1827) | </tr> |
| [1828](#L1828) | </table> |
| [1829](#L1829) | <div style="clear:both"></div> |
| [1830](#L1830) | </div> |
| [1831](#L1831) | </div> |
| [1832](#L1832) | </fieldset> |
| [1833](#L1833) | <?php wp\_nonce\_field('action\_settings\_add\_edit', 'add\_edit\_nonce'); ?> |
| [1834](#L1834) | <input type="submit"   name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes', 'email-subscribe'); ?>" class="button-primary"> |
| [1835](#L1835) |  |
| [1836](#L1836) | </form> |
| [1837](#L1837) | <script type="text/javascript"> |
| [1838](#L1838) |  |
| [1839](#L1839) |  |
| [1840](#L1840) | jQuery(document).ready(function () { |
| [1841](#L1841) |  |
| [1842](#L1842) | jQuery.validator.addMethod("checkHomeCookie", function (value, element) { |
| [1843](#L1843) |  |
| [1844](#L1844) |  |
| [1845](#L1845) | if (jQuery('input[name="newsletter\_show\_on"]:checked').val() == 'home' && jQuery.trim(jQuery("#cookieTimeUpUniqueHomePage").val()) == '') { |
| [1846](#L1846) | return false; |
| [1847](#L1847) | } else { |
| [1848](#L1848) | return true; |
| [1849](#L1849) | } |
| [1850](#L1850) |  |
| [1851](#L1851) |  |
| [1852](#L1852) | }, "Please enter cookie value"); |
| [1853](#L1853) |  |
| [1854](#L1854) | jQuery.validator.addMethod("checkanypageCookie", function (value, element) { |
| [1855](#L1855) |  |
| [1856](#L1856) | if (jQuery('input[name="newsletter\_show\_on"]:checked').val() == 'any' && jQuery.trim(jQuery("#cookieTimeUpUniqueAnyPage").val()) == '') { |
| [1857](#L1857) | return false; |
| [1858](#L1858) | } else { |
| [1859](#L1859) | return true; |
| [1860](#L1860) | } |
| [1861](#L1861) |  |
| [1862](#L1862) |  |
| [1863](#L1863) | }, "Please enter cookie value"); |
| [1864](#L1864) | jQuery("#subscriptionFrmsettiings").validate({ |
| [1865](#L1865) | rules: { |
| [1866](#L1866) | cookieTimeUpUniqueHomePage: { |
| [1867](#L1867) | checkHomeCookie: true, |
| [1868](#L1868) | digits: true |
| [1869](#L1869) |  |
| [1870](#L1870) | }, |
| [1871](#L1871) | cookieTimeUpUniqueAnyPage: { |
| [1872](#L1872) | checkanypageCookie: true, |
| [1873](#L1873) | digits: true |
| [1874](#L1874) |  |
| [1875](#L1875) | }, |
| [1876](#L1876) | heading: { |
| [1877](#L1877) | required: true |
| [1878](#L1878) | }, subheading: { |
| [1879](#L1879) | required: true |
| [1880](#L1880) | }, |
| [1881](#L1881) | email: { |
| [1882](#L1882) | required: true |
| [1883](#L1883) | }, |
| [1884](#L1884) | name: { |
| [1885](#L1885) | required: true |
| [1886](#L1886) | }, |
| [1887](#L1887) | submitbtn: { |
| [1888](#L1888) | required: true |
| [1889](#L1889) | }, |
| [1890](#L1890) | requiredfield: { |
| [1891](#L1891) | required: true |
| [1892](#L1892) | }, |
| [1893](#L1893) | iinvalidemail: { |
| [1894](#L1894) | required: true |
| [1895](#L1895) | }, |
| [1896](#L1896) | invalid\_request: { |
| [1897](#L1897) | required: true |
| [1898](#L1898) | }, |
| [1899](#L1899) | email\_exist: { |
| [1900](#L1900) | required: true |
| [1901](#L1901) | }, |
| [1902](#L1902) | success: { |
| [1903](#L1903) | required: true |
| [1904](#L1904) | }, |
| [1905](#L1905) | success: { |
| [1906](#L1906) | required: true |
| [1907](#L1907) | }, |
| [1908](#L1908) | unsubscribe\_message: { |
| [1909](#L1909) | required: true |
| [1910](#L1910) | } |
| [1911](#L1911) | , wait: { |
| [1912](#L1912) | required: true |
| [1913](#L1913) | } |
| [1914](#L1914) |  |
| [1915](#L1915) | }, |
| [1916](#L1916) | errorClass: "image\_error", |
| [1917](#L1917) | errorPlacement: function (error, element) { |
| [1918](#L1918) | error.appendTo(element.next().next()); |
| [1919](#L1919) | } |
| [1920](#L1920) |  |
| [1921](#L1921) |  |
| [1922](#L1922) | }) |
| [1923](#L1923) | }); |
| [1924](#L1924) |  |
| [1925](#L1925) | </script> |
| [1926](#L1926) |  |
| [1927](#L1927) | </div> |
| [1928](#L1928) | </div> |
| [1929](#L1929) | </div> |
| [1930](#L1930) | </div> |
| [1931](#L1931) | </div> |
| [1932](#L1932) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [1933](#L1933) |  |
| [1934](#L1934) | <div class="postbox"> |
| [1935](#L1935) | <center><h3 class="hndle"><span></span><?php echo \_\_('New AI based DIVI Theme', 'email-subscribe'); ?></h3> </center> |
| [1936](#L1936) | <div class="inside"> |
| [1937](#L1937) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url('images/divi\_300x250.jpg', \_\_FILE\_\_); ?>" width="250" height="250"></a></center> |
| [1938](#L1938) |  |
| [1939](#L1939) | <div style="margin:10px 5px"> |
| [1940](#L1940) |  |
| [1941](#L1941) | </div> |
| [1942](#L1942) | </div></div> |
| [1943](#L1943) | <div class="postbox"> |
| [1944](#L1944) | <center><h3 class="hndle"><span></span><?php echo \_\_('Google For Business', 'email-subscribe'); ?></h3> </center> |
| [1945](#L1945) | <div class="inside"> |
| [1946](#L1946) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="" height="250" border="0"></a></center> |
| [1947](#L1947) | <div style="margin:10px 5px"> |
| [1948](#L1948) | </div> |
| [1949](#L1949) | </div></div> |
| [1950](#L1950) |  |
| [1951](#L1951) | </div> |
| [1952](#L1952) | <div class="clear"></div></div> |
| [1953](#L1953) | <?php |
| [1954](#L1954) | } |
| [1955](#L1955) |  |
| [1956](#L1956) | function massEmailToEmail\_Subscriber\_Func() { |
| [1957](#L1957) |  |
| [1958](#L1958) |  |
| [1959](#L1959) | $selfpage = wp\_get\_referer(); |
| [1960](#L1960) |  |
| [1961](#L1961) | $action = ''; |
| [1962](#L1962) | if (isset($\_REQUEST['action'])) { |
| [1963](#L1963) | $action = $\_REQUEST['action']; |
| [1964](#L1964) | } |
| [1965](#L1965) | ?> |
| [1966](#L1966) |  |
| [1967](#L1967) | <?php |
| [1968](#L1968) | switch ($action) { |
| [1969](#L1969) |  |
| [1970](#L1970) |  |
| [1971](#L1971) | case 'sendEmailSend': |
| [1972](#L1972) |  |
| [1973](#L1973) | if (!check\_admin\_referer('action\_settings\_add\_edit', 'sendEmailSend')) { |
| [1974](#L1974) |  |
| [1975](#L1975) | wp\_die('Security check fail'); |
| [1976](#L1976) | } |
| [1977](#L1977) |  |
| [1978](#L1978) | set\_time\_limit(5000); |
| [1979](#L1979) | $emailTo = preg\_replace('/\s\s+/', ' ', $\_POST['emailTo']); |
| [1980](#L1980) | $toSendEmail = explode(",", $emailTo); |
| [1981](#L1981) | global $wpdb; |
| [1982](#L1982) |  |
| [1983](#L1983) | $flag = false; |
| [1984](#L1984) | foreach ($toSendEmail as $key => $val) { |
| [1985](#L1985) |  |
| [1986](#L1986) | $val = trim(htmlentities(sanitize\_email($val), ENT\_QUOTES)); |
| [1987](#L1987) |  |
| [1988](#L1988) | $subject = stripslashes($\_POST['email\_subject']); |
| [1989](#L1989) | //$subject=trim(htmlentities(strip\_tags($subject),ENT\_QUOTES)); |
| [1990](#L1990) | $from\_name = stripslashes($\_POST['email\_From\_name']); |
| [1991](#L1991) | // $from\_name=trim(htmlentities(strip\_tags($from\_name),ENT\_QUOTES)); |
| [1992](#L1992) |  |
| [1993](#L1993) | $from\_email = htmlentities(sanitize\_email($\_POST['email\_From']), ENT\_QUOTES); |
| [1994](#L1994) | $emailBody = $\_POST['txtArea']; |
| [1995](#L1995) |  |
| [1996](#L1996) | $query = "SELECT \* FROM " . $wpdb->prefix . "nl\_subscriptions WHERE email='$val'"; |
| [1997](#L1997) |  |
| [1998](#L1998) | $userInfo = $wpdb->get\_row($query); |
| [1999](#L1999) | $user\_full\_name = ""; |
| [2000](#L2000) | $user\_email = ""; |
| [2001](#L2001) | $unsubscribeLinkHtml = ""; |
| [2002](#L2002) | $unsubscribeLinkPlain = ""; |
| [2003](#L2003) |  |
| [2004](#L2004) | if (is\_object($userInfo)) { |
| [2005](#L2005) |  |
| [2006](#L2006) | $uerIdunsbs = urldecode($userInfo->unsubs\_key); |
| [2007](#L2007) | $user\_email = $userInfo->email; |
| [2008](#L2008) | $user\_full\_name = stripslashes($userInfo->name); |
| [2009](#L2009) | } |
| [2010](#L2010) | $url = get\_home\_url(); |
| [2011](#L2011) | $unsubs = $url . '?action=nks\_unsubscribeuser&unsc=' . $uerIdunsbs; |
| [2012](#L2012) | $unsubscribeLinkHtml = '<a href="' . $unsubs . '" target="\_blank">Unsubscribe me from all email messages</a>'; |
| [2013](#L2013) | $unsubscribeLinkPlain = $unsubs; |
| [2014](#L2014) |  |
| [2015](#L2015) | $emailBody = stripslashes($emailBody); |
| [2016](#L2016) |  |
| [2017](#L2017) | $emailBody = str\_replace('[user\_full\_name]', $user\_full\_name, $emailBody); |
| [2018](#L2018) | $emailBody = str\_replace('[user\_email]', $user\_email, $emailBody); |
| [2019](#L2019) | $emailBody = str\_replace('[unsubscribe\_link\_plain]', $unsubscribeLinkPlain, $emailBody); |
| [2020](#L2020) | $emailBody = str\_replace('[unsubscribe\_link\_html]', $unsubscribeLinkHtml, $emailBody); |
| [2021](#L2021) |  |
| [2022](#L2022) | $charSet = get\_bloginfo('charset'); |
| [2023](#L2023) |  |
| [2024](#L2024) | $mailheaders = ''; |
| [2025](#L2025) | //$mailheaders .= "X-Priority: 1\n"; |
| [2026](#L2026) | $mailheaders .= "Content-Type: text/html; charset=\"$charSet\"\n"; |
| [2027](#L2027) | $mailheaders .= "From: $from\_name <$from\_email>" . "\r\n"; |
| [2028](#L2028) | //$mailheaders .= "Bcc: $emailTo" . "\r\n"; |
| [2029](#L2029) | // $message=nl2br($message,true); |
| [2030](#L2030) | $emailBody = wpautop($emailBody); |
| [2031](#L2031) | $emailBody = '<!DOCTYPE html><html ' . get\_language\_attributes() . '><head> <meta http-equiv="Content-Type" content="text/html; charset=' . get\_bloginfo("charset") . '" /><title>' . get\_bloginfo('name', 'display') . '</title></head><body>' . $emailBody . '</body></html>'; |
| [2032](#L2032) |  |
| [2033](#L2033) | $Rreturns = wp\_mail($val, $subject, $emailBody, $mailheaders); |
| [2034](#L2034) |  |
| [2035](#L2035) | if ($Rreturns) |
| [2036](#L2036) | $flag = true; |
| [2037](#L2037) | } |
| [2038](#L2038) | $adminUrl = get\_admin\_url(); |
| [2039](#L2039) | if ($flag) { |
| [2040](#L2040) |  |
| [2041](#L2041) | update\_option('mass\_email\_subscribers\_succ', \_\_('Email sent successfully.', 'email-subscribe')); |
| [2042](#L2042) | $entrant = empty($\_POST['entrant']) ? 1 : (int) $\_POST['entrant']; |
| [2043](#L2043) | $setPerPage = empty($\_POST['setPerPage']) ? 10 : (int) $\_POST['setPerPage']; |
| [2044](#L2044) | $searchuser = htmlentities(strip\_tags($\_POST['searchuser']), ENT\_QUOTES); |
| [2045](#L2045) |  |
| [2046](#L2046) | echo "<script>window.location.href='" . $adminUrl . "admin.php?page=email\_subscription\_popup\_subscribers\_management&entrant=$entrant&setPerPage=$setPerPage&searchuser=$searchuser" . "';</script>"; |
| [2047](#L2047) | exit; |
| [2048](#L2048) | } else { |
| [2049](#L2049) |  |
| [2050](#L2050) | $entrant = empty($\_POST['entrant']) ? 1 : (int) $\_POST['entrant']; |
| [2051](#L2051) | $setPerPage = empty($\_POST['setPerPage']) ? 10 : (int) $\_POST['setPerPage']; |
| [2052](#L2052) | $searchuser = htmlentities(strip\_tags($\_POST['searchuser']), ENT\_QUOTES); |
| [2053](#L2053) |  |
| [2054](#L2054) | update\_option('mass\_email\_subscribers\_err', \_\_('Unable to send email to newsletter subscribers.', 'email-subscribe')); |
| [2055](#L2055) | echo "<script>window.location.href='" . $adminUrl . "admin.php?page=email\_subscription\_popup\_subscribers\_management&entrant=$entrant&setPerPage=$setPerPage&searchuser=$searchuser" . "';</script>"; |
| [2056](#L2056) | exit; |
| [2057](#L2057) | } |
| [2058](#L2058) | break; |
| [2059](#L2059) |  |
| [2060](#L2060) | case 'sendEmailForm' : |
| [2061](#L2061) | $referer = wp\_get\_referer(); |
| [2062](#L2062) |  |
| [2063](#L2063) | if (isset($\_POST['deleteEmails'])) { |
| [2064](#L2064) |  |
| [2065](#L2065) | if (!check\_admin\_referer('action\_settings\_add\_edit', 'queue\_and\_delete\_subsciber')) { |
| [2066](#L2066) |  |
| [2067](#L2067) | wp\_die('Security check fail'); |
| [2068](#L2068) | } |
| [2069](#L2069) |  |
| [2070](#L2070) | if (!current\_user\_can('es\_email\_subscribe\_delete\_subscribers')) { |
| [2071](#L2071) |  |
| [2072](#L2072) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [2073](#L2073) | } |
| [2074](#L2074) |  |
| [2075](#L2075) | global $wpdb; |
| [2076](#L2076) | $subscribersSelectedEmails = $\_POST['ckboxs']; |
| [2077](#L2077) | $mass\_email\_queue = get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2078](#L2078) | foreach ($subscribersSelectedEmails as $em) { |
| [2079](#L2079) |  |
| [2080](#L2080) | $em = sanitize\_email($em); |
| [2081](#L2081) | if ($em != "") { |
| [2082](#L2082) |  |
| [2083](#L2083) | $query = "delete from  " . $wpdb->prefix . "nl\_subscriptions where email='$em'"; |
| [2084](#L2084) | $wpdb->query($query); |
| [2085](#L2085) | if (is\_array($mass\_email\_queue)) { |
| [2086](#L2086) |  |
| [2087](#L2087) | $key = (int) array\_search($em, $mass\_email\_queue); |
| [2088](#L2088) | if (array\_search($em, $mass\_email\_queue) >= 0) { |
| [2089](#L2089) |  |
| [2090](#L2090) | unset($mass\_email\_queue[$key]); |
| [2091](#L2091) | } |
| [2092](#L2092) | } |
| [2093](#L2093) | } |
| [2094](#L2094) | } |
| [2095](#L2095) |  |
| [2096](#L2096) | update\_option('mass\_email\_subscribers\_succ', \_\_('Selected subscribers deleted successfully.', 'email-subscribe')); |
| [2097](#L2097) | update\_option('mass\_email\_queue\_news\_subscriber', $mass\_email\_queue); |
| [2098](#L2098) | echo "<script>location.href='" . $referer . "';</script>"; |
| [2099](#L2099) | exit; |
| [2100](#L2100) | } else if (isset($\_POST['resetemailqueue'])) { |
| [2101](#L2101) |  |
| [2102](#L2102) | if (!check\_admin\_referer('action\_settings\_add\_edit', 'queue\_and\_delete\_subsciber')) { |
| [2103](#L2103) |  |
| [2104](#L2104) | wp\_die('Security check fail'); |
| [2105](#L2105) | } |
| [2106](#L2106) | update\_option('mass\_email\_queue\_news\_subscriber', false); |
| [2107](#L2107) | update\_option('mass\_email\_subscribers\_succ', \_\_('Email queue reseted successfully.', 'email-subscribe')); |
| [2108](#L2108) | $setacrionpage = 'admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2109](#L2109) | echo "<script>location.href='" . $setacrionpage . "';</script>"; |
| [2110](#L2110) | exit; |
| [2111](#L2111) | } |
| [2112](#L2112) |  |
| [2113](#L2113) | if (isset($\_POST['sendEmailAll'])) { |
| [2114](#L2114) |  |
| [2115](#L2115) | global $wpdb; |
| [2116](#L2116) |  |
| [2117](#L2117) | if (!current\_user\_can('es\_email\_subscribe\_send\_email\_to\_all\_subscribers')) { |
| [2118](#L2118) |  |
| [2119](#L2119) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [2120](#L2120) | } |
| [2121](#L2121) |  |
| [2122](#L2122) | $query = "SELECT email as emails from " . $wpdb->prefix . "nl\_subscriptions where is\_subscribed=1"; |
| [2123](#L2123) |  |
| [2124](#L2124) | $emails = $wpdb->get\_results($query, 'OBJECT'); |
| [2125](#L2125) | $convertToString = ''; |
| [2126](#L2126) | $count = 0; |
| [2127](#L2127) | foreach ($emails as $mail) { |
| [2128](#L2128) |  |
| [2129](#L2129) | $convertToString .= $mail->emails . ",\n"; |
| [2130](#L2130) | $count++; |
| [2131](#L2131) | } |
| [2132](#L2132) | $convertToString = trim($convertToString, ",\n"); |
| [2133](#L2133) | } else { |
| [2134](#L2134) | if (isset($\_POST['sendEmailQueue'])) { |
| [2135](#L2135) |  |
| [2136](#L2136) | if (!current\_user\_can('es\_email\_subscribe\_send\_email\_to\_selected\_subscribers')) { |
| [2137](#L2137) |  |
| [2138](#L2138) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [2139](#L2139) | } |
| [2140](#L2140) | $convertToString = esc\_textarea($\_POST['queueemails']); |
| [2141](#L2141) | } else { |
| [2142](#L2142) |  |
| [2143](#L2143) | if (!current\_user\_can('es\_email\_subscribe\_send\_email\_to\_selected\_subscribers')) { |
| [2144](#L2144) |  |
| [2145](#L2145) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [2146](#L2146) | } |
| [2147](#L2147) | $subscribersSelectedEmails = $\_POST['ckboxs']; |
| [2148](#L2148) | $convertToString = esc\_textarea(implode(",\n", $subscribersSelectedEmails)); |
| [2149](#L2149) | } |
| [2150](#L2150) | } |
| [2151](#L2151) | ?> |
| [2152](#L2152) |  |
| [2153](#L2153) | <table><tr><td> |
| [2154](#L2154) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [2155](#L2155) | <div id="fb-root"></div> |
| [2156](#L2156) | <script>(function (d, s, id) { |
| [2157](#L2157) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [2158](#L2158) | if (d.getElementById(id)) |
| [2159](#L2159) | return; |
| [2160](#L2160) | js = d.createElement(s); js.id = id; |
| [2161](#L2161) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [2162](#L2162) | fjs.parentNode.insertBefore(js, fjs); |
| [2163](#L2163) | }(document, 'script', 'facebook-jssdk'));</script> |
| [2164](#L2164) | </td> |
| [2165](#L2165) | <td> |
| [2166](#L2166) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [2167](#L2167) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [2168](#L2168) | </a> |
| [2169](#L2169) | </td> |
| [2170](#L2170) | </tr> |
| [2171](#L2171) | </table> |
| [2172](#L2172) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [2173](#L2173) |  |
| [2174](#L2174) | <h3><?php echo \_\_('Send Email To Newsletter Subscribers', 'email-subscribe'); ?> </h3> |
| [2175](#L2175) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [2176](#L2176) | <form name="frmSendEmailsToUserSend" id='frmSendEmailsToUserSend' method="post" action="" > |
| [2177](#L2177) | <input type="hidden" value="sendEmailSend" name="action"> |
| [2178](#L2178) | <?php wp\_nonce\_field('action\_settings\_add\_edit', 'sendEmailSend'); ?> |
| [2179](#L2179) | <input type="hidden" value="<?php echo @$entrant; ?>" name="entrant"> |
| [2180](#L2180) | <input type="hidden" value="<?php echo @$setPerPage; ?>" name="setPerPage"> |
| [2181](#L2181) | <input type="hidden" value="<?php echo @$searchuser; ?>" name="searchuser"> |
| [2182](#L2182) | <table class="form-table" style="width:100%" > |
| [2183](#L2183) | <tbody> |
| [2184](#L2184) |  |
| [2185](#L2185) | <tr valign="top" id="subject"> |
| [2186](#L2186) | <th scope="row" style="width:30%;text-align: right;"><?php echo \_\_('Subject', 'email-subscribe'); ?> \*</th> |
| [2187](#L2187) | <td> |
| [2188](#L2188) | <input type="text" id="email\_subject" name="email\_subject"  class="valid" size="70"> |
| [2189](#L2189) | <div style="clear: both;"></div><div></div> |
| [2190](#L2190) | </td> |
| [2191](#L2191) | </tr> |
| [2192](#L2192) | <tr valign="top" id="subject"> |
| [2193](#L2193) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_('Email From Name', 'email-subscribe'); ?> \*</th> |
| [2194](#L2194) | <td> |
| [2195](#L2195) | <input type="text" id="email\_From\_name" name="email\_From\_name"  class="valid" size="70"> |
| [2196](#L2196) | <br/><?php echo \_\_('(ex. admin)', 'email-subscribe'); ?> |
| [2197](#L2197) | <div style="clear: both;"></div><div></div> |
| [2198](#L2198) |  |
| [2199](#L2199) | </td> |
| [2200](#L2200) | </tr> |
| [2201](#L2201) | <tr valign="top" id="subject"> |
| [2202](#L2202) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_('Email From', 'email-subscribe'); ?> \*</th> |
| [2203](#L2203) | <td> |
| [2204](#L2204) | <input type="text" id="email\_From" name="email\_From"  class="valid" size="70"> |
| [2205](#L2205) | <br/><?php echo \_\_('(ex. admin@yoursite.com) ', 'email-subscribe'); ?> |
| [2206](#L2206) | <div style="clear: both;"></div><div></div> |
| [2207](#L2207) |  |
| [2208](#L2208) | </td> |
| [2209](#L2209) | </tr> |
| [2210](#L2210) | <tr valign="top" id="subject"> |
| [2211](#L2211) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_('Email To', 'email-subscribe'); ?> \*</th> |
| [2212](#L2212) | <td> |
| [2213](#L2213) | <textarea id='emailTo'  name="emailTo" cols="58" rows="4"><?php echo esc\_textarea($convertToString); ?></textarea> |
| [2214](#L2214) | <div style="clear: both;"></div><div></div> |
| [2215](#L2215) | </td> |
| [2216](#L2216) | </tr> |
| [2217](#L2217) | <tr valign="top" id="subject"> |
| [2218](#L2218) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_('Email Body', 'email-subscribe'); ?> \*</th> |
| [2219](#L2219) | <td> |
| [2220](#L2220) | <div class="wrap"> |
| [2221](#L2221) | <?php wp\_editor('', 'txtArea'); ?> |
| [2222](#L2222) | <input type="hidden" name="editor\_val" id="editor\_val" /> |
| [2223](#L2223) | <div style="clear: both;"></div><div></div> |
| [2224](#L2224) | <?php echo \_\_('you can use [user\_full\_name],[user\_email],[unsubscribe\_link\_plain],[unsubscribe\_link\_html] place holder into email content', 'email-subscribe'); ?> |
| [2225](#L2225) | </div> |
| [2226](#L2226) | </td> |
| [2227](#L2227) | </tr> |
| [2228](#L2228) |  |
| [2229](#L2229) | <tr valign="top" id="subject"> |
| [2230](#L2230) | <th scope="row" style="width:30%"></th> |
| [2231](#L2231) | <td> |
| [2232](#L2232) |  |
| [2233](#L2233) | <input type='submit'  value='<?php echo \_\_('Send Email', 'email-subscribe'); ?>' name='sendEmailsend' class='button-primary' id='sendEmailsend' > |
| [2234](#L2234) | </td> |
| [2235](#L2235) | </tr> |
| [2236](#L2236) |  |
| [2237](#L2237) | </table> |
| [2238](#L2238) | </form> |
| [2239](#L2239) | <script type="text/javascript"> |
| [2240](#L2240) |  |
| [2241](#L2241) |  |
| [2242](#L2242) | jQuery(document).ready(function () { |
| [2243](#L2243) |  |
| [2244](#L2244) | jQuery.validator.addMethod("chkCont", function (value, element) { |
| [2245](#L2245) |  |
| [2246](#L2246) |  |
| [2247](#L2247) |  |
| [2248](#L2248) | var editorcontent = tinyMCE.get('txtArea').getContent(); |
| [2249](#L2249) |  |
| [2250](#L2250) | if (editorcontent.length) { |
| [2251](#L2251) | return true; |
| [2252](#L2252) | } else { |
| [2253](#L2253) | return false; |
| [2254](#L2254) | } |
| [2255](#L2255) |  |
| [2256](#L2256) |  |
| [2257](#L2257) | }, |
| [2258](#L2258) | "Please enter email content" |
| [2259](#L2259) | ); |
| [2260](#L2260) |  |
| [2261](#L2261) | jQuery("#frmSendEmailsToUserSend").validate({ |
| [2262](#L2262) | errorClass: "error\_admin\_massemail", |
| [2263](#L2263) | rules: { |
| [2264](#L2264) | email\_subject: { |
| [2265](#L2265) | required: true |
| [2266](#L2266) | }, |
| [2267](#L2267) | email\_From\_name: { |
| [2268](#L2268) | required: true |
| [2269](#L2269) | }, |
| [2270](#L2270) | email\_From: { |
| [2271](#L2271) | required: true, email: true |
| [2272](#L2272) | }, |
| [2273](#L2273) | emailTo: { |
| [2274](#L2274) |  |
| [2275](#L2275) | required: true |
| [2276](#L2276) | }, |
| [2277](#L2277) | editor\_val: { |
| [2278](#L2278) | chkCont: true |
| [2279](#L2279) | } |
| [2280](#L2280) |  |
| [2281](#L2281) | }, |
| [2282](#L2282) |  |
| [2283](#L2283) | errorPlacement: function (error, element) { |
| [2284](#L2284) | error.appendTo(element.next().next()); |
| [2285](#L2285) | } |
| [2286](#L2286) |  |
| [2287](#L2287) | }); |
| [2288](#L2288) |  |
| [2289](#L2289) |  |
| [2290](#L2290) | }); |
| [2291](#L2291) |  |
| [2292](#L2292) | </script> |
| [2293](#L2293) | <?php |
| [2294](#L2294) | break; |
| [2295](#L2295) | default: |
| [2296](#L2296) |  |
| [2297](#L2297) | if (!current\_user\_can('es\_email\_subscribe\_view\_subscribers')) { |
| [2298](#L2298) |  |
| [2299](#L2299) | wp\_die(\_\_("Access Denied", "email-subscribe", 403)); |
| [2300](#L2300) | } |
| [2301](#L2301) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2302](#L2302) | $url = str\_replace("\\", "/", $url); |
| [2303](#L2303) | ?> |
| [2304](#L2304) | <div style="width: 100%;"> |
| [2305](#L2305) | <div style="float:left;width:65%;" > |
| [2306](#L2306) | <?php |
| [2307](#L2307) | global $wpdb; |
| [2308](#L2308) |  |
| [2309](#L2309) | $query = "SELECT \* from " . $wpdb->prefix . "nl\_subscriptions where is\_subscribed=1 "; |
| [2310](#L2310) | $queryCount = "SELECT count(\*) from " . $wpdb->prefix . "nl\_subscriptions where is\_subscribed=1 "; |
| [2311](#L2311) |  |
| [2312](#L2312) | if (isset($\_GET['searchuser']) and $\_GET['searchuser'] != '') { |
| [2313](#L2313) | $term = trim(urldecode(esc\_sql($\_GET['searchuser']))); |
| [2314](#L2314) | $query .= "  and ( name like '%$term%' or email like '%$term%'  )  "; |
| [2315](#L2315) | $queryCount .= "  and ( name like '%$term%' or email like '%$term%'  )  "; |
| [2316](#L2316) | } |
| [2317](#L2317) |  |
| [2318](#L2318) | $totalRecordForQuery = $wpdb->get\_var($queryCount); |
| [2319](#L2319) | $selfPage = wp\_get\_referer() . '?page=email\_subscription\_popup\_subscribers\_management'; |
| [2320](#L2320) | global $wp\_rewrite; |
| [2321](#L2321) |  |
| [2322](#L2322) | $rows\_per\_page = 10; |
| [2323](#L2323) | if (isset($\_GET['setPerPage']) and $\_GET['setPerPage'] != "") { |
| [2324](#L2324) |  |
| [2325](#L2325) | $rows\_per\_page = intval($\_GET['setPerPage']); |
| [2326](#L2326) | } |
| [2327](#L2327) |  |
| [2328](#L2328) | $current = (isset($\_GET['entrant'])) ? (intval($\_GET['entrant'])) : 1; |
| [2329](#L2329) | $pagination\_args = array( |
| [2330](#L2330) | 'base' => @add\_query\_arg('entrant', '%#%'), |
| [2331](#L2331) | 'format' => '', |
| [2332](#L2332) | 'total' => ceil($totalRecordForQuery / $rows\_per\_page), |
| [2333](#L2333) | 'current' => $current, |
| [2334](#L2334) | 'show\_all' => false, |
| [2335](#L2335) | 'type' => 'plain', |
| [2336](#L2336) | ); |
| [2337](#L2337) |  |
| [2338](#L2338) | $selfpage = wp\_get\_referer(); |
| [2339](#L2339) |  |
| [2340](#L2340) | if ($totalRecordForQuery > 0) { |
| [2341](#L2341) | ?> |
| [2342](#L2342) | <?php |
| [2343](#L2343) | $SuccMsg = get\_option('mass\_email\_subscribers\_succ'); |
| [2344](#L2344) | update\_option('mass\_email\_subscribers\_succ', ''); |
| [2345](#L2345) |  |
| [2346](#L2346) | $errMsg = get\_option('mass\_email\_subscribers\_err'); |
| [2347](#L2347) | update\_option('mass\_email\_subscribers\_err', ''); |
| [2348](#L2348) | ?> |
| [2349](#L2349) |  |
| [2350](#L2350) | <?php if ($SuccMsg != "") { |
| [2351](#L2351) | echo "<div class='notice notice-success is-dismissible'><p>"; |
| [2352](#L2352) | echo $SuccMsg; |
| [2353](#L2353) | echo "</p></div>"; |
| [2354](#L2354) | $SuccMsg = ""; |
| [2355](#L2355) | } ?> |
| [2356](#L2356) | <?php if ($errMsg != "") { |
| [2357](#L2357) | echo "<div class='notice notice-error is-dismissible' ></p>"; |
| [2358](#L2358) | \_e($errMsg); |
| [2359](#L2359) | echo "</p></div>"; |
| [2360](#L2360) | $errMsg = ""; |
| [2361](#L2361) | } ?> |
| [2362](#L2362) |  |
| [2363](#L2363) | <table><tr><td> |
| [2364](#L2364) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [2365](#L2365) | <div id="fb-root"></div> |
| [2366](#L2366) | <script>(function (d, s, id) { |
| [2367](#L2367) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [2368](#L2368) | if (d.getElementById(id)) |
| [2369](#L2369) | return; |
| [2370](#L2370) | js = d.createElement(s); |
| [2371](#L2371) | js.id = id; |
| [2372](#L2372) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [2373](#L2373) | fjs.parentNode.insertBefore(js, fjs); |
| [2374](#L2374) | }(document, 'script', 'facebook-jssdk'));</script> |
| [2375](#L2375) | </td> |
| [2376](#L2376) | <td> |
| [2377](#L2377) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [2378](#L2378) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url('images/paypaldonate.jpg', \_\_FILE\_\_); ?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [2379](#L2379) | </a> |
| [2380](#L2380) | </td> |
| [2381](#L2381) | </tr> |
| [2382](#L2382) | </table> |
| [2383](#L2383) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [2384](#L2384) |  |
| [2385](#L2385) | <h3><?php echo \_\_('Send Email To Newsletter Subscribers', 'email-subscribe'); ?></h3> |
| [2386](#L2386) | <?php |
| [2387](#L2387) | $order\_by = 'name'; |
| [2388](#L2388) | $order\_pos = "asc"; |
| [2389](#L2389) |  |
| [2390](#L2390) | $setacrionpage = 'admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2391](#L2391) |  |
| [2392](#L2392) | if (isset($\_GET['entrant']) and $\_GET['entrant'] != "") { |
| [2393](#L2393) | $setacrionpage .= '&entrant=' . intval($\_GET['entrant']); |
| [2394](#L2394) | } |
| [2395](#L2395) |  |
| [2396](#L2396) | if (isset($\_GET['setPerPage']) and $\_GET['setPerPage'] != "") { |
| [2397](#L2397) | $setacrionpage .= '&setPerPage=' . intval($\_GET['setPerPage']); |
| [2398](#L2398) | } |
| [2399](#L2399) |  |
| [2400](#L2400) | $seval = ""; |
| [2401](#L2401) | if (isset($\_GET['searchuser']) and $\_GET['searchuser'] != "") { |
| [2402](#L2402) | $seval = sanitize\_text\_field($\_GET['searchuser']); |
| [2403](#L2403) | } |
| [2404](#L2404) |  |
| [2405](#L2405) | $search\_term\_ = ''; |
| [2406](#L2406) | if (isset($\_GET['searchuser'])) { |
| [2407](#L2407) |  |
| [2408](#L2408) | $search\_term\_ = '&searchuser=' . urlencode(sanitize\_text\_field($\_GET['searchuser'])); |
| [2409](#L2409) | } |
| [2410](#L2410) |  |
| [2411](#L2411) | if (isset($\_GET['order\_by'])) { |
| [2412](#L2412) |  |
| [2413](#L2413) | $order\_by = trim($\_GET['order\_by']); |
| [2414](#L2414) | } |
| [2415](#L2415) |  |
| [2416](#L2416) | if (isset($\_GET['order\_pos'])) { |
| [2417](#L2417) |  |
| [2418](#L2418) | $order\_pos = trim($\_GET['order\_pos']); |
| [2419](#L2419) | } |
| [2420](#L2420) |  |
| [2421](#L2421) | $order\_by = sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [2422](#L2422) | $order\_pos = sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [2423](#L2423) | $setacrionpage = esc\_html($setacrionpage); |
| [2424](#L2424) | ?> |
| [2425](#L2425) | <div style="padding-top:5px;padding-bottom:5px"><b><?php echo \_\_('Search User', 'email-subscribe'); ?> : </b><input type="text" value="<?php echo esc\_attr($seval); ?>" id="searchuser" name="searchuser">&nbsp;<input type='submit'  value='<?php echo \_\_('Search Subscribers', 'email-subscribe'); ?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp;<input type='submit'  value='<?php echo \_\_('Reset Search', 'email-subscribe'); ?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" ></div> |
| [2426](#L2426) | <script type="text/javascript" > |
| [2427](#L2427) | function SearchredirectTO() { |
| [2428](#L2428) | var redirectto = '<?php echo $setacrionpage; ?>'; |
| [2429](#L2429) | var searchval = jQuery('#searchuser').val(); |
| [2430](#L2430) | redirectto = redirectto + '&searchuser=' + jQuery.trim(encodeURIComponent(searchval)) + '&entrant=1'; |
| [2431](#L2431) | window.location.href = redirectto; |
| [2432](#L2432) | } |
| [2433](#L2433) | function ResetSearch() { |
| [2434](#L2434) |  |
| [2435](#L2435) | var redirectto = '<?php echo $setacrionpage; ?>'; |
| [2436](#L2436) | window.location.href = redirectto; |
| [2437](#L2437) | exit; |
| [2438](#L2438) | } |
| [2439](#L2439) | </script> |
| [2440](#L2440) | <form method="post" action="" id="sendemail" name="sendemail"> |
| [2441](#L2441) | <input type="hidden" value="sendEmailForm" name="action" id="action"> |
| [2442](#L2442) |  |
| [2443](#L2443) | <table class="widefat fixed" cellspacing="0" style="width:97% !important" > |
| [2444](#L2444) | <thead> |
| [2445](#L2445) | <tr> |
| [2446](#L2446) | <?php if ($order\_by == "email" and $order\_pos == "asc"): ?> |
| [2447](#L2447) |  |
| [2448](#L2448) | <th> |
| [2449](#L2449) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2450](#L2450) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a> |
| [2451](#L2451) | </th> |
| [2452](#L2452) | <?php else: ?> |
| [2453](#L2453) | <?php if ($order\_by == "email"): ?> |
| [2454](#L2454) | <th> |
| [2455](#L2455) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2456](#L2456) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a> |
| [2457](#L2457) | </th> |
| [2458](#L2458) | <?php else: ?> |
| [2459](#L2459) | <th> |
| [2460](#L2460) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2461](#L2461) | <a href="<?php echo $setacrionpage; ?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Email', 'email-subscribe'); ?></a> |
| [2462](#L2462) | </th> |
| [2463](#L2463) | <?php endif; ?> |
| [2464](#L2464) | <?php endif; ?> |
| [2465](#L2465) |  |
| [2466](#L2466) | <?php if ($order\_by == "name" and $order\_pos == "asc"): ?> |
| [2467](#L2467) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=desc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [2468](#L2468) | <?php else: ?> |
| [2469](#L2469) | <?php if ($order\_by == "name"): ?> |
| [2470](#L2470) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [2471](#L2471) | <?php else: ?> |
| [2472](#L2472) | <th><a href="<?php echo $setacrionpage; ?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_; ?>"><?php echo \_\_('Name', 'email-subscribe'); ?></a></th> |
| [2473](#L2473) | <?php endif; ?> |
| [2474](#L2474) | <?php endif; ?> |
| [2475](#L2475) |  |
| [2476](#L2476) |  |
| [2477](#L2477) | </tr> |
| [2478](#L2478) | </thead> |
| [2479](#L2479) |  |
| [2480](#L2480) | <tfoot> |
| [2481](#L2481) | <tr> |
| [2482](#L2482) | <th scope="col" id="name" class="manage-column column-name" style=""><input onclick="chkAll(this)" type="checkbox" name="chkallfooter" id='chkallfooter'>&nbsp;<?php echo \_\_('Select All Emails', 'email-subscribe'); ?></th> |
| [2483](#L2483) | <th scope="col" id="name" class="manage-column column-name" style=""><?php echo \_\_('Name', 'email-subscribe'); ?></th> |
| [2484](#L2484) |  |
| [2485](#L2485) |  |
| [2486](#L2486) | </tr> |
| [2487](#L2487) | </tfoot> |
| [2488](#L2488) |  |
| [2489](#L2489) | <tbody id="the-list" class="list:cat"> |
| [2490](#L2490) | <?php |
| [2491](#L2491) | $mass\_email\_queue = array(); |
| [2492](#L2492) | if (get\_option('mass\_email\_queue\_news\_subscriber') != false and is\_array(get\_option('mass\_email\_queue\_news\_subscriber'))) |
| [2493](#L2493) | $mass\_email\_queue = get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2494](#L2494) |  |
| [2495](#L2495) | $offset = ($current - 1) \* $rows\_per\_page; |
| [2496](#L2496) | $query .= " order by $order\_by $order\_pos"; |
| [2497](#L2497) | $query .= " limit $offset, $rows\_per\_page"; |
| [2498](#L2498) | $emails = $wpdb->get\_results($query, ARRAY\_A); |
| [2499](#L2499) |  |
| [2500](#L2500) | foreach ($emails as $vemail) { |
| [2501](#L2501) |  |
| [2502](#L2502) | if ($vemail != null) { |
| [2503](#L2503) |  |
| [2504](#L2504) | $userId = $vemail['id']; |
| [2505](#L2505) | $name = $vemail['name']; |
| [2506](#L2506) | $email = sanitize\_email($vemail['email']); |
| [2507](#L2507) |  |
| [2508](#L2508) | if (in\_array($email, $mass\_email\_queue)) |
| [2509](#L2509) | $checked = "checked='checked'"; |
| [2510](#L2510) | else |
| [2511](#L2511) | $checked = ""; |
| [2512](#L2512) |  |
| [2513](#L2513) |  |
| [2514](#L2514) | echo"<tr class='iedit alternate'> |
| [2515](#L2515) | <td  class='name column-name' style='border:1px solid #DBDBDB;padding-left:13px;'><input type='checkBox' name='ckboxs[]' $checked  value='" . esc\_attr($email) . "'>&nbsp;" . esc\_attr($email) . "</td>"; |
| [2516](#L2516) | echo "<td  class='name column-name' style='border:1px solid #DBDBDB;'> " . stripslashes($name) . "</td>"; |
| [2517](#L2517) | echo "</tr>"; |
| [2518](#L2518) | } |
| [2519](#L2519) | } |
| [2520](#L2520) | ?> |
| [2521](#L2521) | </tbody> |
| [2522](#L2522) | </table> |
| [2523](#L2523) | <table> |
| [2524](#L2524) | <tr> |
| [2525](#L2525) | <td> |
| [2526](#L2526) | <?php |
| [2527](#L2527) | if ($totalRecordForQuery > 0) { |
| [2528](#L2528) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [2529](#L2529) | echo paginate\_links($pagination\_args); |
| [2530](#L2530) | echo "</div>"; |
| [2531](#L2531) | } |
| [2532](#L2532) | ?> |
| [2533](#L2533) |  |
| [2534](#L2534) | </td> |
| [2535](#L2535) | <td> |
| [2536](#L2536) | <b>&nbsp;&nbsp;<?php echo \_\_('Per Page :', 'email-subscribe'); ?> </b> |
| [2537](#L2537) | <?php |
| [2538](#L2538) | $setPerPageadmin = 'admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2539](#L2539) | /\* if(isset($\_GET['entrant']) and $\_GET['entrant']!=""){ |
| [2540](#L2540) | $setPerPageadmin.='&entrant='.(int)trim($\_GET['entrant']); |
| [2541](#L2541) | } \*/ |
| [2542](#L2542) | $setPerPageadmin .= '&setPerPage='; |
| [2543](#L2543) | ?> |
| [2544](#L2544) | <select name="setPerPage" onchange="document.location.href = '<?php echo $setPerPageadmin; ?>' + this.options[this.selectedIndex].value + ''"> |
| [2545](#L2545) | <option <?php if ($rows\_per\_page == "10"): ?>selected="selected"<?php endif; ?>  value="10">10</option> |
| [2546](#L2546) | <option <?php if ($rows\_per\_page == "20"): ?>selected="selected"<?php endif; ?> value="20">20</option> |
| [2547](#L2547) | <option <?php if ($rows\_per\_page == "30"): ?>selected="selected"<?php endif; ?>value="30">30</option> |
| [2548](#L2548) | <option <?php if ($rows\_per\_page == "40"): ?>selected="selected"<?php endif; ?> value="40">40</option> |
| [2549](#L2549) | <option <?php if ($rows\_per\_page == "50"): ?>selected="selected"<?php endif; ?> value="50">50</option> |
| [2550](#L2550) | <option <?php if ($rows\_per\_page == "60"): ?>selected="selected"<?php endif; ?> value="60">60</option> |
| [2551](#L2551) | <option <?php if ($rows\_per\_page == "70"): ?>selected="selected"<?php endif; ?> value="70">70</option> |
| [2552](#L2552) | <option <?php if ($rows\_per\_page == "80"): ?>selected="selected"<?php endif; ?> value="80">80</option> |
| [2553](#L2553) | <option <?php if ($rows\_per\_page == "90"): ?>selected="selected"<?php endif; ?> value="90">90</option> |
| [2554](#L2554) | <option <?php if ($rows\_per\_page == "100"): ?>selected="selected"<?php endif; ?> value="100">100</option> |
| [2555](#L2555) | <option <?php if ($rows\_per\_page == "500"): ?>selected="selected"<?php endif; ?> value="500">500</option> |
| [2556](#L2556) | <option <?php if ($rows\_per\_page == "1000"): ?>selected="selected"<?php endif; ?> value="1000">1000</option> |
| [2557](#L2557) | <option <?php if ($rows\_per\_page == "2000"): ?>selected="selected"<?php endif; ?> value="2000">2000</option> |
| [2558](#L2558) | <option <?php if ($rows\_per\_page == "3000"): ?>selected="selected"<?php endif; ?> value="3000">3000</option> |
| [2559](#L2559) | <option <?php if ($rows\_per\_page == "4000"): ?>selected="selected"<?php endif; ?> value="4000">4000</option> |
| [2560](#L2560) | <option <?php if ($rows\_per\_page == "5000"): ?>selected="selected"<?php endif; ?> value="5000">5000</option> |
| [2561](#L2561) | </select> |
| [2562](#L2562) | </td> |
| [2563](#L2563) | </tr> |
| [2564](#L2564) | </table> |
| [2565](#L2565) | <table> |
| [2566](#L2566) | <tr> |
| [2567](#L2567) | <td class='name column-name' style='padding-top:15px;padding-left:10px;'> |
| [2568](#L2568) |  |
| [2569](#L2569) | <script type="text/javascript"> |
| [2570](#L2570) | function sendEmailToAll(obj) { |
| [2571](#L2571) |  |
| [2572](#L2572) | var txt; |
| [2573](#L2573) | var r = confirm("<?php echo \_\_('It is not recommaded to send email to all at once as there is always hosting server limit for send emails hourly basis. Most of hosting providers allow 250 emails per hour. Please upgrade to pro version and use cron job newsletter to send email automatically. Do you still want to continue ?', 'email-subscribe'); ?>"); |
| [2574](#L2574) | if (r == true) { |
| [2575](#L2575) | return true; |
| [2576](#L2576) | } else { |
| [2577](#L2577) | return false; |
| [2578](#L2578) | } |
| [2579](#L2579) |  |
| [2580](#L2580) |  |
| [2581](#L2581) | } |
| [2582](#L2582) | </script> |
| [2583](#L2583) | <?php wp\_nonce\_field('action\_settings\_add\_edit', 'queue\_and\_delete\_subsciber'); ?> |
| [2584](#L2584) | <input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_('Send Email To Selected Subscribers', 'email-subscribe'); ?>' name='sendEmail' class='button-primary' id='sendEmail' >&nbsp;<input onclick="return sendEmailToAll(this)" type='submit' value='<?php echo \_\_('Send Email To All Subscribers', 'email-subscribe'); ?>' name='sendEmailAll' class='button-primary' id='sendEmailAll' >&nbsp;<input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_('Delete Selected Subscribers', 'email-subscribe'); ?>' name='deleteEmails' class='button-primary' id='deleteEmails' ></td> |
| [2585](#L2585) | </tr> |
| [2586](#L2586) |  |
| [2587](#L2587) | <?php |
| [2588](#L2588) | $mass\_email\_queue = get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2589](#L2589) | if ($mass\_email\_queue != false and $mass\_email\_queue != null) { |
| [2590](#L2590) | if (is\_array($mass\_email\_queue)) { |
| [2591](#L2591) | ?> |
| [2592](#L2592) | <tr> |
| [2593](#L2593) | <td> |
| [2594](#L2594) | <h3><?php echo \_\_('Emails In Queue', 'email-subscribe'); ?></h3> |
| [2595](#L2595) | <textarea readonly="readonly" name="queueemails" id="queueemails" cols="70" rows="10"><?php |
| [2596](#L2596) | foreach ($mass\_email\_queue as $email\_) { |
| [2597](#L2597) | echo esc\_attr($email\_) . ",\n"; |
| [2598](#L2598) | } |
| [2599](#L2599) | ?></textarea> |
| [2600](#L2600) | <br/> |
| [2601](#L2601) | <input type="hidden" name="uncheckedemails" id="uncheckedemails" value=""> |
| [2602](#L2602) | <input  type='submit' value='<?php echo \_\_('Send Email To Subscribers In Queue', 'email-subscribe'); ?>' name='sendEmailQueue' class='button-primary' id='sendEmailQueue' >&nbsp;<input  type='submit' value='<?php echo \_\_('Reset Email Queue', 'email-subscribe'); ?>' name='resetemailqueue' class='button-primary' id='resetemailqueue' > |
| [2603](#L2603) | </td> |
| [2604](#L2604) | </tr> |
| [2605](#L2605) | <?php |
| [2606](#L2606) | } |
| [2607](#L2607) | } |
| [2608](#L2608) | ?> |
| [2609](#L2609) | </table> |
| [2610](#L2610) | </form> |
| [2611](#L2611) |  |
| [2612](#L2612) |  |
| [2613](#L2613) | <?php |
| [2614](#L2614) | } else { |
| [2615](#L2615) | echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3>' . \_\_('No Email Subscription Found', 'email-subscribe') . '</h3></div></center>'; |
| [2616](#L2616) |  |
| [2617](#L2617) | //echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3><a href="admin.php?page=email\_subscription\_popup\_subscribers\_management">Click Here To Continue..</a></h3></div></center>'; |
| [2618](#L2618) | ?> |
| [2619](#L2619) | <?php |
| [2620](#L2620) | $exportUrl = plugin\_dir\_url(\_\_FILE\_\_); |
| [2621](#L2621) | $exportUrl .= 'export\_subscribers.php'; |
| [2622](#L2622) | $importUrl = admin\_url('admin.php?page=email\_subscription\_popup\_subscribers\_management&action=importform'); |
| [2623](#L2623) | $subscriberUlr = admin\_url('admin.php?page=email\_subscription\_popup\_subscribers\_management'); |
| [2624](#L2624) | ?> |
| [2625](#L2625) |  |
| [2626](#L2626) | <?php |
| [2627](#L2627) | } |
| [2628](#L2628) | ?> |
| [2629](#L2629) | </div> |
| [2630](#L2630) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [2631](#L2631) |  |
| [2632](#L2632) | <div class="postbox"> |
| [2633](#L2633) | <center><h3 class="hndle"><span></span><?php echo \_\_('Access All Themes In One Price', 'email-subscribe'); ?></h3> </center> |
| [2634](#L2634) | <div class="inside"> |
| [2635](#L2635) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url('images/divi\_300x250.jpg', \_\_FILE\_\_); ?>" width="250" height="250"></a></center> |
| [2636](#L2636) |  |
| [2637](#L2637) | <div style="margin:10px 5px"> |
| [2638](#L2638) |  |
| [2639](#L2639) | </div> |
| [2640](#L2640) | </div></div> |
| [2641](#L2641) | <div class="postbox"> |
| [2642](#L2642) | <center><h3 class="hndle"><span></span><?php echo \_\_('Google For Business', 'email-subscribe'); ?></h3> </center> |
| [2643](#L2643) | <div class="inside"> |
| [2644](#L2644) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url('images/g-suite-promo-code-4.png', \_\_FILE\_\_); ?>" width="" height="250" border="0"></a></center> |
| [2645](#L2645) | <div style="margin:10px 5px"> |
| [2646](#L2646) | </div> |
| [2647](#L2647) | </div></div> |
| [2648](#L2648) |  |
| [2649](#L2649) | </div> |
| [2650](#L2650) | <div class="clear"> |
| [2651](#L2651) | </div> |
| [2652](#L2652) |  |
| [2653](#L2653) | <?php |
| [2654](#L2654) | break; |
| [2655](#L2655) | } |
| [2656](#L2656) | ?> |
| [2657](#L2657) | <script type="text/javascript" > |
| [2658](#L2658) |  |
| [2659](#L2659) | jQuery("input[name='ckboxs[]']").click(function () { |
| [2660](#L2660) | uncheckedmanagement(this); |
| [2661](#L2661) |  |
| [2662](#L2662) | }); |
| [2663](#L2663) |  |
| [2664](#L2664) | function uncheckedmanagement(elementset) { |
| [2665](#L2665) |  |
| [2666](#L2666) | //alert(jQuery(this).is(':checked')); |
| [2667](#L2667) |  |
| [2668](#L2668) | if (jQuery("#uncheckedemails").length > 0) { |
| [2669](#L2669) | var hiddenvals = jQuery("#uncheckedemails").val(); |
| [2670](#L2670) | } else |
| [2671](#L2671) | hiddenvals = "|||"; |
| [2672](#L2672) |  |
| [2673](#L2673) | var emailval = jQuery(elementset).val(); |
| [2674](#L2674) | var emailsUn = hiddenvals.split('|||'); |
| [2675](#L2675) |  |
| [2676](#L2676) | if (jQuery(elementset).is(':checked')) { |
| [2677](#L2677) |  |
| [2678](#L2678) | if (jQuery.isArray(emailsUn) == true) { |
| [2679](#L2679) |  |
| [2680](#L2680) | emailsUn.splice(jQuery.inArray(emailval, emailsUn), 1); |
| [2681](#L2681) | var strconvert = emailsUn.join('|||'); |
| [2682](#L2682) | jQuery("#uncheckedemails").val(strconvert); |
| [2683](#L2683) | } else { |
| [2684](#L2684) |  |
| [2685](#L2685) | var addtohidden = emailval.toString() + '|||'; |
| [2686](#L2686) | jQuery("#uncheckedemails").val(addtohidden); |
| [2687](#L2687) | } |
| [2688](#L2688) |  |
| [2689](#L2689) | } else { |
| [2690](#L2690) |  |
| [2691](#L2691) | if (jQuery.isArray(emailsUn) == true) { |
| [2692](#L2692) |  |
| [2693](#L2693) | if (jQuery.inArray(emailval, emailsUn) <= 0) { |
| [2694](#L2694) | emailsUn.push(emailval); |
| [2695](#L2695) | var strconvert = emailsUn.join('|||'); |
| [2696](#L2696) | jQuery("#uncheckedemails").val(strconvert); |
| [2697](#L2697) | } |
| [2698](#L2698) |  |
| [2699](#L2699) | } else { |
| [2700](#L2700) | var addtohidden = emailval.toString() + '|||'; |
| [2701](#L2701) | jQuery("#uncheckedemails").val(addtohidden); |
| [2702](#L2702) |  |
| [2703](#L2703) | } |
| [2704](#L2704) | } |
| [2705](#L2705) |  |
| [2706](#L2706) |  |
| [2707](#L2707) | } |
| [2708](#L2708) |  |
| [2709](#L2709) | function chkAll(id) { |
| [2710](#L2710) |  |
| [2711](#L2711) | if (id.name == 'chkallfooter') { |
| [2712](#L2712) |  |
| [2713](#L2713) | var chlOrnot = id.checked; |
| [2714](#L2714) | document.getElementById('chkallHeader').checked = chlOrnot; |
| [2715](#L2715) |  |
| [2716](#L2716) | } else if (id.name == 'chkallHeader') { |
| [2717](#L2717) |  |
| [2718](#L2718) | var chlOrnot = id.checked; |
| [2719](#L2719) | document.getElementById('chkallfooter').checked = chlOrnot; |
| [2720](#L2720) |  |
| [2721](#L2721) | } |
| [2722](#L2722) |  |
| [2723](#L2723) | if (id.checked) { |
| [2724](#L2724) |  |
| [2725](#L2725) | var objs = document.getElementsByName("ckboxs[]"); |
| [2726](#L2726) |  |
| [2727](#L2727) | for (var i = 0; i < objs.length; i++) |
| [2728](#L2728) | { |
| [2729](#L2729) | objs[i].checked = true; |
| [2730](#L2730) | uncheckedmanagement(objs[i]); |
| [2731](#L2731) | } |
| [2732](#L2732) |  |
| [2733](#L2733) |  |
| [2734](#L2734) | } else { |
| [2735](#L2735) |  |
| [2736](#L2736) | var objs = document.getElementsByName("ckboxs[]"); |
| [2737](#L2737) |  |
| [2738](#L2738) | for (var i = 0; i < objs.length; i++) |
| [2739](#L2739) | { |
| [2740](#L2740) | objs[i].checked = false; |
| [2741](#L2741) | uncheckedmanagement(objs[i]); |
| [2742](#L2742) | } |
| [2743](#L2743) | } |
| [2744](#L2744) | } |
| [2745](#L2745) |  |
| [2746](#L2746) | function validateSendEmailAndDeleteEmail(idobj) { |
| [2747](#L2747) |  |
| [2748](#L2748) | var objs = document.getElementsByName("ckboxs[]"); |
| [2749](#L2749) | var ischkBoxChecked = false; |
| [2750](#L2750) | for (var i = 0; i < objs.length; i++) { |
| [2751](#L2751) | if (objs[i].checked == true) { |
| [2752](#L2752) |  |
| [2753](#L2753) | ischkBoxChecked = true; |
| [2754](#L2754) | break; |
| [2755](#L2755) | } |
| [2756](#L2756) |  |
| [2757](#L2757) | } |
| [2758](#L2758) |  |
| [2759](#L2759) | if (ischkBoxChecked == false) |
| [2760](#L2760) | { |
| [2761](#L2761) | if (idobj.name == 'sendEmail' || idobj.name == 'sendEmailqueue' || idobj.name == 'exportSelected') { |
| [2762](#L2762) | alert('<?php echo \_\_('Please select atleast one email.', 'email-subscribe'); ?>'); |
| [2763](#L2763) | return false; |
| [2764](#L2764) |  |
| [2765](#L2765) | } else if (idobj.name == 'deleteEmails') |
| [2766](#L2766) | { |
| [2767](#L2767) | alert('<?php echo \_\_('Please select atleast one email to delete.', 'email-subscribe'); ?>') |
| [2768](#L2768) | return false; |
| [2769](#L2769) | } |
| [2770](#L2770) | } else { |
| [2771](#L2771) | if (idobj.name == 'deleteEmails') { |
| [2772](#L2772) |  |
| [2773](#L2773) | var r = confirm("<?php echo \_\_('Are you sure to delete selected subscribers?', 'email-subscribe'); ?>"); |
| [2774](#L2774) | if (r == true) { |
| [2775](#L2775) | return true; |
| [2776](#L2776) | } else { |
| [2777](#L2777) |  |
| [2778](#L2778) | return false; |
| [2779](#L2779) | } |
| [2780](#L2780) |  |
| [2781](#L2781) | } |
| [2782](#L2782) |  |
| [2783](#L2783) | } |
| [2784](#L2784) |  |
| [2785](#L2785) | } |
| [2786](#L2786) |  |
| [2787](#L2787) | </script> |
| [2788](#L2788) |  |
| [2789](#L2789) | <?php |
| [2790](#L2790) | } |
| [2791](#L2791) |  |
| [2792](#L2792) | function email\_subscription\_shortcode\_func(){ |
| [2793](#L2793) | ?> |
| [2794](#L2794) |  |
| [2795](#L2795) | <div id="tab-2" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style=""> |
| [2796](#L2796) | <h3 style="font-size:15px"><?php echo \_\_('Use this shortcode only if you want to print email subscription form separately.', 'email-subscribe'); ?></h3> |
| [2797](#L2797) | <h4>Shortcode</h4> |
| [2798](#L2798) | <input style="text-align:left;height:30px;" onclick="this.focus(); this.select()" value="[print\_email\_subscribe\_form ]"> |
| [2799](#L2799) | <br> |
| [2800](#L2800) | <br> |
| [2801](#L2801) | <div> |
| [2802](#L2802) | <b>Shortcode Params can be</b> |
| [2803](#L2803) | <ul style="list-style-type: circle;padding-left: 50px"> |
| [2804](#L2804) | <li>Heading="Subscribe to our newsletter" </li> |
| [2805](#L2805) | <li>Subheading="Want to be notified when our article is published? Enter your email address and name below to be the first to know."</li> |
| [2806](#L2806) | <li>EmailLabel="Email"</li> |
| [2807](#L2807) | <li>NameLabel="Name"</li> |
| [2808](#L2808) | <li>SubmitButtonLabel="UP FOR NEWSLETTER NOW"</li> |
| [2809](#L2809) | <li>RequiredFieldMessage="This field is required."</li> |
| [2810](#L2810) | <li>InvalidEmailMessage="Please enter valid email address."</li> |
| [2811](#L2811) | <li>InvalidRequestMessage="Invalid request."</li> |
| [2812](#L2812) | <li>EmailExistMessage="This email is already exist."</li> |
| [2813](#L2813) | <li>SuccessMessage="You have successfully subscribed to our Newsletter!"</li> |
| [2814](#L2814) | <li>WaitMessage="Please wait..."</li> |
| [2815](#L2815) | <li>ShowNameField="1"</li> |
| [2816](#L2816) | <li>show\_agreement="0"</li> |
| [2817](#L2817) | <li>agreement\_text="<?php echo htmlentities('I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>');?>"</li> |
| [2818](#L2818) | <li>agreement\_error="Please read and agree to our terms & conditions."</li> |
| [2819](#L2819) | </ul> |
| [2820](#L2820) | </div> |
| [2821](#L2821) |  |
| [2822](#L2822) | </div> |
| [2823](#L2823) | <?php |
| [2824](#L2824) | } |
| [2825](#L2825) |  |
| [2826](#L2826) | function print\_email\_subscribe\_form\_func($instance) { |
| [2827](#L2827) |  |
| [2828](#L2828) | wp\_enqueue\_script('jquery'); |
| [2829](#L2829) |  |
| [2830](#L2830) | ob\_start(); |
| [2831](#L2831) | $Heading = apply\_filters('widget\_title', empty($instance['heading']) ? 'Subscribe to our newsletter' : sanitize\_text\_field($instance['heading'])); |
| [2832](#L2832) | echo "<h2 class='news\_titile\_h2'>" . $Heading . "</h2>"; |
| [2833](#L2833) | $Subheading = empty($instance['subheading']) ? 'Want to be notified when our article is published? Enter your email address and name below to be the first to know.' : sanitize\_textarea\_field($instance['subheading']); |
| [2834](#L2834) | $EmailLabel = empty($instance['emaillabel']) ? 'Email' : sanitize\_text\_field($instance['emaillabel']); |
| [2835](#L2835) | $NameLabel = empty($instance['namelabel']) ? 'Name' : sanitize\_text\_field($instance['namelabel']); |
| [2836](#L2836) | $SubmitButtonLabel = empty($instance['submitbuttonlabel']) ? 'SIGN UP FOR NEWSLETTER NOW' : sanitize\_text\_field($instance['submitbuttonlabel']); |
| [2837](#L2837) | $RequiredFieldMessage = empty($instance['requiredfieldmessage']) ? 'This field is required.' : sanitize\_text\_field($instance['requiredfieldmessage']); |
| [2838](#L2838) | $InvalidEmailMessage = empty($instance['invalidemailmessage']) ? 'Please enter valid email address.' : sanitize\_text\_field($instance['invalidemailmessage']); |
| [2839](#L2839) | $InvalidRequestMessage = empty($instance['invalidrequestmessage']) ? 'Invalid request.' : sanitize\_text\_field($instance['invalidrequestmessage']); |
| [2840](#L2840) | $EmailExistMessage = empty($instance['emailexistmessage']) ? 'This email is already exist.' : sanitize\_text\_field($instance['emailexistmessage']); |
| [2841](#L2841) | $SuccessMessage = empty($instance['successmessage']) ? 'You have successfully subscribed to our Newsletter!' : sanitize\_text\_field($instance['successmessage']); |
| [2842](#L2842) | $WaitMessage = empty($instance['waitmessage']) ? 'Please wait...' : sanitize\_text\_field($instance['waitmessage']); |
| [2843](#L2843) | $ShowNameField = empty($instance['shownamefield']) ? 1 : intval($instance['shownamefield']); |
| [2844](#L2844) | $show\_agreement = empty($instance['show\_agreement']) ? 0 : intval($instance['show\_agreement']); |
| [2845](#L2845) | $agreement\_text = empty($instance['agreement\_text']) ? 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>' : $instance['agreement\_text']; |
| [2846](#L2846) | $agreement\_error = empty($instance['agreement\_error']) ? 'Please read and agree to our terms & conditions.' : sanitize\_text\_field($instance['agreement\_error']); |
| [2847](#L2847) | $imgUrl = plugin\_dir\_url(\_\_FILE\_\_) . "images/"; |
| [2848](#L2848) | $loader = $imgUrl . 'AjaxLoader.gif'; |
| [2849](#L2849) | $rand = uniqid('filed\_'); |
| [2850](#L2850) | $rand\_func = uniqid('fun'); |
| [2851](#L2851) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [2852](#L2852) | $wp\_news\_letter\_settings = stripslashes\_deep($wp\_news\_letter\_settings); |
| [2853](#L2853) | ?> |
| [2854](#L2854) |  |
| [2855](#L2855) | <div class="<?php echo $rand; ?>\_AjaxLoader ajaxLoaderWidget"  id="<?php echo $rand; ?>\_AjaxLoader"><img src="<?php echo $loader; ?>"/><?php echo $WaitMessage; ?></div> |
| [2856](#L2856) | <div class="<?php echo $rand; ?>\_myerror\_msg myerror\_msg" id="<?php echo $rand; ?>\_myerror\_msg"></div> |
| [2857](#L2857) | <div class="<?php echo $rand; ?>\_mysuccess\_msg mysuccess\_msg" id="<?php echo $rand; ?>\_mysuccess\_msg"></div> |
| [2858](#L2858) | <div class="Nknewsletter\_description"><?php echo $Subheading; ?></div> |
| [2859](#L2859) | <div class="Nknewsletter-widget"> |
| [2860](#L2860) | <input type="text" name="<?php echo $rand; ?>\_youremail" id="<?php echo $rand; ?>\_youremail" class="Nknewsletter\_email"  value="<?php echo $EmailLabel; ?>" onfocus="return clearInput(this, '<?php echo $EmailLabel; ?>');" onblur="restoreInput(this, '<?php echo $EmailLabel; ?>')"/> |
| [2861](#L2861) | <div class="" id="<?php echo $rand; ?>\_errorinput\_email"></div> |
| [2862](#L2862) |  |
| [2863](#L2863) | <?php if ($ShowNameField == "1"): ?> |
| [2864](#L2864) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [2865](#L2865) | <input type="text" name="<?php echo $rand; ?>\_yourname" id="<?php echo $rand; ?>\_yourname" class="Nknewsletter\_name" value="<?php echo $NameLabel; ?>" onfocus="return clearInput(this, '<?php echo $NameLabel; ?>');" onblur="restoreInput(this, '<?php echo $NameLabel; ?>')" /> |
| [2866](#L2866) | <div class="errorinput\_widget" id="<?php echo $rand; ?>\_errorinput\_name"></div> |
| [2867](#L2867) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [2868](#L2868) | <?php else: ?> |
| [2869](#L2869) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [2870](#L2870) | <?php endif; ?> |
| [2871](#L2871) |  |
| [2872](#L2872) | <?php if ($show\_agreement == "1"): ?> |
| [2873](#L2873) | <input class="nk\_newsletter\_agree" style="display:inline-block" type="checkbox"  id="<?php echo $rand; ?>\_agree" value="1" name="<?php echo $rand; ?>\_agree" /><span class="nk\_newslteer\_agree\_term"> <?php echo html\_entity\_decode($agreement\_text); ?></span> |
| [2874](#L2874) | <div style="clear:both"></div> |
| [2875](#L2875) | <div class="errorinput\_widget" id="<?php echo $rand; ?>\_errorinput\_agree"></div> |
| [2876](#L2876) |  |
| [2877](#L2877) | <?php else: ?> |
| [2878](#L2878) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_agree\_Nknewsletter\_space" ></div> |
| [2879](#L2879) | <?php endif; ?> |
| [2880](#L2880) |  |
| [2881](#L2881) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>submit\_space" ></div> |
| [2882](#L2882) | <input class="Nknewsletter\_space\_submit" type="submit" value="<?php echo $SubmitButtonLabel; ?>" onclick="return <?php echo $rand\_func; ?>\_submit\_newsletter();" name="<?php echo $rand; ?>\_submit" /> |
| [2883](#L2883) | </div> |
| [2884](#L2884) | <script> |
| [2885](#L2885) |  |
| [2886](#L2886) | function <?php echo $rand\_func; ?>\_submit\_newsletter() { |
| [2887](#L2887) |  |
| [2888](#L2888) |  |
| [2889](#L2889) | var emailAdd = jQuery.trim(jQuery("#<?php echo $rand; ?>\_youremail").val()); |
| [2890](#L2890) | var yourname = jQuery.trim(jQuery("#<?php echo $rand; ?>\_yourname").val()); |
| [2891](#L2891) |  |
| [2892](#L2892) | var returnval = false; |
| [2893](#L2893) | var isvalidName = false; |
| [2894](#L2894) | var isvalidEmail = false; |
| [2895](#L2895) | var isagree = false; |
| [2896](#L2896) |  |
| [2897](#L2897) | if (jQuery("#<?php echo $rand; ?>\_yourname").length > 0) { |
| [2898](#L2898) |  |
| [2899](#L2899) |  |
| [2900](#L2900) | var yourname = jQuery.trim(jQuery("#<?php echo $rand; ?>\_yourname").val()); |
| [2901](#L2901) |  |
| [2902](#L2902) | if (yourname != "" && yourname != null && yourname.toLowerCase() != '<?php echo $NameLabel; ?>'.toLowerCase()) { |
| [2903](#L2903) |  |
| [2904](#L2904) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [2905](#L2905) | isvalidName = true; |
| [2906](#L2906) | jQuery(element).html(''); |
| [2907](#L2907) | } else { |
| [2908](#L2908) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [2909](#L2909) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [2910](#L2910) | jQuery("#<?php echo $rand; ?>\_name\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [2911](#L2911) | // emailAdd=false; |
| [2912](#L2912) |  |
| [2913](#L2913) | } |
| [2914](#L2914) |  |
| [2915](#L2915) |  |
| [2916](#L2916) | } else { |
| [2917](#L2917) | isvalidName = true; |
| [2918](#L2918) |  |
| [2919](#L2919) | } |
| [2920](#L2920) |  |
| [2921](#L2921) | if (jQuery("#<?php echo $rand; ?>\_agree").length > 0) { |
| [2922](#L2922) |  |
| [2923](#L2923) | if (jQuery("#<?php echo $rand; ?>\_agree").is(':checked')) { |
| [2924](#L2924) |  |
| [2925](#L2925) | var element = jQuery("#<?php echo $rand; ?>\_agree").next().next(); |
| [2926](#L2926) | jQuery(element).html(''); |
| [2927](#L2927) | isagree = true; |
| [2928](#L2928) | } else { |
| [2929](#L2929) |  |
| [2930](#L2930) |  |
| [2931](#L2931) | var element = jQuery("#<?php echo $rand; ?>\_agree").next().next(); |
| [2932](#L2932) | jQuery(element).html('<div class="image\_error"><?php echo $agreement\_error; ?></div>'); |
| [2933](#L2933) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [2934](#L2934) | isagree = false; |
| [2935](#L2935) |  |
| [2936](#L2936) | } |
| [2937](#L2937) | } else { |
| [2938](#L2938) |  |
| [2939](#L2939) | isagree = true; |
| [2940](#L2940) |  |
| [2941](#L2941) | } |
| [2942](#L2942) |  |
| [2943](#L2943) |  |
| [2944](#L2944) | if (emailAdd != "") { |
| [2945](#L2945) |  |
| [2946](#L2946) |  |
| [2947](#L2947) | var element = jQuery("#<?php echo $rand; ?>\_youremail").next().next(); |
| [2948](#L2948) | if (emailAdd.toLowerCase() == '<?php echo $EmailLabel; ?>'.toLowerCase()) { |
| [2949](#L2949) |  |
| [2950](#L2950) | jQuery(element).html('<div  class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [2951](#L2951) | isvalidEmail = false; |
| [2952](#L2952) |  |
| [2953](#L2953) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [2954](#L2954) |  |
| [2955](#L2955) | } else { |
| [2956](#L2956) |  |
| [2957](#L2957) | var JsRegExPatern = /^\w+([-+.']\w+)\*@\w+([-.]\w+)\*\.\w+([-.]\w+)\*$/ |
| [2958](#L2958) | if (JsRegExPatern.test(emailAdd)) { |
| [2959](#L2959) |  |
| [2960](#L2960) | isvalidEmail = true; |
| [2961](#L2961) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [2962](#L2962) | jQuery(element).html(''); |
| [2963](#L2963) |  |
| [2964](#L2964) | } else { |
| [2965](#L2965) |  |
| [2966](#L2966) | var element = jQuery("#<?php echo $rand; ?>\_youremail").next().next(); |
| [2967](#L2967) | jQuery(element).html('<div class="image\_error"><?php echo $InvalidEmailMessage; ?></div>'); |
| [2968](#L2968) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [2969](#L2969) | isvalidEmail = false; |
| [2970](#L2970) |  |
| [2971](#L2971) | } |
| [2972](#L2972) |  |
| [2973](#L2973) | } |
| [2974](#L2974) |  |
| [2975](#L2975) | } else { |
| [2976](#L2976) |  |
| [2977](#L2977) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [2978](#L2978) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [2979](#L2979) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [2980](#L2980) | isvalidEmail = false; |
| [2981](#L2981) |  |
| [2982](#L2982) | } |
| [2983](#L2983) |  |
| [2984](#L2984) | if (isvalidName == true && isvalidEmail == true && isagree == true) { |
| [2985](#L2985) |  |
| [2986](#L2986) | jQuery("#<?php echo $rand; ?>\_name\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [2987](#L2987) | jQuery("<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [2988](#L2988) |  |
| [2989](#L2989) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").show(); |
| [2990](#L2990) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').html(''); |
| [2991](#L2991) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').hide(); |
| [2992](#L2992) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(''); |
| [2993](#L2993) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').hide(); |
| [2994](#L2994) |  |
| [2995](#L2995) | var nonce = '<?php echo wp\_create\_nonce('newsletter-nonce'); ?>'; |
| [2996](#L2996) | var url = '<?php echo plugin\_dir\_url(\_\_FILE\_\_); ?>'; |
| [2997](#L2997) | var email = jQuery("#<?php echo $rand; ?>\_youremail").val(); |
| [2998](#L2998) | var name = ""; |
| [2999](#L2999) | if (jQuery("#<?php echo $rand; ?>\_yourname").length > 0) { |
| [3000](#L3000) |  |
| [3001](#L3001) | name = jQuery("#<?php echo $rand; ?>\_yourname").val(); |
| [3002](#L3002) | } |
| [3003](#L3003) | var str = "action=store\_email&email=" + email + '&name=' + name + '&is\_agreed=' + isagree + '&sec\_string=' + nonce; |
| [3004](#L3004) | jQuery.ajax({ |
| [3005](#L3005) | type: "POST", |
| [3006](#L3006) | url: '<?php echo admin\_url('admin-ajax.php'); ?>', |
| [3007](#L3007) | data: str, |
| [3008](#L3008) | async: true, |
| [3009](#L3009) | success: function (msg) { |
| [3010](#L3010) | if (msg != '') { |
| [3011](#L3011) |  |
| [3012](#L3012) | var result = msg.split("|"); |
| [3013](#L3013) | if (result[0] == 'success') { |
| [3014](#L3014) |  |
| [3015](#L3015) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").hide(); |
| [3016](#L3016) | jQuery('.<?php echo $rand; ?>\_mysuccess\_msg').html(result[1]); |
| [3017](#L3017) | jQuery('.<?php echo $rand; ?>\_mysuccess\_msg').show(); |
| [3018](#L3018) | setTimeout(function () { |
| [3019](#L3019) |  |
| [3020](#L3020) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').hide(); |
| [3021](#L3021) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').html(''); |
| [3022](#L3022) | jQuery("#<?php echo $rand; ?>\_youremail").val('<?php echo $EmailLabel; ?>'); |
| [3023](#L3023) | jQuery("#<?php echo $rand; ?>\_yourname").val('<?php echo $NameLabel; ?>'); |
| [3024](#L3024) |  |
| [3025](#L3025) |  |
| [3026](#L3026) | }, 2000); |
| [3027](#L3027) |  |
| [3028](#L3028) |  |
| [3029](#L3029) |  |
| [3030](#L3030) |  |
| [3031](#L3031) | } else { |
| [3032](#L3032) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").hide(); |
| [3033](#L3033) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(result[1]); |
| [3034](#L3034) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').show(); |
| [3035](#L3035) | setTimeout(function () { |
| [3036](#L3036) |  |
| [3037](#L3037) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').hide(); |
| [3038](#L3038) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(''); |
| [3039](#L3039) |  |
| [3040](#L3040) |  |
| [3041](#L3041) |  |
| [3042](#L3042) |  |
| [3043](#L3043) | }, 2000); |
| [3044](#L3044) |  |
| [3045](#L3045) | } |
| [3046](#L3046) |  |
| [3047](#L3047) | } |
| [3048](#L3048) |  |
| [3049](#L3049) | } |
| [3050](#L3050) | }); |
| [3051](#L3051) |  |
| [3052](#L3052) | } |
| [3053](#L3053) |  |
| [3054](#L3054) |  |
| [3055](#L3055) |  |
| [3056](#L3056) |  |
| [3057](#L3057) |  |
| [3058](#L3058) | } |
| [3059](#L3059) | </script> |
| [3060](#L3060) | <style> |
| [3061](#L3061) | <?php echo html\_entity\_decode($wp\_news\_letter\_settings['additional\_css'], ENT\_QUOTES); ?> |
| [3062](#L3062) | </style> |
| [3063](#L3063) | <?php |
| [3064](#L3064) | $output = ob\_get\_clean(); |
| [3065](#L3065) | return $output; |
| [3066](#L3066) | } |
| [3067](#L3067) |  |
| [3068](#L3068) | class nksnewslettersubscriber extends WP\_Widget { |
| [3069](#L3069) |  |
| [3070](#L3070) | function \_\_construct() { |
| [3071](#L3071) |  |
| [3072](#L3072) | $widget\_ops = array('classname' => 'nksnewslettersubscriber', 'description' => 'Nks WordPress Newsletter'); |
| [3073](#L3073) | parent::\_\_construct('nksnewslettersubscriber', 'Newsletter Subscribe', $widget\_ops); |
| [3074](#L3074) | } |
| [3075](#L3075) |  |
| [3076](#L3076) | function widget($args, $instance) { |
| [3077](#L3077) |  |
| [3078](#L3078) | if (is\_array($args)) { |
| [3079](#L3079) |  |
| [3080](#L3080) | extract($args); |
| [3081](#L3081) | } |
| [3082](#L3082) |  |
| [3083](#L3083) | $Heading = apply\_filters('widget\_title', empty($instance['Heading']) ? 'Subscribe to our newsletter' : sanitize\_text\_field($instance['Heading'])); |
| [3084](#L3084) | include\_once(ABSPATH . WPINC . '/feed.php'); |
| [3085](#L3085) | echo @$before\_widget; |
| [3086](#L3086) | echo @$before\_title . $Heading . $after\_title; |
| [3087](#L3087) | $Subheading = empty($instance['Subheading']) ? 'Want to be notified when our article is published? Enter your email address and name below to be the first to know.' : sanitize\_textarea\_field($instance['Subheading']); |
| [3088](#L3088) | $EmailLabel = empty($instance['EmailLabel']) ? 'Email' : sanitize\_text\_field($instance['EmailLabel']); |
| [3089](#L3089) | $NameLabel = empty($instance['NameLabel']) ? 'Name' : sanitize\_text\_field($instance['NameLabel']); |
| [3090](#L3090) | $SubmitButtonLabel = empty($instance['SubmitButtonLabel']) ? 'SIGN UP FOR NEWSLETTER NOW' : sanitize\_text\_field($instance['SubmitButtonLabel']); |
| [3091](#L3091) | $RequiredFieldMessage = empty($instance['RequiredFieldMessage']) ? 'This field is required.' : sanitize\_text\_field($instance['RequiredFieldMessage']); |
| [3092](#L3092) | $InvalidEmailMessage = empty($instance['InvalidEmailMessage']) ? 'Please enter valid email address.' : sanitize\_text\_field($instance['InvalidEmailMessage']); |
| [3093](#L3093) | $InvalidRequestMessage = empty($instance['InvalidRequestMessage']) ? 'Invalid request.' : sanitize\_text\_field($instance['InvalidRequestMessage']); |
| [3094](#L3094) | $EmailExistMessage = empty($instance['EmailExistMessage']) ? 'This email is already exist.' : sanitize\_text\_field($instance['EmailExistMessage']); |
| [3095](#L3095) | $SuccessMessage = empty($instance['SuccessMessage']) ? 'You have successfully subscribed to our Newsletter!' : sanitize\_text\_field($instance['SuccessMessage']); |
| [3096](#L3096) | $WaitMessage = empty($instance['WaitMessage']) ? 'Please wait...' : sanitize\_text\_field($instance['WaitMessage']); |
| [3097](#L3097) | $ShowNameField = empty($instance['ShowNameField']) ? 1 : intval($instance['ShowNameField']); |
| [3098](#L3098) | $show\_agreement = empty($instance['show\_agreement']) ? 0 : intval($instance['show\_agreement']); |
| [3099](#L3099) | $agreement\_text = empty($instance['agreement\_text']) ? 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>' : $instance['agreement\_text']; |
| [3100](#L3100) | $agreement\_error = empty($instance['agreement\_error']) ? 'Please read and agree to our terms & conditions.' : sanitize\_text\_field($instance['agreement\_error']); |
| [3101](#L3101) | $imgUrl = plugin\_dir\_url(\_\_FILE\_\_) . "images/"; |
| [3102](#L3102) | $loader = $imgUrl . 'AjaxLoader.gif'; |
| [3103](#L3103) | $rand = uniqid('filed\_'); |
| [3104](#L3104) | $rand\_func = uniqid('fun'); |
| [3105](#L3105) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [3106](#L3106) | $wp\_news\_letter\_settings = stripslashes\_deep($wp\_news\_letter\_settings); |
| [3107](#L3107) | ?> |
| [3108](#L3108) |  |
| [3109](#L3109) | <div class="<?php echo $rand; ?>\_AjaxLoader ajaxLoaderWidget"  id="<?php echo $rand; ?>\_AjaxLoader"><img src="<?php echo $loader; ?>"/><?php echo $WaitMessage; ?></div> |
| [3110](#L3110) | <div class="<?php echo $rand; ?>\_myerror\_msg myerror\_msg" id="<?php echo $rand; ?>\_myerror\_msg"></div> |
| [3111](#L3111) | <div class="<?php echo $rand; ?>\_mysuccess\_msg mysuccess\_msg" id="<?php echo $rand; ?>\_mysuccess\_msg"></div> |
| [3112](#L3112) | <div class="Nknewsletter\_description"><?php echo $Subheading; ?></div> |
| [3113](#L3113) | <div class="Nknewsletter-widget"> |
| [3114](#L3114) | <input type="text" name="<?php echo $rand; ?>\_youremail" id="<?php echo $rand; ?>\_youremail" class="Nknewsletter\_email"  value="<?php echo $EmailLabel; ?>" onfocus="return clearInput(this, '<?php echo $EmailLabel; ?>');" onblur="restoreInput(this, '<?php echo $EmailLabel; ?>')"/> |
| [3115](#L3115) | <div class="" id="<?php echo $rand; ?>\_errorinput\_email"></div> |
| [3116](#L3116) |  |
| [3117](#L3117) | <?php if ($ShowNameField == "1"): ?> |
| [3118](#L3118) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [3119](#L3119) | <input type="text" name="<?php echo $rand; ?>\_yourname" id="<?php echo $rand; ?>\_yourname" class="Nknewsletter\_name" value="<?php echo $NameLabel; ?>" onfocus="return clearInput(this, '<?php echo $NameLabel; ?>');" onblur="restoreInput(this, '<?php echo $NameLabel; ?>')" /> |
| [3120](#L3120) | <div class="errorinput\_widget" id="<?php echo $rand; ?>\_errorinput\_name"></div> |
| [3121](#L3121) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [3122](#L3122) | <?php else: ?> |
| [3123](#L3123) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_name\_Nknewsletter\_space" ></div> |
| [3124](#L3124) | <?php endif; ?> |
| [3125](#L3125) |  |
| [3126](#L3126) | <?php if ($show\_agreement == "1"): ?> |
| [3127](#L3127) | <input class="nk\_newsletter\_agree" style="display:inline-block" type="checkbox"  id="<?php echo $rand; ?>\_agree" value="1" name="<?php echo $rand; ?>\_agree" /><span class="nk\_newslteer\_agree\_term"> <?php echo html\_entity\_decode($agreement\_text); ?></span> |
| [3128](#L3128) | <div style="clear:both"></div> |
| [3129](#L3129) | <div class="errorinput\_widget" id="<?php echo $rand; ?>\_errorinput\_agree"></div> |
| [3130](#L3130) |  |
| [3131](#L3131) | <?php else: ?> |
| [3132](#L3132) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>\_agree\_Nknewsletter\_space" ></div> |
| [3133](#L3133) | <?php endif; ?> |
| [3134](#L3134) |  |
| [3135](#L3135) | <div class="Nknewsletter\_space" id="<?php echo $rand; ?>submit\_space" ></div> |
| [3136](#L3136) | <input class="Nknewsletter\_space\_submit" type="submit" value="<?php echo $SubmitButtonLabel; ?>" onclick="return <?php echo $rand\_func; ?>\_submit\_newsletter();" name="<?php echo $rand; ?>\_submit" /> |
| [3137](#L3137) | </div> |
| [3138](#L3138) | <script> |
| [3139](#L3139) |  |
| [3140](#L3140) | function <?php echo $rand\_func; ?>\_submit\_newsletter() { |
| [3141](#L3141) |  |
| [3142](#L3142) |  |
| [3143](#L3143) | var emailAdd = jQuery.trim(jQuery("#<?php echo $rand; ?>\_youremail").val()); |
| [3144](#L3144) | var yourname = jQuery.trim(jQuery("#<?php echo $rand; ?>\_yourname").val()); |
| [3145](#L3145) |  |
| [3146](#L3146) | var returnval = false; |
| [3147](#L3147) | var isvalidName = false; |
| [3148](#L3148) | var isvalidEmail = false; |
| [3149](#L3149) | var isagree = false; |
| [3150](#L3150) |  |
| [3151](#L3151) | if (jQuery("#<?php echo $rand; ?>\_yourname").length > 0) { |
| [3152](#L3152) |  |
| [3153](#L3153) |  |
| [3154](#L3154) | var yourname = jQuery.trim(jQuery("#<?php echo $rand; ?>\_yourname").val()); |
| [3155](#L3155) |  |
| [3156](#L3156) | if (yourname != "" && yourname != null && yourname.toLowerCase() != '<?php echo $NameLabel; ?>'.toLowerCase()) { |
| [3157](#L3157) |  |
| [3158](#L3158) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [3159](#L3159) | isvalidName = true; |
| [3160](#L3160) | jQuery(element).html(''); |
| [3161](#L3161) | } else { |
| [3162](#L3162) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [3163](#L3163) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [3164](#L3164) | jQuery("#<?php echo $rand; ?>\_name\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [3165](#L3165) | // emailAdd=false; |
| [3166](#L3166) |  |
| [3167](#L3167) | } |
| [3168](#L3168) |  |
| [3169](#L3169) |  |
| [3170](#L3170) | } else { |
| [3171](#L3171) | isvalidName = true; |
| [3172](#L3172) |  |
| [3173](#L3173) | } |
| [3174](#L3174) |  |
| [3175](#L3175) | if (jQuery("#<?php echo $rand; ?>\_agree").length > 0) { |
| [3176](#L3176) |  |
| [3177](#L3177) | if (jQuery("#<?php echo $rand; ?>\_agree").is(':checked')) { |
| [3178](#L3178) |  |
| [3179](#L3179) | var element = jQuery("#<?php echo $rand; ?>\_agree").next().next(); |
| [3180](#L3180) | jQuery(element).html(''); |
| [3181](#L3181) | isagree = true; |
| [3182](#L3182) | } else { |
| [3183](#L3183) |  |
| [3184](#L3184) |  |
| [3185](#L3185) | var element = jQuery("#<?php echo $rand; ?>\_agree").next().next(); |
| [3186](#L3186) | jQuery(element).html('<div class="image\_error"><?php echo $agreement\_error; ?></div>'); |
| [3187](#L3187) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [3188](#L3188) | isagree = false; |
| [3189](#L3189) |  |
| [3190](#L3190) | } |
| [3191](#L3191) | } else { |
| [3192](#L3192) |  |
| [3193](#L3193) | isagree = true; |
| [3194](#L3194) |  |
| [3195](#L3195) | } |
| [3196](#L3196) |  |
| [3197](#L3197) |  |
| [3198](#L3198) | if (emailAdd != "") { |
| [3199](#L3199) |  |
| [3200](#L3200) |  |
| [3201](#L3201) | var element = jQuery("#<?php echo $rand; ?>\_youremail").next().next(); |
| [3202](#L3202) | if (emailAdd.toLowerCase() == '<?php echo $EmailLabel; ?>'.toLowerCase()) { |
| [3203](#L3203) |  |
| [3204](#L3204) | jQuery(element).html('<div  class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [3205](#L3205) | isvalidEmail = false; |
| [3206](#L3206) |  |
| [3207](#L3207) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [3208](#L3208) |  |
| [3209](#L3209) | } else { |
| [3210](#L3210) |  |
| [3211](#L3211) | var JsRegExPatern = /^\w+([-+.']\w+)\*@\w+([-.]\w+)\*\.\w+([-.]\w+)\*$/ |
| [3212](#L3212) | if (JsRegExPatern.test(emailAdd)) { |
| [3213](#L3213) |  |
| [3214](#L3214) | isvalidEmail = true; |
| [3215](#L3215) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [3216](#L3216) | jQuery(element).html(''); |
| [3217](#L3217) |  |
| [3218](#L3218) | } else { |
| [3219](#L3219) |  |
| [3220](#L3220) | var element = jQuery("#<?php echo $rand; ?>\_youremail").next().next(); |
| [3221](#L3221) | jQuery(element).html('<div class="image\_error"><?php echo $InvalidEmailMessage; ?></div>'); |
| [3222](#L3222) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [3223](#L3223) | isvalidEmail = false; |
| [3224](#L3224) |  |
| [3225](#L3225) | } |
| [3226](#L3226) |  |
| [3227](#L3227) | } |
| [3228](#L3228) |  |
| [3229](#L3229) | } else { |
| [3230](#L3230) |  |
| [3231](#L3231) | var element = jQuery("#<?php echo $rand; ?>\_yourname").next().next(); |
| [3232](#L3232) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage; ?></div>'); |
| [3233](#L3233) | jQuery("#<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "0px"}); |
| [3234](#L3234) | isvalidEmail = false; |
| [3235](#L3235) |  |
| [3236](#L3236) | } |
| [3237](#L3237) |  |
| [3238](#L3238) | if (isvalidName == true && isvalidEmail == true && isagree == true) { |
| [3239](#L3239) |  |
| [3240](#L3240) | jQuery("#<?php echo $rand; ?>\_name\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [3241](#L3241) | jQuery("<?php echo $rand; ?>\_email\_Nknewsletter\_space").css({marginBottom: "20px"}); |
| [3242](#L3242) |  |
| [3243](#L3243) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").show(); |
| [3244](#L3244) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').html(''); |
| [3245](#L3245) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').hide(); |
| [3246](#L3246) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(''); |
| [3247](#L3247) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').hide(); |
| [3248](#L3248) |  |
| [3249](#L3249) | var nonce = '<?php echo wp\_create\_nonce('newsletter-nonce'); ?>'; |
| [3250](#L3250) | var url = '<?php echo plugin\_dir\_url(\_\_FILE\_\_); ?>'; |
| [3251](#L3251) | var email = jQuery("#<?php echo $rand; ?>\_youremail").val(); |
| [3252](#L3252) | var name = ""; |
| [3253](#L3253) | if (jQuery("#<?php echo $rand; ?>\_yourname").length > 0) { |
| [3254](#L3254) |  |
| [3255](#L3255) | name = jQuery("#<?php echo $rand; ?>\_yourname").val(); |
| [3256](#L3256) | } |
| [3257](#L3257) | var str = "action=store\_email&email=" + email + '&name=' + name + '&is\_agreed=' + isagree + '&sec\_string=' + nonce; |
| [3258](#L3258) | jQuery.ajax({ |
| [3259](#L3259) | type: "POST", |
| [3260](#L3260) | url: '<?php echo admin\_url('admin-ajax.php'); ?>', |
| [3261](#L3261) | data: str, |
| [3262](#L3262) | async: true, |
| [3263](#L3263) | success: function (msg) { |
| [3264](#L3264) | if (msg != '') { |
| [3265](#L3265) |  |
| [3266](#L3266) | var result = msg.split("|"); |
| [3267](#L3267) | if (result[0] == 'success') { |
| [3268](#L3268) |  |
| [3269](#L3269) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").hide(); |
| [3270](#L3270) | jQuery('.<?php echo $rand; ?>\_mysuccess\_msg').html(result[1]); |
| [3271](#L3271) | jQuery('.<?php echo $rand; ?>\_mysuccess\_msg').show(); |
| [3272](#L3272) | setTimeout(function () { |
| [3273](#L3273) |  |
| [3274](#L3274) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').hide(); |
| [3275](#L3275) | jQuery('#<?php echo $rand; ?>\_mysuccess\_msg').html(''); |
| [3276](#L3276) | jQuery("#<?php echo $rand; ?>\_youremail").val('<?php echo $EmailLabel; ?>'); |
| [3277](#L3277) | jQuery("#<?php echo $rand; ?>\_yourname").val('<?php echo $NameLabel; ?>'); |
| [3278](#L3278) |  |
| [3279](#L3279) |  |
| [3280](#L3280) | }, 2000); |
| [3281](#L3281) |  |
| [3282](#L3282) |  |
| [3283](#L3283) |  |
| [3284](#L3284) |  |
| [3285](#L3285) | } else { |
| [3286](#L3286) | jQuery("#<?php echo $rand; ?>\_AjaxLoader").hide(); |
| [3287](#L3287) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(result[1]); |
| [3288](#L3288) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').show(); |
| [3289](#L3289) | setTimeout(function () { |
| [3290](#L3290) |  |
| [3291](#L3291) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').hide(); |
| [3292](#L3292) | jQuery('#<?php echo $rand; ?>\_myerror\_msg').html(''); |
| [3293](#L3293) |  |
| [3294](#L3294) |  |
| [3295](#L3295) |  |
| [3296](#L3296) |  |
| [3297](#L3297) | }, 2000); |
| [3298](#L3298) |  |
| [3299](#L3299) | } |
| [3300](#L3300) |  |
| [3301](#L3301) | } |
| [3302](#L3302) |  |
| [3303](#L3303) | } |
| [3304](#L3304) | }); |
| [3305](#L3305) |  |
| [3306](#L3306) | } |
| [3307](#L3307) |  |
| [3308](#L3308) |  |
| [3309](#L3309) |  |
| [3310](#L3310) |  |
| [3311](#L3311) |  |
| [3312](#L3312) | } |
| [3313](#L3313) | </script> |
| [3314](#L3314) | <style> |
| [3315](#L3315) | <?php echo html\_entity\_decode($wp\_news\_letter\_settings['additional\_css'], ENT\_QUOTES); ?> |
| [3316](#L3316) | </style> |
| [3317](#L3317) | <?php |
| [3318](#L3318) | echo $after\_widget; |
| [3319](#L3319) | } |
| [3320](#L3320) |  |
| [3321](#L3321) | function update($new\_instance, $old\_instance) { |
| [3322](#L3322) |  |
| [3323](#L3323) |  |
| [3324](#L3324) | $instance = $old\_instance; |
| [3325](#L3325) | $instance['Heading'] = sanitize\_text\_field($new\_instance['Heading']); |
| [3326](#L3326) | $instance['Subheading'] = sanitize\_textarea\_field($new\_instance['Subheading']); |
| [3327](#L3327) | $instance['EmailLabel'] = sanitize\_text\_field($new\_instance['EmailLabel']); |
| [3328](#L3328) | $instance['NameLabel'] = sanitize\_text\_field($new\_instance['NameLabel']); |
| [3329](#L3329) | $instance['SubmitButtonLabel'] = sanitize\_text\_field($new\_instance['SubmitButtonLabel']); |
| [3330](#L3330) | $instance['RequiredFieldMessage'] = sanitize\_text\_field($new\_instance['RequiredFieldMessage']); |
| [3331](#L3331) | $instance['InvalidEmailMessage'] = sanitize\_text\_field($new\_instance['InvalidEmailMessage']); |
| [3332](#L3332) | $instance['InvalidRequestMessage'] = sanitize\_text\_field($new\_instance['InvalidRequestMessage']); |
| [3333](#L3333) | $instance['EmailExistMessage'] = sanitize\_text\_field($new\_instance['EmailExistMessage']); |
| [3334](#L3334) | $instance['SuccessMessage'] = sanitize\_text\_field($new\_instance['SuccessMessage']); |
| [3335](#L3335) | $instance['WaitMessage'] = sanitize\_text\_field($new\_instance['WaitMessage']); |
| [3336](#L3336) | $instance['ShowNameField'] = intval($new\_instance['ShowNameField']); |
| [3337](#L3337) | $instance['show\_agreement'] = isset($new\_instance['show\_agreement']) ? intval($new\_instance['show\_agreement']) : 0; |
| [3338](#L3338) | $instance['agreement\_text'] = trim(strip\_tags(stripslashes($new\_instance['agreement\_text']), '<a><b><p><strong><em><i>')); |
| [3339](#L3339) | $instance['agreement\_error'] = sanitize\_text\_field($new\_instance['agreement\_error']); |
| [3340](#L3340) |  |
| [3341](#L3341) | return $instance; |
| [3342](#L3342) | } |
| [3343](#L3343) |  |
| [3344](#L3344) | function form($instance) { |
| [3345](#L3345) |  |
| [3346](#L3346) | //Defaults |
| [3347](#L3347) | $instance = wp\_parse\_args((array) $instance, array( |
| [3348](#L3348) | 'Heading' => 'Subscribe to our newsletter', |
| [3349](#L3349) | 'Subheading' => 'Want to be notified when our article is published? Enter your email address and name below to be the first to know.', |
| [3350](#L3350) | 'EmailLabel' => 'Email', |
| [3351](#L3351) | 'NameLabel' => 'Name', |
| [3352](#L3352) | 'SubmitButtonLabel' => 'SIGN UP FOR NEWSLETTER NOW', |
| [3353](#L3353) | 'RequiredFieldMessage' => 'This field is required.', |
| [3354](#L3354) | 'InvalidEmailMessage' => 'Please enter valid email address.', |
| [3355](#L3355) | 'InvalidRequestMessage' => 'Invalid request.', |
| [3356](#L3356) | 'EmailExistMessage' => 'This email is already exist.', |
| [3357](#L3357) | 'SuccessMessage' => 'You have successfully subscribed to our Newsletter!', |
| [3358](#L3358) | 'WaitMessage' => 'Please wait...', |
| [3359](#L3359) | 'ShowNameField' => "1", |
| [3360](#L3360) | 'show\_agreement' => '1', |
| [3361](#L3361) | 'agreement\_text' => 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>', |
| [3362](#L3362) | 'agreement\_error' => 'Please read and agree to our terms & conditions.', |
| [3363](#L3363) | ) |
| [3364](#L3364) | ); |
| [3365](#L3365) | ?> |
| [3366](#L3366) | <p> |
| [3367](#L3367) | <label for="<?php echo $this->get\_field\_id('ShowNameField'); ?>"><b><?php echo \_\_('Show Name Field', 'email-subscribe'); ?>:</b></label><br/> |
| [3368](#L3368) | <input <?php if ($instance['ShowNameField'] == '1') { ?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('ShowNameField'); ?>"  id="s\_type\_show\_field\_yes" value="1"> Yes |
| [3369](#L3369) | <input <?php if ($instance['ShowNameField'] == '2') { ?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('ShowNameField'); ?>"   id="s\_type\_show\_field\_no" value="2"> No |
| [3370](#L3370) | </p> |
| [3371](#L3371) | <p> |
| [3372](#L3372) | <label for="<?php echo $this->get\_field\_id('show\_agreement'); ?>"><b><?php echo \_\_('Show Agreement', 'email-subscribe'); ?>:</b></label><br/> |
| [3373](#L3373) | <input <?php if ($instance['show\_agreement'] == '1') { ?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('show\_agreement'); ?>"  id="s\_type\_show\_agreement\_yes" value="1"> Yes |
| [3374](#L3374) | <input <?php if ($instance['show\_agreement'] == '2') { ?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('show\_agreement'); ?>"   id="s\_type\_show\_agreement\_no" value="2"> No |
| [3375](#L3375) | </p> |
| [3376](#L3376) | <p> |
| [3377](#L3377) | <label for="<?php echo $this->get\_field\_id('Heading'); ?>"><b><?php echo \_\_('Heading:', 'email-subscribe'); ?></b></label> |
| [3378](#L3378) | <input class="widefat" id="<?php echo $this->get\_field\_id('Heading'); ?>" |
| [3379](#L3379) | name="<?php echo $this->get\_field\_name('Heading'); ?>" type="text" value="<?php echo $instance['Heading']; ?>" /> |
| [3380](#L3380) | </p> |
| [3381](#L3381) | <p> |
| [3382](#L3382) | <label for="<?php echo $this->get\_field\_id('Subheading'); ?>"><b><?php echo \_\_('Subheading:', 'email-subscribe'); ?></b></label><br/> |
| [3383](#L3383) | <textarea rows="4" cols="30" name="<?php echo $this->get\_field\_name('Subheading'); ?>" id="Subheading"><?php echo $instance['Subheading']; ?></textarea> |
| [3384](#L3384) | </p> |
| [3385](#L3385) | <p> |
| [3386](#L3386) | <label for="<?php echo $this->get\_field\_id('EmailLabel'); ?>"><b><?php echo \_\_('Email Label:', 'email-subscribe'); ?></b></label> |
| [3387](#L3387) | <input class="widefat" id="<?php echo $this->get\_field\_id('EmailLabel'); ?>" |
| [3388](#L3388) | name="<?php echo $this->get\_field\_name('EmailLabel'); ?>" type="text" value="<?php echo $instance['EmailLabel']; ?>" /> |
| [3389](#L3389) | </p> |
| [3390](#L3390) | <p> |
| [3391](#L3391) | <label for="<?php echo $this->get\_field\_id('NameLabel'); ?>"><b><?php echo \_\_('Name Label:', 'email-subscribe'); ?></b></label> |
| [3392](#L3392) | <input class="widefat" id="<?php echo $this->get\_field\_id('NameLabel'); ?>" |
| [3393](#L3393) | name="<?php echo $this->get\_field\_name('NameLabel'); ?>" type="text" value="<?php echo $instance['NameLabel']; ?>" /> |
| [3394](#L3394) | </p> |
| [3395](#L3395) | <p> |
| [3396](#L3396) | <label for="<?php echo $this->get\_field\_id('SubmitButtonLabel'); ?>"><b><?php echo \_\_('Submit Button Label:', 'email-subscribe'); ?></b></label> |
| [3397](#L3397) | <input class="widefat" id="<?php echo $this->get\_field\_id('SubmitButtonLabel'); ?>" |
| [3398](#L3398) | name="<?php echo $this->get\_field\_name('SubmitButtonLabel'); ?>" type="text" value="<?php echo $instance['SubmitButtonLabel']; ?>" /> |
| [3399](#L3399) | </p> |
| [3400](#L3400) | <p> |
| [3401](#L3401) | <label for="<?php echo $this->get\_field\_id('RequiredFieldMessage'); ?>"><b><?php echo \_\_('Required Field Message:', 'email-subscribe'); ?></b></label> |
| [3402](#L3402) | <input class="widefat" id="<?php echo $this->get\_field\_id('RequiredFieldMessage'); ?>" |
| [3403](#L3403) | name="<?php echo $this->get\_field\_name('RequiredFieldMessage'); ?>" type="text" value="<?php echo $instance['RequiredFieldMessage']; ?>" /> |
| [3404](#L3404) | </p> |
| [3405](#L3405) |  |
| [3406](#L3406) | <p> |
| [3407](#L3407) | <label for="<?php echo $this->get\_field\_id('InvalidEmailMessage'); ?>"><b><?php echo \_\_('Invalid Email Message:', 'email-subscribe'); ?></b></label> |
| [3408](#L3408) | <input class="widefat" id="<?php echo $this->get\_field\_id('InvalidEmailMessage'); ?>" |
| [3409](#L3409) | name="<?php echo $this->get\_field\_name('InvalidEmailMessage'); ?>" type="text" value="<?php echo $instance['InvalidEmailMessage']; ?>" /> |
| [3410](#L3410) | </p> |
| [3411](#L3411) | <p> |
| [3412](#L3412) | <label for="<?php echo $this->get\_field\_id('InvalidRequestMessage'); ?>"><b><?php echo \_\_('Invalid Request Message:', 'email-subscribe'); ?></b></label> |
| [3413](#L3413) | <input class="widefat" id="<?php echo $this->get\_field\_id('InvalidRequestMessage'); ?>" |
| [3414](#L3414) | name="<?php echo $this->get\_field\_name('InvalidRequestMessage'); ?>" type="text" value="<?php echo $instance['InvalidRequestMessage']; ?>" /> |
| [3415](#L3415) | </p> |
| [3416](#L3416) | <p> |
| [3417](#L3417) | <label for="<?php echo $this->get\_field\_id('EmailExistMessage'); ?>"><b><?php echo \_\_('Email Exist Message:', 'email-subscribe'); ?></b></label> |
| [3418](#L3418) | <input class="widefat" id="<?php echo $this->get\_field\_id('EmailExistMessage'); ?>" |
| [3419](#L3419) | name="<?php echo $this->get\_field\_name('EmailExistMessage'); ?>" type="text" value="<?php echo $instance['EmailExistMessage']; ?>" /> |
| [3420](#L3420) | </p> |
| [3421](#L3421) | <p> |
| [3422](#L3422) | <label for="<?php echo $this->get\_field\_id('SuccessMessage'); ?>"><b><?php echo \_\_('Success Message:', 'email-subscribe'); ?></b></label> |
| [3423](#L3423) | <input class="widefat" id="<?php echo $this->get\_field\_id('SuccessMessage'); ?>" |
| [3424](#L3424) | name="<?php echo $this->get\_field\_name('SuccessMessage'); ?>" type="text" value="<?php echo $instance['SuccessMessage']; ?>" /> |
| [3425](#L3425) | </p> |
| [3426](#L3426) | <p> |
| [3427](#L3427) | <label for="<?php echo $this->get\_field\_id('WaitMessage'); ?>"><b><?php echo \_\_('Wait Message:', 'email-subscribe'); ?></b></label> |
| [3428](#L3428) | <input class="widefat" id="<?php echo $this->get\_field\_id('WaitMessage'); ?>" |
| [3429](#L3429) | name="<?php echo $this->get\_field\_name('WaitMessage'); ?>" type="text" value="<?php echo $instance['WaitMessage']; ?>" /> |
| [3430](#L3430) | </p> |
| [3431](#L3431) | <p> |
| [3432](#L3432) | <label for="<?php echo $this->get\_field\_id('agreement\_text'); ?>"><b><?php echo \_\_('Agreement Text:', 'email-subscribe'); ?></b></label> |
| [3433](#L3433) | <textarea class="widefat" id="<?php echo $this->get\_field\_id('agreement\_text'); ?>" |
| [3434](#L3434) | name="<?php echo $this->get\_field\_name('agreement\_text'); ?>" ><?php echo $instance['agreement\_text']; ?></textarea> |
| [3435](#L3435) | </p> |
| [3436](#L3436) | <p> |
| [3437](#L3437) | <label for="<?php echo $this->get\_field\_id('agreement\_error'); ?>"><b><?php echo \_\_('Agreement Message:', 'email-subscribe'); ?></b></label> |
| [3438](#L3438) | <input class="widefat" id="<?php echo $this->get\_field\_id('agreement\_error'); ?>" |
| [3439](#L3439) | name="<?php echo $this->get\_field\_name('agreement\_error'); ?>" type="text" value="<?php echo $instance['agreement\_error']; ?>" /> |
| [3440](#L3440) | </p> |
| [3441](#L3441) |  |
| [3442](#L3442) | <?php |
| [3443](#L3443) | } |
| [3444](#L3444) |  |
| [3445](#L3445) | // function form |
| [3446](#L3446) | } |
| [3447](#L3447) |  |
| [3448](#L3448) | // widget class |
| [3449](#L3449) |  |
| [3450](#L3450) | function store\_email\_callback() { |
| [3451](#L3451) |  |
| [3452](#L3452) | if (isset($\_POST['email']) and isset($\_POST['name']) and isset($\_POST['sec\_string'])) { |
| [3453](#L3453) |  |
| [3454](#L3454) | $wp\_news\_letter\_settings = get\_option('wp\_news\_letter\_settings'); |
| [3455](#L3455) | $nonce = $\_POST['sec\_string']; |
| [3456](#L3456) | $is\_agreed = sanitize\_text\_field($\_POST['is\_agreed']); |
| [3457](#L3457) | $is\_agreed = esc\_html($is\_agreed); |
| [3458](#L3458) | if (wp\_verify\_nonce($nonce, 'newsletter-nonce') and $is\_agreed == true) { |
| [3459](#L3459) |  |
| [3460](#L3460) | global $wpdb; |
| [3461](#L3461) | $email = sanitize\_email($\_POST['email']); |
| [3462](#L3462) | $name = sanitize\_text\_field($\_POST['name']); |
| [3463](#L3463) | $name = esc\_html($name); |
| [3464](#L3464) |  |
| [3465](#L3465) | if (is\_email($email)) { |
| [3466](#L3466) |  |
| [3467](#L3467) |  |
| [3468](#L3468) | $subscribed\_on = date('Y-m-d h:i:s'); |
| [3469](#L3469) | if (function\_exists('date\_i18n')) { |
| [3470](#L3470) |  |
| [3471](#L3471) | $subscribed\_on = date\_i18n('Y-m-d' . ' ' . get\_option('time\_format'), false, false); |
| [3472](#L3472) | if (get\_option('time\_format') == 'H:i') |
| [3473](#L3473) | $subscribed\_on = date('Y-m-d H:i:s', strtotime($subscribed\_on)); |
| [3474](#L3474) | else |
| [3475](#L3475) | $subscribed\_on = date('Y-m-d h:i:s', strtotime($subscribed\_on)); |
| [3476](#L3476) | } |
| [3477](#L3477) |  |
| [3478](#L3478) | $query = $wpdb->prepare('SELECT \* FROM ' . $wpdb->prefix . 'nl\_subscriptions where email = %s', array($email)); |
| [3479](#L3479) | $myrow = $wpdb->get\_row($query); |
| [3480](#L3480) |  |
| [3481](#L3481) | if (is\_object($myrow)) { |
| [3482](#L3482) |  |
| [3483](#L3483) | echo 'error|' . $wp\_news\_letter\_settings['email\_exist']; |
| [3484](#L3484) | } else { |
| [3485](#L3485) | try { |
| [3486](#L3486) |  |
| [3487](#L3487) | $key = md5(uniqid(rand(), true)); |
| [3488](#L3488) |  |
| [3489](#L3489) | $wpdb->insert( |
| [3490](#L3490) | $wpdb->prefix . "nl\_subscriptions", |
| [3491](#L3491) | array('name' => $name, 'email' => $email, 'subscribed\_on' => $subscribed\_on, 'is\_subscribed' => 1, 'unsubs\_key' => $key), |
| [3492](#L3492) | array('%s', '%s', '%s', '%d', '%s') |
| [3493](#L3493) | ); |
| [3494](#L3494) | echo 'success|' . $wp\_news\_letter\_settings['success']; |
| [3495](#L3495) | } catch (Exception $e) { |
| [3496](#L3496) |  |
| [3497](#L3497) | echo 'error|' . $e->getMessage(); |
| [3498](#L3498) | } |
| [3499](#L3499) | } |
| [3500](#L3500) | } else { |
| [3501](#L3501) |  |
| [3502](#L3502) | echo 'error|' . $wp\_news\_letter\_settings['iinvalidemail']; |
| [3503](#L3503) | } |
| [3504](#L3504) | } else { |
| [3505](#L3505) |  |
| [3506](#L3506) | echo 'error|' . $wp\_news\_letter\_settings['invalid\_request']; |
| [3507](#L3507) | } |
| [3508](#L3508) | } else { |
| [3509](#L3509) |  |
| [3510](#L3510) | echo 'error|' . $wp\_news\_letter\_settings['invalid\_request']; |
| [3511](#L3511) | } |
| [3512](#L3512) |  |
| [3513](#L3513) | die; |
| [3514](#L3514) | } |
| [3515](#L3515) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/email-subscribe/tags/1.2.22/wp-email-subscription.php?format=txt)
* [Original Format](/export/3222433/email-subscribe/tags/1.2.22/wp-email-subscription.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_8b0ed347_20250114_181848.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Email Subscription Popup

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Femail-subscribe&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Femail-subscribe&locale=en_US)

Search plugins

![](https://ps.w.org/email-subscribe/assets/banner-772x250.png?rev=1210491)
![](https://ps.w.org/email-subscribe/assets/icon-128x128.png?rev=1210491)
# Email Subscription Popup

By [I Thirteen Web Solution](https://www.i13websolution.com/)

[Download](https://downloads.wordpress.org/plugin/email-subscribe.1.2.24.zip)

* [Details](https://wordpress.org/plugins/email-subscribe/#description)
* [Reviews](https://wordpress.org/plugins/email-subscribe/#reviews)
* [Installation](https://wordpress.org/plugins/email-subscribe/#installation)
* [Development](https://wordpress.org/plugins/email-subscribe/#developers)

[Support](https://wordpress.org/support/plugin/email-subscribe/)

## Description

This plugin shows you a beautiful newsletter subscription popup when someone enter to your site. You can even use widget that allow email subscription. This easy to use, beautiful and powerful plugin. Admin can set if newsletter modal should appear for each unique visit for any page or home page.Admin can also set link for newsletter signup. When click on the link the modal popup of newsletter signup will appear. This plugin provides full customization of each and every label messages and error messages. This plugin can be used for any website localization.

Additionally, admin can view the list of subscribers and also can delete selected subscribers. Admin can send a mass email to subscribers. Admin can also view the list of unsubscribers. This plugin also can be used for responsive sites.

**Find Email Subscription Pro Plugin at [WordPress Newsletter Subscription](https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/)**

**[Live Demo WordPress Newsletter Subscription Pro](http://blog.i13websolution.com/live-preview-wp-newsletter-subscription-plugin/)**

In Pro, Version admin Can have options to choose from three different types of designs. In Pro Version, Admin Can Change Newsletter box’s background color, Border Color, Border Size, Modal Border Color, Title Color, Title Font Size, Sub Title Font Color, Sub Title Font Size, Modal textbox colors, Buttons color, etc. Admin Can also have options in the pro version for auto activate subscriber or via activation email. Admin Can also have the option to receive a notification when someone

subscribe to site.

In the pro version, admin can create newsletter templates. Admin can send a mass email or send a mass email to selected subscribers. Admin can select newsletter template while sending an email. In pro, version user can unsubscribe from newsletter email. Admin can see how have unsubscribed from the newsletter. Admin can also export subscribers and admin can also import subscribers. Admin can mass delete subscribers.

**Video [WordPress Newsletter Subscription](https://www.youtube.com/watch?v=nqrDS58RE9Q)**

**Please rate this plugin if you find it useful**

=Features=

1. Newsletter subscription
2. Responsive design
3. View list of subscribers
4. Mass email to subscribers
5. Delete subscribers
6. Newsletter widget available
7. View list of unsubscribers
8. Plugin ready for translation
9. Gdpr compliance add checkbox I agree
10. show hide I agree and Name field
11. Added WordPress capabilities feature

**=Pro Version Features(Add On)=**

1. Three Different Types Newsletter POPUPS Designs (See In Screenshots).
2. You Can Change Newsletter box’s backgroud color,Border Color,Border Size,Modal Border Color,Title Color,Title Font Size,Sub Title Font Color,

   Sub Title Font Size,Modal textbox colors,Buttons color etc.
3. Show Hide Name Feild In Modal Popup and In Newsletter Widget
4. Mass email to subscribers.
5. Newsletter email templates.
6. Send Newsletter via cronjob
7. Social Media Links.
8. Email Notification to admin when someone subscribe.
9. Option to activate Subscriber via activation link or automatic subscribe
10. Import subscribers.
11. Export subscribers.
12. Mass delete subscribers.
13. unsubscribe from newsletter.
14. Username,email,unsubscribe link place holders while sending emails.
15. Search subscribers.
16. View unsubscribers list and take action of resubscribe or delete it.
17. Delay Newsletter Popup.
18. Plugin ready for translation
19. No advertisements.
20. Gdpr compliance add checkbox I agree
21. show hide I agree and Name field
22. Added WordPress capabilities feature

[Get Support](http://www.i13websolution.com/contacts)

### License

This plugin is free for everyone! Since it’s released under the GPL, you can use it free of charge on your personal or commercial blog. But you can make some donations if you realy find it useful.

## Screenshots

* [![](https://ps.w.org/email-subscribe/assets/screenshot-1.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-1.png?rev=1520375)

  Newsletter Modal popup settings
* [![](https://ps.w.org/email-subscribe/assets/screenshot-2.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-2.png?rev=1520375)

  Preview of modal popup.
* [![](https://ps.w.org/email-subscribe/assets/screenshot-3.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-3.png?rev=1520375)

  Responsive design view.
* [![](https://ps.w.org/email-subscribe/assets/screenshot-4.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-4.png?rev=1520375)

  Widget preview.
* [![](https://ps.w.org/email-subscribe/assets/screenshot-5.png?rev=1602912)](https://ps.w.org/email-subscribe/assets/screenshot-5.png?rev=1602912)

  Pro Version Popup Style 1
* [![](https://ps.w.org/email-subscribe/assets/screenshot-6.png?rev=1602912)](https://ps.w.org/email-subscribe/assets/screenshot-6.png?rev=1602912)

  Pro Version Popup Style 2
* [![](https://ps.w.org/email-subscribe/assets/screenshot-7.png?rev=1602912)](https://ps.w.org/email-subscribe/assets/screenshot-7.png?rev=1602912)

  Pro Version Popup Style 3
* [![](https://ps.w.org/email-subscribe/assets/screenshot-8.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-8.png?rev=1520375)

  Pro version features like mass email,import/export,delete subscribers
* [![](https://ps.w.org/email-subscribe/assets/screenshot-9.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-9.png?rev=1520375)

  List of unsubscribers
* [![](https://ps.w.org/email-subscribe/assets/screenshot-10.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-10.png?rev=1520375)

  Manage newsletter templates
* [![](https://ps.w.org/email-subscribe/assets/screenshot-11.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-11.png?rev=1520375)

  Mass email preview
* [![](https://ps.w.org/email-subscribe/assets/screenshot-12.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-12.png?rev=1520375)

  Activate subscriber via activation link or automatic activate
* [![](https://ps.w.org/email-subscribe/assets/screenshot-13.png?rev=1520375)](https://ps.w.org/email-subscribe/assets/screenshot-13.png?rev=1520375)

  Notify admin when someone subscribe to newsletter

## Installation

This plugin is easy to install like other plug-ins of WordPress as you need to just follow the below mentioned steps:

1. upload wp-email-subscription folder to wp-Content/plugins folder.
2. Activate the plugin from Dashboard / Plugins window.
3. Now Plugin is Activated, Go to the Usage section to see how to use this plugin

### Usage

1.Use of wp email subscription plugin is easy after activating plugin go to menu Email Subscription

2.Edit messages and lables as per your localization.

3.Edit cookie settings.

4.you can also use widget if your theme support widget.

## FAQ

1.How to use ?

For frontend side use please use widget feature.more more info use readme installation and usage notes.

## Reviews

![](https://secure.gravatar.com/avatar/a6a428197cdabee93086c5b9cabe4da9d38f84453b7f7e960689b4a1e99773c0?s=60&d=retro&r=g)
### [Does what you need it to!](https://wordpress.org/support/topic/does-what-you-need-it-to-4/)

[designbymorph](https://profiles.wordpress.org/designbymorph/ "Posts by designbymorph")
July 2, 2019

Very responsive customer support. Does what you need it to. Thanks!

![](https://secure.gravatar.com/avatar/ffb7fccce0adafa05a4214d2ea043031972d3414093bd46bfa7f8631934a2247?s=60&d=retro&r=g)
### [Wow Newsletter Popup setup within few min](https://wordpress.org/support/topic/wow-newsletter-popup-setup-within-few-min/)

[nngandhi](https://profiles.wordpress.org/nngandhi/ "Posts by nngandhi")
June 23, 2018

I have just installed plugin and it is easy to configure. It is shown newsletter popup within few min.
Thanks nks for such plugin..

![](https://secure.gravatar.com/avatar/01ca87f66033673cb91d157b5fccbe0e7251f8f5e109eba0a6943989611b5259?s=60&d=retro&r=g)
### [Not Working Properly](https://wordpress.org/support/topic/not-working-properly-77/)

[rathipriya](https://profiles.wordpress.org/rathipriya/ "Posts by rathipriya")
March 23, 2018

In Localhost it works but website becomes live, cannot able to mail the subscribers it shows an error “Unable to send email to newsletter subscribers.” Kindly rectify it

![](https://secure.gravatar.com/avatar/a9a4112fe2f051a1f9efc64b19ccdaaca13861fe112457a688a6a4500d328a87?s=60&d=retro&r=g)
### [Popup working good](https://wordpress.org/support/topic/popup-not-working-33/)

[jomol](https://profiles.wordpress.org/jomol/ "Posts by jomol")
August 21, 2017

Good

![](https://secure.gravatar.com/avatar/23ca63f080514563af6cd6c8a63ceedcef85e639c050ff57c016006c9a7e4f39?s=60&d=retro&r=g)
### [Excellent. Exactly what I was looking for.](https://wordpress.org/support/topic/excellent-exactly-what-i-was-looking-for/)

[Skytr](https://profiles.wordpress.org/skytruk/ "Posts by Skytr")
February 11, 2017

Found this amazing plugin. Exactly what I was looking for.
With brilliant support.

![](https://secure.gravatar.com/avatar/6557636fe76e6439bac6daf4ac9d05aa09f6db4a83f51867a050bde80eccc021?s=60&d=retro&r=g)
### [Not impressed by the free version of this plugin.](https://wordpress.org/support/topic/not-impressed-by-the-free-version-of-this-plugin/)

[internetnewsalliance](https://profiles.wordpress.org/internetnewsalliance/ "Posts by internetnewsalliance")
January 19, 2017

The pop-up function did work, however, apostrophes do not show up properly and no ascii codes seemed to work (minor inconvenience).
My issue is that once a subscriber signs up, I see them in the plugin’s subscriber list, but there is nothing useful I can do with the data. There is no way to email them that I could find throughout my dashboard, nor is there an export function to be able to export the subscriber list… in order to add them as users in the Users area (which is what would actually be useful for me). All I can do, is ‘delete selected subscriber’.
Anyways, not impressed, and not likely to consider the pro version. I wish there was a negative star option for ratings, as a 1 star rating is too high for this plugin in my opinion. Hopefully others experience will be better than mine, and/or that the plugin is extended to include more useful functions in future releases.

[Read all 11 reviews](https://wordpress.org/support/plugin/email-subscribe/reviews/)
## Contributors & Developers

“Email Subscription Popup” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/f07db069c46bcba78319283b7f669a193bb2b57313d0569c1dc04f7f6e6128d1?s=32&d=mm&r=g) [Nks](https://profiles.wordpress.org/nik00726/)

[Translate “Email Subscription Popup” into your language.](https://translate.wordpress.org/projects/wp-plugins/email-subscribe)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/email-subscribe/), check out the [SVN repository](https://plugins.svn.wordpress.org/email-subscribe/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/email-subscribe/) by [RSS](https://plugins.trac.wordpress.org/log/email-subscribe/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.2.24

* Fixed vulnerable SQL

#### 1.2.23

* Fixed vulnerability Cross-Site Scripting reported by Wordfence

#### 1.2.22

* Added shortcode option to print newsletter subscribe form

#### 1.2.21

* Fixed Vulnerability

#### 1.2.20

* Fixed Vulnerability

#### 1.2.19

* Fixed referer was not escaped

#### 1.2.18

* Fixed css conflict
* Tested with WordPress 6.3

#### 1.2.17

* Fixed vulnerability
* Tested with WordPress 6.2

#### 1.2.16

* Plugin is now compitible with WordPress 5.8
* Tested with WordPress 5.8

#### 1.2.15

* Fixed undefined variable problem

#### 1.2.14

* Fixed lightbox not working with jQuery 3.x

#### 1.2.14

* Removed jQuery.noConflict() as it cause problem to $ usage

#### 1.2.13

* Fixed character set problem.

#### 1.2.12

* Fixed nl2br problem.
* Tested with WordPress 5.4

#### 1.2.11

* Improve modal popup loading.

#### 1.2.10

* Fixed border issue in popup form.
* Tested with WordPress 5.3

#### 1.2.9

* Improve code so that plugin still works even jquery in footer.
* Tested with WordPress 5.2

#### 1.2.8

* Added WordPress capabilities feature
* Tested with WordPress 5.1
* Improve pagination in subscribers list

#### 1.2.7

* Improve admin UI
* Tested with WordPress 5.0

#### 1.2.6

* Added additional css feature.Now developer/admin can add additional css from newsletter popup form settings

#### 1.2.5

* gdpr compliance, Added I agree checkbox in newsletter form.
* Show/hide I agree checkbox
* Show/hide name field

#### 1.2.4

* Fixed issue of unsubscribe message showing blank.

#### 1.2.3

* Added mass email to subscriber functionality.
* Added unsubscriber list functionality
* Subscriber can unsubcribe from newsletter(set link for unsubcribe in newsletter).
* Plugin translation ready

#### 1.2.2

* fix to work with other fancybox scripts

#### 1.2.1

* fix class constructor notice when debug mode is on

#### 1.2

* Security updates

#### 1.0

* Stable 1.0 first release

## Commercial plugin

This plugin is free but offers additional paid commercial upgrades or support. [View support](https://i13websolution.com/contact-us/)

## Meta

* Version **1.2.24**
* Last updated **1 month ago**
* Active installations **2,000+**
* WordPress version **3.0 or higher**
* Tested up to **6.7.1**
* Tag [newsletter widget](https://wordpress.org/plugins/tags/newsletter-widget/)
* [Advanced View](https://wordpress.org/plugins/email-subscribe/advanced/)

## Ratings

3.8 out of 5 stars.

* [6 5-star reviews
  5 stars

  6](https://wordpress.org/support/plugin/email-subscribe/reviews/?filter=5)
* [2 4-star reviews
  4 stars

  2](https://wordpress.org/support/plugin/email-subscribe/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/email-subscribe/reviews/?filter=3)
* [1 2-star review
  2 stars

  1](https://wordpress.org/support/plugin/email-subscribe/reviews/?filter=2)
* [2 1-star reviews
  1 star

  2](https://wordpress.org/support/plugin/email-subscribe/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/email-subscribe/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/email-subscribe/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/f07db069c46bcba78319283b7f669a193bb2b57313d0569c1dc04f7f6e6128d1?s=32&d=mm&r=g) [Nks](https://profiles.wordpress.org/nik00726/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/email-subscribe/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://www.i13websolution.com/donate_for_mass_email.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


