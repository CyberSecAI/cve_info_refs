- **Root cause of vulnerability:** The vulnerability lies in the implementation of the `request_fulluri` parameter in PHP's stream context, which inserts the raw URI into the HTTP request line without proper sanitization, bypassing the usual control character checks. This allows for CRLF injection.
- **Weaknesses/vulnerabilities present:**
    - CRLF injection vulnerability in HTTP request line.
    - Lack of sanitization of user-controlled URI when `request_fulluri` is enabled.
    - Automatic enabling of `request_fulluri` for non-HTTP streams when a proxy is set.
- **Impact of exploitation:**
    - HTTP request smuggling attacks.
    - Server Side Request Forgery (SSRF), allowing attackers to bypass security controls and access internal endpoints.
    - Ability to control the Host header and potentially access different hosts.
    - Possibility to inject arbitrary HTTP methods and headers, including sensitive headers.
    - In certain setups, the attacker might be able to read the HTTP responses of smuggled requests.
- **Attack vectors:**
    - An attacker can inject CRLF characters into the URI when the `request_fulluri` context parameter is true, either through HTTP or FTP streams that have a proxy configured.
- **Required attacker capabilities/position:**
    - Partial control over the resource URI being requested.
    - Ability to influence the stream context and set the `request_fulluri` parameter either directly or through proxy settings.