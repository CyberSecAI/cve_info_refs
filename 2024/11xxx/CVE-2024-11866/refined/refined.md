Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2024-11866

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping within the 'bmlt_tabbed_map' shortcode of the BMLT Tabbed Map WordPress plugin. Specifically, user-supplied attributes of the shortcode are not properly sanitized before being used, which allows for the injection of malicious scripts.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The core vulnerability is a stored XSS, where malicious scripts are injected into the database and executed when a user views the affected content.
- **Insufficient Input Sanitization:** The plugin does not properly sanitize user-provided attributes within the shortcode.
- **Insufficient Output Escaping:** The plugin fails to escape the output of user-provided attributes, leading to the execution of injected scripts.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** An attacker can inject and execute arbitrary web scripts in the context of the victim's browser.
- **Account Takeover:** By injecting malicious scripts, an attacker could potentially perform actions on behalf of a user, which could include account takeover.
- **Data Theft:** An attacker could steal sensitive information such as cookies or session tokens.
- **Website Defacement:** An attacker could modify the appearance or content of the website.

**Attack Vectors:**
- **Shortcode Injection:** The primary attack vector is through the plugin's 'bmlt_tabbed_map' shortcode.
- **Malicious Attributes:** The attacker injects malicious JavaScript code via the shortcode's attributes such as lat, lng, or zoom.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker must be an authenticated user with at least "contributor" level access to a WordPress site running the vulnerable plugin. This allows the attacker to create/edit content with the vulnerable shortcode.
- **Knowledge of Vulnerable Shortcode:** The attacker needs to be aware of the vulnerable shortcode and how to inject malicious attributes.

**Additional Details:**
- The vulnerability exists in all versions of the BMLT Tabbed Map plugin up to and including 1.1.8.
- The vulnerability was addressed in version 1.2.0 of the plugin.
- The patch includes improvements in input sanitization and output escaping.
- The `sanitize_text_field` function is used to sanitize input data, and `esc_url` and `esc_js` are used to properly escape URLs and JavaScript output.