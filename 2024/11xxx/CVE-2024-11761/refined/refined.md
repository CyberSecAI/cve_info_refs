Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-11761

**Root Cause:** The vulnerability stems from insufficient input sanitization and output escaping within the LegalWeb Cloud WordPress plugin's 'legalweb-popup' shortcode. This allows for the injection of malicious scripts via user-supplied attributes.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The core issue is the lack of proper sanitization of user-provided input, specifically the attributes of the `legalweb-popup` shortcode, and the lack of output escaping when these attributes are rendered on a page. This allows an attacker to inject malicious JavaScript that is then stored in the database and executed when a user views the affected page.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation enables attackers to inject and execute arbitrary web scripts in the context of a user's browser session whenever they access a page containing the injected shortcode. This can lead to various malicious activities such as:
    *   Session hijacking
    *   Stealing cookies
    *   Redirecting users to malicious websites
    *   Defacing websites
    *   Other client-side attacks

**Attack Vectors:**
*   **Shortcode Injection:** The attack vector is through the `legalweb-popup` shortcode. Attackers can insert the malicious script by using crafted attributes within the shortcode.
*   **Authenticated Access:** The attacker needs to be an authenticated user with at least "contributor" level access in WordPress. This role allows the creation and editing of posts and pages where shortcodes can be used.

**Required Attacker Capabilities/Position:**
*   **WordPress User Account:** The attacker must have a valid WordPress user account with a role of at least 'contributor'.
*   **Ability to Create/Edit Content:** They need the capability to create or edit content (posts/pages) that allows the insertion of WordPress shortcodes.

**Additional Details from the Patched Code:**
*   The provided diff from the WordPress plugin repository highlights the fix. The `esc_attr` function was added to sanitize the `class` attribute, and `esc_html` was added to sanitize the `text` attribute of the shortcode. This encodes characters in the attribute values and prevents the browser from interpreting them as HTML or Javascript code.