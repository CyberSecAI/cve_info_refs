=== Content from plugins.trac.wordpress.org_0a0cb842_20250114_203032.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fpingmeter-uptime-monitoring%2Ftrunk%2Fpingmeter.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/pingmeter-uptime-monitoring/trunk/pingmeter.php?rev=2465467 "Revision 2465467")
* Next Revision →
* [Blame](/browser/pingmeter-uptime-monitoring/trunk/pingmeter.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/pingmeter-uptime-monitoring/trunk/pingmeter.php)

---

# [source:](/browser?order=name "Go to repository root") [pingmeter-uptime-monitoring](/browser/pingmeter-uptime-monitoring?order=name "View pingmeter-uptime-monitoring")/[trunk](/browser/pingmeter-uptime-monitoring/trunk?order=name "View trunk")/[pingmeter.php](/browser/pingmeter-uptime-monitoring/trunk/pingmeter.php?order=name "View pingmeter.php")

View diff against:

View revision:

| [Last change](/changeset/2719098/pingmeter-uptime-monitoring/trunk/pingmeter.php "View differences") on this file was [2719098](/changeset/2719098/ "View changeset 2719098"), checked in by pingmeter, [3 years ago](/timeline?from=2022-05-06T07%3A34%3A58Z&precision=second "See timeline at 05/06/2022 07:34:58 AM") |
| --- |
| * [WordPress](/wiki/WordPress) 6 |
| * Property **svn:eol-style** set to   *`native`* | |
| **File size:** 27.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: Pingmeter Uptime Monitoring |
| [4](#L4) | Plugin URI: https://www.pingmeter.com/ |
| [5](#L5) | Description: Pingmeter monitors, notify and auto rescues your website during downtimes. |
| [6](#L6) | Author: Armin Nikdel |
| [7](#L7) | Version: 1.0.3 |
| [8](#L8) | Author URI: http://www.pingmeter.com/ |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | add\_action('admin\_menu', 'pm\_admin\_menu'); |
| [12](#L12) | add\_action('wp\_footer', 'pingmeter'); |
| [13](#L13) | add\_action('wp\_head', 'pingmeter'); |
| [14](#L14) |  |
| [15](#L15) | function pingmeter\_load\_plugin\_textdomain() { |
| [16](#L16) | $domain = 'pingmeter-uptime-monitoring'; |
| [17](#L17) | $locale = apply\_filters( 'plugin\_locale', get\_locale(), $domain ); |
| [18](#L18) | if ( $loaded = load\_textdomain( $domain, trailingslashit( WP\_LANG\_DIR ) . $domain . '/' . $domain . '-' . $locale . '.mo' ) ) { |
| [19](#L19) | return $loaded; |
| [20](#L20) | } else { |
| [21](#L21) | load\_plugin\_textdomain( $domain, FALSE, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [22](#L22) | } |
| [23](#L23) | } |
| [24](#L24) | add\_action( 'plugins\_loaded', 'pingmeter\_load\_plugin\_textdomain' ); |
| [25](#L25) |  |
| [26](#L26) |  |
| [27](#L27) |  |
| [28](#L28) |  |
| [29](#L29) |  |
| [30](#L30) | function pingmeter(){ |
| [31](#L31) | global $\_SERVER,$pingmeter\_tracker; |
| [32](#L32) | $option=get\_pm\_conf(); |
| [33](#L33) |  |
| [34](#L34) | if (!isset($option['code'])) $option['code']=''; |
| [35](#L35) |  |
| [36](#L36) | $option['code']=str\_replace("\r",'',str\_replace("\n",'',str\_replace(" ","",trim(html\_entity\_decode($option['code']))))); |
| [37](#L37) |  |
| [38](#L38) | if ( $option['code']!=''){ |
| [39](#L39) | if ( !strpos(strtolower($option['code']),"pingmeter") ){ |
| [40](#L40) | if ( strpos($option['code'],"-")){ |
| [41](#L41) |  |
| [42](#L42) | $codes=explode("-", $option['code']); |
| [43](#L43) | $aid=$codes[0]; |
| [44](#L44) | $sid=$codes[1]; |
| [45](#L45) | // $catID=$codes[2]; |
| [46](#L46) | // $integrity=$codes[3]; |
| [47](#L47) |  |
| [48](#L48) | ?><!-- PINGMETER SMART UPTIME v1.0.3 WP - DO NOT CHANGE --><?php |
| [49](#L49) |  |
| [50](#L50) | $keyword=array(); |
| [51](#L51) | $keyword[]='uptime monitoring'; |
| [52](#L52) | $keyword[]='server ping'; |
| [53](#L53) | $keyword[]='website downtime monitor'; |
| [54](#L54) |  |
| [55](#L55) | $kwid=mt\_rand(0,count($keyword)-1); |
| [56](#L56) |  |
| [57](#L57) | if (round($pingmeter\_tracker==0)){ |
| [58](#L58) |  |
| [59](#L59) | ?> |
| [60](#L60) |  |
| [61](#L61) | <script type="text/javascript">\_pm\_aid=<?php echo $aid; ?>;\_pm\_sid=<?php echo $sid; ?>;(function(){var hstc=document.createElement('script');hstc.src='https://pingmeter.com/track.js';hstc.async=true;var htssc = document.getElementsByTagName('script')[0];htssc.parentNode.insertBefore(hstc, htssc);})(); |
| [62](#L62) | </script> |
| [63](#L63) | <?php } ?> |
| [64](#L64) |  |
| [65](#L65) | <!-- PINGMETER SMART UPTIME - DO NOT CHANGE --><?php |
| [66](#L66) |  |
| [67](#L67) |  |
| [68](#L68) |  |
| [69](#L69) | $pingmeter\_tracker=1; |
| [70](#L70) |  |
| [71](#L71) |  |
| [72](#L72) | } |
| [73](#L73) | } |
| [74](#L74) | } |
| [75](#L75) | } |
| [76](#L76) |  |
| [77](#L77) |  |
| [78](#L78) |  |
| [79](#L79) |  |
| [80](#L80) |  |
| [81](#L81) |  |
| [82](#L82) | if (!function\_exists("pm\_clean\_cache")){ |
| [83](#L83) | function pm\_clean\_cache(){ |
| [84](#L84) |  |
| [85](#L85) |  |
| [86](#L86) | if(function\_exists('wp\_cache\_clean\_cache')){ |
| [87](#L87) | //to avoid a nasty bug! |
| [88](#L88) | if(function\_exists('wp\_cache\_debug')){ |
| [89](#L89) | global $file\_prefix; |
| [90](#L90) | @wp\_cache\_clean\_cache($file\_prefix); |
| [91](#L91) | } |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | if (defined('W3TC')) { |
| [95](#L95) |  |
| [96](#L96) | if(function\_exists('w3tc\_flush\_all')){ |
| [97](#L97) | w3tc\_flush\_all(); |
| [98](#L98) | do\_action('w3tc\_flush\_all'); |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | if (function\_exists('w3tc\_pgcache\_flush')) { |
| [102](#L102) | w3tc\_pgcache\_flush(); |
| [103](#L103) | do\_action('w3tc\_pgcache\_flush'); |
| [104](#L104) | } |
| [105](#L105) |  |
| [106](#L106) |  |
| [107](#L107) | } |
| [108](#L108) |  |
| [109](#L109) |  |
| [110](#L110) |  |
| [111](#L111) |  |
| [112](#L112) | } |
| [113](#L113) | } |
| [114](#L114) |  |
| [115](#L115) |  |
| [116](#L116) | if (!function\_exists("get\_pm\_conf")){ |
| [117](#L117) | function get\_pm\_conf(){ |
| [118](#L118) |  |
| [119](#L119) | $option=get\_option('pm\_setting'); |
| [120](#L120) |  |
| [121](#L121) | //remove PHP Notices |
| [122](#L122) | if (!isset($option['code'])) $option['code']=''; |
| [123](#L123) | if (!isset($option['wgd'])) $option['wgd']=1; |
| [124](#L124) | if (!isset($option['wgl'])) $option['wgl']=2; |
| [125](#L125) |  |
| [126](#L126) |  |
| [127](#L127) | //define pre-defined values. |
| [128](#L128) | if (round($option['wgd'])==0) $option['wgd']=1; |
| [129](#L129) | if (round($option['wgl'])==0) $option['wgl']=2; |
| [130](#L130) |  |
| [131](#L131) |  |
| [132](#L132) | return $option; |
| [133](#L133) |  |
| [134](#L134) | } |
| [135](#L135) | } |
| [136](#L136) | if (!function\_exists("set\_pm\_conf")){ |
| [137](#L137) | function set\_pm\_conf($conf){update\_option('pm\_setting',$conf);} |
| [138](#L138) | } |
| [139](#L139) |  |
| [140](#L140) |  |
| [141](#L141) |  |
| [142](#L142) | if (!function\_exists("pm\_admin\_menu")){ |
| [143](#L143) | function pm\_admin\_menu(){ |
| [144](#L144) |  |
| [145](#L145) | $x = WP\_PLUGIN\_URL.'/'.str\_replace(basename( \_\_FILE\_\_),"",plugin\_basename(\_\_FILE\_\_)); |
| [146](#L146) |  |
| [147](#L147) | add\_options\_page(\_\_("Pingmeter Options",'pingmeter-uptime-monitoring'), \_\_("Pingmeter",'pingmeter-uptime-monitoring'), 'manage\_options', \_\_FILE\_\_, 'pm\_optionpage'); |
| [148](#L148) |  |
| [149](#L149) | } |
| [150](#L150) | } |
| [151](#L151) |  |
| [152](#L152) |  |
| [153](#L153) |  |
| [154](#L154) | if (!function\_exists("pingmeter\_admin\_warnings")){ |
| [155](#L155) | function pingmeter\_admin\_warnings() { |
| [156](#L156) |  |
| [157](#L157) | $option=get\_pm\_conf(); |
| [158](#L158) |  |
| [159](#L159) | if (!isset($option['code'])) $option['code']=''; |
| [160](#L160) | if (!isset($\_REQUEST['hitmagic'])) $\_REQUEST['hitmagic']=''; |
| [161](#L161) |  |
| [162](#L162) | if (isset($\_POST['action'])){ |
| [163](#L163) | $postaction=$\_POST['action']; |
| [164](#L164) | }else{ |
| [165](#L165) | $postaction=''; |
| [166](#L166) | } |
| [167](#L167) |  |
| [168](#L168) | if ( $option['code']=='' && $postaction!='do' && $\_REQUEST['hitmagic']!='do' ) { |
| [169](#L169) | function pingmeter\_warning() { |
| [170](#L170) | echo " |
| [171](#L171) | <div id='pingmeter-warning' class='updated fade'><p><strong>".\_\_('Enjoy peace of mind with Pingmeter Uptime monitoring.','pingmeter-uptime-monitoring')."</strong> ".sprintf(\_\_('You must <a href="%1$s">enter your Pingmeter API key</a> to have pingmeter monitor and notify you of your website downtimes.','pingmeter-uptime-monitoring'), "options-general.php?page=pingmeter-uptime-monitoring/pingmeter.php")."</p></div> |
| [172](#L172) |  |
| [173](#L173) | <script type=\"text/javascript\">setTimeout(function(){jQuery('#pingmeter-warning').slideUp('slow');}, 30000);</script> |
| [174](#L174) |  |
| [175](#L175) | "; |
| [176](#L176) |  |
| [177](#L177) | } |
| [178](#L178) |  |
| [179](#L179) | add\_action('admin\_notices', 'pingmeter\_warning'); |
| [180](#L180) |  |
| [181](#L181) | return; |
| [182](#L182) |  |
| [183](#L183) | } |
| [184](#L184) |  |
| [185](#L185) | } |
| [186](#L186) | pingmeter\_admin\_warnings(); |
| [187](#L187) | $option=get\_pm\_conf(); |
| [188](#L188) |  |
| [189](#L189) | } |
| [190](#L190) |  |
| [191](#L191) |  |
| [192](#L192) | if (!function\_exists("pingmeter\_call")){ |
| [193](#L193) | function pingmeter\_call($post){ |
| [194](#L194) | $pingmeter\_api\_receiver="http://pingmeter.com/api/wp-register.php"; |
| [195](#L195) | $post['v']=1; |
| [196](#L196) |  |
| [197](#L197) | $arg=array( |
| [198](#L198) | 'method'=>'POST', |
| [199](#L199) | 'timeout'=>18, |
| [200](#L200) | 'redirection'=>5, |
| [201](#L201) | 'body'=>$post |
| [202](#L202) | ); |
| [203](#L203) |  |
| [204](#L204) | //Set the URL to work with |
| [205](#L205) | $result=wp\_remote\_post($pingmeter\_api\_receiver,$arg); |
| [206](#L206) | $arr=array(); |
| [207](#L207) |  |
| [208](#L208) |  |
| [209](#L209) | if ($result['body']=='db\_down\_for\_maintaince'){ |
| [210](#L210) | $arr['error']=99; |
| [211](#L211) | $arr['msg']="Pingmeter internal database error"; |
| [212](#L212) | return $arr; |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | if (strpos(strtolower($result['body']),"cloudflare")) { |
| [216](#L216) | $arr['error']=999; |
| [217](#L217) | $arr['msg']="Pingmeter webserver is inaccessible from this plugin."; |
| [218](#L218) | return $arr; |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | //var\_dump($result['body']); |
| [222](#L222) | $arr=(array) json\_decode($result['body'], true); |
| [223](#L223) |  |
| [224](#L224) | return $arr; |
| [225](#L225) |  |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) |  |
| [230](#L230) |  |
| [231](#L231) |  |
| [232](#L232) | if (!function\_exists("pm\_optionpage")){ |
| [233](#L233) | function pm\_optionpage(){ |
| [234](#L234) |  |
| [235](#L235) | $verify=true; |
| [236](#L236) | if (count($\_POST)>0){ |
| [237](#L237) | $verify=wp\_verify\_nonce( $\_POST['\_wpnonce'], 'pm\_option\_page' ); |
| [238](#L238) | } |
| [239](#L239) |  |
| [240](#L240) |  |
| [241](#L241) |  |
| [242](#L242) |  |
| [243](#L243) | if ($verify&&(current\_user\_can('manage\_options')||$option['wgl']!=2)) { |
| [244](#L244) |  |
| [245](#L245) |  |
| [246](#L246) | $nonce = wp\_create\_nonce( 'pm\_option\_page'); |
| [247](#L247) |  |
| [248](#L248) |  |
| [249](#L249) | $option=get\_pm\_conf(); |
| [250](#L250) |  |
| [251](#L251) |  |
| [252](#L252) |  |
| [253](#L253) | $option['code']=html\_entity\_decode($option['code']); |
| [254](#L254) | $option['wgd']=html\_entity\_decode($option['wgd']); |
| [255](#L255) | $option['wgl']=html\_entity\_decode($option['wgl']); |
| [256](#L256) |  |
| [257](#L257) | $magicable=1; |
| [258](#L258) |  |
| [259](#L259) |  |
| [260](#L260) | if (!function\_exists('wp\_get\_current\_user')) |
| [261](#L261) | global $current\_user; |
| [262](#L262) |  |
| [263](#L263) | if(function\_exists('get\_currentuserinfo')){ |
| [264](#L264) |  |
| [265](#L265) | if (!function\_exists('wp\_get\_current\_user')) |
| [266](#L266) | get\_currentuserinfo(); |
| [267](#L267) |  |
| [268](#L268) |  |
| [269](#L269) | } |
| [270](#L270) |  |
| [271](#L271) | if (function\_exists('wp\_get\_current\_user')) |
| [272](#L272) | $current\_user=wp\_get\_current\_user(); |
| [273](#L273) |  |
| [274](#L274) |  |
| [275](#L275) | if ($current\_user->user\_email==''){ |
| [276](#L276) | $magicable=0; |
| [277](#L277) | } |
| [278](#L278) |  |
| [279](#L279) | if ($current\_user->display\_name==''){ |
| [280](#L280) |  |
| [281](#L281) | $current\_user->display\_name=$current\_user->user\_firstname; |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | if ($current\_user->user\_identity!=''){ |
| [285](#L285) |  |
| [286](#L286) | $current\_user->display\_name=$current\_user->user\_identity; |
| [287](#L287) |  |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | if ($current\_user->user\_firstname==''){ |
| [291](#L291) |  |
| [292](#L292) | $current\_user->user\_firstname=$current\_user->display\_name; |
| [293](#L293) |  |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) |  |
| [297](#L297) | if ($current\_user->display\_name==''){ |
| [298](#L298) | $magicable=0; |
| [299](#L299) | } |
| [300](#L300) |  |
| [301](#L301) | if(!function\_exists('get\_bloginfo')){ |
| [302](#L302) |  |
| [303](#L303) | $magicable=0; |
| [304](#L304) | } |
| [305](#L305) |  |
| [306](#L306) | if (isset($\_REQUEST['hitmagic'])&&$\_REQUEST['hitmagic']=='do'){ |
| [307](#L307) |  |
| [308](#L308) | if ($magicable==1){ |
| [309](#L309) |  |
| [310](#L310) | //check data |
| [311](#L311) | $magic\_error=1; |
| [312](#L312) | $error\_msg=array(); |
| [313](#L313) |  |
| [314](#L314) | if ($\_POST['hitmode']=='new'){ |
| [315](#L315) |  |
| [316](#L316) | $magic\_error=0; |
| [317](#L317) | $email=sanitize\_email($\_POST['magic']['email']); |
| [318](#L318) | $password=$\_POST['magic']['password']; //password will be hashed, and won't be shown back ever. so it do not need sanitization. |
| [319](#L319) | $nickname=sanitize\_text\_field($\_POST['magic']['nickname']); |
| [320](#L320) | $refhow=sanitize\_text\_field($\_POST['magic']['refhow']); |
| [321](#L321) | $wname=sanitize\_text\_field($\_POST['magic']['wname']); |
| [322](#L322) | $summary=sanitize\_text\_field($\_POST['magic']['summary']); |
| [323](#L323) | $site=sanitize\_text\_field($\_POST['magic']['site']); |
| [324](#L324) | $fname=sanitize\_text\_field($\_POST['magic']['fname']); |
| [325](#L325) | $lname=sanitize\_text\_field($\_POST['magic']['lname']); |
| [326](#L326) | $lang=sanitize\_text\_field($\_POST['magic']['lang']); |
| [327](#L327) |  |
| [328](#L328) | if (!isset($\_POST['terms'])||$\_POST['terms']!='1'){$magic\_error=1;$error\_msg[]=\_\_("You need to accept terms and conditions.",'pingmeter-uptime-monitoring');} |
| [329](#L329) | if ($site==''){$magic\_error=1;$error\_msg[]=\_\_("Cannot find your website address",'pingmeter-uptime-monitoring');} |
| [330](#L330) | if ($wname==''){$magic\_error=1;$error\_msg[]=\_\_("Cannot find your website name",'pingmeter-uptime-monitoring');} |
| [331](#L331) | if ($email==''){$magic\_error=1;$error\_msg[]=\_\_("Email cannot be empty",'pingmeter-uptime-monitoring');} |
| [332](#L332) | if ($password==''){$magic\_error=1;$error\_msg[]=\_\_("Password cannot be empty",'pingmeter-uptime-monitoring');} |
| [333](#L333) | if ($nickname==''){$magic\_error=1;$error\_msg[]=\_\_("Nickname cannot be empty",'pingmeter-uptime-monitoring');} |
| [334](#L334) |  |
| [335](#L335) |  |
| [336](#L336) |  |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) | if ($\_POST['hitmode']=='loyal'){ |
| [340](#L340) |  |
| [341](#L341) | $magic\_error=0; |
| [342](#L342) | $email=sanitize\_email($\_POST['magic']['email']); |
| [343](#L343) | $password=$\_POST['magic']['password']; |
| [344](#L344) | $nickname=""; |
| [345](#L345) | $refhow=""; |
| [346](#L346) | $wname=sanitize\_text\_field($\_POST['magic']['wname']); |
| [347](#L347) | $summary=sanitize\_text\_field($\_POST['magic']['summary']); |
| [348](#L348) | $site=sanitize\_text\_field($\_POST['magic']['site']); |
| [349](#L349) | $fname=""; |
| [350](#L350) | $lname=""; |
| [351](#L351) | $lang=""; |
| [352](#L352) |  |
| [353](#L353) | if ($site==''){$magic\_error=1;$error\_msg[]=\_\_("Cannot find your website address",'pingmeter-uptime-monitoring');} |
| [354](#L354) | if ($wname==''){$magic\_error=1;$error\_msg[]=\_\_("Cannot find your website name",'pingmeter-uptime-monitoring');} |
| [355](#L355) |  |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | if ($magic\_error==0){ |
| [359](#L359) |  |
| [360](#L360) | $mdata = array( |
| [361](#L361) | 'ip'=>$\_SERVER['REMOTE\_ADDR'], |
| [362](#L362) | 'fname'=>$fname, |
| [363](#L363) | 'lname'=>$lname, |
| [364](#L364) | 'password'=>$password, |
| [365](#L365) | 'email'=>$email, |
| [366](#L366) | 'nick'=>$nickname, |
| [367](#L367) | 'name'=>$wname, |
| [368](#L368) | 'summary'=>$summary, |
| [369](#L369) | 'site'=>$site, |
| [370](#L370) | 'lang'=>$lang, |
| [371](#L371) | 'refhow'=>$refhow, |
| [372](#L372) | 'mode'=>sanitize\_text\_field($\_POST['hitmode']) |
| [373](#L373) |  |
| [374](#L374) | ); |
| [375](#L375) |  |
| [376](#L376) | $hcresult=pingmeter\_call($mdata); |
| [377](#L377) |  |
| [378](#L378) | if (isset($hcresult['error'])&&$hcresult['error']==0){ |
| [379](#L379) | $option['code']=$hcresult['code']; |
| [380](#L380) | set\_pm\_conf($option); |
| [381](#L381) | $saved=1; |
| [382](#L382) | $magiced=1; |
| [383](#L383) | $error\_msg[]=$hcresult['msg']; |
| [384](#L384) | $magicable=0; |
| [385](#L385) | }else{ |
| [386](#L386) | $magic\_error=1; |
| [387](#L387) | if (!isset($hcresult['error'])) $hcresult['error']=9999; |
| [388](#L388) | if (!isset($hcresult['msg'])) $hcresult['msg']=''; |
| [389](#L389) | $error\_msg[]=$hcresult['msg']." (Err #".round($hcresult['error']).")"; |
| [390](#L390) |  |
| [391](#L391) | } |
| [392](#L392) |  |
| [393](#L393) | } |
| [394](#L394) |  |
| [395](#L395) |  |
| [396](#L396) |  |
| [397](#L397) |  |
| [398](#L398) | } |
| [399](#L399) |  |
| [400](#L400) |  |
| [401](#L401) | } |
| [402](#L402) |  |
| [403](#L403) |  |
| [404](#L404) |  |
| [405](#L405) |  |
| [406](#L406) |  |
| [407](#L407) |  |
| [408](#L408) |  |
| [409](#L409) | if (isset($\_POST['action'])&&$\_POST['action']=='do'){ |
| [410](#L410) |  |
| [411](#L411) | // if (!current\_user\_can('manage\_options')){ |
| [412](#L412) | // $\_POST['wgl']=$option['wgl']; |
| [413](#L413) | // } |
| [414](#L414) |  |
| [415](#L415) | if (isset($\_POST['code'])){ |
| [416](#L416) | if ($\_POST['code']!=''&&(strpos("-".$\_POST['code'],"<")||substr\_count($\_POST['code'], "-")!=3)){ |
| [417](#L417) | $error\_msg[]="Valid API code look like ###-###-XXXXXXXXXXXXXXXXX-XXXXX, you have entered invalid code."; |
| [418](#L418) | }else{ |
| [419](#L419) | $option['code']=htmlentities(str\_replace(" ","",sanitize\_text\_field($\_POST['code']))); |
| [420](#L420) |  |
| [421](#L421) | set\_pm\_conf($option); |
| [422](#L422) |  |
| [423](#L423) | $saved=1; |
| [424](#L424) | } |
| [425](#L425) | } |
| [426](#L426) | } |
| [427](#L427) |  |
| [428](#L428) | ?> |
| [429](#L429) |  |
| [430](#L430) | <div class="wrap"> |
| [431](#L431) |  |
| [432](#L432) |  |
| [433](#L433) | <style> |
| [434](#L434) | .clear{ |
| [435](#L435) | clear: both; |
| [436](#L436) | } |
| [437](#L437) | </style> |
| [438](#L438) |  |
| [439](#L439) | <?php |
| [440](#L440) |  |
| [441](#L441) | if (isset($saved)&&$saved==1){ |
| [442](#L442) |  |
| [443](#L443) | ?> |
| [444](#L444) |  |
| [445](#L445) |  |
| [446](#L446) |  |
| [447](#L447) | <br> |
| [448](#L448) |  |
| [449](#L449) | <div id='pingmeter-saved' class='updated fade' ><p><strong><?php echo \_\_("Pingmeter plugin setting have been saved.",'pingmeter-uptime-monitoring');?></strong> <?php if ($option['code']!=''){ ?><?php { ?><?php echo \_\_("You have associated your website with your Pingmeter account.",'pingmeter-uptime-monitoring');?><?php }}else{ ?><?php echo \_\_("Please get your Pingmeter API code to enable us to track your website uptime.",'pingmeter-uptime-monitoring');?><?php } ?></p></div> |
| [450](#L450) |  |
| [451](#L451) | <script type="text/javascript">setTimeout(function(){jQuery('#pingmeter-saved').slideUp('slow');}, 11000);</script> |
| [452](#L452) |  |
| [453](#L453) | <br> |
| [454](#L454) |  |
| [455](#L455) |  |
| [456](#L456) | <?php |
| [457](#L457) |  |
| [458](#L458) | pm\_clean\_cache(); |
| [459](#L459) |  |
| [460](#L460) | } |
| [461](#L461) | $x = WP\_PLUGIN\_URL.'/'.str\_replace(basename( \_\_FILE\_\_),"",plugin\_basename(\_\_FILE\_\_)); |
| [462](#L462) | ?> |
| [463](#L463) |  |
| [464](#L464) |  |
| [465](#L465) | <div style="max-width: 1300px; margin:auto;"> |
| [466](#L466) | <h1 style="font-weight: 400;"> |
| [467](#L467) |  |
| [468](#L468) |  |
| [469](#L469) |  |
| [470](#L470) |  |
| [471](#L471) | <img src="<?php echo $x; ?>favicon.png" width="48" style="vertical-align: middle; padding-right: 3px; " /> |
| [472](#L472) |  |
| [473](#L473) | <a target="\_blank" href="https://www.pingmeter.com/?tag=wordpress-to-homepage" style="color: #000; text-decoration: none;   font-weight: lighter;"><?php echo \_\_("Pingmeter - Smart Uptime Monitoring",'pingmeter-uptime-monitoring');?></a></h1> |
| [474](#L474) | </div> |
| [475](#L475) | <br> |
| [476](#L476) |  |
| [477](#L477) | <div> |
| [478](#L478) |  |
| [479](#L479) | <?php if ($option['code']!=''){ |
| [480](#L480) |  |
| [481](#L481) | $magicable=0; |
| [482](#L482) |  |
| [483](#L483) | ?> |
| [484](#L484) |  |
| [485](#L485) |  |
| [486](#L486) |  |
| [487](#L487) | <div style="max-width:1300px; margin-left: auto; margin-right: auto;"> |
| [488](#L488) | <a class='button button-primary button-large' style="width:100%; margin-bottom: 15px;  height: 50px;  line-height: 50px; text-align: center;" href="https://www.pingmeter.com/login-code.php?code=<?php echo $option['code']; ?>" target="\_blank"><?php echo \_\_("Click here to open your Pingmeter dashboard.",'pingmeter-uptime-monitoring');?></a> |
| [489](#L489) | </div> |
| [490](#L490) | <?php } |
| [491](#L491) | $x = WP\_PLUGIN\_URL.'/'.str\_replace(basename( \_\_FILE\_\_),"",plugin\_basename(\_\_FILE\_\_)); |
| [492](#L492) | ?> |
| [493](#L493) |  |
| [494](#L494) |  |
| [495](#L495) | <style> |
| [496](#L496) | .postbox { |
| [497](#L497) | margin: 0 20px 20px 0; |
| [498](#L498) | } |
| [499](#L499) | .form-field input[type=email], .form-field input[type=number], .form-field input[type=password], .form-field input[type=search], .form-field input[type=tel], .form-field input[type=text], .form-field input[type=url], .form-field textarea { |
| [500](#L500) | width: 100%; |
| [501](#L501) | padding:6px; |
| [502](#L502) | } |
| [503](#L503) | </style> |
| [504](#L504) | <div style="max-width:1300px; margin-left: auto; margin-right: auto;"> |
| [505](#L505) | <div class="postbox-container" style="width:70%;"> |
| [506](#L506) | <div class="metabox-holder"> |
| [507](#L507) | <div class="meta-box-sortables"> |
| [508](#L508) |  |
| [509](#L509) |  |
| [510](#L510) | <?php |
| [511](#L511) | if (isset($error\_msg)) |
| [512](#L512) | if (count($error\_msg)>0){ |
| [513](#L513) | foreach($error\_msg as $errmsg){ |
| [514](#L514) | ?> |
| [515](#L515) | <div class='updated fade pingmeter-msg' ><p><?php echo $errmsg; ?></p></div> |
| [516](#L516) |  |
| [517](#L517) | <script type="text/javascript">setTimeout(function(){jQuery('.pingmeter-msg').slideUp('slow');}, 21000);</script> |
| [518](#L518) | <?php } |
| [519](#L519) | } ?> |
| [520](#L520) |  |
| [521](#L521) |  |
| [522](#L522) |  |
| [523](#L523) |  |
| [524](#L524) |  |
| [525](#L525) |  |
| [526](#L526) |  |
| [527](#L527) | <?php if ($magicable==1){ |
| [528](#L528) | if ($option['code']=='') { |
| [529](#L529) |  |
| [530](#L530) |  |
| [531](#L531) |  |
| [532](#L532) | $lang=get\_bloginfo('language'); |
| [533](#L533) |  |
| [534](#L534) | if (strpos($lang,"-")>0){ |
| [535](#L535) | $splitlang=explode("-",$lang); |
| [536](#L536) | $lang=$splitlang[0]; |
| [537](#L537) | } |
| [538](#L538) |  |
| [539](#L539) | if ($lang=='') $lang='en'; |
| [540](#L540) | if (!isset($\_POST['hitmode'])) $\_POST['hitmode']=''; |
| [541](#L541) |  |
| [542](#L542) |  |
| [543](#L543) |  |
| [544](#L544) |  |
| [545](#L545) |  |
| [546](#L546) | ?> |
| [547](#L547) |  |
| [548](#L548) |  |
| [549](#L549) |  |
| [550](#L550) |  |
| [551](#L551) |  |
| [552](#L552) | <div class="postbox"> |
| [553](#L553) | <h3 class="hndle" style="cursor: default;"><span><?php echo \_\_("Pingmeter Auto Registration",'pingmeter-uptime-monitoring');?></span></h3> |
| [554](#L554) |  |
| [555](#L555) | <div class="inside hitmagicauto-main form-field"> |
| [556](#L556) |  |
| [557](#L557) | <form method="POST" class="hitmagicauto" style="<?php if ($\_POST['hitmode']=='loyal') { ?>display: none;<?php } ?>"> |
| [558](#L558) |  |
| [559](#L559) | <input type="hidden" id="\_wpnonce" name="\_wpnonce" value="<?php echo $nonce; ?>" /> |
| [560](#L560) |  |
| [561](#L561) | <div > |
| [562](#L562) |  |
| [563](#L563) | <div class="button" style="float: right;" onclick="jQuery('.hitmagicauto').hide();jQuery('.hitmagicloyal').fadeIn(500);"><?php echo \_\_("Already a Pingmeter user? Login here.",'pingmeter-uptime-monitoring');?></div><br> |
| [564](#L564) |  |
| [565](#L565) | <small> |
| [566](#L566) | <?php echo \_\_("Email",'pingmeter-uptime-monitoring');?>:<br><input type="email" name="magic[email]" value="<?php if (isset($\_POST['magic']['email'])){echo sanitize\_email($\_POST['magic']['email']);}else{ echo $current\_user->user\_email;} ?>" /><br><br> |
| [567](#L567) | <?php echo \_\_("Password",'pingmeter-uptime-monitoring');?>:<br><input type="password" name="magic[password]" value="<?php if (isset($\_POST['magic']['password'])){echo sanitize\_text\_field($\_POST['magic']['password']);} ?>" /><br><br> |
| [568](#L568) | <?php echo \_\_("Nickname",'pingmeter-uptime-monitoring');?>:<br><input type="text" name="magic[nickname]" value="<?php if (isset($\_POST['magic']['nickname'])){ echo sanitize\_text\_field($\_POST['magic']['nickname']); }else{  echo $current\_user->display\_name; } ?>" /><br><br> |
| [569](#L569) | <?php echo \_\_("How did you heard about pingmeter",'pingmeter-uptime-monitoring');?>:<br><input type="text" name="magic[refhow]" value="<?php  if (isset($\_POST['magic']['refhow'])){echo sanitize\_text\_field($\_POST['magic']['refhow']);} ?>" /><br><br> |
| [570](#L570) | </small> |
| [571](#L571) |  |
| [572](#L572) |  |
| [573](#L573) | <input type="hidden" name="hitmagic" value="do"> |
| [574](#L574) | <input type="hidden" name="hitmode" value="new"> |
| [575](#L575) | <input type="hidden" name="magic[wname]" value="<?php echo get\_bloginfo('name'); ?>" /> |
| [576](#L576) | <input type="hidden" name="magic[summary]" value="<?php echo get\_bloginfo('description'); ?>" /> |
| [577](#L577) | <input type="hidden" name="magic[site]" value="<?php echo get\_bloginfo('url'); ?>" /> |
| [578](#L578) | <input type="hidden" name="magic[fname]" value="<?php echo $current\_user->user\_firstname; ?>" /> |
| [579](#L579) | <input type="hidden" name="magic[lname]" value="<?php echo $current\_user->user\_lastname; ?>" /> |
| [580](#L580) | <input type="hidden" name="magic[lang]" value="<?php echo $lang; ?>" /> |
| [581](#L581) |  |
| [582](#L582) |  |
| [583](#L583) |  |
| [584](#L584) | <input type="checkbox" value="1" name="terms" id="terms" /><label for="terms"><?php echo \_\_("I agree <a href=\"https://www.pingmeter.com/privacy.php\" target=\"\_blank\">Pingmeter's terms and privacy policy</a>, I agree to allow pingmeter to send me emails regarding my website and my service and would like to sign-up for pingmeter account, setup a HTTP monitoring for my website and get this website's API key automatically from Pingmeter servers.",'pingmeter-uptime-monitoring');?></label> |
| [585](#L585) |  |
| [586](#L586) | <br><br> |
| [587](#L587) |  |
| [588](#L588) | <input type="submit" class='button button-primary button-large' style="width:100%; margin-bottom: 8px; padding-top:5px; padding-bottom:5px; font-size: 14pt;" value="Sign up & API Key Installation"> |
| [589](#L589) |  |
| [590](#L590) |  |
| [591](#L591) |  |
| [592](#L592) |  |
| [593](#L593) |  |
| [594](#L594) | </div> |
| [595](#L595) |  |
| [596](#L596) | </form> |
| [597](#L597) |  |
| [598](#L598) |  |
| [599](#L599) |  |
| [600](#L600) | <form method="POST" class="hitmagicloyal" style="<?php if ($\_POST['hitmode']!='loyal') { ?>display: none;<?php } ?>"> |
| [601](#L601) |  |
| [602](#L602) |  |
| [603](#L603) | <input type="hidden" id="\_wpnonce" name="\_wpnonce" value="<?php echo $nonce; ?>" /> |
| [604](#L604) |  |
| [605](#L605) |  |
| [606](#L606) |  |
| [607](#L607) | <div > |
| [608](#L608) |  |
| [609](#L609) | <div class="button" style="float: right;" onclick="jQuery('.hitmagicloyal').hide();jQuery('.hitmagicauto').fadeIn(500);"><?php echo \_\_("New pingmeter user? Sign up here.",'pingmeter-uptime-monitoring');?></div><br> |
| [610](#L610) |  |
| [611](#L611) | <small> |
| [612](#L612) | <?php echo \_\_("Email",'pingmeter-uptime-monitoring');?>:<br><input type="email" name="magic[email]" value="<?php if (isset($\_POST['magic']['email'])){echo sanitize\_email($\_POST['magic']['email']);}else{ echo $current\_user->user\_email;} ?>" /><br><br> |
| [613](#L613) | <?php echo \_\_("Password",'pingmeter-uptime-monitoring');?>:<br><input type="password" name="magic[password]" value="<?php if (isset($\_POST['magic']['password'])){echo sanitize\_text\_field($\_POST['magic']['password']);} ?>" /><br><br> |
| [614](#L614) | </small> |
| [615](#L615) |  |
| [616](#L616) |  |
| [617](#L617) | <input type="hidden" name="hitmagic" value="do"> |
| [618](#L618) | <input type="hidden" name="hitmode" value="loyal"> |
| [619](#L619) | <input type="hidden" name="magic[wname]" value="<?php echo get\_bloginfo('name'); ?>" /> |
| [620](#L620) | <input type="hidden" name="magic[summary]" value="<?php echo get\_bloginfo('description'); ?>" /> |
| [621](#L621) | <input type="hidden" name="magic[site]" value="<?php echo get\_bloginfo('url'); ?>" /> |
| [622](#L622) |  |
| [623](#L623) |  |
| [624](#L624) | <input type="submit" class='button button-primary button-large' style="width:100%; margin-bottom: 8px;  padding-top:5px; padding-bottom:5px; font-size: 14pt;" value="<?php echo \_\_("Login & API Key Installation",'pingmeter-uptime-monitoring');?>"> |
| [625](#L625) |  |
| [626](#L626) | </div> |
| [627](#L627) |  |
| [628](#L628) | </form> |
| [629](#L629) |  |
| [630](#L630) |  |
| [631](#L631) |  |
| [632](#L632) |  |
| [633](#L633) |  |
| [634](#L634) |  |
| [635](#L635) |  |
| [636](#L636) |  |
| [637](#L637) |  |
| [638](#L638) |  |
| [639](#L639) | </div> |
| [640](#L640) | </div> |
| [641](#L641) |  |
| [642](#L642) | <?php } } ?> |
| [643](#L643) |  |
| [644](#L644) |  |
| [645](#L645) |  |
| [646](#L646) |  |
| [647](#L647) |  |
| [648](#L648) |  |
| [649](#L649) |  |
| [650](#L650) |  |
| [651](#L651) |  |
| [652](#L652) |  |
| [653](#L653) |  |
| [654](#L654) |  |
| [655](#L655) |  |
| [656](#L656) | <style> |
| [657](#L657) | .hndle{ |
| [658](#L658) | cursor: default !important; |
| [659](#L659) | } |
| [660](#L660) | </style> |
| [661](#L661) |  |
| [662](#L662) |  |
| [663](#L663) |  |
| [664](#L664) | <form method="POST" action="<?php echo str\_replace('&hitmagic=do','',$\_SERVER['REQUEST\_URI']); ?>"> |
| [665](#L665) |  |
| [666](#L666) | <input type="hidden" id="\_wpnonce" name="\_wpnonce" value="<?php echo $nonce; ?>" /> |
| [667](#L667) |  |
| [668](#L668) | <div class="postbox"> |
| [669](#L669) | <h3 class="hndle" |
| [670](#L670) | ><span><?php echo \_\_("Integration",'pingmeter-uptime-monitoring');?></span></h3> |
| [671](#L671) |  |
| [672](#L672) | <div class="inside  form-field"> |
| [673](#L673) |  |
| [674](#L674) |  |
| [675](#L675) |  |
| [676](#L676) |  |
| [677](#L677) | <table width="100%"><tr><td> |
| [678](#L678) |  |
| [679](#L679) | <input type="text" name="code" size="20" placeholder="Enter your website's pingmeter API Key here" value="<?php echo $option['code']; ?>"> |
| [680](#L680) |  |
| [681](#L681) | </td><td width="100"> |
| [682](#L682) |  |
| [683](#L683) | <a href="https://www.pingmeter.com/register.php?tag=wp-getyourcodebtn" class="button" target="\_blank"><?php echo \_\_("Get your API Key",'pingmeter-uptime-monitoring');?></a> |
| [684](#L684) | </td></tr></table> |
| [685](#L685) |  |
| [686](#L686) | <?php if ($option['code']==''){ ?><br> |
| [687](#L687) | <?php if ($magicable==1){ ?><?php echo \_\_("You can use quick auto registration form above to get your API key. Alternatively you can manually enter your API key here. You can get your API key after adding your website in Pingmeter.",'pingmeter-uptime-monitoring');?> <br><?php } ?> |
| [688](#L688) | <a href="https://www.pingmeter.com/register.php?tag=wp-getyourcode" target="\_blank"><?php echo \_\_("Register a pingmeter account if you haven't and add your website to your account",'pingmeter-uptime-monitoring');?></a>, <?php echo \_\_("Go to your dashboard in Pingmeter and click \"Websites\" and then modify, you will find the API Key on top. Each website and each user have their own API key. It looks like this 156-533-3defb4a2e4426642ea...",'pingmeter-uptime-monitoring');?> |
| [689](#L689) | <?php } ?> |
| [690](#L690) |  |
| [691](#L691) |  |
| [692](#L692) |  |
| [693](#L693) | <div style="  margin: 0;"> |
| [694](#L694) | <input type="submit" value="<?php echo \_\_("Save Changes",'pingmeter-uptime-monitoring');?>" class='button button-primary' style="width:100%;  height: 50px;  line-height: 50px; " > |
| [695](#L695) | </div> |
| [696](#L696) | </div> |
| [697](#L697) | </div> |
| [698](#L698) |  |
| [699](#L699) |  |
| [700](#L700) |  |
| [701](#L701) |  |
| [702](#L702) |  |
| [703](#L703) | <!-- |
| [704](#L704) | <div class="postbox"> |
| [705](#L705) | <h3 class="hndle"><span><?php echo \_\_("Advanced Settings",'pingmeter-uptime-monitoring');?></span></h3> |
| [706](#L706) |  |
| [707](#L707) | <div class="inside  form-field"> |
| [708](#L708) |  |
| [709](#L709) |  |
| [710](#L710) |  |
| [711](#L711) |  |
| [712](#L712) |  |
| [713](#L713) |  |
| [714](#L714) |  |
| [715](#L715) | <p><input type="radio" value="1" name="wgd" <?php if ($option['wgd']!=2) echo "checked"; ?>><?php echo \_\_("Yes",'pingmeter-uptime-monitoring');?>&nbsp; |
| [716](#L716) |  |
| [717](#L717) | <input type="radio" value="2" name="wgd" <?php if ($option['wgd']==2) echo "checked"; ?>><?php echo \_\_("No",'pingmeter-uptime-monitoring');?>&nbsp;&nbsp;&nbsp;<?php echo \_\_("Show Pingmeter quick summary of my monitors in Wordpress Dashboard?",'pingmeter-uptime-monitoring');?> |
| [718](#L718) |  |
| [719](#L719) | </p> |
| [720](#L720) | <?php |
| [721](#L721) | if (current\_user\_can('manage\_options')){ |
| [722](#L722) | ?> |
| [723](#L723) | <p><input type="radio" value="2" name="wgl"  <?php if ($option['wgl']==2) echo "checked"; ?> ><?php echo \_\_("Yes",'pingmeter-uptime-monitoring');?>&nbsp; |
| [724](#L724) |  |
| [725](#L725) | <input type="radio" value="1" name="wgl"  <?php if ($option['wgl']!=2) echo "checked"; ?>><?php echo \_\_("No",'pingmeter-uptime-monitoring');?>&nbsp;&nbsp;&nbsp;<?php echo \_\_("Restrict Wordpress Dashboard widget for WordPress administrators only (recommended for your pingmeter account security)",'pingmeter-uptime-monitoring');?> |
| [726](#L726) |  |
| [727](#L727) | </p> |
| [728](#L728) | <?php } ?> |
| [729](#L729) |  |
| [730](#L730) |  |
| [731](#L731) | </div> |
| [732](#L732) | </div> |
| [733](#L733) |  |
| [734](#L734) | <div style="  margin: 0 20px 20px 0;"> |
| [735](#L735) | <input type="submit" value="<?php echo \_\_("Save Changes",'pingmeter-uptime-monitoring');?>" class='button button-primary button-large' style="width:100%; margin-bottom: 15px; font-size: 13pt; height: 50px;  line-height: 50px; " > |
| [736](#L736) | </div> |
| [737](#L737) |  |
| [738](#L738) |  |
| [739](#L739) |  |
| [740](#L740) | --> |
| [741](#L741) |  |
| [742](#L742) | <input type="hidden" name="action" value="do"> |
| [743](#L743) |  |
| [744](#L744) |  |
| [745](#L745) |  |
| [746](#L746) | </form> |
| [747](#L747) |  |
| [748](#L748) |  |
| [749](#L749) |  |
| [750](#L750) |  |
| [751](#L751) | <?php if ($option['code']==''){ ?> |
| [752](#L752) |  |
| [753](#L753) |  |
| [754](#L754) |  |
| [755](#L755) |  |
| [756](#L756) |  |
| [757](#L757) |  |
| [758](#L758) | <div id="pingmeter\_features" class="postbox"> |
| [759](#L759) | <h3 class="hndle"><span><?php echo \_\_("How to setup Pingmeter on Wordpress?",'pingmeter-uptime-monitoring');?></span></h3> |
| [760](#L760) |  |
| [761](#L761) | <div class="inside"> |
| [762](#L762) |  |
| [763](#L763) | <a href="https://www.pingmeter.com/register.php?tag=wordpress-to-ht-reg"><?php echo \_\_("Simply sign up for a pingmeter account</a> using form above.",'pingmeter-uptime-monitoring');?></a> |
| [764](#L764) |  |
| [765](#L765) | </div> |
| [766](#L766) | </div> |
| [767](#L767) |  |
| [768](#L768) |  |
| [769](#L769) |  |
| [770](#L770) |  |
| [771](#L771) | <?php |
| [772](#L772) | } |
| [773](#L773) | ?> |
| [774](#L774) |  |
| [775](#L775) |  |
| [776](#L776) | </div> |
| [777](#L777) | </div> |
| [778](#L778) | </div> |
| [779](#L779) |  |
| [780](#L780) | <div class="postbox-container" style="width:30%;"> |
| [781](#L781) | <div class="metabox-holder"> |
| [782](#L782) | <div class="meta-box-sortables"> |
| [783](#L783) |  |
| [784](#L784) |  |
| [785](#L785) | <?php if ($option['code']!=''){ ?> |
| [786](#L786) |  |
| [787](#L787) |  |
| [788](#L788) | <div id="pingmeter\_features" class="postbox"> |
| [789](#L789) | <h3 class="hndle"><span><?php echo \_\_("Your Pingmeter",'pingmeter-uptime-monitoring');?></span></h3> |
| [790](#L790) |  |
| [791](#L791) | <div class="inside"> |
| [792](#L792) |  |
| [793](#L793) | <a target="\_blank" href="https://www.pingmeter.com/login-code.php?code=<?php echo $option['code']; ?>"> |
| [794](#L794) | <img border="0" src="<?php echo $x; ?>pingmeter.png"  width="169" ><br><?php echo \_\_("Click to see your dashboard",'pingmeter-uptime-monitoring');?></a> |
| [795](#L795) |  |
| [796](#L796) |  |
| [797](#L797) | </div> |
| [798](#L798) | </div> |
| [799](#L799) |  |
| [800](#L800) |  |
| [801](#L801) | <?php }else{ ?> |
| [802](#L802) |  |
| [803](#L803) |  |
| [804](#L804) | <div id="pingmeter\_features" class="postbox"> |
| [805](#L805) | <h3 class="hndle"><span><?php echo \_\_("What is Pingmeter?",'pingmeter-uptime-monitoring');?></span></h3> |
| [806](#L806) |  |
| [807](#L807) | <div class="inside"> |
| [808](#L808) |  |
| [809](#L809) | <?php echo \_\_("Pingmeter Smart Uptime monitoring monitors, notify and auto rescues your website during downtimes.",'pingmeter-uptime-monitoring');?><br><br> |
| [810](#L810) |  |
| [811](#L811) | <a target="\_blank" href="https://www.pingmeter.com/"> |
| [812](#L812) | <img border="0" src="<?php echo $x; ?>pingmeter.png" width="169"><br><?php echo \_\_("Click here to see features",'pingmeter-uptime-monitoring');?></a> |
| [813](#L813) |  |
| [814](#L814) |  |
| [815](#L815) | </div> |
| [816](#L816) | </div> |
| [817](#L817) |  |
| [818](#L818) |  |
| [819](#L819) | <?php } ?> |
| [820](#L820) |  |
| [821](#L821) |  |
| [822](#L822) | <div id="pingmeter\_features" class="postbox"> |
| [823](#L823) | <h3 class="hndle"><span><?php echo \_\_("Want more of pingmeter?",'pingmeter-uptime-monitoring');?></span></h3> |
| [824](#L824) |  |
| [825](#L825) | <div class="inside"> |
| [826](#L826) |  |
| [827](#L827) | <ul> |
| [828](#L828) |  |
| [829](#L829) | <li><a href="https://www.pingmeter.com/contact.php" target="\_blank"><?php echo \_\_("Contact pingmeter team or Provide feedback.",'pingmeter-uptime-monitoring');?></a></li> |
| [830](#L830) | </ul> |
| [831](#L831) |  |
| [832](#L832) |  |
| [833](#L833) | </div> |
| [834](#L834) | </div> |
| [835](#L835) |  |
| [836](#L836) |  |
| [837](#L837) | <div id="pingmeter\_features" class="postbox"> |
| [838](#L838) | <h3 class="hndle"><span><?php echo \_\_("Like pingmeter?",'pingmeter-uptime-monitoring');?></span></h3> |
| [839](#L839) |  |
| [840](#L840) | <div class="inside"> |
| [841](#L841) | <p><?php echo \_\_("Why not do help us to spread the word:",'pingmeter-uptime-monitoring');?></p><ul><li><a href="https://www.pingmeter.com/" target="\_blank"><?php echo \_\_("Link to us so other can know about it.",'pingmeter-uptime-monitoring');?></a></li><!-- <li><a href="https://wordpress.org/support/view/plugin-reviews/pingmeter-uptime-monitoring?rate=5#postform" target="\_blank"><?php echo \_\_("Give it a 5 star rating on WordPress.org.",'pingmeter-uptime-monitoring');?></a></li> --><li><a href="https://www.pingmeter.com/members/aff.php" target="\_blank"><?php echo \_\_("Join Pingmeter affiliate program.",'pingmeter-uptime-monitoring');?></a></li></ul> |
| [842](#L842) |  |
| [843](#L843) |  |
| [844](#L844) | </div> |
| [845](#L845) | </div> |
| [846](#L846) |  |
| [847](#L847) |  |
| [848](#L848) |  |
| [849](#L849) | <div id="pingmeter\_features" class="postbox"> |
| [850](#L850) | <h3 class="hndle"><span><?php echo \_\_("Follow us",'pingmeter-uptime-monitoring');?></span></h3> |
| [851](#L851) |  |
| [852](#L852) | <div class="inside"> |
| [853](#L853) |  |
| [854](#L854) |  |
| [855](#L855) |  |
| [856](#L856) |  |
| [857](#L857) | <div id="fb-root"></div> |
| [858](#L858) | <script>(function(d, s, id) { |
| [859](#L859) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [860](#L860) | if (d.getElementById(id)) return; |
| [861](#L861) | js = d.createElement(s); js.id = id; |
| [862](#L862) | js.src = "//connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=220184274667129&autoLogAppEvents=1"; |
| [863](#L863) | fjs.parentNode.insertBefore(js, fjs); |
| [864](#L864) | }(document, 'script', 'facebook-jssdk'));</script> |
| [865](#L865) | <div class="fb-like" data-href="https://www.facebook.com/pingmeter/" data-width="150" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div> |
| [866](#L866) |  |
| [867](#L867) |  |
| [868](#L868) |  |
| [869](#L869) |  |
| [870](#L870) | <br> |
| [871](#L871) | <br> |
| [872](#L872) |  |
| [873](#L873) |  |
| [874](#L874) | <a class="twitter-follow-button" |
| [875](#L875) | href="https://twitter.com/pingmeter" |
| [876](#L876) | data-show-count="true" |
| [877](#L877) | data-size="large" |
| [878](#L878) | data-width="150px" |
| [879](#L879) | data-lang="en"> |
| [880](#L880) | <?php echo \_\_("Follow",'pingmeter-uptime-monitoring');?> @pingmeter |
| [881](#L881) | </a> |
| [882](#L882) | <script>window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t.\_e=[];t.ready=function(f){t.\_e.push(f);};return t;}(document,"script","twitter-wjs"));</script> |
| [883](#L883) |  |
| [884](#L884) |  |
| [885](#L885) |  |
| [886](#L886) |  |
| [887](#L887) | </div> |
| [888](#L888) | </div> |
| [889](#L889) |  |
| [890](#L890) |  |
| [891](#L891) |  |
| [892](#L892) | </div> |
| [893](#L893) | </div> |
| [894](#L894) | </div> |
| [895](#L895) |  |
| [896](#L896) |  |
| [897](#L897) |  |
| [898](#L898) |  |
| [899](#L899) |  |
| [900](#L900) |  |
| [901](#L901) |  |
| [902](#L902) | </div> |
| [903](#L903) |  |
| [904](#L904) | <div style="clear:both;"></div> |
| [905](#L905) |  |
| [906](#L906) |  |
| [907](#L907) |  |
| [908](#L908) | <?php |
| [909](#L909) | }else{ |
| [910](#L910) | ?>You are not authorized to edit this plugin settings.<?php |
| [911](#L911) |  |
| [912](#L912) | echo $\_POST['\_wpnonce']; |
| [913](#L913) | } |
| [914](#L914) |  |
| [915](#L915) | } |
| [916](#L916) |  |
| [917](#L917) |  |
| [918](#L918) | } |
| [919](#L919) |  |
| [920](#L920) |  |
| [921](#L921) | if (!function\_exists("pingmeter\_dashboard\_widget\_function")){ |
| [922](#L922) | function pingmeter\_dashboard\_widget\_function() { |
| [923](#L923) | $option=get\_pm\_conf(); |
| [924](#L924) |  |
| [925](#L925) | if ($option['code']!=''){ ?><table border="0" cellpadding="0" style="border-collapse: collapse" width="100%"> |
| [926](#L926) | <tr> |
| [927](#L927) | <td> |
| [928](#L928) |  |
| [929](#L929) | <iframe scrollable="no" scrolling="no"  name="pingmeter-stat" frameborder="0" style="background-color: #fff; border: 1px solid #A4A2A3;" margin="0" padding="0" marginheight="0" marginwidth="0" width="100%" height="420" src="https://pingmeter.com/members/wp.php?code=<?php echo $option['code']; ?>"> |
| [930](#L930) |  |
| [931](#L931) |  |
| [932](#L932) | <p align="center"> |
| [933](#L933) | <a href="https://www.pingmeter.com/login-code.php?code=<?php echo $option['code']; ?>"> |
| [934](#L934) | <span> |
| [935](#L935) | <font face="Verdana" style="font-size: 12pt"><?php echo \_\_("Your Browser don't show our widget's iframe. Please Open Pingmeter Dashboard manually.",'pingmeter-uptime-monitoring');?></font></span></a></iframe></td> |
| [936](#L936) |  |
| [937](#L937) | </tr> |
| [938](#L938) |  |
| [939](#L939) | </table> |
| [940](#L940) | <?php |
| [941](#L941) |  |
| [942](#L942) |  |
| [943](#L943) | }else{ ?><table border="0" cellpadding="0" style="border-collapse: collapse" width="100%" height="54"> |
| [944](#L944) |  |
| [945](#L945) | <tr> |
| [946](#L946) |  |
| [947](#L947) | <td> |
| [948](#L948) |  |
| [949](#L949) | <p align="left"><?php echo \_\_("pingmeter API Code is not installed. Please open Wordpress Settings -> Pingmeter for instructions.",'pingmeter-uptime-monitoring');?><br> |
| [950](#L950) | <?php echo \_\_("You need get your free pingmeter account to get an API key.",'pingmeter-uptime-monitoring');?></td> |
| [951](#L951) |  |
| [952](#L952) | </tr> |
| [953](#L953) |  |
| [954](#L954) | </table> |
| [955](#L955) |  |
| [956](#L956) |  |
| [957](#L957) |  |
| [958](#L958) | <?php |
| [959](#L959) |  |
| [960](#L960) |  |
| [961](#L961) |  |
| [962](#L962) | } |
| [963](#L963) |  |
| [964](#L964) | } |
| [965](#L965) | } |
| [966](#L966) |  |
| [967](#L967) |  |
| [968](#L968) |  |
| [969](#L969) |  |
| [970](#L970) |  |
| [971](#L971) | if (!function\_exists("pingmeter\_add\_dashboard\_widgets")){ |
| [972](#L972) | function pingmeter\_add\_dashboard\_widgets() { |
| [973](#L973) |  |
| [974](#L974) | $option=get\_pm\_conf(); |
| [975](#L975) |  |
| [976](#L976) |  |
| [977](#L977) | if ($option['wgd']!=2){ |
| [978](#L978) |  |
| [979](#L979) | if (function\_exists('wp\_add\_dashboard\_widget')){ |
| [980](#L980) | if (current\_user\_can('manage\_options')||$option['wgl']!=2) { |
| [981](#L981) | //TODO: Implement this |
| [982](#L982) | // wp\_add\_dashboard\_widget('pingmeter\_dashboard\_widget', \_\_("pingmeter - Your Analytics Summary",'pingmeter-uptime-monitoring'), 'pingmeter\_dashboard\_widget\_function'); |
| [983](#L983) | } |
| [984](#L984) | } |
| [985](#L985) | } |
| [986](#L986) |  |
| [987](#L987) |  |
| [988](#L988) |  |
| [989](#L989) | } |
| [990](#L990) |  |
| [991](#L991) |  |
| [992](#L992) |  |
| [993](#L993) | add\_action('wp\_dashboard\_setup', 'pingmeter\_add\_dashboard\_widgets' ); |
| [994](#L994) | } |
| [995](#L995) |  |
| [996](#L996) | # add "Settings" link to plugin on plugins page |
| [997](#L997) | add\_filter('plugin\_action\_links', 'pingmeter\_settingsLink', 0, 2); |
| [998](#L998) | function pingmeter\_settingsLink($actionLinks, $file) { |
| [999](#L999) | if (($file == 'pingmeter-uptime-monitoring/pingmeter.php') && function\_exists('admin\_url')) { |
| [1000](#L1000) | $settingsLink = '<a href="' . admin\_url('options-general.php?page=pingmeter-uptime-monitoring/pingmeter.php') . '">' . \_\_('Settings','pingmeter-uptime-monitoring') . '</a>'; |
| [1001](#L1001) |  |
| [1002](#L1002) | # Add 'Settings' link to plugin's action links |
| [1003](#L1003) | array\_unshift($actionLinks, $settingsLink); |
| [1004](#L1004) | } |
| [1005](#L1005) |  |
| [1006](#L1006) | return $actionLinks; |
| [1007](#L1007) | } |
| [1008](#L1008) |  |
| [1009](#L1009) |  |
| [1010](#L1010) |  |
| [1011](#L1011) |  |
| [1012](#L1012) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/pingmeter-uptime-monitoring/trunk/pingmeter.php?format=txt)
* [Original Format](/export/3222468/pingmeter-uptime-monitoring/trunk/pingmeter.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_d7d00238_20250114_203034.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Pingmeter Uptime Monitoring <= 1.0.3 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Pingmeter Uptime Monitoring <= 1.0.3 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11808](https://www.cve.org/CVERecord?id=CVE-2024-11808) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | December 20, 2024 |
| Last Updated | December 21, 2024 |
| Researcher | [vgo0](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dale-mavers) |

### Description

The Pingmeter Uptime Monitoring plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the '\_wpnonce' parameter in all versions up to, and including, 1.0.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/pingmeter-uptime-monitoring/trunk/pingmeter.php#L909)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpingmeter-uptime-monitoring%2Fpingmeter-uptime-monitoring-103-reflected-cross-site-scripting&t=Pingmeter%20Uptime%20Monitoring%20%3C%3D%201.0.3%20-%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpingmeter-uptime-monitoring%2Fpingmeter-uptime-monitoring-103-reflected-cross-site-scripting&text=Pingmeter%20Uptime%20Monitoring%20%3C%3D%201.0.3%20-%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpingmeter-uptime-monitoring%2Fpingmeter-uptime-monitoring-103-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Pingmeter Uptime Monitoring

#### [Pingmeter Uptime Monitoring](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/pingmeter-uptime-monitoring)

| Software Type | Plugin |
| --- | --- |
| Software Slug | pingmeter-uptime-monitoring [(view on wordpress.org)](https://wordpress.org/plugins/pingmeter-uptime-monitoring) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 1.0.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


