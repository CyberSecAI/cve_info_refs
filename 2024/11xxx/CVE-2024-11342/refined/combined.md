=== Content from www.wordfence.com_ed58df22_20250114_182307.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Skt NURCaptcha <= 3.5.0 - Cross-Site Request Forgery to Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Skt NURCaptcha <= 3.5.0 - Cross-Site Request Forgery to Stored Cross-Site Scripting

6.1

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11342](https://www.cve.org/CVERecord?id=CVE-2024-11342) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | November 25, 2024 |
| Last Updated | November 26, 2024 |
| Researcher | [SOPROBRO](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/soprobro-2) |

### Description

The Skt NURCaptcha plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 3.5.0. This is due to missing or incorrect nonce validation in the skt-nurc-admin.php file. This makes it possible for unauthenticated attackers to update settings and inject malicious web scripts via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3195583%40skt-nurcaptcha&new=3195583%40skt-nurcaptcha&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fskt-nurcaptcha%2Fskt-nurcaptcha-350-cross-site-request-forgery-to-stored-cross-site-scripting&t=Skt%20NURCaptcha%20%3C%3D%203.5.0%20-%20Cross-Site%20Request%20Forgery%20%20to%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fskt-nurcaptcha%2Fskt-nurcaptcha-350-cross-site-request-forgery-to-stored-cross-site-scripting&text=Skt%20NURCaptcha%20%3C%3D%203.5.0%20-%20Cross-Site%20Request%20Forgery%20%20to%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fskt-nurcaptcha%2Fskt-nurcaptcha-350-cross-site-request-forgery-to-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Skt NURCaptcha

#### [Skt NURCaptcha](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/skt-nurcaptcha)

| Software Type | Plugin |
| --- | --- |
| Software Slug | skt-nurcaptcha [(view on wordpress.org)](https://wordpress.org/plugins/skt-nurcaptcha) |
| Patched? | Yes |
| Remediation | Update to version 3.6.0, or a newer patched version |
| Affected Version | * <= 3.5.0 |
| Patched Version | * 3.6.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_3ea18900_20250114_182302.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fskt-nurcaptcha%2Ftrunk%2Fskt-nurc-admin.php%3Frev%3D3195583)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=2364198 "Revision 2364198")
* [Latest Revision](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php)
* Next Revision →
* [Blame](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?annotate=blame&rev=3195583 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583)

---

# [source:](/browser?rev=3195583&order=name "Go to repository root") [skt-nurcaptcha](/browser/skt-nurcaptcha?rev=3195583&order=name "View skt-nurcaptcha")/[trunk](/browser/skt-nurcaptcha/trunk?rev=3195583&order=name "View trunk")/[skt-nurc-admin.php](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583&order=name "View skt-nurc-admin.php") @ [3195583](/changeset/3195583/ "View changeset 3195583")

View diff against:

View revision:

| [Last change](/changeset/3195583/skt-nurcaptcha/trunk/skt-nurc-admin.php "View differences") on this file since 3195583 was [3195583](/changeset/3195583/ "View changeset 3195583"), checked in by Sanskritforum, [7 weeks ago](/timeline?from=2024-11-23T17%3A58%3A06Z&precision=second "See timeline at 11/23/2024 05:58:06 PM") |
| --- |
| Version 3.6.0 - Fixed vulnerability to Cross-Site Request Forgery |
| **File size:** 26.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | // ============================================================ |
| [4](#L4) | if(get\_site\_option('sktnurc\_stopforumspam\_active')!==false) |
| [5](#L5) | delete\_site\_option( 'sktnurc\_stopforumspam\_active' ); |
| [6](#L6) | if(get\_site\_option('sktnurc\_recaptcha\_version')!==false) |
| [7](#L7) | delete\_site\_option( 'sktnurc\_recaptcha\_version' ); |
| [8](#L8) | if(get\_site\_option('sktnurc\_botscout\_active')!==false) |
| [9](#L9) | delete\_site\_option( 'sktnurc\_botscout\_active' ); |
| [10](#L10) | if(get\_site\_option('sktnurc\_botscoutkey')!==false) |
| [11](#L11) | delete\_site\_option( 'sktnurc\_botscoutkey' ); |
| [12](#L12) | if(get\_site\_option('sktnurc\_botscoutTestMode')!==false) |
| [13](#L13) | delete\_site\_option( 'sktnurc\_botscoutTestMode' ); |
| [14](#L14) | // =========================================================== |
| [15](#L15) | \*/ |
| [16](#L16) | if(get\_site\_option('sktnurc\_recaptcha\_language')=="") |
| [17](#L17) | update\_site\_option('sktnurc\_recaptcha\_language','xx'); |
| [18](#L18) | if(get\_site\_option('sktnurc\_data\_theme')=="") |
| [19](#L19) | update\_site\_option('sktnurc\_data\_theme', "light"); |
| [20](#L20) | if(get\_site\_option('sktnurc\_data\_type')=="") |
| [21](#L21) | update\_site\_option('sktnurc\_data\_type', "image"); |
| [22](#L22) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="") |
| [23](#L23) | update\_site\_option('sktnurc\_login\_recaptcha', "false"); |
| [24](#L24) |  |
| [25](#L25) |  |
| [26](#L26) |  |
| [27](#L27) | // \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
| [28](#L28) | $flag = ( isset( $\_POST['sktnonce'] )) ? (wp\_verify\_nonce( $\_POST['sktnonce'], 'sktn\_save\_data' )) ? true : false : false; |
| [29](#L29) | if ($flag) {  //Form data sent |
| [30](#L30) | $sktnurc\_pubkey = $\_POST['sktnurc\_publkey']; |
| [31](#L31) | update\_site\_option('sktnurc\_publkey', $sktnurc\_pubkey); |
| [32](#L32) |  |
| [33](#L33) | $sktnurc\_privkey = $\_POST['sktnurc\_privtkey']; |
| [34](#L34) | update\_site\_option('sktnurc\_privtkey', $sktnurc\_privkey); |
| [35](#L35) |  |
| [36](#L36) | // \*\*\*\*\*  update register form's help messages: |
| [37](#L37) | update\_site\_option('sktnurc\_username\_help', $\_POST['sktnurc\_username\_help']); |
| [38](#L38) | update\_site\_option('sktnurc\_email\_help', $\_POST['sktnurc\_email\_help']); |
| [39](#L39) | update\_site\_option('sktnurc\_v2\_reCaptcha\_help', $\_POST['sktnurc\_v2\_reCaptcha\_help']); |
| [40](#L40) | if(isset($\_POST['sktnurc\_usrhlp\_opt']) && ($\_POST['sktnurc\_usrhlp\_opt'] == 'true')){ |
| [41](#L41) | update\_site\_option('sktnurc\_usrhlp\_opt', 'true'); |
| [42](#L42) | }else{ |
| [43](#L43) | update\_site\_option('sktnurc\_usrhlp\_opt', 'false'); |
| [44](#L44) | } |
| [45](#L45) |  |
| [46](#L46) | if(isset($\_POST['sktnurc\_emlhlp\_opt']) && ($\_POST['sktnurc\_emlhlp\_opt'] == 'true')){ |
| [47](#L47) | update\_site\_option('sktnurc\_emlhlp\_opt', 'true'); |
| [48](#L48) | }else{ |
| [49](#L49) | update\_site\_option('sktnurc\_emlhlp\_opt', 'false'); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | if(isset($\_POST['sktnurc\_rechlp\_opt']) && ($\_POST['sktnurc\_rechlp\_opt'] == 'true')){ |
| [53](#L53) | update\_site\_option('sktnurc\_rechlp\_opt', 'true'); |
| [54](#L54) | }else{ |
| [55](#L55) | update\_site\_option('sktnurc\_rechlp\_opt', 'false'); |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) | // \*\*\*\*\* |
| [59](#L59) |  |
| [60](#L60) | update\_site\_option('sktnurc\_username\_help', $\_POST['sktnurc\_username\_help']); |
| [61](#L61) |  |
| [62](#L62) | $sktnurc\_logpage\_limit = absint($\_POST['sktnurc\_logpage\_limit']); |
| [63](#L63) | if ($sktnurc\_logpage\_limit < 5) $sktnurc\_logpage\_limit = 5; |
| [64](#L64) | update\_site\_option('sktnurc\_logpage\_limit', $sktnurc\_logpage\_limit); |
| [65](#L65) |  |
| [66](#L66) | update\_site\_option('sktnurc\_regbutton', $\_POST['sktnurc\_regbutton']); |
| [67](#L67) |  |
| [68](#L68) | if (isset($\_POST['sktnurc\_custom\_page\_list']) && (is\_array($\_POST['sktnurc\_custom\_page\_list']))){ |
| [69](#L69) | update\_site\_option('sktnurc\_custom\_page\_list', $\_POST['sktnurc\_custom\_page\_list']); |
| [70](#L70) | }else{ |
| [71](#L71) | update\_site\_option('sktnurc\_custom\_page\_list', NULL); |
| [72](#L72) | } |
| [73](#L73) | update\_site\_option('sktnurc\_data\_type', $\_POST['sktnurc\_data\_type']); |
| [74](#L74) | update\_site\_option('sktnurc\_data\_theme', $\_POST['sktnurc\_data\_theme']); |
| [75](#L75) | update\_site\_option('sktnurc\_login\_recaptcha', $\_POST['sktnurc\_login\_recaptcha']); |
| [76](#L76) | update\_site\_option('sktnurc\_recaptcha\_language', $\_POST['sktnurc\_recaptcha\_language']); |
| [77](#L77) |  |
| [78](#L78) |  |
| [79](#L79) | if ($\_POST['log\_clear']!= 'no') { |
| [80](#L80) | $clear\_log\_file = nurc\_clear\_log\_file(); |
| [81](#L81) | if ($clear\_log\_file !== false) { |
| [82](#L82) | ?> |
| [83](#L83) | <div class="updated"><p><strong><?php echo $clear\_log\_file; ?></strong></p></div> |
| [84](#L84) | <?php |
| [85](#L85) | }else{ |
| [86](#L86) | echo '<div class="error"><p><strong>'; |
| [87](#L87) | \_e('An Error occurred: Log File deletion was not possible.', 'skt-nurcaptcha' ); |
| [88](#L88) | echo '</strong></p></div>'; |
| [89](#L89) | } |
| [90](#L90) | } |
| [91](#L91) | ?> |
| [92](#L92) | <div class="updated"><p><strong><?php \_e('Options saved.', 'skt-nurcaptcha' ); ?></strong></p></div> |
| [93](#L93) | <?php |
| [94](#L94) | if ($botscoutkey\_verified == false) { |
| [95](#L95) | settings\_errors( 'botscoutkey' ); |
| [96](#L96) | } |
| [97](#L97) | } else { |
| [98](#L98) | //Normal page display |
| [99](#L99) | $sktnurc\_pubkey = get\_site\_option('sktnurc\_publkey'); |
| [100](#L100) | $sktnurc\_privkey = get\_site\_option('sktnurc\_privtkey'); |
| [101](#L101) | $sktnurc\_botscoutkey = get\_site\_option('sktnurc\_botscoutkey'); |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) |  |
| [105](#L105) | ?> |
| [106](#L106) | <div class="wrap"> |
| [107](#L107) | <?php |
| [108](#L108) | $nurc\_version = nurc\_get\_version(); |
| [109](#L109) | $nurc\_icon = plugin\_dir\_url(dirname(\_\_FILE\_\_).'/skt-nurcaptcha.php')."img/icon.svg"; |
| [110](#L110) | echo "<div style=\"margin-left:24px;\"><h2><img src=\"$nurc\_icon\" height=\"42\" width=\"42\" style=\"margin-right:4px;\" >" . \_\_( 'Skt NURCaptcha Settings', 'skt-nurcaptcha' ) . "</h2></div>"; |
| [111](#L111) | ?> |
| [112](#L112) |  |
| [113](#L113) | <div style="width:680px;padding:12px 0 12px 24px"> |
| [114](#L114) | <form name="sktnurc\_form" method="post" action="<?php echo admin\_url( "options-general.php?page=".$\_GET["page"] ) ?>"> |
| [115](#L115) | <?php wp\_nonce\_field( 'sktn\_save\_data', 'sktnonce' ); ?> |
| [116](#L116) | <input id="log\_clear" type="hidden" name="log\_clear" value="no" /> |
| [117](#L117) | <input id="confirm\_dialog" type="hidden" name="confirm\_dialog" value="<?php \_e( 'This option cannot be undone. Do you really want to erase all Log Data and restart Log File?', 'skt-nurcaptcha' ) ?>" /> |
| [118](#L118) | <?php echo \_\_('Version: ', 'skt-nurcaptcha') . $nurc\_version; ?> |
| [119](#L119) | <p style="padding: .5em; background-color: #666666; color: #fff;position:relative">Skt NURCaptcha |
| [120](#L120) | <?php   $total = skt\_nurc\_countlog(); |
| [121](#L121) | if ($total) { |
| [122](#L122) |  |
| [123](#L123) | echo \_\_( 'has blocked', 'skt-nurcaptcha' ) . " <strong> ".$total."</strong> ". \_\_( 'suspect register attempts on this site.', 'skt-nurcaptcha' ). "<span id='log\_button' class=\"log\_button button-primary\" style=\"position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:12px\">&nbsp;".\_\_('Toggle Log', 'skt-nurcaptcha')."&nbsp;</span><span id='no\_log\_button' class=\"log\_button button-primary\" style=\"display:none;position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:12px\">&nbsp;".\_\_('Toggle Log', 'skt-nurcaptcha')."&nbsp;</span>"; |
| [124](#L124) | } ?> |
| [125](#L125) | </p><br /> |
| [126](#L126) | <?php    echo  \_\_( 'NURCaptcha stands for <strong>New User Register Captcha</strong>.', 'skt-nurcaptcha' ) . "<br />"; ?> |
| [127](#L127) | <?php    echo  \_\_( 'It uses Google\'s reCaptcha tools to protect your site against spammer bots, ', 'skt-nurcaptcha' ) ; ?> |
| [128](#L128) | <?php    echo  \_\_( 'adding security to the WP Register Form. You can learn more', 'skt-nurcaptcha' ) ; ?> |
| [129](#L129) | <?php    echo  '<a href="https://www.google.com/recaptcha/intro/index.html#advanced-security" target="\_blank"> '.\_\_('here','skt-nurcaptcha').' </a>'.\_\_('about reCAPTCHA Security','skt-nurcaptcha').'<br />'; ?> |
| [130](#L130) | <?php    echo "<br />"; ?> |
| [131](#L131) | <p class="submit" > |
| [132](#L132) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [133](#L133) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page! ','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [134](#L134) | </p> |
| [135](#L135) | <div style="clear:both"></div> |
| [136](#L136) | <?php |
| [137](#L137) | if(!isset( $\_GET['pagenum'] )){$display\_none = "display:none";}else{$display\_none = "";} |
| [138](#L138) | echo "<div id='log\_entries' style='width:800px;position:relative;".$display\_none."'>"; |
| [139](#L139) | echo "<span id='unlink\_log\_button' class=\"button-primary\" style=\"position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:82px;".$display\_none ."\">&nbsp;".\_\_('Delete Log File', 'skt-nurcaptcha')."&nbsp;</span><span id='link\_log\_button' class=\"button-primary\" style=\"display:none;position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#ff2000;text-decoration:none;top:2px;right:132px\">&nbsp;".\_\_('Cancel Delete Log File', 'skt-nurcaptcha')."&nbsp;</span> "; |
| [140](#L140) |  |
| [141](#L141) | $pagenum = isset( $\_GET['pagenum'] ) ? absint( $\_GET['pagenum'] ) : 1; // if pagenum absent, assume value 1. |
| [142](#L142) | $limit = get\_site\_option('sktnurc\_logpage\_limit',20); |
| [143](#L143) | $num\_of\_pages = ceil( $total / $limit ); |
| [144](#L144) | if($pagenum > $num\_of\_pages) $pagenum = $num\_of\_pages; |
| [145](#L145) | $page\_links = paginate\_links( array( |
| [146](#L146) | 'base' => add\_query\_arg( 'pagenum', '%#%' ), |
| [147](#L147) | 'format' => '', |
| [148](#L148) | 'prev\_text' => '&laquo;', |
| [149](#L149) | 'next\_text' => '&raquo;', |
| [150](#L150) | 'total' => $num\_of\_pages, |
| [151](#L151) | 'current' => $pagenum |
| [152](#L152) | ) ); |
| [153](#L153) |  |
| [154](#L154) | echo "<h3>". \_\_('Last Blocked Attemptives','skt-nurcaptcha')." (".$total.")</h3>"; |
| [155](#L155) | if ($num\_of\_pages > 1) |
| [156](#L156) | echo "<strong>". \_\_('Page','skt-nurcaptcha'). " ".$pagenum." ".\_\_('of','skt-nurcaptcha')." ".$num\_of\_pages. "</strong> -> "; |
| [157](#L157) | echo " ("; |
| [158](#L158) | echo " <input type=\"text\" id=\"sktnurc\_logpage\_limit\" name=\"sktnurc\_logpage\_limit\" value=\""; |
| [159](#L159) | echo $limit ."\" size=\"4\"> ".\_\_("occurrences per page",'skt-nurcaptcha').")"; |
| [160](#L160) |  |
| [161](#L161) | $offset = ( $pagenum - 1 ) \* $limit; |
| [162](#L162) | if ($attemptives = skt\_nurc\_listlog($limit, $offset)){ |
| [163](#L163) | if ( $page\_links ) { |
| [164](#L164) | echo '<div class="tablenav" style="margin-right:70px"><div class="tablenav-pages" style="margin: 1em 0">' . $page\_links . '</div></div><div style="clear:both"></div>'; |
| [165](#L165) | }else{ |
| [166](#L166) | echo '<br /><br />'; |
| [167](#L167) | } |
| [168](#L168) | //abrir form de eliminação de registros |
| [169](#L169) | foreach($attemptives as $attemptive){ |
| [170](#L170) | // incluir checkbox com value=$attemptive->id; |
| [171](#L171) | echo $attemptive->time; |
| [172](#L172) | echo " &raquo;&ensp; email: &lt;<strong>".$attemptive->email."</strong>&gt;"; |
| [173](#L173) | echo " &rarr; name: <strong>".$attemptive->username."</strong> "; |
| [174](#L174) | echo " &rarr; IP: ".$attemptive->ip." "; |
| [175](#L175) | echo "&ensp;&raquo;&ensp; [".$attemptive->procid."]"; |
| [176](#L176) | echo "<br />"; |
| [177](#L177) | } |
| [178](#L178) | // fechar form de eliminação de registros com botão "Apagar os registros selecionados" |
| [179](#L179) | if ( $page\_links ) { |
| [180](#L180) | echo '<div class="tablenav" style="margin-right:70px"><div class="tablenav-pages" style="margin: 1em 0">' . $page\_links . '</div></div>'; |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) | }else{ |
| [184](#L184) | echo \_\_("No data to show", 'skt-nurcaptcha'); |
| [185](#L185) | } |
| [186](#L186) | echo '<br /><br />'; |
| [187](#L187) | echo "</div>"; // end of <div id="log\_entries"> |
| [188](#L188) | ?> |
| [189](#L189) | <div style="clear:both"></div> |
| [190](#L190) | <?php    echo "<br />"; ?> |
| [191](#L191) | <?php    echo "<p style=\"padding: .5em; background-color: #666666; color: #fff;\">" . \_\_( 'To enable this plugin\'s functionality, please enter your reCAPTCHA keys here:', 'skt-nurcaptcha' ) . "</p><br />"; // grey section title bar |
| [192](#L192) |  |
| [193](#L193) | echo "<small>[". \_\_( 'You can sign up for reCaptcha <strong>free</strong> keys here: ', 'skt-nurcaptcha' ); |
| [194](#L194) | echo '<a href="'.nurc\_recaptcha\_get\_signup\_url().'" target="\_blank"><strong>reCAPTCHA API Signup Page</strong></a>]</small>'; ?> |
| [195](#L195) | </div> |
| [196](#L196) |  |
| [197](#L197) | <div style="width:680px;padding:12px 0 12px 24px"> |
| [198](#L198) | <p><?php \_e("reCaptcha Site Key: ", 'skt-nurcaptcha' ); ?><input type="text" id="sktnurc\_publkey" name="sktnurc\_publkey" value="<?php echo $sktnurc\_pubkey; ?>" size="46"></p> |
| [199](#L199) | <p><?php \_e("reCaptcha Secret Key: ", 'skt-nurcaptcha' ); ?><input type="text" id="sktnurc\_privtkey" name="sktnurc\_privtkey" value="<?php echo $sktnurc\_privkey; ?>" size="46"></p> |
| [200](#L200) | <p class="submit" > |
| [201](#L201) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [202](#L202) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [203](#L203) | </p> |
| [204](#L204) | </div> |
| [205](#L205) |  |
| [206](#L206) | <div style="position:relative;width:680px;padding:12px 0 12px 24px"> |
| [207](#L207) | <p style="padding: .5em; background-color: #666666; color: #fff;"><?php echo \_\_( 'Style your reCaptcha:', 'skt-nurcaptcha' ) ?></p> |
| [208](#L208) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [209](#L209) |  |
| [210](#L210) | <div id="sktth" style="position:relative;"> |
| [211](#L211) | <span><strong><?php  \_e('reCAPTCHA theme:', 'skt-nurcaptcha'); ?></strong></span><br /> |
| [212](#L212) | &nbsp;&nbsp;&nbsp;&nbsp;<select id="sktnurc\_theme" name="sktnurc\_data\_theme"> |
| [213](#L213) | <?php |
| [214](#L214) | $plugin\_img\_path = array(); |
| [215](#L215) | $rc\_themes = array('light' => 'Light (default)', 'dark' => 'Dark'); |
| [216](#L216) | foreach( $rc\_themes as $k => $v ) { |
| [217](#L217) | $selected = ( $k == get\_site\_option('sktnurc\_data\_theme') ) ? 'selected="selected"' : ''; |
| [218](#L218) | echo "<option value='$k' $selected>$v</option>"; |
| [219](#L219) | $plugin\_img\_path[$k] = WP\_PLUGIN\_URL.'/'.str\_replace(basename( \_\_FILE\_\_),"",plugin\_basename(\_\_FILE\_\_)); |
| [220](#L220) | $plugin\_img\_path[$k] .= 'img/'.$k.'.png'; |
| [221](#L221) | } |
| [222](#L222) | $def\_img = ( "" == get\_site\_option('sktnurc\_data\_theme') ) ? 'light' : get\_site\_option('sktnurc\_data\_theme'); |
| [223](#L223) | ?> |
| [224](#L224) | </select><br /> |
| [225](#L225) | <!-- reCAPTCHA images --> |
| [226](#L226) | <div class="captcha-img" style="float:left;width:460px; margin:-42px 0 110px 0; padding:0 0 12px 0"> |
| [227](#L227) | <?php |
| [228](#L228) | foreach ($plugin\_img\_path as $k => $v) { |
| [229](#L229) | ?> |
| [230](#L230) | <div id="sktnurc-display-<?php |
| [231](#L231) | echo $k; |
| [232](#L232) | ?>" style="position:absolute;margin-left:232px<?php |
| [233](#L233) | if ($k != $def\_img) { echo ';display:none';} ?>"> |
| [234](#L234) | <img src="<?php echo $plugin\_img\_path[$k]; ?>" title="<?php |
| [235](#L235) | \_e('This is the look of your captcha','skt-nurcaptcha'); ?>" /> |
| [236](#L236) | </div> |
| [237](#L237) | <?php |
| [238](#L238) | } |
| [239](#L239) | ?> |
| [240](#L240) | </div><!-- end of reCAPTCHA images --> |
| [241](#L241) |  |
| [242](#L242) | </div><!-- end of reCAPTCHA theme block --> |
| [243](#L243) |  |
| [244](#L244) | </div><!-- end of wrapper - theme block --> |
| [245](#L245) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [246](#L246) |  |
| [247](#L247) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [248](#L248) | <div style="padding:4px 0 4px 0;"> |
| [249](#L249) | <span><strong><?php \_e('reCAPTCHA language:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [250](#L250) | <span><?php \_e("If you want to force the widget to render in a specific language, use the selector below. Auto-detects the user's language if unspecified.", 'skt-nurcaptcha') ?></span><br /><br /> |
| [251](#L251) | <?php  echo skt\_get\_lang\_selector(get\_site\_option('sktnurc\_recaptcha\_language')) ?> |
| [252](#L252) | </div> |
| [253](#L253) | </div> |
| [254](#L254) | <div style="clear:both"></div> |
| [255](#L255) |  |
| [256](#L256) | <p class="submit" > |
| [257](#L257) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [258](#L258) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [259](#L259) | </p> |
| [260](#L260) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [261](#L261) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [262](#L262) | <div style="padding:4px 0 4px 0;"> |
| [263](#L263) |  |
| [264](#L264) | <span><strong><?php \_e('reCAPTCHA type:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [265](#L265) | <span><?php \_e('Once and a while, when needed, reCAPTCHA will present a challenge for the user to solve. By default, this challenge is an image with words or numbers. You can change the challenge to audio type, if you think this is a better fit to your site.', 'skt-nurcaptcha') ?></span><br /><br /> |
| [266](#L266) | <p><input type="radio" id="rec\_type\_image" value="image" name="sktnurc\_data\_type" <?php |
| [267](#L267) | if(get\_site\_option('sktnurc\_data\_type')=="image") echo 'checked'; |
| [268](#L268) | ?> /> <?php \_e('Use image challenge, when needed','skt-nurcaptcha'); ?><br /> |
| [269](#L269) | <input type="radio" id="rec\_type\_audio" value="audio" name="sktnurc\_data\_type" <?php |
| [270](#L270) | if(get\_site\_option('sktnurc\_data\_type')=="audio") echo 'checked'; |
| [271](#L271) | ?> /> <?php \_e('Use audio challenge, only','skt-nurcaptcha'); ?><br /></p> |
| [272](#L272) |  |
| [273](#L273) | </div> |
| [274](#L274) | </div> |
| [275](#L275) |  |
| [276](#L276) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [277](#L277) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [278](#L278) | <div style="padding:4px 0 4px 0;"> |
| [279](#L279) |  |
| [280](#L280) | <span><strong><?php \_e('enable reCAPTCHA on LOGIN form:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [281](#L281) | <span><?php \_e('This feature adds extra security to your site, by inserting a reCAPTCHA at the end of the login form. Thus, even if a bot comes to guess the right username and password, this extra reCAPTCHA may provide additional strenght to block the invasion.', 'skt-nurcaptcha') ?></span><br /><br /> |
| [282](#L282) | <p><input type="radio" id="rec\_at\_login" value="true" name="sktnurc\_login\_recaptcha" <?php |
| [283](#L283) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="true") echo 'checked'; |
| [284](#L284) | ?> /> <?php \_e('Use login reCAPTCHA, for extra protection.','skt-nurcaptcha'); ?><br /> |
| [285](#L285) | <input type="radio" id="rec\_not\_at\_login" value="false" name="sktnurc\_login\_recaptcha" <?php |
| [286](#L286) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="false") echo 'checked'; |
| [287](#L287) | ?> /> <?php \_e('No, thanks.','skt-nurcaptcha'); ?><br /></p> |
| [288](#L288) |  |
| [289](#L289) | </div> |
| [290](#L290) | </div> |
| [291](#L291) | <p class="submit" > |
| [292](#L292) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [293](#L293) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [294](#L294) | </p> |
| [295](#L295) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [296](#L296) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [297](#L297) | <div style="padding:4px 0 4px 0;"> |
| [298](#L298) |  |
| [299](#L299) | <span><strong><?php \_e('enable reCAPTCHA on selected front-end pages:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [300](#L300) | <span><?php \_e('If you have login or register forms located on front-end pages in your site, you must select them at the selector below, so the reCAPTCHA script can be correctly loaded to these pages - ready to be called to action.', 'skt-nurcaptcha') ?></span><br /> |
| [301](#L301) | <span><?php \_e('Get some more information on how to set up front pages to display the captcha by reading this article:', 'skt-nurcaptcha') ?></span> <a href="https://skt-nurcaptcha.sanskritforum.org/2015/08/25/recaptcha-anywhere-in-your-theme/" target="\_blank">How to implement a reCAPTCHA anywhere in your theme</a> |
| [302](#L302) | <br /><br /> |
| [303](#L303) | <p> |
| [304](#L304) | <span id='custom\_pages\_button' class="button-primary" style="cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;"><?php echo  \_\_('Toggle Selector', 'skt-nurcaptcha'); ?></span> |
| [305](#L305) | <br /></p> |
| [306](#L306) | <div id="debug\_output"></div> |
| [307](#L307) | <div style="clear:both"></div> |
| [308](#L308) | <?php echo skt\_nurc\_pages\_checkbox(); ?> |
| [309](#L309) | <br /> |
| [310](#L310) |  |
| [311](#L311) | </div> |
| [312](#L312) | </div> |
| [313](#L313) |  |
| [314](#L314) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [315](#L315) | <div style="float:left;width:180px;padding-left:24px;margin:12px 0 12px 0;"> |
| [316](#L316) | <p style="position:relative"> |
| [317](#L317) | <?php \_e("Customize text to appear in Submit Button (register form): ", 'skt-nurcaptcha' ); ?> |
| [318](#L318) | <input type="text" id="sktnurc\_regbutton" name="sktnurc\_regbutton" |
| [319](#L319) | value="<?php echo get\_site\_option('sktnurc\_regbutton'); ?>" size="26"><br /> |
| [320](#L320) | <?php echo "[ default: <strong><span id='sktnurc\_regbutton\_text' >". \_\_('Register', 'skt-nurcaptcha' )."</span></strong> ]"; ?> |
| [321](#L321) |  |
| [322](#L322) | </p> |
| [323](#L323) | </div> |
| [324](#L324) | <div class="regbutton-mock-up" style="margin-left:232px;position:absolute;width:312px;padding:24px 0 12px 0"> |
| [325](#L325) | <input style="float:left;margin-right:12px; border:1px solid #fff" type="submit" size="auto" class="button-primary" id="sktnurc-mockup-wp-submit" value="<?php |
| [326](#L326) | if (get\_site\_option('sktnurc\_regbutton')==""){ |
| [327](#L327) | \_e("Register", 'skt-nurcaptcha'); |
| [328](#L328) | } else { |
| [329](#L329) | echo get\_site\_option('sktnurc\_regbutton'); |
| [330](#L330) | } |
| [331](#L331) | ?>" /> |
| [332](#L332) | </div> |
| [333](#L333) | <div style="clear:both"></div> |
| [334](#L334) |  |
| [335](#L335) | <p class="submit" > |
| [336](#L336) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [337](#L337) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [338](#L338) | </p> |
| [339](#L339) | </div> |
| [340](#L340) |  |
| [341](#L341) | <?php |
| [342](#L342) |  |
| [343](#L343) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Customize register form help messages \*/ |
| [344](#L344) |  |
| [345](#L345) | ?> |
| [346](#L346) | <div style="position:relative;width:680px;padding:8px 0 12px 24px"> |
| [347](#L347) | <p style="padding: .6em; background-color: #666; color: #fff;"> |
| [348](#L348) | <?php echo \_\_( 'Customize register form\'s help messages:', 'skt-nurcaptcha' ) ?> |
| [349](#L349) | </p><br /> |
| [350](#L350) | <span> |
| [351](#L351) | <?php \_e('Use these fields to change the default help messages that Skt NURCaptcha adds to the register form. To return to default values, simply delete all content from that field and click on the save button.','skt-nurcaptcha'); ?> |
| [352](#L352) | </span><br /><br /> |
| [353](#L353) | <?php |
| [354](#L354) | $userHelp = sktnurc\_username\_help\_text(); |
| [355](#L355) | $emailHelp = sktnurc\_email\_help\_text(); |
| [356](#L356) | $recHelp = sktnurc\_reCaptcha\_help\_text(); |
| [357](#L357) |  |
| [358](#L358) | ?> |
| [359](#L359) | <strong><?php \_e( 'Username:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [360](#L360) | <textarea id="sktnurc\_username\_help" name="sktnurc\_username\_help" cols="90" rows="5"> |
| [361](#L361) | <?php echo $userHelp ?> |
| [362](#L362) | </textarea> |
| [363](#L363) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_usrhlp\_opt" id="sktnurc\_usrhlp\_opt" value="true" |
| [364](#L364) | <?php if (get\_site\_option('sktnurc\_usrhlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [365](#L365) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [366](#L366) | <br /><br /> |
| [367](#L367) | <strong><?php \_e( 'Email:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [368](#L368) | <textarea id="sktnurc\_email\_help" name="sktnurc\_email\_help" cols="90" rows="5"> |
| [369](#L369) | <?php echo $emailHelp ?> |
| [370](#L370) | </textarea> |
| [371](#L371) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_emlhlp\_opt" id="sktnurc\_emlhlp\_opt" value="true" |
| [372](#L372) | <?php if (get\_site\_option('sktnurc\_emlhlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [373](#L373) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [374](#L374) | <br /><br /> |
| [375](#L375) | <strong><?php \_e( 'reCAPTCHA:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [376](#L376) | <textarea id="sktnurc\_reCaptcha\_help" name="sktnurc\_v2\_reCaptcha\_help" cols="90" rows="5"> |
| [377](#L377) | <?php echo $recHelp ?> |
| [378](#L378) | </textarea> |
| [379](#L379) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_rechlp\_opt" id="sktnurc\_rechlp\_opt" value="true" |
| [380](#L380) | <?php if (get\_site\_option('sktnurc\_rechlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [381](#L381) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [382](#L382) | <br /> |
| [383](#L383) |  |
| [384](#L384) |  |
| [385](#L385) | <div style="clear:both"></div> |
| [386](#L386) |  |
| [387](#L387) | <p class="submit" > |
| [388](#L388) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [389](#L389) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [390](#L390) | </p> |
| [391](#L391) | </div> |
| [392](#L392) | </form> |
| [393](#L393) |  |
| [394](#L394) | <?php |
| [395](#L395) |  |
| [396](#L396) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* PayPal Donation Button \*/ |
| [397](#L397) |  |
| [398](#L398) | ?> |
| [399](#L399) | <div style="position:relative;width:680px;padding:8px 0 12px 24px"> |
| [400](#L400) | <p style="padding: .6em; background-color: #666; color: #fff;"> |
| [401](#L401) | <?php echo \_\_( 'Make me happy:', 'skt-nurcaptcha' ) ?> |
| [402](#L402) | </p> |
| [403](#L403) | <div style="margin-left:32px;padding-bottom:12px"> |
| [404](#L404) | <form action="https://www.paypal.com/cgi-bin/webscr" method="post"> |
| [405](#L405) | <input type="hidden" name="cmd" value="\_s-xclick"> |
| [406](#L406) | <input type="hidden" name="hosted\_button\_id" value="SKNS7K7L5BFLL"> |
| [407](#L407) | <input type="image" src="https://www.paypalobjects.com/en\_US/i/btn/btn\_donateCC\_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!"> |
| [408](#L408) | <img alt="" border="0" src="https://www.paypalobjects.com/pt\_BR/i/scr/pixel.gif" width="1" height="1"> |
| [409](#L409) | </form> |
| [410](#L410) | </div> |
| [411](#L411) | </div> |
| [412](#L412) |  |
| [413](#L413) | </div>  <?php /\* end of div.wrap \*/ ?> |
| [414](#L414) |  |
| [415](#L415) | <?php |
| [416](#L416) |  |
| [417](#L417) | function nurc\_get\_version() { |
| [418](#L418) | $npath = nurc\_make\_path(); |
| [419](#L419) | $npath .= 'skt-nurcaptcha.php'; |
| [420](#L420) | $lines = file($npath); |
| [421](#L421) | $l = count($lines); |
| [422](#L422) | $version = 'wrong version'; |
| [423](#L423) | $i=0; |
| [424](#L424) | while ($i < $l): |
| [425](#L425) | if (trim($lines[$i])=='') { |
| [426](#L426) | $i++; |
| [427](#L427) | continue; |
| [428](#L428) | } |
| [429](#L429) | $r = strpos($lines[$i],'Version:'); |
| [430](#L430) | if ($r != false) { |
| [431](#L431) | $version = trim(substr($lines[$i],$r+8)); |
| [432](#L432) | break; |
| [433](#L433) | } |
| [434](#L434) | $i++; |
| [435](#L435) | endwhile; |
| [436](#L436) | return $version; |
| [437](#L437) |  |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) |  |
| [441](#L441) | /\* |
| [442](#L442) | \* builds array witth a few country names |
| [443](#L443) | \*/ |
| [444](#L444) | function skt\_nurc\_lang\_array() |
| [445](#L445) | { |
| [446](#L446) | return array( |
| [447](#L447) | 'xx' => 'Auto-detect user language', |
| [448](#L448) | 'ar' => 'Arabic', |
| [449](#L449) | 'bg' => 'Bulgarian', |
| [450](#L450) | 'ca' => 'Catalan', |
| [451](#L451) | 'zh-CN' => 'Chinese (Simplified)', |
| [452](#L452) | 'zh-TW' => 'Chinese (Traditional)', |
| [453](#L453) | 'hr' => 'Croatian', |
| [454](#L454) | 'cs' => 'Czech', |
| [455](#L455) | 'da' => 'Danish', |
| [456](#L456) | 'nl' => 'Dutch', |
| [457](#L457) | 'en-GB' => 'English (UK)', |
| [458](#L458) | 'en' => 'English (US)', |
| [459](#L459) | 'fil' => 'Filipino', |
| [460](#L460) | 'fi' => 'Finnish', |
| [461](#L461) | 'fr' => 'French', |
| [462](#L462) | 'fr-CA' => 'French (Canadian)', |
| [463](#L463) | 'de' => 'German', |
| [464](#L464) | 'de-AT' => 'German (Austria)', |
| [465](#L465) | 'de-CH' => 'German (Switzerland)', |
| [466](#L466) | 'el' => 'Greek', |
| [467](#L467) | 'iw' => 'Hebrew', |
| [468](#L468) | 'hi' => 'Hindi', |
| [469](#L469) | 'hu' => 'Hungarian', |
| [470](#L470) | 'id' => 'Indonesian', |
| [471](#L471) | 'it' => 'Italian', |
| [472](#L472) | 'ja' => 'Japanese', |
| [473](#L473) | 'ko' => 'Korean', |
| [474](#L474) | 'lv' => 'Latvian', |
| [475](#L475) | 'lt' => 'Lithuanian', |
| [476](#L476) | 'no' => 'Norwegian', |
| [477](#L477) | 'fa' => 'Persian', |
| [478](#L478) | 'pl' => 'Polish', |
| [479](#L479) | 'pt' => 'Portuguese', |
| [480](#L480) | 'pt-BR' => 'Portuguese (Brazil)', |
| [481](#L481) | 'pt-PT' => 'Portuguese (Portugal)', |
| [482](#L482) | 'ro' => 'Romanian', |
| [483](#L483) | 'ru' => 'Russian', |
| [484](#L484) | 'sr' => 'Serbian', |
| [485](#L485) | 'sk' => 'Slovak', |
| [486](#L486) | 'sl' => 'Slovenian', |
| [487](#L487) | 'es' => 'Spanish', |
| [488](#L488) | 'es-419' => 'Spanish (Latin America)', |
| [489](#L489) | 'sv' => 'Swedish', |
| [490](#L490) | 'th' => 'Thai', |
| [491](#L491) | 'tr' => 'Turkish', |
| [492](#L492) | 'uk' => 'Ukrainian', |
| [493](#L493) | 'vi' => 'Vietnamese' |
| [494](#L494) | ); |
| [495](#L495) | } |
| [496](#L496) | // |
| [497](#L497) | /\* |
| [498](#L498) | \*\*\*\*\*\*\*\*\*\*\*\*\*\* produz select com os estados brasileiros  \*\*\*\*\*\*\*\*\*\*\*\*\* |
| [499](#L499) | \*/ |
| [500](#L500) | function skt\_get\_lang\_selector($selected = 'xx') { |
| [501](#L501) | $uf\_array = skt\_nurc\_lang\_array(); |
| [502](#L502) | $html = '<select id="sktnurc\_lang" name="sktnurc\_recaptcha\_language">'; |
| [503](#L503) | foreach($uf\_array as $lg => $lang\_name) |
| [504](#L504) | { |
| [505](#L505) | if ($lg==$selected){ |
| [506](#L506) | $s = 'selected="selected"'; |
| [507](#L507) | }else{ |
| [508](#L508) | $s = ''; |
| [509](#L509) | } |
| [510](#L510) | $html .= "<option value=\"$lg\" $s >$lang\_name "; |
| [511](#L511) | if($lg != 'xx') $html .= "[$lg]"; |
| [512](#L512) | $html .= "</option>"; |
| [513](#L513) | } |
| [514](#L514) |  |
| [515](#L515) | $html .= '</select>'; |
| [516](#L516) | return $html; |
| [517](#L517) | } |
| [518](#L518) | // |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583&format=txt)
* [Original Format](/export/3195583/skt-nurcaptcha/trunk/skt-nurc-admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_ad2ea7b9_20250114_182305.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3195583%2540skt-nurcaptcha%26old%3D3195583%2540skt-nurcaptcha)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2812945/skt-nurcaptcha "Changeset 2812945 for skt-nurcaptcha")
* [Next Change](/changeset/3195627/skt-nurcaptcha "Changeset 3195627 for skt-nurcaptcha") →

---

# Changeset [3195583](/changeset/3195583 "Show full changeset") for [skt-nurcaptcha](/browser/skt-nurcaptcha?rev=3195583 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/23/2024 05:58:06 PM
([7 weeks](/timeline?from=2024-11-23T17%3A58%3A06Z&precision=second "See timeline at 11/23/2024 05:58:06 PM") ago)

Author:
Sanskritforum
Message:

Version 3.6.0 - Fixed vulnerability to Cross-Site Request Forgery

Location:
[skt-nurcaptcha/trunk](/browser/skt-nurcaptcha/trunk?rev=3195583)
Files:

3 edited

* [readme.txt](/browser/skt-nurcaptcha/trunk/readme.txt?rev=3195583 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [skt-nurc-admin.php](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [skt-nurcaptcha.php](/browser/skt-nurcaptcha/trunk/skt-nurcaptcha.php?rev=3195583 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [skt-nurcaptcha/trunk/readme.txt](/changeset/3195583/skt-nurcaptcha/trunk/readme.txt "Show the changeset 3195583 restricted to skt-nurcaptcha/trunk/readme.txt")

  | [r2812945](/browser/skt-nurcaptcha/trunk/readme.txt?rev=2812945#L4 "Show revision 2812945 of this file in browser") | [r3195583](/browser/skt-nurcaptcha/trunk/readme.txt?rev=3195583#L4 "Show revision 3195583 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: security, login form, new user, captcha, spambots, reCAPTCHA, register form, bots, spam, register, anti-spam |
  | 5 | 5 | Requires at least: 5.0 |
  | 6 |  | Tested up to: 6.1 |
  | 7 |  | Stable tag: 3.~~5~~.0 |
  |  | 6 | Tested up to: 6.7.1 |
  |  | 7 | Stable tag: 3.6.0 |
  | 8 | 8 |  |
  | 9 | 9 | NURCaptcha inserts a reCAPTCHA on the Register Form of your site to protect it against spambots. |
  | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=2812945#L70) | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=3195583#L70) |  |
  | 70 | 70 | == Changelog == |
  | 71 | 71 |  |
  |  | 72 | = 3.6.0 = |
  |  | 73 | \* Fixed vulnerability to Cross-Site Request Forgery in admin panel |
  | 72 | 74 | = 3.5.0 = |
  | 73 | 75 | \* Upgrade in antispam databases querying routines and a few other small fixes |
  | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=2812945#L82) | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=3195583#L84) |  |
  | 82 | 84 | = 3.4.5 = |
  | 83 | 85 | \* Fixed: call to undefined variable $lang under BP |
  | 84 |  | ~~= 3.4.4 =~~ |
  | 85 |  | ~~\* Fixed: mispelled call to undefined function at line 85~~ |
  | 86 |  | ~~= 3.4.3 =~~ |
  | 87 |  | ~~\* Added: enable reCAPTCHA on selected front side pages~~ |
  | 88 |  | ~~\* Fixed: register form not working when BuddyPress enabled over WPMU~~ |
  | 89 |  | ~~= 3.4.2 =~~ |
  | 90 |  | ~~\* Fixed: bug blocking login when keys were not saved yet~~ |
  | 91 |  | ~~= 3.4.1 =~~ |
  | 92 |  | ~~\* Fixed: small glitch in the code generating PHP warnings~~ |
  | 93 |  | ~~= 3.4.0 =~~ |
  | 94 |  | ~~\* Added: Transition to the new version of Google's reCAPTCHA~~ |
  | 95 |  | ~~\* Added: login form captcha~~ |
  | 96 |  | ~~= 3.1.8 =~~ |
  | 97 |  | ~~\* Fixed: removed duplication of div id in registration form when BuddyPress was active~~ |
  | 98 |  | ~~= 3.1.7 =~~ |
  | 99 |  | ~~\* Fixed: challenge not displaying on https pages~~ |
  | 100 |  | ~~= 3.1.6 =~~ |
  | 101 |  | ~~\* Added: French version - by ChezMat~~ |
  | 102 |  | ~~\* Fixed: field missing at uninstall.php, and small improvements in main code~~ |
  | 103 |  | ~~= 3.1.5 =~~ |
  | 104 |  | ~~\* Added: action hook to allow extra check on username or email by other plugin~~ |
  | 105 |  | ~~\* Added: managing register form's help messages via Admin Panel~~ |
  | 106 |  | ~~\* Fixed: small glitch on register form's help display code~~ |
  | 107 |  | ~~= 3.1.3 =~~ |
  | 108 |  | ~~\* Fixed: bug in MU that blocked new site registration~~ |
  | 109 |  | ~~= 3.1.2 =~~ |
  | 110 |  | ~~\* Fixed: small bug in MU that blocked new user registration from admin panel~~ |
  | 111 |  | ~~= 3.1.1 =~~ |
  | 112 |  | ~~\* Improved: a server-safe procedure to load external xml contents, needed to read anti-spam databases responses.~~ |
  | 113 |  | ~~= 3.1.0 =~~ |
  | 114 |  | ~~\* Improved: log entries now stored in a database table - no more data will be lost when plugin upgrades.~~ |
  | 115 |  | ~~= 3.0.2 =~~ |
  | 116 |  | ~~\* Fixed: anti-spam databases options didn't save changes.~~ |
  | 117 |  | ~~= 3.0.1 =~~ |
  | 118 |  | ~~\* Fixed: small glitch affecting BuddyPress users only - no security issues involved.~~ |
  | 119 |  | ~~= 3.0.0 =~~ |
  | 120 |  | ~~\* Added: StopForumSpam and BotScout databases assessment for extra security.~~ |
  | 121 |  | ~~= 2.4.7 =~~ |
  | 122 |  | ~~\* Added: user customization of reCAPTCHA strings.~~ |
  | 123 |  | ~~\* Improved: better UI to choose native language for reCAPTCHA.~~ |
  | 124 |  | ~~= 2.4.6 =~~ |
  | 125 |  | ~~\* Added: customized text for submit button on register form.~~ |
  | 126 |  | ~~= 2.4.5 =~~ |
  | 127 |  | ~~\* Fixed: excluded ubused help button from BuddyPress and WPMU versions.~~ |
  | 128 |  | ~~= 2.4.4 =~~ |
  | 129 |  | ~~\* Added: help on register form;~~ |
  | 130 |  | ~~\* Fixed: logfile deletion drops log count to zero.~~ |
  | 131 |  | ~~= 2.4.3 =~~ |
  | 132 |  | ~~\* Fixed: wrong data writing on logfile~~ |
  | 133 |  | ~~= 2.4.2 =~~ |
  | 134 |  | ~~\* Added: improvements on javascript.~~ |
  | 135 |  | ~~\* Fixed: small glitch on textdomain call~~ |
  | 136 |  | ~~= 2.4 =~~ |
  | 137 |  | ~~\* Added: support to BuddyPress.~~ |
  | 138 |  | ~~\* Fixed: double counting on WPMU~~ |
  | 139 |  | ~~= 2.0 =~~ |
  | 140 |  | ~~\* Added support to Multisites.~~ |
  | 141 |  | ~~= 1.3 =~~ |
  | 142 |  | ~~\* Included Log File to show data of blocked attemptives, and a few other minor code improvements.~~ |
  | 143 |  | ~~= 1.13 =~~ |
  | 144 |  | ~~\* Register Form Page upgraded with javascript. No critical changes.~~ |
  | 145 |  | ~~= 1.1 =~~ |
  | 146 |  | ~~\* Admin Page upgraded with javascript. No critical changes.~~ |
  | 147 |  | ~~= 1.0 =~~ |
  | 148 |  | ~~\* First version.~~ |
  | 149 | 86 |  |
  | 150 | 87 | == Upgrade Notice == |
  | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=2812945#L158) | […](/browser/skt-nurcaptcha/trunk/readme.txt?rev=3195583#L95) |  |
  | 158 | 95 | = 3.4.7 = |
  | 159 | 96 | \* Fixed: small issue affecting access to language files |
  | 160 |  | ~~= 3.4.6 =~~ |
  | 161 |  | ~~\* Fixed: call to undefined property $errors under BP~~ |
  | 162 |  | ~~= 3.4.5 =~~ |
  | 163 |  | ~~\* Fixed: call to undefined variable $lang under BP~~ |
  | 164 |  | ~~= 3.4.4 =~~ |
  | 165 |  | ~~\* Fixed: mispelled call to undefined function at line 85~~ |
  | 166 |  | ~~= 3.4.3 =~~ |
  | 167 |  | ~~\* This update will enable reCAPTCHA on selected front side pages~~ |
  | 168 |  | ~~= 3.4.2 =~~ |
  | 169 |  | ~~\* Fixed: bug blocking login when keys were not saved yet~~ |
  | 170 |  | ~~= 3.4.1 =~~ |
  | 171 |  | ~~\* Fixed: small glitch in the code generating PHP warnings~~ |
  | 172 |  | ~~= 3.4.0 =~~ |
  | 173 |  | ~~\* IMPORTANT UPDATE: Transition to the new version of Google's reCAPTCHA (dec/2014)~~ |
  | 174 |  | ~~= 3.1.8 =~~ |
  | 175 |  | ~~\* Fixed: removed duplication of div id in registration form when BuddyPress was active~~ |
  | 176 |  | ~~= 3.1.7 =~~ |
  | 177 |  | ~~\* Fixed: reCAPTCHA challenge not displaying on https pages~~ |
  | 178 |  | ~~= 3.1.5 =~~ |
  | 179 |  | ~~\* Added: now you can manage register form's help messages via Admin Panel~~ |
  | 180 |  | ~~= 3.1.3 =~~ |
  | 181 |  | ~~\* Fixed: bug in MU that blocked new site registration~~ |
  | 182 |  | ~~= 3.1.2 =~~ |
  | 183 |  | ~~\* Fixed: small bug in MU that blocked new user registration from admin panel~~ |
  | 184 |  | ~~= 3.1.1 =~~ |
  | 185 |  | ~~\* Improved: a server-safe procedure to load external xml contents, needed to read anti-spam databases responses.~~ |
  | 186 |  | ~~= 3.1.0 =~~ |
  | 187 |  | ~~\* Improved: log entries now stored in a database table - no more data will be lost when plugin upgrades.~~ |
  | 188 |  | ~~= 3.0.2 =~~ |
  | 189 |  | ~~\* Fixed: anti-spam databases options didn't save changes.~~ |
  | 190 |  | ~~= 3.0.1 =~~ |
  | 191 |  | ~~\* Fixed: small visual glitch affecting BuddyPress users only - no security issues involved.~~ |
  | 192 |  | ~~= 3.0.0 =~~ |
  | 193 |  | ~~\* Added: StopForumSpam and BotScout databases assessment for extra security.~~ |
  | 194 |  | ~~\* Alert: we strongly recommend users to upgrade to version 3, as there are some evidences of spammers making a way through reCAPTCHA challenges - probably by tricking someone else to solve it for their bots.~~ |
  | 195 |  | ~~= 2.4.7 =~~ |
  | 196 |  | ~~\* Added: user customization of reCAPTCHA strings.~~ |
  | 197 |  | ~~\* Improved: better UI to choose native language for reCAPTCHA.~~ |
  | 198 |  | ~~= 2.4.6 =~~ |
  | 199 |  | ~~\* Added: customized text for submit button on register form.~~ |
  | 200 |  | ~~= 2.4.5 =~~ |
  | 201 |  | ~~\* Fixed: excluded unused help button from BuddyPress and WPMU versions.~~ |
  | 202 |  | ~~= 2.4.4 =~~ |
  | 203 |  | ~~\* Added: help on register form; Fixed: logfile deletion drops log count to zero.~~ |
  | 204 |  | ~~= 2.4.3 =~~ |
  | 205 |  | ~~\* Fixed: wrong data writing on logfile~~ |
  | 206 |  | ~~= 2.4.2 =~~ |
  | 207 |  | ~~\* Fixed: small glitch on textdomain call~~ |
  | 208 |  | ~~= 2.4 =~~ |
  | 209 |  | ~~\* Fixed double counting in WPMU. Added BuddyPress support~~ |
  | 210 |  | ~~= 2.0 =~~ |
  | 211 |  | ~~\* Added: support to Multisites; settings link (at Plugins List); Improvements on warnings.~~ |
  | 212 |  | ~~= 1.3 =~~ |
  | 213 |  | ~~\* Added: Log data.~~ |
  | 214 |  | ~~= 1.13 =~~ |
  | 215 |  | ~~\* Added: js shake effect to the error message when form fill fails.~~ |
  | 216 |  | ~~= 1.1 =~~ |
  | 217 |  | ~~\* Some Javascript added to admin page. Visual help to change options improved.~~ |
* ## [skt-nurcaptcha/trunk/skt-nurc-admin.php](/changeset/3195583/skt-nurcaptcha/trunk/skt-nurc-admin.php "Show the changeset 3195583 restricted to skt-nurcaptcha/trunk/skt-nurc-admin.php")

  | [r2364198](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=2364198#L25 "Show revision 2364198 of this file in browser") | [r3195583](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583#L25 "Show revision 3195583 of this file in browser") |  |
  | --- | --- | --- |
  | 25 | 25 |  |
  | 26 | 26 |  |
  | 27 |  | if(isset($\_POST['sktnurc\_hidden'])) { // == 'Y' |
  | 28 |  | //Form data sent |
  |  | 27 | // \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
  |  | 28 | $flag = ( isset( $\_POST['sktnonce'] )) ? (wp\_verify\_nonce( $\_POST['sktnonce'], 'sktn\_save\_data' )) ? true : false : false; |
  |  | 29 | if ($flag) {  //Form data sent |
  | 29 | 30 | $sktnurc\_pubkey = $\_POST['sktnurc\_publkey']; |
  | 30 | 31 | update\_site\_option('sktnurc\_publkey', $sktnurc\_pubkey); |
  | […](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=2364198#L112) | […](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=3195583#L113) |  |
  | 112 | 113 | <div style="width:680px;padding:12px 0 12px 24px"> |
  | 113 | 114 | <form name="sktnurc\_form" method="post" action="<?php echo admin\_url( "options-general.php?page=".$\_GET["page"] ) ?>"> |
  | 114 |  | <~~input type="hidden" name="sktnurc\_hidden" value="Y" /~~> |
  |  | 115 | <?php wp\_nonce\_field( 'sktn\_save\_data', 'sktnonce' ); ?> |
  | 115 | 116 | <input id="log\_clear" type="hidden" name="log\_clear" value="no" /> |
  | 116 | 117 | <input id="confirm\_dialog" type="hidden" name="confirm\_dialog" value="<?php \_e( 'This option cannot be undone. Do you really want to erase all Log Data and restart Log File?', 'skt-nurcaptcha' ) ?>" /> |
* ## [skt-nurcaptcha/trunk/skt-nurcaptcha.php](/changeset/3195583/skt-nurcaptcha/trunk/skt-nurcaptcha.php "Show the changeset 3195583 restricted to skt-nurcaptcha/trunk/skt-nurcaptcha.php")

  | [r2364198](/browser/skt-nurcaptcha/trunk/skt-nurcaptcha.php?rev=2364198#L236 "Show revision 2364198 of this file in browser") | [r3195583](/browser/skt-nurcaptcha/trunk/skt-nurcaptcha.php?rev=3195583#L236 "Show revision 3195583 of this file in browser") |  |
  | --- | --- | --- |
  | 236 | 236 | \_e('You must register your reCAPTCHA keys to have Skt NURCaptcha protection enabled.', 'skt-nurcaptcha' ); |
  | 237 | 237 | if (get\_admin\_page\_title() != 'Skt NURCaptcha') { |
  | 238 |  | echo '<br />'.\_\_('Go to', 'skt-nurcaptcha')." <a href='options-general.php?page=skt\_nurcaptcha'>".\_\_('Skt NURCaptcha Settings', 'skt-nurcaptcha')."</a> ". \_\_( 'and save your keys to the appropriate fields', 'skt-nurcaptcha' ); |
  |  | 238 | echo '<br />'.\_\_('Go to', 'skt-nurcaptcha')." <a href='options-general.php?page=skt\_nurcaptcha'>".\_\_('Skt NURCaptcha Settings', 'skt-nurcaptcha')."</a> ". \_\_( 'and save your keys to the appropriate fields', 'skt-nurcaptcha' ); |
  | 239 | 239 | } else { |
  | 240 | 240 | echo '<br />'. \_\_( 'Be sure your keys are saved to the appropriate fields down here', 'skt-nurcaptcha' ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3195583)
* [Zip Archive](?format=zip&new=3195583)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_3553e789_20250114_182257.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fskt-nurcaptcha%2Ftrunk%2Fskt-nurc-admin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?rev=2364198 "Revision 2364198")
* Next Revision →
* [Blame](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/skt-nurcaptcha/trunk/skt-nurc-admin.php)

---

# [source:](/browser?order=name "Go to repository root") [skt-nurcaptcha](/browser/skt-nurcaptcha?order=name "View skt-nurcaptcha")/[trunk](/browser/skt-nurcaptcha/trunk?order=name "View trunk")/[skt-nurc-admin.php](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?order=name "View skt-nurc-admin.php")

View diff against:

View revision:

| [Last change](/changeset/3195583/skt-nurcaptcha/trunk/skt-nurc-admin.php "View differences") on this file was [3195583](/changeset/3195583/ "View changeset 3195583"), checked in by Sanskritforum, [7 weeks ago](/timeline?from=2024-11-23T17%3A58%3A06Z&precision=second "See timeline at 11/23/2024 05:58:06 PM") |
| --- |
| Version 3.6.0 - Fixed vulnerability to Cross-Site Request Forgery |
| **File size:** 26.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | // ============================================================ |
| [4](#L4) | if(get\_site\_option('sktnurc\_stopforumspam\_active')!==false) |
| [5](#L5) | delete\_site\_option( 'sktnurc\_stopforumspam\_active' ); |
| [6](#L6) | if(get\_site\_option('sktnurc\_recaptcha\_version')!==false) |
| [7](#L7) | delete\_site\_option( 'sktnurc\_recaptcha\_version' ); |
| [8](#L8) | if(get\_site\_option('sktnurc\_botscout\_active')!==false) |
| [9](#L9) | delete\_site\_option( 'sktnurc\_botscout\_active' ); |
| [10](#L10) | if(get\_site\_option('sktnurc\_botscoutkey')!==false) |
| [11](#L11) | delete\_site\_option( 'sktnurc\_botscoutkey' ); |
| [12](#L12) | if(get\_site\_option('sktnurc\_botscoutTestMode')!==false) |
| [13](#L13) | delete\_site\_option( 'sktnurc\_botscoutTestMode' ); |
| [14](#L14) | // =========================================================== |
| [15](#L15) | \*/ |
| [16](#L16) | if(get\_site\_option('sktnurc\_recaptcha\_language')=="") |
| [17](#L17) | update\_site\_option('sktnurc\_recaptcha\_language','xx'); |
| [18](#L18) | if(get\_site\_option('sktnurc\_data\_theme')=="") |
| [19](#L19) | update\_site\_option('sktnurc\_data\_theme', "light"); |
| [20](#L20) | if(get\_site\_option('sktnurc\_data\_type')=="") |
| [21](#L21) | update\_site\_option('sktnurc\_data\_type', "image"); |
| [22](#L22) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="") |
| [23](#L23) | update\_site\_option('sktnurc\_login\_recaptcha', "false"); |
| [24](#L24) |  |
| [25](#L25) |  |
| [26](#L26) |  |
| [27](#L27) | // \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
| [28](#L28) | $flag = ( isset( $\_POST['sktnonce'] )) ? (wp\_verify\_nonce( $\_POST['sktnonce'], 'sktn\_save\_data' )) ? true : false : false; |
| [29](#L29) | if ($flag) {  //Form data sent |
| [30](#L30) | $sktnurc\_pubkey = $\_POST['sktnurc\_publkey']; |
| [31](#L31) | update\_site\_option('sktnurc\_publkey', $sktnurc\_pubkey); |
| [32](#L32) |  |
| [33](#L33) | $sktnurc\_privkey = $\_POST['sktnurc\_privtkey']; |
| [34](#L34) | update\_site\_option('sktnurc\_privtkey', $sktnurc\_privkey); |
| [35](#L35) |  |
| [36](#L36) | // \*\*\*\*\*  update register form's help messages: |
| [37](#L37) | update\_site\_option('sktnurc\_username\_help', $\_POST['sktnurc\_username\_help']); |
| [38](#L38) | update\_site\_option('sktnurc\_email\_help', $\_POST['sktnurc\_email\_help']); |
| [39](#L39) | update\_site\_option('sktnurc\_v2\_reCaptcha\_help', $\_POST['sktnurc\_v2\_reCaptcha\_help']); |
| [40](#L40) | if(isset($\_POST['sktnurc\_usrhlp\_opt']) && ($\_POST['sktnurc\_usrhlp\_opt'] == 'true')){ |
| [41](#L41) | update\_site\_option('sktnurc\_usrhlp\_opt', 'true'); |
| [42](#L42) | }else{ |
| [43](#L43) | update\_site\_option('sktnurc\_usrhlp\_opt', 'false'); |
| [44](#L44) | } |
| [45](#L45) |  |
| [46](#L46) | if(isset($\_POST['sktnurc\_emlhlp\_opt']) && ($\_POST['sktnurc\_emlhlp\_opt'] == 'true')){ |
| [47](#L47) | update\_site\_option('sktnurc\_emlhlp\_opt', 'true'); |
| [48](#L48) | }else{ |
| [49](#L49) | update\_site\_option('sktnurc\_emlhlp\_opt', 'false'); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | if(isset($\_POST['sktnurc\_rechlp\_opt']) && ($\_POST['sktnurc\_rechlp\_opt'] == 'true')){ |
| [53](#L53) | update\_site\_option('sktnurc\_rechlp\_opt', 'true'); |
| [54](#L54) | }else{ |
| [55](#L55) | update\_site\_option('sktnurc\_rechlp\_opt', 'false'); |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) | // \*\*\*\*\* |
| [59](#L59) |  |
| [60](#L60) | update\_site\_option('sktnurc\_username\_help', $\_POST['sktnurc\_username\_help']); |
| [61](#L61) |  |
| [62](#L62) | $sktnurc\_logpage\_limit = absint($\_POST['sktnurc\_logpage\_limit']); |
| [63](#L63) | if ($sktnurc\_logpage\_limit < 5) $sktnurc\_logpage\_limit = 5; |
| [64](#L64) | update\_site\_option('sktnurc\_logpage\_limit', $sktnurc\_logpage\_limit); |
| [65](#L65) |  |
| [66](#L66) | update\_site\_option('sktnurc\_regbutton', $\_POST['sktnurc\_regbutton']); |
| [67](#L67) |  |
| [68](#L68) | if (isset($\_POST['sktnurc\_custom\_page\_list']) && (is\_array($\_POST['sktnurc\_custom\_page\_list']))){ |
| [69](#L69) | update\_site\_option('sktnurc\_custom\_page\_list', $\_POST['sktnurc\_custom\_page\_list']); |
| [70](#L70) | }else{ |
| [71](#L71) | update\_site\_option('sktnurc\_custom\_page\_list', NULL); |
| [72](#L72) | } |
| [73](#L73) | update\_site\_option('sktnurc\_data\_type', $\_POST['sktnurc\_data\_type']); |
| [74](#L74) | update\_site\_option('sktnurc\_data\_theme', $\_POST['sktnurc\_data\_theme']); |
| [75](#L75) | update\_site\_option('sktnurc\_login\_recaptcha', $\_POST['sktnurc\_login\_recaptcha']); |
| [76](#L76) | update\_site\_option('sktnurc\_recaptcha\_language', $\_POST['sktnurc\_recaptcha\_language']); |
| [77](#L77) |  |
| [78](#L78) |  |
| [79](#L79) | if ($\_POST['log\_clear']!= 'no') { |
| [80](#L80) | $clear\_log\_file = nurc\_clear\_log\_file(); |
| [81](#L81) | if ($clear\_log\_file !== false) { |
| [82](#L82) | ?> |
| [83](#L83) | <div class="updated"><p><strong><?php echo $clear\_log\_file; ?></strong></p></div> |
| [84](#L84) | <?php |
| [85](#L85) | }else{ |
| [86](#L86) | echo '<div class="error"><p><strong>'; |
| [87](#L87) | \_e('An Error occurred: Log File deletion was not possible.', 'skt-nurcaptcha' ); |
| [88](#L88) | echo '</strong></p></div>'; |
| [89](#L89) | } |
| [90](#L90) | } |
| [91](#L91) | ?> |
| [92](#L92) | <div class="updated"><p><strong><?php \_e('Options saved.', 'skt-nurcaptcha' ); ?></strong></p></div> |
| [93](#L93) | <?php |
| [94](#L94) | if ($botscoutkey\_verified == false) { |
| [95](#L95) | settings\_errors( 'botscoutkey' ); |
| [96](#L96) | } |
| [97](#L97) | } else { |
| [98](#L98) | //Normal page display |
| [99](#L99) | $sktnurc\_pubkey = get\_site\_option('sktnurc\_publkey'); |
| [100](#L100) | $sktnurc\_privkey = get\_site\_option('sktnurc\_privtkey'); |
| [101](#L101) | $sktnurc\_botscoutkey = get\_site\_option('sktnurc\_botscoutkey'); |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) |  |
| [105](#L105) | ?> |
| [106](#L106) | <div class="wrap"> |
| [107](#L107) | <?php |
| [108](#L108) | $nurc\_version = nurc\_get\_version(); |
| [109](#L109) | $nurc\_icon = plugin\_dir\_url(dirname(\_\_FILE\_\_).'/skt-nurcaptcha.php')."img/icon.svg"; |
| [110](#L110) | echo "<div style=\"margin-left:24px;\"><h2><img src=\"$nurc\_icon\" height=\"42\" width=\"42\" style=\"margin-right:4px;\" >" . \_\_( 'Skt NURCaptcha Settings', 'skt-nurcaptcha' ) . "</h2></div>"; |
| [111](#L111) | ?> |
| [112](#L112) |  |
| [113](#L113) | <div style="width:680px;padding:12px 0 12px 24px"> |
| [114](#L114) | <form name="sktnurc\_form" method="post" action="<?php echo admin\_url( "options-general.php?page=".$\_GET["page"] ) ?>"> |
| [115](#L115) | <?php wp\_nonce\_field( 'sktn\_save\_data', 'sktnonce' ); ?> |
| [116](#L116) | <input id="log\_clear" type="hidden" name="log\_clear" value="no" /> |
| [117](#L117) | <input id="confirm\_dialog" type="hidden" name="confirm\_dialog" value="<?php \_e( 'This option cannot be undone. Do you really want to erase all Log Data and restart Log File?', 'skt-nurcaptcha' ) ?>" /> |
| [118](#L118) | <?php echo \_\_('Version: ', 'skt-nurcaptcha') . $nurc\_version; ?> |
| [119](#L119) | <p style="padding: .5em; background-color: #666666; color: #fff;position:relative">Skt NURCaptcha |
| [120](#L120) | <?php   $total = skt\_nurc\_countlog(); |
| [121](#L121) | if ($total) { |
| [122](#L122) |  |
| [123](#L123) | echo \_\_( 'has blocked', 'skt-nurcaptcha' ) . " <strong> ".$total."</strong> ". \_\_( 'suspect register attempts on this site.', 'skt-nurcaptcha' ). "<span id='log\_button' class=\"log\_button button-primary\" style=\"position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:12px\">&nbsp;".\_\_('Toggle Log', 'skt-nurcaptcha')."&nbsp;</span><span id='no\_log\_button' class=\"log\_button button-primary\" style=\"display:none;position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:12px\">&nbsp;".\_\_('Toggle Log', 'skt-nurcaptcha')."&nbsp;</span>"; |
| [124](#L124) | } ?> |
| [125](#L125) | </p><br /> |
| [126](#L126) | <?php    echo  \_\_( 'NURCaptcha stands for <strong>New User Register Captcha</strong>.', 'skt-nurcaptcha' ) . "<br />"; ?> |
| [127](#L127) | <?php    echo  \_\_( 'It uses Google\'s reCaptcha tools to protect your site against spammer bots, ', 'skt-nurcaptcha' ) ; ?> |
| [128](#L128) | <?php    echo  \_\_( 'adding security to the WP Register Form. You can learn more', 'skt-nurcaptcha' ) ; ?> |
| [129](#L129) | <?php    echo  '<a href="https://www.google.com/recaptcha/intro/index.html#advanced-security" target="\_blank"> '.\_\_('here','skt-nurcaptcha').' </a>'.\_\_('about reCAPTCHA Security','skt-nurcaptcha').'<br />'; ?> |
| [130](#L130) | <?php    echo "<br />"; ?> |
| [131](#L131) | <p class="submit" > |
| [132](#L132) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [133](#L133) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page! ','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [134](#L134) | </p> |
| [135](#L135) | <div style="clear:both"></div> |
| [136](#L136) | <?php |
| [137](#L137) | if(!isset( $\_GET['pagenum'] )){$display\_none = "display:none";}else{$display\_none = "";} |
| [138](#L138) | echo "<div id='log\_entries' style='width:800px;position:relative;".$display\_none."'>"; |
| [139](#L139) | echo "<span id='unlink\_log\_button' class=\"button-primary\" style=\"position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;top:2px;right:82px;".$display\_none ."\">&nbsp;".\_\_('Delete Log File', 'skt-nurcaptcha')."&nbsp;</span><span id='link\_log\_button' class=\"button-primary\" style=\"display:none;position:absolute;cursor:pointer;color:#fff;font-weight:bold;background:#ff2000;text-decoration:none;top:2px;right:132px\">&nbsp;".\_\_('Cancel Delete Log File', 'skt-nurcaptcha')."&nbsp;</span> "; |
| [140](#L140) |  |
| [141](#L141) | $pagenum = isset( $\_GET['pagenum'] ) ? absint( $\_GET['pagenum'] ) : 1; // if pagenum absent, assume value 1. |
| [142](#L142) | $limit = get\_site\_option('sktnurc\_logpage\_limit',20); |
| [143](#L143) | $num\_of\_pages = ceil( $total / $limit ); |
| [144](#L144) | if($pagenum > $num\_of\_pages) $pagenum = $num\_of\_pages; |
| [145](#L145) | $page\_links = paginate\_links( array( |
| [146](#L146) | 'base' => add\_query\_arg( 'pagenum', '%#%' ), |
| [147](#L147) | 'format' => '', |
| [148](#L148) | 'prev\_text' => '&laquo;', |
| [149](#L149) | 'next\_text' => '&raquo;', |
| [150](#L150) | 'total' => $num\_of\_pages, |
| [151](#L151) | 'current' => $pagenum |
| [152](#L152) | ) ); |
| [153](#L153) |  |
| [154](#L154) | echo "<h3>". \_\_('Last Blocked Attemptives','skt-nurcaptcha')." (".$total.")</h3>"; |
| [155](#L155) | if ($num\_of\_pages > 1) |
| [156](#L156) | echo "<strong>". \_\_('Page','skt-nurcaptcha'). " ".$pagenum." ".\_\_('of','skt-nurcaptcha')." ".$num\_of\_pages. "</strong> -> "; |
| [157](#L157) | echo " ("; |
| [158](#L158) | echo " <input type=\"text\" id=\"sktnurc\_logpage\_limit\" name=\"sktnurc\_logpage\_limit\" value=\""; |
| [159](#L159) | echo $limit ."\" size=\"4\"> ".\_\_("occurrences per page",'skt-nurcaptcha').")"; |
| [160](#L160) |  |
| [161](#L161) | $offset = ( $pagenum - 1 ) \* $limit; |
| [162](#L162) | if ($attemptives = skt\_nurc\_listlog($limit, $offset)){ |
| [163](#L163) | if ( $page\_links ) { |
| [164](#L164) | echo '<div class="tablenav" style="margin-right:70px"><div class="tablenav-pages" style="margin: 1em 0">' . $page\_links . '</div></div><div style="clear:both"></div>'; |
| [165](#L165) | }else{ |
| [166](#L166) | echo '<br /><br />'; |
| [167](#L167) | } |
| [168](#L168) | //abrir form de eliminação de registros |
| [169](#L169) | foreach($attemptives as $attemptive){ |
| [170](#L170) | // incluir checkbox com value=$attemptive->id; |
| [171](#L171) | echo $attemptive->time; |
| [172](#L172) | echo " &raquo;&ensp; email: &lt;<strong>".$attemptive->email."</strong>&gt;"; |
| [173](#L173) | echo " &rarr; name: <strong>".$attemptive->username."</strong> "; |
| [174](#L174) | echo " &rarr; IP: ".$attemptive->ip." "; |
| [175](#L175) | echo "&ensp;&raquo;&ensp; [".$attemptive->procid."]"; |
| [176](#L176) | echo "<br />"; |
| [177](#L177) | } |
| [178](#L178) | // fechar form de eliminação de registros com botão "Apagar os registros selecionados" |
| [179](#L179) | if ( $page\_links ) { |
| [180](#L180) | echo '<div class="tablenav" style="margin-right:70px"><div class="tablenav-pages" style="margin: 1em 0">' . $page\_links . '</div></div>'; |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) | }else{ |
| [184](#L184) | echo \_\_("No data to show", 'skt-nurcaptcha'); |
| [185](#L185) | } |
| [186](#L186) | echo '<br /><br />'; |
| [187](#L187) | echo "</div>"; // end of <div id="log\_entries"> |
| [188](#L188) | ?> |
| [189](#L189) | <div style="clear:both"></div> |
| [190](#L190) | <?php    echo "<br />"; ?> |
| [191](#L191) | <?php    echo "<p style=\"padding: .5em; background-color: #666666; color: #fff;\">" . \_\_( 'To enable this plugin\'s functionality, please enter your reCAPTCHA keys here:', 'skt-nurcaptcha' ) . "</p><br />"; // grey section title bar |
| [192](#L192) |  |
| [193](#L193) | echo "<small>[". \_\_( 'You can sign up for reCaptcha <strong>free</strong> keys here: ', 'skt-nurcaptcha' ); |
| [194](#L194) | echo '<a href="'.nurc\_recaptcha\_get\_signup\_url().'" target="\_blank"><strong>reCAPTCHA API Signup Page</strong></a>]</small>'; ?> |
| [195](#L195) | </div> |
| [196](#L196) |  |
| [197](#L197) | <div style="width:680px;padding:12px 0 12px 24px"> |
| [198](#L198) | <p><?php \_e("reCaptcha Site Key: ", 'skt-nurcaptcha' ); ?><input type="text" id="sktnurc\_publkey" name="sktnurc\_publkey" value="<?php echo $sktnurc\_pubkey; ?>" size="46"></p> |
| [199](#L199) | <p><?php \_e("reCaptcha Secret Key: ", 'skt-nurcaptcha' ); ?><input type="text" id="sktnurc\_privtkey" name="sktnurc\_privtkey" value="<?php echo $sktnurc\_privkey; ?>" size="46"></p> |
| [200](#L200) | <p class="submit" > |
| [201](#L201) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [202](#L202) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [203](#L203) | </p> |
| [204](#L204) | </div> |
| [205](#L205) |  |
| [206](#L206) | <div style="position:relative;width:680px;padding:12px 0 12px 24px"> |
| [207](#L207) | <p style="padding: .5em; background-color: #666666; color: #fff;"><?php echo \_\_( 'Style your reCaptcha:', 'skt-nurcaptcha' ) ?></p> |
| [208](#L208) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [209](#L209) |  |
| [210](#L210) | <div id="sktth" style="position:relative;"> |
| [211](#L211) | <span><strong><?php  \_e('reCAPTCHA theme:', 'skt-nurcaptcha'); ?></strong></span><br /> |
| [212](#L212) | &nbsp;&nbsp;&nbsp;&nbsp;<select id="sktnurc\_theme" name="sktnurc\_data\_theme"> |
| [213](#L213) | <?php |
| [214](#L214) | $plugin\_img\_path = array(); |
| [215](#L215) | $rc\_themes = array('light' => 'Light (default)', 'dark' => 'Dark'); |
| [216](#L216) | foreach( $rc\_themes as $k => $v ) { |
| [217](#L217) | $selected = ( $k == get\_site\_option('sktnurc\_data\_theme') ) ? 'selected="selected"' : ''; |
| [218](#L218) | echo "<option value='$k' $selected>$v</option>"; |
| [219](#L219) | $plugin\_img\_path[$k] = WP\_PLUGIN\_URL.'/'.str\_replace(basename( \_\_FILE\_\_),"",plugin\_basename(\_\_FILE\_\_)); |
| [220](#L220) | $plugin\_img\_path[$k] .= 'img/'.$k.'.png'; |
| [221](#L221) | } |
| [222](#L222) | $def\_img = ( "" == get\_site\_option('sktnurc\_data\_theme') ) ? 'light' : get\_site\_option('sktnurc\_data\_theme'); |
| [223](#L223) | ?> |
| [224](#L224) | </select><br /> |
| [225](#L225) | <!-- reCAPTCHA images --> |
| [226](#L226) | <div class="captcha-img" style="float:left;width:460px; margin:-42px 0 110px 0; padding:0 0 12px 0"> |
| [227](#L227) | <?php |
| [228](#L228) | foreach ($plugin\_img\_path as $k => $v) { |
| [229](#L229) | ?> |
| [230](#L230) | <div id="sktnurc-display-<?php |
| [231](#L231) | echo $k; |
| [232](#L232) | ?>" style="position:absolute;margin-left:232px<?php |
| [233](#L233) | if ($k != $def\_img) { echo ';display:none';} ?>"> |
| [234](#L234) | <img src="<?php echo $plugin\_img\_path[$k]; ?>" title="<?php |
| [235](#L235) | \_e('This is the look of your captcha','skt-nurcaptcha'); ?>" /> |
| [236](#L236) | </div> |
| [237](#L237) | <?php |
| [238](#L238) | } |
| [239](#L239) | ?> |
| [240](#L240) | </div><!-- end of reCAPTCHA images --> |
| [241](#L241) |  |
| [242](#L242) | </div><!-- end of reCAPTCHA theme block --> |
| [243](#L243) |  |
| [244](#L244) | </div><!-- end of wrapper - theme block --> |
| [245](#L245) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [246](#L246) |  |
| [247](#L247) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [248](#L248) | <div style="padding:4px 0 4px 0;"> |
| [249](#L249) | <span><strong><?php \_e('reCAPTCHA language:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [250](#L250) | <span><?php \_e("If you want to force the widget to render in a specific language, use the selector below. Auto-detects the user's language if unspecified.", 'skt-nurcaptcha') ?></span><br /><br /> |
| [251](#L251) | <?php  echo skt\_get\_lang\_selector(get\_site\_option('sktnurc\_recaptcha\_language')) ?> |
| [252](#L252) | </div> |
| [253](#L253) | </div> |
| [254](#L254) | <div style="clear:both"></div> |
| [255](#L255) |  |
| [256](#L256) | <p class="submit" > |
| [257](#L257) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [258](#L258) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [259](#L259) | </p> |
| [260](#L260) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [261](#L261) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [262](#L262) | <div style="padding:4px 0 4px 0;"> |
| [263](#L263) |  |
| [264](#L264) | <span><strong><?php \_e('reCAPTCHA type:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [265](#L265) | <span><?php \_e('Once and a while, when needed, reCAPTCHA will present a challenge for the user to solve. By default, this challenge is an image with words or numbers. You can change the challenge to audio type, if you think this is a better fit to your site.', 'skt-nurcaptcha') ?></span><br /><br /> |
| [266](#L266) | <p><input type="radio" id="rec\_type\_image" value="image" name="sktnurc\_data\_type" <?php |
| [267](#L267) | if(get\_site\_option('sktnurc\_data\_type')=="image") echo 'checked'; |
| [268](#L268) | ?> /> <?php \_e('Use image challenge, when needed','skt-nurcaptcha'); ?><br /> |
| [269](#L269) | <input type="radio" id="rec\_type\_audio" value="audio" name="sktnurc\_data\_type" <?php |
| [270](#L270) | if(get\_site\_option('sktnurc\_data\_type')=="audio") echo 'checked'; |
| [271](#L271) | ?> /> <?php \_e('Use audio challenge, only','skt-nurcaptcha'); ?><br /></p> |
| [272](#L272) |  |
| [273](#L273) | </div> |
| [274](#L274) | </div> |
| [275](#L275) |  |
| [276](#L276) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [277](#L277) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [278](#L278) | <div style="padding:4px 0 4px 0;"> |
| [279](#L279) |  |
| [280](#L280) | <span><strong><?php \_e('enable reCAPTCHA on LOGIN form:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [281](#L281) | <span><?php \_e('This feature adds extra security to your site, by inserting a reCAPTCHA at the end of the login form. Thus, even if a bot comes to guess the right username and password, this extra reCAPTCHA may provide additional strenght to block the invasion.', 'skt-nurcaptcha') ?></span><br /><br /> |
| [282](#L282) | <p><input type="radio" id="rec\_at\_login" value="true" name="sktnurc\_login\_recaptcha" <?php |
| [283](#L283) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="true") echo 'checked'; |
| [284](#L284) | ?> /> <?php \_e('Use login reCAPTCHA, for extra protection.','skt-nurcaptcha'); ?><br /> |
| [285](#L285) | <input type="radio" id="rec\_not\_at\_login" value="false" name="sktnurc\_login\_recaptcha" <?php |
| [286](#L286) | if(get\_site\_option('sktnurc\_login\_recaptcha')=="false") echo 'checked'; |
| [287](#L287) | ?> /> <?php \_e('No, thanks.','skt-nurcaptcha'); ?><br /></p> |
| [288](#L288) |  |
| [289](#L289) | </div> |
| [290](#L290) | </div> |
| [291](#L291) | <p class="submit" > |
| [292](#L292) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [293](#L293) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [294](#L294) | </p> |
| [295](#L295) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [296](#L296) | <div style="float:left;width:600px;padding-left:24px;margin:12px 0 12px 0"> |
| [297](#L297) | <div style="padding:4px 0 4px 0;"> |
| [298](#L298) |  |
| [299](#L299) | <span><strong><?php \_e('enable reCAPTCHA on selected front-end pages:', 'skt-nurcaptcha') ?></strong></span><br /><br /> |
| [300](#L300) | <span><?php \_e('If you have login or register forms located on front-end pages in your site, you must select them at the selector below, so the reCAPTCHA script can be correctly loaded to these pages - ready to be called to action.', 'skt-nurcaptcha') ?></span><br /> |
| [301](#L301) | <span><?php \_e('Get some more information on how to set up front pages to display the captcha by reading this article:', 'skt-nurcaptcha') ?></span> <a href="https://skt-nurcaptcha.sanskritforum.org/2015/08/25/recaptcha-anywhere-in-your-theme/" target="\_blank">How to implement a reCAPTCHA anywhere in your theme</a> |
| [302](#L302) | <br /><br /> |
| [303](#L303) | <p> |
| [304](#L304) | <span id='custom\_pages\_button' class="button-primary" style="cursor:pointer;color:#fff;font-weight:bold;background:#4086aa;text-decoration:none;"><?php echo  \_\_('Toggle Selector', 'skt-nurcaptcha'); ?></span> |
| [305](#L305) | <br /></p> |
| [306](#L306) | <div id="debug\_output"></div> |
| [307](#L307) | <div style="clear:both"></div> |
| [308](#L308) | <?php echo skt\_nurc\_pages\_checkbox(); ?> |
| [309](#L309) | <br /> |
| [310](#L310) |  |
| [311](#L311) | </div> |
| [312](#L312) | </div> |
| [313](#L313) |  |
| [314](#L314) | <div style="clear:both;border-bottom:dotted #ccc 1px;"></div> <!-- separator --> |
| [315](#L315) | <div style="float:left;width:180px;padding-left:24px;margin:12px 0 12px 0;"> |
| [316](#L316) | <p style="position:relative"> |
| [317](#L317) | <?php \_e("Customize text to appear in Submit Button (register form): ", 'skt-nurcaptcha' ); ?> |
| [318](#L318) | <input type="text" id="sktnurc\_regbutton" name="sktnurc\_regbutton" |
| [319](#L319) | value="<?php echo get\_site\_option('sktnurc\_regbutton'); ?>" size="26"><br /> |
| [320](#L320) | <?php echo "[ default: <strong><span id='sktnurc\_regbutton\_text' >". \_\_('Register', 'skt-nurcaptcha' )."</span></strong> ]"; ?> |
| [321](#L321) |  |
| [322](#L322) | </p> |
| [323](#L323) | </div> |
| [324](#L324) | <div class="regbutton-mock-up" style="margin-left:232px;position:absolute;width:312px;padding:24px 0 12px 0"> |
| [325](#L325) | <input style="float:left;margin-right:12px; border:1px solid #fff" type="submit" size="auto" class="button-primary" id="sktnurc-mockup-wp-submit" value="<?php |
| [326](#L326) | if (get\_site\_option('sktnurc\_regbutton')==""){ |
| [327](#L327) | \_e("Register", 'skt-nurcaptcha'); |
| [328](#L328) | } else { |
| [329](#L329) | echo get\_site\_option('sktnurc\_regbutton'); |
| [330](#L330) | } |
| [331](#L331) | ?>" /> |
| [332](#L332) | </div> |
| [333](#L333) | <div style="clear:both"></div> |
| [334](#L334) |  |
| [335](#L335) | <p class="submit" > |
| [336](#L336) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [337](#L337) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [338](#L338) | </p> |
| [339](#L339) | </div> |
| [340](#L340) |  |
| [341](#L341) | <?php |
| [342](#L342) |  |
| [343](#L343) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Customize register form help messages \*/ |
| [344](#L344) |  |
| [345](#L345) | ?> |
| [346](#L346) | <div style="position:relative;width:680px;padding:8px 0 12px 24px"> |
| [347](#L347) | <p style="padding: .6em; background-color: #666; color: #fff;"> |
| [348](#L348) | <?php echo \_\_( 'Customize register form\'s help messages:', 'skt-nurcaptcha' ) ?> |
| [349](#L349) | </p><br /> |
| [350](#L350) | <span> |
| [351](#L351) | <?php \_e('Use these fields to change the default help messages that Skt NURCaptcha adds to the register form. To return to default values, simply delete all content from that field and click on the save button.','skt-nurcaptcha'); ?> |
| [352](#L352) | </span><br /><br /> |
| [353](#L353) | <?php |
| [354](#L354) | $userHelp = sktnurc\_username\_help\_text(); |
| [355](#L355) | $emailHelp = sktnurc\_email\_help\_text(); |
| [356](#L356) | $recHelp = sktnurc\_reCaptcha\_help\_text(); |
| [357](#L357) |  |
| [358](#L358) | ?> |
| [359](#L359) | <strong><?php \_e( 'Username:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [360](#L360) | <textarea id="sktnurc\_username\_help" name="sktnurc\_username\_help" cols="90" rows="5"> |
| [361](#L361) | <?php echo $userHelp ?> |
| [362](#L362) | </textarea> |
| [363](#L363) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_usrhlp\_opt" id="sktnurc\_usrhlp\_opt" value="true" |
| [364](#L364) | <?php if (get\_site\_option('sktnurc\_usrhlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [365](#L365) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [366](#L366) | <br /><br /> |
| [367](#L367) | <strong><?php \_e( 'Email:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [368](#L368) | <textarea id="sktnurc\_email\_help" name="sktnurc\_email\_help" cols="90" rows="5"> |
| [369](#L369) | <?php echo $emailHelp ?> |
| [370](#L370) | </textarea> |
| [371](#L371) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_emlhlp\_opt" id="sktnurc\_emlhlp\_opt" value="true" |
| [372](#L372) | <?php if (get\_site\_option('sktnurc\_emlhlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [373](#L373) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [374](#L374) | <br /><br /> |
| [375](#L375) | <strong><?php \_e( 'reCAPTCHA:', 'skt-nurcaptcha' ) ?></strong><br /> |
| [376](#L376) | <textarea id="sktnurc\_reCaptcha\_help" name="sktnurc\_v2\_reCaptcha\_help" cols="90" rows="5"> |
| [377](#L377) | <?php echo $recHelp ?> |
| [378](#L378) | </textarea> |
| [379](#L379) | <input class="sktSpam\_check" type="checkbox" name="sktnurc\_rechlp\_opt" id="sktnurc\_rechlp\_opt" value="true" |
| [380](#L380) | <?php if (get\_site\_option('sktnurc\_rechlp\_opt')=='true') { ?>checked<?php } ?> /> |
| [381](#L381) | <?php \_e('(Hide this help)','skt-nurcaptcha'); ?> |
| [382](#L382) | <br /> |
| [383](#L383) |  |
| [384](#L384) |  |
| [385](#L385) | <div style="clear:both"></div> |
| [386](#L386) |  |
| [387](#L387) | <p class="submit" > |
| [388](#L388) | <input style="float:right;margin-right:12px; border:1px solid #fff" type="submit" id="submit" class="button-primary" name="submit" value="<?php \_e('Update Options', 'skt-nurcaptcha' ) ?>" /> |
| [389](#L389) | <span class="save-advert" style="display:none;color:#ff2200;float:right;margin-right:8px"><strong><?php \_e('Remember to save your changes before leaving this page!','skt-nurcaptcha'); ?>&nbsp;&raquo;&nbsp;&raquo;&nbsp;&raquo;&nbsp;</strong></span> |
| [390](#L390) | </p> |
| [391](#L391) | </div> |
| [392](#L392) | </form> |
| [393](#L393) |  |
| [394](#L394) | <?php |
| [395](#L395) |  |
| [396](#L396) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* PayPal Donation Button \*/ |
| [397](#L397) |  |
| [398](#L398) | ?> |
| [399](#L399) | <div style="position:relative;width:680px;padding:8px 0 12px 24px"> |
| [400](#L400) | <p style="padding: .6em; background-color: #666; color: #fff;"> |
| [401](#L401) | <?php echo \_\_( 'Make me happy:', 'skt-nurcaptcha' ) ?> |
| [402](#L402) | </p> |
| [403](#L403) | <div style="margin-left:32px;padding-bottom:12px"> |
| [404](#L404) | <form action="https://www.paypal.com/cgi-bin/webscr" method="post"> |
| [405](#L405) | <input type="hidden" name="cmd" value="\_s-xclick"> |
| [406](#L406) | <input type="hidden" name="hosted\_button\_id" value="SKNS7K7L5BFLL"> |
| [407](#L407) | <input type="image" src="https://www.paypalobjects.com/en\_US/i/btn/btn\_donateCC\_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!"> |
| [408](#L408) | <img alt="" border="0" src="https://www.paypalobjects.com/pt\_BR/i/scr/pixel.gif" width="1" height="1"> |
| [409](#L409) | </form> |
| [410](#L410) | </div> |
| [411](#L411) | </div> |
| [412](#L412) |  |
| [413](#L413) | </div>  <?php /\* end of div.wrap \*/ ?> |
| [414](#L414) |  |
| [415](#L415) | <?php |
| [416](#L416) |  |
| [417](#L417) | function nurc\_get\_version() { |
| [418](#L418) | $npath = nurc\_make\_path(); |
| [419](#L419) | $npath .= 'skt-nurcaptcha.php'; |
| [420](#L420) | $lines = file($npath); |
| [421](#L421) | $l = count($lines); |
| [422](#L422) | $version = 'wrong version'; |
| [423](#L423) | $i=0; |
| [424](#L424) | while ($i < $l): |
| [425](#L425) | if (trim($lines[$i])=='') { |
| [426](#L426) | $i++; |
| [427](#L427) | continue; |
| [428](#L428) | } |
| [429](#L429) | $r = strpos($lines[$i],'Version:'); |
| [430](#L430) | if ($r != false) { |
| [431](#L431) | $version = trim(substr($lines[$i],$r+8)); |
| [432](#L432) | break; |
| [433](#L433) | } |
| [434](#L434) | $i++; |
| [435](#L435) | endwhile; |
| [436](#L436) | return $version; |
| [437](#L437) |  |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) |  |
| [441](#L441) | /\* |
| [442](#L442) | \* builds array witth a few country names |
| [443](#L443) | \*/ |
| [444](#L444) | function skt\_nurc\_lang\_array() |
| [445](#L445) | { |
| [446](#L446) | return array( |
| [447](#L447) | 'xx' => 'Auto-detect user language', |
| [448](#L448) | 'ar' => 'Arabic', |
| [449](#L449) | 'bg' => 'Bulgarian', |
| [450](#L450) | 'ca' => 'Catalan', |
| [451](#L451) | 'zh-CN' => 'Chinese (Simplified)', |
| [452](#L452) | 'zh-TW' => 'Chinese (Traditional)', |
| [453](#L453) | 'hr' => 'Croatian', |
| [454](#L454) | 'cs' => 'Czech', |
| [455](#L455) | 'da' => 'Danish', |
| [456](#L456) | 'nl' => 'Dutch', |
| [457](#L457) | 'en-GB' => 'English (UK)', |
| [458](#L458) | 'en' => 'English (US)', |
| [459](#L459) | 'fil' => 'Filipino', |
| [460](#L460) | 'fi' => 'Finnish', |
| [461](#L461) | 'fr' => 'French', |
| [462](#L462) | 'fr-CA' => 'French (Canadian)', |
| [463](#L463) | 'de' => 'German', |
| [464](#L464) | 'de-AT' => 'German (Austria)', |
| [465](#L465) | 'de-CH' => 'German (Switzerland)', |
| [466](#L466) | 'el' => 'Greek', |
| [467](#L467) | 'iw' => 'Hebrew', |
| [468](#L468) | 'hi' => 'Hindi', |
| [469](#L469) | 'hu' => 'Hungarian', |
| [470](#L470) | 'id' => 'Indonesian', |
| [471](#L471) | 'it' => 'Italian', |
| [472](#L472) | 'ja' => 'Japanese', |
| [473](#L473) | 'ko' => 'Korean', |
| [474](#L474) | 'lv' => 'Latvian', |
| [475](#L475) | 'lt' => 'Lithuanian', |
| [476](#L476) | 'no' => 'Norwegian', |
| [477](#L477) | 'fa' => 'Persian', |
| [478](#L478) | 'pl' => 'Polish', |
| [479](#L479) | 'pt' => 'Portuguese', |
| [480](#L480) | 'pt-BR' => 'Portuguese (Brazil)', |
| [481](#L481) | 'pt-PT' => 'Portuguese (Portugal)', |
| [482](#L482) | 'ro' => 'Romanian', |
| [483](#L483) | 'ru' => 'Russian', |
| [484](#L484) | 'sr' => 'Serbian', |
| [485](#L485) | 'sk' => 'Slovak', |
| [486](#L486) | 'sl' => 'Slovenian', |
| [487](#L487) | 'es' => 'Spanish', |
| [488](#L488) | 'es-419' => 'Spanish (Latin America)', |
| [489](#L489) | 'sv' => 'Swedish', |
| [490](#L490) | 'th' => 'Thai', |
| [491](#L491) | 'tr' => 'Turkish', |
| [492](#L492) | 'uk' => 'Ukrainian', |
| [493](#L493) | 'vi' => 'Vietnamese' |
| [494](#L494) | ); |
| [495](#L495) | } |
| [496](#L496) | // |
| [497](#L497) | /\* |
| [498](#L498) | \*\*\*\*\*\*\*\*\*\*\*\*\*\* produz select com os estados brasileiros  \*\*\*\*\*\*\*\*\*\*\*\*\* |
| [499](#L499) | \*/ |
| [500](#L500) | function skt\_get\_lang\_selector($selected = 'xx') { |
| [501](#L501) | $uf\_array = skt\_nurc\_lang\_array(); |
| [502](#L502) | $html = '<select id="sktnurc\_lang" name="sktnurc\_recaptcha\_language">'; |
| [503](#L503) | foreach($uf\_array as $lg => $lang\_name) |
| [504](#L504) | { |
| [505](#L505) | if ($lg==$selected){ |
| [506](#L506) | $s = 'selected="selected"'; |
| [507](#L507) | }else{ |
| [508](#L508) | $s = ''; |
| [509](#L509) | } |
| [510](#L510) | $html .= "<option value=\"$lg\" $s >$lang\_name "; |
| [511](#L511) | if($lg != 'xx') $html .= "[$lg]"; |
| [512](#L512) | $html .= "</option>"; |
| [513](#L513) | } |
| [514](#L514) |  |
| [515](#L515) | $html .= '</select>'; |
| [516](#L516) | return $html; |
| [517](#L517) | } |
| [518](#L518) | // |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/skt-nurcaptcha/trunk/skt-nurc-admin.php?format=txt)
* [Original Format](/export/3222434/skt-nurcaptcha/trunk/skt-nurc-admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


