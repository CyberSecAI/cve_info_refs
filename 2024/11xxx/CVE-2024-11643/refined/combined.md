=== Content from plugins.trac.wordpress.org_1415327e_20250114_192706.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3202017)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3202016 "Changeset 3202016")
* [Next Changeset](/changeset/3202018 "Changeset 3202018") →

---

# Changeset 3202017

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/04/2024 01:02:16 AM
([6 weeks](/timeline?from=2024-12-04T01%3A02%3A16Z&precision=second "See timeline at 12/04/2024 01:02:16 AM") ago)

Author:
allaccessible
Message:

Release of 1.3.5

Location:
[allaccessible/trunk](/browser/allaccessible/trunk?rev=3202017)
Files:

3 edited

* [README.txt](/browser/allaccessible/trunk/README.txt?rev=3202017 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [allaccessible.php](/browser/allaccessible/trunk/allaccessible.php?rev=3202017 "Show entry in browser")
  (modified)
  ([7 diffs](#file1 "Show differences"))
* [assets/allaccessible-custom.js](/browser/allaccessible/trunk/assets/allaccessible-custom.js?rev=3202017 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [allaccessible/trunk/README.txt](/changeset/3202017/allaccessible/trunk/README.txt "Show the changeset 3202017 restricted to allaccessible/trunk/README.txt")

  | [r3129364](/browser/allaccessible/trunk/README.txt?rev=3129364#L5 "Show revision 3129364 of this file in browser") | [r3202017](/browser/allaccessible/trunk/README.txt?rev=3202017#L5 "Show revision 3202017 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tags: accessibility, wcag, ada, section 508, accessible, wp accessibility |
  | 6 | 6 | Requires at least: 5.0 |
  | 7 |  | Tested up to: 6.~~6~~.1 |
  | 8 |  | Stable tag: 1.3.~~4~~ |
  |  | 7 | Tested up to: 6.7.1 |
  |  | 8 | Stable tag: 1.3.5 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/allaccessible/trunk/README.txt?rev=3129364#L88) | […](/browser/allaccessible/trunk/README.txt?rev=3202017#L88) |  |
  | 88 | 88 | \*   And More! |
  | 89 | 89 |  |
  | 90 |  | Partners receive additional benefits including: |
  |  | 90 | Partners receive additional benefits including: |
  | 91 | 91 |  |
  | 92 | 92 | \*   A free AllAccessible License for their website |
  | 93 |  | \*   Discounted Licensing Costs |
  |  | 93 | \*   Discounted Licensing Costs |
  | 94 | 94 | \*   A listing  on our partner directory |
  | 95 | 95 | \*   Access to our partner portal with free resources such as SOWs and marketing material  to help drive revenue |
  | […](/browser/allaccessible/trunk/README.txt?rev=3129364#L147) | […](/browser/allaccessible/trunk/README.txt?rev=3202017#L147) |  |
  | 147 | 147 | 5. Make adjusts to the widget position, size, icon, color, and other options on the settings screen. Settings are automatically saved. |
  | 148 | 148 |  |
  | 149 |  | 6. Verify the plugin is working on the homepage of the website. |
  |  | 149 | 6. Verify the plugin is working on the homepage of the website. |
  | 150 | 150 |  |
  | 151 | 151 | == Changelog == |
  |  | 152 |  |
  |  | 153 | = 1.3.5 = |
  |  | 154 | \* Security: Added authorization checks and nonce verification to settings updates. Thanks to 1337\_Wannabe for the responsible security disclosure. |
  |  | 155 | \* Security: Restricted option updates to specific plugin settings only. |
  |  | 156 | \* Improved efficiency of settings handling. |
  |  | 157 | \* Tested compatibility with WP 6.7.1 |
  | 152 | 158 |  |
  | 153 | 159 | = 1.3.4 = |
* ## [allaccessible/trunk/allaccessible.php](/changeset/3202017/allaccessible/trunk/allaccessible.php "Show the changeset 3202017 restricted to allaccessible/trunk/allaccessible.php")

  | [r3101358](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L4 "Show revision 3101358 of this file in browser") | [r3202017](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L4 "Show revision 3202017 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://www.allaccessible.org/platform/wordpress/ |
  | 5 | 5 | Description: Unlock true digital accessibility with AllAccessible - a comprehensive WordPress plugin driving your website towards WCAG/ADA compliance. Empower your users with a fully customizable accessibility widget, and enhance their experience with our premium AI-powered features. |
  | 6 |  | Version: 1.3.~~4~~ |
  |  | 6 | Version: 1.3.5 |
  | 7 | 7 | Requires PHP: 7 |
  | 8 | 8 | Author: AllAccessible Team |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L13) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L13) |  |
  | 13 | 13 |  |
  | 14 | 14 | /\*\* |
  | 15 |  | \* Copyright (C) 202~~3~~ AllAccessible. |
  |  | 15 | \* Copyright (C) 2024 AllAccessible. |
  | 16 | 16 | \* |
  | 17 | 17 | \* This program is free software: you can redistribute it and/or modify |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L31) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L31) |  |
  | 31 | 31 | /\*\* |
  | 32 | 32 | \* @package     AllAccessible |
  | 33 |  | \* @version     1.3.~~4~~ |
  |  | 33 | \* @version     1.3.5 |
  | 34 | 34 | \* @since       1.0 |
  | 35 | 35 | \* @author      AllAccessible Team |
  | 36 |  | \* @copyright   Copyright (c) 202~~2~~ AllAccessible |
  |  | 36 | \* @copyright   Copyright (c) 2024 AllAccessible |
  | 37 | 37 | \* @link        https://www.allaccessible.org/ |
  | 38 | 38 | \* @license     http://www.gnu.org/licenses/gpl.html |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L49) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L49) |  |
  | 49 | 49 | //    $aacb\_siteOptions = aacb\_siteOptions(); |
  | 50 | 50 | define('AACB\_NAME', isset($aacb\_siteOptions->isWhitelabel) && $aacb\_siteOptions->isWhitelabel ? \_e( "Accessibility", 'allaccessible' ) : 'AllAccessible'); |
  | 51 |  | define('AACB\_VERSION','1.3.~~4~~'); |
  |  | 51 | define('AACB\_VERSION','1.3.5'); |
  | 52 | 52 | define('AACB\_WP\_MIN\_VERSION','5.0'); |
  | 53 | 53 | define('AACB\_TEXT','allaccessible'); |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L174) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L174) |  |
  | 174 | 174 | wp\_enqueue\_style('allaccessible-admin-style', AACB\_CSS .'allaccessible-style.css',array(),AACB\_VERSION); |
  | 175 | 175 | wp\_register\_script('allaccessible-custom', AACB\_JS .'allaccessible-custom.js',array(),AACB\_VERSION); |
  |  | 176 | $nonce = wp\_create\_nonce('allaccessible\_save\_settings'); |
  | 176 | 177 | $ajax\_data = array( |
  | 177 |  | 'ajax\_url' => admin\_url('admin-ajax.php') |
  |  | 178 | 'ajax\_url' => admin\_url('admin-ajax.php'), |
  |  | 179 | 'nonce' => $nonce |
  | 178 | 180 | ); |
  | 179 | 181 | wp\_localize\_script('allaccessible-custom', 'ajax\_object', $ajax\_data); |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L188) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L190) |  |
  | 188 | 190 | } |
  | 189 | 191 | add\_action('wp\_ajax\_aacb\_dismiss\_notice', 'aacb\_dismiss\_notice'); |
  |  | 192 |  |
  |  | 193 | /\*\* |
  |  | 194 | \* AllAccessible Setting Saver |
  |  | 195 | \* Securely saves plugin settings with proper authorization and validation |
  |  | 196 | \* |
  |  | 197 | \* @since 1.3.5 |
  |  | 198 | \*/ |
  |  | 199 | function AllAccessible\_save\_settings() { |
  |  | 200 | // Verify user has admin capabilities |
  |  | 201 | if (!current\_user\_can('install\_plugins')) { |
  |  | 202 | wp\_send\_json\_error('Unauthorized access'); |
  |  | 203 | return; |
  |  | 204 | } |
  |  | 205 |  |
  |  | 206 | // Verify nonce |
  |  | 207 | $nonce = isset($\_POST['nonce']) ? sanitize\_text\_field($\_POST['nonce']) : ''; |
  |  | 208 | if (empty($nonce) || !wp\_verify\_nonce($nonce, 'allaccessible\_save\_settings')) { |
  |  | 209 | wp\_send\_json\_error('Invalid security token'); |
  |  | 210 | return; |
  |  | 211 | } |
  |  | 212 |  |
  |  | 213 | // Get and sanitize input |
  |  | 214 | $opt\_name = isset($\_POST['opt\_name']) ? sanitize\_text\_field($\_POST['opt\_name']) : ''; |
  |  | 215 | $opt\_value = isset($\_POST['opt\_value']) ? sanitize\_text\_field($\_POST['opt\_value']) : ''; |
  |  | 216 |  |
  |  | 217 | // List of allowed options |
  |  | 218 | $allowed\_options = array( |
  |  | 219 | 'aacb\_accountID', |
  |  | 220 | 'aacb\_siteID', |
  |  | 221 | 'aacb\_options', |
  |  | 222 | 'aacb\_installed' |
  |  | 223 | ); |
  |  | 224 |  |
  |  | 225 | // Validate option name |
  |  | 226 | if (!in\_array($opt\_name, $allowed\_options)) { |
  |  | 227 | wp\_send\_json\_error('Invalid option name'); |
  |  | 228 | return; |
  |  | 229 | } |
  |  | 230 |  |
  |  | 231 | // Update option |
  |  | 232 | $result = update\_option($opt\_name, $opt\_value); |
  |  | 233 |  |
  |  | 234 | if ($result) { |
  |  | 235 | wp\_send\_json\_success(array( |
  |  | 236 | 'message' => 'Option updated successfully', |
  |  | 237 | 'option' => $opt\_name |
  |  | 238 | )); |
  |  | 239 | } else { |
  |  | 240 | wp\_send\_json\_error(array( |
  |  | 241 | 'message' => 'Failed to update option', |
  |  | 242 | 'option' => $opt\_name |
  |  | 243 | )); |
  |  | 244 | } |
  |  | 245 | } |
  |  | 246 | add\_action('wp\_ajax\_AllAccessible\_save\_settings', 'AllAccessible\_save\_settings'); |
  | 190 | 247 |  |
  | 191 | 248 | // =================================================== |
  | […](/browser/allaccessible/trunk/allaccessible.php?rev=3101358#L245) | […](/browser/allaccessible/trunk/allaccessible.php?rev=3202017#L302) |  |
  | 245 | 302 |  |
  | 246 | 303 | /\*\* |
  | 247 |  | ~~\* AllAccessible Setting Saver~~ |
  | 248 |  | ~~\*/~~ |
  | 249 |  | ~~function AllAccessible\_save\_settings() {~~ |
  | 250 |  |  |
  | 251 |  | ~~$opt\_name = isset($\_POST['opt\_name']) ? sanitize\_text\_field($\_POST['opt\_name']) : null;~~ |
  | 252 |  | ~~$opt\_value = isset($\_POST['opt\_value']) ? sanitize\_text\_field($\_POST['opt\_value']) : null;~~ |
  | 253 |  | ~~$update = update\_option($opt\_name, $opt\_value);~~ |
  | 254 |  |  |
  | 255 |  | ~~}~~ |
  | 256 |  | ~~add\_action('wp\_ajax\_AllAccessible\_save\_settings','AllAccessible\_save\_settings');~~ |
  | 257 |  |  |
  | 258 |  | ~~/\*\*~~ |
  | 259 | 304 | \* AllAccessible Deactivation |
  | 260 | 305 | \*/ |
* ## [allaccessible/trunk/assets/allaccessible-custom.js](/changeset/3202017/allaccessible/trunk/assets/allaccessible-custom.js "Show the changeset 3202017 restricted to allaccessible/trunk/assets/allaccessible-custom.js")

  | [r2911378](/browser/allaccessible/trunk/assets/allaccessible-custom.js?rev=2911378#L1 "Show revision 2911378 of this file in browser") | [r3202017](/browser/allaccessible/trunk/assets/allaccessible-custom.js?rev=3202017#L1 "Show revision 3202017 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | jQuery(document).ready(function ($) { |
  | 2 |  |  |
  | 3 |  | $('#AACB\_optionsForm').on('submit', function(event){ |
  | 4 |  |  |
  |  | 2 | // Options Form Handler |
  |  | 3 | $('#AACB\_optionsForm').on('submit', function(event) { |
  | 5 | 4 | event.preventDefault(); |
  | 6 | 5 |  |
  | 7 |  | $('#aacb-save-opt-btn').prop('disabled', true); |
  | 8 |  | var $this = $(this); |
  | 9 |  | // $this.after('<span class="aacb\_loader"></span>'); |
  | 10 |  | $('.aacb\_message').after('<span class="aacb\_loader"></span>'); |
  |  | 6 | var $btn = $('#aacb-save-opt-btn').prop('disabled', true); |
  |  | 7 | var $loader = $('<span class="aacb\_loader"></span>').insertAfter('.aacb\_message'); |
  | 11 | 8 | var id = $('#siteDetails').attr('data-siteid'); |
  |  | 9 |  |
  |  | 10 | var formData = new FormData($(this)[0]); |
  | 12 | 11 | var obj = {}; |
  | 13 |  | ~~var formData = new FormData($('#AACB\_optionsForm')[0]);~~ |
  | 14 | 12 | for (var key of formData.keys()) { |
  | 15 |  | if (key === 'isWhiteLabel') { |
  | 16 |  | obj[key] = (formData.get(key) === 'true'); |
  | 17 |  | } else { |
  | 18 |  | obj[key] = formData.get(key); |
  | 19 |  | } |
  |  | 13 | obj[key] = key === 'isWhiteLabel' ? |
  |  | 14 | (formData.get(key) === 'true') : |
  |  | 15 | formData.get(key); |
  | 20 | 16 | } |
  | 21 |  | ~~var xhr = new XMLHttpRequest();~~ |
  | 22 |  | ~~xhr.open("POST", 'https://app.allaccessible.org/api/save-site-options/'+id);~~ |
  | 23 |  |  |
  | 24 |  | ~~xhr.setRequestHeader("Accept", "application/json");~~ |
  | 25 |  | ~~xhr.setRequestHeader("Content-Type", "application/json");~~ |
  | 26 |  |  |
  | 27 |  | ~~xhr.onreadystatechange = function () {~~ |
  | 28 |  | ~~if (xhr.readyState === 4) {~~ |
  | 29 |  | ~~$('.aacb\_loader').hide();~~ |
  | 30 |  | ~~// $this.after('<span class="aacb\_success"> Saved<div alt="f147" class="dashicons dashicons-yes"></div></a>');~~ |
  | 31 |  | ~~$('.aacb\_message').after('<span class="aacb\_success"> Saved<div alt="f147" class="dashicons dashicons-yes"></div></a>');~~ |
  | 32 |  | ~~$('.aacb\_success').delay(3000).fadeOut(300);~~ |
  | 33 |  | ~~$('#aacb-save-opt-btn').prop('disabled', false);~~ |
  | 34 |  | ~~} else {~~ |
  | 35 |  | ~~$('.aacb\_loader').hide();~~ |
  | 36 |  | ~~$('#aacb-save-opt-btn').prop('disabled', false);~~ |
  | 37 |  | ~~}};~~ |
  | 38 |  | ~~xhr.send(JSON.stringify(obj));~~ |
  | 39 |  |  |
  | 40 |  | ~~});~~ |
  | 41 |  |  |
  | 42 |  | ~~/\* update option meta \*/~~ |
  | 43 |  | ~~$('#AACB\_accountForm').on('submit', function() {~~ |
  | 44 |  |  |
  | 45 |  | ~~var accountID = $( "#aacb\_accountID" ).val();~~ |
  | 46 | 17 |  |
  | 47 | 18 | $.ajax({ |
  | 48 |  | url      : ajaxurl, |
  | 49 |  | type     : 'POST', |
  | 50 |  | dataType : 'json', |
  | 51 |  | data : { |
  | 52 |  | action:'AllAccessible\_save\_settings', |
  | 53 |  | opt\_name: 'aacb\_accountID', |
  | 54 |  | opt\_value: accountID |
  |  | 19 | type: "POST", |
  |  | 20 | url: 'https://app.allaccessible.org/api/save-site-options/' + id, |
  |  | 21 | data: JSON.stringify(obj), |
  |  | 22 | contentType: "application/json", |
  |  | 23 | success: function() { |
  |  | 24 | var $success = $('<span class="aacb\_success"> Saved<div alt="f147" class="dashicons dashicons-yes"></div></span>') |
  |  | 25 | .insertAfter('.aacb\_message') |
  |  | 26 | .delay(3000) |
  |  | 27 | .fadeOut(300); |
  | 55 | 28 | }, |
  | 56 |  | ~~beforeSend: function (xhr~~) { |
  | 57 |  |  |
  |  | 29 | error: function() { |
  |  | 30 | alert('Failed to save options. Please try again.'); |
  | 58 | 31 | }, |
  | 59 |  | success: function (data, textStatus, jqXHR) { |
  | 60 |  |  |
  | 61 |  | location.reload(); |
  | 62 |  |  |
  | 63 |  | if (data.status === 'OK') { |
  | 64 |  | $('.error').html(data.message); |
  | 65 |  |  |
  | 66 |  | } else if (data.status === 'KO') { |
  | 67 |  | $('.error').html(data.v\_error); |
  | 68 |  | } |
  | 69 |  | }, |
  | 70 |  | error: function (jqXHR, textStatus, errorThrown) { |
  | 71 |  | console.log('Something went wrong!'); |
  |  | 32 | complete: function() { |
  |  | 33 | $loader.hide(); |
  |  | 34 | $btn.prop('disabled', false); |
  | 72 | 35 | } |
  | 73 | 36 | }); |
  | 74 | 37 | }); |
  | 75 | 38 |  |
  | 76 |  | // process the form |
  | 77 |  | $('#AACB\_trialForm').on('submit', function(event) { |
  |  | 39 | // Account Form Handler |
  |  | 40 | $('#AACB\_accountForm').on('submit', function(event) { |
  |  | 41 | event.preventDefault(); |
  | 78 | 42 |  |
  | 79 |  | $('#aacb-trial-btn').prop('disabled', true); |
  |  | 43 | var accountID = $("#aacb\_accountID").val(); |
  |  | 44 | if (!accountID) { |
  |  | 45 | alert('Please enter an account ID'); |
  |  | 46 | return; |
  |  | 47 | } |
  | 80 | 48 |  |
  | 81 |  | ~~// process the form~~ |
  | 82 | 49 | $.ajax({ |
  | 83 |  | type        : 'POST', // define the type of HTTP verb we want to use (POST for our form) |
  | 84 |  | url         : 'https://app.allaccessible.org/api/add-site', // the url where we want to POST |
  | 85 |  | data : JSON.stringify({ |
  | 86 |  | email: $( "#aacb\_email" ).val(), |
  | 87 |  | url: $( "#aacb\_url" ).val(), |
  | 88 |  | source: 'wordpress' |
  | 89 |  | }), |
  | 90 |  | dataType    : 'text', |
  | 91 |  | encode          : true, |
  | 92 |  | contentType: 'application/json; charset=utf-8', |
  | 93 |  | success: function(data){ |
  | 94 |  | if(data.error){ |
  | 95 |  | //show error message here |
  | 96 |  | data.errors |
  | 97 |  | $('#aacb-trial-btn').prop('disabled', false); |
  | 98 |  | }else{ |
  | 99 |  | //handle success part |
  | 100 |  | data.message |
  | 101 |  |  |
  | 102 |  | $.ajax({ |
  | 103 |  | url: ajaxurl, |
  | 104 |  | type: 'POST', |
  | 105 |  | dataType: 'json', |
  | 106 |  | data: { |
  | 107 |  | action: 'AllAccessible\_save\_settings', |
  | 108 |  | opt\_name: 'aacb\_accountID', |
  | 109 |  | opt\_value: data |
  | 110 |  | }, |
  | 111 |  | success: function (data, textStatus, jqXHR) { |
  | 112 |  |  |
  | 113 |  | location.reload(); |
  | 114 |  |  |
  | 115 |  | } |
  | 116 |  | }); |
  | 117 |  |  |
  |  | 50 | url: ajax\_object.ajax\_url, |
  |  | 51 | type: 'POST', |
  |  | 52 | dataType: 'json', |
  |  | 53 | data: { |
  |  | 54 | action: 'AllAccessible\_save\_settings', |
  |  | 55 | nonce: ajax\_object.nonce, |
  |  | 56 | opt\_name: 'aacb\_accountID', |
  |  | 57 | opt\_value: accountID |
  |  | 58 | }, |
  |  | 59 | success: function(response) { |
  |  | 60 | if (response.success) { |
  |  | 61 | location.reload(); |
  |  | 62 | } else { |
  |  | 63 | alert(response.data.message || 'Failed to save settings'); |
  | 118 | 64 | } |
  | 119 | 65 | }, |
  | 120 |  | error: function(jqXHR, textStatus, errorThrown){ |
  | 121 |  | //request error |
  | 122 |  | $('#aacb-trial-btn').prop('disabled', false); |
  | 123 |  | console.log('jqXHR:'); |
  | 124 |  | console.log(jqXHR); |
  | 125 |  | console.log('textStatus:'); |
  | 126 |  | console.log(textStatus); |
  | 127 |  | console.log('errorThrown:'); |
  | 128 |  | console.log(errorThrown); |
  |  | 66 | error: function() { |
  |  | 67 | alert('Failed to save settings. Please try again.'); |
  | 129 | 68 | } |
  | 130 |  | ~~});~~ |
  | 131 |  |  |
  | 132 |  | ~~// stop the form from submitting the normal way and refreshing the page~~ |
  | 133 |  | ~~event.preventDefault();~~ |
  | 134 |  | ~~});~~ |
  | 135 |  |  |
  | 136 |  | ~~$(document).on('click', '#aacb-premium-notice .notice-dismiss', function() {~~ |
  | 137 |  |  |
  | 138 |  | ~~//console.log('dismiss clicked');~~ |
  | 139 |  |  |
  | 140 |  | ~~var data = {~~ |
  | 141 |  | ~~'action': 'aacb\_dismiss\_notice'~~ |
  | 142 |  | ~~};~~ |
  | 143 |  |  |
  | 144 |  | ~~$.post(ajax\_object.ajax\_url, data, function (response) {~~ |
  | 145 |  | ~~//console.log('Notice dismissed: ' + response);~~ |
  | 146 | 69 | }); |
  | 147 | 70 | }); |
  | 148 | 71 |  |
  |  | 72 | // Trial Form Handler |
  |  | 73 | $('#AACB\_trialForm').on('submit', function(event) { |
  |  | 74 | event.preventDefault(); |
  |  | 75 |  |
  |  | 76 | var $btn = $('#aacb-trial-btn').prop('disabled', true); |
  |  | 77 | var email = $("#aacb\_email").val(); |
  |  | 78 | var url = $("#aacb\_url").val(); |
  |  | 79 |  |
  |  | 80 | if (!email || !url) { |
  |  | 81 | alert('Please fill in all required fields'); |
  |  | 82 | $btn.prop('disabled', false); |
  |  | 83 | return; |
  |  | 84 | } |
  |  | 85 |  |
  |  | 86 | $.ajax({ |
  |  | 87 | type: 'POST', |
  |  | 88 | url: 'https://app.allaccessible.org/api/add-site', |
  |  | 89 | data: JSON.stringify({ |
  |  | 90 | email: email, |
  |  | 91 | url: url, |
  |  | 92 | source: 'wordpress' |
  |  | 93 | }), |
  |  | 94 | contentType: 'application/json; charset=utf-8', |
  |  | 95 | success: function(data) { |
  |  | 96 | if (data.error) { |
  |  | 97 | alert('Error: ' + (data.errors || 'Failed to create trial')); |
  |  | 98 | $btn.prop('disabled', false); |
  |  | 99 | return; |
  |  | 100 | } |
  |  | 101 |  |
  |  | 102 | $.ajax({ |
  |  | 103 | url: ajax\_object.ajax\_url, |
  |  | 104 | type: 'POST', |
  |  | 105 | dataType: 'json', |
  |  | 106 | data: { |
  |  | 107 | action: 'AllAccessible\_save\_settings', |
  |  | 108 | nonce: ajax\_object.nonce, |
  |  | 109 | opt\_name: 'aacb\_accountID', |
  |  | 110 | opt\_value: data |
  |  | 111 | }, |
  |  | 112 | success: function(response) { |
  |  | 113 | if (response.success) { |
  |  | 114 | location.reload(); |
  |  | 115 | } else { |
  |  | 116 | alert(response.data.message || 'Failed to save settings'); |
  |  | 117 | $btn.prop('disabled', false); |
  |  | 118 | } |
  |  | 119 | }, |
  |  | 120 | error: function() { |
  |  | 121 | alert('Failed to save settings. Please try again.'); |
  |  | 122 | $btn.prop('disabled', false); |
  |  | 123 | } |
  |  | 124 | }); |
  |  | 125 | }, |
  |  | 126 | error: function() { |
  |  | 127 | alert('Failed to create trial. Please try again.'); |
  |  | 128 | $btn.prop('disabled', false); |
  |  | 129 | } |
  |  | 130 | }); |
  |  | 131 | }); |
  |  | 132 |  |
  |  | 133 | // Notice Dismiss Handler |
  |  | 134 | $(document).on('click', '#aacb-premium-notice .notice-dismiss', function() { |
  |  | 135 | $.post(ajax\_object.ajax\_url, { 'action': 'aacb\_dismiss\_notice' }); |
  |  | 136 | }); |
  | 149 | 137 | }); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3202017)
* [Zip Archive](?format=zip&new=3202017)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_a4207b79_20250114_192704.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fallaccessible%2Ftrunk%2Fallaccessible.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/allaccessible/trunk/allaccessible.php?rev=3202024 "Revision 3202024")
* Next Revision →
* [Blame](/browser/allaccessible/trunk/allaccessible.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/allaccessible/trunk/allaccessible.php)

---

# [source:](/browser?order=name "Go to repository root") [allaccessible](/browser/allaccessible?order=name "View allaccessible")/[trunk](/browser/allaccessible/trunk?order=name "View trunk")/[allaccessible.php](/browser/allaccessible/trunk/allaccessible.php?order=name "View allaccessible.php")

View diff against:

View revision:

| [Last change](/changeset/3202025/allaccessible/trunk/allaccessible.php "View differences") on this file was [3202025](/changeset/3202025/ "View changeset 3202025"), checked in by allaccessible, [6 weeks ago](/timeline?from=2024-12-04T01%3A47%3A59Z&precision=second "See timeline at 12/04/2024 01:47:59 AM") |
| --- |
| hotfix |
| * Property **svn:eol-style** set to   *`native`* * Property **svn:executable** set to   *`*`* | |
| **File size:** 14.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | Plugin Name: AllAccessible |
| [4](#L4) | Plugin URI: https://www.allaccessible.org/platform/wordpress/ |
| [5](#L5) | Description: Unlock true digital accessibility with AllAccessible - a comprehensive WordPress plugin driving your website towards WCAG/ADA compliance. Empower your users with a fully customizable accessibility widget, and enhance their experience with our premium AI-powered features. |
| [6](#L6) | Version: 1.3.6 |
| [7](#L7) | Requires PHP: 7 |
| [8](#L8) | Author: AllAccessible Team |
| [9](#L9) | Author URI: https://www.allaccessible.org/ |
| [10](#L10) | Text Domain: allaccessible |
| [11](#L11) | Domain Path: /languages |
| [12](#L12) | \*/ |
| [13](#L13) |  |
| [14](#L14) | /\*\* |
| [15](#L15) | \* Copyright (C) 2024 AllAccessible. |
| [16](#L16) | \* |
| [17](#L17) | \* This program is free software: you can redistribute it and/or modify |
| [18](#L18) | \* it under the terms of the GNU General Public License as published by |
| [19](#L19) | \* the Free Software Foundation, either version 3 of the License, or |
| [20](#L20) | \* (at your option) any later version. |
| [21](#L21) | \* |
| [22](#L22) | \* This program is distributed in the hope that it will be useful, |
| [23](#L23) | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [24](#L24) | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [25](#L25) | \* GNU General Public License for more details. |
| [26](#L26) | \* |
| [27](#L27) | \* You should have received a copy of the GNU General Public License |
| [28](#L28) | \* along with this program.  If not, see <http://www.gnu.org/licenses/>. |
| [29](#L29) | \*/ |
| [30](#L30) |  |
| [31](#L31) | /\*\* |
| [32](#L32) | \* @package     AllAccessible |
| [33](#L33) | \* @version     1.3.6 |
| [34](#L34) | \* @since       1.0 |
| [35](#L35) | \* @author      AllAccessible Team |
| [36](#L36) | \* @copyright   Copyright (c) 2024 AllAccessible |
| [37](#L37) | \* @link        https://www.allaccessible.org/ |
| [38](#L38) | \* @license     http://www.gnu.org/licenses/gpl.html |
| [39](#L39) | \*/ |
| [40](#L40) |  |
| [41](#L41) | if(!defined('ABSPATH')) { |
| [42](#L42) | die('You are not allowed to call this page directly.'); |
| [43](#L43) | } |
| [44](#L44) | // ============================================= |
| [45](#L45) | // Define Global Constants |
| [46](#L46) | // ============================================= |
| [47](#L47) | aacb\_define\_constants(); |
| [48](#L48) | function aacb\_define\_constants() { |
| [49](#L49) | //    $aacb\_siteOptions = aacb\_siteOptions(); |
| [50](#L50) | define('AACB\_NAME', isset($aacb\_siteOptions->isWhitelabel) && $aacb\_siteOptions->isWhitelabel ? \_e( "Accessibility", 'allaccessible' ) : 'AllAccessible'); |
| [51](#L51) | define('AACB\_VERSION','1.3.6'); |
| [52](#L52) | define('AACB\_WP\_MIN\_VERSION','5.0'); |
| [53](#L53) | define('AACB\_TEXT','allaccessible'); |
| [54](#L54) | define('AACB\_DIR', dirname( plugin\_basename( \_\_FILE\_\_ ) ) ); |
| [55](#L55) | define('AACB\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) ); |
| [56](#L56) | define('AACB\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
| [57](#L57) | define('AACB\_JS', AACB\_URL . trailingslashit('assets') ); |
| [58](#L58) | define('AACB\_CSS', AACB\_URL . trailingslashit('assets') ); |
| [59](#L59) | define('AACB\_IMG', AACB\_URL . trailingslashit('assets') ); |
| [60](#L60) | define('AACB\_INC', AACB\_PATH . trailingslashit('inc') ); |
| [61](#L61) | define('AACB\_SUPPORT','https://support.allaccessible.org/'); |
| [62](#L62) | } |
| [63](#L63) | function aacb\_load\_textdomain() { |
| [64](#L64) | load\_plugin\_textdomain( 'allaccessible', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [65](#L65) | } |
| [66](#L66) | add\_action( 'init', 'aacb\_load\_textdomain' ); |
| [67](#L67) |  |
| [68](#L68) | /\*\* |
| [69](#L69) | \*  Load AllAccessible options |
| [70](#L70) | \*/ |
| [71](#L71) | function AllAccessible\_getSiteOptions() { |
| [72](#L72) | $apiUrl      ='https://app.allaccessible.org/api/get-site-options/'; |
| [73](#L73) | $apiResponse = wp\_remote\_post( $apiUrl, |
| [74](#L74) | [ |
| [75](#L75) | 'method'   =>'POST', |
| [76](#L76) | 'sslverify'=> false, |
| [77](#L77) | 'headers'  => [ |
| [78](#L78) | 'content-type'=>'application/json', |
| [79](#L79) | ], |
| [80](#L80) | 'body'       => json\_encode(array('siteId'=> get\_option('aacb\_siteID'))) |
| [81](#L81) | ] |
| [82](#L82) | ); |
| [83](#L83) |  |
| [84](#L84) | return json\_decode( wp\_remote\_retrieve\_body( $apiResponse ) ); |
| [85](#L85) |  |
| [86](#L86) | } |
| [87](#L87) |  |
| [88](#L88) | /\*\* |
| [89](#L89) | \*  Load AllAccessible Settings Page |
| [90](#L90) | \*/ |
| [91](#L91) | function AllAccessible\_settings() { |
| [92](#L92) | // Removes all admin notices for this page |
| [93](#L93) | remove\_all\_actions( 'admin\_notices' ); |
| [94](#L94) | //TODO - improve |
| [95](#L95) | $GLOBALS['aacb\_accountID'] = get\_option('aacb\_accountID'); |
| [96](#L96) |  |
| [97](#L97) | if(!get\_option('aacb\_siteID') && get\_option('aacb\_accountID')){ |
| [98](#L98) | $apiUrl      ='https://app.allaccessible.org/api/get-site-id/'; |
| [99](#L99) | $apiResponse = wp\_remote\_post( $apiUrl, |
| [100](#L100) | [ |
| [101](#L101) | 'method'   =>'POST', |
| [102](#L102) | 'sslverify'=> false, |
| [103](#L103) | 'headers'  => [ |
| [104](#L104) | 'content-type'=>'application/json', |
| [105](#L105) | ], |
| [106](#L106) | 'body'       => json\_encode(array('pageUrl'=> get\_bloginfo('wpurl'),'accountID'=> get\_option('aacb\_accountID'))) |
| [107](#L107) | ] |
| [108](#L108) | ); |
| [109](#L109) | $apiBody     = json\_decode( wp\_remote\_retrieve\_body( $apiResponse ) ); |
| [110](#L110) |  |
| [111](#L111) | update\_option('aacb\_siteID', $apiBody ); |
| [112](#L112) | } |
| [113](#L113) |  |
| [114](#L114) | $GLOBALS['aacb\_accountID'] = get\_option('aacb\_siteID'); |
| [115](#L115) |  |
| [116](#L116) | if(get\_option('aacb\_siteID')){ |
| [117](#L117) | $GLOBALS['aacb\_siteOptions'] = AllAccessible\_getSiteOptions(); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | include AACB\_INC .'AllAccessibleSettings.php'; |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | //========================= |
| [124](#L124) | // Add Script to Header |
| [125](#L125) | //========================= |
| [126](#L126) |  |
| [127](#L127) | function AllAccessible\_loadWidget() { |
| [128](#L128) | if (!is\_admin() && empty($\_GET['et\_fb'])) { |
| [129](#L129) | $account\_id = get\_option('aacb\_accountID') ? esc\_attr(get\_option('aacb\_accountID')) : 'wp\_vFtGhKjLm'; |
| [130](#L130) | $script\_src = "https://app.allaccessible.org/api/{$account\_id}.js"; |
| [131](#L131) | $aacbPreview = false; |
| [132](#L132) | if(isset($\_GET['aacb\_preview']) && $\_GET['aacb\_preview']){ |
| [133](#L133) | $aacbPreview = true; |
| [134](#L134) | } |
| [135](#L135) | ?> |
| [136](#L136) | <script data-accessible-account-id="<?php echo $account\_id; ?>" id="allAccessibleWidget" src="<?php echo $script\_src; ?>" defer></script> |
| [137](#L137) | <?php if($aacbPreview) { ?> |
| [138](#L138) | <script> |
| [139](#L139) | function previewAllAccessible() { |
| [140](#L140) | window.addEventListener('load', (event) => { |
| [141](#L141) | var aacbButton = document.getElementById('accessibility-trigger-button'); |
| [142](#L142) | if (aacbButton) { |
| [143](#L143) | aacbButton.click(); |
| [144](#L144) | } |
| [145](#L145) | }); |
| [146](#L146) | } |
| [147](#L147) | </script> |
| [148](#L148) | <?php } |
| [149](#L149) | } |
| [150](#L150) | } |
| [151](#L151) |  |
| [152](#L152) | add\_action('wp\_head', 'AllAccessible\_loadWidget'); |
| [153](#L153) |  |
| [154](#L154) | register\_activation\_hook( \_\_FILE\_\_ ,'AllAccessible\_Activation'); |
| [155](#L155) | register\_deactivation\_hook( \_\_FILE\_\_ ,'AllAccessible\_Deactivation'); |
| [156](#L156) |  |
| [157](#L157) |  |
| [158](#L158) | // ============================================= |
| [159](#L159) | // Load JS and CSS |
| [160](#L160) | // ============================================= |
| [161](#L161) |  |
| [162](#L162) | /\*\* |
| [163](#L163) | \* Add admin scripts |
| [164](#L164) | \*/ |
| [165](#L165) | function AllAccessible\_LoadScript($hook){ |
| [166](#L166) | // Check if we're on the AllAccessible page |
| [167](#L167) | if ('toplevel\_page\_allaccessible'== $hook ) { |
| [168](#L168) | wp\_enqueue\_style('allaccessible-spectrum-style', AACB\_CSS .'spectrum.min.css',array(),AACB\_VERSION); |
| [169](#L169) | wp\_enqueue\_script('allaccessible-spectrum', AACB\_CSS .'spectrum.js',array(),AACB\_VERSION); |
| [170](#L170) | wp\_enqueue\_style('allaccessible-select2', AACB\_CSS .'select2.min.css',array(),AACB\_VERSION); |
| [171](#L171) | wp\_enqueue\_script('allaccessible-select2-script', AACB\_CSS .'select2.min.js',array(),AACB\_VERSION); |
| [172](#L172) | } |
| [173](#L173) |  |
| [174](#L174) | wp\_enqueue\_style('allaccessible-admin-style', AACB\_CSS .'allaccessible-style.css',array(),AACB\_VERSION); |
| [175](#L175) | wp\_register\_script('allaccessible-custom', AACB\_JS .'allaccessible-custom.js',array(),AACB\_VERSION); |
| [176](#L176) | $nonce = wp\_create\_nonce('allaccessible\_save\_settings'); |
| [177](#L177) | $ajax\_data = array( |
| [178](#L178) | 'ajax\_url' => admin\_url('admin-ajax.php'), |
| [179](#L179) | 'nonce' => $nonce |
| [180](#L180) | ); |
| [181](#L181) | wp\_localize\_script('allaccessible-custom', 'ajax\_object', $ajax\_data); |
| [182](#L182) | wp\_enqueue\_script('allaccessible-custom'); |
| [183](#L183) | } |
| [184](#L184) | add\_action('admin\_enqueue\_scripts','AllAccessible\_LoadScript'); |
| [185](#L185) |  |
| [186](#L186) | function aacb\_dismiss\_notice() { |
| [187](#L187) | update\_option('aacb\_hide\_premium\_notice', true); |
| [188](#L188) | echo 'success'; |
| [189](#L189) | wp\_die(); |
| [190](#L190) | } |
| [191](#L191) | add\_action('wp\_ajax\_aacb\_dismiss\_notice', 'aacb\_dismiss\_notice'); |
| [192](#L192) |  |
| [193](#L193) | /\*\* |
| [194](#L194) | \* AllAccessible Setting Saver |
| [195](#L195) | \* Securely saves plugin settings with proper authorization and validation |
| [196](#L196) | \* |
| [197](#L197) | \* @since 1.3.5 |
| [198](#L198) | \*/ |
| [199](#L199) | function AllAccessible\_save\_settings() { |
| [200](#L200) | // Verify user has admin capabilities |
| [201](#L201) | if (!current\_user\_can('install\_plugins')) { |
| [202](#L202) | wp\_send\_json\_error('Unauthorized access'); |
| [203](#L203) | return; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | // Verify nonce |
| [207](#L207) | $nonce = isset($\_POST['nonce']) ? sanitize\_text\_field($\_POST['nonce']) : ''; |
| [208](#L208) | if (empty($nonce) || !wp\_verify\_nonce($nonce, 'allaccessible\_save\_settings')) { |
| [209](#L209) | wp\_send\_json\_error('Invalid security token'); |
| [210](#L210) | return; |
| [211](#L211) | } |
| [212](#L212) |  |
| [213](#L213) | // Get and sanitize input |
| [214](#L214) | $opt\_name = isset($\_POST['opt\_name']) ? sanitize\_text\_field($\_POST['opt\_name']) : ''; |
| [215](#L215) | $opt\_value = isset($\_POST['opt\_value']) ? sanitize\_text\_field($\_POST['opt\_value']) : ''; |
| [216](#L216) |  |
| [217](#L217) | // List of allowed options |
| [218](#L218) | $allowed\_options = array( |
| [219](#L219) | 'aacb\_accountID', |
| [220](#L220) | 'aacb\_siteID', |
| [221](#L221) | 'aacb\_options', |
| [222](#L222) | 'aacb\_installed' |
| [223](#L223) | ); |
| [224](#L224) |  |
| [225](#L225) | // Validate option name |
| [226](#L226) | if (!in\_array($opt\_name, $allowed\_options)) { |
| [227](#L227) | wp\_send\_json\_error('Invalid option name'); |
| [228](#L228) | return; |
| [229](#L229) | } |
| [230](#L230) |  |
| [231](#L231) | // Update option |
| [232](#L232) | $result = update\_option($opt\_name, $opt\_value); |
| [233](#L233) |  |
| [234](#L234) | if ($result) { |
| [235](#L235) | wp\_send\_json\_success(array( |
| [236](#L236) | 'message' => 'Option updated successfully', |
| [237](#L237) | 'option' => $opt\_name |
| [238](#L238) | )); |
| [239](#L239) | } else { |
| [240](#L240) | wp\_send\_json\_error(array( |
| [241](#L241) | 'message' => 'Failed to update option', |
| [242](#L242) | 'option' => $opt\_name |
| [243](#L243) | )); |
| [244](#L244) | } |
| [245](#L245) | } |
| [246](#L246) | add\_action('wp\_ajax\_AllAccessible\_save\_settings', 'AllAccessible\_save\_settings'); |
| [247](#L247) |  |
| [248](#L248) | // =================================================== |
| [249](#L249) | // Setup Core AllAccessible Admin Options and Settings |
| [250](#L250) | // =================================================== |
| [251](#L251) |  |
| [252](#L252) | /\*\* |
| [253](#L253) | \*  Admin dashboard menu bar |
| [254](#L254) | \*/ |
| [255](#L255) | add\_action('admin\_menu','AllAccessible\_integration'); |
| [256](#L256) |  |
| [257](#L257) | function AllAccessible\_integration() { |
| [258](#L258) | add\_menu\_page( |
| [259](#L259) | AACB\_NAME, |
| [260](#L260) | AACB\_NAME, |
| [261](#L261) | 'manage\_options', |
| [262](#L262) | 'allaccessible', |
| [263](#L263) | 'allaccessible\_settings', |
| [264](#L264) | 'data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzE3LjkgMzE3Ljg5Ij48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhci1ncmFkaWVudCIgeDE9IjE4My4yOSIgeTE9IjIxOC4yMiIgeDI9IjE4My4yOSIgeTI9IjQxLjI0IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjMGY4Y2ZhIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNTRiOGZmIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhci1ncmFkaWVudC0yIiB4MT0iMTU4Ljk0IiB5MT0iMzA5LjQ3IiB4Mj0iMTU4Ljk2IiB5Mj0iMjMuMDgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiMwOTU3YjAiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMyMTc5ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cGF0aCBkPSJNMjU2LjYyLDU3Ljg4bC05Ny45LDk3LjlMMTEwLDEwN2MtMTcuOTMtMTcuOTMtNDUsOS4xOC0yNy4xMSwyNy4xMWw2Mi4yLDYyLjJhMTkuMDgsMTkuMDgsMCwwLDAsMTMuMzUsNS41OWguNjdhMTkuMTQsMTkuMTQsMCwwLDAsMTMuMzUtNS41OUwyODMuNzMsODVDMzAxLjY3LDY3LjA2LDI3NC41NSw0MCwyNTYuNjIsNTcuODhaIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7ZmlsbDp1cmwoI2xpbmVhci1ncmFkaWVudCkiLz48cGF0aCBkPSJNMTU5LDYwLjMxYTI3Ljg2LDI3Ljg2LDAsMSwxLTI3Ljg2LDI3Ljg1QTI3Ljg1LDI3Ljg1LDAsMCwxLDE1OSw2MC4zMVpNMTU5LDBhMTU4Ljg4LDE1OC44OCwwLDEsMCwxMzguOSw4MS42MiwzMC40OCwzMC40OCwwLDAsMS03LDEwLjU0TDI3OC4yNiwxMDQuOGExMzEuMTEsMTMxLjExLDAsMCwxLTI1Ljc1LDE0NS44MmwtNDcuMzUtNDcuMzVjLTE3LjkzLTE3LjkzLTQ1LDkuMTgtMjcuMTEsMjcuMTFMMjIxLjY2LDI3NEExMzEuMjEsMTMxLjIxLDAsMCwxLDk2LDI3My44M2w0My42LTQzLjZjMTcuOTQtMTcuOTQtOS4xOS00NS0yNy4xMS0yNy4xMUw2NS4xNiwyNTAuNEExMzEsMTMxLDAsMCwxLDI0Mi4yOSw1Ny44OGw3LjE3LTcuMTZhMjkuMzMsMjkuMzMsMCwwLDEsMTcuMTktOC42N0ExNTguNDEsMTU4LjQxLDAsMCwwLDE1OSwwWiIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO2ZpbGw6dXJsKCNsaW5lYXItZ3JhZGllbnQtMikiLz48L3N2Zz4=', |
| [265](#L265) | 25 |
| [266](#L266) | ); |
| [267](#L267) | } |
| [268](#L268) |  |
| [269](#L269) | /\*\* |
| [270](#L270) | \* AllAccessible Initial Activation |
| [271](#L271) | \*/ |
| [272](#L272) | function AllAccessible\_activation() { |
| [273](#L273) | global $wpdb; |
| [274](#L274) | $options = get\_option('aacb\_options'); |
| [275](#L275) |  |
| [276](#L276) | if ( ( $options['aacb\_installed'] != 1 ) || ( ! is\_array( $options ) ) ) { |
| [277](#L277) | $opt = array( |
| [278](#L278) | 'aacb\_installed'          => 1, |
| [279](#L279) | ); |
| [280](#L280) | update\_option('aacb\_options', $opt ); |
| [281](#L281) | } |
| [282](#L282) |  |
| [283](#L283) | } |
| [284](#L284) |  |
| [285](#L285) | /\*\* |
| [286](#L286) | \* AllAccessible Admin Notices |
| [287](#L287) | \*/ |
| [288](#L288) | function aacb\_activated\_notice() { |
| [289](#L289) | $options = get\_option('aacb\_options'); |
| [290](#L290) | $hide\_notice = get\_option('aacb\_hide\_premium\_notice'); |
| [291](#L291) |  |
| [292](#L292) | if ($options['aacb\_installed'] && !get\_option('aacb\_accountID') && !$hide\_notice) { |
| [293](#L293) | $settings\_url = admin\_url('options-general.php?page=allaccessible'); |
| [294](#L294) | ?> |
| [295](#L295) | <div id="aacb-premium-notice" class="notice notice-success is-dismissible"> |
| [296](#L296) | <p><?php \_e( 'Activate AllAccessible Premium to Unlock Ai Accessibility Features.', 'allaccessible' ); ?> <a href="<?php echo $settings\_url; ?>"><?php \_e( 'Click Here', 'allaccessible' ); ?></a></p> |
| [297](#L297) | </div> |
| [298](#L298) | <?php |
| [299](#L299) | } |
| [300](#L300) | } |
| [301](#L301) | add\_action('admin\_notices', 'aacb\_activated\_notice'); |
| [302](#L302) |  |
| [303](#L303) | /\*\* |
| [304](#L304) | \* AllAccessible Deactivation |
| [305](#L305) | \*/ |
| [306](#L306) | function AllAccessible\_Deactivation() { |
| [307](#L307) | delete\_option( 'aacb\_options' ); |
| [308](#L308) | delete\_option( 'aacb\_installed' ); |
| [309](#L309) | delete\_option( 'aacb\_siteID' ); |
| [310](#L310) | delete\_option( 'aacb\_accountID'); |
| [311](#L311) | delete\_option('aacb\_hide\_premium\_notice'); |
| [312](#L312) | } |
| [313](#L313) | /\*\* |
| [314](#L314) | \* Deactivation Survey for Dev purposes. |
| [315](#L315) | \*/ |
| [316](#L316) | include ( AACB\_INC ."/AllAccessibleDeactivationForm.php" ); |
| [317](#L317) | add\_filter('allaccessible\_deactivate\_feedback\_form\_plugins', function($plugins) { |
| [318](#L318) |  |
| [319](#L319) | $plugins[] = (object)array( |
| [320](#L320) | 'slug'          => AACB\_TEXT, |
| [321](#L321) | 'version'       => AACB\_VERSION, |
| [322](#L322) | 'url' => get\_bloginfo('wpurl') |
| [323](#L323) | ); |
| [324](#L324) |  |
| [325](#L325) | return $plugins; |
| [326](#L326) |  |
| [327](#L327) | }); |
| [328](#L328) |  |
| [329](#L329) | /\*\* |
| [330](#L330) | \* Logs a debug statement to /wp-content/debug.log |
| [331](#L331) | \* |
| [332](#L332) | \* @param   string |
| [333](#L333) | \*/ |
| [334](#L334) | function AllAccessible\_log\_debug( $message ) { |
| [335](#L335) | if ( WP\_DEBUG === true ) { |
| [336](#L336) | if ( is\_array( $message ) || is\_object( $message ) ) { |
| [337](#L337) | error\_log( print\_r( $message, true ) ); |
| [338](#L338) | } else { |
| [339](#L339) | error\_log( esc\_attr($message) ); |
| [340](#L340) | } |
| [341](#L341) | } |
| [342](#L342) | } |
| [343](#L343) |  |
| [344](#L344) | /\*\* |
| [345](#L345) | \* Hide all the unrelated notices from plugin page. |
| [346](#L346) | \* |
| [347](#L347) | \* @since 1.3 |
| [348](#L348) | \* @return void |
| [349](#L349) | \*/ |
| [350](#L350) | function hide\_admin\_notices() { |
| [351](#L351) | // Bail if we're not on a AllAccessible screen. |
| [352](#L352) | if ( empty( $\_REQUEST['page'] ) || ! preg\_match( '/allaccessible/', esc\_html( wp\_unslash( $\_REQUEST['page'] ) ) ) ) { // phpcs:ignore WordPress.Security.NonceVerification,WordPress.Security.ValidatedSanitizedInput.InputNotSanitized |
| [353](#L353) | return; |
| [354](#L354) | } |
| [355](#L355) | global $wp\_filter; |
| [356](#L356) |  |
| [357](#L357) | $notices\_type = array( |
| [358](#L358) | 'user\_admin\_notices', |
| [359](#L359) | 'admin\_notices', |
| [360](#L360) | 'all\_admin\_notices', |
| [361](#L361) | ); |
| [362](#L362) |  |
| [363](#L363) | foreach ( $notices\_type as $type ) { |
| [364](#L364) | if ( empty( $wp\_filter[ $type ]->callbacks ) || ! is\_array( $wp\_filter[ $type ]->callbacks ) ) { |
| [365](#L365) | continue; |
| [366](#L366) | } |
| [367](#L367) |  |
| [368](#L368) | foreach ( $wp\_filter[ $type ]->callbacks as $priority => $hooks ) { |
| [369](#L369) | foreach ( $hooks as $name => $arr ) { |
| [370](#L370) | if ( is\_object( $arr['function'] ) && $arr['function'] instanceof \Closure ) { |
| [371](#L371) | unset( $wp\_filter[ $type ]->callbacks[ $priority ][ $name ] ); |
| [372](#L372) | continue; |
| [373](#L373) | } |
| [374](#L374) | $class = ! empty( $arr['function'][0] ) && is\_object( $arr['function'][0] ) ? strtolower( get\_class( $arr['function'][0] ) ) : ''; |
| [375](#L375) |  |
| [376](#L376) | if ( ! empty( $class ) && preg\_match( '/^(?:aacb)/', $class ) ) { |
| [377](#L377) | continue; |
| [378](#L378) | } |
| [379](#L379) | if ( ! empty( $name ) && ! preg\_match( '/^(?:aacb)/', $name ) ) { |
| [380](#L380) | unset( $wp\_filter[ $type ]->callbacks[ $priority ][ $name ] ); |
| [381](#L381) | } |
| [382](#L382) | } |
| [383](#L383) | } |
| [384](#L384) | } |
| [385](#L385) | } |
| [386](#L386) | // Hide the unrelated admin notices. |
| [387](#L387) | add\_action( 'admin\_print\_scripts', 'hide\_admin\_notices'); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/allaccessible/trunk/allaccessible.php?format=txt)
* [Original Format](/export/3222454/allaccessible/trunk/allaccessible.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_c527d91b_20250114_192707.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Accessibility by AllAccessible <= 1.3.4 - Missing Authorization to Authenticated (Subscriber+) Arbitrary Option Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Accessibility by AllAccessible <= 1.3.4 - Missing Authorization to Authenticated (Subscriber+) Arbitrary Option Update

8.8

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-11643](https://www.cve.org/CVERecord?id=CVE-2024-11643) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | December 3, 2024 |
| Last Updated | December 4, 2024 |
| Researcher | [1337\_Wannabe - home](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/amrawad) |

### Description

The Accessibility by AllAccessible plugin for WordPress is vulnerable to unauthorized modification of data that can lead to privilege escalation due to a missing capability check on the 'AllAccessible\_save\_settings' function in all versions up to, and including, 1.3.4. This makes it possible for authenticated attackers, with Subscriber-level access and above, to update arbitrary options on the WordPress site. This can be leveraged to update the default role for registration to administrator and enable user registration for attackers to gain administrative user access to a vulnerable site.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/allaccessible/trunk/allaccessible.php#L249)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3202017/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fallaccessible%2Faccessibility-by-allaccessible-134-missing-authorization-to-authenticated-subscriber-arbitrary-option-update&t=Accessibility%20by%20AllAccessible%20%3C%3D%201.3.4%20-%20Missing%20Authorization%20to%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20Option%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fallaccessible%2Faccessibility-by-allaccessible-134-missing-authorization-to-authenticated-subscriber-arbitrary-option-update&text=Accessibility%20by%20AllAccessible%20%3C%3D%201.3.4%20-%20Missing%20Authorization%20to%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20Option%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fallaccessible%2Faccessibility-by-allaccessible-134-missing-authorization-to-authenticated-subscriber-arbitrary-option-update "LinkedIn")
Email

## Vulnerability Details for Accessibility by AllAccessible

#### [Accessibility by AllAccessible](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/allaccessible)

| Software Type | Plugin |
| --- | --- |
| Software Slug | allaccessible [(view on wordpress.org)](https://wordpress.org/plugins/allaccessible) |
| Patched? | Yes |
| Remediation | Update to version 1.3.5, or a newer patched version |
| Affected Version | * <= 1.3.4 |
| Patched Version | * 1.3.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


