=== Content from plugins.trac.wordpress.org_a7bbd0cc_20250114_230350.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fadd-infos-to-the-events-calendar%2Ftags%2F1.4.1%2Fadd_shortcode_to_tec.php%3Frev%3D3205090)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Latest Revision](/browser/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php)
* Next Revision →
* [Blame](/browser/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php?annotate=blame&rev=3205090 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php?rev=3205090)

---

# [source:](/browser?rev=3205090&order=name "Go to repository root") [add-infos-to-the-events-calendar](/browser/add-infos-to-the-events-calendar?rev=3205090&order=name "View add-infos-to-the-events-calendar")/[tags](/browser/add-infos-to-the-events-calendar/tags?rev=3205090&order=name "View tags")/[1.4.1](/browser/add-infos-to-the-events-calendar/tags/1.4.1?rev=3205090&order=name "View 1.4.1")/[add\_shortcode\_to\_tec.php](/browser/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php?rev=3205090&order=name "View add_shortcode_to_tec.php") @ [3205090](/changeset/3205090/ "View changeset 3205090")

View diff against:

View revision:

| [Last change](/changeset/2509304/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php "View differences") on this file since 3205090 was [2509304](/changeset/2509304/ "View changeset 2509304"), checked in by hage, [4 years ago](/timeline?from=2021-04-05T09%3A39%3A58Z&precision=second "See timeline at 04/05/2021 09:39:58 AM") |
| --- |
| tagging version 1.4.1 |
| **File size:** 33.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Plugin Name: Add infos to the events calendar |
| [4](#L4) | \* Description: Provides a shortcode block (image copyright, button with link to events with a special category, link to the website of the organizer) in particular to single events for The Events Calendar Free Plugin (by MODERN TRIBE) |
| [5](#L5) | \* Version:     1.4.1 |
| [6](#L6) | \* Author:      Hans-Gerd Gerhards (haurand.com) |
| [7](#L7) | \* Author URI:  https://haurand.com |
| [8](#L8) | \* Plugin URI:  https://haurand.com/add-infos-to-the-events-calendar/ |
| [9](#L9) | \* Text Domain: add-infos-to-the-events-calendar |
| [10](#L10) | \* Domain Path: /languages |
| [11](#L11) | \* License:     GPL2 |
| [12](#L12) |  |
| [13](#L13) | \* This program is free software: you can redistribute it and/or modify |
| [14](#L14) | \* it under the terms of the GNU General Public License as published by |
| [15](#L15) | \* the Free Software Foundation, either version 2 of the License, or |
| [16](#L16) | \* (at your option) any later version. |
| [17](#L17) |  |
| [18](#L18) | \* This program is distributed in the hope that it will be useful, |
| [19](#L19) | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [20](#L20) | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [21](#L21) | \* GNU General Public License for more details. |
| [22](#L22) |  |
| [23](#L23) | \* You should have received a copy of the GNU General Public License |
| [24](#L24) | \* along with this program.  If not, see <http://www.gnu.org/licenses/>. |
| [25](#L25) |  |
| [26](#L26) | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
| [27](#L27) |  |
| [28](#L28) |  |
| [29](#L29) |  |
| [30](#L30) | define("AIT\_VERSION", "1.4.1"); |
| [31](#L31) | define("AIT\_HTTP", "http://"); |
| [32](#L32) | define("AIT\_HTTPS", "https://"); |
| [33](#L33) | define('AIT\_\_PLUGIN\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
| [34](#L34) | global $ait\_add\_options; |
| [35](#L35) |  |
| [36](#L36) | // Securing against unauthorized access // |
| [37](#L37) | if ( ! defined( 'ABSPATH' ) ) { |
| [38](#L38) | exit; |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | // load admin-functions // |
| [42](#L42) | // require\_once(AIT\_\_PLUGIN\_DIR . 'ait\_admin\_functions.php'); |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) | // Load language files |
| [46](#L46) | function ait\_meine\_textdomain\_laden() { |
| [47](#L47) | load\_plugin\_textdomain( |
| [48](#L48) | 'add-infos-to-the-events-calendar', |
| [49](#L49) | false, |
| [50](#L50) | basename( dirname( \_\_FILE\_\_ ) ) . '/languages' |
| [51](#L51) | ); |
| [52](#L52) | } |
| [53](#L53) | add\_action('plugins\_loaded','ait\_meine\_textdomain\_laden'); |
| [54](#L54) |  |
| [55](#L55) |  |
| [56](#L56) |  |
| [57](#L57) |  |
| [58](#L58) | /\*----------------------------------------------------------------\*/ |
| [59](#L59) | // Start: get the color settings from style\_fuss.css |
| [60](#L60) | // for the design of the buttons |
| [61](#L61) | /\*----------------------------------------------------------------\*/ |
| [62](#L62) |  |
| [63](#L63) | function ait\_fs\_style\_fuss\_plugin\_scripts() { |
| [64](#L64) | // Include CSS file: |
| [65](#L65) | $script = plugin\_dir\_url( \_\_FILE\_\_ ) . 'assets/css/ait\_style\_fuss.css'; |
| [66](#L66) | wp\_enqueue\_style( 'custom\_style',  $script); |
| [67](#L67) |  |
| [68](#L68) | // Variables for button design |
| [69](#L69) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [70](#L70) | $button\_hintergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hintergrundfarbe\_button']); |
| [71](#L71) | $button\_vordergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_vordergrundfarbe\_button']); |
| [72](#L72) | $button\_hover\_hintergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_hintergrundfarbe\_button']); |
| [73](#L73) | $button\_hover\_vordergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_vordergrundfarbe\_button']); |
| [74](#L74) | $button\_rund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_runder\_button']); |
| [75](#L75) | $custom\_css= " |
| [76](#L76) | a.fuss\_button-beitrag { |
| [77](#L77) | color: {$button\_vordergrund}!important; |
| [78](#L78) | background-color: {$button\_hintergrund}!important; |
| [79](#L79) | text-decoration: none!important; |
| [80](#L80) | border-radius: {$button\_rund}px; |
| [81](#L81) | } |
| [82](#L82) | a.fuss\_button-beitrag:hover{ |
| [83](#L83) | color: {$button\_hover\_vordergrund}!important; |
| [84](#L84) | background-color: {$button\_hover\_hintergrund}!important; |
| [85](#L85) | text-decoration: none!important; |
| [86](#L86) | }"; |
| [87](#L87) | wp\_add\_inline\_style( 'custom\_style', $custom\_css ); |
| [88](#L88) | // not used: wp\_enqueue\_script( 'style\_fuss' ); // |
| [89](#L89) | } |
| [90](#L90) | add\_action( 'wp\_enqueue\_scripts', 'ait\_fs\_style\_fuss\_plugin\_scripts' ); |
| [91](#L91) |  |
| [92](#L92) | /\*----------------------------------------------------------------\*/ |
| [93](#L93) | // End: get the color settings from style\_fuss.css |
| [94](#L94) | // for the design of the buttons |
| [95](#L95) | /\*----------------------------------------------------------------\*/ |
| [96](#L96) |  |
| [97](#L97) |  |
| [98](#L98) | /\*----------------------------------------------------------------\*/ |
| [99](#L99) | /\* Start: shortcodes for footer at the single event |
| [100](#L100) | /\*----------------------------------------------------------------\*/ |
| [101](#L101) |  |
| [102](#L102) | // Automatically displays the text from "Caption" in italics by default for an event or a post. |
| [103](#L103) | // Call Examples: |
| [104](#L104) | // [fuss link="https://externer\_link.de" vl=""] --> always shows picture credits, then more info with the link to external website and at vl="" the link to "more events". |
| [105](#L105) | // [fuss vl=""] --> always shows picture credits, but no link to external website and at vl="" the link to "more events". |
| [106](#L106) | // vl = list of events |
| [107](#L107) | // [fuss] --> always shows picture credits, but no link to external website. |
| [108](#L108) | // [fuss link="https://externer\_link.de" vl="nature"] --> always shows picture credits, then more info with the link to external website and at vl="Nature" the link to "more events: nature". |
| [109](#L109) | // (of course the category must exist in The Events Calendar (this is checked by a function). If the category does not exist, the event list will be shown.) |
| [110](#L110) | // [fuss vl="" il="http://internal\_link.de/example"] --> always shows picture credits, but no link to external website and at vl="" the link to "more events" and at il="http://internal\_link.de/example" the link to another external or internal webesite. |
| [111](#L111) | // internal used: fm, kfm, ferien |
| [112](#L112) |  |
| [113](#L113) | function ait\_fs\_beitrags\_fuss\_pi($atts) { |
| [114](#L114) | $werte = shortcode\_atts( array( |
| [115](#L115) | 'link' => '', |
| [116](#L116) | 'fm' => 'nein', |
| [117](#L117) | 'kfm' => 'nein', |
| [118](#L118) | 'ferien' => 'nein', |
| [119](#L119) | 'vl' => 'nein', |
| [120](#L120) | 'il' => '', |
| [121](#L121) | ), $atts); |
| [122](#L122) | $fs\_ausgabe = ''; |
| [123](#L123) | // |
| [124](#L124) | // Output line above // |
| [125](#L125) | // |
| [126](#L126) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [127](#L127) | // workaround to prevent the item from not being created (checked) and create a notice, if WP\_DEBUG is true: |
| [128](#L128) | $add\_infos\_to\_tec\_options = ait\_test\_array($add\_infos\_to\_tec\_options); |
| [129](#L129) | $fs\_l\_o = esc\_attr($add\_infos\_to\_tec\_options['fs\_linie\_oben']); |
| [130](#L130) | if (esc\_attr($add\_infos\_to\_tec\_options['fs\_linie\_oben']) == '1') { |
| [131](#L131) | $fs\_ausgabe = $fs\_ausgabe . '<hr>'; |
| [132](#L132) | } |
| [133](#L133) | // |
| [134](#L134) | // linking |
| [135](#L135) | // |
| [136](#L136) | // Get path from the settings: // |
| [137](#L137) | $ait\_pfad = esc\_url\_raw( $add\_infos\_to\_tec\_options['fs\_option\_pfad']); |
| [138](#L138) | // Save file path |
| [139](#L139) | // Categories used by TEC |
| [140](#L140) | $kategorien = ait\_cliff\_get\_events\_taxonomies(); |
| [141](#L141) |  |
| [142](#L142) | // caption for buttons - 12.05.2019:// |
| [143](#L143) | $button\_externer\_link = trim(esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_externer\_link'])); |
| [144](#L144) | $button\_events\_link = trim(esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_events\_link'])); |
| [145](#L145) | $button\_interner\_link = trim(esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_interner\_link'])); |
| [146](#L146) |  |
| [147](#L147) | // var\_dump($kategorien); // |
| [148](#L148) | if ( trim($werte['link']) != '') { |
| [149](#L149) | // optionally also the link as button: |
| [150](#L150) | if (esc\_attr($add\_infos\_to\_tec\_options['fs\_alle\_buttons']) == 1){ |
| [151](#L151) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"> <a class="fuss\_button-beitrag" href=' . ait\_check\_http\_https($werte['link']) . ' target="\_blank">' . $button\_externer\_link . '</a></p><br>'; |
| [152](#L152) | } else { |
| [153](#L153) | $fs\_ausgabe = $fs\_ausgabe . '<a href=' . ait\_check\_http\_https($werte['link']) . ' target="\_blank" rel="noopener noreferrer">'. $button\_externer\_link . '</a><br>'; |
| [154](#L154) | } |
| [155](#L155) | } |
| [156](#L156) | // |
| [157](#L157) | // font |
| [158](#L158) | // |
| [159](#L159) | $fs\_schriftart\_kennzeichen =  esc\_attr($add\_infos\_to\_tec\_options['fs\_schriftart']); |
| [160](#L160) | $fs\_schriftart\_ein = ''; |
| [161](#L161) | $fs\_schriftart\_aus = ''; |
| [162](#L162) | if ($fs\_schriftart\_kennzeichen == 1) { |
| [163](#L163) | // echo 'kursiv'; // |
| [164](#L164) | $fs\_schriftart\_ein = '<em>'; |
| [165](#L165) | $fs\_schriftart\_aus = '</em>'; |
| [166](#L166) | } |
| [167](#L167) | if ($fs\_schriftart\_kennzeichen == 2) { |
| [168](#L168) | // echo 'fett'; // |
| [169](#L169) | $fs\_schriftart\_ein = '<strong>'; |
| [170](#L170) | $fs\_schriftart\_aus = '</strong>'; |
| [171](#L171) | } |
| [172](#L172) | // |
| [173](#L173) | // Display the copyright if the field is not empty // |
| [174](#L174) | // |
| [175](#L175) | $fs\_copyright = get\_post(get\_post\_thumbnail\_id())->post\_excerpt; |
| [176](#L176) | if ( $fs\_copyright != '' ) { |
| [177](#L177) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz">' . $fs\_schriftart\_ein  .  $fs\_copyright . $fs\_schriftart\_aus . '</p><br>'; |
| [178](#L178) | } |
| [179](#L179) |  |
| [180](#L180) |  |
| [181](#L181) | // only internal for special use // |
| [182](#L182) | if ( $werte['fm'] != 'nein' ) { |
| [183](#L183) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'flohmarkt target="\_blank">' . 'Weitere Flohmärkte' . '</a></p>'; |
| [184](#L184) | } |
| [185](#L185) | if ( $werte['kfm'] != 'nein' ) { |
| [186](#L186) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'flohmarkt/Karte target="\_blank">' . 'Weitere Kinderflohmärkte' . '</a></p>'; |
| [187](#L187) | } |
| [188](#L188) | if ( $werte['ferien'] != 'nein' ) { |
| [189](#L189) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'ferien target="\_blank">' . 'Weitere Ferienveranstaltungen' . '</a></p>'; |
| [190](#L190) | } |
| [191](#L191) | // only internal for special use // |
| [192](#L192) |  |
| [193](#L193) | // |
| [194](#L194) | // Events with category |
| [195](#L195) | // |
| [196](#L196) |  |
| [197](#L197) | // Preset variables (path to event list and without category) // |
| [198](#L198) | // no real category, so it should be the path to all events: // |
| [199](#L199) | // fixed: 1.02 - check if TEC is installed (18.5.2019) // |
| [200](#L200) | if ( ait\_tec\_installed() ) { |
| [201](#L201) | $veranstaltungen = esc\_url( tribe\_get\_listview\_link() ); |
| [202](#L202) | $vergleichswert = ''; |
| [203](#L203) | if ( $werte['vl'] != 'nein' ) { |
| [204](#L204) | if ( trim($werte['vl']) != '') { |
| [205](#L205) | /\* Space characters are replaced by "-" if necessary (security measure when entering categories that contain space characters, e.g. "nature and wood"). \*/ |
| [206](#L206) | $vergleichswert = $werte['vl']; |
| [207](#L207) | // Set value for $ait\_key to -1, so that you can query later whether the value has changed. |
| [208](#L208) | $ait\_key = -1; |
| [209](#L209) | // search in array with categories |
| [210](#L210) | $ait\_key = array\_search($vergleichswert, array\_column($kategorien, 'Kategorie')); |
| [211](#L211) | // if the comparison value is contained in the array of categories - found, then value is greater -1 // |
| [212](#L212) | if ($ait\_key > -1 ){ |
| [213](#L213) | // Get the slug out of the associative array. |
| [214](#L214) | $ait\_slug = $kategorien[$ait\_key]['Slug']; // |
| [215](#L215) | // Replace special characters // |
| [216](#L216) | $ait\_slug = ait\_fs\_sonderzeichen ($ait\_slug); |
| [217](#L217) | $veranstaltungen = $ait\_pfad . str\_replace(" ", "-", $ait\_slug); // |
| [218](#L218) | // Space and colon behind the name, because the category appear behind it. |
| [219](#L219) | $button\_events\_link = $button\_events\_link . ': '; |
| [220](#L220) | // after description - option for buttons not used any more, 12.5.2019 |
| [221](#L221) | // $vergleichswert = ': ' . $vergleichswert . ''; // |
| [222](#L222) | } |
| [223](#L223) | else { |
| [224](#L224) | $vergleichswert = ''; |
| [225](#L225) | } |
| [226](#L226) | } |
| [227](#L227) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"> <a class="fuss\_button-beitrag" href=' . $veranstaltungen . ' target="\_blank">'. $button\_events\_link . $vergleichswert . '</a></p>'; |
| [228](#L228) | } |
| [229](#L229) | } |
| [230](#L230) | // TEC not installed - may be another Event-Plugin installed (19.5.2019) // |
| [231](#L231) | else { |
| [232](#L232) | $veranstaltungen = esc\_url\_raw( $add\_infos\_to\_tec\_options['fs\_option\_pfad']); |
| [233](#L233) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"> <a class="fuss\_button-beitrag" href=' . $veranstaltungen . ' target="\_blank">'. $button\_events\_link . '</a></p>'; |
| [234](#L234) | } |
| [235](#L235) | // |
| [236](#L236) | // Internal link (can also be an external link) |
| [237](#L237) | // |
| [238](#L238) | if ( trim($werte['il']) != '') { |
| [239](#L239) | $fs\_ausgabe = $fs\_ausgabe . '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . ait\_check\_http\_https($werte['il']) . ' target="\_blank">' . $button\_interner\_link . '</a></p>'; |
| [240](#L240) | } |
| [241](#L241) | // |
| [242](#L242) | // Output line below // |
| [243](#L243) | // |
| [244](#L244) | if (esc\_attr($add\_infos\_to\_tec\_options['fs\_linie\_unten']) == 1) { |
| [245](#L245) | $fs\_ausgabe = $fs\_ausgabe . '<hr>'; |
| [246](#L246) | } |
| [247](#L247) | return $fs\_ausgabe; |
| [248](#L248) | } |
| [249](#L249) | add\_shortcode('fuss', 'ait\_fs\_beitrags\_fuss\_pi'); |
| [250](#L250) |  |
| [251](#L251) |  |
| [252](#L252) |  |
| [253](#L253) |  |
| [254](#L254) | /\*----------------------------------------------------------------\*/ |
| [255](#L255) | /\* Ende: shortcodes for footer at the single event |
| [256](#L256) | /\*----------------------------------------------------------------\*/ |
| [257](#L257) |  |
| [258](#L258) |  |
| [259](#L259) | // fixed: 1.02 - check if TEC is installed (18.5.2019) // |
| [260](#L260) | function ait\_tec\_installed() { |
| [261](#L261) | $tec\_installed = TRUE; |
| [262](#L262) | if ( ! function\_exists( 'tribe\_get\_listview\_link' ) ) { |
| [263](#L263) | $tec\_installed = FALSE; |
| [264](#L264) | } |
| [265](#L265) | // var\_dump ($tec\_installed); // |
| [266](#L266) | return $tec\_installed; |
| [267](#L267) | } |
| [268](#L268) |  |
| [269](#L269) |  |
| [270](#L270) | /\*\* |
| [271](#L271) | \* The Events Calendar: See all Events Categories - var\_dump at top of Events archive page |
| [272](#L272) | \* Screenshot: https://cl.ly/0Q0B1D0g2a43 |
| [273](#L273) | \* |
| [274](#L274) | \* for https://theeventscalendar.com/support/forums/topic/getting-list-of-event-categories/ |
| [275](#L275) | \* |
| [276](#L276) | \* From https://gist.github.com/cliffordp/36d2b1f5b4f03fc0c8484ef0d4e0bbbb |
| [277](#L277) | \*/ |
| [278](#L278) | add\_action( 'tribe\_events\_before\_template', 'ait\_cliff\_get\_events\_taxonomies' ); |
| [279](#L279) | function ait\_cliff\_get\_events\_taxonomies(){ |
| [280](#L280) | if( ! class\_exists( 'Tribe\_\_Events\_\_Main' ) ) { |
| [281](#L281) | return false; |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | $tecmain = Tribe\_\_Events\_\_Main::instance(); |
| [285](#L285) |  |
| [286](#L286) | // https://developer.wordpress.org/reference/functions/get\_terms/ |
| [287](#L287) | $cat\_args = array( |
| [288](#L288) | 'hide\_empty' => true, |
| [289](#L289) | ); |
| [290](#L290) | // see here: https://theeventscalendar.com/support/forums/topic/get\_terms-with-tribe\_events\_cat-returning-wp\_error-in-functions-php/ |
| [291](#L291) | $events\_cats = get\_terms(array( |
| [292](#L292) | 'taxonomy' => 'tribe\_events\_cat', |
| [293](#L293) | 'parent' => 0, |
| [294](#L294) | 'hide\_empty' => false |
| [295](#L295) | )); |
| [296](#L296) | // $events\_cats = get\_terms( $tecmain::TAXONOMY, $cat\_args ); // hat hier nicht funktioniert |
| [297](#L297) | /\* $events\_cats\_names = array(); \*/ |
| [298](#L298) | if( ! is\_wp\_error( $events\_cats ) && ! empty( $events\_cats ) && is\_array( $events\_cats) ) { |
| [299](#L299) | $events\_cats\_names = array(); |
| [300](#L300) | foreach( $events\_cats as $key => $value ) { |
| [301](#L301) | // slug instead of name |
| [302](#L302) | $events\_cats\_names[] = array ('Slug' => $value->slug, |
| [303](#L303) | 'Kategorie' => $value->name); |
| [304](#L304) | // $events\_cats\_names[] = $value->name; // |
| [305](#L305) | } |
| [306](#L306) | } |
| [307](#L307) | return $events\_cats\_names; |
| [308](#L308) | } |
| [309](#L309) |  |
| [310](#L310) | /\*----------------------------------------------------------------\*/ |
| [311](#L311) | // Convert German Umlaute, so that e.g.  Führung in Fuehrung |
| [312](#L312) | // otherwise the category list will not be found. |
| [313](#L313) | /\*----------------------------------------------------------------\*/ |
| [314](#L314) | function ait\_fs\_sonderzeichen($string) |
| [315](#L315) | { |
| [316](#L316) | $string = str\_replace("ä", "ae", $string); |
| [317](#L317) | $string = str\_replace("ü", "ue", $string); |
| [318](#L318) | $string = str\_replace("ö", "oe", $string); |
| [319](#L319) | $string = str\_replace("Ä", "Ae", $string); |
| [320](#L320) | $string = str\_replace("Ü", "Ue", $string); |
| [321](#L321) | $string = str\_replace("Ö", "Oe", $string); |
| [322](#L322) | $string = str\_replace("ß", "ss", $string); |
| [323](#L323) | $string = str\_replace("´", "", $string); |
| [324](#L324) | return $string; |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | /\*----------------------------------------------------------------\*/ |
| [328](#L328) | // Automatically adds http:// to a URL before the link, |
| [329](#L329) | // if that is missing at the time of entry |
| [330](#L330) | // 14.5.2019 |
| [331](#L331) | /\*----------------------------------------------------------------\*/ |
| [332](#L332) | function ait\_check\_http\_https($string) |
| [333](#L333) | { |
| [334](#L334) | if ((substr($string, 0, 7) != AIT\_HTTP) && (substr($string, 0, 8) != AIT\_HTTPS)){ |
| [335](#L335) | $string = 'http://' . $string; |
| [336](#L336) | } |
| [337](#L337) | return $string; |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) | /\* ANFANG | hgg, 10.2.2020: Dieser Codeschnipsel scheint nicht mehr nötig zu sein: |
| [341](#L341) | // hooks and filters |
| [342](#L342) | $shortcodes = array( 'fuss\_pi'); // add shortcode triggers to array |
| [343](#L343) | foreach( $shortcodes as $shortcode ) add\_shortcode( $shortcode, 'ait\_fs\_beitrags\_fuss\_pi' ); // create shortcode for each item in $shortcodes |
| [344](#L344) | \*/ |
| [345](#L345) | /\* ENDE | hgg, 10.2.2020: Dieser Codeschnipsel scheint nicht mehr nötig zu sein |
| [346](#L346) |  |
| [347](#L347) | // -------------------------------------------------- // |
| [348](#L348) | // Start: Add new Dashboard-Widget |
| [349](#L349) | // -------------------------------------------------- // |
| [350](#L350) | /\* not used yet |
| [351](#L351) | function ait\_fs\_add\_dashboard\_widget() { |
| [352](#L352) | wp\_add\_dashboard\_widget( |
| [353](#L353) | 'mein\_dashboard\_widget', |
| [354](#L354) | \_\_('Dashboard-Widget for "Add infos to the events calendar" - Plugin', 'add-infos-to-the-events-calendar'), |
| [355](#L355) | 'fs\_dashboard\_widget\_html' |
| [356](#L356) | ); |
| [357](#L357) | } |
| [358](#L358) |  |
| [359](#L359) | add\_action( |
| [360](#L360) | 'wp\_dashboard\_setup', |
| [361](#L361) | 'ait\_fs\_add\_dashboard\_widget' |
| [362](#L362) | ); |
| [363](#L363) | // Ausgabe des Inhaltes des Dashboard-Widgets |
| [364](#L364) | function fs\_dashboard\_widget\_html($post,$callback\_args){ |
| [365](#L365) | esc\_html\_e( |
| [366](#L366) | \_\_('First Dashboard-Widget for "Add infos to the events calendar" - Plugin', 'add-infos-to-the-events-calendar'), |
| [367](#L367) | 'add-infos-to-the-events-calendar' |
| [368](#L368) | ); |
| [369](#L369) | } |
| [370](#L370) | \*/ |
| [371](#L371) |  |
| [372](#L372) | // -------------------------------------------------- // |
| [373](#L373) | // Ende: Add new Dashboard-Widget |
| [374](#L374) | // -------------------------------------------------- // |
| [375](#L375) |  |
| [376](#L376) |  |
| [377](#L377) | // workaround to prevent the item from not being created (option checked()) - would create a notice, if WP\_DEBUG is true |
| [378](#L378) | function ait\_test\_array($ait\_options) { |
| [379](#L379) | // if empty, set the variables for checkboxes to 0 so that no notice appears |
| [380](#L380) | if (empty( $ait\_options['fs\_alle\_buttons'])) { |
| [381](#L381) | $ait\_options['fs\_alle\_buttons'] = '0'; |
| [382](#L382) | } |
| [383](#L383) | if (empty( $ait\_options['fs\_linie\_oben'])) { |
| [384](#L384) | $ait\_options['fs\_linie\_oben'] = '0'; |
| [385](#L385) | } |
| [386](#L386) | if (empty( $ait\_options['fs\_linie\_unten'])) { |
| [387](#L387) | $ait\_options['fs\_linie\_unten'] = '0'; |
| [388](#L388) | } |
| [389](#L389) | if (empty( $ait\_options['fs\_bezeichnung\_externer\_link'])) { |
| [390](#L390) | $ait\_options['fs\_bezeichnung\_externer\_link'] = 'Read More'; |
| [391](#L391) | } |
| [392](#L392) | if (empty( $ait\_options['fs\_bezeichnung\_events\_link'])) { |
| [393](#L393) | $ait\_options['fs\_bezeichnung\_events\_link'] = 'More Events'; |
| [394](#L394) | } |
| [395](#L395) | if (empty( $ait\_options['fs\_bezeichnung\_interner\_link'])) { |
| [396](#L396) | $ait\_options['fs\_bezeichnung\_interner\_link'] = 'Read More on this website '; |
| [397](#L397) | } |
| [398](#L398) | if (empty( $ait\_options['fs\_sortierung\_categories'])) { |
| [399](#L399) | $ait\_options['fs\_sortierung\_categories'] = '0'; |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | return $ait\_options; |
| [403](#L403) | } |
| [404](#L404) |  |
| [405](#L405) | add\_action('admin\_menu', 'ait\_add\_infos\_to\_tec\_create\_menu'); |
| [406](#L406) |  |
| [407](#L407) | // create custom plugin settings menu |
| [408](#L408) | function ait\_add\_infos\_to\_tec\_create\_menu() { |
| [409](#L409) |  |
| [410](#L410) | //create new top-level menu: add\_menu\_page |
| [411](#L411) | add\_submenu\_page('Add Infos to TEC Plugin Settings',  \_\_('Add Infos to TEC Settings', 'add-infos-to-the-events-calendar'), 'administrator', \_\_FILE\_\_, 'ait\_add\_infos\_to\_tec\_settings\_page' , plugins\_url('/images/icon.png', \_\_FILE\_\_) ); |
| [412](#L412) | add\_options\_page( 'Add Infos to TEC Plugin Settings',  \_\_('Add Infos to TEC Settings', 'add-infos-to-the-events-calendar'), 'manage\_options', 'ait\_add\_infos\_to\_tec\_settings\_page', 'ait\_add\_infos\_to\_tec\_settings\_page'); |
| [413](#L413) | //call register settings function |
| [414](#L414) | add\_action( 'admin\_init', 'ait\_register\_add\_infos\_to\_tec\_settings' ); |
| [415](#L415) | /\* |
| [416](#L416) | if (! isset( $\_POST['ait\_tec'] )        || ! wp\_verify\_nonce( $\_POST['ait\_tec'],        'ait\_plugin\_settings\_link' )) { |
| [417](#L417) | print 'Sorry, Nonce ist nicht korrekt.'; |
| [418](#L418) | exit; |
| [419](#L419) | } |
| [420](#L420) | \*/ |
| [421](#L421) | } |
| [422](#L422) |  |
| [423](#L423) |  |
| [424](#L424) | // -------------------------------------------------- // |
| [425](#L425) | // Integrate shortcode generator in tinymce editor |
| [426](#L426) | // -------------------------------------------------- // |
| [427](#L427) |  |
| [428](#L428) | add\_action( 'admin\_init', 'ait\_button' ); |
| [429](#L429) |  |
| [430](#L430) | function ait\_button() { |
| [431](#L431) | if ( current\_user\_can( 'edit\_posts' ) && current\_user\_can( 'edit\_pages' ) ) { |
| [432](#L432) | // check if WYSIWYG is enabled // |
| [433](#L433) | if ( get\_user\_option('rich\_editing') == 'true') { |
| [434](#L434) | add\_filter( 'mce\_buttons', 'ait\_to\_tec\_register\_tinymce\_button' ); |
| [435](#L435) | add\_filter( 'mce\_external\_plugins', 'ait\_to\_tec\_add\_tinymce\_button' ); |
| [436](#L436) | } |
| [437](#L437) | } |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) |  |
| [441](#L441) | function ait\_to\_tec\_register\_tinymce\_button( $buttons ) { |
| [442](#L442) | array\_push( $buttons, "ait\_button"); |
| [443](#L443) | return $buttons; |
| [444](#L444) | } |
| [445](#L445) |  |
| [446](#L446) | function ait\_to\_tec\_add\_tinymce\_button( $plugin\_array ) { |
| [447](#L447) | $plugin\_array['my\_button\_script'] = plugins\_url( '/assets/js/ait\_buttons.js', \_\_FILE\_\_ ) ; |
| [448](#L448) | return $plugin\_array; |
| [449](#L449) | } |
| [450](#L450) |  |
| [451](#L451) |  |
| [452](#L452) |  |
| [453](#L453) | /\* localization for ait\_buttons.js \*/ |
| [454](#L454) | add\_action( 'admin\_enqueue\_scripts', 'ait\_load\_scripts' ); |
| [455](#L455) | function ait\_load\_scripts() { |
| [456](#L456) |  |
| [457](#L457) | global $pagenow; |
| [458](#L458) | // only if we actually do it in Dashboard |
| [459](#L459) | if ( |
| [460](#L460) | ('post.php' === $pagenow && isset($\_GET['post'])) || |
| [461](#L461) | ( 'post-new.php' === $pagenow) |
| [462](#L462) | ) { |
| [463](#L463) | // variables for transfer to ait\_buttons.js |
| [464](#L464) | $ait\_ext\_link       = \_\_( 'Ext. Link:', 'add-infos-to-the-events-calendar' ); |
| [465](#L465) | $ait\_event\_category = \_\_( 'Choose Event Category:', 'add-infos-to-the-events-calendar' ); |
| [466](#L466) | $ait\_int\_link       = \_\_( 'Int. Link:', 'add-infos-to-the-events-calendar' ); |
| [467](#L467) | $ait\_pfad           = plugin\_dir\_url( \_\_FILE\_\_ ) . 'assets/js/ait\_buttons.js'; |
| [468](#L468) | $ait\_cats           = ''; |
| [469](#L469) | $ait\_tec\_installed  = "false"; |
| [470](#L470) | // build an array of categories only if TEC is installed |
| [471](#L471) | if ( ait\_tec\_installed() ) { |
| [472](#L472) | $ait\_cats = ait\_categories(); |
| [473](#L473) | $ait\_tec\_installed = "true"; |
| [474](#L474) | } |
| [475](#L475) | // register script: |
| [476](#L476) | wp\_register\_script('ait\_js\_script',     $ait\_pfad ); |
| [477](#L477) | $ait\_add\_options = array( |
| [478](#L478) | 'external\_link'     => $ait\_ext\_link, |
| [479](#L479) | 'event\_category'    => $ait\_event\_category, |
| [480](#L480) | 'internal\_link'     => $ait\_int\_link, |
| [481](#L481) | 'ait\_categories'    => $ait\_cats, |
| [482](#L482) | 'ait\_tec\_installed' => $ait\_tec\_installed |
| [483](#L483) | ); |
| [484](#L484) | // Localize the script with new data |
| [485](#L485) | wp\_localize\_script( 'ait\_js\_script', 'ait\_php\_var', $ait\_add\_options ); |
| [486](#L486) | // Enqueued script with localized data. |
| [487](#L487) | wp\_enqueue\_script( 'ait\_js\_script' ); |
| [488](#L488) | } |
| [489](#L489) |  |
| [490](#L490) | }; |
| [491](#L491) |  |
| [492](#L492) |  |
| [493](#L493) |  |
| [494](#L494) | // -------------------------------------------------- // |
| [495](#L495) | // Build an array of categories (The Events Calendar) |
| [496](#L496) | // -------------------------------------------------- // |
| [497](#L497) | add\_action( 'tribe\_events\_bar\_after\_template', 'ait\_categories' ); |
| [498](#L498) | // sort event categories by Quantity deascending (beginning with the greatest quantity): |
| [499](#L499) | function ait\_categories() { |
| [500](#L500) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [501](#L501) | // if empty, set fs\_sortierung\_categories to 0 so that no notice appears |
| [502](#L502) | if (empty( $add\_infos\_to\_tec\_options['fs\_sortierung\_categories'])) { |
| [503](#L503) | $add\_infos\_to\_tec\_options['fs\_sortierung\_categories'] = '0'; |
| [504](#L504) | } |
| [505](#L505) | if (esc\_attr($add\_infos\_to\_tec\_options['fs\_sortierung\_categories']) == '1') { |
| [506](#L506) | $ait\_terms = get\_terms( [ |
| [507](#L507) | 'taxonomy' => Tribe\_\_Events\_\_Main::TAXONOMY, |
| [508](#L508) | 'hide\_empty' => false, |
| [509](#L509) | 'orderby' => 'count', |
| [510](#L510) | 'order' => 'DEASC' |
| [511](#L511) | ] ); |
| [512](#L512) | } |
| [513](#L513) | else { |
| [514](#L514) | $ait\_terms = get\_terms( [ |
| [515](#L515) | 'taxonomy' => Tribe\_\_Events\_\_Main::TAXONOMY, |
| [516](#L516) | 'hide\_empty' => false, |
| [517](#L517) | 'orderby' => 'name', |
| [518](#L518) | ] ); |
| [519](#L519) | } |
| [520](#L520) |  |
| [521](#L521) | if ( empty( $ait\_terms ) || is\_wp\_error( $ait\_terms ) ) { |
| [522](#L522) | return; |
| [523](#L523) | } |
| [524](#L524) | $ait\_zaehler = 0; |
| [525](#L525) | foreach ( $ait\_terms as $ait\_single\_term ) { |
| [526](#L526) | $ait\_categories[$ait\_zaehler] = new stdClass(); |
| [527](#L527) | $ait\_categories[$ait\_zaehler]->text = esc\_html( get\_term\_field( 'name', $ait\_single\_term ) ); |
| [528](#L528) | $ait\_categories[$ait\_zaehler]->value = esc\_html( get\_term\_field( 'name', $ait\_single\_term ) ); |
| [529](#L529) | $ait\_zaehler = $ait\_zaehler + 1; |
| [530](#L530) | } |
| [531](#L531) | return $ait\_categories; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) |  |
| [535](#L535) | // -------------------------------------------------- // |
| [536](#L536) | // |
| [537](#L537) | // Start: admin area |
| [538](#L538) | // |
| [539](#L539) | // -------------------------------------------------- // |
| [540](#L540) |  |
| [541](#L541) | // WP Color Picker |
| [542](#L542) | add\_action( 'admin\_enqueue\_scripts', 'ait\_farbwaehler\_laden' ); |
| [543](#L543) | function ait\_farbwaehler\_laden( $hook ) { |
| [544](#L544) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [545](#L545) | wp\_enqueue\_script( |
| [546](#L546) | 'color-script', |
| [547](#L547) | plugins\_url( 'assets/js/ait\_script.js', \_\_FILE\_\_ ), |
| [548](#L548) | array( 'wp-color-picker' ), |
| [549](#L549) | false, |
| [550](#L550) | true |
| [551](#L551) | ); |
| [552](#L552) | } |
| [553](#L553) |  |
| [554](#L554) |  |
| [555](#L555) | // -------------------------------------------------- // |
| [556](#L556) | // Determine path for events and suggest as path if necessary |
| [557](#L557) | // -------------------------------------------------- // |
| [558](#L558) | function ait\_path\_for\_tec(){ |
| [559](#L559) | if ( !ait\_tec\_installed() ) { |
| [560](#L560) | // The Events Calendar is not installed, therefore: |
| [561](#L561) | $ait\_path = "http://that\_is\_my\_website/interesting\_post/"; |
| [562](#L562) | } else { |
| [563](#L563) | $ait\_path = esc\_url( tribe\_get\_listview\_link() ); |
| [564](#L564) | // delete last "/": |
| [565](#L565) | $ait\_path = substr($ait\_path,0,strlen($ait\_path)-1); |
| [566](#L566) | $tec\_category = \_\_( 'category', 'the-events-calendar' ); |
| [567](#L567) | $tec\_category = strtolower($tec\_category); |
| [568](#L568) | // show the path without the kind of view: |
| [569](#L569) | $ait\_path = substr($ait\_path,0,strrpos($ait\_path, '/')) . '/' . $tec\_category . '/'; |
| [570](#L570) | } |
| [571](#L571) | return $ait\_path; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | // -------------------------------------------------- // |
| [575](#L575) | // Settings in the Plugin List |
| [576](#L576) | // -------------------------------------------------- // |
| [577](#L577) | function ait\_plugin\_settings\_link( $links ) { |
| [578](#L578) | $settings\_link = '<a href="options-general.php?page=ait\_add\_infos\_to\_tec\_settings\_page">'       . \_\_( 'Settings' ) . '</a>'; |
| [579](#L579) | // check\_admin\_referer( 'ait\_plugin\_settings\_link', 'ait\_tec' ); |
| [580](#L580) | array\_push( $links, $settings\_link ); |
| [581](#L581) | return $links; |
| [582](#L582) | } |
| [583](#L583) | add\_filter( |
| [584](#L584) | 'plugin\_action\_links\_' . plugin\_basename( \_\_FILE\_\_ ),   'ait\_plugin\_settings\_link' |
| [585](#L585) | ); |
| [586](#L586) |  |
| [587](#L587) | // -------------------------------------------------- // |
| [588](#L588) | //register our settings |
| [589](#L589) | // -------------------------------------------------- // |
| [590](#L590) | function ait\_register\_add\_infos\_to\_tec\_settings() { |
| [591](#L591) | register\_setting( 'add\_infos\_to\_tec\_settings-group', 'add\_infos\_to\_tec\_settings' ); |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) |  |
| [595](#L595) | // -------------------------------------------------- // |
| [596](#L596) | // page with settings |
| [597](#L597) | // -------------------------------------------------- // |
| [598](#L598) | function ait\_add\_infos\_to\_tec\_settings\_page() { |
| [599](#L599) | ?> |
| [600](#L600) | <div class="wrap"> |
| [601](#L601) | <h1>Add Infos to The Events Calendar - Version: <?php echo AIT\_VERSION ?></h1> |
| [602](#L602) | <hr> |
| [603](#L603) |  |
| [604](#L604) | <form method="post" action="options.php"> |
| [605](#L605) | <?php |
| [606](#L606) | settings\_fields( 'add\_infos\_to\_tec\_settings-group' ); |
| [607](#L607) | do\_settings\_sections( 'add\_infos\_to\_tec\_settings-group' ); |
| [608](#L608) | // get plugin options from the database |
| [609](#L609) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [610](#L610) | $tec\_path = ''; |
| [611](#L611) | // Check that user has proper security level |
| [612](#L612) | if ( !current\_user\_can( 'manage\_options' ) ){ |
| [613](#L613) | wp\_die( \_\_('You do not have permissions to perform this action', 'add-infos-to-the-events-calendar') ); |
| [614](#L614) | } |
| [615](#L615) | // security (nonce) // |
| [616](#L616) | wp\_nonce\_field('ait\_plugin\_settings\_link', 'ait\_tec'); |
| [617](#L617) | // $nonce\_field = wp\_nonce\_field('ait\_plugin\_settings\_link', 'ait\_tec'); |
| [618](#L618) | // Set options if the options do not yet exist |
| [619](#L619) | if (empty( $add\_infos\_to\_tec\_options)) { |
| [620](#L620) | // The option hasn't been added yet. We'll add it with $autoload set to 'no'. |
| [621](#L621) | $deprecated = null; |
| [622](#L622) | $autoload = 'no'; |
| [623](#L623) | $tec\_path = ait\_path\_for\_tec(); |
| [624](#L624) | $add\_infos\_to\_tec\_options = array( |
| [625](#L625) | 'fs\_option\_pfad' => $tec\_path, |
| [626](#L626) | 'fs\_hintergrundfarbe\_button' => '#77BCC7', |
| [627](#L627) | 'fs\_vordergrundfarbe\_button' => '#ffffff', |
| [628](#L628) | 'fs\_hover\_hintergrundfarbe\_button' => '#F9B81E', |
| [629](#L629) | 'fs\_hover\_vordergrundfarbe\_button' => '#ffffff', |
| [630](#L630) | 'fs\_runder\_button' => '5', |
| [631](#L631) | 'fs\_alle\_buttons' => '0', |
| [632](#L632) | 'fs\_schriftart' => '1', |
| [633](#L633) | 'fs\_linie\_oben' => '1', |
| [634](#L634) | 'fs\_linie\_unten' => '0', |
| [635](#L635) | 'fs\_bezeichnung\_externer\_link' => 'Read More', |
| [636](#L636) | 'fs\_bezeichnung\_events\_link' => 'More Events', |
| [637](#L637) | 'fs\_bezeichnung\_interner\_link' => 'Read More on this website', |
| [638](#L638) | 'fs\_sortierung\_categories' => '1' |
| [639](#L639) | ); |
| [640](#L640) | add\_option( 'add\_infos\_to\_tec\_settings', $add\_infos\_to\_tec\_options, $deprecated, $autoload); |
| [641](#L641) | } |
| [642](#L642) | // workaround to prevent the item from not being created (checked) and create a notice, if WP\_DEBUG is true: |
| [643](#L643) | $add\_infos\_to\_tec\_options = ait\_test\_array($add\_infos\_to\_tec\_options); |
| [644](#L644) | ?> |
| [645](#L645) | <table class="form-table"> |
| [646](#L646) | <!-- path--> |
| [647](#L647) | <tr valign="top"> |
| [648](#L648) | <hr> |
| [649](#L649) | <!-- check if a TEC folder exists --> |
| [650](#L650) | <?php |
| [651](#L651) | $tec\_path = ''; |
| [652](#L652) | if ( ait\_tec\_installed() ) { |
| [653](#L653) | // this should be the path to The Events Calendar: |
| [654](#L654) | $tec\_path = ait\_path\_for\_tec(); |
| [655](#L655) | echo \_\_( 'This could be the path to the categories of The Events Calendar (TEC): ', 'add-infos-to-the-events-calendar' ) . '<font color="#FF0000"><strong>' . $tec\_path . '</strong></font><br />'; |
| [656](#L656) | echo \_\_( 'To be on the safe side, however, you should check this by going to the relevant event after using the shortcut and checking that the links are executed correctly.', 'add-infos-to-the-events-calendar' ); |
| [657](#L657) | ?> |
| [658](#L658) | <th scope="row"><?php echo \_\_( 'Path e.g. categories to The Events Calendar (e.g. http://example.com/events/category/):', 'add-infos-to-the-events-calendar' ); ?></th> |
| [659](#L659) | <?php |
| [660](#L660) | } |
| [661](#L661) | else { |
| [662](#L662) | echo \_\_( 'It seems that you do not use The Events Calendar. However, you can still use this plugin and enter a URL on your website that is particularly important to you. This URL will be used instead.', 'add-infos-to-the-events-calendar' ); |
| [663](#L663) | ?> |
| [664](#L664) | <th scope="row"><?php echo \_\_( 'Enter a URL on your website that is particularly important to you:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [665](#L665) | <?php |
| [666](#L666) | } |
| [667](#L667) | ?> |
| [668](#L668) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_option\_pfad]" size=50 value="<?php echo esc\_url\_raw( $add\_infos\_to\_tec\_options['fs\_option\_pfad']); ?>" /></td> |
| [669](#L669) | </tr> |
| [670](#L670) |  |
| [671](#L671) | <!-- Buttons --> |
| [672](#L672) | <tr valign="top"> |
| [673](#L673) | <th scope="row"><h3><?php echo \_\_( 'Settings for Buttons:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [674](#L674) |  |
| [675](#L675) |  |
| [676](#L676) | <tr valign="top"> |
| [677](#L677) | <th scope="row"><?php echo \_\_( 'Background color:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [678](#L678) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_hintergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hintergrundfarbe\_button']); ?>" class="color" /></td> |
| [679](#L679) | </tr> |
| [680](#L680) |  |
| [681](#L681) |  |
| [682](#L682) | <tr valign="top"> |
| [683](#L683) | <th scope="row"><?php echo \_\_( 'Font color:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [684](#L684) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_vordergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_vordergrundfarbe\_button']); ?>" class="color" /></td> |
| [685](#L685) | </tr> |
| [686](#L686) |  |
| [687](#L687) | <tr valign="top"> |
| [688](#L688) | <th scope="row"><?php echo \_\_( 'Background color when driving over the button (Hover):', 'add-infos-to-the-events-calendar' ); ?></th> |
| [689](#L689) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_hover\_hintergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_hintergrundfarbe\_button']); ?>" class="color" /></td> |
| [690](#L690) | </tr> |
| [691](#L691) |  |
| [692](#L692) | <tr valign="top"> |
| [693](#L693) | <th scope="row"><?php echo \_\_( 'Font color when driving over the button (Hover):', 'add-infos-to-the-events-calendar' ); ?></th> |
| [694](#L694) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_hover\_vordergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_vordergrundfarbe\_button']); ?>" class="color" /></td> |
| [695](#L695) | </tr> |
| [696](#L696) |  |
| [697](#L697) | <!--  caption for buttons - 12.05.2019: --> |
| [698](#L698) | <tr valign="top"> |
| [699](#L699) | <th scope="row"><?php echo \_\_( 'Description for external link:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [700](#L700) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_externer\_link]" size=30 value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_externer\_link']); ?>" /></td> |
| [701](#L701) | </tr> |
| [702](#L702) |  |
| [703](#L703) | <tr valign="top"> |
| [704](#L704) | <?php |
| [705](#L705) | // The Events Calendar installed: |
| [706](#L706) | if ( $tec\_path != '' ) { |
| [707](#L707) | ?> |
| [708](#L708) | <th scope="row"><?php echo \_\_( 'Description for events:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [709](#L709) | <?php |
| [710](#L710) | } |
| [711](#L711) | else |
| [712](#L712) | { |
| [713](#L713) | ?> |
| [714](#L714) | <th scope="row"><?php echo \_\_( 'Description for particularly link:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [715](#L715) | <?php |
| [716](#L716) | } |
| [717](#L717) | ?> |
| [718](#L718) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_events\_link]" size=30 value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_events\_link']); ?>" /></td> |
| [719](#L719) | </tr> |
| [720](#L720) |  |
| [721](#L721) | <tr valign="top"> |
| [722](#L722) | <th scope="row"><?php echo \_\_( 'Description for internal link:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [723](#L723) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_interner\_link]" size=30 value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_interner\_link']); ?>" /></td> |
| [724](#L724) | </tr> |
| [725](#L725) |  |
| [726](#L726) | <tr valign="top"> |
| [727](#L727) | <th scope="row"><h3><?php echo \_\_( 'Setting for design on website:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [728](#L728) |  |
| [729](#L729) | <tr valign="top"> |
| [730](#L730) | <th scope="row"><?php echo \_\_( 'Rounded corners (values from 0 - 30):', 'add-infos-to-the-events-calendar' ); ?></th> |
| [731](#L731) | <td><input type="number" min="0" max="30" step="1" name="add\_infos\_to\_tec\_settings[fs\_runder\_button]" size=2 value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_runder\_button']); ?>" /></td> |
| [732](#L732) | </tr> |
| [733](#L733) |  |
| [734](#L734) |  |
| [735](#L735) | <tr valign="top"> |
| [736](#L736) | <th scope="row"><?php echo \_\_( 'All links as buttons:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [737](#L737) | <td><input type="checkbox" name="add\_infos\_to\_tec\_settings[fs\_alle\_buttons]" value="1" <?php echo esc\_attr(checked($add\_infos\_to\_tec\_options['fs\_alle\_buttons'], 1, true)); ?> /> |
| [738](#L738) | </tr> |
| [739](#L739) |  |
| [740](#L740) | <!-- Divers --> |
| [741](#L741) | <tr valign="top"> |
| [742](#L742) | <th scope="row"><?php echo \_\_( 'Font for Copyright:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [743](#L743) | <td><input type="radio" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="1" <?php echo esc\_attr(checked(1, $add\_infos\_to\_tec\_options['fs\_schriftart'], true)); ?>><?php echo \_\_( 'italic', 'add-infos-to-the-events-calendar' ); ?> |
| [744](#L744) | <input type="radio" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="2" <?php echo esc\_attr(checked(2, $add\_infos\_to\_tec\_options['fs\_schriftart'], true)); ?>><?php echo \_\_( 'bold', 'add-infos-to-the-events-calendar' ); ?> |
| [745](#L745) | <input type="radio" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="3" <?php echo esc\_attr(checked(3, $add\_infos\_to\_tec\_options['fs\_schriftart'], true)); ?>><?php echo \_\_( 'normal', 'add-infos-to-the-events-calendar' ); ?></td> |
| [746](#L746) | </tr> |
| [747](#L747) |  |
| [748](#L748) | <tr valign="top"> |
| [749](#L749) | <th scope="row"><?php echo \_\_( 'Horizontal line above the block:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [750](#L750) | <td><input type="checkbox" name="add\_infos\_to\_tec\_settings[fs\_linie\_oben]" value="1" <?php echo esc\_attr(checked($add\_infos\_to\_tec\_options['fs\_linie\_oben'], 1, true)); ?> /> |
| [751](#L751) | </tr> |
| [752](#L752) |  |
| [753](#L753) | <tr valign="top"> |
| [754](#L754) | <th scope="row"><?php echo \_\_( 'Horizontal line below the block:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [755](#L755) | <td><input type="checkbox" name="add\_infos\_to\_tec\_settings[fs\_linie\_unten]" value="1" <?php echo esc\_attr(checked($add\_infos\_to\_tec\_options['fs\_linie\_unten'], 1, true)); ?> /> |
| [756](#L756) | </tr> |
| [757](#L757) |  |
| [758](#L758) | <?php |
| [759](#L759) | // The Events Calendar installed: |
| [760](#L760) | if ( $tec\_path != '' ) { |
| [761](#L761) | ?> |
| [762](#L762) | <tr valign="top"> |
| [763](#L763) | <th scope="row"><h3><?php echo \_\_( 'Further Settings:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [764](#L764) |  |
| [765](#L765) | <tr valign="top"> |
| [766](#L766) | <th scope="row"><?php echo \_\_( 'Sorting categories by occurrence (Frequently selected categories first):', 'add-infos-to-the-events-calendar' ); ?></th> |
| [767](#L767) | <td><input type="checkbox" name="add\_infos\_to\_tec\_settings[fs\_sortierung\_categories]" value="1" <?php echo esc\_attr(checked($add\_infos\_to\_tec\_options['fs\_sortierung\_categories'], 1, true)); ?> /> |
| [768](#L768) | </tr> |
| [769](#L769) | <?php |
| [770](#L770) | } |
| [771](#L771) | ?> |
| [772](#L772) |  |
| [773](#L773) |  |
| [774](#L774) | </table> |
| [775](#L775) | <?php |
| [776](#L776) | submit\_button(); |
| [777](#L777) | ?> |
| [778](#L778) | </form> |
| [779](#L779) | </div> |
| [780](#L780) | <?php |
| [781](#L781) | } |
| [782](#L782) | // -------------------------------------------------- // |
| [783](#L783) | // End: admin area |
| [784](#L784) | // -------------------------------------------------- // |
| [785](#L785) |  |
| [786](#L786) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php?rev=3205090&format=txt)
* [Original Format](/export/3205090/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_381f78ab_20250114_230354.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Add infos to the events calendar <= 1.4.1 - Authenticated (Contributor+) Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Add infos to the events calendar <= 1.4.1 - Authenticated (Contributor+) Stored Cross-Site Scripting

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11875](https://www.cve.org/CVERecord?id=CVE-2024-11875) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | December 11, 2024 |
| Last Updated | December 12, 2024 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The Add infos to the events calendar plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'fuss' shortcode in all versions up to, and including, 1.4.1 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php?rev=3205090#L94)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/add-infos-to-the-events-calendar/tags/1.4.1/add_shortcode_to_tec.php?rev=3205090)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadd-infos-to-the-events-calendar%2Fadd-infos-to-the-events-calendar-141-authenticated-contributor-stored-cross-site-scripting&t=Add%20infos%20to%20the%20events%20calendar%20%3C%3D%201.4.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadd-infos-to-the-events-calendar%2Fadd-infos-to-the-events-calendar-141-authenticated-contributor-stored-cross-site-scripting&text=Add%20infos%20to%20the%20events%20calendar%20%3C%3D%201.4.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadd-infos-to-the-events-calendar%2Fadd-infos-to-the-events-calendar-141-authenticated-contributor-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Add infos to The Events Calendar

#### [Add infos to The Events Calendar](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/add-infos-to-the-events-calendar)

| Software Type | Plugin |
| --- | --- |
| Software Slug | add-infos-to-the-events-calendar [(view on wordpress.org)](https://wordpress.org/plugins/add-infos-to-the-events-calendar) |
| Patched? | Yes |
| Remediation | Update to version 1.5.0, or a newer patched version |
| Affected Version | * <= 1.4.1 |
| Patched Version | * 1.5.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_d62cb695_20250114_230353.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fadd-infos-to-the-events-calendar%2Ftags%2F1.5.0%2Fadd-infos-to-the-events-calendar.php%3Frev%3D3205090)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Latest Revision](/browser/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php)
* Next Revision →
* [Blame](/browser/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php?annotate=blame&rev=3205090 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php?rev=3205090)

---

# [source:](/browser?rev=3205090&order=name "Go to repository root") [add-infos-to-the-events-calendar](/browser/add-infos-to-the-events-calendar?rev=3205090&order=name "View add-infos-to-the-events-calendar")/[tags](/browser/add-infos-to-the-events-calendar/tags?rev=3205090&order=name "View tags")/[1.5.0](/browser/add-infos-to-the-events-calendar/tags/1.5.0?rev=3205090&order=name "View 1.5.0")/[add-infos-to-the-events-calendar.php](/browser/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php?rev=3205090&order=name "View add-infos-to-the-events-calendar.php") @ [3205090](/changeset/3205090/ "View changeset 3205090")

View diff against:

View revision:

| [Last change](/changeset/3202600/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php "View differences") on this file since 3205090 was [3202600](/changeset/3202600/ "View changeset 3202600"), checked in by threadi, [6 weeks ago](/timeline?from=2024-12-04T19%3A49%3A05Z&precision=second "See timeline at 12/04/2024 07:49:05 PM") |
| --- |
| Release 1.5.0 |
| **File size:** 27.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* File to handle the plugin tasks. |
| [4](#L4) | \* |
| [5](#L5) | \* @package add-infos-to-the-events-calendar |
| [6](#L6) | \*/ |
| [7](#L7) |  |
| [8](#L8) | // securing against unauthorized access. |
| [9](#L9) | if ( ! defined( 'ABSPATH' ) ) { |
| [10](#L10) | exit; |
| [11](#L11) | } |
| [12](#L12) |  |
| [13](#L13) | // do nothing if PHP-version is not 7.4 or newer. |
| [14](#L14) | if ( version\_compare( PHP\_VERSION, '7.4', '<' ) ) { |
| [15](#L15) | return; |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | // set version. |
| [19](#L19) | const AIT\_VERSION = '1.5.0'; |
| [20](#L20) |  |
| [21](#L21) | /\*\* |
| [22](#L22) | \* Load language files. |
| [23](#L23) | \* |
| [24](#L24) | \* TODO remove and replace with translate.wordpress.org. |
| [25](#L25) | \* |
| [26](#L26) | \* @return void |
| [27](#L27) | \*/ |
| [28](#L28) | function ait\_meine\_textdomain\_laden(): void { |
| [29](#L29) | load\_plugin\_textdomain( |
| [30](#L30) | 'add-infos-to-the-events-calendar', |
| [31](#L31) | false, |
| [32](#L32) | basename( \_\_DIR\_\_ ) . '/languages' |
| [33](#L33) | ); |
| [34](#L34) | } |
| [35](#L35) | add\_action( 'init', 'ait\_meine\_textdomain\_laden' ); |
| [36](#L36) |  |
| [37](#L37) | /\*\* |
| [38](#L38) | \* Get the color settings from style\_fuss.css for the design of the buttons |
| [39](#L39) | \* |
| [40](#L40) | \* @return void |
| [41](#L41) | \*/ |
| [42](#L42) | function ait\_fs\_style\_fuss\_plugin\_scripts(): void { |
| [43](#L43) | // include css file. |
| [44](#L44) | wp\_enqueue\_style( |
| [45](#L45) | 'ait', |
| [46](#L46) | plugin\_dir\_url( \_\_FILE\_\_ ) . 'assets/css/ait\_style\_fuss.css', |
| [47](#L47) | array(), |
| [48](#L48) | AIT\_VERSION, |
| [49](#L49) | ); |
| [50](#L50) |  |
| [51](#L51) | // variables for button design. |
| [52](#L52) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [53](#L53) | $button\_hintergrund       = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hintergrundfarbe\_button'] ); |
| [54](#L54) | $button\_vordergrund       = esc\_attr( $add\_infos\_to\_tec\_options['fs\_vordergrundfarbe\_button'] ); |
| [55](#L55) | $button\_hover\_hintergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_hintergrundfarbe\_button'] ); |
| [56](#L56) | $button\_hover\_vordergrund = esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_vordergrundfarbe\_button'] ); |
| [57](#L57) | $button\_rund              = $add\_infos\_to\_tec\_options['fs\_runder\_button']; |
| [58](#L58) | $custom\_css               = " |
| [59](#L59) | a.fuss\_button-beitrag { |
| [60](#L60) | color: {$button\_vordergrund}!important; |
| [61](#L61) | background-color: {$button\_hintergrund}!important; |
| [62](#L62) | text-decoration: none!important; |
| [63](#L63) | border-radius: {$button\_rund}px; |
| [64](#L64) | } |
| [65](#L65) | a.fuss\_button-beitrag:hover{ |
| [66](#L66) | color: {$button\_hover\_vordergrund}!important; |
| [67](#L67) | background-color: {$button\_hover\_hintergrund}!important; |
| [68](#L68) | text-decoration: none!important; |
| [69](#L69) | }"; |
| [70](#L70) | wp\_add\_inline\_style( 'ait', $custom\_css ); |
| [71](#L71) | } |
| [72](#L72) | add\_action( 'wp\_enqueue\_scripts', 'ait\_fs\_style\_fuss\_plugin\_scripts' ); |
| [73](#L73) |  |
| [74](#L74) | /\*\* |
| [75](#L75) | \* Shortcodes for footer at the single event. |
| [76](#L76) | \* |
| [77](#L77) | \* Automatically displays the text from "Caption" in italics by default for an event or a post. |
| [78](#L78) | \* |
| [79](#L79) | \* Call Examples: |
| [80](#L80) | \* [fuss link="https://externer\_link.de" vl=""] --> always shows picture credits, then more info with the link to external website and at vl="" the link to "more events". |
| [81](#L81) | \* [fuss vl=""] --> always shows picture credits, but no link to external website and at vl="" the link to "more events". |
| [82](#L82) | \* -> vl = list of events |
| [83](#L83) | \* [fuss] --> always shows picture credits, but no link to external website. |
| [84](#L84) | \* [fuss link="https://externer\_link.de" vl="nature"] --> always shows picture credits, then more info with the link to external website and at vl="Nature" the link to "more events: nature". |
| [85](#L85) | \* -> (of course the category must exist in The Events Calendar (this is checked by a function). If the category does not exist, the event list will be shown.) |
| [86](#L86) | \* [fuss vl="" il="http://internal\_link.de/example"] --> always shows picture credits, but no link to external website and at vl="" the link to "more events" and at il="http://internal\_link.de/example" the link to another external or internal webesite. |
| [87](#L87) | \* -> internal used: fm, kfm, ferien |
| [88](#L88) | \* |
| [89](#L89) | \* TODO using hooks for internal things. |
| [90](#L90) | \* |
| [91](#L91) | \* @param array $attributes List of attributes. |
| [92](#L92) | \* @return string |
| [93](#L93) | \*/ |
| [94](#L94) | function ait\_fs\_beitrags\_fuss\_pi( array $attributes ): string { |
| [95](#L95) | // secure the attributes. |
| [96](#L96) | $werte = shortcode\_atts( |
| [97](#L97) | array( |
| [98](#L98) | 'link'   => '', |
| [99](#L99) | 'fm'     => 'nein', |
| [100](#L100) | 'kfm'    => 'nein', |
| [101](#L101) | 'ferien' => 'nein', |
| [102](#L102) | 'vl'     => 'nein', |
| [103](#L103) | 'il'     => '', |
| [104](#L104) | ), |
| [105](#L105) | $attributes |
| [106](#L106) | ); |
| [107](#L107) |  |
| [108](#L108) | // collect the output. |
| [109](#L109) | $fs\_ausgabe = ''; |
| [110](#L110) |  |
| [111](#L111) | // output line above. |
| [112](#L112) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [113](#L113) |  |
| [114](#L114) | // generate default values for not existing entries in the settings. |
| [115](#L115) | $add\_infos\_to\_tec\_options = ait\_set\_default\_settings( $add\_infos\_to\_tec\_options ); |
| [116](#L116) | if ( 1 === absint( $add\_infos\_to\_tec\_options['fs\_linie\_oben'] ) ) { |
| [117](#L117) | $fs\_ausgabe .= '<hr>'; |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | // get path from the settings. |
| [121](#L121) | $ait\_pfad = $add\_infos\_to\_tec\_options['fs\_option\_pfad']; |
| [122](#L122) |  |
| [123](#L123) | // get categories used by TEC. |
| [124](#L124) | $kategorien = ait\_cliff\_get\_events\_taxonomies(); |
| [125](#L125) |  |
| [126](#L126) | // caption for buttons - 12.05.2019. |
| [127](#L127) | $button\_externer\_link = $add\_infos\_to\_tec\_options['fs\_bezeichnung\_externer\_link']; |
| [128](#L128) | $button\_events\_link   = $add\_infos\_to\_tec\_options['fs\_bezeichnung\_events\_link']; |
| [129](#L129) | $button\_interner\_link = $add\_infos\_to\_tec\_options['fs\_bezeichnung\_interner\_link']; |
| [130](#L130) |  |
| [131](#L131) | if ( '' !== $werte['link'] ) { |
| [132](#L132) | // optionally also the link as button. |
| [133](#L133) | if ( 1 === absint( $add\_infos\_to\_tec\_options['fs\_alle\_buttons'] ) ) { |
| [134](#L134) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . esc\_url( $werte['link'] ) . ' target="\_blank">' . esc\_html( $button\_externer\_link ) . '</a></p><br>'; |
| [135](#L135) | } else { |
| [136](#L136) | $fs\_ausgabe .= '<a href=' . esc\_url( $werte['link'] ) . ' target="\_blank" rel="noopener noreferrer">' . esc\_html( $button\_externer\_link ) . '</a><br>'; |
| [137](#L137) | } |
| [138](#L138) | } |
| [139](#L139) |  |
| [140](#L140) | // get font. |
| [141](#L141) | $fs\_schriftart\_kennzeichen = absint( $add\_infos\_to\_tec\_options['fs\_schriftart'] ); |
| [142](#L142) | $fs\_schriftart\_ein         = ''; |
| [143](#L143) | $fs\_schriftart\_aus         = ''; |
| [144](#L144) | if ( 1 === $fs\_schriftart\_kennzeichen ) { |
| [145](#L145) | $fs\_schriftart\_ein = '<em>'; |
| [146](#L146) | $fs\_schriftart\_aus = '</em>'; |
| [147](#L147) | } |
| [148](#L148) | if ( 2 === $fs\_schriftart\_kennzeichen ) { |
| [149](#L149) | $fs\_schriftart\_ein = '<strong>'; |
| [150](#L150) | $fs\_schriftart\_aus = '</strong>'; |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) | // Display the copyright if the field is not empty. |
| [154](#L154) | $fs\_copyright = get\_post( get\_post\_thumbnail\_id() )->post\_excerpt; |
| [155](#L155) | if ( ! empty( $fs\_copyright ) ) { |
| [156](#L156) | $fs\_ausgabe .= '<p class="fuss\_button-absatz">' . $fs\_schriftart\_ein . $fs\_copyright . $fs\_schriftart\_aus . '</p><br>'; |
| [157](#L157) | } |
| [158](#L158) |  |
| [159](#L159) | // only internal for special use. |
| [160](#L160) | if ( 'nein' !== $werte['fm'] ) { |
| [161](#L161) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'flohmarkt target="\_blank">Weitere Flohmärkte</a></p>'; |
| [162](#L162) | } |
| [163](#L163) | if ( 'nein' !== $werte['kfm'] ) { |
| [164](#L164) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'flohmarkt/Karte target="\_blank">Weitere Kinderflohmärkte</a></p>'; |
| [165](#L165) | } |
| [166](#L166) | if ( 'nein' !== $werte['ferien'] ) { |
| [167](#L167) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . $ait\_pfad . 'ferien target="\_blank">Weitere Ferienveranstaltungen</a></p>'; |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | // check if TEC is installed. |
| [171](#L171) | if ( ait\_tec\_installed() ) { |
| [172](#L172) | $veranstaltungen = esc\_url( tribe\_get\_listview\_link() ); |
| [173](#L173) | $vergleichswert  = ''; |
| [174](#L174) | if ( 'nein' !== $werte['vl'] ) { |
| [175](#L175) | if ( ! empty( trim( $werte['vl'] ) ) ) { |
| [176](#L176) | // Space characters are replaced by "-" if necessary (security measure when entering categories that contain space characters, e.g. "nature and wood"). |
| [177](#L177) | $vergleichswert = $werte['vl']; |
| [178](#L178) |  |
| [179](#L179) | // search in array with categories. |
| [180](#L180) | $ait\_key = array\_search( $vergleichswert, array\_column( $kategorien, 'Kategorie' ), true ); |
| [181](#L181) |  |
| [182](#L182) | // if value has been found. |
| [183](#L183) | if ( $ait\_key > -1 ) { |
| [184](#L184) | // get the slug out of the associative array. |
| [185](#L185) | $ait\_slug = remove\_accents( $kategorien[ $ait\_key ]['Slug'] ); |
| [186](#L186) |  |
| [187](#L187) | // get path. |
| [188](#L188) | $veranstaltungen = $ait\_pfad . str\_replace( ' ', '-', $ait\_slug ); |
| [189](#L189) |  |
| [190](#L190) | // Space and colon behind the name, because the category appear behind it. |
| [191](#L191) | $button\_events\_link = $button\_events\_link . ': '; |
| [192](#L192) | } else { |
| [193](#L193) | $vergleichswert = ''; |
| [194](#L194) | } |
| [195](#L195) | } |
| [196](#L196) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"> <a class="fuss\_button-beitrag" href=' . $veranstaltungen . ' target="\_blank">' . $button\_events\_link . $vergleichswert . '</a></p>'; |
| [197](#L197) | } |
| [198](#L198) | } else { |
| [199](#L199) | // TEC not installed - may be another Event-Plugin installed (19.5.2019). |
| [200](#L200) | $veranstaltungen = esc\_url\_raw( $add\_infos\_to\_tec\_options['fs\_option\_pfad'] ); |
| [201](#L201) | $fs\_ausgabe      = $fs\_ausgabe . '<p class="fuss\_button-absatz"> <a class="fuss\_button-beitrag" href=' . $veranstaltungen . ' target="\_blank">' . $button\_events\_link . '</a></p>'; |
| [202](#L202) | } |
| [203](#L203) |  |
| [204](#L204) | // internal link (can also be an external link). |
| [205](#L205) | if ( ! empty( trim( $werte['il'] ) ) ) { |
| [206](#L206) | $fs\_ausgabe .= '<p class="fuss\_button-absatz"><a class="fuss\_button-beitrag" href=' . esc\_url( $werte['il'] ) . ' target="\_blank">' . $button\_interner\_link . '</a></p>'; |
| [207](#L207) | } |
| [208](#L208) |  |
| [209](#L209) | // output line below. |
| [210](#L210) | if ( 1 === absint( $add\_infos\_to\_tec\_options['fs\_linie\_unten'] ) ) { |
| [211](#L211) | $fs\_ausgabe .= '<hr>'; |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | // return resulting text. |
| [215](#L215) | return $fs\_ausgabe; |
| [216](#L216) | } |
| [217](#L217) | add\_shortcode( 'fuss', 'ait\_fs\_beitrags\_fuss\_pi' ); |
| [218](#L218) |  |
| [219](#L219) | /\*\* |
| [220](#L220) | \* Check if TEC is installed. |
| [221](#L221) | \* |
| [222](#L222) | \* @return bool |
| [223](#L223) | \*/ |
| [224](#L224) | function ait\_tec\_installed(): bool { |
| [225](#L225) | return function\_exists( 'tribe\_get\_listview\_link' ); |
| [226](#L226) | } |
| [227](#L227) |  |
| [228](#L228) | /\*\* |
| [229](#L229) | \* The Events Calendar: See all Events Categories. |
| [230](#L230) | \* |
| [231](#L231) | \* @source https://theeventscalendar.com/support/forums/topic/getting-list-of-event-categories/ |
| [232](#L232) | \* @source https://gist.github.com/cliffordp/36d2b1f5b4f03fc0c8484ef0d4e0bbbb |
| [233](#L233) | \* |
| [234](#L234) | \* TODO used? |
| [235](#L235) | \* |
| [236](#L236) | \* @return array |
| [237](#L237) | \*/ |
| [238](#L238) | function ait\_cliff\_get\_events\_taxonomies(): array { |
| [239](#L239) | // bail if tribe events does not exist. |
| [240](#L240) | if ( ! class\_exists( 'Tribe\_\_Events\_\_Main' ) ) { |
| [241](#L241) | return array(); |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | // get the tribe event categories. |
| [245](#L245) | $events\_cats = get\_terms( |
| [246](#L246) | array( |
| [247](#L247) | 'taxonomy'   => 'tribe\_events\_cat', |
| [248](#L248) | 'parent'     => 0, |
| [249](#L249) | 'hide\_empty' => false, |
| [250](#L250) | ) |
| [251](#L251) | ); |
| [252](#L252) |  |
| [253](#L253) | // bail if term query results in error. |
| [254](#L254) | if ( is\_wp\_error( $events\_cats ) ) { |
| [255](#L255) | return array(); |
| [256](#L256) | } |
| [257](#L257) |  |
| [258](#L258) | // bail if list of cats is empty. |
| [259](#L259) | if ( empty( $events\_cats ) ) { |
| [260](#L260) | return array(); |
| [261](#L261) | } |
| [262](#L262) |  |
| [263](#L263) | // bail if list of event cats is not an array. |
| [264](#L264) | if ( ! is\_array( $events\_cats ) ) { |
| [265](#L265) | return array(); |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) | // array to collect the categories. |
| [269](#L269) | $events\_cats\_names = array(); |
| [270](#L270) | foreach ( $events\_cats as $value ) { |
| [271](#L271) | // slug instead of name. |
| [272](#L272) | $events\_cats\_names[] = array( |
| [273](#L273) | 'Slug'      => $value->slug, |
| [274](#L274) | 'Kategorie' => $value->name, |
| [275](#L275) | ); |
| [276](#L276) | } |
| [277](#L277) |  |
| [278](#L278) | // return resulting list of categories. |
| [279](#L279) | return $events\_cats\_names; |
| [280](#L280) | } |
| [281](#L281) | add\_action( 'tribe\_events\_before\_template', 'ait\_cliff\_get\_events\_taxonomies' ); |
| [282](#L282) |  |
| [283](#L283) | /\*\* |
| [284](#L284) | \* Set default values for not existing entries in the settings. |
| [285](#L285) | \* |
| [286](#L286) | \* @param array $ait\_options The settings array. |
| [287](#L287) | \* @return array |
| [288](#L288) | \*/ |
| [289](#L289) | function ait\_set\_default\_settings( array $ait\_options ): array { |
| [290](#L290) | if ( empty( $ait\_options['fs\_alle\_buttons'] ) ) { |
| [291](#L291) | $ait\_options['fs\_alle\_buttons'] = '0'; |
| [292](#L292) | } |
| [293](#L293) | if ( empty( $ait\_options['fs\_linie\_oben'] ) ) { |
| [294](#L294) | $ait\_options['fs\_linie\_oben'] = '0'; |
| [295](#L295) | } |
| [296](#L296) | if ( empty( $ait\_options['fs\_linie\_unten'] ) ) { |
| [297](#L297) | $ait\_options['fs\_linie\_unten'] = '0'; |
| [298](#L298) | } |
| [299](#L299) | if ( empty( $ait\_options['fs\_bezeichnung\_externer\_link'] ) ) { |
| [300](#L300) | $ait\_options['fs\_bezeichnung\_externer\_link'] = 'Read More'; |
| [301](#L301) | } |
| [302](#L302) | if ( empty( $ait\_options['fs\_bezeichnung\_events\_link'] ) ) { |
| [303](#L303) | $ait\_options['fs\_bezeichnung\_events\_link'] = 'More Events'; |
| [304](#L304) | } |
| [305](#L305) | if ( empty( $ait\_options['fs\_bezeichnung\_interner\_link'] ) ) { |
| [306](#L306) | $ait\_options['fs\_bezeichnung\_interner\_link'] = 'Read More on this website '; |
| [307](#L307) | } |
| [308](#L308) | if ( empty( $ait\_options['fs\_sortierung\_categories'] ) ) { |
| [309](#L309) | $ait\_options['fs\_sortierung\_categories'] = '0'; |
| [310](#L310) | } |
| [311](#L311) |  |
| [312](#L312) | // return resulting settings with its default values. |
| [313](#L313) | return $ait\_options; |
| [314](#L314) | } |
| [315](#L315) |  |
| [316](#L316) | /\*\* |
| [317](#L317) | \* Add our custom menu for settings. |
| [318](#L318) | \* |
| [319](#L319) | \* @return void |
| [320](#L320) | \*/ |
| [321](#L321) | function ait\_add\_infos\_to\_tec\_create\_menu(): void { |
| [322](#L322) | add\_options\_page( |
| [323](#L323) | 'Add Infos to TEC Plugin Settings', |
| [324](#L324) | \_\_( 'Add Infos to TEC Settings', 'add-infos-to-the-events-calendar' ), |
| [325](#L325) | 'manage\_options', |
| [326](#L326) | 'ait\_add\_infos\_to\_tec\_settings\_page', |
| [327](#L327) | 'ait\_add\_infos\_to\_tec\_settings\_page' |
| [328](#L328) | ); |
| [329](#L329) | } |
| [330](#L330) | add\_action( 'admin\_menu', 'ait\_add\_infos\_to\_tec\_create\_menu' ); |
| [331](#L331) |  |
| [332](#L332) | /\*\* |
| [333](#L333) | \* Register our settings. |
| [334](#L334) | \* |
| [335](#L335) | \* @return void |
| [336](#L336) | \*/ |
| [337](#L337) | function ait\_register\_add\_infos\_to\_tec\_settings(): void { |
| [338](#L338) | register\_setting( 'add\_infos\_to\_tec\_settings-group', 'add\_infos\_to\_tec\_settings' ); |
| [339](#L339) | } |
| [340](#L340) | add\_action( 'admin\_init', 'ait\_register\_add\_infos\_to\_tec\_settings' ); |
| [341](#L341) |  |
| [342](#L342) | /\*\* |
| [343](#L343) | \* Add button in tinyMCE. |
| [344](#L344) | \* |
| [345](#L345) | \* @return void |
| [346](#L346) | \*/ |
| [347](#L347) | function ait\_button(): void { |
| [348](#L348) | // bail if current user has no capabilities. |
| [349](#L349) | if ( ! ( current\_user\_can( 'edit\_posts' ) && current\_user\_can( 'edit\_pages' ) ) ) { |
| [350](#L350) | return; |
| [351](#L351) | } |
| [352](#L352) |  |
| [353](#L353) | // bail if WYSIWYG is disabled in user setting. |
| [354](#L354) | if ( 'true' !== get\_user\_meta( get\_current\_user\_id(), 'rich\_editing', true ) ) { |
| [355](#L355) | return; |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | // use filter to add the button. |
| [359](#L359) | add\_filter( 'mce\_buttons', 'ait\_to\_tec\_register\_tinymce\_button' ); |
| [360](#L360) | add\_filter( 'mce\_external\_plugins', 'ait\_to\_tec\_add\_tinymce\_button' ); |
| [361](#L361) | } |
| [362](#L362) | add\_action( 'admin\_init', 'ait\_button' ); |
| [363](#L363) |  |
| [364](#L364) | /\*\* |
| [365](#L365) | \* Add the ait button in tinyMCE. |
| [366](#L366) | \* |
| [367](#L367) | \* @param array $buttons List of buttons. |
| [368](#L368) | \* @return array |
| [369](#L369) | \*/ |
| [370](#L370) | function ait\_to\_tec\_register\_tinymce\_button( array $buttons ): array { |
| [371](#L371) | $buttons[] = 'ait\_button'; |
| [372](#L372) | return $buttons; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | /\*\* |
| [376](#L376) | \* Add the JS for the air button in tinyMCE. |
| [377](#L377) | \* |
| [378](#L378) | \* @param array $plugin\_array List of plugin scripts. |
| [379](#L379) | \* @return array |
| [380](#L380) | \*/ |
| [381](#L381) | function ait\_to\_tec\_add\_tinymce\_button( array $plugin\_array ): array { |
| [382](#L382) | $plugin\_array['ait\_button\_script'] = plugins\_url( '/assets/js/ait\_buttons.js', \_\_FILE\_\_ ); |
| [383](#L383) | return $plugin\_array; |
| [384](#L384) | } |
| [385](#L385) |  |
| [386](#L386) | /\*\* |
| [387](#L387) | \* Localization of the tinyMCE JS-script. |
| [388](#L388) | \* |
| [389](#L389) | \* @return void |
| [390](#L390) | \*/ |
| [391](#L391) | function ait\_load\_scripts(): void { |
| [392](#L392) | global $pagenow; |
| [393](#L393) |  |
| [394](#L394) | // bail if we are not on edit page. |
| [395](#L395) | if ( ! ( 'post.php' === $pagenow || 'post-new.php' === $pagenow ) ) { |
| [396](#L396) | return; |
| [397](#L397) | } |
| [398](#L398) |  |
| [399](#L399) | // get cats and tec marker. |
| [400](#L400) | $ait\_cats          = ''; |
| [401](#L401) | $ait\_tec\_installed = 'false'; |
| [402](#L402) |  |
| [403](#L403) | // build an array of categories only if TEC is installed. |
| [404](#L404) | if ( ait\_tec\_installed() ) { |
| [405](#L405) | $ait\_cats          = ait\_categories(); |
| [406](#L406) | $ait\_tec\_installed = 'true'; |
| [407](#L407) | } |
| [408](#L408) |  |
| [409](#L409) | // register our custom script. |
| [410](#L410) | wp\_register\_script( |
| [411](#L411) | 'ait', |
| [412](#L412) | plugin\_dir\_url( \_\_FILE\_\_ ) . 'assets/js/ait\_buttons.js', |
| [413](#L413) | array(), |
| [414](#L414) | AIT\_VERSION, |
| [415](#L415) | true |
| [416](#L416) | ); |
| [417](#L417) |  |
| [418](#L418) | // localize the script with new data. |
| [419](#L419) | wp\_localize\_script( |
| [420](#L420) | 'ait', |
| [421](#L421) | 'ait\_php\_var', |
| [422](#L422) | array( |
| [423](#L423) | 'mouseover\_title'   => \_\_( 'Add Infos to the events calendar', 'add-infos-to-the-events-calendar' ), |
| [424](#L424) | 'window\_title'      => \_\_( 'Add Infos to the events calendar Shortcode Generator', 'add-infos-to-the-events-calendar' ), |
| [425](#L425) | 'external\_link'     => \_\_( 'Ext. Link:', 'add-infos-to-the-events-calendar' ), |
| [426](#L426) | 'event\_category'    => \_\_( 'Choose Event Category:', 'add-infos-to-the-events-calendar' ), |
| [427](#L427) | 'internal\_link'     => \_\_( 'Int. Link:', 'add-infos-to-the-events-calendar' ), |
| [428](#L428) | 'ait\_categories'    => $ait\_cats, |
| [429](#L429) | 'ait\_tec\_installed' => $ait\_tec\_installed, |
| [430](#L430) | ) |
| [431](#L431) | ); |
| [432](#L432) | // enqueued script with localized data. |
| [433](#L433) | wp\_enqueue\_script( 'ait' ); |
| [434](#L434) | } |
| [435](#L435) | add\_action( 'admin\_enqueue\_scripts', 'ait\_load\_scripts' ); |
| [436](#L436) |  |
| [437](#L437) | /\*\* |
| [438](#L438) | \* Get TEC categories as array with simple objects for each category. |
| [439](#L439) | \* |
| [440](#L440) | \* @return array |
| [441](#L441) | \*/ |
| [442](#L442) | function ait\_categories(): array { |
| [443](#L443) | // get the settings. |
| [444](#L444) | $add\_infos\_to\_tec\_options = ait\_set\_default\_settings( get\_option( 'add\_infos\_to\_tec\_settings' ) ); // TODO validate via get\_option. |
| [445](#L445) |  |
| [446](#L446) | // define query for the categories. |
| [447](#L447) | $query = array( |
| [448](#L448) | 'taxonomy'   => Tribe\_\_Events\_\_Main::TAXONOMY, |
| [449](#L449) | 'hide\_empty' => false, |
| [450](#L450) | 'orderby'    => 'name', |
| [451](#L451) | ); |
| [452](#L452) |  |
| [453](#L453) | // add sort if enabled. |
| [454](#L454) | if ( 1 === absint( $add\_infos\_to\_tec\_options['fs\_sortierung\_categories'] ) ) { |
| [455](#L455) | $query['orderby'] = 'count'; |
| [456](#L456) | $query['order']   = 'DESC'; |
| [457](#L457) | } |
| [458](#L458) |  |
| [459](#L459) | // get the terms. |
| [460](#L460) | $ait\_terms = get\_terms( $query ); |
| [461](#L461) |  |
| [462](#L462) | // bail on error or if list is empty. |
| [463](#L463) | if ( empty( $ait\_terms ) || is\_wp\_error( $ait\_terms ) ) { |
| [464](#L464) | return array(); |
| [465](#L465) | } |
| [466](#L466) |  |
| [467](#L467) | // prepare array for the list. |
| [468](#L468) | $ait\_categories = array(); |
| [469](#L469) |  |
| [470](#L470) | // set counter to 0. |
| [471](#L471) | $ait\_counter = 0; |
| [472](#L472) |  |
| [473](#L473) | foreach ( $ait\_terms as $ait\_single\_term ) { |
| [474](#L474) | $ait\_categories[ $ait\_counter ]        = new stdClass(); |
| [475](#L475) | $ait\_categories[ $ait\_counter ]->text  = get\_term\_field( 'name', $ait\_single\_term ); |
| [476](#L476) | $ait\_categories[ $ait\_counter ]->value = get\_term\_field( 'name', $ait\_single\_term ); |
| [477](#L477) | ++$ait\_counter; |
| [478](#L478) | } |
| [479](#L479) |  |
| [480](#L480) | // return resulting list of categories. |
| [481](#L481) | return $ait\_categories; |
| [482](#L482) | } |
| [483](#L483) | add\_action( 'tribe\_events\_bar\_after\_template', 'ait\_categories' ); |
| [484](#L484) |  |
| [485](#L485) | /\*\* |
| [486](#L486) | \* Load color chooser. |
| [487](#L487) | \* |
| [488](#L488) | \* @return void |
| [489](#L489) | \*/ |
| [490](#L490) | function ait\_get\_color\_chooser(): void { |
| [491](#L491) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [492](#L492) | wp\_enqueue\_script( |
| [493](#L493) | 'ait-color-chooser', |
| [494](#L494) | plugins\_url( 'assets/js/ait\_script.js', \_\_FILE\_\_ ), |
| [495](#L495) | array( 'jquery', 'wp-color-picker' ), |
| [496](#L496) | AIT\_VERSION, |
| [497](#L497) | false |
| [498](#L498) | ); |
| [499](#L499) | } |
| [500](#L500) | add\_action( 'admin\_enqueue\_scripts', 'ait\_get\_color\_chooser' ); |
| [501](#L501) |  |
| [502](#L502) | /\*\* |
| [503](#L503) | \* Return path for events and suggest path if necessary. |
| [504](#L504) | \* |
| [505](#L505) | \* @return string |
| [506](#L506) | \*/ |
| [507](#L507) | function ait\_path\_for\_tec(): string { |
| [508](#L508) | // show default URL is TEC is not installed. |
| [509](#L509) | if ( ! ait\_tec\_installed() ) { |
| [510](#L510) | // The Events Calendar is not installed. |
| [511](#L511) | return 'http://that\_is\_my\_website/interesting\_post/'; |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | // get the list view link from tribe. |
| [515](#L515) | $ait\_path = tribe\_get\_listview\_link(); |
| [516](#L516) |  |
| [517](#L517) | // delete last. |
| [518](#L518) | $ait\_path     = substr( $ait\_path, 0, strlen( $ait\_path ) - 1 ); |
| [519](#L519) | $tec\_category = \_\_( 'category', 'the-events-calendar' ); |
| [520](#L520) | $tec\_category = strtolower( $tec\_category ); |
| [521](#L521) | // show the path without the kind of view. |
| [522](#L522) | return substr( $ait\_path, 0, strrpos( $ait\_path, '/' ) ) . '/' . $tec\_category . '/'; |
| [523](#L523) | } |
| [524](#L524) |  |
| [525](#L525) | /\*\* |
| [526](#L526) | \* Add setting link in plugin list. |
| [527](#L527) | \* |
| [528](#L528) | \* @param array $links List of links. |
| [529](#L529) | \* @return array |
| [530](#L530) | \*/ |
| [531](#L531) | function ait\_plugin\_settings\_link( array $links ): array { |
| [532](#L532) | // create the URL. |
| [533](#L533) | $url = add\_query\_arg( |
| [534](#L534) | array( |
| [535](#L535) | 'page' => 'ait\_add\_infos\_to\_tec\_settings\_page', |
| [536](#L536) | ), |
| [537](#L537) | get\_admin\_url() . 'options-general.php' |
| [538](#L538) | ); |
| [539](#L539) |  |
| [540](#L540) | // add the setting link. |
| [541](#L541) | $links[] = '<a href="' . esc\_url( $url ) . '">' . \_\_( 'Settings', 'add-infos-to-the-events-calendar' ) . '</a>'; |
| [542](#L542) |  |
| [543](#L543) | // return resulting links. |
| [544](#L544) | return $links; |
| [545](#L545) | } |
| [546](#L546) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename( \_\_FILE\_\_ ), 'ait\_plugin\_settings\_link' ); |
| [547](#L547) |  |
| [548](#L548) | /\*\* |
| [549](#L549) | \* Show settings page. |
| [550](#L550) | \* |
| [551](#L551) | \* @return void |
| [552](#L552) | \*/ |
| [553](#L553) | function ait\_add\_infos\_to\_tec\_settings\_page(): void { |
| [554](#L554) | // check that user has proper security level. |
| [555](#L555) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [556](#L556) | wp\_die( esc\_html\_\_( 'You do not have permissions to perform this action!', 'add-infos-to-the-events-calendar' ) ); |
| [557](#L557) | } |
| [558](#L558) |  |
| [559](#L559) | ?> |
| [560](#L560) | <div class="wrap"> |
| [561](#L561) | <h1><?php echo esc\_html\_\_( 'Add Infos to The Events Calendar', 'add-infos-to-the-events-calendar' ) . ' - ' . esc\_html\_\_( 'Version:', 'add-infos-to-the-events-calendar' ) . ' ' . esc\_html( AIT\_VERSION ); ?></h1> |
| [562](#L562) | <hr> |
| [563](#L563) |  |
| [564](#L564) | <form method="post" action="<?php echo esc\_url( get\_admin\_url() . 'options.php' ); ?>"> |
| [565](#L565) | <?php |
| [566](#L566) | // show the fields. |
| [567](#L567) | settings\_fields( 'add\_infos\_to\_tec\_settings-group' ); |
| [568](#L568) | do\_settings\_sections( 'add\_infos\_to\_tec\_settings-group' ); |
| [569](#L569) |  |
| [570](#L570) | // get plugin options from the database. |
| [571](#L571) | $add\_infos\_to\_tec\_options = get\_option( 'add\_infos\_to\_tec\_settings' ); |
| [572](#L572) |  |
| [573](#L573) | // set options if the options do not yet exist. |
| [574](#L574) | if ( empty( $add\_infos\_to\_tec\_options ) ) { |
| [575](#L575) | $add\_infos\_to\_tec\_options = array( |
| [576](#L576) | 'fs\_option\_pfad'                   => ait\_path\_for\_tec(), |
| [577](#L577) | 'fs\_hintergrundfarbe\_button'       => '#77BCC7', |
| [578](#L578) | 'fs\_vordergrundfarbe\_button'       => '#ffffff', |
| [579](#L579) | 'fs\_hover\_hintergrundfarbe\_button' => '#F9B81E', |
| [580](#L580) | 'fs\_hover\_vordergrundfarbe\_button' => '#ffffff', |
| [581](#L581) | 'fs\_runder\_button'                 => '5', |
| [582](#L582) | 'fs\_alle\_buttons'                  => '0', |
| [583](#L583) | 'fs\_schriftart'                    => '1', |
| [584](#L584) | 'fs\_linie\_oben'                    => '1', |
| [585](#L585) | 'fs\_linie\_unten'                   => '0', |
| [586](#L586) | 'fs\_bezeichnung\_externer\_link'     => 'Read More', |
| [587](#L587) | 'fs\_bezeichnung\_events\_link'       => 'More Events', |
| [588](#L588) | 'fs\_bezeichnung\_interner\_link'     => 'Read More on this website', |
| [589](#L589) | 'fs\_sortierung\_categories'         => '1', |
| [590](#L590) | ); |
| [591](#L591) | add\_option( 'add\_infos\_to\_tec\_settings', $add\_infos\_to\_tec\_options, '', 'no' ); |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) | // generate default values for not existing entries in the settings. |
| [595](#L595) | $add\_infos\_to\_tec\_options = ait\_set\_default\_settings( $add\_infos\_to\_tec\_options ); |
| [596](#L596) |  |
| [597](#L597) | // output. |
| [598](#L598) | ?> |
| [599](#L599) | <table class="form-table"> |
| [600](#L600) | <tr> |
| [601](#L601) | <?php |
| [602](#L602) | $tec\_path = ''; |
| [603](#L603) | if ( ait\_tec\_installed() ) { |
| [604](#L604) | // this should be the path to The Events Calendar. |
| [605](#L605) | $tec\_path = ait\_path\_for\_tec(); |
| [606](#L606) | ?> |
| [607](#L607) | <th colspan="2"> |
| [608](#L608) | <?php |
| [609](#L609) | echo esc\_html\_\_( 'This could be the path to the categories of The Events Calendar (TEC): ', 'add-infos-to-the-events-calendar' ) . '<strong style="color: #FF0000">' . esc\_url( $tec\_path ) . '</strong><br />'; |
| [610](#L610) | echo esc\_html\_\_( 'To be on the safe side, however, you should check this by going to the relevant event after using the shortcut and checking that the links are executed correctly.', 'add-infos-to-the-events-calendar' ); |
| [611](#L611) | ?> |
| [612](#L612) | </th> |
| [613](#L613) | </tr> |
| [614](#L614) | <tr> |
| [615](#L615) | <th scope="row"><label for="fs\_option\_pfad"><?php echo esc\_html\_\_( 'Path e.g. categories to The Events Calendar (e.g. http://example.com/events/category/):', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [616](#L616) | <?php |
| [617](#L617) | } else { |
| [618](#L618) | ?> |
| [619](#L619) | <th colspan="2"> |
| [620](#L620) | <?php |
| [621](#L621) | echo esc\_html\_\_( 'It seems that you do not use The Events Calendar. However, you can still use this plugin and enter a URL on your website that is particularly important to you. This URL will be used instead.', 'add-infos-to-the-events-calendar' ); |
| [622](#L622) | ?> |
| [623](#L623) | </th> |
| [624](#L624) | </tr> |
| [625](#L625) | <tr> |
| [626](#L626) | <th scope="row"><label for="fs\_option\_pfad"><?php echo esc\_html\_\_( 'Enter a URL on your website that is particularly important to you:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [627](#L627) | <?php |
| [628](#L628) | } |
| [629](#L629) | ?> |
| [630](#L630) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_option\_pfad]" class="widefat" id="fs\_option\_pfad" value="<?php echo esc\_url\_raw( $add\_infos\_to\_tec\_options['fs\_option\_pfad'] ); ?>" /></td> |
| [631](#L631) | </tr> |
| [632](#L632) |  |
| [633](#L633) | <tr> |
| [634](#L634) | <th colspan="2"><h3><?php echo esc\_html\_\_( 'Settings for Buttons:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [635](#L635) | </tr> |
| [636](#L636) | <tr> |
| [637](#L637) | <th><label for="fs\_hintergrundfarbe\_button"><?php echo esc\_html\_\_( 'Background color:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [638](#L638) | <td><input type="text" id="fs\_hintergrundfarbe\_button" name="add\_infos\_to\_tec\_settings[fs\_hintergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hintergrundfarbe\_button'] ); ?>" class="color" /></td> |
| [639](#L639) | </tr> |
| [640](#L640) | <tr> |
| [641](#L641) | <th><label for="fs\_vordergrundfarbe\_button"><?php echo esc\_html\_\_( 'Font color:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [642](#L642) | <td><input type="text" id="fs\_vordergrundfarbe\_button" name="add\_infos\_to\_tec\_settings[fs\_vordergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_vordergrundfarbe\_button'] ); ?>" class="color" /></td> |
| [643](#L643) | </tr> |
| [644](#L644) |  |
| [645](#L645) | <tr> |
| [646](#L646) | <th><label for="fs\_hover\_hintergrundfarbe\_button"><?php echo esc\_html\_\_( 'Background color when driving over the button (Hover):', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [647](#L647) | <td><input type="text" id="fs\_hover\_hintergrundfarbe\_button" name="add\_infos\_to\_tec\_settings[fs\_hover\_hintergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_hintergrundfarbe\_button'] ); ?>" class="color" /></td> |
| [648](#L648) | </tr> |
| [649](#L649) |  |
| [650](#L650) | <tr> |
| [651](#L651) | <th><label for="fs\_hover\_vordergrundfarbe\_button"><?php echo esc\_html\_\_( 'Font color when driving over the button (Hover):', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [652](#L652) | <td><input type="text" id="fs\_hover\_vordergrundfarbe\_button" name="add\_infos\_to\_tec\_settings[fs\_hover\_vordergrundfarbe\_button]" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_hover\_vordergrundfarbe\_button'] ); ?>" class="color" /></td> |
| [653](#L653) | </tr> |
| [654](#L654) |  |
| [655](#L655) | <tr> |
| [656](#L656) | <th><label for="fs\_bezeichnung\_externer\_link"><?php echo esc\_html\_\_( 'Description for external link:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [657](#L657) | <td><input type="text" id="fs\_bezeichnung\_externer\_link" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_externer\_link]" class="widefat" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_externer\_link'] ); ?>" /></td> |
| [658](#L658) | </tr> |
| [659](#L659) |  |
| [660](#L660) | <tr> |
| [661](#L661) | <?php |
| [662](#L662) | // The Events Calendar installed. |
| [663](#L663) | if ( ! empty( $tec\_path ) ) { |
| [664](#L664) | ?> |
| [665](#L665) | <th><?php echo esc\_html\_\_( 'Description for events:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [666](#L666) | <?php |
| [667](#L667) | } else { |
| [668](#L668) | ?> |
| [669](#L669) | <th><?php echo esc\_html\_\_( 'Description for particularly link:', 'add-infos-to-the-events-calendar' ); ?></th> |
| [670](#L670) | <?php |
| [671](#L671) | } |
| [672](#L672) | ?> |
| [673](#L673) | <td><input type="text" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_events\_link]" class="widefat" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_events\_link'] ); ?>" /></td> |
| [674](#L674) | </tr> |
| [675](#L675) |  |
| [676](#L676) | <tr> |
| [677](#L677) | <th><label for="fs\_bezeichnung\_interner\_link"><?php echo esc\_html\_\_( 'Description for internal link:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [678](#L678) | <td><input type="text" id="fs\_bezeichnung\_interner\_link" name="add\_infos\_to\_tec\_settings[fs\_bezeichnung\_interner\_link]" class="widefat" value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_bezeichnung\_interner\_link'] ); ?>" /></td> |
| [679](#L679) | </tr> |
| [680](#L680) |  |
| [681](#L681) | <tr> |
| [682](#L682) | <th><h3><?php echo esc\_html\_\_( 'Setting for design on website:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [683](#L683) | </tr> |
| [684](#L684) |  |
| [685](#L685) | <tr> |
| [686](#L686) | <th><label for="fs\_runder\_button"><?php echo esc\_html\_\_( 'Rounded corners (values from 0 - 30):', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [687](#L687) | <td><input type="number" id="fs\_runder\_button" min="0" max="30" step="1" name="add\_infos\_to\_tec\_settings[fs\_runder\_button]" size=2 value="<?php echo esc\_attr( $add\_infos\_to\_tec\_options['fs\_runder\_button'] ); ?>" /></td> |
| [688](#L688) | </tr> |
| [689](#L689) |  |
| [690](#L690) |  |
| [691](#L691) | <tr> |
| [692](#L692) | <th><label for="fs\_alle\_buttons"><?php echo esc\_html\_\_( 'All links as buttons:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [693](#L693) | <td><input type="checkbox" id="fs\_alle\_buttons" name="add\_infos\_to\_tec\_settings[fs\_alle\_buttons]" value="1" <?php echo esc\_attr( checked( $add\_infos\_to\_tec\_options['fs\_alle\_buttons'], 1, true ) ); ?> /> |
| [694](#L694) | </tr> |
| [695](#L695) |  |
| [696](#L696) | <tr> |
| [697](#L697) | <th><label for="fs\_schriftart"><?php echo esc\_html\_\_( 'Font for Copyright:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [698](#L698) | <td><input type="radio" id="fs\_schriftart" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="1" <?php echo esc\_attr( checked( 1, $add\_infos\_to\_tec\_options['fs\_schriftart'], true ) ); ?>><?php echo esc\_html\_\_( 'italic', 'add-infos-to-the-events-calendar' ); ?> |
| [699](#L699) | <input type="radio" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="2" <?php echo esc\_attr( checked( 2, $add\_infos\_to\_tec\_options['fs\_schriftart'], true ) ); ?>><?php echo esc\_html\_\_( 'bold', 'add-infos-to-the-events-calendar' ); ?> |
| [700](#L700) | <input type="radio" name="add\_infos\_to\_tec\_settings[fs\_schriftart]" value="3" <?php echo esc\_attr( checked( 3, $add\_infos\_to\_tec\_options['fs\_schriftart'], true ) ); ?>><?php echo esc\_html\_\_( 'normal', 'add-infos-to-the-events-calendar' ); ?> |
| [701](#L701) | </td> |
| [702](#L702) | </tr> |
| [703](#L703) |  |
| [704](#L704) | <tr> |
| [705](#L705) | <th><label for="fs\_linie\_oben"><?php echo esc\_html\_\_( 'Horizontal line above the block:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [706](#L706) | <td><input type="checkbox" id="fs\_linie\_oben" name="add\_infos\_to\_tec\_settings[fs\_linie\_oben]" value="1" <?php echo esc\_attr( checked( $add\_infos\_to\_tec\_options['fs\_linie\_oben'], 1, true ) ); ?> /> |
| [707](#L707) | </tr> |
| [708](#L708) |  |
| [709](#L709) | <tr> |
| [710](#L710) | <th><label for="fs\_linie\_unten"><?php echo esc\_html\_\_( 'Horizontal line below the block:', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [711](#L711) | <td><input type="checkbox" id="fs\_linie\_unten" name="add\_infos\_to\_tec\_settings[fs\_linie\_unten]" value="1" <?php echo esc\_attr( checked( $add\_infos\_to\_tec\_options['fs\_linie\_unten'], 1, true ) ); ?> /> |
| [712](#L712) | </tr> |
| [713](#L713) |  |
| [714](#L714) | <?php |
| [715](#L715) | // The Events Calendar installed. |
| [716](#L716) | if ( ! empty( $tec\_path ) ) { |
| [717](#L717) | ?> |
| [718](#L718) | <tr> |
| [719](#L719) | <th colspan="2"><h3><?php echo esc\_html\_\_( 'Further Settings:', 'add-infos-to-the-events-calendar' ); ?></h3></th> |
| [720](#L720) | </tr> |
| [721](#L721) |  |
| [722](#L722) | <tr> |
| [723](#L723) | <th><label for="fs\_sortierung\_categories"><?php echo esc\_html\_\_( 'Sorting categories by occurrence (Frequently selected categories first):', 'add-infos-to-the-events-calendar' ); ?></label></th> |
| [724](#L724) | <td><input type="checkbox" id="fs\_sortierung\_categories" name="add\_infos\_to\_tec\_settings[fs\_sortierung\_categories]" value="1" <?php echo esc\_attr( checked( $add\_infos\_to\_tec\_options['fs\_sortierung\_categories'], 1, true ) ); ?> /> |
| [725](#L725) | </tr> |
| [726](#L726) | <?php |
| [727](#L727) | } |
| [728](#L728) | ?> |
| [729](#L729) | </table> |
| [730](#L730) | <?php |
| [731](#L731) | submit\_button(); |
| [732](#L732) | ?> |
| [733](#L733) | </form> |
| [734](#L734) | </div> |
| [735](#L735) | <?php |
| [736](#L736) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php?rev=3205090&format=txt)
* [Original Format](/export/3205090/add-infos-to-the-events-calendar/tags/1.5.0/add-infos-to-the-events-calendar.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


