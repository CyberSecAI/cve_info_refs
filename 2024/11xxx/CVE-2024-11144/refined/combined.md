=== Content from www.blackduck.com_1df6c6fb_20250114_202856.html ===


The Synopsys Software Integrity Group is now Black Duck®. [Learn More](/blog/our-new-beginning-as-black-duck.html)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)

[Build trust in your software](/)

* [Support](https://community.blackduck.com)
* English
* 日本語
* 简体中文

close search bar

Sorry, not available in this language yet

close language selection

* English
* 日本語

* [Manage Security Risks](/blog/category.manage-security-risks.html)
* [Build Security into DevOps](/blog/category.build-secure-software.html)
* [Secure the Software Supply Chain](/blog/category.software-supply-chain.html)
* [Security News & Trends](/blog/category.security-news-research.html)
* [Contact Sales](/contact-sales.html)

* [Blog Home](/blog.html)

# CyRC Vulnerability Advisory: CVE-2024-11144 Race condition with LightFTP

[Kari Hulkko](/blog/authors/kari-hulkko.html)

Dec 12, 2024
/
1 min read

Table of Contents

* Overview
* Exploitation
* Affected software
* Impact
* Remediation
* Discovery credit
* Timeline
* About CVSS

## Subscribe

## Overview

The Black Duck Cybersecurity Research Center (CyRC) has identified problems in LightFTP, a small x86-32/x64 FTP Server available under BSD 2-Clause license on <https://github.com/hfiref0x/LightFTP>.

The server lacks thread safety and can be crashed by anomalous data sent by an anonymous user from a remote network. The crash causes the FTP service to become unavailable, affecting all users and processes that rely on it for file transfers. If the crash occurs during file upload or download, it could lead to incomplete file transfers, potentially corrupting data. The repeated crash might also affect the stability of the underlying system, especially if it leads to resource leaks or affects other services.

## Exploitation

Problem is with the race condition on worker thread cleanup: <https://github.com/hfiref0x/LightFTP/blob/master/Source/ftpserv.c#L240>

err = pthread\_join(context->WorkerThreadId, &retv);

The section is not protected by a mutex, and the context is shared within the program. There is a two-second sleep before the join, and during the sleep, *context->WorkerThreadId* is changed, leading to a segmentation fault on *pthread\_join()* and resulting in server termination. When *pthread\_join()* is called, *context->WorkerThreadValid* is set to -1, but this is not checked by the caller.

The crash can be triggered for example with following sequence:

![CyRC LightFTP test case view](/blog/cyrc-advisory-LightFTP/_jcr_content/root/synopsyscontainer/synopsyscontainer/column_copy/colRight/anchor_copy_1359246988/anchorContent/image.coreimg.png/1734103511278/cyrc-advisory-lightftp.png "CyRC LightFTP test case view")

##

The anomaly in the EPRT command initiates cleanup and setting up a new connection during this cleanup triggers the vulnerability. This can be reproduced with an anonymous user and multiple different sequences that trigger the same race condition.

## Affected software

LightFTP version 2.3. The vulnerability was introduced while the project was fixing another vulnerability: <https://nvd.nist.gov/vuln/detail/CVE-2023-24042>.

## Impact

**CVSS 3.1 base score:** **7.5 (High)**

**CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H**

## Remediation

**Update to LightFTP version 2.3.1**

## Discovery credit

Kari Hulkko from the CyRC discovered these vulnerabilities by using the [Defensics® fuzz testing tool](/fuzz-testing/defensics.html) with [FTP Server protocol test suites](/fuzz-testing/defensics/protocols/ftp-server.html).

## Timeline

* **April 25, 2024:**Initial disclosure
* **May 9, 2024:**       Project maintainer confirms the issue
* **June 21, 2024:**    Fix received
* **June 24, 2024:**    Fix verified with Defensics
* **June 30, 2024:**    Patch integrated into master and new release published
* **December 11, 2024:** Advisory published by Black Duck

## About CVSS

FIRST.Org, Inc (FIRST) is a non-profit organization based out of US that owns and manages CVSS. It is not required to be a member of FIRST to utilize or implement CVSS but FIRST does require any individual or organization give appropriate attribution while using CVSS. FIRST also states that any individual or organization that publishes scores follow the guideline so that anyone can understand how the score was calculated.

* [CyRC](/blog/category.cyrc.html "CyRC")
* [Fuzzing](/blog/category.fuzzing.html "Fuzzing")

## Continue Reading

[![Overcome AST noise to find and fix software vulnerabilities](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/overcome-ast-noise-fix-vulns.jpg)](/blog/overcome-ast-noise-find-fix-software-vulnerabilities.html "Overcome AST noise to find and fix software vulnerabilities")

#### [Overcome AST noise to find and fix software vulnerabilities](/blog/overcome-ast-noise-find-fix-software-vulnerabilities.html)

![Steven Zimmerman](/content/dam/black-duck/blogs/application-security/authors/Steven-Zimmerman.jpg)

By
[Steven Zimmerman](/blog/authors/steven-zimmerman.html)

Jan 06, 2025
/
6 min read

Tags:
[Agile, CI/CD](/blog/category.agile-ci-cd.html),
[Build Security into DevOps](/blog/category.build-secure-software.html),
[DevSecOps](/blog/category.devsecops.html)

[![Artificial intelligence widens the gap between security and development](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/global-devsecops-ai-widens-gap.png)](/blog/artificial-intelligence-widens-gap-between-security-development.html "Artificial intelligence widens the gap between security and development")

#### [Artificial intelligence widens the gap between security and development](/blog/artificial-intelligence-widens-gap-between-security-development.html)

![Steven Zimmerman](/content/dam/black-duck/blogs/application-security/authors/Steven-Zimmerman.jpg)

By
[Steven Zimmerman](/blog/authors/steven-zimmerman.html)

Dec 02, 2024
/
7 min read

Tags:
[Artificial Intelligence](/blog/category.artificial-intelligence.html),
[Build Security into DevOps](/blog/category.build-secure-software.html),
[DevSecOps](/blog/category.devsecops.html)

[![Key insights from Black Duck’s 2024 Global State of DevSecOps report](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/global-state-devsecops-thumbnail.jpg)](/blog/black-duck-devsecops-report.html "Key insights from Black Duck’s 2024 Global State of DevSecOps report")

#### [Key insights from Black Duck’s 2024 Global State of DevSecOps report](/blog/black-duck-devsecops-report.html)

![Fred Bals](/content/dam/black-duck/blogs/application-security/authors/Fred-Bals.jpg)

By
[Fred Bals](/blog/authors/fred-bals.html)

Oct 08, 2024
/
5 min read

Tags:
[Security News & Trends](/blog/category.security-news-research.html),
[DevSecOps](/blog/category.devsecops.html)

[![Top 4 software development methodologies](https://www.blackduck.com/content/dam/black-duck/blogs/thumbnails/blackduck-logo-thumbnail.svg)](/blog/top-4-software-development-methodologies.html "Top 4 software development methodologies")

#### [Top 4 software development methodologies](/blog/top-4-software-development-methodologies.html)

![Mike McGuire](/content/dam/black-duck/blogs/application-security/authors/Mike-McGuire.jpg)

By
[Mike McGuire](/blog/authors/mike-mcguire.html)

Mar 24, 2024
/
5 min read

Tags:
[Agile, CI/CD](/blog/category.agile-ci-cd.html),
[Build Security into DevOps](/blog/category.build-secure-software.html),
[DevSecOps](/blog/category.devsecops.html)

[![The integrated DevSecOps playbook: Steps for successful DevSecOps](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/devsecops-playbook.jpg)](/blog/devsecops-playbook-tips-for-successful-devsecops.html "The integrated DevSecOps playbook: Steps for successful DevSecOps")

#### [The integrated DevSecOps playbook: Steps for successful DevSecOps](/blog/devsecops-playbook-tips-for-successful-devsecops.html)

![Steven Zimmerman](/content/dam/black-duck/blogs/application-security/authors/Steven-Zimmerman.jpg)

By
[Steven Zimmerman](/blog/authors/steven-zimmerman.html)

Mar 03, 2024
/
4 min read

Tags:
[Build Security into DevOps](/blog/category.build-secure-software.html),
[DevSecOps](/blog/category.devsecops.html)

[![The cybersecurity landscape - A discussion of future state and AI with Dr. Lisa Bradley](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/build-security-in.jpg)](/blog/building-security-in-podcast-cybersecurity-and-ai.html "The cybersecurity landscape - A discussion of future state and AI with Dr. Lisa Bradley")

#### [The cybersecurity landscape - A discussion of future state and AI with Dr. Lisa Bradley](/blog/building-security-in-podcast-cybersecurity-and-ai.html)

By
Sammy Migues

Feb 21, 2024
/
1 min read

Tags:
[Artificial Intelligence](/blog/category.artificial-intelligence.html),
[Build Security into DevOps](/blog/category.build-secure-software.html),
[DevSecOps](/blog/category.devsecops.html)

##

## Explore Topics

[Agile, CI/CD](/blog/category.agile-ci-cd.html)
[AppSec Best Practices](/blog/category.appsec-best-practices.html)
[Artificial Intelligence](/blog/category.artificial-intelligence.html)
[Automotive](/blog/category.automotive.html)
[Build Security into DevOps](/blog/category.build-secure-software.html)
[Cloud Security](/blog/category.cloud-security.html)
[Compliance](/blog/category.compliance.html)
[Container Security](/blog/category.container-security.html)
[CyRC](/blog/category.cyrc.html)
[DevSecOps](/blog/category.devsecops.html)
[DAST](/blog/category.dast.html)
[Financial Services](/blog/category.financial-services.html)
[Fuzzing](/blog/category.fuzzing.html)
[Healthcare](/blog/category.healthcare.html)
[IAST](/blog/category.iast.html)
[Internet of Things](/blog/category.iot.html)
[M&A](/blog/category.m-a.html)
[Manage Security Risks](/blog/category.manage-security-risks.html)
[Medical Devices](/blog/category.medical-devices.html)
[Mobile](/blog/category.mobile.html)
[Orchestration & Correlation](/blog/category.orchestration-correlation.html)
[OSS License Compliance](/blog/category.oss-license-compliance.html)
[Pen Testing](/blog/category.pen-testing.html)
[Program Strategy & Planning](/blog/category.program-strategy-planning.html)
[Public Sector](/blog/category.public-sector.html)
[SAST](/blog/category.sast.html)
[SCA](/blog/category.sca.html)
[Secure the Software Supply Chain](/blog/category.software-supply-chain.html)
[Security News & Trends](/blog/category.security-news-research.html)
[Threat Modeling](/blog/category.threat-modeling.html)
[Threat & Risk Assessment](/blog/category.threat-risk-assessment.html)
[Training](/blog/category.training.html)
[Web Application Security](/blog/category.web-appsec.html)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)
### Follow

[Manage Email Preferences](https://go.blackduck.com/email-subscription-center.html)

Manage Cookie Settings

 [800 District Ave. Ste 201
Burlington, MA 01803](https://www.google.com/maps/place/800%2BDistrict%2BAve%2B%23101%2C%2BBurlington%2C%2BMA%2B01803/%4042.4824129%2C-71.28993%2C12z/data%3D%214m5%213m4%211s0x89e39e3082ec0bb9%3A0x4f2eda58614dd0d9%218m2%213d42.482409%214d-71.2075325?entry=ttu)

[Contact Us](/contact-sales.html)

### Solutions

* [AI-generated Code](/solutions/artificial-intelligence-software-development.html)
* [API Security Testing](/solutions/api-security-testing.html)
* [AppSec Consolidation](/solutions/appsec-consolidation.html)
* [Application Security Testing](/solutions/application-security-testing.html)
* [DevSecOps](/solutions/devsecops.html)
* [Software Supply Chain Security](/solutions/software-supply-chain-security.html)
* [Manage AppSec Risk](/solutions/enterprise-application-security-risk-management.html)
* [Cloud & Container Security](/solutions/cloud-security.html)
* [Open Source License Compliance](/solutions/open-source-security.html)
* [M&A Due Diligence](/solutions/mergers-and-acquisitions.html)
* [Quality & Security Standards Compliance](/solutions/compliance.html)

### Products & Services

* [AppSec SaaS Platform](/platform.html)
* [Static Analysis (SAST)](/static-analysis-tools-sast.html)
* [Software Composition Analysis (SCA)](/software-composition-analysis-tools.html)
* [Interactive Analysis (IAST)](/interactive-application-security-testing.html)
* [Dynamic Analysis (DAST)](/dast.html)
* [Penetration Testing](/services/penetration-testing.html)
* [Protocol Fuzzing](/fuzz-testing.html)
* [AppSec Program Services](/services/security-program.html)
* [Threat & Risk Assessments](/services/security-program/software-architecture-design.html)

### Support

* [Community](https://community.blackduck.com/)
* [Documentation](https://documentation.blackduck.com)
* [Product Education](https://blackduck.skilljar.com/)
* [AppSec Training](/training.html)
* [Add-On Services](/customer-success.html)

### Resources

* [Resources Center](/resources.html)
* [Webinars](/resources/webinars.html)
* [Demos](/contact-sales.html)
* [Research & Reports](/resources/analyst-reports.html)
* [eBooks](/resources/ebooks.html)
* [White Papers](/resources/white-papers.html)
* [Blog](/blog.html)

### Explore more

* [About us](/company.html)
* [Contact sales](/contact-sales.html)
* [Customer stories](/resources/case-studies.html)
* [Partners](/partners.html)
* [Newsroom](https://news.blackduck.com)
* [Careers](/company/careers.html)
* [Glossary](/glossary.html)

### Legal

* [Agreements](/company/legal.html)
* [Privacy](/company/legal/privacy-policy.html)
* [Security](/company/legal/vulnerability-disclosure-policy.html)

©2025 Black Duck Software, Inc. All Rights Reserved


