=== Content from plugins.trac.wordpress.org_0b4a9e42_20250114_202644.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fplezi%2Ftrunk%2Fincludes%2Fplz-admin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/plezi/trunk/includes/plz-admin.php?rev=3209502 "Revision 3209502")
* Next Revision →
* [Blame](/browser/plezi/trunk/includes/plz-admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/plezi/trunk/includes/plz-admin.php)

---

# [source:](/browser?order=name "Go to repository root") [plezi](/browser/plezi?order=name "View plezi")/[trunk](/browser/plezi/trunk?order=name "View trunk")/[includes](/browser/plezi/trunk/includes?order=name "View includes")/[plz-admin.php](/browser/plezi/trunk/includes/plz-admin.php?order=name "View plz-admin.php")

View diff against:

View revision:

| [Last change](/changeset/3210983/plezi/trunk/includes/plz-admin.php "View differences") on this file was [3210983](/changeset/3210983/ "View changeset 3210983"), checked in by webwaveofficial, [4 weeks ago](/timeline?from=2024-12-20T11%3A06%3A33Z&precision=second "See timeline at 12/20/2024 11:06:33 AM") |
| --- |
| Upgrade plugin version to 1.0.8 |
| **File size:** 34.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | if ( ! function\_exists( 'plz\_settings\_link' ) ) : |
| [3](#L3) | function plz\_settings\_link( $links ) { |
| [4](#L4) | $signup\_url = 'https://enjoy.plezi.co/signup?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=wp-plugins-list'; |
| [5](#L5) | $settings\_url = esc\_url( |
| [6](#L6) | add\_query\_arg( |
| [7](#L7) | 'page', |
| [8](#L8) | 'plezi-for-wordpress-configuration.php', |
| [9](#L9) | get\_admin\_url() . 'admin.php' |
| [10](#L10) | ) |
| [11](#L11) | ); |
| [12](#L12) |  |
| [13](#L13) | $signup = '<a href="' . $signup\_url . '" title="' . \_\_( 'Signup', 'plezi' ) . '" target="\_blank">' . \_\_( 'Signup', 'plezi' ) . '</a>'; |
| [14](#L14) | $settings = '<a href="' . $settings\_url . '" title="' . \_\_( 'Settings', 'plezi' ) . '">' . \_\_( 'Settings', 'plezi' ) . '</a>'; |
| [15](#L15) |  |
| [16](#L16) | array\_unshift( $links, $signup ); |
| [17](#L17) | array\_unshift( $links, $settings ); |
| [18](#L18) |  |
| [19](#L19) | return $links; |
| [20](#L20) | } |
| [21](#L21) | endif; |
| [22](#L22) |  |
| [23](#L23) | if ( ! function\_exists( 'plz\_add\_pages' ) ) : |
| [24](#L24) | function plz\_add\_pages() { |
| [25](#L25) | if ( current\_user\_can( 'manage\_options' ) ) : |
| [26](#L26) | add\_menu\_page( \_\_( 'Plezi', 'plezi' ), \_\_( 'Plezi', 'plezi' ), 'manage\_options', 'plezi-for-wordpress-configuration.php', '', plugin\_dir\_url( \_\_DIR\_\_ ) . 'images/ico\_logo.svg', 26 ); |
| [27](#L27) | add\_submenu\_page( 'plezi-for-wordpress-configuration.php', \_\_( 'Setup', 'plezi' ), \_\_( 'Setup', 'plezi' ), 'manage\_options', 'plezi-for-wordpress-configuration.php', 'plz\_admin\_configuration', 1 ); |
| [28](#L28) | add\_submenu\_page( 'plezi-for-wordpress-configuration.php', \_\_( 'Forms', 'plezi' ), \_\_( 'Forms', 'plezi' ), 'manage\_options', 'plezi-for-wordpress-forms.php', 'plz\_admin\_forms', 2 ); |
| [29](#L29) | add\_submenu\_page( 'plezi-for-wordpress-configuration.php', \_\_( 'FAQ', 'plezi' ), \_\_( 'FAQ', 'plezi' ), 'manage\_options', 'plezi-for-wordpress-faq.php', 'plz\_admin\_faq', 3 ); |
| [30](#L30) | endif; |
| [31](#L31) | } |
| [32](#L32) | endif; |
| [33](#L33) |  |
| [34](#L34) | if ( ! function\_exists( 'plz\_admin\_configuration' ) ) : |
| [35](#L35) | function plz\_admin\_configuration() { |
| [36](#L36) | if ( ! current\_user\_can( 'manage\_options' ) ) : |
| [37](#L37) | wp\_die( esc\_attr\_\_( 'You do not have sufficient permissions to access this page.', 'plezi' ) ); |
| [38](#L38) | endif; |
| [39](#L39) |  |
| [40](#L40) | $options = get\_option( 'plz\_configuration\_authentification\_options' ); |
| [41](#L41) | $check\_tracker = plz\_get\_tracking\_enable\_mode(); |
| [42](#L42) |  |
| [43](#L43) | if ( ! isset( $options['plz\_authentification\_status'] ) || empty( $options['plz\_authentification\_status'] ) || '0' === $options['plz\_authentification\_status'] ) : |
| [44](#L44) | $tab\_authentification\_status = 'status-disable'; |
| [45](#L45) | $plz\_class\_get\_authentification = ''; |
| [46](#L46) | $plz\_class\_remove\_authentification = 'plz-hidden'; |
| [47](#L47) | else : |
| [48](#L48) | $tab\_authentification\_status = 'status-enable'; |
| [49](#L49) | $plz\_class\_get\_authentification = 'plz-hidden'; |
| [50](#L50) | $plz\_class\_remove\_authentification = ''; |
| [51](#L51) | endif; |
| [52](#L52) |  |
| [53](#L53) | if ( $check\_tracker ) : |
| [54](#L54) | $tab\_tracking\_status = 'status-enable'; |
| [55](#L55) | else : |
| [56](#L56) | $tab\_tracking\_status = 'status-disable'; |
| [57](#L57) | endif; |
| [58](#L58) |  |
| [59](#L59) | echo '<div class="plz-loader"><div class="plz-lds-dual-ring"></div></div>'; |
| [60](#L60) | echo '<div class="wrap plezi-wrap-page">'; |
| [61](#L61) | echo '<h1><strong>' . esc\_attr\_\_( 'Setup', 'plezi' ) . '</strong></h1>'; |
| [62](#L62) | echo '<div class="plezi-wrap-page-row">'; |
| [63](#L63) | echo '<div class="plezi-left-column">'; |
| [64](#L64) | echo '<ul class="plezi-tabs-buttons">'; |
| [65](#L65) | echo '<li class="active"><span class="status ' . esc\_attr( $tab\_authentification\_status ) . '"></span><a href="#" title="' . esc\_attr\_\_( 'API connexion', 'plezi' ) . '" data-tab="authentification">' . esc\_attr\_\_( 'API Connexion', 'plezi' ) . '</a></li>'; |
| [66](#L66) | echo '<li><span class="status ' . esc\_attr( $tab\_tracking\_status ) . '"></span><a href="#" title="' . esc\_attr\_\_( 'Tracking', 'plezi' ) . '" data-tab="tracking">' . esc\_attr\_\_( 'Tracking', 'plezi' ) . '</a></li>'; |
| [67](#L67) | echo '</ul>'; |
| [68](#L68) | echo '</div>'; |
| [69](#L69) | echo '<div class="plezi-right-column">'; |
| [70](#L70) | echo '<div id="authentification" class="plezi-tab-content">'; |
| [71](#L71) | echo '<form id="plezi-configuration-authentification-form" method="post" action="options.php">'; |
| [72](#L72) |  |
| [73](#L73) | settings\_fields( 'plz\_configuration\_authentification\_options' ); |
| [74](#L74) | do\_settings\_sections( 'plezi-for-wordpress-configuration-authentification.php' ); |
| [75](#L75) | submit\_button( \_\_( 'Connect', 'plezi' ), 'plz-submit-button ' . $plz\_class\_get\_authentification, 'submit', false, array( 'id' => 'plezi-get-authentification' ) ); |
| [76](#L76) | submit\_button( \_\_( 'Logout', 'plezi' ), 'plz-submit-button plz-logout-button ' . $plz\_class\_remove\_authentification, 'submit', false, array( 'id' => 'plezi-remove-authentification' ) ); |
| [77](#L77) |  |
| [78](#L78) | echo '</form>'; |
| [79](#L79) | echo '</div>'; |
| [80](#L80) | echo '<div id="tracking" class="plezi-tab-content">'; |
| [81](#L81) | echo '<form id="plezi-configuration-tracking-form" method="post" action="options.php">'; |
| [82](#L82) |  |
| [83](#L83) | settings\_fields( 'plz\_configuration\_tracking\_options' ); |
| [84](#L84) | do\_settings\_sections( 'plezi-for-wordpress-configuration-tracking.php' ); |
| [85](#L85) |  |
| [86](#L86) | echo '</form>'; |
| [87](#L87) | echo '</div>'; |
| [88](#L88) | echo '</div>'; |
| [89](#L89) | echo '</div>'; |
| [90](#L90) | echo '</div>'; |
| [91](#L91) | } |
| [92](#L92) | endif; |
| [93](#L93) |  |
| [94](#L94) | if ( ! function\_exists( 'plz\_admin\_forms' ) ) : |
| [95](#L95) | function plz\_admin\_forms() { |
| [96](#L96) | if ( ! current\_user\_can( 'manage\_options' ) ) : |
| [97](#L97) | wp\_die( esc\_attr\_\_( 'You do not have sufficient permissions to access this page.', 'plezi' ) ); |
| [98](#L98) | endif; |
| [99](#L99) |  |
| [100](#L100) | $options = get\_option( 'plz\_configuration\_authentification\_options' ); |
| [101](#L101) |  |
| [102](#L102) | echo '<div class="wrap plezi-wrap-page">'; |
| [103](#L103) | echo '<h1><strong>' . esc\_attr\_\_( 'Forms', 'plezi' ) . '</strong></h1>'; |
| [104](#L104) | echo '<div class="plezi-wrap-page-content">'; |
| [105](#L105) |  |
| [106](#L106) | if ( ! isset( $options['plz\_authentification\_status'] ) || empty( $options['plz\_authentification\_status'] ) || '0' === $options['plz\_authentification\_status'] ) : |
| [107](#L107) | $setup = admin\_url( 'admin.php?page=plezi-for-wordpress-configuration.php' ); |
| [108](#L108) |  |
| [109](#L109) | echo '<div class="plezi-wrap-page-content-introduction">'; |
| [110](#L110) | echo '<p>' . esc\_attr\_\_( 'To add your Plezi forms onto your pages, you need to connect Plezi to your WordPress account.', 'plezi' ) . '</p>'; |
| [111](#L111) | echo '<a class="plezi-btn-purple" href="' . esc\_url( $setup ) . '" title="' . esc\_attr\_\_( 'Connect with API', 'plezi' ) . '">'; |
| [112](#L112) | echo esc\_attr\_\_( 'Connect', 'plezi' ); |
| [113](#L113) | echo '</a>'; |
| [114](#L114) | echo '</div>'; |
| [115](#L115) | else : |
| [116](#L116) | $forms\_list\_table = new PLZ\_List\_Forms(); |
| [117](#L117) |  |
| [118](#L118) | $forms\_list\_table->prepare\_items(); |
| [119](#L119) |  |
| [120](#L120) | if ( $forms\_list\_table && isset( $forms\_list\_table->items ) ) : |
| [121](#L121) | echo '<div class="plezi-wrap-page-content-introduction">'; |
| [122](#L122) | echo '<p>' . esc\_attr\_\_( 'If you use Elementor, Gutenberg or Divi, that\'s fantastic! You’ll find a Plezi Form widget, directly in your page editor. Otherwise, you can copy your form\'s shortcode here and paste it once you get to your page\'s edition.', 'plezi' ) . '</p>'; |
| [123](#L123) | echo '<div class="plz-forms-notice">'; |
| [124](#L124) | echo '<p>' . esc\_attr\_\_( 'To follow your website performance, go check out your dashboard in Plezi.', 'plezi' ) . '</p>'; |
| [125](#L125) | echo '<a href="https://enjoy.plezi.co/dashboard?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=forms-page" title="' . esc\_attr\_\_( 'Go to dashboard', 'plezi' ) . '" target="\_blank" class="plezi-btn-purple">' . esc\_attr\_\_( 'Go to dashboard', 'plezi' ) . '</a>'; |
| [126](#L126) | echo '</div>'; |
| [127](#L127) | echo '<form class="plz-forms-list" method="post">'; |
| [128](#L128) |  |
| [129](#L129) | $forms\_list\_table->display(); |
| [130](#L130) |  |
| [131](#L131) | echo '</form>'; |
| [132](#L132) | echo '</div>'; |
| [133](#L133) | echo '<div id="plz-popup-preview-wrapper">'; |
| [134](#L134) | echo '<div id="plz-popup-preview">'; |
| [135](#L135) | echo '<a class="plz-popup-close" href="#" title="' . esc\_attr\_\_( 'Close the popup', 'plezi' ) . '">×</a>'; |
| [136](#L136) | echo '<div class="plz-popup-content">'; |
| [137](#L137) | echo '<div class="plz-lds-dual-ring"></div>'; |
| [138](#L138) | echo '</div>'; |
| [139](#L139) | echo '</div>'; |
| [140](#L140) | echo '</div>'; |
| [141](#L141) | else : |
| [142](#L142) | echo '<div class="plezi-wrap-page-content-introduction plezi-forms-empty">'; |
| [143](#L143) | echo '<p>' . esc\_attr\_\_( 'If you use Elementor, Gutenberg or Divi, that\'s fantastic! You’ll find a Plezi Form widget, directly in your page editor. Otherwise, you can copy your form\'s shortcode here and paste it once you get to your page\'s edition.', 'plezi' ) . '</p>'; |
| [144](#L144) | echo '<p class="plezi-image-center"><img src="' . esc\_url( plugin\_dir\_url( \_\_DIR\_\_ ) ) . 'images/ico\_forms\_empty.svg" alt="' . esc\_attr\_\_( 'It seems that you\'ve never created any form in Plezi -yet ;)', 'plezi' ) . '" /></p>'; |
| [145](#L145) | echo '<p class="plezi-strong">' . esc\_attr\_\_( 'It seems that you\'ve never created any form in Plezi -yet ;)', 'plezi' ) . '</p>'; |
| [146](#L146) | echo '<p class="plezi-button-center"><a class="plezi-btn-purple" href="https://enjoy.plezi.co/resources/create?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=forms-page" target="\_blank" title="' . esc\_attr\_\_( 'Create my first form', 'plezi' ) . '">'; |
| [147](#L147) | echo esc\_attr\_\_( 'Create my first form', 'plezi' ); |
| [148](#L148) | echo '</a></p>'; |
| [149](#L149) | echo '</div>'; |
| [150](#L150) | endif; |
| [151](#L151) | endif; |
| [152](#L152) |  |
| [153](#L153) | echo '</div>'; |
| [154](#L154) | echo '</div>'; |
| [155](#L155) | } |
| [156](#L156) | endif; |
| [157](#L157) |  |
| [158](#L158) | if ( ! function\_exists( 'plz\_admin\_faq' ) ) : |
| [159](#L159) | function plz\_admin\_faq() { |
| [160](#L160) | if ( ! current\_user\_can( 'manage\_options' ) ) : |
| [161](#L161) | wp\_die( esc\_attr\_\_( 'You do not have sufficient permissions to access this page.', 'plezi' ) ); |
| [162](#L162) | endif; |
| [163](#L163) |  |
| [164](#L164) | $setup = admin\_url( 'admin.php?page=plezi-for-wordpress-configuration.php' ); |
| [165](#L165) | $faq = array( |
| [166](#L166) | \_\_( 'Are there any pre-requisites to use this plugin?', 'plezi' ) => \_\_( 'To use the Plezi plugin, you need:', 'plezi' ) . '<br />' . esc\_attr\_\_( '- to have a Plezi One account.', 'plezi' ) . ' <a href="https://enjoy.plezi.co/signup?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=faq-page" target="\_blank" title="' . esc\_attr\_\_( 'Signup here', 'plezi' ) . '">' . esc\_attr\_\_( 'Signup here', 'plezi' ) . '</a>.<br />' . esc\_attr\_\_( '- connect your Plezi account to your Wordpress account.', 'plezi' ) . ' <a href="' . $setup . '" title="' . esc\_attr\_\_( 'Connect Plezi here', 'plezi' ) . '">' . esc\_attr\_\_( 'Connect Plezi here', 'plezi' ) . '</a>.', |
| [167](#L167) | \_\_( 'What is this plugin for?', 'plezi' ) => \_\_( 'This plugin allows you to:', 'plezi' ) . '<br />' . esc\_attr\_\_( '- have the Plezi tracking script through all your website pages', 'plezi' ) . '<br />' . esc\_attr\_\_( '- publish your Plezi forms online, thanks to a tailored Plezi widget (on Gutemberg, Elementor and Divi builders) or simplified shortcodes', 'plezi' ) . '<br />' . esc\_attr\_\_( '- take shortcuts to your Plezi dashboard to follow your website stats', 'plezi' ), |
| [168](#L168) | \_\_( 'What is Plezi\'s tracking script for?', 'plezi' ) => \_\_( 'The tracking script allows Plezi to see visits to your website and identify prospects when they return.', 'plezi' ), |
| [169](#L169) | \_\_( 'How do I install Plezi tracking script on my website with Wordpress?', 'plezi' ) => |
| [170](#L170) | \_\_( 'To install Plezi tracking script, follow the instructions', 'plezi' ) . ' <a href="' . $setup . '" title="' . esc\_attr\_\_( 'on the Setup tab of this plugin', 'plezi' ) . '">' . esc\_attr\_\_( 'on the Setup tab of this plugin', 'plezi' ) . '</a>.', |
| [171](#L171) | \_\_( 'How can I get all my Plezi forms in WordPress?', 'plezi' ) => \_\_( 'To find your Plezi forms in WordPress, you’ll need to authenticate your Plezi API keys.', 'plezi' ), |
| [172](#L172) | \_\_( 'How can I publish a Plezi form in WordPress?', 'plezi' ) => \_\_( 'If you use Elementor, Gutenberg or Divi, that\'s fantastic! You’ll find a Plezi Form widget, directly in your page editor. Otherwise, you can copy your form\'s shortcode here and paste it in your editor.', 'plezi' ), |
| [173](#L173) | \_\_( 'How can I use Plezi shortcodes in WordPress?', 'plezi' ) => \_\_( 'To publish a form online, copy its shortcode and paste it in a classic text bloc.', 'plezi' ), |
| [174](#L174) | ); |
| [175](#L175) |  |
| [176](#L176) | echo '<div class="wrap plezi-wrap-page plezi-wrap-faq">'; |
| [177](#L177) | echo '<h1>' . esc\_attr\_\_( 'Frequently Asked', 'plezi' ) . ' <strong>' . esc\_attr\_\_( 'Questions', 'plezi' ) . '</strong></h1>'; |
| [178](#L178) | echo '<ul>'; |
| [179](#L179) |  |
| [180](#L180) | foreach ( $faq as $question => $response ) : |
| [181](#L181) | echo '<li>'; |
| [182](#L182) | echo '<div class="plezi-question"><div>' . esc\_html( $question ) . '</div></div>'; |
| [183](#L183) | echo '<div class="plezi-response"><div>' . wp\_kses( $response, 'post' ) . '</div></div>'; |
| [184](#L184) | echo '</li>'; |
| [185](#L185) | endforeach; |
| [186](#L186) |  |
| [187](#L187) | echo '</ul>'; |
| [188](#L188) | echo '</div>'; |
| [189](#L189) | } |
| [190](#L190) | endif; |
| [191](#L191) |  |
| [192](#L192) | if ( ! function\_exists( 'plz\_page\_configuration\_init' ) ) : |
| [193](#L193) | function plz\_page\_configuration\_init() { |
| [194](#L194) | register\_setting( |
| [195](#L195) | 'plz\_configuration\_tracking\_options', |
| [196](#L196) | 'plz\_configuration\_tracking\_options', |
| [197](#L197) | 'plz\_configuration\_tracking\_options\_validate' |
| [198](#L198) | ); |
| [199](#L199) |  |
| [200](#L200) | register\_setting( |
| [201](#L201) | 'plz\_configuration\_authentification\_options', |
| [202](#L202) | 'plz\_configuration\_authentification\_options', |
| [203](#L203) | 'plz\_configuration\_authentification\_options\_validate' |
| [204](#L204) | ); |
| [205](#L205) |  |
| [206](#L206) | add\_settings\_section( |
| [207](#L207) | 'plz-configuration-section-tracking', |
| [208](#L208) | \_\_( 'Tracking', 'plezi' ), |
| [209](#L209) | 'plz\_page\_configuration\_section\_tracking', |
| [210](#L210) | 'plezi-for-wordpress-configuration-tracking.php' |
| [211](#L211) | ); |
| [212](#L212) |  |
| [213](#L213) | add\_settings\_section( |
| [214](#L214) | 'plz-configuration-section-authentification', |
| [215](#L215) | \_\_( 'API connexion', 'plezi' ), |
| [216](#L216) | 'plz\_page\_configuration\_section\_authentification', |
| [217](#L217) | 'plezi-for-wordpress-configuration-authentification.php' |
| [218](#L218) | ); |
| [219](#L219) |  |
| [220](#L220) | add\_settings\_field( |
| [221](#L221) | 'plz\_configuration\_tracking\_choice', |
| [222](#L222) | '', |
| [223](#L223) | 'plz\_configuration\_tracking\_choice\_field', |
| [224](#L224) | 'plezi-for-wordpress-configuration-tracking.php', |
| [225](#L225) | 'plz-configuration-section-tracking' |
| [226](#L226) | ); |
| [227](#L227) |  |
| [228](#L228) | add\_settings\_field( |
| [229](#L229) | 'plz\_configuration\_tracking\_code', |
| [230](#L230) | '', |
| [231](#L231) | 'plz\_configuration\_tracking\_code\_field', |
| [232](#L232) | 'plezi-for-wordpress-configuration-tracking.php', |
| [233](#L233) | 'plz-configuration-section-tracking' |
| [234](#L234) | ); |
| [235](#L235) |  |
| [236](#L236) | add\_settings\_field( |
| [237](#L237) | 'plz\_configuration\_authentification\_public\_key', |
| [238](#L238) | '', |
| [239](#L239) | 'plz\_configuration\_authentification\_public\_key\_field', |
| [240](#L240) | 'plezi-for-wordpress-configuration-authentification.php', |
| [241](#L241) | 'plz-configuration-section-authentification' |
| [242](#L242) | ); |
| [243](#L243) |  |
| [244](#L244) | add\_settings\_field( |
| [245](#L245) | 'plz\_configuration\_authentification\_secret\_key', |
| [246](#L246) | '', |
| [247](#L247) | 'plz\_configuration\_authentification\_secret\_key\_field', |
| [248](#L248) | 'plezi-for-wordpress-configuration-authentification.php', |
| [249](#L249) | 'plz-configuration-section-authentification' |
| [250](#L250) | ); |
| [251](#L251) | } |
| [252](#L252) | endif; |
| [253](#L253) |  |
| [254](#L254) | if ( ! function\_exists( 'plz\_page\_configuration\_section\_tracking' ) ) : |
| [255](#L255) | function plz\_page\_configuration\_section\_tracking() { |
| [256](#L256) | echo '<p>' . esc\_attr\_\_( 'Install Plezi\'s tracking script to see visits on your website. Get your script by 1) clicking on the pink button below if you\'ve connected Plezi to Wordpress or 2) by pasting it ', 'plezi' ) . ' <a href="https://enjoy.plezi.co/settings/configuration?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=settings-page" title="' . esc\_attr\_\_( 'from here', 'plezi' ) . '" target="\_blank">' . esc\_attr\_\_( 'from here', 'plezi' ) . '</a> ' . esc\_attr\_\_( ', activate it... et voilà!', 'plezi' ) . '</p>'; |
| [257](#L257) | echo '<p>' . esc\_attr\_\_( 'If you\'d rather choose another method to install the script (e.g. via Google Tag Manager), that\'s alright!', 'plezi' ) . ' <strong>' . esc\_attr\_\_( 'Don\'t do it twice', 'plezi' ) . '</strong> ' . esc\_attr\_\_( 'unless you want to see your visits counted twice ;)', 'plezi' ); |
| [258](#L258) | } |
| [259](#L259) | endif; |
| [260](#L260) |  |
| [261](#L261) | if ( ! function\_exists( 'plz\_page\_configuration\_section\_authentification' ) ) : |
| [262](#L262) | function plz\_page\_configuration\_section\_authentification() { |
| [263](#L263) | echo '<p>' . esc\_attr\_\_( 'To fully enjoy this plugin -like adding your Plezi forms into your pages, you need to connect Plezi to your WordPress acount. You\'ll find your API credentials here ', 'plezi' ) . ' <a href="https://enjoy.plezi.co/settings/configuration?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=settings-page" title="' . esc\_attr\_\_( 'in your Plezi settings', 'plezi' ) . '" target="\_blank">' . esc\_attr\_\_( 'in your Plezi settings', 'plezi' ) . '</a>.</p>'; |
| [264](#L264) | } |
| [265](#L265) | endif; |
| [266](#L266) |  |
| [267](#L267) | if ( ! function\_exists( 'plz\_configuration\_tracking\_choice\_field' ) ) : |
| [268](#L268) | function plz\_configuration\_tracking\_choice\_field() { |
| [269](#L269) | $choice = plz\_check\_tracking\_choice(); |
| [270](#L270) |  |
| [271](#L271) | echo '<input type="radio" name="plz\_configuration\_tracking\_options[plz\_tracking\_choice]" id="api"  value="api" ' . esc\_attr( $choice['api'] ) . ' class="plezi-radio" />'; |
| [272](#L272) | echo '<label for="api" class="plezi-radio-label">' . esc\_attr\_\_( 'Install with this plugin (faster)', 'plezi' ) . '</label>'; |
| [273](#L273) | echo '<input type="radio" name="plz\_configuration\_tracking\_options[plz\_tracking\_choice]" id="manual"  value="manual" ' . esc\_attr( $choice['manual'] ) . ' class="plezi-radio" />'; |
| [274](#L274) | echo '<label for="manual" class="plezi-radio-label">' . esc\_attr\_\_( 'Install script another way', 'plezi' ) . '</label>'; |
| [275](#L275) | } |
| [276](#L276) | endif; |
| [277](#L277) |  |
| [278](#L278) | if ( ! function\_exists( 'plz\_configuration\_tracking\_code\_field' ) ) : |
| [279](#L279) | function plz\_configuration\_tracking\_code\_field() { |
| [280](#L280) | $options = get\_option( 'plz\_configuration\_tracking\_options' ); |
| [281](#L281) | $check\_tracker = plz\_get\_tracking\_enable\_mode\_for\_header(); |
| [282](#L282) | $tracking\_code = plz\_get\_tracking\_code(); |
| [283](#L283) | $tracking\_date = plz\_get\_tracking\_date(); |
| [284](#L284) |  |
| [285](#L285) | if ( ! $check\_tracker ) : |
| [286](#L286) | $plz\_class\_tracking\_api\_validation = 'plz-hidden'; |
| [287](#L287) | $plz\_class\_tracking\_api\_label\_active = 'plz-hidden'; |
| [288](#L288) | $plz\_class\_tracking\_api\_label\_inactive = ''; |
| [289](#L289) | $plz\_class\_tracking\_api\_date = 'plz-hidden'; |
| [290](#L290) | $tracking\_status = ''; |
| [291](#L291) | else : |
| [292](#L292) | $plz\_class\_tracking\_api\_validation = ''; |
| [293](#L293) | $plz\_class\_tracking\_api\_label\_active = ''; |
| [294](#L294) | $plz\_class\_tracking\_api\_label\_inactive = 'plz-hidden'; |
| [295](#L295) | $plz\_class\_tracking\_api\_date = 'plz-hidden'; |
| [296](#L296) | $tracking\_status = 'checked'; |
| [297](#L297) |  |
| [298](#L298) | if ( $tracking\_date ) : |
| [299](#L299) | $plz\_class\_tracking\_api\_date = ''; |
| [300](#L300) | endif; |
| [301](#L301) | endif; |
| [302](#L302) |  |
| [303](#L303) | if ( empty( $tracking\_code ) ) : |
| [304](#L304) | $plz\_class\_tracking\_api\_btn\_remove = 'plz-hidden'; |
| [305](#L305) | $plz\_class\_tracking\_api\_btn\_get = ''; |
| [306](#L306) | $plz\_tracking\_button\_status = 'disabled'; |
| [307](#L307) | $plz\_tracking\_textarea\_status = ''; |
| [308](#L308) | else : |
| [309](#L309) | $plz\_class\_tracking\_api\_btn\_remove = ''; |
| [310](#L310) | $plz\_class\_tracking\_api\_btn\_get = 'plz-hidden'; |
| [311](#L311) | $plz\_tracking\_button\_status = ''; |
| [312](#L312) | $plz\_tracking\_textarea\_status = 'disabled="disabled"'; |
| [313](#L313) | endif; |
| [314](#L314) |  |
| [315](#L315) | if ( isset( $options['plz\_configuration\_tracking\_enable\_manual'] ) && ! empty( $options['plz\_configuration\_tracking\_enable\_manual'] ) && 'checked' === $options['plz\_configuration\_tracking\_enable\_manual'] ) : |
| [316](#L316) | $plz\_class\_tracking\_button\_manual\_status = 'disabled'; |
| [317](#L317) | $plz\_class\_tracking\_date\_manual = ''; |
| [318](#L318) | $plz\_configuration\_tracking\_button\_manual\_status = 'disabled="disabled"'; |
| [319](#L319) | $plz\_configuration\_tracking\_enable\_manual\_option = 'checked'; |
| [320](#L320) | $plz\_configuration\_tracking\_date\_manual\_option = $options['plz\_configuration\_tracking\_manual\_date']; |
| [321](#L321) | else : |
| [322](#L322) | $plz\_class\_tracking\_button\_manual\_status = ''; |
| [323](#L323) | $plz\_class\_tracking\_date\_manual = 'plz-hidden'; |
| [324](#L324) | $plz\_configuration\_tracking\_button\_manual\_status = ''; |
| [325](#L325) | $plz\_configuration\_tracking\_enable\_manual\_option = ''; |
| [326](#L326) | $plz\_configuration\_tracking\_date\_manual\_option = ''; |
| [327](#L327) | endif; |
| [328](#L328) |  |
| [329](#L329) | echo '<div class="plezi-tracking-api-wrapper">'; |
| [330](#L330) | echo '<div class="plezi-tracking-api-row">'; |
| [331](#L331) | echo '<div class="plezi-tracking-left">'; |
| [332](#L332) | echo '<h5>' . esc\_attr\_\_( 'Tracking script', 'plezi' ) . '</h5>'; |
| [333](#L333) | echo '<textarea id="plz\_configuration\_tracking\_code" name="plz\_configuration\_tracking\_options[plz\_configuration\_tracking\_code]" ' . esc\_attr( $plz\_tracking\_textarea\_status ) . '>' . esc\_attr( $tracking\_code ) . '</textarea>'; |
| [334](#L334) | echo '<p class="plz-date-validation ' . esc\_attr( $plz\_class\_tracking\_api\_date ) . '">' . esc\_attr\_\_( 'Script added on ', 'plezi' ) . '<span>' . esc\_attr( $tracking\_date ) . '</span></p>'; |
| [335](#L335) | echo '</div>'; |
| [336](#L336) | echo '<div class="plezi-tracking-right">'; |
| [337](#L337) | echo '<button type="button" name="plezi-remove-tracking" id="plezi-remove-tracking" class="plezi-btn-purple plezi-btn-purple-active ' . esc\_attr( $plz\_class\_tracking\_api\_btn\_remove ) . '">' . esc\_attr\_\_( 'Remove tracking', 'plezi' ) . '</button>'; |
| [338](#L338) | echo '<button type="button" name="plezi-get-tracking" id="plezi-get-tracking" class="plezi-btn-purple ' . esc\_attr( $plz\_class\_tracking\_api\_btn\_get ) . '">' . esc\_attr\_\_( 'Get my tracking script', 'plezi' ) . '</button>'; |
| [339](#L339) | echo '<div class="plz-switch-wrapper">'; |
| [340](#L340) | echo '<label class="plz-switch">'; |
| [341](#L341) | echo '<input type="checkbox" id="plz\_configuration\_tracking\_enable" name="plz\_configuration\_tracking\_options[plz\_configuration\_tracking\_enable]" value="checked" ' . esc\_attr( $plz\_tracking\_button\_status ) . ' ' . esc\_attr( $tracking\_status ) . ' />'; |
| [342](#L342) | echo '<span class="plz-slider plz-round"></span>'; |
| [343](#L343) | echo '</label>'; |
| [344](#L344) | echo '<span id="plz-label-active" class="plz-switch-label-active ' . esc\_attr( $plz\_class\_tracking\_api\_label\_active) . '">' . esc\_attr\_\_( 'Active', 'plezi' ) . '</span>'; |
| [345](#L345) | echo '<span id="plz-label-inactive" class="plz-switch-label ' . esc\_attr( $plz\_class\_tracking\_api\_label\_inactive) . '">' . esc\_attr\_\_( 'Inactive', 'plezi' ) . '</span>'; |
| [346](#L346) | echo '</div>'; |
| [347](#L347) | echo '</div>'; |
| [348](#L348) | echo '<div class="plz-tracking-confirmation-sentence ' . esc\_attr( $plz\_class\_tracking\_api\_validation ) . '">'; |
| [349](#L349) | echo '<img src="' . esc\_url( plugin\_dir\_url( \_\_DIR\_\_ ) ) . 'images/ico\_valid\_tracking.svg" alt="' . esc\_attr\_\_( 'The tracking script is integrated on your website! Visits will be tracked from now on in our application.', 'plezi' ) . '" />'; |
| [350](#L350) | echo '<p>' . esc\_attr\_\_( 'The tracking script is integrated to your website! Visits will be tracked from now on.', 'plezi' ) . '</p>'; |
| [351](#L351) | echo '</div>'; |
| [352](#L352) | echo '</div>'; |
| [353](#L353) | echo '</div>'; |
| [354](#L354) | echo '<div class="plezi-tracking-manual-wrapper">'; |
| [355](#L355) | echo '<div class="plezi-tracking-manual-row">'; |
| [356](#L356) | echo '<h5>' . esc\_attr\_\_( 'Note to myself', 'plezi' ) . '</h5>'; |
| [357](#L357) | echo '<div class="plezi-checkbox-wrapper">'; |
| [358](#L358) | echo '<p>'; |
| [359](#L359) | echo '<input type="checkbox" id="plz\_configuration\_tracking\_enable\_manual" class="plezi-checkbox" name="plz\_configuration\_tracking\_options[plz\_configuration\_tracking\_enable\_manual]" value="checked" ' . esc\_attr( $plz\_configuration\_tracking\_enable\_manual\_option ) . ' />'; |
| [360](#L360) | echo '<label for="plz\_configuration\_tracking\_enable\_manual">' . esc\_attr\_\_( 'I installed the tracking script with Google Tag Manager or manually', 'plezi' ) . '</label>'; |
| [361](#L361) | echo '</p>'; |
| [362](#L362) | echo '</div>'; |
| [363](#L363) | echo '<button type="button" name="plezi-set-tracking-manual" id="plezi-set-tracking-manual" class="plezi-btn-purple plezi-btn-purple-active ' . esc\_attr( $plz\_class\_tracking\_button\_manual\_status ) . '" ' . esc\_attr( $plz\_configuration\_tracking\_button\_manual\_status ) . '>' . esc\_attr\_\_( 'Save', 'plezi' ) . '</button>'; |
| [364](#L364) | echo '<div class="plz-manual-date-validation-wrapper ' . esc\_attr( $plz\_class\_tracking\_date\_manual ) . '">'; |
| [365](#L365) | echo '<hr />'; |
| [366](#L366) | echo '<p class="plz-date-validation"><span>' . esc\_attr( $plz\_configuration\_tracking\_date\_manual\_option ) . '</span> : ' . esc\_attr\_\_( 'Tracking script Installed via another method', 'plezi' ) . '</p>'; |
| [367](#L367) | echo '</div>'; |
| [368](#L368) | echo '</div>'; |
| [369](#L369) | echo '</div>'; |
| [370](#L370) | } |
| [371](#L371) | endif; |
| [372](#L372) |  |
| [373](#L373) | if ( ! function\_exists( 'plz\_configuration\_authentification\_public\_key\_field' ) ) : |
| [374](#L374) | function plz\_configuration\_authentification\_public\_key\_field() { |
| [375](#L375) | $options = get\_option( 'plz\_configuration\_authentification\_options' ); |
| [376](#L376) | $authentification\_status\_class = ''; |
| [377](#L377) |  |
| [378](#L378) | if ( ! isset( $options['plz\_authentification\_public\_key'] ) ) : |
| [379](#L379) | $options['plz\_authentification\_public\_key'] = ''; |
| [380](#L380) | endif; |
| [381](#L381) |  |
| [382](#L382) | if ( ! isset( $options['plz\_authentification\_status'] ) || empty( $options['plz\_authentification\_status'] ) || '0' === $options['plz\_authentification\_status'] ) : |
| [383](#L383) | $authentification\_status\_class = 'plz-validation-authentification-hidden'; |
| [384](#L384) | endif; |
| [385](#L385) |  |
| [386](#L386) | echo '<label for="plz\_authentification\_public\_key">' . esc\_attr\_\_( 'API key', 'plezi' ) . '</label>'; |
| [387](#L387) | echo '<input type="text" id="plz\_authentification\_public\_key" name="plz\_configuration\_authentification\_options[plz\_authentification\_public\_key]" value="' . esc\_attr( $options['plz\_authentification\_public\_key'] ) . '" />'; |
| [388](#L388) | echo '<img class="plz-validation-authentification ' . esc\_attr( $authentification\_status\_class ) . '" src="' . esc\_url( plugin\_dir\_url( \_\_DIR\_\_ ) ) . 'images/ico\_valid\_option.svg" alt="' . esc\_attr\_\_( 'API key', 'plezi' ) . '" />'; |
| [389](#L389) | } |
| [390](#L390) | endif; |
| [391](#L391) |  |
| [392](#L392) | if ( ! function\_exists( 'plz\_configuration\_authentification\_secret\_key\_field' ) ) : |
| [393](#L393) | function plz\_configuration\_authentification\_secret\_key\_field() { |
| [394](#L394) | $options = get\_option( 'plz\_configuration\_authentification\_options' ); |
| [395](#L395) | $authentification\_status\_class = ''; |
| [396](#L396) |  |
| [397](#L397) | if ( ! isset( $options['plz\_authentification\_secret\_key'] ) ) : |
| [398](#L398) | $options['plz\_authentification\_secret\_key'] = ''; |
| [399](#L399) | endif; |
| [400](#L400) |  |
| [401](#L401) | if ( ! isset( $options['plz\_authentification\_status'] ) || empty( $options['plz\_authentification\_status'] ) || '0' === $options['plz\_authentification\_status'] ) : |
| [402](#L402) | $authentification\_status\_class = 'plz-validation-authentification-hidden'; |
| [403](#L403) | endif; |
| [404](#L404) |  |
| [405](#L405) | echo '<label for="plz\_authentification\_secret\_key">' . esc\_attr\_\_( 'Secret key', 'plezi' ) . '</label>'; |
| [406](#L406) | echo '<input type="password" id="plz\_authentification\_secret\_key" name="plz\_configuration\_authentification\_options[plz\_authentification\_secret\_key]" value="' . esc\_attr( $options['plz\_authentification\_secret\_key'] ) . '" />'; |
| [407](#L407) | echo '<img class="plz-validation-authentification ' . esc\_attr( $authentification\_status\_class ) . '" src="' . esc\_url( plugin\_dir\_url( \_\_DIR\_\_ ) ) . 'images/ico\_valid\_option.svg" alt="' . esc\_attr\_\_( 'Secret key', 'plezi' ) . '" />'; |
| [408](#L408) | echo '<p class="plz-error-authentification">'; |
| [409](#L409) | echo esc\_attr\_\_( 'Oh no! These keys don\'t exist. Please try again.', 'plezi' ); |
| [410](#L410) | echo '</p>'; |
| [411](#L411) | } |
| [412](#L412) | endif; |
| [413](#L413) |  |
| [414](#L414) | if ( ! function\_exists( 'plz\_configuration\_tracking\_options\_validate' ) ) : |
| [415](#L415) | function plz\_configuration\_tracking\_options\_validate( $inputs ) { |
| [416](#L416) | $outputs = array(); |
| [417](#L417) |  |
| [418](#L418) | foreach ( $inputs as $key => $value ) : |
| [419](#L419) | $outputs[ $key ] = $value; |
| [420](#L420) | endforeach; |
| [421](#L421) |  |
| [422](#L422) | if ( isset( $inputs['plz\_configuration\_tracking\_code'] ) && ! empty( $inputs['plz\_configuration\_tracking\_code'] ) ) : |
| [423](#L423) | $outputs['plz\_configuration\_tracking\_date'] = gmdate( 'd/m/Y' ); |
| [424](#L424) | $outputs['plz\_configuration\_tracking\_enable'] = 'checked'; |
| [425](#L425) | else : |
| [426](#L426) | $outputs['plz\_configuration\_tracking\_enable'] = ''; |
| [427](#L427) | endif; |
| [428](#L428) |  |
| [429](#L429) | return apply\_filters( 'plz\_configuration\_tracking\_options\_validate', $outputs, $inputs ); |
| [430](#L430) | } |
| [431](#L431) | endif; |
| [432](#L432) |  |
| [433](#L433) | if ( ! function\_exists( 'plz\_configuration\_authentification\_options\_validate' ) ) : |
| [434](#L434) | function plz\_configuration\_authentification\_options\_validate( $inputs ) { |
| [435](#L435) | $outputs = array(); |
| [436](#L436) |  |
| [437](#L437) | foreach ( $inputs as $key => $value ) : |
| [438](#L438) | $outputs[ $key ] = $value; |
| [439](#L439) | endforeach; |
| [440](#L440) |  |
| [441](#L441) | if ( isset( $inputs['plz\_authentification\_public\_key'] ) && ! empty( $inputs['plz\_authentification\_public\_key'] ) && isset( $inputs['plz\_authentification\_secret\_key'] ) && ! empty( $inputs['plz\_authentification\_secret\_key'] ) ) : |
| [442](#L442) | $outputs['plz\_authentification\_status'] = '1'; |
| [443](#L443) | else : |
| [444](#L444) | $outputs['plz\_authentification\_status'] = '0'; |
| [445](#L445) | endif; |
| [446](#L446) |  |
| [447](#L447) | return apply\_filters( 'plz\_configuration\_authentification\_options\_validate', $outputs, $inputs ); |
| [448](#L448) | } |
| [449](#L449) | endif; |
| [450](#L450) |  |
| [451](#L451) | if ( ! function\_exists( 'plz\_admin\_include\_scripts' ) ) : |
| [452](#L452) | function plz\_admin\_include\_scripts() { |
| [453](#L453) | global $pagenow; |
| [454](#L454) |  |
| [455](#L455) | if ( is\_admin() && current\_user\_can( 'manage\_options' ) && plz\_check\_screen( ) ) : |
| [456](#L456) | wp\_enqueue\_style( 'plz-admin-fonts', plugin\_dir\_url( \_\_DIR\_\_ ) . 'css/fonts.css', array(), PLZ\_VERSION, 'all' ); |
| [457](#L457) | wp\_enqueue\_style( 'plz-admin-style', plugin\_dir\_url( \_\_DIR\_\_ ) . 'css/plz-admin.css', array(), PLZ\_VERSION, 'all' ); |
| [458](#L458) | wp\_enqueue\_script( 'plz-admin-script', plugin\_dir\_url( \_\_DIR\_\_ ) . 'js/plz-admin.js', array( 'jquery' ), PLZ\_VERSION, true); |
| [459](#L459) | wp\_localize\_script( 'plz-admin-script', 'plzlabels', array( 'plztrackingremovescript'      => \_\_( 'Are you sure you want to delete the script? You can disable it with the toggle below.', 'plezi' ) ) ); |
| [460](#L460) | wp\_localize\_script( 'plz-admin-script', 'plzapi', array( 'plzsetauthentification'          => '/wp-json/plz/v2/configuration/set-authentification', |
| [461](#L461) | 'plzremoveauthentification'       => '/wp-json/plz/v2/configuration/remove-authentification', |
| [462](#L462) | 'plzsettrackingmanualstatus'      => '/wp-json/plz/v2/configuration/set-tracking-manual-status', |
| [463](#L463) | 'plzgettrackingapi'               => '/wp-json/plz/v2/configuration/get-tracking-api', |
| [464](#L464) | 'plzsettrackingapi'               => '/wp-json/plz/v2/configuration/set-tracking-api', |
| [465](#L465) | 'plzremovetrackingapi'            => '/wp-json/plz/v2/configuration/remove-tracking-api', |
| [466](#L466) | 'plzsettrackingapistatus'         => '/wp-json/plz/v2/configuration/set-tracking-api-status', |
| [467](#L467) | 'plznonceapi'                     => wp\_create\_nonce( 'wp\_rest' ), |
| [468](#L468) | ) ); |
| [469](#L469) | elseif ( is\_admin() && plz\_check\_dashboard\_screen() ) : |
| [470](#L470) | wp\_enqueue\_style( 'plz-admin-fonts', plugin\_dir\_url( \_\_DIR\_\_ ) . 'css/fonts.css', array(), PLZ\_VERSION, 'all' ); |
| [471](#L471) | wp\_enqueue\_style( 'plz-admin-widget-style', plugin\_dir\_url( \_\_DIR\_\_ ) . 'css/plz-admin-widget.css', array(), PLZ\_VERSION, 'all' ); |
| [472](#L472) | elseif ( is\_admin() && $pagenow == 'post.php' && isset($\_GET['vc\_action']) ) : |
| [473](#L473) | wp\_enqueue\_style( 'plz-admin-wpbakery-style', plugin\_dir\_url( \_\_DIR\_\_ ) . 'builders/wpbakery-element/styles/style.css', array(), PLZ\_VERSION, 'all' ); |
| [474](#L474) | endif; |
| [475](#L475) | } |
| [476](#L476) | endif; |
| [477](#L477) |  |
| [478](#L478) | if ( ! function\_exists( 'plz\_footer' ) ) : |
| [479](#L479) | function plz\_footer() { |
| [480](#L480) | if ( plz\_check\_screen( ) ) : |
| [481](#L481) | return '<span class="plz-footer">' . esc\_html\_\_( 'Powered with 💗︎ by ', 'plezi' ) . '</span><img src="' . esc\_url( plugin\_dir\_url( \_\_DIR\_\_ ) ) . 'images/footer\_logo.svg" alt="' . esc\_attr\_\_( 'Plezi', 'plezi' ) . '" class="plz-footer-image" />'; |
| [482](#L482) | endif; |
| [483](#L483) | } |
| [484](#L484) | endif; |
| [485](#L485) |  |
| [486](#L486) | if ( ! function\_exists( 'plz\_check\_screen' ) ) : |
| [487](#L487) | function plz\_check\_screen() { |
| [488](#L488) | $screen   = get\_current\_screen(); |
| [489](#L489) | $screens  = array( 'toplevel\_page\_plezi-for-wordpress-configuration', 'plezi\_page\_plezi-for-wordpress-forms', 'plezi\_page\_plezi-for-wordpress-faq' ); |
| [490](#L490) |  |
| [491](#L491) | if ( in\_array($screen->id, $screens ) ) : |
| [492](#L492) | return true; |
| [493](#L493) | endif; |
| [494](#L494) |  |
| [495](#L495) | return false; |
| [496](#L496) | } |
| [497](#L497) | endif; |
| [498](#L498) |  |
| [499](#L499) | if ( ! function\_exists( 'plz\_check\_dashboard\_screen' ) ) : |
| [500](#L500) | function plz\_check\_dashboard\_screen() { |
| [501](#L501) | $screen   = get\_current\_screen(); |
| [502](#L502) |  |
| [503](#L503) | if ( 'dashboard' === $screen->id ) : |
| [504](#L504) | return true; |
| [505](#L505) | endif; |
| [506](#L506) |  |
| [507](#L507) | return false; |
| [508](#L508) | } |
| [509](#L509) | endif; |
| [510](#L510) |  |
| [511](#L511) | if ( ! function\_exists( 'plz\_load\_textdomain' ) ) : |
| [512](#L512) | function plz\_load\_textdomain( $mofile, $domain ) { |
| [513](#L513) | if ( 'plezi' === $domain && false !== strpos( $mofile, WP\_LANG\_DIR . '/plugins/' ) ) : |
| [514](#L514) | $locale = apply\_filters( 'plugin\_locale', determine\_locale(), $domain ); |
| [515](#L515) | $mofile = WP\_PLUGIN\_DIR . '/' . dirname( plugin\_basename( \_\_DIR\_\_ ) ) . '/languages/' . $domain . '-' . $locale . '.mo'; |
| [516](#L516) | endif; |
| [517](#L517) |  |
| [518](#L518) | return $mofile; |
| [519](#L519) | } |
| [520](#L520) | endif; |
| [521](#L521) |  |
| [522](#L522) | if ( ! function\_exists( 'plz\_load\_plugin' ) ) : |
| [523](#L523) | function plz\_load\_plugin() { |
| [524](#L524) | load\_plugin\_textdomain( 'plezi', false, plugin\_basename( \_\_DIR\_\_ ) . '/languages' ); |
| [525](#L525) |  |
| [526](#L526) | $permalink\_structure = get\_option( 'permalink\_structure' ); |
| [527](#L527) |  |
| [528](#L528) | if ( empty( $permalink\_structure ) ) : |
| [529](#L529) | add\_action( 'admin\_notices', 'plz\_show\_permalink\_error' ); |
| [530](#L530) | endif; |
| [531](#L531) | } |
| [532](#L532) | endif; |
| [533](#L533) |  |
| [534](#L534) | if ( ! function\_exists( 'plz\_show\_permalink\_error' ) ) : |
| [535](#L535) | function plz\_show\_permalink\_error() { |
| [536](#L536) | echo '<div class="notice notice-error is-dismissible">'; |
| [537](#L537) | echo '<p>'; |
| [538](#L538) | echo esc\_attr\_\_( 'Please, edit your ', 'plezi' ); |
| [539](#L539) | echo '<a href="' . esc\_url( admin\_url( 'options-permalink.php' ) ) . '" title="' . esc\_attr\_\_( 'permalinks structure', 'plezi' ) . '">'; |
| [540](#L540) | echo esc\_attr\_\_( 'permalinks structure', 'plezi' ); |
| [541](#L541) | echo '</a>'; |
| [542](#L542) | echo esc\_attr\_\_( ' to use Plezi plugin.', 'plezi' ); |
| [543](#L543) | echo '</p>'; |
| [544](#L544) | echo '</div>'; |
| [545](#L545) | } |
| [546](#L546) | endif; |
| [547](#L547) |  |
| [548](#L548) | if ( ! function\_exists( 'plz\_add\_dashboard\_widget' ) ) : |
| [549](#L549) | function plz\_add\_dashboard\_widget() { |
| [550](#L550) | global $wp\_meta\_boxes; |
| [551](#L551) |  |
| [552](#L552) | $plz\_widget\_id = 'plezi\_dashboard\_widget'; |
| [553](#L553) |  |
| [554](#L554) | wp\_add\_dashboard\_widget($plz\_widget\_id, \_\_( 'Plezi’s dashboard', 'plezi' ), 'plz\_dashboard\_widget\_content' ); |
| [555](#L555) |  |
| [556](#L556) | $normal\_dashboard = $wp\_meta\_boxes['dashboard']['normal']['core']; |
| [557](#L557) | $widget\_instance = [ $plz\_widget\_id => $normal\_dashboard[ $plz\_widget\_id ] ]; |
| [558](#L558) |  |
| [559](#L559) | unset( $normal\_dashboard[ $plz\_widget\_id ] ); |
| [560](#L560) |  |
| [561](#L561) | $sorted\_dashboard = array\_merge( $widget\_instance, $normal\_dashboard ); |
| [562](#L562) | $wp\_meta\_boxes['dashboard']['normal']['core'] = $sorted\_dashboard; |
| [563](#L563) | } |
| [564](#L564) | endif; |
| [565](#L565) |  |
| [566](#L566) | if ( ! function\_exists( 'plz\_dashboard\_widget\_content' ) ) : |
| [567](#L567) | function plz\_dashboard\_widget\_content( $post, $callback\_args ) { |
| [568](#L568) | echo '<div>'; |
| [569](#L569) | echo '<div class="plz-widget-dashboard">'; |
| [570](#L570) | echo '<div class="plz-widget-dashboard-container">'; |
| [571](#L571) | echo '<div class="plz-widget-dashboard-content">'; |
| [572](#L572) | echo '<h3>' . esc\_attr\_\_( 'Follow your website performance on Plezi', 'plezi' ) . '</h3>'; |
| [573](#L573) | echo '<ul class="introduction">'; |
| [574](#L574) | echo '<li><span class="plz-dashboard-widget-validation">✔</span> ' . esc\_attr\_\_( 'Visits, conversion rate, leads', 'plezi' ); |
| [575](#L575) | echo '<li><span class="plz-dashboard-widget-validation">✔</span> ' . esc\_attr\_\_( 'Top digital channels', 'plezi' ); |
| [576](#L576) | echo '<li><span class="plz-dashboard-widget-validation">✔</span> ' . esc\_attr\_\_( 'Top keywords and SEO positions', 'plezi' ); |
| [577](#L577) | echo '</ul>'; |
| [578](#L578) | echo '<p class="plezi-button-center">'; |
| [579](#L579) | echo '<a class="plezi-btn-purple" href="https://enjoy.plezi.co/dashboard?utm\_medium=referral&utm\_source=wordpress&utm\_campaign=plezi\_one&utm\_content=plugin&utm\_term=widget-dashboard" target="\_blank" title="' . esc\_attr\_\_( 'Go to dashboard', 'plezi' ) . '">'; |
| [580](#L580) | echo esc\_attr\_\_( 'Go to dashboard', 'plezi' ); |
| [581](#L581) | echo '</a>'; |
| [582](#L582) | echo '</p>'; |
| [583](#L583) | echo '</div>'; |
| [584](#L584) | echo '</div>'; |
| [585](#L585) | echo '</div>'; |
| [586](#L586) | echo '</div>'; |
| [587](#L587) | } |
| [588](#L588) | endif; |
| [589](#L589) |  |
| [590](#L590) | if ( ! function\_exists( 'plz\_form\_shortcode' ) ) : |
| [591](#L591) | function plz\_form\_shortcode( $atts ) { |
| [592](#L592) | $atts = shortcode\_atts( [ 'form' => null ], $atts, 'plezi' ); |
| [593](#L593) | $form = isset( $atts['form'] ) ? sanitize\_text\_field( $atts['form'] ) : null; |
| [594](#L594) |  |
| [595](#L595) | if ( $form && ! empty( $form ) && preg\_match( '/^[a-zA-Z0-9-]+$/', $form ) ) : |
| [596](#L596) | $escaped\_form = esc\_attr( $form ); |
| [597](#L597) |  |
| [598](#L598) | wp\_enqueue\_script( 'plezi-form-' . $escaped\_form, 'https://brain.plezi.co/api/v1/web\_forms/scripts?content\_web\_form\_id=' . $escaped\_form, [], PLZ\_VERSION, [ 'in\_footer' => true, 'strategy' => 'async' ] ); |
| [599](#L599) |  |
| [600](#L600) | return '<form id="plz-form-' . $escaped\_form . '"></form>'; |
| [601](#L601) | endif; |
| [602](#L602) |  |
| [603](#L603) | return ''; |
| [604](#L604) | } |
| [605](#L605) | endif; |
| [606](#L606) |  |
| [607](#L607) | if ( ! function\_exists( 'plz\_register\_widget' ) ) : |
| [608](#L608) | function plz\_register\_widget( $widgets\_manager ) { |
| [609](#L609) | include\_once( plugin\_dir\_path( \_\_DIR\_\_ ) . '/builders/elementor-widget/class-elementor-plezi-form-widget.php' ); |
| [610](#L610) |  |
| [611](#L611) | $widgets\_manager->register(new \Elementor\_Plezi\_Form\_Widget() ); |
| [612](#L612) | } |
| [613](#L613) | endif; |
| [614](#L614) |  |
| [615](#L615) | if ( ! function\_exists( 'plz\_add\_elementor\_widget\_category' ) ) : |
| [616](#L616) | function plz\_add\_elementor\_widget\_category( $elements\_manager ) { |
| [617](#L617) | $elements\_manager->add\_category( |
| [618](#L618) | 'plezi', |
| [619](#L619) | [ |
| [620](#L620) | 'title' => \_\_( 'Plezi', 'plezi' ), |
| [621](#L621) | 'icon' => 'fa fa-plug', |
| [622](#L622) | ] |
| [623](#L623) | ); |
| [624](#L624) | } |
| [625](#L625) | endif; |
| [626](#L626) |  |
| [627](#L627) | if ( ! function\_exists( 'plz\_get\_user\_cookies' ) ) : |
| [628](#L628) | function plz\_get\_user\_cookies() { |
| [629](#L629) | $cookies = array(); |
| [630](#L630) |  |
| [631](#L631) | foreach ( $\_COOKIE as $name => $value ) : |
| [632](#L632) | if ( ! is\_string( $value ) ) { |
| [633](#L633) | $value = wp\_json\_encode( $value ); |
| [634](#L634) | } |
| [635](#L635) |  |
| [636](#L636) | $cookies[] = new WP\_Http\_Cookie( array( 'name' => $name, 'value' => $value ) ); |
| [637](#L637) | endforeach; |
| [638](#L638) |  |
| [639](#L639) | return $cookies; |
| [640](#L640) | } |
| [641](#L641) | endif; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/plezi/trunk/includes/plz-admin.php?format=txt)
* [Original Format](/export/3222468/plezi/trunk/includes/plz-admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_f52189bc_20250114_202646.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Plezi <= 1.0.6 - Authenticated (Contributor+) Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Plezi <= 1.0.6 - Authenticated (Contributor+) Stored Cross-Site Scripting

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-11763](https://www.cve.org/CVERecord?id=CVE-2024-11763) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | December 13, 2024 |
| Last Updated | December 21, 2024 |
| Researcher | [SOPROBRO](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/soprobro-2) |

### Description

The Plezi plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'plezi' shortcode in all versions up to, and including, 1.0.6 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/plezi/trunk/includes/plz-admin.php#L590)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3209502/plezi/trunk/includes/plz-admin.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fplezi%2Fplezi-106-authenticated-contributor-stored-cross-site-scripting&t=Plezi%20%3C%3D%201.0.6%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fplezi%2Fplezi-106-authenticated-contributor-stored-cross-site-scripting&text=Plezi%20%3C%3D%201.0.6%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fplezi%2Fplezi-106-authenticated-contributor-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Plezi

#### [Plezi](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/plezi)

| Software Type | Plugin |
| --- | --- |
| Software Slug | plezi [(view on wordpress.org)](https://wordpress.org/plugins/plezi) |
| Patched? | Yes |
| Remediation | Update to version 1.0.7, or a newer patched version |
| Affected Version | * <= 1.0.6 |
| Patched Version | * 1.0.7 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


