=== Content from mega.nz_9337568d_20250114_213152.html ===




=== Content from github.com_ad96ea8e_20250114_213151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=eNMS-automation%2FeNMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eNMS-automation](/eNMS-automation)
/
**[eNMS](/eNMS-automation/eNMS)**
Public

* [Notifications](/login?return_to=%2FeNMS-automation%2FeNMS) You must be signed in to change notification settings
* [Fork
  162](/login?return_to=%2FeNMS-automation%2FeNMS)
* [Star
   814](/login?return_to=%2FeNMS-automation%2FeNMS)

* [Code](/eNMS-automation/eNMS)
* [Issues
  27](/eNMS-automation/eNMS/issues)
* [Pull requests
  1](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects
  0](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

Additional navigation options

* [Code](/eNMS-automation/eNMS)
* [Issues](/eNMS-automation/eNMS/issues)
* [Pull requests](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Update controller.py #419

 Merged

[afourmy](/afourmy)
merged 1 commit into
[eNMS-automation:public](/eNMS-automation/eNMS/tree/public "eNMS-automation/eNMS:public")
from
[0xs1ash:public](/0xs1ash/eNMS/tree/public "0xs1ash/eNMS:public")

Nov 23, 2024

 Merged

# [Update controller.py](#top) #419

[afourmy](/afourmy)
merged 1 commit into
[eNMS-automation:public](/eNMS-automation/eNMS/tree/public "eNMS-automation/eNMS:public")
from
[0xs1ash:public](/0xs1ash/eNMS/tree/public "0xs1ash/eNMS:public")

Nov 23, 2024

[Conversation
2](/eNMS-automation/eNMS/pull/419)
[Commits
1](/eNMS-automation/eNMS/pull/419/commits)
[Checks
0](/eNMS-automation/eNMS/pull/419/checks)
[Files changed](/eNMS-automation/eNMS/pull/419/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=60&v=4)](/0xs1ash)

Copy link

Contributor

### @0xs1ash **[0xs1ash](/0xs1ash)** commented [Nov 23, 2024](#issue-2686386676)

Summary

I had previously informed you about the RCE in your admin panel, and you mentioned that it was a feature. I decided to dig deeper into the system and discovered a very critical vulnerability. I found an Arbitrary File Write vulnerability in the system, which leads to remote code execution.

Details

This is a vulnerability code section:

controller.py:

def import\_services(self, \*\*kwargs):

file = kwargs["file"]

filepath = vs.file\_path / "services" / file.filename

(vs.file\_path / "services").mkdir(parents=True, exist\_ok=True)

file.save(str(filepath))

with open\_tar(filepath) as tar\_file:

tar\_file.extractall(path=vs.file\_path / "services")

folder\_name = tar\_file.getmembers()[0].name

status = self.migration\_import(

folder="services",

name=folder\_name,

import\_export\_types=["service", "workflow\_edge"],

service\_import=True,

skip\_pool\_update=True,

skip\_model\_update=True,

)

rmtree(vs.file\_path / "services" / folder\_name, ignore\_errors=True)

if "Error during import" in status:

raise Exception(status)

return status

There is a serious vulnerability in the code I mentioned above. The import\_services function introduces a critical issue when attempting to import a tgz file. Specifically, the function uses open\_tar to open the file and then extractall to extract its contents. However, the problem arises because the names of the files extracted from the tgz file are not being validated. This leads to a ZIP Slip vulnerability.

In other words, if we name a file within the tgz archive as ../../../../.ssh/authorized\_keys and include an attacker’s SSH key as the content of this file, when the tgz file is imported and extracted, the system does not validate the file names. As a result, the data we provided will be written to the user's .ssh/authorized\_keys file on the system. This allows us to connect to the system via SSH remotely and gain control over it.

PoC

I have written a code that automates the entire process and eventually provides an SSH shell. You can watch the video below to analyze it. I will share the exploit's source code in the link below.

Poc Video: <https://youtu.be/9vdSzQp_-iM>

Exploit Source code: <https://mega.nz/folder/ZhIiDQaI#TUJCRV-XN41L-WEVAu0sWg>

Impact

This vulnerability allows remote attackers to execute arbitrary system commands, potentially leading to full system compromise and unauthorized access..

Sorry, something went wrong.

All reactions

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=40&v=4)](/0xs1ash)

`[Update controller.py](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529 "Update controller.py")`

`[22b0b44](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529)`

[![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=40&u=e3a65ddc04ddfe71e2a4314676d1fe6c217571de&v=4)](/afourmy)
[afourmy](/afourmy)
merged commit [`22b0b44`](/eNMS-automation/eNMS/commit/22b0b443acca740fc83b5544165c1f53eff3f529)
into
eNMS-automation:public

[Nov 23, 2024](https://github.com/eNMS-automation/eNMS/pull/419#event-15408542559)

[![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=80&u=e3a65ddc04ddfe71e2a4314676d1fe6c217571de&v=4)](/afourmy)

Copy link

Member

### **[afourmy](/afourmy)** commented [Nov 23, 2024](#issuecomment-2495640750)

| I modified it a bit before merging it, can you see if it is still working (I removed the part where we check that `base_path == target_path`, I don't think these paths should never be the same), and fixed the indentation (app couldn't load) |
| --- |

All reactions

Sorry, something went wrong.

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=80&u=d756cd4aa4d459f906b6c796dea302f251b82b05&v=4)](/0xs1ash)

Copy link

Contributor

Author

### **[0xs1ash](/0xs1ash)** commented [Nov 24, 2024](#issuecomment-2495835644)

| The update works perfectly, thank you. Please release the patch as a new version so that there is no confusion for those using the previous version, as this is version 4.2, and it is also labeled 4.2 here on GitHub. At first glance, people will think it is up-to-date. Please upgrade this to version 4.3 so it is recognized as the latest version. Thank you in advance, and I hope it won’t be an issue for you if I share this vulnerability on my blog since it has already been fixed. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=52&v=4)](/0xs1ash) [![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=52&v=4)](/afourmy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_15ab933c_20250114_213152.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419%2Fcommits%2F22b0b443acca740fc83b5544165c1f53eff3f529)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419%2Fcommits%2F22b0b443acca740fc83b5544165c1f53eff3f529)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=eNMS-automation%2FeNMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eNMS-automation](/eNMS-automation)
/
**[eNMS](/eNMS-automation/eNMS)**
Public

* [Notifications](/login?return_to=%2FeNMS-automation%2FeNMS) You must be signed in to change notification settings
* [Fork
  162](/login?return_to=%2FeNMS-automation%2FeNMS)
* [Star
   814](/login?return_to=%2FeNMS-automation%2FeNMS)

* [Code](/eNMS-automation/eNMS)
* [Issues
  27](/eNMS-automation/eNMS/issues)
* [Pull requests
  1](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects
  0](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

Additional navigation options

* [Code](/eNMS-automation/eNMS)
* [Issues](/eNMS-automation/eNMS/issues)
* [Pull requests](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)
to your account

# Update controller.py #419

 Merged

[afourmy](/afourmy)
merged 1 commit into
[eNMS-automation:public](/eNMS-automation/eNMS/tree/public "eNMS-automation/eNMS:public")
from
[0xs1ash:public](/0xs1ash/eNMS/tree/public "0xs1ash/eNMS:public")

Nov 23, 2024

[Conversation
2](/eNMS-automation/eNMS/pull/419)
[Commits
1](/eNMS-automation/eNMS/pull/419/commits)
[Checks
0](/eNMS-automation/eNMS/pull/419/checks)
[Files changed](/eNMS-automation/eNMS/pull/419/files)

 Merged

# [Update controller.py](#top) #419

 Changes from **all commits**

Commits

[Show all changes

1 commit](/eNMS-automation/eNMS/pull/419/files)
Select commit

[`22b0b44`
Update controller.py

0xs1ash Nov 23, 2024](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529)

**File filter**

### Filter by extension

Filter by extension

.py
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Update controller.py

* Loading branch information

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=40&v=4)](/0xs1ash)

[0xs1ash](/eNMS-automation/eNMS/commits?author=0xs1ash "View all commits by 0xs1ash")
authored
Nov 23, 2024

commit 22b0b443acca740fc83b5544165c1f53eff3f529

## There are no files selected for viewing

55 changes: 36 additions & 19 deletions

55
[eNMS/controller.py](#diff-790f15ed7b87843471c57009b5eece16eb525e96ce1faf12bd509da39121148d "eNMS/controller.py")

Show comments

[View file](/0xs1ash/eNMS/blob/22b0b443acca740fc83b5544165c1f53eff3f529/eNMS/controller.py)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1087,25 +1087,42 @@ def multiselect\_filtering(self, model, \*\*params): |
|  |  | } |
|  |  |  |
|  |  | def import\_services(self, \*\*kwargs): |
|  |  | file = kwargs["file"] |
|  |  | filepath = vs.file\_path / "services" / file.filename |
|  |  | (vs.file\_path / "services").mkdir(parents=True, exist\_ok=True) |
|  |  | file.save(str(filepath)) |
|  |  | with open\_tar(filepath) as tar\_file: |
|  |  | tar\_file.extractall(path=vs.file\_path / "services") |
|  |  | folder\_name = tar\_file.getmembers()[0].name |
|  |  | status = self.migration\_import( |
|  |  | folder="services", |
|  |  | name=folder\_name, |
|  |  | import\_export\_types=["service", "workflow\_edge"], |
|  |  | service\_import=True, |
|  |  | skip\_pool\_update=True, |
|  |  | skip\_model\_update=True, |
|  |  | ) |
|  |  | rmtree(vs.file\_path / "services" / folder\_name, ignore\_errors=True) |
|  |  | if "Error during import" in status: |
|  |  | raise Exception(status) |
|  |  | return status |
|  |  | file = kwargs["file"] |
|  |  | base\_path = vs.file\_path / "services" |
|  |  | base\_path.mkdir(parents=True, exist\_ok=True) |
|  |  |  |
|  |  | filepath = base\_path / file.filename |
|  |  | file.save(str(filepath)) |
|  |  |  |
|  |  | def is\_safe\_path(base\_path, target\_path): |
|  |  | return base\_path in target\_path.parents or base\_path == target\_path |
|  |  |  |
|  |  | with open\_tar(filepath) as tar\_file: |
|  |  | for member in tar\_file.getmembers(): |
|  |  | member\_path = Path(base\_path) / member.name |
|  |  | member\_path = member\_path.resolve() |
|  |  |  |
|  |  | if not is\_safe\_path(base\_path.resolve(), member\_path): |
|  |  | raise ValueError(f"Unsafe path detected: {member.name}") |
|  |  |  |
|  |  | tar\_file.extractall(path=base\_path) |
|  |  |  |
|  |  | folder\_name = tar\_file.getmembers()[0].name |
|  |  | status = self.migration\_import( |
|  |  | folder="services", |
|  |  | name=folder\_name, |
|  |  | import\_export\_types=["service", "workflow\_edge"], |
|  |  | service\_import=True, |
|  |  | skip\_pool\_update=True, |
|  |  | skip\_model\_update=True, |
|  |  | ) |
|  |  |  |
|  |  | rmtree(base\_path / folder\_name, ignore\_errors=True) |
|  |  |  |
|  |  | if "Error during import" in status: |
|  |  | raise Exception(status) |
|  |  |  |
|  |  | return status |
|  |  |  |
|  |  | def import\_topology(self, \*\*kwargs): |
|  |  | file = kwargs["file"] |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fa54eb60_20250114_213150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=eNMS-automation%2FeNMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eNMS-automation](/eNMS-automation)
/
**[eNMS](/eNMS-automation/eNMS)**
Public

* [Notifications](/login?return_to=%2FeNMS-automation%2FeNMS) You must be signed in to change notification settings
* [Fork
  162](/login?return_to=%2FeNMS-automation%2FeNMS)
* [Star
   814](/login?return_to=%2FeNMS-automation%2FeNMS)

* [Code](/eNMS-automation/eNMS)
* [Issues
  27](/eNMS-automation/eNMS/issues)
* [Pull requests
  1](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects
  0](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

Additional navigation options

* [Code](/eNMS-automation/eNMS)
* [Issues](/eNMS-automation/eNMS/issues)
* [Pull requests](/eNMS-automation/eNMS/pulls)
* [Discussions](/eNMS-automation/eNMS/discussions)
* [Projects](/eNMS-automation/eNMS/projects)
* [Security](/eNMS-automation/eNMS/security)
* [Insights](/eNMS-automation/eNMS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeNMS-automation%2FeNMS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Update controller.py #419

 Merged

[afourmy](/afourmy)
merged 1 commit into
[eNMS-automation:public](/eNMS-automation/eNMS/tree/public "eNMS-automation/eNMS:public")
from
[0xs1ash:public](/0xs1ash/eNMS/tree/public "0xs1ash/eNMS:public")

Nov 23, 2024

 Merged

# [Update controller.py](#top) #419

[afourmy](/afourmy)
merged 1 commit into
[eNMS-automation:public](/eNMS-automation/eNMS/tree/public "eNMS-automation/eNMS:public")
from
[0xs1ash:public](/0xs1ash/eNMS/tree/public "0xs1ash/eNMS:public")

Nov 23, 2024

[Conversation
2](/eNMS-automation/eNMS/pull/419)
[Commits
1](/eNMS-automation/eNMS/pull/419/commits)
[Checks
0](/eNMS-automation/eNMS/pull/419/checks)
[Files changed](/eNMS-automation/eNMS/pull/419/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=60&v=4)](/0xs1ash)

Copy link

Contributor

### @0xs1ash **[0xs1ash](/0xs1ash)** commented [Nov 23, 2024](#issue-2686386676)

Summary

I had previously informed you about the RCE in your admin panel, and you mentioned that it was a feature. I decided to dig deeper into the system and discovered a very critical vulnerability. I found an Arbitrary File Write vulnerability in the system, which leads to remote code execution.

Details

This is a vulnerability code section:

controller.py:

def import\_services(self, \*\*kwargs):

file = kwargs["file"]

filepath = vs.file\_path / "services" / file.filename

(vs.file\_path / "services").mkdir(parents=True, exist\_ok=True)

file.save(str(filepath))

with open\_tar(filepath) as tar\_file:

tar\_file.extractall(path=vs.file\_path / "services")

folder\_name = tar\_file.getmembers()[0].name

status = self.migration\_import(

folder="services",

name=folder\_name,

import\_export\_types=["service", "workflow\_edge"],

service\_import=True,

skip\_pool\_update=True,

skip\_model\_update=True,

)

rmtree(vs.file\_path / "services" / folder\_name, ignore\_errors=True)

if "Error during import" in status:

raise Exception(status)

return status

There is a serious vulnerability in the code I mentioned above. The import\_services function introduces a critical issue when attempting to import a tgz file. Specifically, the function uses open\_tar to open the file and then extractall to extract its contents. However, the problem arises because the names of the files extracted from the tgz file are not being validated. This leads to a ZIP Slip vulnerability.

In other words, if we name a file within the tgz archive as ../../../../.ssh/authorized\_keys and include an attacker’s SSH key as the content of this file, when the tgz file is imported and extracted, the system does not validate the file names. As a result, the data we provided will be written to the user's .ssh/authorized\_keys file on the system. This allows us to connect to the system via SSH remotely and gain control over it.

PoC

I have written a code that automates the entire process and eventually provides an SSH shell. You can watch the video below to analyze it. I will share the exploit's source code in the link below.

Poc Video: <https://youtu.be/9vdSzQp_-iM>

Exploit Source code: <https://mega.nz/folder/ZhIiDQaI#TUJCRV-XN41L-WEVAu0sWg>

Impact

This vulnerability allows remote attackers to execute arbitrary system commands, potentially leading to full system compromise and unauthorized access..

Sorry, something went wrong.

All reactions

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=40&v=4)](/0xs1ash)

`[Update controller.py](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529 "Update controller.py")`

`[22b0b44](/eNMS-automation/eNMS/pull/419/commits/22b0b443acca740fc83b5544165c1f53eff3f529)`

[![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=40&u=e3a65ddc04ddfe71e2a4314676d1fe6c217571de&v=4)](/afourmy)
[afourmy](/afourmy)
merged commit [`22b0b44`](/eNMS-automation/eNMS/commit/22b0b443acca740fc83b5544165c1f53eff3f529)
into
eNMS-automation:public

[Nov 23, 2024](https://github.com/eNMS-automation/eNMS/pull/419#event-15408542559)

[![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=80&u=e3a65ddc04ddfe71e2a4314676d1fe6c217571de&v=4)](/afourmy)

Copy link

Member

### **[afourmy](/afourmy)** commented [Nov 23, 2024](#issuecomment-2495640750)

| I modified it a bit before merging it, can you see if it is still working (I removed the part where we check that `base_path == target_path`, I don't think these paths should never be the same), and fixed the indentation (app couldn't load) |
| --- |

All reactions

Sorry, something went wrong.

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=80&u=d756cd4aa4d459f906b6c796dea302f251b82b05&v=4)](/0xs1ash)

Copy link

Contributor

Author

### **[0xs1ash](/0xs1ash)** commented [Nov 24, 2024](#issuecomment-2495835644)

| The update works perfectly, thank you. Please release the patch as a new version so that there is no confusion for those using the previous version, as this is version 4.2, and it is also labeled 4.2 here on GitHub. At first glance, people will think it is up-to-date. Please upgrade this to version 4.3 so it is recognized as the latest version. Thank you in advance, and I hope it won’t be an issue for you if I share this vulnerability on my blog since it has already been fixed. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FeNMS-automation%2FeNMS%2Fpull%2F419)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@0xs1ash](https://avatars.githubusercontent.com/u/87544644?s=52&v=4)](/0xs1ash) [![@afourmy](https://avatars.githubusercontent.com/u/16152622?s=52&v=4)](/afourmy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


