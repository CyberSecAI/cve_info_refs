The provided content describes a vulnerability in the `import_services` function of the `controller.py` file in the eNMS project. This is a classic **Zip Slip** vulnerability.

**Root cause of vulnerability:**

The vulnerability stems from the `import_services` function's flawed handling of TGZ archive extraction. Specifically, the function extracts files from a TGZ archive without validating the file names, allowing an attacker to include malicious file paths within the archive.

**Weaknesses/vulnerabilities present:**

*   **Path Traversal (Zip Slip):** The `tar_file.extractall(path=vs.file_path / "services")` extracts files without sanitizing file paths contained within the archive. This allows an attacker to craft a malicious TGZ archive containing files with paths like `../../../../.ssh/authorized_keys` to write to arbitrary locations.

**Impact of exploitation:**

*   **Arbitrary File Write:** By crafting a malicious TGZ archive, an attacker can write arbitrary files to the server.
*   **Remote Code Execution (RCE):** Specifically, writing to `~/.ssh/authorized_keys` allows the attacker to gain SSH access to the server, leading to full system compromise and unauthorized access.

**Attack vectors:**

*   The attacker uploads a malicious TGZ archive file through the `import_services` function.

**Required attacker capabilities/position:**

*   The attacker needs to have the ability to upload files to the system, specifically through the vulnerable `import_services` function.

**Additional Details**
*   The provided text includes a link to a PoC video and source code.
*   The vulnerability was fixed by adding a validation check using `is_safe_path` to ensure the target path is within the intended base directory.