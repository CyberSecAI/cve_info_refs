=== Content from www.wordfence.com_bcd2ae03_20250114_215805.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Greenshift – animation and page builder blocks <= 9.9.9.3 - Authenticated (Contributor+) Post Disclosure

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Greenshift – animation and page builder blocks <= 9.9.9.3 - Authenticated (Contributor+) Post Disclosure

4.3

**Authorization Bypass Through User-Controlled Key**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-11181](https://www.cve.org/CVERecord?id=CVE-2024-11181) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | December 11, 2024 |
| Last Updated | December 12, 2024 |
| Researcher | [Brian Sans-Souci (liardom)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/brian-sans-souci) |

### Description

The Greenshift – animation and page builder blocks plugin for WordPress is vulnerable to Information Exposure in all versions up to, and including, 9.9.9.3 via the 'wp\_reusable\_render' shortcode due to insufficient restrictions on which posts can be included. This makes it possible for authenticated attackers, with Contributor-level access and above, to extract data from password protected, private, or draft posts that they should not have access to.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php#L43)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php#L1236)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3203829/greenshift-animation-and-page-builder-blocks/trunk/settings.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fgreenshift-animation-and-page-builder-blocks%2Fgreenshift-animation-and-page-builder-blocks-9993-authenticated-contributor-post-disclosure&t=Greenshift%20%E2%80%93%20animation%20and%20page%20builder%20blocks%20%3C%3D%209.9.9.3%20-%20Authenticated%20%28Contributor%2B%29%20Post%20Disclosure "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fgreenshift-animation-and-page-builder-blocks%2Fgreenshift-animation-and-page-builder-blocks-9993-authenticated-contributor-post-disclosure&text=Greenshift%20%E2%80%93%20animation%20and%20page%20builder%20blocks%20%3C%3D%209.9.9.3%20-%20Authenticated%20%28Contributor%2B%29%20Post%20Disclosure "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fgreenshift-animation-and-page-builder-blocks%2Fgreenshift-animation-and-page-builder-blocks-9993-authenticated-contributor-post-disclosure "LinkedIn")
Email

## Vulnerability Details for Greenshift – animation and page builder blocks

#### [Greenshift – animation and page builder blocks](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/greenshift-animation-and-page-builder-blocks)

| Software Type | Plugin |
| --- | --- |
| Software Slug | greenshift-animation-and-page-builder-blocks [(view on wordpress.org)](https://wordpress.org/plugins/greenshift-animation-and-page-builder-blocks) |
| Patched? | Yes |
| Remediation | Update to version 9.9.9.4, or a newer patched version |
| Affected Version | * <= 9.9.9.3 |
| Patched Version | * 9.9.9.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_4249e362_20250114_215800.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fgreenshift-animation-and-page-builder-blocks%2Ftrunk%2Fsettings.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3219798 "Revision 3219798")
* Next Revision →
* [Blame](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/greenshift-animation-and-page-builder-blocks/trunk/settings.php)

---

# [source:](/browser?order=name "Go to repository root") [greenshift-animation-and-page-builder-blocks](/browser/greenshift-animation-and-page-builder-blocks?order=name "View greenshift-animation-and-page-builder-blocks")/[trunk](/browser/greenshift-animation-and-page-builder-blocks/trunk?order=name "View trunk")/[settings.php](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?order=name "View settings.php")

View diff against:

View revision:

| [Last change](/changeset/3221806/greenshift-animation-and-page-builder-blocks/trunk/settings.php "View differences") on this file was [3221806](/changeset/3221806/ "View changeset 3221806"), checked in by wpsoul, [25 hours ago](/timeline?from=2025-01-13T20%3A42%3A18Z&precision=second "See timeline at 01/13/2025 08:42:18 PM") |
| --- |
| update |
| **File size:** 76.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | // Exit if accessed directly |
| [3](#L3) | if (!defined('ABSPATH')) { |
| [4](#L4) | exit; |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | if (!class\_exists('GSPB\_GreenShift\_Settings')) { |
| [8](#L8) |  |
| [9](#L9) | class GSPB\_GreenShift\_Settings |
| [10](#L10) | { |
| [11](#L11) | private $allowed\_font\_ext = [ |
| [12](#L12) | 'woff2', |
| [13](#L13) | 'woff', |
| [14](#L14) | 'tiff', |
| [15](#L15) | 'ttf', |
| [16](#L16) | ]; |
| [17](#L17) |  |
| [18](#L18) | private $global\_settings = array(); |
| [19](#L19) |  |
| [20](#L20) | public function \_\_construct() |
| [21](#L21) | { |
| [22](#L22) | $this->global\_settings = get\_option('gspb\_global\_settings'); |
| [23](#L23) | add\_filter('body\_class', array($this, 'gspb\_front\_body\_class')); |
| [24](#L24) |  |
| [25](#L25) | add\_filter('admin\_body\_class', array($this, 'gspb\_admin\_body\_class')); |
| [26](#L26) | add\_action('admin\_menu', array($this, 'greenshift\_admin\_page')); |
| [27](#L27) | add\_action('wp\_footer', array($this, 'greenshift\_additional\_\_footer\_elements')); |
| [28](#L28) | add\_action('wp\_head', array($this, 'greenshift\_additional\_\_header\_elements')); |
| [29](#L29) | add\_action('wp\_ajax\_gspb\_generate\_stylebook', array($this, 'gspb\_generate\_stylebook')); |
| [30](#L30) | add\_action('admin\_init', array($this, 'gspb\_stylebook\_redirect')); |
| [31](#L31) | add\_action('admin\_enqueue\_scripts', array($this, 'greenshift\_admin\_enqueue\_scripts')); |
| [32](#L32) | add\_filter('block\_categories\_all', array($this, 'gspb\_greenShift\_category'), 11, 2); |
| [33](#L33) | add\_filter('block\_editor\_settings\_all', array($this, 'gspb\_generate\_custom\_block\_settings'), 10, 2); |
| [34](#L34) | if (!defined('REHUB\_ADMIN\_DIR')) { |
| [35](#L35) | //Show Reusable blocks column |
| [36](#L36) | add\_filter('manage\_wp\_block\_posts\_columns', array($this, 'gspb\_template\_screen\_add\_column')); |
| [37](#L37) | add\_action('manage\_wp\_block\_posts\_custom\_column', array($this, 'gspb\_template\_screen\_fill\_column'), 1000, 2); |
| [38](#L38) | // Force Block editor for Reusable Blocks even when Classic editor plugin is activated |
| [39](#L39) | add\_filter('use\_block\_editor\_for\_post', array($this, 'gspb\_template\_gutenberg\_post'), 1000, 2); |
| [40](#L40) | add\_filter('use\_block\_editor\_for\_post\_type', array($this, 'gspb\_template\_gutenberg\_post\_type'), 1000, 2); |
| [41](#L41) | //Shortcode output for reusable blocks |
| [42](#L42) | add\_shortcode('wp\_reusable\_render', array($this, 'gspb\_template\_shortcode\_function')); |
| [43](#L43) | //Ajax render action |
| [44](#L44) | add\_action('wp\_ajax\_gspb\_el\_reusable\_load', array($this, 'gspb\_el\_reusable\_load')); |
| [45](#L45) | add\_action('wp\_ajax\_nopriv\_gspb\_el\_reusable\_load', array($this, 'gspb\_el\_reusable\_load')); |
| [46](#L46) | //settings fonts actions |
| [47](#L47) | add\_action('wp\_ajax\_gspb\_settings\_add\_font', array($this, 'gspb\_settings\_add\_font')); |
| [48](#L48) | } |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | public function gspb\_front\_body\_class($classes) |
| [52](#L52) | { |
| [53](#L53) | $classes[] = 'gspbody'; |
| [54](#L54) | $classes[] = 'gspb-bodyfront'; |
| [55](#L55) | $global\_settings = $this->global\_settings; |
| [56](#L56) | if (!empty($global\_settings['dark\_mode\_on'])) { |
| [57](#L57) | if (isset($\_COOKIE['darkmode'])){ |
| [58](#L58) | $classes[] = 'darkmode'; |
| [59](#L59) | } |
| [60](#L60) | } |
| [61](#L61) | return $classes; |
| [62](#L62) | } |
| [63](#L63) | public function gspb\_admin\_body\_class($classes) |
| [64](#L64) | { |
| [65](#L65) | $classes .= ' gspbody gspb-bodyadmin '; |
| [66](#L66) | return $classes; |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | function gspb\_generate\_custom\_block\_settings($settings, $block\_editor\_context) |
| [70](#L70) | { |
| [71](#L71) | $global\_settings = $this->global\_settings; |
| [72](#L72) | if (empty($global\_settings['anchors\_disable'])) { |
| [73](#L73) | $settings['generateAnchors'] = true; |
| [74](#L74) | } |
| [75](#L75) | if (!empty($global\_settings['simplified\_panels'])) { |
| [76](#L76) | $settings['canLockBlocks'] = current\_user\_can( 'manage\_options' ); |
| [77](#L77) | } |
| [78](#L78) | return $settings; |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | public function gspb\_greenShift\_category($categories, $post) |
| [82](#L82) | { |
| [83](#L83) | $global\_settings = $this->global\_settings; |
| [84](#L84) | if ((!empty($global\_settings['show\_element\_block']) && ($global\_settings['show\_element\_block'] === 'bothelement' || $global\_settings['show\_element\_block'] === 'element'))) { |
| [85](#L85) | return array\_merge( |
| [86](#L86) | array( |
| [87](#L87) | array( |
| [88](#L88) | 'slug'  => 'GreenLightLayout', |
| [89](#L89) | 'title' => \_\_('GreenLight Layout Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [90](#L90) | ), |
| [91](#L91) | array( |
| [92](#L92) | 'slug'  => 'GreenLightContent', |
| [93](#L93) | 'title' => \_\_('GreenLight Content Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [94](#L94) | ), |
| [95](#L95) | array( |
| [96](#L96) | 'slug'  => 'GreenLightExtra', |
| [97](#L97) | 'title' => \_\_('GreenLight Extra Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [98](#L98) | ), |
| [99](#L99) | array( |
| [100](#L100) | 'slug'  => 'GreenLightTags', |
| [101](#L101) | 'title' => \_\_('GreenLight Tags Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [102](#L102) | ), |
| [103](#L103) | array( |
| [104](#L104) | 'slug'  => 'GreenShiftLayout', |
| [105](#L105) | 'title' => \_\_('GreenShift Layout Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [106](#L106) | ), |
| [107](#L107) | array( |
| [108](#L108) | 'slug'  => 'GreenShiftContent', |
| [109](#L109) | 'title' => \_\_('GreenShift Content Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [110](#L110) | ), |
| [111](#L111) | array( |
| [112](#L112) | 'slug'  => 'GreenShiftExtra', |
| [113](#L113) | 'title' => \_\_('GreenShift Extra Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [114](#L114) | ), |
| [115](#L115) | ), |
| [116](#L116) | $categories |
| [117](#L117) | ); |
| [118](#L118) | }else{ |
| [119](#L119) | return array\_merge( |
| [120](#L120) | array( |
| [121](#L121) | array( |
| [122](#L122) | 'slug'  => 'GreenShiftLayout', |
| [123](#L123) | 'title' => \_\_('GreenShift Layout Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [124](#L124) | ), |
| [125](#L125) | array( |
| [126](#L126) | 'slug'  => 'GreenShiftContent', |
| [127](#L127) | 'title' => \_\_('GreenShift Content Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [128](#L128) | ), |
| [129](#L129) | array( |
| [130](#L130) | 'slug'  => 'GreenShiftExtra', |
| [131](#L131) | 'title' => \_\_('GreenShift Extra Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [132](#L132) | ), |
| [133](#L133) | array( |
| [134](#L134) | 'slug'  => 'GreenLightLayout', |
| [135](#L135) | 'title' => \_\_('GreenLight Layout Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [136](#L136) | ), |
| [137](#L137) | array( |
| [138](#L138) | 'slug'  => 'GreenLightContent', |
| [139](#L139) | 'title' => \_\_('GreenLight Content Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [140](#L140) | ), |
| [141](#L141) | array( |
| [142](#L142) | 'slug'  => 'GreenLightExtra', |
| [143](#L143) | 'title' => \_\_('GreenLight Extra Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [144](#L144) | ), |
| [145](#L145) | array( |
| [146](#L146) | 'slug'  => 'GreenLightTags', |
| [147](#L147) | 'title' => \_\_('GreenLight Tags Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [148](#L148) | ), |
| [149](#L149) | ), |
| [150](#L150) | $categories |
| [151](#L151) | ); |
| [152](#L152) | } |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | public function greenshift\_admin\_enqueue\_scripts() |
| [156](#L156) | { |
| [157](#L157) | $current\_page = isset($\_GET['page']) ? $\_GET['page'] : ''; |
| [158](#L158) |  |
| [159](#L159) | // Check if the current admin page URL starts with 'greenshift' |
| [160](#L160) | if (strpos($current\_page, 'greenshift') === 0) { |
| [161](#L161) | wp\_enqueue\_style( 'greenShift-admin-css' ); |
| [162](#L162) | } |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) | public function greenshift\_admin\_page() |
| [166](#L166) | { |
| [167](#L167) |  |
| [168](#L168) | $parent\_slug = 'greenshift\_dashboard'; |
| [169](#L169) |  |
| [170](#L170) | if (!defined('REHUB\_ADMIN\_DIR')) { |
| [171](#L171) | add\_menu\_page( |
| [172](#L172) | esc\_html\_\_('Reusable Templates', 'greenshift-animation-and-page-builder-blocks'), |
| [173](#L173) | esc\_html\_\_('Reusable Templates', 'greenshift-animation-and-page-builder-blocks'), |
| [174](#L174) | 'manage\_options',  // Capability required to access the menu item |
| [175](#L175) | 'edit.php?post\_type=wp\_block',  // URL of the custom link |
| [176](#L176) | '', |
| [177](#L177) | 'dashicons-screenoptions',  // Icon URL (optional) |
| [178](#L178) | 71  // Position of the menu item (use a number to set the position; 6 will place the item below "Settings") |
| [179](#L179) | ); |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) |  |
| [183](#L183) | add\_menu\_page( |
| [184](#L184) | 'GreenShift', |
| [185](#L185) | 'GreenShift', |
| [186](#L186) | 'manage\_options', |
| [187](#L187) | $parent\_slug, |
| [188](#L188) | array($this, 'welcome\_page'), |
| [189](#L189) | plugin\_dir\_url(\_\_FILE\_\_) . 'libs/gspbLogo.svg', |
| [190](#L190) | 70 |
| [191](#L191) | ); |
| [192](#L192) |  |
| [193](#L193) | add\_submenu\_page( |
| [194](#L194) | $parent\_slug, |
| [195](#L195) | esc\_html\_\_('Settings', 'greenshift-animation-and-page-builder-blocks'), |
| [196](#L196) | esc\_html\_\_('Settings', 'greenshift-animation-and-page-builder-blocks'), |
| [197](#L197) | 'manage\_options', |
| [198](#L198) | 'greenshift', |
| [199](#L199) | array($this, 'settings\_page') |
| [200](#L200) | ); |
| [201](#L201) |  |
| [202](#L202) | add\_submenu\_page( |
| [203](#L203) | $parent\_slug, |
| [204](#L204) | esc\_html\_\_('Addons', 'greenshift-animation-and-page-builder-blocks'), |
| [205](#L205) | esc\_html\_\_('Addons', 'greenshift-animation-and-page-builder-blocks'), |
| [206](#L206) | 'manage\_options', |
| [207](#L207) | 'greenshift\_dashboard-addons', |
| [208](#L208) | array($this, 'addons\_page') |
| [209](#L209) | ); |
| [210](#L210) |  |
| [211](#L211) | add\_submenu\_page( |
| [212](#L212) | $parent\_slug, |
| [213](#L213) | esc\_html\_\_('Upgrade', 'greenshift-animation-and-page-builder-blocks'), |
| [214](#L214) | esc\_html\_\_('Upgrade', 'greenshift-animation-and-page-builder-blocks'), |
| [215](#L215) | 'manage\_options', |
| [216](#L216) | 'greenshift\_upgrade', |
| [217](#L217) | array($this, 'upgrade\_page') |
| [218](#L218) | ); |
| [219](#L219) |  |
| [220](#L220) | add\_submenu\_page( |
| [221](#L221) | $parent\_slug, |
| [222](#L222) | esc\_html\_\_('Contact Us', 'greenshift-animation-and-page-builder-blocks'), |
| [223](#L223) | esc\_html\_\_('Contact Us', 'greenshift-animation-and-page-builder-blocks'), |
| [224](#L224) | 'manage\_options', |
| [225](#L225) | 'greenshift\_contact', |
| [226](#L226) | array($this, 'contact\_page') |
| [227](#L227) | ); |
| [228](#L228) | add\_submenu\_page( |
| [229](#L229) | $parent\_slug, |
| [230](#L230) | esc\_html\_\_('Import/Export', 'greenshift-animation-and-page-builder-blocks'), |
| [231](#L231) | esc\_html\_\_('Import/Export', 'greenshift-animation-and-page-builder-blocks'), |
| [232](#L232) | 'manage\_options', |
| [233](#L233) | 'greenshift\_import', |
| [234](#L234) | array($this, 'import\_page') |
| [235](#L235) | ); |
| [236](#L236) | add\_submenu\_page( |
| [237](#L237) | $parent\_slug, |
| [238](#L238) | esc\_html\_\_('Demo Import', 'greenshift-animation-and-page-builder-blocks'), |
| [239](#L239) | esc\_html\_\_('Demo Import', 'greenshift-animation-and-page-builder-blocks'), |
| [240](#L240) | 'manage\_options', |
| [241](#L241) | 'greenshift\_demo', |
| [242](#L242) | array($this, 'import\_demo') |
| [243](#L243) | ); |
| [244](#L244) |  |
| [245](#L245) | $stylebook\_post\_id = get\_option('gspb\_stylebook\_id'); |
| [246](#L246) |  |
| [247](#L247) | if ($stylebook\_post\_id) { |
| [248](#L248) |  |
| [249](#L249) | $editposturl = admin\_url('post.php?post=' . $stylebook\_post\_id . '&action=edit'); |
| [250](#L250) |  |
| [251](#L251) | add\_submenu\_page( |
| [252](#L252) | $parent\_slug, |
| [253](#L253) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [254](#L254) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [255](#L255) | 'manage\_options', |
| [256](#L256) | $editposturl |
| [257](#L257) | ); |
| [258](#L258) | } else { |
| [259](#L259) |  |
| [260](#L260) | add\_submenu\_page( |
| [261](#L261) | $parent\_slug, |
| [262](#L262) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [263](#L263) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [264](#L264) | 'manage\_options', |
| [265](#L265) | 'greenshift\_stylebook', |
| [266](#L266) | array($this, 'stylebook\_page\_callback') |
| [267](#L267) | ); |
| [268](#L268) | } |
| [269](#L269) | } |
| [270](#L270) |  |
| [271](#L271) | public function welcome\_page() |
| [272](#L272) | { |
| [273](#L273) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/welcome-page.php'; |
| [274](#L274) | } |
| [275](#L275) |  |
| [276](#L276) | public function contact\_page() |
| [277](#L277) | { |
| [278](#L278) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/contact-page.php'; |
| [279](#L279) | } |
| [280](#L280) |  |
| [281](#L281) | public function import\_page() |
| [282](#L282) | { |
| [283](#L283) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/import-page.php'; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | public function import\_demo() |
| [287](#L287) | { |
| [288](#L288) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/import-demo.php'; |
| [289](#L289) | } |
| [290](#L290) |  |
| [291](#L291) | public function addons\_page() |
| [292](#L292) | { |
| [293](#L293) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/addon-page.php'; |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | public function upgrade\_page() |
| [297](#L297) | { |
| [298](#L298) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/upgrade-page.php'; |
| [299](#L299) | } |
| [300](#L300) |  |
| [301](#L301) | public function stylebook\_page\_callback() |
| [302](#L302) | { |
| [303](#L303) | ?> |
| [304](#L304) | <style> |
| [305](#L305) | #greenshift\_stylebook\_btn { |
| [306](#L306) | margin-top: 30px; |
| [307](#L307) | width: 220px; |
| [308](#L308) | height: 40px; |
| [309](#L309) | font-size: 1rem; |
| [310](#L310) | line-height: 1rem; |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | .stylbook\_btn\_wrapper { |
| [314](#L314) | position: relative; |
| [315](#L315) | display: flex; |
| [316](#L316) | align-items: center; |
| [317](#L317) | } |
| [318](#L318) | </style> |
| [319](#L319) | <script> |
| [320](#L320) | jQuery(document).ready(function($) { |
| [321](#L321) | // Stylebook ajax request |
| [322](#L322) | $("#stylebook\_generation").submit(function(e) { |
| [323](#L323) | e.preventDefault(); |
| [324](#L324) |  |
| [325](#L325) | $('#ajax-response').html(''); |
| [326](#L326) |  |
| [327](#L327) | const targetForm = e.target; |
| [328](#L328) | const payload = new FormData(targetForm); |
| [329](#L329) | payload.append("action", "gspb\_generate\_stylebook") |
| [330](#L330) | $.ajax({ |
| [331](#L331) | method: "POST", |
| [332](#L332) | url: ajaxurl, |
| [333](#L333) | processData: false, |
| [334](#L334) | contentType: false, |
| [335](#L335) | data: payload, |
| [336](#L336) | beforeSend: function(response) { |
| [337](#L337) | $(".spinner").addClass("is-active"); |
| [338](#L338) | } |
| [339](#L339) | }) |
| [340](#L340) | .success(function(response) { |
| [341](#L341) | $(".spinner").removeClass("is-active"); |
| [342](#L342) | if (response.data.status == "success") { |
| [343](#L343) | const post\_link = response?.data?.post\_link; |
| [344](#L344) | if (post\_link) { |
| [345](#L345) | const postEditLink = post\_link.replace(/&amp;/g, '&'); |
| [346](#L346) | window.location.href = postEditLink; |
| [347](#L347) | } |
| [348](#L348) | } |
| [349](#L349) | if (response.data.status == "error") { |
| [350](#L350) | $('#ajax-response').append('<div class="notice notice-error"><p>' + response.data.msg + '</p></div>'); |
| [351](#L351) | } |
| [352](#L352) | }) |
| [353](#L353) | .error(function(response) { |
| [354](#L354) | $(".spinner").removeClass("is-active"); |
| [355](#L355) | $('#ajax-response').append('<div class="notice notice-error"><p>Something went wrong.</p></div>'); |
| [356](#L356) | }); |
| [357](#L357) |  |
| [358](#L358) | }); |
| [359](#L359) | }); |
| [360](#L360) | </script> |
| [361](#L361) | <div class="stylebook\_form\_wrap" style="padding:25px"> |
| [362](#L362) | <h1><?php \_e('GreenShift Stylebook', 'greenshift-animation-and-page-builder-blocks'); ?></h1> |
| [363](#L363) | <div id="ajax-response"> </div> |
| [364](#L364) | <form id="stylebook\_generation" method="post" class="stylbook\_btn\_wrapper"> |
| [365](#L365) | <?php wp\_nonce\_field('gspb\_generate\_stylebook', 'gspb\_stylebook'); ?> |
| [366](#L366) | <div class="stylbook\_btn\_wrapper"> |
| [367](#L367) | <input type="submit" id="greenshift\_stylebook\_btn" name="greenshift\_stylebook\_btn" value=<?php \_e('Create Stylebook', 'greenshift-animation-and-page-builder-blocks'); ?> class="button button-primary button-large"> |
| [368](#L368) | <span class="spinner"></span> |
| [369](#L369) | </div> |
| [370](#L370) | </form> |
| [371](#L371) | </div> |
| [372](#L372) | <?php |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | public function gspb\_stylebook\_redirect() |
| [376](#L376) | { |
| [377](#L377) | if (isset($\_GET['post\_type']) && $\_GET['post\_type'] === 'gspbstylebook') { |
| [378](#L378) | wp\_safe\_redirect(admin\_url('?page=greenshift\_dashboard')); |
| [379](#L379) | exit; |
| [380](#L380) | } |
| [381](#L381) | } |
| [382](#L382) |  |
| [383](#L383) | public function gspb\_generate\_stylebook() |
| [384](#L384) | { |
| [385](#L385) |  |
| [386](#L386) | $response = array(); |
| [387](#L387) |  |
| [388](#L388) | if (!isset($\_POST['gspb\_stylebook'])  || !wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_stylebook'])), 'gspb\_generate\_stylebook')) { |
| [389](#L389) |  |
| [390](#L390) | $response =  array( |
| [391](#L391) | 'status' => 'error', |
| [392](#L392) | 'msg' => 'User Security not varified.' |
| [393](#L393) | ); |
| [394](#L394) | } else { |
| [395](#L395) | $stylebook\_post\_id = get\_option('gspb\_stylebook\_id'); |
| [396](#L396) |  |
| [397](#L397) | if (!$stylebook\_post\_id || !get\_edit\_post\_link($stylebook\_post\_id)) { |
| [398](#L398) |  |
| [399](#L399) | // Create post object |
| [400](#L400) | $stylebook\_post = array( |
| [401](#L401) | 'post\_title'    => 'Greenshift Stylebook', |
| [402](#L402) | 'post\_type'             => 'gspbstylebook', |
| [403](#L403) | 'post\_name'             =>      'greenshift-stylebook', |
| [404](#L404) | 'post\_content'  =>      '<!-- wp:greenshift-blocks/stylebook /-->', |
| [405](#L405) | 'post\_status'   => 'publish', |
| [406](#L406) | ); |
| [407](#L407) |  |
| [408](#L408) | // Insert the post into the database |
| [409](#L409) | $stylebook\_post\_id = wp\_insert\_post($stylebook\_post); |
| [410](#L410) |  |
| [411](#L411) | if (!is\_wp\_error($stylebook\_post\_id)) { |
| [412](#L412) |  |
| [413](#L413) | $response =  array( |
| [414](#L414) | 'status' => 'success', |
| [415](#L415) | 'post\_link' => get\_edit\_post\_link($stylebook\_post\_id) |
| [416](#L416) | ); |
| [417](#L417) |  |
| [418](#L418) | update\_option('gspb\_stylebook\_id', $stylebook\_post\_id); |
| [419](#L419) |  |
| [420](#L420) | // we need to flush this because post is created programatically. |
| [421](#L421) | flush\_rewrite\_rules(); |
| [422](#L422) | } else { |
| [423](#L423) |  |
| [424](#L424) | $response =  array( |
| [425](#L425) | 'status' => 'error', |
| [426](#L426) | 'msg' => $stylebook\_post\_id->get\_error\_message() |
| [427](#L427) | ); |
| [428](#L428) |  |
| [429](#L429) | return $response; |
| [430](#L430) | } |
| [431](#L431) | } else { |
| [432](#L432) |  |
| [433](#L433) | $response =  array( |
| [434](#L434) | 'status' => 'success', |
| [435](#L435) | 'post\_link' => get\_edit\_post\_link($stylebook\_post\_id) |
| [436](#L436) | ); |
| [437](#L437) | } |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) | wp\_send\_json\_success($response); |
| [441](#L441) | } |
| [442](#L442) |  |
| [443](#L443) | public function settings\_page() |
| [444](#L444) | { |
| [445](#L445) |  |
| [446](#L446) | if (!current\_user\_can('manage\_options')) { |
| [447](#L447) | wp\_die('Unauthorized user'); |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) | // Get the active tab from the $\_GET param |
| [451](#L451) | $default\_tab = null; |
| [452](#L452) | $tab  = isset($\_GET['tab']) ? sanitize\_text\_field($\_GET['tab']) : $default\_tab; |
| [453](#L453) |  |
| [454](#L454) | ?> |
| [455](#L455) |  |
| [456](#L456) | <div class="wp-block-greenshift-blocks-container alignfull gspb\_container gspb\_container-gsbp-ead11204-4841" id="gspb\_container-id-gsbp-ead11204-4841"> |
| [457](#L457) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-cbc3fa8c-bb26" id="gspb\_container-id-gsbp-cbc3fa8c-bb26"> |
| [458](#L458) |  |
| [459](#L459) | <?php $activetab = 'settings'; ?> |
| [460](#L460) | <?php include(GREENSHIFT\_DIR\_PATH . 'templates/admin/navleft.php'); ?> |
| [461](#L461) |  |
| [462](#L462) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-89d45563-1559" id="gspb\_container-id-gsbp-89d45563-1559"> |
| [463](#L463) |  |
| [464](#L464) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-efb64efe-d083" id="gspb\_container-id-gsbp-efb64efe-d083"> |
| [465](#L465) | <h2 id="gspb\_heading-id-gsbp-ca0b0ada-6561" class="gspb\_heading gspb\_heading-id-gsbp-ca0b0ada-6561 "><?php esc\_html\_e("Settings", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [466](#L466) | </div> |
| [467](#L467) |  |
| [468](#L468) | <div class="class-tabs-gs wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-01099b45-f36b" id="gspb\_container-id-gsbp-01099b45-f36b"> |
| [469](#L469) | <a href="?page=greenshift" id="gspb\_text-id-gsbp-2c96ad79-8324" class="gspb\_text gspb\_text-id-gsbp-2c96ad79-8324 <?php if ($tab === null) : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Font Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [470](#L470) | <a href="?page=greenshift&tab=breakpoints" id="gspb\_text-id-gsbp-557ed921-38fe" class="gspb\_text gspb\_text-id-gsbp-557ed921-38fe <?php if ($tab === 'breakpoints') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Breakpoints", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [471](#L471) | <a href="?page=greenshift&tab=save\_css" id="gspb\_text-id-gsbp-94bd1cf0-c77b" class="gspb\_text gspb\_text-id-gsbp-94bd1cf0-c77b <?php if ($tab === 'save\_css') : ?>gs-tab-active<?php endif; ?> "><?php esc\_html\_e("CSS Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [472](#L472) | <a href="?page=greenshift&tab=scripts" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'scripts') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Script Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [473](#L473) | <a href="?page=greenshift&tab=header" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'header') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Header/Footer code", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [474](#L474) | <a href="?page=greenshift&tab=interface" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'interface') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Interface", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [475](#L475) | <a href="?page=greenshift&tab=keys" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'keys') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("API Keys", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [476](#L476) | </div> |
| [477](#L477) |  |
| [478](#L478) |  |
| [479](#L479) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-7b4f8e8f-1a69" id="gspb\_container-id-gsbp-7b4f8e8f-1a69"> |
| [480](#L480) | <div class="greenshift\_form"> |
| [481](#L481) | <?php |
| [482](#L482) | switch ($tab): |
| [483](#L483) | case 'save\_css': |
| [484](#L484) |  |
| [485](#L485) | if (isset($\_POST['gspb\_save\_settings'])) { |
| [486](#L486) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [487](#L487) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [488](#L488) | return; |
| [489](#L489) | } |
| [490](#L490) | update\_option('gspb\_css\_save', sanitize\_text\_field($\_POST['gspb\_settings\_option'])); |
| [491](#L491) |  |
| [492](#L492) | $default\_settings = get\_option('gspb\_global\_settings'); |
| [493](#L493) |  |
| [494](#L494) | $sanitised = array(); |
| [495](#L495) | if (!empty($\_POST['reusablestyles'])) { |
| [496](#L496) | foreach ($\_POST['reusablestyles'] as $key => $value) { |
| [497](#L497) | $sanitised['reusablestyles'][$key] = array( |
| [498](#L498) | "style" => sanitize\_textarea\_field($value['style']), |
| [499](#L499) | "blockname" =>  sanitize\_text\_field($value['blockname']), |
| [500](#L500) | ); |
| [501](#L501) | } |
| [502](#L502) | $newargs = wp\_parse\_args($sanitised, $default\_settings); |
| [503](#L503) | update\_option('gspb\_global\_settings', $newargs); |
| [504](#L504) | } |
| [505](#L505) | if (isset($\_POST['dark\_mode\_on'])) { |
| [506](#L506) | $newargs = wp\_parse\_args(array('dark\_mode\_on' => true), $default\_settings); |
| [507](#L507) | update\_option('gspb\_global\_settings', $newargs); |
| [508](#L508) | } else { |
| [509](#L509) | $newargs = wp\_parse\_args(array('dark\_mode\_on' => false), $default\_settings); |
| [510](#L510) | update\_option('gspb\_global\_settings', $newargs); |
| [511](#L511) | } |
| [512](#L512) | if (isset($\_POST['enable\_head\_inline'])) { |
| [513](#L513) | $newargs = wp\_parse\_args(array('enable\_head\_inline' => true), $default\_settings); |
| [514](#L514) | update\_option('gspb\_global\_settings', $newargs); |
| [515](#L515) | } else { |
| [516](#L516) | $newargs = wp\_parse\_args(array('enable\_head\_inline' => false), $default\_settings); |
| [517](#L517) | update\_option('gspb\_global\_settings', $newargs); |
| [518](#L518) | } |
| [519](#L519) | } |
| [520](#L520) |  |
| [521](#L521) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [522](#L522) | $css\_tsyle\_option = get\_option('gspb\_css\_save'); |
| [523](#L523) | $dark\_mode\_on = !empty($global\_settings['dark\_mode\_on']) ? $global\_settings['dark\_mode\_on'] : ''; |
| [524](#L524) | $enable\_head\_inline = !empty($global\_settings['enable\_head\_inline']) ? $global\_settings['enable\_head\_inline'] : ''; |
| [525](#L525) | ?> |
| [526](#L526) | <div class="gspb\_settings\_form"> |
| [527](#L527) | <form method="POST"> |
| [528](#L528) | <div class="greenshift\_form"> |
| [529](#L529) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [530](#L530) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [531](#L531) | <div class="gs-box notice\_type icon\_type"> |
| [532](#L532) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [533](#L533) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [534](#L534) | </svg></div> |
| [535](#L535) | <div class="gs-box-text"> |
| [536](#L536) | <?php esc\_html\_e("Use Inline in block only if you have some issues with not updating styles of blocks or cache. Once saved as inline in block, styles can be overwritten only when you update post with blocks", 'greenshift-animation-and-page-builder-blocks'); ?> |
| [537](#L537) | </div> |
| [538](#L538) | </div> |
| [539](#L539) | </div> |
| [540](#L540) | <table class="form-table"> |
| [541](#L541) | <tr> |
| [542](#L542) | <td> <label for="css\_system"><?php esc\_html\_e("Css location", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [543](#L543) | <td> |
| [544](#L544) | <select name="gspb\_settings\_option"> |
| [545](#L545) | <option value="inline" <?php selected($css\_tsyle\_option, 'inline'); ?>><?php esc\_html\_e("Inline in Head", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [546](#L546) | <option value="inlineblock" <?php selected($css\_tsyle\_option, 'inlineblock'); ?>> <?php esc\_html\_e("Inline in block", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [547](#L547) | </select> |
| [548](#L548) | </td> |
| [549](#L549) | </tr> |
| [550](#L550) | <tr> |
| [551](#L551) | <td> <label for="dark\_mode\_on"><?php esc\_html\_e("Enable detection of dark mode before site loading", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [552](#L552) | <td> |
| [553](#L553) | <input type="checkbox" name="dark\_mode\_on" id="dark\_mode\_on" <?php echo $dark\_mode\_on == true ? 'checked' : ''; ?> /> |
| [554](#L554) | </td> |
| [555](#L555) | </tr> |
| [556](#L556) | <tr> |
| [557](#L557) | <td> <label for="enable\_head\_inline"><?php esc\_html\_e("Try to merge all inline styles (Beta, works only in block themes)", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [558](#L558) | <td> |
| [559](#L559) | <input type="checkbox" name="enable\_head\_inline" id="enable\_head\_inline" <?php echo $enable\_head\_inline == true ? 'checked' : ''; ?> /> |
| [560](#L560) | </td> |
| [561](#L561) | </tr> |
| [562](#L562) | </table> |
| [563](#L563) |  |
| [564](#L564) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [565](#L565) | </div> |
| [566](#L566) |  |
| [567](#L567) | </form> |
| [568](#L568) | </div> |
| [569](#L569) | <?php |
| [570](#L570) | break; |
| [571](#L571) | case 'interface': |
| [572](#L572) |  |
| [573](#L573) | if (isset($\_POST['gspb\_save\_settings'])) { |
| [574](#L574) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [575](#L575) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [576](#L576) | return; |
| [577](#L577) | } |
| [578](#L578) | $default\_settings = get\_option('gspb\_global\_settings'); |
| [579](#L579) | if(empty($default\_settings)){ |
| [580](#L580) | $default\_settings = array(); |
| [581](#L581) | } |
| [582](#L582) |  |
| [583](#L583) | if (isset($\_POST['cf\_utility\_on'])) { |
| [584](#L584) | $default\_settings['cf\_utility\_on'] = true; |
| [585](#L585) | } else { |
| [586](#L586) | $default\_settings['cf\_utility\_on'] = false; |
| [587](#L587) | } |
| [588](#L588) |  |
| [589](#L589) | if (isset($\_POST['anchors\_disable'])) { |
| [590](#L590) | $default\_settings['anchors\_disable'] = true; |
| [591](#L591) | } else { |
| [592](#L592) | $default\_settings['anchors\_disable'] = false; |
| [593](#L593) | } |
| [594](#L594) |  |
| [595](#L595) | if (isset($\_POST['row\_padding\_disable'])) { |
| [596](#L596) | $default\_settings['row\_padding\_disable'] = true; |
| [597](#L597) | } else { |
| [598](#L598) | $default\_settings['row\_padding\_disable'] = false; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | if (isset($\_POST['dark\_accent\_scheme'])) { |
| [602](#L602) | $default\_settings['dark\_accent\_scheme'] = true; |
| [603](#L603) | } else { |
| [604](#L604) | $default\_settings['dark\_accent\_scheme'] = false; |
| [605](#L605) | } |
| [606](#L606) | if (isset($\_POST['hide\_local\_styles'])) { |
| [607](#L607) | $default\_settings['hide\_local\_styles'] = true; |
| [608](#L608) | } else { |
| [609](#L609) | $default\_settings['hide\_local\_styles'] = false; |
| [610](#L610) | } |
| [611](#L611) | if (isset($\_POST['simplified\_panels'])) { |
| [612](#L612) | $default\_settings['simplified\_panels'] = true; |
| [613](#L613) | } else { |
| [614](#L614) | $default\_settings['simplified\_panels'] = false; |
| [615](#L615) | } |
| [616](#L616) | if (isset($\_POST['show\_element\_block'])) { |
| [617](#L617) | $default\_settings['show\_element\_block'] = sanitize\_text\_field($\_POST['show\_element\_block']); |
| [618](#L618) | } |
| [619](#L619) | if (isset($\_POST['default\_unit'])) { |
| [620](#L620) | $default\_settings['default\_unit'] = sanitize\_text\_field($\_POST['default\_unit']); |
| [621](#L621) | } |
| [622](#L622) | update\_option('gspb\_global\_settings', $default\_settings); |
| [623](#L623) | } |
| [624](#L624) |  |
| [625](#L625) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [626](#L626) | $cf\_utility\_on = !empty($global\_settings['cf\_utility\_on']) ? $global\_settings['cf\_utility\_on'] : ''; |
| [627](#L627) | $anchors\_disable = !empty($global\_settings['anchors\_disable']) ? $global\_settings['anchors\_disable'] : ''; |
| [628](#L628) | $dark\_accent\_scheme = !empty($global\_settings['dark\_accent\_scheme']) ? $global\_settings['dark\_accent\_scheme'] : ''; |
| [629](#L629) | $hide\_local\_styles = !empty($global\_settings['hide\_local\_styles']) ? $global\_settings['hide\_local\_styles'] : ''; |
| [630](#L630) | $simplified\_panels = !empty($global\_settings['simplified\_panels']) ? $global\_settings['simplified\_panels'] : ''; |
| [631](#L631) | $show\_element\_block = !empty($global\_settings['show\_element\_block']) ? $global\_settings['show\_element\_block'] : ''; |
| [632](#L632) | $default\_unit = !empty($global\_settings['default\_unit']) ? $global\_settings['default\_unit'] : ''; |
| [633](#L633) | $row\_padding\_disable = !empty($global\_settings['row\_padding\_disable']) ? $global\_settings['row\_padding\_disable'] : ''; |
| [634](#L634) | ?> |
| [635](#L635) | <div class="gspb\_settings\_form"> |
| [636](#L636) | <form method="POST"> |
| [637](#L637) | <div class="greenshift\_form"> |
| [638](#L638) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [639](#L639) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [640](#L640) | <div class="gs-box notice\_type icon\_type"> |
| [641](#L641) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [642](#L642) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [643](#L643) | </svg></div> |
| [644](#L644) | <div class="gs-box-text"> |
| [645](#L645) | <?php esc\_html\_e("Install Smart Code AI free plugin to enable code editor in block HTML/CSS panels", 'greenshift-animation-and-page-builder-blocks'); ?> |
| [646](#L646) | <a target="\_blank" href="<?php echo admin\_url('plugin-install.php?s=Greenshift%2520Smart%2520Code%2520AI&tab=search&type=term');?>" target="\_blank"><?php esc\_html\_e("Download", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [647](#L647) | </div> |
| [648](#L648) | </div> |
| [649](#L649) | </div> |
| [650](#L650) | <table class="form-table"> |
| [651](#L651) | <tr> |
| [652](#L652) | <td> <label for="cf\_utility\_on"><?php esc\_html\_e("Support for Core Framework Utility classes", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [653](#L653) | <td> |
| [654](#L654) | <input type="checkbox" name="cf\_utility\_on" id="cf\_utility\_on" <?php echo $cf\_utility\_on == true ? 'checked' : ''; ?> /> |
| [655](#L655) | </td> |
| [656](#L656) | </tr> |
| [657](#L657) | <tr> |
| [658](#L658) | <td> <label for="anchors\_disable"><?php esc\_html\_e("Disable core Headings anchor generation", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [659](#L659) | <td> |
| [660](#L660) | <input type="checkbox" name="anchors\_disable" id="anchors\_disable" <?php echo $anchors\_disable == true ? 'checked' : ''; ?> /> |
| [661](#L661) | </td> |
| [662](#L662) | </tr> |
| [663](#L663) | <tr> |
| [664](#L664) | <td> <label for="row\_padding\_disable"><?php esc\_html\_e("Disable default Column padding in Row block", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [665](#L665) | <td> |
| [666](#L666) | <input type="checkbox" name="row\_padding\_disable" id="row\_padding\_disable" <?php echo $row\_padding\_disable == true ? 'checked' : ''; ?> /> |
| [667](#L667) | </td> |
| [668](#L668) | </tr> |
| [669](#L669) | <tr> |
| [670](#L670) | <td> <label for="dark\_accent\_scheme"><?php esc\_html\_e("Dark Accent UI for block panels", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [671](#L671) | <td> |
| [672](#L672) | <input type="checkbox" name="dark\_accent\_scheme" id="dark\_accent\_scheme" <?php echo $dark\_accent\_scheme == true ? 'checked' : ''; ?> /> |
| [673](#L673) | </td> |
| [674](#L674) | </tr> |
| [675](#L675) | <tr> |
| [676](#L676) | <td> <label for="show\_element\_block"><?php esc\_html\_e("Priority for GreenLight Element Blocks in Inserter", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [677](#L677) | <td> |
| [678](#L678) | <select name="show\_element\_block"> |
| [679](#L679) | <option value="both" <?php selected($show\_element\_block, 'both'); ?>><?php esc\_html\_e("Show both, priority on regular Greenshift blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [680](#L680) | <option value="bothelement" <?php selected($show\_element\_block, 'bothelement'); ?>><?php esc\_html\_e("Show both, priority on GreenLight Element blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [681](#L681) | <option value="element" <?php selected($show\_element\_block, 'element'); ?>> <?php esc\_html\_e("Show only GreenLight Element blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [682](#L682) | <option value="regular" <?php selected($show\_element\_block, 'regular'); ?>> <?php esc\_html\_e("Show only Greenshift blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [683](#L683) | </select> |
| [684](#L684) | </td> |
| [685](#L685) | </tr> |
| [686](#L686) | <tr> |
| [687](#L687) | <td> <label for="default\_unit"><?php esc\_html\_e("Default unit for values", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [688](#L688) | <td> |
| [689](#L689) | <select name="default\_unit"> |
| [690](#L690) | <option value="px" <?php selected($default\_unit, 'px'); ?>>px</option> |
| [691](#L691) | <option value="em" <?php selected($default\_unit, 'em'); ?>>em</option> |
| [692](#L692) | <option value="rem" <?php selected($default\_unit, 'rem'); ?>>rem</option> |
| [693](#L693) | </select> |
| [694](#L694) | </td> |
| [695](#L695) | </tr> |
| [696](#L696) | <tr> |
| [697](#L697) | <td> <label for="hide\_local\_styles"><?php esc\_html\_e("Close Local style option in Element block by default", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [698](#L698) | <td> |
| [699](#L699) | <input type="checkbox" name="hide\_local\_styles" id="hide\_local\_styles" <?php echo $hide\_local\_styles == true ? 'checked' : ''; ?> /> |
| [700](#L700) | </td> |
| [701](#L701) | </tr> |
| [702](#L702) | <tr> |
| [703](#L703) | <td> <label for="simplified\_panels"><?php esc\_html\_e("Simplified panels for non admin user roles", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [704](#L704) | <td> |
| [705](#L705) | <input type="checkbox" name="simplified\_panels" id="simplified\_panels" <?php echo $simplified\_panels == true ? 'checked' : ''; ?> /> |
| [706](#L706) | </td> |
| [707](#L707) | </tr> |
| [708](#L708) | </table> |
| [709](#L709) |  |
| [710](#L710) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [711](#L711) | </div> |
| [712](#L712) |  |
| [713](#L713) | </form> |
| [714](#L714) | </div> |
| [715](#L715) | <?php |
| [716](#L716) | break; |
| [717](#L717) | case 'breakpoints': |
| [718](#L718) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [719](#L719) | $gsbp\_breakpoints = apply\_filters('greenshift\_responsive\_breakpoints', array( |
| [720](#L720) | 'mobile'        => 576, |
| [721](#L721) | 'tablet'        => 768, |
| [722](#L722) | 'desktop' =>  992 |
| [723](#L723) | )); |
| [724](#L724) |  |
| [725](#L725) | if (isset($\_POST['gspb\_save\_settings']) && isset($\_POST['gspb\_settings\_field']) && wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [726](#L726) | $breakpoints = array( |
| [727](#L727) | "mobile" =>  sanitize\_text\_field($\_POST['mobile']), |
| [728](#L728) | "tablet" =>  sanitize\_text\_field($\_POST['tablet']), |
| [729](#L729) | "desktop" =>  sanitize\_text\_field($\_POST['desktop']), |
| [730](#L730) | "row" =>  sanitize\_text\_field($\_POST['row']), |
| [731](#L731) | ); |
| [732](#L732) | $global\_settings['breakpoints'] = $breakpoints; |
| [733](#L733) |  |
| [734](#L734) | if (!empty($\_POST['enable\_landscape'])) { |
| [735](#L735) | $global\_settings['enable\_landscape'] = true; |
| [736](#L736) | } else { |
| [737](#L737) | if(isset($global\_settings['enable\_landscape'])){ |
| [738](#L738) | unset($global\_settings['enable\_landscape']); |
| [739](#L739) | } |
| [740](#L740) | } |
| [741](#L741) | update\_option('gspb\_global\_settings', $global\_settings); |
| [742](#L742) | } |
| [743](#L743) | $enable\_landscape = !empty($global\_settings['enable\_landscape']) ? $global\_settings['enable\_landscape'] : ''; |
| [744](#L744) | ?> |
| [745](#L745) | <form method="POST" class="greenshift\_form"> |
| [746](#L746) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [747](#L747) | <table class="form-table"> |
| [748](#L748) |  |
| [749](#L749) | <tr> |
| [750](#L750) | <td> <?php esc\_html\_e("Mobile", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [751](#L751) | <td> |
| [752](#L752) | <input name="mobile" type="text" value="<?php if (isset($global\_settings['breakpoints']['mobile'])) { |
| [753](#L753) | echo esc\_attr($global\_settings['breakpoints']['mobile']); |
| [754](#L754) | }  ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['mobile']; ?>" /> |
| [755](#L755) | </td> |
| [756](#L756) | </tr> |
| [757](#L757) | <tr> |
| [758](#L758) | <td> <?php esc\_html\_e("Tablet", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [759](#L759) | <td> |
| [760](#L760) | <input name="tablet" type="text" value="<?php if (isset($global\_settings['breakpoints']['tablet'])) { |
| [761](#L761) | echo esc\_attr($global\_settings['breakpoints']['tablet']); |
| [762](#L762) | } ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['tablet']; ?>" /> |
| [763](#L763) | </td> |
| [764](#L764) | </tr> |
| [765](#L765) | <tr> |
| [766](#L766) | <td> <?php esc\_html\_e("Desktop", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [767](#L767) | <td> |
| [768](#L768) | <input name="desktop" type="text" value="<?php if (isset($global\_settings['breakpoints']['desktop'])) { |
| [769](#L769) | echo esc\_attr($global\_settings['breakpoints']['desktop']); |
| [770](#L770) | } ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['desktop']; ?>" /> |
| [771](#L771) | </td> |
| [772](#L772) | </tr> |
| [773](#L773) | <tr> |
| [774](#L774) | <td> <?php esc\_html\_e("Default Row Content Width", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [775](#L775) | <td> |
| [776](#L776) | <input name="row" type="text" value="<?php if (isset($global\_settings['breakpoints']['row'])) { |
| [777](#L777) | echo esc\_attr($global\_settings['breakpoints']['row']); |
| [778](#L778) | } ?>" placeholder="<?php echo apply\_filters('gspb\_default\_row\_width\_px', 1200); ?>" /> |
| [779](#L779) | </td> |
| [780](#L780) | </tr> |
| [781](#L781) | <tr> |
| [782](#L782) | <td> <label for="enable\_landscape"><?php esc\_html\_e("Enable Landscape point", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [783](#L783) | <td> |
| [784](#L784) | <input type="checkbox" name="enable\_landscape" id="enable\_landscape" <?php echo $enable\_landscape == true ? 'checked' : ''; ?> /> |
| [785](#L785) | </td> |
| [786](#L786) | </tr> |
| [787](#L787) | </table> |
| [788](#L788) | <input type="submit" name="gspb\_save\_settings" value="Save" class="button button-primary button-large"> |
| [789](#L789) | </form> |
| [790](#L790) | <?php |
| [791](#L791) | break; |
| [792](#L792) | case 'scripts': |
| [793](#L793) | wp\_enqueue\_style('gsadminsettings'); |
| [794](#L794) | wp\_enqueue\_script('gsadminsettings'); |
| [795](#L795) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [796](#L796) | if (isset($\_POST['gspb\_save\_settings'])) { // Delay script saving |
| [797](#L797) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [798](#L798) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [799](#L799) | return; |
| [800](#L800) | } |
| [801](#L801) |  |
| [802](#L802) | $is\_dealyjson = isset($\_POST['delay\_js\_on']) && $\_POST['delay\_js\_on'] == "on" ? 1 : 0; |
| [803](#L803) | $jsdelay = array( |
| [804](#L804) | "delay\_js\_on" => $is\_dealyjson, |
| [805](#L805) | "delay\_js\_page\_on" =>  sanitize\_text\_field($\_POST['delay\_js\_page\_on']), |
| [806](#L806) | "delay\_js\_page\_list" =>  sanitize\_text\_field($\_POST['delay\_js\_page\_list']), |
| [807](#L807) | ); |
| [808](#L808) | $global\_settings['jsdelay'] = $jsdelay; |
| [809](#L809) |  |
| [810](#L810) | update\_option('gspb\_global\_settings', $global\_settings); |
| [811](#L811) | } |
| [812](#L812) | //Form for delay script saving |
| [813](#L813) | $delay\_js\_on = !empty($global\_settings['jsdelay']['delay\_js\_on']) ? $global\_settings['jsdelay']['delay\_js\_on'] : ''; |
| [814](#L814) | $delay\_js\_page\_on = !empty($global\_settings['jsdelay']['delay\_js\_page\_on']) ? $global\_settings['jsdelay']['delay\_js\_page\_on'] : ''; |
| [815](#L815) | $delay\_js\_page\_list = !empty($global\_settings['jsdelay']['delay\_js\_page\_list']) ? $global\_settings['jsdelay']['delay\_js\_page\_list'] : ''; |
| [816](#L816) |  |
| [817](#L817) | $show\_page\_option = $delay\_js\_on && ($delay\_js\_page\_on == "includefor" || $delay\_js\_page\_on  == "excludefor") ? true : false; |
| [818](#L818) |  |
| [819](#L819) | ?> |
| [820](#L820) | <div class="gspb\_settings\_form"> |
| [821](#L821) | <form method="POST"> |
| [822](#L822) | <h2><?php esc\_html\_e("Javascript Files Delay", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [823](#L823) | <div class="greenshift\_form"> |
| [824](#L824) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [825](#L825) | <div class="gs-box notice\_type icon\_type"> |
| [826](#L826) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [827](#L827) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [828](#L828) | </svg></div> |
| [829](#L829) | <div class="gs-box-text"> |
| [830](#L830) | <div><?php esc\_html\_e("Attention! This is experimental feature", "greenshift-animation-and-page-builder-blocks"); ?></div> |
| [831](#L831) | </div> |
| [832](#L832) | </div> |
| [833](#L833) | </div> |
| [834](#L834) |  |
| [835](#L835) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [836](#L836) | <table class="form-table"> |
| [837](#L837) | <tr> |
| [838](#L838) | <td colspan="2"> |
| [839](#L839) | <input type="checkbox" name="delay\_js\_on" id="delay\_js\_on" <?php echo $delay\_js\_on == true ? 'checked' : ''; ?> /> |
| [840](#L840) | <label for="delay\_js\_on"><?php esc\_html\_e("Enable script delay for Greenshift's scripts", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [841](#L841) | </td> |
| [842](#L842) | </tr> |
| [843](#L843) | <tr class="delay\_js\_optionsrow" <?php echo $delay\_js\_on == true ? 'style="display: table-row;"' : ''; ?>> |
| [844](#L844) | <td> <label for="css\_system"><?php esc\_html\_e("Javascript delay options", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [845](#L845) | <td> |
| [846](#L846) | <select id="delay\_js\_page\_on" name="delay\_js\_page\_on"> |
| [847](#L847) | <option value="all" <?php selected($delay\_js\_page\_on, 'all'); ?>><?php esc\_html\_e("Enable on whole site", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [848](#L848) | <option value="includefor" <?php selected($delay\_js\_page\_on, 'includefor'); ?>> <?php esc\_html\_e("Enable only on selected pages", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [849](#L849) | <option value="excludefor" <?php selected($delay\_js\_page\_on, 'excludefor'); ?>> <?php esc\_html\_e("Enable on whole site except selected pages", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [850](#L850) | </select> |
| [851](#L851) | </td> |
| [852](#L852) | </tr> |
| [853](#L853) | <tr class="delay\_js\_pagerow" <?php echo $show\_page\_option == true ? 'style="display: table-row;"' : ''; ?>> |
| [854](#L854) | <td> |
| [855](#L855) | <label for="delay\_js\_page\_list"><?php esc\_html\_e("Page Urls (one per line).", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [856](#L856) | </td> |
| [857](#L857) | <td> |
| [858](#L858) | <textarea style="width:100%; min-height:100px;" id="delay\_js\_page\_list" name="delay\_js\_page\_list"><?php echo esc\_html($delay\_js\_page\_list); ?></textarea> |
| [859](#L859) | <div style="margin-bottom:15px"><?php esc\_html\_e("Specify URLs of pages (one per line).", 'greenshift-animation-and-page-builder-blocks'); ?></div> |
| [860](#L860) | </td> |
| [861](#L861) | </tr> |
| [862](#L862) | </table> |
| [863](#L863) |  |
| [864](#L864) |  |
| [865](#L865) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large javascript\_delay\_submit"> |
| [866](#L866) | </div> |
| [867](#L867) | </form> |
| [868](#L868) | </div> |
| [869](#L869) | <?php |
| [870](#L870) | //End Form for delay script saving |
| [871](#L871) | break; |
| [872](#L872) |  |
| [873](#L873) | case 'keys': |
| [874](#L874) |  |
| [875](#L875) | if (isset($\_POST['gspb\_save\_settings'])) { // Delay script saving |
| [876](#L876) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [877](#L877) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [878](#L878) | return; |
| [879](#L879) | } |
| [880](#L880) | $sanitised = array(); |
| [881](#L881) |  |
| [882](#L882) | if (isset($\_POST['googleapi']) || isset($\_POST['openaiapi']) || isset($\_POST['openaiapimodel'])) { |
| [883](#L883) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [884](#L884) | if (isset($\_POST['googleapi'])) { |
| [885](#L885) | $sanitised['googleapi'] = sanitize\_text\_field($\_POST['googleapi']); |
| [886](#L886) | } |
| [887](#L887) | if (isset($\_POST['openaiapi'])) { |
| [888](#L888) | $sanitised['openaiapi'] = sanitize\_text\_field($\_POST['openaiapi']); |
| [889](#L889) | } |
| [890](#L890) | if (isset($\_POST['openaiapimodel'])) { |
| [891](#L891) | $sanitised['openaiapimodel'] = sanitize\_text\_field($\_POST['openaiapimodel']); |
| [892](#L892) | } |
| [893](#L893) | $newargs = wp\_parse\_args($sanitised, $global\_settings); |
| [894](#L894) | update\_option('gspb\_global\_settings', $newargs); |
| [895](#L895) | } |
| [896](#L896) | } |
| [897](#L897) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [898](#L898) | //Form for delay script saving |
| [899](#L899) | $googleapi = !empty($global\_settings['googleapi']) ? $global\_settings['googleapi'] : ''; |
| [900](#L900) | $openaiapi = !empty($global\_settings['openaiapi']) ? $global\_settings['openaiapi'] : ''; |
| [901](#L901) | $openaiapimodel = !empty($global\_settings['openaiapimodel']) ? $global\_settings['openaiapimodel'] : ''; |
| [902](#L902) |  |
| [903](#L903) | ?> |
| [904](#L904) | <div class="gspb\_settings\_form"> |
| [905](#L905) | <form method="POST"> |
| [906](#L906) | <div class="greenshift\_form"> |
| [907](#L907) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [908](#L908) | <table class="form-table"> |
| [909](#L909) | <tbody> |
| [910](#L910) | <tr class="googleapikey"> |
| [911](#L911) | <td> |
| [912](#L912) | <label for="googleapi"><?php esc\_html\_e("Google API Key", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [913](#L913) | </td> |
| [914](#L914) | <td> |
| [915](#L915) | <textarea style="width:100%; min-height:50px;border-color:#ddd" id="googleapi" name="googleapi"><?php echo esc\_html($googleapi); ?></textarea> |
| [916](#L916) | <div style="margin-bottom:15px"><a href="https://developers.google.com/maps/documentation/javascript/get-api-key"><?php esc\_html\_e("Get an API Key", 'greenshift-animation-and-page-builder-blocks'); ?></a></div> |
| [917](#L917) | </td> |
| [918](#L918) | </tr> |
| [919](#L919) | <tr class="openaiapikey"> |
| [920](#L920) | <td> |
| [921](#L921) | <label for="openaiapi"><?php esc\_html\_e("Open AI API Key", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [922](#L922) | </td> |
| [923](#L923) | <td> |
| [924](#L924) | <textarea style="width:100%; min-height:50px;border-color:#ddd" id="openaiapi" name="openaiapi"><?php echo esc\_html($openaiapi); ?></textarea> |
| [925](#L925) | <div style="margin-bottom:15px"><a href="https://platform.openai.com/account/api-keys"><?php esc\_html\_e("Get an API Key", 'greenshift-animation-and-page-builder-blocks'); ?></a></div> |
| [926](#L926) | </td> |
| [927](#L927) | </tr> |
| [928](#L928) | <tr class="openaiapimodel"> |
| [929](#L929) | <td> |
| [930](#L930) | <label for="openaiapimodel"><?php esc\_html\_e("Open AI Model", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [931](#L931) | </td> |
| [932](#L932) | <td> |
| [933](#L933) | <select name="openaiapimodel"> |
| [934](#L934) | <option value="gpt-3.5-turbo" <?php selected($openaiapimodel, 'gpt-3.5-turbo'); ?>><?php esc\_html\_e("gpt-3.5-turbo", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [935](#L935) | <option value="gpt-4" <?php selected($openaiapimodel, 'gpt-4'); ?>> <?php esc\_html\_e("gpt-4", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [936](#L936) | <option value="gpt-4-turbo" <?php selected($openaiapimodel, 'gpt-4-turbo'); ?>> <?php esc\_html\_e("gpt-4-turbo", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [937](#L937) | <option value="gpt-4-32k" <?php selected($openaiapimodel, 'gpt-4-32k'); ?>> <?php esc\_html\_e("gpt-4-32k", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [938](#L938) | <option value="gpt-4o" <?php selected($openaiapimodel, 'gpt-4o'); ?>> <?php esc\_html\_e("gpt-4o", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [939](#L939) | <option value="gpt-4o-mini" <?php selected($openaiapimodel, 'gpt-4o-mini'); ?>> <?php esc\_html\_e("gpt-4o-mini", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [940](#L940) | <option value="o1" <?php selected($openaiapimodel, 'o1'); ?>> <?php esc\_html\_e("o1", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [941](#L941) | <option value="o1-mini" <?php selected($openaiapimodel, 'o1-mini'); ?>> <?php esc\_html\_e("o1-mini", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [942](#L942) | <option value="o1-preview" <?php selected($openaiapimodel, 'o1-preview'); ?>> <?php esc\_html\_e("o1-preview", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [943](#L943) | </select> |
| [944](#L944) | </td> |
| [945](#L945) | </tr> |
| [946](#L946) | </tbody> |
| [947](#L947) | </table> |
| [948](#L948) |  |
| [949](#L949) |  |
| [950](#L950) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [951](#L951) | </div> |
| [952](#L952) | </form> |
| [953](#L953) | </div> |
| [954](#L954) | <?php |
| [955](#L955) | //End Form for delay script saving |
| [956](#L956) | break; |
| [957](#L957) | case 'header': |
| [958](#L958) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [959](#L959) |  |
| [960](#L960) | if (isset($\_POST['gspb\_save\_settings\_header'])) { // Delay script saving |
| [961](#L961) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [962](#L962) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [963](#L963) | return; |
| [964](#L964) | } |
| [965](#L965) | $sanitised = array(); |
| [966](#L966) |  |
| [967](#L967) | if (isset($\_POST['custom\_code\_in\_head'])) { |
| [968](#L968) | $theme\_settings['custom\_code\_in\_head'] = wp\_kses(wp\_unslash($\_POST['custom\_code\_in\_head']), [ |
| [969](#L969) | 'meta' => [ |
| [970](#L970) | 'charset' => [], |
| [971](#L971) | 'content' => [], |
| [972](#L972) | 'http-equiv' => [], |
| [973](#L973) | 'name' => [], |
| [974](#L974) | 'property' => [] |
| [975](#L975) | ], |
| [976](#L976) | 'style' => [ |
| [977](#L977) | 'media' => [], |
| [978](#L978) | 'type' => [] |
| [979](#L979) | ], |
| [980](#L980) | 'script' => [ |
| [981](#L981) | 'async' => [], |
| [982](#L982) | 'charset' => [], |
| [983](#L983) | 'defer' => [], |
| [984](#L984) | 'src' => [], |
| [985](#L985) | 'type' => [] |
| [986](#L986) | ], |
| [987](#L987) | 'link' => [ |
| [988](#L988) | 'href' => [], |
| [989](#L989) | 'rel' => [], |
| [990](#L990) | 'type' => [] |
| [991](#L991) | ], |
| [992](#L992) | 'img' => [ |
| [993](#L993) | 'alt' => [], |
| [994](#L994) | 'height' => [], |
| [995](#L995) | 'src' => [], |
| [996](#L996) | 'width' => [], |
| [997](#L997) | 'style' => [] |
| [998](#L998) | ], |
| [999](#L999) | 'noscript' => [] |
| [1000](#L1000) | ]); |
| [1001](#L1001) | } |
| [1002](#L1002) | if (isset($\_POST['custom\_code\_before\_closed\_body'])) { |
| [1003](#L1003) | $theme\_settings['custom\_code\_before\_closed\_body'] = wp\_kses(wp\_unslash($\_POST['custom\_code\_before\_closed\_body']), [ |
| [1004](#L1004) | 'meta' => [ |
| [1005](#L1005) | 'charset' => [], |
| [1006](#L1006) | 'content' => [], |
| [1007](#L1007) | 'http-equiv' => [], |
| [1008](#L1008) | 'name' => [], |
| [1009](#L1009) | 'property' => [] |
| [1010](#L1010) | ], |
| [1011](#L1011) | 'style' => [ |
| [1012](#L1012) | 'media' => [], |
| [1013](#L1013) | 'type' => [] |
| [1014](#L1014) | ], |
| [1015](#L1015) | 'script' => [ |
| [1016](#L1016) | 'async' => [], |
| [1017](#L1017) | 'charset' => [], |
| [1018](#L1018) | 'defer' => [], |
| [1019](#L1019) | 'src' => [], |
| [1020](#L1020) | 'type' => [] |
| [1021](#L1021) | ], |
| [1022](#L1022) | 'link' => [ |
| [1023](#L1023) | 'href' => [], |
| [1024](#L1024) | 'rel' => [], |
| [1025](#L1025) | 'type' => [] |
| [1026](#L1026) | ], |
| [1027](#L1027) | 'img' => [ |
| [1028](#L1028) | 'alt' => [], |
| [1029](#L1029) | 'height' => [], |
| [1030](#L1030) | 'src' => [], |
| [1031](#L1031) | 'width' => [], |
| [1032](#L1032) | 'style' => [] |
| [1033](#L1033) | ], |
| [1034](#L1034) | 'noscript' => [] |
| [1035](#L1035) | ]); |
| [1036](#L1036) | } |
| [1037](#L1037) | if (isset($\_POST['custom\_code\_in\_head']) || isset($\_POST['custom\_code\_before\_closed\_body'])) { |
| [1038](#L1038) | update\_option('greenshift\_theme\_options', $theme\_settings); |
| [1039](#L1039) | } |
| [1040](#L1040) | } |
| [1041](#L1041) | ?> |
| [1042](#L1042) | <h2><?php esc\_html\_e("Footer and Head Hooks", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [1043](#L1043) | <div class="greenshift\_form"> |
| [1044](#L1044) | <?php |
| [1045](#L1045) | $custom\_code\_in\_head = !empty($theme\_settings['custom\_code\_in\_head']) ? wp\_unslash($theme\_settings['custom\_code\_in\_head']) : ''; |
| [1046](#L1046) | $custom\_code\_before\_closed\_body = !empty($theme\_settings['custom\_code\_before\_closed\_body']) ? wp\_unslash($theme\_settings['custom\_code\_before\_closed\_body']) : ''; |
| [1047](#L1047) | ?> |
| [1048](#L1048) | <form method="POST"> |
| [1049](#L1049) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [1050](#L1050) | <table class="form-table"> |
| [1051](#L1051) | <tr> |
| [1052](#L1052) | <th> <label for="custom\_code\_in\_head"><?php esc\_html\_e("Custom code in head section", 'greenshift'); ?></label> </th> |
| [1053](#L1053) | <td> |
| [1054](#L1054) | <textarea name="custom\_code\_in\_head" id="" cols="30" rows="10" style="width: 100%"><?php echo $custom\_code\_in\_head ?></textarea> |
| [1055](#L1055) | </td> |
| [1056](#L1056) | </tr> |
| [1057](#L1057) | <tr> |
| [1058](#L1058) | <th> <label for="custom\_code\_before\_closed\_body"><?php esc\_html\_e("Custom code before closed Body", 'greenshift'); ?></label> </th> |
| [1059](#L1059) | <td> |
| [1060](#L1060) | <textarea name="custom\_code\_before\_closed\_body" id="" cols="30" rows="10" style="width: 100%"><?php echo $custom\_code\_before\_closed\_body ?></textarea> |
| [1061](#L1061) | </td> |
| [1062](#L1062) | </tr> |
| [1063](#L1063) | </table> |
| [1064](#L1064) | <input type="submit" name="gspb\_save\_settings\_header" value="<?php esc\_html\_e('Save', 'greenshift-animation-and-page-builder-blocks') ?>" class="button button-primary button-large"> |
| [1065](#L1065) | </form> |
| [1066](#L1066) | </div> |
| [1067](#L1067) | <?php |
| [1068](#L1068) | //End Form for delay script saving |
| [1069](#L1069) | break; |
| [1070](#L1070) | default: |
| [1071](#L1071) | wp\_enqueue\_style('gsadminsettings'); |
| [1072](#L1072) | wp\_enqueue\_script('gsadminsettings'); |
| [1073](#L1073) | if (isset($\_POST['gspb\_save\_settings\_general']) && isset($\_POST['gspb\_settings\_field']) && wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { // local font saving |
| [1074](#L1074) | $this->gspb\_save\_general\_form($\_POST, $\_FILES); |
| [1075](#L1075) | } |
| [1076](#L1076) |  |
| [1077](#L1077) | ?> |
| [1078](#L1078) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [1079](#L1079) | <div class="gs-box notice\_type icon\_type"> |
| [1080](#L1080) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [1081](#L1081) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [1082](#L1082) | </svg></div> |
| [1083](#L1083) | <div class="gs-box-text"> |
| [1084](#L1084) | <?php esc\_html\_e("Attention! Local font is global option and it can reduce performance in some cases. Do not use more than 2 global fonts. Please, check", 'greenshift-animation-and-page-builder-blocks'); ?> <a href="https://greenshiftwp.com/how-to-use-local-fonts-in-greenshift-for-gdpr/" target="\_blank"><?php esc\_html\_e("Documentation", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [1085](#L1085) | </div> |
| [1086](#L1086) | </div> |
| [1087](#L1087) | </div> |
| [1088](#L1088) | <?php |
| [1089](#L1089) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1090](#L1090) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/settings\_general\_form.php'; ?> |
| [1091](#L1091) | <?php |
| [1092](#L1092) | break; |
| [1093](#L1093) | endswitch; |
| [1094](#L1094) | ?> |
| [1095](#L1095) | </div> |
| [1096](#L1096) | </div> |
| [1097](#L1097) | </div> |
| [1098](#L1098) | </div> |
| [1099](#L1099) | </div> |
| [1100](#L1100) | <?php |
| [1101](#L1101) | } |
| [1102](#L1102) |  |
| [1103](#L1103) | // settings fonts |
| [1104](#L1104) | public function gspb\_settings\_add\_font() |
| [1105](#L1105) | { |
| [1106](#L1106) | $i = $\_POST['i']; |
| [1107](#L1107) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1108](#L1108) | ob\_start(); |
| [1109](#L1109) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/settings\_general\_font\_item.php'; |
| [1110](#L1110) | $html = ob\_get\_contents(); |
| [1111](#L1111) | ob\_get\_clean(); |
| [1112](#L1112) | wp\_send\_json(['html' => $html]); |
| [1113](#L1113) | } |
| [1114](#L1114) |  |
| [1115](#L1115) | public function gspb\_save\_general\_form($data, $files) |
| [1116](#L1116) | { |
| [1117](#L1117) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [1118](#L1118) |  |
| [1119](#L1119) | $fonts\_urls = $this->gspb\_save\_files($files); |
| [1120](#L1120) | $arr = []; |
| [1121](#L1121) | for ($i = 0; (int)$data['fonts\_count'] > $i; $i++) { |
| [1122](#L1122) | //$item\_arr = ['label' => sanitize\_text\_field($data['font\_specific\_style\_name'][$i])]; |
| [1123](#L1123) | foreach ($this->allowed\_font\_ext as $ext) { |
| [1124](#L1124) | $item\_arr[$ext] = !empty($fonts\_urls[$i][$ext]) ? $fonts\_urls[$i][$ext] : sanitize\_text\_field($data[$ext][$i]); |
| [1125](#L1125) | } |
| [1126](#L1126) | $item\_arr['preloaded'] = !empty($data['font\_family\_preload'][$i]) ? sanitize\_text\_field($data['font\_family\_preload'][$i]) : ''; |
| [1127](#L1127) | $arr[sanitize\_text\_field($data['font\_family\_name'][$i])] = $item\_arr; |
| [1128](#L1128) | } |
| [1129](#L1129) | $new\_localfont = json\_encode($arr); |
| [1130](#L1130) | $global\_settings['localfont'] = $new\_localfont; |
| [1131](#L1131) |  |
| [1132](#L1132) | $localfontcss = ''; |
| [1133](#L1133) | if (!empty($arr)) { |
| [1134](#L1134) | foreach ($arr as $i => $value) { |
| [1135](#L1135) | $localfontcss .= '@font-face {'; |
| [1136](#L1136) | $localfontcss .= 'font-family: "' . $i . '";'; |
| [1137](#L1137) | $localfontcss .= 'src: '; |
| [1138](#L1138) | if (!empty($value['woff2'])) { |
| [1139](#L1139) | $localfontcss .= 'url(' . $value["woff2"] . ') format("woff2"), '; |
| [1140](#L1140) | } |
| [1141](#L1141) | if (!empty($value['woff'])) { |
| [1142](#L1142) | $localfontcss .= 'url(' . $value["woff"] . ') format("woff"), '; |
| [1143](#L1143) | } |
| [1144](#L1144) | if (!empty($value['ttf'])) { |
| [1145](#L1145) | $localfontcss .= 'url(' . $value["ttf"] . ') format("truetype"), '; |
| [1146](#L1146) | } |
| [1147](#L1147) | if (!empty($value['tiff'])) { |
| [1148](#L1148) | $localfontcss .= 'url(' . $value["tiff"] . ') format("tiff"), '; |
| [1149](#L1149) | } |
| [1150](#L1150) | $localfontcss .= ';'; |
| [1151](#L1151) | $localfontcss .= 'font-display: swap;}'; |
| [1152](#L1152) | } |
| [1153](#L1153) | $localfontcss = str\_replace(', ;', ';', $localfontcss); |
| [1154](#L1154) | $global\_settings['localfontcss'] = $localfontcss; |
| [1155](#L1155) |  |
| [1156](#L1156) | $upload\_dir = wp\_upload\_dir(); |
| [1157](#L1157) | require\_once ABSPATH . 'wp-admin/includes/file.php'; |
| [1158](#L1158) | global $wp\_filesystem; |
| [1159](#L1159) | $dir = trailingslashit($upload\_dir['basedir']) . 'GreenShift/'; // Set storage directory path |
| [1160](#L1160) |  |
| [1161](#L1161) | WP\_Filesystem(); // WP file system |
| [1162](#L1162) |  |
| [1163](#L1163) | if (!$wp\_filesystem->is\_dir($dir)) { |
| [1164](#L1164) | $wp\_filesystem->mkdir($dir); |
| [1165](#L1165) | } |
| [1166](#L1166) |  |
| [1167](#L1167) | $gspb\_json\_filename = 'settings\_backup.json'; |
| [1168](#L1168) | $gspb\_backup\_data = json\_encode($global\_settings, JSON\_PRETTY\_PRINT); |
| [1169](#L1169) |  |
| [1170](#L1170) | if (!$wp\_filesystem->put\_contents($dir . $gspb\_json\_filename, $gspb\_backup\_data)) { |
| [1171](#L1171) | throw new Exception(esc\_html\_\_('JSON is not saved due the permission!!!', 'greenshift-animation-and-page-builder-blocks')); |
| [1172](#L1172) | } |
| [1173](#L1173) | } |
| [1174](#L1174) | update\_option('gspb\_global\_settings', $global\_settings); |
| [1175](#L1175) | } |
| [1176](#L1176) |  |
| [1177](#L1177) | public function gspb\_save\_files($files) |
| [1178](#L1178) | { |
| [1179](#L1179) | $result = []; |
| [1180](#L1180) | $upload = wp\_upload\_dir(); |
| [1181](#L1181) | $upload\_dir = $upload['basedir'] . '/GreenShift/fonts'; |
| [1182](#L1182) | $upload\_url = $upload['baseurl'] . '/GreenShift/fonts'; |
| [1183](#L1183) |  |
| [1184](#L1184) | foreach (array\_keys($files) as $filename) { |
| [1185](#L1185) | foreach ($files[$filename]["error"] as $key => $error) { |
| [1186](#L1186) | if ($error == UPLOAD\_ERR\_OK) { |
| [1187](#L1187) | $tmp\_name = $files[$filename]["tmp\_name"][$key]; |
| [1188](#L1188) | $name = basename($files[$filename]["name"][$key]); |
| [1189](#L1189) | $ext = pathinfo($name, PATHINFO\_EXTENSION); |
| [1190](#L1190) | $font\_dir = $upload\_dir . '/font\_' . ($key + 1) . '/' . $ext; |
| [1191](#L1191) |  |
| [1192](#L1192) | $this->gspb\_rm\_rec($font\_dir); //clean up dir before download |
| [1193](#L1193) |  |
| [1194](#L1194) | if (!wp\_mkdir\_p($font\_dir)) { |
| [1195](#L1195) | return false; |
| [1196](#L1196) | } |
| [1197](#L1197) |  |
| [1198](#L1198) | if(!in\_array($ext, $this->allowed\_font\_ext)) continue; |
| [1199](#L1199) |  |
| [1200](#L1200) | if (move\_uploaded\_file($tmp\_name, "$font\_dir/$name")) { |
| [1201](#L1201) | $result[$key][$ext] = $upload\_url . '/font\_' . ($key + 1) . '/' . $ext . '/' . $name; |
| [1202](#L1202) | } |
| [1203](#L1203) | } |
| [1204](#L1204) | } |
| [1205](#L1205) | } |
| [1206](#L1206) |  |
| [1207](#L1207) | return $result; |
| [1208](#L1208) | } |
| [1209](#L1209) |  |
| [1210](#L1210) | public function gspb\_rm\_rec($path) |
| [1211](#L1211) | { |
| [1212](#L1212) | if (is\_file($path)) return unlink($path); |
| [1213](#L1213) | if (is\_dir($path)) { |
| [1214](#L1214) | foreach (scandir($path) as $p) if (($p != '.') && ($p != '..')) |
| [1215](#L1215) | $this->gspb\_rm\_rec($path . '/' . $p); |
| [1216](#L1216) | return rmdir($path); |
| [1217](#L1217) | } |
| [1218](#L1218) | return false; |
| [1219](#L1219) | } |
| [1220](#L1220) |  |
| [1221](#L1221) | //Columns in Reusable section |
| [1222](#L1222) | function gspb\_template\_screen\_add\_column($columns) |
| [1223](#L1223) | { |
| [1224](#L1224) | $newcols = array( |
| [1225](#L1225) | 'cb' => '<input type="checkbox" />', |
| [1226](#L1226) | 'title' => esc\_html\_\_('Block title', 'greenshift-animation-and-page-builder-blocks'), |
| [1227](#L1227) | 'gs-reusable-preview' => esc\_html\_\_('Usage', 'greenshift-animation-and-page-builder-blocks'), |
| [1228](#L1228) | ); |
| [1229](#L1229) | return apply\_filters('greenshift\_reusable\_blocks\_list', array\_merge($columns, $newcols)); |
| [1230](#L1230) | } |
| [1231](#L1231) |  |
| [1232](#L1232) | //Render function for Columns in Reusable Sections |
| [1233](#L1233) | function gspb\_template\_screen\_fill\_column($column, $ID) |
| [1234](#L1234) | { |
| [1235](#L1235) | global $post; |
| [1236](#L1236) | switch ($column) { |
| [1237](#L1237) |  |
| [1238](#L1238) | case 'gs-reusable-preview': |
| [1239](#L1239) |  |
| [1240](#L1240) | echo '<p><input type="text" style="width:350px" value="[wp\_reusable\_render id=\'' . $ID . '\']" readonly=""></p>'; |
| [1241](#L1241) | echo '<p>' . esc\_html\_\_('If you use template inside other dynamic ajax blocks', 'greenshift-animation-and-page-builder-blocks') . '<br><input type="text" style="width:350px" value="[wp\_reusable\_render inlinestyle=1 id=\'' . $ID . '\']" readonly="">'; |
| [1242](#L1242) | echo '<p>' . esc\_html\_\_('Shortcode for Ajax render:', 'greenshift-animation-and-page-builder-blocks') . '<br><input type="text" style="width:350px" value="[wp\_reusable\_render ajax=1 height=100px id=\'' . $ID . '\']" readonly="">'; |
| [1243](#L1243) | echo '<p>' . esc\_html\_\_('Hover trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onhover load-block-' . $ID . '</code>'; |
| [1244](#L1244) | echo '<p>' . esc\_html\_\_('Click trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onclick load-block-' . $ID . '</code>'; |
| [1245](#L1245) | echo '<p>' . esc\_html\_\_('On view trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onview load-block-' . $ID . '</code>'; |
| [1246](#L1246) | break; |
| [1247](#L1247) |  |
| [1248](#L1248) | default: |
| [1249](#L1249) | break; |
| [1250](#L1250) | } |
| [1251](#L1251) | } |
| [1252](#L1252) |  |
| [1253](#L1253) | //Render shortcode function |
| [1254](#L1254) | function gspb\_template\_shortcode\_function($atts) |
| [1255](#L1255) | { |
| [1256](#L1256) | extract(shortcode\_atts( |
| [1257](#L1257) | array( |
| [1258](#L1258) | 'id' => '', |
| [1259](#L1259) | 'ajax' => '', |
| [1260](#L1260) | 'height' => '', |
| [1261](#L1261) | 'inlinestyle' => '' |
| [1262](#L1262) | ), |
| [1263](#L1263) | $atts |
| [1264](#L1264) | )); |
| [1265](#L1265) | if (!isset($id) || empty($id)) { |
| [1266](#L1266) | return ''; |
| [1267](#L1267) | } |
| [1268](#L1268) | if (!is\_numeric($id)) { |
| [1269](#L1269) | $postget = get\_page\_by\_path($id, OBJECT, array('wp\_block')); |
| [1270](#L1270) | if (is\_object($postget)) { |
| [1271](#L1271) | $id = $postget->ID; |
| [1272](#L1272) | } else { |
| [1273](#L1273) | return; |
| [1274](#L1274) | } |
| [1275](#L1275) | } |
| [1276](#L1276) | $style = ''; |
| [1277](#L1277) | $post\_css = get\_post\_meta((int)$id, '\_gspb\_post\_css', true); |
| [1278](#L1278) | if(!empty($post\_css)){ |
| [1279](#L1279) | $dynamic\_style = '<style>' . wp\_kses\_post($post\_css) . '</style>'; |
| [1280](#L1280) | $dynamic\_style = gspb\_get\_final\_css($dynamic\_style); |
| [1281](#L1281) | $dynamic\_style = gspb\_quick\_minify\_css($dynamic\_style); |
| [1282](#L1282) | $dynamic\_style = htmlspecialchars\_decode($dynamic\_style); |
| [1283](#L1283) | $style .= $dynamic\_style; |
| [1284](#L1284) | } |
| [1285](#L1285) | if (!empty($ajax)) { |
| [1286](#L1286) | wp\_enqueue\_style('wp-block-library'); |
| [1287](#L1287) | wp\_enqueue\_style('gspreloadercss'); |
| [1288](#L1288) | wp\_enqueue\_script('gselajaxloader'); |
| [1289](#L1289) | $scriptvars = array( |
| [1290](#L1290) | 'reusablenonce' => wp\_create\_nonce('gsreusable'), |
| [1291](#L1291) | 'ajax\_url' => admin\_url('admin-ajax.php', 'relative'), |
| [1292](#L1292) | ); |
| [1293](#L1293) | wp\_localize\_script('gselajaxloader', 'gsreusablevars', $scriptvars); |
| [1294](#L1294) | $content = '<div class="gs-ajax-load-block gs-ajax-load-block-' . (int)$id . '"></div>'; |
| [1295](#L1295) |  |
| [1296](#L1296) | $content\_post = get\_post($id); |
| [1297](#L1297) | if (!is\_object($content\_post)) return false; |
| [1298](#L1298) | if($content\_post->post\_type != 'wp\_block') return false; |
| [1299](#L1299) | $contentpost = $content\_post->post\_content; |
| [1300](#L1300) | if (has\_blocks($contentpost)) { |
| [1301](#L1301) | $blocks = parse\_blocks($contentpost); |
| [1302](#L1302) | $style .= '<style>'; |
| [1303](#L1303) | $style .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1304](#L1304) | $style .= '</style>'; |
| [1305](#L1305) | } |
| [1306](#L1306) | if (!empty($height)) { |
| [1307](#L1307) | $content = '<div style="min-height:' . esc\_attr($height) . '">' . $content . $style . '</div>'; |
| [1308](#L1308) | } else { |
| [1309](#L1309) | $content = '<div>' . $content . $style . '</div>'; |
| [1310](#L1310) | } |
| [1311](#L1311) | } else { |
| [1312](#L1312) | $content\_post = get\_post($id); |
| [1313](#L1313) | if (!is\_object($content\_post)) return false; |
| [1314](#L1314) | if($content\_post->post\_type != 'wp\_block') return false; |
| [1315](#L1315) | $content = $content\_post->post\_content; |
| [1316](#L1316) | if ($inlinestyle) { |
| [1317](#L1317) | if (has\_blocks($content)) { |
| [1318](#L1318) | $blocks = parse\_blocks($content); |
| [1319](#L1319) | $style .= '<style>'; |
| [1320](#L1320) | $style .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1321](#L1321) | $style .= '</style>'; |
| [1322](#L1322) | } |
| [1323](#L1323) | } |
| [1324](#L1324) | $content = do\_blocks($content); |
| [1325](#L1325) | $content = do\_shortcode($content); |
| [1326](#L1326) | $content = preg\_replace('%<p>&nbsp;\s\*</p>%', '', $content); |
| [1327](#L1327) | $content = preg\_replace('/^(?:<br\s\*\/?>\s\*)+/', '', $content); |
| [1328](#L1328) | $content = $content . $style; |
| [1329](#L1329) | } |
| [1330](#L1330) | return $content; |
| [1331](#L1331) | } |
| [1332](#L1332) |  |
| [1333](#L1333) | //Load reusable Ajax function |
| [1334](#L1334) | function gspb\_el\_reusable\_load() |
| [1335](#L1335) | { |
| [1336](#L1336) | check\_ajax\_referer('gsreusable', 'security'); |
| [1337](#L1337) | $post\_id = intval($\_POST['post\_id']); |
| [1338](#L1338) | $content\_post = get\_post($post\_id); |
| [1339](#L1339) | $content = ''; |
| [1340](#L1340) | if(is\_object($content\_post)){ |
| [1341](#L1341) | $content = $content\_post->post\_content; |
| [1342](#L1342) | $content = apply\_filters('the\_content', $content); |
| [1343](#L1343) | $content = str\_replace('strokewidth', 'stroke-width', $content); |
| [1344](#L1344) | $content = str\_replace('strokedasharray', 'stroke-dasharray', $content); |
| [1345](#L1345) | $content = str\_replace('stopcolor', 'stop-color', $content); |
| [1346](#L1346) | $content = str\_replace('loading="lazy"', '', $content); |
| [1347](#L1347) | if($content\_post->post\_type != 'wp\_block') $content = 'Please use this feature only for reusable blocks'; |
| [1348](#L1348) | } |
| [1349](#L1349) | if ($content) { |
| [1350](#L1350) | wp\_send\_json\_success($content); |
| [1351](#L1351) | } else { |
| [1352](#L1352) | wp\_send\_json\_success('fail'); |
| [1353](#L1353) | } |
| [1354](#L1354) | wp\_die(); |
| [1355](#L1355) | } |
| [1356](#L1356) |  |
| [1357](#L1357) | //Show gutenberg editor on reusable section even if Classic editor plugins enabled |
| [1358](#L1358) | function gspb\_template\_gutenberg\_post($use\_block\_editor, $post) |
| [1359](#L1359) | { |
| [1360](#L1360) | if (empty($post->ID)) return $use\_block\_editor; |
| [1361](#L1361) | if ('wp\_block' === get\_post\_type($post->ID)) return true; |
| [1362](#L1362) | return $use\_block\_editor; |
| [1363](#L1363) | } |
| [1364](#L1364) | function gspb\_template\_gutenberg\_post\_type($use\_block\_editor, $post\_type) |
| [1365](#L1365) | { |
| [1366](#L1366) | if ('wp\_block' === $post\_type) return true; |
| [1367](#L1367) | return $use\_block\_editor; |
| [1368](#L1368) | } |
| [1369](#L1369) |  |
| [1370](#L1370) | function greenshift\_additional\_\_header\_elements() |
| [1371](#L1371) | { |
| [1372](#L1372) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [1373](#L1373) | if (!empty($theme\_settings['custom\_code\_in\_head'])) { |
| [1374](#L1374) | echo wp\_kses(wp\_unslash($theme\_settings['custom\_code\_in\_head']), [ |
| [1375](#L1375) | 'meta' => [ |
| [1376](#L1376) | 'charset' => [], |
| [1377](#L1377) | 'content' => [], |
| [1378](#L1378) | 'http-equiv' => [], |
| [1379](#L1379) | 'name' => [], |
| [1380](#L1380) | 'property' => [] |
| [1381](#L1381) | ], |
| [1382](#L1382) | 'style' => [ |
| [1383](#L1383) | 'media' => [], |
| [1384](#L1384) | 'type' => [] |
| [1385](#L1385) | ], |
| [1386](#L1386) | 'script' => [ |
| [1387](#L1387) | 'async' => [], |
| [1388](#L1388) | 'charset' => [], |
| [1389](#L1389) | 'defer' => [], |
| [1390](#L1390) | 'src' => [], |
| [1391](#L1391) | 'type' => [] |
| [1392](#L1392) | ], |
| [1393](#L1393) | 'link' => [ |
| [1394](#L1394) | 'href' => [], |
| [1395](#L1395) | 'rel' => [], |
| [1396](#L1396) | 'type' => [] |
| [1397](#L1397) | ], |
| [1398](#L1398) | 'img' => [ |
| [1399](#L1399) | 'alt' => [], |
| [1400](#L1400) | 'height' => [], |
| [1401](#L1401) | 'src' => [], |
| [1402](#L1402) | 'width' => [], |
| [1403](#L1403) | 'style' => [] |
| [1404](#L1404) | ], |
| [1405](#L1405) | 'iframe' => [ |
| [1406](#L1406) | 'height' => [], |
| [1407](#L1407) | 'src' => [], |
| [1408](#L1408) | 'width' => [], |
| [1409](#L1409) | 'style' => [] |
| [1410](#L1410) | ], |
| [1411](#L1411) | 'noscript' => [] |
| [1412](#L1412) | ]); |
| [1413](#L1413) | } |
| [1414](#L1414) | $sitesettings = get\_option('gspb\_global\_settings'); |
| [1415](#L1415) | $localfonts = (!empty($sitesettings['localfont'])) ? $sitesettings['localfont'] : ''; |
| [1416](#L1416) | if ($localfonts) { |
| [1417](#L1417) | $localfonts = json\_decode($localfonts, true); |
| [1418](#L1418) | if (is\_array($localfonts)) { |
| [1419](#L1419) | foreach ($localfonts as $localfont) { |
| [1420](#L1420) | if (!empty($localfont['preloaded'])) { |
| [1421](#L1421) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1422](#L1422) | foreach ($allowed\_font\_ext as $ext) { |
| [1423](#L1423) | if (!empty($localfont[$ext])) { |
| [1424](#L1424) | echo '<link rel="preload" href="' . $localfont[$ext] . '" as="font" type="font/' . $ext . '" crossorigin>'; |
| [1425](#L1425) | } |
| [1426](#L1426) | } |
| [1427](#L1427) | } |
| [1428](#L1428) | } |
| [1429](#L1429) | } |
| [1430](#L1430) | } |
| [1431](#L1431) | if (!empty($sitesettings['sitesettings']['smoothscroll'])) { |
| [1432](#L1432) | echo '<style>html.lenis, html.lenis body {height: auto;}.lenis.lenis-smooth {scroll-behavior: auto !important;}.lenis.lenis-smooth [data-lenis-prevent] {overscroll-behavior: contain;}.lenis.lenis-stopped {overflow: hidden;}.lenis.lenis-smooth iframe {pointer-events: none;}</style>'; |
| [1433](#L1433) | } |
| [1434](#L1434) | if (!empty($sitesettings['sitesettings']['pagetransition']) && !empty($sitesettings['sitesettings']['pagetransitioneffect'])) { |
| [1435](#L1435) | echo '<style> |
| [1436](#L1436) | @view-transition {navigation: auto;} |
| [1437](#L1437) | @media (prefers-reduced-motion) { |
| [1438](#L1438) | ::view-transition-group(\*), ::view-transition-old(\*), ::view-transition-new(\*) { |
| [1439](#L1439) | animation: none !important; |
| [1440](#L1440) | } |
| [1441](#L1441) | } |
| [1442](#L1442) | </style>'; |
| [1443](#L1443) | if($sitesettings['sitesettings']['pagetransitioneffect'] != 'none'){ |
| [1444](#L1444) | echo '<style> |
| [1445](#L1445) | ::view-transition-old(root) {animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease);} |
| [1446](#L1446) | ::view-transition-new(root) {animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease);} |
| [1447](#L1447) | </style>'; |
| [1448](#L1448) | } |
| [1449](#L1449) | if (!empty($sitesettings['sitesettings']['pagetransitioneffect'])) { |
| [1450](#L1450) | if($sitesettings['sitesettings']['pagetransitioneffect'] == 'fade'){ |
| [1451](#L1451) | echo '<style> |
| [1452](#L1452) | @keyframes gs-pagetransition-out {from {opacity: 1;}to {opacity: 0;}} |
| [1453](#L1453) | @keyframes gs-pagetransition-in {from {opacity: 0;}to {opacity: 1;}} |
| [1454](#L1454) | </style>'; |
| [1455](#L1455) | } |
| [1456](#L1456) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-bottom'){ |
| [1457](#L1457) | echo '<style> |
| [1458](#L1458) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 0 5rem;}} |
| [1459](#L1459) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 0 -5rem;}to {opacity: 1;translate: 0;}} |
| [1460](#L1460) | </style>'; |
| [1461](#L1461) | } |
| [1462](#L1462) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-left'){ |
| [1463](#L1463) | echo '<style> |
| [1464](#L1464) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: -5rem 0;}} |
| [1465](#L1465) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 5rem 0;}to {opacity: 1;translate: 0;}} |
| [1466](#L1466) | </style>'; |
| [1467](#L1467) | } |
| [1468](#L1468) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-right'){ |
| [1469](#L1469) | echo '<style> |
| [1470](#L1470) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 5rem 0;}} |
| [1471](#L1471) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: -5rem 0;}to {opacity: 1;translate: 0;}} |
| [1472](#L1472) | </style>'; |
| [1473](#L1473) | } |
| [1474](#L1474) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'zoom'){ |
| [1475](#L1475) | echo '<style> |
| [1476](#L1476) | @keyframes gs-pagetransition-out {from {opacity: 1;scale: 1;}to {opacity: 0;scale: 1.2;}} |
| [1477](#L1477) | @keyframes gs-pagetransition-in {from {opacity: 0;scale: 0.8;}to {opacity: 1;scale: 1;}} |
| [1478](#L1478) | </style>'; |
| [1479](#L1479) | } |
| [1480](#L1480) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'parallax-out'){ |
| [1481](#L1481) | echo '<style> |
| [1482](#L1482) | ::view-transition-old(root) { |
| [1483](#L1483) | animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1484](#L1484) | } |
| [1485](#L1485) | ::view-transition-new(root) { |
| [1486](#L1486) | animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1487](#L1487) | } |
| [1488](#L1488) | @keyframes gs-pagetransition-out { |
| [1489](#L1489) | from { opacity: 1; transform: translateY(0); } |
| [1490](#L1490) | to { opacity: 0.5; transform: translateY(-50%); } |
| [1491](#L1491) | } |
| [1492](#L1492) | @keyframes gs-pagetransition-in { |
| [1493](#L1493) | from { opacity: 0; transform: translateY(100%); } |
| [1494](#L1494) | to { opacity: 1; transform: translateY(0); } |
| [1495](#L1495) | } |
| [1496](#L1496) | </style>'; |
| [1497](#L1497) | } |
| [1498](#L1498) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'push'){ |
| [1499](#L1499) | echo '<style> |
| [1500](#L1500) | ::view-transition-old(root) { |
| [1501](#L1501) | animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1502](#L1502) | } |
| [1503](#L1503) | ::view-transition-new(root) { |
| [1504](#L1504) | animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1505](#L1505) | } |
| [1506](#L1506) | @keyframes gs-pagetransition-out { |
| [1507](#L1507) | from { transform: translateY(0); } |
| [1508](#L1508) | to { transform: translateY(-100%); } |
| [1509](#L1509) | } |
| [1510](#L1510) | @keyframes gs-pagetransition-in { |
| [1511](#L1511) | from { transform: translateY(100%); } |
| [1512](#L1512) | to { transform: translateY(0); } |
| [1513](#L1513) | } |
| [1514](#L1514) | </style>'; |
| [1515](#L1515) | } |
| [1516](#L1516) | else{ |
| [1517](#L1517) | echo '<style> |
| [1518](#L1518) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 0 -5rem;}} |
| [1519](#L1519) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 0 5rem;}to {opacity: 1;translate: 0;}} |
| [1520](#L1520) | </style>'; |
| [1521](#L1521) | } |
| [1522](#L1522) | } |
| [1523](#L1523) | if (!empty($sitesettings['sitesettings']['pagetransitionsafe'])) { |
| [1524](#L1524) | echo '<style>'; |
| [1525](#L1525) | $safeselectors = explode(',', $sitesettings['sitesettings']['pagetransitionsafe']); |
| [1526](#L1526) | foreach ($safeselectors as $selector) { |
| [1527](#L1527) | echo $selector . ' { view-transition-name: ' . str\_replace(array('.', '#'), '', esc\_attr($selector)) . '; }'; |
| [1528](#L1528) | } |
| [1529](#L1529) | echo '</style>'; |
| [1530](#L1530) | }else{ |
| [1531](#L1531) | echo '<style> |
| [1532](#L1532) | header{ |
| [1533](#L1533) | view-transition-name: header; |
| [1534](#L1534) | } |
| [1535](#L1535) | footer{ |
| [1536](#L1536) | view-transition-name: footer; |
| [1537](#L1537) | } |
| [1538](#L1538) | #wpadminbar{ |
| [1539](#L1539) | view-transition-name: topbar; |
| [1540](#L1540) | } |
| [1541](#L1541) | </style>'; |
| [1542](#L1542) | } |
| [1543](#L1543) | } |
| [1544](#L1544) | } |
| [1545](#L1545) |  |
| [1546](#L1546) | function greenshift\_additional\_\_footer\_elements() |
| [1547](#L1547) | { |
| [1548](#L1548) | if (defined('GREENSHIFTGSAP\_DIR\_URL')) { |
| [1549](#L1549) | $sitesettings = $this->global\_settings; |
| [1550](#L1550) | if (!empty($sitesettings['sitesettings']['mousefollow'])) { |
| [1551](#L1551) | $color = !empty($sitesettings['sitesettings']['mousecolor']) ? $sitesettings['sitesettings']['mousecolor'] : '#2184f9'; |
| [1552](#L1552) | echo '<div class="gsmouseball"></div><div class="gsmouseballsmall"></div><style>.gsmouseball{width:33px;height:33px;position:fixed;top:0;left:0;z-index:99999;border:1px solid ' . esc\_attr($color) . ';border-radius:50%;pointer-events:none;opacity:0}.gsmouseballsmall{width:4px;height:4px;position:fixed;top:0;left:0;background:' . esc\_attr($color) . ';border-radius:50%;pointer-events:none;opacity:0; z-index:99999}</style>'; |
| [1553](#L1553) | wp\_enqueue\_script('gsap-mousefollow-init'); |
| [1554](#L1554) | } |
| [1555](#L1555) | if (!empty($sitesettings['sitesettings']['smoothscroll'])) { |
| [1556](#L1556) | wp\_enqueue\_script('gs-smooth-scroll'); |
| [1557](#L1557) | } |
| [1558](#L1558) | } |
| [1559](#L1559) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [1560](#L1560) | if (!empty($theme\_settings['custom\_code\_before\_closed\_body'])) { |
| [1561](#L1561) | echo wp\_kses(wp\_unslash($theme\_settings['custom\_code\_before\_closed\_body']), [ |
| [1562](#L1562) | 'meta' => [ |
| [1563](#L1563) | 'charset' => [], |
| [1564](#L1564) | 'content' => [], |
| [1565](#L1565) | 'http-equiv' => [], |
| [1566](#L1566) | 'name' => [], |
| [1567](#L1567) | 'property' => [] |
| [1568](#L1568) | ], |
| [1569](#L1569) | 'style' => [ |
| [1570](#L1570) | 'media' => [], |
| [1571](#L1571) | 'type' => [] |
| [1572](#L1572) | ], |
| [1573](#L1573) | 'script' => [ |
| [1574](#L1574) | 'async' => [], |
| [1575](#L1575) | 'charset' => [], |
| [1576](#L1576) | 'defer' => [], |
| [1577](#L1577) | 'src' => [], |
| [1578](#L1578) | 'type' => [] |
| [1579](#L1579) | ], |
| [1580](#L1580) | 'link' => [ |
| [1581](#L1581) | 'href' => [], |
| [1582](#L1582) | 'rel' => [], |
| [1583](#L1583) | 'type' => [] |
| [1584](#L1584) | ], |
| [1585](#L1585) | 'img' => [ |
| [1586](#L1586) | 'alt' => [], |
| [1587](#L1587) | 'height' => [], |
| [1588](#L1588) | 'src' => [], |
| [1589](#L1589) | 'width' => [], |
| [1590](#L1590) | 'style' => [] |
| [1591](#L1591) | ], |
| [1592](#L1592) | 'iframe' => [ |
| [1593](#L1593) | 'height' => [], |
| [1594](#L1594) | 'src' => [], |
| [1595](#L1595) | 'width' => [], |
| [1596](#L1596) | 'style' => [] |
| [1597](#L1597) | ], |
| [1598](#L1598) | 'noscript' => [] |
| [1599](#L1599) | ]); |
| [1600](#L1600) | } |
| [1601](#L1601) | } |
| [1602](#L1602) | } |
| [1603](#L1603) | } |
| [1604](#L1604) |  |
| [1605](#L1605) | function gspb\_get\_inline\_styles\_blocks($blocks) |
| [1606](#L1606) | { |
| [1607](#L1607) | $inlinestyle = ''; |
| [1608](#L1608) | foreach ($blocks as $block) { |
| [1609](#L1609) | if (!empty($block['attrs']['inlineCssStyles'])) { |
| [1610](#L1610) | $dynamic\_style = $block['attrs']['inlineCssStyles']; |
| [1611](#L1611) | $dynamic\_style = gspb\_get\_final\_css($dynamic\_style); |
| [1612](#L1612) | $dynamic\_style = gspb\_quick\_minify\_css($dynamic\_style); |
| [1613](#L1613) | $dynamic\_style = htmlspecialchars\_decode($dynamic\_style); |
| [1614](#L1614) | $inlinestyle .= $dynamic\_style; |
| [1615](#L1615) | } |
| [1616](#L1616) | gspb\_greenShift\_block\_script\_assets('', $block); |
| [1617](#L1617) | if (function\_exists('greenShiftGsap\_block\_script\_assets')) { |
| [1618](#L1618) | greenShiftGsap\_block\_script\_assets('', $block); |
| [1619](#L1619) | } |
| [1620](#L1620) | if (!empty($block['innerBlocks'])) { |
| [1621](#L1621) | $blocks = $block['innerBlocks']; |
| [1622](#L1622) | $inlinestyle .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1623](#L1623) | } |
| [1624](#L1624) | } |
| [1625](#L1625) | return $inlinestyle; |
| [1626](#L1626) | } |
| [1627](#L1627) |  |
| [1628](#L1628) | ////////////////////////////////////////////////////////////////// |
| [1629](#L1629) | // File Manager |
| [1630](#L1630) | ////////////////////////////////////////////////////////////////// |
| [1631](#L1631) |  |
| [1632](#L1632) | if (!function\_exists('greenshift\_download\_file\_localy')) { |
| [1633](#L1633) | function greenshift\_download\_file\_localy($file\_uri, $save\_dir, $file\_name, $file\_ext = null, $check\_type = '') |
| [1634](#L1634) | { |
| [1635](#L1635) | $file\_path = trailingslashit($save\_dir) . $file\_name; |
| [1636](#L1636) | if (file\_exists($file\_path)) { |
| [1637](#L1637) | return $file\_name; |
| [1638](#L1638) | } |
| [1639](#L1639) | $args = array( |
| [1640](#L1640) | 'timeout' => 30, |
| [1641](#L1641) | 'httpversion' => '1.1', |
| [1642](#L1642) | 'user-agent'  => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36', |
| [1643](#L1643) | 'sslverify'   => true, |
| [1644](#L1644) | ); |
| [1645](#L1645) |  |
| [1646](#L1646) | $response = wp\_remote\_get($file\_uri, $args); |
| [1647](#L1647) |  |
| [1648](#L1648) | if (is\_wp\_error($response) || (int) wp\_remote\_retrieve\_response\_code($response) !== 200) { |
| [1649](#L1649) | return false; |
| [1650](#L1650) | } |
| [1651](#L1651) |  |
| [1652](#L1652) | if ($file\_ext === null) { |
| [1653](#L1653) | $headers = wp\_remote\_retrieve\_headers($response); |
| [1654](#L1654) | if (empty($headers['content-type'])) return false; |
| [1655](#L1655) |  |
| [1656](#L1656) | $types = array\_search($headers['content-type'], wp\_get\_mime\_types()); |
| [1657](#L1657) |  |
| [1658](#L1658) | if (!$types) return false; |
| [1659](#L1659) |  |
| [1660](#L1660) | $exts = explode('|', $types); |
| [1661](#L1661) | $file\_ext = $exts[0]; |
| [1662](#L1662) | $file\_name .= '.' . $file\_ext; |
| [1663](#L1663) | } |
| [1664](#L1664) |  |
| [1665](#L1665) | $file\_name = wp\_unique\_filename($save\_dir, $file\_name); |
| [1666](#L1666) | if ($check\_type) { |
| [1667](#L1667) | $filetype = wp\_check\_filetype($file\_name); |
| [1668](#L1668) | if ($filetype['type'] != $check\_type) |
| [1669](#L1669) | return false; |
| [1670](#L1670) | } |
| [1671](#L1671) |  |
| [1672](#L1672) | $image\_string = wp\_remote\_retrieve\_body($response); |
| [1673](#L1673) | if (!file\_put\_contents($file\_path, $image\_string)) |
| [1674](#L1674) | return false; |
| [1675](#L1675) |  |
| [1676](#L1676) | return $file\_name; |
| [1677](#L1677) | } |
| [1678](#L1678) | } |
| [1679](#L1679) |  |
| [1680](#L1680) | if (!function\_exists('greenshift\_save\_file\_localy')) { |
| [1681](#L1681) | function greenshift\_save\_file\_localy($file\_uri, $img\_title = '', $check\_type = '') |
| [1682](#L1682) | { |
| [1683](#L1683) | if(!current\_user\_can('manage\_options')) return false; |
| [1684](#L1684) | $newfilename = basename($file\_uri); |
| [1685](#L1685) | $ext = pathinfo(basename($file\_uri), PATHINFO\_EXTENSION); |
| [1686](#L1686) |  |
| [1687](#L1687) | $ext = ($ext) ? $ext : null; |
| [1688](#L1688) |  |
| [1689](#L1689) | if($ext == 'svg') return false; |
| [1690](#L1690) |  |
| [1691](#L1691) | if (empty($newfilename)) { |
| [1692](#L1692) | $newfilename = preg\_replace('/[^a-zA-Z0-9\-]/', '', $newfilename); |
| [1693](#L1693) | $newfilename = strtolower($newfilename); |
| [1694](#L1694) | } |
| [1695](#L1695) |  |
| [1696](#L1696) | $uploads = wp\_upload\_dir(); |
| [1697](#L1697) |  |
| [1698](#L1698) | if ($newfilename = greenshift\_download\_file\_localy($file\_uri, $uploads['path'], $newfilename, $ext, $check\_type)) { |
| [1699](#L1699) | return $newfilename; |
| [1700](#L1700) | } else { |
| [1701](#L1701) | return false; |
| [1702](#L1702) | } |
| [1703](#L1703) | } |
| [1704](#L1704) | } |
| [1705](#L1705) |  |
| [1706](#L1706) | if (!function\_exists('greenshift\_replace\_ext\_images')) { |
| [1707](#L1707) | function greenshift\_replace\_ext\_images($content, $format = 'json') |
| [1708](#L1708) | { |
| [1709](#L1709) | $pattern = '#https?://[^/\s]+/\S+\.(jpg|png|gif|webp|svg|jpeg|json)#'; |
| [1710](#L1710) | if ($format == 'json') { |
| [1711](#L1711) | $content = json\_decode($content, true); |
| [1712](#L1712) | } |
| [1713](#L1713) | $result = preg\_replace\_callback($pattern, function ($match) { |
| [1714](#L1714) | if (is\_array($match)) { |
| [1715](#L1715) | $url = $match[0]; |
| [1716](#L1716) | if (strpos($url, get\_bloginfo('url')) !== 0) { |
| [1717](#L1717) | $urlnew = greenshift\_save\_file\_localy($url); |
| [1718](#L1718) | $uploads = wp\_upload\_dir(); |
| [1719](#L1719) | $image = trailingslashit($uploads['url']) . $urlnew; |
| [1720](#L1720) | return $image; |
| [1721](#L1721) | } else { |
| [1722](#L1722) | return $url; |
| [1723](#L1723) | } |
| [1724](#L1724) | } |
| [1725](#L1725) | }, $content); |
| [1726](#L1726) | if ($format == 'json') { |
| [1727](#L1727) | $result = json\_encode($result); |
| [1728](#L1728) | } |
| [1729](#L1729) | return $result; |
| [1730](#L1730) | } |
| [1731](#L1731) | } |
| [1732](#L1732) |  |
| [1733](#L1733) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?format=txt)
* [Original Format](/export/3222484/greenshift-animation-and-page-builder-blocks/trunk/settings.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_f108f4eb_20250114_215754.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fgreenshift-animation-and-page-builder-blocks%2Ftrunk%2Fsettings.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3219798 "Revision 3219798")
* Next Revision →
* [Blame](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/greenshift-animation-and-page-builder-blocks/trunk/settings.php)

---

# [source:](/browser?order=name "Go to repository root") [greenshift-animation-and-page-builder-blocks](/browser/greenshift-animation-and-page-builder-blocks?order=name "View greenshift-animation-and-page-builder-blocks")/[trunk](/browser/greenshift-animation-and-page-builder-blocks/trunk?order=name "View trunk")/[settings.php](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?order=name "View settings.php")

View diff against:

View revision:

| [Last change](/changeset/3221806/greenshift-animation-and-page-builder-blocks/trunk/settings.php "View differences") on this file was [3221806](/changeset/3221806/ "View changeset 3221806"), checked in by wpsoul, [25 hours ago](/timeline?from=2025-01-13T20%3A42%3A18Z&precision=second "See timeline at 01/13/2025 08:42:18 PM") |
| --- |
| update |
| **File size:** 76.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | // Exit if accessed directly |
| [3](#L3) | if (!defined('ABSPATH')) { |
| [4](#L4) | exit; |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | if (!class\_exists('GSPB\_GreenShift\_Settings')) { |
| [8](#L8) |  |
| [9](#L9) | class GSPB\_GreenShift\_Settings |
| [10](#L10) | { |
| [11](#L11) | private $allowed\_font\_ext = [ |
| [12](#L12) | 'woff2', |
| [13](#L13) | 'woff', |
| [14](#L14) | 'tiff', |
| [15](#L15) | 'ttf', |
| [16](#L16) | ]; |
| [17](#L17) |  |
| [18](#L18) | private $global\_settings = array(); |
| [19](#L19) |  |
| [20](#L20) | public function \_\_construct() |
| [21](#L21) | { |
| [22](#L22) | $this->global\_settings = get\_option('gspb\_global\_settings'); |
| [23](#L23) | add\_filter('body\_class', array($this, 'gspb\_front\_body\_class')); |
| [24](#L24) |  |
| [25](#L25) | add\_filter('admin\_body\_class', array($this, 'gspb\_admin\_body\_class')); |
| [26](#L26) | add\_action('admin\_menu', array($this, 'greenshift\_admin\_page')); |
| [27](#L27) | add\_action('wp\_footer', array($this, 'greenshift\_additional\_\_footer\_elements')); |
| [28](#L28) | add\_action('wp\_head', array($this, 'greenshift\_additional\_\_header\_elements')); |
| [29](#L29) | add\_action('wp\_ajax\_gspb\_generate\_stylebook', array($this, 'gspb\_generate\_stylebook')); |
| [30](#L30) | add\_action('admin\_init', array($this, 'gspb\_stylebook\_redirect')); |
| [31](#L31) | add\_action('admin\_enqueue\_scripts', array($this, 'greenshift\_admin\_enqueue\_scripts')); |
| [32](#L32) | add\_filter('block\_categories\_all', array($this, 'gspb\_greenShift\_category'), 11, 2); |
| [33](#L33) | add\_filter('block\_editor\_settings\_all', array($this, 'gspb\_generate\_custom\_block\_settings'), 10, 2); |
| [34](#L34) | if (!defined('REHUB\_ADMIN\_DIR')) { |
| [35](#L35) | //Show Reusable blocks column |
| [36](#L36) | add\_filter('manage\_wp\_block\_posts\_columns', array($this, 'gspb\_template\_screen\_add\_column')); |
| [37](#L37) | add\_action('manage\_wp\_block\_posts\_custom\_column', array($this, 'gspb\_template\_screen\_fill\_column'), 1000, 2); |
| [38](#L38) | // Force Block editor for Reusable Blocks even when Classic editor plugin is activated |
| [39](#L39) | add\_filter('use\_block\_editor\_for\_post', array($this, 'gspb\_template\_gutenberg\_post'), 1000, 2); |
| [40](#L40) | add\_filter('use\_block\_editor\_for\_post\_type', array($this, 'gspb\_template\_gutenberg\_post\_type'), 1000, 2); |
| [41](#L41) | //Shortcode output for reusable blocks |
| [42](#L42) | add\_shortcode('wp\_reusable\_render', array($this, 'gspb\_template\_shortcode\_function')); |
| [43](#L43) | //Ajax render action |
| [44](#L44) | add\_action('wp\_ajax\_gspb\_el\_reusable\_load', array($this, 'gspb\_el\_reusable\_load')); |
| [45](#L45) | add\_action('wp\_ajax\_nopriv\_gspb\_el\_reusable\_load', array($this, 'gspb\_el\_reusable\_load')); |
| [46](#L46) | //settings fonts actions |
| [47](#L47) | add\_action('wp\_ajax\_gspb\_settings\_add\_font', array($this, 'gspb\_settings\_add\_font')); |
| [48](#L48) | } |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | public function gspb\_front\_body\_class($classes) |
| [52](#L52) | { |
| [53](#L53) | $classes[] = 'gspbody'; |
| [54](#L54) | $classes[] = 'gspb-bodyfront'; |
| [55](#L55) | $global\_settings = $this->global\_settings; |
| [56](#L56) | if (!empty($global\_settings['dark\_mode\_on'])) { |
| [57](#L57) | if (isset($\_COOKIE['darkmode'])){ |
| [58](#L58) | $classes[] = 'darkmode'; |
| [59](#L59) | } |
| [60](#L60) | } |
| [61](#L61) | return $classes; |
| [62](#L62) | } |
| [63](#L63) | public function gspb\_admin\_body\_class($classes) |
| [64](#L64) | { |
| [65](#L65) | $classes .= ' gspbody gspb-bodyadmin '; |
| [66](#L66) | return $classes; |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | function gspb\_generate\_custom\_block\_settings($settings, $block\_editor\_context) |
| [70](#L70) | { |
| [71](#L71) | $global\_settings = $this->global\_settings; |
| [72](#L72) | if (empty($global\_settings['anchors\_disable'])) { |
| [73](#L73) | $settings['generateAnchors'] = true; |
| [74](#L74) | } |
| [75](#L75) | if (!empty($global\_settings['simplified\_panels'])) { |
| [76](#L76) | $settings['canLockBlocks'] = current\_user\_can( 'manage\_options' ); |
| [77](#L77) | } |
| [78](#L78) | return $settings; |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | public function gspb\_greenShift\_category($categories, $post) |
| [82](#L82) | { |
| [83](#L83) | $global\_settings = $this->global\_settings; |
| [84](#L84) | if ((!empty($global\_settings['show\_element\_block']) && ($global\_settings['show\_element\_block'] === 'bothelement' || $global\_settings['show\_element\_block'] === 'element'))) { |
| [85](#L85) | return array\_merge( |
| [86](#L86) | array( |
| [87](#L87) | array( |
| [88](#L88) | 'slug'  => 'GreenLightLayout', |
| [89](#L89) | 'title' => \_\_('GreenLight Layout Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [90](#L90) | ), |
| [91](#L91) | array( |
| [92](#L92) | 'slug'  => 'GreenLightContent', |
| [93](#L93) | 'title' => \_\_('GreenLight Content Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [94](#L94) | ), |
| [95](#L95) | array( |
| [96](#L96) | 'slug'  => 'GreenLightExtra', |
| [97](#L97) | 'title' => \_\_('GreenLight Extra Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [98](#L98) | ), |
| [99](#L99) | array( |
| [100](#L100) | 'slug'  => 'GreenLightTags', |
| [101](#L101) | 'title' => \_\_('GreenLight Tags Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [102](#L102) | ), |
| [103](#L103) | array( |
| [104](#L104) | 'slug'  => 'GreenShiftLayout', |
| [105](#L105) | 'title' => \_\_('GreenShift Layout Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [106](#L106) | ), |
| [107](#L107) | array( |
| [108](#L108) | 'slug'  => 'GreenShiftContent', |
| [109](#L109) | 'title' => \_\_('GreenShift Content Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [110](#L110) | ), |
| [111](#L111) | array( |
| [112](#L112) | 'slug'  => 'GreenShiftExtra', |
| [113](#L113) | 'title' => \_\_('GreenShift Extra Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [114](#L114) | ), |
| [115](#L115) | ), |
| [116](#L116) | $categories |
| [117](#L117) | ); |
| [118](#L118) | }else{ |
| [119](#L119) | return array\_merge( |
| [120](#L120) | array( |
| [121](#L121) | array( |
| [122](#L122) | 'slug'  => 'GreenShiftLayout', |
| [123](#L123) | 'title' => \_\_('GreenShift Layout Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [124](#L124) | ), |
| [125](#L125) | array( |
| [126](#L126) | 'slug'  => 'GreenShiftContent', |
| [127](#L127) | 'title' => \_\_('GreenShift Content Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [128](#L128) | ), |
| [129](#L129) | array( |
| [130](#L130) | 'slug'  => 'GreenShiftExtra', |
| [131](#L131) | 'title' => \_\_('GreenShift Extra Blocks', 'greenshift-animation-and-page-builder-blocks'), |
| [132](#L132) | ), |
| [133](#L133) | array( |
| [134](#L134) | 'slug'  => 'GreenLightLayout', |
| [135](#L135) | 'title' => \_\_('GreenLight Layout Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [136](#L136) | ), |
| [137](#L137) | array( |
| [138](#L138) | 'slug'  => 'GreenLightContent', |
| [139](#L139) | 'title' => \_\_('GreenLight Content Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [140](#L140) | ), |
| [141](#L141) | array( |
| [142](#L142) | 'slug'  => 'GreenLightExtra', |
| [143](#L143) | 'title' => \_\_('GreenLight Extra Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [144](#L144) | ), |
| [145](#L145) | array( |
| [146](#L146) | 'slug'  => 'GreenLightTags', |
| [147](#L147) | 'title' => \_\_('GreenLight Tags Elements', 'greenshift-animation-and-page-builder-blocks'), |
| [148](#L148) | ), |
| [149](#L149) | ), |
| [150](#L150) | $categories |
| [151](#L151) | ); |
| [152](#L152) | } |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | public function greenshift\_admin\_enqueue\_scripts() |
| [156](#L156) | { |
| [157](#L157) | $current\_page = isset($\_GET['page']) ? $\_GET['page'] : ''; |
| [158](#L158) |  |
| [159](#L159) | // Check if the current admin page URL starts with 'greenshift' |
| [160](#L160) | if (strpos($current\_page, 'greenshift') === 0) { |
| [161](#L161) | wp\_enqueue\_style( 'greenShift-admin-css' ); |
| [162](#L162) | } |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) | public function greenshift\_admin\_page() |
| [166](#L166) | { |
| [167](#L167) |  |
| [168](#L168) | $parent\_slug = 'greenshift\_dashboard'; |
| [169](#L169) |  |
| [170](#L170) | if (!defined('REHUB\_ADMIN\_DIR')) { |
| [171](#L171) | add\_menu\_page( |
| [172](#L172) | esc\_html\_\_('Reusable Templates', 'greenshift-animation-and-page-builder-blocks'), |
| [173](#L173) | esc\_html\_\_('Reusable Templates', 'greenshift-animation-and-page-builder-blocks'), |
| [174](#L174) | 'manage\_options',  // Capability required to access the menu item |
| [175](#L175) | 'edit.php?post\_type=wp\_block',  // URL of the custom link |
| [176](#L176) | '', |
| [177](#L177) | 'dashicons-screenoptions',  // Icon URL (optional) |
| [178](#L178) | 71  // Position of the menu item (use a number to set the position; 6 will place the item below "Settings") |
| [179](#L179) | ); |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) |  |
| [183](#L183) | add\_menu\_page( |
| [184](#L184) | 'GreenShift', |
| [185](#L185) | 'GreenShift', |
| [186](#L186) | 'manage\_options', |
| [187](#L187) | $parent\_slug, |
| [188](#L188) | array($this, 'welcome\_page'), |
| [189](#L189) | plugin\_dir\_url(\_\_FILE\_\_) . 'libs/gspbLogo.svg', |
| [190](#L190) | 70 |
| [191](#L191) | ); |
| [192](#L192) |  |
| [193](#L193) | add\_submenu\_page( |
| [194](#L194) | $parent\_slug, |
| [195](#L195) | esc\_html\_\_('Settings', 'greenshift-animation-and-page-builder-blocks'), |
| [196](#L196) | esc\_html\_\_('Settings', 'greenshift-animation-and-page-builder-blocks'), |
| [197](#L197) | 'manage\_options', |
| [198](#L198) | 'greenshift', |
| [199](#L199) | array($this, 'settings\_page') |
| [200](#L200) | ); |
| [201](#L201) |  |
| [202](#L202) | add\_submenu\_page( |
| [203](#L203) | $parent\_slug, |
| [204](#L204) | esc\_html\_\_('Addons', 'greenshift-animation-and-page-builder-blocks'), |
| [205](#L205) | esc\_html\_\_('Addons', 'greenshift-animation-and-page-builder-blocks'), |
| [206](#L206) | 'manage\_options', |
| [207](#L207) | 'greenshift\_dashboard-addons', |
| [208](#L208) | array($this, 'addons\_page') |
| [209](#L209) | ); |
| [210](#L210) |  |
| [211](#L211) | add\_submenu\_page( |
| [212](#L212) | $parent\_slug, |
| [213](#L213) | esc\_html\_\_('Upgrade', 'greenshift-animation-and-page-builder-blocks'), |
| [214](#L214) | esc\_html\_\_('Upgrade', 'greenshift-animation-and-page-builder-blocks'), |
| [215](#L215) | 'manage\_options', |
| [216](#L216) | 'greenshift\_upgrade', |
| [217](#L217) | array($this, 'upgrade\_page') |
| [218](#L218) | ); |
| [219](#L219) |  |
| [220](#L220) | add\_submenu\_page( |
| [221](#L221) | $parent\_slug, |
| [222](#L222) | esc\_html\_\_('Contact Us', 'greenshift-animation-and-page-builder-blocks'), |
| [223](#L223) | esc\_html\_\_('Contact Us', 'greenshift-animation-and-page-builder-blocks'), |
| [224](#L224) | 'manage\_options', |
| [225](#L225) | 'greenshift\_contact', |
| [226](#L226) | array($this, 'contact\_page') |
| [227](#L227) | ); |
| [228](#L228) | add\_submenu\_page( |
| [229](#L229) | $parent\_slug, |
| [230](#L230) | esc\_html\_\_('Import/Export', 'greenshift-animation-and-page-builder-blocks'), |
| [231](#L231) | esc\_html\_\_('Import/Export', 'greenshift-animation-and-page-builder-blocks'), |
| [232](#L232) | 'manage\_options', |
| [233](#L233) | 'greenshift\_import', |
| [234](#L234) | array($this, 'import\_page') |
| [235](#L235) | ); |
| [236](#L236) | add\_submenu\_page( |
| [237](#L237) | $parent\_slug, |
| [238](#L238) | esc\_html\_\_('Demo Import', 'greenshift-animation-and-page-builder-blocks'), |
| [239](#L239) | esc\_html\_\_('Demo Import', 'greenshift-animation-and-page-builder-blocks'), |
| [240](#L240) | 'manage\_options', |
| [241](#L241) | 'greenshift\_demo', |
| [242](#L242) | array($this, 'import\_demo') |
| [243](#L243) | ); |
| [244](#L244) |  |
| [245](#L245) | $stylebook\_post\_id = get\_option('gspb\_stylebook\_id'); |
| [246](#L246) |  |
| [247](#L247) | if ($stylebook\_post\_id) { |
| [248](#L248) |  |
| [249](#L249) | $editposturl = admin\_url('post.php?post=' . $stylebook\_post\_id . '&action=edit'); |
| [250](#L250) |  |
| [251](#L251) | add\_submenu\_page( |
| [252](#L252) | $parent\_slug, |
| [253](#L253) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [254](#L254) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [255](#L255) | 'manage\_options', |
| [256](#L256) | $editposturl |
| [257](#L257) | ); |
| [258](#L258) | } else { |
| [259](#L259) |  |
| [260](#L260) | add\_submenu\_page( |
| [261](#L261) | $parent\_slug, |
| [262](#L262) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [263](#L263) | esc\_html\_\_('Stylebook', 'greenshift-animation-and-page-builder-blocks'), |
| [264](#L264) | 'manage\_options', |
| [265](#L265) | 'greenshift\_stylebook', |
| [266](#L266) | array($this, 'stylebook\_page\_callback') |
| [267](#L267) | ); |
| [268](#L268) | } |
| [269](#L269) | } |
| [270](#L270) |  |
| [271](#L271) | public function welcome\_page() |
| [272](#L272) | { |
| [273](#L273) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/welcome-page.php'; |
| [274](#L274) | } |
| [275](#L275) |  |
| [276](#L276) | public function contact\_page() |
| [277](#L277) | { |
| [278](#L278) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/contact-page.php'; |
| [279](#L279) | } |
| [280](#L280) |  |
| [281](#L281) | public function import\_page() |
| [282](#L282) | { |
| [283](#L283) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/import-page.php'; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | public function import\_demo() |
| [287](#L287) | { |
| [288](#L288) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/import-demo.php'; |
| [289](#L289) | } |
| [290](#L290) |  |
| [291](#L291) | public function addons\_page() |
| [292](#L292) | { |
| [293](#L293) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/addon-page.php'; |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | public function upgrade\_page() |
| [297](#L297) | { |
| [298](#L298) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/upgrade-page.php'; |
| [299](#L299) | } |
| [300](#L300) |  |
| [301](#L301) | public function stylebook\_page\_callback() |
| [302](#L302) | { |
| [303](#L303) | ?> |
| [304](#L304) | <style> |
| [305](#L305) | #greenshift\_stylebook\_btn { |
| [306](#L306) | margin-top: 30px; |
| [307](#L307) | width: 220px; |
| [308](#L308) | height: 40px; |
| [309](#L309) | font-size: 1rem; |
| [310](#L310) | line-height: 1rem; |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | .stylbook\_btn\_wrapper { |
| [314](#L314) | position: relative; |
| [315](#L315) | display: flex; |
| [316](#L316) | align-items: center; |
| [317](#L317) | } |
| [318](#L318) | </style> |
| [319](#L319) | <script> |
| [320](#L320) | jQuery(document).ready(function($) { |
| [321](#L321) | // Stylebook ajax request |
| [322](#L322) | $("#stylebook\_generation").submit(function(e) { |
| [323](#L323) | e.preventDefault(); |
| [324](#L324) |  |
| [325](#L325) | $('#ajax-response').html(''); |
| [326](#L326) |  |
| [327](#L327) | const targetForm = e.target; |
| [328](#L328) | const payload = new FormData(targetForm); |
| [329](#L329) | payload.append("action", "gspb\_generate\_stylebook") |
| [330](#L330) | $.ajax({ |
| [331](#L331) | method: "POST", |
| [332](#L332) | url: ajaxurl, |
| [333](#L333) | processData: false, |
| [334](#L334) | contentType: false, |
| [335](#L335) | data: payload, |
| [336](#L336) | beforeSend: function(response) { |
| [337](#L337) | $(".spinner").addClass("is-active"); |
| [338](#L338) | } |
| [339](#L339) | }) |
| [340](#L340) | .success(function(response) { |
| [341](#L341) | $(".spinner").removeClass("is-active"); |
| [342](#L342) | if (response.data.status == "success") { |
| [343](#L343) | const post\_link = response?.data?.post\_link; |
| [344](#L344) | if (post\_link) { |
| [345](#L345) | const postEditLink = post\_link.replace(/&amp;/g, '&'); |
| [346](#L346) | window.location.href = postEditLink; |
| [347](#L347) | } |
| [348](#L348) | } |
| [349](#L349) | if (response.data.status == "error") { |
| [350](#L350) | $('#ajax-response').append('<div class="notice notice-error"><p>' + response.data.msg + '</p></div>'); |
| [351](#L351) | } |
| [352](#L352) | }) |
| [353](#L353) | .error(function(response) { |
| [354](#L354) | $(".spinner").removeClass("is-active"); |
| [355](#L355) | $('#ajax-response').append('<div class="notice notice-error"><p>Something went wrong.</p></div>'); |
| [356](#L356) | }); |
| [357](#L357) |  |
| [358](#L358) | }); |
| [359](#L359) | }); |
| [360](#L360) | </script> |
| [361](#L361) | <div class="stylebook\_form\_wrap" style="padding:25px"> |
| [362](#L362) | <h1><?php \_e('GreenShift Stylebook', 'greenshift-animation-and-page-builder-blocks'); ?></h1> |
| [363](#L363) | <div id="ajax-response"> </div> |
| [364](#L364) | <form id="stylebook\_generation" method="post" class="stylbook\_btn\_wrapper"> |
| [365](#L365) | <?php wp\_nonce\_field('gspb\_generate\_stylebook', 'gspb\_stylebook'); ?> |
| [366](#L366) | <div class="stylbook\_btn\_wrapper"> |
| [367](#L367) | <input type="submit" id="greenshift\_stylebook\_btn" name="greenshift\_stylebook\_btn" value=<?php \_e('Create Stylebook', 'greenshift-animation-and-page-builder-blocks'); ?> class="button button-primary button-large"> |
| [368](#L368) | <span class="spinner"></span> |
| [369](#L369) | </div> |
| [370](#L370) | </form> |
| [371](#L371) | </div> |
| [372](#L372) | <?php |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | public function gspb\_stylebook\_redirect() |
| [376](#L376) | { |
| [377](#L377) | if (isset($\_GET['post\_type']) && $\_GET['post\_type'] === 'gspbstylebook') { |
| [378](#L378) | wp\_safe\_redirect(admin\_url('?page=greenshift\_dashboard')); |
| [379](#L379) | exit; |
| [380](#L380) | } |
| [381](#L381) | } |
| [382](#L382) |  |
| [383](#L383) | public function gspb\_generate\_stylebook() |
| [384](#L384) | { |
| [385](#L385) |  |
| [386](#L386) | $response = array(); |
| [387](#L387) |  |
| [388](#L388) | if (!isset($\_POST['gspb\_stylebook'])  || !wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_stylebook'])), 'gspb\_generate\_stylebook')) { |
| [389](#L389) |  |
| [390](#L390) | $response =  array( |
| [391](#L391) | 'status' => 'error', |
| [392](#L392) | 'msg' => 'User Security not varified.' |
| [393](#L393) | ); |
| [394](#L394) | } else { |
| [395](#L395) | $stylebook\_post\_id = get\_option('gspb\_stylebook\_id'); |
| [396](#L396) |  |
| [397](#L397) | if (!$stylebook\_post\_id || !get\_edit\_post\_link($stylebook\_post\_id)) { |
| [398](#L398) |  |
| [399](#L399) | // Create post object |
| [400](#L400) | $stylebook\_post = array( |
| [401](#L401) | 'post\_title'    => 'Greenshift Stylebook', |
| [402](#L402) | 'post\_type'             => 'gspbstylebook', |
| [403](#L403) | 'post\_name'             =>      'greenshift-stylebook', |
| [404](#L404) | 'post\_content'  =>      '<!-- wp:greenshift-blocks/stylebook /-->', |
| [405](#L405) | 'post\_status'   => 'publish', |
| [406](#L406) | ); |
| [407](#L407) |  |
| [408](#L408) | // Insert the post into the database |
| [409](#L409) | $stylebook\_post\_id = wp\_insert\_post($stylebook\_post); |
| [410](#L410) |  |
| [411](#L411) | if (!is\_wp\_error($stylebook\_post\_id)) { |
| [412](#L412) |  |
| [413](#L413) | $response =  array( |
| [414](#L414) | 'status' => 'success', |
| [415](#L415) | 'post\_link' => get\_edit\_post\_link($stylebook\_post\_id) |
| [416](#L416) | ); |
| [417](#L417) |  |
| [418](#L418) | update\_option('gspb\_stylebook\_id', $stylebook\_post\_id); |
| [419](#L419) |  |
| [420](#L420) | // we need to flush this because post is created programatically. |
| [421](#L421) | flush\_rewrite\_rules(); |
| [422](#L422) | } else { |
| [423](#L423) |  |
| [424](#L424) | $response =  array( |
| [425](#L425) | 'status' => 'error', |
| [426](#L426) | 'msg' => $stylebook\_post\_id->get\_error\_message() |
| [427](#L427) | ); |
| [428](#L428) |  |
| [429](#L429) | return $response; |
| [430](#L430) | } |
| [431](#L431) | } else { |
| [432](#L432) |  |
| [433](#L433) | $response =  array( |
| [434](#L434) | 'status' => 'success', |
| [435](#L435) | 'post\_link' => get\_edit\_post\_link($stylebook\_post\_id) |
| [436](#L436) | ); |
| [437](#L437) | } |
| [438](#L438) | } |
| [439](#L439) |  |
| [440](#L440) | wp\_send\_json\_success($response); |
| [441](#L441) | } |
| [442](#L442) |  |
| [443](#L443) | public function settings\_page() |
| [444](#L444) | { |
| [445](#L445) |  |
| [446](#L446) | if (!current\_user\_can('manage\_options')) { |
| [447](#L447) | wp\_die('Unauthorized user'); |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) | // Get the active tab from the $\_GET param |
| [451](#L451) | $default\_tab = null; |
| [452](#L452) | $tab  = isset($\_GET['tab']) ? sanitize\_text\_field($\_GET['tab']) : $default\_tab; |
| [453](#L453) |  |
| [454](#L454) | ?> |
| [455](#L455) |  |
| [456](#L456) | <div class="wp-block-greenshift-blocks-container alignfull gspb\_container gspb\_container-gsbp-ead11204-4841" id="gspb\_container-id-gsbp-ead11204-4841"> |
| [457](#L457) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-cbc3fa8c-bb26" id="gspb\_container-id-gsbp-cbc3fa8c-bb26"> |
| [458](#L458) |  |
| [459](#L459) | <?php $activetab = 'settings'; ?> |
| [460](#L460) | <?php include(GREENSHIFT\_DIR\_PATH . 'templates/admin/navleft.php'); ?> |
| [461](#L461) |  |
| [462](#L462) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-89d45563-1559" id="gspb\_container-id-gsbp-89d45563-1559"> |
| [463](#L463) |  |
| [464](#L464) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-efb64efe-d083" id="gspb\_container-id-gsbp-efb64efe-d083"> |
| [465](#L465) | <h2 id="gspb\_heading-id-gsbp-ca0b0ada-6561" class="gspb\_heading gspb\_heading-id-gsbp-ca0b0ada-6561 "><?php esc\_html\_e("Settings", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [466](#L466) | </div> |
| [467](#L467) |  |
| [468](#L468) | <div class="class-tabs-gs wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-01099b45-f36b" id="gspb\_container-id-gsbp-01099b45-f36b"> |
| [469](#L469) | <a href="?page=greenshift" id="gspb\_text-id-gsbp-2c96ad79-8324" class="gspb\_text gspb\_text-id-gsbp-2c96ad79-8324 <?php if ($tab === null) : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Font Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [470](#L470) | <a href="?page=greenshift&tab=breakpoints" id="gspb\_text-id-gsbp-557ed921-38fe" class="gspb\_text gspb\_text-id-gsbp-557ed921-38fe <?php if ($tab === 'breakpoints') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Breakpoints", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [471](#L471) | <a href="?page=greenshift&tab=save\_css" id="gspb\_text-id-gsbp-94bd1cf0-c77b" class="gspb\_text gspb\_text-id-gsbp-94bd1cf0-c77b <?php if ($tab === 'save\_css') : ?>gs-tab-active<?php endif; ?> "><?php esc\_html\_e("CSS Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [472](#L472) | <a href="?page=greenshift&tab=scripts" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'scripts') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Script Options", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [473](#L473) | <a href="?page=greenshift&tab=header" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'header') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Header/Footer code", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [474](#L474) | <a href="?page=greenshift&tab=interface" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'interface') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("Interface", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [475](#L475) | <a href="?page=greenshift&tab=keys" id="gspb\_text-id-gsbp-f27becf0-4d87" class="gspb\_text gspb\_text-id-gsbp-f27becf0-4d87   <?php if ($tab === 'keys') : ?>gs-tab-active<?php endif; ?>"><?php esc\_html\_e("API Keys", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [476](#L476) | </div> |
| [477](#L477) |  |
| [478](#L478) |  |
| [479](#L479) | <div class="wp-block-greenshift-blocks-container gspb\_container gspb\_container-gsbp-7b4f8e8f-1a69" id="gspb\_container-id-gsbp-7b4f8e8f-1a69"> |
| [480](#L480) | <div class="greenshift\_form"> |
| [481](#L481) | <?php |
| [482](#L482) | switch ($tab): |
| [483](#L483) | case 'save\_css': |
| [484](#L484) |  |
| [485](#L485) | if (isset($\_POST['gspb\_save\_settings'])) { |
| [486](#L486) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [487](#L487) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [488](#L488) | return; |
| [489](#L489) | } |
| [490](#L490) | update\_option('gspb\_css\_save', sanitize\_text\_field($\_POST['gspb\_settings\_option'])); |
| [491](#L491) |  |
| [492](#L492) | $default\_settings = get\_option('gspb\_global\_settings'); |
| [493](#L493) |  |
| [494](#L494) | $sanitised = array(); |
| [495](#L495) | if (!empty($\_POST['reusablestyles'])) { |
| [496](#L496) | foreach ($\_POST['reusablestyles'] as $key => $value) { |
| [497](#L497) | $sanitised['reusablestyles'][$key] = array( |
| [498](#L498) | "style" => sanitize\_textarea\_field($value['style']), |
| [499](#L499) | "blockname" =>  sanitize\_text\_field($value['blockname']), |
| [500](#L500) | ); |
| [501](#L501) | } |
| [502](#L502) | $newargs = wp\_parse\_args($sanitised, $default\_settings); |
| [503](#L503) | update\_option('gspb\_global\_settings', $newargs); |
| [504](#L504) | } |
| [505](#L505) | if (isset($\_POST['dark\_mode\_on'])) { |
| [506](#L506) | $newargs = wp\_parse\_args(array('dark\_mode\_on' => true), $default\_settings); |
| [507](#L507) | update\_option('gspb\_global\_settings', $newargs); |
| [508](#L508) | } else { |
| [509](#L509) | $newargs = wp\_parse\_args(array('dark\_mode\_on' => false), $default\_settings); |
| [510](#L510) | update\_option('gspb\_global\_settings', $newargs); |
| [511](#L511) | } |
| [512](#L512) | if (isset($\_POST['enable\_head\_inline'])) { |
| [513](#L513) | $newargs = wp\_parse\_args(array('enable\_head\_inline' => true), $default\_settings); |
| [514](#L514) | update\_option('gspb\_global\_settings', $newargs); |
| [515](#L515) | } else { |
| [516](#L516) | $newargs = wp\_parse\_args(array('enable\_head\_inline' => false), $default\_settings); |
| [517](#L517) | update\_option('gspb\_global\_settings', $newargs); |
| [518](#L518) | } |
| [519](#L519) | } |
| [520](#L520) |  |
| [521](#L521) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [522](#L522) | $css\_tsyle\_option = get\_option('gspb\_css\_save'); |
| [523](#L523) | $dark\_mode\_on = !empty($global\_settings['dark\_mode\_on']) ? $global\_settings['dark\_mode\_on'] : ''; |
| [524](#L524) | $enable\_head\_inline = !empty($global\_settings['enable\_head\_inline']) ? $global\_settings['enable\_head\_inline'] : ''; |
| [525](#L525) | ?> |
| [526](#L526) | <div class="gspb\_settings\_form"> |
| [527](#L527) | <form method="POST"> |
| [528](#L528) | <div class="greenshift\_form"> |
| [529](#L529) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [530](#L530) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [531](#L531) | <div class="gs-box notice\_type icon\_type"> |
| [532](#L532) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [533](#L533) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [534](#L534) | </svg></div> |
| [535](#L535) | <div class="gs-box-text"> |
| [536](#L536) | <?php esc\_html\_e("Use Inline in block only if you have some issues with not updating styles of blocks or cache. Once saved as inline in block, styles can be overwritten only when you update post with blocks", 'greenshift-animation-and-page-builder-blocks'); ?> |
| [537](#L537) | </div> |
| [538](#L538) | </div> |
| [539](#L539) | </div> |
| [540](#L540) | <table class="form-table"> |
| [541](#L541) | <tr> |
| [542](#L542) | <td> <label for="css\_system"><?php esc\_html\_e("Css location", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [543](#L543) | <td> |
| [544](#L544) | <select name="gspb\_settings\_option"> |
| [545](#L545) | <option value="inline" <?php selected($css\_tsyle\_option, 'inline'); ?>><?php esc\_html\_e("Inline in Head", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [546](#L546) | <option value="inlineblock" <?php selected($css\_tsyle\_option, 'inlineblock'); ?>> <?php esc\_html\_e("Inline in block", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [547](#L547) | </select> |
| [548](#L548) | </td> |
| [549](#L549) | </tr> |
| [550](#L550) | <tr> |
| [551](#L551) | <td> <label for="dark\_mode\_on"><?php esc\_html\_e("Enable detection of dark mode before site loading", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [552](#L552) | <td> |
| [553](#L553) | <input type="checkbox" name="dark\_mode\_on" id="dark\_mode\_on" <?php echo $dark\_mode\_on == true ? 'checked' : ''; ?> /> |
| [554](#L554) | </td> |
| [555](#L555) | </tr> |
| [556](#L556) | <tr> |
| [557](#L557) | <td> <label for="enable\_head\_inline"><?php esc\_html\_e("Try to merge all inline styles (Beta, works only in block themes)", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [558](#L558) | <td> |
| [559](#L559) | <input type="checkbox" name="enable\_head\_inline" id="enable\_head\_inline" <?php echo $enable\_head\_inline == true ? 'checked' : ''; ?> /> |
| [560](#L560) | </td> |
| [561](#L561) | </tr> |
| [562](#L562) | </table> |
| [563](#L563) |  |
| [564](#L564) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [565](#L565) | </div> |
| [566](#L566) |  |
| [567](#L567) | </form> |
| [568](#L568) | </div> |
| [569](#L569) | <?php |
| [570](#L570) | break; |
| [571](#L571) | case 'interface': |
| [572](#L572) |  |
| [573](#L573) | if (isset($\_POST['gspb\_save\_settings'])) { |
| [574](#L574) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [575](#L575) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [576](#L576) | return; |
| [577](#L577) | } |
| [578](#L578) | $default\_settings = get\_option('gspb\_global\_settings'); |
| [579](#L579) | if(empty($default\_settings)){ |
| [580](#L580) | $default\_settings = array(); |
| [581](#L581) | } |
| [582](#L582) |  |
| [583](#L583) | if (isset($\_POST['cf\_utility\_on'])) { |
| [584](#L584) | $default\_settings['cf\_utility\_on'] = true; |
| [585](#L585) | } else { |
| [586](#L586) | $default\_settings['cf\_utility\_on'] = false; |
| [587](#L587) | } |
| [588](#L588) |  |
| [589](#L589) | if (isset($\_POST['anchors\_disable'])) { |
| [590](#L590) | $default\_settings['anchors\_disable'] = true; |
| [591](#L591) | } else { |
| [592](#L592) | $default\_settings['anchors\_disable'] = false; |
| [593](#L593) | } |
| [594](#L594) |  |
| [595](#L595) | if (isset($\_POST['row\_padding\_disable'])) { |
| [596](#L596) | $default\_settings['row\_padding\_disable'] = true; |
| [597](#L597) | } else { |
| [598](#L598) | $default\_settings['row\_padding\_disable'] = false; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | if (isset($\_POST['dark\_accent\_scheme'])) { |
| [602](#L602) | $default\_settings['dark\_accent\_scheme'] = true; |
| [603](#L603) | } else { |
| [604](#L604) | $default\_settings['dark\_accent\_scheme'] = false; |
| [605](#L605) | } |
| [606](#L606) | if (isset($\_POST['hide\_local\_styles'])) { |
| [607](#L607) | $default\_settings['hide\_local\_styles'] = true; |
| [608](#L608) | } else { |
| [609](#L609) | $default\_settings['hide\_local\_styles'] = false; |
| [610](#L610) | } |
| [611](#L611) | if (isset($\_POST['simplified\_panels'])) { |
| [612](#L612) | $default\_settings['simplified\_panels'] = true; |
| [613](#L613) | } else { |
| [614](#L614) | $default\_settings['simplified\_panels'] = false; |
| [615](#L615) | } |
| [616](#L616) | if (isset($\_POST['show\_element\_block'])) { |
| [617](#L617) | $default\_settings['show\_element\_block'] = sanitize\_text\_field($\_POST['show\_element\_block']); |
| [618](#L618) | } |
| [619](#L619) | if (isset($\_POST['default\_unit'])) { |
| [620](#L620) | $default\_settings['default\_unit'] = sanitize\_text\_field($\_POST['default\_unit']); |
| [621](#L621) | } |
| [622](#L622) | update\_option('gspb\_global\_settings', $default\_settings); |
| [623](#L623) | } |
| [624](#L624) |  |
| [625](#L625) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [626](#L626) | $cf\_utility\_on = !empty($global\_settings['cf\_utility\_on']) ? $global\_settings['cf\_utility\_on'] : ''; |
| [627](#L627) | $anchors\_disable = !empty($global\_settings['anchors\_disable']) ? $global\_settings['anchors\_disable'] : ''; |
| [628](#L628) | $dark\_accent\_scheme = !empty($global\_settings['dark\_accent\_scheme']) ? $global\_settings['dark\_accent\_scheme'] : ''; |
| [629](#L629) | $hide\_local\_styles = !empty($global\_settings['hide\_local\_styles']) ? $global\_settings['hide\_local\_styles'] : ''; |
| [630](#L630) | $simplified\_panels = !empty($global\_settings['simplified\_panels']) ? $global\_settings['simplified\_panels'] : ''; |
| [631](#L631) | $show\_element\_block = !empty($global\_settings['show\_element\_block']) ? $global\_settings['show\_element\_block'] : ''; |
| [632](#L632) | $default\_unit = !empty($global\_settings['default\_unit']) ? $global\_settings['default\_unit'] : ''; |
| [633](#L633) | $row\_padding\_disable = !empty($global\_settings['row\_padding\_disable']) ? $global\_settings['row\_padding\_disable'] : ''; |
| [634](#L634) | ?> |
| [635](#L635) | <div class="gspb\_settings\_form"> |
| [636](#L636) | <form method="POST"> |
| [637](#L637) | <div class="greenshift\_form"> |
| [638](#L638) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [639](#L639) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [640](#L640) | <div class="gs-box notice\_type icon\_type"> |
| [641](#L641) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [642](#L642) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [643](#L643) | </svg></div> |
| [644](#L644) | <div class="gs-box-text"> |
| [645](#L645) | <?php esc\_html\_e("Install Smart Code AI free plugin to enable code editor in block HTML/CSS panels", 'greenshift-animation-and-page-builder-blocks'); ?> |
| [646](#L646) | <a target="\_blank" href="<?php echo admin\_url('plugin-install.php?s=Greenshift%2520Smart%2520Code%2520AI&tab=search&type=term');?>" target="\_blank"><?php esc\_html\_e("Download", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [647](#L647) | </div> |
| [648](#L648) | </div> |
| [649](#L649) | </div> |
| [650](#L650) | <table class="form-table"> |
| [651](#L651) | <tr> |
| [652](#L652) | <td> <label for="cf\_utility\_on"><?php esc\_html\_e("Support for Core Framework Utility classes", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [653](#L653) | <td> |
| [654](#L654) | <input type="checkbox" name="cf\_utility\_on" id="cf\_utility\_on" <?php echo $cf\_utility\_on == true ? 'checked' : ''; ?> /> |
| [655](#L655) | </td> |
| [656](#L656) | </tr> |
| [657](#L657) | <tr> |
| [658](#L658) | <td> <label for="anchors\_disable"><?php esc\_html\_e("Disable core Headings anchor generation", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [659](#L659) | <td> |
| [660](#L660) | <input type="checkbox" name="anchors\_disable" id="anchors\_disable" <?php echo $anchors\_disable == true ? 'checked' : ''; ?> /> |
| [661](#L661) | </td> |
| [662](#L662) | </tr> |
| [663](#L663) | <tr> |
| [664](#L664) | <td> <label for="row\_padding\_disable"><?php esc\_html\_e("Disable default Column padding in Row block", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [665](#L665) | <td> |
| [666](#L666) | <input type="checkbox" name="row\_padding\_disable" id="row\_padding\_disable" <?php echo $row\_padding\_disable == true ? 'checked' : ''; ?> /> |
| [667](#L667) | </td> |
| [668](#L668) | </tr> |
| [669](#L669) | <tr> |
| [670](#L670) | <td> <label for="dark\_accent\_scheme"><?php esc\_html\_e("Dark Accent UI for block panels", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [671](#L671) | <td> |
| [672](#L672) | <input type="checkbox" name="dark\_accent\_scheme" id="dark\_accent\_scheme" <?php echo $dark\_accent\_scheme == true ? 'checked' : ''; ?> /> |
| [673](#L673) | </td> |
| [674](#L674) | </tr> |
| [675](#L675) | <tr> |
| [676](#L676) | <td> <label for="show\_element\_block"><?php esc\_html\_e("Priority for GreenLight Element Blocks in Inserter", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [677](#L677) | <td> |
| [678](#L678) | <select name="show\_element\_block"> |
| [679](#L679) | <option value="both" <?php selected($show\_element\_block, 'both'); ?>><?php esc\_html\_e("Show both, priority on regular Greenshift blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [680](#L680) | <option value="bothelement" <?php selected($show\_element\_block, 'bothelement'); ?>><?php esc\_html\_e("Show both, priority on GreenLight Element blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [681](#L681) | <option value="element" <?php selected($show\_element\_block, 'element'); ?>> <?php esc\_html\_e("Show only GreenLight Element blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [682](#L682) | <option value="regular" <?php selected($show\_element\_block, 'regular'); ?>> <?php esc\_html\_e("Show only Greenshift blocks", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [683](#L683) | </select> |
| [684](#L684) | </td> |
| [685](#L685) | </tr> |
| [686](#L686) | <tr> |
| [687](#L687) | <td> <label for="default\_unit"><?php esc\_html\_e("Default unit for values", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [688](#L688) | <td> |
| [689](#L689) | <select name="default\_unit"> |
| [690](#L690) | <option value="px" <?php selected($default\_unit, 'px'); ?>>px</option> |
| [691](#L691) | <option value="em" <?php selected($default\_unit, 'em'); ?>>em</option> |
| [692](#L692) | <option value="rem" <?php selected($default\_unit, 'rem'); ?>>rem</option> |
| [693](#L693) | </select> |
| [694](#L694) | </td> |
| [695](#L695) | </tr> |
| [696](#L696) | <tr> |
| [697](#L697) | <td> <label for="hide\_local\_styles"><?php esc\_html\_e("Close Local style option in Element block by default", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [698](#L698) | <td> |
| [699](#L699) | <input type="checkbox" name="hide\_local\_styles" id="hide\_local\_styles" <?php echo $hide\_local\_styles == true ? 'checked' : ''; ?> /> |
| [700](#L700) | </td> |
| [701](#L701) | </tr> |
| [702](#L702) | <tr> |
| [703](#L703) | <td> <label for="simplified\_panels"><?php esc\_html\_e("Simplified panels for non admin user roles", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [704](#L704) | <td> |
| [705](#L705) | <input type="checkbox" name="simplified\_panels" id="simplified\_panels" <?php echo $simplified\_panels == true ? 'checked' : ''; ?> /> |
| [706](#L706) | </td> |
| [707](#L707) | </tr> |
| [708](#L708) | </table> |
| [709](#L709) |  |
| [710](#L710) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [711](#L711) | </div> |
| [712](#L712) |  |
| [713](#L713) | </form> |
| [714](#L714) | </div> |
| [715](#L715) | <?php |
| [716](#L716) | break; |
| [717](#L717) | case 'breakpoints': |
| [718](#L718) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [719](#L719) | $gsbp\_breakpoints = apply\_filters('greenshift\_responsive\_breakpoints', array( |
| [720](#L720) | 'mobile'        => 576, |
| [721](#L721) | 'tablet'        => 768, |
| [722](#L722) | 'desktop' =>  992 |
| [723](#L723) | )); |
| [724](#L724) |  |
| [725](#L725) | if (isset($\_POST['gspb\_save\_settings']) && isset($\_POST['gspb\_settings\_field']) && wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [726](#L726) | $breakpoints = array( |
| [727](#L727) | "mobile" =>  sanitize\_text\_field($\_POST['mobile']), |
| [728](#L728) | "tablet" =>  sanitize\_text\_field($\_POST['tablet']), |
| [729](#L729) | "desktop" =>  sanitize\_text\_field($\_POST['desktop']), |
| [730](#L730) | "row" =>  sanitize\_text\_field($\_POST['row']), |
| [731](#L731) | ); |
| [732](#L732) | $global\_settings['breakpoints'] = $breakpoints; |
| [733](#L733) |  |
| [734](#L734) | if (!empty($\_POST['enable\_landscape'])) { |
| [735](#L735) | $global\_settings['enable\_landscape'] = true; |
| [736](#L736) | } else { |
| [737](#L737) | if(isset($global\_settings['enable\_landscape'])){ |
| [738](#L738) | unset($global\_settings['enable\_landscape']); |
| [739](#L739) | } |
| [740](#L740) | } |
| [741](#L741) | update\_option('gspb\_global\_settings', $global\_settings); |
| [742](#L742) | } |
| [743](#L743) | $enable\_landscape = !empty($global\_settings['enable\_landscape']) ? $global\_settings['enable\_landscape'] : ''; |
| [744](#L744) | ?> |
| [745](#L745) | <form method="POST" class="greenshift\_form"> |
| [746](#L746) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [747](#L747) | <table class="form-table"> |
| [748](#L748) |  |
| [749](#L749) | <tr> |
| [750](#L750) | <td> <?php esc\_html\_e("Mobile", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [751](#L751) | <td> |
| [752](#L752) | <input name="mobile" type="text" value="<?php if (isset($global\_settings['breakpoints']['mobile'])) { |
| [753](#L753) | echo esc\_attr($global\_settings['breakpoints']['mobile']); |
| [754](#L754) | }  ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['mobile']; ?>" /> |
| [755](#L755) | </td> |
| [756](#L756) | </tr> |
| [757](#L757) | <tr> |
| [758](#L758) | <td> <?php esc\_html\_e("Tablet", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [759](#L759) | <td> |
| [760](#L760) | <input name="tablet" type="text" value="<?php if (isset($global\_settings['breakpoints']['tablet'])) { |
| [761](#L761) | echo esc\_attr($global\_settings['breakpoints']['tablet']); |
| [762](#L762) | } ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['tablet']; ?>" /> |
| [763](#L763) | </td> |
| [764](#L764) | </tr> |
| [765](#L765) | <tr> |
| [766](#L766) | <td> <?php esc\_html\_e("Desktop", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [767](#L767) | <td> |
| [768](#L768) | <input name="desktop" type="text" value="<?php if (isset($global\_settings['breakpoints']['desktop'])) { |
| [769](#L769) | echo esc\_attr($global\_settings['breakpoints']['desktop']); |
| [770](#L770) | } ?>" placeholder="<?php echo (int)$gsbp\_breakpoints['desktop']; ?>" /> |
| [771](#L771) | </td> |
| [772](#L772) | </tr> |
| [773](#L773) | <tr> |
| [774](#L774) | <td> <?php esc\_html\_e("Default Row Content Width", 'greenshift-animation-and-page-builder-blocks'); ?> </td> |
| [775](#L775) | <td> |
| [776](#L776) | <input name="row" type="text" value="<?php if (isset($global\_settings['breakpoints']['row'])) { |
| [777](#L777) | echo esc\_attr($global\_settings['breakpoints']['row']); |
| [778](#L778) | } ?>" placeholder="<?php echo apply\_filters('gspb\_default\_row\_width\_px', 1200); ?>" /> |
| [779](#L779) | </td> |
| [780](#L780) | </tr> |
| [781](#L781) | <tr> |
| [782](#L782) | <td> <label for="enable\_landscape"><?php esc\_html\_e("Enable Landscape point", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [783](#L783) | <td> |
| [784](#L784) | <input type="checkbox" name="enable\_landscape" id="enable\_landscape" <?php echo $enable\_landscape == true ? 'checked' : ''; ?> /> |
| [785](#L785) | </td> |
| [786](#L786) | </tr> |
| [787](#L787) | </table> |
| [788](#L788) | <input type="submit" name="gspb\_save\_settings" value="Save" class="button button-primary button-large"> |
| [789](#L789) | </form> |
| [790](#L790) | <?php |
| [791](#L791) | break; |
| [792](#L792) | case 'scripts': |
| [793](#L793) | wp\_enqueue\_style('gsadminsettings'); |
| [794](#L794) | wp\_enqueue\_script('gsadminsettings'); |
| [795](#L795) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [796](#L796) | if (isset($\_POST['gspb\_save\_settings'])) { // Delay script saving |
| [797](#L797) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [798](#L798) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [799](#L799) | return; |
| [800](#L800) | } |
| [801](#L801) |  |
| [802](#L802) | $is\_dealyjson = isset($\_POST['delay\_js\_on']) && $\_POST['delay\_js\_on'] == "on" ? 1 : 0; |
| [803](#L803) | $jsdelay = array( |
| [804](#L804) | "delay\_js\_on" => $is\_dealyjson, |
| [805](#L805) | "delay\_js\_page\_on" =>  sanitize\_text\_field($\_POST['delay\_js\_page\_on']), |
| [806](#L806) | "delay\_js\_page\_list" =>  sanitize\_text\_field($\_POST['delay\_js\_page\_list']), |
| [807](#L807) | ); |
| [808](#L808) | $global\_settings['jsdelay'] = $jsdelay; |
| [809](#L809) |  |
| [810](#L810) | update\_option('gspb\_global\_settings', $global\_settings); |
| [811](#L811) | } |
| [812](#L812) | //Form for delay script saving |
| [813](#L813) | $delay\_js\_on = !empty($global\_settings['jsdelay']['delay\_js\_on']) ? $global\_settings['jsdelay']['delay\_js\_on'] : ''; |
| [814](#L814) | $delay\_js\_page\_on = !empty($global\_settings['jsdelay']['delay\_js\_page\_on']) ? $global\_settings['jsdelay']['delay\_js\_page\_on'] : ''; |
| [815](#L815) | $delay\_js\_page\_list = !empty($global\_settings['jsdelay']['delay\_js\_page\_list']) ? $global\_settings['jsdelay']['delay\_js\_page\_list'] : ''; |
| [816](#L816) |  |
| [817](#L817) | $show\_page\_option = $delay\_js\_on && ($delay\_js\_page\_on == "includefor" || $delay\_js\_page\_on  == "excludefor") ? true : false; |
| [818](#L818) |  |
| [819](#L819) | ?> |
| [820](#L820) | <div class="gspb\_settings\_form"> |
| [821](#L821) | <form method="POST"> |
| [822](#L822) | <h2><?php esc\_html\_e("Javascript Files Delay", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [823](#L823) | <div class="greenshift\_form"> |
| [824](#L824) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [825](#L825) | <div class="gs-box notice\_type icon\_type"> |
| [826](#L826) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [827](#L827) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [828](#L828) | </svg></div> |
| [829](#L829) | <div class="gs-box-text"> |
| [830](#L830) | <div><?php esc\_html\_e("Attention! This is experimental feature", "greenshift-animation-and-page-builder-blocks"); ?></div> |
| [831](#L831) | </div> |
| [832](#L832) | </div> |
| [833](#L833) | </div> |
| [834](#L834) |  |
| [835](#L835) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [836](#L836) | <table class="form-table"> |
| [837](#L837) | <tr> |
| [838](#L838) | <td colspan="2"> |
| [839](#L839) | <input type="checkbox" name="delay\_js\_on" id="delay\_js\_on" <?php echo $delay\_js\_on == true ? 'checked' : ''; ?> /> |
| [840](#L840) | <label for="delay\_js\_on"><?php esc\_html\_e("Enable script delay for Greenshift's scripts", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [841](#L841) | </td> |
| [842](#L842) | </tr> |
| [843](#L843) | <tr class="delay\_js\_optionsrow" <?php echo $delay\_js\_on == true ? 'style="display: table-row;"' : ''; ?>> |
| [844](#L844) | <td> <label for="css\_system"><?php esc\_html\_e("Javascript delay options", 'greenshift-animation-and-page-builder-blocks'); ?></label> </td> |
| [845](#L845) | <td> |
| [846](#L846) | <select id="delay\_js\_page\_on" name="delay\_js\_page\_on"> |
| [847](#L847) | <option value="all" <?php selected($delay\_js\_page\_on, 'all'); ?>><?php esc\_html\_e("Enable on whole site", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [848](#L848) | <option value="includefor" <?php selected($delay\_js\_page\_on, 'includefor'); ?>> <?php esc\_html\_e("Enable only on selected pages", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [849](#L849) | <option value="excludefor" <?php selected($delay\_js\_page\_on, 'excludefor'); ?>> <?php esc\_html\_e("Enable on whole site except selected pages", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [850](#L850) | </select> |
| [851](#L851) | </td> |
| [852](#L852) | </tr> |
| [853](#L853) | <tr class="delay\_js\_pagerow" <?php echo $show\_page\_option == true ? 'style="display: table-row;"' : ''; ?>> |
| [854](#L854) | <td> |
| [855](#L855) | <label for="delay\_js\_page\_list"><?php esc\_html\_e("Page Urls (one per line).", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [856](#L856) | </td> |
| [857](#L857) | <td> |
| [858](#L858) | <textarea style="width:100%; min-height:100px;" id="delay\_js\_page\_list" name="delay\_js\_page\_list"><?php echo esc\_html($delay\_js\_page\_list); ?></textarea> |
| [859](#L859) | <div style="margin-bottom:15px"><?php esc\_html\_e("Specify URLs of pages (one per line).", 'greenshift-animation-and-page-builder-blocks'); ?></div> |
| [860](#L860) | </td> |
| [861](#L861) | </tr> |
| [862](#L862) | </table> |
| [863](#L863) |  |
| [864](#L864) |  |
| [865](#L865) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large javascript\_delay\_submit"> |
| [866](#L866) | </div> |
| [867](#L867) | </form> |
| [868](#L868) | </div> |
| [869](#L869) | <?php |
| [870](#L870) | //End Form for delay script saving |
| [871](#L871) | break; |
| [872](#L872) |  |
| [873](#L873) | case 'keys': |
| [874](#L874) |  |
| [875](#L875) | if (isset($\_POST['gspb\_save\_settings'])) { // Delay script saving |
| [876](#L876) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [877](#L877) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [878](#L878) | return; |
| [879](#L879) | } |
| [880](#L880) | $sanitised = array(); |
| [881](#L881) |  |
| [882](#L882) | if (isset($\_POST['googleapi']) || isset($\_POST['openaiapi']) || isset($\_POST['openaiapimodel'])) { |
| [883](#L883) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [884](#L884) | if (isset($\_POST['googleapi'])) { |
| [885](#L885) | $sanitised['googleapi'] = sanitize\_text\_field($\_POST['googleapi']); |
| [886](#L886) | } |
| [887](#L887) | if (isset($\_POST['openaiapi'])) { |
| [888](#L888) | $sanitised['openaiapi'] = sanitize\_text\_field($\_POST['openaiapi']); |
| [889](#L889) | } |
| [890](#L890) | if (isset($\_POST['openaiapimodel'])) { |
| [891](#L891) | $sanitised['openaiapimodel'] = sanitize\_text\_field($\_POST['openaiapimodel']); |
| [892](#L892) | } |
| [893](#L893) | $newargs = wp\_parse\_args($sanitised, $global\_settings); |
| [894](#L894) | update\_option('gspb\_global\_settings', $newargs); |
| [895](#L895) | } |
| [896](#L896) | } |
| [897](#L897) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [898](#L898) | //Form for delay script saving |
| [899](#L899) | $googleapi = !empty($global\_settings['googleapi']) ? $global\_settings['googleapi'] : ''; |
| [900](#L900) | $openaiapi = !empty($global\_settings['openaiapi']) ? $global\_settings['openaiapi'] : ''; |
| [901](#L901) | $openaiapimodel = !empty($global\_settings['openaiapimodel']) ? $global\_settings['openaiapimodel'] : ''; |
| [902](#L902) |  |
| [903](#L903) | ?> |
| [904](#L904) | <div class="gspb\_settings\_form"> |
| [905](#L905) | <form method="POST"> |
| [906](#L906) | <div class="greenshift\_form"> |
| [907](#L907) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [908](#L908) | <table class="form-table"> |
| [909](#L909) | <tbody> |
| [910](#L910) | <tr class="googleapikey"> |
| [911](#L911) | <td> |
| [912](#L912) | <label for="googleapi"><?php esc\_html\_e("Google API Key", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [913](#L913) | </td> |
| [914](#L914) | <td> |
| [915](#L915) | <textarea style="width:100%; min-height:50px;border-color:#ddd" id="googleapi" name="googleapi"><?php echo esc\_html($googleapi); ?></textarea> |
| [916](#L916) | <div style="margin-bottom:15px"><a href="https://developers.google.com/maps/documentation/javascript/get-api-key"><?php esc\_html\_e("Get an API Key", 'greenshift-animation-and-page-builder-blocks'); ?></a></div> |
| [917](#L917) | </td> |
| [918](#L918) | </tr> |
| [919](#L919) | <tr class="openaiapikey"> |
| [920](#L920) | <td> |
| [921](#L921) | <label for="openaiapi"><?php esc\_html\_e("Open AI API Key", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [922](#L922) | </td> |
| [923](#L923) | <td> |
| [924](#L924) | <textarea style="width:100%; min-height:50px;border-color:#ddd" id="openaiapi" name="openaiapi"><?php echo esc\_html($openaiapi); ?></textarea> |
| [925](#L925) | <div style="margin-bottom:15px"><a href="https://platform.openai.com/account/api-keys"><?php esc\_html\_e("Get an API Key", 'greenshift-animation-and-page-builder-blocks'); ?></a></div> |
| [926](#L926) | </td> |
| [927](#L927) | </tr> |
| [928](#L928) | <tr class="openaiapimodel"> |
| [929](#L929) | <td> |
| [930](#L930) | <label for="openaiapimodel"><?php esc\_html\_e("Open AI Model", 'greenshift-animation-and-page-builder-blocks'); ?></label> |
| [931](#L931) | </td> |
| [932](#L932) | <td> |
| [933](#L933) | <select name="openaiapimodel"> |
| [934](#L934) | <option value="gpt-3.5-turbo" <?php selected($openaiapimodel, 'gpt-3.5-turbo'); ?>><?php esc\_html\_e("gpt-3.5-turbo", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [935](#L935) | <option value="gpt-4" <?php selected($openaiapimodel, 'gpt-4'); ?>> <?php esc\_html\_e("gpt-4", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [936](#L936) | <option value="gpt-4-turbo" <?php selected($openaiapimodel, 'gpt-4-turbo'); ?>> <?php esc\_html\_e("gpt-4-turbo", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [937](#L937) | <option value="gpt-4-32k" <?php selected($openaiapimodel, 'gpt-4-32k'); ?>> <?php esc\_html\_e("gpt-4-32k", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [938](#L938) | <option value="gpt-4o" <?php selected($openaiapimodel, 'gpt-4o'); ?>> <?php esc\_html\_e("gpt-4o", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [939](#L939) | <option value="gpt-4o-mini" <?php selected($openaiapimodel, 'gpt-4o-mini'); ?>> <?php esc\_html\_e("gpt-4o-mini", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [940](#L940) | <option value="o1" <?php selected($openaiapimodel, 'o1'); ?>> <?php esc\_html\_e("o1", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [941](#L941) | <option value="o1-mini" <?php selected($openaiapimodel, 'o1-mini'); ?>> <?php esc\_html\_e("o1-mini", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [942](#L942) | <option value="o1-preview" <?php selected($openaiapimodel, 'o1-preview'); ?>> <?php esc\_html\_e("o1-preview", 'greenshift-animation-and-page-builder-blocks'); ?> </option> |
| [943](#L943) | </select> |
| [944](#L944) | </td> |
| [945](#L945) | </tr> |
| [946](#L946) | </tbody> |
| [947](#L947) | </table> |
| [948](#L948) |  |
| [949](#L949) |  |
| [950](#L950) | <input type="submit" name="gspb\_save\_settings" value="<?php esc\_html\_e("Save settings"); ?>" class="button button-primary button-large"> |
| [951](#L951) | </div> |
| [952](#L952) | </form> |
| [953](#L953) | </div> |
| [954](#L954) | <?php |
| [955](#L955) | //End Form for delay script saving |
| [956](#L956) | break; |
| [957](#L957) | case 'header': |
| [958](#L958) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [959](#L959) |  |
| [960](#L960) | if (isset($\_POST['gspb\_save\_settings\_header'])) { // Delay script saving |
| [961](#L961) | if (!wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { |
| [962](#L962) | esc\_html\_e("Sorry, your nonce did not verify.", 'greenshift-animation-and-page-builder-blocks'); |
| [963](#L963) | return; |
| [964](#L964) | } |
| [965](#L965) | $sanitised = array(); |
| [966](#L966) |  |
| [967](#L967) | if (isset($\_POST['custom\_code\_in\_head'])) { |
| [968](#L968) | $theme\_settings['custom\_code\_in\_head'] = wp\_kses(wp\_unslash($\_POST['custom\_code\_in\_head']), [ |
| [969](#L969) | 'meta' => [ |
| [970](#L970) | 'charset' => [], |
| [971](#L971) | 'content' => [], |
| [972](#L972) | 'http-equiv' => [], |
| [973](#L973) | 'name' => [], |
| [974](#L974) | 'property' => [] |
| [975](#L975) | ], |
| [976](#L976) | 'style' => [ |
| [977](#L977) | 'media' => [], |
| [978](#L978) | 'type' => [] |
| [979](#L979) | ], |
| [980](#L980) | 'script' => [ |
| [981](#L981) | 'async' => [], |
| [982](#L982) | 'charset' => [], |
| [983](#L983) | 'defer' => [], |
| [984](#L984) | 'src' => [], |
| [985](#L985) | 'type' => [] |
| [986](#L986) | ], |
| [987](#L987) | 'link' => [ |
| [988](#L988) | 'href' => [], |
| [989](#L989) | 'rel' => [], |
| [990](#L990) | 'type' => [] |
| [991](#L991) | ], |
| [992](#L992) | 'img' => [ |
| [993](#L993) | 'alt' => [], |
| [994](#L994) | 'height' => [], |
| [995](#L995) | 'src' => [], |
| [996](#L996) | 'width' => [], |
| [997](#L997) | 'style' => [] |
| [998](#L998) | ], |
| [999](#L999) | 'noscript' => [] |
| [1000](#L1000) | ]); |
| [1001](#L1001) | } |
| [1002](#L1002) | if (isset($\_POST['custom\_code\_before\_closed\_body'])) { |
| [1003](#L1003) | $theme\_settings['custom\_code\_before\_closed\_body'] = wp\_kses(wp\_unslash($\_POST['custom\_code\_before\_closed\_body']), [ |
| [1004](#L1004) | 'meta' => [ |
| [1005](#L1005) | 'charset' => [], |
| [1006](#L1006) | 'content' => [], |
| [1007](#L1007) | 'http-equiv' => [], |
| [1008](#L1008) | 'name' => [], |
| [1009](#L1009) | 'property' => [] |
| [1010](#L1010) | ], |
| [1011](#L1011) | 'style' => [ |
| [1012](#L1012) | 'media' => [], |
| [1013](#L1013) | 'type' => [] |
| [1014](#L1014) | ], |
| [1015](#L1015) | 'script' => [ |
| [1016](#L1016) | 'async' => [], |
| [1017](#L1017) | 'charset' => [], |
| [1018](#L1018) | 'defer' => [], |
| [1019](#L1019) | 'src' => [], |
| [1020](#L1020) | 'type' => [] |
| [1021](#L1021) | ], |
| [1022](#L1022) | 'link' => [ |
| [1023](#L1023) | 'href' => [], |
| [1024](#L1024) | 'rel' => [], |
| [1025](#L1025) | 'type' => [] |
| [1026](#L1026) | ], |
| [1027](#L1027) | 'img' => [ |
| [1028](#L1028) | 'alt' => [], |
| [1029](#L1029) | 'height' => [], |
| [1030](#L1030) | 'src' => [], |
| [1031](#L1031) | 'width' => [], |
| [1032](#L1032) | 'style' => [] |
| [1033](#L1033) | ], |
| [1034](#L1034) | 'noscript' => [] |
| [1035](#L1035) | ]); |
| [1036](#L1036) | } |
| [1037](#L1037) | if (isset($\_POST['custom\_code\_in\_head']) || isset($\_POST['custom\_code\_before\_closed\_body'])) { |
| [1038](#L1038) | update\_option('greenshift\_theme\_options', $theme\_settings); |
| [1039](#L1039) | } |
| [1040](#L1040) | } |
| [1041](#L1041) | ?> |
| [1042](#L1042) | <h2><?php esc\_html\_e("Footer and Head Hooks", 'greenshift-animation-and-page-builder-blocks'); ?></h2> |
| [1043](#L1043) | <div class="greenshift\_form"> |
| [1044](#L1044) | <?php |
| [1045](#L1045) | $custom\_code\_in\_head = !empty($theme\_settings['custom\_code\_in\_head']) ? wp\_unslash($theme\_settings['custom\_code\_in\_head']) : ''; |
| [1046](#L1046) | $custom\_code\_before\_closed\_body = !empty($theme\_settings['custom\_code\_before\_closed\_body']) ? wp\_unslash($theme\_settings['custom\_code\_before\_closed\_body']) : ''; |
| [1047](#L1047) | ?> |
| [1048](#L1048) | <form method="POST"> |
| [1049](#L1049) | <?php wp\_nonce\_field('gspb\_settings\_page\_action', 'gspb\_settings\_field'); ?> |
| [1050](#L1050) | <table class="form-table"> |
| [1051](#L1051) | <tr> |
| [1052](#L1052) | <th> <label for="custom\_code\_in\_head"><?php esc\_html\_e("Custom code in head section", 'greenshift'); ?></label> </th> |
| [1053](#L1053) | <td> |
| [1054](#L1054) | <textarea name="custom\_code\_in\_head" id="" cols="30" rows="10" style="width: 100%"><?php echo $custom\_code\_in\_head ?></textarea> |
| [1055](#L1055) | </td> |
| [1056](#L1056) | </tr> |
| [1057](#L1057) | <tr> |
| [1058](#L1058) | <th> <label for="custom\_code\_before\_closed\_body"><?php esc\_html\_e("Custom code before closed Body", 'greenshift'); ?></label> </th> |
| [1059](#L1059) | <td> |
| [1060](#L1060) | <textarea name="custom\_code\_before\_closed\_body" id="" cols="30" rows="10" style="width: 100%"><?php echo $custom\_code\_before\_closed\_body ?></textarea> |
| [1061](#L1061) | </td> |
| [1062](#L1062) | </tr> |
| [1063](#L1063) | </table> |
| [1064](#L1064) | <input type="submit" name="gspb\_save\_settings\_header" value="<?php esc\_html\_e('Save', 'greenshift-animation-and-page-builder-blocks') ?>" class="button button-primary button-large"> |
| [1065](#L1065) | </form> |
| [1066](#L1066) | </div> |
| [1067](#L1067) | <?php |
| [1068](#L1068) | //End Form for delay script saving |
| [1069](#L1069) | break; |
| [1070](#L1070) | default: |
| [1071](#L1071) | wp\_enqueue\_style('gsadminsettings'); |
| [1072](#L1072) | wp\_enqueue\_script('gsadminsettings'); |
| [1073](#L1073) | if (isset($\_POST['gspb\_save\_settings\_general']) && isset($\_POST['gspb\_settings\_field']) && wp\_verify\_nonce(sanitize\_text\_field( wp\_unslash($\_POST['gspb\_settings\_field'])), 'gspb\_settings\_page\_action')) { // local font saving |
| [1074](#L1074) | $this->gspb\_save\_general\_form($\_POST, $\_FILES); |
| [1075](#L1075) | } |
| [1076](#L1076) |  |
| [1077](#L1077) | ?> |
| [1078](#L1078) | <div class="wp-block-greenshift-blocks-infobox gspb\_infoBox gspb\_infoBox-id-gsbp-158b5f3e-b35c" id="gspb\_infoBox-id-gsbp-158b5f3e-b35c"> |
| [1079](#L1079) | <div class="gs-box notice\_type icon\_type"> |
| [1080](#L1080) | <div class="gs-box-icon"><svg class="" style="display:inline-block;vertical-align:middle" width="32" height="32" viewBox="0 0 704 1024" xmlns="http://www.w3.org/2000/svg"> |
| [1081](#L1081) | <path style="fill:#565D66" d="M352 160c-105.88 0-192 86.12-192 192 0 17.68 14.32 32 32 32s32-14.32 32-32c0-70.6 57.44-128 128-128 17.68 0 32-14.32 32-32s-14.32-32-32-32zM192.12 918.34c0 6.3 1.86 12.44 5.36 17.68l49.020 73.68c5.94 8.92 15.94 14.28 26.64 14.28h157.7c10.72 0 20.72-5.36 26.64-14.28l49.020-73.68c3.48-5.24 5.34-11.4 5.36-17.68l0.1-86.36h-319.92l0.080 86.36zM352 0c-204.56 0-352 165.94-352 352 0 88.74 32.9 169.7 87.12 231.56 33.28 37.98 85.48 117.6 104.84 184.32v0.12h96v-0.24c-0.020-9.54-1.44-19.020-4.3-28.14-11.18-35.62-45.64-129.54-124.34-219.34-41.080-46.86-63.040-106.3-63.22-168.28-0.4-147.28 119.34-256 255.9-256 141.16 0 256 114.84 256 256 0 61.94-22.48 121.7-63.3 168.28-78.22 89.22-112.84 182.94-124.2 218.92-2.805 8.545-4.428 18.381-4.44 28.594l-0 0.006v0.2h96v-0.1c19.36-66.74 71.56-146.36 104.84-184.32 54.2-61.88 87.1-142.84 87.1-231.58 0-194.4-157.6-352-352-352z"></path> |
| [1082](#L1082) | </svg></div> |
| [1083](#L1083) | <div class="gs-box-text"> |
| [1084](#L1084) | <?php esc\_html\_e("Attention! Local font is global option and it can reduce performance in some cases. Do not use more than 2 global fonts. Please, check", 'greenshift-animation-and-page-builder-blocks'); ?> <a href="https://greenshiftwp.com/how-to-use-local-fonts-in-greenshift-for-gdpr/" target="\_blank"><?php esc\_html\_e("Documentation", 'greenshift-animation-and-page-builder-blocks'); ?></a> |
| [1085](#L1085) | </div> |
| [1086](#L1086) | </div> |
| [1087](#L1087) | </div> |
| [1088](#L1088) | <?php |
| [1089](#L1089) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1090](#L1090) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/settings\_general\_form.php'; ?> |
| [1091](#L1091) | <?php |
| [1092](#L1092) | break; |
| [1093](#L1093) | endswitch; |
| [1094](#L1094) | ?> |
| [1095](#L1095) | </div> |
| [1096](#L1096) | </div> |
| [1097](#L1097) | </div> |
| [1098](#L1098) | </div> |
| [1099](#L1099) | </div> |
| [1100](#L1100) | <?php |
| [1101](#L1101) | } |
| [1102](#L1102) |  |
| [1103](#L1103) | // settings fonts |
| [1104](#L1104) | public function gspb\_settings\_add\_font() |
| [1105](#L1105) | { |
| [1106](#L1106) | $i = $\_POST['i']; |
| [1107](#L1107) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1108](#L1108) | ob\_start(); |
| [1109](#L1109) | require\_once GREENSHIFT\_DIR\_PATH . 'templates/admin/settings\_general\_font\_item.php'; |
| [1110](#L1110) | $html = ob\_get\_contents(); |
| [1111](#L1111) | ob\_get\_clean(); |
| [1112](#L1112) | wp\_send\_json(['html' => $html]); |
| [1113](#L1113) | } |
| [1114](#L1114) |  |
| [1115](#L1115) | public function gspb\_save\_general\_form($data, $files) |
| [1116](#L1116) | { |
| [1117](#L1117) | $global\_settings = get\_option('gspb\_global\_settings'); |
| [1118](#L1118) |  |
| [1119](#L1119) | $fonts\_urls = $this->gspb\_save\_files($files); |
| [1120](#L1120) | $arr = []; |
| [1121](#L1121) | for ($i = 0; (int)$data['fonts\_count'] > $i; $i++) { |
| [1122](#L1122) | //$item\_arr = ['label' => sanitize\_text\_field($data['font\_specific\_style\_name'][$i])]; |
| [1123](#L1123) | foreach ($this->allowed\_font\_ext as $ext) { |
| [1124](#L1124) | $item\_arr[$ext] = !empty($fonts\_urls[$i][$ext]) ? $fonts\_urls[$i][$ext] : sanitize\_text\_field($data[$ext][$i]); |
| [1125](#L1125) | } |
| [1126](#L1126) | $item\_arr['preloaded'] = !empty($data['font\_family\_preload'][$i]) ? sanitize\_text\_field($data['font\_family\_preload'][$i]) : ''; |
| [1127](#L1127) | $arr[sanitize\_text\_field($data['font\_family\_name'][$i])] = $item\_arr; |
| [1128](#L1128) | } |
| [1129](#L1129) | $new\_localfont = json\_encode($arr); |
| [1130](#L1130) | $global\_settings['localfont'] = $new\_localfont; |
| [1131](#L1131) |  |
| [1132](#L1132) | $localfontcss = ''; |
| [1133](#L1133) | if (!empty($arr)) { |
| [1134](#L1134) | foreach ($arr as $i => $value) { |
| [1135](#L1135) | $localfontcss .= '@font-face {'; |
| [1136](#L1136) | $localfontcss .= 'font-family: "' . $i . '";'; |
| [1137](#L1137) | $localfontcss .= 'src: '; |
| [1138](#L1138) | if (!empty($value['woff2'])) { |
| [1139](#L1139) | $localfontcss .= 'url(' . $value["woff2"] . ') format("woff2"), '; |
| [1140](#L1140) | } |
| [1141](#L1141) | if (!empty($value['woff'])) { |
| [1142](#L1142) | $localfontcss .= 'url(' . $value["woff"] . ') format("woff"), '; |
| [1143](#L1143) | } |
| [1144](#L1144) | if (!empty($value['ttf'])) { |
| [1145](#L1145) | $localfontcss .= 'url(' . $value["ttf"] . ') format("truetype"), '; |
| [1146](#L1146) | } |
| [1147](#L1147) | if (!empty($value['tiff'])) { |
| [1148](#L1148) | $localfontcss .= 'url(' . $value["tiff"] . ') format("tiff"), '; |
| [1149](#L1149) | } |
| [1150](#L1150) | $localfontcss .= ';'; |
| [1151](#L1151) | $localfontcss .= 'font-display: swap;}'; |
| [1152](#L1152) | } |
| [1153](#L1153) | $localfontcss = str\_replace(', ;', ';', $localfontcss); |
| [1154](#L1154) | $global\_settings['localfontcss'] = $localfontcss; |
| [1155](#L1155) |  |
| [1156](#L1156) | $upload\_dir = wp\_upload\_dir(); |
| [1157](#L1157) | require\_once ABSPATH . 'wp-admin/includes/file.php'; |
| [1158](#L1158) | global $wp\_filesystem; |
| [1159](#L1159) | $dir = trailingslashit($upload\_dir['basedir']) . 'GreenShift/'; // Set storage directory path |
| [1160](#L1160) |  |
| [1161](#L1161) | WP\_Filesystem(); // WP file system |
| [1162](#L1162) |  |
| [1163](#L1163) | if (!$wp\_filesystem->is\_dir($dir)) { |
| [1164](#L1164) | $wp\_filesystem->mkdir($dir); |
| [1165](#L1165) | } |
| [1166](#L1166) |  |
| [1167](#L1167) | $gspb\_json\_filename = 'settings\_backup.json'; |
| [1168](#L1168) | $gspb\_backup\_data = json\_encode($global\_settings, JSON\_PRETTY\_PRINT); |
| [1169](#L1169) |  |
| [1170](#L1170) | if (!$wp\_filesystem->put\_contents($dir . $gspb\_json\_filename, $gspb\_backup\_data)) { |
| [1171](#L1171) | throw new Exception(esc\_html\_\_('JSON is not saved due the permission!!!', 'greenshift-animation-and-page-builder-blocks')); |
| [1172](#L1172) | } |
| [1173](#L1173) | } |
| [1174](#L1174) | update\_option('gspb\_global\_settings', $global\_settings); |
| [1175](#L1175) | } |
| [1176](#L1176) |  |
| [1177](#L1177) | public function gspb\_save\_files($files) |
| [1178](#L1178) | { |
| [1179](#L1179) | $result = []; |
| [1180](#L1180) | $upload = wp\_upload\_dir(); |
| [1181](#L1181) | $upload\_dir = $upload['basedir'] . '/GreenShift/fonts'; |
| [1182](#L1182) | $upload\_url = $upload['baseurl'] . '/GreenShift/fonts'; |
| [1183](#L1183) |  |
| [1184](#L1184) | foreach (array\_keys($files) as $filename) { |
| [1185](#L1185) | foreach ($files[$filename]["error"] as $key => $error) { |
| [1186](#L1186) | if ($error == UPLOAD\_ERR\_OK) { |
| [1187](#L1187) | $tmp\_name = $files[$filename]["tmp\_name"][$key]; |
| [1188](#L1188) | $name = basename($files[$filename]["name"][$key]); |
| [1189](#L1189) | $ext = pathinfo($name, PATHINFO\_EXTENSION); |
| [1190](#L1190) | $font\_dir = $upload\_dir . '/font\_' . ($key + 1) . '/' . $ext; |
| [1191](#L1191) |  |
| [1192](#L1192) | $this->gspb\_rm\_rec($font\_dir); //clean up dir before download |
| [1193](#L1193) |  |
| [1194](#L1194) | if (!wp\_mkdir\_p($font\_dir)) { |
| [1195](#L1195) | return false; |
| [1196](#L1196) | } |
| [1197](#L1197) |  |
| [1198](#L1198) | if(!in\_array($ext, $this->allowed\_font\_ext)) continue; |
| [1199](#L1199) |  |
| [1200](#L1200) | if (move\_uploaded\_file($tmp\_name, "$font\_dir/$name")) { |
| [1201](#L1201) | $result[$key][$ext] = $upload\_url . '/font\_' . ($key + 1) . '/' . $ext . '/' . $name; |
| [1202](#L1202) | } |
| [1203](#L1203) | } |
| [1204](#L1204) | } |
| [1205](#L1205) | } |
| [1206](#L1206) |  |
| [1207](#L1207) | return $result; |
| [1208](#L1208) | } |
| [1209](#L1209) |  |
| [1210](#L1210) | public function gspb\_rm\_rec($path) |
| [1211](#L1211) | { |
| [1212](#L1212) | if (is\_file($path)) return unlink($path); |
| [1213](#L1213) | if (is\_dir($path)) { |
| [1214](#L1214) | foreach (scandir($path) as $p) if (($p != '.') && ($p != '..')) |
| [1215](#L1215) | $this->gspb\_rm\_rec($path . '/' . $p); |
| [1216](#L1216) | return rmdir($path); |
| [1217](#L1217) | } |
| [1218](#L1218) | return false; |
| [1219](#L1219) | } |
| [1220](#L1220) |  |
| [1221](#L1221) | //Columns in Reusable section |
| [1222](#L1222) | function gspb\_template\_screen\_add\_column($columns) |
| [1223](#L1223) | { |
| [1224](#L1224) | $newcols = array( |
| [1225](#L1225) | 'cb' => '<input type="checkbox" />', |
| [1226](#L1226) | 'title' => esc\_html\_\_('Block title', 'greenshift-animation-and-page-builder-blocks'), |
| [1227](#L1227) | 'gs-reusable-preview' => esc\_html\_\_('Usage', 'greenshift-animation-and-page-builder-blocks'), |
| [1228](#L1228) | ); |
| [1229](#L1229) | return apply\_filters('greenshift\_reusable\_blocks\_list', array\_merge($columns, $newcols)); |
| [1230](#L1230) | } |
| [1231](#L1231) |  |
| [1232](#L1232) | //Render function for Columns in Reusable Sections |
| [1233](#L1233) | function gspb\_template\_screen\_fill\_column($column, $ID) |
| [1234](#L1234) | { |
| [1235](#L1235) | global $post; |
| [1236](#L1236) | switch ($column) { |
| [1237](#L1237) |  |
| [1238](#L1238) | case 'gs-reusable-preview': |
| [1239](#L1239) |  |
| [1240](#L1240) | echo '<p><input type="text" style="width:350px" value="[wp\_reusable\_render id=\'' . $ID . '\']" readonly=""></p>'; |
| [1241](#L1241) | echo '<p>' . esc\_html\_\_('If you use template inside other dynamic ajax blocks', 'greenshift-animation-and-page-builder-blocks') . '<br><input type="text" style="width:350px" value="[wp\_reusable\_render inlinestyle=1 id=\'' . $ID . '\']" readonly="">'; |
| [1242](#L1242) | echo '<p>' . esc\_html\_\_('Shortcode for Ajax render:', 'greenshift-animation-and-page-builder-blocks') . '<br><input type="text" style="width:350px" value="[wp\_reusable\_render ajax=1 height=100px id=\'' . $ID . '\']" readonly="">'; |
| [1243](#L1243) | echo '<p>' . esc\_html\_\_('Hover trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onhover load-block-' . $ID . '</code>'; |
| [1244](#L1244) | echo '<p>' . esc\_html\_\_('Click trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onclick load-block-' . $ID . '</code>'; |
| [1245](#L1245) | echo '<p>' . esc\_html\_\_('On view trigger:', 'greenshift-animation-and-page-builder-blocks') . ' <code>gs-el-onview load-block-' . $ID . '</code>'; |
| [1246](#L1246) | break; |
| [1247](#L1247) |  |
| [1248](#L1248) | default: |
| [1249](#L1249) | break; |
| [1250](#L1250) | } |
| [1251](#L1251) | } |
| [1252](#L1252) |  |
| [1253](#L1253) | //Render shortcode function |
| [1254](#L1254) | function gspb\_template\_shortcode\_function($atts) |
| [1255](#L1255) | { |
| [1256](#L1256) | extract(shortcode\_atts( |
| [1257](#L1257) | array( |
| [1258](#L1258) | 'id' => '', |
| [1259](#L1259) | 'ajax' => '', |
| [1260](#L1260) | 'height' => '', |
| [1261](#L1261) | 'inlinestyle' => '' |
| [1262](#L1262) | ), |
| [1263](#L1263) | $atts |
| [1264](#L1264) | )); |
| [1265](#L1265) | if (!isset($id) || empty($id)) { |
| [1266](#L1266) | return ''; |
| [1267](#L1267) | } |
| [1268](#L1268) | if (!is\_numeric($id)) { |
| [1269](#L1269) | $postget = get\_page\_by\_path($id, OBJECT, array('wp\_block')); |
| [1270](#L1270) | if (is\_object($postget)) { |
| [1271](#L1271) | $id = $postget->ID; |
| [1272](#L1272) | } else { |
| [1273](#L1273) | return; |
| [1274](#L1274) | } |
| [1275](#L1275) | } |
| [1276](#L1276) | $style = ''; |
| [1277](#L1277) | $post\_css = get\_post\_meta((int)$id, '\_gspb\_post\_css', true); |
| [1278](#L1278) | if(!empty($post\_css)){ |
| [1279](#L1279) | $dynamic\_style = '<style>' . wp\_kses\_post($post\_css) . '</style>'; |
| [1280](#L1280) | $dynamic\_style = gspb\_get\_final\_css($dynamic\_style); |
| [1281](#L1281) | $dynamic\_style = gspb\_quick\_minify\_css($dynamic\_style); |
| [1282](#L1282) | $dynamic\_style = htmlspecialchars\_decode($dynamic\_style); |
| [1283](#L1283) | $style .= $dynamic\_style; |
| [1284](#L1284) | } |
| [1285](#L1285) | if (!empty($ajax)) { |
| [1286](#L1286) | wp\_enqueue\_style('wp-block-library'); |
| [1287](#L1287) | wp\_enqueue\_style('gspreloadercss'); |
| [1288](#L1288) | wp\_enqueue\_script('gselajaxloader'); |
| [1289](#L1289) | $scriptvars = array( |
| [1290](#L1290) | 'reusablenonce' => wp\_create\_nonce('gsreusable'), |
| [1291](#L1291) | 'ajax\_url' => admin\_url('admin-ajax.php', 'relative'), |
| [1292](#L1292) | ); |
| [1293](#L1293) | wp\_localize\_script('gselajaxloader', 'gsreusablevars', $scriptvars); |
| [1294](#L1294) | $content = '<div class="gs-ajax-load-block gs-ajax-load-block-' . (int)$id . '"></div>'; |
| [1295](#L1295) |  |
| [1296](#L1296) | $content\_post = get\_post($id); |
| [1297](#L1297) | if (!is\_object($content\_post)) return false; |
| [1298](#L1298) | if($content\_post->post\_type != 'wp\_block') return false; |
| [1299](#L1299) | $contentpost = $content\_post->post\_content; |
| [1300](#L1300) | if (has\_blocks($contentpost)) { |
| [1301](#L1301) | $blocks = parse\_blocks($contentpost); |
| [1302](#L1302) | $style .= '<style>'; |
| [1303](#L1303) | $style .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1304](#L1304) | $style .= '</style>'; |
| [1305](#L1305) | } |
| [1306](#L1306) | if (!empty($height)) { |
| [1307](#L1307) | $content = '<div style="min-height:' . esc\_attr($height) . '">' . $content . $style . '</div>'; |
| [1308](#L1308) | } else { |
| [1309](#L1309) | $content = '<div>' . $content . $style . '</div>'; |
| [1310](#L1310) | } |
| [1311](#L1311) | } else { |
| [1312](#L1312) | $content\_post = get\_post($id); |
| [1313](#L1313) | if (!is\_object($content\_post)) return false; |
| [1314](#L1314) | if($content\_post->post\_type != 'wp\_block') return false; |
| [1315](#L1315) | $content = $content\_post->post\_content; |
| [1316](#L1316) | if ($inlinestyle) { |
| [1317](#L1317) | if (has\_blocks($content)) { |
| [1318](#L1318) | $blocks = parse\_blocks($content); |
| [1319](#L1319) | $style .= '<style>'; |
| [1320](#L1320) | $style .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1321](#L1321) | $style .= '</style>'; |
| [1322](#L1322) | } |
| [1323](#L1323) | } |
| [1324](#L1324) | $content = do\_blocks($content); |
| [1325](#L1325) | $content = do\_shortcode($content); |
| [1326](#L1326) | $content = preg\_replace('%<p>&nbsp;\s\*</p>%', '', $content); |
| [1327](#L1327) | $content = preg\_replace('/^(?:<br\s\*\/?>\s\*)+/', '', $content); |
| [1328](#L1328) | $content = $content . $style; |
| [1329](#L1329) | } |
| [1330](#L1330) | return $content; |
| [1331](#L1331) | } |
| [1332](#L1332) |  |
| [1333](#L1333) | //Load reusable Ajax function |
| [1334](#L1334) | function gspb\_el\_reusable\_load() |
| [1335](#L1335) | { |
| [1336](#L1336) | check\_ajax\_referer('gsreusable', 'security'); |
| [1337](#L1337) | $post\_id = intval($\_POST['post\_id']); |
| [1338](#L1338) | $content\_post = get\_post($post\_id); |
| [1339](#L1339) | $content = ''; |
| [1340](#L1340) | if(is\_object($content\_post)){ |
| [1341](#L1341) | $content = $content\_post->post\_content; |
| [1342](#L1342) | $content = apply\_filters('the\_content', $content); |
| [1343](#L1343) | $content = str\_replace('strokewidth', 'stroke-width', $content); |
| [1344](#L1344) | $content = str\_replace('strokedasharray', 'stroke-dasharray', $content); |
| [1345](#L1345) | $content = str\_replace('stopcolor', 'stop-color', $content); |
| [1346](#L1346) | $content = str\_replace('loading="lazy"', '', $content); |
| [1347](#L1347) | if($content\_post->post\_type != 'wp\_block') $content = 'Please use this feature only for reusable blocks'; |
| [1348](#L1348) | } |
| [1349](#L1349) | if ($content) { |
| [1350](#L1350) | wp\_send\_json\_success($content); |
| [1351](#L1351) | } else { |
| [1352](#L1352) | wp\_send\_json\_success('fail'); |
| [1353](#L1353) | } |
| [1354](#L1354) | wp\_die(); |
| [1355](#L1355) | } |
| [1356](#L1356) |  |
| [1357](#L1357) | //Show gutenberg editor on reusable section even if Classic editor plugins enabled |
| [1358](#L1358) | function gspb\_template\_gutenberg\_post($use\_block\_editor, $post) |
| [1359](#L1359) | { |
| [1360](#L1360) | if (empty($post->ID)) return $use\_block\_editor; |
| [1361](#L1361) | if ('wp\_block' === get\_post\_type($post->ID)) return true; |
| [1362](#L1362) | return $use\_block\_editor; |
| [1363](#L1363) | } |
| [1364](#L1364) | function gspb\_template\_gutenberg\_post\_type($use\_block\_editor, $post\_type) |
| [1365](#L1365) | { |
| [1366](#L1366) | if ('wp\_block' === $post\_type) return true; |
| [1367](#L1367) | return $use\_block\_editor; |
| [1368](#L1368) | } |
| [1369](#L1369) |  |
| [1370](#L1370) | function greenshift\_additional\_\_header\_elements() |
| [1371](#L1371) | { |
| [1372](#L1372) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [1373](#L1373) | if (!empty($theme\_settings['custom\_code\_in\_head'])) { |
| [1374](#L1374) | echo wp\_kses(wp\_unslash($theme\_settings['custom\_code\_in\_head']), [ |
| [1375](#L1375) | 'meta' => [ |
| [1376](#L1376) | 'charset' => [], |
| [1377](#L1377) | 'content' => [], |
| [1378](#L1378) | 'http-equiv' => [], |
| [1379](#L1379) | 'name' => [], |
| [1380](#L1380) | 'property' => [] |
| [1381](#L1381) | ], |
| [1382](#L1382) | 'style' => [ |
| [1383](#L1383) | 'media' => [], |
| [1384](#L1384) | 'type' => [] |
| [1385](#L1385) | ], |
| [1386](#L1386) | 'script' => [ |
| [1387](#L1387) | 'async' => [], |
| [1388](#L1388) | 'charset' => [], |
| [1389](#L1389) | 'defer' => [], |
| [1390](#L1390) | 'src' => [], |
| [1391](#L1391) | 'type' => [] |
| [1392](#L1392) | ], |
| [1393](#L1393) | 'link' => [ |
| [1394](#L1394) | 'href' => [], |
| [1395](#L1395) | 'rel' => [], |
| [1396](#L1396) | 'type' => [] |
| [1397](#L1397) | ], |
| [1398](#L1398) | 'img' => [ |
| [1399](#L1399) | 'alt' => [], |
| [1400](#L1400) | 'height' => [], |
| [1401](#L1401) | 'src' => [], |
| [1402](#L1402) | 'width' => [], |
| [1403](#L1403) | 'style' => [] |
| [1404](#L1404) | ], |
| [1405](#L1405) | 'iframe' => [ |
| [1406](#L1406) | 'height' => [], |
| [1407](#L1407) | 'src' => [], |
| [1408](#L1408) | 'width' => [], |
| [1409](#L1409) | 'style' => [] |
| [1410](#L1410) | ], |
| [1411](#L1411) | 'noscript' => [] |
| [1412](#L1412) | ]); |
| [1413](#L1413) | } |
| [1414](#L1414) | $sitesettings = get\_option('gspb\_global\_settings'); |
| [1415](#L1415) | $localfonts = (!empty($sitesettings['localfont'])) ? $sitesettings['localfont'] : ''; |
| [1416](#L1416) | if ($localfonts) { |
| [1417](#L1417) | $localfonts = json\_decode($localfonts, true); |
| [1418](#L1418) | if (is\_array($localfonts)) { |
| [1419](#L1419) | foreach ($localfonts as $localfont) { |
| [1420](#L1420) | if (!empty($localfont['preloaded'])) { |
| [1421](#L1421) | $allowed\_font\_ext = $this->allowed\_font\_ext; |
| [1422](#L1422) | foreach ($allowed\_font\_ext as $ext) { |
| [1423](#L1423) | if (!empty($localfont[$ext])) { |
| [1424](#L1424) | echo '<link rel="preload" href="' . $localfont[$ext] . '" as="font" type="font/' . $ext . '" crossorigin>'; |
| [1425](#L1425) | } |
| [1426](#L1426) | } |
| [1427](#L1427) | } |
| [1428](#L1428) | } |
| [1429](#L1429) | } |
| [1430](#L1430) | } |
| [1431](#L1431) | if (!empty($sitesettings['sitesettings']['smoothscroll'])) { |
| [1432](#L1432) | echo '<style>html.lenis, html.lenis body {height: auto;}.lenis.lenis-smooth {scroll-behavior: auto !important;}.lenis.lenis-smooth [data-lenis-prevent] {overscroll-behavior: contain;}.lenis.lenis-stopped {overflow: hidden;}.lenis.lenis-smooth iframe {pointer-events: none;}</style>'; |
| [1433](#L1433) | } |
| [1434](#L1434) | if (!empty($sitesettings['sitesettings']['pagetransition']) && !empty($sitesettings['sitesettings']['pagetransitioneffect'])) { |
| [1435](#L1435) | echo '<style> |
| [1436](#L1436) | @view-transition {navigation: auto;} |
| [1437](#L1437) | @media (prefers-reduced-motion) { |
| [1438](#L1438) | ::view-transition-group(\*), ::view-transition-old(\*), ::view-transition-new(\*) { |
| [1439](#L1439) | animation: none !important; |
| [1440](#L1440) | } |
| [1441](#L1441) | } |
| [1442](#L1442) | </style>'; |
| [1443](#L1443) | if($sitesettings['sitesettings']['pagetransitioneffect'] != 'none'){ |
| [1444](#L1444) | echo '<style> |
| [1445](#L1445) | ::view-transition-old(root) {animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease);} |
| [1446](#L1446) | ::view-transition-new(root) {animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease);} |
| [1447](#L1447) | </style>'; |
| [1448](#L1448) | } |
| [1449](#L1449) | if (!empty($sitesettings['sitesettings']['pagetransitioneffect'])) { |
| [1450](#L1450) | if($sitesettings['sitesettings']['pagetransitioneffect'] == 'fade'){ |
| [1451](#L1451) | echo '<style> |
| [1452](#L1452) | @keyframes gs-pagetransition-out {from {opacity: 1;}to {opacity: 0;}} |
| [1453](#L1453) | @keyframes gs-pagetransition-in {from {opacity: 0;}to {opacity: 1;}} |
| [1454](#L1454) | </style>'; |
| [1455](#L1455) | } |
| [1456](#L1456) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-bottom'){ |
| [1457](#L1457) | echo '<style> |
| [1458](#L1458) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 0 5rem;}} |
| [1459](#L1459) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 0 -5rem;}to {opacity: 1;translate: 0;}} |
| [1460](#L1460) | </style>'; |
| [1461](#L1461) | } |
| [1462](#L1462) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-left'){ |
| [1463](#L1463) | echo '<style> |
| [1464](#L1464) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: -5rem 0;}} |
| [1465](#L1465) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 5rem 0;}to {opacity: 1;translate: 0;}} |
| [1466](#L1466) | </style>'; |
| [1467](#L1467) | } |
| [1468](#L1468) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'slide-right'){ |
| [1469](#L1469) | echo '<style> |
| [1470](#L1470) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 5rem 0;}} |
| [1471](#L1471) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: -5rem 0;}to {opacity: 1;translate: 0;}} |
| [1472](#L1472) | </style>'; |
| [1473](#L1473) | } |
| [1474](#L1474) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'zoom'){ |
| [1475](#L1475) | echo '<style> |
| [1476](#L1476) | @keyframes gs-pagetransition-out {from {opacity: 1;scale: 1;}to {opacity: 0;scale: 1.2;}} |
| [1477](#L1477) | @keyframes gs-pagetransition-in {from {opacity: 0;scale: 0.8;}to {opacity: 1;scale: 1;}} |
| [1478](#L1478) | </style>'; |
| [1479](#L1479) | } |
| [1480](#L1480) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'parallax-out'){ |
| [1481](#L1481) | echo '<style> |
| [1482](#L1482) | ::view-transition-old(root) { |
| [1483](#L1483) | animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1484](#L1484) | } |
| [1485](#L1485) | ::view-transition-new(root) { |
| [1486](#L1486) | animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1487](#L1487) | } |
| [1488](#L1488) | @keyframes gs-pagetransition-out { |
| [1489](#L1489) | from { opacity: 1; transform: translateY(0); } |
| [1490](#L1490) | to { opacity: 0.5; transform: translateY(-50%); } |
| [1491](#L1491) | } |
| [1492](#L1492) | @keyframes gs-pagetransition-in { |
| [1493](#L1493) | from { opacity: 0; transform: translateY(100%); } |
| [1494](#L1494) | to { opacity: 1; transform: translateY(0); } |
| [1495](#L1495) | } |
| [1496](#L1496) | </style>'; |
| [1497](#L1497) | } |
| [1498](#L1498) | else if($sitesettings['sitesettings']['pagetransitioneffect'] == 'push'){ |
| [1499](#L1499) | echo '<style> |
| [1500](#L1500) | ::view-transition-old(root) { |
| [1501](#L1501) | animation: 1s gs-pagetransition-out 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1502](#L1502) | } |
| [1503](#L1503) | ::view-transition-new(root) { |
| [1504](#L1504) | animation: 1s gs-pagetransition-in 0s var(--gs-root-pagetransition-easing, ease) both; |
| [1505](#L1505) | } |
| [1506](#L1506) | @keyframes gs-pagetransition-out { |
| [1507](#L1507) | from { transform: translateY(0); } |
| [1508](#L1508) | to { transform: translateY(-100%); } |
| [1509](#L1509) | } |
| [1510](#L1510) | @keyframes gs-pagetransition-in { |
| [1511](#L1511) | from { transform: translateY(100%); } |
| [1512](#L1512) | to { transform: translateY(0); } |
| [1513](#L1513) | } |
| [1514](#L1514) | </style>'; |
| [1515](#L1515) | } |
| [1516](#L1516) | else{ |
| [1517](#L1517) | echo '<style> |
| [1518](#L1518) | @keyframes gs-pagetransition-out {from {opacity: 1;translate: 0;}to {opacity: 0;translate: 0 -5rem;}} |
| [1519](#L1519) | @keyframes gs-pagetransition-in {from {opacity: 0;translate: 0 5rem;}to {opacity: 1;translate: 0;}} |
| [1520](#L1520) | </style>'; |
| [1521](#L1521) | } |
| [1522](#L1522) | } |
| [1523](#L1523) | if (!empty($sitesettings['sitesettings']['pagetransitionsafe'])) { |
| [1524](#L1524) | echo '<style>'; |
| [1525](#L1525) | $safeselectors = explode(',', $sitesettings['sitesettings']['pagetransitionsafe']); |
| [1526](#L1526) | foreach ($safeselectors as $selector) { |
| [1527](#L1527) | echo $selector . ' { view-transition-name: ' . str\_replace(array('.', '#'), '', esc\_attr($selector)) . '; }'; |
| [1528](#L1528) | } |
| [1529](#L1529) | echo '</style>'; |
| [1530](#L1530) | }else{ |
| [1531](#L1531) | echo '<style> |
| [1532](#L1532) | header{ |
| [1533](#L1533) | view-transition-name: header; |
| [1534](#L1534) | } |
| [1535](#L1535) | footer{ |
| [1536](#L1536) | view-transition-name: footer; |
| [1537](#L1537) | } |
| [1538](#L1538) | #wpadminbar{ |
| [1539](#L1539) | view-transition-name: topbar; |
| [1540](#L1540) | } |
| [1541](#L1541) | </style>'; |
| [1542](#L1542) | } |
| [1543](#L1543) | } |
| [1544](#L1544) | } |
| [1545](#L1545) |  |
| [1546](#L1546) | function greenshift\_additional\_\_footer\_elements() |
| [1547](#L1547) | { |
| [1548](#L1548) | if (defined('GREENSHIFTGSAP\_DIR\_URL')) { |
| [1549](#L1549) | $sitesettings = $this->global\_settings; |
| [1550](#L1550) | if (!empty($sitesettings['sitesettings']['mousefollow'])) { |
| [1551](#L1551) | $color = !empty($sitesettings['sitesettings']['mousecolor']) ? $sitesettings['sitesettings']['mousecolor'] : '#2184f9'; |
| [1552](#L1552) | echo '<div class="gsmouseball"></div><div class="gsmouseballsmall"></div><style>.gsmouseball{width:33px;height:33px;position:fixed;top:0;left:0;z-index:99999;border:1px solid ' . esc\_attr($color) . ';border-radius:50%;pointer-events:none;opacity:0}.gsmouseballsmall{width:4px;height:4px;position:fixed;top:0;left:0;background:' . esc\_attr($color) . ';border-radius:50%;pointer-events:none;opacity:0; z-index:99999}</style>'; |
| [1553](#L1553) | wp\_enqueue\_script('gsap-mousefollow-init'); |
| [1554](#L1554) | } |
| [1555](#L1555) | if (!empty($sitesettings['sitesettings']['smoothscroll'])) { |
| [1556](#L1556) | wp\_enqueue\_script('gs-smooth-scroll'); |
| [1557](#L1557) | } |
| [1558](#L1558) | } |
| [1559](#L1559) | $theme\_settings = get\_option('greenshift\_theme\_options'); |
| [1560](#L1560) | if (!empty($theme\_settings['custom\_code\_before\_closed\_body'])) { |
| [1561](#L1561) | echo wp\_kses(wp\_unslash($theme\_settings['custom\_code\_before\_closed\_body']), [ |
| [1562](#L1562) | 'meta' => [ |
| [1563](#L1563) | 'charset' => [], |
| [1564](#L1564) | 'content' => [], |
| [1565](#L1565) | 'http-equiv' => [], |
| [1566](#L1566) | 'name' => [], |
| [1567](#L1567) | 'property' => [] |
| [1568](#L1568) | ], |
| [1569](#L1569) | 'style' => [ |
| [1570](#L1570) | 'media' => [], |
| [1571](#L1571) | 'type' => [] |
| [1572](#L1572) | ], |
| [1573](#L1573) | 'script' => [ |
| [1574](#L1574) | 'async' => [], |
| [1575](#L1575) | 'charset' => [], |
| [1576](#L1576) | 'defer' => [], |
| [1577](#L1577) | 'src' => [], |
| [1578](#L1578) | 'type' => [] |
| [1579](#L1579) | ], |
| [1580](#L1580) | 'link' => [ |
| [1581](#L1581) | 'href' => [], |
| [1582](#L1582) | 'rel' => [], |
| [1583](#L1583) | 'type' => [] |
| [1584](#L1584) | ], |
| [1585](#L1585) | 'img' => [ |
| [1586](#L1586) | 'alt' => [], |
| [1587](#L1587) | 'height' => [], |
| [1588](#L1588) | 'src' => [], |
| [1589](#L1589) | 'width' => [], |
| [1590](#L1590) | 'style' => [] |
| [1591](#L1591) | ], |
| [1592](#L1592) | 'iframe' => [ |
| [1593](#L1593) | 'height' => [], |
| [1594](#L1594) | 'src' => [], |
| [1595](#L1595) | 'width' => [], |
| [1596](#L1596) | 'style' => [] |
| [1597](#L1597) | ], |
| [1598](#L1598) | 'noscript' => [] |
| [1599](#L1599) | ]); |
| [1600](#L1600) | } |
| [1601](#L1601) | } |
| [1602](#L1602) | } |
| [1603](#L1603) | } |
| [1604](#L1604) |  |
| [1605](#L1605) | function gspb\_get\_inline\_styles\_blocks($blocks) |
| [1606](#L1606) | { |
| [1607](#L1607) | $inlinestyle = ''; |
| [1608](#L1608) | foreach ($blocks as $block) { |
| [1609](#L1609) | if (!empty($block['attrs']['inlineCssStyles'])) { |
| [1610](#L1610) | $dynamic\_style = $block['attrs']['inlineCssStyles']; |
| [1611](#L1611) | $dynamic\_style = gspb\_get\_final\_css($dynamic\_style); |
| [1612](#L1612) | $dynamic\_style = gspb\_quick\_minify\_css($dynamic\_style); |
| [1613](#L1613) | $dynamic\_style = htmlspecialchars\_decode($dynamic\_style); |
| [1614](#L1614) | $inlinestyle .= $dynamic\_style; |
| [1615](#L1615) | } |
| [1616](#L1616) | gspb\_greenShift\_block\_script\_assets('', $block); |
| [1617](#L1617) | if (function\_exists('greenShiftGsap\_block\_script\_assets')) { |
| [1618](#L1618) | greenShiftGsap\_block\_script\_assets('', $block); |
| [1619](#L1619) | } |
| [1620](#L1620) | if (!empty($block['innerBlocks'])) { |
| [1621](#L1621) | $blocks = $block['innerBlocks']; |
| [1622](#L1622) | $inlinestyle .= gspb\_get\_inline\_styles\_blocks($blocks); |
| [1623](#L1623) | } |
| [1624](#L1624) | } |
| [1625](#L1625) | return $inlinestyle; |
| [1626](#L1626) | } |
| [1627](#L1627) |  |
| [1628](#L1628) | ////////////////////////////////////////////////////////////////// |
| [1629](#L1629) | // File Manager |
| [1630](#L1630) | ////////////////////////////////////////////////////////////////// |
| [1631](#L1631) |  |
| [1632](#L1632) | if (!function\_exists('greenshift\_download\_file\_localy')) { |
| [1633](#L1633) | function greenshift\_download\_file\_localy($file\_uri, $save\_dir, $file\_name, $file\_ext = null, $check\_type = '') |
| [1634](#L1634) | { |
| [1635](#L1635) | $file\_path = trailingslashit($save\_dir) . $file\_name; |
| [1636](#L1636) | if (file\_exists($file\_path)) { |
| [1637](#L1637) | return $file\_name; |
| [1638](#L1638) | } |
| [1639](#L1639) | $args = array( |
| [1640](#L1640) | 'timeout' => 30, |
| [1641](#L1641) | 'httpversion' => '1.1', |
| [1642](#L1642) | 'user-agent'  => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36', |
| [1643](#L1643) | 'sslverify'   => true, |
| [1644](#L1644) | ); |
| [1645](#L1645) |  |
| [1646](#L1646) | $response = wp\_remote\_get($file\_uri, $args); |
| [1647](#L1647) |  |
| [1648](#L1648) | if (is\_wp\_error($response) || (int) wp\_remote\_retrieve\_response\_code($response) !== 200) { |
| [1649](#L1649) | return false; |
| [1650](#L1650) | } |
| [1651](#L1651) |  |
| [1652](#L1652) | if ($file\_ext === null) { |
| [1653](#L1653) | $headers = wp\_remote\_retrieve\_headers($response); |
| [1654](#L1654) | if (empty($headers['content-type'])) return false; |
| [1655](#L1655) |  |
| [1656](#L1656) | $types = array\_search($headers['content-type'], wp\_get\_mime\_types()); |
| [1657](#L1657) |  |
| [1658](#L1658) | if (!$types) return false; |
| [1659](#L1659) |  |
| [1660](#L1660) | $exts = explode('|', $types); |
| [1661](#L1661) | $file\_ext = $exts[0]; |
| [1662](#L1662) | $file\_name .= '.' . $file\_ext; |
| [1663](#L1663) | } |
| [1664](#L1664) |  |
| [1665](#L1665) | $file\_name = wp\_unique\_filename($save\_dir, $file\_name); |
| [1666](#L1666) | if ($check\_type) { |
| [1667](#L1667) | $filetype = wp\_check\_filetype($file\_name); |
| [1668](#L1668) | if ($filetype['type'] != $check\_type) |
| [1669](#L1669) | return false; |
| [1670](#L1670) | } |
| [1671](#L1671) |  |
| [1672](#L1672) | $image\_string = wp\_remote\_retrieve\_body($response); |
| [1673](#L1673) | if (!file\_put\_contents($file\_path, $image\_string)) |
| [1674](#L1674) | return false; |
| [1675](#L1675) |  |
| [1676](#L1676) | return $file\_name; |
| [1677](#L1677) | } |
| [1678](#L1678) | } |
| [1679](#L1679) |  |
| [1680](#L1680) | if (!function\_exists('greenshift\_save\_file\_localy')) { |
| [1681](#L1681) | function greenshift\_save\_file\_localy($file\_uri, $img\_title = '', $check\_type = '') |
| [1682](#L1682) | { |
| [1683](#L1683) | if(!current\_user\_can('manage\_options')) return false; |
| [1684](#L1684) | $newfilename = basename($file\_uri); |
| [1685](#L1685) | $ext = pathinfo(basename($file\_uri), PATHINFO\_EXTENSION); |
| [1686](#L1686) |  |
| [1687](#L1687) | $ext = ($ext) ? $ext : null; |
| [1688](#L1688) |  |
| [1689](#L1689) | if($ext == 'svg') return false; |
| [1690](#L1690) |  |
| [1691](#L1691) | if (empty($newfilename)) { |
| [1692](#L1692) | $newfilename = preg\_replace('/[^a-zA-Z0-9\-]/', '', $newfilename); |
| [1693](#L1693) | $newfilename = strtolower($newfilename); |
| [1694](#L1694) | } |
| [1695](#L1695) |  |
| [1696](#L1696) | $uploads = wp\_upload\_dir(); |
| [1697](#L1697) |  |
| [1698](#L1698) | if ($newfilename = greenshift\_download\_file\_localy($file\_uri, $uploads['path'], $newfilename, $ext, $check\_type)) { |
| [1699](#L1699) | return $newfilename; |
| [1700](#L1700) | } else { |
| [1701](#L1701) | return false; |
| [1702](#L1702) | } |
| [1703](#L1703) | } |
| [1704](#L1704) | } |
| [1705](#L1705) |  |
| [1706](#L1706) | if (!function\_exists('greenshift\_replace\_ext\_images')) { |
| [1707](#L1707) | function greenshift\_replace\_ext\_images($content, $format = 'json') |
| [1708](#L1708) | { |
| [1709](#L1709) | $pattern = '#https?://[^/\s]+/\S+\.(jpg|png|gif|webp|svg|jpeg|json)#'; |
| [1710](#L1710) | if ($format == 'json') { |
| [1711](#L1711) | $content = json\_decode($content, true); |
| [1712](#L1712) | } |
| [1713](#L1713) | $result = preg\_replace\_callback($pattern, function ($match) { |
| [1714](#L1714) | if (is\_array($match)) { |
| [1715](#L1715) | $url = $match[0]; |
| [1716](#L1716) | if (strpos($url, get\_bloginfo('url')) !== 0) { |
| [1717](#L1717) | $urlnew = greenshift\_save\_file\_localy($url); |
| [1718](#L1718) | $uploads = wp\_upload\_dir(); |
| [1719](#L1719) | $image = trailingslashit($uploads['url']) . $urlnew; |
| [1720](#L1720) | return $image; |
| [1721](#L1721) | } else { |
| [1722](#L1722) | return $url; |
| [1723](#L1723) | } |
| [1724](#L1724) | } |
| [1725](#L1725) | }, $content); |
| [1726](#L1726) | if ($format == 'json') { |
| [1727](#L1727) | $result = json\_encode($result); |
| [1728](#L1728) | } |
| [1729](#L1729) | return $result; |
| [1730](#L1730) | } |
| [1731](#L1731) | } |
| [1732](#L1732) |  |
| [1733](#L1733) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?format=txt)
* [Original Format](/export/3222484/greenshift-animation-and-page-builder-blocks/trunk/settings.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_663db35a_20250114_215802.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3203829%2Fgreenshift-animation-and-page-builder-blocks%2Ftrunk%2Fsettings.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3202741/greenshift-animation-and-page-builder-blocks/trunk/settings.php "Changeset 3202741 for greenshift-animation-and-page-builder-blocks/trunk/settings.php")
* [Next Change](/changeset/3204239/greenshift-animation-and-page-builder-blocks/trunk/settings.php "Changeset 3204239 for greenshift-animation-and-page-builder-blocks/trunk/settings.php") →

---

# Changeset [3203829](/changeset/3203829 "Show full changeset") for [greenshift-animation-and-page-builder-blocks/trunk/settings.php](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3203829 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/06/2024 07:00:15 PM
([6 weeks](/timeline?from=2024-12-06T19%3A00%3A15Z&precision=second "See timeline at 12/06/2024 07:00:15 PM") ago)

Author:
wpsoul
Message:

update

File:

1 edited

* [greenshift-animation-and-page-builder-blocks/trunk/settings.php](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3203829 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [greenshift-animation-and-page-builder-blocks/trunk/settings.php](/changeset/3203829/greenshift-animation-and-page-builder-blocks/trunk/settings.php "Show the changeset 3203829 restricted to greenshift-animation-and-page-builder-blocks/trunk/settings.php")

  | [r3202741](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3202741#L1286 "Show revision 3202741 of this file in browser") | [r3203829](/browser/greenshift-animation-and-page-builder-blocks/trunk/settings.php?rev=3203829#L1286 "Show revision 3203829 of this file in browser") |  |
  | --- | --- | --- |
  | 1286 | 1286 | $content\_post = get\_post($id); |
  | 1287 | 1287 | if (!is\_object($content\_post)) return false; |
  |  | 1288 | if($content\_post->post\_type != 'wp\_block') return false; |
  | 1288 | 1289 | $content = $content\_post->post\_content; |
  | 1289 | 1290 | $style = ''; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3203829)
* [Zip Archive](?format=zip&new=3203829)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


