Based on the provided content, here's an analysis of CVE-2024-11940:

**Vulnerability Details:**

*   **CVE ID:** CVE-2024-11940
*   **Affected Software:** Property Hive Mortgage Calculator WordPress plugin, versions up to and including 1.0.6.
*   **Vulnerability Type:** Stored Cross-Site Scripting (XSS)
*   **CVSS Score:** 6.4 (Medium)
*   **Root Cause:** The plugin does not properly sanitize and escape the `price` parameter passed to the `mortgage_calculator` shortcode. This allows an attacker to inject malicious JavaScript code.
*   **Weaknesses/Vulnerabilities:**
    *   **Insufficient Input Sanitization:** The plugin fails to sanitize the `price` attribute passed to the shortcode.
    *   **Insufficient Output Escaping:** The plugin does not properly escape the output of the price attribute when rendering the form, leading to XSS vulnerability.
*   **Impact of Exploitation:** An attacker can inject arbitrary web scripts that will execute when a user accesses a page containing the vulnerable shortcode. This could lead to:
    *   Malicious redirects to phishing sites.
    *   Session hijacking.
    *   Defacement of the website.
    *   Other malicious actions performed on the user's behalf.
*   **Attack Vector:**
    *   The attacker injects malicious JavaScript code via the `price` attribute of the `mortgage_calculator` shortcode.
    *   The injected code is stored in the database as part of the post content.
    *   When a user views the page containing the shortcode, the malicious script is executed in their browser.
*   **Required Attacker Capabilities/Position:**
    *   **Authenticated User:** The attacker needs to have at least Contributor-level access to the WordPress site to be able to create or edit post content and add the vulnerable shortcode with the malicious payload.
    *   **Knowledge of Vulnerable Parameter:** The attacker needs to know that the `price` attribute of the shortcode is vulnerable to XSS.

**Technical Details:**

The vulnerability is located in the `templates/mortgage-calculator.php` file. The following line:

```php
<input type="text" name="purchase_price" value="<?php echo $atts['price']; ?>" placeholder="500,000">
```

does not sanitize the `price` attribute, allowing an attacker to inject javascript via the `price` parameter.

The fix, implemented in version 1.0.7, involves adding sanitization and escaping to the template:

```php
<input type="text" name="purchase_price" value="<?php echo esc_attr( $atts['price'] ); ?>" placeholder="e.g. 500,000">
```

and also sanitizing the price value before passing it to the template.

```php
$atts['price'] = str_replace(",", "", $atts['price']);
$atts['price'] = ( isset($atts['price']) && $atts['price'] != '' ) ? floatval($atts['price']) : '';
```

**Mitigation:**

*   Update the Property Hive Mortgage Calculator plugin to version 1.0.7 or later.

**Additional Notes:**

* The vulnerability was discovered by Peter Thaleikis.
* The fix was implemented in changeset [3202219](https://plugins.trac.wordpress.org/changeset/3202219/).

This analysis provides more detail than the basic CVE description.