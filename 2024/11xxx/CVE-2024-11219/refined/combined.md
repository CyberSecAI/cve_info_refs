=== Content from plugins.trac.wordpress.org_87dbc43d_20250114_202354.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fotter-blocks%2Ftags%2F3.0.6%2Finc%2Fplugins%2Fclass-dynamic-content.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/otter-blocks/trunk/inc/plugins/class-dynamic-content.php?rev=2928489 "Revision 2928489")
* Next Revision →
* [Blame](/browser/otter-blocks/trunk/inc/plugins/class-dynamic-content.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/otter-blocks/tags/3.0.6/inc/plugins/class-dynamic-content.php)

---

# [source:](/browser?order=name "Go to repository root") [otter-blocks](/browser/otter-blocks?order=name "View otter-blocks")/[tags](/browser/otter-blocks/tags?order=name "View tags")/[3.0.6](/browser/otter-blocks/tags/3.0.6?order=name "View 3.0.6")/[inc](/browser/otter-blocks/tags/3.0.6/inc?order=name "View inc")/[plugins](/browser/otter-blocks/tags/3.0.6/inc/plugins?order=name "View plugins")/[class-dynamic-content.php](/browser/otter-blocks/tags/3.0.6/inc/plugins/class-dynamic-content.php?order=name "View class-dynamic-content.php")

View diff against:

View revision:

| [Last change](/changeset/2997210/otter-blocks/trunk/inc/plugins/class-dynamic-content.php "View differences") on this file was [2997210](/changeset/2997210/ "View changeset 2997210"), checked in by themeisle, [14 months ago](/timeline?from=2023-11-16T15%3A53%3A25Z&precision=second "See timeline at 11/16/2023 03:53:25 PM") |
| --- |
| Update to version 2.5.0 from GitHub |
| **File size:** 20.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Dynamic Content. |
| [4](#L4) | \* |
| [5](#L5) | \* @package ThemeIsle\GutenbergBlocks\Plugins |
| [6](#L6) | \*/ |
| [7](#L7) |  |
| [8](#L8) | namespace ThemeIsle\GutenbergBlocks\Plugins; |
| [9](#L9) |  |
| [10](#L10) | /\*\* |
| [11](#L11) | \* Class Dynamic\_Content |
| [12](#L12) | \*/ |
| [13](#L13) | class Dynamic\_Content { |
| [14](#L14) |  |
| [15](#L15) | /\*\* |
| [16](#L16) | \* The main instance var. |
| [17](#L17) | \* |
| [18](#L18) | \* @var Dynamic\_Content|null |
| [19](#L19) | \*/ |
| [20](#L20) | protected static $instance = null; |
| [21](#L21) |  |
| [22](#L22) | /\*\* |
| [23](#L23) | \* Initialize the class |
| [24](#L24) | \*/ |
| [25](#L25) | public function init() { |
| [26](#L26) | add\_filter( 'render\_block', array( $this, 'apply\_dynamic\_content' ) ); |
| [27](#L27) | add\_filter( 'render\_block', array( $this, 'apply\_dynamic\_magic\_tags' ) ); |
| [28](#L28) | add\_filter( 'render\_block', array( $this, 'apply\_dynamic\_link' ) ); |
| [29](#L29) | add\_filter( 'render\_block', array( $this, 'apply\_dynamic\_link\_button' ) ); |
| [30](#L30) | add\_filter( 'render\_block', array( $this, 'apply\_dynamic\_images' ) ); |
| [31](#L31) | add\_filter( 'otter\_apply\_dynamic\_image', array( $this, 'apply\_dynamic\_images' ) ); |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Filter post content for dynamic content. |
| [36](#L36) | \* |
| [37](#L37) | \* @param string $content Post content. |
| [38](#L38) | \* |
| [39](#L39) | \* @return string |
| [40](#L40) | \*/ |
| [41](#L41) | public function apply\_dynamic\_content( $content ) { |
| [42](#L42) | if ( false === strpos( $content, '<o-dynamic' ) ) { |
| [43](#L43) | return $content; |
| [44](#L44) | } |
| [45](#L45) |  |
| [46](#L46) | $matches = array(); |
| [47](#L47) | $num     = self::parse\_dynamic\_content\_query( $content, $matches ); |
| [48](#L48) |  |
| [49](#L49) | if ( isset( $num ) && 0 === $num ) { |
| [50](#L50) | return $content; |
| [51](#L51) | } |
| [52](#L52) |  |
| [53](#L53) | foreach ( $matches as $match ) { |
| [54](#L54) | $replacement       = $this->apply\_data( $match ); |
| [55](#L55) | $string\_to\_replace = $match[0]; |
| [56](#L56) | $position          = strstr( $content, $string\_to\_replace, true ); |
| [57](#L57) |  |
| [58](#L58) | if ( false === $position ) { |
| [59](#L59) | continue; |
| [60](#L60) | } |
| [61](#L61) |  |
| [62](#L62) | $position = strlen( $position ); |
| [63](#L63) | $content  = substr\_replace( $content, $replacement, $position, strlen( $string\_to\_replace ) ); |
| [64](#L64) | } |
| [65](#L65) |  |
| [66](#L66) | return $content; |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | /\*\* |
| [70](#L70) | \* Get the Dynamic Content regex. |
| [71](#L71) | \* |
| [72](#L72) | \* @return string |
| [73](#L73) | \*/ |
| [74](#L74) | public static function dynamic\_content\_regex() { |
| [75](#L75) | // Todo: Improve this Regex, it can't go on for like this. Soon it will be longer than the available space in the universe!!! |
| [76](#L76) | return '/<o-dynamic(?:\s+(?:data-type=["\'](?P<type>[^"\'<>]+)["\']|data-id=["\'](?P<id>[^"\'<>]+)["\']|data-before=["\'](?P<before>[^"\'<>]+)["\']|data-after=["\'](?P<after>[^"\'<>]+)["\']|data-length=["\'](?P<length>[^"\'<>]+)["\']|data-date-type=["\'](?P<dateType>[^"\'<>]+)["\']|data-date-format=["\'](?P<dateFormat>[^"\'<>]+)["\']|data-date-custom=["\'](?P<dateCustom>[^"\'<>]+)["\']|data-time-type=["\'](?P<timeType>[^"\'<>]+)["\']|data-time-format=["\'](?P<timeFormat>[^"\'<>]+)["\']|data-time-custom=["\'](?P<timeCustom>[^"\'<>]+)["\']|data-term-type=["\'](?P<termType>[^"\'<>]+)["\']|data-term-separator=["\'](?P<termSeparator>[^"\'<>]+)["\']|data-meta-key=["\'](?P<metaKey>[^"\'<>]+)["\']|data-parameter=["\'](?P<parameter>[^"\'<>]+)["\']|data-format=["\'](?P<format>[^"\'<>]+)["\']|data-context=["\'](?P<context>[^"\'<>]+)["\']|data-taxonomy=["\'](?P<taxonomy>[^"\'<>]+)["\']|[a-zA-Z-]+=["\'][^"\'<>]+["\']))\*\s\*>(?<default>[^ $].\*?)<\s\*\/\s\*o-dynamic>/'; |
| [77](#L77) | } |
| [78](#L78) |  |
| [79](#L79) | /\*\* |
| [80](#L80) | \* Parse dynamic content query. |
| [81](#L81) | \* |
| [82](#L82) | \* @param string $content The content to parse. |
| [83](#L83) | \* @param array  $matches The matches. |
| [84](#L84) | \* @return mixed |
| [85](#L85) | \*/ |
| [86](#L86) | public static function parse\_dynamic\_content\_query( $content, &$matches ) { |
| [87](#L87) | $re = self::dynamic\_content\_regex(); |
| [88](#L88) | return preg\_match\_all( $re, $content, $matches, PREG\_SET\_ORDER, 0 ); |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) | /\*\* |
| [92](#L92) | \* Filter post content for Magic Tags. |
| [93](#L93) | \* |
| [94](#L94) | \* @param string $content Post content. |
| [95](#L95) | \* |
| [96](#L96) | \* @return string |
| [97](#L97) | \*/ |
| [98](#L98) | public function apply\_dynamic\_magic\_tags( $content ) { |
| [99](#L99) | if ( false === strpos( $content, '{otterDynamic?' ) ) { |
| [100](#L100) | return $content; |
| [101](#L101) | } |
| [102](#L102) |  |
| [103](#L103) | $re = '/{(otterDynamic\/?.[^"]\*)}/'; |
| [104](#L104) |  |
| [105](#L105) | return preg\_replace\_callback( $re, array( $this, 'apply\_magic\_tags' ), $content ); |
| [106](#L106) | } |
| [107](#L107) |  |
| [108](#L108) | /\*\* |
| [109](#L109) | \* Apply dynamic data for Magic Tags. |
| [110](#L110) | \* |
| [111](#L111) | \* @param array $data Dynamic request. |
| [112](#L112) | \* |
| [113](#L113) | \* @return string|void |
| [114](#L114) | \*/ |
| [115](#L115) | public function apply\_magic\_tags( $data ) { |
| [116](#L116) | if ( ! isset( $data[1] ) ) { |
| [117](#L117) | return; |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | $data = explode( 'otterDynamic', $data[1] ); |
| [121](#L121) | $data = self::query\_string\_to\_array( $data[1] ); |
| [122](#L122) |  |
| [123](#L123) | if ( ! isset( $data['default'] ) ) { |
| [124](#L124) | $data['default'] = ''; |
| [125](#L125) | } |
| [126](#L126) |  |
| [127](#L127) | $data = $this->apply\_data( $data, true ); |
| [128](#L128) |  |
| [129](#L129) | return $data; |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | /\*\* |
| [133](#L133) | \* Filter post content for dynamic link. |
| [134](#L134) | \* |
| [135](#L135) | \* @param string $content Post content. |
| [136](#L136) | \* |
| [137](#L137) | \* @return string |
| [138](#L138) | \*/ |
| [139](#L139) | public function apply\_dynamic\_link( $content ) { |
| [140](#L140) | if ( false === strpos( $content, '<o-dynamic-link' ) ) { |
| [141](#L141) | return $content; |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | $re = '/<o-dynamic-link(?:\s+(?:data-type=["\'](?P<type>[^"\'<>]+)["\']|data-target=["\'](?P<target>[^"\'<>]+)["\']|data-meta-key=["\'](?P<metaKey>[^"\'<>]+)["\']|data-context=["\'](?P<context>[^"\'<>]+)["\']|[a-zA-Z-]+=["\'][^"\'<>]+["\']))\*\s\*>(?<text>[^ $].\*?)<\s\*\/\s\*o-dynamic-link>/'; |
| [145](#L145) |  |
| [146](#L146) | return preg\_replace\_callback( $re, array( $this, 'apply\_link' ), $content ); |
| [147](#L147) | } |
| [148](#L148) |  |
| [149](#L149) | /\*\* |
| [150](#L150) | \* Filter post content for dynamic link buttons. |
| [151](#L151) | \* |
| [152](#L152) | \* @param string $content Post content. |
| [153](#L153) | \* |
| [154](#L154) | \* @return string |
| [155](#L155) | \*/ |
| [156](#L156) | public function apply\_dynamic\_link\_button( $content ) { |
| [157](#L157) | if ( false === strpos( $content, '#otterDynamicLink' ) ) { |
| [158](#L158) | return $content; |
| [159](#L159) | } |
| [160](#L160) |  |
| [161](#L161) | $re = '/#otterDynamicLink\/?.[^"]\*/'; |
| [162](#L162) |  |
| [163](#L163) | return preg\_replace\_callback( $re, array( $this, 'apply\_link\_button' ), $content ); |
| [164](#L164) | } |
| [165](#L165) |  |
| [166](#L166) | /\*\* |
| [167](#L167) | \* Filter post content for dynamic images. |
| [168](#L168) | \* |
| [169](#L169) | \* @param string $content Post content. |
| [170](#L170) | \* |
| [171](#L171) | \* @return string |
| [172](#L172) | \*/ |
| [173](#L173) | public function apply\_dynamic\_images( $content ) { |
| [174](#L174) | if ( false === strpos( $content, 'otter/v1/dynamic' ) ) { |
| [175](#L175) | return $content; |
| [176](#L176) | } |
| [177](#L177) |  |
| [178](#L178) | $rest\_url = get\_rest\_url( null, 'otter/v1' ); |
| [179](#L179) | $rest\_url = preg\_replace( '/([^A-Za-z0-9\s\_-])/', '\\\\$1', $rest\_url ); |
| [180](#L180) |  |
| [181](#L181) | $re = '/' . $rest\_url . '\/dynamic\/?.[^"]\*/'; |
| [182](#L182) |  |
| [183](#L183) | return preg\_replace\_callback( $re, array( $this, 'apply\_images' ), $content ); |
| [184](#L184) | } |
| [185](#L185) |  |
| [186](#L186) | /\*\* |
| [187](#L187) | \* Apply dynamic data. |
| [188](#L188) | \* |
| [189](#L189) | \* @param array $data Dynamic request. |
| [190](#L190) | \* |
| [191](#L191) | \* @return string|void |
| [192](#L192) | \*/ |
| [193](#L193) | public function apply\_images( $data ) { |
| [194](#L194) | if ( ! isset( $data[0] ) ) { |
| [195](#L195) | return; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | $data  = self::query\_string\_to\_array( $data[0] ); |
| [199](#L199) | $value = $this->get\_image( $data ); |
| [200](#L200) |  |
| [201](#L201) | return $value; |
| [202](#L202) | } |
| [203](#L203) |  |
| [204](#L204) | /\*\* |
| [205](#L205) | \* Apply dynamic image. |
| [206](#L206) | \* |
| [207](#L207) | \* @param array $data Query array. |
| [208](#L208) | \* |
| [209](#L209) | \* @return string |
| [210](#L210) | \*/ |
| [211](#L211) | public function get\_image( $data ) { |
| [212](#L212) | $value = OTTER\_BLOCKS\_URL . 'assets/images/placeholder.jpg'; |
| [213](#L213) |  |
| [214](#L214) | global $post; |
| [215](#L215) |  |
| [216](#L216) | $id = ( defined( 'REST\_REQUEST' ) && REST\_REQUEST || ( isset( $data['context'] ) && 'query' === $data['context'] ) ) ? $post->ID : get\_queried\_object\_id(); |
| [217](#L217) |  |
| [218](#L218) | if ( isset( $data['context'] ) && ( 0 === $data['context'] || 'query' === $data['context'] || ( is\_singular() && $data['context'] !== $id ) ) ) { |
| [219](#L219) | $data['context'] = $id; |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | if ( isset( $data['fallback'] ) && ! empty( $data['fallback'] ) ) { |
| [223](#L223) | $value = esc\_url( $data['fallback'] ); |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | if ( ! isset( $data['type'] ) && empty( $data['type'] ) ) { |
| [227](#L227) | return $value; |
| [228](#L228) | } |
| [229](#L229) |  |
| [230](#L230) | if ( 'featuredImage' === $data['type'] ) { |
| [231](#L231) | $image = get\_the\_post\_thumbnail\_url( $data['context'] ); |
| [232](#L232) |  |
| [233](#L233) | if ( $image ) { |
| [234](#L234) | $value = $image; |
| [235](#L235) | } |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | if ( 'author' === $data['type'] ) { |
| [239](#L239) | $author = get\_post\_field( 'post\_author', $data['context'] ); |
| [240](#L240) | $value  = get\_avatar\_url( $author ); |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | if ( 'loggedInUser' === $data['type'] ) { |
| [244](#L244) | $user = get\_current\_user\_id(); |
| [245](#L245) |  |
| [246](#L246) | if ( true === boolval( $user ) ) { |
| [247](#L247) | $value = get\_avatar\_url( $user ); |
| [248](#L248) | } |
| [249](#L249) | } |
| [250](#L250) |  |
| [251](#L251) | if ( 'logo' === $data['type'] ) { |
| [252](#L252) | $custom\_logo\_id = get\_theme\_mod( 'custom\_logo' ); |
| [253](#L253) |  |
| [254](#L254) | if ( $custom\_logo\_id ) { |
| [255](#L255) | $value = wp\_get\_attachment\_image\_url( $custom\_logo\_id, 'full' ); |
| [256](#L256) | } |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | $value = apply\_filters( 'otter\_blocks\_evaluate\_dynamic\_content\_media\_content', $value, $data ); |
| [260](#L260) |  |
| [261](#L261) | return $value; |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | /\*\* |
| [265](#L265) | \* Apply dynamic data. |
| [266](#L266) | \* |
| [267](#L267) | \* @param array $data Dynamic request. |
| [268](#L268) | \* @param bool  $magic\_tags Is a request for Magic Tags. |
| [269](#L269) | \* |
| [270](#L270) | \* @return string |
| [271](#L271) | \*/ |
| [272](#L272) | public function apply\_data( $data, $magic\_tags = false ) { |
| [273](#L273) | $value = $this->get\_data( $data, $magic\_tags ); |
| [274](#L274) |  |
| [275](#L275) | if ( isset( $data['before'] ) || isset( $data['after'] ) ) { |
| [276](#L276) | $value = $this->apply\_formatting( $value, $data ); |
| [277](#L277) | } |
| [278](#L278) |  |
| [279](#L279) | if ( isset( $data['default'] ) && false !== strpos( $data['default'], '<o-dynamic-link' ) ) { |
| [280](#L280) | $link = $this->apply\_dynamic\_link( $data['default'] ); |
| [281](#L281) | return preg\_replace( '/(<a.\*?>).\*?(<\/a>)/', '$1' . $value . '$2', $link ); |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | return $value; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | /\*\* |
| [288](#L288) | \* Apply formatting. |
| [289](#L289) | \* |
| [290](#L290) | \* @param string $value Dynamic value. |
| [291](#L291) | \* @param array  $data Dynamic request. |
| [292](#L292) | \* |
| [293](#L293) | \* @return string |
| [294](#L294) | \*/ |
| [295](#L295) | public function apply\_formatting( $value, $data ) { |
| [296](#L296) | if ( isset( $data['before'] ) ) { |
| [297](#L297) | $value = esc\_html( $data['before'] ) . $value; |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | if ( isset( $data['after'] ) ) { |
| [301](#L301) | $value = $value . esc\_html( $data['after'] ); |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | return $value; |
| [305](#L305) | } |
| [306](#L306) |  |
| [307](#L307) | /\*\* |
| [308](#L308) | \* Get dynamic data. |
| [309](#L309) | \* |
| [310](#L310) | \* @param array $data Dynamic request. |
| [311](#L311) | \* @param bool  $magic\_tags Is a request for Magic Tags. |
| [312](#L312) | \* |
| [313](#L313) | \* @return string |
| [314](#L314) | \*/ |
| [315](#L315) | public function get\_data( $data, $magic\_tags ) { |
| [316](#L316) | if ( ! ( defined( 'REST\_REQUEST' ) && REST\_REQUEST ) || true === $magic\_tags ) { |
| [317](#L317) | if ( isset( $data['context'] ) && 'query' === $data['context'] ) { |
| [318](#L318) | $data['context'] = get\_the\_ID(); |
| [319](#L319) | } else { |
| [320](#L320) | /\* |
| [321](#L321) | \* We use the queried object ID to make sure when posts are displayed inside other posts |
| [322](#L322) | \* the displayed post is being used as a source for the dynamic tags. Eg. Custom Layouts inside Neve. |
| [323](#L323) | \*/ |
| [324](#L324) | $data['context'] = get\_queried\_object\_id(); |
| [325](#L325) | } |
| [326](#L326) | } else { |
| [327](#L327) | $data['default'] = ''; |
| [328](#L328) | } |
| [329](#L329) |  |
| [330](#L330) | if ( ! isset( $data['type'] ) && isset( $data['default'] ) ) { |
| [331](#L331) | return esc\_html( $data['default'] ); |
| [332](#L332) | } |
| [333](#L333) |  |
| [334](#L334) | if ( 'postID' === $data['type'] ) { |
| [335](#L335) | return $data['context']; |
| [336](#L336) | } |
| [337](#L337) |  |
| [338](#L338) | if ( 'postTitle' === $data['type'] ) { |
| [339](#L339) | return get\_the\_title( $data['context'] ); |
| [340](#L340) | } |
| [341](#L341) |  |
| [342](#L342) | if ( 'postContent' === $data['type'] ) { |
| [343](#L343) | return $this->get\_content( $data ); |
| [344](#L344) | } |
| [345](#L345) |  |
| [346](#L346) | if ( 'postExcerpt' === $data['type'] ) { |
| [347](#L347) | return $this->get\_excerpt( $data ); |
| [348](#L348) | } |
| [349](#L349) |  |
| [350](#L350) | if ( 'postType' === $data['type'] ) { |
| [351](#L351) | return get\_post\_type( $data['context'] ); |
| [352](#L352) | } |
| [353](#L353) |  |
| [354](#L354) | if ( 'postStatus' === $data['type'] ) { |
| [355](#L355) | return get\_post\_status( $data['context'] ); |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | if ( 'siteTitle' === $data['type'] ) { |
| [359](#L359) | return get\_bloginfo( 'name' ); |
| [360](#L360) | } |
| [361](#L361) |  |
| [362](#L362) | if ( 'siteTagline' === $data['type'] ) { |
| [363](#L363) | return get\_bloginfo( 'description' ); |
| [364](#L364) | } |
| [365](#L365) |  |
| [366](#L366) | if ( 'authorName' === $data['type'] ) { |
| [367](#L367) | return get\_the\_author\_meta( 'display\_name', intval( get\_post\_field( 'post\_author', $data['context'] ) ) ); |
| [368](#L368) | } |
| [369](#L369) |  |
| [370](#L370) | if ( 'authorDescription' === $data['type'] ) { |
| [371](#L371) | return get\_the\_author\_meta( 'description', intval( get\_post\_field( 'post\_author', $data['context'] ) ) ); |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | if ( 'loggedInUserName' === $data['type'] ) { |
| [375](#L375) | return $this->get\_loggedin\_name( $data ); |
| [376](#L376) | } |
| [377](#L377) |  |
| [378](#L378) | if ( 'loggedInUserDescription' === $data['type'] ) { |
| [379](#L379) | return $this->get\_loggedin\_description( $data ); |
| [380](#L380) | } |
| [381](#L381) |  |
| [382](#L382) | if ( 'loggedInUserEmail' === $data['type'] ) { |
| [383](#L383) | return $this->get\_loggedin\_email( $data ); |
| [384](#L384) | } |
| [385](#L385) |  |
| [386](#L386) | if ( 'archiveTitle' === $data['type'] ) { |
| [387](#L387) | return get\_the\_archive\_title(); |
| [388](#L388) | } |
| [389](#L389) |  |
| [390](#L390) | if ( 'archiveDescription' === $data['type'] ) { |
| [391](#L391) | return $this->get\_archive\_description( $data ); |
| [392](#L392) | } |
| [393](#L393) |  |
| [394](#L394) | if ( 'date' === $data['type'] ) { |
| [395](#L395) | return $this->get\_current\_date( $data ); |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | if ( 'time' === $data['type'] ) { |
| [399](#L399) | return $this->get\_current\_time( $data ); |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | return apply\_filters( 'otter\_blocks\_evaluate\_dynamic\_content\_text', $data['default'], $data ); |
| [403](#L403) | } |
| [404](#L404) |  |
| [405](#L405) | /\*\* |
| [406](#L406) | \* Get Content. |
| [407](#L407) | \* |
| [408](#L408) | \* @param array $data Dynamic Data. |
| [409](#L409) | \* |
| [410](#L410) | \* @return string |
| [411](#L411) | \*/ |
| [412](#L412) | public function get\_content( $data ) { |
| [413](#L413) | $data = $this->mark\_exceptions( $data ); |
| [414](#L414) | $key  = $this->get\_exception\_key( $data ); |
| [415](#L415) |  |
| [416](#L416) | if ( isset( $data[ $key ] ) ) { |
| [417](#L417) | return ''; |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) | $content = get\_the\_content( $data['context'] ); |
| [421](#L421) | $content = apply\_filters( 'the\_content', str\_replace( ']]>', ']]&gt;', $content ) ); |
| [422](#L422) | return wp\_kses\_post( $content ); |
| [423](#L423) | } |
| [424](#L424) |  |
| [425](#L425) | /\*\* |
| [426](#L426) | \* Get Excerpt. |
| [427](#L427) | \* |
| [428](#L428) | \* @param array $data Dynamic Data. |
| [429](#L429) | \* |
| [430](#L430) | \* @return string |
| [431](#L431) | \*/ |
| [432](#L432) | public function get\_excerpt( $data ) { |
| [433](#L433) | $post    = get\_post( $data['context'] ); |
| [434](#L434) | $excerpt = $post->post\_excerpt; // Here we don't use get\_the\_excerpt() function as it causes an infinite loop. |
| [435](#L435) |  |
| [436](#L436) | if ( empty( $excerpt ) ) { |
| [437](#L437) | $data = $this->mark\_exceptions( $data ); |
| [438](#L438) | $key  = $this->get\_exception\_key( $data, $post->ID ); |
| [439](#L439) |  |
| [440](#L440) | if ( ! isset( $data[ $key ] ) ) { |
| [441](#L441) | $excerpt = wp\_trim\_excerpt( '', $post ); |
| [442](#L442) | } |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | if ( isset( $data['length'] ) && ! empty( $data['length'] ) ) { |
| [446](#L446) | $excerpt = substr( $excerpt, 0, intval( $data['length'] ) ) . '…'; |
| [447](#L447) | } |
| [448](#L448) |  |
| [449](#L449) | if ( empty( $excerpt ) ) { |
| [450](#L450) | return $data['default']; |
| [451](#L451) | } |
| [452](#L452) |  |
| [453](#L453) | return sanitize\_text\_field( $excerpt ); |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | /\*\* |
| [457](#L457) | \* Get Logged-in User Name. |
| [458](#L458) | \* |
| [459](#L459) | \* @param array $data Dynamic Data. |
| [460](#L460) | \* |
| [461](#L461) | \* @return string |
| [462](#L462) | \*/ |
| [463](#L463) | public function get\_loggedin\_name( $data ) { |
| [464](#L464) | $user\_id = get\_current\_user\_id(); |
| [465](#L465) | $default = isset( $data['default'] ) ? esc\_html( $data['default'] ) : ''; |
| [466](#L466) | $user    = get\_userdata( $user\_id ); |
| [467](#L467) |  |
| [468](#L468) | if ( false === $user ) { |
| [469](#L469) | $display\_name = $default; |
| [470](#L470) | } else { |
| [471](#L471) | $display\_name = $user->display\_name; |
| [472](#L472) | } |
| [473](#L473) |  |
| [474](#L474) | return esc\_html( $display\_name ); |
| [475](#L475) | } |
| [476](#L476) |  |
| [477](#L477) | /\*\* |
| [478](#L478) | \* Get Logged-in User Description. |
| [479](#L479) | \* |
| [480](#L480) | \* @param array $data Dynamic Data. |
| [481](#L481) | \* |
| [482](#L482) | \* @return string |
| [483](#L483) | \*/ |
| [484](#L484) | public function get\_loggedin\_description( $data ) { |
| [485](#L485) | $user\_id = get\_current\_user\_id(); |
| [486](#L486) | $default = isset( $data['default'] ) ? esc\_html( $data['default'] ) : ''; |
| [487](#L487) | $user    = get\_userdata( $user\_id ); |
| [488](#L488) |  |
| [489](#L489) | if ( false === $user ) { |
| [490](#L490) | $description = $default; |
| [491](#L491) | } else { |
| [492](#L492) | $description = $user->description; |
| [493](#L493) | } |
| [494](#L494) |  |
| [495](#L495) | return esc\_html( $description ); |
| [496](#L496) | } |
| [497](#L497) |  |
| [498](#L498) | /\*\* |
| [499](#L499) | \* Get Logged-in User Email. |
| [500](#L500) | \* |
| [501](#L501) | \* @param array $data Dynamic Data. |
| [502](#L502) | \* |
| [503](#L503) | \* @return string |
| [504](#L504) | \*/ |
| [505](#L505) | public function get\_loggedin\_email( $data ) { |
| [506](#L506) | $user    = wp\_get\_current\_user(); |
| [507](#L507) | $default = isset( $data['default'] ) ? esc\_html( $data['default'] ) : ''; |
| [508](#L508) | $email   = $user->user\_email; |
| [509](#L509) |  |
| [510](#L510) | if ( empty( $email ) ) { |
| [511](#L511) | $email = $default; |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | return esc\_html( $email ); |
| [515](#L515) | } |
| [516](#L516) |  |
| [517](#L517) | /\*\* |
| [518](#L518) | \* Get Archive Description. |
| [519](#L519) | \* |
| [520](#L520) | \* @param array $data Dynamic Data. |
| [521](#L521) | \* |
| [522](#L522) | \* @return string |
| [523](#L523) | \*/ |
| [524](#L524) | public function get\_archive\_description( $data ) { |
| [525](#L525) | $description = get\_the\_archive\_description(); |
| [526](#L526) |  |
| [527](#L527) | if ( empty( $description ) ) { |
| [528](#L528) | $default     = isset( $data['default'] ) ? esc\_html( $data['default'] ) : ''; |
| [529](#L529) | $description = $default; |
| [530](#L530) | } |
| [531](#L531) |  |
| [532](#L532) | return $description; |
| [533](#L533) | } |
| [534](#L534) |  |
| [535](#L535) | /\*\* |
| [536](#L536) | \* Get Current Date. |
| [537](#L537) | \* |
| [538](#L538) | \* @param array $data Dynamic Data. |
| [539](#L539) | \* |
| [540](#L540) | \* @return string |
| [541](#L541) | \*/ |
| [542](#L542) | public function get\_current\_date( $data ) { |
| [543](#L543) | $format = get\_option( 'date\_format' ); |
| [544](#L544) |  |
| [545](#L545) | if ( isset( $data['dateFormat'] ) && ! empty( $data['dateFormat'] ) && 'default' !== $data['dateFormat'] && 'custom' !== $data['dateFormat'] ) { |
| [546](#L546) | $format = esc\_html( $data['dateFormat'] ); |
| [547](#L547) | } |
| [548](#L548) |  |
| [549](#L549) | if ( isset( $data['dateCustom'] ) && ! empty( $data['dateCustom'] ) && isset( $data['dateFormat'] ) && 'custom' === $data['dateFormat'] ) { |
| [550](#L550) | $format = esc\_html( $data['dateCustom'] ); |
| [551](#L551) | } |
| [552](#L552) |  |
| [553](#L553) | $date = date( $format ); |
| [554](#L554) |  |
| [555](#L555) | return $date; |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | /\*\* |
| [559](#L559) | \* Get Current Date. |
| [560](#L560) | \* |
| [561](#L561) | \* @param array $data Dynamic Data. |
| [562](#L562) | \* |
| [563](#L563) | \* @return string |
| [564](#L564) | \*/ |
| [565](#L565) | public function get\_current\_time( $data ) { |
| [566](#L566) | $format = get\_option( 'time\_format' ); |
| [567](#L567) |  |
| [568](#L568) | if ( isset( $data['timeFormat'] ) && ! empty( $data['timeFormat'] ) && 'default' !== $data['timeFormat'] && 'custom' !== $data['timeFormat'] ) { |
| [569](#L569) | $format = esc\_html( $data['timeFormat'] ); |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) | if ( isset( $data['timeCustom'] ) && ! empty( $data['timeCustom'] ) && isset( $data['timeFormat'] ) && 'custom' === $data['timeFormat'] ) { |
| [573](#L573) | $format = esc\_html( $data['timeCustom'] ); |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | $time = date( $format ); |
| [577](#L577) |  |
| [578](#L578) | return $time; |
| [579](#L579) | } |
| [580](#L580) |  |
| [581](#L581) | /\*\* |
| [582](#L582) | \* Convert Query String to Array. |
| [583](#L583) | \* |
| [584](#L584) | \* @param string $qry URL. |
| [585](#L585) | \* |
| [586](#L586) | \* @return array|bool |
| [587](#L587) | \*/ |
| [588](#L588) | public static function query\_string\_to\_array( $qry ) { |
| [589](#L589) | $result = array(); |
| [590](#L590) |  |
| [591](#L591) | if ( strpos( $qry, '=' ) ) { |
| [592](#L592) | if ( strpos( $qry, '?' ) !== false ) { |
| [593](#L593) | $qry = str\_replace( array( '&#038;', '&amp;' ), '&', $qry ); |
| [594](#L594) | $q   = wp\_parse\_url( $qry ); |
| [595](#L595) | $qry = isset( $q['query'] ) ? $q['query'] : $q['fragment']; |
| [596](#L596) | } |
| [597](#L597) | } else { |
| [598](#L598) | return false; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | foreach ( explode( '&', $qry ) as $couple ) { |
| [602](#L602) | list ( $key, $val ) = array\_pad( explode( '=', $couple ), 2, null ); |
| [603](#L603) | $result[ $key ]     = $val; |
| [604](#L604) | } |
| [605](#L605) |  |
| [606](#L606) | return $result; |
| [607](#L607) | } |
| [608](#L608) |  |
| [609](#L609) | /\*\* |
| [610](#L610) | \* Apply dynamic data. |
| [611](#L611) | \* |
| [612](#L612) | \* @param array $data Dynamic request. |
| [613](#L613) | \* |
| [614](#L614) | \* @return string |
| [615](#L615) | \*/ |
| [616](#L616) | public function apply\_link( $data ) { |
| [617](#L617) | $link = $this->get\_link( $data ); |
| [618](#L618) |  |
| [619](#L619) | if ( empty( $link ) ) { |
| [620](#L620) | $link = get\_site\_url(); |
| [621](#L621) | } |
| [622](#L622) |  |
| [623](#L623) | $attrs = ''; |
| [624](#L624) |  |
| [625](#L625) | if ( isset( $data['target'] ) && '\_blank' === $data['target'] ) { |
| [626](#L626) | $attrs = 'target="\_blank"'; |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) | $value = sprintf( |
| [630](#L630) | '<a href="%s" %s>%s</a>', |
| [631](#L631) | esc\_url( $link ), |
| [632](#L632) | $attrs, |
| [633](#L633) | esc\_html( $data['text'] ) |
| [634](#L634) | ); |
| [635](#L635) |  |
| [636](#L636) | return $value; |
| [637](#L637) | } |
| [638](#L638) |  |
| [639](#L639) | /\*\* |
| [640](#L640) | \* Apply dynamic data for Buttons. |
| [641](#L641) | \* |
| [642](#L642) | \* @param array $data Dynamic request. |
| [643](#L643) | \* |
| [644](#L644) | \* @return string|void |
| [645](#L645) | \*/ |
| [646](#L646) | public function apply\_link\_button( $data ) { |
| [647](#L647) | if ( ! isset( $data[0] ) ) { |
| [648](#L648) | return; |
| [649](#L649) | } |
| [650](#L650) |  |
| [651](#L651) | $data = explode( '#otterDynamicLink', $data[0] ); |
| [652](#L652) | $data = self::query\_string\_to\_array( $data[1] ); |
| [653](#L653) |  |
| [654](#L654) | $link = $this->get\_link( $data ); |
| [655](#L655) |  |
| [656](#L656) | if ( empty( $link ) ) { |
| [657](#L657) | $link = get\_site\_url(); |
| [658](#L658) | } |
| [659](#L659) |  |
| [660](#L660) | return $link; |
| [661](#L661) | } |
| [662](#L662) |  |
| [663](#L663) | /\*\* |
| [664](#L664) | \* Apply dynamic data. |
| [665](#L665) | \* |
| [666](#L666) | \* @param array $data Dynamic request. |
| [667](#L667) | \* |
| [668](#L668) | \* @return string|void |
| [669](#L669) | \*/ |
| [670](#L670) | public function get\_link( $data ) { |
| [671](#L671) | if ( ! isset( $data['type'] ) ) { |
| [672](#L672) | return; |
| [673](#L673) | } |
| [674](#L674) |  |
| [675](#L675) | if ( isset( $data['context'] ) && 'query' === $data['context'] ) { |
| [676](#L676) | $data['context'] = get\_the\_ID(); |
| [677](#L677) | } else { |
| [678](#L678) | $data['context'] = get\_queried\_object\_id(); |
| [679](#L679) | } |
| [680](#L680) |  |
| [681](#L681) | if ( 'postURL' === $data['type'] ) { |
| [682](#L682) | return get\_the\_permalink( $data['context'] ); |
| [683](#L683) | } |
| [684](#L684) |  |
| [685](#L685) | if ( 'siteURL' === $data['type'] ) { |
| [686](#L686) | return get\_site\_url(); |
| [687](#L687) | } |
| [688](#L688) |  |
| [689](#L689) | if ( 'featuredImageURL' === $data['type'] ) { |
| [690](#L690) | return wp\_get\_attachment\_url( get\_post\_thumbnail\_id( $data['context'] ) ); |
| [691](#L691) | } |
| [692](#L692) |  |
| [693](#L693) | if ( 'authorURL' === $data['type'] ) { |
| [694](#L694) | return get\_author\_posts\_url( intval( get\_post\_field( 'post\_author', $data['context'] ) ) ); |
| [695](#L695) | } |
| [696](#L696) |  |
| [697](#L697) | if ( 'authorWebsite' === $data['type'] ) { |
| [698](#L698) | return get\_the\_author\_meta( 'url', intval( get\_post\_field( 'post\_author', $data['context'] ) ) ); |
| [699](#L699) | } |
| [700](#L700) |  |
| [701](#L701) | return apply\_filters( 'otter\_blocks\_evaluate\_dynamic\_content\_link', '', $data ); |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) | /\*\* |
| [705](#L705) | \* Mark the exceptions for Dynamic request. |
| [706](#L706) | \* |
| [707](#L707) | \* Features that are using complex functions like `get\_content` (directly or indirectly) might not behave correctly in every situation. |
| [708](#L708) | \* Based on the context, we decide if it is safe to use those functions.. |
| [709](#L709) | \* |
| [710](#L710) | \* @param array $data Dynamic request. |
| [711](#L711) | \* @return array Dynamic request with marked exceptions. |
| [712](#L712) | \*/ |
| [713](#L713) | public function mark\_exceptions( $data ) { |
| [714](#L714) | if ( 'postExcerpt' === $data['type'] || 'postContent' === $data['type'] ) { |
| [715](#L715) | if ( |
| [716](#L716) | 'valid' === apply\_filters( 'product\_neve\_license\_status', false ) && |
| [717](#L717) | class\_exists( '\Neve\_Pro\Modules\Custom\_Layouts\Module' ) |
| [718](#L718) | ) { |
| [719](#L719) | $post = get\_post( $data['context'] ); |
| [720](#L720) | if ( isset( $post ) && 'neve\_custom\_layouts' === $post->post\_type ) { |
| [721](#L721) | $key = $this->get\_exception\_key( $data, $post->ID ); |
| [722](#L722) | if ( $key ) { |
| [723](#L723) | $data[ $key ] = true; |
| [724](#L724) | } |
| [725](#L725) | } |
| [726](#L726) | } |
| [727](#L727) |  |
| [728](#L728) | if ( 'postContent' === $data['type'] ) { |
| [729](#L729) |  |
| [730](#L730) | // To do not trigger postContent action if the given content contains the postContent dynamic tag, because it will cause an infinite loop. |
| [731](#L731) | $content = get\_the\_content( $data['context'] ); |
| [732](#L732) | if ( isset( $post ) && strpos( $content, 'data-type="postContent"' ) ) { |
| [733](#L733) | $key = $this->get\_exception\_key( $data, $post->ID ); |
| [734](#L734) | if ( $key ) { |
| [735](#L735) | $data[ $key ] = true; |
| [736](#L736) | } |
| [737](#L737) | } |
| [738](#L738) | } |
| [739](#L739) | } |
| [740](#L740) |  |
| [741](#L741) | if ( has\_filter( 'otter\_blocks\_dynamic\_content\_exception' ) ) { |
| [742](#L742) |  |
| [743](#L743) | /\*\* |
| [744](#L744) | \* Gather exceptions for Dynamic request from other plugins via hooks. Before merging the changes, we make sure that critical data is present. |
| [745](#L745) | \*/ |
| [746](#L746) | $data\_exceptions = apply\_filters( 'otter\_blocks\_dynamic\_content\_exception', $data ); |
| [747](#L747) | if ( |
| [748](#L748) | isset( $data\_exceptions ) && |
| [749](#L749) | is\_array( $data\_exceptions ) |
| [750](#L750) | ) { |
| [751](#L751) | $merged = array\_merge( $data, $data\_exceptions ); |
| [752](#L752) |  |
| [753](#L753) | if ( isset( $merged['type'] ) && isset( $merged['context'] ) ) { |
| [754](#L754) | $data = $merged; |
| [755](#L755) | } |
| [756](#L756) | } |
| [757](#L757) | } |
| [758](#L758) |  |
| [759](#L759) | return $data; |
| [760](#L760) | } |
| [761](#L761) |  |
| [762](#L762) | /\*\* |
| [763](#L763) | \* Get the exception key for Dynamic request. |
| [764](#L764) | \* |
| [765](#L765) | \* @param array   $data Dynamic request. |
| [766](#L766) | \* @param numeric $post\_id Post ID. |
| [767](#L767) | \* @return string|null |
| [768](#L768) | \*/ |
| [769](#L769) | public function get\_exception\_key( $data, $post\_id = null ) { |
| [770](#L770) | if ( null == $post\_id ) { |
| [771](#L771) | $post = get\_post( $data['context'] ); |
| [772](#L772) | if ( isset( $post ) ) { |
| [773](#L773) | $post\_id = $post->ID; |
| [774](#L774) | } |
| [775](#L775) | } |
| [776](#L776) |  |
| [777](#L777) | return 'exception\_dynamic\_content\_' . $data['type'] . '\_' . $post\_id; |
| [778](#L778) | } |
| [779](#L779) |  |
| [780](#L780) | /\*\* |
| [781](#L781) | \* The instance method for the static class. |
| [782](#L782) | \* Defines and returns the instance of the static class. |
| [783](#L783) | \* |
| [784](#L784) | \* @static |
| [785](#L785) | \* @since 1.2.0 |
| [786](#L786) | \* @access public |
| [787](#L787) | \* @return Dynamic\_Content |
| [788](#L788) | \*/ |
| [789](#L789) | public static function instance() { |
| [790](#L790) | if ( is\_null( self::$instance ) ) { |
| [791](#L791) | self::$instance = new self(); |
| [792](#L792) | self::$instance->init(); |
| [793](#L793) | } |
| [794](#L794) |  |
| [795](#L795) | return self::$instance; |
| [796](#L796) | } |
| [797](#L797) |  |
| [798](#L798) | /\*\* |
| [799](#L799) | \* Throw error on object clone |
| [800](#L800) | \* |
| [801](#L801) | \* The whole idea of the singleton design pattern is that there is a single |
| [802](#L802) | \* object therefore, we don't want the object to be cloned. |
| [803](#L803) | \* |
| [804](#L804) | \* @access public |
| [805](#L805) | \* @since 1.2.0 |
| [806](#L806) | \* @return void |
| [807](#L807) | \*/ |
| [808](#L808) | public function \_\_clone() { |
| [809](#L809) | // Cloning instances of the class is forbidden. |
| [810](#L810) | \_doing\_it\_wrong( \_\_FUNCTION\_\_, esc\_html\_\_( 'Cheatin&#8217; huh?', 'otter-blocks' ), '1.0.0' ); |
| [811](#L811) | } |
| [812](#L812) |  |
| [813](#L813) | /\*\* |
| [814](#L814) | \* Disable unserializing of the class |
| [815](#L815) | \* |
| [816](#L816) | \* @access public |
| [817](#L817) | \* @since 1.2.0 |
| [818](#L818) | \* @return void |
| [819](#L819) | \*/ |
| [820](#L820) | public function \_\_wakeup() { |
| [821](#L821) | // Unserializing instances of the class is forbidden. |
| [822](#L822) | \_doing\_it\_wrong( \_\_FUNCTION\_\_, esc\_html\_\_( 'Cheatin&#8217; huh?', 'otter-blocks' ), '1.0.0' ); |
| [823](#L823) | } |
| [824](#L824) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/otter-blocks/tags/3.0.6/inc/plugins/class-dynamic-content.php?format=txt)
* [Original Format](/export/3222466/otter-blocks/tags/3.0.6/inc/plugins/class-dynamic-content.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_62cc4e98_20250114_202446.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Otter Blocks – Gutenberg Blocks, Page Builder for Gutenberg Editor & FSE <= 3.0.6 - Unauthetnicated Path Traversal to Arbitrary Image View

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Otter Blocks – Gutenberg Blocks, Page Builder for Gutenberg Editor & FSE <= 3.0.6 - Unauthetnicated Path Traversal to Arbitrary Image View

5.3

**Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-11219](https://www.cve.org/CVERecord?id=CVE-2024-11219) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | November 26, 2024 |
| Last Updated | November 27, 2024 |
| Researcher | [mikemyers](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/michael-mazzolini) |

### Description

The Otter Blocks – Gutenberg Blocks, Page Builder for Gutenberg Editor & FSE plugin for WordPress is vulnerable to Path Traversal in all versions up to, and including, 3.0.6 via the get\_image function. This makes it possible for unauthenticated attackers to view arbitrary images on the server, which can contain sensitive information.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/otter-blocks/tags/3.0.6/inc/plugins/class-dynamic-content.php#L222)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fotter-blocks%2Fotter-blocks-gutenberg-blocks-page-builder-for-gutenberg-editor-fse-306-unauthetnicated-path-traversal-to-arbitrary-image-view&t=Otter%20Blocks%20%E2%80%93%20Gutenberg%20Blocks%2C%20Page%20Builder%20for%20Gutenberg%20Editor%20%26%20FSE%20%3C%3D%203.0.6%20-%20Unauthetnicated%20Path%20Traversal%20to%20Arbitrary%20Image%20View "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fotter-blocks%2Fotter-blocks-gutenberg-blocks-page-builder-for-gutenberg-editor-fse-306-unauthetnicated-path-traversal-to-arbitrary-image-view&text=Otter%20Blocks%20%E2%80%93%20Gutenberg%20Blocks%2C%20Page%20Builder%20for%20Gutenberg%20Editor%20%26%20FSE%20%3C%3D%203.0.6%20-%20Unauthetnicated%20Path%20Traversal%20to%20Arbitrary%20Image%20View "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fotter-blocks%2Fotter-blocks-gutenberg-blocks-page-builder-for-gutenberg-editor-fse-306-unauthetnicated-path-traversal-to-arbitrary-image-view "LinkedIn")
Email

## Vulnerability Details for Otter Blocks – Gutenberg Blocks, Page Builder for Gutenberg Editor & FSE

#### [Otter Blocks – Gutenberg Blocks, Page Builder for Gutenberg Editor & FSE](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/otter-blocks)

| Software Type | Plugin |
| --- | --- |
| Software Slug | otter-blocks [(view on wordpress.org)](https://wordpress.org/plugins/otter-blocks) |
| Patched? | Yes |
| Remediation | Update to version 3.0.7, or a newer patched version |
| Affected Version | * <= 3.0.6 |
| Patched Version | * 3.0.7 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


