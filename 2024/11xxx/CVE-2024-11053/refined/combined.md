=== Content from curl.se_604e5e2d_20250115_190657.html ===

[Docs Overview](/docs/ "Documentation Overview")
[Project](/docs/projdocs.html)
[Bug Bounty](/docs/bugbounty.html)
[Bug Report](/docs/bugs.html)
[Code of conduct](/docs/code-of-conduct.html)
[Dependencies](/docs/libs.html)
[Donate](/donation.html)
[FAQ](/docs/faq.html)
[Features](/docs/features.html)
[Governance](/docs/governance.html)
[History](/docs/history.html)
[Install](/docs/install.html)
[Known Bugs](/docs/knownbugs.html)
[Logo](/logo/)
[TODO](/docs/todo.html)
[website Info](/about.html)

[Protocols](/docs/protdocs.html)
[CA Extract](/docs/caextract.html)
[HTTP cookies](/docs/http-cookies.html)
[HTTP/3](/docs/http3.html)
[MQTT](/docs/mqtt.html)
[SSL certs](/docs/sslcerts.html)
[SSL libs compared](/docs/ssl-compared.html)
[URL syntax](/docs/url-syntax.html)
[WebSocket](/docs/websocket.html)

[Releases](/docs/reldocs.html)
[Changelog](/ch/)
[curl CVEs](/docs/security.html)
[Release Table](/docs/releases.html)
[Version Numbering](/docs/versions.html)
[Vulnerabilities](/docs/vulnerabilities.html)

[Tool](/docs/tooldocs.html)
[Comparison Table](/docs/comparison-table.html)
[curl man page](/docs/manpage.html)
[HTTP Scripting](/docs/httpscripting.html)
[mk-ca-bundle](/docs/mk-ca-bundle.html)
[Tutorial](/docs/tutorial.html)
[When options were added](optionswhen.html)

[Who and Why](/docs/whodocs.html)
[Companies](/docs/companies.html)
[Copyright](/docs/copyright.html)
[Sponsors](/sponsors.html)
[Thanks](/docs/thanks.html)
[The name](/docs/thename.html)

[curl](/) / [Docs](/docs/) / [curl CVEs](/docs/security.html) / **netrc and redirect credential leak**
**Related:**

[Audits](audits.html)

[Bug Bounty](/docs/bugbounty.html)

[Changelog](/ch/)

[curl CVEs](security.html)

[JSON metadata](CVE-2024-11053.json)

[Original report](https://hackerone.com/reports/2829063)

[Vulnerability Disclosure](/dev/vuln-disclosure.html)

[Vulnerabilities Table](vulnerabilities.html)

Awarded 540 USD

## CVE-2024-11053

# netrc and redirect credential leak

Project curl Security Advisory, December 11th 2024 - [Permalink](https://curl.se/docs/CVE-2024-11053.html)

## VULNERABILITY

When asked to both use a `.netrc` file for credentials and
to follow HTTP redirects, curl could leak the password used for the
first host to the followed-to host under certain circumstances.

This flaw only manifests itself if the netrc file has an entry that
matches the redirect target hostname but the entry either omits just the
password or omits both login and password.

## INFO

A curl transfer with `a.tld` that redirects to
`b.tld` that uses a `.netrc` like below (with a
match, but no password specified for the second host), would make curl
pass on `alicespassword` as password even in the second
transfer to the separate host `b.tld`.

```
machine a.tld
  login alice
  password alicespassword
default
  login bob
```

This bug is **not** considered a *C mistake*. It
is not likely to have been avoided had we not been using C.

This flaw also affects the curl command line tool.

The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2024-11053 to this issue.

CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Severity: Low

## AFFECTED VERSIONS

* Affected versions: curl [7.76.0](vuln-7.76.0.html) to and including [8.11.0](vuln-8.11.0.html)
* Not affected versions: curl < [7.76.0](vuln-7.76.0.html) and >= [8.11.1](vuln-8.11.1.html)
* Introduced-in: <https://github.com/curl/curl/commit/46620b97431e19c53ce82e5>

libcurl is used by many applications, but not always advertised as
such!

## SOLUTION

* Fixed-in: <https://github.com/curl/curl/commit/e9b9bbac22c26cf6731>

The fix also addresses a few other .netrc related issues.

## RECOMMENDATIONS

We suggest you take one of the following actions immediately, in
order of preference:

A - Upgrade curl and libcurl to version [8.11.1](vuln-8.11.1.html)

B - Apply the patch to your version and rebuild

C - Avoid using netrc together with redirects

## TIMELINE

This issue was reported to the curl project on November 8, 2024. We
contacted distros@openwall on December 3, 2024.

curl [8.11.1](vuln-8.11.1.html) was released on December 11 2024 around 06:00 UTC,
coordinated with the publication of this advisory.

## CREDITS

* Reported-by: Harry Sintonen
* Patched-by: Daniel Stenberg

Thanks a lot!



=== Content from curl.se_f00c97ae_20250115_190657.html ===
{
"schema\_version": "1.5.0",
"id": "CURL-CVE-2024-11053",
"aliases": [
"CVE-2024-11053"
],
"summary": "netrc and redirect credential leak",
"modified": "2025-01-07T11:28:55.00Z",
"database\_specific": {
"package": "curl",
"URL": "https://curl.se/docs/CVE-2024-11053.json",
"www": "https://curl.se/docs/CVE-2024-11053.html",
"issue": "https://hackerone.com/reports/2829063",
"CWE": {
"id": "CWE-200",
"desc": "Exposure of Sensitive Information to an Unauthorized Actor"
},
"award": {
"amount": "505",
"currency": "USD"
},
"last\_affected": "8.11.0",
"severity": "Low"
},
"published": "2024-12-11T08:00:00.00Z",
"affected": [
{
"ranges": [
{
"type": "SEMVER",
"events": [
{"introduced": "7.76.0"},
{"fixed": "8.11.1"}
]
},
{
"type": "GIT",
"repo": "https://github.com/curl/curl.git",
"events": [
{"introduced": "46620b97431e19c53ce82e55055c85830f088cf4"},
{"fixed": "e9b9bbac22c26cf67316fa8e6c6b9e831af31949"}
]
}
],
"versions": [
"8.11.0", "8.10.1", "8.10.0", "8.9.1", "8.9.0", "8.8.0", "8.7.1",
"8.7.0", "8.6.0", "8.5.0", "8.4.0", "8.3.0", "8.2.1", "8.2.0",
"8.1.2", "8.1.1", "8.1.0", "8.0.1", "8.0.0", "7.88.1", "7.88.0",
"7.87.0", "7.86.0", "7.85.0", "7.84.0", "7.83.1", "7.83.0", "7.82.0",
"7.81.0", "7.80.0", "7.79.1", "7.79.0", "7.78.0", "7.77.0", "7.76.1",
"7.76.0"
]
}
],
"credits": [
{
"name": "Harry Sintonen",
"type": "FINDER"
},
{
"name": "Daniel Stenberg",
"type": "REMEDIATION\_DEVELOPER"
}
],
"details": "When asked to both use a `.netrc` file for credentials and to follow HTTP\nredirects, curl could leak the password used for the first host to the\nfollowed-to host under certain circumstances.\n\nThis flaw only manifests itself if the netrc file has an entry that matches\nthe redirect target hostname but the entry either omits just the password or\nomits both login and password."
}

=== Content from www.openwall.com_709a88f9_20250114_212705.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/12/09/4) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <q901so86-n601-s296-p516-o89p7q69p2n9@unkk.fr>
Date: Wed, 11 Dec 2024 08:27:18 +0100 (CET)
From: Daniel Stenberg <daniel@...x.se>
To: curl security announcements -- curl users <curl-users@...ts.haxx.se>,
    curl-announce@...ts.haxx.se, libcurl hacking <curl-library@...ts.haxx.se>,
    oss-security@...ts.openwall.com
Subject: [SECURITY ADVISORY] curl: CVE-2024-11053: netrc and redirect credential
 leak

netrc and redirect credential leak
==================================

Project curl Security Advisory, December 11th 2024 -
[Permalink](<https://curl.se/docs/CVE-2024-11053.html>)

VULNERABILITY
-------------

When asked to both use a `.netrc` file for credentials and to follow HTTP
redirects, curl could leak the password used for the first host to the
followed-to host under certain circumstances.

This flaw only manifests itself if the netrc file has an entry that matches
the redirect target hostname but the entry either omits just the password or
omits both login and password.

INFO
----

A curl transfer with `a.tld` that redirects to `b.tld` that uses a `.netrc`
like below (with a match, but no password specified for the second host),
would make curl pass on `alicespassword` as password even in the second
transfer to the separate host `b.tld`.

~~~
machine a.tld
   login alice
   password alicespassword

default
   login bob
~~~

This bug is **not** considered a *C mistake*. It is not likely to have been
avoided had we not been using C.

This flaw also affects the curl command line tool.

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2024-11053 to this issue.

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

Severity: Low

AFFECTED VERSIONS
-----------------

- Affected versions: curl 6.5 to and including 8.11.0
- Not affected versions: curl < 6.5 and >= 8.11.1
- Introduced-in: <https://github.com/curl/curl/commit/ae1912cb0d494b48d514>

libcurl is used by many applications, but not always advertised as such!

SOLUTION
------------

- Fixed-in: <https://github.com/curl/curl/commit/e9b9bbac22c26cf6731>

The fix also addresses a few other .netrc related issues.

RECOMMENDATIONS
---------------

We suggest you take one of the following actions immediately, in order of
preference:

  A - Upgrade curl and libcurl to version 8.11.1

  B - Apply the patch to your version and rebuild

  C - Avoid using netrc together with redirects

TIMELINE
---------

This issue was reported to the curl project on November 8, 2024. We contacted
distros@...nwall on December 3, 2024.

curl 8.11.1 was released on December 11 2024 around 06:00 UTC, coordinated
with the publication of this advisory.

CREDITS
-------

- Reported-by: Harry Sintonen
- Patched-by: Daniel Stenberg

Thanks a lot!

--

  / daniel.haxx.se

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


