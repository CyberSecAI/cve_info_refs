=== Content from ctfd.io_16ee0c53_20250114_232004.html ===

[[![](/static/img/ctfd.svg)](/)](/)

* [Features](/features)
* [Pricing](/pricing)
* [Enterprise](/enterprise)
* [Store](/store)
* [Contact](/contact)
* [Login](https://cloud.ctfd.io/login)
* [Sign
  Up](https://cloud.ctfd.io/signup)

![](/static/img/core/score-board.png)

# Cyber Security Training made simple

#### With the best Capture The Flag platform

[What's a Capture The Flag?](/whats-a-ctf)

## Trusted by

|  |  |  |  |
| --- | --- | --- | --- |
|  |  |  |  |

[Read our case studies](/case-studies)

![](/static/img/core/challenges/puppers-standard-challenge.png)
> A simple challenge

![](/static/img/core/challenges/reverse-code-challenge.png)
> Ask your users to program too!

![](/static/img/core/challenges/trivia-multiple-challenge.png)
> Classic multiple choice questions

## Build your own cyber security workshop

---

Design your own questions. Understand where your students excel and where they might need to improve.

Creating light competition drives users to out-do one another on the public scoreboard and share techniques.

[Custom Workshops](/workshops)

![](/static/img/services-docker.png)

## Easily deploy your challenges on

## our hosted platform

---

Our custom designed challenge workflow makes it easy to deploy your Docker based challenges.

It's as easy as `docker push`

[Read More >>>](/challenge-deployment)

# Managed hosting from $50 / month

[Deploy Instantly](/hosting)
[Try a Demo](https://demo.ctfd.io)

CTFd is free, open source software.

[Install from source code](https://github.com/CTFd/CTFd)

> ![](/static/img/nharbour.png)
>
> “We struggled with our own infrastructure for a few years before switching to CTFd.
>
>
>
>
> We anticipated that the slick interface, easy configuration, and stability would be a big win for us, but what surprised us was what we weren’t expecting: **our data got better.**
>
>
>
>
> We finally got accurate stats and were able to **seamlessly collect the data we need for global recruitment**. CTFd has made it easier for us to scout blue-chip prospects and elite veteran tech talent for our company.”
>
> Nick Harbour, FireEye

![](/static/img/core/private-team-profile.png)

## Track user progress with easy graphs

---

Visualize your users with their skill graphs.

With easy to use visualizations, you can quickly infer the state of a team without getting into the nitty gritty..

> ![](/static/img/jhaddix.png)
>
> “No longer are you **bogged down** with the task of creating the scoring, registration, administration, challenge modals, and all auxiliary applications, you can **focus on what matters**; challenges and learning objectives!”
>
> Jason Haddix, Head of Trust and Security, Bugcrowd

![](/static/img/core/challenge-update-modal.png)

## Easily add content and manage users

---

The administration panel gives you the ability to manage teams on the fly.

Send messages, edit team information, create new pages, add new challenges, and lots of other features are available to admins.

You can also customize CTFd with themes and plugins for infinite customizability on a rock solid base.

* ###### Company
* [About](/about)
* [Blog](https://blog.ctfd.io)
* [Careers](/careers)
* [Documentation](https://docs.ctfd.io)
* [Get Involved](https://github.com/CTFd/CTFd/issues)
* [Status](https://status.ctfd.io)
* [Terms of Use](/terms-of-use)
* [Privacy Policy](/privacy-policy)

* ###### Contact Details
* [Contact Form](/contact)
* [Email](/cdn-cgi/l/email-protection#45363035352a373105263123216b2c2a)
* [Mailing List](https://newsletters.ctfd.io/lists/ot889gr1sa0e1/subscribe)

* ###### Social Media
* [Twitter](https://twitter.com/ctfdio)
* [Facebook](https://facebook.com/ctfdio)
* [Github](https://github.com/CTFd)

© Copyright CTFd LLC 2017 - 2024

Built with ❤️  in New York City



=== Content from seclists.org_abe72bab_20250114_232007.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
![Next](/images/right-icon-16x16.png)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
![Next](/images/right-icon-16x16.png)

![](/shared/images/nst-icons.svg#search)

# Multiple vulnerabilities in CTFd versions <= 3.7.4

---

*From*: Blazej Adamczyk <blazej.adamczyk () gmail com>

*Date*: Tue, 24 Dec 2024 12:28:40 +0100

---

```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Multiple vulnerabilities in CTFd versions <= 3.7.4
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1 General information
═════════════════════

  Multiple vulnerabilities in CTFd versions <= 3.7.4 allows a remote
  attacker who acquired user’s activation or password reset link (e.g.
  from browser history) to hijack victim’s account. Other vulnerability
  allows the user to pass access control and change an already set
  bracket.

  Product name: CTFd

  Website: <<https://ctfd.io>>

  Product description: CTFd is a Capture The Flag framework focusing on
  ease of use and customizability. It comes with everything you need to
  run a CTF and it's easy to customize with plugins and themes.

2 [Vulnerability #1] User can change the bracket without administrator
══════════════════════════════════════════════════════════════════════

2.1 CVE
───────

  CVE-2024-11716

2.2 Affected versions
─────────────────────

  CTFd (<<https://ctfd.io>>) versions <= 3.7.4

2.3 CVSSv4
──────────

  5.3 Medium
  (CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N)

2.4 Description
───────────────

  CTFd offers scoreboard bracket function where users can be assigned to
  a bracket and are scoring is grouped by brackets. The function allows
  the user to pick a bracket once at start. It seems the logic's
  intention is to not allow the user to change the bracket when it was
  already assigned:

  ┌────
  │ 195  @pre_load
  │ 196  def validate_bracket_id(self, data):
  │ 197      bracket_id = data.get("bracket_id")
  │ 198      if bracket_id is None:
  │ 199          return
  │ 200
  │ 201      current_user = get_current_user()
  │ 202      if is_admin():
  │ 203          bracket = Brackets.query.filter_by(id=bracket_id, type="users").first()
  │ 204          if bracket is None:
  │ 205              ValidationError(
  │ 206                  "Please provide a valid bracket id", field_names=["bracket_id"]
  │ 207              )
  │ 208      else:
  │ 209          if (
  │ 210              current_user.bracket_id == int(bracket_id)
  │ 211              or current_user.bracket_id is None
  │ 212          ):
  │ 213              bracket = Brackets.query.filter_by(id=bracket_id, type="users").first()
  │ 214              if bracket is None:
  │ 215                  ValidationError(
  │ 216                      "Please provide a valid bracket id", field_names=["bracket_id"]
  │ 217                  )
  │ 218          else:
  │ 219              raise ValidationError(
  │ 220                  "Please contact an admin to change your bracket",
  │ 221                  field_names=["bracket_id"],
  │ 222              )
  └────
  Listing 1: CTFd/schemas/users.py

  Please note in lines 210-211 the code verifies if user has changed the
  bracket_id and if so raises an error stating that only administrator
  can do so.

  This validation suggests the system treats this as a security control
  and does not allow to switch brackets. Some setups/deployments might
  assume trust to this function.

  The user can however *bypass the check* by:
  1. First saving user details with bracket_id=null - GUI blocks this
     but API allows according to line 198. E.g.
     ┌────
     │ curl '[http://ctfd/api/v1/users/me'](http://ctfd/api/v1/users/me%26apos); --H 'Content-Type: application/json' \
     │      -H 'Content-Type: application/json' -H "CSRF-Token: $CSRF" \
     │       --data-raw '{"name":"test","email":"t () t pl","bracket_id":null,"fields":[]}'
     └────
  2. Second saving again with the proper changed bracket_id - this will
     be allowed according to line 211. This can be done normally in GUI.

2.5 PoC example
───────────────

  Some contests can use the scoreboard bracket system to group users
  into different prize pools. Having the possibility to change the
  bracket might end up with cheating and getting the prize.

2.6 Solution
────────────

  It should not be possible to change an already set bracket to null and
  this should be verified in the API (backend) OR (if the security
  control is simply wrong) there should be no ValidationError in order
  not to confuse CTFd implementers.

  Fixed in: <<https://github.com/CTFd/CTFd/pull/2636>>

3 [Vulnerability #2] Multiple vulnerabilities in token handling
═══════════════════════════════════════════════════════════════

3.1 CVE
───────

  CVE-2024-11717

3.2 Affected versions
─────────────────────

  CTFd (<<https://ctfd.io>>) versions <= 3.7.4

3.3 CVSSv4
──────────

  6.3 Medium
  (CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N)

3.4 Description
───────────────

3.4.1 [Vulnerability #2.1] Account activation and password reset tokens can be interchanged
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  CTFd uses the "itsdangerous" python package for creating activation
  and password reset tokens. In both cases it is done by signing user's
  e-mail address with timestamp with the system's secret_key.

  The generated token is directly used in URL sent to the user over
  e-mail. During token validation, in both activation and password
  reset, the system is checking if the HMAC signature is correct and if
  the token was not created more than 1800s (30min) ago. Then the system
  verifies if the signed value matches any user's e-mail address. The
  matched user is being either activated or setting new password is
  being permitted.

  The tokens for both use cases have exactly the same construction and
  can be used interchangeably. Particularly, activation token can be
  used in reset password function which is pretty dangerous especially
  when the user registers and the token was used in GET request what
  means it can be stored in many places - browser's history, proxy
  access logs, and so on. An attacker gaining access to such token
  within the expiration time can use it to gain control of the victim's
  account.

  Connected with the vulnerability #3 the impact is even more visible as
  the token can be reused many times and cannot be revoked by the user
  until it expires.

3.4.2 [Vulnerability #2.2] Account activation and password reset tokens are not single-use
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  The described above mechanism of token generation is stateless. This
  means tokens are not single-use and can be used withing the expiration
  timeout (30min) multiple times.

  Tokens sent in URL can be stored in many places - e-mail, browser's
  history, proxy access logs and so on. An attacker gaining access to
  such token within the expiration time can use it to gain control of
  the victim's account.

3.4.3 [Vulnerability #2.3] Email in token sent in GET requests
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  The tokens for resetting password and activating account have base64
  encoded email address of the user in plain text. They are opened via
  GET requests which means can be stored in many places and thus may
  leak user's email address.

3.5 PoC example
───────────────

  High school and university students are encouraged to participate in a
  CTF. They read this info on classes and are registering to the CTF
  using a university/school computer (e.g. during classes).

  The attack does not depend on email access:
  1. Victim registers to CTF.
  2. Victim logs into e-mail account and clicks the link.
  3. Victim logs out of CTFd and e-mail account.
  4. Attacker looks up browser history, takes the token and base64
     decodes email address (vuln #4).
  5. Attacker within 30 minutes takes the activation token and reuses it
     to reset victim's password (vuln #2 and vuln #3).

3.6 Solution
────────────

  To fix all 3 vulnerabilities it would be good to change the tokens to
  random numbers (no email) stored in Redis cache and use keys
  distinguishing the action type (activation vs reset password). After
  usage the token can be removed from Redis thus making the tokens
  single-use.

  Fixed in: <<https://github.com/CTFd/CTFd/pull/2679>>

4 Timeline
══════════

  • 09.10.2024 - Initial contact with vendor about encryption public key.
  • 12.10.2024 - Reported the issue over unencrypted e-mail (vendor is
    not offering any encryption means of vulnerability reports at the
    moment - see issue <<https://github.com/CTFd/CTFd/issues/2622>>)
  • 14.10.2024 - Fixed CVE-2024-11716 in
    <<https://github.com/CTFd/CTFd/pull/2636>>
  • 12-15.10.2024 - Discussion of the reported issues over email.
  • 23.12.2024 - Fixed CVE-2024-11717 in
    <<https://github.com/CTFd/CTFd/pull/2679>>

5 Vendor response
═════════════════

  Special thanks to Kevin Chung (ColdHeat) from CTFd for fast response
  and fixes.

6 References
════════════

  • <<https://sploit.tech/2024/12/24/CTFd.html>> - details
  • <<https://cert.pl/en/posts/2024/12/CVE-2024-11716>> - Advisory
  • <<https://github.com/CTFd/CTFd>> - CTFd github repository

7 Credits
═════════

  Author: Blazej Adamczyk (br0x) | <<https://sploit.tech/>>

  Team: Efigo <<https://efigo.pl/>>

```

**Attachment:
[signature.asc](att-21/signature_asc.bin)**

*Description:* This is a digitally signed message part

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
![Next](/images/right-icon-16x16.png)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
![Next](/images/right-icon-16x16.png)

### Current thread:

* **Multiple vulnerabilities in CTFd versions <= 3.7.4** *Blazej Adamczyk (Dec 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from cert.pl_05d6ef8c_20250114_232003.html ===


[Report an incident](https://incydent.cert.pl/#!/lang=en)

Back

* You're in the menu
* About us
  + About us
  + [About our team](../../../../about-us/)
  + [Contact](../../../../contact/)
* [News](../../../../news/)
* For experts
  + For experts
  + [News](../../../../news/)
  + [Publications](../../../../publications/)
  + [The Warning List](../../../../warning-list/)
  + Projects
  + [n6](../../../../n6/)
  + [Artemis](/en/posts/2024/01/artemis-security-scanner/)
  + [MWDB](https://mwdb.cert.pl/)
  + CVD program
  + [CVD policy](../../../../cvd)
  + [Advisories](../../../../cve)

* About us
* [News](../../../../news/)
* For experts

[Report an incident](https://incydent.cert.pl/#!/lang=en)

About us
[About our team](../../../../about-us/)
[Contact](../../../../contact/)

Baza wiedzy
[FaÅszywe inwestycje](/falszywe-inwestycje)
[UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
[FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
[FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
[FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÅstwa OUCH!](/ouch)

For experts
[Publications](../../../../publications/)
[The Warning List](../../../../warning-list/)

Projects
[n6](../../../../n6/)
[Artemis](/en/posts/2024/01/artemis-security-scanner/)
[MWDB](https://mwdb.cert.pl/)

CVD program
[CVD policy](../../../../cvd)
[Advisories](../../../../cve)

Vulnerabilities in CTFd software

02 January 2025
| [CERT Polska](../../../../author/cert-polska/) | [#vulnerability](../../../../tag/vulnerability/), [#warning](../../../../tag/warning/), [#cve](../../../../tag/cve/)

| **CVE ID** | [CVE-2024-11716](https://www.cve.org/CVERecord?id=CVE-2024-11716) |
| --- | --- |
| **Publication date** | 02 January 2025 |
| **Vendor** | CTFd |
| **Product** | CTFd |
| **Vulnerable versions** | From 3.7.0 through 3.7.4 |
| **Vulnerability type (CWE)** | Improper Enforcement of a Single, Unique Action ([CWE-837](https://cwe.mitre.org/data/definitions/837.html)) |
| **Report source** | Report to CERT Polska |
| **CVE ID** | [CVE-2024-11717](https://www.cve.org/CVERecord?id=CVE-2024-11717) |
| --- | --- |
| **Publication date** | 02 January 2025 |
| **Vendor** | CTFd |
| **Product** | CTFd |
| **Vulnerable versions** | All through 3.7.4 |
| **Vulnerability type (CWE)** | Improper Enforcement of a Single, Unique Action ([CWE-837](https://cwe.mitre.org/data/definitions/837.html)) |
| **Report source** | Report to CERT Polska |

## Description

CERT Polska has received a report about vulnerabilities in CTFd software and participated in coordination of their disclosure.

While assignment of a user to a team (bracket) in CTFd should be possible only once, at the registration, a flaw in logic implementation allows an authenticated user to reset it's bracket and then pick a new one, joining another team while a competition is already ongoing.
This issue was assigned [CVE-2024-11716](https://www.cve.org/CVERecord?id=CVE-2024-11716). It impacts releases from 3.7.0 up to 3.7.4 and was addressed by [pull request 2636](https://github.com/CTFd/CTFd/pull/2636) included in 3.7.5 release.

Tokens in CTFd used for account activation and password resetting can be used interchangeably for these operations. When used, they are sent to the server as a GET parameter and they are not single use, which means, that during token expiration time an on-path attacker might reuse such a token to change user's password and take over the account. Moreover, the tokens also include base64 encoded user email.
This issue was assigned [CVE-2024-11717](https://www.cve.org/CVERecord?id=CVE-2024-11717). It impacts all releases up to 3.7.4 and was addressed by [pull request 2679](https://github.com/CTFd/CTFd/pull/2679) included in 3.7.5 release.

The researcher has published technical details under [the following link](https://seclists.org/fulldisclosure/2024/Dec/21).

## Credits

We thank BÅaÅ¼ej Adamczyk (efigo.pl) for the responsible vulnerability report.

---

More about the coordinated vulnerability disclosure process at CERT Polska can be found at [https://cert.pl/en/cvd/](https://cert.pl/cvd/).

CERT Polska is a team operating within the structures of NASK - National Research Institute,
established in 1996 to respond to computer security incidents. It carries out the role of
CSIRT NASK, one of three such teams operating at the national level within the Polish national
cybersecurity system.

# Social media

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska_en)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Contact

Address: Kolska 12, 01-045 Warsaw, Poland

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÄczenia: AE:PL-60057-61611-BCEGR-11

E-mail: [[email protected]](/cdn-cgi/l/email-protection#533a3d353c13303621277d233f)

Incident reporting: [incydent.cert.pl](https://incydent.cert.pl/#!/lang=en)

[[email protected]](/cdn-cgi/l/email-protection#593a3c2b2d193a3c2b2d772935)

![Co-financed by the Connecting Europe Facility of The European Union](/theme/assets/img/ue-en.png)

* Â© 2025 [NASK](https://nask.pl/)
* [Privacy policy](/uploads/misc/privacy-policy-en.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)



=== Content from github.com_94820592_20250115_205041.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2636)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2636)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=CTFd%2FCTFd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CTFd](/CTFd)
/
**[CTFd](/CTFd/CTFd)**
Public

* [Notifications](/login?return_to=%2FCTFd%2FCTFd) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2FCTFd%2FCTFd)
* [Star
   5.8k](/login?return_to=%2FCTFd%2FCTFd)

* [Code](/CTFd/CTFd)
* [Issues
  290](/CTFd/CTFd/issues)
* [Pull requests
  64](/CTFd/CTFd/pulls)
* [Actions](/CTFd/CTFd/actions)
* [Projects
  0](/CTFd/CTFd/projects)
* [Wiki](/CTFd/CTFd/wiki)
* [Security](/CTFd/CTFd/security)
* [Insights](/CTFd/CTFd/pulse)

Additional navigation options

* [Code](/CTFd/CTFd)
* [Issues](/CTFd/CTFd/issues)
* [Pull requests](/CTFd/CTFd/pulls)
* [Actions](/CTFd/CTFd/actions)
* [Projects](/CTFd/CTFd/projects)
* [Wiki](/CTFd/CTFd/wiki)
* [Security](/CTFd/CTFd/security)
* [Insights](/CTFd/CTFd/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FCTFd%2FCTFd%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FCTFd%2FCTFd%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix issue where users could set their own bracket after registration #2636

 Merged

[ColdHeat](/ColdHeat)
merged 3 commits into
[master](/CTFd/CTFd/tree/master "CTFd/CTFd:master")
from
[prevent-self-bracket-switching](/CTFd/CTFd/tree/prevent-self-bracket-switching "CTFd/CTFd:prevent-self-bracket-switching")

Oct 14, 2024

 Merged

# [Fix issue where users could set their own bracket after registration](#top) #2636

[ColdHeat](/ColdHeat)
merged 3 commits into
[master](/CTFd/CTFd/tree/master "CTFd/CTFd:master")
from
[prevent-self-bracket-switching](/CTFd/CTFd/tree/prevent-self-bracket-switching "CTFd/CTFd:prevent-self-bracket-switching")

Oct 14, 2024

[Conversation
0](/CTFd/CTFd/pull/2636)
[Commits
3](/CTFd/CTFd/pull/2636/commits)
[Checks
7](/CTFd/CTFd/pull/2636/checks)
[Files changed](/CTFd/CTFd/pull/2636/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ColdHeat](https://avatars.githubusercontent.com/u/166333?s=60&v=4)](/ColdHeat)

Copy link

Member

### @ColdHeat **[ColdHeat](/ColdHeat)** commented [Oct 14, 2024](#issue-2586920391)

* Fix issue where users/teams could set their own bracket after registration

Sorry, something went wrong.

All reactions

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Fix issue where users could set their own bracket after registration](/CTFd/CTFd/pull/2636/commits/b603d0fd69bc0df78ca1096348975a6f39f012d1 "Fix issue where users could set their own bracket after registration")`

`[b603d0f](/CTFd/CTFd/pull/2636/commits/b603d0fd69bc0df78ca1096348975a6f39f012d1)`

 [![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)
[ColdHeat](/ColdHeat)
marked this pull request as ready for review
[October 14, 2024 19:56](#event-14645306377)

 [ColdHeat](/ColdHeat)
added 2 commits
[October 14, 2024 16:13](#commits-pushed-833d411)

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Remove bracket_id instead of raising error](/CTFd/CTFd/pull/2636/commits/833d411d03ead2b8f566ea06b5288d23e887ccfe "Remove bracket_id instead of raising error")`

`[833d411](/CTFd/CTFd/pull/2636/commits/833d411d03ead2b8f566ea06b5288d23e887ccfe)`

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Remove bracket_id properly](/CTFd/CTFd/pull/2636/commits/4439d0ff02d2a93e5e9d9ca14a8cdc74d4c1e856 "Remove bracket_id properly")`

`[4439d0f](/CTFd/CTFd/pull/2636/commits/4439d0ff02d2a93e5e9d9ca14a8cdc74d4c1e856)`

 Hide details
View details

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)
[ColdHeat](/ColdHeat)
merged commit [`7e0f6ca`](/CTFd/CTFd/commit/7e0f6ca151874ec671c545074a33b67d69ee3165)
into
master

[Oct 14, 2024](https://github.com/CTFd/CTFd/pull/2636#event-14646073493)
7 checks passed

 [![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)
[ColdHeat](/ColdHeat)
deleted the
prevent-self-bracket-switching

branch
[October 14, 2024 21:41](#event-14646621337)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2636)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=52&v=4)](/ColdHeat)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from ctfd.io_93dd2932_20250115_205040.html ===

[[![](/static/img/ctfd.svg)](/)](/)

* [Features](/features)
* [Pricing](/pricing)
* [Enterprise](/enterprise)
* [Store](/store)
* [Contact](/contact)
* [Login](https://cloud.ctfd.io/login)
* [Sign
  Up](https://cloud.ctfd.io/signup)

![](/static/img/core/score-board.png)

# Cyber Security Training made simple

#### With the best Capture The Flag platform

[What's a Capture The Flag?](/whats-a-ctf)

## Trusted by

|  |  |  |  |
| --- | --- | --- | --- |
|  |  |  |  |

[Read our case studies](/case-studies)

![](/static/img/core/challenges/puppers-standard-challenge.png)
> A simple challenge

![](/static/img/core/challenges/reverse-code-challenge.png)
> Ask your users to program too!

![](/static/img/core/challenges/trivia-multiple-challenge.png)
> Classic multiple choice questions

## Build your own cyber security workshop

---

Design your own questions. Understand where your students excel and where they might need to improve.

Creating light competition drives users to out-do one another on the public scoreboard and share techniques.

[Custom Workshops](/workshops)

![](/static/img/services-docker.png)

## Easily deploy your challenges on

## our hosted platform

---

Our custom designed challenge workflow makes it easy to deploy your Docker based challenges.

It's as easy as `docker push`

[Read More >>>](/challenge-deployment)

# Managed hosting from $50 / month

[Deploy Instantly](/hosting)
[Try a Demo](https://demo.ctfd.io)

CTFd is free, open source software.

[Install from source code](https://github.com/CTFd/CTFd)

> ![](/static/img/nharbour.png)
>
> “We struggled with our own infrastructure for a few years before switching to CTFd.
>
>
>
>
> We anticipated that the slick interface, easy configuration, and stability would be a big win for us, but what surprised us was what we weren’t expecting: **our data got better.**
>
>
>
>
> We finally got accurate stats and were able to **seamlessly collect the data we need for global recruitment**. CTFd has made it easier for us to scout blue-chip prospects and elite veteran tech talent for our company.”
>
> Nick Harbour, FireEye

![](/static/img/core/private-team-profile.png)

## Track user progress with easy graphs

---

Visualize your users with their skill graphs.

With easy to use visualizations, you can quickly infer the state of a team without getting into the nitty gritty..

> ![](/static/img/jhaddix.png)
>
> “No longer are you **bogged down** with the task of creating the scoring, registration, administration, challenge modals, and all auxiliary applications, you can **focus on what matters**; challenges and learning objectives!”
>
> Jason Haddix, Head of Trust and Security, Bugcrowd

![](/static/img/core/challenge-update-modal.png)

## Easily add content and manage users

---

The administration panel gives you the ability to manage teams on the fly.

Send messages, edit team information, create new pages, add new challenges, and lots of other features are available to admins.

You can also customize CTFd with themes and plugins for infinite customizability on a rock solid base.

* ###### Company
* [About](/about)
* [Blog](https://blog.ctfd.io)
* [Careers](/careers)
* [Documentation](https://docs.ctfd.io)
* [Get Involved](https://github.com/CTFd/CTFd/issues)
* [Status](https://status.ctfd.io)
* [Terms of Use](/terms-of-use)
* [Privacy Policy](/privacy-policy)

* ###### Contact Details
* [Contact Form](/contact)
* [Email](/cdn-cgi/l/email-protection#a3d0d6d3d3ccd1d7e3c0d7c5c78dcacc)
* [Mailing List](https://newsletters.ctfd.io/lists/ot889gr1sa0e1/subscribe)

* ###### Social Media
* [Twitter](https://twitter.com/ctfdio)
* [Facebook](https://facebook.com/ctfdio)
* [Github](https://github.com/CTFd)

© Copyright CTFd LLC 2017 - 2024

Built with ❤️  in New York City



=== Content from blog.ctfd.io_584c86d7_20250114_232002.html ===

[![Logo](https://blog.ctfd.io/content/images/2020/09/logo.png)](https://blog.ctfd.io "Home")

* [Home](https://blog.ctfd.io/)

* [@ctfdio](https://twitter.com/ctfdio "@ctfdio")
* [ctfdio](https://www.facebook.com/ctfdio "ctfdio")
* Search

Menu

Article
# CTFd 3.7.5

[![Kevin Chung](/content/images/2020/12/166333.jpeg)](/author/kevin/)

#### [Kevin Chung](/author/kevin/)

30 Dec 2024 • 1 min read

CTFd 3.7.5 has been released with a security fix for an issue where a user could change their own bracket after registration. Depending on how brackets are used this could affect external systems/processes that relied on the integrity of bracket assignments.

CTFd 3.7.5 also converts email confirmation and reset password tokens to be single use and not interchangeable. This mitigates the possibility of a man-in-the-middle attacker re-using a token before the 30 minute expiration.

We recommend all CTFd users update their instance to v3.7.5.

v3.7.5 has already been deployed to Hosted CTFd customers. Self-hosted users can download the latest version of CTFd from [Github](https://github.com/CTFd/CTFd/releases/tag/3.7.4?ref=blog.ctfd.io).

Share

Show Comments

[## CTFd 3.7.4

CTFd 3.7.4 has been released with a security fix for…

14 Oct 2024](/ctfd-3-7-4/)

#### Topics

[release: 4](/tag/release/)
[News: 1](/tag/news/)
[security: 1](/tag/security/)
[oss: 1](/tag/oss/)
[tourist: 1](/tag/tourist/)

CTFd Blog © 2025
Published with [Ghost](https://ghost.org) • Theme [Attila](https://github.com/zutrinken/attila) • System theme



=== Content from github.com_3c2aa580_20250115_205042.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2679)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2679)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=CTFd%2FCTFd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CTFd](/CTFd)
/
**[CTFd](/CTFd/CTFd)**
Public

* [Notifications](/login?return_to=%2FCTFd%2FCTFd) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2FCTFd%2FCTFd)
* [Star
   5.8k](/login?return_to=%2FCTFd%2FCTFd)

* [Code](/CTFd/CTFd)
* [Issues
  290](/CTFd/CTFd/issues)
* [Pull requests
  64](/CTFd/CTFd/pulls)
* [Actions](/CTFd/CTFd/actions)
* [Projects
  0](/CTFd/CTFd/projects)
* [Wiki](/CTFd/CTFd/wiki)
* [Security](/CTFd/CTFd/security)
* [Insights](/CTFd/CTFd/pulse)

Additional navigation options

* [Code](/CTFd/CTFd)
* [Issues](/CTFd/CTFd/issues)
* [Pull requests](/CTFd/CTFd/pulls)
* [Actions](/CTFd/CTFd/actions)
* [Projects](/CTFd/CTFd/projects)
* [Wiki](/CTFd/CTFd/wiki)
* [Security](/CTFd/CTFd/security)
* [Insights](/CTFd/CTFd/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FCTFd%2FCTFd%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FCTFd%2FCTFd%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Convert confirmation & reset password emails to single use #2679

 Merged

[ColdHeat](/ColdHeat)
merged 7 commits into
[master](/CTFd/CTFd/tree/master "CTFd/CTFd:master")
from
[single-use-email-tokens](/CTFd/CTFd/tree/single-use-email-tokens "CTFd/CTFd:single-use-email-tokens")

Dec 23, 2024

 Merged

# [Convert confirmation & reset password emails to single use](#top) #2679

[ColdHeat](/ColdHeat)
merged 7 commits into
[master](/CTFd/CTFd/tree/master "CTFd/CTFd:master")
from
[single-use-email-tokens](/CTFd/CTFd/tree/single-use-email-tokens "CTFd/CTFd:single-use-email-tokens")

Dec 23, 2024

[Conversation
7](/CTFd/CTFd/pull/2679)
[Commits
7](/CTFd/CTFd/pull/2679/commits)
[Checks
8](/CTFd/CTFd/pull/2679/checks)
[Files changed](/CTFd/CTFd/pull/2679/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ColdHeat](https://avatars.githubusercontent.com/u/166333?s=60&v=4)](/ColdHeat)

Copy link

Member

### @ColdHeat **[ColdHeat](/ColdHeat)** commented [Dec 15, 2024](#issue-2740303021)

* Convert confirmation & reset password emails to single use by storing the email tokens in caching

Sorry, something went wrong.

All reactions

 [ColdHeat](/ColdHeat)
added 2 commits
[December 15, 2024 00:58](#commits-pushed-d240de1)

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Convert confirmation & reset password emails to single use](/CTFd/CTFd/pull/2679/commits/d240de1d500f521e49f491d7739f8963993758b9 "Convert confirmation & reset password emails to single use")`

`[d240de1](/CTFd/CTFd/pull/2679/commits/d240de1d500f521e49f491d7739f8963993758b9)`

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Properly use timeout variable](/CTFd/CTFd/pull/2679/commits/df5ae6b73af0444e87c4ef9dab2b65c6671f9406 "Properly use timeout variable")`

`[df5ae6b](/CTFd/CTFd/pull/2679/commits/df5ae6b73af0444e87c4ef9dab2b65c6671f9406)`

[![br0xpl](https://avatars.githubusercontent.com/u/6824163?s=60&v=4)](/br0xpl)

**[br0xpl](/br0xpl)**
reviewed
[Dec 18, 2024](#pullrequestreview-2511776124)

 [View reviewed changes](/CTFd/CTFd/pull/2679/files/df5ae6b73af0444e87c4ef9dab2b65c6671f9406)

[CTFd/utils/security/email.py](/CTFd/CTFd/pull/2679/files/df5ae6b73af0444e87c4ef9dab2b65c6671f9406#diff-0d946322f43a6471ab23822aaebcc0797098afc78491b999155b63f5430555ce)
Outdated

Show resolved

Hide resolved

 [ColdHeat](/ColdHeat)
added 4 commits
[December 18, 2024 11:54](#commits-pushed-fc0247a)

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Switch to using a random nonce](/CTFd/CTFd/pull/2679/commits/fc0247a2868b5844fe2bb1febe152c008a547694 "Switch to using a random nonce")`

`[fc0247a](/CTFd/CTFd/pull/2679/commits/fc0247a2868b5844fe2bb1febe152c008a547694)`

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Fix tests](/CTFd/CTFd/pull/2679/commits/bd7a1d5e63a17d86160402661a76f8ee537301fe "Fix tests")`

`[bd7a1d5](/CTFd/CTFd/pull/2679/commits/bd7a1d5e63a17d86160402661a76f8ee537301fe)`

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Add tests for testing that email links are single use and email token…](/CTFd/CTFd/pull/2679/commits/1153fc994d94e941042e84ecf011ff9aeb205038 "Add tests for testing that email links are single use and email tokens are unique")`
 …

`[1153fc9](/CTFd/CTFd/pull/2679/commits/1153fc994d94e941042e84ecf011ff9aeb205038)`

```
…s are unique
```

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Make single use test a little better](/CTFd/CTFd/pull/2679/commits/30ae0d5756e114bf09c6eab6cbcc052ffea98c15 "Make single use test a little better")`

`[30ae0d5](/CTFd/CTFd/pull/2679/commits/30ae0d5756e114bf09c6eab6cbcc052ffea98c15)`

[![@br0xpl](https://avatars.githubusercontent.com/u/6824163?s=80&v=4)](/br0xpl)

Copy link

Contributor

### **[br0xpl](/br0xpl)** commented [Dec 19, 2024](#issuecomment-2553089733) • edited Loading

| [@ColdHeat](https://github.com/ColdHeat), one more thing: to be honest I don't know if we need to authenticate the tokens at all (hmac), two things:   1. If the token is random enough and is stored in redis and assuming noone has access to redis then random number without hmac is enough. 2. Still if we want to sign the token then it should be also verified during token verification. |
| --- |

All reactions

Sorry, something went wrong.

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=80&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)

Copy link

Member

Author

### **[ColdHeat](/ColdHeat)** commented [Dec 19, 2024](#issuecomment-2555298497)

| [@br0xpl](https://github.com/br0xpl) The reason the HMAC is there is to allow revocation of the tokens by rotating the secret key.  Signing would really only be useful if we wanted to give the user a message that their token expired but I don't think that's needed anymore. With the HMAC there's no way to verify it without having the original random bytes. |
| --- |

All reactions

Sorry, something went wrong.

[![@br0xpl](https://avatars.githubusercontent.com/u/6824163?s=80&v=4)](/br0xpl)

Copy link

Contributor

### **[br0xpl](/br0xpl)** commented [Dec 19, 2024](#issuecomment-2555521145)

| [@ColdHeat](https://github.com/ColdHeat) sorry I was not clear enough - I did not mean signing, what I meant is that we don't need hmac at all.  Let me try again, we can have two options:   1. Use random number without hmac and store it in redis. You don't need to hmac it becuase you can revoke tokens by simply removing them from redis. 2. The other option is to use hmac as you are now but right now you are not validating the hmac -- look at functions verify\_reset\_password\_token and verify\_email\_confirm\_token -- you are just checking if they exist in redis. This is equal to simply having a random number in redis without hmac at the moment. If you want to keep hmac, then you should also at the end of verify\_....\_token functions perform a hmac check on the email taken from redis and check if it is equal to the provided nonce. |
| --- |

 👍
1
 pandatix reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=80&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)

Copy link

Member

Author

### **[ColdHeat](/ColdHeat)** commented [Dec 21, 2024](#issuecomment-2558002832)

| [@br0xpl](https://github.com/br0xpl)   1. Revocation by redis key is more tedious in comparison to rotating the secret key and letting the redis keys expire. 2. The hmac is built off of a random value, not the email. So there's no way to verify the hmac without also storing the random value (which seems unnecessary). |
| --- |

All reactions

Sorry, something went wrong.

[![@br0xpl](https://avatars.githubusercontent.com/u/6824163?s=80&v=4)](/br0xpl)

Copy link

Contributor

### **[br0xpl](/br0xpl)** commented [Dec 21, 2024](#issuecomment-2558033117) • edited Loading

| [@ColdHeat](https://github.com/ColdHeat)  Ad 2. Haha of course I forgot, you would have to store the random number as well ;)  Ad 1. So how do you want to revoke the token if there is no verification of hmac? You rotate the key but the token is still in Redis and still working.. this is exactly my original comment :-)  I don't see any point of using hmac here at all. Just random secure with enough entropy should be good to go. |
| --- |

All reactions

Sorry, something went wrong.

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=80&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)

Copy link

Member

Author

### **[ColdHeat](/ColdHeat)** commented [Dec 22, 2024](#issuecomment-2558307428)

| [@br0xpl](https://github.com/br0xpl) Ah yes I understand now, thank you for clarifying. I will update the PR to use just the random bytes. |
| --- |

 👍
1
 br0xpl reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&v=4)](/ColdHeat)

`[Remove use of hmac](/CTFd/CTFd/pull/2679/commits/551efef897c302cd9b732bc0f7833b5436c06dcd "Remove use of hmac")`

`[551efef](/CTFd/CTFd/pull/2679/commits/551efef897c302cd9b732bc0f7833b5436c06dcd)`

 Hide details
View details

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)
[ColdHeat](/ColdHeat)
merged commit [`2e0c75c`](/CTFd/CTFd/commit/2e0c75c21ef6253c8a36bac5ddddd15fee59e9fa)
into
master

[Dec 23, 2024](https://github.com/CTFd/CTFd/pull/2679#event-15749989030)
8 checks passed

 [![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=40&u=a0b449258d8a2936ba371059666a0ed9ce2cc676&v=4)](/ColdHeat)
[ColdHeat](/ColdHeat)
deleted the
single-use-email-tokens

branch
[December 23, 2024 16:37](#event-15749989586)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FCTFd%2FCTFd%2Fpull%2F2679)

Reviewers

[![@br0xpl](https://avatars.githubusercontent.com/u/6824163?s=40&v=4)](/br0xpl) [br0xpl](/br0xpl)

br0xpl left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@ColdHeat](https://avatars.githubusercontent.com/u/166333?s=52&v=4)](/ColdHeat) [![@br0xpl](https://avatars.githubusercontent.com/u/6824163?s=52&v=4)](/br0xpl)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


