=== Content from www.wordfence.com_ce2103ac_20250114_210806.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Maintenance & Coming Soon Redirect Animation <= 2.1.3 - Missing Authorization to Settings Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Maintenance & Coming Soon Redirect Animation <= 2.1.3 - Missing Authorization to Settings Update

4.3

**Improper Access Control**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-9503](https://www.cve.org/CVERecord?id=CVE-2024-9503) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | December 19, 2024 |
| Last Updated | December 20, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Maintenance & Coming Soon Redirect Animation plugin for WordPress is vulnerable to unauthorized modification of data due to a missing capability check on the 'wploti\_add\_whitelisted\_roles\_option', 'wploti\_remove\_whitelisted\_roles\_option', 'wploti\_add\_whitelisted\_users\_option', 'wploti\_remove\_whitelisted\_users\_option', and 'wploti\_uploaded\_animation\_save\_option' functions in all versions up to, and including, 2.1.3. This makes it possible for authenticated attackers, with Subscriber-level access and above, to modify certain plugin settings.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmaintenance-coming-soon-redirect-animation%2Fmaintenance-coming-soon-redirect-animation-213-missing-authorization-to-settings-update&t=Maintenance%20%26%20Coming%20Soon%20Redirect%20Animation%20%3C%3D%202.1.3%20-%20Missing%20Authorization%20to%20Settings%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmaintenance-coming-soon-redirect-animation%2Fmaintenance-coming-soon-redirect-animation-213-missing-authorization-to-settings-update&text=Maintenance%20%26%20Coming%20Soon%20Redirect%20Animation%20%3C%3D%202.1.3%20-%20Missing%20Authorization%20to%20Settings%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fmaintenance-coming-soon-redirect-animation%2Fmaintenance-coming-soon-redirect-animation-213-missing-authorization-to-settings-update "LinkedIn")
Email

## Vulnerability Details for Maintenance & Coming Soon Redirect Animation

#### [Maintenance & Coming Soon Redirect Animation](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/maintenance-coming-soon-redirect-animation)

| Software Type | Plugin |
| --- | --- |
| Software Slug | maintenance-coming-soon-redirect-animation [(view on wordpress.org)](https://wordpress.org/plugins/maintenance-coming-soon-redirect-animation) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 2.1.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_d0581cb5_20250114_210805.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fmaintenance-coming-soon-redirect-animation%2Ftrunk%2Fwploti_maintenance_redirect.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php?rev=3027717 "Revision 3027717")
* Next Revision →
* [Blame](/browser/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php)

---

# [source:](/browser?order=name "Go to repository root") [maintenance-coming-soon-redirect-animation](/browser/maintenance-coming-soon-redirect-animation?order=name "View maintenance-coming-soon-redirect-animation")/[trunk](/browser/maintenance-coming-soon-redirect-animation/trunk?order=name "View trunk")/[wploti\_maintenance\_redirect.php](/browser/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php?order=name "View wploti_maintenance_redirect.php")

View diff against:

View revision:

| [Last change](/changeset/3075198/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php "View differences") on this file was [3075198](/changeset/3075198/ "View changeset 3075198"), checked in by yasinedr, [9 months ago](/timeline?from=2024-04-22T17%3A51%3A18Z&precision=second "See timeline at 04/22/2024 05:51:18 PM") |
| --- |
| wp version 6.5.2 compatible |
| **File size:** 111.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name:            Maintenance & Coming Soon Redirect Animation |
| [4](#L4) | Plugin URI:                     https://wordpress.org/plugins/maintenance-coming-soon-redirect-animation/ |
| [5](#L5) | Description:            Make your website in maintenance mode in seconds with great looking animations and configure settings to allow specific users to bypass the maintenance mode. |
| [6](#L6) | Version:                        2.1.3 |
| [7](#L7) | Stable tag:                     2.1.3 |
| [8](#L8) | Requires at least:      4.6 |
| [9](#L9) | Tested up to:           6.5.2 |
| [10](#L10) | Requires PHP:           5.4 |
| [11](#L11) |  |
| [12](#L12) | Text Domain:            maintenance-coming-soon-redirect-animation |
| [13](#L13) | Domain Path:            /languages |
| [14](#L14) |  |
| [15](#L15) | License:                        GPLv3 |
| [16](#L16) | License URI:            https://www.gnu.org/licenses/gpl-3.0.html |
| [17](#L17) |  |
| [18](#L18) | Author:                         Yassine Idrissi |
| [19](#L19) | Author URI:                     https://profiles.wordpress.org/yasinedr/ |
| [20](#L20) |  |
| [21](#L21) | Copyright:                      2022 Yassine Idrissi    (email: ydrissi9@gmail.com) |
| [22](#L22) |  |
| [23](#L23) |  |
| [24](#L24) |  |
| [25](#L25) | This program is free software; you can redistribute it and/or modify |
| [26](#L26) | it under the terms of the GNU General Public License, version 3, as |
| [27](#L27) | published by the Free Software Foundation. |
| [28](#L28) |  |
| [29](#L29) | This program is distributed in the hope that it will be useful, |
| [30](#L30) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [31](#L31) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [32](#L32) | GNU General Public License for more details. |
| [33](#L33) |  |
| [34](#L34) | You should have received a copy of the GNU General Public License |
| [35](#L35) | along with this program; if not, write to the Free Software |
| [36](#L36) | Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
| [37](#L37) |  |
| [38](#L38) |  |
| [39](#L39) |  |
| [40](#L40) | \*/ |
| [41](#L41) |  |
| [42](#L42) | // Exit if accessed directly |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) |  |
| [46](#L46) | defined( 'ABSPATH' ) || exit; |
| [47](#L47) |  |
| [48](#L48) | if( !class\_exists("wploti\_maintenance\_redirect") ) { |
| [49](#L49) |  |
| [50](#L50) | class wploti\_maintenance\_redirect { |
| [51](#L51) |  |
| [52](#L52) | private $admin\_options\_name; |
| [53](#L53) | private $maintenance\_html; |
| [54](#L54) | private $maintenance\_head; |
| [55](#L55) |  |
| [56](#L56) |  |
| [57](#L57) | /\*\* |
| [58](#L58) | \* (php) constructor |
| [59](#L59) | \* |
| [60](#L60) | \* @since 1.0.0 |
| [61](#L61) | \* @access public |
| [62](#L62) | \* @return void |
| [63](#L63) | \*/ |
| [64](#L64) |  |
| [65](#L65) | function \_\_construct() { |
| [66](#L66) | $this->admin\_options\_name       = "wploti\_mr"; |
| [67](#L67) | global $wploti\_ajax\_nonce, $headers, $wploti\_header; |
| [68](#L68) |  |
| [69](#L69) | $wploti\_header = get\_option('wploti\_header\_type'); |
| [70](#L70) |  |
| [71](#L71) | //set headers here , otherwrise we will get headers already sent warning |
| [72](#L72) |  |
| [73](#L73) | $headers = array(); |
| [74](#L74) | $headers[] = array('title' => '200 OK' , 'code' => '200' , 'description' => \_\_( "Best used for when the site is under development." , "maintenance-coming-soon-redirect-animation" )); |
| [75](#L75) | $headers[] = array('title' => '202 Accepted' , 'code' => '202' , 'description' => \_\_( "The request has been accepted for processing, but the processing has not been completed." , "maintenance-coming-soon-redirect-animation" )); |
| [76](#L76) | $headers[] = array('title' => '206 Partial Content' , 'code' => '206' , 'description' => \_\_( "The request has succeeded and the body contains the requested ranges of data, as described in the Range header of the request." , "maintenance-coming-soon-redirect-animation" )); |
| [77](#L77) | $headers[] = array('title' => '302 Found' , 'code' => '302' , 'description' => \_\_( "The target resource resides temporarily under a different URI" , "maintenance-coming-soon-redirect-animation" )); |
| [78](#L78) | $headers[] = array('title' => '307 Temporary Redirect' , 'code' => '307' , 'description' => \_\_( "The resource requested has been temporarily moved to a different URI" , "maintenance-coming-soon-redirect-animation" )); |
| [79](#L79) | $headers[] = array('title' => '503 Service Temporarily Unavailable' , 'code' => '503' , 'description' => \_\_( "Best for when the site is temporarily taken offline for small amendments. If used for a long period of time, 503 can damage your Google ranking." , "maintenance-coming-soon-redirect-animation" )); |
| [80](#L80) |  |
| [81](#L81) | foreach ($headers as $header) { |
| [82](#L82) | switch ($wploti\_header) { |
| [83](#L83) | case $header['code']: |
| [84](#L84) |  |
| [85](#L85) | if (!is\_admin()) { |
| [86](#L86) | header('HTTP/1.1 ' . $header['title']); |
| [87](#L87) | header('Status: ' . $header['title']); |
| [88](#L88) | header("Cache-Control: no-cache, no-store, must-revalidate"); // HTTP 1.1. |
| [89](#L89) | header("Pragma: no-cache"); // HTTP 1.0. |
| [90](#L90) | header("Expires: 0"); // Proxies. |
| [91](#L91) | } |
| [92](#L92) |  |
| [93](#L93) | break; |
| [94](#L94) | } |
| [95](#L95) |  |
| [96](#L96) | header('Retry-After: 600'); |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | /\*\* |
| [102](#L102) | \* (php) initialize |
| [103](#L103) | \* |
| [104](#L104) | \* @since 1.0.0 |
| [105](#L105) | \* @access public |
| [106](#L106) | \* @return void |
| [107](#L107) | \*/ |
| [108](#L108) |  |
| [109](#L109) | function init() { |
| [110](#L110) | global $wpdb, $wploti\_whitelisted\_roles; |
| [111](#L111) |  |
| [112](#L112) | // create keys table if needed. |
| [113](#L113) | $tbl = $wpdb->prefix . $this->admin\_options\_name . "\_access\_keys"; |
| [114](#L114) | if( $wpdb->get\_var( "SHOW TABLES LIKE '". esc\_sql($tbl) ."'" ) != esc\_sql($tbl) ) { |
| [115](#L115) | $sql = "create table $tbl ( id int auto\_increment primary key, name varchar(100), access\_key varchar(20), email varchar(100), created\_at datetime not null default '0000-00-00 00:00:00', active int(1) not null default 1 )"; |
| [116](#L116) | $wpdb->query($sql); |
| [117](#L117) | } |
| [118](#L118) |  |
| [119](#L119) | // create IPs table if needed |
| [120](#L120) | $tbl = $wpdb->prefix . $this->admin\_options\_name . "\_unrestricted\_ips"; |
| [121](#L121) | if( $wpdb->get\_var( "SHOW TABLES LIKE '". esc\_sql($tbl) ."'" ) != esc\_sql($tbl) ) { |
| [122](#L122) | $sql = "create table $tbl ( id int auto\_increment primary key, name varchar(100), ip\_address varchar(20), created\_at datetime not null default '0000-00-00 00:00:00', active int(1) not null default 1 )"; |
| [123](#L123) | $wpdb->query($sql); |
| [124](#L124) |  |
| [125](#L125) | } |
| [126](#L126) |  |
| [127](#L127) | $wploti\_whitelisted\_roles = array('administrator'); |
| [128](#L128) | $wploti\_whitelisted\_users = array(); |
| [129](#L129) | $wploti\_message = \_\_( 'This site is currently undergoing maintenance. Please check back later', 'maintenance-coming-soon-redirect-animation' ); |
| [130](#L130) |  |
| [131](#L131) | // setup options |
| [132](#L132) |  |
| [133](#L133) | add\_option('wploti\_animation', wploti\_animation\_dir . 'default-animation.json'); |
| [134](#L134) |  |
| [135](#L135) | update\_option('wploti\_activation\_notice', 1); |
| [136](#L136) | update\_option('wploti\_notes\_notice', 1 ); |
| [137](#L137) | update\_option('wploti\_status', '0'); |
| [138](#L138) | update\_option('wploti\_header\_type', '200'); |
| [139](#L139) |  |
| [140](#L140) | update\_option('wploti\_whitelisted\_roles', $wploti\_whitelisted\_roles); |
| [141](#L141) | update\_option('wploti\_whitelisted\_users', $wploti\_whitelisted\_users); |
| [142](#L142) | update\_option('wploti\_message', $wploti\_message); |
| [143](#L143) |  |
| [144](#L144) | } |
| [145](#L145) |  |
| [146](#L146) |  |
| [147](#L147) | /\*\* |
| [148](#L148) | \* (php) add custom class to plugin settings page |
| [149](#L149) | \* |
| [150](#L150) | \* @since 2.0.0 |
| [151](#L151) | \* @access public |
| [152](#L152) | \* @return string |
| [153](#L153) | \*/ |
| [154](#L154) |  |
| [155](#L155) | function wploti\_body\_class($classes) { |
| [156](#L156) |  |
| [157](#L157) | $wploti\_current\_screen = get\_current\_screen(); |
| [158](#L158) |  |
| [159](#L159) | if ($wploti\_current\_screen->base === "toplevel\_page\_wploti-settings") |
| [160](#L160) |  |
| [161](#L161) | $classes .= ' wploti\_settings\_page'; |
| [162](#L162) |  |
| [163](#L163) | return $classes; |
| [164](#L164) | } |
| [165](#L165) |  |
| [166](#L166) |  |
| [167](#L167) | /\*\* |
| [168](#L168) | \* (php) Get input message value |
| [169](#L169) | \* |
| [170](#L170) | \* @since 1.0.0 |
| [171](#L171) | \* @access public |
| [172](#L172) | \* @return string |
| [173](#L173) | \*/ |
| [174](#L174) |  |
| [175](#L175) |  |
| [176](#L176) | function wploti\_ajax\_message() { |
| [177](#L177) |  |
| [178](#L178) | global $refresh\_active; |
| [179](#L179) |  |
| [180](#L180) | check\_ajax\_referer('wploti\_nonce', 'security'); |
| [181](#L181) |  |
| [182](#L182) | if ( isset($\_POST['message']) ) { |
| [183](#L183) |  |
| [184](#L184) | $wploti\_message = wp\_kses\_post($\_POST['message']); |
| [185](#L185) |  |
| [186](#L186) | update\_option('wploti\_message', $wploti\_message); |
| [187](#L187) |  |
| [188](#L188) | } |
| [189](#L189) |  |
| [190](#L190) | wp\_die(); |
| [191](#L191) |  |
| [192](#L192) | } |
| [193](#L193) |  |
| [194](#L194) |  |
| [195](#L195) | /\*\* |
| [196](#L196) | \* (php) Update header type |
| [197](#L197) | \* |
| [198](#L198) | \* @since 1.0.0 |
| [199](#L199) | \* @access public |
| [200](#L200) | \* @return string |
| [201](#L201) | \*/ |
| [202](#L202) |  |
| [203](#L203) | function wploti\_ajax\_header\_type(){ |
| [204](#L204) |  |
| [205](#L205) | check\_ajax\_referer('wploti\_nonce', 'security'); |
| [206](#L206) |  |
| [207](#L207) | if ( isset($\_POST['header\_type']) ) { |
| [208](#L208) |  |
| [209](#L209) | $header\_type = sanitize\_text\_field($\_POST['header\_type']); |
| [210](#L210) |  |
| [211](#L211) | update\_option('wploti\_header\_type', $header\_type); |
| [212](#L212) |  |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | wp\_die(); |
| [216](#L216) |  |
| [217](#L217) | } |
| [218](#L218) |  |
| [219](#L219) | /\*\* |
| [220](#L220) | \* Dismiss activation notice |
| [221](#L221) | \* |
| [222](#L222) | \* @since 1.1.1 |
| [223](#L223) | \* @access public |
| [224](#L224) | \* @return void |
| [225](#L225) | \*/ |
| [226](#L226) |  |
| [227](#L227) | function wploti\_ajax\_dismiss\_activation\_notice() { |
| [228](#L228) |  |
| [229](#L229) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [230](#L230) |  |
| [231](#L231) | // user has dismissed the welcome notice |
| [232](#L232) | update\_option( 'wploti\_activation\_notice', 0 ); |
| [233](#L233) |  |
| [234](#L234) | wp\_die(); |
| [235](#L235) |  |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | /\*\* |
| [239](#L239) | \* Dismiss notes notice |
| [240](#L240) | \* |
| [241](#L241) | \* @since 1.1.1 |
| [242](#L242) | \* @access public |
| [243](#L243) | \* @return void |
| [244](#L244) | \*/ |
| [245](#L245) |  |
| [246](#L246) | function wploti\_ajax\_dismiss\_notes\_notice() { |
| [247](#L247) |  |
| [248](#L248) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [249](#L249) |  |
| [250](#L250) | // user has dismissed the notes notice |
| [251](#L251) | update\_option( 'wploti\_notes\_notice', 0 ); |
| [252](#L252) |  |
| [253](#L253) | wp\_die(); |
| [254](#L254) |  |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | /\*\*  (php) show Maintenance Mode notice on WP login form |
| [258](#L258) | \* |
| [259](#L259) | \* @since 2.0.0 |
| [260](#L260) | \* @access public |
| [261](#L261) | \* @return void |
| [262](#L262) | \*/ |
| [263](#L263) |  |
| [264](#L264) | function login\_message($message) |
| [265](#L265) | { |
| [266](#L266) | if ( $this->wploti\_active() == '1') { |
| [267](#L267) | $message .= '<div class="message">' . \_\_('Maintenance Mode is <b>enabled</b>.', 'maintenance-coming-soon-redirect-animation') . '</div>'; |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | return $message; |
| [271](#L271) | } |
| [272](#L272) |  |
| [273](#L273) | /\*\*  (php) show Maintenance Mode notice on Browser console |
| [274](#L274) | \* |
| [275](#L275) | \* @since 2.1.3 |
| [276](#L276) | \* @access public |
| [277](#L277) | \* @return void |
| [278](#L278) | \*/ |
| [279](#L279) |  |
| [280](#L280) | function console\_message(){ |
| [281](#L281) |  |
| [282](#L282) | $message = ''; |
| [283](#L283) | $console = ''; |
| [284](#L284) | $console\_style = ''; |
| [285](#L285) | $console\_style .= 'margin: 20px auto;font-family: cursive;'; |
| [286](#L286) | $console\_style .= 'font-size: 30px; font-weight: bold;'; |
| [287](#L287) | $console\_style .= 'color: #CFC547; text-align: center;'; |
| [288](#L288) | $console\_style .= 'letter-spacing: 5px;'; |
| [289](#L289) | $console\_style .= 'text-shadow: 3px 0px 2px rgba(81,67,21,0.8), -3px 0px 2px rgba(81,67,21,0.8),0px 4px 2px rgba(81,67,21,0.8);'; |
| [290](#L290) |  |
| [291](#L291) | if ( $this->wploti\_active() == '1') { |
| [292](#L292) | $message =  \_\_('Maintenance Mode is enabled.', 'maintenance-coming-soon-redirect-animation'); |
| [293](#L293) | }else{ |
| [294](#L294) | $message =  \_\_('Maintenance Mode is disabled.', 'maintenance-coming-soon-redirect-animation'); |
| [295](#L295) | } |
| [296](#L296) |  |
| [297](#L297) | $console = 'console.warn("%c ' . $message . '", "'. $console\_style . '")'; |
| [298](#L298) |  |
| [299](#L299) | return $console; |
| [300](#L300) | } |
| [301](#L301) |  |
| [302](#L302) | /\*\* |
| [303](#L303) | \* (php)  add settings link to plugin page |
| [304](#L304) | \* |
| [305](#L305) | \* @since 1.0.0 |
| [306](#L306) | \* @version 2.0.0 updated |
| [307](#L307) | \* @access public |
| [308](#L308) | \* @return array |
| [309](#L309) | \*/ |
| [310](#L310) |  |
| [311](#L311) | function wploti\_action\_links ( $actions ) { |
| [312](#L312) |  |
| [313](#L313) | global $page , $plugin\_file , $context , $s , $plugin\_data , $plugin\_id\_attr; |
| [314](#L314) | $new\_actions = array(); |
| [315](#L315) | $new\_actions[] = sprintf( '<a href="'.wploti\_admin\_url.'">%s</a>', \_\_('Settings', 'maintenance-coming-soon-redirect-animation') ); |
| [316](#L316) | $new\_actions = array\_merge($new\_actions, $actions); |
| [317](#L317) | //$uninstall\_url =admin\_url() .'uninstall.php'.'&amp;action=uninstall&amp;\_wpnonce='.wp\_create\_nonce('wploti\_uninstall\_'.get\_current\_user\_id().'\_wpnonce'); |
| [318](#L318) | //$new\_actions[] = '<span class="delete"><a href="'.$uninstall\_url.'" class="delete">'.\_\_('Uninstall','=maintenance-coming-soon-redirect-animation').'</a></span>'; |
| [319](#L319) | /\* if ( current\_user\_can( 'delete\_plugins' ) && ! is\_plugin\_active( $plugin\_file ) ) { |
| [320](#L320) | $new\_actions['delete'] = sprintf( |
| [321](#L321) | '<a href="%s" id="delete-%s" class="delete" aria-label="%s">%s</a>', |
| [322](#L322) | wp\_nonce\_url( 'plugins.php?action=delete-selected&amp;checked[]=' . urlencode( $plugin\_file ) . '&amp' ), |
| [323](#L323) | esc\_attr( $plugin\_id\_attr ), |
| [324](#L324) |  |
| [325](#L325) | esc\_attr( sprintf( \_x( 'Delete %s', 'plugin' ), $plugin\_data['Name'] ) ), |
| [326](#L326) | \_\_( 'Delete' ) |
| [327](#L327) | ); |
| [328](#L328) | } \*/ |
| [329](#L329) | return $new\_actions; |
| [330](#L330) | } |
| [331](#L331) |  |
| [332](#L332) |  |
| [333](#L333) | /\*\* |
| [334](#L334) | \* Filters the array of row meta for each plugin in the Plugins list table. |
| [335](#L335) | \* |
| [336](#L336) | \* @param string[] $plugin\_meta An array of the plugin's metadata. |
| [337](#L337) | \* @param string   $plugin\_file Path to the plugin file relative to the plugins directory. |
| [338](#L338) | \* @return string[] An array of the plugin's metadata. |
| [339](#L339) | \*/ |
| [340](#L340) | public function wploti\_plugin\_row\_meta( array $plugin\_meta, $plugin\_file ) { |
| [341](#L341) | if ( 'maintenance-coming-soon-redirect-animation/wploti\_maintenance\_redirect.php' !== $plugin\_file ) { |
| [342](#L342) | return $plugin\_meta; |
| [343](#L343) | } |
| [344](#L344) |  |
| [345](#L345) | $plugin\_meta[] = sprintf( |
| [346](#L346) | '<a href="%1$s">%2$s</a>', |
| [347](#L347) | 'https://wordpress.org/support/plugin/maintenance-coming-soon-redirect-animation/', |
| [348](#L348) | esc\_html\_x( 'Support', 'verb', 'maintenance-coming-soon-redirect-animation' ) |
| [349](#L349) | ); |
| [350](#L350) | $plugin\_meta[] .= sprintf( |
| [351](#L351) | '<a href="%1$s"><span class="dashicons dashicons-star-filled" aria-hidden="true" style="font-size:14px;line-height:1.3"></span>%2$s</a>', |
| [352](#L352) | 'https://www.paypal.me/yassineidrissi', |
| [353](#L353) | esc\_html\_x( 'Sponsor', 'verb', 'maintenance-coming-soon-redirect-animation' ) |
| [354](#L354) | ); |
| [355](#L355) |  |
| [356](#L356) | return $plugin\_meta; |
| [357](#L357) | } |
| [358](#L358) |  |
| [359](#L359) | /\*\*  (php) display admin topbar notice |
| [360](#L360) | \* |
| [361](#L361) | \* @since 1.1.1 |
| [362](#L362) | \* @version 2.0.0 updated |
| [363](#L363) | \* @access public |
| [364](#L364) | \* @return void |
| [365](#L365) | \*/ |
| [366](#L366) |  |
| [367](#L367) | function wploti\_admin\_bar(){ |
| [368](#L368) |  |
| [369](#L369) | global $wp\_admin\_bar; |
| [370](#L370) | $wploti\_ajax\_nonce = wp\_create\_nonce( "wploti\_nonce" ); |
| [371](#L371) | $wploti\_settings\_img = '<div class="wploti\_settings\_img svg" style="background-image: url(&quot;'. wploti\_icon .'&quot;) !important;" aria-hidden="true"><br></div>'; |
| [372](#L372) | $wploti\_state\_image = '<div class="wploti\_animation\_state"><lottie-player autoplay="true" loop src="'. esc\_attr ( $this->wploti\_active() == '1' ? IMG\_path .'/green-on.json' : IMG\_path .'/red-off.json'  ).'"  class="animation-state"></lottie-player></div>'; |
| [373](#L373) | $topbar = $wploti\_state\_image.'<div class="wploti\_menu\_text">'. \_\_( "Maintenance Status" , "maintenance-coming-soon-redirect-animation" ) .' : </div><div class="toggle-wrapper"><div id="wploti-status-menubar" class="toggle-checkbox"></div><div id="wploti-toggle-adminbar" class="status-' . esc\_attr( $this->wploti\_active() ) . '" data-security="'. esc\_attr($wploti\_ajax\_nonce) .'"><span class="toggle\_handler"></span></div></div>'; |
| [374](#L374) |  |
| [375](#L375) | //Add the main siteadmin menu item |
| [376](#L376) | $wp\_admin\_bar->add\_menu( array( |
| [377](#L377) | 'id'     => 'wploti-activation-status', |
| [378](#L378) | 'title'  => $topbar, |
| [379](#L379) | 'href'   => admin\_url().'admin.php?page=wploti-settings', |
| [380](#L380) | 'parent' => 'top-secondary', |
| [381](#L381) | ) ); |
| [382](#L382) |  |
| [383](#L383) | $wp\_admin\_bar->add\_node(array( |
| [384](#L384) | 'id'     => 'wploti-preview', |
| [385](#L385) | 'title'  => '<span class="wploti\_preview dashicons dashicons-external"></span>' . esc\_attr\_\_('Preview', 'maintenance-coming-soon-redirect-animation'), |
| [386](#L386) | 'meta'   => array('target' => 'blank'), |
| [387](#L387) | 'href'   => get\_home\_url() . '/?wploti\_preview', |
| [388](#L388) | 'parent' => 'wploti-activation-status' |
| [389](#L389) | )); |
| [390](#L390) | $wp\_admin\_bar->add\_node(array( |
| [391](#L391) | 'id'     => 'wploti-settings', |
| [392](#L392) | 'title'  =>  $wploti\_settings\_img . esc\_attr\_\_('Settings', 'maintenance-coming-soon-redirect-animation'), |
| [393](#L393) | 'href'   => admin\_url('admin.php?page=wploti-settings'), |
| [394](#L394) | 'parent' => 'wploti-activation-status', |
| [395](#L395) | )); |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | /\*\*  (php)  toggle activation for admin menu icon |
| [399](#L399) | \* |
| [400](#L400) | \* @since 1.1.1 |
| [401](#L401) | \* @access public |
| [402](#L402) | \* @return void |
| [403](#L403) | \*/ |
| [404](#L404) |  |
| [405](#L405) | function wploti\_ajax\_toggle\_activation() { |
| [406](#L406) |  |
| [407](#L407) | // check for ajax payoload |
| [408](#L408) | if ( isset( $\_POST['payload'] )  && $\_POST['payload'] == 'toggle\_wploti\_status' ) { |
| [409](#L409) |  |
| [410](#L410) | // verify nonce |
| [411](#L411) | check\_ajax\_referer( 'wploti\_nonce' ,'security'); |
| [412](#L412) |  |
| [413](#L413) | // verify user rights |
| [414](#L414) | if ( ! current\_user\_can('manage\_options') ) { |
| [415](#L415) | wp\_die("Oh no you don't!"); |
| [416](#L416) | return; |
| [417](#L417) | } |
| [418](#L418) |  |
| [419](#L419) | if ( $this->wploti\_active() === '0' ) { |
| [420](#L420) | update\_option('wploti\_status', '1'); |
| [421](#L421) | } else { |
| [422](#L422) | update\_option('wploti\_status', '0'); |
| [423](#L423) | } |
| [424](#L424) |  |
| [425](#L425) | wp\_die(); |
| [426](#L426) |  |
| [427](#L427) | } |
| [428](#L428) | } |
| [429](#L429) |  |
| [430](#L430) |  |
| [431](#L431) | /\*\* |
| [432](#L432) | \* (php) add top-level administrative menu |
| [433](#L433) | \* |
| [434](#L434) | \* @since 1.0.0 |
| [435](#L435) | \* @return void |
| [436](#L436) | \*/ |
| [437](#L437) |  |
| [438](#L438) | function wploti\_maintenance\_redirect\_menu() { |
| [439](#L439) |  |
| [440](#L440) | global $submenu; |
| [441](#L441) |  |
| [442](#L442) | add\_menu\_page( |
| [443](#L443) | \_\_( 'Maintenance redirect Settings', 'maintenance-coming-soon-redirect-animation' ), |
| [444](#L444) | \_\_( 'Maintenance', 'maintenance-coming-soon-redirect-animation' ), |
| [445](#L445) | 'manage\_options', |
| [446](#L446) | 'wploti-settings', |
| [447](#L447) | [$this,'print\_admin\_page'], |
| [448](#L448) | wploti\_icon, |
| [449](#L449) | 2 |
| [450](#L450) | ); |
| [451](#L451) |  |
| [452](#L452) | $wploti\_menus = array( |
| [453](#L453) | 'header' => \_\_( 'Header Type', 'maintenance-coming-soon-redirect-animation' ), |
| [454](#L454) | 'ip' => \_\_( 'Unrestricted IP addresses ', 'maintenance-coming-soon-redirect-animation' ), |
| [455](#L455) | 'keys' => \_\_( 'Access Keys', 'maintenance-coming-soon-redirect-animation' ), |
| [456](#L456) | 'animation' => \_\_( 'Animation', 'maintenance-coming-soon-redirect-animation' ), |
| [457](#L457) | 'message' => \_\_( 'Message', 'maintenance-coming-soon-redirect-animation' ), |
| [458](#L458) | 'extra' => \_\_( 'Extra', 'maintenance-coming-soon-redirect-animation' ), |
| [459](#L459) | ); |
| [460](#L460) |  |
| [461](#L461) | /\*\* Register submenus \*/ |
| [462](#L462) | foreach( $wploti\_menus as $menu\_key => $menu\_label ) { |
| [463](#L463) | add\_submenu\_page( |
| [464](#L464) | 'wploti-settings', |
| [465](#L465) | $menu\_label , |
| [466](#L466) | $menu\_label , |
| [467](#L467) | 'manage\_options', |
| [468](#L468) | 'wploti-settings#' . $menu\_key , |
| [469](#L469) | array( $this,'print\_admin\_page' ), |
| [470](#L470) | ); |
| [471](#L471) | } |
| [472](#L472) |  |
| [473](#L473) | $submenu['wploti-settings'][0] = array( \_\_( 'All settings' ), 'manage\_options', 'wploti-settings', 'Maintenance redirect Settings' ); |
| [474](#L474) |  |
| [475](#L475) | } |
| [476](#L476) |  |
| [477](#L477) | /\*\* |
| [478](#L478) | \* Animation Select |
| [479](#L479) | \* |
| [480](#L480) | \* @since 1.0.1 |
| [481](#L481) | \* @access public |
| [482](#L482) | \* @return void |
| [483](#L483) | \*/ |
| [484](#L484) |  |
| [485](#L485) | function animation\_select(){ |
| [486](#L486) |  |
| [487](#L487) | $selected\_animation =  basename(sanitize\_text\_field($\_POST['animation\_url'])); |
| [488](#L488) |  |
| [489](#L489) | update\_option('wploti\_animation', wploti\_animation\_dir . $selected\_animation); |
| [490](#L490) |  |
| [491](#L491) | wp\_die(); |
| [492](#L492) |  |
| [493](#L493) | } |
| [494](#L494) |  |
| [495](#L495) | /\*\* |
| [496](#L496) | \* (php) load animations by infinite scroll |
| [497](#L497) | \* |
| [498](#L498) | \* @since 1.0.0 |
| [499](#L499) | \* @access public |
| [500](#L500) | \* @return void |
| [501](#L501) | \*/ |
| [502](#L502) |  |
| [503](#L503) | function load\_animations(){ |
| [504](#L504) |  |
| [505](#L505) | if (isset($\_POST['start'], $\_POST['limit'])){ |
| [506](#L506) |  |
| [507](#L507) | $animations = array\_slice(scandir(\_\_DIR\_\_.'/animations'),2); |
| [508](#L508) |  |
| [509](#L509) | $counter = sanitize\_text\_field($\_POST['start']); |
| [510](#L510) | $limit = sanitize\_text\_field($\_POST['limit']) ; |
| [511](#L511) |  |
| [512](#L512) |  |
| [513](#L513) | while ( $counter < $limit  )  :   ?> |
| [514](#L514) | <div class="animation-grid"> |
| [515](#L515) | <div id="lottiecontainer"> |
| [516](#L516) | <?php if (explode( wploti\_animation\_dir , get\_option("wploti\_animation"))[1] == $animations[$counter] ) : ?> |
| [517](#L517) | <div class="selected-bg"> |
| [518](#L518) | <span class="selected-btn wp-core-ui button-secondary"><?php \_e('Selected', 'maintenance-coming-soon-redirect-animation'); ?></span> |
| [519](#L519) | </div> |
| [520](#L520) | <?php endif; ?> |
| [521](#L521) | <div class="select-bg"> |
| [522](#L522) | <span class="select-btn wp-core-ui button-primary"><?php \_e('Select', 'maintenance-coming-soon-redirect-animation') ?></span> |
| [523](#L523) | </div> |
| [524](#L524) | <lottie-player autoplay="true" loop src="<?php echo wploti\_animation\_dir .$animations[esc\_attr($counter)] ?>" class="lottieanimation"></lottie-player> |
| [525](#L525) | </div> |
| [526](#L526) | </div> |
| [527](#L527) | <?php |
| [528](#L528) |  |
| [529](#L529) | $counter++; |
| [530](#L530) |  |
| [531](#L531) | endwhile; |
| [532](#L532) |  |
| [533](#L533) | } ?> |
| [534](#L534) |  |
| [535](#L535) | <script> |
| [536](#L536) | jQuery(document).ready(function($) { |
| [537](#L537) |  |
| [538](#L538) | $('.select-btn').click(function(){ |
| [539](#L539) |  |
| [540](#L540) | animation = $(this).parent().next('lottie-player') ; |
| [541](#L541) |  |
| [542](#L542) | animation\_url = animation.get(0).src ; |
| [543](#L543) |  |
| [544](#L544) | selected\_bg = '<div class="selected-bg"><span class="selected-btn wp-core-ui button-secondary"><?php \_e('Selected', 'maintenance-coming-soon-redirect-animation'); ?></span></div>'; |
| [545](#L545) |  |
| [546](#L546) | $('.selected-animation > lottie-player').remove(); |
| [547](#L547) |  |
| [548](#L548) | animation.clone().appendTo( ".selected-animation" ); |
| [549](#L549) |  |
| [550](#L550) | $('.selected-bg').remove(); |
| [551](#L551) |  |
| [552](#L552) | $(this).parents("#lottiecontainer").prepend(selected\_bg); |
| [553](#L553) |  |
| [554](#L554) | $('.selected-animation').find('lottie-player').attr('src', animation\_url) |
| [555](#L555) |  |
| [556](#L556) | $.ajax({ |
| [557](#L557) | url: ajaxurl, |
| [558](#L558) | data: { |
| [559](#L559) | action: 'wploti\_animation\_select', |
| [560](#L560) | animation\_url: animation\_url, |
| [561](#L561) | }, |
| [562](#L562) | type: 'post', |
| [563](#L563) |  |
| [564](#L564) | success: function (result, textstatus) { |
| [565](#L565) | $(".updated").fadeIn(1000).delay(7000).fadeOut("slow"); |
| [566](#L566) | /\* console.log(result); |
| [567](#L567) | console.log('sucess'); \*/ |
| [568](#L568) | }, |
| [569](#L569) | error: function (result) { |
| [570](#L570) | /\* console.log(result); |
| [571](#L571) | console.log('fail'); \*/ |
| [572](#L572) | }, |
| [573](#L573) |  |
| [574](#L574) | }) |
| [575](#L575) |  |
| [576](#L576) | }) |
| [577](#L577) | }); |
| [578](#L578) | </script> |
| [579](#L579) |  |
| [580](#L580) | <?php wp\_die(); |
| [581](#L581) | } |
| [582](#L582) |  |
| [583](#L583) |  |
| [584](#L584) | /\*\* |
| [585](#L585) | \* (php) deactivate action |
| [586](#L586) | \* |
| [587](#L587) | \* @since 1.0.0 |
| [588](#L588) | \* @access public |
| [589](#L589) | \* @return void |
| [590](#L590) | \*/ |
| [591](#L591) |  |
| [592](#L592) | function wploti\_deactivate(){ |
| [593](#L593) |  |
| [594](#L594) | update\_option('wploti\_activation\_notice', 0); |
| [595](#L595) |  |
| [596](#L596) | } |
| [597](#L597) |  |
| [598](#L598) | /\*\* |
| [599](#L599) | \* (php) enqueue admin style and script |
| [600](#L600) | \* |
| [601](#L601) | \* @since 1.0.0 |
| [602](#L602) | \* @access public |
| [603](#L603) | \* @return void |
| [604](#L604) | \*/ |
| [605](#L605) |  |
| [606](#L606) | function wploti\_enqueue\_style\_and\_script\_admin() { |
| [607](#L607) |  |
| [608](#L608) | $style\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'css/admin-style.css'; |
| [609](#L609) |  |
| [610](#L610) | $admin\_bar\_style\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'css/wploti-admin-bar.css'; |
| [611](#L611) |  |
| [612](#L612) | $loti\_script\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'js/lottie-player-script.js'; |
| [613](#L613) |  |
| [614](#L614) | $select\_slyle\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'css/select2.min.css'; |
| [615](#L615) |  |
| [616](#L616) | $select\_script\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'js/select2.min.js'; |
| [617](#L617) |  |
| [618](#L618) | $admin\_script\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'js/admin-script.js'; |
| [619](#L619) |  |
| [620](#L620) | wp\_enqueue\_style( 'wploti-admin-style', $style\_src, array(), WPLOTI\_VERSION, 'all' ); |
| [621](#L621) |  |
| [622](#L622) | wp\_enqueue\_style( 'admin-bar-style-src', $admin\_bar\_style\_src, array(), WPLOTI\_VERSION, 'all' ); |
| [623](#L623) |  |
| [624](#L624) | wp\_enqueue\_style( 'select-slyle-src', $select\_slyle\_src, array(), WPLOTI\_VERSION, 'all' ); |
| [625](#L625) |  |
| [626](#L626) | wp\_enqueue\_script( 'select-script', $select\_script\_src, array(), WPLOTI\_VERSION, false ); |
| [627](#L627) |  |
| [628](#L628) | wp\_enqueue\_script( 'lottiplayer-script', $loti\_script\_src, array(), WPLOTI\_VERSION, false ); |
| [629](#L629) |  |
| [630](#L630) | wp\_enqueue\_script( 'admin-script', $admin\_script\_src, array('lottiplayer-script','select-script'), WPLOTI\_VERSION, false ); |
| [631](#L631) |  |
| [632](#L632) | wp\_enqueue\_script('jquery-ui-tabs'); |
| [633](#L633) |  |
| [634](#L634) | wp\_add\_inline\_script('admin-script', $this->console\_message()); |
| [635](#L635) |  |
| [636](#L636) | } |
| [637](#L637) |  |
| [638](#L638) | /\*\* |
| [639](#L639) | \* (php) enqueue public style and script |
| [640](#L640) | \* |
| [641](#L641) | \* @since 1.0.0 |
| [642](#L642) | \* @access public |
| [643](#L643) | \* @return void |
| [644](#L644) | \*/ |
| [645](#L645) |  |
| [646](#L646) | function wploti\_enqueue\_style\_and\_script\_public() { |
| [647](#L647) |  |
| [648](#L648) | $loti\_script\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'js/lottie-player-script.js'; |
| [649](#L649) |  |
| [650](#L650) | $admin\_bar\_style\_src = plugin\_dir\_url( \_\_FILE\_\_ ) .'css/wploti-admin-bar.css'; |
| [651](#L651) |  |
| [652](#L652) | wp\_enqueue\_style( 'admin\_bar\_style\_src', $admin\_bar\_style\_src, array(), WPLOTI\_VERSION, 'all' ); |
| [653](#L653) |  |
| [654](#L654) | wp\_enqueue\_script( 'lottiplayer-script', $loti\_script\_src, array(), WPLOTI\_VERSION, false ); |
| [655](#L655) |  |
| [656](#L656) | wp\_add\_inline\_script('lottiplayer-script', $this->console\_message()); |
| [657](#L657) |  |
| [658](#L658) | } |
| [659](#L659) |  |
| [660](#L660) | /\*\* |
| [661](#L661) | \* (php) load translation files |
| [662](#L662) | \* |
| [663](#L663) | \* @since 1.1.2 |
| [664](#L664) | \* @access public |
| [665](#L665) | \* @return void |
| [666](#L666) | \*/ |
| [667](#L667) |  |
| [668](#L668) | function wploti\_translation() { |
| [669](#L669) |  |
| [670](#L670) | load\_plugin\_textdomain( 'maintenance-coming-soon-redirect-animation', false, dirname( plugin\_basename( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [671](#L671) |  |
| [672](#L672) | } |
| [673](#L673) |  |
| [674](#L674) | /\*\* |
| [675](#L675) | \* (php) handle external translation files |
| [676](#L676) | \* |
| [677](#L677) | \* @since 1.1.2 |
| [678](#L678) | \* @access public |
| [679](#L679) | \* @return void |
| [680](#L680) | \*/ |
| [681](#L681) |  |
| [682](#L682) | function wploti\_translations\_script() { |
| [683](#L683) | global $wploti\_ajax\_nonce, $wploti\_message, $refresh\_active; |
| [684](#L684) | // Strings to be translated |
| [685](#L685) | $translation\_array = array( |
| [686](#L686) | 'be\_careful' => \_\_( 'Please Be careful', 'maintenance-coming-soon-redirect-animation' ), |
| [687](#L687) | 'option\_reset\_txt' => \_\_( 'This option will reset all your selections to defaults options and will delete the IP addresses and access keys as well', 'maintenance-coming-soon-redirect-animation' ), |
| [688](#L688) | 'pls\_wait' => \_\_( 'Please Wait', 'maintenance-coming-soon-redirect-animation' ), |
| [689](#L689) | 'save\_content' => \_\_( 'Save Content', 'maintenance-coming-soon-redirect-animation' ), |
| [690](#L690) | 'saved\_content' => \_\_( 'Content Saved', 'maintenance-coming-soon-redirect-animation' ), |
| [691](#L691) | 'logged\_out\_description' => \_\_( 'Execute a complete log-out for all currently signed-in users with a single click.', 'maintenance-coming-soon-redirect-animation' ), |
| [692](#L692) | 'logged\_out\_success' => \_\_( 'All users have been successfully logged out.', 'maintenance-coming-soon-redirect-animation' ), |
| [693](#L693) | 'wploti\_whitelisted\_users\_placeholder' => esc\_attr\_\_('Select whitelisted user(s)', 'maintenance-coming-soon-redirect-animation'), |
| [694](#L694) | ); |
| [695](#L695) |  |
| [696](#L696) | // Localize the script with new data |
| [697](#L697) | wp\_localize\_script( 'admin-script', 'wploti\_translate', $translation\_array ); |
| [698](#L698) |  |
| [699](#L699) | // variables to js |
| [700](#L700) | $wploti\_var = array( |
| [701](#L701) | 'IMG\_path' => plugin\_dir\_url( \_\_FILE\_\_ ) .'images', |
| [702](#L702) | 'wploti\_nonce' => esc\_attr($wploti\_ajax\_nonce) , |
| [703](#L703) | 'wploti\_msg\_value' => esc\_attr( get\_option('wploti\_message', $wploti\_message) ) , |
| [704](#L704) |  |
| [705](#L705) | ); |
| [706](#L706) |  |
| [707](#L707) | // Localize the script with new data |
| [708](#L708) | wp\_localize\_script( 'admin-script', 'wploti\_var', $wploti\_var ); |
| [709](#L709) |  |
| [710](#L710) | } |
| [711](#L711) |  |
| [712](#L712) | /\*\* |
| [713](#L713) | \* (php) find user IP |
| [714](#L714) | \* |
| [715](#L715) | \* @since 1.0.0 |
| [716](#L716) | \* @access public |
| [717](#L717) | \* @return string |
| [718](#L718) | \*/ |
| [719](#L719) |  |
| [720](#L720) | function get\_user\_ip(){ |
| [721](#L721) | $ip = ( isset( $\_SERVER['HTTP\_X\_FORWARD\_FOR'] ) ) ? sanitize\_text\_field($\_SERVER['HTTP\_X\_FORWARD\_FOR']) : sanitize\_text\_field($\_SERVER['REMOTE\_ADDR']); |
| [722](#L722) | return $ip; |
| [723](#L723) | } |
| [724](#L724) |  |
| [725](#L725) | /\*\* |
| [726](#L726) | \* (php) determine user class c |
| [727](#L727) | \* |
| [728](#L728) | \* @since 1.0.0 |
| [729](#L729) | \* @access public |
| [730](#L730) | \* @return string |
| [731](#L731) | \*/ |
| [732](#L732) |  |
| [733](#L733) | function get\_user\_class\_c(){ |
| [734](#L734) | $ip = $this->get\_user\_ip(); |
| [735](#L735) | $ip\_parts = explode( '.', $ip ); |
| [736](#L736) | $class\_c = $ip\_parts[0] . '.' . $ip\_parts[1] . '.' .$ip\_parts[2] . '.\*'; |
| [737](#L737) | return $class\_c; |
| [738](#L738) | } |
| [739](#L739) |  |
| [740](#L740) |  |
| [741](#L741) | /\*\* |
| [742](#L742) | \* Reset settings |
| [743](#L743) | \* |
| [744](#L744) | \* @since 1.0.0 |
| [745](#L745) | \* @throws Exception |
| [746](#L746) | \*/ |
| [747](#L747) |  |
| [748](#L748) | public function reset\_plugin\_settings() { |
| [749](#L749) |  |
| [750](#L750) | global $wpdb , $wploti\_message; |
| [751](#L751) |  |
| [752](#L752) | try { |
| [753](#L753) | // check capabilities |
| [754](#L754) | if ( ! current\_user\_can('manage\_options') ) { |
| [755](#L755) | throw new Exception( \_\_( 'You do not have access to this resource.', 'maintenance-coming-soon-redirect-animation' ) ); |
| [756](#L756) | } |
| [757](#L757) |  |
| [758](#L758) | // check nonce |
| [759](#L759) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [760](#L760) |  |
| [761](#L761) | // update options using the default values |
| [762](#L762) |  |
| [763](#L763) | $wploti\_whitelisted\_roles = array('administrator'); |
| [764](#L764) | $wploti\_whitelisted\_users = array(); |
| [765](#L765) | $wploti\_message = \_\_( 'This site is currently undergoing maintenance. Please check back later', 'maintenance-coming-soon-redirect-animation' ); |
| [766](#L766) |  |
| [767](#L767) |  |
| [768](#L768) | update\_option('wploti\_animation', wploti\_animation\_dir . 'default-animation.json'); |
| [769](#L769) | update\_option('wploti\_header\_type', '200'); |
| [770](#L770) | update\_option('wploti\_message', $wploti\_message); |
| [771](#L771) | update\_option('wploti\_whitelisted\_roles', $wploti\_whitelisted\_roles); |
| [772](#L772) | update\_option('wploti\_whitelisted\_users', $wploti\_whitelisted\_users); |
| [773](#L773) |  |
| [774](#L774) | // delete ip\_adresses & access keys |
| [775](#L775) | $ip\_adresses = $wpdb->prefix . $this->admin\_options\_name . '\_unrestricted\_ips'; |
| [776](#L776) | $access\_keys = $wpdb->prefix . $this->admin\_options\_name . '\_access\_keys'; |
| [777](#L777) | $wpdb->query( " DELETE FROM `". esc\_sql($ip\_adresses) ."` " ); |
| [778](#L778) | $wpdb->query( " DELETE FROM `". esc\_sql($access\_keys) ."` " ); |
| [779](#L779) |  |
| [780](#L780) | wp\_send\_json\_success(); |
| [781](#L781) |  |
| [782](#L782) | } catch ( Exception $ex ) { |
| [783](#L783) | wp\_send\_json\_error( $ex->getMessage() ); |
| [784](#L784) | } |
| [785](#L785) | } |
| [786](#L786) |  |
| [787](#L787) | /\*\* |
| [788](#L788) | \* (php) generate key |
| [789](#L789) | \* |
| [790](#L790) | \* @since 1.0.0 |
| [791](#L791) | \* @access public |
| [792](#L792) | \* @return string |
| [793](#L793) | \*/ |
| [794](#L794) |  |
| [795](#L795) | function alphastring( $len = 20, $valid\_chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' ){ |
| [796](#L796) | $str  = ''; |
| [797](#L797) | $chrs = explode( ' ', $valid\_chars ); |
| [798](#L798) | for( $i=0; $i<$len; $i++ ){ |
| [799](#L799) | $str .= $valid\_chars[ rand( 1, strlen( $valid\_chars ) - 1 ) ]; |
| [800](#L800) | } |
| [801](#L801) | return $str; |
| [802](#L802) | } |
| [803](#L803) |  |
| [804](#L804) |  |
| [805](#L805) | /\*\* |
| [806](#L806) | \* (php)  add site favicon on admin panel |
| [807](#L807) | \* |
| [808](#L808) | \* @since 2.0.0 |
| [809](#L809) | \* @access public |
| [810](#L810) | \* @return void |
| [811](#L811) | \*/ |
| [812](#L812) |  |
| [813](#L813) | function add\_site\_favicon() { |
| [814](#L814) |  |
| [815](#L815) | $favicon\_link = '<link rel="icon" type="image/x-icon" href="'.  plugin\_dir\_url( \_\_FILE\_\_ ).'/images/alert-icon.png' .'">'; |
| [816](#L816) |  |
| [817](#L817) | echo wp\_kses( $favicon\_link, |
| [818](#L818) | array( |
| [819](#L819) | 'link' => array( |
| [820](#L820) | 'href' => array(), |
| [821](#L821) | 'type' => array(), |
| [822](#L822) | 'rel' => array(), |
| [823](#L823) | ) |
| [824](#L824) | ) |
| [825](#L825) | ); |
| [826](#L826) | } |
| [827](#L827) |  |
| [828](#L828) | /\*\* |
| [829](#L829) | \* (php)  generate maintenance page |
| [830](#L830) | \* |
| [831](#L831) | \* @since 1.0.0 |
| [832](#L832) | \* @access public |
| [833](#L833) | \* @return void |
| [834](#L834) | \*/ |
| [835](#L835) |  |
| [836](#L836) | function generate\_maintenance\_page(){ |
| [837](#L837) |  |
| [838](#L838) | global $wploti\_ajax\_nonce; |
| [839](#L839) | $maintenance\_head = ''; |
| [840](#L840) |  |
| [841](#L841) | $console = wp\_kses\_post(get\_option('wploti\_message')); |
| [842](#L842) | $console\_style = ''; |
| [843](#L843) | $console\_style .= 'margin: 20px auto;font-family: cursive;'; |
| [844](#L844) | $console\_style .= 'font-size: 30px; font-weight: bold;'; |
| [845](#L845) | $console\_style .= 'color: #CFC547; text-align: center;'; |
| [846](#L846) | $console\_style .= 'letter-spacing: 5px;'; |
| [847](#L847) | $console\_style .= 'text-shadow: 3px 0px 2px rgba(81,67,21,0.8), -3px 0px 2px rgba(81,67,21,0.8),0px 4px 2px rgba(81,67,21,0.8);'; |
| [848](#L848) |  |
| [849](#L849) | $maintenance\_head .= ' |
| [850](#L850) | <link href=" '. plugin\_dir\_url( \_\_FILE\_\_ ) ."css/front-style.css" .'" rel="stylesheet" type="text/css" /> |
| [851](#L851) | <script src="'. plugin\_dir\_url( \_\_FILE\_\_ ) ."js/lottie-player-script.js" .'"></script> |
| [852](#L852) | <script>console.warn("%c' . $console . '", "' . $console\_style . '")</script> |
| [853](#L853) | <title>'. get\_bloginfo( 'name' ) .'</title> |
| [854](#L854) | <meta charset="utf-8"> |
| [855](#L855) | <meta http-equiv="X-UA-Compatible" content="IE=edge"> |
| [856](#L856) |  |
| [857](#L857) | <link rel="icon" type="image/x-icon" href="'.  plugin\_dir\_url( \_\_FILE\_\_ ).'/images/alert-icon.png' .'"> |
| [858](#L858) | <meta name="viewport" content="width=device-width, initial-scale=1">'; |
| [859](#L859) | /\* if($refresh\_active ) : |
| [860](#L860) | $maintenance\_head .= '<meta http-equiv="refresh" content="5">'; |
| [861](#L861) | endif; \*/ |
| [862](#L862) |  |
| [863](#L863) |  |
| [864](#L864) | echo wp\_kses($maintenance\_head , |
| [865](#L865) | array( |
| [866](#L866) | 'link' => array( |
| [867](#L867) | 'href' => array(), |
| [868](#L868) | 'type' => array(), |
| [869](#L869) | 'rel' => array(), |
| [870](#L870) | ), |
| [871](#L871) | 'meta' => array( |
| [872](#L872) | 'name' => array(), |
| [873](#L873) | 'content' => array(), |
| [874](#L874) | 'charset' => array(), |
| [875](#L875) | 'http-equiv' => array(), |
| [876](#L876) | ), |
| [877](#L877) | 'script' => array( |
| [878](#L878) | 'src' => array(), |
| [879](#L879) | ), |
| [880](#L880) | 'title' => array(), |
| [881](#L881) |  |
| [882](#L882) | ) |
| [883](#L883) | ); |
| [884](#L884) |  |
| [885](#L885) |  |
| [886](#L886) | $maintenance\_html =''; |
| [887](#L887) | $maintenance\_html .= '<!DOCTYPE html><html><body>'; |
| [888](#L888) | $maintenance\_html .= '<lottie-player autoplay="true" loop src="'. esc\_attr( get\_option('wploti\_animation', 'default-animation.json') ) .'"></lottie-player>'; |
| [889](#L889) | $maintenance\_html .= '</body></html>'; |
| [890](#L890) |  |
| [891](#L891) |  |
| [892](#L892) | echo wp\_kses($maintenance\_html , |
| [893](#L893) | array( |
| [894](#L894) | 'lottie-player' => array( |
| [895](#L895) | 'autoplay' => true, |
| [896](#L896) | 'loop' => true, |
| [897](#L897) | 'src' => array(), |
| [898](#L898) | ) |
| [899](#L899) | ) |
| [900](#L900) | ); |
| [901](#L901) |  |
| [902](#L902) | echo wp\_kses\_post(get\_option('wploti\_message')); |
| [903](#L903) |  |
| [904](#L904) | exit(); |
| [905](#L905) | } |
| [906](#L906) |  |
| [907](#L907) |  |
| [908](#L908) | /\*\* |
| [909](#L909) | \* (php)  #####  main function  ##### |
| [910](#L910) | \*              #####  Redirection process  ##### |
| [911](#L911) | \*              find out if we need to redirect or not |
| [912](#L912) | \* |
| [913](#L913) | \* @since 1.0.0 |
| [914](#L914) | \* @access public |
| [915](#L915) | \* @return void |
| [916](#L916) | \*/ |
| [917](#L917) |  |
| [918](#L918) | function process\_redirect() { |
| [919](#L919) | global $wpdb; |
| [920](#L920) | $valid\_ips      = array(); |
| [921](#L921) | $valid\_class\_cs = array(); |
| [922](#L922) | $valid\_aks      = array(); |
| [923](#L923) | $wploti\_matches  = apply\_filters( 'wploti\_matches', array() ); |
| [924](#L924) | $current\_user = wp\_get\_current\_user(); |
| [925](#L925) |  |
| [926](#L926) | // set cookie if needed |
| [927](#L927) | if ( isset( $\_GET['wploti\_mr\_temp\_access\_key'] ) && trim( $\_GET['wploti\_mr\_temp\_access\_key'] ) != '' ) { |
| [928](#L928) | // get valid access keys |
| [929](#L929) | $sql = $wpdb->prepare("select access\_key from " . $wpdb->prefix . $this->admin\_options\_name . "\_access\_keys where active = 1"); |
| [930](#L930) | $aks = $wpdb->get\_results($sql, OBJECT); |
| [931](#L931) | if( $aks ){ |
| [932](#L932) | foreach( $aks as $ak ){ |
| [933](#L933) | $valid\_aks[] = $ak->access\_key; |
| [934](#L934) | } |
| [935](#L935) | } |
| [936](#L936) |  |
| [937](#L937) | // set cookie if there's a match |
| [938](#L938) | if( in\_array( $\_GET['wploti\_mr\_temp\_access\_key'], $valid\_aks ) ){ |
| [939](#L939) | $wploti\_mr\_cookie\_time = time()+(60\*60\*24\*365); |
| [940](#L940) | setcookie( 'wploti\_mr\_access\_key', sanitize\_text\_field($\_GET['wploti\_mr\_temp\_access\_key']), $wploti\_mr\_cookie\_time, '/' ); |
| [941](#L941) | $\_COOKIE['wploti\_mr\_access\_key'] = sanitize\_text\_field($\_GET['wploti\_mr\_temp\_access\_key']); |
| [942](#L942) | } |
| [943](#L943) | } |
| [944](#L944) |  |
| [945](#L945) |  |
| [946](#L946) | // skip admin pages by default |
| [947](#L947) | $url\_parts = explode( '/', sanitize\_text\_field($\_SERVER['REQUEST\_URI']) ); |
| [948](#L948) | if( in\_array( 'wp-admin', $url\_parts ) ) { |
| [949](#L949) | $wploti\_matches[] = "<!-- wploti\_MR: SKIPPING ADMIN -->"; |
| [950](#L950) | }else{ |
| [951](#L951) | // determine if user is admin.. if so, bypass all of this. |
| [952](#L952) | if ( current\_user\_can( apply\_filters( 'wploti\_user\_can', 'manage\_options' ) ) ) { |
| [953](#L953) | $wploti\_matches[] = "<!-- wploti\_MR: USER IS ADMIN -->"; |
| [954](#L954) | }else{ |
| [955](#L955) | if( $this->wploti\_active() == '1' ) { |
| [956](#L956) | // get valid unrestricted IPs |
| [957](#L957) |  |
| [958](#L958) | // prepare warning |
| [959](#L959) | $sql = "select ip\_address from " . $wpdb->prefix . $this->admin\_options\_name . "\_unrestricted\_ips where active = 1"; |
| [960](#L960) | $ips = $wpdb->get\_results($sql, OBJECT); |
| [961](#L961) | if( $ips ){ |
| [962](#L962) | foreach( $ips as $ip ){ |
| [963](#L963) | $ip\_parts = explode( '.', $ip->ip\_address ); |
| [964](#L964) | if( $ip\_parts[3] == '\*' ){ |
| [965](#L965) | $valid\_class\_cs[] = $ip\_parts[0] . '.' . $ip\_parts[1] . '.' . $ip\_parts[2]; |
| [966](#L966) | }else{ |
| [967](#L967) | $valid\_ips[] = $ip->ip\_address; |
| [968](#L968) | } |
| [969](#L969) | } |
| [970](#L970) | } |
| [971](#L971) |  |
| [972](#L972) | // get valid access keys |
| [973](#L973) | $valid\_aks = array(); |
| [974](#L974) |  |
| [975](#L975) | $sql = "select access\_key from " . $wpdb->prefix . $this->admin\_options\_name . "\_access\_keys where active = 1"; |
| [976](#L976) | $aks = $wpdb->get\_results($sql, OBJECT); |
| [977](#L977) | if( $aks ){ |
| [978](#L978) | foreach( $aks as $ak ){ |
| [979](#L979) | $valid\_aks[] = $ak->access\_key; |
| [980](#L980) | } |
| [981](#L981) | } |
| [982](#L982) |  |
| [983](#L983) | // manage cookie filtering |
| [984](#L984) | if( isset( $\_COOKIE['wploti\_mr\_access\_key'] ) && $\_COOKIE['wploti\_mr\_access\_key'] != '' ){ |
| [985](#L985) | // check versus active codes |
| [986](#L986) | if( in\_array( $\_COOKIE['wploti\_mr\_access\_key'], $valid\_aks ) ){ |
| [987](#L987) | $wploti\_matches[] = "<!-- wploti\_MR: COOKIE MATCH -->"; |
| [988](#L988) | } |
| [989](#L989) | } |
| [990](#L990) |  |
| [991](#L991) | // manage ip filtering |
| [992](#L992) | if( in\_array( $this->get\_user\_ip(), $valid\_ips ) ) { |
| [993](#L993) | $wploti\_matches[] = "<!-- wploti\_MR: IP MATCH -->"; |
| [994](#L994) | }else{ |
| [995](#L995) | // check for partial ( class c ) match |
| [996](#L996) | $ip\_parts     = explode( '.', $this->get\_user\_ip() ); |
| [997](#L997) | $user\_class\_c = $ip\_parts[0] . '.' . $ip\_parts[1] . '.' . $ip\_parts[2]; |
| [998](#L998) | if( in\_array( $user\_class\_c, $valid\_class\_cs ) ) { |
| [999](#L999) | $wploti\_matches[] = "<!-- wploti\_MR: CLASS C MATCH -->"; |
| [1000](#L1000) | } |
| [1001](#L1001) | } |
| [1002](#L1002) |  |
| [1003](#L1003) | //skip Whitelisted User Roles |
| [1004](#L1004) | if($this->user\_has\_role( get\_option('wploti\_whitelisted\_roles'))){ |
| [1005](#L1005) | $wploti\_matches[] = "<!-- wploti\_MR: ROLE MATCH -->"; |
| [1006](#L1006) | } |
| [1007](#L1007) |  |
| [1008](#L1008) | //skip Whitelisted Users |
| [1009](#L1009) | if( in\_array($current\_user->ID , get\_option('wploti\_whitelisted\_users')) ){ |
| [1010](#L1010) | $wploti\_matches[] = "<!-- wploti\_MR: USER MATCH -->"; |
| [1011](#L1011) | } |
| [1012](#L1012) |  |
| [1013](#L1013) | if( count( $wploti\_matches ) == 0 ) { |
| [1014](#L1014) |  |
| [1015](#L1015) | // no match found. show maintenance page |
| [1016](#L1016) |  |
| [1017](#L1017) | $this->generate\_maintenance\_page(); |
| [1018](#L1018) |  |
| [1019](#L1019) | } |
| [1020](#L1020) | }else{ |
| [1021](#L1021) | $wploti\_matches[] = "<!-- wploti\_MR: REDIR DISABLED -->"; |
| [1022](#L1022) | } |
| [1023](#L1023) | } |
| [1024](#L1024) | } |
| [1025](#L1025) | } |
| [1026](#L1026) |  |
| [1027](#L1027) | /\*\* |
| [1028](#L1028) | \* (php)  add new IP |
| [1029](#L1029) | \* |
| [1030](#L1030) | \* @since 1.0.0 |
| [1031](#L1031) | \* @access public |
| [1032](#L1032) | \* @return void |
| [1033](#L1033) | \*/ |
| [1034](#L1034) |  |
| [1035](#L1035) | function add\_new\_ip() { |
| [1036](#L1036) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1037](#L1037) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1038](#L1038) | global $wpdb; |
| [1039](#L1039) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_unrestricted\_ips'; |
| [1040](#L1040) | $name       = stripslashes( sanitize\_text\_field($\_POST['wploti\_mr\_ip\_name']) ) ; |
| [1041](#L1041) | $ip\_address = stripslashes( trim( sanitize\_text\_field($\_POST['wploti\_mr\_ip\_ip']) ) ) ; |
| [1042](#L1042) | $sql        = $wpdb->prepare("insert into ".esc\_sql($tbl)." ( name, ip\_address, created\_at ) values ( '".esc\_sql($name)."', '".esc\_sql($ip\_address)."', NOW() )"); |
| [1043](#L1043) | $rs         = $wpdb->query( $sql ); |
| [1044](#L1044) | if( $rs ){ |
| [1045](#L1045) | // send table data |
| [1046](#L1046) | $this->print\_unrestricted\_ips(); |
| [1047](#L1047) | }else{ |
| [1048](#L1048) | \_e( 'Unable to add IP because of a database error. Please reload the page.' , 'maintenance-coming-soon-redirect-animation' ); |
| [1049](#L1049) | } |
| [1050](#L1050) | die(); |
| [1051](#L1051) | } |
| [1052](#L1052) |  |
| [1053](#L1053) | /\*\* |
| [1054](#L1054) | \* (php)  toggle IP status |
| [1055](#L1055) | \* |
| [1056](#L1056) | \* @since 1.0.0 |
| [1057](#L1057) | \* @access public |
| [1058](#L1058) | \* @return void |
| [1059](#L1059) | \*/ |
| [1060](#L1060) |  |
| [1061](#L1061) | function toggle\_ip\_status(){ |
| [1062](#L1062) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1063](#L1063) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1064](#L1064) | global $wpdb; |
| [1065](#L1065) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_unrestricted\_ips'; |
| [1066](#L1066) | $ip\_id     = sanitize\_text\_field( $\_POST['wploti\_mr\_ip\_id'] ); |
| [1067](#L1067) | $ip\_active = ( sanitize\_text\_field($\_POST['wploti\_mr\_ip\_active']) == 1 ) ? 1 : 0; |
| [1068](#L1068) | $sql       = $wpdb->prepare("update ". esc\_sql($tbl)." set active = '". esc\_sql($ip\_active)."' where id = '". esc\_sql($ip\_id) ."'"); |
| [1069](#L1069) | $rs        = $wpdb->query( $sql ); |
| [1070](#L1070) | if( $rs ){ |
| [1071](#L1071) | echo 'SUCCESS' . '|' . esc\_html($ip\_id) . '|' . esc\_html($ip\_active); |
| [1072](#L1072) | }else{ |
| [1073](#L1073) | echo 'ERROR'; |
| [1074](#L1074) | } |
| [1075](#L1075) | die(); |
| [1076](#L1076) | } |
| [1077](#L1077) |  |
| [1078](#L1078) | /\*\* |
| [1079](#L1079) | \* (php)  delete IP |
| [1080](#L1080) | \* |
| [1081](#L1081) | \* @since 1.0.0 |
| [1082](#L1082) | \* @access public |
| [1083](#L1083) | \* @return void |
| [1084](#L1084) | \*/ |
| [1085](#L1085) |  |
| [1086](#L1086) | function delete\_ip(){ |
| [1087](#L1087) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1088](#L1088) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1089](#L1089) | global $wpdb; |
| [1090](#L1090) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_unrestricted\_ips'; |
| [1091](#L1091) | $ip\_id     = sanitize\_text\_field( $\_POST['wploti\_mr\_ip\_id'] ); |
| [1092](#L1092) | $sql       = $wpdb->prepare("delete from ". esc\_sql($tbl)." where id = '". esc\_sql($ip\_id) ."'"); |
| [1093](#L1093) | $rs        = $wpdb->query( $sql ); |
| [1094](#L1094) | if( $rs ){ |
| [1095](#L1095) | $this->print\_unrestricted\_ips(); |
| [1096](#L1096) | }else{ |
| [1097](#L1097) | \_e( 'Unable to delete IP because of a database error. Please reload the page.' , 'maintenance-coming-soon-redirect-animation' ); |
| [1098](#L1098) | } |
| [1099](#L1099) | die(); |
| [1100](#L1100) | } |
| [1101](#L1101) |  |
| [1102](#L1102) | /\*\* |
| [1103](#L1103) | \* (php)  add new Access Key |
| [1104](#L1104) | \* |
| [1105](#L1105) | \* @since 1.0.0 |
| [1106](#L1106) | \* @access public |
| [1107](#L1107) | \* @return void |
| [1108](#L1108) | \*/ |
| [1109](#L1109) |  |
| [1110](#L1110) | function add\_new\_ak() { |
| [1111](#L1111) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1112](#L1112) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1113](#L1113) | global $wpdb; |
| [1114](#L1114) | $tbl        = $wpdb->prefix . $this->admin\_options\_name . '\_access\_keys'; |
| [1115](#L1115) | $name       = sanitize\_text\_field( stripslashes( $\_POST['wploti\_mr\_ak\_name'] ) ); |
| [1116](#L1116) | $email      = sanitize\_email( $\_POST['wploti\_mr\_ak\_email'] ); |
| [1117](#L1117) | $access\_key = sanitize\_text\_field( $this->alphastring(20) ); |
| [1118](#L1118) | $sql        = $wpdb->prepare("insert into ".esc\_sql($tbl)." ( name, email, access\_key, created\_at ) values ( '".esc\_sql($name)."', '".esc\_sql($email)."', '".esc\_sql($access\_key)."', NOW() )"); |
| [1119](#L1119) | $rs         = $wpdb->query( $sql ); |
| [1120](#L1120) | if( $rs ){ |
| [1121](#L1121) | // email user |
| [1122](#L1122) | $subject    = sprintf( /\* translators: %s = name of the website/blog \*/ \_\_( "Access Key Link for %s" , "maintenance-coming-soon-redirect-animation" ), get\_bloginfo() ); |
| [1123](#L1123) | $full\_msg   = sprintf( /\* translators: %s = name of the website/blog \*/ \_\_( "The following link will provide you temporary access to %s:" , "maintenance-coming-soon-redirect-animation" ), get\_bloginfo() ) . "\n\n"; |
| [1124](#L1124) | $full\_msg  .= \_\_( "Please note that you must have cookies enabled for this to work." , "maintenance-coming-soon-redirect-animation" ) . "\n\n"; |
| [1125](#L1125) | $full\_msg  .= get\_bloginfo('url') . '?wploti\_mr\_temp\_access\_key=' . $access\_key; |
| [1126](#L1126) | $mail\_sent  = wp\_mail( $email, $subject, $full\_msg ); |
| [1127](#L1127) | echo ( esc\_html($mail\_sent) ) ? '<!-- SEND\_SUCCESS -->' : '<!-- SEND\_FAILURE -->'; |
| [1128](#L1128) | // send table data |
| [1129](#L1129) | $this->print\_access\_keys(); |
| [1130](#L1130) | }else{ |
| [1131](#L1131) | \_e( "Unable to add Access Key because of a database error. Please reload the page." , "maintenance-coming-soon-redirect-animation" ); |
| [1132](#L1132) | } |
| [1133](#L1133) | die(); |
| [1134](#L1134) | } |
| [1135](#L1135) |  |
| [1136](#L1136) | /\*\* |
| [1137](#L1137) | \* (php)  toggle Access Key status |
| [1138](#L1138) | \* |
| [1139](#L1139) | \* @since 1.0.0 |
| [1140](#L1140) | \* @access public |
| [1141](#L1141) | \* @return void |
| [1142](#L1142) | \*/ |
| [1143](#L1143) |  |
| [1144](#L1144) | function toggle\_ak\_status(){ |
| [1145](#L1145) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1146](#L1146) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1147](#L1147) | global $wpdb; |
| [1148](#L1148) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_access\_keys'; |
| [1149](#L1149) | $ak\_id     = sanitize\_text\_field( $\_POST['wploti\_mr\_ak\_id'] ); |
| [1150](#L1150) | $ak\_active = ( sanitize\_text\_field($\_POST['wploti\_mr\_ak\_active']) == 1 ) ? 1 : 0; |
| [1151](#L1151) | $sql       = $wpdb->prepare("update ". esc\_sql($tbl)." set active = '". esc\_sql($ak\_active) ."' where id = ' ". esc\_sql($ak\_id) ." '"); |
| [1152](#L1152) | $rs        = $wpdb->query( $sql ); |
| [1153](#L1153) | if( $rs ){ |
| [1154](#L1154) | echo 'SUCCESS' . '|' . esc\_html($ak\_id) . '|' . esc\_html($ak\_active); |
| [1155](#L1155) | }else{ |
| [1156](#L1156) | echo 'ERROR'; |
| [1157](#L1157) | } |
| [1158](#L1158) | die(); |
| [1159](#L1159) | } |
| [1160](#L1160) |  |
| [1161](#L1161) | /\*\* |
| [1162](#L1162) | \* (php)  delete Access Key |
| [1163](#L1163) | \* |
| [1164](#L1164) | \* @since 1.0.0 |
| [1165](#L1165) | \* @access public |
| [1166](#L1166) | \* @return void |
| [1167](#L1167) | \*/ |
| [1168](#L1168) |  |
| [1169](#L1169) | function delete\_ak(){ |
| [1170](#L1170) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1171](#L1171) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1172](#L1172) | global $wpdb; |
| [1173](#L1173) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_access\_keys'; |
| [1174](#L1174) | $ak\_id     = sanitize\_text\_field( $\_POST['wploti\_mr\_ak\_id'] ); |
| [1175](#L1175) | $sql       = $wpdb->prepare("delete from ". esc\_sql($tbl) ." where id = '". esc\_sql($ak\_id) ."'"); |
| [1176](#L1176) | $rs        = $wpdb->query( $sql ); |
| [1177](#L1177) | if( $rs ){ |
| [1178](#L1178) | $this->print\_access\_keys(); |
| [1179](#L1179) | }else{ |
| [1180](#L1180) | \_e( 'Unable to delete Access Key because of a database error. Please reload the page.' , 'maintenance-coming-soon-redirect-animation'); |
| [1181](#L1181) | } |
| [1182](#L1182) | die(); |
| [1183](#L1183) | } |
| [1184](#L1184) |  |
| [1185](#L1185) | /\*\* |
| [1186](#L1186) | \* (php)  resend Access Key email |
| [1187](#L1187) | \* |
| [1188](#L1188) | \* @since 1.0.0 |
| [1189](#L1189) | \* @access public |
| [1190](#L1190) | \* @return void |
| [1191](#L1191) | \*/ |
| [1192](#L1192) |  |
| [1193](#L1193) | function resend\_ak(){ |
| [1194](#L1194) | if ( !current\_user\_can('manage\_options') ) wp\_die("Oh no you don't!"); |
| [1195](#L1195) | check\_ajax\_referer( 'wploti\_nonce', 'security' ); |
| [1196](#L1196) | global $wpdb; |
| [1197](#L1197) | $tbl       = $wpdb->prefix . $this->admin\_options\_name . '\_access\_keys'; |
| [1198](#L1198) | $ak\_id     = sanitize\_text\_field( $\_POST['wploti\_mr\_ak\_id'] ); |
| [1199](#L1199) | $sql       = $wpdb->prepare("select \* from ". esc\_sql($tbl) ." where id = '". esc\_sql($ak\_id) ."'"); |
| [1200](#L1200) | $ak        = $wpdb->get\_row( $sql ); |
| [1201](#L1201) | if( $ak ){ |
| [1202](#L1202) | $subject    = sprintf( /\* translators: %s = name of the website/blog \*/ \_\_( "Access Key Link for %s" , "maintenance-coming-soon-redirect-animation"), get\_bloginfo() ); |
| [1203](#L1203) | $full\_msg   = sprintf( /\* translators: %s = name of the website/blog \*/ \_\_( "The following link will provide you temporary access to %s:" , "maintenance-coming-soon-redirect-animation"), get\_bloginfo() ) . "\n\n"; |
| [1204](#L1204) | $full\_msg  .= \_\_( "Please note that you must have cookies enabled for this to work." , "maintenance-coming-soon-redirect-animation") . "\n\n"; |
| [1205](#L1205) | $full\_msg  .= get\_bloginfo('url') . '?wploti\_mr\_temp\_access\_key=' . esc\_html($ak->access\_key); |
| [1206](#L1206) | $mail\_sent  = wp\_mail( $ak->email, $subject, $full\_msg ); |
| [1207](#L1207) | echo ( esc\_html($mail\_sent) ) ? 'SEND\_SUCCESS' : 'SEND\_FAILURE'; |
| [1208](#L1208) | }else{ |
| [1209](#L1209) | echo 'ERROR' ; |
| [1210](#L1210) | } |
| [1211](#L1211) | die(); |
| [1212](#L1212) | } |
| [1213](#L1213) |  |
| [1214](#L1214) | /\*\* |
| [1215](#L1215) | \* (php)  generate IP table data |
| [1216](#L1216) | \* |
| [1217](#L1217) | \* @since 1.0.0 |
| [1218](#L1218) | \* @access public |
| [1219](#L1219) | \* @return void |
| [1220](#L1220) | \*/ |
| [1221](#L1221) |  |
| [1222](#L1222) | function print\_unrestricted\_ips(){ |
| [1223](#L1223) | global $wpdb; ?> |
| [1224](#L1224) |  |
| [1225](#L1225) | <table class="widefat fixed" cellspacing="0"> |
| [1226](#L1226) | <thead> |
| [1227](#L1227) | <tr> |
| [1228](#L1228) | <th class="column-wploti-ip-name"><?php \_e( "Name" , "maintenance-coming-soon-redirect-animation" ); ?></th> |
| [1229](#L1229) | <th class="column-wploti-ip-ip"><?php \_e( "IP" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1230](#L1230) | <th class="column-wploti-ip-active"><?php \_e( "Creation Date" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1231](#L1231) | <th class="column-wploti-ip-creation-date"><?php \_e( "Active" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1232](#L1232) | <th class="column-wploti-actions"><?php \_e( "Actions" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1233](#L1233) | </tr> |
| [1234](#L1234) | </thead> |
| [1235](#L1235) |  |
| [1236](#L1236) | <tfoot> |
| [1237](#L1237) | <tr> |
| [1238](#L1238) | <th class="column-wploti-ip-name"><?php \_e( "Name" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1239](#L1239) | <th class="column-wploti-ip-ip"><?php \_e( "IP" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1240](#L1240) | <th class="column-wploti-ip-creation-date"><?php \_e( "Creation Date" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1241](#L1241) | <th class="column-wploti-ip-active"><?php \_e( "Active" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1242](#L1242) | <th class="column-wploti-actions"><?php \_e( "Actions" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1243](#L1243) | </tr> |
| [1244](#L1244) | </tfoot> |
| [1245](#L1245) |  |
| [1246](#L1246) | <tbody> |
| [1247](#L1247) | <?php |
| [1248](#L1248) |  |
| [1249](#L1249) | $sql = "select \* from " . $wpdb->prefix . $this->admin\_options\_name . "\_unrestricted\_ips order by name"; |
| [1250](#L1250) | $ips = $wpdb->get\_results($sql, OBJECT); |
| [1251](#L1251) | $ip\_row\_class = 'alternate'; |
| [1252](#L1252) | if( $ips ){ |
| [1253](#L1253) | foreach( $ips as $ip ) : |
| [1254](#L1254) | $ip\_name = sanitize\_text\_field($ip->name); |
| [1255](#L1255) | $ip\_address = sanitize\_text\_field($ip->ip\_address); |
| [1256](#L1256) | $ip\_creation\_date = sanitize\_text\_field($ip->created\_at); |
| [1257](#L1257) | $ip\_id = sanitize\_text\_field($ip->id); |
| [1258](#L1258) | ?> |
| [1259](#L1259) | <tr id="wploti-ip-<?php echo esc\_attr($ip\_id); ?>" valign="middle"  class="<?php echo esc\_attr($ip\_row\_class); ?>"> |
| [1260](#L1260) | <td class="column-wploti-ip-name"><?php echo esc\_html($ip\_name); ?></td> |
| [1261](#L1261) | <td class="column-wploti-ip-ip"><?php echo esc\_html($ip\_address); ?></td> |
| [1262](#L1262) | <td class="column-wploti-ip-creation-date"><?php echo esc\_html($ip\_creation\_date); ?></td> |
| [1263](#L1263) | <td class="column-wploti-ip-active" id="wploti\_mr\_ip\_status\_<?php echo esc\_attr($ip\_id); ?>" ><?php echo ( sanitize\_text\_field($ip->active) == 1) ? '<span class="green">' .  \_\_( 'Yes' , 'maintenance-coming-soon-redirect-animation' ) .' </span>' : '<span class="red">' . \_\_( 'No' , 'maintenance-coming-soon-redirect-animation' ) .' </span>' ; ?></td> |
| [1264](#L1264) | <td class="column-wploti-actions"> |
| [1265](#L1265) | <span class='edit' id="wploti\_mr\_ip\_status\_<?php echo esc\_attr($ip\_id); ?>\_action"> |
| [1266](#L1266) | <?php if( $ip->active == 1 ){ ?> |
| [1267](#L1267) | <a href="javascript:wploti\_mr\_toggle\_ip( 0, <?php echo esc\_attr($ip\_id) ?> );"><?php \_e( "Disable" , "maintenance-coming-soon-redirect-animation" ); ?></a> | |
| [1268](#L1268) | <?php }else{ ?> |
| [1269](#L1269) | <a href="javascript:wploti\_mr\_toggle\_ip( 1, <?php echo esc\_attr($ip\_id) ?> );"><?php \_e( "Enable" , "maintenance-coming-soon-redirect-animation" ); ?></a> | |
| [1270](#L1270) | <?php } ?> |
| [1271](#L1271) | </span> |
| [1272](#L1272) | <span class='delete'> |
| [1273](#L1273) | <a class='submitdelete' href="javascript:wploti\_mr\_delete\_ip( <?php echo esc\_attr($ip\_id) ?>, '<?php echo addslashes( esc\_attr($ip\_address) ) ?>' );" ><?php \_e( "Delete" , "maintenance-coming-soon-redirect-animation" ); ?></a> |
| [1274](#L1274) | </span> |
| [1275](#L1275) | </td> |
| [1276](#L1276) | </tr> |
| [1277](#L1277) | <?php |
| [1278](#L1278) | $ip\_row\_class = ( $ip\_row\_class == '' ) ? 'alternate' : ''; |
| [1279](#L1279) | endforeach; |
| [1280](#L1280) | } |
| [1281](#L1281) | ?> |
| [1282](#L1282) |  |
| [1283](#L1283) | <tr id="wploti-ip-NEW" valign="middle"  class="<?php echo esc\_attr($ip\_row\_class); ?>"> |
| [1284](#L1284) | <td class="column-wploti-ip-name"> |
| [1285](#L1285) | <input class="wploti\_mr\_disabled\_field" type="text" id="wploti\_mr\_new\_ip\_name" name="wploti\_mr\_new\_ip\_name" placeholder="<?php \_e( "Enter Name:" , "maintenance-coming-soon-redirect-animation"); ?>"> |
| [1286](#L1286) |  |
| [1287](#L1287) | </td> |
| [1288](#L1288) | <td class="column-wploti-ip-ip"> |
| [1289](#L1289) | <input class="wploti\_mr\_disabled\_field" type="text" id="wploti\_mr\_new\_ip\_ip" name="wploti\_mr\_new\_ip\_ip" placeholder="<?php \_e( "Enter IP:" , "maintenance-coming-soon-redirect-animation"); ?>"> |
| [1290](#L1290) | </td> |
| [1291](#L1291) | <td class="column-wploti-ip-active">&nbsp;</td> |
| [1292](#L1292) | <td class="column-wploti-ip-creation-date">&nbsp;</td> |
| [1293](#L1293) | <td class="column-wploti-actions"> |
| [1294](#L1294) | <span class='edit' id="wploti\_mr\_add\_ip\_link"> |
| [1295](#L1295) | <a href="javascript:wploti\_mr\_add\_new\_ip( );"><?php \_e( "Add New IP" , "maintenance-coming-soon-redirect-animation"); ?></a> |
| [1296](#L1296) | </span> |
| [1297](#L1297) | </td> |
| [1298](#L1298) | </tr> |
| [1299](#L1299) | </tbody> |
| [1300](#L1300) | </table> |
| [1301](#L1301) | <?php |
| [1302](#L1302) | } |
| [1303](#L1303) |  |
| [1304](#L1304) | /\*\* |
| [1305](#L1305) | \* (php)  genereate Access Key table data |
| [1306](#L1306) | \* |
| [1307](#L1307) | \* @since 1.0.0 |
| [1308](#L1308) | \* @access public |
| [1309](#L1309) | \* @return void |
| [1310](#L1310) | \*/ |
| [1311](#L1311) |  |
| [1312](#L1312) | function print\_access\_keys(){ |
| [1313](#L1313) | global $wpdb; ?> |
| [1314](#L1314) | <table class="widefat fixed" cellspacing="0"> |
| [1315](#L1315) | <thead> |
| [1316](#L1316) | <tr> |
| [1317](#L1317) | <th class="column-wploti-ak-name"><?php \_e( "Name" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1318](#L1318) | <th class="column-wploti-ak-email"><?php \_e( "Email" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1319](#L1319) | <th class="column-wploti-ak-key"><?php \_e( "Access Key" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1320](#L1320) | <th class="column-wploti-ak-key-creation-date"><?php \_e( "Creation Date" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1321](#L1321) | <th class="column-wploti-ak-active"><?php \_e( "Active" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1322](#L1322) | <th class="column-wploti-actions"><?php \_e( "Actions" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1323](#L1323) | </tr> |
| [1324](#L1324) | </thead> |
| [1325](#L1325) |  |
| [1326](#L1326) | <tfoot> |
| [1327](#L1327) | <tr> |
| [1328](#L1328) | <th class="column-wploti-ak-name"><?php \_e( "Name" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1329](#L1329) | <th class="column-wploti-ak-email"><?php \_e( "Email" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1330](#L1330) | <th class="column-wploti-ak-key"><?php \_e( "Access Key" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1331](#L1331) | <th class="column-wploti-ak-key-creation-date"><?php \_e( "Creation Date" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1332](#L1332) | <th class="column-wploti-ak-active"><?php \_e( "Active" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1333](#L1333) | <th class="column-wploti-actions"><?php \_e( "Actions" , "maintenance-coming-soon-redirect-animation"); ?></th> |
| [1334](#L1334) | </tr> |
| [1335](#L1335) | </tfoot> |
| [1336](#L1336) |  |
| [1337](#L1337) | <tbody> |
| [1338](#L1338) | <?php |
| [1339](#L1339) |  |
| [1340](#L1340) | $sql   = "select \* from " . $wpdb->prefix . $this->admin\_options\_name . "\_access\_keys order by name"; |
| [1341](#L1341) | $codes = $wpdb->get\_results($sql, OBJECT); |
| [1342](#L1342) | $ak\_row\_class = 'alternate'; |
| [1343](#L1343) | if( $codes ){ |
| [1344](#L1344) | foreach( $codes as $code ) : |
| [1345](#L1345) | $ak\_name = sanitize\_text\_field($code->name); |
| [1346](#L1346) | $ak\_email = sanitize\_email($code->email); |
| [1347](#L1347) | $ak\_key = sanitize\_text\_field($code->access\_key); |
| [1348](#L1348) | $ak\_creation\_date = sanitize\_text\_field($code->created\_at); |
| [1349](#L1349) | $ak\_code = sanitize\_text\_field($code->id); |
| [1350](#L1350) | ?> |
| [1351](#L1351) | <tr id="wploti-ak-<?php echo esc\_attr($ak\_code) ?>" valign="middle"  class="<?php echo esc\_attr($ak\_row\_class) ?>"> |
| [1352](#L1352) | <td class="column-wploti-ak-name"><?php echo esc\_html($ak\_name); ?></td> |
| [1353](#L1353) | <td class="column-wploti-ak-email"><a href="mailto:<?php echo esc\_attr($ak\_email) ?>" title="email : <?php echo esc\_attr($ak\_email) ?>"><?php echo esc\_html($ak\_email) ?></a></td> |
| [1354](#L1354) | <td class="column-wploti-ak-key"><?php echo esc\_html($ak\_key); ?></td> |
| [1355](#L1355) | <td class="column-wploti-ak-key-creation-date"><?php echo esc\_html($ak\_creation\_date); ?></td> |
| [1356](#L1356) | <td class="column-wploti-ak-active" id="wploti\_mr\_ak\_status\_<?php echo esc\_attr($ak\_code); ?>" ><?php echo ( $code->active == 1) ? '<span class="green">' .  \_\_( "Yes" , "maintenance-coming-soon-redirect-animation") .' </span>' :  '<span class="red">' .  \_\_( "No" , "maintenance-coming-soon-redirect-animation") .' </span>'; ?></td> |
| [1357](#L1357) | <td class="column-wploti-actions"> |
| [1358](#L1358) | <span class='edit' id="wploti\_mr\_ak\_status\_<?php echo esc\_attr($ak\_code); ?>\_action"> |
| [1359](#L1359) | <?php if( $code->active == 1 ){ ?> |
| [1360](#L1360) | <a href="javascript:wploti\_mr\_toggle\_ak( 0, <?php echo esc\_attr($ak\_code); ?> );"><?php \_e( "Disable" , "maintenance-coming-soon-redirect-animation"); ?></a> | |
| [1361](#L1361) | <?php }else{ ?> |
| [1362](#L1362) | <a href="javascript:wploti\_mr\_toggle\_ak( 1, <?php echo esc\_attr($ak\_code); ?> );"><?php \_e( "Enable" , "maintenance-coming-soon-redirect-animation"); ?></a> | |
| [1363](#L1363) | <?php } ?> |
| [1364](#L1364) | </span> |
| [1365](#L1365) | <span class='resend'> |
| [1366](#L1366) | <a class='submitdelete' href="javascript:wploti\_mr\_resend\_ak( <?php echo esc\_attr($ak\_code) ?>, '<?php echo addslashes( esc\_attr($ak\_name) ) ?>', '<?php echo addslashes( esc\_attr($ak\_email) ) ?>' );" ><?php \_e( "Resend Code" , "maintenance-coming-soon-redirect-animation"); ?></a> | |
| [1367](#L1367) | </span> |
| [1368](#L1368) | <span class='delete'> |
| [1369](#L1369) | <a class='submitdelete' href="javascript:wploti\_mr\_delete\_ak( <?php echo esc\_attr($ak\_code) ?>, '<?php echo addslashes( esc\_attr($ak\_name) ) ?>' );" ><?php \_e( "Delete" , "maintenance-coming-soon-redirect-animation" ); ?></a> |
| [1370](#L1370) | </span> |
| [1371](#L1371) | </td> |
| [1372](#L1372) | </tr> |
| [1373](#L1373) | <?php |
| [1374](#L1374) | $ak\_row\_class = ( $ak\_row\_class == '' ) ? 'alternate' : ''; |
| [1375](#L1375) | endforeach; |
| [1376](#L1376) | } |
| [1377](#L1377) | ?> |
| [1378](#L1378) | <tr id="wploti-ak-NEW" valign="middle"  class="<?php echo esc\_attr($ak\_row\_class); ?>"> |
| [1379](#L1379) | <td class="column-wploti-ak-name"> |
| [1380](#L1380) | <input class="wploti\_mr\_disabled\_field" type="text" id="wploti\_mr\_new\_ak\_name" name="wploti\_mr\_new\_ak\_name" placeholder="<?php \_e( "Enter Name:" , "maintenance-coming-soon-redirect-animation"); ?>"> |
| [1381](#L1381) | </td> |
| [1382](#L1382) | <td class="column-wploti-ak-email"> |
| [1383](#L1383) | <input class="wploti\_mr\_disabled\_field" type="text" id="wploti\_mr\_new\_ak\_email" name="wploti\_mr\_new\_ak\_email" placeholder="<?php \_e( "Enter Email:" , "maintenance-coming-soon-redirect-animation"); ?>"> |
| [1384](#L1384) | </td> |
| [1385](#L1385) | <td class="column-wploti-ak-key">&nbsp;</td> |
| [1386](#L1386) | <td class="column-wploti-ak-active">&nbsp;</td> |
| [1387](#L1387) | <td class="column-wploti-ak-key-creation-date">&nbsp;</td> |
| [1388](#L1388) | <td class="column-wploti-actions"> |
| [1389](#L1389) | <span class='edit' id="wploti\_mr\_add\_ak\_link"> |
| [1390](#L1390) | <a href="javascript:wploti\_mr\_add\_new\_ak( );"><?php \_e( "Add New Access Key" , "maintenance-coming-soon-redirect-animation"); ?></a> |
| [1391](#L1391) | </span> |
| [1392](#L1392) | </td> |
| [1393](#L1393) | </tr> |
| [1394](#L1394) | </tbody> |
| [1395](#L1395) | </table> |
| [1396](#L1396) | <?php |
| [1397](#L1397) | } |
| [1398](#L1398) |  |
| [1399](#L1399) | /\*\* |
| [1400](#L1400) | \* (php)  display activation notice |
| [1401](#L1401) | \* |
| [1402](#L1402) | \* @since 1.0.0 |
| [1403](#L1403) | \* @access public |
| [1404](#L1404) | \* @return void |
| [1405](#L1405) | \*/ |
| [1406](#L1406) |  |
| [1407](#L1407) | function display\_status\_if\_active(){ |
| [1408](#L1408) | global $wpdb , $pagenow , $wploti\_ajax\_nonce ; |
| [1409](#L1409) |  |
| [1410](#L1410) | if ( get\_option( 'wploti\_activation\_notice' ) && current\_user\_can('manage\_options')) { |
| [1411](#L1411) |  |
| [1412](#L1412) | // load the notices view |
| [1413](#L1413) | $current\_screen = get\_current\_screen(); |
| [1414](#L1414) | $current\_user = wp\_get\_current\_user(); |
| [1415](#L1415) | $settingslink = ( $current\_screen->id != "settings\_page\_wploti-settings" ) ? ' <a href="'.wploti\_admin\_url.'">'.\_\_( 'Settings' , 'maintenance-coming-soon-redirect-animation' ).'</a>' : ''; |
| [1416](#L1416) | $welcomemsg = ''; |
| [1417](#L1417) | $welcomemsg .='<div class="wploti-notice notice-success is-dismissable" id="wploti\_enabled\_notice">'; |
| [1418](#L1418) | $welcomemsg .='<lottie-player autoplay="true" loop src="'. esc\_attr(IMG\_path .'/wploti-bg.json').'"  class="wploti\_animation"></lottie-player>'; |
| [1419](#L1419) | $welcomemsg .='<div class="notice-activation-text-wrapper">'; |
| [1420](#L1420) | $welcomemsg .='<p><h3 class="main\_redirect\_msg">' .  \_\_( "Thank you "  . $current\_user->display\_name . " for installing Maintenance & Coming Soon Redirect Animation Plugin!" , "maintenance-coming-soon-redirect-animation" ) . '</h3>'; |
| [1421](#L1421) | $welcomemsg .='<span>'. \_\_( "You can activate the Maintenance Mode in" , "maintenance-coming-soon-redirect-animation" ) . $settingslink . ' ' .  \_\_( "or by Maintenance Status Top bar icon and choose your animation !", "maintenance-coming-soon-redirect-animation" ) .'</span>'; |
| [1422](#L1422) | $welcomemsg .='</div>'; |
| [1423](#L1423) | $welcomemsg .='<div class="wploti-dismiss"><a href="#dismiss" data-security="'. esc\_attr($wploti\_ajax\_nonce) .'" name="wploti-activation-dismiss" class="wploti-activation-dismiss">' . \_\_( "Dismiss" , "maintenance-coming-soon-redirect-animation" ) .' </a></div>'; |
| [1424](#L1424) | $welcomemsg .='</p></div>'; |
| [1425](#L1425) |  |
| [1426](#L1426) | $allowed\_tags = [ |
| [1427](#L1427) |  |
| [1428](#L1428) | 'div' => [ |
| [1429](#L1429) | 'class'         => true, |
| [1430](#L1430) | 'id'            => true, |
| [1431](#L1431) | ], |
| [1432](#L1432) | 'h3' => [ |
| [1433](#L1433) | 'class'         => true, |
| [1434](#L1434) | ], |
| [1435](#L1435) | 'img' => [ |
| [1436](#L1436) | 'src'           => true, |
| [1437](#L1437) | 'class'     => array() |
| [1438](#L1438) | ], |
| [1439](#L1439) | 'a' => [ |
| [1440](#L1440) | 'href'                   => true, |
| [1441](#L1441) | 'data-security'  => true, |
| [1442](#L1442) | 'name'                   => true, |
| [1443](#L1443) | 'class'                  => true, |
| [1444](#L1444) | ], |
| [1445](#L1445) | 'span' => [ |
| [1446](#L1446) | 'class' => array(), |
| [1447](#L1447) | ], |
| [1448](#L1448) | 'lottie-player' => [ |
| [1449](#L1449) | 'autoplay'  => true, |
| [1450](#L1450) | 'loop'      => true, |
| [1451](#L1451) | 'src'           => array(), |
| [1452](#L1452) | 'class'         => array(), |
| [1453](#L1453) | ] |
| [1454](#L1454) |  |
| [1455](#L1455) | ]; |
| [1456](#L1456) |  |
| [1457](#L1457) | echo wp\_kses($welcomemsg , $allowed\_tags); |
| [1458](#L1458) |  |
| [1459](#L1459) | } |
| [1460](#L1460) |  |
| [1461](#L1461) | return; |
| [1462](#L1462) |  |
| [1463](#L1463) | } |
| [1464](#L1464) |  |
| [1465](#L1465) | /\*\* |
| [1466](#L1466) | \* (php)  remove jquery migrate console |
| [1467](#L1467) | \* |
| [1468](#L1468) | \* @since 2.0.0 |
| [1469](#L1469) | \* @access public |
| [1470](#L1470) | \* @return void |
| [1471](#L1471) | \*/ |
| [1472](#L1472) |  |
| [1473](#L1473) | function remove\_jquery\_migrate\_console($scripts) { |
| [1474](#L1474) | if (!empty($scripts->registered['jquery'])) { |
| [1475](#L1475) | $scripts->registered['jquery']->deps = array\_diff($scripts->registered['jquery']->deps, ['jquery-migrate']); |
| [1476](#L1476) | } |
| [1477](#L1477) | } |
| [1478](#L1478) |  |
| [1479](#L1479) |  |
| [1480](#L1480) | /\*\* |
| [1481](#L1481) | \* (php)  Add site health test |
| [1482](#L1482) | \* |
| [1483](#L1483) | \* @since 1.0.0 |
| [1484](#L1484) | \* @access public |
| [1485](#L1485) | \* @return void |
| [1486](#L1486) | \*/ |
| [1487](#L1487) |  |
| [1488](#L1488) | function wploti\_add\_site\_health( $tests ) { |
| [1489](#L1489) | $tests['direct']['wploti\_status'] = array( |
| [1490](#L1490) | 'label' => \_\_( 'Maintenance' ), |
| [1491](#L1491) | 'test'  => array( $this, 'wploti\_site\_health' ), |
| [1492](#L1492) | ); |
| [1493](#L1493) | return $tests; |
| [1494](#L1494) | } |
| [1495](#L1495) |  |
| [1496](#L1496) |  |
| [1497](#L1497) | /\*\* |
| [1498](#L1498) | \* (php)  verify site health status |
| [1499](#L1499) | \* |
| [1500](#L1500) | \* @since 1.0.0 |
| [1501](#L1501) | \* @access public |
| [1502](#L1502) | \* @return array |
| [1503](#L1503) | \*/ |
| [1504](#L1504) |  |
| [1505](#L1505) | function wploti\_site\_health() { |
| [1506](#L1506) |  |
| [1507](#L1507) | global $wploti\_header; |
| [1508](#L1508) |  |
| [1509](#L1509) | $result = array( |
| [1510](#L1510) | 'label'       => \_\_( 'Maintenance Redirect is not enabled' , 'maintenance-coming-soon-redirect-animation' ), |
| [1511](#L1511) | 'status'      => 'good', |
| [1512](#L1512) | 'badge'       => array( |
| [1513](#L1513) | 'label' => \_\_( 'Visibility' ), |
| [1514](#L1514) | 'color' => 'blue', |
| [1515](#L1515) | ), |
| [1516](#L1516) | 'description' => sprintf( |
| [1517](#L1517) | '<p>%s</p>', |
| [1518](#L1518) | \_\_( 'Maintenance is not enabled and your site is visible to visitors.' , 'maintenance-coming-soon-redirect-animation' ) |
| [1519](#L1519) | ), |
| [1520](#L1520) | 'actions'     => sprintf( |
| [1521](#L1521) | '<p><a href="options-general.php?page=wploti-settings">%s</a></p>', |
| [1522](#L1522) | \_\_( 'Settings' ) |
| [1523](#L1523) | ), |
| [1524](#L1524) | 'test'        => 'wploti\_status', |
| [1525](#L1525) | ); |
| [1526](#L1526) |  |
| [1527](#L1527) | if ( $this->wploti\_active() == '1' ) { |
| [1528](#L1528) |  |
| [1529](#L1529) | if ( $wploti\_header == "503" ) { |
| [1530](#L1530) |  |
| [1531](#L1531) | $result['status'] = 'critical'; |
| [1532](#L1532) | $result['badge']['color'] = 'red'; |
| [1533](#L1533) | $result['label'] = \_\_( 'Maintenance is enabled' , 'maintenance-coming-soon-redirect-animation' ); |
| [1534](#L1534) | $result['description'] = sprintf( |
| [1535](#L1535) | '<p>%s</p>', |
| [1536](#L1536) | \_\_( 'Maintenance is enabled and your site is not visible to visitors. Your redirection type is set to 503, which could harm your Google ranking if left on for any length of time.' , 'maintenance-coming-soon-redirect-animation') |
| [1537](#L1537) |  |
| [1538](#L1538) | ); |
| [1539](#L1539) | } else { |
| [1540](#L1540) |  |
| [1541](#L1541) | if( $wploti\_header != '503' ) : |
| [1542](#L1542) | $result['status'] = 'recommended'; |
| [1543](#L1543) | $result['label'] = \_\_( 'Maintenance Redirect is enabled' , 'maintenance-coming-soon-redirect-animation' ); |
| [1544](#L1544) | $result['description'] = sprintf( |
| [1545](#L1545) | '<p>%s</p>', |
| [1546](#L1546) | \_\_( 'Maintenance is enabled and your site is not visible to visitors. Your redirection type is set to ' . $wploti\_header  , 'maintenance-coming-soon-redirect-animation' ) |
| [1547](#L1547) | ); |
| [1548](#L1548) | endif; |
| [1549](#L1549) | } |
| [1550](#L1550) |  |
| [1551](#L1551) | } |
| [1552](#L1552) | return $result; |
| [1553](#L1553) | } |
| [1554](#L1554) |  |
| [1555](#L1555) | /\*\* |
| [1556](#L1556) | \* (php)  Return active status 0 or 1 |
| [1557](#L1557) | \* |
| [1558](#L1558) | \* Default is 0 after plugin installation |
| [1559](#L1559) | \* @since 1.1.1 |
| [1560](#L1560) | \* @return string |
| [1561](#L1561) | \*/ |
| [1562](#L1562) |  |
| [1563](#L1563) | public function wploti\_active() { |
| [1564](#L1564) | return get\_option('wploti\_status', '0') === '0' ? '0': '1'; |
| [1565](#L1565) | } |
| [1566](#L1566) |  |
| [1567](#L1567) | function header\_tab(){ |
| [1568](#L1568) |  |
| [1569](#L1569) | global $wploti\_ajax\_nonce, $headers; |
| [1570](#L1570) |  |
| [1571](#L1571) | ?> |
| [1572](#L1572) |  |
| [1573](#L1573) | <div class="wploti\_mr\_admin\_section" > |
| [1574](#L1574) | <h3 class="big-title"><?php \_e( "Header Type:" , "maintenance-coming-soon-redirect-animation" ); ?></h3> |
| [1575](#L1575) | <p><?php \_e( "When redirect is enabled you can send different header types:" , "maintenance-coming-soon-redirect-animation" ); ?> </p> |
| [1576](#L1576) | <dl> |
| [1577](#L1577) |  |
| [1578](#L1578) | <?php   foreach ( $headers as $header ) {  ?> |
| [1579](#L1579) |  |
| [1580](#L1580) | <dt> |
| [1581](#L1581) | <input type="radio" id="<?php echo esc\_attr($header['code']) ?>" name="wploti\_header\_type" class="wploti\_header\_type" data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ; ?>" <?php checked( get\_option('wploti\_header\_type') ,  esc\_attr($header['code']) ) ?> value="<?php echo esc\_attr($header['code']) ?>"> |
| [1582](#L1582) | <label for="<?php echo esc\_attr($header['code']) ?>"><?php \_e( $header['title'] , "maintenance-coming-soon-redirect-animation") ?></label><br> |
| [1583](#L1583) | </dt> |
| [1584](#L1584) | <dd><?php  echo $header['description']  ; ?></dd> |
| [1585](#L1585) |  |
| [1586](#L1586) | <?php   } ?> |
| [1587](#L1587) |  |
| [1588](#L1588) | </dl> |
| [1589](#L1589) | </div> |
| [1590](#L1590) |  |
| [1591](#L1591) | <?php }   //header\_tab |
| [1592](#L1592) |  |
| [1593](#L1593) | function ip\_tab(){ ?> |
| [1594](#L1594) |  |
| [1595](#L1595) | <div class="wploti\_mr\_admin\_section" > |
| [1596](#L1596) | <h3 class="big-title"><?php \_e( "Unrestricted IP addresses:" , "maintenance-coming-soon-redirect-animation" ); ?>&nbsp;<span class="wploti\_mr\_small\_dim">( <?php \_e( "Your IP address is:" , "maintenance-coming-soon-redirect-animation" ); ?>&nbsp;<?php echo $this->get\_user\_ip(); ?> - <?php \_e( "Your Class C is:" , "maintenance-coming-soon-redirect-animation" ); ?>&nbsp;<?php echo $this->get\_user\_class\_c(); ?> )</span></h3> |
| [1597](#L1597) | <p><?php \_e( "Users with unrestricted IP addresses will bypass maintenance mode entirely. Using this option is useful to an entire office of clients to view the site without needing to jump through any extra hoops." , "maintenance-coming-soon-redirect-animation" ); ?></p> |
| [1598](#L1598) |  |
| [1599](#L1599) | <div id="wploti\_mr\_ip\_tbl\_container"> |
| [1600](#L1600) | <?php $this->print\_unrestricted\_ips(); ?> |
| [1601](#L1601) | </div> |
| [1602](#L1602) | </div> |
| [1603](#L1603) |  |
| [1604](#L1604) | <?php } //ip\_tab / |
| [1605](#L1605) |  |
| [1606](#L1606) |  |
| [1607](#L1607) | function key\_tab(){ ?> |
| [1608](#L1608) |  |
| [1609](#L1609) | <div class="wploti\_mr\_admin\_section"> |
| [1610](#L1610) | <h3 class="big-title"><?php \_e( "Access Keys :" , "maintenance-coming-soon-redirect-animation"); ?></h3> |
| [1611](#L1611) | <p><?php \_e( "You can allow users temporary access by sending them the access key. When a new key is created, a link to create the access key cookie will be emailed to the email address provided. Access can then be revoked either by disabling or deleting the key." , "maintenance-coming-soon-redirect-animation" ); ?></p> |
| [1612](#L1612) |  |
| [1613](#L1613) | <div id="wploti\_mr\_ak\_tbl\_container"> |
| [1614](#L1614) | <?php $this->print\_access\_keys(); ?> |
| [1615](#L1615) | </div> |
| [1616](#L1616) | </div> |
| [1617](#L1617) |  |
| [1618](#L1618) | <?php } |
| [1619](#L1619) |  |
| [1620](#L1620) |  |
| [1621](#L1621) | function animation\_tab(){ |
| [1622](#L1622) |  |
| [1623](#L1623) | ?> |
| [1624](#L1624) |  |
| [1625](#L1625) | <div class="wploti\_mr\_admin\_section"> |
| [1626](#L1626) | <h3 class="big-title"><?php \_e( "Maintenance Animation :" , "maintenance-coming-soon-redirect-animation"); ?></h3> |
| [1627](#L1627) |  |
| [1628](#L1628) | <h4 class="small-title"><?php \_e( "Active Animation :" , "maintenance-coming-soon-redirect-animation"); ?></h4> |
| [1629](#L1629) |  |
| [1630](#L1630) | <div class="selected-animation"> |
| [1631](#L1631) | <lottie-player autoplay="true" loop src="<?php echo esc\_attr( get\_option("wploti\_animation", 'default-animation.json') ) ?>" class="lottieanimation"></lottie-player> |
| [1632](#L1632) | </div> |
| [1633](#L1633) |  |
| [1634](#L1634) | <?php $this->upload\_animation(); ?> |
| [1635](#L1635) |  |
| [1636](#L1636) | <h4 class="small-title"><?php \_e( "Or select one from the animations library :" , "maintenance-coming-soon-redirect-animation" ); ?></h4> |
| [1637](#L1637) | <?php $animations = array\_slice(scandir(\_\_DIR\_\_.'/animations'),2); ?> |
| [1638](#L1638) | <div animations-count="<?php echo esc\_attr(count($animations)); ?>" class="animations"></div> |
| [1639](#L1639) |  |
| [1640](#L1640) | <div id ="load-animations-message"></div> |
| [1641](#L1641) |  |
| [1642](#L1642) | </div> |
| [1643](#L1643) |  |
| [1644](#L1644) | <?php } |
| [1645](#L1645) |  |
| [1646](#L1646) | function wploti\_mime\_types($mimes) { |
| [1647](#L1647) | $mimes['json'] = 'text/plain'; // Usually the MIME type for JSON used here would be 'application/json', but because of a current WordPress core bug it’s being interpreted as 'text/plain' |
| [1648](#L1648) | return $mimes; |
| [1649](#L1649) | } |
| [1650](#L1650) |  |
| [1651](#L1651) | function upload\_animation(){ |
| [1652](#L1652) | ?> |
| [1653](#L1653) |  |
| [1654](#L1654) | <div class="img-select-container" style="display: flex; align-items: center; gap: 40px;"> |
| [1655](#L1655) | <input id="upload\_image" type="hidden" size="36" name="wploti\_upload\_animation" value=<?php echo get\_option('wploti\_upload\_animation'); ?> /> |
| [1656](#L1656) | <input type="button"  name="wploti\_upload\_animation" accept="\*.json, \*.gif" class="button button-secondary upload-button" value="<?php echo esc\_attr( "Upload Your own animation" , "maintenance-coming-soon-redirect-animation"); ?>" data-group="1"> |
| [1657](#L1657) | <?php \_e( "Please upload your animation in JSON format, otherwise it will not be displayed" , "maintenance-coming-soon-redirect-animation" ); ?> |
| [1658](#L1658) | </div> |
| [1659](#L1659) | <?php |
| [1660](#L1660) |  |
| [1661](#L1661) | wp\_enqueue\_media(); ?> |
| [1662](#L1662) |  |
| [1663](#L1663) | <script> |
| [1664](#L1664) | jQuery(document).ready( function($) { |
| [1665](#L1665) |  |
| [1666](#L1666) | // Uploading files |
| [1667](#L1667) | var mediaUploader; |
| [1668](#L1668) |  |
| [1669](#L1669) | $('.upload-button').on('click', function( event ){ |
| [1670](#L1670) |  |
| [1671](#L1671) | event.preventDefault(); |
| [1672](#L1672) |  |
| [1673](#L1673) | var buttonID = $(this).data('id'); |
| [1674](#L1674) |  |
| [1675](#L1675) | // If the media frame already exists, reopen it. |
| [1676](#L1676) | if ( mediaUploader ) { |
| [1677](#L1677) | // Open frame |
| [1678](#L1678) | mediaUploader.id = buttonID; |
| [1679](#L1679) | mediaUploader.open(); |
| [1680](#L1680) | return; |
| [1681](#L1681) | } |
| [1682](#L1682) |  |
| [1683](#L1683) | // Create the media frame. |
| [1684](#L1684) | mediaUploader = wp.media.frames.file\_frame = wp.media({ |
| [1685](#L1685) | id: buttonID, |
| [1686](#L1686) | title: 'Select a file to upload', |
| [1687](#L1687) | button: { |
| [1688](#L1688) | text: 'Select', |
| [1689](#L1689) | }, |
| [1690](#L1690) | multiple: false , // Set to true to allow multiple files to be selected |
| [1691](#L1691) | uploader: { |
| [1692](#L1692) | type: 'text/plain' |
| [1693](#L1693) | } |
| [1694](#L1694) | }); |
| [1695](#L1695) |  |
| [1696](#L1696) | // When an image is selected, run a callback. |
| [1697](#L1697) | mediaUploader.on( 'select', function() { |
| [1698](#L1698) |  |
| [1699](#L1699) | attachment = mediaUploader.state().get('selection').first().toJSON(); |
| [1700](#L1700) |  |
| [1701](#L1701) | var uploaded\_animation = attachment.url; |
| [1702](#L1702) |  |
| [1703](#L1703) | $('.selected-bg').remove(); |
| [1704](#L1704) |  |
| [1705](#L1705) | $('.selected-animation > lottie-player').remove(); |
| [1706](#L1706) | $('.selected-animation').append( |
| [1707](#L1707) | $('<lottie-player/>') |
| [1708](#L1708) | .attr("autoplay", "true") |
| [1709](#L1709) | .attr("loop", "true") |
| [1710](#L1710) | .attr("src", uploaded\_animation) |
| [1711](#L1711) | ) |
| [1712](#L1712) |  |
| [1713](#L1713) | $.ajax({ |
| [1714](#L1714) | url: ajaxurl, |
| [1715](#L1715) | data: { |
| [1716](#L1716) | uploaded\_animation: uploaded\_animation, |
| [1717](#L1717) | action: 'wploti\_uploaded\_animation\_save', |
| [1718](#L1718) | }, |
| [1719](#L1719) | type: 'post', |
| [1720](#L1720) |  |
| [1721](#L1721) | success: function (result, textstatus) { |
| [1722](#L1722) | /\* console.log(result); |
| [1723](#L1723) | console.log('sucess'); \*/ |
| [1724](#L1724) |  |
| [1725](#L1725) | }, |
| [1726](#L1726) | error: function (result) { |
| [1727](#L1727) | /\* console.log(result); |
| [1728](#L1728) | console.log('fail'); \*/ |
| [1729](#L1729) | }, |
| [1730](#L1730) |  |
| [1731](#L1731) | }) |
| [1732](#L1732) |  |
| [1733](#L1733) | }); |
| [1734](#L1734) |  |
| [1735](#L1735) |  |
| [1736](#L1736) | // Finally, open the modal |
| [1737](#L1737) | mediaUploader.open(); |
| [1738](#L1738) | }); |
| [1739](#L1739) |  |
| [1740](#L1740) |  |
| [1741](#L1741) | }); |
| [1742](#L1742) | </script> |
| [1743](#L1743) | <?php |
| [1744](#L1744) | } |
| [1745](#L1745) |  |
| [1746](#L1746) | function wploti\_uploaded\_animation\_save\_option(){ |
| [1747](#L1747) |  |
| [1748](#L1748) | $uploaded\_animation = $\_POST['uploaded\_animation']; |
| [1749](#L1749) |  |
| [1750](#L1750) | update\_option('wploti\_animation' , $uploaded\_animation); |
| [1751](#L1751) |  |
| [1752](#L1752) | wp\_die(); |
| [1753](#L1753) | } |
| [1754](#L1754) |  |
| [1755](#L1755) | function wploti\_add\_whitelisted\_roles\_option(){ |
| [1756](#L1756) |  |
| [1757](#L1757) | if( isset($\_POST['role']) ) { |
| [1758](#L1758) |  |
| [1759](#L1759) | $wploti\_whitelisted\_roles = get\_option('wploti\_whitelisted\_roles'); |
| [1760](#L1760) |  |
| [1761](#L1761) | $whitelisted\_role = $\_POST['role']; |
| [1762](#L1762) |  |
| [1763](#L1763) | if (!in\_array($whitelisted\_role, $wploti\_whitelisted\_roles)){ |
| [1764](#L1764) |  |
| [1765](#L1765) | array\_push( $wploti\_whitelisted\_roles , $whitelisted\_role ) ; |
| [1766](#L1766) |  |
| [1767](#L1767) | } |
| [1768](#L1768) |  |
| [1769](#L1769) | update\_option('wploti\_whitelisted\_roles' , $wploti\_whitelisted\_roles); |
| [1770](#L1770) |  |
| [1771](#L1771) | } |
| [1772](#L1772) |  |
| [1773](#L1773) | wp\_die(); |
| [1774](#L1774) | } |
| [1775](#L1775) |  |
| [1776](#L1776) | function wploti\_remove\_whitelisted\_roles\_option(){ |
| [1777](#L1777) |  |
| [1778](#L1778) | if( isset($\_POST['role']) ) { |
| [1779](#L1779) |  |
| [1780](#L1780) | $wploti\_whitelisted\_roles = get\_option('wploti\_whitelisted\_roles'); |
| [1781](#L1781) |  |
| [1782](#L1782) | $whitelisted\_role = $\_POST['role']; |
| [1783](#L1783) |  |
| [1784](#L1784) | //Delete element key that value match $whitelisted\_role |
| [1785](#L1785) | foreach (array\_keys($wploti\_whitelisted\_roles, $whitelisted\_role, true) as $key) { |
| [1786](#L1786) | unset($wploti\_whitelisted\_roles[$key]); |
| [1787](#L1787) | } |
| [1788](#L1788) |  |
| [1789](#L1789) | update\_option('wploti\_whitelisted\_roles' , $wploti\_whitelisted\_roles); |
| [1790](#L1790) |  |
| [1791](#L1791) | } |
| [1792](#L1792) |  |
| [1793](#L1793) | wp\_die(); |
| [1794](#L1794) | } |
| [1795](#L1795) |  |
| [1796](#L1796) | /\*\* |
| [1797](#L1797) | \* (php) Add whitelisted users option |
| [1798](#L1798) | \* |
| [1799](#L1799) | \* @since 2.0.0 |
| [1800](#L1800) | \* @access public |
| [1801](#L1801) | \* @return void |
| [1802](#L1802) | \*/ |
| [1803](#L1803) |  |
| [1804](#L1804) | function wploti\_add\_whitelisted\_users\_option(){ |
| [1805](#L1805) |  |
| [1806](#L1806) | if ( isset($\_POST['user\_id']) ) { |
| [1807](#L1807) |  |
| [1808](#L1808) | $wploti\_whitelisted\_users = get\_option('wploti\_whitelisted\_users'); |
| [1809](#L1809) |  |
| [1810](#L1810) | $whitelisted\_user = sanitize\_text\_field($\_POST['user\_id']); |
| [1811](#L1811) |  |
| [1812](#L1812) | if (!in\_array($whitelisted\_user, $wploti\_whitelisted\_users)){ |
| [1813](#L1813) |  |
| [1814](#L1814) | array\_push( $wploti\_whitelisted\_users , $whitelisted\_user ) ; |
| [1815](#L1815) |  |
| [1816](#L1816) | } |
| [1817](#L1817) |  |
| [1818](#L1818) | update\_option('wploti\_whitelisted\_users', $wploti\_whitelisted\_users); |
| [1819](#L1819) |  |
| [1820](#L1820) | } |
| [1821](#L1821) |  |
| [1822](#L1822) | wp\_die(); |
| [1823](#L1823) |  |
| [1824](#L1824) | } |
| [1825](#L1825) |  |
| [1826](#L1826) | // |
| [1827](#L1827) |  |
| [1828](#L1828) | /\*\* |
| [1829](#L1829) | \* (php) Remove whitelisted users option |
| [1830](#L1830) | \* |
| [1831](#L1831) | \* @since 2.0.0 |
| [1832](#L1832) | \* @access public |
| [1833](#L1833) | \* @return void |
| [1834](#L1834) | \*/ |
| [1835](#L1835) |  |
| [1836](#L1836) | function wploti\_remove\_whitelisted\_users\_option(){ |
| [1837](#L1837) |  |
| [1838](#L1838) | if( isset($\_POST['user\_id']) ) { |
| [1839](#L1839) |  |
| [1840](#L1840) | $wploti\_whitelisted\_users = get\_option('wploti\_whitelisted\_users'); |
| [1841](#L1841) |  |
| [1842](#L1842) | $whitelisted\_user = sanitize\_text\_field($\_POST['user\_id']); |
| [1843](#L1843) |  |
| [1844](#L1844) | //Delete element key that value match $whitelisted\_user |
| [1845](#L1845) | foreach (array\_keys($wploti\_whitelisted\_users, $whitelisted\_user, true) as $key) { |
| [1846](#L1846) | unset($wploti\_whitelisted\_users[$key]); |
| [1847](#L1847) | } |
| [1848](#L1848) |  |
| [1849](#L1849) | update\_option('wploti\_whitelisted\_users' , $wploti\_whitelisted\_users); |
| [1850](#L1850) |  |
| [1851](#L1851) | } |
| [1852](#L1852) |  |
| [1853](#L1853) | wp\_die(); |
| [1854](#L1854) |  |
| [1855](#L1855) | } |
| [1856](#L1856) |  |
| [1857](#L1857) |  |
| [1858](#L1858) | /\*\*  (php)  toggle activation for admin menu icon |
| [1859](#L1859) | \* |
| [1860](#L1860) | \* @since 1.1.1 |
| [1861](#L1861) | \* @access public |
| [1862](#L1862) | \* @return void |
| [1863](#L1863) | \*/ |
| [1864](#L1864) |  |
| [1865](#L1865) | function wploti\_logout\_users\_callback() { |
| [1866](#L1866) | // Check for ajax payload |
| [1867](#L1867) | if (isset($\_POST['payload']) && $\_POST['payload'] == 'wploti\_logout\_users') { |
| [1868](#L1868) | // Verify nonce |
| [1869](#L1869) | check\_ajax\_referer('wploti\_nonce', 'security'); |
| [1870](#L1870) |  |
| [1871](#L1871) | // Verify user rights |
| [1872](#L1872) | if (!current\_user\_can('manage\_options')) { |
| [1873](#L1873) | wp\_die("Oh no you don't!"); |
| [1874](#L1874) | return; |
| [1875](#L1875) | } |
| [1876](#L1876) |  |
| [1877](#L1877) | // Get All users except administrator |
| [1878](#L1878) | $args = [ |
| [1879](#L1879) | 'role\_\_not\_in' => ['administrator'], |
| [1880](#L1880) | 'fields' => 'ID', |
| [1881](#L1881) | ]; |
| [1882](#L1882) | $users = get\_users($args); |
| [1883](#L1883) | // Loop through the user IDs and log them out |
| [1884](#L1884) | foreach ($users as $user) { |
| [1885](#L1885) | if (is\_user\_logged\_in($user)) { |
| [1886](#L1886) |  |
| [1887](#L1887) | // Get all sessions for the user with ID |
| [1888](#L1888) | $sessions = WP\_Session\_Tokens::get\_instance($user); |
| [1889](#L1889) |  |
| [1890](#L1890) | // Destroy all sessions |
| [1891](#L1891) | $sessions->destroy\_all(); |
| [1892](#L1892) |  |
| [1893](#L1893) | } |
| [1894](#L1894) | } |
| [1895](#L1895) |  |
| [1896](#L1896) | //wp\_send\_json\_success('logout success'); |
| [1897](#L1897) | wp\_die(); |
| [1898](#L1898) | } |
| [1899](#L1899) | } |
| [1900](#L1900) |  |
| [1901](#L1901) |  |
| [1902](#L1902) |  |
| [1903](#L1903) | function message\_tab() { |
| [1904](#L1904) |  |
| [1905](#L1905) | global $wploti\_ajax\_nonce; |
| [1906](#L1906) |  |
| [1907](#L1907) | ?> |
| [1908](#L1908) |  |
| [1909](#L1909) | <div id="wploti\_text\_message"> |
| [1910](#L1910) | <strong><?php \_e( "Maintenance Mode Message (optional) :" , "maintenance-coming-soon-redirect-animation"); ?></strong> |
| [1911](#L1911) | <p><?php \_e( "You can write a brief message that will be displayed under animation :" , "maintenance-coming-soon-redirect-animation"); ?></p> |
| [1912](#L1912) | <?php |
| [1913](#L1913) | $wploti\_message = \_\_( 'This site is currently undergoing maintenance. Please check back later', 'maintenance-coming-soon-redirect-animation' ); |
| [1914](#L1914) | wp\_editor( get\_option('wploti\_message', $wploti\_message), 'content', array('tabfocus\_elements' => 'insert-media-button,save-post', 'editor\_height' => 250, 'resize' => 1, 'editor\_class' => 'wploti\_message', 'textarea\_name' => 'wploti\_message', 'drag\_drop\_upload' => 1)); ?> |
| [1915](#L1915) | </div> |
| [1916](#L1916) |  |
| [1917](#L1917) |  |
| [1918](#L1918) | <?php } |
| [1919](#L1919) |  |
| [1920](#L1920) | function extra\_tab(){ |
| [1921](#L1921) | $wploti\_ajax\_nonce = wp\_create\_nonce( "wploti\_nonce" ); |
| [1922](#L1922) | ?> |
| [1923](#L1923) |  |
| [1924](#L1924) | <div class="wploti-tab-content"> |
| [1925](#L1925) | <table class="form-table"><tbody> |
| [1926](#L1926) | <?php //Whitelisted User Roles |
| [1927](#L1927) | $wploti\_whitelisted\_roles[] = get\_option('wploti\_whitelisted\_roles'); |
| [1928](#L1928) | $wploti\_whitelisted\_users[] = get\_option('wploti\_whitelisted\_users'); |
| [1929](#L1929) | $wploti\_roles = new WP\_Roles(); |
| [1930](#L1930) | $roles = $wploti\_roles->get\_names(); |
| [1931](#L1931) | $users = array(); |
| [1932](#L1932) |  |
| [1933](#L1933) | ?> |
| [1934](#L1934) | <tr valign="top"> |
| [1935](#L1935) | <th scope="row"><?php \_e( "Whitelisted User Roles" , "maintenance-coming-soon-redirect-animation"); ?> :</th> |
| [1936](#L1936) | <td> |
| [1937](#L1937) | <?php |
| [1938](#L1938) | $current\_user = wp\_get\_current\_user(); |
| [1939](#L1939) |  |
| [1940](#L1940) | foreach ($roles as $role\_value => $role\_label) { |
| [1941](#L1941) |  |
| [1942](#L1942) | ?> |
| [1943](#L1943) | <input |
| [1944](#L1944) | type="checkbox" |
| [1945](#L1945) | value="<?php echo esc\_attr($role\_value); ?>" |
| [1946](#L1946) | class="wploti\_whitelisted\_roles" |
| [1947](#L1947) | data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ?>" |
| [1948](#L1948) | <?php if(in\_array( $role\_value , $wploti\_whitelisted\_roles[0] )){ |
| [1949](#L1949) | echo "checked"; |
| [1950](#L1950) | }?> |
| [1951](#L1951) | /> |
| [1952](#L1952) | <label><?php \_e($role\_label , "maintenance-coming-soon-redirect-animation"); ?></label> |
| [1953](#L1953) | <br /> |
| [1954](#L1954) | <?php } |
| [1955](#L1955) | ?> |
| [1956](#L1956) | </td> |
| [1957](#L1957) |  |
| [1958](#L1958) | </tr> |
| [1959](#L1959) | <tr class="description"> |
| [1960](#L1960) | <td  colspan="2"><p ><?php echo \_\_('Selected user roles will <b>not</b> be affected by the maintenance mode and will always see the "normal" site. Default: administrator.', 'maintenance-coming-soon-redirect-animation') ?> </p> </td> |
| [1961](#L1961) | </tr> |
| [1962](#L1962) |  |
| [1963](#L1963) | <?php //Whitelisted Users |
| [1964](#L1964) |  |
| [1965](#L1965) | $tmp\_users = get\_users(array('fields' => array('id', 'display\_name'))); |
| [1966](#L1966) | foreach ($tmp\_users as $user) { |
| [1967](#L1967) | $users[] = array('val' => $user->id, 'label' => $user->display\_name); |
| [1968](#L1968) | } |
| [1969](#L1969) | ?> |
| [1970](#L1970) | <tr valign="top"> |
| [1971](#L1971) |  |
| [1972](#L1972) | <th scope="row"> |
| [1973](#L1973) | <label for="wploti\_whitelisted\_users"><?php \_e( "Whitelisted Users :" , "maintenance-coming-soon-redirect-animation"); ?></label> |
| [1974](#L1974) | </th> |
| [1975](#L1975) | <td> |
| [1976](#L1976) | <select id="wploti\_whitelisted\_users" class="select2" style="width: 100%; max-width: 300px;" name="wploti\_whitelisted\_users" multiple> |
| [1977](#L1977) | <?php |
| [1978](#L1978) | $this->create\_wploti\_select\_options($users , get\_option('wploti\_whitelisted\_users') , true) ; |
| [1979](#L1979) | ?> |
| [1980](#L1980) | </select> |
| [1981](#L1981) | </td> |
| [1982](#L1982) |  |
| [1983](#L1983) | </tr> |
| [1984](#L1984) | <tr class="description"> |
| [1985](#L1985) | <td colspan="2"><p><?php \_e('Selected users (when logged in) will <b>not</b> be affected by the maintenance mode and will always see the "normal" site.', 'maintenance-coming-soon-redirect-animation') ?> </p> </td> |
| [1986](#L1986) | </tr> |
| [1987](#L1987) |  |
| [1988](#L1988) | <tr class="logout-extra"> |
| [1989](#L1989) | <td><input type="button" value="<?php esc\_attr\_e( 'Logout All users', 'maintenance-coming-soon-redirect-animation' ); ?>" class="button button-secondary wploti\_logout\_users" data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ; ?>" name="logout" /></td> |
| [1990](#L1990) | <td colspan="2"><p id="logged\_out\_description"><?php \_e('Execute a complete log-out for all currently signed-in users with a single click.', 'maintenance-coming-soon-redirect-animation') ?> </p> </td> |
| [1991](#L1991) | </tr> |
| [1992](#L1992) |  |
| [1993](#L1993) | </table> |
| [1994](#L1994) | </div> |
| [1995](#L1995) |  |
| [1996](#L1996) | <?php |
| [1997](#L1997) | } |
| [1998](#L1998) |  |
| [1999](#L1999) | /\*\* |
| [2000](#L2000) | \* (php)  check if user has the specified role |
| [2001](#L2001) | \* |
| [2002](#L2002) | \* @since 2.0.0 |
| [2003](#L2003) | \* @access public |
| [2004](#L2004) | \* @return boolean |
| [2005](#L2005) | \*/ |
| [2006](#L2006) | function user\_has\_role($roles){ |
| [2007](#L2007) | $current\_user = wp\_get\_current\_user(); |
| [2008](#L2008) |  |
| [2009](#L2009) | if ($current\_user->roles) { |
| [2010](#L2010) | $user\_role = $current\_user->roles[0]; |
| [2011](#L2011) | } else { |
| [2012](#L2012) | $user\_role = 'guest'; |
| [2013](#L2013) | } |
| [2014](#L2014) |  |
| [2015](#L2015) | return in\_array($user\_role, $roles); |
| [2016](#L2016) | } // user\_has\_role |
| [2017](#L2017) |  |
| [2018](#L2018) |  |
| [2019](#L2019) | /\*\* |
| [2020](#L2020) | \* (php)  helper function for creating dropdowns |
| [2021](#L2021) | \* |
| [2022](#L2022) | \* @since 2.0.0 |
| [2023](#L2023) | \* @access public |
| [2024](#L2024) | \* @return boolean |
| [2025](#L2025) | \*/ |
| [2026](#L2026) | function create\_wploti\_select\_options($options, $selected = null, $output = true) |
| [2027](#L2027) | { |
| [2028](#L2028) | $out = "\n"; |
| [2029](#L2029) |  |
| [2030](#L2030) | if (!is\_array($selected)) { |
| [2031](#L2031) | $selected = array($selected); |
| [2032](#L2032) | } |
| [2033](#L2033) |  |
| [2034](#L2034) | foreach ($options as $tmp) { |
| [2035](#L2035) | $data = ''; |
| [2036](#L2036) | if (isset($tmp['disabled'])) { |
| [2037](#L2037) | $data .= ' disabled="disabled" '; |
| [2038](#L2038) | } |
| [2039](#L2039) | if (in\_array($tmp['val'], $selected)) { |
| [2040](#L2040) | $out .= "<option selected=\"selected\" value=\"{$tmp['val']}\"{$data}>{$tmp['label']}&nbsp;</option>\n"; |
| [2041](#L2041) | } else { |
| [2042](#L2042) | $out .= "<option value=\"{$tmp['val']}\"{$data}>{$tmp['label']}&nbsp;</option>\n"; |
| [2043](#L2043) | } |
| [2044](#L2044) | } // foreach |
| [2045](#L2045) |  |
| [2046](#L2046) | if ($output) { |
| [2047](#L2047) | //echo ($out); |
| [2048](#L2048) | echo wp\_kses( $out, |
| [2049](#L2049) | array( |
| [2050](#L2050) | 'option' => array( |
| [2051](#L2051) | 'selected' => array(), |
| [2052](#L2052) | 'value' => array(), |
| [2053](#L2053) | 'rel' => array(), |
| [2054](#L2054) | ) |
| [2055](#L2055) | ) |
| [2056](#L2056) | ); |
| [2057](#L2057) | } else { |
| [2058](#L2058) | return $out; |
| [2059](#L2059) | } |
| [2060](#L2060) | } // create\_wploti\_select\_options |
| [2061](#L2061) |  |
| [2062](#L2062) |  |
| [2063](#L2063) | /\*\* |
| [2064](#L2064) | \* (php)  create the admin page |
| [2065](#L2065) | \* |
| [2066](#L2066) | \* @since 1.0.0 |
| [2067](#L2067) | \* @access public |
| [2068](#L2068) | \* @return array |
| [2069](#L2069) | \*/ |
| [2070](#L2070) |  |
| [2071](#L2071) | function print\_admin\_page() { |
| [2072](#L2072) | global $wpdb; |
| [2073](#L2073) | global $wploti\_ajax\_nonce; |
| [2074](#L2074) |  |
| [2075](#L2075) | // display update notice |
| [2076](#L2076) | echo '<div class="updated" style="display: none" ><p><strong>'. \_\_("Settings Saved" , "maintenance-coming-soon-redirect-animation" ) .'</strong></p></div>'; |
| [2077](#L2077) |  |
| [2078](#L2078) | ?> |
| [2079](#L2079) |  |
| [2080](#L2080) | <!-- \*\*\*\*\*\*\*\*\*\*\*\*\*\*  JS  \*\*\*\*\*\*\*\*\*\*\*\*\*\* --> |
| [2081](#L2081) |  |
| [2082](#L2082) | <script type="text/javascript" charset="utf-8"> |
| [2083](#L2083) |  |
| [2084](#L2084) | /\*\* |
| [2085](#L2085) | \* (js) custom alert |
| [2086](#L2086) | \* |
| [2087](#L2087) | \* @since 1.0.0 |
| [2088](#L2088) | \* @param string msg1 |
| [2089](#L2089) | \* @param string msg2 |
| [2090](#L2090) | \* @return string |
| [2091](#L2091) | \*/ |
| [2092](#L2092) |  |
| [2093](#L2093) | function wploti\_alert(msg1, msg2) { |
| [2094](#L2094) | var alertContent = ` |
| [2095](#L2095) | <div class="modal"> |
| [2096](#L2096) | <div class="modal-content"> |
| [2097](#L2097) | <div class="modal-header"> |
| [2098](#L2098) | <img class="alert-icon" src="<?php echo esc\_attr ( plugin\_dir\_url( \_\_FILE\_\_ ).'/images/alert-icon.png' )?>" alt="Alert Icon" /> |
| [2099](#L2099) | </div> |
| [2100](#L2100) | <div class="messages"> |
| [2101](#L2101) | <div>${msg1}</div> |
| [2102](#L2102) | <div>${msg2}</div> |
| [2103](#L2103) | </div> |
| [2104](#L2104) | <div class="modal-footer"> |
| [2105](#L2105) | <button value="Reset settings" class="button button-primary ok\_wploti\_alert" name="ok\_wploti\_alert">OK</button> |
| [2106](#L2106) | </div> |
| [2107](#L2107) | </div> |
| [2108](#L2108) | </div>` |
| [2109](#L2109) | var modal = document.createElement("div"); |
| [2110](#L2110) | modal.innerHTML = alertContent; |
| [2111](#L2111) | document.body.appendChild(modal); |
| [2112](#L2112) |  |
| [2113](#L2113) | jQuery('.ok\_wploti\_alert').click( function(){ |
| [2114](#L2114) | jQuery('.modal').fadeOut('1000'); |
| [2115](#L2115) | }) |
| [2116](#L2116) | } |
| [2117](#L2117) |  |
| [2118](#L2118) | /\*\* |
| [2119](#L2119) | \* (js) custom confirm |
| [2120](#L2120) | \* |
| [2121](#L2121) | \* @since 1.0.0 |
| [2122](#L2122) | \* @param {object options} The properties to create the element with |
| [2123](#L2123) | \* @return object |
| [2124](#L2124) | \*/ |
| [2125](#L2125) |  |
| [2126](#L2126) | const wploti\_confirm = { |
| [2127](#L2127) | open (options) { |
| [2128](#L2128) | options = Object.assign({}, { |
| [2129](#L2129) | message: '', |
| [2130](#L2130) | okText: 'OK', |
| [2131](#L2131) | cancelText: 'Cancel', |
| [2132](#L2132) | onok: function () {}, |
| [2133](#L2133) | oncancel: function () {} |
| [2134](#L2134) | }, options); |
| [2135](#L2135) |  |
| [2136](#L2136) |  |
| [2137](#L2137) | var confirmContent = ` |
| [2138](#L2138) | <div class="modal"> |
| [2139](#L2139) | <div class="modal-content"> |
| [2140](#L2140) | <div class="modal-header"> |
| [2141](#L2141) | <img class="alert-icon" src="<?php echo esc\_attr ( plugin\_dir\_url( \_\_FILE\_\_ ).'/images/alert-icon.png' )?>" alt="Alert Icon" /> |
| [2142](#L2142) | </div> |
| [2143](#L2143) | <div class="messages"> |
| [2144](#L2144) | <div>${options.message}</div> |
| [2145](#L2145) | </div> |
| [2146](#L2146) | <div class="modal-footer"> |
| [2147](#L2147) | <button value="OK" class="button button-primary ok\_wploti\_confirm" name="ok\_wploti\_alert">${options.okText}</button> |
| [2148](#L2148) | <button value="${options.cancelText}" class="button button-secondary cancel\_wploti\_confirm" name="cancel\_wploti\_alert"><?php \_e('Cancel', 'maintenance-coming-soon-redirect-animation' ) ?></button> |
| [2149](#L2149) | </div> |
| [2150](#L2150) | </div> |
| [2151](#L2151) | </div>` |
| [2152](#L2152) | var modal = document.createElement("div"); |
| [2153](#L2153) | modal.innerHTML = confirmContent; |
| [2154](#L2154) | document.body.appendChild(modal); |
| [2155](#L2155) |  |
| [2156](#L2156) | jQuery('.cancel\_wploti\_confirm').click( function(){ |
| [2157](#L2157) | options.oncancel(); |
| [2158](#L2158) | jQuery('.modal').fadeOut('1000'); |
| [2159](#L2159) | }) |
| [2160](#L2160) |  |
| [2161](#L2161) | jQuery('.ok\_wploti\_confirm').click( function(){ |
| [2162](#L2162) | options.onok(); |
| [2163](#L2163) | jQuery('.modal').fadeOut('1000'); |
| [2164](#L2164) | }) |
| [2165](#L2165) | } |
| [2166](#L2166) | } |
| [2167](#L2167) |  |
| [2168](#L2168) | /\*\* |
| [2169](#L2169) | \* (js) validate IP4 address |
| [2170](#L2170) | \* |
| [2171](#L2171) | \* @since 1.0.0 |
| [2172](#L2172) | \* @param string ipaddress |
| [2173](#L2173) | \* @return boolean |
| [2174](#L2174) | \*/ |
| [2175](#L2175) |  |
| [2176](#L2176) | function ValidateIPaddress(ipaddress) { |
| [2177](#L2177) | if (/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|\\*))$/.test(ipaddress)) { |
| [2178](#L2178) | return true |
| [2179](#L2179) | } |
| [2180](#L2180) | } |
| [2181](#L2181) |  |
| [2182](#L2182) | /\*\* |
| [2183](#L2183) | \* (js) add new IP |
| [2184](#L2184) | \* |
| [2185](#L2185) | \* @since 1.0.0 |
| [2186](#L2186) | \* @return void |
| [2187](#L2187) | \*/ |
| [2188](#L2188) |  |
| [2189](#L2189) | function wploti\_mr\_add\_new\_ip () { |
| [2190](#L2190) | // validate entries before posting ajax call |
| [2191](#L2191) | var error\_msg = ''; |
| [2192](#L2192) | if( jQuery('#wploti\_mr\_new\_ip\_name').val() == ''                              ) error\_msg += '<?php \_e( "You must enter a Name" , "maintenance-coming-soon-redirect-animation"); ?>.\n<br>'; |
| [2193](#L2193) | if( jQuery('#wploti\_mr\_new\_ip\_name').val() == '<?php \_e( "Enter Name:" , "maintenance-coming-soon-redirect-animation"); ?>' ) error\_msg += '<?php \_e( "You must enter a Name" , "maintenance-coming-soon-redirect-animation"); ?>.\n<br>'; |
| [2194](#L2194) | if( jQuery('#wploti\_mr\_new\_ip\_ip'  ).val() == ''                              ) error\_msg += '<?php \_e( "You must enter an IP" , "maintenance-coming-soon-redirect-animation"); ?>.\n<br>'; |
| [2195](#L2195) | if( jQuery('#wploti\_mr\_new\_ip\_ip'  ).val() == '<?php \_e( "Enter IP:" , "maintenance-coming-soon-redirect-animation"); ?>'   ) error\_msg += '<?php \_e( "You must enter an IP" , "maintenance-coming-soon-redirect-animation"); ?>.\n<br>'; |
| [2196](#L2196) | if( ValidateIPaddress( jQuery('#wploti\_mr\_new\_ip\_ip'  ).val() ) != true   ) error\_msg += '<?php \_e( "IP address not valid" , "maintenance-coming-soon-redirect-animation"); ?>.\n<br>'; |
| [2197](#L2197) | if( error\_msg != '' ){ |
| [2198](#L2198) | wploti\_alert('<?php \_e( "There is a problem with the information you have entered" , "maintenance-coming-soon-redirect-animation"); ?>.\n\n' , error\_msg ) |
| [2199](#L2199) |  |
| [2200](#L2200) | }else{ |
| [2201](#L2201) | // prepare ajax data |
| [2202](#L2202) | var data = { |
| [2203](#L2203) | action:         'wploti\_mr\_add\_ip', |
| [2204](#L2204) | security:               '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2205](#L2205) | wploti\_mr\_ip\_name:      jQuery('#wploti\_mr\_new\_ip\_name').val(), |
| [2206](#L2206) | wploti\_mr\_ip\_ip:        jQuery('#wploti\_mr\_new\_ip\_ip').val() |
| [2207](#L2207) | }; |
| [2208](#L2208) |  |
| [2209](#L2209) | // set section to loading img |
| [2210](#L2210) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2211](#L2211) | jQuery( '#wploti\_mr\_ip\_tbl\_container' ).html('<img src="' + img\_url + '">'); |
| [2212](#L2212) |  |
| [2213](#L2213) | // send ajax request |
| [2214](#L2214) | jQuery.post( ajaxurl, data, function(response) { |
| [2215](#L2215) | jQuery('#wploti\_mr\_ip\_tbl\_container').html( response ); |
| [2216](#L2216) | }); |
| [2217](#L2217) | } |
| [2218](#L2218) | } |
| [2219](#L2219) |  |
| [2220](#L2220) | /\*\* |
| [2221](#L2221) | \* (js) toggle IP status |
| [2222](#L2222) | \* |
| [2223](#L2223) | \* @since 1.0.0 |
| [2224](#L2224) | \* @param status boolean |
| [2225](#L2225) | \* @param ip\_id number |
| [2226](#L2226) | \* @return void |
| [2227](#L2227) | \*/ |
| [2228](#L2228) |  |
| [2229](#L2229) | function wploti\_mr\_toggle\_ip ( status, ip\_id ) { |
| [2230](#L2230) | // prepare ajax data |
| [2231](#L2231) | var data = { |
| [2232](#L2232) | action:                 'wploti\_mr\_toggle\_ip', |
| [2233](#L2233) | security:                       '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2234](#L2234) | wploti\_mr\_ip\_active:    status, |
| [2235](#L2235) | wploti\_mr\_ip\_id:        ip\_id |
| [2236](#L2236) | }; |
| [2237](#L2237) |  |
| [2238](#L2238) | // (js) set status to loading img |
| [2239](#L2239) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2240](#L2240) | jQuery( '#wploti\_mr\_ip\_status\_' + ip\_id ).html('<img src="' + img\_url + '">'); |
| [2241](#L2241) |  |
| [2242](#L2242) | // send ajax request |
| [2243](#L2243) | jQuery.post( ajaxurl, data, function(response) { |
| [2244](#L2244) | var split\_response = response.split('|'); |
| [2245](#L2245) | if( split\_response[0] == 'SUCCESS' ){ |
| [2246](#L2246) | var ip\_id     = split\_response[1]; |
| [2247](#L2247) | var ip\_active = split\_response[1]; |
| [2248](#L2248) | // update divs / 1 = id / 2 = status |
| [2249](#L2249) | if( split\_response[2] == '1' ){ |
| [2250](#L2250) | // active |
| [2251](#L2251) | jQuery('#wploti\_mr\_ip\_status\_' + split\_response[1] ).html( '<span class="green">Yes</span>' ); |
| [2252](#L2252) | jQuery('#wploti\_mr\_ip\_status\_' + split\_response[1] + '\_action' ).html( '<a href="javascript:wploti\_mr\_toggle\_ip( 0, ' + split\_response[1] + ' );"><?php \_e( "Disable" , "maintenance-coming-soon-redirect-animation"); ?></a> | ' ); |
| [2253](#L2253) | }else{ |
| [2254](#L2254) | // disabled |
| [2255](#L2255) | jQuery('#wploti\_mr\_ip\_status\_' + split\_response[1] ).html( '<span class="red">No</span>' ); |
| [2256](#L2256) | jQuery('#wploti\_mr\_ip\_status\_' + split\_response[1] + '\_action' ).html( '<a href="javascript:wploti\_mr\_toggle\_ip( 1, ' + split\_response[1] + ' );"><?php \_e( "Enable" , "maintenance-coming-soon-redirect-animation"); ?></a> | ' ); |
| [2257](#L2257) | } |
| [2258](#L2258) | }else{ |
| [2259](#L2259) | wploti\_alert( '<?php \_e( "There was a database error. Please reload this page" , "maintenance-coming-soon-redirect-animation"); ?>' ); |
| [2260](#L2260) | } |
| [2261](#L2261) | }); |
| [2262](#L2262) | } |
| [2263](#L2263) |  |
| [2264](#L2264) | /\*\* |
| [2265](#L2265) | \* (js) delete IP |
| [2266](#L2266) | \* |
| [2267](#L2267) | \* @since 1.0.0 |
| [2268](#L2268) | \* @param ip\_addr string |
| [2269](#L2269) | \* @param ip\_id number |
| [2270](#L2270) | \* @return void |
| [2271](#L2271) | \*/ |
| [2272](#L2272) |  |
| [2273](#L2273) | function wploti\_mr\_delete\_ip ( ip\_id, ip\_addr ) { |
| [2274](#L2274) |  |
| [2275](#L2275) | wploti\_confirm.open({ |
| [2276](#L2276) |  |
| [2277](#L2277) | message: '<?php \_e( "You are about to delete the IP address:" , "maintenance-coming-soon-redirect-animation"); ?>\n\n\'' + ip\_addr + '\'\n\n', |
| [2278](#L2278) | onok: () => { |
| [2279](#L2279) | // prepare ajax data |
| [2280](#L2280) | var data = { |
| [2281](#L2281) | action:         'wploti\_mr\_delete\_ip', |
| [2282](#L2282) | security:               '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2283](#L2283) | wploti\_mr\_ip\_id:   ip\_id |
| [2284](#L2284) | }; |
| [2285](#L2285) |  |
| [2286](#L2286) | // set section to loading img |
| [2287](#L2287) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2288](#L2288) | jQuery( '#wploti\_mr\_ip\_tbl\_container' ).html('<img src="' + img\_url + '">'); |
| [2289](#L2289) |  |
| [2290](#L2290) | // send ajax request |
| [2291](#L2291) | jQuery.post( ajaxurl, data, function(response) { |
| [2292](#L2292) | jQuery('#wploti\_mr\_ip\_tbl\_container').html( response ); |
| [2293](#L2293) | }); |
| [2294](#L2294) | } |
| [2295](#L2295) | }) |
| [2296](#L2296) | } |
| [2297](#L2297) |  |
| [2298](#L2298) | /\*\* |
| [2299](#L2299) | \* (js) add new Access Key |
| [2300](#L2300) | \* |
| [2301](#L2301) | \* @since 1.0.0 |
| [2302](#L2302) | \* @param ak\_email string |
| [2303](#L2303) | \* @return void |
| [2304](#L2304) | \*/ |
| [2305](#L2305) |  |
| [2306](#L2306) | function wploti\_mr\_add\_new\_ak (ak\_email) { |
| [2307](#L2307) | // validate entries before posting ajax call |
| [2308](#L2308) | var error\_msg = ''; |
| [2309](#L2309) | var ak\_email = jQuery('#wploti\_mr\_new\_ak\_email').val() |
| [2310](#L2310) | if( jQuery('#wploti\_mr\_new\_ak\_name' ).val() == ''                               ) error\_msg += '<?php \_e( "You must enter a Name" , "maintenance-coming-soon-redirect-animation"); ?>.<br>\n'; |
| [2311](#L2311) | if( jQuery('#wploti\_mr\_new\_ak\_name' ).val() == '<?php \_e( "Enter Name:" , "maintenance-coming-soon-redirect-animation"); ?>'  ) error\_msg += '<?php \_e( "You must enter a Name" , "maintenance-coming-soon-redirect-animation"); ?>.<br>\n'; |
| [2312](#L2312) | if( jQuery('#wploti\_mr\_new\_ak\_email').val() == ''                               ) error\_msg += '<?php \_e( "You must enter an Email" , "maintenance-coming-soon-redirect-animation"); ?>.<br>\n'; |
| [2313](#L2313) | if( jQuery('#wploti\_mr\_new\_ak\_email').val() == '<?php \_e( "Enter Email:" ); ?>' ) error\_msg += '<?php \_e( "You must enter an Email" , "maintenance-coming-soon-redirect-animation"); ?>.<br>\n'; |
| [2314](#L2314) | if( error\_msg != '' ){ |
| [2315](#L2315) | wploti\_alert( '<?php \_e( "There is a problem with the information you have entered" , "maintenance-coming-soon-redirect-animation"); ?>.\n\n' , error\_msg ); |
| [2316](#L2316) |  |
| [2317](#L2317) | }else{ |
| [2318](#L2318) |  |
| [2319](#L2319) | wploti\_confirm.open({ |
| [2320](#L2320) |  |
| [2321](#L2321) | message : '<?php \_e( "You are about to email an Access Key link to" , "maintenance-coming-soon-redirect-animation"); ?> <b>' + ak\_email + '</b> !<br> <?php \_e( "If you do not see the email in a few secondes," , "maintenance-coming-soon-redirect-animation") ?> <br> <?php \_e("Please check your “junk mail” or “spam” folder." , "maintenance-coming-soon-redirect-animation") ?> \n\n', |
| [2322](#L2322) | onok: () => { |
| [2323](#L2323) | // prepare ajax data |
| [2324](#L2324) | var data = { |
| [2325](#L2325) | action:         'wploti\_mr\_add\_ak', |
| [2326](#L2326) | security:               '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2327](#L2327) | wploti\_mr\_ak\_name:  jQuery('#wploti\_mr\_new\_ak\_name').val(), |
| [2328](#L2328) | wploti\_mr\_ak\_email: jQuery('#wploti\_mr\_new\_ak\_email').val() |
| [2329](#L2329) | }; |
| [2330](#L2330) |  |
| [2331](#L2331) | // set section to loading img |
| [2332](#L2332) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2333](#L2333) | jQuery( '#wploti\_mr\_ak\_tbl\_container' ).html('<img src="' + img\_url + '">'); |
| [2334](#L2334) |  |
| [2335](#L2335) | // send ajax request |
| [2336](#L2336) | jQuery.post( ajaxurl, data, function(response) { |
| [2337](#L2337) | jQuery('#wploti\_mr\_ak\_tbl\_container').html( response ); |
| [2338](#L2338) | }); |
| [2339](#L2339) | } |
| [2340](#L2340) | }) |
| [2341](#L2341) |  |
| [2342](#L2342) | } |
| [2343](#L2343) | } |
| [2344](#L2344) | /\*\* |
| [2345](#L2345) | \* (js) toggle Access Key status ( Enable || disable  Access Key ) |
| [2346](#L2346) | \* |
| [2347](#L2347) | \* @since 1.0.0 |
| [2348](#L2348) | \* @param status string |
| [2349](#L2349) | \* @param ak\_id number |
| [2350](#L2350) | \* @return void |
| [2351](#L2351) | \*/ |
| [2352](#L2352) |  |
| [2353](#L2353) | function wploti\_mr\_toggle\_ak ( status, ak\_id ) { |
| [2354](#L2354) | // prepare ajax data |
| [2355](#L2355) | var data = { |
| [2356](#L2356) | action:                 'wploti\_mr\_toggle\_ak', |
| [2357](#L2357) | security:                       '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2358](#L2358) | wploti\_mr\_ak\_active:    status, |
| [2359](#L2359) | wploti\_mr\_ak\_id:        ak\_id |
| [2360](#L2360) | }; |
| [2361](#L2361) |  |
| [2362](#L2362) | // set status to loading img |
| [2363](#L2363) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2364](#L2364) | jQuery( '#wploti\_mr\_ak\_status\_' + ak\_id ).html('<img src="' + img\_url + '">'); |
| [2365](#L2365) |  |
| [2366](#L2366) | // send ajax request |
| [2367](#L2367) | jQuery.post( ajaxurl, data, function(response) { |
| [2368](#L2368) | var split\_response = response.split('|'); |
| [2369](#L2369) | if( split\_response[0] == 'SUCCESS' ){ |
| [2370](#L2370) | var ak\_id     = split\_response[1]; |
| [2371](#L2371) | var ak\_active = split\_response[1]; |
| [2372](#L2372) | // update divs / 1 = id / 2 = status |
| [2373](#L2373) | if( split\_response[2] == '1' ){ |
| [2374](#L2374) | // active |
| [2375](#L2375) | jQuery('#wploti\_mr\_ak\_status\_' + split\_response[1] ).html( '<span class="green">Yes</span>' ); |
| [2376](#L2376) | jQuery('#wploti\_mr\_ak\_status\_' + split\_response[1] + '\_action' ).html( '<a href="javascript:wploti\_mr\_toggle\_ak( 0, ' + split\_response[1] + ' );"><?php \_e( "Disable" , "maintenance-coming-soon-redirect-animation"); ?></a> | ' ); |
| [2377](#L2377) | }else{ |
| [2378](#L2378) | // disabled |
| [2379](#L2379) | jQuery('#wploti\_mr\_ak\_status\_' + split\_response[1] ).html( '<span class="red">No</span>' ); |
| [2380](#L2380) | jQuery('#wploti\_mr\_ak\_status\_' + split\_response[1] + '\_action' ).html( '<a href="javascript:wploti\_mr\_toggle\_ak( 1, ' + split\_response[1] + ' );"><?php \_e( "Enable" , "maintenance-coming-soon-redirect-animation"); ?></a> | ' ); |
| [2381](#L2381) | } |
| [2382](#L2382) | }else{ |
| [2383](#L2383) | wploti\_alert( '<?php \_e( "There was a database error. Please reload this page" , "maintenance-coming-soon-redirect-animation"); ?>' , ' ' ); |
| [2384](#L2384) | } |
| [2385](#L2385) | }); |
| [2386](#L2386) | } |
| [2387](#L2387) |  |
| [2388](#L2388) | /\*\* |
| [2389](#L2389) | \* (js) delete Access Key |
| [2390](#L2390) | \* |
| [2391](#L2391) | \* @since 1.0.0 |
| [2392](#L2392) | \* @param ak\_id number |
| [2393](#L2393) | \* @param ak\_name string |
| [2394](#L2394) | \* @return void |
| [2395](#L2395) | \*/ |
| [2396](#L2396) |  |
| [2397](#L2397) | function wploti\_mr\_delete\_ak ( ak\_id, ak\_name ) { |
| [2398](#L2398) |  |
| [2399](#L2399) | wploti\_confirm.open({ |
| [2400](#L2400) |  |
| [2401](#L2401) | message: '<?php \_e( "You are about to delete this Access Key:" , "maintenance-coming-soon-redirect-animation" ); ?>\n\n\'' + ak\_name + '\'\n\n', |
| [2402](#L2402) | onok: () => { |
| [2403](#L2403) | // prepare ajax data |
| [2404](#L2404) | var data = { |
| [2405](#L2405) | action:         'wploti\_mr\_delete\_ak', |
| [2406](#L2406) | security:               '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2407](#L2407) | wploti\_mr\_ak\_id:        ak\_id |
| [2408](#L2408) | }; |
| [2409](#L2409) |  |
| [2410](#L2410) | // set section to loading img |
| [2411](#L2411) | var img\_url = '<?php echo plugins\_url( 'images/ajax\_loader\_16x16.gif', \_\_FILE\_\_ ); ?>'; |
| [2412](#L2412) | jQuery( '#wploti\_mr\_ak\_tbl\_container' ).html('<img src="' + img\_url + '">'); |
| [2413](#L2413) |  |
| [2414](#L2414) | // send ajax request |
| [2415](#L2415) | jQuery.post( ajaxurl, data, function(response) { |
| [2416](#L2416) | jQuery('#wploti\_mr\_ak\_tbl\_container').html( response ); |
| [2417](#L2417) | }); |
| [2418](#L2418) | } |
| [2419](#L2419) | }) |
| [2420](#L2420) | } |
| [2421](#L2421) |  |
| [2422](#L2422) |  |
| [2423](#L2423) | /\*\* |
| [2424](#L2424) | \* (js) re-send Access Key |
| [2425](#L2425) | \* |
| [2426](#L2426) | \* @since 1.0.0 |
| [2427](#L2427) | \* @param ak\_id number |
| [2428](#L2428) | \* @param ak\_name string |
| [2429](#L2429) | \* @param ak\_email string |
| [2430](#L2430) | \* @return void |
| [2431](#L2431) | \*/ |
| [2432](#L2432) |  |
| [2433](#L2433) | function wploti\_mr\_resend\_ak ( ak\_id, ak\_name, ak\_email ) { |
| [2434](#L2434) |  |
| [2435](#L2435) | wploti\_confirm.open({ |
| [2436](#L2436) | message : '<?php \_e( "You are about to resend an Access Key link to" , "maintenance-coming-soon-redirect-animation" ); ?> <b>' + ak\_email + '</b> !<br> <?php \_e( "If you do not see the email in a few secondes," , "maintenance-coming-soon-redirect-animation") ?> <br> <?php \_e("Please check your “junk mail” or “spam” folder." , "maintenance-coming-soon-redirect-animation" ) ?> \n\n', |
| [2437](#L2437) | onok: () => { |
| [2438](#L2438) | // prepare ajax data |
| [2439](#L2439) | var data = { |
| [2440](#L2440) | action:         'wploti\_mr\_resend\_ak', |
| [2441](#L2441) | security:               '<?php echo $wploti\_ajax\_nonce; ?>', |
| [2442](#L2442) | wploti\_mr\_ak\_id:        ak\_id |
| [2443](#L2443) | }; |
| [2444](#L2444) |  |
| [2445](#L2445) | // send ajax request |
| [2446](#L2446) | jQuery.post( ajaxurl, data, function(response) { |
| [2447](#L2447) | if( response == 'SEND\_SUCCESS' ){ |
| [2448](#L2448) | wploti\_alert( '<?php \_e( "Notification Sent." , "maintenance-coming-soon-redirect-animation" ); ?>','' ); |
| [2449](#L2449) | }else{ |
| [2450](#L2450) | wploti\_alert( '<?php \_e( "Notification Failure. Please check your server settings." , "maintenance-coming-soon-redirect-animation" ); ?>','' ); |
| [2451](#L2451) | } |
| [2452](#L2452) | }); |
| [2453](#L2453) | } |
| [2454](#L2454) | }) |
| [2455](#L2455) |  |
| [2456](#L2456) | } |
| [2457](#L2457) |  |
| [2458](#L2458) | /\*\* |
| [2459](#L2459) | \* (js) RESET SETTINGS |
| [2460](#L2460) | \* |
| [2461](#L2461) | \* @since 1.0.0 |
| [2462](#L2462) | \* @return void |
| [2463](#L2463) | \*/ |
| [2464](#L2464) |  |
| [2465](#L2465) | jQuery('.wploti\_reset\_settings').click(function() { |
| [2466](#L2466) | var security = jQuery(this).data('security'); |
| [2467](#L2467) | wploti\_confirm.open({ |
| [2468](#L2468) | message: '<?php \_e( "Please Be careful ! " , "maintenance-coming-soon-redirect-animation" ) . '<br><br>' . \_e( "Please Be careful ! " , "maintenance-coming-soon-redirect-animation" ) ?>', |
| [2469](#L2469) | onok: () => { |
| [2470](#L2470) | jQuery.ajax({ |
| [2471](#L2471) | url: ajaxurl, |
| [2472](#L2472) | data: { |
| [2473](#L2473) | action: 'wploti\_reset\_settings', |
| [2474](#L2474) | security: security, |
| [2475](#L2475) | }, |
| [2476](#L2476) | type: 'post', |
| [2477](#L2477) | success: function(result, textstatus) { |
| [2478](#L2478) | window.location.reload(true); |
| [2479](#L2479) | }, |
| [2480](#L2480) | error: function(result) { |
| [2481](#L2481) | }, |
| [2482](#L2482) | }) |
| [2483](#L2483) | } |
| [2484](#L2484) | }) |
| [2485](#L2485) | }) |
| [2486](#L2486) |  |
| [2487](#L2487) | </script> |
| [2488](#L2488) |  |
| [2489](#L2489) | <!-- \*\*\*\*\*\*\*\*\*\*\*\*\*\*  JS  \*\*\*\*\*\*\*\*\*\*\*\*\*\* --> |
| [2490](#L2490) |  |
| [2491](#L2491) | <div class="wrap"> |
| [2492](#L2492) | <h2></h2> |
| [2493](#L2493) | <div class="wploti-head"> |
| [2494](#L2494) | <div class="wploti\_animation\_state"> |
| [2495](#L2495) | <lottie-player autoplay="true" loop src="<?php echo esc\_attr ( $this->wploti\_active() == '1' ? IMG\_path .'/green-on.json' : IMG\_path .'/red-off.json'  )?>"  class="animation-state"></lottie-player> |
| [2496](#L2496) | </div> |
| [2497](#L2497) | <h1 class="big-title"><?php echo esc\_html(get\_admin\_page\_title() , "maintenance-coming-soon-redirect-animation"); ?></h1> |
| [2498](#L2498) | </div> |
| [2499](#L2499) |  |
| [2500](#L2500) | <p><?php \_e( "Make your website in maintenance mode in seconds with great looking animations and configure settings to allow specific users to bypass the maintenance mode functionality in order to preview the site prior to public launch. Any logged in user with WordPress administrator privileges will be allowed to view the site regardless of the settings below." , "maintenance-coming-soon-redirect-animation" ); ?></p> |
| [2501](#L2501) | <?php if ( get\_option('wploti\_notes\_notice') ) : ?> |
| [2502](#L2502) | <div class=" notice-success is-dismissable" id="wploti\_note\_notice"> |
| [2503](#L2503) | <div class="notice-activation-text-wrapper"> |
| [2504](#L2504) | <div class="note\_head"> |
| [2505](#L2505) | <img class="alert-icon" src="<?php echo esc\_attr ( IMG\_path.'/alert-icon.png' )?>" alt="Alert Icon" /> |
| [2506](#L2506) | <h3 class="main\_redirect\_msg"><?php \_e( "Notes : " , "maintenance-coming-soon-redirect-animation" )?></h3> |
| [2507](#L2507) | </div> |
| [2508](#L2508) | <ul class="note\_text"> |
| [2509](#L2509) | <li><?php \_e( "This plugin will override any other maintenance plugin you use ." , "maintenance-coming-soon-redirect-animation" ); ?></li> |
| [2510](#L2510) | <li><?php \_e( "All settings are auto-updated , you don't need to save anything ." , "maintenance-coming-soon-redirect-animation" ); ?></li> |
| [2511](#L2511) | </ul> |
| [2512](#L2512) | <div class="wploti-leave-feedback"> |
| [2513](#L2513) | <div><a href="#dismiss" data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ?>" name="wploti-activation-dismiss" class="wploti-note-dismiss"><?php \_e('Dismiss' , "maintenance-coming-soon-redirect-animation"); ?></a></div> |
| [2514](#L2514) | </div> |
| [2515](#L2515) | </div> |
| [2516](#L2516) | </div> |
| [2517](#L2517) | <?php endif; ?> |
| [2518](#L2518) | <h3 class="big-title"><?php \_e( "Enable Maintenance Mode:" , "maintenance-coming-soon-redirect-animation" ); ?></h3> |
| [2519](#L2519) | <div class="enable-maintenance-mode"> |
| [2520](#L2520) | <div class="wploti-maintenance-toggle"> |
| [2521](#L2521) | <div class="toggle-wrapper"> |
| [2522](#L2522) | <input type="checkbox" data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ?>" name="wploti\_status" id="wploti-status" class="toggle-checkbox" <?php checked( '1', $this->wploti\_active() );  ?>> |
| [2523](#L2523) | <label for="wploti-status" class="toggle"><span class="toggle\_handler"></span></label> |
| [2524](#L2524) | </div> |
| [2525](#L2525) | </div> |
| [2526](#L2526) | </div> |
| [2527](#L2527) |  |
| [2528](#L2528) | <style> |
| [2529](#L2529) | .wploti-maintenance-toggle .toggle:before { |
| [2530](#L2530) | content: "<?php \_e("Disabled", "maintenance-coming-soon-redirect-animation") ?>"; |
| [2531](#L2531) | } |
| [2532](#L2532) | .wploti-maintenance-toggle .toggle:after { |
| [2533](#L2533) | content: "<?php \_e("Enabled", "maintenance-coming-soon-redirect-animation") ?>"; |
| [2534](#L2534) | } |
| [2535](#L2535) | </style> |
| [2536](#L2536) |  |
| [2537](#L2537) |  |
| [2538](#L2538) | <div id="wploti\_main\_options" style="display: <?php echo ( $this->wploti\_active() == '1' ) ? 'block' : 'none'; ?> " > |
| [2539](#L2539) |  |
| [2540](#L2540) | <?php |
| [2541](#L2541) |  |
| [2542](#L2542) | $tabs = array(); |
| [2543](#L2543) | $tabs[] = array('id' => 'header', 'icon' => 'dashicons-welcome-learn-more', 'class' => '', 'label' => \_\_('Header Type', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'header\_tab')); |
| [2544](#L2544) | $tabs[] = array('id' => 'ip', 'icon' => 'dashicons-location', 'class' => '', 'label' => esc\_attr\_\_('IP addresses', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'ip\_tab')); |
| [2545](#L2545) | $tabs[] = array('id' => 'keys', 'icon' => 'dashicons-admin-network', 'class' => '', 'label' => esc\_attr\_\_('Access Keys', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'key\_tab')); |
| [2546](#L2546) | $tabs[] = array('id' => 'animation', 'icon' => 'dashicons-welcome-view-site', 'class' => '', 'label' => esc\_attr\_\_('Animation', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'animation\_tab')); |
| [2547](#L2547) | $tabs[] = array('id' => 'message', 'icon' => 'dashicons-admin-comments', 'class' => '', 'label' => esc\_attr\_\_('Message', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'message\_tab')); |
| [2548](#L2548) | $tabs[] = array('id' => 'extra', 'icon' => 'dashicons-awards', 'class' => '', 'label' => esc\_attr\_\_('Extra', 'maintenance-coming-soon-redirect-animation'), 'callback' => array(\_\_CLASS\_\_, 'extra\_tab')); |
| [2549](#L2549) |  |
| [2550](#L2550) | $tabs = apply\_filters('wploti\_tabs', $tabs); |
| [2551](#L2551) |  |
| [2552](#L2552) | echo '<div id="wploti\_tabs" class="ui-tabs" style="display: none;">'; |
| [2553](#L2553) | echo '<ul class="wploti-main-tab">'; |
| [2554](#L2554) | foreach ($tabs as $tab) { |
| [2555](#L2555) | if (!empty($tab['label'])) { |
| [2556](#L2556) | echo '<li><a href="#' . esc\_attr($tab['id']) . '" class="' . esc\_attr($tab['class']) . '"><span class="icon"><span class="dashicons ' . esc\_attr($tab['icon']) . '"></span></span><span class="label">' . esc\_attr($tab['label']) . '</span></a></li>'; |
| [2557](#L2557) | } |
| [2558](#L2558) | } |
| [2559](#L2559) | echo '</ul>'; |
| [2560](#L2560) |  |
| [2561](#L2561) | foreach ($tabs as $tab) { |
| [2562](#L2562) | if (is\_callable($tab['callback'])) { |
| [2563](#L2563) | echo '<div style="display: none;" id="' . esc\_attr($tab['id']) . '">'; |
| [2564](#L2564) | call\_user\_func($tab['callback']); |
| [2565](#L2565) | echo '</div>'; |
| [2566](#L2566) | } |
| [2567](#L2567) | } // foreach |
| [2568](#L2568) | echo '</div>'; // wploti\_tabs |
| [2569](#L2569) |  |
| [2570](#L2570) | ?> |
| [2571](#L2571) |  |
| [2572](#L2572) | <div class="submit"> |
| [2573](#L2573) | <?php wp\_nonce\_field( 'wploti\_nonce' ); ?> |
| [2574](#L2574) | <!-- <input type="submit" name="update\_wp\_maintenance\_redirect\_settings" class="wp-core-ui button-primary" value="<?php \_e( 'Update Settings' ); ?>" /> --> |
| [2575](#L2575) | <input type="button" value="<?php esc\_attr\_e( 'Reset settings', 'maintenance-coming-soon-redirect-animation' ); ?>" class="button button-secondary wploti\_reset\_settings" data-security="<?php echo esc\_attr($wploti\_ajax\_nonce) ; ?>" name="submit" /> |
| [2576](#L2576) | </div> |
| [2577](#L2577) |  |
| [2578](#L2578) | </div> |
| [2579](#L2579) |  |
| [2580](#L2580) | </div> |
| [2581](#L2581) |  |
| [2582](#L2582) | <?php |
| [2583](#L2583) |  |
| [2584](#L2584) |  |
| [2585](#L2585) | } // end function print\_admin\_page() |
| [2586](#L2586) |  |
| [2587](#L2587) |  |
| [2588](#L2588) | } // end class wploti\_maintenance\_redirect |
| [2589](#L2589) | } |
| [2590](#L2590) |  |
| [2591](#L2591) | if (class\_exists("wploti\_maintenance\_redirect")) { |
| [2592](#L2592) | $my\_wploti\_maintenance\_redirect = new wploti\_maintenance\_redirect(); |
| [2593](#L2593) | } |
| [2594](#L2594) |  |
| [2595](#L2595) |  |
| [2596](#L2596) | if (!function\_exists("wploti\_maintenance\_redirect\_ap")) { |
| [2597](#L2597) |  |
| [2598](#L2598) | /\*\* |
| [2599](#L2599) | \* (php) initialize the admin and users panel |
| [2600](#L2600) | \* |
| [2601](#L2601) | \* @since 1.0.0 |
| [2602](#L2602) | \* @return void |
| [2603](#L2603) | \*/ |
| [2604](#L2604) |  |
| [2605](#L2605) | function wploti\_maintenance\_redirect\_ap() { |
| [2606](#L2606) | if( current\_user\_can('manage\_options') ) { |
| [2607](#L2607) | global $my\_wploti\_maintenance\_redirect; |
| [2608](#L2608) | global $wploti\_ajax\_nonce; |
| [2609](#L2609) | $wploti\_ajax\_nonce = wp\_create\_nonce( "wploti\_nonce" ); |
| [2610](#L2610) |  |
| [2611](#L2611) | if( !isset($my\_wploti\_maintenance\_redirect) ) return; |
| [2612](#L2612) |  |
| [2613](#L2613) |  |
| [2614](#L2614) | if (function\_exists('add\_options\_page')) { |
| [2615](#L2615) | add\_options\_page( |
| [2616](#L2616) | \_\_("Maintenance Redirect Options" , 'maintenance-coming-soon-redirect-animation'), |
| [2617](#L2617) | \_\_("Maintenance" ), |
| [2618](#L2618) | 'manage\_options', |
| [2619](#L2619) | 'wploti-settings', |
| [2620](#L2620) | array( $my\_wploti\_maintenance\_redirect, 'print\_admin\_page' )); |
| [2621](#L2621) | } |
| [2622](#L2622) | } |
| [2623](#L2623) | } |
| [2624](#L2624) | } |
| [2625](#L2625) |  |
| [2626](#L2626) |  |
| [2627](#L2627) |  |
| [2628](#L2628) | // actions and filters |
| [2629](#L2629) |  |
| [2630](#L2630) | if( isset( $my\_wploti\_maintenance\_redirect ) ) { |
| [2631](#L2631) | //global constants |
| [2632](#L2632) |  |
| [2633](#L2633) | define('WPLOTI\_VERSION','2.1.2'); |
| [2634](#L2634) | define('wploti\_icon', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0ic3ZnIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI0MDAiIGhlaWdodD0iMjg4LjE4MjM2MzUyNzI5NDU3IiB2aWV3Qm94PSIwLCAwLCA0MDAsMjg4LjE4MjM2MzUyNzI5NDU3Ij48ZyBpZD0ic3ZnZyI+PHBhdGggaWQ9InBhdGgwIiBkPSJNMTQuOTk3IDAuMzQ0IEMgNy40NzkgMi4yNDcsMS43NzMgOC4xMzQsMC4zMzEgMTUuNDc3IEMgLTAuMjkzIDE4LjY1MSwtMC4xNDcgMTk5LjExNSwwLjQ4MiAyMDIuMTcwIEMgMi40MDggMjExLjUzMCw5LjM3NyAyMTkuODY3LDE3Ljk5NiAyMjMuMTIxIEMgMTkuNTE0IDIyMy42OTQsMjAuOTcyIDIyNC4yNTksMjEuMjM2IDIyNC4zNzUgQyAyMi4zMTYgMjI0Ljg1MiwyNS4yNzAgMjI1LjA3MywzMy41OTMgMjI1LjMwMiBDIDM4LjQxMCAyMjUuNDM0LDQ0LjAyNSAyMjUuNjA1LDQ2LjA3MSAyMjUuNjgyIEMgNDguMTE2IDIyNS43NTksNTUuODM3IDIyNS45MTgsNjMuMjI3IDIyNi4wMzYgQyA3MC42MTggMjI2LjE1NSw4MC41NTIgMjI2LjM2Miw4NS4zMDMgMjI2LjQ5OCBDIDkwLjA1NCAyMjYuNjMzLDEwMC41ODIgMjI2Ljg1OCwxMDguNjk4IDIyNi45OTggQyAxMTYuODE1IDIyNy4xMzgsMTI4LjM2OCAyMjcuMzUyLDEzNC4zNzMgMjI3LjQ3NSBDIDE0MC4zNzggMjI3LjU5NywxNTEuMjU3IDIyNy43NzIsMTU4LjU0OCAyMjcuODY0IEwgMTcxLjgwNiAyMjguMDMxIDE3MS44MDYgMjI5LjAyOCBDIDE3MS44MDYgMjI5LjU3NywxNzEuNzAxIDIzMC42MTMsMTcxLjU3MyAyMzEuMzMwIEMgMTcxLjQ0NSAyMzIuMDQ3LDE3MS4yMjMgMjMzLjc2NywxNzEuMDgwIDIzNS4xNTMgQyAxNzAuNTM5IDI0MC4zOTUsMTcwLjExNyAyNDQuMjQ2LDE2OS43NzYgMjQ3LjAzMSBDIDE2OS41ODIgMjQ4LjYxNCwxNjkuMjU5IDI1MS40NzYsMTY5LjA1NyAyNTMuMzg5IEMgMTY4Ljg1NiAyNTUuMzAzLDE2OC41ODQgMjU3LjY3OCwxNjguNDU0IDI1OC42NjggQyAxNjguMzIzIDI1OS42NTgsMTY4LjE4NyAyNjEuMTQyLDE2OC4xNTEgMjYxLjk2NiBDIDE2OC4xMTYgMjYyLjc5MCwxNjcuOTk1IDI2My40NjUsMTY3Ljg4MiAyNjMuNDY2IEMgMTY3Ljc3MCAyNjMuNDY3LDE2Ny43MTcgMjYzLjk1MywxNjcuNzY0IDI2NC41NDcgQyAxNjcuODExIDI2NS4xNDEsMTY3Ljc1NyAyNjUuNjI3LDE2Ny42NDQgMjY1LjYyNyBDIDE2Ny41MzEgMjY1LjYyNywxNjcuNDc3IDI2Ni4xMTMsMTY3LjUyNCAyNjYuNzA3IEMgMTY3LjU3MSAyNjcuMzAxLDE2Ny41MzcgMjY3Ljc4NiwxNjcuNDQ3IDI2Ny43ODYgQyAxNjcuMzU4IDI2Ny43ODYsMTY3LjIwOCAyNjguODY2LDE2Ny4xMTUgMjcwLjE4NiBDIDE2Ni45NDYgMjcyLjU3MiwxNjYuOTQxIDI3Mi41ODUsMTY2LjMxNiAyNzIuNTg2IEMgMTYxLjA1MSAyNzIuNTg5LDE0Ny45NDkgMjczLjE2MCwxNDYuOTA2IDI3My40MzIgQyAxNDMuODU0IDI3NC4yMjcsMTQyLjkwMSAyNzUuNTIzLDE0Mi4wMzQgMjgwLjA1OSBDIDE0MS44NzQgMjgwLjg5NywxNDEuNjYxIDI4MS42OTIsMTQxLjU2MCAyODEuODI0IEMgMTQwLjI3NiAyODMuNTEzLDE0MS44ODIgMjg3LjU0MiwxNDQuMDUwIDI4OC4wNjkgQyAxNDQuMzM2IDI4OC4xMzksMTczLjAyMyAyODguMTY2LDIwNy43OTggMjg4LjEyOSBMIDI3MS4wMjYgMjg4LjA2MiAyNzEuOTg5IDI4Ny41NDcgQyAyNzQuMTM4IDI4Ni4zOTUsMjc1LjA1MSAyODQuNzI0LDI3NC41NTkgMjgyLjgzOSBDIDI3NC40MTMgMjgyLjI4MCwyNzQuMDg1IDI4MS4wMTEsMjczLjgzMCAyODAuMDE3IEMgMjczLjU3NiAyNzkuMDI0LDI3My4wMTcgMjc3LjA4MCwyNzIuNTg5IDI3NS42OTggQyAyNzAuNjQzIDI2OS40MDgsMjcwLjg5MiAyNjkuNTQ0LDI2MS41NDggMjY5LjcwMiBDIDI1Ny43ODYgMjY5Ljc2NiwyNTMuNzkzIDI2OS44MjAsMjUyLjY3MiAyNjkuODIyIEwgMjUwLjYzNiAyNjkuODI2IDI1MC4yMjMgMjY3LjMwNyBDIDI0OS45OTcgMjY1LjkyMSwyNDkuNzAzIDI2NC4wODUsMjQ5LjU3MSAyNjMuMjI3IEMgMjQ5LjMzNyAyNjEuNzEzLDI0OS4xNTIgMjYwLjYxOSwyNDguMTU0IDI1NC44MjkgQyAyNDcuODkzIDI1My4zMTEsMjQ3LjU1NyAyNTEuMzE0LDI0Ny40MDggMjUwLjM5MCBDIDI0Ny4yNTkgMjQ5LjQ2NiwyNDYuOTE5IDI0Ny40MTUsMjQ2LjY1NCAyNDUuODMxIEMgMjQ2LjM4OCAyNDQuMjQ3LDI0Ni4wNzIgMjQyLjM1OCwyNDUuOTUxIDI0MS42MzIgQyAyNDUuODMxIDI0MC45MDYsMjQ1LjYzMyAyMzkuNzcyLDI0NS41MTEgMjM5LjExMiBDIDI0NS4zODggMjM4LjQ1MiwyNDUuMTYzIDIzNy4xMDMsMjQ1LjAwOSAyMzYuMTEzIEMgMjQ0Ljg1NiAyMzUuMTIzLDI0NC42MzAgMjMzLjc3MywyNDQuNTA3IDIzMy4xMTMgQyAyNDQuMzg0IDIzMi40NTQsMjQ0LjIxNSAyMzEuMzY0LDI0NC4xMzIgMjMwLjY5MiBMIDI0My45ODAgMjI5LjQ3MSAyNDcuNzg1IDIyOS4zMTcgQyAyNDkuODc3IDIyOS4yMzIsMjU0LjgyOSAyMjkuMjY4LDI1OC43ODggMjI5LjM5NyBDIDI2Ny43MjcgMjI5LjY4OCwzMjQuMjQ1IDIzMC4xMDksMzUzLjY4OSAyMzAuMTAzIEMgMzc2Ljk0NCAyMzAuMDk4LDM3OC41NDkgMjMwLjAzMywzODEuNjk0IDIyOC45NTcgQyAzODIuNDU4IDIyOC42OTYsMzgzLjczMSAyMjguMjkxLDM4NC41MjMgMjI4LjA1OCBDIDM5MS4yMDQgMjI2LjA5MCwzOTYuNTkwIDIyMC41NzgsMzk4LjIyMyAyMTQuMDM3IEMgMzk4Ljc1NCAyMTEuOTExLDM5OS4wMjEgMjA2LjM5MiwzOTkuMjg2IDE5Mi4wOTkgQyAzOTkuNDIzIDE4NC43MTgsMzk5LjY0MiAxNzguMjM5LDM5OS43NzIgMTc3LjcwMiBDIDQwMC4wNzAgMTc2LjQ4MCwzOTkuODkyIDk1Ljk0NiwzOTkuNTY3IDg0LjcwMyBDIDM5OS4yOTEgNzUuMTI5LDM5OC44ODcgNjUuNjk5LDM5OC41NzUgNjEuNTQ4IEMgMzk4LjQ0NiA1OS44MzIsMzk4LjI3MyA1Ni45MTcsMzk4LjE5MCA1NS4wNjkgQyAzOTcuOTE0IDQ4LjkzMSwzOTYuMjY0IDMxLjM5NywzOTUuNTQ4IDI2Ljk5NSBDIDM5NS4zNTUgMjUuODA3LDM5NS4wODMgMjQuMDc5LDM5NC45NDMgMjMuMTU1IEMgMzkzLjcwNiAxNC45NjgsMzg4LjA4NSA4LjcxNywzNzkuNzI0IDYuMjI5IEMgMzc4LjIzMCA1Ljc4NSwzNjQuNTIxIDUuMjA1LDM0Ni4wMTEgNC44MDMgQyAzMzkuNjEwIDQuNjY0LDMzMS40NTggNC40NDYsMzI3Ljg5NCA0LjMxOSBDIDMyNC4zMzEgNC4xOTIsMzEyLjY2OSAzLjkyOSwzMDEuOTgwIDMuNzMzIEMgMjkxLjI5MCAzLjUzOCwyNzkuNTc0IDMuMjY3LDI3NS45NDUgMy4xMzIgQyAyNzIuMzE2IDIuOTk3LDI2NS4xODkgMi44MjUsMjYwLjEwOCAyLjc1MCBDIDI1MS4zNjIgMi42MjAsMjI5LjIzNSAyLjE2MiwyMDkuMTE4IDEuNjk1IEMgMTk4LjM4OSAxLjQ0NSwxNzUuMDU2IDEuMDQwLDE1MS41MzAgMC42OTQgQyAxNDIuMjkyIDAuNTU4LDEyOC40NzAgMC4zNTQsMTIwLjgxNiAwLjI0MSBDIDk3LjgxMiAtMC4xMDAsMTYuNDM2IC0wLjAyMCwxNC45OTcgMC4zNDQgTTUwLjk5MCAxNy43NTggQyA3Ny40ODcgMTguMzc2LDgyLjc2MiAxOC40ODYsOTAuOTQyIDE4LjU5NiBDIDk1Ljc1OSAxOC42NjEsMTAwLjc4MCAxOC43NjcsMTAyLjEwMCAxOC44MzEgQyAxMDMuNDE5IDE4Ljg5NiwxMDcuMzA3IDE5LjAxMCwxMTAuNzM4IDE5LjA4NCBDIDE0Ny4yODMgMTkuODgwLDE3NC4zMTUgMjAuNDMwLDE4Ni45MjMgMjAuNjM1IEMgMjA3LjQxOSAyMC45NjksMjM2LjMzMCAyMS41MzEsMjU1LjkwOSAyMS45NzYgQyAyNjQuNzUxIDIyLjE3NywyNzUuNjAzIDIyLjM5OCwyODAuMDI0IDIyLjQ2OCBDIDI4NC40NDUgMjIuNTM4LDI4OC44MTggMjIuNjM0LDI4OS43NDIgMjIuNjgyIEMgMjkwLjY2NiAyMi43MjksMjk2LjI4MSAyMi44MjEsMzAyLjIyMCAyMi44ODUgQyAzMDguMTU4IDIyLjk0OSwzMTMuMTc5IDIzLjA2MSwzMTMuMzc3IDIzLjEzMyBDIDMxMy41NzUgMjMuMjA2LDMxOC4yMTggMjMuMzIwLDMyMy42OTUgMjMuMzg2IEMgMzM5LjY3NCAyMy41NzksMzYxLjEzNSAyNC4xODAsMzYyLjQzNiAyNC40NzIgQyAzNjUuNTc4IDI1LjE3NywzNjguMjcyIDI3LjQxOSwzNjkuNTU2IDMwLjM5NSBMIDM3MC4zNjYgMzIuMjc0IDM3MC4zNjYgNTUuOTA5IEMgMzcwLjM2NiA5OC4xNjcsMzY5Ljk3OSAxODYuNzA5LDM2OS43NzggMTkwLjQwMiBDIDM2OS41NzAgMTk0LjIxOCwzNjkuMzk5IDE5NS4zOTEsMzY5LjAzMSAxOTUuNTIxIEMgMzY4LjkwNiAxOTUuNTY2LDM2OC44NTkgMTk1LjY5MiwzNjguOTI3IDE5NS44MDIgQyAzNjguOTk1IDE5NS45MTIsMzY4Ljg4MCAxOTYuMTczLDM2OC42NzEgMTk2LjM4MSBDIDM2OC40NjMgMTk2LjU5MCwzNjguMzYzIDE5Ni43NjEsMzY4LjQ0OSAxOTYuNzYxIEMgMzY4LjY1NCAxOTYuNzYxLDM2Ny43MDUgMTk4LjMxMywzNjYuNzc5IDE5OS40OTMgQyAzNjUuOTc1IDIwMC41MTcsMzYzLjE1NSAyMDIuNzU5LDM2Mi42NzIgMjAyLjc1OSBDIDM2Mi41MDQgMjAyLjc1OSwzNjIuMzIzIDIwMi44OTQsMzYyLjI2OCAyMDMuMDU5IEMgMzYyLjE5MSAyMDMuMjkwLDM2MC42MzkgMjAzLjM1OSwzNTUuNTg5IDIwMy4zNTkgQyAzNDkuMDE2IDIwMy4zNTksMzQ0LjE3NyAyMDMuMzAzLDI5My45NDEgMjAyLjY0MSBDIDI0OC44NDMgMjAyLjA0NywyMDkuMDI3IDIwMS41ODYsMTkwLjQwMiAyMDEuNDQzIEMgMTgwLjYzNiAyMDEuMzY4LDE1Ni40NDkgMjAxLjEwMCwxMzYuNjUzIDIwMC44NDcgQyAxMTYuODU3IDIwMC41OTMsOTQuNjY3IDIwMC4zMjUsODcuMzQzIDIwMC4yNTEgQyA4MC4wMTggMjAwLjE3Niw3Mi45NDUgMjAwLjA2NCw3MS42MjYgMjAwLjAwMiBDIDcwLjMwNiAxOTkuOTM5LDYyLjE1NCAxOTkuODMxLDUzLjUwOSAxOTkuNzYyIEMgMjkuNDg3IDE5OS41NzAsMjkuMDU5IDE5OS41MzksMjUuNDM1IDE5Ny43NjkgQyAyMi4zODkgMTk2LjI4MiwyMC4zMjUgMTkzLjY4MywxOS40ODkgMTkwLjI4MiBDIDE4Ljk3MSAxODguMTc0LDE4LjY3MiA3Mi44MTUsMTkuMDkyIDM3LjU1MiBMIDE5LjIzNiAyNS41NTUgMjAuMTcxIDIzLjU5OSBDIDIxLjI1NSAyMS4zMzIsMjIuOTI5IDE5LjY3NSwyNS4zMzcgMTguNDg2IEMgMjcuOTYwIDE3LjE5MCwyNy4zNTcgMTcuMjA3LDUwLjk5MCAxNy43NTggTTE4NC4xNDQgMzEuMjk2IEMgMTgyLjcyMCAzMS43MzYsMTgxLjc3OSAzMi41MjYsMTgxLjAxNCAzMy45MjIgTCAxODAuMzQwIDM1LjE1MyAxODAuMTkwIDQ0Ljc1MSBDIDE3OS45ODQgNTcuOTU2LDE3OS44NjAgNTguMjE1LDE3Mi4yODYgNjEuMTgwIEMgMTY0Ljc5MyA2NC4xMTMsMTY0LjUyMyA2NC4wMTAsMTU1LjU2MiA1NC44MDEgQyAxNDguNDA4IDQ3LjQ0OSwxNDguMTgwIDQ3LjI2NCwxNDYuMDM3IDQ3LjA5MiBDIDE0My41NDAgNDYuODkyLDE0My4wNjcgNDcuMjE1LDEzNi4zMTQgNTMuNzUyIEMgMTI2LjgxMCA2Mi45NTIsMTI2LjgwNiA2Mi42NDUsMTM2LjU3MCA3Mi42ODQgQyAxNDUuNjc4IDgyLjA0OCwxNDUuODE0IDgyLjQzNiwxNDIuNTcwIDg5Ljc0MiBDIDE0MC41NDUgOTQuMzAxLDEzOS43OTUgOTUuMzM3LDEzNy42OTMgOTYuNDc3IEwgMTM2LjE3MyA5Ny4zMDEgMTI2LjA5NSA5Ny4zMDEgTCAxMTYuMDE3IDk3LjMwMSAxMTQuODcyIDk3Ljk3NCBDIDExMi4yODkgOTkuNDkyLDExMi4wNjEgMTAwLjU2NCwxMTIuMDU5IDExMS4xNjUgQyAxMTIuMDU3IDEyMy41MjIsMTExLjUzNyAxMjMuMDU2LDEyNS41NTYgMTIzLjI5NSBMIDEzNC45ODQgMTIzLjQ1NSAxMzYuNTg2IDEyNC4yNDQgQyAxMzkuMDg3IDEyNS40NzYsMTM5Ljc2NyAxMjYuNDI4LDE0MS43MDkgMTMxLjQxOSBDIDE0NC44MzYgMTM5LjQ1NywxNDQuODYyIDEzOS40MDQsMTMxLjE3MSAxNTIuMzg0IEMgMTI1Ljk5MyAxNTcuMjkzLDEyNi4zNDQgMTU4LjY1NCwxMzUuMDYyIDE2Ny40ODIgQyAxNDQuMTQ3IDE3Ni42ODEsMTQzLjU1NiAxNzYuNjk4LDE1My42MTMgMTY2Ljk2NCBDIDE2Mi43MDggMTU4LjE2MiwxNjIuOTExIDE1OC4wOTMsMTcwLjM0MCAxNjEuMjY1IEMgMTc1LjE5MyAxNjMuMzM4LDE3Ni40ODUgMTY0LjI5MywxNzcuNjA3IDE2Ni42NDEgTCAxNzguMjk4IDE2OC4wODYgMTc4LjI1OSAxNzcuNjkyIEMgMTc4LjIwMiAxOTEuODQ0LDE3Ny42MzQgMTkxLjIzMSwxOTEuMDE0IDE5MS40MjYgQyAyMDQuNDc3IDE5MS42MjIsMjAzLjk4NCAxOTIuMTEyLDIwNC4yMzEgMTc4LjI4NCBDIDIwNC40MTEgMTY4LjIyMywyMDQuNDM3IDE2OC4wMjIsMjA1Ljg3NiAxNjUuOTMxIEMgMjA2Ljg0OSAxNjQuNTE3LDIwOC4xMDEgMTYzLjcwNCwyMTEuMjE4IDE2Mi40NjIgTCAyMTMuNzk5IDE2MS40MzQgMjEyLjYxNSAxNjAuMDgxIEMgMjExLjk2NCAxNTkuMzM3LDIxMC4xNDMgMTU3LjQ0OSwyMDguNTY5IDE1NS44ODYgTCAyMDUuNzA2IDE1My4wNDQgMjAzLjI2NyAxNTMuNjU5IEMgMTY4LjMwMiAxNjIuNDc3LDEzOC4xNTMgMTI3LjY3NiwxNTIuMjIyIDk0LjczOCBDIDE2NS45MTggNjIuNjc0LDIwOS40ODMgNTguODY5LDIyOC42NjQgODguMDYyIEMgMjM1LjY3MCA5OC43MjYsMjM3LjY4OCAxMTQuMzE5LDIzMy40ODggMTI1LjMzOCBDIDIzMy4yMzUgMTI2LjAwMiwyMzMuMzMzIDEyNi4xMjgsMjM3LjIxOSAxMzAuMTM3IEMgMjM5LjQxMyAxMzIuNDAxLDI0MS4yODIgMTM0LjI4MiwyNDEuMzcxIDEzNC4zMTcgQyAyNDEuNDU5IDEzNC4zNTEsMjQyLjA1MyAxMzMuMTQxLDI0Mi42OTEgMTMxLjYyNiBDIDI0My45MDIgMTI4Ljc0OSwyNDQuOTQwIDEyNy4yNzQsMjQ2LjQwNiAxMjYuMzUyIEMgMjQ4LjI4MCAxMjUuMTczLDI0OC41NjAgMTI1LjE0OCwyNTguNTQ4IDEyNS4yMjcgQyAyNzIuNzQ1IDEyNS4zMzksMjcyLjI2MyAxMjUuODAyLDI3Mi4zODQgMTExLjkzOCBDIDI3Mi40OTIgOTkuNTQzLDI3Mi4zNjcgOTkuMzg0LDI2Mi41MDcgOTkuMzMzIEMgMjQ1Ljg3MyA5OS4yNDcsMjQ1LjcwNSA5OS4xNzgsMjQyLjQ3MiA5MS4xODggQyAyMzkuNDU1IDgzLjczNSwyMzkuNTc1IDgzLjQxMywyNDguNjQyIDc0LjY0MyBDIDI1NS40NDQgNjguMDYyLDI1Ni4xNjEgNjcuMjI4LDI1Ni40MDQgNjUuNjEwIEMgMjU2LjgxNiA2Mi44NjIsMjU2LjUwNCA2Mi4zODUsMjQ5LjY5OSA1NS4zNDYgQyAyNDAuNTQzIDQ1Ljg3NCwyNDAuODU5IDQ1Ljg2NCwyMzAuNTEzIDU1LjkyMyBDIDIyMS40MjAgNjQuNzYzLDIyMC45MDQgNjQuOTQ2LDIxMy44MTUgNjEuODUxIEMgMjA2LjAxNiA1OC40NDUsMjA1Ljk4NiA1OC4zODAsMjA2LjE4NyA0NS4zNTcgQyAyMDYuNDEyIDMwLjgxNSwyMDYuODczIDMxLjMyNCwxOTMuMjgxIDMxLjExOCBDIDE4Ny4xMDAgMzEuMDI0LDE4NC44ODYgMzEuMDY3LDE4NC4xNDQgMzEuMjk2IE0xOTEuNjk1IDgwLjEzMyBDIDE4OS45NjcgODAuMzExLDE4Ni4yOTggODEuMDI5LDE4NS44OTggODEuMjY3IEMgMTg1LjUzOSA4MS40ODIsMTg2Ljg2NyA4Mi45NzQsMTkyLjY5NyA4OC45MDIgQyAxOTguMDc1IDk0LjM3MiwxOTkuODQyIDk2LjQ0MCwyMDAuOTA2IDk4LjUxMiBDIDIwNy4yNTggMTEwLjg3NywxOTIuNzg5IDEyNS42ODcsMTgwLjA0NCAxMTkuODY3IEMgMTc2LjkxNyAxMTguNDM5LDE3NS41MTQgMTE3LjE4MiwxNjguMTE4IDEwOS4xNzggQyAxNjUuNDk2IDEwNi4zNDEsMTYzLjE3NSAxMDMuOTkyLDE2Mi45NTkgMTAzLjk1OSBDIDE2MS40MzMgMTAzLjcyNiwxNjAuNTk5IDEwNy42MzksMTYwLjg1MCAxMTMuODU3IEMgMTYxLjIwNyAxMjIuNjc1LDE2NC40NDggMTI5LjYzMiwxNzEuMTI3IDEzNS45MjAgQyAxNzkuODQzIDE0NC4xMjUsMTkwLjEzOCAxNDYuNTU5LDIwMi4xNjAgMTQzLjI1OSBDIDIwNy4yODggMTQxLjg1MSwyMDUuMDI1IDE0MC4xNDIsMjI2LjY1OCAxNjEuNzYxIEMgMjM2LjgzMyAxNzEuOTI5LDI0NS42NDUgMTgwLjU2NSwyNDYuMjQwIDE4MC45NTIgQyAyNTQuOTc3IDE4Ni42MzUsMjY2LjUwMCAxNzYuNDc4LDI2MS45MzggMTY3LjExNSBDIDI2MS4wMjYgMTY1LjI0NSwyNjAuNjMyIDE2NC44MzAsMjQyLjM0OCAxNDYuNDkxIEMgMjMyLjA4NSAxMzYuMTk3LDIyMy41NjkgMTI3LjUzOSwyMjMuNDIyIDEyNy4yNTAgQyAyMjIuOTYwIDEyNi4zNDMsMjIzLjEyOCAxMjQuNzg0LDIyMy45NzIgMTIyLjE1OCBDIDIzMC45NjEgMTAwLjM5MSwyMTMuNjY0IDc3Ljg2OSwxOTEuNjk1IDgwLjEzMyBNMjUyLjc4OSAxNjYuMjU4IEMgMjU3LjY3NCAxNjguNDk4LDI1Ni4zMDcgMTc1LjY0NSwyNTAuOTk0IDE3NS42NDUgQyAyNDYuNTQxIDE3NS42NDUsMjQ0LjM3NSAxNzAuNDk2LDI0Ny41MDggMTY3LjM1OCBDIDI0OS4wMjEgMTY1Ljg0MiwyNTAuOTkwIDE2NS40MzIsMjUyLjc4OSAxNjYuMjU4IE0yMC42NjYgMjA2Ljg5MSBDIDIwLjc1OSAyMDcuMDQwLDIwLjg4NSAyMDcuMDE4LDIwLjk5OSAyMDYuODM0IEMgMjEuMTQxIDIwNi42MDMsMjIuOTQ1IDIwNi41NzMsMjkuMTI3IDIwNi42OTcgQyAzMy40OTcgMjA2Ljc4NCw1Mi43MjkgMjA3LjEyMiw3MS44NjYgMjA3LjQ0NyBDIDkxLjAwMiAyMDcuNzcyLDEyNS4zOTMgMjA4LjM2MiwxNDguMjkwIDIwOC43NTkgQyAxNzEuMTg4IDIwOS4xNTYsMjE1LjA4MSAyMDkuOTEwLDI0NS44MzEgMjEwLjQzNSBDIDI3Ni41ODEgMjEwLjk1OSwzMjEuMDY4IDIxMS43MTksMzQ0LjY5MSAyMTIuMTI0IEMgMzY5LjcxMCAyMTIuNTUyLDM4Ny44NzQgMjEyLjk1NSwzODguMTk2IDIxMy4wODkgQyAzODkuODQwIDIxMy43NzMsMzg4LjM1OSAyMTMuODY3LDM3OC41NDggMjEzLjcwNiBDIDM0NS4xNDkgMjEzLjE1NiwyODEuMDY0IDIxMi4wODksMjY4Ljg2NiAyMTEuODc5IEMgMjEyLjcwMCAyMTAuOTE2LDE1Mi4yNDggMjA5Ljg5OSw5Ny42NjAgMjA4Ljk5OSBDIDM4Ljc0OCAyMDguMDI3LDEyLjQwMCAyMDcuNTM5LDEyLjIwMSAyMDcuNDE2IEMgMTIuMDg5IDIwNy4zNDcsMTEuOTk4IDIwNy4wNjgsMTEuOTk4IDIwNi43OTUgQyAxMS45OTggMjA2LjI1MCwyMC4zMjAgMjA2LjM0MiwyMC42NjYgMjA2Ljg5MSBNMjA0Ljc0NiAyMTMuMDkyIEMgMjA3LjA1NSAyMTMuNzMzLDIwOC4zNjYgMjE2LjE0OCwyMDcuNjgxIDIxOC41MDIgQyAyMDYuNTg1IDIyMi4yNzMsMjAxLjQ1NyAyMjIuODAxLDE5OS43MDAgMjE5LjMyMyBDIDE5Ny45MDQgMjE1Ljc2OCwyMDAuOTI4IDIxMi4wMzIsMjA0Ljc0NiAyMTMuMDkyIE0yMDEuOTIwIDIxNC40ODQgQyAyMDAuMTQ4IDIxNS41NzgsMTk5LjcyMCAyMTcuMDM4LDIwMC42NDUgMjE4LjgzNCBDIDIwMS44MTUgMjIxLjEwNywyMDQuODQzIDIyMS4yNDcsMjA2LjI5MyAyMTkuMDk1IEMgMjA4LjE4NiAyMTYuMjg2LDIwNC43OTQgMjEyLjcwOCwyMDEuOTIwIDIxNC40ODQgIiBzdHJva2U9Im5vbmUiIGZpbGw9IiNhN2FhYWQiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvZz48L3N2Zz4='); |
| [2635](#L2635) | define('wploti\_animation\_dir', plugin\_dir\_url( \_\_FILE\_\_ ) .'animations/'); |
| [2636](#L2636) | define('IMG\_path', plugin\_dir\_url( \_\_FILE\_\_ ) .'images'); |
| [2637](#L2637) | define('wploti\_admin\_url', admin\_url().'admin.php?page=wploti-settings'); |
| [2638](#L2638) |  |
| [2639](#L2639) | // notice\_dismiss |
| [2640](#L2640) | add\_action('wp\_ajax\_wploti\_ajax\_dismiss\_activation\_notice', array( $my\_wploti\_maintenance\_redirect, 'wploti\_ajax\_dismiss\_activation\_notice' ) ); |
| [2641](#L2641) | add\_action('wp\_ajax\_wploti\_ajax\_dismiss\_notes\_notice', array( $my\_wploti\_maintenance\_redirect, 'wploti\_ajax\_dismiss\_notes\_notice' ) ); |
| [2642](#L2642) | // animation\_select |
| [2643](#L2643) | add\_action('wp\_ajax\_wploti\_animation\_select', array( $my\_wploti\_maintenance\_redirect, 'animation\_select' ) ); |
| [2644](#L2644) | add\_action('wp\_ajax\_wploti\_animation\_ajax\_load', array( $my\_wploti\_maintenance\_redirect, 'load\_animations' ) ); |
| [2645](#L2645) | // actions & filters |
| [2646](#L2646) | add\_action('admin\_menu', 'wploti\_maintenance\_redirect\_ap' ); |
| [2647](#L2647) | add\_action('admin\_menu', array( $my\_wploti\_maintenance\_redirect, 'wploti\_maintenance\_redirect\_menu' )); |
| [2648](#L2648) | add\_action('send\_headers', array( $my\_wploti\_maintenance\_redirect, 'process\_redirect'), 0 ); |
| [2649](#L2649) | add\_action('admin\_notices', array( $my\_wploti\_maintenance\_redirect, 'display\_status\_if\_active' ) ); |
| [2650](#L2650) | //add\_action( 'admin\_notices', array( $my\_wploti\_maintenance\_redirect, 'loti\_notice' ) ); |
| [2651](#L2651) | add\_action('wp\_before\_admin\_bar\_render', array( $my\_wploti\_maintenance\_redirect, 'wploti\_admin\_bar' ) ); |
| [2652](#L2652) | //enqueue styles and scripts |
| [2653](#L2653) | add\_action('admin\_enqueue\_scripts', array( $my\_wploti\_maintenance\_redirect ,'wploti\_enqueue\_style\_and\_script\_admin' ) ); |
| [2654](#L2654) | add\_action('wp\_enqueue\_scripts', array( $my\_wploti\_maintenance\_redirect ,'wploti\_enqueue\_style\_and\_script\_public' ) ); |
| [2655](#L2655) | //register script for translation |
| [2656](#L2656) | add\_action('admin\_enqueue\_scripts', array( $my\_wploti\_maintenance\_redirect ,'wploti\_translations\_script' ) ); |
| [2657](#L2657) |  |
| [2658](#L2658) | //add\_filter('plugin\_action\_links\_'.plugin\_basename(\_\_FILE\_\_), array( $my\_wploti\_maintenance\_redirect, 'plugin\_settings\_link' ) ); |
| [2659](#L2659) | add\_filter('site\_status\_tests', array( $my\_wploti\_maintenance\_redirect, 'wploti\_add\_site\_health' ) ); |
| [2660](#L2660) | add\_filter('admin\_body\_class',  array( $my\_wploti\_maintenance\_redirect,'wploti\_body\_class' ) ); |
| [2661](#L2661) | add\_filter('login\_message', array( $my\_wploti\_maintenance\_redirect, 'login\_message')); |
| [2662](#L2662) | add\_filter('upload\_mimes', array( $my\_wploti\_maintenance\_redirect, 'wploti\_mime\_types')); |
| [2663](#L2663) | add\_filter('plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), array( $my\_wploti\_maintenance\_redirect, 'wploti\_action\_links' ) ); |
| [2664](#L2664) | add\_filter('plugin\_row\_meta', array( $my\_wploti\_maintenance\_redirect, 'wploti\_plugin\_row\_meta' ), 10, 2 ); |
| [2665](#L2665) |  |
| [2666](#L2666) |  |
| [2667](#L2667) | // ajax actions |
| [2668](#L2668) | add\_action('wp\_ajax\_wploti\_toggle\_activation', array( $my\_wploti\_maintenance\_redirect, 'wploti\_ajax\_toggle\_activation') ); |
| [2669](#L2669) | add\_action('wp\_ajax\_wploti\_header\_type',  array( $my\_wploti\_maintenance\_redirect, 'wploti\_ajax\_header\_type') ); |
| [2670](#L2670) | add\_action('wp\_ajax\_wploti\_mr\_add\_ip',    array( $my\_wploti\_maintenance\_redirect, 'add\_new\_ip'       ) ); |
| [2671](#L2671) | add\_action('wp\_ajax\_wploti\_mr\_toggle\_ip', array( $my\_wploti\_maintenance\_redirect, 'toggle\_ip\_status' ) ); |
| [2672](#L2672) | add\_action('wp\_ajax\_wploti\_mr\_delete\_ip', array( $my\_wploti\_maintenance\_redirect, 'delete\_ip'        ) ); |
| [2673](#L2673) | add\_action('wp\_ajax\_wploti\_mr\_add\_ak',    array( $my\_wploti\_maintenance\_redirect, 'add\_new\_ak'       ) ); |
| [2674](#L2674) | add\_action('wp\_ajax\_wploti\_mr\_toggle\_ak', array( $my\_wploti\_maintenance\_redirect, 'toggle\_ak\_status' ) ); |
| [2675](#L2675) | add\_action('wp\_ajax\_wploti\_mr\_delete\_ak', array( $my\_wploti\_maintenance\_redirect, 'delete\_ak'        ) ); |
| [2676](#L2676) | add\_action('wp\_ajax\_wploti\_mr\_resend\_ak', array( $my\_wploti\_maintenance\_redirect, 'resend\_ak'        ) ); |
| [2677](#L2677) | add\_action('wp\_ajax\_wploti\_ajax\_message', array( $my\_wploti\_maintenance\_redirect, 'wploti\_ajax\_message') ); |
| [2678](#L2678) | add\_action('wp\_ajax\_wploti\_uploaded\_animation\_save', array( $my\_wploti\_maintenance\_redirect, 'wploti\_uploaded\_animation\_save\_option') ); |
| [2679](#L2679) | add\_action('wp\_ajax\_wploti\_add\_whitelisted\_roles', array( $my\_wploti\_maintenance\_redirect, 'wploti\_add\_whitelisted\_roles\_option') ); |
| [2680](#L2680) | add\_action('wp\_ajax\_wploti\_remove\_whitelisted\_roles', array( $my\_wploti\_maintenance\_redirect, 'wploti\_remove\_whitelisted\_roles\_option') ); |
| [2681](#L2681) | add\_action('wp\_ajax\_wploti\_add\_whitelisted\_users', array( $my\_wploti\_maintenance\_redirect, 'wploti\_add\_whitelisted\_users\_option') ); |
| [2682](#L2682) | add\_action('wp\_ajax\_wploti\_remove\_whitelisted\_users', array( $my\_wploti\_maintenance\_redirect, 'wploti\_remove\_whitelisted\_users\_option') ); |
| [2683](#L2683) | add\_action('wp\_ajax\_wploti\_logout\_users', array( $my\_wploti\_maintenance\_redirect, 'wploti\_logout\_users\_callback') ); |
| [2684](#L2684) |  |
| [2685](#L2685) | // activation & deactivation |
| [2686](#L2686) | register\_activation\_hook( \_\_FILE\_\_, array( $my\_wploti\_maintenance\_redirect, 'init' ) ); |
| [2687](#L2687) | register\_deactivation\_hook( \_\_FILE\_\_, array( $my\_wploti\_maintenance\_redirect, 'wploti\_deactivate' ) ); |
| [2688](#L2688) |  |
| [2689](#L2689) | // Reset Settings action |
| [2690](#L2690) | add\_action( 'wp\_ajax\_wploti\_reset\_settings', array( $my\_wploti\_maintenance\_redirect, 'reset\_plugin\_settings' ) ); |
| [2691](#L2691) |  |
| [2692](#L2692) | // Translation |
| [2693](#L2693) | add\_action( 'plugins\_loaded', array( $my\_wploti\_maintenance\_redirect, 'wploti\_translation' )); |
| [2694](#L2694) |  |
| [2695](#L2695) | add\_action('admin\_head', array( $my\_wploti\_maintenance\_redirect, 'add\_site\_favicon')); |
| [2696](#L2696) | //add\_action('wp\_default\_scripts', array( $my\_wploti\_maintenance\_redirect, 'remove\_jquery\_migrate\_console') ); |
| [2697](#L2697) |  |
| [2698](#L2698) |  |
| [2699](#L2699) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php?format=txt)
* [Original Format](/export/3222476/maintenance-coming-soon-redirect-animation/trunk/wploti_maintenance_redirect.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


