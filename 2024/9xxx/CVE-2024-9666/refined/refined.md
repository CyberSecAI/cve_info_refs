```
{
  "cveId": "CVE-2024-9666",
  "description": "Keycloak proxy header handling Denial-of-Service (DoS) vulnerability",
  "vulnerabilityDetails": {
    "rootCause": "Improper handling of proxy headers. Keycloak may accept non-IP values in proxy headers, such as obfuscated identifiers, without proper validation.",
    "weaknesses": [
      "Denial of Service (DoS) due to costly DNS resolution operations.",
      "Insufficient validation of input data (proxy headers)."
    ],
    "impact": "An attacker can exploit this vulnerability to tie up IO threads, potentially causing a denial of service.",
    "attackVectors": [
      "Sending requests to a Keycloak instance configured to accept proxy headers.",
       "The attack is triggered when reverse proxies do not overwrite incoming headers, and Keycloak is configured to trust these headers."
    ],
    "attackerCapabilities": "The attacker needs to have access to send requests to the Keycloak instance and be able to influence the proxy headers." ,
    "additionalDetails": [
        "Successful exploitation in Keycloak version 26 requires the realm to have SslRequired=EXTERNAL (the default), HTTP must be enabled, the instance must not be using a full hostname URL, access must come from behind a proxy (assuming the proxy overwrites the X-Forwarded-For header), and trusted proxies must not be set or must incorrectly trust the client from which the request is originating."
      ]
  },
  "affectedProducts": [
    "Red Hat build of Keycloak versions 26 and earlier."
  ],
  "fixes": [
    "Patched versions of Red Hat build of Keycloak 24.0.9, 26.0 and 26.0.6 address this vulnerability"
    ]
}
```