```
{
  "vulnerability": {
    "root_cause": "The `location()` method in the Express 3.x response object is vulnerable to open redirect due to improper handling of user-controlled input.",
    "weaknesses": [
      "Improper input validation.",
      "URL redirection vulnerability."
    ],
    "impact": "An attacker can redirect users to a malicious site, potentially leading to phishing attacks or malware infections.",
    "attack_vectors": "A crafted URL containing a malicious redirect path is provided as a query parameter. The vulnerable application, using the express `location()` method, will then redirect the user to the malicious site.",
    "required_capabilities": "The attacker needs to be able to craft a URL and have the victim click on it."
  },
  "additional_details": {
    "affected_versions": "Express versions >=3.4.5 and <4.0.0",
     "reproduction_steps": [
      "Create an Express application that takes a user-controlled query parameter and uses it in a redirect using `res.location()`.",
       "Send a crafted URL with a double slash followed by the intended redirection URL (e.g., `http://localhost:3000//?pageId=./example.com`)."
    ],
   "vulnerable_code":  "```javascript\napp.get('/', function (req, res) {\n  const pageId = req.query.pageId;\n  if (pageId && pageId[0] === '.') {\n    res.status(301).location(pageId);\n  }\n  res.send('OK');\n});\n```" ,
   "mitigations": [
    "Migrate to a newer version of Express (>=4.0.0).",
        "Use a commercial support partner for post-EOL security support."
      ]
  }
}
```