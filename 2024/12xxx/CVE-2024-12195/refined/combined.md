=== Content from plugins.trac.wordpress.org_48ba310f_20250115_092225.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3213295%2Fwedevs-project-manager)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3206717/wedevs-project-manager "Changeset 3206717 for wedevs-project-manager")
* Next Change →

---

# Changeset [3213295](/changeset/3213295 "Show full changeset") for [wedevs-project-manager](/browser/wedevs-project-manager?rev=3213295 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/26/2024 11:46:38 AM
([3 weeks](/timeline?from=2024-12-26T11%3A46%3A38Z&precision=second "See timeline at 12/26/2024 11:46:38 AM") ago)

Author:
wedevs
Message:

Update to version 2.6.17 from GitHub

Location:
[wedevs-project-manager](/browser/wedevs-project-manager?rev=3213295)
Files:

62 edited
1 copied

* [tags/2.6.17](/browser/wedevs-project-manager/tags/2.6.17?rev=3213295 "Show entry in browser")
  (copied)
  *(copied from [wedevs-project-manager/trunk](/browser/wedevs-project-manager/trunk?rev=3206717 "Show original file (revision 3213294)"))*
* [tags/2.6.17/changelog.txt](/browser/wedevs-project-manager/tags/2.6.17/changelog.txt?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/2.6.17/config/app.php](/browser/wedevs-project-manager/tags/2.6.17/config/app.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/2.6.17/core/Notifications/Emails/New\_Comment\_Notification.php](/browser/wedevs-project-manager/tags/2.6.17/core/Notifications/Emails/New_Comment_Notification.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/2.6.17/cpm.php](/browser/wedevs-project-manager/tags/2.6.17/cpm.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [tags/2.6.17/libs/functions.php](/browser/wedevs-project-manager/tags/2.6.17/libs/functions.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [tags/2.6.17/readme.txt](/browser/wedevs-project-manager/tags/2.6.17/readme.txt?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [tags/2.6.17/src/Activity/Controllers/Activity\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Activity/Controllers/Activity_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [tags/2.6.17/src/Category/Controllers/Category\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file8 "Show differences"))
* [tags/2.6.17/src/Comment/Controllers/Comment\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [tags/2.6.17/src/Discussion\_Board/Controllers/Discussion\_Board\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([10 diffs](#file10 "Show differences"))
* [tags/2.6.17/src/File/Controllers/File\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file11 "Show differences"))
* [tags/2.6.17/src/File/Models/File.php](/browser/wedevs-project-manager/tags/2.6.17/src/File/Models/File.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [tags/2.6.17/src/Imports/Controllers/Trello\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file13 "Show differences"))
* [tags/2.6.17/src/Imports/Controllers/Trello\_Controller\_backup.php](/browser/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller_backup.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [tags/2.6.17/src/Milestone/Controllers/Milestone\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([6 diffs](#file15 "Show differences"))
* [tags/2.6.17/src/My\_Task/Controllers/MyTask\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file16 "Show differences"))
* [tags/2.6.17/src/Project/Controllers/Project\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file17 "Show differences"))
* [tags/2.6.17/src/Role/Controllers/Role\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file18 "Show differences"))
* [tags/2.6.17/src/Search/Controllers/Search\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file19 "Show differences"))
* [tags/2.6.17/src/Settings/Controllers/Settings\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file20 "Show differences"))
* [tags/2.6.17/src/Settings/Controllers/Task\_Types\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file21 "Show differences"))
* [tags/2.6.17/src/Task/Controllers/Task\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([19 diffs](#file22 "Show differences"))
* [tags/2.6.17/src/Task/Helper/Task.php](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php?rev=3213295 "Show entry in browser")
  (modified)
  ([4 diffs](#file23 "Show differences"))
* [tags/2.6.17/src/Task\_List/Controllers/Task\_List\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([14 diffs](#file24 "Show differences"))
* [tags/2.6.17/src/User/Controllers/User\_Controller.php](/browser/wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file25 "Show differences"))
* [tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file26 "Show differences"))
* [tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file27 "Show differences"))
* [tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file28 "Show differences"))
* [tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295 "Show entry in browser")
  (modified)
  ([20 diffs](#file29 "Show differences"))
* [tags/2.6.17/vendor/composer/installed.json](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file30 "Show differences"))
* [tags/2.6.17/vendor/composer/installed.php](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file31 "Show differences"))
* [trunk/changelog.txt](/browser/wedevs-project-manager/trunk/changelog.txt?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [trunk/config/app.php](/browser/wedevs-project-manager/trunk/config/app.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [trunk/core/Notifications/Emails/New\_Comment\_Notification.php](/browser/wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))
* [trunk/cpm.php](/browser/wedevs-project-manager/trunk/cpm.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file35 "Show differences"))
* [trunk/libs/functions.php](/browser/wedevs-project-manager/trunk/libs/functions.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file36 "Show differences"))
* [trunk/readme.txt](/browser/wedevs-project-manager/trunk/readme.txt?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file37 "Show differences"))
* [trunk/src/Activity/Controllers/Activity\_Controller.php](/browser/wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file38 "Show differences"))
* [trunk/src/Category/Controllers/Category\_Controller.php](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file39 "Show differences"))
* [trunk/src/Comment/Controllers/Comment\_Controller.php](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file40 "Show differences"))
* [trunk/src/Discussion\_Board/Controllers/Discussion\_Board\_Controller.php](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([10 diffs](#file41 "Show differences"))
* [trunk/src/File/Controllers/File\_Controller.php](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file42 "Show differences"))
* [trunk/src/File/Models/File.php](/browser/wedevs-project-manager/trunk/src/File/Models/File.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file43 "Show differences"))
* [trunk/src/Imports/Controllers/Trello\_Controller.php](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file44 "Show differences"))
* [trunk/src/Imports/Controllers/Trello\_Controller\_backup.php](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file45 "Show differences"))
* [trunk/src/Milestone/Controllers/Milestone\_Controller.php](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([6 diffs](#file46 "Show differences"))
* [trunk/src/My\_Task/Controllers/MyTask\_Controller.php](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file47 "Show differences"))
* [trunk/src/Project/Controllers/Project\_Controller.php](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file48 "Show differences"))
* [trunk/src/Role/Controllers/Role\_Controller.php](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file49 "Show differences"))
* [trunk/src/Search/Controllers/Search\_Controller.php](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file50 "Show differences"))
* [trunk/src/Settings/Controllers/Settings\_Controller.php](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file51 "Show differences"))
* [trunk/src/Settings/Controllers/Task\_Types\_Controller.php](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file52 "Show differences"))
* [trunk/src/Task/Controllers/Task\_Controller.php](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([19 diffs](#file53 "Show differences"))
* [trunk/src/Task/Helper/Task.php](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=3213295 "Show entry in browser")
  (modified)
  ([4 diffs](#file54 "Show differences"))
* [trunk/src/Task\_List/Controllers/Task\_List\_Controller.php](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([14 diffs](#file55 "Show differences"))
* [trunk/src/User/Controllers/User\_Controller.php](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file56 "Show differences"))
* [trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file57 "Show differences"))
* [trunk/vendor/a5hleyrich/wp-background-processing/Makefile](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3213295 "Show entry in browser")
  (modified)
  ([1 diff](#file58 "Show differences"))
* [trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295 "Show entry in browser")
  (modified)
  ([2 diffs](#file59 "Show differences"))
* [trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295 "Show entry in browser")
  (modified)
  ([20 diffs](#file60 "Show differences"))
* [trunk/vendor/composer/installed.json](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295 "Show entry in browser")
  (modified)
  ([5 diffs](#file61 "Show differences"))
* [trunk/vendor/composer/installed.php](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3213295 "Show entry in browser")
  (modified)
  ([3 diffs](#file62 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wedevs-project-manager/tags/2.6.17/changelog.txt](/changeset/3213295/wedevs-project-manager/tags/2.6.17/changelog.txt "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/changelog.txt")

  | [r3206717](/browser/wedevs-project-manager/trunk/changelog.txt?rev=3206717#L1 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/changelog.txt?rev=3213295#L1 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | == Changelog == |
  |  | 2 |  |
  |  | 3 | = v2.6.17 - Dec 26, 2024 = |
  |  | 4 |  |
  |  | 5 | \*\*Improved:\*\* Enhanced sanitization of user input to strengthen data security. |
  |  | 6 | \*\*Fix:\*\* Resolved SQL security vulnerability to ensure system integrity.. |
  | 2 | 7 |  |
  | 3 | 8 | = v2.6.16 - Dec 10, 2024 = |
* ## [wedevs-project-manager/tags/2.6.17/config/app.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/config/app.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/config/app.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/config/app.php?rev=3206717#L4 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/config/app.php?rev=3213295#L4 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'name'        => 'Project Manager', |
  | 5 | 5 | 'slug'        => 'pm', |
  | 6 |  | 'version'     => '2.6.1~~6~~', |
  |  | 6 | 'version'     => '2.6.17', |
  | 7 | 7 | 'api'         => '2', |
  | 8 | 8 | 'db\_version'  => '2.5', |
* ## [wedevs-project-manager/tags/2.6.17/core/Notifications/Emails/New\_Comment\_Notification.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/core/Notifications/Emails/New_Comment_Notification.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/core/Notifications/Emails/New_Comment_Notification.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php?rev=2474296#L76 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/core/Notifications/Emails/New_Comment_Notification.php?rev=3213295#L76 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | ->where( 'meta\_key', 'title' ) |
  | 77 | 77 | ->first(); |
  | 78 |  | $title = $filemeta->meta\_value; |
  |  | 78 |  |
  |  | 79 | $title = $filemeta->meta\_value ?? ''; |
  | 79 | 80 | } |
  | 80 | 81 |  |
* ## [wedevs-project-manager/tags/2.6.17/cpm.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/cpm.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/cpm.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/cpm.php?rev=3206717#L6 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/cpm.php?rev=3213295#L6 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Author: weDevs |
  | 7 | 7 | \* Author URI: https://wedevs.com |
  | 8 |  | \* Version: 2.6.1~~6~~ |
  |  | 8 | \* Version: 2.6.17 |
  | 9 | 9 | \* Text Domain: wedevs-project-manager |
  | 10 | 10 | \* Domain Path: /languages |
* ## [wedevs-project-manager/tags/2.6.17/libs/functions.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/libs/functions.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/libs/functions.php")

  | [r2938582](/browser/wedevs-project-manager/trunk/libs/functions.php?rev=2938582#L1328 "Show revision 2938582 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/libs/functions.php?rev=3213295#L1328 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1328 | 1328 | return empty( $cap ) ? $caps : $caps[$cap]; |
  | 1329 | 1329 | } |
  |  | 1330 |  |
  |  | 1331 |  |
  |  | 1332 | function pm\_validate\_assignee( $assignees){ |
  |  | 1333 |  |
  |  | 1334 | if ( empty( $assignees ) ) { |
  |  | 1335 | return []; |
  |  | 1336 | } |
  |  | 1337 |  |
  |  | 1338 | if ( !is\_array( $assignees ) ) { |
  |  | 1339 | return []; |
  |  | 1340 | } |
  |  | 1341 |  |
  |  | 1342 | foreach ( $assignees as &$assignee ) { |
  |  | 1343 | // Sanitize user\_id and role\_id |
  |  | 1344 | $assignee['user\_id'] = absint( $assignee['user\_id'] ); |
  |  | 1345 | $assignee['role\_id'] = absint( $assignee['role\_id'] ); |
  |  | 1346 |  |
  |  | 1347 | // validate user\_id exists |
  |  | 1348 | $user = get\_user\_by( 'id', $assignee['user\_id'] ); |
  |  | 1349 | if ( ! $user ) { |
  |  | 1350 | continue; |
  |  | 1351 | } |
  |  | 1352 |  |
  |  | 1353 | // validate role\_id is a valid role in your system |
  |  | 1354 | if ( ! get\_role( $assignee['role\_id'] ) ) { |
  |  | 1355 | continue; |
  |  | 1356 | } |
  |  | 1357 | } |
  |  | 1358 |  |
  |  | 1359 | return $assignees; |
  |  | 1360 | } |
* ## [wedevs-project-manager/tags/2.6.17/readme.txt](/changeset/3213295/wedevs-project-manager/tags/2.6.17/readme.txt "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/readme.txt")

  | [r3206717](/browser/wedevs-project-manager/trunk/readme.txt?rev=3206717#L6 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/readme.txt?rev=3213295#L6 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.7.1 |
  | 7 | 7 | Requires PHP: 5.6 |
  | 8 |  | Stable tag: 2.6.1~~6~~ |
  |  | 8 | Stable tag: 2.6.17 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wedevs-project-manager/trunk/readme.txt?rev=3206717#L310) | […](/browser/wedevs-project-manager/tags/2.6.17/readme.txt?rev=3213295#L310) |  |
  | 310 | 310 | == Changelog == |
  | 311 | 311 |  |
  |  | 312 | = v2.6.17 - Dec 26, 2024 = |
  |  | 313 |  |
  |  | 314 | \*\*Improved:\*\* Enhanced sanitization of user input to strengthen data security. |
  |  | 315 | \*\*Fix:\*\* Resolved SQL security vulnerability to ensure system integrity.. |
  |  | 316 |  |
  | 312 | 317 | = v2.6.16 - Dec 10, 2024 = |
  | 313 | 318 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Activity/Controllers/Activity\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Activity/Controllers/Activity_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Activity/Controllers/Activity_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Activity/Controllers/Activity_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | public function index( WP\_REST\_Request $request ) { |
  | 21 | 21 |  |
  | 22 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  | 23 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  | 24 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 22 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 23 | $page       = intval( $request->get\_param( 'page' ) ); |
  |  | 24 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 25 | 25 |  |
  | 26 | 26 | $per\_page   = $per\_page ? $per\_page : 20; |
* ## [wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $type = ~~$request->get\_param( 'type'~~ ); |
  |  | 22 | $type = sanitize\_text\_field( $request->get\_param( 'type' ) ); |
  | 23 | 23 |  |
  | 24 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 24 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 25 | 25 | $per\_page = $per\_page ? $per\_page : 20; |
  | 26 | 26 |  |
  | 27 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 27 | $page = intval( $request->get\_param( 'page' ) ); |
  | 28 | 28 | $page = $page ? $page : 1; |
  | 29 | 29 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L54) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295#L54) |  |
  | 54 | 54 |  |
  | 55 | 55 | public function show( WP\_REST\_Request $request ) { |
  | 56 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 56 | $id = intval( $request->get\_param( 'id' ) ); |
  | 57 | 57 |  |
  | 58 | 58 | $category = Category::findOrFail( $id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L70) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295#L70) |  |
  | 70 | 70 | public function store( WP\_REST\_Request $request ) { |
  | 71 | 71 | $data = [ |
  | 72 |  | 'title' => ~~$request->get\_param( 'title'~~ ), |
  | 73 |  | 'description' => ~~$request->get\_param( 'description'~~ ), |
  | 74 |  | 'categorible\_type' => ~~$request->get\_param( 'categorible\_type'~~ ) |
  |  | 72 | 'title' => sanitize\_text\_field( $request->get\_param( 'title' ) ), |
  |  | 73 | 'description' => sanitize\_text\_field( $request->get\_param( 'description' ) ), |
  |  | 74 | 'categorible\_type' => sanitize\_text\_field( $request->get\_param( 'categorible\_type' ) ) |
  | 75 | 75 | ]; |
  | 76 | 76 | $data = array\_filter( $data ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L88) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295#L88) |  |
  | 88 | 88 |  |
  | 89 | 89 | public function update( WP\_REST\_Request $request ) { |
  | 90 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 90 | $id = intval( $request->get\_param( 'id' ) ); |
  | 91 | 91 |  |
  | 92 | 92 | $data = [ |
  | 93 |  | 'title' => ~~$request->get\_param( 'title'~~ ), |
  | 94 |  | 'description' => ~~$request->get\_param( 'description'~~ ), |
  | 95 |  | 'categorible\_type' => ~~$request->get\_param( 'categorible\_type'~~ ) |
  |  | 93 | 'title' => sanitize\_text\_field( $request->get\_param( 'title' ) ), |
  |  | 94 | 'description' => sanitize\_text\_field( $request->get\_param( 'description' ) ), |
  |  | 95 | 'categorible\_type' => sanitize\_text\_field( $request->get\_param( 'categorible\_type' ) ) |
  | 96 | 96 | ]; |
  |  | 97 |  |
  | 97 | 98 |  |
  | 98 | 99 | $category = Category::findOrFail( $id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L110) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Category/Controllers/Category_Controller.php?rev=3213295#L111) |  |
  | 110 | 111 |  |
  | 111 | 112 | public function destroy( WP\_REST\_Request $request ) { |
  | 112 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 113 | $id = intval( $request->get\_param( 'id' ) ); |
  | 113 | 114 | $category = Category::find( $id ); |
  | 114 | 115 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment_Controller.php")

  | [r3185807](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3185807#L23 "Show revision 3185807 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment_Controller.php?rev=3213295#L23 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 |  |
  | 24 | 24 | public function index( WP\_REST\_Request $request ) { |
  | 25 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 26 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  | 27 |  | $page     = ~~$request->get\_param( 'page'~~ ); |
  |  | 25 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 26 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 27 | $page     = intval( $request->get\_param( 'page' ) ); |
  | 28 | 28 |  |
  | 29 | 29 | $per\_page = $per\_page ? $per\_page : pm\_config('app.comment\_per\_page'); |
  | […](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3185807#L31) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Comment/Controllers/Comment_Controller.php?rev=3213295#L31) |  |
  | 31 | 31 |  |
  | 32 | 32 | $on = $request->get\_param( 'on' ); |
  | 33 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 33 | $id = intval( $request->get\_param( 'id' ) ); |
  | 34 | 34 | $by = $request->get\_param( 'by' ); |
  | 35 | 35 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Discussion\_Board/Controllers/Discussion\_Board\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php")

  | [r3185807](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L27 "Show revision 3185807 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L27 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 |  |
  | 28 | 28 | public function index( WP\_REST\_Request $request ) { |
  | 29 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 30 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 29 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 30 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 31 | 31 | $per\_page = $per\_page ? $per\_page : 15; |
  | 32 | 32 |  |
  | 33 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 33 | $page = intval( $request->get\_param( 'page' ) ); |
  | 34 | 34 | $page = $page ? $page : 1; |
  | 35 | 35 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L52) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L52) |  |
  | 52 | 52 |  |
  | 53 | 53 | public function show( WP\_REST\_Request $request ) { |
  | 54 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 55 |  | $discussion\_board\_id = ~~$request->get\_param( 'discussion\_board\_id'~~ ); |
  | 56 |  |  |
  |  | 54 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 55 | $discussion\_board\_id = intval( $request->get\_param( 'discussion\_board\_id' ) ); |
  |  | 56 |  |
  | 57 | 57 | $discussion\_board  = Discussion\_Board::with('metas')->where( 'id', $discussion\_board\_id )->where( 'project\_id', $project\_id ); |
  | 58 | 58 | $discussion\_board = apply\_filters( 'pm\_discuss\_show\_query', $discussion\_board, $project\_id, $request ); |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L73) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L73) |  |
  | 73 | 73 | $data         = $this->extract\_non\_empty\_values( $request ); |
  | 74 | 74 | $media\_data   = $request->get\_file\_params(); |
  | 75 |  | $milestone\_id = ~~$request->get\_param( 'milestone'~~ ); |
  |  | 75 | $milestone\_id = intval( $request->get\_param( 'milestone' ) ); |
  | 76 | 76 | $files        = array\_key\_exists( 'files', $media\_data ) ? $media\_data['files'] : null; |
  | 77 |  |  |
  |  | 77 |  |
  | 78 | 78 | if( HelperFile::check\_file\_for\_xss\_code( $files ) ){ |
  | 79 | 79 | return wp\_send\_json( |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L83) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L83) |  |
  | 83 | 83 | ], 400 |
  | 84 | 84 | ); |
  | 85 |  | ~~wp\_die();~~ |
  | 86 | 85 | } |
  | 87 | 86 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L114) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L113) |  |
  | 114 | 113 | $data                = $this->extract\_non\_empty\_values( $request ); |
  | 115 | 114 | $media\_data          = $request->get\_file\_params(); |
  | 116 |  | $project\_id          = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 115 | $project\_id          = intval( $request->get\_param( 'project\_id' ) ); |
  | 117 | 116 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 118 | 117 | $milestone\_id        = $request->get\_param( 'milestone' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L127) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L126) |  |
  | 127 | 126 | ], 400 |
  | 128 | 127 | ); |
  | 129 |  | wp\_die(); |
  | 130 |  | } |
  | 131 |  |  |
  | 132 |  | $is\_private    = $request->get\_param( 'privacy' ); |
  |  | 128 | } |
  |  | 129 |  |
  |  | 130 | $is\_private    = sanitize\_text\_field( $request->get\_param( 'privacy' ) ); |
  | 133 | 131 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 134 | 132 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L166) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L164) |  |
  | 166 | 164 |  |
  | 167 | 165 | public function destroy( WP\_REST\_Request $request ) { |
  | 168 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 166 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 169 | 167 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 170 | 168 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L213) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L211) |  |
  | 213 | 211 |  |
  | 214 | 212 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 215 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 216 |  | $discussion\_board\_id = ~~$request->get\_param( 'discussion\_board\_id'~~ ); |
  |  | 213 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 214 | $discussion\_board\_id = intval( $request->get\_param( 'discussion\_board\_id' ) ); |
  | 217 | 215 |  |
  | 218 | 216 | $discussion\_board = Discussion\_Board::where( 'id', $discussion\_board\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L240) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L238) |  |
  | 240 | 238 |  |
  | 241 | 239 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 242 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 240 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 243 | 241 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 244 | 242 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L259) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L257) |  |
  | 259 | 257 |  |
  | 260 | 258 | public function privacy( WP\_REST\_Request $request ) { |
  | 261 |  | $project\_id = $request->get\_param( 'project\_id' ); |
  | 262 |  | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 263 |  | $privacy = $request->get\_param( 'is\_private' ); |
  |  | 259 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 260 | $discussion\_board\_id = intval($request->get\_param( 'discussion\_board\_id' ) ); |
  |  | 261 | $privacy = intval( $request->get\_param( 'is\_private' ) ); |
  |  | 262 |  |
  | 264 | 263 | $discuss = Discussion\_Board::find( $discussion\_board\_id ); |
  | 265 | 264 | $discuss->update\_model( [ |
* ## [wedevs-project-manager/tags/2.6.17/src/File/Controllers/File\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 23 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 22 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 23 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 24 | 24 | $per\_page = $per\_page ? $per\_page : 200; |
  | 25 | 25 |  |
  | 26 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 26 | $page = intval( $request->get\_param( 'page' ) ); |
  | 27 | 27 | $page = $page ? $page : 1; |
  | 28 | 28 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L46) | […](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295#L46) |  |
  | 46 | 46 |  |
  | 47 | 47 | public function show( WP\_REST\_Request $request ) { |
  | 48 |  | $file\_id = ~~$request->get\_param( 'file\_id'~~ ); |
  |  | 48 | $file\_id = intval($request->get\_param( 'file\_id' ) ); |
  | 49 | 49 | $file = File::find( $file\_id ); |
  | 50 | 50 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L70) | […](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295#L70) |  |
  | 70 | 70 |  |
  | 71 | 71 | public function rename( WP\_REST\_Request $request ) { |
  | 72 |  | $file\_id   = ~~$request->get\_param( 'file\_id'~~ ); |
  | 73 |  | $file\_name = ~~$request->get\_param( 'name'~~ ); |
  |  | 72 | $file\_id   = intval( $request->get\_param( 'file\_id' ) ); |
  |  | 73 | $file\_name = sanitize\_file\_name($request->get\_param( 'name' ) ); |
  | 74 | 74 | $file      = File::find( $file\_id ); |
  | 75 | 75 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L82) | […](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295#L82) |  |
  | 82 | 82 |  |
  | 83 | 83 | public function destroy( WP\_REST\_Request $request ) { |
  | 84 |  | $file\_id = ~~$request->get\_param( 'file\_id'~~ ); |
  |  | 84 | $file\_id = intval( $request->get\_param( 'file\_id' ) ); |
  | 85 | 85 |  |
  | 86 | 86 | $file = File::find( $file\_id ); |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L92) | […](/browser/wedevs-project-manager/tags/2.6.17/src/File/Controllers/File_Controller.php?rev=3213295#L92) |  |
  | 92 | 92 |  |
  | 93 | 93 | public function download( WP\_REST\_Request $request ) { |
  | 94 |  | $file\_id = ~~$request->get\_param('file\_id'~~); |
  |  | 94 | $file\_id = intval( $request->get\_param('file\_id') ); |
  | 95 | 95 |  |
  | 96 | 96 | //get file path |
* ## [wedevs-project-manager/tags/2.6.17/src/File/Models/File.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/File/Models/File.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/File/Models/File.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/File/Models/File.php?rev=2474296#L28 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/File/Models/File.php?rev=3213295#L28 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 | public function comment() { |
  | 29 | 29 | return $this->hasOne( 'WeDevs\PM\Comment\Models\Comment', 'id', 'fileable\_id'); |
  | 30 |  | ~~return $this->belongsToMany( 'WeDevs\PM\Common\Models\Board', pm\_tb\_prefix() . 'pm\_comments', 'id', 'commentable\_id', 'fileable\_id');~~ |
  | 31 | 30 | } |
  | 32 | 31 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=2474296#L21 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller.php?rev=3213295#L21 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | public function test( WP\_REST\_Request $request ) { |
  | 22 | 22 |  |
  | 23 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 24 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 23 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 24 | $app\_token = trim(sanitize\_text\_field($request->get\_param('app\_token'))); |
  | 25 | 25 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 26 | 26 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=2474296#L49) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller.php?rev=3213295#L49) |  |
  | 49 | 49 |  |
  | 50 | 50 | public function get\_user(WP\_REST\_Request $request){ |
  | 51 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 52 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 51 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 52 | $app\_token = trim(sanitize\_text\_field($request->get\_param('app\_token'))); |
  | 53 | 53 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 54 | 54 | $trello\_user = $trello\_helper->get\_trello\_user(); |
* ## [wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello\_Controller\_backup.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller_backup.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller_backup.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Imports/Controllers/Trello_Controller_backup.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | public function test( WP\_REST\_Request $request ) { |
  | 20 | 20 |  |
  | 21 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 22 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 21 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 22 | $app\_token = trim(sanitize\_text\_field( $request->get\_param('app\_token'))); |
  | 23 | 23 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 24 | 24 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L32 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L32 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 32 | 32 |  |
  | 33 | 33 | public function index( WP\_REST\_Request $request ) { |
  | 34 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 35 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  | 36 |  | $status     = ~~$request->get\_param( 'status'~~ ); |
  |  | 34 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 35 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 36 | $status     = sanitize\_text\_field($request->get\_param( 'status' ) ); |
  | 37 | 37 | $per\_page   = $per\_page ? $per\_page : -1; |
  | 38 | 38 |  |
  | 39 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 39 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 40 | 40 | $page       = $page ? $page : 1; |
  | 41 | 41 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L77) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L77) |  |
  | 77 | 77 |  |
  | 78 | 78 | public function show( WP\_REST\_Request $request ) { |
  | 79 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 80 |  | $milestone\_id = ~~$request->get\_param( 'milestone\_id'~~ ); |
  |  | 79 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 80 | $milestone\_id = intval( $request->get\_param( 'milestone\_id' ) ); |
  | 81 | 81 |  |
  | 82 | 82 | $milestone = Milestone::where( 'id', $milestone\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L131) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L131) |  |
  | 131 | 131 | // Grab non empty user input |
  | 132 | 132 | $data = $this->extract\_non\_empty\_values( $request ); |
  | 133 |  | $is\_private    = ~~$request->get\_param( 'privacy'~~ ); |
  |  | 133 | $is\_private    = sanitize\_text\_field( $request->get\_param( 'privacy' ) ); |
  | 134 | 134 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 135 | 135 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L174) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L174) |  |
  | 174 | 174 |  |
  | 175 | 175 | // Set project id from url parameter |
  | 176 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 176 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  | 177 | 177 |  |
  | 178 | 178 | // Set milestone id from url parameter |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L215) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L215) |  |
  | 215 | 215 |  |
  | 216 | 216 | public function destroy( WP\_REST\_Request $request ) { |
  | 217 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 217 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  | 218 | 218 | $milestone\_id = $request->get\_param( 'milestone\_id' ); |
  | 219 | 219 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L234) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L234) |  |
  | 234 | 234 | } |
  | 235 | 235 | public function privacy( WP\_REST\_Request $request ) { |
  | 236 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 236 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 237 | 237 | $milestone\_id = $request->get\_param( 'milestone\_id' ); |
  | 238 | 238 | $privacy = $request->get\_param( 'is\_private' ); |
* ## [wedevs-project-manager/tags/2.6.17/src/My\_Task/Controllers/MyTask\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php")

  | [r2918375](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L23 "Show revision 2918375 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L23 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 |  |
  | 24 | 24 | public function user\_tasks\_by\_type ( WP\_REST\_Request $request ) { |
  | 25 |  | $id       = $request->get\_param( 'id' ); |
  | 26 |  | $taskType = $request->get\_param( 'task\_type' ); |
  |  | 25 | $id       = intval( $request->get\_param( 'id' ) ); |
  |  | 26 | $taskType = sanitize\_text\_field( $request->get\_param( 'task\_type' ) ); |
  |  | 27 |  |
  | 27 | 28 | $today = date( 'Y-m-d', strtotime( current\_time( 'mysql' ) ) ); |
  | 28 | 29 |  |
  | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L655) | […](/browser/wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L656) |  |
  | 655 | 656 |  |
  | 656 | 657 | // public function user\_calender\_tasks\_x( WP\_REST\_Request $request ) { |
  | 657 |  | //     $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 658 | //     $id = intval( $request->get\_param( 'id' ) ); |
  | 658 | 659 | //     $start      = $request->get\_param( 'start' ); |
  | 659 | 660 | //     $end        = $request->get\_param( 'end' ); |
  | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L722) | […](/browser/wedevs-project-manager/tags/2.6.17/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L723) |  |
  | 722 | 723 |  |
  | 723 | 724 | public function user\_activities ( WP\_REST\_Request $request ) { |
  | 724 |  | $id       = ~~$request->get\_param( 'id'~~ ); |
  |  | 725 | $id       = intval( $request->get\_param( 'id' ) ); |
  | 725 | 726 | $page     = $request->get\_param( 'mytask\_activities\_page' ); |
  | 726 | 727 | $per\_page = $request->get\_param( 'mytask\_activities\_per\_page' ); |
* ## [wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L26 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295#L26 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 26 | 26 |  |
  | 27 | 27 | public function index( WP\_REST\_Request $request ) { |
  | 28 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  | 29 |  | $page     = ~~$request->get\_param( 'page'~~ ); |
  |  | 28 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 29 | $page     = intval( $request->get\_param( 'page' ) ); |
  | 30 | 30 | $status   = $request->get\_param( 'status' ); |
  | 31 | 31 | $category = $request->get\_param( 'category' ); |
  | 32 | 32 | $project\_transform = $request->get\_param( 'project\_transform' ); |
  | 33 |  |  |
  |  | 33 |  |
  | 34 | 34 | $per\_page\_from\_settings = pm\_get\_setting( 'project\_per\_page' ); |
  | 35 | 35 | $per\_page\_from\_settings = $per\_page\_from\_settings ? $per\_page\_from\_settings : 15; |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L216) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295#L216) |  |
  | 216 | 216 | add\_option('projectId\_git\_bit\_hash\_'.$project->id , sha1(strtotime("now").$project->id)); |
  | 217 | 217 | // Establishing relationships |
  | 218 |  | $category\_ids = $request->get\_param( 'categories' ); |
  |  | 218 | $category\_ids = intval( $request->get\_param( 'categories' ) ); |
  |  | 219 |  |
  | 219 | 220 | if ( $category\_ids ) { |
  | 220 | 221 | $project->categories()->sync( $category\_ids ); |
  | 221 | 222 | } |
  | 222 | 223 |  |
  | 223 |  | $assignees =  $request->get\_param( 'assignees' ); |
  |  | 224 | $assignees = pm\_validate\_assignee( $request->get\_param( 'assignees' ) ); |
  |  | 225 |  |
  | 224 | 226 | $assignees[] = [ |
  | 225 | 227 | 'user\_id' => wp\_get\_current\_user()->ID, |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L253) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295#L255) |  |
  | 253 | 255 |  |
  | 254 | 256 | // Establishing relationships |
  | 255 |  | $category\_ids = ~~$request->get\_param( 'categories'~~ ); |
  |  | 257 | $category\_ids = intval( $request->get\_param( 'categories' )); |
  | 256 | 258 | if ( $category\_ids ) { |
  | 257 | 259 | $project->categories()->sync( $category\_ids ); |
  | 258 | 260 | } |
  | 259 | 261 |  |
  | 260 |  | $assignees = ~~$request->get\_param( 'assignees'~~ ); |
  |  | 262 | $assignees = pm\_validate\_assignee( $request->get\_param( 'assignees' ) ); |
  | 261 | 263 |  |
  | 262 | 264 | if ( is\_array( $assignees ) ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L323) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295#L325) |  |
  | 323 | 325 |  |
  | 324 | 326 | public function destroy( WP\_REST\_Request $request ) { |
  | 325 |  | $id = ~~$request->get\_param('id'~~); |
  |  | 327 | $id = intval( $request->get\_param('id') ); |
  | 326 | 328 |  |
  | 327 | 329 | // Find the requested resource |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L381) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Project/Controllers/Project_Controller.php?rev=3213295#L383) |  |
  | 381 | 383 |  |
  | 382 | 384 | public function favourite\_project (WP\_REST\_Request $request) { |
  | 383 |  | $project\_id = ~~$request->get\_param( 'id'~~ ); |
  | 384 |  | $favourite  = ~~$request->get\_param( 'favourite' )~~; |
  |  | 385 | $project\_id = intval( $request->get\_param( 'id' ) ); |
  |  | 386 | $favourite  = sanitize\_text\_field( $request->get\_param( 'favourite' ) ) ; |
  | 385 | 387 | $user\_id    = get\_current\_user\_id(); |
  | 386 | 388 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=2474296#L27 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role_Controller.php?rev=3213295#L27 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 |  |
  | 28 | 28 | public function show( WP\_REST\_Request $request ) { |
  | 29 |  | $id       = ~~$request->get\_param('id'~~); |
  |  | 29 | $id       = intval( $request->get\_param('id') ); |
  | 30 | 30 | $role     = Role::where('status', 1)->find( $id ); |
  | 31 | 31 | $resource = new Item( $role, new Role\_Transformer ); |
  | […](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=2474296#L57) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Role/Controllers/Role_Controller.php?rev=3213295#L57) |  |
  | 57 | 57 |  |
  | 58 | 58 | public function destroy( WP\_REST\_Request $request ) { |
  | 59 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 59 | $id = intval( $request->get\_param( 'id' ) ); |
  | 60 | 60 | $role = Role::find( $id ); |
  | 61 | 61 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search_Controller.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 |  |
  | 20 | 20 | public function search( WP\_REST\_Request $request ) { |
  | 21 |  | $string     = ~~$request->get\_param( 'query'~~ ); |
  | 22 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 21 | $string     = sanitize\_text\_field( $request->get\_param( 'query' ) ); |
  |  | 22 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 23 | 23 | $model      = $request->get\_param( 'model' ); //[milestone, discussion\_board, task\_list, task] |
  | 24 | 24 | $model      = empty( $model ) ? '' : $model; |
  | […](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=2474296#L35) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Search/Controllers/Search_Controller.php?rev=3213295#L35) |  |
  | 35 | 35 |  |
  | 36 | 36 | public function searchTopBar( WP\_REST\_Request $request ) { |
  | 37 |  | $string     = ~~$request->get\_param( 'query'~~ ); |
  | 38 |  | $type     = ~~$request->get\_param( 'type'~~ ); |
  |  | 37 | $string     = sanitize\_text\_field ( $request->get\_param( 'query' ) ); |
  |  | 38 | $type     = sanitize\_text\_field( $request->get\_param( 'type' ) ); |
  | 39 | 39 | $model      = $request->get\_param( 'model' ); //[milestone, discussion\_board, task\_list, task] |
  | 40 | 40 | $model      = empty( $model ) ? '' : $model; |
* ## [wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 |  |
  | 20 | 20 | public function index( WP\_REST\_Request $request ) { |
  | 21 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 21 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 22 | 22 | $key        = $request->get\_param( 'key' ); |
  | 23 | 23 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L54) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L54) |  |
  | 54 | 54 | public function store( WP\_REST\_Request $request ) { |
  | 55 | 55 | $data       = $this->extract\_non\_empty\_values( $request ); |
  | 56 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 56 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 57 | 57 | $settings   = $request->get\_param( 'settings' ); |
  | 58 |  | $id         = ~~$request->get\_param( 'id'~~ ); |
  |  | 58 | $id         = intval( $request->get\_param( 'id' ) ); |
  | 59 | 59 |  |
  | 60 | 60 | if ( is\_array( $settings ) ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L115) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L115) |  |
  | 115 | 115 |  |
  | 116 | 116 | public function destroy( WP\_REST\_Request $request ) { |
  | 117 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 117 | $id = intval( $request->get\_param( 'id' ) ); |
  | 118 | 118 |  |
  | 119 | 119 | $settings = Settings::where( 'id', $id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L132) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L132) |  |
  | 132 | 132 | $key = $request->get\_param('key'); |
  | 133 | 133 |  |
  | 134 |  | return pm\_get\_setting( $k~~ye~~ ); |
  |  | 134 | return pm\_get\_setting( $key ); |
  | 135 | 135 | } |
  | 136 | 136 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L139) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L139) |  |
  | 139 | 139 | $key        = $request->get\_param('key'); |
  | 140 | 140 |  |
  | 141 |  | return pm\_get\_setting( $k~~ye~~, $project\_id ); |
  |  | 141 | return pm\_get\_setting( $key, $project\_id ); |
  | 142 | 142 | } |
  | 143 | 143 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task\_Types\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 22 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 23 | 23 | $per\_page   = $per\_page ? $per\_page : 500; |
  | 24 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 24 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 25 | 25 | $page       = empty( $page ) ? 1 : $page; |
  | 26 | 26 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L67) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L67) |  |
  | 67 | 67 |  |
  | 68 | 68 | public function update\_task\_type( WP\_REST\_Request $request ) { |
  | 69 |  | $id          = ~~$request->get\_param( 'id'~~ ); |
  |  | 69 | $id          = intval( $request->get\_param( 'id' ) ); |
  | 70 | 70 | $title       = $request->get\_param( 'title' ); |
  | 71 | 71 | $description = $request->get\_param( 'description' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L89) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L89) |  |
  | 89 | 89 |  |
  | 90 | 90 | public function destroy\_task\_type( WP\_REST\_Request $request ) { |
  | 91 |  | $id    = ~~$request->get\_param( 'id'~~ ); |
  |  | 91 | $id    = intval( $request->get\_param( 'id' ) ); |
  | 92 | 92 |  |
  | 93 | 93 | $stored\_type = Task\_Types::where( 'id', $id ) |
* ## [wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php")

  | [r2627870](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L50 "Show revision 2627870 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L50 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 50 | 50 |  |
  | 51 | 51 | public function index( WP\_REST\_Request $request ) { |
  | 52 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 53 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 52 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 53 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 54 | 54 | $per\_page   = $per\_page ? $per\_page : 5; |
  | 55 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  | 56 |  | $search     = ~~$request->get\_param( 's'~~ ); |
  |  | 55 | $page       = intval( $request->get\_param( 'page' ) ); |
  |  | 56 | $search     = sanitize\_text\_field( $request->get\_param( 's' ) ); |
  | 57 | 57 |  |
  | 58 | 58 | Paginator::currentPageResolver(function () use ($page) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L92) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L92) |  |
  | 92 | 92 |  |
  | 93 | 93 | public function show( WP\_REST\_Request $request ) { |
  | 94 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 95 |  | $task\_id    = ~~$request->get\_param( 'task\_id'~~ ); |
  |  | 94 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 95 | $task\_id    = intval( $request->get\_param( 'task\_id' ) ); |
  | 96 | 96 | return $this->get\_task( $task\_id, $project\_id, $request->get\_params() ); |
  | 97 | 97 | } |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L102) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L102) |  |
  | 102 | 102 | 'with' => 'project, activities, comments, task\_list, time, labels' |
  | 103 | 103 | ] ); |
  | 104 |  | ~~// $task = Task::with( 'task\_lists' )~~ |
  | 105 |  | ~~//     ->where( 'id', $task\_id )~~ |
  | 106 |  | ~~//     ->parent();~~ |
  | 107 |  |  |
  | 108 |  | ~~// if ( $project\_id ) {~~ |
  | 109 |  | ~~//     $task = $task->where( 'project\_id', $project\_id );~~ |
  | 110 |  |  |
  | 111 |  | ~~// }~~ |
  | 112 |  |  |
  | 113 |  | ~~// $task = apply\_filters( 'pm\_task\_show\_query', $task, $project\_id, $request );~~ |
  | 114 |  | ~~// $task = $task->first();~~ |
  | 115 |  |  |
  | 116 |  | ~~// if ( $task == NULL ) {~~ |
  | 117 |  | ~~//     return pm\_get\_response( null,  [~~ |
  | 118 |  | ~~//         'message' => pm\_get\_text('success\_messages.no\_element')~~ |
  | 119 |  | ~~//     ] );~~ |
  | 120 |  | ~~// }~~ |
  | 121 |  |  |
  | 122 |  | ~~// $resource = new Item( $task, new Task\_Transformer );~~ |
  | 123 |  | ~~// $response = self::getInstance()->get\_response( $resource );~~ |
  | 124 |  | ~~// $response = apply\_filters('pm\_get\_task', $response , $request);~~ |
  | 125 |  |  |
  | 126 |  | ~~// return $response ;~~ |
  | 127 | 104 | } |
  | 128 | 105 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L186) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L163) |  |
  | 186 | 163 | public function store( WP\_REST\_Request $request ) { |
  | 187 | 164 | $data          = $this->extract\_non\_empty\_values( $request ); |
  | 188 |  | $project\_id    = ~~$request->get\_param( 'project\_id'~~ ); |
  | 189 |  | $board\_id      = ~~$request->get\_param( 'board\_id'~~ ); |
  | 190 |  | $assignees     = ~~$request->get\_param( 'assignees'~~ ); |
  | 191 |  | $is\_private    = ~~$request->get\_param( 'privacy'~~ ); |
  | 192 |  | $type\_id       = ~~$request->get\_param( 'type\_id'~~ ); |
  |  | 165 | $project\_id    = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 166 | $board\_id      = intval( $request->get\_param( 'board\_id' ) ); |
  |  | 167 | $assignees     = array\_map( 'intval', $request->get\_param( 'assignees' )); |
  |  | 168 | $is\_private    = intval( $request->get\_param( 'privacy' ) ); |
  |  | 169 | $type\_id       = intval( $request->get\_param( 'type\_id' ) ); |
  | 193 | 170 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 194 | 171 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L208) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L185) |  |
  | 208 | 185 |  |
  | 209 | 186 | do\_action( 'cpm\_task\_new', $board\_id, $task->id, $request->get\_params() ); |
  | 210 |  | ~~// do\_action('pm\_after\_update\_task', $task, $request->get\_params() );~~ |
  | 211 | 187 |  |
  | 212 | 188 | if ( $task && $board ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L354) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L330) |  |
  | 354 | 330 | } |
  | 355 | 331 |  |
  | 356 |  | // public static function task\_update( $params ) { |
  | 357 |  | //     $task\_id    = $params['task\_id']; |
  | 358 |  |  |
  | 359 |  | //     $task = Task::with('assignees')->find( $task\_id ); |
  | 360 |  |  |
  | 361 |  | //     if ( ! isset( $params['assignees'] ) ) { |
  | 362 |  | //         $assignees  = wp\_list\_pluck( $task->assignees->toArray(), 'assigned\_to' ); |
  | 363 |  | //     } else { |
  | 364 |  | //         $assignees  = empty( $params['assignees'] ) ? [] : $params['assignees']; |
  | 365 |  | //     } |
  | 366 |  |  |
  | 367 |  | //     $list\_id              = $task->task\_list; |
  | 368 |  | //     $project\_id           = $task->project\_id; |
  | 369 |  | //     $params['project\_id'] = $task->project\_id; |
  | 370 |  | //     $params['list\_id']    = $task->task\_list; |
  | 371 |  | //     $is\_private           = isset( $params['privacy'] ) ? $params['privacy'] : false; |
  | 372 |  | //     $params['is\_private'] = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 373 |  |  |
  | 374 |  | //     $deleted\_users = $task->assignees()->whereNotIn( 'assigned\_to', $assignees )->get()->toArray(); //->delete(); |
  | 375 |  | //     $deleted\_users = apply\_filters( 'pm\_task\_deleted\_users', $deleted\_users, $task ); |
  | 376 |  | //     $deleted\_users = wp\_list\_pluck( $deleted\_users, 'id' ); |
  | 377 |  |  |
  | 378 |  | //     if ( $deleted\_users ) { |
  | 379 |  | //         Assignee::destroy( $deleted\_users ); |
  | 380 |  | //     } |
  | 381 |  |  |
  | 382 |  | //     self::getInstance()->attach\_assignees( $task, $assignees ); |
  | 383 |  |  |
  | 384 |  | //     do\_action( 'cpm\_task\_update', $list\_id, $task\_id, $params ); |
  | 385 |  |  |
  | 386 |  | //     $params = apply\_filters( 'pm\_before\_update\_task', $params, $list\_id, $task\_id, $task ); |
  | 387 |  | //     $task->update\_model( $params ); |
  | 388 |  |  |
  | 389 |  | //     do\_action( 'cpm\_after\_update\_task', $task->id, $list\_id, $project\_id ); |
  | 390 |  | //     do\_action('pm\_after\_update\_task', $task, $params ); |
  | 391 |  |  |
  | 392 |  | //     $resource = new Item( $task, new Task\_Transformer ); |
  | 393 |  |  |
  | 394 |  | //     $message = [ |
  | 395 |  | //         'message' => pm\_get\_text('success\_messages.task\_updated'), |
  | 396 |  | //         'activity' => self::getInstance()->last\_activity( 'task', $task->id ), |
  | 397 |  | //     ]; |
  | 398 |  |  |
  | 399 |  | //     $response = self::getInstance()->get\_response( $resource, $message ); |
  | 400 |  |  |
  | 401 |  | //     do\_action('pm\_update\_task\_aftre\_transformer', $response, $params ); |
  | 402 |  |  |
  | 403 |  | //     return $response; |
  | 404 |  | // } |
  | 405 |  |  |
  |  | 332 |  |
  | 406 | 333 | public static function task\_update( $params ) { |
  | 407 |  | $task\_id    = ~~$params['task\_id']~~; |
  |  | 334 | $task\_id    = intval( $params['task\_id'] ); |
  | 408 | 335 |  |
  | 409 | 336 | $task = Task::with('assignees')->find( $task\_id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L412) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L339) |  |
  | 412 | 339 | $assignees  = wp\_list\_pluck( $task->assignees->toArray(), 'assigned\_to' ); |
  | 413 | 340 | } else { |
  | 414 |  | $assignees  = empty( $params['assignees'] ) ? [] : ~~$params['assignees']~~; |
  |  | 341 | $assignees  = empty( $params['assignees'] ) ? [] : array\_map( 'intval', $params['assignees'] ); |
  | 415 | 342 | } |
  | 416 | 343 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L492) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L419) |  |
  | 492 | 419 | do\_action( 'pm\_changed\_task\_status', $task, $old\_value, $request->get\_params() ); |
  | 493 | 420 |  |
  | 494 |  | ~~//$resource = new Item( $task, new Task\_Transformer );~~ |
  | 495 | 421 | $task\_response = Task\_Helper::get\_results([ |
  | 496 | 422 | 'id' => $task->id, |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L503) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L429) |  |
  | 503 | 429 | 'data'     => $task\_response['data'] |
  | 504 | 430 | ]; |
  | 505 |  |  |
  | 506 |  | ~~// $message = [~~ |
  | 507 |  | ~~//     'message' => pm\_get\_text('success\_messages.task\_updated'),~~ |
  | 508 |  | ~~//     'activity' => $this->last\_activity( 'task', $task->id ),~~ |
  | 509 |  | ~~// ];~~ |
  | 510 |  |  |
  | 511 |  | ~~// $response = $this->get\_response( $resource, $message );~~ |
  | 512 | 431 |  |
  | 513 | 432 | do\_action('pm\_changed\_task\_status\_aftre\_transformer', $response, $request->get\_params() ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L588) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L507) |  |
  | 588 | 507 | public function destroy( WP\_REST\_Request $request ) { |
  | 589 | 508 | // Grab user inputs |
  | 590 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 509 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 591 | 510 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 592 | 511 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L679) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L598) |  |
  | 679 | 598 |  |
  | 680 | 599 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 681 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 600 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 682 | 601 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 683 | 602 | $user\_ids   = $request->get\_param( 'users' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L704) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L623) |  |
  | 704 | 623 |  |
  | 705 | 624 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 706 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 625 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 707 | 626 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 708 | 627 | $user\_ids   = $request->get\_param( 'users' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L744) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L663) |  |
  | 744 | 663 |  |
  | 745 | 664 | public function privacy( WP\_REST\_Request $request ) { |
  | 746 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 665 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 747 | 666 | $task\_id = $request->get\_param( 'task\_id' ); |
  | 748 | 667 | $privacy = $request->get\_param( 'is\_private' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L757) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L676) |  |
  | 757 | 676 | public function task\_sorting( WP\_REST\_Request $request ) { |
  | 758 | 677 |  |
  | 759 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 760 |  | $list\_id    = ~~$request->get\_param( 'list\_id'~~ ); |
  | 761 |  | $task\_id    = ~~$request->get\_param( 'task\_id'~~ ); |
  |  | 678 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 679 | $list\_id    = intval( $request->get\_param( 'list\_id' ) ); |
  |  | 680 | $task\_id    = intval($request->get\_param( 'task\_id' ) ); |
  | 762 | 681 | $orders     = $request->get\_param( 'orders' ); |
  | 763 | 682 | $receive    = $request->get\_param( 'receive' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L820) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L739) |  |
  | 820 | 739 | global $wpdb; |
  | 821 | 740 |  |
  | 822 |  | $status       = ~~$request->get\_param('status'~~); |
  | 823 |  | ~~//$board\_status = $request->get\_param('board\_status'~~); |
  | 824 |  | $~~due\_date     = $request->get\_param('dueDate'~~); |
  | 825 |  | $~~assignees    = $request->get\_param('users'~~); |
  | 826 |  | $~~lists        = $request->get\_param('lists'~~); |
  | 827 |  | $~~project\_id   = $request->get\_param('project\_id'~~); |
  | 828 |  | $title        = $request->get\_param('title'); |
  |  | 741 | $status       = sanitize\_text\_field($request->get\_param('status')); |
  |  | 742 | $due\_date     = sanitize\_text\_field($request->get\_param('dueDate')); |
  |  | 743 | $assignees    = array\_map('intval', (array) $request->get\_param('users')); |
  |  | 744 | $lists        = array\_map('intval', (array) $request->get\_param('lists')); |
  |  | 745 | $project\_id   = intval($request->get\_param('project\_id')); |
  |  | 746 | $title        = sanitize\_text\_field($request->get\_param('title')); |
  |  | 747 |  |
  | 829 | 748 | $tb\_lists     = pm\_tb\_prefix() . 'pm\_boards'; |
  | 830 | 749 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L941) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L860) |  |
  | 941 | 860 | $ct\_per\_page   = empty( $per\_page ) ? 20 : intval( $per\_page ); |
  | 942 | 861 |  |
  | 943 |  | $page         = ~~$request->get\_param('page'~~); |
  | 944 |  | $project\_id   = ~~$request->get\_param('project\_id'~~); |
  |  | 862 | $page         = intval($request->get\_param('page')); |
  |  | 863 | $project\_id   = intval($request->get\_param('project\_id')); |
  | 945 | 864 |  |
  | 946 | 865 | Paginator::currentPageResolver(function () use ($page) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L966) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L885) |  |
  | 966 | 885 |  |
  | 967 | 886 | $filter = [ |
  | 968 |  | 'status' => ~~$request->get\_param('status'~~), |
  | 969 |  | 'due\_date' =>  ~~$request->get\_param('dueDate'~~), |
  | 970 |  | 'users' => ~~$request->get\_param('users'~~), |
  | 971 |  | 'title' => ~~$request->get\_param('title'~~) |
  |  | 887 | 'status' => sanitize\_key( $request->get\_param('status') ), |
  |  | 888 | 'due\_date' =>  sanitize\_text\_field( $request->get\_param('dueDate') ), |
  |  | 889 | 'users' => is\_array( $request->get\_param('users') ) ? array\_map( 'intval', $request->get\_param('users') )  : ( is\_numeric( $request->get\_param('users') ) ? intval( $request->get\_param('users') ) : null ), |
  |  | 890 | 'title' => sanitize\_text\_field( $request->get\_param('title') ) |
  | 972 | 891 | ]; |
  |  | 892 |  |
  | 973 | 893 |  |
  | 974 | 894 | //get total complete and incomplete tasks count |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L1013) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L933) |  |
  | 1013 | 933 | public function activities( WP\_REST\_Request $request ) { |
  | 1014 | 934 |  |
  | 1015 |  | $current\_page = $request->get\_param( 'activityPage' ); |
  | 1016 |  | $task\_id = $request->get\_param( 'task\_id' ); |
  |  | 935 | $current\_page = intval( $request->get\_param( 'activityPage' ) ); |
  |  | 936 | $task\_id = intval( $request->get\_param( 'task\_id' ) ); |
  |  | 937 |  |
  | 1017 | 938 | $per\_page = 10; |
  | 1018 | 939 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L1411) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Controllers/Task_Controller.php?rev=3213295#L1332) |  |
  | 1411 | 1332 |  |
  | 1412 | 1333 | public function load\_more\_tasks( WP\_REST\_Request $request ) { |
  | 1413 |  | $list\_id    = ~~$request->get\_param( 'list\_id'~~ ); |
  | 1414 |  | $task\_ids   = ~~$request->get\_param( 'task\_ids'~~ ); |
  | 1415 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 1416 |  | $status     = ~~$request->get\_param( 'status'~~ ); |
  |  | 1334 | $list\_id    = intval( $request->get\_param( 'list\_id' ) ); |
  |  | 1335 | $task\_ids   = array\_map( 'intval', (array)$request->get\_param( 'task\_ids' )); |
  |  | 1336 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 1337 | $status     = intval( $request->get\_param( 'status' ) ); |
  | 1417 | 1338 |  |
  | 1418 | 1339 | if ( (int) $status ) { |
* ## [wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php")

  | [r2967341](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L145 "Show revision 2967341 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php?rev=3213295#L145 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 145 | 145 | $response = $self->format\_tasks( $self->tasks ); |
  | 146 | 146 |  |
  | 147 |  | ~~//        $response = $array = [~~ |
  | 148 |  | ~~//            "data" => [~~ |
  | 149 |  | ~~//                [~~ |
  | 150 |  | ~~//                    "id" => 30,~~ |
  | 151 |  | ~~//                    "title" => "Project",~~ |
  | 152 |  | ~~//                    "description" => [~~ |
  | 153 |  | ~~//                        "html" => "",~~ |
  | 154 |  | ~~//                        "content" => ""~~ |
  | 155 |  | ~~//                    ],~~ |
  | 156 |  | ~~//                    "estimation" => 0,~~ |
  | 157 |  | ~~//                    "comparable\_estimation" => 0,~~ |
  | 158 |  | ~~//                    "formated\_com\_est" => [~~ |
  | 159 |  | ~~//                        "hour" => "00",~~ |
  | 160 |  | ~~//                        "minute" => "00",~~ |
  | 161 |  | ~~//                        "second" => "00",~~ |
  | 162 |  | ~~//                        "total\_second" => 0~~ |
  | 163 |  | ~~//                    ],~~ |
  | 164 |  | ~~//                    "start\_at" => [~~ |
  | 165 |  | ~~//                        "date" => "",~~ |
  | 166 |  | ~~//                        "time" => "",~~ |
  | 167 |  | ~~//                        "datetime" => "",~~ |
  | 168 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 169 |  | ~~//                        "timestamp" => ""~~ |
  | 170 |  | ~~//                    ],~~ |
  | 171 |  | ~~//                    "due\_date" => [~~ |
  | 172 |  | ~~//                        "date" => "",~~ |
  | 173 |  | ~~//                        "time" => "",~~ |
  | 174 |  | ~~//                        "datetime" => "",~~ |
  | 175 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 176 |  | ~~//                        "timestamp" => ""~~ |
  | 177 |  | ~~//                    ],~~ |
  | 178 |  | ~~//                    "complexity" => "basic",~~ |
  | 179 |  | ~~//                    "priority" => "medium",~~ |
  | 180 |  | ~~//                    "order" => 2,~~ |
  | 181 |  | ~~//                    "payable" => "no",~~ |
  | 182 |  | ~~//                    "recurrent" => 0,~~ |
  | 183 |  | ~~//                    "parent\_id" => 0,~~ |
  | 184 |  | ~~//                    "status" => "incomplete",~~ |
  | 185 |  | ~~//                    "category\_id" => "",~~ |
  | 186 |  | ~~//                    "created\_at" => [~~ |
  | 187 |  | ~~//                        "date" => "2023-08-23",~~ |
  | 188 |  | ~~//                        "time" => "05:27:37",~~ |
  | 189 |  | ~~//                        "datetime" => "2023-08-23 05:27:37",~~ |
  | 190 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 191 |  | ~~//                        "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 192 |  | ~~//                    ],~~ |
  | 193 |  | ~~//                    "created\_by" => 3,~~ |
  | 194 |  | ~~//                    "completed\_at" => [~~ |
  | 195 |  | ~~//                        "date" => "",~~ |
  | 196 |  | ~~//                        "time" => "",~~ |
  | 197 |  | ~~//                        "datetime" => "",~~ |
  | 198 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 199 |  | ~~//                        "timestamp" => ""~~ |
  | 200 |  | ~~//                    ],~~ |
  | 201 |  | ~~//                    "updated\_at" => [~~ |
  | 202 |  | ~~//                        "date" => "2023-08-23",~~ |
  | 203 |  | ~~//                        "time" => "05:27:37",~~ |
  | 204 |  | ~~//                        "datetime" => "2023-08-23 05:27:37",~~ |
  | 205 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 206 |  | ~~//                        "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 207 |  | ~~//                    ],~~ |
  | 208 |  | ~~//                    "creator" => [~~ |
  | 209 |  | ~~//                        "data" => [~~ |
  | 210 |  | ~~//                            "id" => 3,~~ |
  | 211 |  | ~~//                            "username" => "selygyh@email.com",~~ |
  | 212 |  | ~~//                            "nicename" => "selygyhemail-com",~~ |
  | 213 |  | ~~//                            "email" => "vicebeqy@mailinator.com",~~ |
  | 214 |  | ~~//                            "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 215 |  | ~~//                            "display\_name" => "Pandora Best",~~ |
  | 216 |  | ~~//                            "manage\_capability" => 1,~~ |
  | 217 |  | ~~//                            "create\_capability" => 1,~~ |
  | 218 |  | ~~//                            "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 219 |  | ~~//                            "github" => "",~~ |
  | 220 |  | ~~//                            "bitbucket" => ""~~ |
  | 221 |  | ~~//                        ]~~ |
  | 222 |  | ~~//                    ],~~ |
  | 223 |  | ~~//                    "updater" => [~~ |
  | 224 |  | ~~//                        "data" => [~~ |
  | 225 |  | ~~//                            "id" => 3,~~ |
  | 226 |  | ~~//                            "username" => "selygyh@email.com",~~ |
  | 227 |  | ~~//                            "nicename" => "selygyhemail-com",~~ |
  | 228 |  | ~~//                            "email" => "vicebeqy@mailinator.com",~~ |
  | 229 |  | ~~//                            "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 230 |  | ~~//                            "display\_name" => "Pandora Best",~~ |
  | 231 |  | ~~//                            "manage\_capability" => 1,~~ |
  | 232 |  | ~~//                            "create\_capability" => 1,~~ |
  | 233 |  | ~~//                            "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 234 |  | ~~//                            "github" => "",~~ |
  | 235 |  | ~~//                            "bitbucket" => ""~~ |
  | 236 |  | ~~//                        ]~~ |
  | 237 |  | ~~//                    ],~~ |
  | 238 |  | ~~//                    "project" => [~~ |
  | 239 |  | ~~//                        "data" => [~~ |
  | 240 |  | ~~//                            "id" => 6,~~ |
  | 241 |  | ~~//                            "project\_id" => 6,~~ |
  | 242 |  | ~~//                            "title" => "48# - Test Product",~~ |
  | 243 |  | ~~//                            "description" => [~~ |
  | 244 |  | ~~//                                "html" => "",~~ |
  | 245 |  | ~~//                                "content" => ""~~ |
  | 246 |  | ~~//                            ],~~ |
  | 247 |  | ~~//                            "status" => 0,~~ |
  | 248 |  | ~~//                            "budget" => "",~~ |
  | 249 |  | ~~//                            "pay\_rate" => "",~~ |
  | 250 |  | ~~//                            "est\_completion\_date" => "",~~ |
  | 251 |  | ~~//                            "order" => "",~~ |
  | 252 |  | ~~//                            "projectable\_type" => "",~~ |
  | 253 |  | ~~//                            "favourite" => "",~~ |
  | 254 |  | ~~//                            "created\_at" => [~~ |
  | 255 |  | ~~//                                "date" => "2023-08-23",~~ |
  | 256 |  | ~~//                                "time" => "05:26:33",~~ |
  | 257 |  | ~~//                                "datetime" => "2023-08-23 05:26:33",~~ |
  | 258 |  | ~~//                                "timezone" => "Etc/UTC",~~ |
  | 259 |  | ~~//                                "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 260 |  | ~~//                            ],~~ |
  | 261 |  | ~~//                            "updated\_at" => [~~ |
  | 262 |  | ~~//                                "date" => "2023-08-23",~~ |
  | 263 |  | ~~//                                "time" => "05:26:33",~~ |
  | 264 |  | ~~//                                "datetime" => "2023-08-23 05:26:33",~~ |
  | 265 |  | ~~//                                "timezone" => "Etc/UTC",~~ |
  | 266 |  | ~~//                                "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 267 |  | ~~//                            ],~~ |
  | 268 |  | ~~//                            "created\_by" => 3,~~ |
  | 269 |  | ~~//                            "list\_inbox" => 23,~~ |
  | 270 |  | ~~//                            "role\_capabilities" => [~~ |
  | 271 |  | ~~//                                "manager" => [~~ |
  | 272 |  | ~~//                                    "create\_message" => 1,~~ |
  | 273 |  | ~~//                                    "view\_private\_message" => 1,~~ |
  | 274 |  | ~~//                                    "create\_list" => 1,~~ |
  | 275 |  | ~~//                                    "view\_private\_list" => 1,~~ |
  | 276 |  | ~~//                                    "create\_task" => 1,~~ |
  | 277 |  | ~~//                                    "view\_private\_task" => 1,~~ |
  | 278 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 279 |  | ~~//                                    "view\_private\_milestone" => 1,~~ |
  | 280 |  | ~~//                                    "create\_file" => 1,~~ |
  | 281 |  | ~~//                                    "view\_private\_file" => 1~~ |
  | 282 |  | ~~//                                ],~~ |
  | 283 |  | ~~//                                "co\_worker" => [~~ |
  | 284 |  | ~~//                                    "create\_message" => 1,~~ |
  | 285 |  | ~~//                                    "view\_private\_message" => 1,~~ |
  | 286 |  | ~~//                                    "create\_list" => 1,~~ |
  | 287 |  | ~~//                                    "view\_private\_list" => 1,~~ |
  | 288 |  | ~~//                                    "create\_task" => 1,~~ |
  | 289 |  | ~~//                                    "view\_private\_task" => 1,~~ |
  | 290 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 291 |  | ~~//                                    "view\_private\_milestone" => 1,~~ |
  | 292 |  | ~~//                                    "create\_file" => 1,~~ |
  | 293 |  | ~~//                                    "view\_private\_file" => 1~~ |
  | 294 |  | ~~//                                ],~~ |
  | 295 |  | ~~//                                "client" => [~~ |
  | 296 |  | ~~//                                    "create\_message" => 1,~~ |
  | 297 |  | ~~//                                    "view\_private\_message" => "",~~ |
  | 298 |  | ~~//                                    "create\_list" => 1,~~ |
  | 299 |  | ~~//                                    "view\_private\_list" => "",~~ |
  | 300 |  | ~~//                                    "create\_task" => 1,~~ |
  | 301 |  | ~~//                                    "view\_private\_task" => "",~~ |
  | 302 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 303 |  | ~~//                                    "view\_private\_milestone" => "",~~ |
  | 304 |  | ~~//                                    "create\_file" => 1,~~ |
  | 305 |  | ~~//                                    "view\_private\_file" => ""~~ |
  | 306 |  | ~~//                                ]~~ |
  | 307 |  | ~~//                            ],~~ |
  | 308 |  | ~~//                            "meta" => [~~ |
  | 309 |  | ~~//                                "data" => [~~ |
  | 310 |  | ~~//                                    "total\_task\_lists" => 3,~~ |
  | 311 |  | ~~//                                    "total\_tasks" => 5,~~ |
  | 312 |  | ~~//                                    "total\_complete\_tasks" => 0,~~ |
  | 313 |  | ~~//                                    "total\_incomplete\_tasks" => 5,~~ |
  | 314 |  | ~~//                                    "total\_discussion\_boards" => 0,~~ |
  | 315 |  | ~~//                                    "total\_milestones" => 0,~~ |
  | 316 |  | ~~//                                    "total\_comments" => 0,~~ |
  | 317 |  | ~~//                                    "total\_files" => 0,~~ |
  | 318 |  | ~~//                                    "total\_activities" => 9~~ |
  | 319 |  | ~~//                                ]~~ |
  | 320 |  | ~~//                            ]~~ |
  | 321 |  | ~~//                        ]~~ |
  | 322 |  | ~~//                    ],~~ |
  | 323 |  | ~~//                    "task\_list" => [~~ |
  | 324 |  | ~~//                        "data" => [~~ |
  | 325 |  | ~~//                            "id" => 24,~~ |
  | 326 |  | ~~//                            "title" => "Test Project"~~ |
  | 327 |  | ~~//                        ]~~ |
  | 328 |  | ~~//                    ],~~ |
  | 329 |  | ~~//                    "activities" => [~~ |
  | 330 |  | ~~//                        "data" => [~~ |
  | 331 |  | ~~//                            [~~ |
  | 332 |  | ~~//                                "id" => 74,~~ |
  | 333 |  | ~~//                                "message" => "{{actor.data.display\_name}} has created a task, {{meta.task\_title}}.",~~ |
  | 334 |  | ~~//                                "action" => "create\_task",~~ |
  | 335 |  | ~~//                                "action\_type" => "create",~~ |
  | 336 |  | ~~//                                "project\_id" => 6,~~ |
  | 337 |  | ~~//                                "meta" => [~~ |
  | 338 |  | ~~//                                    "task\_title" => "Project"~~ |
  | 339 |  | ~~//                                ],~~ |
  | 340 |  | ~~//                                "committed\_at" => [~~ |
  | 341 |  | ~~//                                    "date" => "2023-08-23",~~ |
  | 342 |  | ~~//                                    "time" => "05:27:37",~~ |
  | 343 |  | ~~//                                    "datetime" => "2023-08-23 05:27:37",~~ |
  | 344 |  | ~~//                                    "timezone" => "Etc/UTC",~~ |
  | 345 |  | ~~//                                    "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 346 |  | ~~//                                ],~~ |
  | 347 |  | ~~//                                "resource\_id" => 30,~~ |
  | 348 |  | ~~//                                "resource\_type" => "task",~~ |
  | 349 |  | ~~//                                "actor" => [~~ |
  | 350 |  | ~~//                                    "data" => [~~ |
  | 351 |  | ~~//                                        "id" => 3,~~ |
  | 352 |  | ~~//                                        "username" => "selygyh@email.com",~~ |
  | 353 |  | ~~//                                        "nicename" => "selygyhemail-com",~~ |
  | 354 |  | ~~//                                        "email" => "vicebeqy@mailinator.com",~~ |
  | 355 |  | ~~//                                        "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 356 |  | ~~//                                        "display\_name" => "Pandora Best",~~ |
  | 357 |  | ~~//                                        "manage\_capability" => 1,~~ |
  | 358 |  | ~~//                                        "create\_capability" => 1,~~ |
  | 359 |  | ~~//                                        "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 360 |  | ~~//                                        "github" => "",~~ |
  | 361 |  | ~~//                                        "bitbucket" => ""~~ |
  | 362 |  | ~~//                                    ]~~ |
  | 363 |  | ~~//                                ],~~ |
  | 364 |  | ~~//                                "project" => [~~ |
  | 365 |  | ~~//                                    "data" => [~~ |
  | 366 |  | ~~//                                        "id" => 6,~~ |
  | 367 |  | ~~//                                        "project\_id" => 6,~~ |
  | 368 |  | ~~//                                        "title" => "48# - Test Product",~~ |
  | 369 |  | ~~//                                        "description" => [~~ |
  | 370 |  | ~~//                                            "html" => "",~~ |
  | 371 |  | ~~//                                            "content" => ""~~ |
  | 372 |  | ~~//                                        ],~~ |
  | 373 |  | ~~//                                        "status" => 0,~~ |
  | 374 |  | ~~//                                        "budget" => "",~~ |
  | 375 |  | ~~//                                        "pay\_rate" => "",~~ |
  | 376 |  | ~~//                                        "est\_completion\_date" => "",~~ |
  | 377 |  | ~~//                                        "order" => "",~~ |
  | 378 |  | ~~//                                        "projectable\_type" => "",~~ |
  | 379 |  | ~~//                                        "favourite" => "",~~ |
  | 380 |  | ~~//                                        "created\_at" => [~~ |
  | 381 |  | ~~//                                            "date" => "2023-08-23",~~ |
  | 382 |  | ~~//                                            "time" => "05:26:33",~~ |
  | 383 |  | ~~//                                            "datetime" => "2023-08-23 05:26:33",~~ |
  | 384 |  | ~~//                                            "timezone" => "Etc/UTC",~~ |
  | 385 |  | ~~//                                            "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 386 |  | ~~//                                        ],~~ |
  | 387 |  | ~~//                                        "updated\_at" => [~~ |
  | 388 |  | ~~//                                            "date" => "2023-08-23",~~ |
  | 389 |  | ~~//                                            "time" => "05:26:33",~~ |
  | 390 |  | ~~//                                            "datetime" => "2023-08-23 05:26:33",~~ |
  | 391 |  | ~~//                                            "timezone" => "Etc/UTC",~~ |
  | 392 |  | ~~//                                            "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 393 |  | ~~//                                        ],~~ |
  | 394 |  | ~~//                                        "created\_by" => 3,~~ |
  | 395 |  | ~~//                                        "list\_inbox" => 23,~~ |
  | 396 |  | ~~//                                        "role\_capabilities" => [~~ |
  | 397 |  | ~~//                                            "manager" => [~~ |
  | 398 |  | ~~//                                                "create\_message" => 1,~~ |
  | 399 |  | ~~//                                                "view\_private\_message" => 1,~~ |
  | 400 |  | ~~//                                                "create\_list" => 1,~~ |
  | 401 |  | ~~//                                                "view\_private\_list" => 1,~~ |
  | 402 |  | ~~//                                                "create\_task" => 1,~~ |
  | 403 |  | ~~//                                                "view\_private\_task" => 1,~~ |
  | 404 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 405 |  | ~~//                                                "view\_private\_milestone" => 1,~~ |
  | 406 |  | ~~//                                                "create\_file" => 1,~~ |
  | 407 |  | ~~//                                                "view\_private\_file" => 1~~ |
  | 408 |  | ~~//                                            ],~~ |
  | 409 |  | ~~//                                            "co\_worker" => [~~ |
  | 410 |  | ~~//                                                "create\_message" => 1,~~ |
  | 411 |  | ~~//                                                "view\_private\_message" => 1,~~ |
  | 412 |  | ~~//                                                "create\_list" => 1,~~ |
  | 413 |  | ~~//                                                "view\_private\_list" => 1,~~ |
  | 414 |  | ~~//                                                "create\_task" => 1,~~ |
  | 415 |  | ~~//                                                "view\_private\_task" => 1,~~ |
  | 416 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 417 |  | ~~//                                                "view\_private\_milestone" => 1,~~ |
  | 418 |  | ~~//                                                "create\_file" => 1,~~ |
  | 419 |  | ~~//                                                "view\_private\_file" => 1~~ |
  | 420 |  | ~~//                                            ],~~ |
  | 421 |  | ~~//                                            "client" => [~~ |
  | 422 |  | ~~//                                                "create\_message" => 1,~~ |
  | 423 |  | ~~//                                                "view\_private\_message" => "",~~ |
  | 424 |  | ~~//                                                "create\_list" => 1,~~ |
  | 425 |  | ~~//                                                "view\_private\_list" => "",~~ |
  | 426 |  | ~~//                                                "create\_task" => 1,~~ |
  | 427 |  | ~~//                                                "view\_private\_task" => "",~~ |
  | 428 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 429 |  | ~~//                                                "view\_private\_milestone" => "",~~ |
  | 430 |  | ~~//                                                "create\_file" => 1,~~ |
  | 431 |  | ~~//                                                "view\_private\_file" => ""~~ |
  | 432 |  | ~~//                                            ]~~ |
  | 433 |  | ~~//                                        ],~~ |
  | 434 |  | ~~//                                        "meta" => [~~ |
  | 435 |  | ~~//                                            "data" => [~~ |
  | 436 |  | ~~//                                                "total\_task\_lists" => 3,~~ |
  | 437 |  | ~~//                                                "total\_tasks" => 5,~~ |
  | 438 |  | ~~//                                                "total\_complete\_tasks" => 0,~~ |
  | 439 |  | ~~//                                                "total\_incomplete\_tasks" => 5,~~ |
  | 440 |  | ~~//                                                "total\_discussion\_boards" => 0,~~ |
  | 441 |  | ~~//                                                "total\_milestones" => 0,~~ |
  | 442 |  | ~~//                                                "total\_comments" => 0,~~ |
  | 443 |  | ~~//                                                "total\_files" => 0,~~ |
  | 444 |  | ~~//                                                "total\_activities" => 9~~ |
  | 445 |  | ~~//                                            ]~~ |
  | 446 |  | ~~//                                        ]~~ |
  | 447 |  | ~~//                                    ]~~ |
  | 448 |  | ~~//                                ]~~ |
  | 449 |  | ~~//                            ]~~ |
  | 450 |  | ~~//                        ]~~ |
  | 451 |  | ~~//                    ],~~ |
  | 452 |  | ~~//                    "comments" => [~~ |
  | 453 |  | ~~//                        "data" => []~~ |
  | 454 |  | ~~//                    ],~~ |
  | 455 |  | ~~//                    "time" => [~~ |
  | 456 |  | ~~//                        "data" => [],~~ |
  | 457 |  | ~~//                        "all\_data" => [],~~ |
  | 458 |  | ~~//                        "users\_data" => [],~~ |
  | 459 |  | ~~//                        "meta" => [~~ |
  | 460 |  | ~~//                            "running" => "",~~ |
  | 461 |  | ~~//                            "totalTaskTime" => [],~~ |
  | 462 |  | ~~//                            "totalTime" => [~~ |
  | 463 |  | ~~//                                "hour" => "00",~~ |
  | 464 |  | ~~//                                "minute" => "00",~~ |
  | 465 |  | ~~//                                "second" => "00",~~ |
  | 466 |  | ~~//                                "total\_second" => 0~~ |
  | 467 |  | ~~//                            ]~~ |
  | 468 |  | ~~//                        ]~~ |
  | 469 |  | ~~//                    ],~~ |
  | 470 |  | ~~//                    "labels" => [~~ |
  | 471 |  | ~~//                        "data" => []~~ |
  | 472 |  | ~~//                    ],~~ |
  | 473 |  | ~~//                    "project\_id" => 6,~~ |
  | 474 |  | ~~//                    "project\_title" => "48# - Test Product",~~ |
  | 475 |  | ~~//                    "type" => "",~~ |
  | 476 |  | ~~//                    "assignees" => [~~ |
  | 477 |  | ~~//                        "data" => []~~ |
  | 478 |  | ~~//                    ],~~ |
  | 479 |  | ~~//                    "task\_list\_id" => 24,~~ |
  | 480 |  | ~~//                    "task\_list\_title" => "Test Project",~~ |
  | 481 |  | ~~//                    "meta" => [~~ |
  | 482 |  | ~~//                        "total\_comment" => 0,~~ |
  | 483 |  | ~~//                        "can\_complete\_task" => 1,~~ |
  | 484 |  | ~~//                        "total\_files" => 0,~~ |
  | 485 |  | ~~//                        "total\_assignee" => 0,~~ |
  | 486 |  | ~~//                        "privacy" => 0~~ |
  | 487 |  | ~~//                    ]~~ |
  | 488 |  | ~~//                ]~~ |
  | 489 |  | ~~//            ],~~ |
  | 490 |  | ~~//            "meta" => [~~ |
  | 491 |  | ~~//                "total\_tasks" => 1,~~ |
  | 492 |  | ~~//                "total\_page" => 1,~~ |
  | 493 |  | ~~//                "per\_page" => 10~~ |
  | 494 |  | ~~//            ]~~ |
  | 495 |  | ~~//        ];~~ |
  | 496 |  |  |
  | 497 |  | ~~//        error\_log( var\_export( $params, 1 ) );~~ |
  | 498 |  | ~~//        error\_log( var\_export( $response, 1 ) );~~ |
  | 499 | 147 | if ( pm\_is\_single\_query( $params ) ) { |
  | 500 | 148 | return ['data' => $response['data'][0]] ; |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L518) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php?rev=3213295#L166) |  |
  | 518 | 166 | ]; |
  | 519 | 167 |  |
  | 520 |  | ~~// if ( ! is\_array( $tasks ) ) {~~ |
  | 521 |  | ~~//  $response['data'] = $this->fromat\_task( $tasks );~~ |
  | 522 |  | ~~//  $response['meta'] = $this->set\_meta();~~ |
  | 523 |  | ~~//  return $response;~~ |
  | 524 |  | ~~// }~~ |
  | 525 | 168 |  |
  | 526 | 169 | foreach ( $tasks as $key => $task ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L579) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php?rev=3213295#L222) |  |
  | 579 | 222 | ]; |
  | 580 | 223 |  |
  | 581 |  | //       $select\_items = empty( $this->query\_params['select'] ) ? false : $this->query\_params['select']; |
  | 582 |  |  |
  | 583 |  | // if ( $select\_items && ! is\_array( $select\_items ) ) { |
  | 584 |  | //  $select\_items = str\_replace( ' ', '', $select\_items ); |
  | 585 |  | //  $select\_items = explode( ',', $select\_items ); |
  | 586 |  | // } |
  | 587 |  |  |
  | 588 |  | // if ( empty( $select\_items ) ) { |
  | 589 |  | //  $items = $this->set\_with\_items( $items, $task ); |
  | 590 |  | //  $items = $this->set\_fixed\_items( $items, $task ); |
  | 591 |  | //  $items = $this->set\_item\_meta( $items, $task ); |
  | 592 |  |  |
  | 593 |  | //  return $items; |
  | 594 |  | // } |
  | 595 |  |  |
  | 596 |  | // foreach ( $items as $item\_key => $item ) { |
  | 597 |  |  |
  | 598 |  | //  if ( ! in\_array( $item\_key, $select\_items ) ) { |
  | 599 |  | //      unset( $items[$item\_key] ); |
  | 600 |  | //  } |
  | 601 |  | // } |
  |  | 224 |  |
  | 602 | 225 |  |
  | 603 | 226 | $items = $this->set\_with\_items( $items, $task ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L637) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task/Helper/Task.php?rev=3213295#L260) |  |
  | 637 | 260 | return true; |
  | 638 | 261 | } |
  | 639 |  | //pmpr($task); die(); |
  | 640 |  | $assignees = $task->assignees['data'];~~//pluck( 'assigned\_to' )->all();~~ |
  |  | 262 |  |
  |  | 263 | $assignees = $task->assignees['data']; |
  | 641 | 264 | $assignees = wp\_list\_pluck( $assignees, 'id' ); |
  | 642 | 265 | $in\_array = in\_array( $user\_id, $assignees ); |
* ## [wedevs-project-manager/tags/2.6.17/src/Task\_List/Controllers/Task\_List\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L46 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L46 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 46 | 46 | $list\_tb                = $wpdb->prefix . 'pm\_boardables'; |
  | 47 | 47 |  |
  | 48 |  | $project\_id             = ~~$request->get\_param( 'project\_id'~~ ); |
  | 49 |  | $per\_page               = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 48 | $project\_id             = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 49 | $per\_page               = intval( $request->get\_param( 'per\_page' ) ); |
  | 50 | 50 | $status                 = $request->get\_param( 'status' ); |
  | 51 | 51 | $list\_id                = $request->get\_param( 'list\_id' ); //must be a array |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L56) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L56) |  |
  | 56 | 56 | $with                   = explode( ',', $with ); |
  | 57 | 57 |  |
  | 58 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 58 | $page = intval( $request->get\_param( 'page' ) ); |
  | 59 | 59 | $page = $page ? $page : 1; |
  | 60 | 60 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L86) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L86) |  |
  | 86 | 86 | $tb\_boardable = pm\_tb\_prefix() . 'pm\_boardables'; |
  | 87 | 87 | $tb\_meta      = pm\_tb\_prefix() . 'pm\_meta'; |
  | 88 |  | $title       = ~~$request->get\_param( 'title'~~ ); |
  |  | 88 | $title       = sanitize\_text\_field( $request->get\_param( 'title' ) ); |
  | 89 | 89 | $is\_archive  = $request->get\_param( 'is\_archive' ); |
  | 90 | 90 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L228) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L228) |  |
  | 228 | 228 |  |
  | 229 | 229 | public function listInbox ( WP\_REST\_Request $request ) { |
  | 230 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 230 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 231 | 231 | $tasks = Task::parent()->doesnthave('boardables')->where('project\_id', $project\_id)->get(); |
  | 232 | 232 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L238) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L238) |  |
  | 238 | 238 |  |
  | 239 | 239 | public function show( WP\_REST\_Request $request ) { |
  | 240 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 241 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 240 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 241 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 242 | 242 | $with         = $request->get\_param( 'with' ); |
  | 243 | 243 |  |
  | 244 | 244 | return $this->get\_list( [ |
  | 245 |  | 'project\_id'   => $~~request->get\_param( 'project\_id' )~~, |
  | 246 |  | 'task\_list\_id' => $~~request->get\_param( 'task\_list\_id' )~~, |
  |  | 245 | 'project\_id'   => $project\_id, |
  |  | 246 | 'task\_list\_id' => $task\_list\_id, |
  | 247 | 247 | 'with'         => $request->get\_param( 'with' ) |
  | 248 | 248 | ] ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L291) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L291) |  |
  | 291 | 291 | return $list; |
  | 292 | 292 | } |
  | 293 |  |  |
  | 294 |  | ~~//updated query but not filter updated~~ |
  | 295 |  | ~~// public function get\_list( $params ) {~~ |
  | 296 |  |  |
  | 297 |  | ~~//     $project\_id   = $params['project\_id'];~~ |
  | 298 |  | ~~//     $task\_list\_id = $params['task\_list\_id'];~~ |
  | 299 |  | ~~//     $with         = empty( $params['with'] ) ? [] : $params['with'];~~ |
  | 300 |  | ~~//     $with         = pm\_get\_prepare\_data( $with );~~ |
  | 301 |  |  |
  | 302 |  | ~~//     $list = pm\_get\_task\_lists([~~ |
  | 303 |  | ~~//         'id'         => $task\_list\_id,~~ |
  | 304 |  | ~~//         'project\_id' => $project\_id,~~ |
  | 305 |  | ~~//         'with'       => $with~~ |
  | 306 |  | ~~//     ]);~~ |
  | 307 |  |  |
  | 308 |  | ~~//     $list\_id = [$task\_list\_id];~~ |
  | 309 |  |  |
  | 310 |  | ~~//     if ( in\_array( 'incomplete\_tasks', $with ) ) {~~ |
  | 311 |  | ~~//         $incomplete\_task\_ids = ( new Task\_Controller )->get\_incomplete\_task\_ids( $list\_id, $project\_id );~~ |
  | 312 |  | ~~//         $incomplete\_tasks    = pm\_get\_tasks( [ 'id' => $incomplete\_task\_ids ] );~~ |
  | 313 |  |  |
  | 314 |  | ~~//         $list['data']['incomplete\_tasks']['data'] = $incomplete\_tasks['data'];~~ |
  | 315 |  | ~~//         $list['data']['incomplete\_tasks']['meta'] = $incomplete\_tasks['meta'];~~ |
  | 316 |  | ~~//     }~~ |
  | 317 |  |  |
  | 318 |  | ~~//     if ( in\_array( 'complete\_tasks', $with ) ) {~~ |
  | 319 |  | ~~//         $complete\_task\_ids = ( new Task\_Controller )->get\_complete\_task\_ids( $list\_id, $project\_id );~~ |
  | 320 |  | ~~//         $complete\_tasks    = pm\_get\_tasks( [ 'id' => $complete\_task\_ids ] );~~ |
  | 321 |  |  |
  | 322 |  | ~~//         $list['data']['complete\_tasks']['data'] = $complete\_tasks['data'];~~ |
  | 323 |  | ~~//         $list['data']['complete\_tasks']['meta'] = $complete\_tasks['meta'];~~ |
  | 324 |  | ~~//     }~~ |
  | 325 |  |  |
  | 326 |  | ~~//     return $list;~~ |
  | 327 |  | ~~// }~~ |
  | 328 | 293 |  |
  | 329 | 294 | public static function create\_tasklist( $data ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L357) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L322) |  |
  | 357 | 322 | public function store( WP\_REST\_Request $request ) { |
  | 358 | 323 | $data               = $this->extract\_non\_empty\_values( $request ); |
  | 359 |  | $milestone\_id       = ~~$request->get\_param( 'milestone'~~ ); |
  | 360 |  | $project\_id         = ~~$request->get\_param( 'project\_id'~~ ); |
  | 361 |  | $is\_private         = ~~$request->get\_param( 'privacy'~~ ); |
  |  | 324 | $milestone\_id       = sanitize\_text\_field( $request->get\_param( 'milestone' ) ); |
  |  | 325 | $project\_id         = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 326 | $is\_private         = sanitize\_text\_field($request->get\_param( 'privacy' ) ); |
  | 362 | 327 | $data['is\_private'] = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 363 | 328 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L386) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L351) |  |
  | 386 | 351 | $data = $this->extract\_non\_empty\_values( $request ); |
  | 387 | 352 |  |
  | 388 |  | $project\_id          = ~~$request->get\_param( 'project\_id'~~ ); |
  | 389 |  | $task\_list\_id        = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 353 | $project\_id          = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 354 | $task\_list\_id        = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 390 | 355 | $milestone\_id        = $request->get\_param( 'milestone' ); |
  | 391 | 356 | $data['description'] = $request->get\_param('description'); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L447) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L412) |  |
  | 447 | 412 | public function destroy( WP\_REST\_Request $request ) { |
  | 448 | 413 | // Grab user inputs |
  | 449 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 450 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 414 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 415 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 451 | 416 |  |
  | 452 | 417 | // Select the task list to be deleted |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L516) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L481) |  |
  | 516 | 481 |  |
  | 517 | 482 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 518 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 519 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 483 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 484 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 520 | 485 |  |
  | 521 | 486 | $task\_list = Task\_List::where( 'id', $task\_list\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L543) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L508) |  |
  | 543 | 508 |  |
  | 544 | 509 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 545 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 546 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 510 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 511 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 547 | 512 |  |
  | 548 | 513 | $task\_list = Task\_List::where( 'id', $task\_list\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L550) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L515) |  |
  | 550 | 515 | ->first(); |
  | 551 | 516 |  |
  | 552 |  | $user\_ids = ~~explode( ',', $request->get\_param( 'users'~~ ) ); |
  |  | 517 | $user\_ids = array\_map( 'intval', explode( ',', $request->get\_param( 'users' ) ) ); |
  | 553 | 518 |  |
  | 554 | 519 | $task\_list->users()->whereIn( 'boardable\_id', $user\_ids )->delete(); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L560) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L525) |  |
  | 560 | 525 |  |
  | 561 | 526 | public function privacy( WP\_REST\_Request $request ) { |
  | 562 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 563 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 527 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 528 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 564 | 529 | $privacy = $request->get\_param( 'is\_private' ); |
  | 565 | 530 | pm\_update\_meta( $task\_list\_id, $project\_id, 'task\_list', 'privacy', $privacy ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L591) | […](/browser/wedevs-project-manager/tags/2.6.17/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L556) |  |
  | 591 | 556 | public function list\_search( WP\_REST\_Request $request ) { |
  | 592 | 557 |  |
  | 593 |  | $project\_id  = ~~$request->get\_param( 'project\_id'~~ ); |
  | 594 |  | $title       = ~~$request->get\_param( 'title' );~~ |
  |  | 558 | $project\_id  = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 559 | $title       = sanitize\_text\_field( $request->get\_param( 'title' ) ); |
  | 595 | 560 | $is\_archive  = $request->get\_param( 'is\_archive' ); |
  | 596 | 561 |  |
* ## [wedevs-project-manager/tags/2.6.17/src/User/Controllers/User\_Controller.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php")

  | [r3033466](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L22 "Show revision 3033466 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php?rev=3213295#L22 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 |  |
  | 23 | 23 | public function index( WP\_REST\_Request $request ) { |
  | 24 |  | $id    = ~~$request->get\_param( 'id'~~ ); |
  | 25 |  |  |
  | 26 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 24 | $id    = intval( $request->get\_param( 'id' ) ); |
  |  | 25 |  |
  |  | 26 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 27 | 27 | $per\_page   = $per\_page ? $per\_page : 15; |
  | 28 | 28 |  |
  | 29 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 29 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 30 | 30 | $page       = $page ? $page : 1; |
  | 31 | 31 |  |
  | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L49) | […](/browser/wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php?rev=3213295#L49) |  |
  | 49 | 49 |  |
  | 50 | 50 | public function show( WP\_REST\_Request $request ) { |
  | 51 |  | $id       = ~~$request->get\_param( 'id'~~ ); |
  |  | 51 | $id       = intval( $request->get\_param( 'id' ) ); |
  | 52 | 52 | $user     = User::find( $id ); |
  | 53 | 53 | $resource = new Item( $user, new User\_Transformer ); |
  | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L135) | […](/browser/wedevs-project-manager/tags/2.6.17/src/User/Controllers/User_Controller.php?rev=3213295#L135) |  |
  | 135 | 135 | // Extract user inputs |
  | 136 | 136 | $id         = $request->get\_param( 'user\_id' ); |
  | 137 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 137 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 138 | 138 | $role\_ids   = $request->get\_param( 'role\_ids' ); |
  | 139 | 139 | $role\_ids   = explode( ',', $role\_ids ); |
* ## [wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3206717#L1 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3213295#L1 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | \* @deliciousbrains/deli-eng |
  | 2 | 2 |  |
  | 3 |  | #jira:~~[18802]~~ is where issues related to this repository should be ticketed] |
  |  | 3 | #jira:DELI is where issues related to this repository should be ticketed] |
* ## [wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3206717#L16 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3213295#L16 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 16 | 16 | clean: |
  | 17 | 17 | rm -rf vendor |
  | 18 |  | rm -f tests/.phpunit.result.cache |
  |  | 18 | rm -f tests/.phpunit.result.cache .phpunit.result.cache |
* ## [wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php")

  | [r3061130](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3061130#L102 "Show revision 3061130 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295#L102 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 102 | 102 |  |
  | 103 | 103 | /\*\* |
  | 104 |  | \* Filters the ~~post~~ arguments used during an async request. |
  | 105 |  | \* |
  | 106 |  | \* @param array $~~url~~ |
  |  | 104 | \* Filters the query arguments used during an async request. |
  |  | 105 | \* |
  |  | 106 | \* @param array $args |
  | 107 | 107 | \*/ |
  | 108 | 108 | return apply\_filters( $this->identifier . '\_query\_args', $args ); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3061130#L122) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295#L122) |  |
  | 122 | 122 |  |
  | 123 | 123 | /\*\* |
  | 124 |  | \* Filters the ~~post arguments~~ used during an async request. |
  |  | 124 | \* Filters the query URL used during an async request. |
  | 125 | 125 | \* |
  | 126 | 126 | \* @param string $url |
* ## [wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php")

  | [r3061130](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L13 "Show revision 3061130 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L13 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | \*/ |
  | 14 | 14 | abstract class WP\_Background\_Process extends WP\_Async\_Request { |
  |  | 15 | /\*\* |
  |  | 16 | \* The default query arg name used for passing the chain ID to new processes. |
  |  | 17 | \*/ |
  |  | 18 | const CHAIN\_ID\_ARG\_NAME = 'chain\_id'; |
  |  | 19 |  |
  |  | 20 | /\*\* |
  |  | 21 | \* Unique background process chain ID. |
  |  | 22 | \* |
  |  | 23 | \* @var string |
  |  | 24 | \*/ |
  |  | 25 | private $chain\_id; |
  | 15 | 26 |  |
  | 16 | 27 | /\*\* |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L98) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L109) |  |
  | 98 | 109 | add\_action( $this->cron\_hook\_identifier, array( $this, 'handle\_cron\_healthcheck' ) ); |
  | 99 | 110 | add\_filter( 'cron\_schedules', array( $this, 'schedule\_cron\_healthcheck' ) ); |
  |  | 111 |  |
  |  | 112 | // Ensure dispatch query args included extra data. |
  |  | 113 | add\_filter( $this->identifier . '\_query\_args', array( $this, 'filter\_dispatch\_query\_args' ) ); |
  | 100 | 114 | } |
  | 101 | 115 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L112) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L126) |  |
  | 112 | 126 | } |
  | 113 | 127 |  |
  |  | 128 | /\*\* |
  |  | 129 | \* Filter fired before background process dispatches its next process. |
  |  | 130 | \* |
  |  | 131 | \* @param bool   $cancel   Should the dispatch be cancelled? Default false. |
  |  | 132 | \* @param string $chain\_id The background process chain ID. |
  |  | 133 | \*/ |
  |  | 134 | $cancel = apply\_filters( $this->identifier . '\_pre\_dispatch', false, $this->get\_chain\_id() ); |
  |  | 135 |  |
  |  | 136 | if ( $cancel ) { |
  |  | 137 | return false; |
  |  | 138 | } |
  |  | 139 |  |
  | 114 | 140 | // Schedule the cron healthcheck. |
  | 115 | 141 | $this->schedule\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L212) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L238) |  |
  | 212 | 238 | \*/ |
  | 213 | 239 | public function is\_cancelled() { |
  | 214 |  | $status = get\_site\_option( $this->get\_status\_key(), 0 ); |
  | 215 |  |  |
  | 216 |  | return absint( $status ) === self::STATUS\_CANCELLED; |
  |  | 240 | return $this->get\_status() === self::STATUS\_CANCELLED; |
  | 217 | 241 | } |
  | 218 | 242 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L221) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L245) |  |
  | 221 | 245 | \*/ |
  | 222 | 246 | protected function cancelled() { |
  | 223 |  | do\_action( $this->identifier . '\_cancelled' ); |
  |  | 247 | do\_action( $this->identifier . '\_cancelled', $this->get\_chain\_id() ); |
  | 224 | 248 | } |
  | 225 | 249 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L232) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L256) |  |
  | 232 | 256 |  |
  | 233 | 257 | /\*\* |
  | 234 |  | \* ~~Is the job~~ paused? |
  |  | 258 | \* Has the process been paused? |
  | 235 | 259 | \* |
  | 236 | 260 | \* @return bool |
  | 237 | 261 | \*/ |
  | 238 | 262 | public function is\_paused() { |
  | 239 |  | $status = get\_site\_option( $this->get\_status\_key(), 0 ); |
  | 240 |  |  |
  | 241 |  | return absint( $status ) === self::STATUS\_PAUSED; |
  |  | 263 | return $this->get\_status() === self::STATUS\_PAUSED; |
  | 242 | 264 | } |
  | 243 | 265 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L246) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L268) |  |
  | 246 | 268 | \*/ |
  | 247 | 269 | protected function paused() { |
  | 248 |  | do\_action( $this->identifier . '\_paused' ); |
  |  | 270 | do\_action( $this->identifier . '\_paused', $this->get\_chain\_id() ); |
  | 249 | 271 | } |
  | 250 | 272 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L264) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L286) |  |
  | 264 | 286 | \*/ |
  | 265 | 287 | protected function resumed() { |
  | 266 |  | do\_action( $this->identifier . '\_resumed' ); |
  |  | 288 | do\_action( $this->identifier . '\_resumed', $this->get\_chain\_id() ); |
  | 267 | 289 | } |
  | 268 | 290 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L313) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L335) |  |
  | 313 | 335 |  |
  | 314 | 336 | /\*\* |
  |  | 337 | \* Get the status value for the process. |
  |  | 338 | \* |
  |  | 339 | \* @return int |
  |  | 340 | \*/ |
  |  | 341 | protected function get\_status() { |
  |  | 342 | global $wpdb; |
  |  | 343 |  |
  |  | 344 | if ( is\_multisite() ) { |
  |  | 345 | $status = $wpdb->get\_var( |
  |  | 346 | $wpdb->prepare( |
  |  | 347 | "SELECT meta\_value FROM $wpdb->sitemeta WHERE meta\_key = %s AND site\_id = %d LIMIT 1", |
  |  | 348 | $this->get\_status\_key(), |
  |  | 349 | get\_current\_network\_id() |
  |  | 350 | ) |
  |  | 351 | ); |
  |  | 352 | } else { |
  |  | 353 | $status = $wpdb->get\_var( |
  |  | 354 | $wpdb->prepare( |
  |  | 355 | "SELECT option\_value FROM $wpdb->options WHERE option\_name = %s LIMIT 1", |
  |  | 356 | $this->get\_status\_key() |
  |  | 357 | ) |
  |  | 358 | ); |
  |  | 359 | } |
  |  | 360 |  |
  |  | 361 | return absint( $status ); |
  |  | 362 | } |
  |  | 363 |  |
  |  | 364 | /\*\* |
  | 315 | 365 | \* Maybe process a batch of queued items. |
  | 316 | 366 | \* |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L322) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L372) |  |
  | 322 | 372 | session\_write\_close(); |
  | 323 | 373 |  |
  |  | 374 | check\_ajax\_referer( $this->identifier, 'nonce' ); |
  |  | 375 |  |
  |  | 376 | // Background process already running. |
  | 324 | 377 | if ( $this->is\_processing() ) { |
  | 325 |  | ~~// Background process already running.~~ |
  | 326 | 378 | return $this->maybe\_wp\_die(); |
  | 327 | 379 | } |
  | 328 | 380 |  |
  |  | 381 | // Cancel requested. |
  | 329 | 382 | if ( $this->is\_cancelled() ) { |
  | 330 | 383 | $this->clear\_scheduled\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L334) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L387) |  |
  | 334 | 387 | } |
  | 335 | 388 |  |
  |  | 389 | // Pause requested. |
  | 336 | 390 | if ( $this->is\_paused() ) { |
  | 337 | 391 | $this->clear\_scheduled\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L341) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L395) |  |
  | 341 | 395 | } |
  | 342 | 396 |  |
  |  | 397 | // No data to process. |
  | 343 | 398 | if ( $this->is\_queue\_empty() ) { |
  | 344 |  | ~~// No data to process.~~ |
  | 345 | 399 | return $this->maybe\_wp\_die(); |
  | 346 | 400 | } |
  | 347 |  |  |
  | 348 |  | ~~check\_ajax\_referer( $this->identifier, 'nonce' );~~ |
  | 349 | 401 |  |
  | 350 | 402 | $this->handle(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L397) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L449) |  |
  | 397 | 449 | \* Override if applicable, but the duration should be greater than that |
  | 398 | 450 | \* defined in the time\_exceeded() method. |
  | 399 |  | \*/ |
  | 400 |  | protected function lock\_process() { |
  | 401 |  | $this->start\_time = time(); // Set start time of current process. |
  |  | 451 | \* |
  |  | 452 | \* @param bool $reset\_start\_time Optional, default true. |
  |  | 453 | \*/ |
  |  | 454 | public function lock\_process( $reset\_start\_time = true ) { |
  |  | 455 | if ( $reset\_start\_time ) { |
  |  | 456 | $this->start\_time = time(); // Set start time of current process. |
  |  | 457 | } |
  | 402 | 458 |  |
  | 403 | 459 | $lock\_duration = ( property\_exists( $this, 'queue\_lock\_time' ) ) ? $this->queue\_lock\_time : 60; // 1 minute |
  | 404 | 460 | $lock\_duration = apply\_filters( $this->identifier . '\_queue\_lock\_time', $lock\_duration ); |
  | 405 | 461 |  |
  | 406 |  | set\_site\_transient( $this->identifier . '\_process\_lock', microtime(), $lock\_duration ); |
  |  | 462 | $microtime = microtime(); |
  |  | 463 | $locked    = set\_site\_transient( $this->identifier . '\_process\_lock', $microtime, $lock\_duration ); |
  |  | 464 |  |
  |  | 465 | /\*\* |
  |  | 466 | \* Action to note whether the background process managed to create its lock. |
  |  | 467 | \* |
  |  | 468 | \* The lock is used to signify that a process is running a task and no other |
  |  | 469 | \* process should be allowed to run the same task until the lock is released. |
  |  | 470 | \* |
  |  | 471 | \* @param bool   $locked        Whether the lock was successfully created. |
  |  | 472 | \* @param string $microtime     Microtime string value used for the lock. |
  |  | 473 | \* @param int    $lock\_duration Max number of seconds that the lock will live for. |
  |  | 474 | \* @param string $chain\_id      Current background process chain ID. |
  |  | 475 | \*/ |
  |  | 476 | do\_action( |
  |  | 477 | $this->identifier . '\_process\_locked', |
  |  | 478 | $locked, |
  |  | 479 | $microtime, |
  |  | 480 | $lock\_duration, |
  |  | 481 | $this->get\_chain\_id() |
  |  | 482 | ); |
  | 407 | 483 | } |
  | 408 | 484 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L415) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L491) |  |
  | 415 | 491 | \*/ |
  | 416 | 492 | protected function unlock\_process() { |
  | 417 |  | delete\_site\_transient( $this->identifier . '\_process\_lock' ); |
  |  | 493 | $unlocked = delete\_site\_transient( $this->identifier . '\_process\_lock' ); |
  |  | 494 |  |
  |  | 495 | /\*\* |
  |  | 496 | \* Action to note whether the background process managed to release its lock. |
  |  | 497 | \* |
  |  | 498 | \* The lock is used to signify that a process is running a task and no other |
  |  | 499 | \* process should be allowed to run the same task until the lock is released. |
  |  | 500 | \* |
  |  | 501 | \* @param bool   $unlocked Whether the lock was released. |
  |  | 502 | \* @param string $chain\_id Current background process chain ID. |
  |  | 503 | \*/ |
  |  | 504 | do\_action( $this->identifier . '\_process\_unlocked', $unlocked, $this->get\_chain\_id() ); |
  | 418 | 505 |  |
  | 419 | 506 | return $this; |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L478) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L565) |  |
  | 478 | 565 | } |
  | 479 | 566 |  |
  | 480 |  | $items = $wpdb->get\_results( $wpdb->prepare( $sql, $args ) ); // phpcs:ignore WordPress.DB.PreparedSQL.NotPrepared |
  |  | 567 | $items = $wpdb->get\_results( |
  |  | 568 | $wpdb->prepare( |
  |  | 569 | $sql, // phpcs:ignore WordPress.DB.PreparedSQL.NotPrepared |
  |  | 570 | $args |
  |  | 571 | ) |
  |  | 572 | ); |
  | 481 | 573 |  |
  | 482 | 574 | $batches = array(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L545) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L637) |  |
  | 545 | 637 | sleep( $throttle\_seconds ); |
  | 546 | 638 |  |
  | 547 |  | // Batch limits reached, or pause or cancel request. |
  | 548 |  | if ( ~~$this->time\_exceeded() || $this->memory\_exceeded() || $this->is\_paused() || $this->is\_cancelled~~() ) { |
  |  | 639 | // Batch limits reached, or pause or cancel requested. |
  |  | 640 | if ( ! $this->should\_continue() ) { |
  | 549 | 641 | break; |
  | 550 | 642 | } |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L555) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L647) |  |
  | 555 | 647 | $this->delete( $batch->key ); |
  | 556 | 648 | } |
  | 557 |  | } while ( ! $this->~~time\_exceeded() && ! $this->memory\_exceeded() && ! $this->is\_queue\_empty() && ! $this->is\_paused() && ! $this->is\_cancelled~~() ); |
  |  | 649 | } while ( ! $this->is\_queue\_empty() && $this->should\_continue() ); |
  | 558 | 650 |  |
  | 559 | 651 | $this->unlock\_process(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L648) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L740) |  |
  | 648 | 740 | \*/ |
  | 649 | 741 | protected function completed() { |
  | 650 |  | do\_action( $this->identifier . '\_completed' ); |
  |  | 742 | do\_action( $this->identifier . '\_completed', $this->get\_chain\_id() ); |
  | 651 | 743 | } |
  | 652 | 744 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L723) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L815) |  |
  | 723 | 815 | protected function schedule\_event() { |
  | 724 | 816 | if ( ! wp\_next\_scheduled( $this->cron\_hook\_identifier ) ) { |
  | 725 |  | wp\_schedule\_event( time() + ( $this->get\_cron\_interval() \* MINUTE\_IN\_SECONDS ), $this->cron\_interval\_identifier, $this->cron\_hook\_identifier ); |
  |  | 817 | wp\_schedule\_event( |
  |  | 818 | time() + ( $this->get\_cron\_interval() \* MINUTE\_IN\_SECONDS ), |
  |  | 819 | $this->cron\_interval\_identifier, |
  |  | 820 | $this->cron\_hook\_identifier |
  |  | 821 | ); |
  | 726 | 822 | } |
  | 727 | 823 | } |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L784) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L880) |  |
  | 784 | 880 | return $data; |
  | 785 | 881 | } |
  |  | 882 |  |
  |  | 883 | /\*\* |
  |  | 884 | \* Should any processing continue? |
  |  | 885 | \* |
  |  | 886 | \* @return bool |
  |  | 887 | \*/ |
  |  | 888 | public function should\_continue() { |
  |  | 889 | /\*\* |
  |  | 890 | \* Filter whether the current background process should continue running the task |
  |  | 891 | \* if there is data to be processed. |
  |  | 892 | \* |
  |  | 893 | \* If the processing time or memory limits have been exceeded, the value will be false. |
  |  | 894 | \* If pause or cancel have been requested, the value will be false. |
  |  | 895 | \* |
  |  | 896 | \* It is very unlikely that you would want to override a false value with true. |
  |  | 897 | \* |
  |  | 898 | \* If false is returned here, it does not necessarily mean background processing is |
  |  | 899 | \* complete. If there is batch data still to be processed and pause or cancel have not |
  |  | 900 | \* been requested, it simply means this background process should spawn a new process |
  |  | 901 | \* for the chain to continue processing and then close itself down. |
  |  | 902 | \* |
  |  | 903 | \* @param bool   $continue Should the current process continue processing the task? |
  |  | 904 | \* @param string $chain\_id The current background process chain's ID. |
  |  | 905 | \* |
  |  | 906 | \* @return bool |
  |  | 907 | \*/ |
  |  | 908 | return apply\_filters( |
  |  | 909 | $this->identifier . '\_should\_continue', |
  |  | 910 | ! ( $this->time\_exceeded() || $this->memory\_exceeded() || $this->is\_paused() || $this->is\_cancelled() ), |
  |  | 911 | $this->get\_chain\_id() |
  |  | 912 | ); |
  |  | 913 | } |
  |  | 914 |  |
  |  | 915 | /\*\* |
  |  | 916 | \* Get the string used to identify this type of background process. |
  |  | 917 | \* |
  |  | 918 | \* @return string |
  |  | 919 | \*/ |
  |  | 920 | public function get\_identifier() { |
  |  | 921 | return $this->identifier; |
  |  | 922 | } |
  |  | 923 |  |
  |  | 924 | /\*\* |
  |  | 925 | \* Return the current background process chain's ID. |
  |  | 926 | \* |
  |  | 927 | \* If the chain's ID hasn't been set before this function is first used, |
  |  | 928 | \* and hasn't been passed as a query arg during dispatch, |
  |  | 929 | \* the chain ID will be generated before being returned. |
  |  | 930 | \* |
  |  | 931 | \* @return string |
  |  | 932 | \*/ |
  |  | 933 | public function get\_chain\_id() { |
  |  | 934 | if ( empty( $this->chain\_id ) && wp\_doing\_ajax() ) { |
  |  | 935 | check\_ajax\_referer( $this->identifier, 'nonce' ); |
  |  | 936 |  |
  |  | 937 | if ( ! empty( $\_GET[ $this->get\_chain\_id\_arg\_name() ] ) ) { |
  |  | 938 | $chain\_id = sanitize\_key( $\_GET[ $this->get\_chain\_id\_arg\_name() ] ); |
  |  | 939 |  |
  |  | 940 | if ( wp\_is\_uuid( $chain\_id ) ) { |
  |  | 941 | $this->chain\_id = $chain\_id; |
  |  | 942 |  |
  |  | 943 | return $this->chain\_id; |
  |  | 944 | } |
  |  | 945 | } |
  |  | 946 | } |
  |  | 947 |  |
  |  | 948 | if ( empty( $this->chain\_id ) ) { |
  |  | 949 | $this->chain\_id = wp\_generate\_uuid4(); |
  |  | 950 | } |
  |  | 951 |  |
  |  | 952 | return $this->chain\_id; |
  |  | 953 | } |
  |  | 954 |  |
  |  | 955 | /\*\* |
  |  | 956 | \* Filters the query arguments used during an async request. |
  |  | 957 | \* |
  |  | 958 | \* @param array $args Current query args. |
  |  | 959 | \* |
  |  | 960 | \* @return array |
  |  | 961 | \*/ |
  |  | 962 | public function filter\_dispatch\_query\_args( $args ) { |
  |  | 963 | $args[ $this->get\_chain\_id\_arg\_name() ] = $this->get\_chain\_id(); |
  |  | 964 |  |
  |  | 965 | return $args; |
  |  | 966 | } |
  |  | 967 |  |
  |  | 968 | /\*\* |
  |  | 969 | \* Get the query arg name used for passing the chain ID to new processes. |
  |  | 970 | \* |
  |  | 971 | \* @return string |
  |  | 972 | \*/ |
  |  | 973 | private function get\_chain\_id\_arg\_name() { |
  |  | 974 | static $chain\_id\_arg\_name; |
  |  | 975 |  |
  |  | 976 | if ( ! empty( $chain\_id\_arg\_name ) ) { |
  |  | 977 | return $chain\_id\_arg\_name; |
  |  | 978 | } |
  |  | 979 |  |
  |  | 980 | /\*\* |
  |  | 981 | \* Filter the query arg name used for passing the chain ID to new processes. |
  |  | 982 | \* |
  |  | 983 | \* If you encounter problems with using the default query arg name, you can |
  |  | 984 | \* change it with this filter. |
  |  | 985 | \* |
  |  | 986 | \* @param string $chain\_id\_arg\_name Default "chain\_id". |
  |  | 987 | \* |
  |  | 988 | \* @return string |
  |  | 989 | \*/ |
  |  | 990 | $chain\_id\_arg\_name = apply\_filters( $this->identifier . '\_chain\_id\_arg\_name', self::CHAIN\_ID\_ARG\_NAME ); |
  |  | 991 |  |
  |  | 992 | if ( ! is\_string( $chain\_id\_arg\_name ) || empty( $chain\_id\_arg\_name ) ) { |
  |  | 993 | $chain\_id\_arg\_name = self::CHAIN\_ID\_ARG\_NAME; |
  |  | 994 | } |
  |  | 995 |  |
  |  | 996 | return $chain\_id\_arg\_name; |
  |  | 997 | } |
  | 786 | 998 | } |
* ## [wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L3 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295#L3 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | { |
  | 4 | 4 | "name": "a5hleyrich/wp-background-processing", |
  | 5 |  | "version": "1.~~3.1~~", |
  | 6 |  | "version\_normalized": "1.~~3.1~~.0", |
  |  | 5 | "version": "1.4.0", |
  |  | 6 | "version\_normalized": "1.4.0.0", |
  | 7 | 7 | "source": { |
  | 8 | 8 | "type": "git", |
  | 9 | 9 | "url": "https://github.com/deliciousbrains/wp-background-processing.git", |
  | 10 |  | "reference": "~~6d1e48165e461260075b9f161b3861c7278f71e7~~" |
  | 11 |  | }, |
  | 12 |  | "dist": { |
  | 13 |  | "type": "zip", |
  | 14 |  | "url": "https://api.github.com/repos/deliciousbrains/wp-background-processing/zipball/~~6d1e48165e461260075b9f161b3861c7278f71e7~~", |
  | 15 |  | "reference": "~~6d1e48165e461260075b9f161b3861c7278f71e7~~", |
  |  | 10 | "reference": "7ca7cc3504333db3a291bbab7f1917124fba4816" |
  |  | 11 | }, |
  |  | 12 | "dist": { |
  |  | 13 | "type": "zip", |
  |  | 14 | "url": "https://api.github.com/repos/deliciousbrains/wp-background-processing/zipball/7ca7cc3504333db3a291bbab7f1917124fba4816", |
  |  | 15 | "reference": "7ca7cc3504333db3a291bbab7f1917124fba4816", |
  | 16 | 16 | "shasum": "" |
  | 17 | 17 | }, |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L29) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295#L29) |  |
  | 29 | 29 | "coenjacobs/mozart": "Easily wrap this library with your own prefix, to prevent collisions when multiple plugins use this library" |
  | 30 | 30 | }, |
  | 31 |  | "time": "2024-~~02-28T13:39:06~~+00:00", |
  |  | 31 | "time": "2024-12-17T14:04:30+00:00", |
  | 32 | 32 | "type": "library", |
  | 33 | 33 | "installation-source": "dist", |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L50) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295#L50) |  |
  | 50 | 50 | "support": { |
  | 51 | 51 | "issues": "https://github.com/deliciousbrains/wp-background-processing/issues", |
  | 52 |  | "source": "https://github.com/deliciousbrains/wp-background-processing/tree/1.~~3.1~~" |
  |  | 52 | "source": "https://github.com/deliciousbrains/wp-background-processing/tree/1.4.0" |
  | 53 | 53 | }, |
  | 54 | 54 | "install-path": "../a5hleyrich/wp-background-processing" |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L810) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295#L810) |  |
  | 810 | 810 | "type": "library", |
  | 811 | 811 | "extra": { |
  | 812 |  | ~~"branch-alias": {~~ |
  | 813 |  | ~~"dev-master": "3.x-dev",~~ |
  | 814 |  | ~~"dev-2.x": "2.x-dev"~~ |
  | 815 |  | ~~},~~ |
  | 816 | 812 | "laravel": { |
  | 817 | 813 | "providers": [ |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L823) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.json?rev=3213295#L819) |  |
  | 823 | 819 | "extension.neon" |
  | 824 | 820 | ] |
  |  | 821 | }, |
  |  | 822 | "branch-alias": { |
  |  | 823 | "dev-2.x": "2.x-dev", |
  |  | 824 | "dev-master": "3.x-dev" |
  | 825 | 825 | } |
  | 826 | 826 | }, |
* ## [wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php](/changeset/3213295/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php "Show the changeset 3213295 restricted to wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L2 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php?rev=3213295#L2 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'wedevsofficial/wp-project-manager', |
  | 4 |  | 'pretty\_version' => 'v2.6.1~~6~~', |
  | 5 |  | 'version' => '2.6.1~~6~~.0', |
  | 6 |  | 'reference' => '~~aa10bf0db85fa168f8dd53272db03b0e826f519e~~', |
  |  | 4 | 'pretty\_version' => 'v2.6.17', |
  |  | 5 | 'version' => '2.6.17.0', |
  |  | 6 | 'reference' => '797195be849fb8196d032c4d5009c6a4532b0c7b', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L12) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php?rev=3213295#L12) |  |
  | 12 | 12 | 'versions' => array( |
  | 13 | 13 | 'a5hleyrich/wp-background-processing' => array( |
  | 14 |  | 'pretty\_version' => '1.~~3.1~~', |
  | 15 |  | 'version' => '1.~~3.1~~.0', |
  | 16 |  | 'reference' => '~~6d1e48165e461260075b9f161b3861c7278f71e7~~', |
  |  | 14 | 'pretty\_version' => '1.4.0', |
  |  | 15 | 'version' => '1.4.0.0', |
  |  | 16 | 'reference' => '7ca7cc3504333db3a291bbab7f1917124fba4816', |
  | 17 | 17 | 'type' => 'library', |
  | 18 | 18 | 'install\_path' => \_\_DIR\_\_ . '/../a5hleyrich/wp-background-processing', |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L233) | […](/browser/wedevs-project-manager/tags/2.6.17/vendor/composer/installed.php?rev=3213295#L233) |  |
  | 233 | 233 | ), |
  | 234 | 234 | 'wedevsofficial/wp-project-manager' => array( |
  | 235 |  | 'pretty\_version' => 'v2.6.1~~6~~', |
  | 236 |  | 'version' => '2.6.1~~6~~.0', |
  | 237 |  | 'reference' => '~~aa10bf0db85fa168f8dd53272db03b0e826f519e~~', |
  |  | 235 | 'pretty\_version' => 'v2.6.17', |
  |  | 236 | 'version' => '2.6.17.0', |
  |  | 237 | 'reference' => '797195be849fb8196d032c4d5009c6a4532b0c7b', |
  | 238 | 238 | 'type' => 'wordpress-plugin', |
  | 239 | 239 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [wedevs-project-manager/trunk/changelog.txt](/changeset/3213295/wedevs-project-manager/trunk/changelog.txt "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/changelog.txt")

  | [r3206717](/browser/wedevs-project-manager/trunk/changelog.txt?rev=3206717#L1 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/changelog.txt?rev=3213295#L1 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | == Changelog == |
  |  | 2 |  |
  |  | 3 | = v2.6.17 - Dec 26, 2024 = |
  |  | 4 |  |
  |  | 5 | \*\*Improved:\*\* Enhanced sanitization of user input to strengthen data security. |
  |  | 6 | \*\*Fix:\*\* Resolved SQL security vulnerability to ensure system integrity.. |
  | 2 | 7 |  |
  | 3 | 8 | = v2.6.16 - Dec 10, 2024 = |
* ## [wedevs-project-manager/trunk/config/app.php](/changeset/3213295/wedevs-project-manager/trunk/config/app.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/config/app.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/config/app.php?rev=3206717#L4 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/config/app.php?rev=3213295#L4 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'name'        => 'Project Manager', |
  | 5 | 5 | 'slug'        => 'pm', |
  | 6 |  | 'version'     => '2.6.1~~6~~', |
  |  | 6 | 'version'     => '2.6.17', |
  | 7 | 7 | 'api'         => '2', |
  | 8 | 8 | 'db\_version'  => '2.5', |
* ## [wedevs-project-manager/trunk/core/Notifications/Emails/New\_Comment\_Notification.php](/changeset/3213295/wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php?rev=2474296#L76 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/core/Notifications/Emails/New_Comment_Notification.php?rev=3213295#L76 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | ->where( 'meta\_key', 'title' ) |
  | 77 | 77 | ->first(); |
  | 78 |  | $title = $filemeta->meta\_value; |
  |  | 78 |  |
  |  | 79 | $title = $filemeta->meta\_value ?? ''; |
  | 79 | 80 | } |
  | 80 | 81 |  |
* ## [wedevs-project-manager/trunk/cpm.php](/changeset/3213295/wedevs-project-manager/trunk/cpm.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/cpm.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/cpm.php?rev=3206717#L6 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/cpm.php?rev=3213295#L6 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Author: weDevs |
  | 7 | 7 | \* Author URI: https://wedevs.com |
  | 8 |  | \* Version: 2.6.1~~6~~ |
  |  | 8 | \* Version: 2.6.17 |
  | 9 | 9 | \* Text Domain: wedevs-project-manager |
  | 10 | 10 | \* Domain Path: /languages |
* ## [wedevs-project-manager/trunk/libs/functions.php](/changeset/3213295/wedevs-project-manager/trunk/libs/functions.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/libs/functions.php")

  | [r2938582](/browser/wedevs-project-manager/trunk/libs/functions.php?rev=2938582#L1328 "Show revision 2938582 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/libs/functions.php?rev=3213295#L1328 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1328 | 1328 | return empty( $cap ) ? $caps : $caps[$cap]; |
  | 1329 | 1329 | } |
  |  | 1330 |  |
  |  | 1331 |  |
  |  | 1332 | function pm\_validate\_assignee( $assignees){ |
  |  | 1333 |  |
  |  | 1334 | if ( empty( $assignees ) ) { |
  |  | 1335 | return []; |
  |  | 1336 | } |
  |  | 1337 |  |
  |  | 1338 | if ( !is\_array( $assignees ) ) { |
  |  | 1339 | return []; |
  |  | 1340 | } |
  |  | 1341 |  |
  |  | 1342 | foreach ( $assignees as &$assignee ) { |
  |  | 1343 | // Sanitize user\_id and role\_id |
  |  | 1344 | $assignee['user\_id'] = absint( $assignee['user\_id'] ); |
  |  | 1345 | $assignee['role\_id'] = absint( $assignee['role\_id'] ); |
  |  | 1346 |  |
  |  | 1347 | // validate user\_id exists |
  |  | 1348 | $user = get\_user\_by( 'id', $assignee['user\_id'] ); |
  |  | 1349 | if ( ! $user ) { |
  |  | 1350 | continue; |
  |  | 1351 | } |
  |  | 1352 |  |
  |  | 1353 | // validate role\_id is a valid role in your system |
  |  | 1354 | if ( ! get\_role( $assignee['role\_id'] ) ) { |
  |  | 1355 | continue; |
  |  | 1356 | } |
  |  | 1357 | } |
  |  | 1358 |  |
  |  | 1359 | return $assignees; |
  |  | 1360 | } |
* ## [wedevs-project-manager/trunk/readme.txt](/changeset/3213295/wedevs-project-manager/trunk/readme.txt "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/readme.txt")

  | [r3206717](/browser/wedevs-project-manager/trunk/readme.txt?rev=3206717#L6 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/readme.txt?rev=3213295#L6 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.7.1 |
  | 7 | 7 | Requires PHP: 5.6 |
  | 8 |  | Stable tag: 2.6.1~~6~~ |
  |  | 8 | Stable tag: 2.6.17 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wedevs-project-manager/trunk/readme.txt?rev=3206717#L310) | […](/browser/wedevs-project-manager/trunk/readme.txt?rev=3213295#L310) |  |
  | 310 | 310 | == Changelog == |
  | 311 | 311 |  |
  |  | 312 | = v2.6.17 - Dec 26, 2024 = |
  |  | 313 |  |
  |  | 314 | \*\*Improved:\*\* Enhanced sanitization of user input to strengthen data security. |
  |  | 315 | \*\*Fix:\*\* Resolved SQL security vulnerability to ensure system integrity.. |
  |  | 316 |  |
  | 312 | 317 | = v2.6.16 - Dec 10, 2024 = |
  | 313 | 318 |  |
* ## [wedevs-project-manager/trunk/src/Activity/Controllers/Activity\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Activity/Controllers/Activity_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | public function index( WP\_REST\_Request $request ) { |
  | 21 | 21 |  |
  | 22 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  | 23 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  | 24 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 22 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 23 | $page       = intval( $request->get\_param( 'page' ) ); |
  |  | 24 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 25 | 25 |  |
  | 26 | 26 | $per\_page   = $per\_page ? $per\_page : 20; |
* ## [wedevs-project-manager/trunk/src/Category/Controllers/Category\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $type = ~~$request->get\_param( 'type'~~ ); |
  |  | 22 | $type = sanitize\_text\_field( $request->get\_param( 'type' ) ); |
  | 23 | 23 |  |
  | 24 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 24 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 25 | 25 | $per\_page = $per\_page ? $per\_page : 20; |
  | 26 | 26 |  |
  | 27 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 27 | $page = intval( $request->get\_param( 'page' ) ); |
  | 28 | 28 | $page = $page ? $page : 1; |
  | 29 | 29 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L54) | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295#L54) |  |
  | 54 | 54 |  |
  | 55 | 55 | public function show( WP\_REST\_Request $request ) { |
  | 56 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 56 | $id = intval( $request->get\_param( 'id' ) ); |
  | 57 | 57 |  |
  | 58 | 58 | $category = Category::findOrFail( $id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L70) | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295#L70) |  |
  | 70 | 70 | public function store( WP\_REST\_Request $request ) { |
  | 71 | 71 | $data = [ |
  | 72 |  | 'title' => ~~$request->get\_param( 'title'~~ ), |
  | 73 |  | 'description' => ~~$request->get\_param( 'description'~~ ), |
  | 74 |  | 'categorible\_type' => ~~$request->get\_param( 'categorible\_type'~~ ) |
  |  | 72 | 'title' => sanitize\_text\_field( $request->get\_param( 'title' ) ), |
  |  | 73 | 'description' => sanitize\_text\_field( $request->get\_param( 'description' ) ), |
  |  | 74 | 'categorible\_type' => sanitize\_text\_field( $request->get\_param( 'categorible\_type' ) ) |
  | 75 | 75 | ]; |
  | 76 | 76 | $data = array\_filter( $data ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L88) | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295#L88) |  |
  | 88 | 88 |  |
  | 89 | 89 | public function update( WP\_REST\_Request $request ) { |
  | 90 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 90 | $id = intval( $request->get\_param( 'id' ) ); |
  | 91 | 91 |  |
  | 92 | 92 | $data = [ |
  | 93 |  | 'title' => ~~$request->get\_param( 'title'~~ ), |
  | 94 |  | 'description' => ~~$request->get\_param( 'description'~~ ), |
  | 95 |  | 'categorible\_type' => ~~$request->get\_param( 'categorible\_type'~~ ) |
  |  | 93 | 'title' => sanitize\_text\_field( $request->get\_param( 'title' ) ), |
  |  | 94 | 'description' => sanitize\_text\_field( $request->get\_param( 'description' ) ), |
  |  | 95 | 'categorible\_type' => sanitize\_text\_field( $request->get\_param( 'categorible\_type' ) ) |
  | 96 | 96 | ]; |
  |  | 97 |  |
  | 97 | 98 |  |
  | 98 | 99 | $category = Category::findOrFail( $id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=2474296#L110) | […](/browser/wedevs-project-manager/trunk/src/Category/Controllers/Category_Controller.php?rev=3213295#L111) |  |
  | 110 | 111 |  |
  | 111 | 112 | public function destroy( WP\_REST\_Request $request ) { |
  | 112 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 113 | $id = intval( $request->get\_param( 'id' ) ); |
  | 113 | 114 | $category = Category::find( $id ); |
  | 114 | 115 |  |
* ## [wedevs-project-manager/trunk/src/Comment/Controllers/Comment\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php")

  | [r3185807](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3185807#L23 "Show revision 3185807 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3213295#L23 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 |  |
  | 24 | 24 | public function index( WP\_REST\_Request $request ) { |
  | 25 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 26 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  | 27 |  | $page     = ~~$request->get\_param( 'page'~~ ); |
  |  | 25 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 26 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 27 | $page     = intval( $request->get\_param( 'page' ) ); |
  | 28 | 28 |  |
  | 29 | 29 | $per\_page = $per\_page ? $per\_page : pm\_config('app.comment\_per\_page'); |
  | […](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3185807#L31) | […](/browser/wedevs-project-manager/trunk/src/Comment/Controllers/Comment_Controller.php?rev=3213295#L31) |  |
  | 31 | 31 |  |
  | 32 | 32 | $on = $request->get\_param( 'on' ); |
  | 33 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 33 | $id = intval( $request->get\_param( 'id' ) ); |
  | 34 | 34 | $by = $request->get\_param( 'by' ); |
  | 35 | 35 |  |
* ## [wedevs-project-manager/trunk/src/Discussion\_Board/Controllers/Discussion\_Board\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php")

  | [r3185807](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L27 "Show revision 3185807 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L27 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 |  |
  | 28 | 28 | public function index( WP\_REST\_Request $request ) { |
  | 29 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 30 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 29 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 30 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 31 | 31 | $per\_page = $per\_page ? $per\_page : 15; |
  | 32 | 32 |  |
  | 33 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 33 | $page = intval( $request->get\_param( 'page' ) ); |
  | 34 | 34 | $page = $page ? $page : 1; |
  | 35 | 35 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L52) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L52) |  |
  | 52 | 52 |  |
  | 53 | 53 | public function show( WP\_REST\_Request $request ) { |
  | 54 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 55 |  | $discussion\_board\_id = ~~$request->get\_param( 'discussion\_board\_id'~~ ); |
  | 56 |  |  |
  |  | 54 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 55 | $discussion\_board\_id = intval( $request->get\_param( 'discussion\_board\_id' ) ); |
  |  | 56 |  |
  | 57 | 57 | $discussion\_board  = Discussion\_Board::with('metas')->where( 'id', $discussion\_board\_id )->where( 'project\_id', $project\_id ); |
  | 58 | 58 | $discussion\_board = apply\_filters( 'pm\_discuss\_show\_query', $discussion\_board, $project\_id, $request ); |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L73) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L73) |  |
  | 73 | 73 | $data         = $this->extract\_non\_empty\_values( $request ); |
  | 74 | 74 | $media\_data   = $request->get\_file\_params(); |
  | 75 |  | $milestone\_id = ~~$request->get\_param( 'milestone'~~ ); |
  |  | 75 | $milestone\_id = intval( $request->get\_param( 'milestone' ) ); |
  | 76 | 76 | $files        = array\_key\_exists( 'files', $media\_data ) ? $media\_data['files'] : null; |
  | 77 |  |  |
  |  | 77 |  |
  | 78 | 78 | if( HelperFile::check\_file\_for\_xss\_code( $files ) ){ |
  | 79 | 79 | return wp\_send\_json( |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L83) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L83) |  |
  | 83 | 83 | ], 400 |
  | 84 | 84 | ); |
  | 85 |  | ~~wp\_die();~~ |
  | 86 | 85 | } |
  | 87 | 86 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L114) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L113) |  |
  | 114 | 113 | $data                = $this->extract\_non\_empty\_values( $request ); |
  | 115 | 114 | $media\_data          = $request->get\_file\_params(); |
  | 116 |  | $project\_id          = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 115 | $project\_id          = intval( $request->get\_param( 'project\_id' ) ); |
  | 117 | 116 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 118 | 117 | $milestone\_id        = $request->get\_param( 'milestone' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L127) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L126) |  |
  | 127 | 126 | ], 400 |
  | 128 | 127 | ); |
  | 129 |  | wp\_die(); |
  | 130 |  | } |
  | 131 |  |  |
  | 132 |  | $is\_private    = $request->get\_param( 'privacy' ); |
  |  | 128 | } |
  |  | 129 |  |
  |  | 130 | $is\_private    = sanitize\_text\_field( $request->get\_param( 'privacy' ) ); |
  | 133 | 131 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 134 | 132 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L166) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L164) |  |
  | 166 | 164 |  |
  | 167 | 165 | public function destroy( WP\_REST\_Request $request ) { |
  | 168 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 166 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 169 | 167 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 170 | 168 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L213) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L211) |  |
  | 213 | 211 |  |
  | 214 | 212 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 215 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 216 |  | $discussion\_board\_id = ~~$request->get\_param( 'discussion\_board\_id'~~ ); |
  |  | 213 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 214 | $discussion\_board\_id = intval( $request->get\_param( 'discussion\_board\_id' ) ); |
  | 217 | 215 |  |
  | 218 | 216 | $discussion\_board = Discussion\_Board::where( 'id', $discussion\_board\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L240) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L238) |  |
  | 240 | 238 |  |
  | 241 | 239 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 242 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 240 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 243 | 241 | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 244 | 242 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3185807#L259) | […](/browser/wedevs-project-manager/trunk/src/Discussion_Board/Controllers/Discussion_Board_Controller.php?rev=3213295#L257) |  |
  | 259 | 257 |  |
  | 260 | 258 | public function privacy( WP\_REST\_Request $request ) { |
  | 261 |  | $project\_id = $request->get\_param( 'project\_id' ); |
  | 262 |  | $discussion\_board\_id = $request->get\_param( 'discussion\_board\_id' ); |
  | 263 |  | $privacy = $request->get\_param( 'is\_private' ); |
  |  | 259 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 260 | $discussion\_board\_id = intval($request->get\_param( 'discussion\_board\_id' ) ); |
  |  | 261 | $privacy = intval( $request->get\_param( 'is\_private' ) ); |
  |  | 262 |  |
  | 264 | 263 | $discuss = Discussion\_Board::find( $discussion\_board\_id ); |
  | 265 | 264 | $discuss->update\_model( [ |
* ## [wedevs-project-manager/trunk/src/File/Controllers/File\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 23 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 22 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 23 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  | 24 | 24 | $per\_page = $per\_page ? $per\_page : 200; |
  | 25 | 25 |  |
  | 26 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 26 | $page = intval( $request->get\_param( 'page' ) ); |
  | 27 | 27 | $page = $page ? $page : 1; |
  | 28 | 28 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L46) | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295#L46) |  |
  | 46 | 46 |  |
  | 47 | 47 | public function show( WP\_REST\_Request $request ) { |
  | 48 |  | $file\_id = ~~$request->get\_param( 'file\_id'~~ ); |
  |  | 48 | $file\_id = intval($request->get\_param( 'file\_id' ) ); |
  | 49 | 49 | $file = File::find( $file\_id ); |
  | 50 | 50 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L70) | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295#L70) |  |
  | 70 | 70 |  |
  | 71 | 71 | public function rename( WP\_REST\_Request $request ) { |
  | 72 |  | $file\_id   = ~~$request->get\_param( 'file\_id'~~ ); |
  | 73 |  | $file\_name = ~~$request->get\_param( 'name'~~ ); |
  |  | 72 | $file\_id   = intval( $request->get\_param( 'file\_id' ) ); |
  |  | 73 | $file\_name = sanitize\_file\_name($request->get\_param( 'name' ) ); |
  | 74 | 74 | $file      = File::find( $file\_id ); |
  | 75 | 75 |  |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L82) | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295#L82) |  |
  | 82 | 82 |  |
  | 83 | 83 | public function destroy( WP\_REST\_Request $request ) { |
  | 84 |  | $file\_id = ~~$request->get\_param( 'file\_id'~~ ); |
  |  | 84 | $file\_id = intval( $request->get\_param( 'file\_id' ) ); |
  | 85 | 85 |  |
  | 86 | 86 | $file = File::find( $file\_id ); |
  | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=2474296#L92) | […](/browser/wedevs-project-manager/trunk/src/File/Controllers/File_Controller.php?rev=3213295#L92) |  |
  | 92 | 92 |  |
  | 93 | 93 | public function download( WP\_REST\_Request $request ) { |
  | 94 |  | $file\_id = ~~$request->get\_param('file\_id'~~); |
  |  | 94 | $file\_id = intval( $request->get\_param('file\_id') ); |
  | 95 | 95 |  |
  | 96 | 96 | //get file path |
* ## [wedevs-project-manager/trunk/src/File/Models/File.php](/changeset/3213295/wedevs-project-manager/trunk/src/File/Models/File.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/File/Models/File.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/File/Models/File.php?rev=2474296#L28 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/File/Models/File.php?rev=3213295#L28 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 | public function comment() { |
  | 29 | 29 | return $this->hasOne( 'WeDevs\PM\Comment\Models\Comment', 'id', 'fileable\_id'); |
  | 30 |  | ~~return $this->belongsToMany( 'WeDevs\PM\Common\Models\Board', pm\_tb\_prefix() . 'pm\_comments', 'id', 'commentable\_id', 'fileable\_id');~~ |
  | 31 | 30 | } |
  | 32 | 31 |  |
* ## [wedevs-project-manager/trunk/src/Imports/Controllers/Trello\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=2474296#L21 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=3213295#L21 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | public function test( WP\_REST\_Request $request ) { |
  | 22 | 22 |  |
  | 23 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 24 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 23 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 24 | $app\_token = trim(sanitize\_text\_field($request->get\_param('app\_token'))); |
  | 25 | 25 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 26 | 26 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=2474296#L49) | […](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller.php?rev=3213295#L49) |  |
  | 49 | 49 |  |
  | 50 | 50 | public function get\_user(WP\_REST\_Request $request){ |
  | 51 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 52 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 51 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 52 | $app\_token = trim(sanitize\_text\_field($request->get\_param('app\_token'))); |
  | 53 | 53 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 54 | 54 | $trello\_user = $trello\_helper->get\_trello\_user(); |
* ## [wedevs-project-manager/trunk/src/Imports/Controllers/Trello\_Controller\_backup.php](/changeset/3213295/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Imports/Controllers/Trello_Controller_backup.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | public function test( WP\_REST\_Request $request ) { |
  | 20 | 20 |  |
  | 21 |  | $app\_key = trim(~~$request->get\_param('app\_key'~~)); |
  | 22 |  | $app\_token = trim(~~$request->get\_param('app\_token'~~)); |
  |  | 21 | $app\_key = trim(sanitize\_text\_field($request->get\_param('app\_key'))); |
  |  | 22 | $app\_token = trim(sanitize\_text\_field( $request->get\_param('app\_token'))); |
  | 23 | 23 | $trello\_helper = new Trello\_helper($app\_key,$app\_token,'dev'); |
  | 24 | 24 |  |
* ## [wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L32 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L32 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 32 | 32 |  |
  | 33 | 33 | public function index( WP\_REST\_Request $request ) { |
  | 34 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 35 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  | 36 |  | $status     = ~~$request->get\_param( 'status'~~ ); |
  |  | 34 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 35 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 36 | $status     = sanitize\_text\_field($request->get\_param( 'status' ) ); |
  | 37 | 37 | $per\_page   = $per\_page ? $per\_page : -1; |
  | 38 | 38 |  |
  | 39 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 39 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 40 | 40 | $page       = $page ? $page : 1; |
  | 41 | 41 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L77) | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L77) |  |
  | 77 | 77 |  |
  | 78 | 78 | public function show( WP\_REST\_Request $request ) { |
  | 79 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 80 |  | $milestone\_id = ~~$request->get\_param( 'milestone\_id'~~ ); |
  |  | 79 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 80 | $milestone\_id = intval( $request->get\_param( 'milestone\_id' ) ); |
  | 81 | 81 |  |
  | 82 | 82 | $milestone = Milestone::where( 'id', $milestone\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L131) | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L131) |  |
  | 131 | 131 | // Grab non empty user input |
  | 132 | 132 | $data = $this->extract\_non\_empty\_values( $request ); |
  | 133 |  | $is\_private    = ~~$request->get\_param( 'privacy'~~ ); |
  |  | 133 | $is\_private    = sanitize\_text\_field( $request->get\_param( 'privacy' ) ); |
  | 134 | 134 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 135 | 135 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L174) | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L174) |  |
  | 174 | 174 |  |
  | 175 | 175 | // Set project id from url parameter |
  | 176 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 176 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  | 177 | 177 |  |
  | 178 | 178 | // Set milestone id from url parameter |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L215) | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L215) |  |
  | 215 | 215 |  |
  | 216 | 216 | public function destroy( WP\_REST\_Request $request ) { |
  | 217 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 217 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  | 218 | 218 | $milestone\_id = $request->get\_param( 'milestone\_id' ); |
  | 219 | 219 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=2474296#L234) | […](/browser/wedevs-project-manager/trunk/src/Milestone/Controllers/Milestone_Controller.php?rev=3213295#L234) |  |
  | 234 | 234 | } |
  | 235 | 235 | public function privacy( WP\_REST\_Request $request ) { |
  | 236 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 236 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 237 | 237 | $milestone\_id = $request->get\_param( 'milestone\_id' ); |
  | 238 | 238 | $privacy = $request->get\_param( 'is\_private' ); |
* ## [wedevs-project-manager/trunk/src/My\_Task/Controllers/MyTask\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php")

  | [r2918375](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L23 "Show revision 2918375 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L23 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 |  |
  | 24 | 24 | public function user\_tasks\_by\_type ( WP\_REST\_Request $request ) { |
  | 25 |  | $id       = $request->get\_param( 'id' ); |
  | 26 |  | $taskType = $request->get\_param( 'task\_type' ); |
  |  | 25 | $id       = intval( $request->get\_param( 'id' ) ); |
  |  | 26 | $taskType = sanitize\_text\_field( $request->get\_param( 'task\_type' ) ); |
  |  | 27 |  |
  | 27 | 28 | $today = date( 'Y-m-d', strtotime( current\_time( 'mysql' ) ) ); |
  | 28 | 29 |  |
  | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L655) | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L656) |  |
  | 655 | 656 |  |
  | 656 | 657 | // public function user\_calender\_tasks\_x( WP\_REST\_Request $request ) { |
  | 657 |  | //     $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 658 | //     $id = intval( $request->get\_param( 'id' ) ); |
  | 658 | 659 | //     $start      = $request->get\_param( 'start' ); |
  | 659 | 660 | //     $end        = $request->get\_param( 'end' ); |
  | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=2918375#L722) | […](/browser/wedevs-project-manager/trunk/src/My_Task/Controllers/MyTask_Controller.php?rev=3213295#L723) |  |
  | 722 | 723 |  |
  | 723 | 724 | public function user\_activities ( WP\_REST\_Request $request ) { |
  | 724 |  | $id       = ~~$request->get\_param( 'id'~~ ); |
  |  | 725 | $id       = intval( $request->get\_param( 'id' ) ); |
  | 725 | 726 | $page     = $request->get\_param( 'mytask\_activities\_page' ); |
  | 726 | 727 | $per\_page = $request->get\_param( 'mytask\_activities\_per\_page' ); |
* ## [wedevs-project-manager/trunk/src/Project/Controllers/Project\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L26 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295#L26 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 26 | 26 |  |
  | 27 | 27 | public function index( WP\_REST\_Request $request ) { |
  | 28 |  | $per\_page = ~~$request->get\_param( 'per\_page'~~ ); |
  | 29 |  | $page     = ~~$request->get\_param( 'page'~~ ); |
  |  | 28 | $per\_page = intval( $request->get\_param( 'per\_page' ) ); |
  |  | 29 | $page     = intval( $request->get\_param( 'page' ) ); |
  | 30 | 30 | $status   = $request->get\_param( 'status' ); |
  | 31 | 31 | $category = $request->get\_param( 'category' ); |
  | 32 | 32 | $project\_transform = $request->get\_param( 'project\_transform' ); |
  | 33 |  |  |
  |  | 33 |  |
  | 34 | 34 | $per\_page\_from\_settings = pm\_get\_setting( 'project\_per\_page' ); |
  | 35 | 35 | $per\_page\_from\_settings = $per\_page\_from\_settings ? $per\_page\_from\_settings : 15; |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L216) | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295#L216) |  |
  | 216 | 216 | add\_option('projectId\_git\_bit\_hash\_'.$project->id , sha1(strtotime("now").$project->id)); |
  | 217 | 217 | // Establishing relationships |
  | 218 |  | $category\_ids = $request->get\_param( 'categories' ); |
  |  | 218 | $category\_ids = intval( $request->get\_param( 'categories' ) ); |
  |  | 219 |  |
  | 219 | 220 | if ( $category\_ids ) { |
  | 220 | 221 | $project->categories()->sync( $category\_ids ); |
  | 221 | 222 | } |
  | 222 | 223 |  |
  | 223 |  | $assignees =  $request->get\_param( 'assignees' ); |
  |  | 224 | $assignees = pm\_validate\_assignee( $request->get\_param( 'assignees' ) ); |
  |  | 225 |  |
  | 224 | 226 | $assignees[] = [ |
  | 225 | 227 | 'user\_id' => wp\_get\_current\_user()->ID, |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L253) | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295#L255) |  |
  | 253 | 255 |  |
  | 254 | 256 | // Establishing relationships |
  | 255 |  | $category\_ids = ~~$request->get\_param( 'categories'~~ ); |
  |  | 257 | $category\_ids = intval( $request->get\_param( 'categories' )); |
  | 256 | 258 | if ( $category\_ids ) { |
  | 257 | 259 | $project->categories()->sync( $category\_ids ); |
  | 258 | 260 | } |
  | 259 | 261 |  |
  | 260 |  | $assignees = ~~$request->get\_param( 'assignees'~~ ); |
  |  | 262 | $assignees = pm\_validate\_assignee( $request->get\_param( 'assignees' ) ); |
  | 261 | 263 |  |
  | 262 | 264 | if ( is\_array( $assignees ) ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L323) | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295#L325) |  |
  | 323 | 325 |  |
  | 324 | 326 | public function destroy( WP\_REST\_Request $request ) { |
  | 325 |  | $id = ~~$request->get\_param('id'~~); |
  |  | 327 | $id = intval( $request->get\_param('id') ); |
  | 326 | 328 |  |
  | 327 | 329 | // Find the requested resource |
  | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=2474296#L381) | […](/browser/wedevs-project-manager/trunk/src/Project/Controllers/Project_Controller.php?rev=3213295#L383) |  |
  | 381 | 383 |  |
  | 382 | 384 | public function favourite\_project (WP\_REST\_Request $request) { |
  | 383 |  | $project\_id = ~~$request->get\_param( 'id'~~ ); |
  | 384 |  | $favourite  = ~~$request->get\_param( 'favourite' )~~; |
  |  | 385 | $project\_id = intval( $request->get\_param( 'id' ) ); |
  |  | 386 | $favourite  = sanitize\_text\_field( $request->get\_param( 'favourite' ) ) ; |
  | 385 | 387 | $user\_id    = get\_current\_user\_id(); |
  | 386 | 388 |  |
* ## [wedevs-project-manager/trunk/src/Role/Controllers/Role\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=2474296#L27 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=3213295#L27 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 |  |
  | 28 | 28 | public function show( WP\_REST\_Request $request ) { |
  | 29 |  | $id       = ~~$request->get\_param('id'~~); |
  |  | 29 | $id       = intval( $request->get\_param('id') ); |
  | 30 | 30 | $role     = Role::where('status', 1)->find( $id ); |
  | 31 | 31 | $resource = new Item( $role, new Role\_Transformer ); |
  | […](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=2474296#L57) | […](/browser/wedevs-project-manager/trunk/src/Role/Controllers/Role_Controller.php?rev=3213295#L57) |  |
  | 57 | 57 |  |
  | 58 | 58 | public function destroy( WP\_REST\_Request $request ) { |
  | 59 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 59 | $id = intval( $request->get\_param( 'id' ) ); |
  | 60 | 60 | $role = Role::find( $id ); |
  | 61 | 61 |  |
* ## [wedevs-project-manager/trunk/src/Search/Controllers/Search\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 |  |
  | 20 | 20 | public function search( WP\_REST\_Request $request ) { |
  | 21 |  | $string     = ~~$request->get\_param( 'query'~~ ); |
  | 22 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 21 | $string     = sanitize\_text\_field( $request->get\_param( 'query' ) ); |
  |  | 22 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 23 | 23 | $model      = $request->get\_param( 'model' ); //[milestone, discussion\_board, task\_list, task] |
  | 24 | 24 | $model      = empty( $model ) ? '' : $model; |
  | […](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=2474296#L35) | […](/browser/wedevs-project-manager/trunk/src/Search/Controllers/Search_Controller.php?rev=3213295#L35) |  |
  | 35 | 35 |  |
  | 36 | 36 | public function searchTopBar( WP\_REST\_Request $request ) { |
  | 37 |  | $string     = ~~$request->get\_param( 'query'~~ ); |
  | 38 |  | $type     = ~~$request->get\_param( 'type'~~ ); |
  |  | 37 | $string     = sanitize\_text\_field ( $request->get\_param( 'query' ) ); |
  |  | 38 | $type     = sanitize\_text\_field( $request->get\_param( 'type' ) ); |
  | 39 | 39 | $model      = $request->get\_param( 'model' ); //[milestone, discussion\_board, task\_list, task] |
  | 40 | 40 | $model      = empty( $model ) ? '' : $model; |
* ## [wedevs-project-manager/trunk/src/Settings/Controllers/Settings\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L19 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L19 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 |  |
  | 20 | 20 | public function index( WP\_REST\_Request $request ) { |
  | 21 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 21 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 22 | 22 | $key        = $request->get\_param( 'key' ); |
  | 23 | 23 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L54) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L54) |  |
  | 54 | 54 | public function store( WP\_REST\_Request $request ) { |
  | 55 | 55 | $data       = $this->extract\_non\_empty\_values( $request ); |
  | 56 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 56 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 57 | 57 | $settings   = $request->get\_param( 'settings' ); |
  | 58 |  | $id         = ~~$request->get\_param( 'id'~~ ); |
  |  | 58 | $id         = intval( $request->get\_param( 'id' ) ); |
  | 59 | 59 |  |
  | 60 | 60 | if ( is\_array( $settings ) ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L115) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L115) |  |
  | 115 | 115 |  |
  | 116 | 116 | public function destroy( WP\_REST\_Request $request ) { |
  | 117 |  | $id = ~~$request->get\_param( 'id'~~ ); |
  |  | 117 | $id = intval( $request->get\_param( 'id' ) ); |
  | 118 | 118 |  |
  | 119 | 119 | $settings = Settings::where( 'id', $id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L132) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L132) |  |
  | 132 | 132 | $key = $request->get\_param('key'); |
  | 133 | 133 |  |
  | 134 |  | return pm\_get\_setting( $k~~ye~~ ); |
  |  | 134 | return pm\_get\_setting( $key ); |
  | 135 | 135 | } |
  | 136 | 136 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=2474296#L139) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Settings_Controller.php?rev=3213295#L139) |  |
  | 139 | 139 | $key        = $request->get\_param('key'); |
  | 140 | 140 |  |
  | 141 |  | return pm\_get\_setting( $k~~ye~~, $project\_id ); |
  |  | 141 | return pm\_get\_setting( $key, $project\_id ); |
  | 142 | 142 | } |
  | 143 | 143 |  |
* ## [wedevs-project-manager/trunk/src/Settings/Controllers/Task\_Types\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php")

  | [r2474296](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L20 "Show revision 2474296 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L20 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | public function index( WP\_REST\_Request $request ) { |
  | 22 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 22 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 23 | 23 | $per\_page   = $per\_page ? $per\_page : 500; |
  | 24 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 24 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 25 | 25 | $page       = empty( $page ) ? 1 : $page; |
  | 26 | 26 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L67) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L67) |  |
  | 67 | 67 |  |
  | 68 | 68 | public function update\_task\_type( WP\_REST\_Request $request ) { |
  | 69 |  | $id          = ~~$request->get\_param( 'id'~~ ); |
  |  | 69 | $id          = intval( $request->get\_param( 'id' ) ); |
  | 70 | 70 | $title       = $request->get\_param( 'title' ); |
  | 71 | 71 | $description = $request->get\_param( 'description' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=2474296#L89) | […](/browser/wedevs-project-manager/trunk/src/Settings/Controllers/Task_Types_Controller.php?rev=3213295#L89) |  |
  | 89 | 89 |  |
  | 90 | 90 | public function destroy\_task\_type( WP\_REST\_Request $request ) { |
  | 91 |  | $id    = ~~$request->get\_param( 'id'~~ ); |
  |  | 91 | $id    = intval( $request->get\_param( 'id' ) ); |
  | 92 | 92 |  |
  | 93 | 93 | $stored\_type = Task\_Types::where( 'id', $id ) |
* ## [wedevs-project-manager/trunk/src/Task/Controllers/Task\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php")

  | [r2627870](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L50 "Show revision 2627870 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L50 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 50 | 50 |  |
  | 51 | 51 | public function index( WP\_REST\_Request $request ) { |
  | 52 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 53 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 52 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 53 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 54 | 54 | $per\_page   = $per\_page ? $per\_page : 5; |
  | 55 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  | 56 |  | $search     = ~~$request->get\_param( 's'~~ ); |
  |  | 55 | $page       = intval( $request->get\_param( 'page' ) ); |
  |  | 56 | $search     = sanitize\_text\_field( $request->get\_param( 's' ) ); |
  | 57 | 57 |  |
  | 58 | 58 | Paginator::currentPageResolver(function () use ($page) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L92) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L92) |  |
  | 92 | 92 |  |
  | 93 | 93 | public function show( WP\_REST\_Request $request ) { |
  | 94 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 95 |  | $task\_id    = ~~$request->get\_param( 'task\_id'~~ ); |
  |  | 94 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 95 | $task\_id    = intval( $request->get\_param( 'task\_id' ) ); |
  | 96 | 96 | return $this->get\_task( $task\_id, $project\_id, $request->get\_params() ); |
  | 97 | 97 | } |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L102) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L102) |  |
  | 102 | 102 | 'with' => 'project, activities, comments, task\_list, time, labels' |
  | 103 | 103 | ] ); |
  | 104 |  | ~~// $task = Task::with( 'task\_lists' )~~ |
  | 105 |  | ~~//     ->where( 'id', $task\_id )~~ |
  | 106 |  | ~~//     ->parent();~~ |
  | 107 |  |  |
  | 108 |  | ~~// if ( $project\_id ) {~~ |
  | 109 |  | ~~//     $task = $task->where( 'project\_id', $project\_id );~~ |
  | 110 |  |  |
  | 111 |  | ~~// }~~ |
  | 112 |  |  |
  | 113 |  | ~~// $task = apply\_filters( 'pm\_task\_show\_query', $task, $project\_id, $request );~~ |
  | 114 |  | ~~// $task = $task->first();~~ |
  | 115 |  |  |
  | 116 |  | ~~// if ( $task == NULL ) {~~ |
  | 117 |  | ~~//     return pm\_get\_response( null,  [~~ |
  | 118 |  | ~~//         'message' => pm\_get\_text('success\_messages.no\_element')~~ |
  | 119 |  | ~~//     ] );~~ |
  | 120 |  | ~~// }~~ |
  | 121 |  |  |
  | 122 |  | ~~// $resource = new Item( $task, new Task\_Transformer );~~ |
  | 123 |  | ~~// $response = self::getInstance()->get\_response( $resource );~~ |
  | 124 |  | ~~// $response = apply\_filters('pm\_get\_task', $response , $request);~~ |
  | 125 |  |  |
  | 126 |  | ~~// return $response ;~~ |
  | 127 | 104 | } |
  | 128 | 105 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L186) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L163) |  |
  | 186 | 163 | public function store( WP\_REST\_Request $request ) { |
  | 187 | 164 | $data          = $this->extract\_non\_empty\_values( $request ); |
  | 188 |  | $project\_id    = ~~$request->get\_param( 'project\_id'~~ ); |
  | 189 |  | $board\_id      = ~~$request->get\_param( 'board\_id'~~ ); |
  | 190 |  | $assignees     = ~~$request->get\_param( 'assignees'~~ ); |
  | 191 |  | $is\_private    = ~~$request->get\_param( 'privacy'~~ ); |
  | 192 |  | $type\_id       = ~~$request->get\_param( 'type\_id'~~ ); |
  |  | 165 | $project\_id    = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 166 | $board\_id      = intval( $request->get\_param( 'board\_id' ) ); |
  |  | 167 | $assignees     = array\_map( 'intval', $request->get\_param( 'assignees' )); |
  |  | 168 | $is\_private    = intval( $request->get\_param( 'privacy' ) ); |
  |  | 169 | $type\_id       = intval( $request->get\_param( 'type\_id' ) ); |
  | 193 | 170 | $data['is\_private']    = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 194 | 171 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L208) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L185) |  |
  | 208 | 185 |  |
  | 209 | 186 | do\_action( 'cpm\_task\_new', $board\_id, $task->id, $request->get\_params() ); |
  | 210 |  | ~~// do\_action('pm\_after\_update\_task', $task, $request->get\_params() );~~ |
  | 211 | 187 |  |
  | 212 | 188 | if ( $task && $board ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L354) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L330) |  |
  | 354 | 330 | } |
  | 355 | 331 |  |
  | 356 |  | // public static function task\_update( $params ) { |
  | 357 |  | //     $task\_id    = $params['task\_id']; |
  | 358 |  |  |
  | 359 |  | //     $task = Task::with('assignees')->find( $task\_id ); |
  | 360 |  |  |
  | 361 |  | //     if ( ! isset( $params['assignees'] ) ) { |
  | 362 |  | //         $assignees  = wp\_list\_pluck( $task->assignees->toArray(), 'assigned\_to' ); |
  | 363 |  | //     } else { |
  | 364 |  | //         $assignees  = empty( $params['assignees'] ) ? [] : $params['assignees']; |
  | 365 |  | //     } |
  | 366 |  |  |
  | 367 |  | //     $list\_id              = $task->task\_list; |
  | 368 |  | //     $project\_id           = $task->project\_id; |
  | 369 |  | //     $params['project\_id'] = $task->project\_id; |
  | 370 |  | //     $params['list\_id']    = $task->task\_list; |
  | 371 |  | //     $is\_private           = isset( $params['privacy'] ) ? $params['privacy'] : false; |
  | 372 |  | //     $params['is\_private'] = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 373 |  |  |
  | 374 |  | //     $deleted\_users = $task->assignees()->whereNotIn( 'assigned\_to', $assignees )->get()->toArray(); //->delete(); |
  | 375 |  | //     $deleted\_users = apply\_filters( 'pm\_task\_deleted\_users', $deleted\_users, $task ); |
  | 376 |  | //     $deleted\_users = wp\_list\_pluck( $deleted\_users, 'id' ); |
  | 377 |  |  |
  | 378 |  | //     if ( $deleted\_users ) { |
  | 379 |  | //         Assignee::destroy( $deleted\_users ); |
  | 380 |  | //     } |
  | 381 |  |  |
  | 382 |  | //     self::getInstance()->attach\_assignees( $task, $assignees ); |
  | 383 |  |  |
  | 384 |  | //     do\_action( 'cpm\_task\_update', $list\_id, $task\_id, $params ); |
  | 385 |  |  |
  | 386 |  | //     $params = apply\_filters( 'pm\_before\_update\_task', $params, $list\_id, $task\_id, $task ); |
  | 387 |  | //     $task->update\_model( $params ); |
  | 388 |  |  |
  | 389 |  | //     do\_action( 'cpm\_after\_update\_task', $task->id, $list\_id, $project\_id ); |
  | 390 |  | //     do\_action('pm\_after\_update\_task', $task, $params ); |
  | 391 |  |  |
  | 392 |  | //     $resource = new Item( $task, new Task\_Transformer ); |
  | 393 |  |  |
  | 394 |  | //     $message = [ |
  | 395 |  | //         'message' => pm\_get\_text('success\_messages.task\_updated'), |
  | 396 |  | //         'activity' => self::getInstance()->last\_activity( 'task', $task->id ), |
  | 397 |  | //     ]; |
  | 398 |  |  |
  | 399 |  | //     $response = self::getInstance()->get\_response( $resource, $message ); |
  | 400 |  |  |
  | 401 |  | //     do\_action('pm\_update\_task\_aftre\_transformer', $response, $params ); |
  | 402 |  |  |
  | 403 |  | //     return $response; |
  | 404 |  | // } |
  | 405 |  |  |
  |  | 332 |  |
  | 406 | 333 | public static function task\_update( $params ) { |
  | 407 |  | $task\_id    = ~~$params['task\_id']~~; |
  |  | 334 | $task\_id    = intval( $params['task\_id'] ); |
  | 408 | 335 |  |
  | 409 | 336 | $task = Task::with('assignees')->find( $task\_id ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L412) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L339) |  |
  | 412 | 339 | $assignees  = wp\_list\_pluck( $task->assignees->toArray(), 'assigned\_to' ); |
  | 413 | 340 | } else { |
  | 414 |  | $assignees  = empty( $params['assignees'] ) ? [] : ~~$params['assignees']~~; |
  |  | 341 | $assignees  = empty( $params['assignees'] ) ? [] : array\_map( 'intval', $params['assignees'] ); |
  | 415 | 342 | } |
  | 416 | 343 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L492) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L419) |  |
  | 492 | 419 | do\_action( 'pm\_changed\_task\_status', $task, $old\_value, $request->get\_params() ); |
  | 493 | 420 |  |
  | 494 |  | ~~//$resource = new Item( $task, new Task\_Transformer );~~ |
  | 495 | 421 | $task\_response = Task\_Helper::get\_results([ |
  | 496 | 422 | 'id' => $task->id, |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L503) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L429) |  |
  | 503 | 429 | 'data'     => $task\_response['data'] |
  | 504 | 430 | ]; |
  | 505 |  |  |
  | 506 |  | ~~// $message = [~~ |
  | 507 |  | ~~//     'message' => pm\_get\_text('success\_messages.task\_updated'),~~ |
  | 508 |  | ~~//     'activity' => $this->last\_activity( 'task', $task->id ),~~ |
  | 509 |  | ~~// ];~~ |
  | 510 |  |  |
  | 511 |  | ~~// $response = $this->get\_response( $resource, $message );~~ |
  | 512 | 431 |  |
  | 513 | 432 | do\_action('pm\_changed\_task\_status\_aftre\_transformer', $response, $request->get\_params() ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L588) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L507) |  |
  | 588 | 507 | public function destroy( WP\_REST\_Request $request ) { |
  | 589 | 508 | // Grab user inputs |
  | 590 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 509 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 591 | 510 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 592 | 511 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L679) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L598) |  |
  | 679 | 598 |  |
  | 680 | 599 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 681 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 600 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 682 | 601 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 683 | 602 | $user\_ids   = $request->get\_param( 'users' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L704) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L623) |  |
  | 704 | 623 |  |
  | 705 | 624 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 706 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 625 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 707 | 626 | $task\_id    = $request->get\_param( 'task\_id' ); |
  | 708 | 627 | $user\_ids   = $request->get\_param( 'users' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L744) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L663) |  |
  | 744 | 663 |  |
  | 745 | 664 | public function privacy( WP\_REST\_Request $request ) { |
  | 746 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 665 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 747 | 666 | $task\_id = $request->get\_param( 'task\_id' ); |
  | 748 | 667 | $privacy = $request->get\_param( 'is\_private' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L757) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L676) |  |
  | 757 | 676 | public function task\_sorting( WP\_REST\_Request $request ) { |
  | 758 | 677 |  |
  | 759 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 760 |  | $list\_id    = ~~$request->get\_param( 'list\_id'~~ ); |
  | 761 |  | $task\_id    = ~~$request->get\_param( 'task\_id'~~ ); |
  |  | 678 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 679 | $list\_id    = intval( $request->get\_param( 'list\_id' ) ); |
  |  | 680 | $task\_id    = intval($request->get\_param( 'task\_id' ) ); |
  | 762 | 681 | $orders     = $request->get\_param( 'orders' ); |
  | 763 | 682 | $receive    = $request->get\_param( 'receive' ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L820) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L739) |  |
  | 820 | 739 | global $wpdb; |
  | 821 | 740 |  |
  | 822 |  | $status       = ~~$request->get\_param('status'~~); |
  | 823 |  | ~~//$board\_status = $request->get\_param('board\_status'~~); |
  | 824 |  | $~~due\_date     = $request->get\_param('dueDate'~~); |
  | 825 |  | $~~assignees    = $request->get\_param('users'~~); |
  | 826 |  | $~~lists        = $request->get\_param('lists'~~); |
  | 827 |  | $~~project\_id   = $request->get\_param('project\_id'~~); |
  | 828 |  | $title        = $request->get\_param('title'); |
  |  | 741 | $status       = sanitize\_text\_field($request->get\_param('status')); |
  |  | 742 | $due\_date     = sanitize\_text\_field($request->get\_param('dueDate')); |
  |  | 743 | $assignees    = array\_map('intval', (array) $request->get\_param('users')); |
  |  | 744 | $lists        = array\_map('intval', (array) $request->get\_param('lists')); |
  |  | 745 | $project\_id   = intval($request->get\_param('project\_id')); |
  |  | 746 | $title        = sanitize\_text\_field($request->get\_param('title')); |
  |  | 747 |  |
  | 829 | 748 | $tb\_lists     = pm\_tb\_prefix() . 'pm\_boards'; |
  | 830 | 749 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L941) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L860) |  |
  | 941 | 860 | $ct\_per\_page   = empty( $per\_page ) ? 20 : intval( $per\_page ); |
  | 942 | 861 |  |
  | 943 |  | $page         = ~~$request->get\_param('page'~~); |
  | 944 |  | $project\_id   = ~~$request->get\_param('project\_id'~~); |
  |  | 862 | $page         = intval($request->get\_param('page')); |
  |  | 863 | $project\_id   = intval($request->get\_param('project\_id')); |
  | 945 | 864 |  |
  | 946 | 865 | Paginator::currentPageResolver(function () use ($page) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L966) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L885) |  |
  | 966 | 885 |  |
  | 967 | 886 | $filter = [ |
  | 968 |  | 'status' => ~~$request->get\_param('status'~~), |
  | 969 |  | 'due\_date' =>  ~~$request->get\_param('dueDate'~~), |
  | 970 |  | 'users' => ~~$request->get\_param('users'~~), |
  | 971 |  | 'title' => ~~$request->get\_param('title'~~) |
  |  | 887 | 'status' => sanitize\_key( $request->get\_param('status') ), |
  |  | 888 | 'due\_date' =>  sanitize\_text\_field( $request->get\_param('dueDate') ), |
  |  | 889 | 'users' => is\_array( $request->get\_param('users') ) ? array\_map( 'intval', $request->get\_param('users') )  : ( is\_numeric( $request->get\_param('users') ) ? intval( $request->get\_param('users') ) : null ), |
  |  | 890 | 'title' => sanitize\_text\_field( $request->get\_param('title') ) |
  | 972 | 891 | ]; |
  |  | 892 |  |
  | 973 | 893 |  |
  | 974 | 894 | //get total complete and incomplete tasks count |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L1013) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L933) |  |
  | 1013 | 933 | public function activities( WP\_REST\_Request $request ) { |
  | 1014 | 934 |  |
  | 1015 |  | $current\_page = $request->get\_param( 'activityPage' ); |
  | 1016 |  | $task\_id = $request->get\_param( 'task\_id' ); |
  |  | 935 | $current\_page = intval( $request->get\_param( 'activityPage' ) ); |
  |  | 936 | $task\_id = intval( $request->get\_param( 'task\_id' ) ); |
  |  | 937 |  |
  | 1017 | 938 | $per\_page = 10; |
  | 1018 | 939 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=2627870#L1411) | […](/browser/wedevs-project-manager/trunk/src/Task/Controllers/Task_Controller.php?rev=3213295#L1332) |  |
  | 1411 | 1332 |  |
  | 1412 | 1333 | public function load\_more\_tasks( WP\_REST\_Request $request ) { |
  | 1413 |  | $list\_id    = ~~$request->get\_param( 'list\_id'~~ ); |
  | 1414 |  | $task\_ids   = ~~$request->get\_param( 'task\_ids'~~ ); |
  | 1415 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 1416 |  | $status     = ~~$request->get\_param( 'status'~~ ); |
  |  | 1334 | $list\_id    = intval( $request->get\_param( 'list\_id' ) ); |
  |  | 1335 | $task\_ids   = array\_map( 'intval', (array)$request->get\_param( 'task\_ids' )); |
  |  | 1336 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 1337 | $status     = intval( $request->get\_param( 'status' ) ); |
  | 1417 | 1338 |  |
  | 1418 | 1339 | if ( (int) $status ) { |
* ## [wedevs-project-manager/trunk/src/Task/Helper/Task.php](/changeset/3213295/wedevs-project-manager/trunk/src/Task/Helper/Task.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Task/Helper/Task.php")

  | [r2967341](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L145 "Show revision 2967341 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=3213295#L145 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 145 | 145 | $response = $self->format\_tasks( $self->tasks ); |
  | 146 | 146 |  |
  | 147 |  | ~~//        $response = $array = [~~ |
  | 148 |  | ~~//            "data" => [~~ |
  | 149 |  | ~~//                [~~ |
  | 150 |  | ~~//                    "id" => 30,~~ |
  | 151 |  | ~~//                    "title" => "Project",~~ |
  | 152 |  | ~~//                    "description" => [~~ |
  | 153 |  | ~~//                        "html" => "",~~ |
  | 154 |  | ~~//                        "content" => ""~~ |
  | 155 |  | ~~//                    ],~~ |
  | 156 |  | ~~//                    "estimation" => 0,~~ |
  | 157 |  | ~~//                    "comparable\_estimation" => 0,~~ |
  | 158 |  | ~~//                    "formated\_com\_est" => [~~ |
  | 159 |  | ~~//                        "hour" => "00",~~ |
  | 160 |  | ~~//                        "minute" => "00",~~ |
  | 161 |  | ~~//                        "second" => "00",~~ |
  | 162 |  | ~~//                        "total\_second" => 0~~ |
  | 163 |  | ~~//                    ],~~ |
  | 164 |  | ~~//                    "start\_at" => [~~ |
  | 165 |  | ~~//                        "date" => "",~~ |
  | 166 |  | ~~//                        "time" => "",~~ |
  | 167 |  | ~~//                        "datetime" => "",~~ |
  | 168 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 169 |  | ~~//                        "timestamp" => ""~~ |
  | 170 |  | ~~//                    ],~~ |
  | 171 |  | ~~//                    "due\_date" => [~~ |
  | 172 |  | ~~//                        "date" => "",~~ |
  | 173 |  | ~~//                        "time" => "",~~ |
  | 174 |  | ~~//                        "datetime" => "",~~ |
  | 175 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 176 |  | ~~//                        "timestamp" => ""~~ |
  | 177 |  | ~~//                    ],~~ |
  | 178 |  | ~~//                    "complexity" => "basic",~~ |
  | 179 |  | ~~//                    "priority" => "medium",~~ |
  | 180 |  | ~~//                    "order" => 2,~~ |
  | 181 |  | ~~//                    "payable" => "no",~~ |
  | 182 |  | ~~//                    "recurrent" => 0,~~ |
  | 183 |  | ~~//                    "parent\_id" => 0,~~ |
  | 184 |  | ~~//                    "status" => "incomplete",~~ |
  | 185 |  | ~~//                    "category\_id" => "",~~ |
  | 186 |  | ~~//                    "created\_at" => [~~ |
  | 187 |  | ~~//                        "date" => "2023-08-23",~~ |
  | 188 |  | ~~//                        "time" => "05:27:37",~~ |
  | 189 |  | ~~//                        "datetime" => "2023-08-23 05:27:37",~~ |
  | 190 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 191 |  | ~~//                        "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 192 |  | ~~//                    ],~~ |
  | 193 |  | ~~//                    "created\_by" => 3,~~ |
  | 194 |  | ~~//                    "completed\_at" => [~~ |
  | 195 |  | ~~//                        "date" => "",~~ |
  | 196 |  | ~~//                        "time" => "",~~ |
  | 197 |  | ~~//                        "datetime" => "",~~ |
  | 198 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 199 |  | ~~//                        "timestamp" => ""~~ |
  | 200 |  | ~~//                    ],~~ |
  | 201 |  | ~~//                    "updated\_at" => [~~ |
  | 202 |  | ~~//                        "date" => "2023-08-23",~~ |
  | 203 |  | ~~//                        "time" => "05:27:37",~~ |
  | 204 |  | ~~//                        "datetime" => "2023-08-23 05:27:37",~~ |
  | 205 |  | ~~//                        "timezone" => "Etc/UTC",~~ |
  | 206 |  | ~~//                        "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 207 |  | ~~//                    ],~~ |
  | 208 |  | ~~//                    "creator" => [~~ |
  | 209 |  | ~~//                        "data" => [~~ |
  | 210 |  | ~~//                            "id" => 3,~~ |
  | 211 |  | ~~//                            "username" => "selygyh@email.com",~~ |
  | 212 |  | ~~//                            "nicename" => "selygyhemail-com",~~ |
  | 213 |  | ~~//                            "email" => "vicebeqy@mailinator.com",~~ |
  | 214 |  | ~~//                            "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 215 |  | ~~//                            "display\_name" => "Pandora Best",~~ |
  | 216 |  | ~~//                            "manage\_capability" => 1,~~ |
  | 217 |  | ~~//                            "create\_capability" => 1,~~ |
  | 218 |  | ~~//                            "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 219 |  | ~~//                            "github" => "",~~ |
  | 220 |  | ~~//                            "bitbucket" => ""~~ |
  | 221 |  | ~~//                        ]~~ |
  | 222 |  | ~~//                    ],~~ |
  | 223 |  | ~~//                    "updater" => [~~ |
  | 224 |  | ~~//                        "data" => [~~ |
  | 225 |  | ~~//                            "id" => 3,~~ |
  | 226 |  | ~~//                            "username" => "selygyh@email.com",~~ |
  | 227 |  | ~~//                            "nicename" => "selygyhemail-com",~~ |
  | 228 |  | ~~//                            "email" => "vicebeqy@mailinator.com",~~ |
  | 229 |  | ~~//                            "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 230 |  | ~~//                            "display\_name" => "Pandora Best",~~ |
  | 231 |  | ~~//                            "manage\_capability" => 1,~~ |
  | 232 |  | ~~//                            "create\_capability" => 1,~~ |
  | 233 |  | ~~//                            "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 234 |  | ~~//                            "github" => "",~~ |
  | 235 |  | ~~//                            "bitbucket" => ""~~ |
  | 236 |  | ~~//                        ]~~ |
  | 237 |  | ~~//                    ],~~ |
  | 238 |  | ~~//                    "project" => [~~ |
  | 239 |  | ~~//                        "data" => [~~ |
  | 240 |  | ~~//                            "id" => 6,~~ |
  | 241 |  | ~~//                            "project\_id" => 6,~~ |
  | 242 |  | ~~//                            "title" => "48# - Test Product",~~ |
  | 243 |  | ~~//                            "description" => [~~ |
  | 244 |  | ~~//                                "html" => "",~~ |
  | 245 |  | ~~//                                "content" => ""~~ |
  | 246 |  | ~~//                            ],~~ |
  | 247 |  | ~~//                            "status" => 0,~~ |
  | 248 |  | ~~//                            "budget" => "",~~ |
  | 249 |  | ~~//                            "pay\_rate" => "",~~ |
  | 250 |  | ~~//                            "est\_completion\_date" => "",~~ |
  | 251 |  | ~~//                            "order" => "",~~ |
  | 252 |  | ~~//                            "projectable\_type" => "",~~ |
  | 253 |  | ~~//                            "favourite" => "",~~ |
  | 254 |  | ~~//                            "created\_at" => [~~ |
  | 255 |  | ~~//                                "date" => "2023-08-23",~~ |
  | 256 |  | ~~//                                "time" => "05:26:33",~~ |
  | 257 |  | ~~//                                "datetime" => "2023-08-23 05:26:33",~~ |
  | 258 |  | ~~//                                "timezone" => "Etc/UTC",~~ |
  | 259 |  | ~~//                                "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 260 |  | ~~//                            ],~~ |
  | 261 |  | ~~//                            "updated\_at" => [~~ |
  | 262 |  | ~~//                                "date" => "2023-08-23",~~ |
  | 263 |  | ~~//                                "time" => "05:26:33",~~ |
  | 264 |  | ~~//                                "datetime" => "2023-08-23 05:26:33",~~ |
  | 265 |  | ~~//                                "timezone" => "Etc/UTC",~~ |
  | 266 |  | ~~//                                "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 267 |  | ~~//                            ],~~ |
  | 268 |  | ~~//                            "created\_by" => 3,~~ |
  | 269 |  | ~~//                            "list\_inbox" => 23,~~ |
  | 270 |  | ~~//                            "role\_capabilities" => [~~ |
  | 271 |  | ~~//                                "manager" => [~~ |
  | 272 |  | ~~//                                    "create\_message" => 1,~~ |
  | 273 |  | ~~//                                    "view\_private\_message" => 1,~~ |
  | 274 |  | ~~//                                    "create\_list" => 1,~~ |
  | 275 |  | ~~//                                    "view\_private\_list" => 1,~~ |
  | 276 |  | ~~//                                    "create\_task" => 1,~~ |
  | 277 |  | ~~//                                    "view\_private\_task" => 1,~~ |
  | 278 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 279 |  | ~~//                                    "view\_private\_milestone" => 1,~~ |
  | 280 |  | ~~//                                    "create\_file" => 1,~~ |
  | 281 |  | ~~//                                    "view\_private\_file" => 1~~ |
  | 282 |  | ~~//                                ],~~ |
  | 283 |  | ~~//                                "co\_worker" => [~~ |
  | 284 |  | ~~//                                    "create\_message" => 1,~~ |
  | 285 |  | ~~//                                    "view\_private\_message" => 1,~~ |
  | 286 |  | ~~//                                    "create\_list" => 1,~~ |
  | 287 |  | ~~//                                    "view\_private\_list" => 1,~~ |
  | 288 |  | ~~//                                    "create\_task" => 1,~~ |
  | 289 |  | ~~//                                    "view\_private\_task" => 1,~~ |
  | 290 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 291 |  | ~~//                                    "view\_private\_milestone" => 1,~~ |
  | 292 |  | ~~//                                    "create\_file" => 1,~~ |
  | 293 |  | ~~//                                    "view\_private\_file" => 1~~ |
  | 294 |  | ~~//                                ],~~ |
  | 295 |  | ~~//                                "client" => [~~ |
  | 296 |  | ~~//                                    "create\_message" => 1,~~ |
  | 297 |  | ~~//                                    "view\_private\_message" => "",~~ |
  | 298 |  | ~~//                                    "create\_list" => 1,~~ |
  | 299 |  | ~~//                                    "view\_private\_list" => "",~~ |
  | 300 |  | ~~//                                    "create\_task" => 1,~~ |
  | 301 |  | ~~//                                    "view\_private\_task" => "",~~ |
  | 302 |  | ~~//                                    "create\_milestone" => 1,~~ |
  | 303 |  | ~~//                                    "view\_private\_milestone" => "",~~ |
  | 304 |  | ~~//                                    "create\_file" => 1,~~ |
  | 305 |  | ~~//                                    "view\_private\_file" => ""~~ |
  | 306 |  | ~~//                                ]~~ |
  | 307 |  | ~~//                            ],~~ |
  | 308 |  | ~~//                            "meta" => [~~ |
  | 309 |  | ~~//                                "data" => [~~ |
  | 310 |  | ~~//                                    "total\_task\_lists" => 3,~~ |
  | 311 |  | ~~//                                    "total\_tasks" => 5,~~ |
  | 312 |  | ~~//                                    "total\_complete\_tasks" => 0,~~ |
  | 313 |  | ~~//                                    "total\_incomplete\_tasks" => 5,~~ |
  | 314 |  | ~~//                                    "total\_discussion\_boards" => 0,~~ |
  | 315 |  | ~~//                                    "total\_milestones" => 0,~~ |
  | 316 |  | ~~//                                    "total\_comments" => 0,~~ |
  | 317 |  | ~~//                                    "total\_files" => 0,~~ |
  | 318 |  | ~~//                                    "total\_activities" => 9~~ |
  | 319 |  | ~~//                                ]~~ |
  | 320 |  | ~~//                            ]~~ |
  | 321 |  | ~~//                        ]~~ |
  | 322 |  | ~~//                    ],~~ |
  | 323 |  | ~~//                    "task\_list" => [~~ |
  | 324 |  | ~~//                        "data" => [~~ |
  | 325 |  | ~~//                            "id" => 24,~~ |
  | 326 |  | ~~//                            "title" => "Test Project"~~ |
  | 327 |  | ~~//                        ]~~ |
  | 328 |  | ~~//                    ],~~ |
  | 329 |  | ~~//                    "activities" => [~~ |
  | 330 |  | ~~//                        "data" => [~~ |
  | 331 |  | ~~//                            [~~ |
  | 332 |  | ~~//                                "id" => 74,~~ |
  | 333 |  | ~~//                                "message" => "{{actor.data.display\_name}} has created a task, {{meta.task\_title}}.",~~ |
  | 334 |  | ~~//                                "action" => "create\_task",~~ |
  | 335 |  | ~~//                                "action\_type" => "create",~~ |
  | 336 |  | ~~//                                "project\_id" => 6,~~ |
  | 337 |  | ~~//                                "meta" => [~~ |
  | 338 |  | ~~//                                    "task\_title" => "Project"~~ |
  | 339 |  | ~~//                                ],~~ |
  | 340 |  | ~~//                                "committed\_at" => [~~ |
  | 341 |  | ~~//                                    "date" => "2023-08-23",~~ |
  | 342 |  | ~~//                                    "time" => "05:27:37",~~ |
  | 343 |  | ~~//                                    "datetime" => "2023-08-23 05:27:37",~~ |
  | 344 |  | ~~//                                    "timezone" => "Etc/UTC",~~ |
  | 345 |  | ~~//                                    "timestamp" => "2023-08-23T05:27:37+00:00"~~ |
  | 346 |  | ~~//                                ],~~ |
  | 347 |  | ~~//                                "resource\_id" => 30,~~ |
  | 348 |  | ~~//                                "resource\_type" => "task",~~ |
  | 349 |  | ~~//                                "actor" => [~~ |
  | 350 |  | ~~//                                    "data" => [~~ |
  | 351 |  | ~~//                                        "id" => 3,~~ |
  | 352 |  | ~~//                                        "username" => "selygyh@email.com",~~ |
  | 353 |  | ~~//                                        "nicename" => "selygyhemail-com",~~ |
  | 354 |  | ~~//                                        "email" => "vicebeqy@mailinator.com",~~ |
  | 355 |  | ~~//                                        "profile\_url" => "https://www.zovahoky.ws",~~ |
  | 356 |  | ~~//                                        "display\_name" => "Pandora Best",~~ |
  | 357 |  | ~~//                                        "manage\_capability" => 1,~~ |
  | 358 |  | ~~//                                        "create\_capability" => 1,~~ |
  | 359 |  | ~~//                                        "avatar\_url" => "http://1.gravatar.com/avatar/10537eacc2681ca27cdc42dc1f370c34?s=96&d=mm&r=g",~~ |
  | 360 |  | ~~//                                        "github" => "",~~ |
  | 361 |  | ~~//                                        "bitbucket" => ""~~ |
  | 362 |  | ~~//                                    ]~~ |
  | 363 |  | ~~//                                ],~~ |
  | 364 |  | ~~//                                "project" => [~~ |
  | 365 |  | ~~//                                    "data" => [~~ |
  | 366 |  | ~~//                                        "id" => 6,~~ |
  | 367 |  | ~~//                                        "project\_id" => 6,~~ |
  | 368 |  | ~~//                                        "title" => "48# - Test Product",~~ |
  | 369 |  | ~~//                                        "description" => [~~ |
  | 370 |  | ~~//                                            "html" => "",~~ |
  | 371 |  | ~~//                                            "content" => ""~~ |
  | 372 |  | ~~//                                        ],~~ |
  | 373 |  | ~~//                                        "status" => 0,~~ |
  | 374 |  | ~~//                                        "budget" => "",~~ |
  | 375 |  | ~~//                                        "pay\_rate" => "",~~ |
  | 376 |  | ~~//                                        "est\_completion\_date" => "",~~ |
  | 377 |  | ~~//                                        "order" => "",~~ |
  | 378 |  | ~~//                                        "projectable\_type" => "",~~ |
  | 379 |  | ~~//                                        "favourite" => "",~~ |
  | 380 |  | ~~//                                        "created\_at" => [~~ |
  | 381 |  | ~~//                                            "date" => "2023-08-23",~~ |
  | 382 |  | ~~//                                            "time" => "05:26:33",~~ |
  | 383 |  | ~~//                                            "datetime" => "2023-08-23 05:26:33",~~ |
  | 384 |  | ~~//                                            "timezone" => "Etc/UTC",~~ |
  | 385 |  | ~~//                                            "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 386 |  | ~~//                                        ],~~ |
  | 387 |  | ~~//                                        "updated\_at" => [~~ |
  | 388 |  | ~~//                                            "date" => "2023-08-23",~~ |
  | 389 |  | ~~//                                            "time" => "05:26:33",~~ |
  | 390 |  | ~~//                                            "datetime" => "2023-08-23 05:26:33",~~ |
  | 391 |  | ~~//                                            "timezone" => "Etc/UTC",~~ |
  | 392 |  | ~~//                                            "timestamp" => "2023-08-23T05:26:33+00:00"~~ |
  | 393 |  | ~~//                                        ],~~ |
  | 394 |  | ~~//                                        "created\_by" => 3,~~ |
  | 395 |  | ~~//                                        "list\_inbox" => 23,~~ |
  | 396 |  | ~~//                                        "role\_capabilities" => [~~ |
  | 397 |  | ~~//                                            "manager" => [~~ |
  | 398 |  | ~~//                                                "create\_message" => 1,~~ |
  | 399 |  | ~~//                                                "view\_private\_message" => 1,~~ |
  | 400 |  | ~~//                                                "create\_list" => 1,~~ |
  | 401 |  | ~~//                                                "view\_private\_list" => 1,~~ |
  | 402 |  | ~~//                                                "create\_task" => 1,~~ |
  | 403 |  | ~~//                                                "view\_private\_task" => 1,~~ |
  | 404 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 405 |  | ~~//                                                "view\_private\_milestone" => 1,~~ |
  | 406 |  | ~~//                                                "create\_file" => 1,~~ |
  | 407 |  | ~~//                                                "view\_private\_file" => 1~~ |
  | 408 |  | ~~//                                            ],~~ |
  | 409 |  | ~~//                                            "co\_worker" => [~~ |
  | 410 |  | ~~//                                                "create\_message" => 1,~~ |
  | 411 |  | ~~//                                                "view\_private\_message" => 1,~~ |
  | 412 |  | ~~//                                                "create\_list" => 1,~~ |
  | 413 |  | ~~//                                                "view\_private\_list" => 1,~~ |
  | 414 |  | ~~//                                                "create\_task" => 1,~~ |
  | 415 |  | ~~//                                                "view\_private\_task" => 1,~~ |
  | 416 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 417 |  | ~~//                                                "view\_private\_milestone" => 1,~~ |
  | 418 |  | ~~//                                                "create\_file" => 1,~~ |
  | 419 |  | ~~//                                                "view\_private\_file" => 1~~ |
  | 420 |  | ~~//                                            ],~~ |
  | 421 |  | ~~//                                            "client" => [~~ |
  | 422 |  | ~~//                                                "create\_message" => 1,~~ |
  | 423 |  | ~~//                                                "view\_private\_message" => "",~~ |
  | 424 |  | ~~//                                                "create\_list" => 1,~~ |
  | 425 |  | ~~//                                                "view\_private\_list" => "",~~ |
  | 426 |  | ~~//                                                "create\_task" => 1,~~ |
  | 427 |  | ~~//                                                "view\_private\_task" => "",~~ |
  | 428 |  | ~~//                                                "create\_milestone" => 1,~~ |
  | 429 |  | ~~//                                                "view\_private\_milestone" => "",~~ |
  | 430 |  | ~~//                                                "create\_file" => 1,~~ |
  | 431 |  | ~~//                                                "view\_private\_file" => ""~~ |
  | 432 |  | ~~//                                            ]~~ |
  | 433 |  | ~~//                                        ],~~ |
  | 434 |  | ~~//                                        "meta" => [~~ |
  | 435 |  | ~~//                                            "data" => [~~ |
  | 436 |  | ~~//                                                "total\_task\_lists" => 3,~~ |
  | 437 |  | ~~//                                                "total\_tasks" => 5,~~ |
  | 438 |  | ~~//                                                "total\_complete\_tasks" => 0,~~ |
  | 439 |  | ~~//                                                "total\_incomplete\_tasks" => 5,~~ |
  | 440 |  | ~~//                                                "total\_discussion\_boards" => 0,~~ |
  | 441 |  | ~~//                                                "total\_milestones" => 0,~~ |
  | 442 |  | ~~//                                                "total\_comments" => 0,~~ |
  | 443 |  | ~~//                                                "total\_files" => 0,~~ |
  | 444 |  | ~~//                                                "total\_activities" => 9~~ |
  | 445 |  | ~~//                                            ]~~ |
  | 446 |  | ~~//                                        ]~~ |
  | 447 |  | ~~//                                    ]~~ |
  | 448 |  | ~~//                                ]~~ |
  | 449 |  | ~~//                            ]~~ |
  | 450 |  | ~~//                        ]~~ |
  | 451 |  | ~~//                    ],~~ |
  | 452 |  | ~~//                    "comments" => [~~ |
  | 453 |  | ~~//                        "data" => []~~ |
  | 454 |  | ~~//                    ],~~ |
  | 455 |  | ~~//                    "time" => [~~ |
  | 456 |  | ~~//                        "data" => [],~~ |
  | 457 |  | ~~//                        "all\_data" => [],~~ |
  | 458 |  | ~~//                        "users\_data" => [],~~ |
  | 459 |  | ~~//                        "meta" => [~~ |
  | 460 |  | ~~//                            "running" => "",~~ |
  | 461 |  | ~~//                            "totalTaskTime" => [],~~ |
  | 462 |  | ~~//                            "totalTime" => [~~ |
  | 463 |  | ~~//                                "hour" => "00",~~ |
  | 464 |  | ~~//                                "minute" => "00",~~ |
  | 465 |  | ~~//                                "second" => "00",~~ |
  | 466 |  | ~~//                                "total\_second" => 0~~ |
  | 467 |  | ~~//                            ]~~ |
  | 468 |  | ~~//                        ]~~ |
  | 469 |  | ~~//                    ],~~ |
  | 470 |  | ~~//                    "labels" => [~~ |
  | 471 |  | ~~//                        "data" => []~~ |
  | 472 |  | ~~//                    ],~~ |
  | 473 |  | ~~//                    "project\_id" => 6,~~ |
  | 474 |  | ~~//                    "project\_title" => "48# - Test Product",~~ |
  | 475 |  | ~~//                    "type" => "",~~ |
  | 476 |  | ~~//                    "assignees" => [~~ |
  | 477 |  | ~~//                        "data" => []~~ |
  | 478 |  | ~~//                    ],~~ |
  | 479 |  | ~~//                    "task\_list\_id" => 24,~~ |
  | 480 |  | ~~//                    "task\_list\_title" => "Test Project",~~ |
  | 481 |  | ~~//                    "meta" => [~~ |
  | 482 |  | ~~//                        "total\_comment" => 0,~~ |
  | 483 |  | ~~//                        "can\_complete\_task" => 1,~~ |
  | 484 |  | ~~//                        "total\_files" => 0,~~ |
  | 485 |  | ~~//                        "total\_assignee" => 0,~~ |
  | 486 |  | ~~//                        "privacy" => 0~~ |
  | 487 |  | ~~//                    ]~~ |
  | 488 |  | ~~//                ]~~ |
  | 489 |  | ~~//            ],~~ |
  | 490 |  | ~~//            "meta" => [~~ |
  | 491 |  | ~~//                "total\_tasks" => 1,~~ |
  | 492 |  | ~~//                "total\_page" => 1,~~ |
  | 493 |  | ~~//                "per\_page" => 10~~ |
  | 494 |  | ~~//            ]~~ |
  | 495 |  | ~~//        ];~~ |
  | 496 |  |  |
  | 497 |  | ~~//        error\_log( var\_export( $params, 1 ) );~~ |
  | 498 |  | ~~//        error\_log( var\_export( $response, 1 ) );~~ |
  | 499 | 147 | if ( pm\_is\_single\_query( $params ) ) { |
  | 500 | 148 | return ['data' => $response['data'][0]] ; |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L518) | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=3213295#L166) |  |
  | 518 | 166 | ]; |
  | 519 | 167 |  |
  | 520 |  | ~~// if ( ! is\_array( $tasks ) ) {~~ |
  | 521 |  | ~~//  $response['data'] = $this->fromat\_task( $tasks );~~ |
  | 522 |  | ~~//  $response['meta'] = $this->set\_meta();~~ |
  | 523 |  | ~~//  return $response;~~ |
  | 524 |  | ~~// }~~ |
  | 525 | 168 |  |
  | 526 | 169 | foreach ( $tasks as $key => $task ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L579) | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=3213295#L222) |  |
  | 579 | 222 | ]; |
  | 580 | 223 |  |
  | 581 |  | //       $select\_items = empty( $this->query\_params['select'] ) ? false : $this->query\_params['select']; |
  | 582 |  |  |
  | 583 |  | // if ( $select\_items && ! is\_array( $select\_items ) ) { |
  | 584 |  | //  $select\_items = str\_replace( ' ', '', $select\_items ); |
  | 585 |  | //  $select\_items = explode( ',', $select\_items ); |
  | 586 |  | // } |
  | 587 |  |  |
  | 588 |  | // if ( empty( $select\_items ) ) { |
  | 589 |  | //  $items = $this->set\_with\_items( $items, $task ); |
  | 590 |  | //  $items = $this->set\_fixed\_items( $items, $task ); |
  | 591 |  | //  $items = $this->set\_item\_meta( $items, $task ); |
  | 592 |  |  |
  | 593 |  | //  return $items; |
  | 594 |  | // } |
  | 595 |  |  |
  | 596 |  | // foreach ( $items as $item\_key => $item ) { |
  | 597 |  |  |
  | 598 |  | //  if ( ! in\_array( $item\_key, $select\_items ) ) { |
  | 599 |  | //      unset( $items[$item\_key] ); |
  | 600 |  | //  } |
  | 601 |  | // } |
  |  | 224 |  |
  | 602 | 225 |  |
  | 603 | 226 | $items = $this->set\_with\_items( $items, $task ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=2967341#L637) | […](/browser/wedevs-project-manager/trunk/src/Task/Helper/Task.php?rev=3213295#L260) |  |
  | 637 | 260 | return true; |
  | 638 | 261 | } |
  | 639 |  | //pmpr($task); die(); |
  | 640 |  | $assignees = $task->assignees['data'];~~//pluck( 'assigned\_to' )->all();~~ |
  |  | 262 |  |
  |  | 263 | $assignees = $task->assignees['data']; |
  | 641 | 264 | $assignees = wp\_list\_pluck( $assignees, 'id' ); |
  | 642 | 265 | $in\_array = in\_array( $user\_id, $assignees ); |
* ## [wedevs-project-manager/trunk/src/Task\_List/Controllers/Task\_List\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L46 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L46 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 46 | 46 | $list\_tb                = $wpdb->prefix . 'pm\_boardables'; |
  | 47 | 47 |  |
  | 48 |  | $project\_id             = ~~$request->get\_param( 'project\_id'~~ ); |
  | 49 |  | $per\_page               = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 48 | $project\_id             = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 49 | $per\_page               = intval( $request->get\_param( 'per\_page' ) ); |
  | 50 | 50 | $status                 = $request->get\_param( 'status' ); |
  | 51 | 51 | $list\_id                = $request->get\_param( 'list\_id' ); //must be a array |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L56) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L56) |  |
  | 56 | 56 | $with                   = explode( ',', $with ); |
  | 57 | 57 |  |
  | 58 |  | $page = ~~$request->get\_param( 'page'~~ ); |
  |  | 58 | $page = intval( $request->get\_param( 'page' ) ); |
  | 59 | 59 | $page = $page ? $page : 1; |
  | 60 | 60 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L86) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L86) |  |
  | 86 | 86 | $tb\_boardable = pm\_tb\_prefix() . 'pm\_boardables'; |
  | 87 | 87 | $tb\_meta      = pm\_tb\_prefix() . 'pm\_meta'; |
  | 88 |  | $title       = ~~$request->get\_param( 'title'~~ ); |
  |  | 88 | $title       = sanitize\_text\_field( $request->get\_param( 'title' ) ); |
  | 89 | 89 | $is\_archive  = $request->get\_param( 'is\_archive' ); |
  | 90 | 90 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L228) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L228) |  |
  | 228 | 228 |  |
  | 229 | 229 | public function listInbox ( WP\_REST\_Request $request ) { |
  | 230 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 230 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 231 | 231 | $tasks = Task::parent()->doesnthave('boardables')->where('project\_id', $project\_id)->get(); |
  | 232 | 232 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L238) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L238) |  |
  | 238 | 238 |  |
  | 239 | 239 | public function show( WP\_REST\_Request $request ) { |
  | 240 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 241 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 240 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 241 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 242 | 242 | $with         = $request->get\_param( 'with' ); |
  | 243 | 243 |  |
  | 244 | 244 | return $this->get\_list( [ |
  | 245 |  | 'project\_id'   => $~~request->get\_param( 'project\_id' )~~, |
  | 246 |  | 'task\_list\_id' => $~~request->get\_param( 'task\_list\_id' )~~, |
  |  | 245 | 'project\_id'   => $project\_id, |
  |  | 246 | 'task\_list\_id' => $task\_list\_id, |
  | 247 | 247 | 'with'         => $request->get\_param( 'with' ) |
  | 248 | 248 | ] ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L291) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L291) |  |
  | 291 | 291 | return $list; |
  | 292 | 292 | } |
  | 293 |  |  |
  | 294 |  | ~~//updated query but not filter updated~~ |
  | 295 |  | ~~// public function get\_list( $params ) {~~ |
  | 296 |  |  |
  | 297 |  | ~~//     $project\_id   = $params['project\_id'];~~ |
  | 298 |  | ~~//     $task\_list\_id = $params['task\_list\_id'];~~ |
  | 299 |  | ~~//     $with         = empty( $params['with'] ) ? [] : $params['with'];~~ |
  | 300 |  | ~~//     $with         = pm\_get\_prepare\_data( $with );~~ |
  | 301 |  |  |
  | 302 |  | ~~//     $list = pm\_get\_task\_lists([~~ |
  | 303 |  | ~~//         'id'         => $task\_list\_id,~~ |
  | 304 |  | ~~//         'project\_id' => $project\_id,~~ |
  | 305 |  | ~~//         'with'       => $with~~ |
  | 306 |  | ~~//     ]);~~ |
  | 307 |  |  |
  | 308 |  | ~~//     $list\_id = [$task\_list\_id];~~ |
  | 309 |  |  |
  | 310 |  | ~~//     if ( in\_array( 'incomplete\_tasks', $with ) ) {~~ |
  | 311 |  | ~~//         $incomplete\_task\_ids = ( new Task\_Controller )->get\_incomplete\_task\_ids( $list\_id, $project\_id );~~ |
  | 312 |  | ~~//         $incomplete\_tasks    = pm\_get\_tasks( [ 'id' => $incomplete\_task\_ids ] );~~ |
  | 313 |  |  |
  | 314 |  | ~~//         $list['data']['incomplete\_tasks']['data'] = $incomplete\_tasks['data'];~~ |
  | 315 |  | ~~//         $list['data']['incomplete\_tasks']['meta'] = $incomplete\_tasks['meta'];~~ |
  | 316 |  | ~~//     }~~ |
  | 317 |  |  |
  | 318 |  | ~~//     if ( in\_array( 'complete\_tasks', $with ) ) {~~ |
  | 319 |  | ~~//         $complete\_task\_ids = ( new Task\_Controller )->get\_complete\_task\_ids( $list\_id, $project\_id );~~ |
  | 320 |  | ~~//         $complete\_tasks    = pm\_get\_tasks( [ 'id' => $complete\_task\_ids ] );~~ |
  | 321 |  |  |
  | 322 |  | ~~//         $list['data']['complete\_tasks']['data'] = $complete\_tasks['data'];~~ |
  | 323 |  | ~~//         $list['data']['complete\_tasks']['meta'] = $complete\_tasks['meta'];~~ |
  | 324 |  | ~~//     }~~ |
  | 325 |  |  |
  | 326 |  | ~~//     return $list;~~ |
  | 327 |  | ~~// }~~ |
  | 328 | 293 |  |
  | 329 | 294 | public static function create\_tasklist( $data ) { |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L357) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L322) |  |
  | 357 | 322 | public function store( WP\_REST\_Request $request ) { |
  | 358 | 323 | $data               = $this->extract\_non\_empty\_values( $request ); |
  | 359 |  | $milestone\_id       = ~~$request->get\_param( 'milestone'~~ ); |
  | 360 |  | $project\_id         = ~~$request->get\_param( 'project\_id'~~ ); |
  | 361 |  | $is\_private         = ~~$request->get\_param( 'privacy'~~ ); |
  |  | 324 | $milestone\_id       = sanitize\_text\_field( $request->get\_param( 'milestone' ) ); |
  |  | 325 | $project\_id         = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 326 | $is\_private         = sanitize\_text\_field($request->get\_param( 'privacy' ) ); |
  | 362 | 327 | $data['is\_private'] = $is\_private == 'true' || $is\_private === true ? 1 : 0; |
  | 363 | 328 |  |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L386) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L351) |  |
  | 386 | 351 | $data = $this->extract\_non\_empty\_values( $request ); |
  | 387 | 352 |  |
  | 388 |  | $project\_id          = ~~$request->get\_param( 'project\_id'~~ ); |
  | 389 |  | $task\_list\_id        = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 353 | $project\_id          = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 354 | $task\_list\_id        = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 390 | 355 | $milestone\_id        = $request->get\_param( 'milestone' ); |
  | 391 | 356 | $data['description'] = $request->get\_param('description'); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L447) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L412) |  |
  | 447 | 412 | public function destroy( WP\_REST\_Request $request ) { |
  | 448 | 413 | // Grab user inputs |
  | 449 |  | $project\_id   = ~~$request->get\_param( 'project\_id'~~ ); |
  | 450 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 414 | $project\_id   = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 415 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 451 | 416 |  |
  | 452 | 417 | // Select the task list to be deleted |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L516) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L481) |  |
  | 516 | 481 |  |
  | 517 | 482 | public function attach\_users( WP\_REST\_Request $request ) { |
  | 518 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 519 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 483 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 484 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 520 | 485 |  |
  | 521 | 486 | $task\_list = Task\_List::where( 'id', $task\_list\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L543) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L508) |  |
  | 543 | 508 |  |
  | 544 | 509 | public function detach\_users( WP\_REST\_Request $request ) { |
  | 545 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 546 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 510 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 511 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 547 | 512 |  |
  | 548 | 513 | $task\_list = Task\_List::where( 'id', $task\_list\_id ) |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L550) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L515) |  |
  | 550 | 515 | ->first(); |
  | 551 | 516 |  |
  | 552 |  | $user\_ids = ~~explode( ',', $request->get\_param( 'users'~~ ) ); |
  |  | 517 | $user\_ids = array\_map( 'intval', explode( ',', $request->get\_param( 'users' ) ) ); |
  | 553 | 518 |  |
  | 554 | 519 | $task\_list->users()->whereIn( 'boardable\_id', $user\_ids )->delete(); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L560) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L525) |  |
  | 560 | 525 |  |
  | 561 | 526 | public function privacy( WP\_REST\_Request $request ) { |
  | 562 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  | 563 |  | $task\_list\_id = ~~$request->get\_param( 'task\_list\_id'~~ ); |
  |  | 527 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 528 | $task\_list\_id = intval( $request->get\_param( 'task\_list\_id' ) ); |
  | 564 | 529 | $privacy = $request->get\_param( 'is\_private' ); |
  | 565 | 530 | pm\_update\_meta( $task\_list\_id, $project\_id, 'task\_list', 'privacy', $privacy ); |
  | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3206717#L591) | […](/browser/wedevs-project-manager/trunk/src/Task_List/Controllers/Task_List_Controller.php?rev=3213295#L556) |  |
  | 591 | 556 | public function list\_search( WP\_REST\_Request $request ) { |
  | 592 | 557 |  |
  | 593 |  | $project\_id  = ~~$request->get\_param( 'project\_id'~~ ); |
  | 594 |  | $title       = ~~$request->get\_param( 'title' );~~ |
  |  | 558 | $project\_id  = intval( $request->get\_param( 'project\_id' ) ); |
  |  | 559 | $title       = sanitize\_text\_field( $request->get\_param( 'title' ) ); |
  | 595 | 560 | $is\_archive  = $request->get\_param( 'is\_archive' ); |
  | 596 | 561 |  |
* ## [wedevs-project-manager/trunk/src/User/Controllers/User\_Controller.php](/changeset/3213295/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php")

  | [r3033466](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L22 "Show revision 3033466 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3213295#L22 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 |  |
  | 23 | 23 | public function index( WP\_REST\_Request $request ) { |
  | 24 |  | $id    = ~~$request->get\_param( 'id'~~ ); |
  | 25 |  |  |
  | 26 |  | $per\_page   = ~~$request->get\_param( 'per\_page'~~ ); |
  |  | 24 | $id    = intval( $request->get\_param( 'id' ) ); |
  |  | 25 |  |
  |  | 26 | $per\_page   = intval( $request->get\_param( 'per\_page' ) ); |
  | 27 | 27 | $per\_page   = $per\_page ? $per\_page : 15; |
  | 28 | 28 |  |
  | 29 |  | $page       = ~~$request->get\_param( 'page'~~ ); |
  |  | 29 | $page       = intval( $request->get\_param( 'page' ) ); |
  | 30 | 30 | $page       = $page ? $page : 1; |
  | 31 | 31 |  |
  | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L49) | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3213295#L49) |  |
  | 49 | 49 |  |
  | 50 | 50 | public function show( WP\_REST\_Request $request ) { |
  | 51 |  | $id       = ~~$request->get\_param( 'id'~~ ); |
  |  | 51 | $id       = intval( $request->get\_param( 'id' ) ); |
  | 52 | 52 | $user     = User::find( $id ); |
  | 53 | 53 | $resource = new Item( $user, new User\_Transformer ); |
  | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3033466#L135) | […](/browser/wedevs-project-manager/trunk/src/User/Controllers/User_Controller.php?rev=3213295#L135) |  |
  | 135 | 135 | // Extract user inputs |
  | 136 | 136 | $id         = $request->get\_param( 'user\_id' ); |
  | 137 |  | $project\_id = ~~$request->get\_param( 'project\_id'~~ ); |
  |  | 137 | $project\_id = intval( $request->get\_param( 'project\_id' ) ); |
  | 138 | 138 | $role\_ids   = $request->get\_param( 'role\_ids' ); |
  | 139 | 139 | $role\_ids   = explode( ',', $role\_ids ); |
* ## [wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS](/changeset/3213295/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3206717#L1 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/.github/CODEOWNERS?rev=3213295#L1 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | \* @deliciousbrains/deli-eng |
  | 2 | 2 |  |
  | 3 |  | #jira:~~[18802]~~ is where issues related to this repository should be ticketed] |
  |  | 3 | #jira:DELI is where issues related to this repository should be ticketed] |
* ## [wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile](/changeset/3213295/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3206717#L16 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/Makefile?rev=3213295#L16 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 16 | 16 | clean: |
  | 17 | 17 | rm -rf vendor |
  | 18 |  | rm -f tests/.phpunit.result.cache |
  |  | 18 | rm -f tests/.phpunit.result.cache .phpunit.result.cache |
* ## [wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php](/changeset/3213295/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php")

  | [r3061130](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3061130#L102 "Show revision 3061130 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295#L102 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 102 | 102 |  |
  | 103 | 103 | /\*\* |
  | 104 |  | \* Filters the ~~post~~ arguments used during an async request. |
  | 105 |  | \* |
  | 106 |  | \* @param array $~~url~~ |
  |  | 104 | \* Filters the query arguments used during an async request. |
  |  | 105 | \* |
  |  | 106 | \* @param array $args |
  | 107 | 107 | \*/ |
  | 108 | 108 | return apply\_filters( $this->identifier . '\_query\_args', $args ); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3061130#L122) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-async-request.php?rev=3213295#L122) |  |
  | 122 | 122 |  |
  | 123 | 123 | /\*\* |
  | 124 |  | \* Filters the ~~post arguments~~ used during an async request. |
  |  | 124 | \* Filters the query URL used during an async request. |
  | 125 | 125 | \* |
  | 126 | 126 | \* @param string $url |
* ## [wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php](/changeset/3213295/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php")

  | [r3061130](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L13 "Show revision 3061130 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L13 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | \*/ |
  | 14 | 14 | abstract class WP\_Background\_Process extends WP\_Async\_Request { |
  |  | 15 | /\*\* |
  |  | 16 | \* The default query arg name used for passing the chain ID to new processes. |
  |  | 17 | \*/ |
  |  | 18 | const CHAIN\_ID\_ARG\_NAME = 'chain\_id'; |
  |  | 19 |  |
  |  | 20 | /\*\* |
  |  | 21 | \* Unique background process chain ID. |
  |  | 22 | \* |
  |  | 23 | \* @var string |
  |  | 24 | \*/ |
  |  | 25 | private $chain\_id; |
  | 15 | 26 |  |
  | 16 | 27 | /\*\* |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L98) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L109) |  |
  | 98 | 109 | add\_action( $this->cron\_hook\_identifier, array( $this, 'handle\_cron\_healthcheck' ) ); |
  | 99 | 110 | add\_filter( 'cron\_schedules', array( $this, 'schedule\_cron\_healthcheck' ) ); |
  |  | 111 |  |
  |  | 112 | // Ensure dispatch query args included extra data. |
  |  | 113 | add\_filter( $this->identifier . '\_query\_args', array( $this, 'filter\_dispatch\_query\_args' ) ); |
  | 100 | 114 | } |
  | 101 | 115 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L112) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L126) |  |
  | 112 | 126 | } |
  | 113 | 127 |  |
  |  | 128 | /\*\* |
  |  | 129 | \* Filter fired before background process dispatches its next process. |
  |  | 130 | \* |
  |  | 131 | \* @param bool   $cancel   Should the dispatch be cancelled? Default false. |
  |  | 132 | \* @param string $chain\_id The background process chain ID. |
  |  | 133 | \*/ |
  |  | 134 | $cancel = apply\_filters( $this->identifier . '\_pre\_dispatch', false, $this->get\_chain\_id() ); |
  |  | 135 |  |
  |  | 136 | if ( $cancel ) { |
  |  | 137 | return false; |
  |  | 138 | } |
  |  | 139 |  |
  | 114 | 140 | // Schedule the cron healthcheck. |
  | 115 | 141 | $this->schedule\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L212) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L238) |  |
  | 212 | 238 | \*/ |
  | 213 | 239 | public function is\_cancelled() { |
  | 214 |  | $status = get\_site\_option( $this->get\_status\_key(), 0 ); |
  | 215 |  |  |
  | 216 |  | return absint( $status ) === self::STATUS\_CANCELLED; |
  |  | 240 | return $this->get\_status() === self::STATUS\_CANCELLED; |
  | 217 | 241 | } |
  | 218 | 242 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L221) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L245) |  |
  | 221 | 245 | \*/ |
  | 222 | 246 | protected function cancelled() { |
  | 223 |  | do\_action( $this->identifier . '\_cancelled' ); |
  |  | 247 | do\_action( $this->identifier . '\_cancelled', $this->get\_chain\_id() ); |
  | 224 | 248 | } |
  | 225 | 249 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L232) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L256) |  |
  | 232 | 256 |  |
  | 233 | 257 | /\*\* |
  | 234 |  | \* ~~Is the job~~ paused? |
  |  | 258 | \* Has the process been paused? |
  | 235 | 259 | \* |
  | 236 | 260 | \* @return bool |
  | 237 | 261 | \*/ |
  | 238 | 262 | public function is\_paused() { |
  | 239 |  | $status = get\_site\_option( $this->get\_status\_key(), 0 ); |
  | 240 |  |  |
  | 241 |  | return absint( $status ) === self::STATUS\_PAUSED; |
  |  | 263 | return $this->get\_status() === self::STATUS\_PAUSED; |
  | 242 | 264 | } |
  | 243 | 265 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L246) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L268) |  |
  | 246 | 268 | \*/ |
  | 247 | 269 | protected function paused() { |
  | 248 |  | do\_action( $this->identifier . '\_paused' ); |
  |  | 270 | do\_action( $this->identifier . '\_paused', $this->get\_chain\_id() ); |
  | 249 | 271 | } |
  | 250 | 272 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L264) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L286) |  |
  | 264 | 286 | \*/ |
  | 265 | 287 | protected function resumed() { |
  | 266 |  | do\_action( $this->identifier . '\_resumed' ); |
  |  | 288 | do\_action( $this->identifier . '\_resumed', $this->get\_chain\_id() ); |
  | 267 | 289 | } |
  | 268 | 290 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L313) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L335) |  |
  | 313 | 335 |  |
  | 314 | 336 | /\*\* |
  |  | 337 | \* Get the status value for the process. |
  |  | 338 | \* |
  |  | 339 | \* @return int |
  |  | 340 | \*/ |
  |  | 341 | protected function get\_status() { |
  |  | 342 | global $wpdb; |
  |  | 343 |  |
  |  | 344 | if ( is\_multisite() ) { |
  |  | 345 | $status = $wpdb->get\_var( |
  |  | 346 | $wpdb->prepare( |
  |  | 347 | "SELECT meta\_value FROM $wpdb->sitemeta WHERE meta\_key = %s AND site\_id = %d LIMIT 1", |
  |  | 348 | $this->get\_status\_key(), |
  |  | 349 | get\_current\_network\_id() |
  |  | 350 | ) |
  |  | 351 | ); |
  |  | 352 | } else { |
  |  | 353 | $status = $wpdb->get\_var( |
  |  | 354 | $wpdb->prepare( |
  |  | 355 | "SELECT option\_value FROM $wpdb->options WHERE option\_name = %s LIMIT 1", |
  |  | 356 | $this->get\_status\_key() |
  |  | 357 | ) |
  |  | 358 | ); |
  |  | 359 | } |
  |  | 360 |  |
  |  | 361 | return absint( $status ); |
  |  | 362 | } |
  |  | 363 |  |
  |  | 364 | /\*\* |
  | 315 | 365 | \* Maybe process a batch of queued items. |
  | 316 | 366 | \* |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L322) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L372) |  |
  | 322 | 372 | session\_write\_close(); |
  | 323 | 373 |  |
  |  | 374 | check\_ajax\_referer( $this->identifier, 'nonce' ); |
  |  | 375 |  |
  |  | 376 | // Background process already running. |
  | 324 | 377 | if ( $this->is\_processing() ) { |
  | 325 |  | ~~// Background process already running.~~ |
  | 326 | 378 | return $this->maybe\_wp\_die(); |
  | 327 | 379 | } |
  | 328 | 380 |  |
  |  | 381 | // Cancel requested. |
  | 329 | 382 | if ( $this->is\_cancelled() ) { |
  | 330 | 383 | $this->clear\_scheduled\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L334) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L387) |  |
  | 334 | 387 | } |
  | 335 | 388 |  |
  |  | 389 | // Pause requested. |
  | 336 | 390 | if ( $this->is\_paused() ) { |
  | 337 | 391 | $this->clear\_scheduled\_event(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L341) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L395) |  |
  | 341 | 395 | } |
  | 342 | 396 |  |
  |  | 397 | // No data to process. |
  | 343 | 398 | if ( $this->is\_queue\_empty() ) { |
  | 344 |  | ~~// No data to process.~~ |
  | 345 | 399 | return $this->maybe\_wp\_die(); |
  | 346 | 400 | } |
  | 347 |  |  |
  | 348 |  | ~~check\_ajax\_referer( $this->identifier, 'nonce' );~~ |
  | 349 | 401 |  |
  | 350 | 402 | $this->handle(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L397) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L449) |  |
  | 397 | 449 | \* Override if applicable, but the duration should be greater than that |
  | 398 | 450 | \* defined in the time\_exceeded() method. |
  | 399 |  | \*/ |
  | 400 |  | protected function lock\_process() { |
  | 401 |  | $this->start\_time = time(); // Set start time of current process. |
  |  | 451 | \* |
  |  | 452 | \* @param bool $reset\_start\_time Optional, default true. |
  |  | 453 | \*/ |
  |  | 454 | public function lock\_process( $reset\_start\_time = true ) { |
  |  | 455 | if ( $reset\_start\_time ) { |
  |  | 456 | $this->start\_time = time(); // Set start time of current process. |
  |  | 457 | } |
  | 402 | 458 |  |
  | 403 | 459 | $lock\_duration = ( property\_exists( $this, 'queue\_lock\_time' ) ) ? $this->queue\_lock\_time : 60; // 1 minute |
  | 404 | 460 | $lock\_duration = apply\_filters( $this->identifier . '\_queue\_lock\_time', $lock\_duration ); |
  | 405 | 461 |  |
  | 406 |  | set\_site\_transient( $this->identifier . '\_process\_lock', microtime(), $lock\_duration ); |
  |  | 462 | $microtime = microtime(); |
  |  | 463 | $locked    = set\_site\_transient( $this->identifier . '\_process\_lock', $microtime, $lock\_duration ); |
  |  | 464 |  |
  |  | 465 | /\*\* |
  |  | 466 | \* Action to note whether the background process managed to create its lock. |
  |  | 467 | \* |
  |  | 468 | \* The lock is used to signify that a process is running a task and no other |
  |  | 469 | \* process should be allowed to run the same task until the lock is released. |
  |  | 470 | \* |
  |  | 471 | \* @param bool   $locked        Whether the lock was successfully created. |
  |  | 472 | \* @param string $microtime     Microtime string value used for the lock. |
  |  | 473 | \* @param int    $lock\_duration Max number of seconds that the lock will live for. |
  |  | 474 | \* @param string $chain\_id      Current background process chain ID. |
  |  | 475 | \*/ |
  |  | 476 | do\_action( |
  |  | 477 | $this->identifier . '\_process\_locked', |
  |  | 478 | $locked, |
  |  | 479 | $microtime, |
  |  | 480 | $lock\_duration, |
  |  | 481 | $this->get\_chain\_id() |
  |  | 482 | ); |
  | 407 | 483 | } |
  | 408 | 484 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L415) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L491) |  |
  | 415 | 491 | \*/ |
  | 416 | 492 | protected function unlock\_process() { |
  | 417 |  | delete\_site\_transient( $this->identifier . '\_process\_lock' ); |
  |  | 493 | $unlocked = delete\_site\_transient( $this->identifier . '\_process\_lock' ); |
  |  | 494 |  |
  |  | 495 | /\*\* |
  |  | 496 | \* Action to note whether the background process managed to release its lock. |
  |  | 497 | \* |
  |  | 498 | \* The lock is used to signify that a process is running a task and no other |
  |  | 499 | \* process should be allowed to run the same task until the lock is released. |
  |  | 500 | \* |
  |  | 501 | \* @param bool   $unlocked Whether the lock was released. |
  |  | 502 | \* @param string $chain\_id Current background process chain ID. |
  |  | 503 | \*/ |
  |  | 504 | do\_action( $this->identifier . '\_process\_unlocked', $unlocked, $this->get\_chain\_id() ); |
  | 418 | 505 |  |
  | 419 | 506 | return $this; |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L478) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L565) |  |
  | 478 | 565 | } |
  | 479 | 566 |  |
  | 480 |  | $items = $wpdb->get\_results( $wpdb->prepare( $sql, $args ) ); // phpcs:ignore WordPress.DB.PreparedSQL.NotPrepared |
  |  | 567 | $items = $wpdb->get\_results( |
  |  | 568 | $wpdb->prepare( |
  |  | 569 | $sql, // phpcs:ignore WordPress.DB.PreparedSQL.NotPrepared |
  |  | 570 | $args |
  |  | 571 | ) |
  |  | 572 | ); |
  | 481 | 573 |  |
  | 482 | 574 | $batches = array(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L545) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L637) |  |
  | 545 | 637 | sleep( $throttle\_seconds ); |
  | 546 | 638 |  |
  | 547 |  | // Batch limits reached, or pause or cancel request. |
  | 548 |  | if ( ~~$this->time\_exceeded() || $this->memory\_exceeded() || $this->is\_paused() || $this->is\_cancelled~~() ) { |
  |  | 639 | // Batch limits reached, or pause or cancel requested. |
  |  | 640 | if ( ! $this->should\_continue() ) { |
  | 549 | 641 | break; |
  | 550 | 642 | } |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L555) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L647) |  |
  | 555 | 647 | $this->delete( $batch->key ); |
  | 556 | 648 | } |
  | 557 |  | } while ( ! $this->~~time\_exceeded() && ! $this->memory\_exceeded() && ! $this->is\_queue\_empty() && ! $this->is\_paused() && ! $this->is\_cancelled~~() ); |
  |  | 649 | } while ( ! $this->is\_queue\_empty() && $this->should\_continue() ); |
  | 558 | 650 |  |
  | 559 | 651 | $this->unlock\_process(); |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L648) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L740) |  |
  | 648 | 740 | \*/ |
  | 649 | 741 | protected function completed() { |
  | 650 |  | do\_action( $this->identifier . '\_completed' ); |
  |  | 742 | do\_action( $this->identifier . '\_completed', $this->get\_chain\_id() ); |
  | 651 | 743 | } |
  | 652 | 744 |  |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L723) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L815) |  |
  | 723 | 815 | protected function schedule\_event() { |
  | 724 | 816 | if ( ! wp\_next\_scheduled( $this->cron\_hook\_identifier ) ) { |
  | 725 |  | wp\_schedule\_event( time() + ( $this->get\_cron\_interval() \* MINUTE\_IN\_SECONDS ), $this->cron\_interval\_identifier, $this->cron\_hook\_identifier ); |
  |  | 817 | wp\_schedule\_event( |
  |  | 818 | time() + ( $this->get\_cron\_interval() \* MINUTE\_IN\_SECONDS ), |
  |  | 819 | $this->cron\_interval\_identifier, |
  |  | 820 | $this->cron\_hook\_identifier |
  |  | 821 | ); |
  | 726 | 822 | } |
  | 727 | 823 | } |
  | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3061130#L784) | […](/browser/wedevs-project-manager/trunk/vendor/a5hleyrich/wp-background-processing/classes/wp-background-process.php?rev=3213295#L880) |  |
  | 784 | 880 | return $data; |
  | 785 | 881 | } |
  |  | 882 |  |
  |  | 883 | /\*\* |
  |  | 884 | \* Should any processing continue? |
  |  | 885 | \* |
  |  | 886 | \* @return bool |
  |  | 887 | \*/ |
  |  | 888 | public function should\_continue() { |
  |  | 889 | /\*\* |
  |  | 890 | \* Filter whether the current background process should continue running the task |
  |  | 891 | \* if there is data to be processed. |
  |  | 892 | \* |
  |  | 893 | \* If the processing time or memory limits have been exceeded, the value will be false. |
  |  | 894 | \* If pause or cancel have been requested, the value will be false. |
  |  | 895 | \* |
  |  | 896 | \* It is very unlikely that you would want to override a false value with true. |
  |  | 897 | \* |
  |  | 898 | \* If false is returned here, it does not necessarily mean background processing is |
  |  | 899 | \* complete. If there is batch data still to be processed and pause or cancel have not |
  |  | 900 | \* been requested, it simply means this background process should spawn a new process |
  |  | 901 | \* for the chain to continue processing and then close itself down. |
  |  | 902 | \* |
  |  | 903 | \* @param bool   $continue Should the current process continue processing the task? |
  |  | 904 | \* @param string $chain\_id The current background process chain's ID. |
  |  | 905 | \* |
  |  | 906 | \* @return bool |
  |  | 907 | \*/ |
  |  | 908 | return apply\_filters( |
  |  | 909 | $this->identifier . '\_should\_continue', |
  |  | 910 | ! ( $this->time\_exceeded() || $this->memory\_exceeded() || $this->is\_paused() || $this->is\_cancelled() ), |
  |  | 911 | $this->get\_chain\_id() |
  |  | 912 | ); |
  |  | 913 | } |
  |  | 914 |  |
  |  | 915 | /\*\* |
  |  | 916 | \* Get the string used to identify this type of background process. |
  |  | 917 | \* |
  |  | 918 | \* @return string |
  |  | 919 | \*/ |
  |  | 920 | public function get\_identifier() { |
  |  | 921 | return $this->identifier; |
  |  | 922 | } |
  |  | 923 |  |
  |  | 924 | /\*\* |
  |  | 925 | \* Return the current background process chain's ID. |
  |  | 926 | \* |
  |  | 927 | \* If the chain's ID hasn't been set before this function is first used, |
  |  | 928 | \* and hasn't been passed as a query arg during dispatch, |
  |  | 929 | \* the chain ID will be generated before being returned. |
  |  | 930 | \* |
  |  | 931 | \* @return string |
  |  | 932 | \*/ |
  |  | 933 | public function get\_chain\_id() { |
  |  | 934 | if ( empty( $this->chain\_id ) && wp\_doing\_ajax() ) { |
  |  | 935 | check\_ajax\_referer( $this->identifier, 'nonce' ); |
  |  | 936 |  |
  |  | 937 | if ( ! empty( $\_GET[ $this->get\_chain\_id\_arg\_name() ] ) ) { |
  |  | 938 | $chain\_id = sanitize\_key( $\_GET[ $this->get\_chain\_id\_arg\_name() ] ); |
  |  | 939 |  |
  |  | 940 | if ( wp\_is\_uuid( $chain\_id ) ) { |
  |  | 941 | $this->chain\_id = $chain\_id; |
  |  | 942 |  |
  |  | 943 | return $this->chain\_id; |
  |  | 944 | } |
  |  | 945 | } |
  |  | 946 | } |
  |  | 947 |  |
  |  | 948 | if ( empty( $this->chain\_id ) ) { |
  |  | 949 | $this->chain\_id = wp\_generate\_uuid4(); |
  |  | 950 | } |
  |  | 951 |  |
  |  | 952 | return $this->chain\_id; |
  |  | 953 | } |
  |  | 954 |  |
  |  | 955 | /\*\* |
  |  | 956 | \* Filters the query arguments used during an async request. |
  |  | 957 | \* |
  |  | 958 | \* @param array $args Current query args. |
  |  | 959 | \* |
  |  | 960 | \* @return array |
  |  | 961 | \*/ |
  |  | 962 | public function filter\_dispatch\_query\_args( $args ) { |
  |  | 963 | $args[ $this->get\_chain\_id\_arg\_name() ] = $this->get\_chain\_id(); |
  |  | 964 |  |
  |  | 965 | return $args; |
  |  | 966 | } |
  |  | 967 |  |
  |  | 968 | /\*\* |
  |  | 969 | \* Get the query arg name used for passing the chain ID to new processes. |
  |  | 970 | \* |
  |  | 971 | \* @return string |
  |  | 972 | \*/ |
  |  | 973 | private function get\_chain\_id\_arg\_name() { |
  |  | 974 | static $chain\_id\_arg\_name; |
  |  | 975 |  |
  |  | 976 | if ( ! empty( $chain\_id\_arg\_name ) ) { |
  |  | 977 | return $chain\_id\_arg\_name; |
  |  | 978 | } |
  |  | 979 |  |
  |  | 980 | /\*\* |
  |  | 981 | \* Filter the query arg name used for passing the chain ID to new processes. |
  |  | 982 | \* |
  |  | 983 | \* If you encounter problems with using the default query arg name, you can |
  |  | 984 | \* change it with this filter. |
  |  | 985 | \* |
  |  | 986 | \* @param string $chain\_id\_arg\_name Default "chain\_id". |
  |  | 987 | \* |
  |  | 988 | \* @return string |
  |  | 989 | \*/ |
  |  | 990 | $chain\_id\_arg\_name = apply\_filters( $this->identifier . '\_chain\_id\_arg\_name', self::CHAIN\_ID\_ARG\_NAME ); |
  |  | 991 |  |
  |  | 992 | if ( ! is\_string( $chain\_id\_arg\_name ) || empty( $chain\_id\_arg\_name ) ) { |
  |  | 993 | $chain\_id\_arg\_name = self::CHAIN\_ID\_ARG\_NAME; |
  |  | 994 | } |
  |  | 995 |  |
  |  | 996 | return $chain\_id\_arg\_name; |
  |  | 997 | } |
  | 786 | 998 | } |
* ## [wedevs-project-manager/trunk/vendor/composer/installed.json](/changeset/3213295/wedevs-project-manager/trunk/vendor/composer/installed.json "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/composer/installed.json")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L3 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295#L3 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | { |
  | 4 | 4 | "name": "a5hleyrich/wp-background-processing", |
  | 5 |  | "version": "1.~~3.1~~", |
  | 6 |  | "version\_normalized": "1.~~3.1~~.0", |
  |  | 5 | "version": "1.4.0", |
  |  | 6 | "version\_normalized": "1.4.0.0", |
  | 7 | 7 | "source": { |
  | 8 | 8 | "type": "git", |
  | 9 | 9 | "url": "https://github.com/deliciousbrains/wp-background-processing.git", |
  | 10 |  | "reference": "~~6d1e48165e461260075b9f161b3861c7278f71e7~~" |
  | 11 |  | }, |
  | 12 |  | "dist": { |
  | 13 |  | "type": "zip", |
  | 14 |  | "url": "https://api.github.com/repos/deliciousbrains/wp-background-processing/zipball/~~6d1e48165e461260075b9f161b3861c7278f71e7~~", |
  | 15 |  | "reference": "~~6d1e48165e461260075b9f161b3861c7278f71e7~~", |
  |  | 10 | "reference": "7ca7cc3504333db3a291bbab7f1917124fba4816" |
  |  | 11 | }, |
  |  | 12 | "dist": { |
  |  | 13 | "type": "zip", |
  |  | 14 | "url": "https://api.github.com/repos/deliciousbrains/wp-background-processing/zipball/7ca7cc3504333db3a291bbab7f1917124fba4816", |
  |  | 15 | "reference": "7ca7cc3504333db3a291bbab7f1917124fba4816", |
  | 16 | 16 | "shasum": "" |
  | 17 | 17 | }, |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L29) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295#L29) |  |
  | 29 | 29 | "coenjacobs/mozart": "Easily wrap this library with your own prefix, to prevent collisions when multiple plugins use this library" |
  | 30 | 30 | }, |
  | 31 |  | "time": "2024-~~02-28T13:39:06~~+00:00", |
  |  | 31 | "time": "2024-12-17T14:04:30+00:00", |
  | 32 | 32 | "type": "library", |
  | 33 | 33 | "installation-source": "dist", |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L50) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295#L50) |  |
  | 50 | 50 | "support": { |
  | 51 | 51 | "issues": "https://github.com/deliciousbrains/wp-background-processing/issues", |
  | 52 |  | "source": "https://github.com/deliciousbrains/wp-background-processing/tree/1.~~3.1~~" |
  |  | 52 | "source": "https://github.com/deliciousbrains/wp-background-processing/tree/1.4.0" |
  | 53 | 53 | }, |
  | 54 | 54 | "install-path": "../a5hleyrich/wp-background-processing" |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L810) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295#L810) |  |
  | 810 | 810 | "type": "library", |
  | 811 | 811 | "extra": { |
  | 812 |  | ~~"branch-alias": {~~ |
  | 813 |  | ~~"dev-master": "3.x-dev",~~ |
  | 814 |  | ~~"dev-2.x": "2.x-dev"~~ |
  | 815 |  | ~~},~~ |
  | 816 | 812 | "laravel": { |
  | 817 | 813 | "providers": [ |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3206717#L823) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.json?rev=3213295#L819) |  |
  | 823 | 819 | "extension.neon" |
  | 824 | 820 | ] |
  |  | 821 | }, |
  |  | 822 | "branch-alias": { |
  |  | 823 | "dev-2.x": "2.x-dev", |
  |  | 824 | "dev-master": "3.x-dev" |
  | 825 | 825 | } |
  | 826 | 826 | }, |
* ## [wedevs-project-manager/trunk/vendor/composer/installed.php](/changeset/3213295/wedevs-project-manager/trunk/vendor/composer/installed.php "Show the changeset 3213295 restricted to wedevs-project-manager/trunk/vendor/composer/installed.php")

  | [r3206717](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L2 "Show revision 3206717 of this file in browser") | [r3213295](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3213295#L2 "Show revision 3213295 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'wedevsofficial/wp-project-manager', |
  | 4 |  | 'pretty\_version' => 'v2.6.1~~6~~', |
  | 5 |  | 'version' => '2.6.1~~6~~.0', |
  | 6 |  | 'reference' => '~~aa10bf0db85fa168f8dd53272db03b0e826f519e~~', |
  |  | 4 | 'pretty\_version' => 'v2.6.17', |
  |  | 5 | 'version' => '2.6.17.0', |
  |  | 6 | 'reference' => '797195be849fb8196d032c4d5009c6a4532b0c7b', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L12) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3213295#L12) |  |
  | 12 | 12 | 'versions' => array( |
  | 13 | 13 | 'a5hleyrich/wp-background-processing' => array( |
  | 14 |  | 'pretty\_version' => '1.~~3.1~~', |
  | 15 |  | 'version' => '1.~~3.1~~.0', |
  | 16 |  | 'reference' => '~~6d1e48165e461260075b9f161b3861c7278f71e7~~', |
  |  | 14 | 'pretty\_version' => '1.4.0', |
  |  | 15 | 'version' => '1.4.0.0', |
  |  | 16 | 'reference' => '7ca7cc3504333db3a291bbab7f1917124fba4816', |
  | 17 | 17 | 'type' => 'library', |
  | 18 | 18 | 'install\_path' => \_\_DIR\_\_ . '/../a5hleyrich/wp-background-processing', |
  | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3206717#L233) | […](/browser/wedevs-project-manager/trunk/vendor/composer/installed.php?rev=3213295#L233) |  |
  | 233 | 233 | ), |
  | 234 | 234 | 'wedevsofficial/wp-project-manager' => array( |
  | 235 |  | 'pretty\_version' => 'v2.6.1~~6~~', |
  | 236 |  | 'version' => '2.6.1~~6~~.0', |
  | 237 |  | 'reference' => '~~aa10bf0db85fa168f8dd53272db03b0e826f519e~~', |
  |  | 235 | 'pretty\_version' => 'v2.6.17', |
  |  | 236 | 'version' => '2.6.17.0', |
  |  | 237 | 'reference' => '797195be849fb8196d032c4d5009c6a4532b0c7b', |
  | 238 | 238 | 'type' => 'wordpress-plugin', |
  | 239 | 239 | 'install\_path' => \_\_DIR\_\_ . '/../../', |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3213295)
* [Zip Archive](?format=zip&new=3213295)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_a8d4ecf3_20250115_092226.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP Project Manager – Task, team, and project management plugin featuring kanban board and gantt charts <= 2.6.16 - Authenticated (Subscriber+) SQL Injection

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP Project Manager – Task, team, and project management plugin featuring kanban board and gantt charts <= 2.6.16 - Authenticated (Subscriber+) SQL Injection

6.5

**Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

| CVE | [CVE-2024-12195](https://www.cve.org/CVERecord?id=CVE-2024-12195) |
| --- | --- |
| CVSS | 6.5 (Medium) |
| Publicly Published | January 3, 2025 |
| Last Updated | January 4, 2025 |
| Researcher | [Trương Hữu Phúc (truonghuuphuc)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/phuc-truong-huu) |

### Description

The WP Project Manager – Task, team, and project management plugin featuring kanban board and gantt charts plugin for WordPress is vulnerable to SQL Injection via the 'project\_id' parameter of the /wp-json/pm/v2/projects/2/task-lists REST API endpoint in all versions up to, and including, 2.6.16 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for authenticated attackers, who have been granted access to a project, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wedevs-project-manager/tags/2.6.14/src/Task_List/Controllers/Task_List_Controller.php#L688)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3213295/wedevs-project-manager)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwedevs-project-manager%2Fwp-project-manager-task-team-and-project-management-plugin-featuring-kanban-board-and-gantt-charts-2616-authenticated-subscriber-sql-injection&t=WP%20Project%20Manager%20%E2%80%93%20Task%2C%20team%2C%20and%20project%20management%20plugin%20featuring%20kanban%20board%20and%20gantt%20charts%20%3C%3D%202.6.16%20-%20Authenticated%20%28Subscriber%2B%29%20SQL%20Injection "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwedevs-project-manager%2Fwp-project-manager-task-team-and-project-management-plugin-featuring-kanban-board-and-gantt-charts-2616-authenticated-subscriber-sql-injection&text=WP%20Project%20Manager%20%E2%80%93%20Task%2C%20team%2C%20and%20project%20management%20plugin%20featuring%20kanban%20board%20and%20gantt%20charts%20%3C%3D%202.6.16%20-%20Authenticated%20%28Subscriber%2B%29%20SQL%20Injection "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwedevs-project-manager%2Fwp-project-manager-task-team-and-project-management-plugin-featuring-kanban-board-and-gantt-charts-2616-authenticated-subscriber-sql-injection "LinkedIn")
Email

## Vulnerability Details for WP Project Manager – Task, team, and project management plugin featuring kanban board and gantt charts

#### [WP Project Manager – Task, team, and project management plugin featuring kanban board and gantt charts](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wedevs-project-manager)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wedevs-project-manager [(view on wordpress.org)](https://wordpress.org/plugins/wedevs-project-manager) |
| Patched? | Yes |
| Remediation | Update to version 2.6.17, or a newer patched version |
| Affected Version | * <= 2.6.16 |
| Patched Version | * 2.6.17 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


