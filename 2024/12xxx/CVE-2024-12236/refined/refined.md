- **Root cause of vulnerability:** The Vertex AI API, specifically when handling Gemini multimodal requests, allows the inclusion of media files by specifying their URLs in the `fileUri` parameter. This functionality, intended for legitimate use, can be exploited to bypass VPC Service Controls.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the fact that the `fileUri` parameter does not properly adhere to VPC Service Controls, thus allowing unauthorized access to resources outside the intended perimeter.
- **Impact of exploitation:** An attacker within the service perimeter can encode sensitive data into the `fileUri` parameter. This data can then be exfiltrated bypassing VPC Service Controls, potentially leading to data breaches.
- **Attack vectors:** The attack vector involves using the Vertex AI API with a malicious `fileUri` parameter to initiate the exfiltration.
- **Required attacker capabilities/position:** An attacker needs to be positioned within the service perimeter and needs to be able to access the Vertex AI API. They also need the ability to encode data into a URL.