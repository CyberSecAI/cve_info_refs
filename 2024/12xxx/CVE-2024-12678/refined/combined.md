=== Content from discuss.hashicorp.com_ba93641d_20250114_184152.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[dduzgun-security](https://discuss.hashicorp.com/u/dduzgun-security)

December 20, 2024, 1:47am

1

**Bulletin ID:** HCSEC-2024-29

**Affected Products / Versions:**

Nomad Community Edition from 1.4.0 up to 1.9.3, fixed in 1.9.4.

Nomad Enterprise from 1.4.0 up to 1.9.3, 1.8.7, 1.7.15, fixed in 1.9.4, 1.8.8, and 1.7.16.

**Publication Date:** December 19, 2024

**Summary**

Nomad Community and Nomad Enterprise (“Nomad”) allocations are vulnerable to privilege escalation within a namespace through unredacted workload identity tokens. This vulnerability, identified as CVE-2024-12678, is fixed in Nomad Community Edition 1.9.4 and Nomad Enterprise 1.9.4, 1.8.8, and 1.7.16.

**Background**

Every workload running in Nomad is given a default identity. When an [allocation](https://developer.hashicorp.com/nomad/docs/glossary#allocation) is accepted by the [scheduler](https://developer.hashicorp.com/nomad/docs/concepts/scheduling/scheduling), the leader generates a Workload Identity for each task in the allocation. This workload identity is a [JSON Web Token (JWT)](https://datatracker.ietf.org/doc/html/rfc7519) that has been signed by the leader’s keyring. Additional workload identities may be defined in tasks and services using the [identity](https://developer.hashicorp.com/nomad/docs/job-specification/identity) block.

You can associate additional [ACL policies with workload identities](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity#workload-associated-acl-policies) by passing the `-job`, `-group`, and `-task` flags to nomad acl policy apply. When Nomad resolves a workload identity claim, it will automatically include policies that match. If no matching policies exist, the workload identity does not have any additional capabilities.

**Details**

Accessing HashiCorp Nomad allocations through the [Read Allocation API](https://developer.hashicorp.com/nomad/api-docs/allocations#read-allocation) or [alloc](https://developer.hashicorp.com/nomad/docs/commands/alloc) command includes a [Workload Identity](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity) token which offers access to the workload-associated variables and service discovery. When combined with the [workload associated with ACL policies](https://developer.hashicorp.com/nomad/docs/concepts/workload-identity#workload-associated-acl-policies), a user with `namespace:read` access can potentially escalate privileges and access additional policies for any workload within the namespace.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.9.4, 1.8.8, 1.7.16, or newer.

Please refer to [Upgrading Nomad](https://developer.hashicorp.com/nomad/docs/upgrade) for general guidance and the [Upgrade Guides](https://developer.hashicorp.com/nomad/docs/upgrade/upgrade-specific) for version-specific upgrade notes.

**Acknowledgement**

This issue was identified by HashiCorp‘s Nomad engineering teams.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](https://discuss.hashicorp.com/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5258 | March 13, 2023 |
| [HCSEC-2022-25 - Nomad’s Workload Identity Token Can List Non-sensitive Metadata For nomad/ Paths](https://discuss.hashicorp.com/t/hcsec-2022-25-nomad-s-workload-identity-token-can-list-non-sensitive-metadata-for-nomad-paths/46167)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5917 | October 28, 2022 |
| [HCSEC-2023-09 - Nomad ACLs Can Not Deny Access to Workload's Own Variables](https://discuss.hashicorp.com/t/hcsec-2023-09-nomad-acls-can-not-deny-access-to-workloads-own-variables/51390)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5253 | March 13, 2023 |
| [HCSEC-2024-15 - Nomad Vulnerable to Allocation Directory Path Escape Through Archive Unpacking](https://discuss.hashicorp.com/t/hcsec-2024-15-nomad-vulnerable-to-allocation-directory-path-escape-through-archive-unpacking/68781)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 1032 | July 22, 2024 |
| [HCSEC-2024-17 - Nomad Vulnerable to Allocation Directory Escape On Non-Existing File Paths Through Archive Unpacking](https://discuss.hashicorp.com/t/hcsec-2024-17-nomad-vulnerable-to-allocation-directory-escape-on-non-existing-file-paths-through-archive-unpacking/69293)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 1070 | August 14, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


