=== Content from plugins.trac.wordpress.org_6c617e4a_20250115_081342.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwb-custom-product-tabs-for-woocommerce%2Ftrunk%2Fincludes%2Fclass-wb-custom-product-tabs-for-woocommerce.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php?rev=3178252 "Revision 3178252")
* Next Revision →
* [Blame](/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php)

---

# [source:](/browser?order=name "Go to repository root") [wb-custom-product-tabs-for-woocommerce](/browser/wb-custom-product-tabs-for-woocommerce?order=name "View wb-custom-product-tabs-for-woocommerce")/[trunk](/browser/wb-custom-product-tabs-for-woocommerce/trunk?order=name "View trunk")/[includes](/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes?order=name "View includes")/[class-wb-custom-product-tabs-for-woocommerce.php](/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php?order=name "View class-wb-custom-product-tabs-for-woocommerce.php")

View diff against:

View revision:

| [Last change](/changeset/3213473/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php "View differences") on this file was [3213473](/changeset/3213473/ "View changeset 3213473"), checked in by webbuilder143, [3 weeks ago](/timeline?from=2024-12-26T19%3A52%3A08Z&precision=second "See timeline at 12/26/2024 07:52:08 PM") |
| --- |
| 1.2.5  * Tested with WC 9.5 * [Fix] Security vulnerability fixed. |
| * Property **svn:eol-style** set to   *`native`* | |
| **File size:** 14.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* The file that defines the core plugin class |
| [5](#L5) | \* |
| [6](#L6) | \* A class definition that includes attributes and functions used across both the |
| [7](#L7) | \* public-facing side of the site and the admin area. |
| [8](#L8) | \* |
| [9](#L9) | \* @link       https://profiles.wordpress.org/webbuilder143/ |
| [10](#L10) | \* @since      1.0.0 |
| [11](#L11) | \* |
| [12](#L12) | \* @package    Wb\_Custom\_Product\_Tabs\_For\_Woocommerce |
| [13](#L13) | \* @subpackage Wb\_Custom\_Product\_Tabs\_For\_Woocommerce/includes |
| [14](#L14) | \*/ |
| [15](#L15) |  |
| [16](#L16) | /\*\* |
| [17](#L17) | \* The core plugin class. |
| [18](#L18) | \* |
| [19](#L19) | \* This is used to define internationalization, admin-specific hooks, and |
| [20](#L20) | \* public-facing site hooks. |
| [21](#L21) | \* |
| [22](#L22) | \* Also maintains the unique identifier of this plugin as well as the current |
| [23](#L23) | \* version of the plugin. |
| [24](#L24) | \* |
| [25](#L25) | \* @since      1.0.0 |
| [26](#L26) | \* @package    Wb\_Custom\_Product\_Tabs\_For\_Woocommerce |
| [27](#L27) | \* @subpackage Wb\_Custom\_Product\_Tabs\_For\_Woocommerce/includes |
| [28](#L28) | \* @author     Web Builder 143 <webbuilder143@gmail.com> |
| [29](#L29) | \*/ |
| [30](#L30) | class Wb\_Custom\_Product\_Tabs\_For\_Woocommerce { |
| [31](#L31) |  |
| [32](#L32) | /\*\* |
| [33](#L33) | \* The loader that's responsible for maintaining and registering all hooks that power |
| [34](#L34) | \* the plugin. |
| [35](#L35) | \* |
| [36](#L36) | \* @since    1.0.0 |
| [37](#L37) | \* @access   protected |
| [38](#L38) | \* @var      Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Loader    $loader    Maintains and registers all hooks for the plugin. |
| [39](#L39) | \*/ |
| [40](#L40) | protected $loader; |
| [41](#L41) |  |
| [42](#L42) | /\*\* |
| [43](#L43) | \* The unique identifier of this plugin. |
| [44](#L44) | \* |
| [45](#L45) | \* @since    1.0.0 |
| [46](#L46) | \* @access   protected |
| [47](#L47) | \* @var      string    $plugin\_name    The string used to uniquely identify this plugin. |
| [48](#L48) | \*/ |
| [49](#L49) | protected $plugin\_name; |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* The current version of the plugin. |
| [53](#L53) | \* |
| [54](#L54) | \* @since    1.0.0 |
| [55](#L55) | \* @access   protected |
| [56](#L56) | \* @var      string    $version    The current version of the plugin. |
| [57](#L57) | \*/ |
| [58](#L58) | protected $version; |
| [59](#L59) |  |
| [60](#L60) | /\*\* |
| [61](#L61) | \* Define the core functionality of the plugin. |
| [62](#L62) | \* |
| [63](#L63) | \* Set the plugin name and the plugin version that can be used throughout the plugin. |
| [64](#L64) | \* Load the dependencies, define the locale, and set the hooks for the admin area and |
| [65](#L65) | \* the public-facing side of the site. |
| [66](#L66) | \* |
| [67](#L67) | \* @since    1.0.0 |
| [68](#L68) | \*/ |
| [69](#L69) | public function \_\_construct() { |
| [70](#L70) | if ( defined( 'WB\_CUSTOM\_PRODUCT\_TABS\_FOR\_WOOCOMMERCE\_VERSION' ) ) { |
| [71](#L71) | $this->version = WB\_CUSTOM\_PRODUCT\_TABS\_FOR\_WOOCOMMERCE\_VERSION; |
| [72](#L72) | } else { |
| [73](#L73) | $this->version = '1.2.5'; |
| [74](#L74) | } |
| [75](#L75) | $this->plugin\_name = 'wb-custom-product-tabs-for-woocommerce'; |
| [76](#L76) |  |
| [77](#L77) | $this->load\_dependencies(); |
| [78](#L78) | $this->set\_locale(); |
| [79](#L79) | $this->define\_admin\_hooks(); |
| [80](#L80) | $this->define\_public\_hooks(); |
| [81](#L81) |  |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | /\*\* |
| [85](#L85) | \* Load the required dependencies for this plugin. |
| [86](#L86) | \* |
| [87](#L87) | \* Include the following files that make up the plugin: |
| [88](#L88) | \* |
| [89](#L89) | \* - Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Loader. Orchestrates the hooks of the plugin. |
| [90](#L90) | \* - Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_i18n. Defines internationalization functionality. |
| [91](#L91) | \* - Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Admin. Defines all hooks for the admin area. |
| [92](#L92) | \* - Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Public. Defines all hooks for the public side of the site. |
| [93](#L93) | \* |
| [94](#L94) | \* Create an instance of the loader which will be used to register the hooks |
| [95](#L95) | \* with WordPress. |
| [96](#L96) | \* |
| [97](#L97) | \* @since    1.0.0 |
| [98](#L98) | \* @access   private |
| [99](#L99) | \*/ |
| [100](#L100) | private function load\_dependencies() { |
| [101](#L101) |  |
| [102](#L102) | /\*\* |
| [103](#L103) | \* The class responsible for orchestrating the actions and filters of the |
| [104](#L104) | \* core plugin. |
| [105](#L105) | \*/ |
| [106](#L106) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-wb-custom-product-tabs-for-woocommerce-loader.php'; |
| [107](#L107) |  |
| [108](#L108) | /\*\* |
| [109](#L109) | \* The class responsible for defining internationalization functionality |
| [110](#L110) | \* of the plugin. |
| [111](#L111) | \*/ |
| [112](#L112) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-wb-custom-product-tabs-for-woocommerce-i18n.php'; |
| [113](#L113) |  |
| [114](#L114) | /\*\* |
| [115](#L115) | \* The class responsible for defining all actions that occur in the admin area. |
| [116](#L116) | \*/ |
| [117](#L117) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'admin/class-wb-custom-product-tabs-for-woocommerce-admin.php'; |
| [118](#L118) |  |
| [119](#L119) | /\*\* |
| [120](#L120) | \* The class responsible for defining all actions that occur in the public-facing |
| [121](#L121) | \* side of the site. |
| [122](#L122) | \*/ |
| [123](#L123) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'public/class-wb-custom-product-tabs-for-woocommerce-public.php'; |
| [124](#L124) |  |
| [125](#L125) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'admin/classes/class-wb-custom-product-tabs-for-woocommerce-feedback.php'; |
| [126](#L126) |  |
| [127](#L127) | $this->loader = new Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Loader(); |
| [128](#L128) |  |
| [129](#L129) | } |
| [130](#L130) |  |
| [131](#L131) | /\*\* |
| [132](#L132) | \* Define the locale for this plugin for internationalization. |
| [133](#L133) | \* |
| [134](#L134) | \* Uses the Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_i18n class in order to set the domain and to register the hook |
| [135](#L135) | \* with WordPress. |
| [136](#L136) | \* |
| [137](#L137) | \* @since    1.0.0 |
| [138](#L138) | \* @access   private |
| [139](#L139) | \*/ |
| [140](#L140) | private function set\_locale() { |
| [141](#L141) |  |
| [142](#L142) | $plugin\_i18n = new Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_i18n(); |
| [143](#L143) |  |
| [144](#L144) | $this->loader->add\_action( 'init', $plugin\_i18n, 'load\_plugin\_textdomain' ); |
| [145](#L145) |  |
| [146](#L146) | } |
| [147](#L147) |  |
| [148](#L148) | /\*\* |
| [149](#L149) | \* Register all of the hooks related to the admin area functionality |
| [150](#L150) | \* of the plugin. |
| [151](#L151) | \* |
| [152](#L152) | \* @since    1.0.0 |
| [153](#L153) | \* @access   private |
| [154](#L154) | \*/ |
| [155](#L155) | private function define\_admin\_hooks() { |
| [156](#L156) |  |
| [157](#L157) | $plugin\_admin = new Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Admin( $this->get\_plugin\_name(), $this->get\_version() ); |
| [158](#L158) |  |
| [159](#L159) | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueue\_styles' ); |
| [160](#L160) | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueue\_scripts' ); |
| [161](#L161) |  |
| [162](#L162) | /\* product page tab \*/ |
| [163](#L163) | $this->loader->add\_filter( 'woocommerce\_product\_data\_tabs', $plugin\_admin, 'product\_data\_tabs' ); |
| [164](#L164) |  |
| [165](#L165) | /\* product page tab content \*/ |
| [166](#L166) | $this->loader->add\_action( 'woocommerce\_product\_data\_panels', $plugin\_admin, 'product\_data\_panels' ); |
| [167](#L167) |  |
| [168](#L168) | /\* save tab content \*/ |
| [169](#L169) | $this->loader->add\_action( 'woocommerce\_process\_product\_meta', $plugin\_admin, 'process\_product\_meta',10,2); |
| [170](#L170) |  |
| [171](#L171) | /\*\* |
| [172](#L172) | \* @since 1.0.2 |
| [173](#L173) | \* register global tabs as custom post type |
| [174](#L174) | \*/ |
| [175](#L175) | $this->loader->add\_action( 'init', $plugin\_admin, 'register\_global\_tabs',10,2); |
| [176](#L176) |  |
| [177](#L177) | /\*\* |
| [178](#L178) | \* @since 1.0.2 |
| [179](#L179) | \* register meta box for global tab custom post type |
| [180](#L180) | \*/ |
| [181](#L181) | $this->loader->add\_action( 'add\_meta\_boxes', $plugin\_admin, 'register\_meta\_box',10,2); |
| [182](#L182) |  |
| [183](#L183) | /\*\* |
| [184](#L184) | \* @since 1.0.2 |
| [185](#L185) | \* save meta box data for global tab custom post type |
| [186](#L186) | \*/ |
| [187](#L187) | $this->loader->add\_action( 'save\_post', $plugin\_admin, 'save\_meta\_box\_data', 10, 2); |
| [188](#L188) |  |
| [189](#L189) | /\*\* |
| [190](#L190) | \* @since 1.0.9 |
| [191](#L191) | \* Global tabs, Add new product links on plugins page |
| [192](#L192) | \*/ |
| [193](#L193) | $this->loader->add\_filter('plugin\_action\_links\_'.plugin\_basename(WB\_TAB\_PLUGIN\_FILENAME), $plugin\_admin, 'plugin\_action\_links'); |
| [194](#L194) |  |
| [195](#L195) | /\*\* |
| [196](#L196) | \* @since 1.1.0 |
| [197](#L197) | \* Nickname column in global tabs listing page |
| [198](#L198) | \*/ |
| [199](#L199) | $this->loader->add\_filter('manage\_'.WB\_TAB\_POST\_TYPE.'\_posts\_columns', $plugin\_admin, 'add\_nickname\_column'); |
| [200](#L200) | $this->loader->add\_action('manage\_'.WB\_TAB\_POST\_TYPE.'\_posts\_custom\_column' , $plugin\_admin, 'add\_nickname\_column\_data', 10, 2); |
| [201](#L201) |  |
| [202](#L202) | /\*\* |
| [203](#L203) | \* Product categories/tags columns in global tabs listing page |
| [204](#L204) | \* |
| [205](#L205) | \* @since 1.1.3 |
| [206](#L206) | \*/ |
| [207](#L207) | $this->loader->add\_filter('manage\_'.WB\_TAB\_POST\_TYPE.'\_posts\_columns', $plugin\_admin, 'add\_product\_cat\_tag\_column'); |
| [208](#L208) | $this->loader->add\_action('manage\_'.WB\_TAB\_POST\_TYPE.'\_posts\_custom\_column' , $plugin\_admin, 'add\_product\_cat\_tag\_column\_data', 10, 2); |
| [209](#L209) |  |
| [210](#L210) | /\*\* |
| [211](#L211) | \* YouTube Embed option in tab content editor |
| [212](#L212) | \* |
| [213](#L213) | \* @since 1.1.5 |
| [214](#L214) | \*/ |
| [215](#L215) | $this->loader->add\_action('media\_buttons', $plugin\_admin, 'add\_youtube\_embed\_button'); |
| [216](#L216) |  |
| [217](#L217) |  |
| [218](#L218) | /\*\* |
| [219](#L219) | \* YouTube Embed popup HTML |
| [220](#L220) | \* |
| [221](#L221) | \* @since 1.1.5 |
| [222](#L222) | \*/ |
| [223](#L223) | $this->loader->add\_action('in\_admin\_header', $plugin\_admin, 'add\_youtube\_embed\_popup'); |
| [224](#L224) |  |
| [225](#L225) |  |
| [226](#L226) | /\*\* |
| [227](#L227) | \* Change log in upgrade notice |
| [228](#L228) | \* |
| [229](#L229) | \* @since 1.1.5 |
| [230](#L230) | \*/ |
| [231](#L231) | $this->loader->add\_action('in\_plugin\_update\_message-wb-custom-product-tabs-for-woocommerce/wb-custom-product-tabs-for-woocommerce.php', $plugin\_admin, 'changelog\_in\_upgrade\_notice', 10, 2 ); |
| [232](#L232) |  |
| [233](#L233) | /\*\* |
| [234](#L234) | \* Review banner on global tabs page. |
| [235](#L235) | \* |
| [236](#L236) | \* @since 1.1.13 |
| [237](#L237) | \*/ |
| [238](#L238) | $this->loader->add\_action( 'admin\_head-edit.php', $plugin\_admin, 'global\_tabs\_page\_review\_banner' ); |
| [239](#L239) |  |
| [240](#L240) |  |
| [241](#L241) | /\*\* |
| [242](#L242) | \* Alter the options in the tab content editor. |
| [243](#L243) | \* |
| [244](#L244) | \* @since 1.2.3 |
| [245](#L245) | \*/ |
| [246](#L246) | $this->loader->add\_action( 'mce\_buttons', $plugin\_admin, 'alter\_editor\_buttons', 10, 2 ); |
| [247](#L247) |  |
| [248](#L248) |  |
| [249](#L249) | /\*\* |
| [250](#L250) | \* Add global tabs to polylang custom post type list. |
| [251](#L251) | \* |
| [252](#L252) | \* @since 1.2.4 |
| [253](#L253) | \*/ |
| [254](#L254) | $this->loader->add\_filter( 'pll\_get\_post\_types', $plugin\_admin, 'add\_global\_tabs\_to\_pll\_post\_type\_list', 11 ); |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | /\*\* |
| [258](#L258) | \* Register all of the hooks related to the public-facing functionality |
| [259](#L259) | \* of the plugin. |
| [260](#L260) | \* |
| [261](#L261) | \* @since    1.0.0 |
| [262](#L262) | \* @access   private |
| [263](#L263) | \*/ |
| [264](#L264) | private function define\_public\_hooks() { |
| [265](#L265) |  |
| [266](#L266) | $plugin\_public = new Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Public( $this->get\_plugin\_name(), $this->get\_version() ); |
| [267](#L267) |  |
| [268](#L268) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueue\_styles' ); |
| [269](#L269) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueue\_scripts' ); |
| [270](#L270) |  |
| [271](#L271) | $this->loader->add\_filter('woocommerce\_product\_tabs', $plugin\_public, 'add\_custom\_tab'); |
| [272](#L272) |  |
| [273](#L273) |  |
| [274](#L274) | /\*\* |
| [275](#L275) | \* Shortcode to embed YouTube videos |
| [276](#L276) | \* |
| [277](#L277) | \* @since 1.1.5 |
| [278](#L278) | \*/ |
| [279](#L279) | add\_shortcode('wb\_cpt\_youtube\_embed\_shortcode', array($plugin\_public, 'add\_youtube\_embed\_shortcode')); |
| [280](#L280) | } |
| [281](#L281) |  |
| [282](#L282) | /\*\* |
| [283](#L283) | \* Run the loader to execute all of the hooks with WordPress. |
| [284](#L284) | \* |
| [285](#L285) | \* @since    1.0.0 |
| [286](#L286) | \*/ |
| [287](#L287) | public function run() { |
| [288](#L288) | $this->loader->run(); |
| [289](#L289) | } |
| [290](#L290) |  |
| [291](#L291) | /\*\* |
| [292](#L292) | \* The name of the plugin used to uniquely identify it within the context of |
| [293](#L293) | \* WordPress and to define internationalization functionality. |
| [294](#L294) | \* |
| [295](#L295) | \* @since     1.0.0 |
| [296](#L296) | \* @return    string    The name of the plugin. |
| [297](#L297) | \*/ |
| [298](#L298) | public function get\_plugin\_name() { |
| [299](#L299) | return $this->plugin\_name; |
| [300](#L300) | } |
| [301](#L301) |  |
| [302](#L302) | /\*\* |
| [303](#L303) | \* The reference to the class that orchestrates the hooks with the plugin. |
| [304](#L304) | \* |
| [305](#L305) | \* @since     1.0.0 |
| [306](#L306) | \* @return    Wb\_Custom\_Product\_Tabs\_For\_Woocommerce\_Loader    Orchestrates the hooks of the plugin. |
| [307](#L307) | \*/ |
| [308](#L308) | public function get\_loader() { |
| [309](#L309) | return $this->loader; |
| [310](#L310) | } |
| [311](#L311) |  |
| [312](#L312) | /\*\* |
| [313](#L313) | \* Retrieve the version number of the plugin. |
| [314](#L314) | \* |
| [315](#L315) | \* @since     1.0.0 |
| [316](#L316) | \* @return    string    The version number of the plugin. |
| [317](#L317) | \*/ |
| [318](#L318) | public function get\_version() { |
| [319](#L319) | return $this->version; |
| [320](#L320) | } |
| [321](#L321) |  |
| [322](#L322) |  |
| [323](#L323) | /\*\* |
| [324](#L324) | \* Get product term IDs array |
| [325](#L325) | \* |
| [326](#L326) | \* @since     1.0.2 |
| [327](#L327) | \* @param     int               product id |
| [328](#L328) | \* @param     string    term name |
| [329](#L329) | \* @return    array    term IDs array |
| [330](#L330) | \*/ |
| [331](#L331) | public static function \_get\_product\_term\_ids( $product\_id, $term ) { |
| [332](#L332) | $terms = get\_the\_terms( $product\_id, $term ); |
| [333](#L333) | $terms = ( $terms && is\_array( $terms ) ? $terms : array() ); |
| [334](#L334) |  |
| [335](#L335) | /\*\* |
| [336](#L336) | \*      Alter product term ids. |
| [337](#L337) | \* |
| [338](#L338) | \*      @since 1.2.4 |
| [339](#L339) | \*      @param array    Term ids array. |
| [340](#L340) | \*      @param int      Product id. |
| [341](#L341) | \*      @param string   Term name. |
| [342](#L342) | \*      @return array    Term ids array. |
| [343](#L343) | \*/ |
| [344](#L344) | $term\_ids = apply\_filters( 'wb\_cptb\_product\_term\_ids', array\_column( $terms, 'term\_id' ), $product\_id, $term ); |
| [345](#L345) |  |
| [346](#L346) | return is\_array( $term\_ids ) ? $term\_ids : array(); |
| [347](#L347) | } |
| [348](#L348) |  |
| [349](#L349) |  |
| [350](#L350) | /\*\* |
| [351](#L351) | \* Get custom tabs of a product |
| [352](#L352) | \* |
| [353](#L353) | \* @since     1.0.2 |
| [354](#L354) | \* @since     1.2.4                             Added compatibility for brands. |
| [355](#L355) | \* @param     WC\_Product object         $product |
| [356](#L356) | \* @param     boolean                           $sort                   Sort the product based on tab position |
| [357](#L357) | \* @return    array                             Product tabs |
| [358](#L358) | \*/ |
| [359](#L359) | public static function get\_product\_tabs($product, $sort=false) |
| [360](#L360) | { |
| [361](#L361) | /\*\* |
| [362](#L362) | \*       Taking custom tabs |
| [363](#L363) | \*/ |
| [364](#L364) | $product\_id=(method\_exists($product, 'get\_id')===true ? $product->get\_id() : $product->ID); |
| [365](#L365) |  |
| [366](#L366) | $wb\_tabs=$product->get\_meta('wb\_custom\_tabs', true); |
| [367](#L367) | $wb\_tabs=(is\_array($wb\_tabs) ? $wb\_tabs : array()); |
| [368](#L368) |  |
| [369](#L369) | /\* |
| [370](#L370) | \*       Taking global tabs |
| [371](#L371) | \*/ |
| [372](#L372) | /\* Taking categories \*/ |
| [373](#L373) | $cat\_id\_arr=self::\_get\_product\_category\_ids($product\_id); |
| [374](#L374) |  |
| [375](#L375) | /\* Taking tags \*/ |
| [376](#L376) | $tag\_id\_arr=self::\_get\_product\_term\_ids($product\_id, 'product\_tag'); |
| [377](#L377) |  |
| [378](#L378) | $tax\_query = array( |
| [379](#L379) | 'relation'=>'OR', |
| [380](#L380) | array( |
| [381](#L381) | 'taxonomy'=>'product\_cat', |
| [382](#L382) | 'field'=>'ID', |
| [383](#L383) | 'terms'=>$cat\_id\_arr, |
| [384](#L384) | 'include\_children' => apply\_filters('wb\_cptb\_include\_child\_category\_tabs', false), |
| [385](#L385) | ), |
| [386](#L386) | array( |
| [387](#L387) | 'taxonomy'=>'product\_tag', |
| [388](#L388) | 'field'=>'ID', |
| [389](#L389) | 'terms'=>$tag\_id\_arr, |
| [390](#L390) | ), |
| [391](#L391) | ); |
| [392](#L392) |  |
| [393](#L393) |  |
| [394](#L394) | // Add compatibility for thirdparty brand plugins. |
| [395](#L395) | $brand\_taxonamies = self::\_get\_thirdparty\_brand\_taxonamies(); |
| [396](#L396) |  |
| [397](#L397) | foreach ( $brand\_taxonamies as $brand\_taxonamy ) { |
| [398](#L398) | if ( ! is\_string( $brand\_taxonamy ) ) { |
| [399](#L399) | continue; |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | $brand\_id\_arr = self::\_get\_product\_term\_ids( $product\_id, $brand\_taxonamy ); |
| [403](#L403) |  |
| [404](#L404) | if ( ! empty( $brand\_id\_arr ) ) { |
| [405](#L405) | $tax\_query[] = array( |
| [406](#L406) | 'taxonomy'  => $brand\_taxonamy, |
| [407](#L407) | 'field'     => 'ID', |
| [408](#L408) | 'terms'     => $brand\_id\_arr, |
| [409](#L409) | ); |
| [410](#L410) | } |
| [411](#L411) | } |
| [412](#L412) |  |
| [413](#L413) |  |
| [414](#L414) | $query = new WP\_Query( |
| [415](#L415) | array( |
| [416](#L416) | 'post\_type' => WB\_TAB\_POST\_TYPE, |
| [417](#L417) | 'tax\_query' => $tax\_query, // phpcs:ignore WordPress.DB.SlowDBQuery.slow\_db\_query\_tax\_query |
| [418](#L418) | ) |
| [419](#L419) | ); |
| [420](#L420) |  |
| [421](#L421) | if($query->have\_posts()) |
| [422](#L422) | { |
| [423](#L423) | while ( $query->have\_posts() ) { |
| [424](#L424) | $query->the\_post(); |
| [425](#L425) | $post\_id=get\_the\_ID(); |
| [426](#L426) | $tab\_position=self::\_get\_global\_tab\_position($post\_id); |
| [427](#L427) | $tab\_nickname=self::\_get\_global\_tab\_nickname($post\_id); |
| [428](#L428) | $wb\_tabs[]=array('title'=>get\_the\_title(), 'content'=>get\_the\_content(), 'tab\_type'=>'global', 'position'=>$tab\_position, 'nickname'=>$tab\_nickname, 'tab\_id'=>$post\_id); |
| [429](#L429) | } |
| [430](#L430) | } |
| [431](#L431) | wp\_reset\_postdata(); |
| [432](#L432) |  |
| [433](#L433) | /\* |
| [434](#L434) | \*       If sort is true then sort the tabs based on Tabs position |
| [435](#L435) | \*/ |
| [436](#L436) | if($sort) |
| [437](#L437) | { |
| [438](#L438) | $position\_arr=array\_column($wb\_tabs, 'position'); |
| [439](#L439) | array\_multisort($position\_arr, SORT\_ASC, $wb\_tabs); |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | return $wb\_tabs; |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | public static function \_get\_global\_tab\_position($id) |
| [446](#L446) | { |
| [447](#L447) | $tab\_position=get\_post\_meta($id, '\_wb\_tab\_position', true); |
| [448](#L448) | return absint($tab\_position==="" ? 20 : $tab\_position); |
| [449](#L449) | } |
| [450](#L450) |  |
| [451](#L451) | public static function \_get\_global\_tab\_nickname($id) |
| [452](#L452) | { |
| [453](#L453) | $tab\_nickname=get\_post\_meta($id, '\_wb\_tab\_nickname', true); |
| [454](#L454) | return $tab\_nickname===false ? '' : $tab\_nickname; |
| [455](#L455) | } |
| [456](#L456) |  |
| [457](#L457) | /\*\* |
| [458](#L458) | \* Get product category IDs array |
| [459](#L459) | \* |
| [460](#L460) | \* @since     1.1.9 |
| [461](#L461) | \* @param     int               product id |
| [462](#L462) | \* @return    int[]     category IDs array |
| [463](#L463) | \*/ |
| [464](#L464) | private static function \_get\_product\_category\_ids($product\_id) |
| [465](#L465) | { |
| [466](#L466) | $category\_ids = array(); |
| [467](#L467) | if(apply\_filters('wb\_cptb\_include\_parent\_category\_tabs', true)) |
| [468](#L468) | { |
| [469](#L469) | $category\_ids = wc\_get\_product\_cat\_ids($product\_id); |
| [470](#L470) | }else |
| [471](#L471) | { |
| [472](#L472) | $category\_ids = wc\_get\_product\_term\_ids($product\_id, 'product\_cat'); |
| [473](#L473) | } |
| [474](#L474) |  |
| [475](#L475) | return $category\_ids; |
| [476](#L476) | } |
| [477](#L477) |  |
| [478](#L478) |  |
| [479](#L479) | /\*\* |
| [480](#L480) | \*      Get third party brand taxonamies. |
| [481](#L481) | \* |
| [482](#L482) | \*  @since  1.2.4 |
| [483](#L483) | \*      @param  string[] Brand taxonamies |
| [484](#L484) | \*      @return string[] Brand taxonamies |
| [485](#L485) | \*/ |
| [486](#L486) | public static function \_get\_thirdparty\_brand\_taxonamies() { |
| [487](#L487) |  |
| [488](#L488) | /\*\* |
| [489](#L489) | \*      Alter third party brand taxonamies. |
| [490](#L490) | \* |
| [491](#L491) | \*  @since  1.2.4 |
| [492](#L492) | \*      @param  string[] Brand taxonamies |
| [493](#L493) | \*      @return string[] Brand taxonamies |
| [494](#L494) | \*/ |
| [495](#L495) | $brand\_taxonomy\_arr = apply\_filters( 'wb\_cptb\_thirdparty\_brand\_taxonamies', array( 'pwb-brand' ) ) ; |
| [496](#L496) |  |
| [497](#L497) | return is\_array( $brand\_taxonomy\_arr ) ? $brand\_taxonomy\_arr : array(); |
| [498](#L498) | } |
| [499](#L499) |  |
| [500](#L500) |  |
| [501](#L501) | //public function migrate\_old\_ |
| [502](#L502) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php?format=txt)
* [Original Format](/export/3222669/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_aa0aaaa5_20250115_081343.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Custom Product Tabs For WooCommerce <= 1.2.4 - Authenticated (Shop Manager+) PHP Object Injection

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Custom Product Tabs For WooCommerce <= 1.2.4 - Authenticated (Shop Manager+) PHP Object Injection

7.2

**Deserialization of Untrusted Data**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-12721](https://www.cve.org/CVERecord?id=CVE-2024-12721) |
| --- | --- |
| CVSS | 7.2 (High) |
| Publicly Published | December 20, 2024 |
| Last Updated | January 9, 2025 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Custom Product Tabs For WooCommerce plugin for WordPress is vulnerable to PHP Object Injection in all versions up to, and including, 1.2.4 via deserialization of untrusted input from the 'wb\_custom\_tabs' parameter. This makes it possible for authenticated attackers, with Shop Manager-level access and above, to inject a PHP Object. No known POP chain is present in the vulnerable software. If a POP chain is present via an additional plugin or theme installed on the target system, it could allow the attacker to delete arbitrary files, retrieve sensitive data, or execute code.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wb-custom-product-tabs-for-woocommerce/trunk/includes/class-wb-custom-product-tabs-for-woocommerce.php#L366)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3213473%40wb-custom-product-tabs-for-woocommerce&new=3213473%40wb-custom-product-tabs-for-woocommerce&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwb-custom-product-tabs-for-woocommerce%2Fcustom-product-tabs-for-woocommerce-124-authenticated-shop-manager-php-object-injection&t=Custom%20Product%20Tabs%20For%20WooCommerce%20%3C%3D%201.2.4%20-%20Authenticated%20%28Shop%20Manager%2B%29%20PHP%20Object%20Injection "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwb-custom-product-tabs-for-woocommerce%2Fcustom-product-tabs-for-woocommerce-124-authenticated-shop-manager-php-object-injection&text=Custom%20Product%20Tabs%20For%20WooCommerce%20%3C%3D%201.2.4%20-%20Authenticated%20%28Shop%20Manager%2B%29%20PHP%20Object%20Injection "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwb-custom-product-tabs-for-woocommerce%2Fcustom-product-tabs-for-woocommerce-124-authenticated-shop-manager-php-object-injection "LinkedIn")
Email

## Vulnerability Details for Custom Product tabs for WooCommerce

#### [Custom Product tabs for WooCommerce](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wb-custom-product-tabs-for-woocommerce)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wb-custom-product-tabs-for-woocommerce [(view on wordpress.org)](https://wordpress.org/plugins/wb-custom-product-tabs-for-woocommerce) |
| Patched? | Yes |
| Remediation | Update to version 1.2.5, or a newer patched version |
| Affected Version | * <= 1.2.4 |
| Patched Version | * 1.2.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


