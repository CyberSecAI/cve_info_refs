Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The root cause of this vulnerability is the lack of sufficient file type validation when uploading profile pictures within the "MStore API – Create Native Android & iOS Apps On The Cloud" WordPress plugin.  Specifically, the plugin fails to properly verify if an uploaded file is an image, allowing an attacker to upload HTML files instead.

**Weaknesses/Vulnerabilities:**

*   **Unrestricted File Upload:** The plugin doesn't restrict the types of files that can be uploaded.
*   **Insufficient File Type Validation:** The plugin checks the mime type but doesn't properly validate it against a list of allowed image types, or the file extension.

**Impact of Exploitation:**

*   **Stored Cross-Site Scripting (XSS):** By uploading a malicious HTML file containing JavaScript, an attacker can execute arbitrary web scripts in the context of other users' browsers whenever they access the uploaded file. This allows for a range of malicious activities, such as:
    *   Stealing session cookies
    *   Redirecting users to malicious websites
    *   Defacing the website
    *   Performing actions on behalf of the victim user

**Attack Vectors:**

*   **File Upload Functionality:** The vulnerability is triggered via the profile picture upload functionality in the plugin.
*   **HTML File Upload:** The attacker uploads a specially crafted HTML file containing malicious JavaScript code.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be a registered user on the WordPress site with at least subscriber-level access. This means they must have an account and the ability to log in.

**Additional Information:**

*   The vulnerability affects all versions of the "MStore API – Create Native Android & iOS Apps On The Cloud" plugin up to and including version 4.16.4.
*   The vulnerability has been patched in version 4.16.5, which includes improved file type validation to prevent HTML file uploads.
*   The provided code snippet from the plugin's `index.php` file shows the fix implemented by adding `wp_check_filetype` and `wp_match_mime_types` checks to validate the uploaded file is indeed an image.
* The fix was implemented in changeset 3205338.