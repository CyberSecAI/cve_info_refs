- **Root cause of vulnerability:** A double-free vulnerability exists in the uD3TN BPv7 implementation when handling a malformed Endpoint Identifier (EID) in a bundle. This occurs because the `bundle7_eid_parse_cbor` function prematurely frees the `eid` pointer upon encountering an error when parsing a malformed EID with the `ipn` scheme, and the same memory address stored in `bundle->destination` is later freed again in the `bundle_free_dynamic_parts` function.
- **Weaknesses/vulnerabilities present:** Double-free vulnerability (CWE-415)
- **Impact of exploitation:** Denial of service (DoS). The service crashes due to a double-free, causing the uD3TN service to abort.
- **Attack vectors:** Sending a crafted BPv7 bundle with a malformed EID.
- **Required attacker capabilities/position:** The attacker needs to be able to send a malformed BPv7 bundle to a running uD3TN node. This can be done via network access if the node is exposed, or by any other means of delivering the crafted bundle.