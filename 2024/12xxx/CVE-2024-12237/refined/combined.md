=== Content from plugins.trac.wordpress.org_3cc14472_20250114_185514.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-responsive-photo-gallery%2Ftags%2F1.0.15%2Fwp-responsive-photo-gallery.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-responsive-photo-gallery](/browser/wp-responsive-photo-gallery?order=name "View wp-responsive-photo-gallery")/[tags](/browser/wp-responsive-photo-gallery/tags?order=name "View tags")/[1.0.15](/browser/wp-responsive-photo-gallery/tags/1.0.15?order=name "View 1.0.15")/[wp-responsive-photo-gallery.php](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?order=name "View wp-responsive-photo-gallery.php")

View diff against:

View revision:

| [Last change](/changeset/2968045/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php "View differences") on this file was [2968045](/changeset/2968045/ "View changeset 2968045"), checked in by nik00726, [16 months ago](/timeline?from=2023-09-17T17%3A18%3A25Z&precision=second "See timeline at 09/17/2023 05:18:25 PM") |
| --- |
| * Make plugin compatible with block editor * Tested with [WordPress](/wiki/WordPress) 6.3 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 437.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name:Masonry Tiled Gallery & Photo Gallery Slideshow |
| [4](#L4) | Plugin URI:https://www.i13websolution.com |
| [5](#L5) | Author URI:https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/ |
| [6](#L6) | Description: This is beautiful masonry tiled gallery and photo gallery slideshow plugin for wordPress blogs and sites.Admin can manages any number of images for photo slideshow and unlimited media into the masonry gallery. |
| [7](#L7) | Author:I Thirteen Web Solution |
| [8](#L8) | Version:1.0.15 |
| [9](#L9) | Text Domain:wp-responsive-photo-gallery |
| [10](#L10) | Domain Path: /languages |
| [11](#L11) | \*/ |
| [12](#L12) | //error\_reporting(0); |
| [13](#L13) |  |
| [14](#L14) | if ( ! defined( 'ABSPATH' ) ) exit; |
| [15](#L15) |  |
| [16](#L16) | $dir = plugin\_dir\_path( \_\_FILE\_\_ ); |
| [17](#L17) | $dir=str\_replace("\\","/",$dir); |
| [18](#L18) | if(!class\_exists('resize')){ |
| [19](#L19) |  |
| [20](#L20) | require\_once($dir.'classes/class.Images.php'); |
| [21](#L21) | } |
| [22](#L22) |  |
| [23](#L23) | add\_action('admin\_menu', 'add\_my\_responsive\_photo\_gallery\_admin\_menu'); |
| [24](#L24) | //add\_action( 'admin\_init', 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [25](#L25) | register\_activation\_hook(\_\_FILE\_\_,'install\_my\_responsive\_photo\_gallery'); |
| [26](#L26) | register\_deactivation\_hook(\_\_FILE\_\_,'rsp\_responsive\_photo\_gallery\_remove\_access\_capabilities'); |
| [27](#L27) | add\_action('wp\_enqueue\_scripts', 'my\_responsive\_photo\_gallery\_load\_styles\_and\_js'); |
| [28](#L28) | add\_shortcode('print\_my\_responsive\_photo\_gallery', 'print\_my\_responsive\_photo\_gallery\_func' ); |
| [29](#L29) | add\_filter('widget\_text', 'do\_shortcode'); |
| [30](#L30) | add\_action ( 'admin\_notices', 'wp\_responsive\_photo\_gallery\_admin\_notices' ); |
| [31](#L31) | add\_action('plugins\_loaded', 'rsp\_responsive\_photo\_gallery\_load\_lang'); |
| [32](#L32) |  |
| [33](#L33) | add\_action( 'wp\_ajax\_rjg\_check\_file\_exist\_justified\_gallery', 'rjg\_check\_file\_exist\_justified\_gallery\_callback' ); |
| [34](#L34) | add\_action( 'wp\_ajax\_rjg\_get\_youtube\_info\_justified\_gallery', 'rjg\_get\_youtube\_info\_justified\_gallery\_callback' ); |
| [35](#L35) | add\_action( 'wp\_ajax\_rjg\_get\_metacafe\_info\_justified\_gallery', 'rjg\_get\_metacafe\_info\_justified\_gallery\_callback' ); |
| [36](#L36) |  |
| [37](#L37) | add\_action('wp\_ajax\_rjg\_get\_grid\_data\_justified\_gallery', 'rjg\_get\_grid\_data\_justified\_gallery\_callback'); |
| [38](#L38) | add\_action('wp\_ajax\_nopriv\_rjg\_get\_grid\_data\_justified\_gallery', 'rjg\_get\_grid\_data\_justified\_gallery\_callback'); |
| [39](#L39) | add\_shortcode ( 'print\_masonry\_gallery\_plus\_lightbox', 'rjg\_print\_masonry\_gallery\_plus\_lightbox\_func' ); |
| [40](#L40) | add\_filter( 'user\_has\_cap', 'rsp\_responsive\_photo\_gallery\_admin\_cap\_list' , 10, 4 ); |
| [41](#L41) | add\_action( 'wp\_ajax\_mass\_upload\_wpresponsivephgallery', 'wrthslider\_slider\_mass\_upload\_wpresponsivephgallery' ); |
| [42](#L42) | add\_action( 'wp\_ajax\_mass\_upload\_wpresponsivephgalleryms', 'wrthslider\_slider\_mass\_upload\_wpresponsivephgalleryms' ); |
| [43](#L43) |  |
| [44](#L44) | function rsp\_responsive\_photo\_gallery\_load\_lang() { |
| [45](#L45) |  |
| [46](#L46) | load\_plugin\_textdomain( 'wp-responsive-photo-gallery', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [47](#L47) | add\_filter( 'map\_meta\_cap',  'map\_rsp\_responsive\_photo\_gallery\_meta\_caps', 10, 4 ); |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | function rs\_photogallery\_save\_image\_remote\_lbox($url,$saveto){ |
| [51](#L51) |  |
| [52](#L52) | $raw = wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [53](#L53) |  |
| [54](#L54) | if(file\_exists($saveto)){ |
| [55](#L55) | @unlink($saveto); |
| [56](#L56) | } |
| [57](#L57) | $fp = @fopen($saveto,'x'); |
| [58](#L58) | @fwrite($fp, $raw); |
| [59](#L59) | @fclose($fp); |
| [60](#L60) | } |
| [61](#L61) | function map\_rsp\_responsive\_photo\_gallery\_meta\_caps( array $caps, $cap, $user\_id, array $args  ) { |
| [62](#L62) |  |
| [63](#L63) |  |
| [64](#L64) | if ( ! in\_array( $cap, array( |
| [65](#L65) | 'rsp\_responsive\_photo\_gallery\_slideshow\_settings', |
| [66](#L66) | 'rsp\_responsive\_photo\_gallery\_view\_images', |
| [67](#L67) | 'rsp\_responsive\_photo\_gallery\_add\_image', |
| [68](#L68) | 'rsp\_responsive\_photo\_gallery\_edit\_image', |
| [69](#L69) | 'rsp\_responsive\_photo\_gallery\_delete\_image', |
| [70](#L70) | 'rsp\_responsive\_photo\_gallery\_preview', |
| [71](#L71) | 'rsp\_masonry\_gallery\_settings', |
| [72](#L72) | 'rsp\_masonry\_gallery\_view\_media', |
| [73](#L73) | 'rsp\_masonry\_gallery\_add\_media', |
| [74](#L74) | 'rsp\_masonry\_gallery\_edit\_media', |
| [75](#L75) | 'rsp\_masonry\_gallery\_delete\_media', |
| [76](#L76) | 'rsp\_masonry\_gallery\_preview', |
| [77](#L77) |  |
| [78](#L78) | ), true ) ) { |
| [79](#L79) |  |
| [80](#L80) | return $caps; |
| [81](#L81) | } |
| [82](#L82) |  |
| [83](#L83) |  |
| [84](#L84) |  |
| [85](#L85) |  |
| [86](#L86) | $caps = array(); |
| [87](#L87) |  |
| [88](#L88) | switch ( $cap ) { |
| [89](#L89) |  |
| [90](#L90) | case 'rsp\_responsive\_photo\_gallery\_slideshow\_settings': |
| [91](#L91) | $caps[] = 'rsp\_responsive\_photo\_gallery\_slideshow\_settings'; |
| [92](#L92) | break; |
| [93](#L93) |  |
| [94](#L94) | case 'rsp\_responsive\_photo\_gallery\_view\_images': |
| [95](#L95) | $caps[] = 'rsp\_responsive\_photo\_gallery\_view\_images'; |
| [96](#L96) | break; |
| [97](#L97) |  |
| [98](#L98) | case 'rsp\_responsive\_photo\_gallery\_add\_image': |
| [99](#L99) | $caps[] = 'rsp\_responsive\_photo\_gallery\_add\_image'; |
| [100](#L100) | break; |
| [101](#L101) |  |
| [102](#L102) | case 'rsp\_responsive\_photo\_gallery\_edit\_image': |
| [103](#L103) | $caps[] = 'rsp\_responsive\_photo\_gallery\_edit\_image'; |
| [104](#L104) | break; |
| [105](#L105) |  |
| [106](#L106) | case 'rsp\_responsive\_photo\_gallery\_delete\_image': |
| [107](#L107) | $caps[] = 'rsp\_responsive\_photo\_gallery\_delete\_image'; |
| [108](#L108) | break; |
| [109](#L109) |  |
| [110](#L110) | case 'rsp\_responsive\_photo\_gallery\_preview': |
| [111](#L111) | $caps[] = 'rsp\_responsive\_photo\_gallery\_preview'; |
| [112](#L112) | break; |
| [113](#L113) |  |
| [114](#L114) | case 'rsp\_masonry\_gallery\_settings': |
| [115](#L115) | $caps[] = 'rsp\_masonry\_gallery\_settings'; |
| [116](#L116) | break; |
| [117](#L117) |  |
| [118](#L118) | case 'rsp\_masonry\_gallery\_view\_media': |
| [119](#L119) | $caps[] = 'rsp\_masonry\_gallery\_view\_media'; |
| [120](#L120) | break; |
| [121](#L121) |  |
| [122](#L122) | case 'rsp\_masonry\_gallery\_add\_media': |
| [123](#L123) | $caps[] = 'rsp\_masonry\_gallery\_add\_media'; |
| [124](#L124) | break; |
| [125](#L125) |  |
| [126](#L126) | case 'rsp\_masonry\_gallery\_edit\_media': |
| [127](#L127) | $caps[] = 'rsp\_masonry\_gallery\_edit\_media'; |
| [128](#L128) | break; |
| [129](#L129) |  |
| [130](#L130) | case 'rsp\_masonry\_gallery\_delete\_media': |
| [131](#L131) | $caps[] = 'rsp\_masonry\_gallery\_delete\_media'; |
| [132](#L132) | break; |
| [133](#L133) | case 'rsp\_masonry\_gallery\_preview': |
| [134](#L134) | $caps[] = 'rsp\_masonry\_gallery\_preview'; |
| [135](#L135) | break; |
| [136](#L136) |  |
| [137](#L137) | default: |
| [138](#L138) |  |
| [139](#L139) | $caps[] = 'do\_not\_allow'; |
| [140](#L140) | break; |
| [141](#L141) | } |
| [142](#L142) |  |
| [143](#L143) |  |
| [144](#L144) | return apply\_filters( 'rsp\_responsive\_photo\_gallery\_meta\_caps', $caps, $cap, $user\_id, $args ); |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) |  |
| [148](#L148) | function rsp\_responsive\_photo\_gallery\_admin\_cap\_list($allcaps, $caps, $args, $user){ |
| [149](#L149) |  |
| [150](#L150) |  |
| [151](#L151) | if ( ! in\_array( 'administrator', $user->roles ) ) { |
| [152](#L152) |  |
| [153](#L153) | return $allcaps; |
| [154](#L154) | } |
| [155](#L155) | else{ |
| [156](#L156) |  |
| [157](#L157) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_slideshow\_settings'])){ |
| [158](#L158) |  |
| [159](#L159) | $allcaps['rsp\_responsive\_photo\_gallery\_slideshow\_settings']=true; |
| [160](#L160) | } |
| [161](#L161) |  |
| [162](#L162) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_view\_images'])){ |
| [163](#L163) |  |
| [164](#L164) | $allcaps['rsp\_responsive\_photo\_gallery\_view\_images']=true; |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_add\_image'])){ |
| [168](#L168) |  |
| [169](#L169) | $allcaps['rsp\_responsive\_photo\_gallery\_add\_image']=true; |
| [170](#L170) | } |
| [171](#L171) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_edit\_image'])){ |
| [172](#L172) |  |
| [173](#L173) | $allcaps['rsp\_responsive\_photo\_gallery\_edit\_image']=true; |
| [174](#L174) | } |
| [175](#L175) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_delete\_image'])){ |
| [176](#L176) |  |
| [177](#L177) | $allcaps['rsp\_responsive\_photo\_gallery\_delete\_image']=true; |
| [178](#L178) | } |
| [179](#L179) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_preview'])){ |
| [180](#L180) |  |
| [181](#L181) | $allcaps['rsp\_responsive\_photo\_gallery\_preview']=true; |
| [182](#L182) | } |
| [183](#L183) | if(!isset($allcaps['rsp\_masonry\_gallery\_settings'])){ |
| [184](#L184) |  |
| [185](#L185) | $allcaps['rsp\_masonry\_gallery\_settings']=true; |
| [186](#L186) | } |
| [187](#L187) | if(!isset($allcaps['rsp\_masonry\_gallery\_view\_media'])){ |
| [188](#L188) |  |
| [189](#L189) | $allcaps['rsp\_masonry\_gallery\_view\_media']=true; |
| [190](#L190) | } |
| [191](#L191) | if(!isset($allcaps['rsp\_masonry\_gallery\_add\_media'])){ |
| [192](#L192) |  |
| [193](#L193) | $allcaps['rsp\_masonry\_gallery\_add\_media']=true; |
| [194](#L194) | } |
| [195](#L195) | if(!isset($allcaps['rsp\_masonry\_gallery\_edit\_media'])){ |
| [196](#L196) |  |
| [197](#L197) | $allcaps['rsp\_masonry\_gallery\_edit\_media']=true; |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | if(!isset($allcaps['rsp\_masonry\_gallery\_delete\_media'])){ |
| [201](#L201) |  |
| [202](#L202) | $allcaps['rsp\_masonry\_gallery\_delete\_media']=true; |
| [203](#L203) | } |
| [204](#L204) | if(!isset($allcaps['rsp\_masonry\_gallery\_preview'])){ |
| [205](#L205) |  |
| [206](#L206) | $allcaps['rsp\_masonry\_gallery\_preview']=true; |
| [207](#L207) | } |
| [208](#L208) |  |
| [209](#L209) | } |
| [210](#L210) |  |
| [211](#L211) | return $allcaps; |
| [212](#L212) |  |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | function  rsp\_responsive\_photo\_gallery\_add\_access\_capabilities() { |
| [216](#L216) |  |
| [217](#L217) | // Capabilities for all roles. |
| [218](#L218) | $roles = array( 'administrator' ); |
| [219](#L219) | foreach ( $roles as $role ) { |
| [220](#L220) |  |
| [221](#L221) | $role = get\_role( $role ); |
| [222](#L222) | if ( empty( $role ) ) { |
| [223](#L223) | continue; |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) |  |
| [227](#L227) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ) ){ |
| [228](#L228) |  |
| [229](#L229) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ); |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ) ){ |
| [233](#L233) |  |
| [234](#L234) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ); |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) |  |
| [238](#L238) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ){ |
| [239](#L239) |  |
| [240](#L240) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ); |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ){ |
| [244](#L244) |  |
| [245](#L245) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ); |
| [246](#L246) | } |
| [247](#L247) |  |
| [248](#L248) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ){ |
| [249](#L249) |  |
| [250](#L250) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ); |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ) ){ |
| [254](#L254) |  |
| [255](#L255) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ); |
| [256](#L256) | } |
| [257](#L257) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_settings' ) ){ |
| [258](#L258) |  |
| [259](#L259) | $role->add\_cap( 'rsp\_masonry\_gallery\_settings' ); |
| [260](#L260) | } |
| [261](#L261) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_view\_media' ) ){ |
| [262](#L262) |  |
| [263](#L263) | $role->add\_cap( 'rsp\_masonry\_gallery\_view\_media' ); |
| [264](#L264) | } |
| [265](#L265) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_add\_media' ) ){ |
| [266](#L266) |  |
| [267](#L267) | $role->add\_cap( 'rsp\_masonry\_gallery\_add\_media' ); |
| [268](#L268) | } |
| [269](#L269) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_edit\_media' ) ){ |
| [270](#L270) |  |
| [271](#L271) | $role->add\_cap( 'rsp\_masonry\_gallery\_edit\_media' ); |
| [272](#L272) | } |
| [273](#L273) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_delete\_media' ) ){ |
| [274](#L274) |  |
| [275](#L275) | $role->add\_cap( 'rsp\_masonry\_gallery\_delete\_media' ); |
| [276](#L276) | } |
| [277](#L277) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_preview' ) ){ |
| [278](#L278) |  |
| [279](#L279) | $role->add\_cap( 'rsp\_masonry\_gallery\_preview' ); |
| [280](#L280) | } |
| [281](#L281) |  |
| [282](#L282) |  |
| [283](#L283) | } |
| [284](#L284) |  |
| [285](#L285) | $user = wp\_get\_current\_user(); |
| [286](#L286) | $user->get\_role\_caps(); |
| [287](#L287) |  |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | function rsp\_responsive\_photo\_gallery\_remove\_access\_capabilities(){ |
| [291](#L291) |  |
| [292](#L292) | global $wp\_roles; |
| [293](#L293) |  |
| [294](#L294) | if ( ! isset( $wp\_roles ) ) { |
| [295](#L295) | $wp\_roles = new WP\_Roles(); |
| [296](#L296) | } |
| [297](#L297) |  |
| [298](#L298) | foreach ( $wp\_roles->roles as $role => $details ) { |
| [299](#L299) | $role = $wp\_roles->get\_role( $role ); |
| [300](#L300) | if ( empty( $role ) ) { |
| [301](#L301) | continue; |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ); |
| [305](#L305) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ); |
| [306](#L306) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ); |
| [307](#L307) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ); |
| [308](#L308) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ); |
| [309](#L309) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ); |
| [310](#L310) | $role->remove\_cap( 'rsp\_masonry\_gallery\_settings' ); |
| [311](#L311) | $role->remove\_cap( 'rsp\_masonry\_gallery\_view\_media' ); |
| [312](#L312) | $role->remove\_cap( 'rsp\_masonry\_gallery\_add\_media' ); |
| [313](#L313) | $role->remove\_cap( 'rsp\_masonry\_gallery\_edit\_media' ); |
| [314](#L314) | $role->remove\_cap( 'rsp\_masonry\_gallery\_delete\_media' ); |
| [315](#L315) | $role->remove\_cap( 'rsp\_masonry\_gallery\_preview' ); |
| [316](#L316) |  |
| [317](#L317) |  |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) | // Refresh current set of capabilities of the user, to be able to directly use the new caps. |
| [321](#L321) | $user = wp\_get\_current\_user(); |
| [322](#L322) | $user->get\_role\_caps(); |
| [323](#L323) |  |
| [324](#L324) | } |
| [325](#L325) |  |
| [326](#L326) | function my\_responsive\_photo\_gallery\_load\_styles\_and\_js(){ |
| [327](#L327) |  |
| [328](#L328) | if (! is\_admin ()) { |
| [329](#L329) |  |
| [330](#L330) |  |
| [331](#L331) |  |
| [332](#L332) | wp\_register\_style( 'jquery.galleryview-3.0-dev-responsive', plugins\_url('/css/jquery.galleryview-3.0-dev-responsive.css', \_\_FILE\_\_) ); |
| [333](#L333) | wp\_register\_script('jquery.timers-1.2',plugins\_url('/js/jquery.timers-1.2.js', \_\_FILE\_\_),array('jquery'),'1.0.8'); |
| [334](#L334) | wp\_register\_script('jquery.easing.1.3',plugins\_url('/js/jquery.easing.1.3.js', \_\_FILE\_\_),array('jquery'),'1.0.8'); |
| [335](#L335) | wp\_register\_script('jquery.gview-3.0-dev-responsive',plugins\_url('/js/jquery.gview-3.0-dev-responsive.js', \_\_FILE\_\_),array('jquery'),'1.0.11'); |
| [336](#L336) |  |
| [337](#L337) | wp\_register\_style ( 'rjg-lbox', plugins\_url ( '/css/rjg-lbox.css', \_\_FILE\_\_ ) ,array(),'1.0.11'); |
| [338](#L338) | wp\_register\_style ( 'rjg-justified-gallery', plugins\_url ( '/css/rjg-justified-gallery.css', \_\_FILE\_\_ ) ); |
| [339](#L339) | wp\_register\_script ( 'rjg-justified-gallery', plugins\_url ( '/js/rjg-justified-gallery.js', \_\_FILE\_\_ ),array('jquery'),'1.0.8' ); |
| [340](#L340) | wp\_register\_script ( 'rjg-lbox-js', plugins\_url ( '/js/rjg-lbox-js.js', \_\_FILE\_\_ ),array('jquery'),'1.0.11' ); |
| [341](#L341) |  |
| [342](#L342) |  |
| [343](#L343) | } |
| [344](#L344) |  |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | function install\_my\_responsive\_photo\_gallery(){ |
| [348](#L348) |  |
| [349](#L349) | global $wpdb; |
| [350](#L350) | $table\_name = $wpdb->prefix . "gv\_responsive\_slider"; |
| [351](#L351) | $table\_nameg\_rjg = $wpdb->prefix . "rjg\_gallery"; |
| [352](#L352) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [353](#L353) |  |
| [354](#L354) | $sql = "CREATE TABLE " . $table\_name . " ( |
| [355](#L355) | id int(10) unsigned NOT NULL auto\_increment, |
| [356](#L356) | title varchar(1000) NOT NULL, |
| [357](#L357) | image\_name varchar(500) NOT NULL, |
| [358](#L358) | createdon datetime NOT NULL, |
| [359](#L359) | custom\_link varchar(1000) default NULL, |
| [360](#L360) | post\_id int(10) unsigned default NULL, |
| [361](#L361) | PRIMARY KEY  (id) |
| [362](#L362) | ) $charset\_collate; " |
| [363](#L363) | . "CREATE TABLE " . $table\_nameg\_rjg . " ( |
| [364](#L364) | `id` int(11) NOT NULL AUTO\_INCREMENT, |
| [365](#L365) | `media\_type` varchar(10) NOT NULL, |
| [366](#L366) | `image\_name` varchar(500) NOT NULL, |
| [367](#L367) | `title` varchar(500) NOT NULL, |
| [368](#L368) | `murl` varchar(2000) DEFAULT NULL, |
| [369](#L369) | `open\_link\_in` tinyint(1) NOT NULL DEFAULT '0', |
| [370](#L370) | `vtype` varchar(50) DEFAULT NULL, |
| [371](#L371) | `vid` varchar(300) DEFAULT NULL, |
| [372](#L372) | `videourl` varchar(1000) DEFAULT NULL, |
| [373](#L373) | `embed\_url` varchar(300) DEFAULT NULL, |
| [374](#L374) | `HdnMediaSelection` varchar(300) NOT NULL, |
| [375](#L375) | `createdon` datetime NOT NULL, |
| [376](#L376) | `slider\_id` int(11) NOT NULL DEFAULT '1', |
| [377](#L377) | PRIMARY KEY (`id`) |
| [378](#L378) | ) $charset\_collate;"; |
| [379](#L379) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [380](#L380) | dbDelta($sql); |
| [381](#L381) |  |
| [382](#L382) |  |
| [383](#L383) | $my\_responsive\_photo\_gallery\_slider\_settings=array('transition\_speed' => '1000', |
| [384](#L384) | 'transition\_interval' => '4000', |
| [385](#L385) | 'show\_panels' =>'1', |
| [386](#L386) | 'show\_panel\_nav' =>'1', |
| [387](#L387) | 'enable\_overlays' => '0', |
| [388](#L388) | 'panel\_width'=>'550', |
| [389](#L389) | 'panel\_height' => '400', |
| [390](#L390) | 'panel\_animation' => 'fade', |
| [391](#L391) | 'panel\_scale' => 'crop', |
| [392](#L392) | 'overlay\_position'=> 'bottom', |
| [393](#L393) | 'pan\_images' => '1', |
| [394](#L394) | 'pan\_style'=>'drag', |
| [395](#L395) | 'start\_frame'=>'1', |
| [396](#L396) | 'show\_filmstrip'=>'1', |
| [397](#L397) | 'show\_filmstrip\_nav'=>'0', |
| [398](#L398) | 'enable\_slideshow'=>'1', |
| [399](#L399) | 'autoplay'=>'1', |
| [400](#L400) | 'filmstrip\_position'=>'bottom', |
| [401](#L401) | 'frame\_width'=>80, |
| [402](#L402) | 'frame\_height'=>80, |
| [403](#L403) | 'frame\_opacity'=>0.4, |
| [404](#L404) | 'frame\_scale'=>'crop', |
| [405](#L405) | 'filmstrip\_style'=>'scroll', |
| [406](#L406) | 'frame\_gap'=>1, |
| [407](#L407) | 'show\_captions'=>0, |
| [408](#L408) | 'show\_infobar'=>0, |
| [409](#L409) | 'infobar\_opacity'=>1 |
| [410](#L410) | ); |
| [411](#L411) |  |
| [412](#L412) | if( !get\_option( 'my\_responsive\_photo\_gallery\_slider\_settings' ) ) { |
| [413](#L413) |  |
| [414](#L414) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings',$my\_responsive\_photo\_gallery\_slider\_settings); |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | $rjg\_settings=array( |
| [418](#L418) |  |
| [419](#L419) | 'BackgroundColor'=>'#FFFFFF', |
| [420](#L420) | 'imageheight'=>160, |
| [421](#L421) | 'imageMargin'=>5, |
| [422](#L422) | 'page\_size'=>50, |
| [423](#L423) | 'show\_hover\_caption'=>1, |
| [424](#L424) | 'show\_hover\_icon'=>1 |
| [425](#L425) |  |
| [426](#L426) | ); |
| [427](#L427) |  |
| [428](#L428) | if( !get\_option( 'rjg\_settings' ) ) { |
| [429](#L429) |  |
| [430](#L430) | update\_option('rjg\_settings',$rjg\_settings); |
| [431](#L431) | } |
| [432](#L432) |  |
| [433](#L433) |  |
| [434](#L434) | $uploads = wp\_upload\_dir (); |
| [435](#L435) | $baseDir = $uploads ['basedir']; |
| [436](#L436) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [437](#L437) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [438](#L438) | wp\_mkdir\_p ( $pathToImagesFolder ); |
| [439](#L439) | rsp\_responsive\_photo\_gallery\_add\_access\_capabilities(); |
| [440](#L440) |  |
| [441](#L441) | } |
| [442](#L442) |  |
| [443](#L443) |  |
| [444](#L444) | function rjg\_do\_upgrade\_if\_not\_done(){ |
| [445](#L445) |  |
| [446](#L446) |  |
| [447](#L447) | global $wpdb; |
| [448](#L448) | $table\_nameg\_rjg = $wpdb->prefix . "rjg\_gallery"; |
| [449](#L449) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [450](#L450) |  |
| [451](#L451) |  |
| [452](#L452) | if($wpdb->get\_var("SHOW TABLES LIKE '$table\_nameg\_rjg'") != $table\_nameg\_rjg) { |
| [453](#L453) |  |
| [454](#L454) | $sql = "CREATE TABLE " . $table\_nameg\_rjg . " ( |
| [455](#L455) | `id` int(11) NOT NULL AUTO\_INCREMENT, |
| [456](#L456) | `media\_type` varchar(10) NOT NULL, |
| [457](#L457) | `image\_name` varchar(500) NOT NULL, |
| [458](#L458) | `title` varchar(500) NOT NULL, |
| [459](#L459) | `murl` varchar(2000) DEFAULT NULL, |
| [460](#L460) | `open\_link\_in` tinyint(1) NOT NULL DEFAULT '0', |
| [461](#L461) | `vtype` varchar(50) DEFAULT NULL, |
| [462](#L462) | `vid` varchar(300) DEFAULT NULL, |
| [463](#L463) | `videourl` varchar(1000) DEFAULT NULL, |
| [464](#L464) | `embed\_url` varchar(300) DEFAULT NULL, |
| [465](#L465) | `HdnMediaSelection` varchar(300) NOT NULL, |
| [466](#L466) | `createdon` datetime NOT NULL, |
| [467](#L467) | `slider\_id` int(11) NOT NULL DEFAULT '1', |
| [468](#L468) | PRIMARY KEY (`id`) |
| [469](#L469) | ) $charset\_collate;"; |
| [470](#L470) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [471](#L471) | dbDelta($sql); |
| [472](#L472) | } |
| [473](#L473) | $rjg\_settings=array( |
| [474](#L474) |  |
| [475](#L475) | 'BackgroundColor'=>'#FFFFFF', |
| [476](#L476) | 'imageheight'=>160, |
| [477](#L477) | 'imageMargin'=>5, |
| [478](#L478) | 'page\_size'=>50, |
| [479](#L479) | 'show\_hover\_caption'=>1, |
| [480](#L480) | 'show\_hover\_icon'=>1 |
| [481](#L481) |  |
| [482](#L482) | ); |
| [483](#L483) |  |
| [484](#L484) | if( !get\_option( 'rjg\_settings' ) ) { |
| [485](#L485) |  |
| [486](#L486) | update\_option('rjg\_settings',$rjg\_settings); |
| [487](#L487) | } |
| [488](#L488) |  |
| [489](#L489) |  |
| [490](#L490) | } |
| [491](#L491) |  |
| [492](#L492) | function wp\_responsive\_photo\_gallery\_admin\_notices(){ |
| [493](#L493) |  |
| [494](#L494) | if (is\_plugin\_active('wp-responsive-photo-gallery/wp-responsive-photo-gallery.php')) { |
| [495](#L495) |  |
| [496](#L496) | $uploads = wp\_upload\_dir(); |
| [497](#L497) | $baseDir=$uploads['basedir']; |
| [498](#L498) | $baseDir=str\_replace("\\","/",$baseDir); |
| [499](#L499) | $pathToImagesFolder=$baseDir.'/wp-responsive-photo-gallery'; |
| [500](#L500) |  |
| [501](#L501) | if(file\_exists($pathToImagesFolder) and is\_dir($pathToImagesFolder)){ |
| [502](#L502) |  |
| [503](#L503) | if( !is\_writable($pathToImagesFolder)){ |
| [504](#L504) |  |
| [505](#L505) | echo "<div class='updated'><p>".\_\_( 'Photo Gallery Plugin is active but does not have write permission on','wp-responsive-photo-gallery')."</p><p><b>" . $pathToImagesFolder . "</b>".\_\_( ' directory.Please allow write permission.','wp-responsive-photo-gallery')."</p></div> "; |
| [506](#L506) |  |
| [507](#L507) | } |
| [508](#L508) | } |
| [509](#L509) | else{ |
| [510](#L510) |  |
| [511](#L511) | wp\_mkdir\_p($pathToImagesFolder); |
| [512](#L512) | if(!file\_exists($pathToImagesFolder) and !is\_dir($pathToImagesFolder)){ |
| [513](#L513) |  |
| [514](#L514) | echo "<div class='updated'><p>".\_\_( 'Photo Gallery Plugin is active but plugin does not have permission to create directory','wp-responsive-photo-gallery')."</p><p><b>" . $pathToImagesFolder . "</b> ".\_\_( '.Please create post-slider-carousel directory inside upload directory and allow write permission.','wp-responsive-photo-gallery')."</p></div> "; |
| [515](#L515) |  |
| [516](#L516) | } |
| [517](#L517) | } |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | function add\_my\_responsive\_photo\_gallery\_admin\_menu(){ |
| [523](#L523) |  |
| [524](#L524) |  |
| [525](#L525) |  |
| [526](#L526) | $hook\_suffix\_r\_p=add\_menu\_page( \_\_( 'Photo Slideshow & Masonry Gallery','wp-responsive-photo-gallery'), \_\_( 'Photo Slideshow & Masonry Gallery','wp-responsive-photo-gallery' ), 'rsp\_responsive\_photo\_gallery\_slideshow\_settings', 'responsive\_photo\_gallery\_slider', 'responsive\_photo\_gallery\_slider\_admin\_options' ); |
| [527](#L527) | $hook\_suffix\_r\_p=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Settings','wp-responsive-photo-gallery'), \_\_( 'Slideshow Settings','wp-responsive-photo-gallery' ),'rsp\_responsive\_photo\_gallery\_slideshow\_settings', 'responsive\_photo\_gallery\_slider', 'responsive\_photo\_gallery\_slider\_admin\_options' ); |
| [528](#L528) | $hook\_suffix\_r\_p\_1=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Images','wp-responsive-photo-gallery'), \_\_( 'Slideshow Images','wp-responsive-photo-gallery'),'rsp\_responsive\_photo\_gallery\_view\_images', 'responsive\_photo\_gallery\_image\_management', 'responsive\_photo\_gallery\_image\_management' ); |
| [529](#L529) | $hook\_suffix\_r\_p\_2=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Preview','wp-responsive-photo-gallery'), \_\_( 'Slideshow Preview','wp-responsive-photo-gallery'),'rsp\_responsive\_photo\_gallery\_preview', 'responsive\_photo\_galleryrsp\_responsive\_photo\_gallery\_preview\_slider\_preview', 'responsive\_photo\_gallery\_slider\_admin\_preview' ); |
| [530](#L530) |  |
| [531](#L531) | $hook\_suffix=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Settings','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Settings','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_settings', 'responsive\_justified\_gallery\_with\_lightbox', 'rjg\_responsive\_justified\_gallery\_with\_lightbox\_admin\_options\_func' ); |
| [532](#L532) | $hook\_suffix\_image=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Media','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Media','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_view\_media', 'responsive\_justified\_gallery\_with\_lightbox\_media\_management', 'rjg\_responsive\_justified\_gallery\_with\_lightbox\_media\_management\_func' ); |
| [533](#L533) | $hook\_suffix\_prev=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Preview','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Preview','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_preview', 'responsive\_justified\_gallery\_with\_lightbox\_media\_preview', 'rfp\_responsive\_justified\_gallery\_with\_lightbox\_media\_preview\_func' ); |
| [534](#L534) |  |
| [535](#L535) | add\_action( 'load-' . $hook\_suffix , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [536](#L536) | add\_action( 'load-' . $hook\_suffix\_image , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [537](#L537) | add\_action( 'load-' . $hook\_suffix\_prev , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [538](#L538) |  |
| [539](#L539) |  |
| [540](#L540) | add\_action( 'load-' . $hook\_suffix\_r\_p , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [541](#L541) | add\_action( 'load-' . $hook\_suffix\_r\_p\_1 , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [542](#L542) | add\_action( 'load-' . $hook\_suffix\_r\_p\_2 , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [543](#L543) |  |
| [544](#L544) |  |
| [545](#L545) |  |
| [546](#L546) |  |
| [547](#L547) |  |
| [548](#L548) | } |
| [549](#L549) |  |
| [550](#L550) | function my\_responsive\_photo\_gallery\_admin\_init(){ |
| [551](#L551) |  |
| [552](#L552) |  |
| [553](#L553) |  |
| [554](#L554) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [555](#L555) |  |
| [556](#L556) | wp\_enqueue\_style( 'admin-css-responsive', plugins\_url('/css/admin-css-responsive.css', \_\_FILE\_\_) ); |
| [557](#L557) | wp\_enqueue\_style( 'jquery.galleryview-3.0-dev-responsive', plugins\_url('/css/jquery.galleryview-3.0-dev-responsive.css', \_\_FILE\_\_) ); |
| [558](#L558) | wp\_enqueue\_style ( 'rjg-lbox', plugins\_url ( '/css/rjg-lbox.css', \_\_FILE\_\_ ) ); |
| [559](#L559) | wp\_enqueue\_style ( 'rjg-justified-gallery', plugins\_url ( '/css/rjg-justified-gallery.css', \_\_FILE\_\_ ) ); |
| [560](#L560) |  |
| [561](#L561) | wp\_enqueue\_script('jquery'); |
| [562](#L562) | wp\_enqueue\_script("jquery-ui-core"); |
| [563](#L563) | wp\_enqueue\_script('jquery.timers-1.2',plugins\_url('/js/jquery.timers-1.2.js', \_\_FILE\_\_)); |
| [564](#L564) | wp\_enqueue\_script('jquery.easing.1.3',plugins\_url('/js/jquery.easing.1.3.js', \_\_FILE\_\_)); |
| [565](#L565) | wp\_enqueue\_script('jquery.gview-3.0-dev-responsive',plugins\_url('/js/jquery.gview-3.0-dev-responsive.js', \_\_FILE\_\_)); |
| [566](#L566) | wp\_enqueue\_script('jquery.validate',plugins\_url('/js/jquery.validate.js', \_\_FILE\_\_)); |
| [567](#L567) | wp\_enqueue\_script ( 'rjg-justified-gallery', plugins\_url ( '/js/rjg-justified-gallery.js', \_\_FILE\_\_ ) ); |
| [568](#L568) | wp\_enqueue\_script ( 'rjg-lbox-js', plugins\_url ( '/js/rjg-lbox-js.js', \_\_FILE\_\_ ) ); |
| [569](#L569) |  |
| [570](#L570) |  |
| [571](#L571) | rjg\_responsive\_justified\_gallery\_plus\_lightbox\_admin\_scripts\_init(); |
| [572](#L572) | //my\_responsive\_photo\_gallery\_admin\_scripts\_init(); |
| [573](#L573) |  |
| [574](#L574) | rjg\_do\_upgrade\_if\_not\_done(); |
| [575](#L575) |  |
| [576](#L576) |  |
| [577](#L577) | } |
| [578](#L578) |  |
| [579](#L579) | function responsive\_photo\_gallery\_slider\_admin\_options(){ |
| [580](#L580) |  |
| [581](#L581) |  |
| [582](#L582) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ) ) { |
| [583](#L583) |  |
| [584](#L584) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [585](#L585) |  |
| [586](#L586) | } |
| [587](#L587) |  |
| [588](#L588) | if(isset($\_POST['btnsave'])){ |
| [589](#L589) |  |
| [590](#L590) | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
| [591](#L591) |  |
| [592](#L592) | wp\_die('Security check fail'); |
| [593](#L593) | } |
| [594](#L594) |  |
| [595](#L595) |  |
| [596](#L596) | $options=array(); |
| [597](#L597) | $options['transition\_speed']       =(int)trim(htmlentities(sanitize\_text\_field($\_POST['transition\_speed']),ENT\_QUOTES)); |
| [598](#L598) | $options['transition\_interval']    =(int)trim(htmlentities(sanitize\_text\_field($\_POST['transition\_interval']),ENT\_QUOTES)); |
| [599](#L599) | $options['show\_panel\_nav']         =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_panel\_nav']),ENT\_QUOTES)); |
| [600](#L600) | $options['panel\_width']            =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_width']),ENT\_QUOTES)); |
| [601](#L601) | $options['panel\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_height']),ENT\_QUOTES)); |
| [602](#L602) | $options['panel\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_height']),ENT\_QUOTES)); |
| [603](#L603) | $options['panel\_scale']            =trim(htmlentities(sanitize\_text\_field($\_POST['panel\_scale']),ENT\_QUOTES)); |
| [604](#L604) | $options['pan\_style'   ]           =trim(htmlentities(sanitize\_text\_field($\_POST['pan\_style']),ENT\_QUOTES)); |
| [605](#L605) | $options['pan\_images']             =(int)trim(htmlentities(sanitize\_text\_field($\_POST['pan\_images']),ENT\_QUOTES)); |
| [606](#L606) | $options['show\_filmstrip']         =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_filmstrip']),ENT\_QUOTES)); |
| [607](#L607) | $options['autoplay']               =(int)trim(htmlentities(sanitize\_text\_field($\_POST['autoplay']),ENT\_QUOTES)); |
| [608](#L608) | $options['frame\_width']            =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_width']),ENT\_QUOTES)); |
| [609](#L609) | $options['frame\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_height']),ENT\_QUOTES)); |
| [610](#L610) | $options['frame\_opacity']          =trim(htmlentities(sanitize\_text\_field($\_POST['frame\_opacity']),ENT\_QUOTES)); |
| [611](#L611) | $options['frame\_scale']            =trim(htmlentities(sanitize\_text\_field($\_POST['frame\_scale']),ENT\_QUOTES)); |
| [612](#L612) | $options['filmstrip\_style']        ='scroll'; |
| [613](#L613) | $options['frame\_gap']              =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_gap']),ENT\_QUOTES)); |
| [614](#L614) | $options['show\_infobar']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_infobar']),ENT\_QUOTES)); |
| [615](#L615) | $options['infobar\_opacity']        = floatval(htmlentities(sanitize\_text\_field($\_POST['infobar\_opacity']),ENT\_QUOTES)); |
| [616](#L616) | $options['start\_frame']            =1; |
| [617](#L617) | $options['panel\_animation']        ='fade'; |
| [618](#L618) | $options['overlay\_position']       ='bottom'; |
| [619](#L619) | $options['filmstrip\_position']     ='bottom'; |
| [620](#L620) | $options['enable\_overlays']        =0; |
| [621](#L621) | $options['show\_captions']          =0; |
| [622](#L622) | $options['show\_filmstrip\_nav']     =0; |
| [623](#L623) | $options['show\_panels']            =1; |
| [624](#L624) |  |
| [625](#L625) | if((int)trim($\_POST['autoplay'])) |
| [626](#L626) | $options['enable\_slideshow']=1; |
| [627](#L627) | else |
| [628](#L628) | $options['enable\_slideshow']=0; |
| [629](#L629) |  |
| [630](#L630) | $settings=update\_option('my\_responsive\_photo\_gallery\_slider\_settings',$options); |
| [631](#L631) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [632](#L632) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [633](#L633) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Settings saved successfully.','wp-responsive-photo-gallery' ); |
| [634](#L634) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [635](#L635) |  |
| [636](#L636) |  |
| [637](#L637) |  |
| [638](#L638) | } |
| [639](#L639) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [640](#L640) |  |
| [641](#L641) | ?> |
| [642](#L642) | <div style="width: 100%;"> |
| [643](#L643) | <div style="float:left;width:100%;"> |
| [644](#L644) | <div class="wrap"> |
| [645](#L645) | <table><tr> |
| [646](#L646) | <td> |
| [647](#L647) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [648](#L648) | <div id="fb-root"></div> |
| [649](#L649) | <script>(function(d, s, id) { |
| [650](#L650) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [651](#L651) | if (d.getElementById(id)) return; |
| [652](#L652) | js = d.createElement(s); js.id = id; |
| [653](#L653) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [654](#L654) | fjs.parentNode.insertBefore(js, fjs); |
| [655](#L655) | }(document, 'script', 'facebook-jssdk'));</script> |
| [656](#L656) | </td> |
| [657](#L657) | <td> |
| [658](#L658) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [659](#L659) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [660](#L660) | </a> |
| [661](#L661) | </td> |
| [662](#L662) | </tr> |
| [663](#L663) | </table> |
| [664](#L664) | <div style="clear:both"> |
| [665](#L665) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [666](#L666) | </div> |
| [667](#L667) | <?php |
| [668](#L668) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [669](#L669) | $type=''; |
| [670](#L670) | $message=''; |
| [671](#L671) | if(isset($messages['type']) and $messages['type']!=""){ |
| [672](#L672) |  |
| [673](#L673) | $type=$messages['type']; |
| [674](#L674) | $message=$messages['message']; |
| [675](#L675) |  |
| [676](#L676) | } |
| [677](#L677) |  |
| [678](#L678) |  |
| [679](#L679) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [680](#L680) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [681](#L681) |  |
| [682](#L682) |  |
| [683](#L683) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [684](#L684) | ?> |
| [685](#L685) |  |
| [686](#L686) |  |
| [687](#L687) | <h2><?php echo \_\_( 'Gallery Settings','wp-responsive-photo-gallery' );?></h2> |
| [688](#L688) |  |
| [689](#L689) | <div id="poststuff"> |
| [690](#L690) | <div id="post-body" class="metabox-holder columns-2"> |
| [691](#L691) | <div id="post-body-content"> |
| [692](#L692) | <form method="post" action="" id="scrollersettiings" name="scrollersettiings" > |
| [693](#L693) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [694](#L694) | <h3><label for="link\_name"><?php echo \_\_( 'Settings','wp-responsive-photo-gallery' );?></label></h3> |
| [695](#L695) | <table cellspacing="0" class="form-list" cellpadding="10"> |
| [696](#L696) | <tbody> |
| [697](#L697) | <tr> |
| [698](#L698) | <td class="label"> |
| [699](#L699) | <label for="transition\_speed"><?php echo \_\_( 'Transition Speed','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [700](#L700) | </td> |
| [701](#L701) | <td class="value"> |
| [702](#L702) | <input id="transition\_speed" value="<?php echo $settings['transition\_speed']; ?>" name="transition\_speed"  class="input-text" type="text"> |
| [703](#L703) | <div style="clear:both"></div> |
| [704](#L704) | <div></div> |
| [705](#L705) | </td> |
| [706](#L706) | </tr> |
| [707](#L707) | <tr> |
| [708](#L708) | <td class="label"> |
| [709](#L709) | <label for="transition\_interval"><?php echo \_\_( 'Transition Interval','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [710](#L710) | </td> |
| [711](#L711) | <td class="value"> |
| [712](#L712) | <input id="transition\_interval"  value="<?php echo $settings['transition\_interval']; ?>" name="transition\_interval"  class="input-text" type="text"> |
| [713](#L713) | <div style="clear:both"></div> |
| [714](#L714) | <div></div> |
| [715](#L715) | </td> |
| [716](#L716) | </tr> |
| [717](#L717) | <tr> |
| [718](#L718) | <td class="label"> |
| [719](#L719) | <label for="show\_panel\_nav"><?php echo \_\_( 'Show Slider Navigation arrows','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [720](#L720) | </td> |
| [721](#L721) | <td class="value"> |
| [722](#L722) | <select id="show\_panel\_nav" name="show\_panel\_nav" class="select"> |
| [723](#L723) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [724](#L724) | <option <?php if($settings['show\_panel\_nav']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [725](#L725) | <option <?php if($settings['show\_panel\_nav']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [726](#L726) | </select> |
| [727](#L727) | <div style="clear:both"></div> |
| [728](#L728) | <div></div> |
| [729](#L729) | </td> |
| [730](#L730) | </tr> |
| [731](#L731) | <tr> |
| [732](#L732) | <td class="label"> |
| [733](#L733) | <label for="panel\_width"><?php echo \_\_( 'Width','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [734](#L734) | </td> |
| [735](#L735) | <td class="value"> |
| [736](#L736) | <input id="panel\_width" value="<?php echo $settings['panel\_width']; ?>" name="panel\_width"  class="input-text" type="text"> |
| [737](#L737) | <div style="clear:both"></div> |
| [738](#L738) | <div></div> |
| [739](#L739) | </td> |
| [740](#L740) | </tr> |
| [741](#L741) | <tr> |
| [742](#L742) | <td class="label"> |
| [743](#L743) | <label for="panel\_height"><?php echo \_\_( 'Height','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [744](#L744) | </td> |
| [745](#L745) | <td class="value"> |
| [746](#L746) | <input id="panel\_height" value="<?php echo $settings['panel\_height']; ?>"  name="panel\_height"  class="input-text" type="text"> |
| [747](#L747) | <div style="clear:both"></div> |
| [748](#L748) | <div></div> |
| [749](#L749) | </td> |
| [750](#L750) | </tr> |
| [751](#L751) | <tr> |
| [752](#L752) | <td class="label"> |
| [753](#L753) | <label for="panel\_scale"><?php echo \_\_( 'Scale','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label> |
| [754](#L754) | </td> |
| [755](#L755) | <td class="value"> |
| [756](#L756) | <select id="panel\_scale" name="panel\_scale" class="select"> |
| [757](#L757) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [758](#L758) | <option <?php if($settings['panel\_scale']=='crop'):?> selected="selected" <?php endif;?> value="crop"><?php echo \_\_( 'Crop','wp-responsive-photo-gallery' );?></option> |
| [759](#L759) | <option <?php if($settings['panel\_scale']=='fit'):?> selected="selected" <?php endif;?> value="fit" ><?php echo \_\_( 'Fit','wp-responsive-photo-gallery' );?></option> |
| [760](#L760) | </select> |
| [761](#L761) | <div style="clear:both"></div> |
| [762](#L762) | <div></div> |
| [763](#L763) | </td> |
| [764](#L764) | </tr> |
| [765](#L765) | <tr> |
| [766](#L766) | <td class="label"> |
| [767](#L767) | <label for="pan\_images"><?php echo \_\_( 'Pan Images','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label> |
| [768](#L768) | </td> |
| [769](#L769) | <td class="value"> |
| [770](#L770) | <select id="pan\_images" name="pan\_images" class="select"> |
| [771](#L771) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [772](#L772) | <option <?php if($settings['pan\_images']==1):?> selected="selected" <?php endif;?>  value="1"><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [773](#L773) | <option <?php if($settings['pan\_images']==0):?> selected="selected" <?php endif;?>  value="0" ><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [774](#L774) | </select> |
| [775](#L775) | <div style="clear:both"></div> |
| [776](#L776) | <div></div> |
| [777](#L777) | </td> |
| [778](#L778) | </tr> |
| [779](#L779) | <tr> |
| [780](#L780) | <td class="label"> |
| [781](#L781) | <label for="pan\_style"><?php echo \_\_( 'Pan Style','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [782](#L782) | </td> |
| [783](#L783) | <td class="value"> |
| [784](#L784) | <select id="pan\_style" name="pan\_style" class="select"> |
| [785](#L785) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [786](#L786) | <option <?php if($settings['pan\_style']=='drag'):?> selected="selected" <?php endif;?>  value="drag"><?php echo \_\_( 'Drag','wp-responsive-photo-gallery' );?></option> |
| [787](#L787) | <option <?php if($settings['pan\_style']=='track'):?> selected="selected" <?php endif;?>  value="track" ><?php echo \_\_( 'Track','wp-responsive-photo-gallery' );?></option> |
| [788](#L788) | </select> |
| [789](#L789) | <div style="clear:both"></div> |
| [790](#L790) | <div></div> |
| [791](#L791) | </td> |
| [792](#L792) | </tr> |
| [793](#L793) | <tr> |
| [794](#L794) | <td class="label"> |
| [795](#L795) | <label for="show\_filmstrip"><?php echo \_\_( 'Show Thumbnail Gallery','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [796](#L796) | </td> |
| [797](#L797) | <td class="value"> |
| [798](#L798) | <select id="show\_filmstrip" name="show\_filmstrip" class="select"> |
| [799](#L799) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [800](#L800) | <option <?php if($settings['show\_filmstrip']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [801](#L801) | <option <?php if($settings['show\_filmstrip']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [802](#L802) | </select> |
| [803](#L803) | <div style="clear:both"></div> |
| [804](#L804) | <div></div> |
| [805](#L805) | </td> |
| [806](#L806) | </tr> |
| [807](#L807) | <tr> |
| [808](#L808) | <td class="label"><label for="autoplay"><?php echo \_\_( 'Auto play?','wp-responsive-photo-gallery' );?>   <span class="required">\*</span></label></td> |
| [809](#L809) | <td class="value"> |
| [810](#L810) | <select id="autoplay" name="autoplay" class="select"> |
| [811](#L811) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [812](#L812) | <option <?php if($settings['autoplay']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [813](#L813) | <option <?php if($settings['autoplay']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [814](#L814) | </select> |
| [815](#L815) | <div style="clear:both"></div> |
| [816](#L816) | <div></div> |
| [817](#L817) | </td> |
| [818](#L818) | </tr> |
| [819](#L819) | <tr> |
| [820](#L820) | <td class="label"> |
| [821](#L821) | <label for="frame\_width"><?php echo \_\_( 'Thumbnail Width','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [822](#L822) | </td> |
| [823](#L823) | <td class="value"> |
| [824](#L824) | <input id="frame\_width" value="<?php echo $settings['frame\_width']; ?>" name="frame\_width" value="80" class="input-text" type="text"> |
| [825](#L825) | <div style="clear:both"></div> |
| [826](#L826) | <div></div> |
| [827](#L827) | </td> |
| [828](#L828) | </tr> |
| [829](#L829) | <tr> |
| [830](#L830) | <td class="label"> |
| [831](#L831) | <label for="frame\_height"><?php echo \_\_( 'Thumbnail Height','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [832](#L832) | </td> |
| [833](#L833) | <td class="value"> |
| [834](#L834) | <input id="frame\_height" value="<?php echo $settings['frame\_height']; ?>" name="frame\_height"  class="input-text" type="text"> |
| [835](#L835) | <div style="clear:both"></div> |
| [836](#L836) | <div></div> |
| [837](#L837) | </td> |
| [838](#L838) | </tr> |
| [839](#L839) | <tr> |
| [840](#L840) | <td class="label"> |
| [841](#L841) | <label for="frame\_opacity"><?php echo \_\_( 'Thumbnail Opacity','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [842](#L842) | </td> |
| [843](#L843) | <td class="value"> |
| [844](#L844) | <input id="frame\_opacity" value="<?php echo $settings['frame\_opacity']; ?>" name="frame\_opacity"  class="input-text" type="text"> |
| [845](#L845) | <div style="clear:both"></div> |
| [846](#L846) | <div></div> |
| [847](#L847) | </td> |
| [848](#L848) | </tr> |
| [849](#L849) | <tr> |
| [850](#L850) | <td class="label"> |
| [851](#L851) | <label for="frame\_scale"><?php echo \_\_( 'Thumbnail Scale','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [852](#L852) | </td> |
| [853](#L853) | <td class="value"> |
| [854](#L854) | <select id="frame\_scale" name="frame\_scale" class="select"> |
| [855](#L855) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [856](#L856) | <option <?php if($settings['frame\_scale']=='crop'):?> selected="selected" <?php endif;?> value="crop" ><?php echo \_\_( 'Crop','wp-responsive-photo-gallery' );?></option> |
| [857](#L857) | <option <?php if($settings['frame\_scale']=='fit'):?> selected="selected" <?php endif;?>  value="fit"><?php echo \_\_( 'Fit','wp-responsive-photo-gallery' );?></option> |
| [858](#L858) | </select> |
| [859](#L859) | <div style="clear:both"></div> |
| [860](#L860) | <div></div> |
| [861](#L861) | </td> |
| [862](#L862) | </tr> |
| [863](#L863) | <tr> |
| [864](#L864) | <td class="label"> |
| [865](#L865) | <label for="frame\_gap"><?php echo \_\_( 'Thumbnail Gap','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [866](#L866) | </td> |
| [867](#L867) | <td class="value"> |
| [868](#L868) | <input id="frame\_gap" value="<?php echo $settings['frame\_gap']; ?>" name="frame\_gap"  class="input-text" type="text"> |
| [869](#L869) | <div style="clear:both"></div> |
| [870](#L870) | <div></div> |
| [871](#L871) | </td> |
| [872](#L872) | </tr> |
| [873](#L873) | <tr> |
| [874](#L874) | <td class="label"><label for="show\_infobar"><?php echo \_\_( 'Show Infobar?','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label></td> |
| [875](#L875) | <td class="value"> |
| [876](#L876) | <select id="show\_infobar" name="show\_infobar" class=" select"> |
| [877](#L877) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [878](#L878) | <option <?php if($settings['show\_infobar']==1):?> selected="selected" <?php endif;?>  value="1"><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [879](#L879) | <option <?php if($settings['show\_infobar']==0):?> selected="selected" <?php endif;?>  value="0" ><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [880](#L880) | </select> |
| [881](#L881) | <div style="clear:both"></div> |
| [882](#L882) | <div></div> |
| [883](#L883) | </td> |
| [884](#L884) | </tr> |
| [885](#L885) | <tr> |
| [886](#L886) | <td class="label"> |
| [887](#L887) | <label for="infobar\_opacity"><?php echo \_\_( 'Infobar Opacity','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [888](#L888) | </td> |
| [889](#L889) | <td class="value"> |
| [890](#L890) | <input id="infobar\_opacity" value="<?php echo $settings['infobar\_opacity']; ?>" name="infobar\_opacity"  class="input-text" type="text"> |
| [891](#L891) | <div style="clear:both"></div> |
| [892](#L892) | <div></div> |
| [893](#L893) | </td> |
| [894](#L894) | </tr> |
| [895](#L895) | <tr> |
| [896](#L896) | <td class="label"> |
| [897](#L897) | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
| [898](#L898) | <input type="submit"  name="btnsave" id="btnsave" value="<?php echo \_\_( 'Save Changes','wp-responsive-photo-gallery' );?>" class="button-primary"> |
| [899](#L899) | </td> |
| [900](#L900) | <td class="value"> |
| [901](#L901) |  |
| [902](#L902) | <input type="button" name="cancle" id="cancle" value="<?php echo \_\_( 'Cancel','wp-responsive-photo-gallery' );?>" class="button-primary" onclick="location.href='admin.php?page=responsive\_photo\_gallery\_slider'"> |
| [903](#L903) |  |
| [904](#L904) | </td> |
| [905](#L905) | </tr> |
| [906](#L906) | </tbody> |
| [907](#L907) | </table> |
| [908](#L908) | </div> |
| [909](#L909) | <input type="hidden" name="start\_frame" id="start\_frame" value="1"> |
| [910](#L910) | <input type="hidden" name="enable\_slideshow" id="start\_frame" value="1"> |
| [911](#L911) | <input type="hidden" name="panel\_animation" id="panel\_animation" value="fade"> |
| [912](#L912) | <input type="hidden" name="overlay\_position" id="overlay\_position" value="bottom"> |
| [913](#L913) | <input type="hidden" name="filmstrip\_position" id="filmstrip\_position" value="bottom"> |
| [914](#L914) | <input type="hidden" name="enable\_overlays" id="enable\_overlays" value="0"> |
| [915](#L915) | <input type="hidden" name="show\_captions" id="show\_captions" value="0"> |
| [916](#L916) | <input type="hidden" name="show\_filmstrip\_nav" id="show\_filmstrip\_nav" value="0"> |
| [917](#L917) | <input type="hidden" name="show\_panels" id="show\_panels" value="1"> |
| [918](#L918) | </form> |
| [919](#L919) | <script type="text/javascript"> |
| [920](#L920) |  |
| [921](#L921) | jQuery(document).ready(function() { |
| [922](#L922) |  |
| [923](#L923) | jQuery("#scrollersettiings").validate({ |
| [924](#L924) | rules: { |
| [925](#L925) | transition\_speed: { |
| [926](#L926) | required:true, |
| [927](#L927) | number:true, |
| [928](#L928) | maxlength:10 |
| [929](#L929) | },transition\_interval: { |
| [930](#L930) | required:true, |
| [931](#L931) | number:true, |
| [932](#L932) | maxlength:10 |
| [933](#L933) | },show\_panel\_nav: { |
| [934](#L934) | required:true, |
| [935](#L935) | }, |
| [936](#L936) | panel\_width:{ |
| [937](#L937) | required:true, |
| [938](#L938) | number:true, |
| [939](#L939) | maxlength:10 |
| [940](#L940) |  |
| [941](#L941) | }, |
| [942](#L942) | panel\_height:{ |
| [943](#L943) | required:true, |
| [944](#L944) | number:true, |
| [945](#L945) | maxlength:10 |
| [946](#L946) | }, |
| [947](#L947) | panel\_scale:{ |
| [948](#L948) | required:true |
| [949](#L949) | }, |
| [950](#L950) | pan\_images:{ |
| [951](#L951) | required:true |
| [952](#L952) |  |
| [953](#L953) | }, |
| [954](#L954) | pan\_style:{ |
| [955](#L955) | required:true |
| [956](#L956) | },show\_filmstrip:{ |
| [957](#L957) | required:true |
| [958](#L958) |  |
| [959](#L959) | },autoplay:{ |
| [960](#L960) | required:true |
| [961](#L961) |  |
| [962](#L962) | },frame\_width:{ |
| [963](#L963) | required:true, |
| [964](#L964) | number:true, |
| [965](#L965) | maxlength:10 |
| [966](#L966) | },frame\_height:{ |
| [967](#L967) | required:true, |
| [968](#L968) | number:true, |
| [969](#L969) | maxlength:10 |
| [970](#L970) | } |
| [971](#L971) | ,frame\_opacity:{ |
| [972](#L972) | required:true, |
| [973](#L973) | number:true, |
| [974](#L974) | maxlength:10 |
| [975](#L975) | } |
| [976](#L976) | ,frame\_scale:{ |
| [977](#L977) | required:true |
| [978](#L978) |  |
| [979](#L979) | },frame\_gap:{ |
| [980](#L980) | required:true, |
| [981](#L981) | number:true, |
| [982](#L982) | maxlength:10 |
| [983](#L983) |  |
| [984](#L984) | },show\_infobar:{ |
| [985](#L985) | required:true |
| [986](#L986) |  |
| [987](#L987) | },infobar\_opacity:{ |
| [988](#L988) | required:true, |
| [989](#L989) | number:true, |
| [990](#L990) | maxlength:10 |
| [991](#L991) | } |
| [992](#L992) |  |
| [993](#L993) | }, |
| [994](#L994) | errorClass: "image\_error", |
| [995](#L995) | errorPlacement: function(error, element) { |
| [996](#L996) | error.appendTo( element.next().next()); |
| [997](#L997) | } |
| [998](#L998) |  |
| [999](#L999) |  |
| [1000](#L1000) | }) |
| [1001](#L1001) | }); |
| [1002](#L1002) |  |
| [1003](#L1003) | </script> |
| [1004](#L1004) |  |
| [1005](#L1005) | </div> |
| [1006](#L1006) | <div id="postbox-container-1" class="postbox-container"  > |
| [1007](#L1007) |  |
| [1008](#L1008) | <div class="postbox"> |
| [1009](#L1009) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [1010](#L1010) | <div class="inside"> |
| [1011](#L1011) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [1012](#L1012) |  |
| [1013](#L1013) | <div style="margin:10px 5px"> |
| [1014](#L1014) |  |
| [1015](#L1015) | </div> |
| [1016](#L1016) | </div></div> |
| [1017](#L1017) | <div class="postbox"> |
| [1018](#L1018) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [1019](#L1019) | <div class="inside"> |
| [1020](#L1020) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px;width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>"  border="0"></a></center> |
| [1021](#L1021) | <div style="margin:10px 5px"> |
| [1022](#L1022) | </div> |
| [1023](#L1023) | </div></div> |
| [1024](#L1024) |  |
| [1025](#L1025) |  |
| [1026](#L1026) |  |
| [1027](#L1027) | </div> |
| [1028](#L1028) | <div class="clear"></div> |
| [1029](#L1029) | </div> |
| [1030](#L1030) |  |
| [1031](#L1031) | </div> |
| [1032](#L1032) | </div> |
| [1033](#L1033) | </div> |
| [1034](#L1034) |  |
| [1035](#L1035) |  |
| [1036](#L1036) |  |
| [1037](#L1037) | <div class="clear"></div></div> |
| [1038](#L1038) | <?php |
| [1039](#L1039) | } |
| [1040](#L1040) | function responsive\_photo\_gallery\_image\_management(){ |
| [1041](#L1041) |  |
| [1042](#L1042) |  |
| [1043](#L1043) | $uploads = wp\_upload\_dir (); |
| [1044](#L1044) | $baseDir = $uploads ['basedir']; |
| [1045](#L1045) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [1046](#L1046) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [1047](#L1047) |  |
| [1048](#L1048) | $baseurl=$uploads['baseurl']; |
| [1049](#L1049) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [1050](#L1050) |  |
| [1051](#L1051) | global $wpdb; |
| [1052](#L1052) |  |
| [1053](#L1053) |  |
| [1054](#L1054) | $action = 'gridview'; |
| [1055](#L1055) |  |
| [1056](#L1056) | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
| [1057](#L1057) |  |
| [1058](#L1058) | $action = trim ( sanitize\_text\_field($\_GET ['action'] )); |
| [1059](#L1059) |  |
| [1060](#L1060) | if(isset($\_GET['order\_by'])){ |
| [1061](#L1061) |  |
| [1062](#L1062) | if(sanitize\_sql\_orderby($\_GET['order\_by'])){ |
| [1063](#L1063) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1064](#L1064) | } |
| [1065](#L1065) | else{ |
| [1066](#L1066) |  |
| [1067](#L1067) | $order\_by=' id '; |
| [1068](#L1068) | } |
| [1069](#L1069) | } |
| [1070](#L1070) |  |
| [1071](#L1071) | if(isset($\_GET['order\_pos'])){ |
| [1072](#L1072) |  |
| [1073](#L1073) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1074](#L1074) | } |
| [1075](#L1075) |  |
| [1076](#L1076) | $search\_term\_=''; |
| [1077](#L1077) | if(isset($\_GET['search\_term'])){ |
| [1078](#L1078) |  |
| [1079](#L1079) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1080](#L1080) | } |
| [1081](#L1081) | } |
| [1082](#L1082) |  |
| [1083](#L1083) | $search\_term\_=''; |
| [1084](#L1084) | if(isset($\_GET['search\_term'])){ |
| [1085](#L1085) |  |
| [1086](#L1086) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1087](#L1087) | } |
| [1088](#L1088) |  |
| [1089](#L1089) | ?> |
| [1090](#L1090) |  |
| [1091](#L1091) | <?php |
| [1092](#L1092) | if(strtolower($action)==strtolower('gridview')){ |
| [1093](#L1093) |  |
| [1094](#L1094) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_view\_images' ) ) { |
| [1095](#L1095) |  |
| [1096](#L1096) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [1097](#L1097) |  |
| [1098](#L1098) | } |
| [1099](#L1099) |  |
| [1100](#L1100) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1101](#L1101) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1102](#L1102) |  |
| [1103](#L1103) |  |
| [1104](#L1104) |  |
| [1105](#L1105) | ?> |
| [1106](#L1106) | <div class="wrap"> |
| [1107](#L1107) | <table><tr> |
| [1108](#L1108) | <td> |
| [1109](#L1109) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [1110](#L1110) | <div id="fb-root"></div> |
| [1111](#L1111) | <script>(function(d, s, id) { |
| [1112](#L1112) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [1113](#L1113) | if (d.getElementById(id)) return; |
| [1114](#L1114) | js = d.createElement(s); js.id = id; |
| [1115](#L1115) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [1116](#L1116) | fjs.parentNode.insertBefore(js, fjs); |
| [1117](#L1117) | }(document, 'script', 'facebook-jssdk'));</script> |
| [1118](#L1118) | </td> |
| [1119](#L1119) | <td> |
| [1120](#L1120) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [1121](#L1121) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [1122](#L1122) | </a> |
| [1123](#L1123) | </td> |
| [1124](#L1124) | </tr> |
| [1125](#L1125) | </table> |
| [1126](#L1126) | <div style="clear:both"> |
| [1127](#L1127) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [1128](#L1128) | </div> |
| [1129](#L1129) |  |
| [1130](#L1130) | <?php |
| [1131](#L1131) |  |
| [1132](#L1132) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [1133](#L1133) | $type=''; |
| [1134](#L1134) | $message=''; |
| [1135](#L1135) | if(isset($messages['type']) and $messages['type']!=""){ |
| [1136](#L1136) |  |
| [1137](#L1137) | $type=$messages['type']; |
| [1138](#L1138) | $message=$messages['message']; |
| [1139](#L1139) |  |
| [1140](#L1140) | } |
| [1141](#L1141) |  |
| [1142](#L1142) |  |
| [1143](#L1143) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1144](#L1144) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1145](#L1145) |  |
| [1146](#L1146) |  |
| [1147](#L1147) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [1148](#L1148) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [1149](#L1149) | ?> |
| [1150](#L1150) | <div id="modelMainDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [1151](#L1151) | <div id="LoaderDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [1152](#L1152) | <div id="ContainDiv" style="display:none;z-index: 1056; position: fixed; padding: 5px; margin: 0px; width: 30%; top: 40%; left: 35%; text-align: center; color: rgb(0, 0, 0); border: 1px solid #999999; background-color: rgb(255, 255, 255); cursor: wait;" > |
| [1153](#L1153) | <img src="<?php echo $url.'images/ajax-loader.gif'?>" /> |
| [1154](#L1154) | <h5 id="wait"><?php echo \_\_('Please wait while uploading images...','wp-responsive-photo-gallery');?></h5> |
| [1155](#L1155) | </div> |
| [1156](#L1156) | <div id="poststuff" > |
| [1157](#L1157) | <div id="post-body" class="metabox-holder columns-2"> |
| [1158](#L1158) | <div id="post-body-content" > |
| [1159](#L1159) |  |
| [1160](#L1160) | <div class="icon32 icon32-posts-post" id="icon-edit"><br></div> |
| [1161](#L1161) | <h1> |
| [1162](#L1162) | <?php echo \_\_( 'Images','wp-responsive-photo-gallery' );?> <a class="button add-new-h2" href="admin.php?page=responsive\_photo\_gallery\_image\_management&action=addedit"><?php echo \_\_( 'Add New','wp-responsive-photo-gallery' );?></a> |
| [1163](#L1163) | &nbsp;&nbsp; |
| [1164](#L1164) | <a class="massAdd button add-new-h2" href="javascript:void(0)"><?php echo \_\_('Mass Add','wp-responsive-photo-gallery');?></a> |
| [1165](#L1165) |  |
| [1166](#L1166) | </h1> |
| [1167](#L1167) | <br/> |
| [1168](#L1168) |  |
| [1169](#L1169) | <form method="POST" action="admin.php?page=responsive\_photo\_gallery\_image\_management&action=deleteselected"  id="posts-filter" onkeypress="return event.keyCode != 13;"> |
| [1170](#L1170) | <div class="alignleft actions"> |
| [1171](#L1171) | <select name="action\_upper" id="action\_upper"> |
| [1172](#L1172) | <option selected="selected" value="-1"><?php echo \_\_( 'Bulk Actions','wp-responsive-photo-gallery' );?></option> |
| [1173](#L1173) | <option value="delete"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></option> |
| [1174](#L1174) | </select> |
| [1175](#L1175) | <input type="submit" value="<?php echo \_\_( 'Apply','wp-responsive-photo-gallery' );?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [1176](#L1176) | </div> |
| [1177](#L1177) | <br class="clear"> |
| [1178](#L1178) | <?php |
| [1179](#L1179) |  |
| [1180](#L1180) | $setacrionpage='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1181](#L1181) |  |
| [1182](#L1182) | if(isset($\_GET['order\_by']) and $\_GET['order\_by']!=""){ |
| [1183](#L1183) | $setacrionpage.='&order\_by='.esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1184](#L1184) | } |
| [1185](#L1185) |  |
| [1186](#L1186) | if(isset($\_GET['order\_pos']) and $\_GET['order\_pos']!=""){ |
| [1187](#L1187) | $setacrionpage.='&order\_pos='.esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1188](#L1188) | } |
| [1189](#L1189) |  |
| [1190](#L1190) | $seval=""; |
| [1191](#L1191) | if(isset($\_GET['search\_term']) and $\_GET['search\_term']!=""){ |
| [1192](#L1192) | $seval=esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) |  |
| [1196](#L1196) | $order\_by='id'; |
| [1197](#L1197) | $order\_pos="asc"; |
| [1198](#L1198) |  |
| [1199](#L1199) | if(isset($\_GET['order\_by']) and sanitize\_sql\_orderby($\_GET['order\_by'])!==false){ |
| [1200](#L1200) |  |
| [1201](#L1201) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1202](#L1202) | } |
| [1203](#L1203) |  |
| [1204](#L1204) | if(isset($\_GET['order\_pos'])){ |
| [1205](#L1205) |  |
| [1206](#L1206) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1207](#L1207) | } |
| [1208](#L1208) |  |
| [1209](#L1209) | $search\_term=''; |
| [1210](#L1210) | if(isset($\_GET['search\_term'])){ |
| [1211](#L1211) |  |
| [1212](#L1212) | $search\_term= esc\_html(sanitize\_text\_field(esc\_sql($\_GET['search\_term']))); |
| [1213](#L1213) | } |
| [1214](#L1214) |  |
| [1215](#L1215) |  |
| [1216](#L1216) | ?> |
| [1217](#L1217) | <?php |
| [1218](#L1218) |  |
| [1219](#L1219) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [1220](#L1220) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider "; |
| [1221](#L1221) | $queryCount="SELECT count(\*) FROM ".$wpdb->prefix."gv\_responsive\_slider "; |
| [1222](#L1222) | if($search\_term!=''){ |
| [1223](#L1223) | $query.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [1224](#L1224) | $queryCount.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [1225](#L1225) | } |
| [1226](#L1226) |  |
| [1227](#L1227) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [1228](#L1228) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [1229](#L1229) |  |
| [1230](#L1230) | $rowsCount=$wpdb->get\_var($queryCount); |
| [1231](#L1231) | $query.=" order by $order\_by $order\_pos"; |
| [1232](#L1232) |  |
| [1233](#L1233) |  |
| [1234](#L1234) | ?> |
| [1235](#L1235) |  |
| [1236](#L1236) | <div style="padding-top:5px;padding-bottom:5px"> |
| [1237](#L1237) | <b><?php echo \_\_( 'Search','wp-responsive-photo-gallery');?> : </b> |
| [1238](#L1238) | <input type="text" value="<?php echo $seval;?>" id="search\_term" name="search\_term">&nbsp; |
| [1239](#L1239) | <input type='button'  value='<?php echo \_\_( 'Search','wp-responsive-photo-gallery');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
| [1240](#L1240) | <input type='button'  value='<?php echo \_\_( 'Reset Search','wp-responsive-photo-gallery');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
| [1241](#L1241) | </div> |
| [1242](#L1242) | <script type="text/javascript" > |
| [1243](#L1243) |  |
| [1244](#L1244) | jQuery('#search\_term').on("keyup", function(e) { |
| [1245](#L1245) | if (e.which == 13) { |
| [1246](#L1246) |  |
| [1247](#L1247) | SearchredirectTO(); |
| [1248](#L1248) | } |
| [1249](#L1249) | }); |
| [1250](#L1250) | function SearchredirectTO(){ |
| [1251](#L1251) |  |
| [1252](#L1252) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [1253](#L1253) | var searchval=jQuery('#search\_term').val(); |
| [1254](#L1254) | redirectto=redirectto+'&search\_term='+jQuery.trim(encodeURIComponent(searchval)); |
| [1255](#L1255) | window.location.href=redirectto; |
| [1256](#L1256) | } |
| [1257](#L1257) | function ResetSearch(){ |
| [1258](#L1258) |  |
| [1259](#L1259) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [1260](#L1260) | window.location.href=redirectto; |
| [1261](#L1261) | exit; |
| [1262](#L1262) | } |
| [1263](#L1263) | </script> |
| [1264](#L1264) | <div id="no-more-tables"> |
| [1265](#L1265) | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf" > |
| [1266](#L1266) | <thead> |
| [1267](#L1267) | <tr> |
| [1268](#L1268) | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
| [1269](#L1269) | <?php if($order\_by=="id" and $order\_pos=="asc"):?> |
| [1270](#L1270) |  |
| [1271](#L1271) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1272](#L1272) | <?php else:?> |
| [1273](#L1273) | <?php if($order\_by=="id"):?> |
| [1274](#L1274) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1275](#L1275) | <?php else:?> |
| [1276](#L1276) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?></a></th> |
| [1277](#L1277) | <?php endif;?> |
| [1278](#L1278) | <?php endif;?> |
| [1279](#L1279) | <?php if($order\_by=="title" and $order\_pos=="asc"):?> |
| [1280](#L1280) |  |
| [1281](#L1281) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1282](#L1282) | <?php else:?> |
| [1283](#L1283) | <?php if($order\_by=="title"):?> |
| [1284](#L1284) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1285](#L1285) | <?php else:?> |
| [1286](#L1286) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?></a></th> |
| [1287](#L1287) | <?php endif;?> |
| [1288](#L1288) | <?php endif;?> |
| [1289](#L1289) | <th><span></span></th> |
| [1290](#L1290) | <?php if($order\_by=="createdon" and $order\_pos=="asc"):?> |
| [1291](#L1291) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1292](#L1292) | <?php else:?> |
| [1293](#L1293) | <?php if($order\_by=="createdon"):?> |
| [1294](#L1294) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1295](#L1295) | <?php else:?> |
| [1296](#L1296) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?></a></th> |
| [1297](#L1297) | <?php endif;?> |
| [1298](#L1298) | <?php endif;?> |
| [1299](#L1299) | <th><span><?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?></span></th> |
| [1300](#L1300) | <th><span><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></span></th> |
| [1301](#L1301) | </tr> |
| [1302](#L1302) | </thead> |
| [1303](#L1303) | <tbody id="the-list"> |
| [1304](#L1304) | <?php |
| [1305](#L1305) |  |
| [1306](#L1306) | if($rowsCount > 0){ |
| [1307](#L1307) |  |
| [1308](#L1308) | global $wp\_rewrite; |
| [1309](#L1309) | $rows\_per\_page = 10; |
| [1310](#L1310) |  |
| [1311](#L1311) | $current = (isset($\_GET['paged'])) ? (intval($\_GET['paged'])) : 1; |
| [1312](#L1312) | $pagination\_args = array( |
| [1313](#L1313) | 'base' => @add\_query\_arg('paged','%#%'), |
| [1314](#L1314) | 'format' => '', |
| [1315](#L1315) | 'total' => ceil($rowsCount/$rows\_per\_page), |
| [1316](#L1316) | 'current' => $current, |
| [1317](#L1317) | 'show\_all' => false, |
| [1318](#L1318) | 'type' => 'plain', |
| [1319](#L1319) | ); |
| [1320](#L1320) |  |
| [1321](#L1321) |  |
| [1322](#L1322) | $offset = ($current - 1) \* $rows\_per\_page; |
| [1323](#L1323) | $query.=" limit $offset, $rows\_per\_page"; |
| [1324](#L1324) | $rows = $wpdb->get\_results ( $query ,ARRAY\_A); |
| [1325](#L1325) | $delRecNonce=wp\_create\_nonce('delete\_image'); |
| [1326](#L1326) |  |
| [1327](#L1327) | foreach ($rows as $row ) { |
| [1328](#L1328) |  |
| [1329](#L1329) | $id=$row['id']; |
| [1330](#L1330) | $editlink="admin.php?page=responsive\_photo\_gallery\_image\_management&action=addedit&id=$id"; |
| [1331](#L1331) | $deletelink="admin.php?page=responsive\_photo\_gallery\_image\_management&action=delete&id=$id&nonce=$delRecNonce"; |
| [1332](#L1332) | $outputimgmain = $baseurl.$row['image\_name']; |
| [1333](#L1333) |  |
| [1334](#L1334) | ?> |
| [1335](#L1335) | <tr valign="top"> |
| [1336](#L1336) | <td class="alignCenter check-column"   data-title="<?php echo \_\_( 'Select Record','wp-responsive-photo-gallery' );?>" ><input type="checkbox" value="<?php echo $row['id']; ?>" name="thumbnails[]"></td> |
| [1337](#L1337) | <td class="alignCenter" data-title="<?php echo \_\_( 'ID','wp-responsive-photo-gallery' );?>"><strong><?php echo $row['id']; ?></strong></td> |
| [1338](#L1338) | <td class="alignCenter" data-title="<?php echo \_\_( 'Title','wp-responsive-photo-gallery' );?>"><strong><?php echo $row['title']; ?></strong></td> |
| [1339](#L1339) | <td class="alignCenter"> |
| [1340](#L1340) | <img src="<?php echo $outputimgmain;?>" style="width:50px" height="50px"/> |
| [1341](#L1341) | </td> |
| [1342](#L1342) | <td class="alignCenter" data-title="<?php echo \_\_( 'Published On','wp-responsive-photo-gallery' );?>"><?php echo $row['createdon'] ?></td> |
| [1343](#L1343) | <td class="alignCenter"   data-title="<?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?>"><strong><a href='<?php echo $editlink; ?>' title="<?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?>"><?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?></a></strong></td> |
| [1344](#L1344) | <td class="alignCenter"   data-title="<?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?>"><strong><a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();"  title="<?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?>"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></a> </strong></td> |
| [1345](#L1345) | </tr> |
| [1346](#L1346) | <?php |
| [1347](#L1347) | } |
| [1348](#L1348) | } |
| [1349](#L1349) | else{ |
| [1350](#L1350) | ?> |
| [1351](#L1351) |  |
| [1352](#L1352) | <tr valign="top" class="" id=""> |
| [1353](#L1353) | <td colspan="7" data-title="No Record" align="center"><strong><?php echo \_\_( 'No Images Found','wp-responsive-photo-gallery' );?></strong></td> |
| [1354](#L1354) | </tr> |
| [1355](#L1355) | <?php |
| [1356](#L1356) | } |
| [1357](#L1357) | ?> |
| [1358](#L1358) | </tbody> |
| [1359](#L1359) | </table> |
| [1360](#L1360) | </div> |
| [1361](#L1361) | <?php |
| [1362](#L1362) | if($rowsCount>0){ |
| [1363](#L1363) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [1364](#L1364) | echo paginate\_links($pagination\_args); |
| [1365](#L1365) | echo "</div>"; |
| [1366](#L1366) | } |
| [1367](#L1367) | ?> |
| [1368](#L1368) | <br/> |
| [1369](#L1369) | <div class="alignleft actions"> |
| [1370](#L1370) | <select name="action" id="action\_bottom"> |
| [1371](#L1371) | <option selected="selected" value="-1"><?php echo \_\_( 'Bulk Actions','wp-responsive-photo-gallery' );?></option> |
| [1372](#L1372) | <option value="delete"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></option> |
| [1373](#L1373) | </select> |
| [1374](#L1374) | <?php wp\_nonce\_field('action\_settings\_mass\_delete','mass\_delete\_nonce'); ?> |
| [1375](#L1375) | <input type="submit" value="<?php echo \_\_( 'Apply','wp-responsive-photo-gallery' );?>" class="button-secondary action" id="deleteselected" name="deleteselected"> |
| [1376](#L1376) | </div> |
| [1377](#L1377) |  |
| [1378](#L1378) | </form> |
| [1379](#L1379) | <script type="text/JavaScript"> |
| [1380](#L1380) |  |
| [1381](#L1381) | function  confirmDelete\_bulk(){ |
| [1382](#L1382) | var topval=document.getElementById("action\_bottom").value; |
| [1383](#L1383) | var bottomVal=document.getElementById("action\_upper").value; |
| [1384](#L1384) |  |
| [1385](#L1385) | if(topval=='delete' || bottomVal=='delete'){ |
| [1386](#L1386) |  |
| [1387](#L1387) |  |
| [1388](#L1388) | var agree=confirm("<?php echo \_\_( 'Are you sure you want to delete selected images','wp-responsive-photo-gallery' );?> ?"); |
| [1389](#L1389) | if (agree) |
| [1390](#L1390) | return true ; |
| [1391](#L1391) | else |
| [1392](#L1392) | return false; |
| [1393](#L1393) | } |
| [1394](#L1394) | } |
| [1395](#L1395) | function  confirmDelete(){ |
| [1396](#L1396) | var agree=confirm("<?php echo \_\_( 'Are you sure you want to delete this image ?','wp-responsive-photo-gallery' );?>"); |
| [1397](#L1397) | if (agree) |
| [1398](#L1398) | return true ; |
| [1399](#L1399) | else |
| [1400](#L1400) | return false; |
| [1401](#L1401) | } |
| [1402](#L1402) |  |
| [1403](#L1403) | var nonce\_sec='<?php echo wp\_create\_nonce( "thumbnail-mass-image" );?>'; |
| [1404](#L1404) | jQuery(document).ready(function() { |
| [1405](#L1405) | //uploading files variable |
| [1406](#L1406) | var custom\_file\_frame; |
| [1407](#L1407) | jQuery(".massAdd").click(function(event) { |
| [1408](#L1408) | var slider\_id=jQuery(this).attr('id'); |
| [1409](#L1409) | event.preventDefault(); |
| [1410](#L1410) | //If the frame already exists, reopen it |
| [1411](#L1411) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [1412](#L1412) | custom\_file\_frame.close(); |
| [1413](#L1413) | } |
| [1414](#L1414) |  |
| [1415](#L1415) | //Create WP media frame. |
| [1416](#L1416) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [1417](#L1417) | //Title of media manager frame |
| [1418](#L1418) | title: "<?php echo \_\_("WP Media Uploader",'wp-responsive-photo-gallery');?>", |
| [1419](#L1419) | library: { |
| [1420](#L1420) | type: 'image' |
| [1421](#L1421) | }, |
| [1422](#L1422) | button: { |
| [1423](#L1423) | //Button text |
| [1424](#L1424) | text: "<?php echo \_\_("Set Image",'wp-responsive-photo-gallery');?>" |
| [1425](#L1425) | }, |
| [1426](#L1426) | //Do not allow multiple files, if you want multiple, set true |
| [1427](#L1427) | multiple: true |
| [1428](#L1428) | }); |
| [1429](#L1429) |  |
| [1430](#L1430) | //callback for selected image |
| [1431](#L1431) |  |
| [1432](#L1432) | custom\_file\_frame.on('select', function() { |
| [1433](#L1433) |  |
| [1434](#L1434) |  |
| [1435](#L1435) | jQuery("#modelMainDiv").show(); |
| [1436](#L1436) | jQuery("#LoaderDiv").show(); |
| [1437](#L1437) | jQuery("#ContainDiv").show(); |
| [1438](#L1438) | var selection = custom\_file\_frame.state().get('selection'); |
| [1439](#L1439) | selection.map(function(attachment) { |
| [1440](#L1440) |  |
| [1441](#L1441) | attachment = attachment.toJSON(); |
| [1442](#L1442) | var validExtensions=new Array(); |
| [1443](#L1443) | validExtensions[0]='jpg'; |
| [1444](#L1444) | validExtensions[1]='jpeg'; |
| [1445](#L1445) | validExtensions[2]='png'; |
| [1446](#L1446) | validExtensions[3]='gif'; |
| [1447](#L1447) |  |
| [1448](#L1448) |  |
| [1449](#L1449) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [1450](#L1450) |  |
| [1451](#L1451) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [1452](#L1452) |  |
| [1453](#L1453) | var titleTouse=""; |
| [1454](#L1454) | var imageDescriptionTouse=""; |
| [1455](#L1455) |  |
| [1456](#L1456) | if(jQuery.trim(attachment.title)!=''){ |
| [1457](#L1457) |  |
| [1458](#L1458) | titleTouse=jQuery.trim(attachment.title); |
| [1459](#L1459) | } |
| [1460](#L1460) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1461](#L1461) |  |
| [1462](#L1462) | titleTouse=jQuery.trim(attachment.caption); |
| [1463](#L1463) | } |
| [1464](#L1464) |  |
| [1465](#L1465) | if(jQuery.trim(attachment.description)!=''){ |
| [1466](#L1466) |  |
| [1467](#L1467) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [1468](#L1468) | } |
| [1469](#L1469) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1470](#L1470) |  |
| [1471](#L1471) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [1472](#L1472) | } |
| [1473](#L1473) |  |
| [1474](#L1474) | var data = { |
| [1475](#L1475) | imagetitle:titleTouse, |
| [1476](#L1476) | image\_description: imageDescriptionTouse, |
| [1477](#L1477) | attachment\_id:attachment.id, |
| [1478](#L1478) | slider\_id:slider\_id, |
| [1479](#L1479) | action: 'mass\_upload\_wpresponsivephgallery', |
| [1480](#L1480) | thumbnail\_security:nonce\_sec |
| [1481](#L1481) | }; |
| [1482](#L1482) |  |
| [1483](#L1483) | url='admin.php?page=responsive\_photo\_gallery\_image\_management&action=mass\_upload\_wpresponsivephgallery' |
| [1484](#L1484) | jQuery.ajax({ |
| [1485](#L1485) | type: 'POST', |
| [1486](#L1486) | url: ajaxurl, |
| [1487](#L1487) | data: data, |
| [1488](#L1488) | success: function(result) { |
| [1489](#L1489) | if(result.isOk == false) |
| [1490](#L1490) | alert(result.message); |
| [1491](#L1491) | }, |
| [1492](#L1492) | dataType:'html', |
| [1493](#L1493) | async:false |
| [1494](#L1494) | }); |
| [1495](#L1495) |  |
| [1496](#L1496) |  |
| [1497](#L1497) | } |
| [1498](#L1498) |  |
| [1499](#L1499) | }); |
| [1500](#L1500) |  |
| [1501](#L1501) | jQuery("#modelMainDiv").hide(); |
| [1502](#L1502) | jQuery("#LoaderDiv").hide(); |
| [1503](#L1503) | jQuery("#ContainDiv").hide(); |
| [1504](#L1504) |  |
| [1505](#L1505) | }); |
| [1506](#L1506) |  |
| [1507](#L1507) | custom\_file\_frame.on('close', function() { |
| [1508](#L1508) | window.location.reload(); |
| [1509](#L1509) | }); |
| [1510](#L1510) |  |
| [1511](#L1511) | //Open modal |
| [1512](#L1512) | custom\_file\_frame.open(); |
| [1513](#L1513) | }); |
| [1514](#L1514) | }) |
| [1515](#L1515) | </script> |
| [1516](#L1516) |  |
| [1517](#L1517) | <br class="clear"> |
| [1518](#L1518) |  |
| [1519](#L1519) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress Post/Page use below Short code','wp-responsive-photo-gallery' );?></h3> |
| [1520](#L1520) | <input type="text" value="[print\_my\_responsive\_photo\_gallery]" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [1521](#L1521) | <div class="clear"></div> |
| [1522](#L1522) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress theme/template PHP files use below php code','wp-responsive-photo-gallery' );?></h3> |
| [1523](#L1523) | <input type="text" value="&lt;?php echo do\_shortcode('[print\_my\_responsive\_photo\_gallery]'); ?&gt;" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [1524](#L1524) |  |
| [1525](#L1525) | <div class="clear"></div> |
| [1526](#L1526) | </div> |
| [1527](#L1527) | <div id="postbox-container-1" class="postbox-container"  > |
| [1528](#L1528) |  |
| [1529](#L1529) | <div class="postbox"> |
| [1530](#L1530) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [1531](#L1531) | <div class="inside"> |
| [1532](#L1532) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [1533](#L1533) |  |
| [1534](#L1534) | <div style="margin:10px 5px"> |
| [1535](#L1535) |  |
| [1536](#L1536) | </div> |
| [1537](#L1537) | </div></div> |
| [1538](#L1538) | <div class="postbox"> |
| [1539](#L1539) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [1540](#L1540) | <div class="inside"> |
| [1541](#L1541) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [1542](#L1542) | <div style="margin:10px 5px"> |
| [1543](#L1543) | </div> |
| [1544](#L1544) | </div></div> |
| [1545](#L1545) |  |
| [1546](#L1546) |  |
| [1547](#L1547) | </div> |
| [1548](#L1548) | <div class="clear"></div> |
| [1549](#L1549) | </div> |
| [1550](#L1550) |  |
| [1551](#L1551) | <div style="clear: both;"></div> |
| [1552](#L1552) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
| [1553](#L1553) | </div> |
| [1554](#L1554) | </div> |
| [1555](#L1555) |  |
| [1556](#L1556) | <?php |
| [1557](#L1557) | } |
| [1558](#L1558) | else if(strtolower($action)==strtolower('addedit')){ |
| [1559](#L1559) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [1560](#L1560) |  |
| [1561](#L1561) | ?> |
| [1562](#L1562) | <?php |
| [1563](#L1563) | if(isset($\_POST['btnsave'])){ |
| [1564](#L1564) |  |
| [1565](#L1565) | //edit save |
| [1566](#L1566) | if(isset($\_POST['imageid'])){ |
| [1567](#L1567) |  |
| [1568](#L1568) | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
| [1569](#L1569) |  |
| [1570](#L1570) | wp\_die('Security check fail'); |
| [1571](#L1571) | } |
| [1572](#L1572) |  |
| [1573](#L1573) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ) { |
| [1574](#L1574) |  |
| [1575](#L1575) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1576](#L1576) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1577](#L1577) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1578](#L1578) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1579](#L1579) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1580](#L1580) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1581](#L1581) | exit; |
| [1582](#L1582) |  |
| [1583](#L1583) | } |
| [1584](#L1584) |  |
| [1585](#L1585) |  |
| [1586](#L1586) |  |
| [1587](#L1587) | //add new |
| [1588](#L1588) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1589](#L1589) | $title=trim(htmlentities(sanitize\_text\_field($\_POST['imagetitle']),ENT\_QUOTES)); |
| [1590](#L1590) | $imageurl=trim(htmlentities(esc\_url\_raw($\_POST['imageurl']),ENT\_QUOTES)); |
| [1591](#L1591) | $imageid=intval(htmlentities(sanitize\_text\_field($\_POST['imageid']),ENT\_QUOTES)); |
| [1592](#L1592) | $imagename=""; |
| [1593](#L1593) | if(trim($\_POST['HdnMediaSelection'])!=''){ |
| [1594](#L1594) |  |
| [1595](#L1595) | $postThumbnailID=(int) htmlentities(strip\_tags($\_POST['HdnMediaSelection']),ENT\_QUOTES); |
| [1596](#L1596) | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
| [1597](#L1597) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [1598](#L1598) |  |
| [1599](#L1599) | $fileName=$photoMeta['file']; |
| [1600](#L1600) | $phyPath=ABSPATH; |
| [1601](#L1601) | $phyPath=str\_replace("\\","/",$phyPath); |
| [1602](#L1602) |  |
| [1603](#L1603) | $pathArray=pathinfo($fileName); |
| [1604](#L1604) |  |
| [1605](#L1605) | $imagename=$pathArray['basename']; |
| [1606](#L1606) |  |
| [1607](#L1607) | $upload\_dir\_n = wp\_upload\_dir(); |
| [1608](#L1608) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [1609](#L1609) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [1610](#L1610) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [1611](#L1611) |  |
| [1612](#L1612) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1613](#L1613) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1614](#L1614) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [1615](#L1615) |  |
| [1616](#L1616) | @copy($fileUrl, $imageUploadTo); |
| [1617](#L1617) | if(!file\_exists($imageUploadTo)){ |
| [1618](#L1618) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [1619](#L1619) | } |
| [1620](#L1620) |  |
| [1621](#L1621) |  |
| [1622](#L1622) | } |
| [1623](#L1623) |  |
| [1624](#L1624) | } |
| [1625](#L1625) |  |
| [1626](#L1626) |  |
| [1627](#L1627) | try{ |
| [1628](#L1628) | if($imagename!=""){ |
| [1629](#L1629) | $query = "update ".$wpdb->prefix."gv\_responsive\_slider set title='$title',image\_name='$imagename', |
| [1630](#L1630) | custom\_link='$imageurl' where id=$imageid"; |
| [1631](#L1631) | } |
| [1632](#L1632) | else{ |
| [1633](#L1633) | $query = "update ".$wpdb->prefix."gv\_responsive\_slider set title='$title', |
| [1634](#L1634) | custom\_link='$imageurl' where id=$imageid"; |
| [1635](#L1635) | } |
| [1636](#L1636) | $wpdb->query($query); |
| [1637](#L1637) |  |
| [1638](#L1638) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1639](#L1639) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [1640](#L1640) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Image updated successfully.','wp-responsive-photo-gallery' ); |
| [1641](#L1641) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1642](#L1642) |  |
| [1643](#L1643) |  |
| [1644](#L1644) | } |
| [1645](#L1645) | catch(Exception $e){ |
| [1646](#L1646) |  |
| [1647](#L1647) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1648](#L1648) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1649](#L1649) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Error while updating image.','wp-responsive-photo-gallery' ); |
| [1650](#L1650) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1651](#L1651) | } |
| [1652](#L1652) |  |
| [1653](#L1653) |  |
| [1654](#L1654) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1655](#L1655) | } |
| [1656](#L1656) | else{ |
| [1657](#L1657) |  |
| [1658](#L1658) | //add new |
| [1659](#L1659) |  |
| [1660](#L1660) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [1661](#L1661) |  |
| [1662](#L1662) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1663](#L1663) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1664](#L1664) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1665](#L1665) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1666](#L1666) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1667](#L1667) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1668](#L1668) | exit; |
| [1669](#L1669) |  |
| [1670](#L1670) | } |
| [1671](#L1671) |  |
| [1672](#L1672) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1673](#L1673) | $title=trim(htmlentities(sanitize\_text\_field($\_POST['imagetitle']),ENT\_QUOTES)); |
| [1674](#L1674) | $imageurl=trim(htmlentities(esc\_url\_raw($\_POST['imageurl']),ENT\_QUOTES)); |
| [1675](#L1675) | $createdOn=date('Y-m-d h:i:s'); |
| [1676](#L1676) | if(function\_exists('date\_i18n')){ |
| [1677](#L1677) |  |
| [1678](#L1678) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [1679](#L1679) | if(get\_option('time\_format')=='H:i') |
| [1680](#L1680) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [1681](#L1681) | else |
| [1682](#L1682) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [1683](#L1683) |  |
| [1684](#L1684) | } |
| [1685](#L1685) |  |
| [1686](#L1686) |  |
| [1687](#L1687) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1688](#L1688) |  |
| [1689](#L1689) | try{ |
| [1690](#L1690) |  |
| [1691](#L1691) | if(trim($\_POST['HdnMediaSelection'])!=''){ |
| [1692](#L1692) |  |
| [1693](#L1693) | $postThumbnailID=(int) htmlentities(strip\_tags($\_POST['HdnMediaSelection']),ENT\_QUOTES); |
| [1694](#L1694) | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
| [1695](#L1695) |  |
| [1696](#L1696) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [1697](#L1697) |  |
| [1698](#L1698) | $fileName=$photoMeta['file']; |
| [1699](#L1699) | $phyPath=ABSPATH; |
| [1700](#L1700) | $phyPath=str\_replace("\\","/",$phyPath); |
| [1701](#L1701) |  |
| [1702](#L1702) | $pathArray=pathinfo($fileName); |
| [1703](#L1703) |  |
| [1704](#L1704) | $imagename=$pathArray['basename']; |
| [1705](#L1705) |  |
| [1706](#L1706) | $upload\_dir\_n = wp\_upload\_dir(); |
| [1707](#L1707) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [1708](#L1708) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [1709](#L1709) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [1710](#L1710) |  |
| [1711](#L1711) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1712](#L1712) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1713](#L1713) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [1714](#L1714) |  |
| [1715](#L1715) | @copy($fileUrl, $imageUploadTo); |
| [1716](#L1716) | if(!file\_exists($imageUploadTo)){ |
| [1717](#L1717) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [1718](#L1718) | } |
| [1719](#L1719) |  |
| [1720](#L1720) | } |
| [1721](#L1721) |  |
| [1722](#L1722) | } |
| [1723](#L1723) |  |
| [1724](#L1724) |  |
| [1725](#L1725) | $query = "INSERT INTO ".$wpdb->prefix."gv\_responsive\_slider (title, image\_name,createdon,custom\_link) |
| [1726](#L1726) | VALUES ('$title','$imagename','$createdOn','$imageurl')"; |
| [1727](#L1727) |  |
| [1728](#L1728) | $wpdb->query($query); |
| [1729](#L1729) |  |
| [1730](#L1730) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1731](#L1731) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [1732](#L1732) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='New image added successfully.'; |
| [1733](#L1733) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1734](#L1734) |  |
| [1735](#L1735) |  |
| [1736](#L1736) | } |
| [1737](#L1737) | catch(Exception $e){ |
| [1738](#L1738) |  |
| [1739](#L1739) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1740](#L1740) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1741](#L1741) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='Error while adding image.'; |
| [1742](#L1742) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1743](#L1743) | } |
| [1744](#L1744) |  |
| [1745](#L1745) |  |
| [1746](#L1746) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1747](#L1747) |  |
| [1748](#L1748) | } |
| [1749](#L1749) |  |
| [1750](#L1750) | } |
| [1751](#L1751) | else{ |
| [1752](#L1752) |  |
| [1753](#L1753) | ?> |
| [1754](#L1754) | <div style="width: 100%;"> |
| [1755](#L1755) | <div style="float:left;width:100%;" > |
| [1756](#L1756) | <div class="wrap"> |
| [1757](#L1757) | <?php if(isset($\_GET['id']) and intval($\_GET['id'])>0) |
| [1758](#L1758) | { |
| [1759](#L1759) |  |
| [1760](#L1760) |  |
| [1761](#L1761) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ) { |
| [1762](#L1762) |  |
| [1763](#L1763) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1764](#L1764) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1765](#L1765) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1766](#L1766) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1767](#L1767) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1768](#L1768) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1769](#L1769) | exit; |
| [1770](#L1770) |  |
| [1771](#L1771) | } |
| [1772](#L1772) |  |
| [1773](#L1773) | $id= intval($\_GET['id']); |
| [1774](#L1774) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$id"; |
| [1775](#L1775) | $myrow  = $wpdb->get\_row($query); |
| [1776](#L1776) |  |
| [1777](#L1777) | if(is\_object($myrow)){ |
| [1778](#L1778) |  |
| [1779](#L1779) | $title=$myrow->title; |
| [1780](#L1780) | $image\_link=$myrow->custom\_link; |
| [1781](#L1781) | $image\_name=$myrow->image\_name; |
| [1782](#L1782) |  |
| [1783](#L1783) | } |
| [1784](#L1784) |  |
| [1785](#L1785) | ?> |
| [1786](#L1786) |  |
| [1787](#L1787) | <h2><?php echo \_\_( 'Update Image','wp-responsive-photo-gallery' );?> </h2> |
| [1788](#L1788) |  |
| [1789](#L1789) | <?php }else{ |
| [1790](#L1790) |  |
| [1791](#L1791) | $title=''; |
| [1792](#L1792) | $image\_link=''; |
| [1793](#L1793) | $image\_name=''; |
| [1794](#L1794) |  |
| [1795](#L1795) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [1796](#L1796) |  |
| [1797](#L1797) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1798](#L1798) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1799](#L1799) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1800](#L1800) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1801](#L1801) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1802](#L1802) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1803](#L1803) | exit; |
| [1804](#L1804) |  |
| [1805](#L1805) | } |
| [1806](#L1806) | ?> |
| [1807](#L1807) | <div style="clear:both"> |
| [1808](#L1808) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [1809](#L1809) | </div> |
| [1810](#L1810) | <h2><?php echo \_\_( 'Add Image','wp-responsive-photo-gallery' );?></h2> |
| [1811](#L1811) | <?php } ?> |
| [1812](#L1812) |  |
| [1813](#L1813) | <div id="poststuff"> |
| [1814](#L1814) | <div id="post-body" class="metabox-holder columns-2"> |
| [1815](#L1815) | <div id="post-body-content"> |
| [1816](#L1816) | <form method="post" action="" id="addimage" name="addimage" enctype="multipart/form-data" > |
| [1817](#L1817) |  |
| [1818](#L1818) | <div class="stuffbox" id="namediv" style="width:100%;"> |
| [1819](#L1819) | <h3><label for="link\_name"><?php echo \_\_( 'Upload Image','wp-responsive-photo-gallery' );?></label></h3> |
| [1820](#L1820) | <div class="inside" id="fileuploaddiv"> |
| [1821](#L1821) | <?php if($image\_name!=""){ ?> |
| [1822](#L1822) | <div><b><?php echo \_\_( 'Current Image :','wp-responsive-photo-gallery' );?></b><a id="currImg" href="<?php echo $baseurl.$image\_name; ?>" target="\_new"><?php echo $image\_name; ?></a></div> |
| [1823](#L1823) | <?php } ?> |
| [1824](#L1824) |  |
| [1825](#L1825) | <div class="uploader"> |
| [1826](#L1826) |  |
| [1827](#L1827) | <a href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_( 'Click Here to upload','wp-responsive-photo-gallery' );?></b></a> |
| [1828](#L1828) | <input id="HdnMediaSelection" name="HdnMediaSelection" type="hidden" value="" /> |
| [1829](#L1829) | <br/> |
| [1830](#L1830) | </div> |
| [1831](#L1831) |  |
| [1832](#L1832) | <script> |
| [1833](#L1833) |  |
| [1834](#L1834) | jQuery(document).ready(function() { |
| [1835](#L1835) | //uploading files variable |
| [1836](#L1836) | var custom\_file\_frame; |
| [1837](#L1837) | jQuery("#myMediaUploader").click(function(event) { |
| [1838](#L1838) | event.preventDefault(); |
| [1839](#L1839) | //If the frame already exists, reopen it |
| [1840](#L1840) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [1841](#L1841) | custom\_file\_frame.close(); |
| [1842](#L1842) | } |
| [1843](#L1843) |  |
| [1844](#L1844) | //Create WP media frame. |
| [1845](#L1845) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [1846](#L1846) | //Title of media manager frame |
| [1847](#L1847) | title: "<?php echo \_\_( 'WP Media Uploader','wp-responsive-photo-gallery' );?>", |
| [1848](#L1848) | library: { |
| [1849](#L1849) | type: 'image' |
| [1850](#L1850) | }, |
| [1851](#L1851) | button: { |
| [1852](#L1852) | //Button text |
| [1853](#L1853) | text: "<?php echo \_\_( 'Set Image','wp-responsive-photo-gallery' );?>" |
| [1854](#L1854) | }, |
| [1855](#L1855) | //Do not allow multiple files, if you want multiple, set true |
| [1856](#L1856) | multiple: false |
| [1857](#L1857) | }); |
| [1858](#L1858) |  |
| [1859](#L1859) | //callback for selected image |
| [1860](#L1860) | custom\_file\_frame.on('select', function() { |
| [1861](#L1861) |  |
| [1862](#L1862) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [1863](#L1863) |  |
| [1864](#L1864) | var validExtensions=new Array(); |
| [1865](#L1865) | validExtensions[0]='jpg'; |
| [1866](#L1866) | validExtensions[1]='jpeg'; |
| [1867](#L1867) | validExtensions[2]='png'; |
| [1868](#L1868) | validExtensions[3]='gif'; |
| [1869](#L1869) |  |
| [1870](#L1870) |  |
| [1871](#L1871) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [1872](#L1872) |  |
| [1873](#L1873) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [1874](#L1874) |  |
| [1875](#L1875) | var titleTouse=""; |
| [1876](#L1876) | var imageDescriptionTouse=""; |
| [1877](#L1877) |  |
| [1878](#L1878) | if(jQuery.trim(attachment.title)!=''){ |
| [1879](#L1879) |  |
| [1880](#L1880) | titleTouse=jQuery.trim(attachment.title); |
| [1881](#L1881) | } |
| [1882](#L1882) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1883](#L1883) |  |
| [1884](#L1884) | titleTouse=jQuery.trim(attachment.caption); |
| [1885](#L1885) | } |
| [1886](#L1886) |  |
| [1887](#L1887) | if(jQuery.trim(attachment.description)!=''){ |
| [1888](#L1888) |  |
| [1889](#L1889) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [1890](#L1890) | } |
| [1891](#L1891) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1892](#L1892) |  |
| [1893](#L1893) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [1894](#L1894) | } |
| [1895](#L1895) |  |
| [1896](#L1896) | jQuery("#imagetitle").val(titleTouse); |
| [1897](#L1897) | jQuery("#image\_description").val(imageDescriptionTouse); |
| [1898](#L1898) |  |
| [1899](#L1899) | if(attachment.id!=''){ |
| [1900](#L1900) | jQuery("#HdnMediaSelection").val(attachment.id); |
| [1901](#L1901) | } |
| [1902](#L1902) |  |
| [1903](#L1903) | } |
| [1904](#L1904) | else{ |
| [1905](#L1905) |  |
| [1906](#L1906) | alert('<?php echo \_\_( 'Invalid image selection','wp-responsive-photo-gallery' );?>.'); |
| [1907](#L1907) | } |
| [1908](#L1908) | //do something with attachment variable, for example attachment.filename |
| [1909](#L1909) | //Object: |
| [1910](#L1910) | //attachment.alt - image alt |
| [1911](#L1911) | //attachment.author - author id |
| [1912](#L1912) | //attachment.caption |
| [1913](#L1913) | //attachment.dateFormatted - date of image uploaded |
| [1914](#L1914) | //attachment.description |
| [1915](#L1915) | //attachment.editLink - edit link of media |
| [1916](#L1916) | //attachment.filename |
| [1917](#L1917) | //attachment.height |
| [1918](#L1918) | //attachment.icon - don't know WTF?)) |
| [1919](#L1919) | //attachment.id - id of attachment |
| [1920](#L1920) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [1921](#L1921) | //attachment.menuOrder |
| [1922](#L1922) | //attachment.mime - mime type, for example image/jpeg" |
| [1923](#L1923) | //attachment.name - name of attachment file, for example "my-image" |
| [1924](#L1924) | //attachment.status - usual is "inherit" |
| [1925](#L1925) | //attachment.subtype - "jpeg" if is "jpg" |
| [1926](#L1926) | //attachment.title |
| [1927](#L1927) | //attachment.type - "image" |
| [1928](#L1928) | //attachment.uploadedTo |
| [1929](#L1929) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [1930](#L1930) | //attachment.width |
| [1931](#L1931) | }); |
| [1932](#L1932) |  |
| [1933](#L1933) | //Open modal |
| [1934](#L1934) | custom\_file\_frame.open(); |
| [1935](#L1935) | }); |
| [1936](#L1936) | }) |
| [1937](#L1937) | </script> |
| [1938](#L1938) |  |
| [1939](#L1939) | </div> |
| [1940](#L1940) | </div> |
| [1941](#L1941) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [1942](#L1942) | <h3><label for="link\_name"><?php echo \_\_( 'Image Title','wp-responsive-photo-gallery' );?></label></h3> |
| [1943](#L1943) | <div class="inside"> |
| [1944](#L1944) | <input type="text" id="imagetitle"  size="30" name="imagetitle" value="<?php echo $title;?>"> |
| [1945](#L1945) | <div style="clear:both"></div> |
| [1946](#L1946) | <div></div> |
| [1947](#L1947) | <div style="clear:both"></div> |
| [1948](#L1948) | <p><?php echo \_\_( 'Used in image alt for seo','wp-responsive-photo-gallery' );?></p> |
| [1949](#L1949) | </div> |
| [1950](#L1950) | </div> |
| [1951](#L1951) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [1952](#L1952) | <h3><label for="link\_name"><?php echo \_\_( 'Image Url','wp-responsive-photo-gallery' );?>(<?php echo \_\_( 'On click redirect to this url.','wp-responsive-photo-gallery' );?>)</label></h3> |
| [1953](#L1953) | <div class="inside"> |
| [1954](#L1954) | <input type="text" id="imageurl" class=""   size="30" name="imageurl" value="<?php echo $image\_link; ?>"> |
| [1955](#L1955) | <div style="clear:both"></div> |
| [1956](#L1956) | <div></div> |
| [1957](#L1957) | <div style="clear:both"></div> |
| [1958](#L1958) | <p><?php echo \_\_( 'On image click users will redirect to this url.','wp-responsive-photo-gallery' );?></p> |
| [1959](#L1959) | </div> |
| [1960](#L1960) | </div> |
| [1961](#L1961) |  |
| [1962](#L1962) | <?php if(isset($\_GET['id']) and intval($\_GET['id'])>0){ ?> |
| [1963](#L1963) | <input type="hidden" name="imageid" id="imageid" value="<?php echo htmlentities(intval($\_GET['id']),ENT\_QUOTES);?>"> |
| [1964](#L1964) | <?php |
| [1965](#L1965) | } |
| [1966](#L1966) | ?> |
| [1967](#L1967) | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
| [1968](#L1968) | <input type="submit" onclick="return validateFile();" name="btnsave" id="btnsave" value="<?php echo \_\_( 'Save Changes','wp-responsive-photo-gallery' );?>" class="button-primary">&nbsp;&nbsp;<input type="button" name="cancle" id="cancle" value="Cancel" class="button-primary" onclick="location.href='admin.php?page=responsive\_photo\_gallery\_image\_management'"> |
| [1969](#L1969) |  |
| [1970](#L1970) | </form> |
| [1971](#L1971) | <script type="text/javascript"> |
| [1972](#L1972) |  |
| [1973](#L1973) |  |
| [1974](#L1974) | jQuery(document).ready(function() { |
| [1975](#L1975) |  |
| [1976](#L1976) | jQuery("#addimage").validate({ |
| [1977](#L1977) | rules: { |
| [1978](#L1978) | imagetitle: { |
| [1979](#L1979) | required:true, |
| [1980](#L1980) | maxlength: 200 |
| [1981](#L1981) | },imageurl: { |
| [1982](#L1982) | url2:true, |
| [1983](#L1983) | maxlength: 500 |
| [1984](#L1984) | }, |
| [1985](#L1985) | image\_name:{ |
| [1986](#L1986) | isimage:true |
| [1987](#L1987) | } |
| [1988](#L1988) | }, |
| [1989](#L1989) | errorClass: "image\_error", |
| [1990](#L1990) | errorPlacement: function(error, element) { |
| [1991](#L1991) | error.appendTo( element.next().next().next()); |
| [1992](#L1992) | } |
| [1993](#L1993) |  |
| [1994](#L1994) |  |
| [1995](#L1995) | }) |
| [1996](#L1996) | }); |
| [1997](#L1997) |  |
| [1998](#L1998) | function validateFile(){ |
| [1999](#L1999) |  |
| [2000](#L2000) |  |
| [2001](#L2001) | if(jQuery('#currImg').length>0 || jQuery.trim(jQuery("#HdnMediaSelection").val())!="" ){ |
| [2002](#L2002) | return true; |
| [2003](#L2003) | } |
| [2004](#L2004) | else |
| [2005](#L2005) | { |
| [2006](#L2006) | jQuery("#err\_daynamic").remove(); |
| [2007](#L2007) | jQuery("#myMediaUploader").after('<br/><label class="image\_error" id="err\_daynamic"><?php echo \_\_( 'Please select file','wp-responsive-photo-gallery' );?>.</label>'); |
| [2008](#L2008) | return false; |
| [2009](#L2009) | } |
| [2010](#L2010) |  |
| [2011](#L2011) | } |
| [2012](#L2012) | </script> |
| [2013](#L2013) |  |
| [2014](#L2014) | </div> |
| [2015](#L2015) | <div id="postbox-container-1" class="postbox-container" > |
| [2016](#L2016) |  |
| [2017](#L2017) | <div class="postbox"> |
| [2018](#L2018) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [2019](#L2019) | <div class="inside"> |
| [2020](#L2020) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [2021](#L2021) |  |
| [2022](#L2022) | <div style="margin:10px 5px"> |
| [2023](#L2023) |  |
| [2024](#L2024) | </div> |
| [2025](#L2025) | </div></div> |
| [2026](#L2026) |  |
| [2027](#L2027) |  |
| [2028](#L2028) | </div> |
| [2029](#L2029) | </div> |
| [2030](#L2030) | </div> |
| [2031](#L2031) |  |
| [2032](#L2032) | </div> |
| [2033](#L2033) | </div> |
| [2034](#L2034) |  |
| [2035](#L2035) |  |
| [2036](#L2036) | <?php |
| [2037](#L2037) | } |
| [2038](#L2038) | } |
| [2039](#L2039) |  |
| [2040](#L2040) | else if(strtolower($action)==strtolower('delete')){ |
| [2041](#L2041) |  |
| [2042](#L2042) |  |
| [2043](#L2043) | $retrieved\_nonce = ''; |
| [2044](#L2044) |  |
| [2045](#L2045) | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
| [2046](#L2046) |  |
| [2047](#L2047) | $retrieved\_nonce=sanitize\_text\_field($\_GET['nonce']); |
| [2048](#L2048) |  |
| [2049](#L2049) | } |
| [2050](#L2050) | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
| [2051](#L2051) |  |
| [2052](#L2052) |  |
| [2053](#L2053) | wp\_die('Security check fail'); |
| [2054](#L2054) | } |
| [2055](#L2055) |  |
| [2056](#L2056) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ) { |
| [2057](#L2057) |  |
| [2058](#L2058) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2059](#L2059) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2060](#L2060) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2061](#L2061) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [2062](#L2062) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2063](#L2063) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2064](#L2064) | exit; |
| [2065](#L2065) |  |
| [2066](#L2066) | } |
| [2067](#L2067) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2068](#L2068) | $deleteId=(int) htmlentities(strip\_tags($\_GET['id']),ENT\_QUOTES); |
| [2069](#L2069) |  |
| [2070](#L2070) | try{ |
| [2071](#L2071) |  |
| [2072](#L2072) |  |
| [2073](#L2073) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$deleteId"; |
| [2074](#L2074) | $myrow  = $wpdb->get\_row($query); |
| [2075](#L2075) |  |
| [2076](#L2076) | if(is\_object($myrow)){ |
| [2077](#L2077) |  |
| [2078](#L2078) | $image\_name=$myrow->image\_name; |
| [2079](#L2079) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2080](#L2080) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2081](#L2081) | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
| [2082](#L2082) | @unlink($imagetoDel); |
| [2083](#L2083) |  |
| [2084](#L2084) | $query = "delete from  ".$wpdb->prefix."gv\_responsive\_slider where id=$deleteId"; |
| [2085](#L2085) | $wpdb->query($query); |
| [2086](#L2086) |  |
| [2087](#L2087) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2088](#L2088) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [2089](#L2089) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Image deleted successfully.','wp-responsive-photo-gallery' ); |
| [2090](#L2090) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2091](#L2091) | } |
| [2092](#L2092) |  |
| [2093](#L2093) |  |
| [2094](#L2094) | } |
| [2095](#L2095) | catch(Exception $e){ |
| [2096](#L2096) |  |
| [2097](#L2097) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2098](#L2098) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2099](#L2099) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Error while deleting image.','wp-responsive-photo-gallery' ); |
| [2100](#L2100) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2101](#L2101) | } |
| [2102](#L2102) |  |
| [2103](#L2103) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2104](#L2104) |  |
| [2105](#L2105) | } |
| [2106](#L2106) | else if(strtolower($action)==strtolower('deleteselected')){ |
| [2107](#L2107) |  |
| [2108](#L2108) | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
| [2109](#L2109) |  |
| [2110](#L2110) | wp\_die('Security check fail'); |
| [2111](#L2111) | } |
| [2112](#L2112) |  |
| [2113](#L2113) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ) { |
| [2114](#L2114) |  |
| [2115](#L2115) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2116](#L2116) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2117](#L2117) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2118](#L2118) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [2119](#L2119) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2120](#L2120) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2121](#L2121) | exit; |
| [2122](#L2122) |  |
| [2123](#L2123) | } |
| [2124](#L2124) |  |
| [2125](#L2125) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2126](#L2126) | if(isset($\_POST) and isset($\_POST['deleteselected']) and  ( $\_POST['action']=='delete' or $\_POST['action\_upper']=='delete')){ |
| [2127](#L2127) |  |
| [2128](#L2128) | if(sizeof($\_POST['thumbnails']) >0){ |
| [2129](#L2129) |  |
| [2130](#L2130) | $deleteto=$\_POST['thumbnails']; |
| [2131](#L2131) | $implode=implode(',',$deleteto); |
| [2132](#L2132) |  |
| [2133](#L2133) | try{ |
| [2134](#L2134) |  |
| [2135](#L2135) | foreach($deleteto as $img){ |
| [2136](#L2136) |  |
| [2137](#L2137) | $img=intval($img); |
| [2138](#L2138) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$img"; |
| [2139](#L2139) | $myrow  = $wpdb->get\_row($query); |
| [2140](#L2140) |  |
| [2141](#L2141) | if(is\_object($myrow)){ |
| [2142](#L2142) |  |
| [2143](#L2143) | $image\_name=$myrow->image\_name; |
| [2144](#L2144) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2145](#L2145) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2146](#L2146) | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
| [2147](#L2147) | @unlink($imagetoDel); |
| [2148](#L2148) | $query = "delete from  ".$wpdb->prefix."gv\_responsive\_slider where id=$img"; |
| [2149](#L2149) | $wpdb->query($query); |
| [2150](#L2150) |  |
| [2151](#L2151) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2152](#L2152) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [2153](#L2153) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Selected images deleted successfully.','wp-responsive-photo-gallery' ); |
| [2154](#L2154) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2155](#L2155) | } |
| [2156](#L2156) |  |
| [2157](#L2157) | } |
| [2158](#L2158) |  |
| [2159](#L2159) | } |
| [2160](#L2160) | catch(Exception $e){ |
| [2161](#L2161) |  |
| [2162](#L2162) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2163](#L2163) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2164](#L2164) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='Error while deleting image.'; |
| [2165](#L2165) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2166](#L2166) | } |
| [2167](#L2167) |  |
| [2168](#L2168) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2169](#L2169) |  |
| [2170](#L2170) |  |
| [2171](#L2171) | } |
| [2172](#L2172) | else{ |
| [2173](#L2173) |  |
| [2174](#L2174) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2175](#L2175) | } |
| [2176](#L2176) |  |
| [2177](#L2177) | } |
| [2178](#L2178) | else{ |
| [2179](#L2179) |  |
| [2180](#L2180) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2181](#L2181) | } |
| [2182](#L2182) |  |
| [2183](#L2183) | } |
| [2184](#L2184) | } |
| [2185](#L2185) | function responsive\_photo\_gallery\_slider\_admin\_preview(){ |
| [2186](#L2186) |  |
| [2187](#L2187) |  |
| [2188](#L2188) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [2189](#L2189) |  |
| [2190](#L2190) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_preview' ) ) { |
| [2191](#L2191) |  |
| [2192](#L2192) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [2193](#L2193) |  |
| [2194](#L2194) | } |
| [2195](#L2195) |  |
| [2196](#L2196) | ?> |
| [2197](#L2197) | <div style=""> |
| [2198](#L2198) | <div style=""> |
| [2199](#L2199) | <br/> |
| [2200](#L2200) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [2201](#L2201) | <div class="wrap"> |
| [2202](#L2202) | <h2><?php echo \_\_( 'Slider Preview','wp-responsive-photo-gallery' );?></h2> |
| [2203](#L2203) | <br> |
| [2204](#L2204) |  |
| [2205](#L2205) | <?php |
| [2206](#L2206) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2207](#L2207) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2208](#L2208) |  |
| [2209](#L2209) | $uploads = wp\_upload\_dir (); |
| [2210](#L2210) | $baseDir = $uploads ['basedir']; |
| [2211](#L2211) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2212](#L2212) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2213](#L2213) |  |
| [2214](#L2214) | $baseurl=$uploads['baseurl']; |
| [2215](#L2215) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [2216](#L2216) |  |
| [2217](#L2217) |  |
| [2218](#L2218) | ?> |
| [2219](#L2219) | <?php $slider\_id\_html=time().rand(0,5000);?> |
| [2220](#L2220) | <div id="poststuff"> |
| [2221](#L2221) | <div id="post-body" class="metabox-holder columns-2"> |
| [2222](#L2222) | <div id="post-body-content"> |
| [2223](#L2223) | <div style="clear: both;"></div> |
| [2224](#L2224) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
| [2225](#L2225) | <div id="divSliderMain\_admin" style="max-width:<?php echo $settings['panel\_width'];?>px;"> |
| [2226](#L2226) | <ul id="<?php echo $slider\_id\_html;?>"> |
| [2227](#L2227) | <?php |
| [2228](#L2228) | global $wpdb; |
| [2229](#L2229) | $imageheight=$settings['panel\_height']; |
| [2230](#L2230) | $imagewidth=$settings['panel\_width']; |
| [2231](#L2231) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider order by createdon desc"; |
| [2232](#L2232) | $rows=$wpdb->get\_results($query,'ARRAY\_A'); |
| [2233](#L2233) |  |
| [2234](#L2234) | if(count($rows) > 0){ |
| [2235](#L2235) | foreach($rows as $row){ |
| [2236](#L2236) |  |
| [2237](#L2237) | $imagename=$row['image\_name']; |
| [2238](#L2238) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [2239](#L2239) | $imageUploadTo=str\_replace("\\","/",$imageUploadTo); |
| [2240](#L2240) | $pathinfo=pathinfo($imageUploadTo); |
| [2241](#L2241) | $filenamewithoutextension=$pathinfo['filename']; |
| [2242](#L2242) | $outputimg=""; |
| [2243](#L2243) |  |
| [2244](#L2244) | if($settings['panel\_scale']=='fit'){ |
| [2245](#L2245) |  |
| [2246](#L2246) | $outputimg = $baseurl.$imagename; |
| [2247](#L2247) |  |
| [2248](#L2248) | }else{ |
| [2249](#L2249) |  |
| [2250](#L2250) | list($width, $height) = getimagesize($pathToImagesFolder."/".$row['image\_name']); |
| [2251](#L2251) | if($width<$imagewidth){ |
| [2252](#L2252) | $imagewidth=$width; |
| [2253](#L2253) | } |
| [2254](#L2254) |  |
| [2255](#L2255) | if($height<$imageheight){ |
| [2256](#L2256) |  |
| [2257](#L2257) | $imageheight=$height; |
| [2258](#L2258) | } |
| [2259](#L2259) |  |
| [2260](#L2260) | $imagetoCheck=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2261](#L2261) | $imagetoCheckSmall=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2262](#L2262) |  |
| [2263](#L2263) |  |
| [2264](#L2264) | if(file\_exists($imagetoCheck)){ |
| [2265](#L2265) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2266](#L2266) |  |
| [2267](#L2267) | } |
| [2268](#L2268) | else if(file\_exists($imagetoCheckSmall)){ |
| [2269](#L2269) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2270](#L2270) | } |
| [2271](#L2271) | else{ |
| [2272](#L2272) |  |
| [2273](#L2273) | if(file\_exists($pathToImagesFolder."/".$row['image\_name'])){ |
| [2274](#L2274) |  |
| [2275](#L2275) | $resizeObj = new resize($pathToImagesFolder."/".$row['image\_name']); |
| [2276](#L2276) | $resizeObj -> resizeImage($imagewidth, $imageheight, "exact"); |
| [2277](#L2277) | $resizeObj -> saveImage($pathToImagesFolder."/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension'], 100); |
| [2278](#L2278) | //$outputimg = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2279](#L2279) |  |
| [2280](#L2280) | if(file\_exists($imagetoCheck)){ |
| [2281](#L2281) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2282](#L2282) | } |
| [2283](#L2283) | else if(file\_exists($imagetoCheckSmall)){ |
| [2284](#L2284) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2285](#L2285) | } |
| [2286](#L2286) |  |
| [2287](#L2287) | }else{ |
| [2288](#L2288) |  |
| [2289](#L2289) | $outputimg = $baseurl.$imagename; |
| [2290](#L2290) | } |
| [2291](#L2291) |  |
| [2292](#L2292) | } |
| [2293](#L2293) |  |
| [2294](#L2294) | } |
| [2295](#L2295) | ?> |
| [2296](#L2296) | <li><img data-target="1" data-href="<?php echo $row['custom\_link'];?>" org-src-="<?php echo $outputimg;?>"  /></li> |
| [2297](#L2297) |  |
| [2298](#L2298) | <?php }?> |
| [2299](#L2299) | <?php }?> |
| [2300](#L2300) | </ul> |
| [2301](#L2301) | </div> |
| [2302](#L2302) | <script type="text/javascript"> |
| [2303](#L2303) |  |
| [2304](#L2304) | jQuery(document).ready(function() { |
| [2305](#L2305) |  |
| [2306](#L2306) | <?php $galRandNo=rand(0,13313); ?> |
| [2307](#L2307) | var galleryItems<?php echo $galRandNo;?>; |
| [2308](#L2308) | jQuery(function(){ |
| [2309](#L2309) | galleryItems<?php echo $galRandNo;?> = jQuery("#<?php echo $slider\_id\_html;?>"); |
| [2310](#L2310) |  |
| [2311](#L2311) | var galleryItemDivs = jQuery('#divSliderMain\_admin'); |
| [2312](#L2312) |  |
| [2313](#L2313) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2314](#L2314) | item.parent\_data = jQuery(item).parent("#divSliderMain\_admin"); |
| [2315](#L2315) | }); |
| [2316](#L2316) |  |
| [2317](#L2317) |  |
| [2318](#L2318) | galleryItemDivs.each(function(index, item){ |
| [2319](#L2319) | jQuery("ul",this).galleryView({ |
| [2320](#L2320) |  |
| [2321](#L2321) | transition\_speed:<?php echo $settings['transition\_speed'];?>,         //INT - duration of panel/frame transition (in milliseconds) |
| [2322](#L2322) | transition\_interval:<?php echo $settings['transition\_interval'];?>,         //INT - delay between panel/frame transitions (in milliseconds) |
| [2323](#L2323) | easing:'<?php echo isset($settings['easing'])?$settings['easing']:'';?>',                 //STRING - easing method to use for animations (jQuery provides 'swing' or 'linear', more available with jQuery UI or Easing plugin) |
| [2324](#L2324) | show\_panels:<?php echo ($settings['show\_panels']==1)?'true':'false' ;?>,                 //BOOLEAN - flag to show or hide panel portion of gallery |
| [2325](#L2325) | show\_panel\_nav:<?php echo ($settings['show\_panel\_nav']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel navigation buttons |
| [2326](#L2326) | enable\_overlays:<?php echo ($settings['enable\_overlays']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel overlays |
| [2327](#L2327) | panel\_width:<?php echo $settings['panel\_width'];?>,                 //INT - width of gallery panel (in pixels) |
| [2328](#L2328) | panel\_height:<?php echo $settings['panel\_height'];?>,                 //INT - height of gallery panel (in pixels) |
| [2329](#L2329) | panel\_animation:'<?php echo $settings['panel\_animation'];?>',         //STRING - animation method for panel transitions (crossfade,fade,slide,none) |
| [2330](#L2330) | panel\_scale: '<?php echo $settings['panel\_scale'];?>',             //STRING - cropping option for panel images (crop = scale image and fit to aspect ratio determined by panel\_width and panel\_height, fit = scale image and preserve original aspect ratio) |
| [2331](#L2331) | overlay\_position:'<?php echo $settings['overlay\_position'];?>',     //STRING - position of panel overlay (bottom, top) |
| [2332](#L2332) | pan\_images:<?php echo ($settings['pan\_images']==1)?'true':'false' ;?>,                //BOOLEAN - flag to allow user to grab/drag oversized images within gallery |
| [2333](#L2333) | pan\_style:'<?php echo $settings['pan\_style'];?>',                //STRING - panning method (drag = user clicks and drags image to pan, track = image automatically pans based on mouse position |
| [2334](#L2334) | start\_frame:'<?php echo $settings['start\_frame'];?>',                 //INT - index of panel/frame to show first when gallery loads |
| [2335](#L2335) | show\_filmstrip:<?php echo ($settings['show\_filmstrip']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide filmstrip portion of gallery |
| [2336](#L2336) | show\_filmstrip\_nav:<?php echo ($settings['show\_filmstrip\_nav']==1)?'true':'false' ;?>,         //BOOLEAN - flag indicating whether to display navigation buttons |
| [2337](#L2337) | enable\_slideshow:<?php echo ($settings['enable\_slideshow']==1)?'true':'false' ;?>,            //BOOLEAN - flag indicating whether to display slideshow play/pause button |
| [2338](#L2338) | autoplay:<?php echo ($settings['autoplay']==1)?'true':'false' ;?>,                //BOOLEAN - flag to start slideshow on gallery load |
| [2339](#L2339) | show\_captions:<?php echo ($settings['show\_captions']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide frame captions |
| [2340](#L2340) | filmstrip\_style: '<?php echo $settings['filmstrip\_style'];?>',         //STRING - type of filmstrip to use (scroll = display one line of frames, scroll filmstrip if necessary, showall = display multiple rows of frames if necessary) |
| [2341](#L2341) | filmstrip\_position:'<?php echo $settings['filmstrip\_position'];?>',     //STRING - position of filmstrip within gallery (bottom, top, left, right) |
| [2342](#L2342) | frame\_width:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2343](#L2343) | frame\_height:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2344](#L2344) | frame\_opacity:<?php echo $settings['frame\_opacity'];?>,             //FLOAT - transparency of non-active frames (1.0 = opaque, 0.0 = transparent) |
| [2345](#L2345) | frame\_scale: '<?php echo $settings['frame\_scale'];?>',             //STRING - cropping option for filmstrip images (same as above) |
| [2346](#L2346) | frame\_gap:<?php echo $settings['frame\_gap'];?>,                     //INT - spacing between frames within filmstrip (in pixels) |
| [2347](#L2347) | show\_infobar:<?php echo ($settings['show\_infobar']==1)?'true':'false' ;?>,                //BOOLEAN - flag to show or hide infobar |
| [2348](#L2348) | infobar\_opacity:<?php echo $settings['infobar\_opacity'];?>,               //FLOAT - transparency for info bar |
| [2349](#L2349) | clickable: 'all' |
| [2350](#L2350) |  |
| [2351](#L2351) | }); |
| [2352](#L2352) |  |
| [2353](#L2353) | }); |
| [2354](#L2354) |  |
| [2355](#L2355) | }); |
| [2356](#L2356) |  |
| [2357](#L2357) |  |
| [2358](#L2358) | // |
| [2359](#L2359) | // Resize the image gallery |
| [2360](#L2360) | // |
| [2361](#L2361) | var oldsize\_w<?php echo $galRandNo;?>=<?php echo $settings['panel\_width'];?>; |
| [2362](#L2362) | var oldsize\_h<?php echo $galRandNo;?>=<?php echo $settings['panel\_height'];?>; |
| [2363](#L2363) |  |
| [2364](#L2364) | function resizegallery<?php echo $galRandNo;?>(){ |
| [2365](#L2365) |  |
| [2366](#L2366) | if(galleryItems<?php echo $galRandNo;?>==undefined){return;} |
| [2367](#L2367) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2368](#L2368) | var $parent = item.parent\_data; |
| [2369](#L2369) |  |
| [2370](#L2370) | // width based on parent? |
| [2371](#L2371) | var width = ($parent.innerWidth()-10);//2 times 5 pixels margin |
| [2372](#L2372) | var height = ($parent.innerHeight()-10);//2 times 5 pixels margin |
| [2373](#L2373) | if(oldsize\_w<?php echo $galRandNo;?>==width){ |
| [2374](#L2374) | return; |
| [2375](#L2375) | } |
| [2376](#L2376) | oldsize\_w<?php echo $galRandNo;?>=width; |
| [2377](#L2377) | var resizeToHeight=width/3\*2; |
| [2378](#L2378) | if(resizeToHeight><?php echo $settings['panel\_height'];?>){ |
| [2379](#L2379) | resizeToHeight=<?php echo $settings['panel\_height'];?>; |
| [2380](#L2380) | } |
| [2381](#L2381) | thumbfactor = width/(<?php echo $settings['panel\_width'];?>-10); |
| [2382](#L2382) |  |
| [2383](#L2383) | jQuery(item).resizeGalleryView( |
| [2384](#L2384) | width,resizeToHeight, <?php echo $settings['frame\_width'];?>\*thumbfactor, <?php echo $settings['frame\_height'];?>\*thumbfactor); |
| [2385](#L2385) |  |
| [2386](#L2386) | }); |
| [2387](#L2387) | } |
| [2388](#L2388) |  |
| [2389](#L2389) | var inited<?php echo $galRandNo;?>=false; |
| [2390](#L2390) |  |
| [2391](#L2391) | function onresize<?php echo $galRandNo;?>(){ |
| [2392](#L2392) |  |
| [2393](#L2393) | resizegallery<?php echo $galRandNo;?>(); |
| [2394](#L2394) | inited<?php echo $galRandNo;?>=true; |
| [2395](#L2395) | } |
| [2396](#L2396) |  |
| [2397](#L2397) |  |
| [2398](#L2398) | jQuery(window).resize(onresize<?php echo $galRandNo;?>); |
| [2399](#L2399) | jQuery( document ).ready(function() { |
| [2400](#L2400) | onresize<?php echo $galRandNo;?>(); |
| [2401](#L2401) | }); |
| [2402](#L2402) |  |
| [2403](#L2403) | }); |
| [2404](#L2404) |  |
| [2405](#L2405) |  |
| [2406](#L2406) | </script> |
| [2407](#L2407) | </div> |
| [2408](#L2408) | </div> |
| [2409](#L2409) | </div> |
| [2410](#L2410) | </div> |
| [2411](#L2411) | </div> |
| [2412](#L2412) | <div class="clear"></div> |
| [2413](#L2413) | </div> |
| [2414](#L2414) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress Post/Page use below Short code','wp-responsive-photo-gallery' );?></h3> |
| [2415](#L2415) | <input type="text" value="[print\_my\_responsive\_photo\_gallery]" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [2416](#L2416) | <div class="clear"></div> |
| [2417](#L2417) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress theme/template PHP files use below php code','wp-responsive-photo-gallery' );?></h3> |
| [2418](#L2418) | <input type="text" value="&lt;?php echo do\_shortcode('[print\_my\_responsive\_photo\_gallery]'); ?&gt;" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [2419](#L2419) | <div class="clear"></div> |
| [2420](#L2420) | <?php |
| [2421](#L2421) | } |
| [2422](#L2422) |  |
| [2423](#L2423) | function print\_my\_responsive\_photo\_gallery\_func(){ |
| [2424](#L2424) |  |
| [2425](#L2425) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [2426](#L2426) | $rand\_Numb=uniqid('gallery\_slider'); |
| [2427](#L2427) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2428](#L2428) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2429](#L2429) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2430](#L2430) |  |
| [2431](#L2431) | $uploads = wp\_upload\_dir (); |
| [2432](#L2432) | $baseDir = $uploads ['basedir']; |
| [2433](#L2433) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2434](#L2434) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2435](#L2435) |  |
| [2436](#L2436) | $baseurl=$uploads['baseurl']; |
| [2437](#L2437) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [2438](#L2438) |  |
| [2439](#L2439) | wp\_enqueue\_style('jquery.galleryview-3.0-dev-responsive'); |
| [2440](#L2440) | wp\_enqueue\_script('jquery'); |
| [2441](#L2441) | wp\_enqueue\_script('jquery-ui-core'); |
| [2442](#L2442) | wp\_enqueue\_script('jquery.timers-1.2'); |
| [2443](#L2443) | wp\_enqueue\_script('jquery.easing.1.3'); |
| [2444](#L2444) | wp\_enqueue\_script('jquery.gview-3.0-dev-responsive'); |
| [2445](#L2445) |  |
| [2446](#L2446) | ob\_start(); |
| [2447](#L2447) | ?><!-- print\_my\_responsive\_photo\_gallery\_func --><div id="divSliderMain\_admin\_<?php echo $rand\_Numb;?>" style="max-width:<?php echo $settings['panel\_width'];?>px;"> |
| [2448](#L2448) | <ul id="<?php echo $rand\_Numb;?>" style="visibility: hidden"> |
| [2449](#L2449) | <?php |
| [2450](#L2450) | global $wpdb; |
| [2451](#L2451) | $imageheight=$settings['panel\_height']; |
| [2452](#L2452) | $imagewidth=$settings['panel\_width']; |
| [2453](#L2453) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider order by createdon desc"; |
| [2454](#L2454) | $rows=$wpdb->get\_results($query,'ARRAY\_A'); |
| [2455](#L2455) |  |
| [2456](#L2456) | if(count($rows) > 0){ |
| [2457](#L2457) | foreach($rows as $row){ |
| [2458](#L2458) |  |
| [2459](#L2459) | $imagename=$row['image\_name']; |
| [2460](#L2460) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [2461](#L2461) | $imageUploadTo=str\_replace("\\","/",$imageUploadTo); |
| [2462](#L2462) | $pathinfo=pathinfo($imageUploadTo); |
| [2463](#L2463) | $filenamewithoutextension=$pathinfo['filename']; |
| [2464](#L2464) | $outputimg=""; |
| [2465](#L2465) |  |
| [2466](#L2466) | if($settings['panel\_scale']=='fit'){ |
| [2467](#L2467) |  |
| [2468](#L2468) | $outputimg = $baseurl.$imagename; |
| [2469](#L2469) |  |
| [2470](#L2470) | }else{ |
| [2471](#L2471) | list($width, $height) = getimagesize($pathToImagesFolder."/".$row['image\_name']); |
| [2472](#L2472) | if($width<$imagewidth){ |
| [2473](#L2473) | $imagewidth=$width; |
| [2474](#L2474) | } |
| [2475](#L2475) |  |
| [2476](#L2476) | if($height<$imageheight){ |
| [2477](#L2477) |  |
| [2478](#L2478) | $imageheight=$height; |
| [2479](#L2479) | } |
| [2480](#L2480) |  |
| [2481](#L2481) | $imagetoCheck=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2482](#L2482) | $imagetoCheckSmall=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2483](#L2483) |  |
| [2484](#L2484) | if(file\_exists($imagetoCheck)){ |
| [2485](#L2485) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2486](#L2486) |  |
| [2487](#L2487) | } |
| [2488](#L2488) | else if(file\_exists($imagetoCheckSmall)){ |
| [2489](#L2489) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2490](#L2490) | } |
| [2491](#L2491) | else{ |
| [2492](#L2492) |  |
| [2493](#L2493) | if(file\_exists($pathToImagesFolder."/".$row['image\_name'])){ |
| [2494](#L2494) |  |
| [2495](#L2495) | $resizeObj = new resize($pathToImagesFolder."/".$row['image\_name']); |
| [2496](#L2496) | $resizeObj -> resizeImage($imagewidth, $imageheight, "exact"); |
| [2497](#L2497) | $resizeObj -> saveImage($pathToImagesFolder."/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension'], 100); |
| [2498](#L2498) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2499](#L2499) | }else{ |
| [2500](#L2500) |  |
| [2501](#L2501) | $outputimg = $baseurl.$imagename; |
| [2502](#L2502) | } |
| [2503](#L2503) |  |
| [2504](#L2504) | } |
| [2505](#L2505) |  |
| [2506](#L2506) | } |
| [2507](#L2507) | ?> |
| [2508](#L2508) | <li><img data-target="1" data-href="<?php echo $row['custom\_link'];?>" org-src-="<?php echo $outputimg;?>"  /></li> |
| [2509](#L2509) |  |
| [2510](#L2510) | <?php }?> |
| [2511](#L2511) | <?php }?> |
| [2512](#L2512) | </ul> |
| [2513](#L2513) | </div> |
| [2514](#L2514) | <script type="text/javascript"> |
| [2515](#L2515) |  |
| [2516](#L2516) |  |
| [2517](#L2517) | <?php $intval= uniqid('interval\_');?> |
| [2518](#L2518) |  |
| [2519](#L2519) | var <?php echo $intval;?> = setInterval(function() { |
| [2520](#L2520) |  |
| [2521](#L2521) | if(document.readyState === 'complete') { |
| [2522](#L2522) |  |
| [2523](#L2523) | clearInterval(<?php echo $intval;?>); |
| [2524](#L2524) |  |
| [2525](#L2525) |  |
| [2526](#L2526) |  |
| [2527](#L2527) | jQuery("#<?php echo $rand\_Numb;?>").css('visibility','visible'); |
| [2528](#L2528) | <?php $galRandNo=rand(0,13313); ?> |
| [2529](#L2529) | var galleryItems<?php echo $galRandNo;?>; |
| [2530](#L2530) | jQuery(function(){ |
| [2531](#L2531) | galleryItems<?php echo $galRandNo;?> = jQuery("#<?php echo $rand\_Numb;?>"); |
| [2532](#L2532) |  |
| [2533](#L2533) | var galleryItemDivs = jQuery('#divSliderMain\_admin\_<?php echo $rand\_Numb;?>'); |
| [2534](#L2534) |  |
| [2535](#L2535) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2536](#L2536) | item.parent\_data = jQuery(item).parent("#divSliderMain\_admin\_<?php echo $rand\_Numb;?>"); |
| [2537](#L2537) | }); |
| [2538](#L2538) |  |
| [2539](#L2539) | galleryItemDivs.each(function(index, item){ |
| [2540](#L2540) |  |
| [2541](#L2541) | jQuery("ul",this).galleryView({ |
| [2542](#L2542) |  |
| [2543](#L2543) | transition\_speed:<?php echo $settings['transition\_speed'];?>,         //INT - duration of panel/frame transition (in milliseconds) |
| [2544](#L2544) | transition\_interval:<?php echo $settings['transition\_interval'];?>,         //INT - delay between panel/frame transitions (in milliseconds) |
| [2545](#L2545) | easing:'<?php echo isset($settings['easing'])?$settings['easing']:'';?>',                 //STRING - easing method to use for animations (jQuery provides 'swing' or 'linear', more available with jQuery UI or Easing plugin) |
| [2546](#L2546) | show\_panels:<?php echo ($settings['show\_panels']==1)?'true':'false' ;?>,                 //BOOLEAN - flag to show or hide panel portion of gallery |
| [2547](#L2547) | show\_panel\_nav:<?php echo ($settings['show\_panel\_nav']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel navigation buttons |
| [2548](#L2548) | enable\_overlays:<?php echo ($settings['enable\_overlays']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel overlays |
| [2549](#L2549) | panel\_width:<?php echo $settings['panel\_width'];?>,                 //INT - width of gallery panel (in pixels) |
| [2550](#L2550) | panel\_height:<?php echo $settings['panel\_height'];?>,                 //INT - height of gallery panel (in pixels) |
| [2551](#L2551) | panel\_animation:'<?php echo $settings['panel\_animation'];?>',         //STRING - animation method for panel transitions (crossfade,fade,slide,none) |
| [2552](#L2552) | panel\_scale: '<?php echo $settings['panel\_scale'];?>',             //STRING - cropping option for panel images (crop = scale image and fit to aspect ratio determined by panel\_width and panel\_height, fit = scale image and preserve original aspect ratio) |
| [2553](#L2553) | overlay\_position:'<?php echo $settings['overlay\_position'];?>',     //STRING - position of panel overlay (bottom, top) |
| [2554](#L2554) | pan\_images:<?php echo ($settings['pan\_images']==1)?'true':'false' ;?>,                //BOOLEAN - flag to allow user to grab/drag oversized images within gallery |
| [2555](#L2555) | pan\_style:'<?php echo $settings['pan\_style'];?>',                //STRING - panning method (drag = user clicks and drags image to pan, track = image automatically pans based on mouse position |
| [2556](#L2556) | start\_frame:'<?php echo $settings['start\_frame'];?>',                 //INT - index of panel/frame to show first when gallery loads |
| [2557](#L2557) | show\_filmstrip:<?php echo ($settings['show\_filmstrip']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide filmstrip portion of gallery |
| [2558](#L2558) | show\_filmstrip\_nav:<?php echo ($settings['show\_filmstrip\_nav']==1)?'true':'false' ;?>,         //BOOLEAN - flag indicating whether to display navigation buttons |
| [2559](#L2559) | enable\_slideshow:<?php echo ($settings['enable\_slideshow']==1)?'true':'false' ;?>,            //BOOLEAN - flag indicating whether to display slideshow play/pause button |
| [2560](#L2560) | autoplay:<?php echo ($settings['autoplay']==1)?'true':'false' ;?>,                //BOOLEAN - flag to start slideshow on gallery load |
| [2561](#L2561) | show\_captions:<?php echo ($settings['show\_captions']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide frame captions |
| [2562](#L2562) | filmstrip\_style: '<?php echo $settings['filmstrip\_style'];?>',         //STRING - type of filmstrip to use (scroll = display one line of frames, scroll filmstrip if necessary, showall = display multiple rows of frames if necessary) |
| [2563](#L2563) | filmstrip\_position:'<?php echo $settings['filmstrip\_position'];?>',     //STRING - position of filmstrip within gallery (bottom, top, left, right) |
| [2564](#L2564) | frame\_width:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2565](#L2565) | frame\_height:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2566](#L2566) | frame\_opacity:<?php echo $settings['frame\_opacity'];?>,             //FLOAT - transparency of non-active frames (1.0 = opaque, 0.0 = transparent) |
| [2567](#L2567) | frame\_scale: '<?php echo $settings['frame\_scale'];?>',             //STRING - cropping option for filmstrip images (same as above) |
| [2568](#L2568) | frame\_gap:<?php echo $settings['frame\_gap'];?>,                     //INT - spacing between frames within filmstrip (in pixels) |
| [2569](#L2569) | show\_infobar:<?php echo ($settings['show\_infobar']==1)?'true':'false' ;?>,                //BOOLEAN - flag to show or hide infobar |
| [2570](#L2570) | infobar\_opacity:<?php echo $settings['infobar\_opacity'];?>,               //FLOAT - transparency for info bar |
| [2571](#L2571) | clickable: 'all' |
| [2572](#L2572) |  |
| [2573](#L2573) | }); |
| [2574](#L2574) |  |
| [2575](#L2575) | }); |
| [2576](#L2576) |  |
| [2577](#L2577) |  |
| [2578](#L2578) | var oldsize\_w<?php echo $galRandNo;?>=<?php echo $settings['panel\_width'];?>; |
| [2579](#L2579) | var oldsize\_h<?php echo $galRandNo;?>=<?php echo $settings['panel\_height'];?>; |
| [2580](#L2580) |  |
| [2581](#L2581) | function resizegallery<?php echo $galRandNo;?>(){ |
| [2582](#L2582) |  |
| [2583](#L2583) | if(galleryItems<?php echo $galRandNo;?>==undefined){return;} |
| [2584](#L2584) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2585](#L2585) | var $parent = item.parent\_data; |
| [2586](#L2586) |  |
| [2587](#L2587) | // width based on parent? |
| [2588](#L2588) | var width = ($parent.innerWidth()-10);//2 times 5 pixels margin |
| [2589](#L2589) | var height = ($parent.innerHeight()-10);//2 times 5 pixels margin |
| [2590](#L2590) | if(oldsize\_w<?php echo $galRandNo;?>==width){ |
| [2591](#L2591) | return; |
| [2592](#L2592) | } |
| [2593](#L2593) | oldsize\_w<?php echo $galRandNo;?>=width; |
| [2594](#L2594) | var resizeToHeight=width/3\*2; |
| [2595](#L2595) | if(resizeToHeight><?php echo $settings['panel\_height'];?>){ |
| [2596](#L2596) | resizeToHeight=<?php echo $settings['panel\_height'];?>; |
| [2597](#L2597) | } |
| [2598](#L2598) | thumbfactor = width/(<?php echo $settings['panel\_width'];?>-10); |
| [2599](#L2599) |  |
| [2600](#L2600) | jQuery(item).resizeGalleryView( |
| [2601](#L2601) | width, |
| [2602](#L2602) | resizeToHeight, <?php echo $settings['frame\_width'];?>\*thumbfactor, <?php echo $settings['frame\_height'];?>\*thumbfactor); |
| [2603](#L2603) |  |
| [2604](#L2604) | }); |
| [2605](#L2605) | } |
| [2606](#L2606) |  |
| [2607](#L2607) | var inited<?php echo $galRandNo;?>=false; |
| [2608](#L2608) |  |
| [2609](#L2609) | function onresize<?php echo $galRandNo;?>(){ |
| [2610](#L2610) | resizegallery<?php echo $galRandNo;?>(); |
| [2611](#L2611) | inited<?php echo $galRandNo;?>=true; |
| [2612](#L2612) | } |
| [2613](#L2613) |  |
| [2614](#L2614) |  |
| [2615](#L2615) | jQuery(window).resize(onresize<?php echo $galRandNo;?>); |
| [2616](#L2616) | jQuery( document ).ready(function() { |
| [2617](#L2617) | onresize<?php echo $galRandNo;?>(); |
| [2618](#L2618) | }); |
| [2619](#L2619) |  |
| [2620](#L2620) | }); |
| [2621](#L2621) |  |
| [2622](#L2622) |  |
| [2623](#L2623) | } |
| [2624](#L2624) | }, 100); |
| [2625](#L2625) |  |
| [2626](#L2626) |  |
| [2627](#L2627) | </script><!-- end print\_my\_responsive\_photo\_gallery\_func --><?php |
| [2628](#L2628) | $output = ob\_get\_clean(); |
| [2629](#L2629) | return $output; |
| [2630](#L2630) | } |
| [2631](#L2631) |  |
| [2632](#L2632) | function my\_responsive\_photo\_gallery\_get\_wp\_version() { |
| [2633](#L2633) |  |
| [2634](#L2634) | global $wp\_version; |
| [2635](#L2635) | return $wp\_version; |
| [2636](#L2636) | } |
| [2637](#L2637) |  |
| [2638](#L2638) |  |
| [2639](#L2639) | function my\_responsive\_photo\_gallery\_is\_plugin\_page() { |
| [2640](#L2640) | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
| [2641](#L2641) |  |
| [2642](#L2642) | foreach (array('responsive\_photo\_gallery\_image\_management') as $allowURI) { |
| [2643](#L2643) | if(stristr($server\_uri, $allowURI)) return true; |
| [2644](#L2644) | } |
| [2645](#L2645) | return false; |
| [2646](#L2646) | } |
| [2647](#L2647) |  |
| [2648](#L2648) |  |
| [2649](#L2649) | function rjg\_save\_image\_remote($url,$saveto){ |
| [2650](#L2650) |  |
| [2651](#L2651) | $raw = wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [2652](#L2652) |  |
| [2653](#L2653) | if(file\_exists($saveto)){ |
| [2654](#L2654) | @unlink($saveto); |
| [2655](#L2655) | } |
| [2656](#L2656) | $fp = @fopen($saveto,'x'); |
| [2657](#L2657) | @fwrite($fp, $raw); |
| [2658](#L2658) | @fclose($fp); |
| [2659](#L2659) | } |
| [2660](#L2660) |  |
| [2661](#L2661) |  |
| [2662](#L2662) | function rjg\_i13\_get\_http\_response\_code\_gallery($url) { |
| [2663](#L2663) | $headers = @get\_headers($url); |
| [2664](#L2664) | return @substr($headers[0], 9, 3); |
| [2665](#L2665) | } |
| [2666](#L2666) |  |
| [2667](#L2667) |  |
| [2668](#L2668) | function rjg\_get\_grid\_data\_justified\_gallery\_callback() { |
| [2669](#L2669) |  |
| [2670](#L2670) | $retrieved\_nonce=''; |
| [2671](#L2671) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [2672](#L2672) |  |
| [2673](#L2673) | $retrieved\_nonce = $\_POST['vNonce']; |
| [2674](#L2674) | } |
| [2675](#L2675) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [2676](#L2676) |  |
| [2677](#L2677) |  |
| [2678](#L2678) | wp\_die('Security check fail'); |
| [2679](#L2679) | } |
| [2680](#L2680) |  |
| [2681](#L2681) | ob\_start(); |
| [2682](#L2682) | global $wpdb; |
| [2683](#L2683) |  |
| [2684](#L2684) | $pageUrl = urldecode($\_POST['page\_url']); |
| [2685](#L2685) | $urlComponents = parse\_url($pageUrl); |
| [2686](#L2686) | $queryStr = $urlComponents['query']; |
| [2687](#L2687) | if ($queryStr != '') { |
| [2688](#L2688) | parse\_str($queryStr, $qStrArr); |
| [2689](#L2689) | } |
| [2690](#L2690) |  |
| [2691](#L2691) | $pagenum = 0; |
| [2692](#L2692) | if (isset($qStrArr['pagenum']) and (int) $qStrArr['pagenum'] > 0) { |
| [2693](#L2693) |  |
| [2694](#L2694) | $pagenum = intval($qStrArr['pagenum']); |
| [2695](#L2695) | } |
| [2696](#L2696) |  |
| [2697](#L2697) | $settings=get\_option('rjg\_settings'); |
| [2698](#L2698) |  |
| [2699](#L2699) |  |
| [2700](#L2700) | $limit = $settings['page\_size']; |
| [2701](#L2701) | $offset = ( $pagenum - 1 ) \* $limit; |
| [2702](#L2702) |  |
| [2703](#L2703) | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
| [2704](#L2704) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [2705](#L2705) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [2706](#L2706) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [2707](#L2707) |  |
| [2708](#L2708) |  |
| [2709](#L2709) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [2710](#L2710) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [2711](#L2711) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [2712](#L2712) |  |
| [2713](#L2713) | $uploads = wp\_upload\_dir (); |
| [2714](#L2714) | $baseDir = $uploads ['basedir']; |
| [2715](#L2715) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2716](#L2716) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2717](#L2717) | $baseurl = $uploads ['baseurl']; |
| [2718](#L2718) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [2719](#L2719) |  |
| [2720](#L2720) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [2721](#L2721) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [2722](#L2722) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [2723](#L2723) | $randOmeRel = uniqid ( 'rel\_' ); |
| [2724](#L2724) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [2725](#L2725) | $vNonce = wp\_create\_nonce('vNonce'); |
| [2726](#L2726) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2727](#L2727) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [2728](#L2728) | $imageMargin=$settings['imageMargin']; |
| [2729](#L2729) |  |
| [2730](#L2730) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [2731](#L2731) | if(strtolower($LoadingBackColor)=='none'){ |
| [2732](#L2732) | $LoadingBackColor='#ffffff'; |
| [2733](#L2733) | } |
| [2734](#L2734) | if (is\_array($settings)) { |
| [2735](#L2735) |  |
| [2736](#L2736) | ?> |
| [2737](#L2737) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [2738](#L2738) | <div style="clear: both;"></div> |
| [2739](#L2739) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [2740](#L2740) | <div style="clear: both;"></div> |
| [2741](#L2741) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [2742](#L2742) |  |
| [2743](#L2743) |  |
| [2744](#L2744) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" > |
| [2745](#L2745) |  |
| [2746](#L2746) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [2747](#L2747) |  |
| [2748](#L2748) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [2749](#L2749) |  |
| [2750](#L2750) | <?php |
| [2751](#L2751) |  |
| [2752](#L2752) | $imageheight = $settings ['imageheight']; |
| [2753](#L2753) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [2754](#L2754) | $firstChild='firstimg'; |
| [2755](#L2755) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [2756](#L2756) |  |
| [2757](#L2757) |  |
| [2758](#L2758) | if (count ( $rows ) > 0) { |
| [2759](#L2759) |  |
| [2760](#L2760) | foreach ( $rows as $row ) { |
| [2761](#L2761) |  |
| [2762](#L2762) | $imagename = $row ['image\_name']; |
| [2763](#L2763) | $video\_url = $row ['videourl']; |
| [2764](#L2764) | $video\_url\_org = $row ['murl']; |
| [2765](#L2765) | $Url\_vid = @parse\_url($video\_url\_org); |
| [2766](#L2766) |  |
| [2767](#L2767) |  |
| [2768](#L2768) |  |
| [2769](#L2769) | $relend = ''; |
| [2770](#L2770) | $flag=false; |
| [2771](#L2771) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [2772](#L2772) |  |
| [2773](#L2773) |  |
| [2774](#L2774) | parse\_str($Url\_vid['query'], $get\_array); |
| [2775](#L2775) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [2776](#L2776) |  |
| [2777](#L2777) | foreach($get\_array as $k=>$v){ |
| [2778](#L2778) |  |
| [2779](#L2779) | if($flag==false){ |
| [2780](#L2780) |  |
| [2781](#L2781) | $flag=true; |
| [2782](#L2782) | $relend.="?$k=$v"; |
| [2783](#L2783) | } |
| [2784](#L2784) | else{ |
| [2785](#L2785) |  |
| [2786](#L2786) | $relend.="&$k=$v"; |
| [2787](#L2787) |  |
| [2788](#L2788) | } |
| [2789](#L2789) |  |
| [2790](#L2790) |  |
| [2791](#L2791) | } |
| [2792](#L2792) |  |
| [2793](#L2793) |  |
| [2794](#L2794) | } |
| [2795](#L2795) |  |
| [2796](#L2796) |  |
| [2797](#L2797) |  |
| [2798](#L2798) | } |
| [2799](#L2799) |  |
| [2800](#L2800) | $vtype= $row ['vtype']; |
| [2801](#L2801) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [2802](#L2802) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [2803](#L2803) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [2804](#L2804) | $filenamewithoutextension = $pathinfo ['filename']; |
| [2805](#L2805) |  |
| [2806](#L2806) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [2807](#L2807) | $outputimg=$outputimgmain; |
| [2808](#L2808) | $media\_type=$row['media\_type']; |
| [2809](#L2809) | $hoverClass=''; |
| [2810](#L2810) | if($media\_type=="link") |
| [2811](#L2811) | $hoverClass="playbtnCss\_link"; |
| [2812](#L2812) | else if($media\_type=="video") |
| [2813](#L2813) | $hoverClass="playbtnCss\_video"; |
| [2814](#L2814) | else if($media\_type=="image") |
| [2815](#L2815) | $hoverClass="playbtnCss\_zoom"; |
| [2816](#L2816) |  |
| [2817](#L2817) | $title = ""; |
| [2818](#L2818) | $rowTitle = $row['title']; |
| [2819](#L2819) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [2820](#L2820) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [2821](#L2821) |  |
| [2822](#L2822) |  |
| [2823](#L2823) |  |
| [2824](#L2824) | $open\_link\_in = $row['open\_link\_in']; |
| [2825](#L2825) | $open\_title\_link\_in = 1; |
| [2826](#L2826) |  |
| [2827](#L2827) | if(!$open\_title\_link\_in) |
| [2828](#L2828) | $openImageInNewTab = '\_self'; |
| [2829](#L2829) | else |
| [2830](#L2830) | $openImageInNewTab = '\_blank'; |
| [2831](#L2831) |  |
| [2832](#L2832) | $embed\_url=$row['embed\_url'].$relend; |
| [2833](#L2833) | if($media\_type=="video"){ |
| [2834](#L2834) |  |
| [2835](#L2835) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [2836](#L2836) |  |
| [2837](#L2837) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [2838](#L2838) |  |
| [2839](#L2839) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [2840](#L2840) |  |
| [2841](#L2841) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [2842](#L2842) |  |
| [2843](#L2843) | } else { |
| [2844](#L2844) |  |
| [2845](#L2845) | if ($row['mdescription'] != '') |
| [2846](#L2846) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [2847](#L2847) |  |
| [2848](#L2848) | } |
| [2849](#L2849) | } |
| [2850](#L2850) | else if($media\_type=="image"){ |
| [2851](#L2851) |  |
| [2852](#L2852) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [2853](#L2853) |  |
| [2854](#L2854) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [2855](#L2855) |  |
| [2856](#L2856) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [2857](#L2857) |  |
| [2858](#L2858) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [2859](#L2859) |  |
| [2860](#L2860) | } else { |
| [2861](#L2861) |  |
| [2862](#L2862) | if ($row['mdescription'] != '') |
| [2863](#L2863) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [2864](#L2864) |  |
| [2865](#L2865) | } |
| [2866](#L2866) |  |
| [2867](#L2867) | } |
| [2868](#L2868) |  |
| [2869](#L2869) |  |
| [2870](#L2870) | ?> |
| [2871](#L2871) |  |
| [2872](#L2872) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [2873](#L2873) |  |
| [2874](#L2874) | <?php if ($open\_link\_in == 1): ?> |
| [2875](#L2875) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [2876](#L2876) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2877](#L2877) | </a> |
| [2878](#L2878) | <?php else: ?> |
| [2879](#L2879) |  |
| [2880](#L2880) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [2881](#L2881) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2882](#L2882) | </a> |
| [2883](#L2883) | <?php endif;?> |
| [2884](#L2884) |  |
| [2885](#L2885) | <?php else:?> |
| [2886](#L2886) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [2887](#L2887) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2888](#L2888) | </a> |
| [2889](#L2889) |  |
| [2890](#L2890) | <?php endif;?> |
| [2891](#L2891) |  |
| [2892](#L2892) |  |
| [2893](#L2893) |  |
| [2894](#L2894) | <?php } ?> |
| [2895](#L2895) |  |
| [2896](#L2896) | <?php } ?> |
| [2897](#L2897) | <br style="clear: both;"> |
| [2898](#L2898) | </div> |
| [2899](#L2899) | <?php |
| [2900](#L2900) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [2901](#L2901) | $num\_of\_pages = ceil($total / $limit); |
| [2902](#L2902) | $page\_links = paginate\_links(array( |
| [2903](#L2903) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [2904](#L2904) | 'format' => '', |
| [2905](#L2905) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [2906](#L2906) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [2907](#L2907) | 'total' => $num\_of\_pages, |
| [2908](#L2908) | 'current' => $pagenum, |
| [2909](#L2909) | 'prev\_next' => true, |
| [2910](#L2910) | 'type' => 'list', |
| [2911](#L2911) | )); |
| [2912](#L2912) |  |
| [2913](#L2913) | if ($page\_links) { |
| [2914](#L2914) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [2915](#L2915) |  |
| [2916](#L2916) | } |
| [2917](#L2917) | ?> |
| [2918](#L2918) |  |
| [2919](#L2919) | <div style="clear:both"></div> |
| [2920](#L2920) | </div> |
| [2921](#L2921) |  |
| [2922](#L2922) | <script> |
| [2923](#L2923) |  |
| [2924](#L2924) | <?php $uniqId = uniqid(); ?> |
| [2925](#L2925) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [2926](#L2926) |  |
| [2927](#L2927) | jQuery(document).ready(function() { |
| [2928](#L2928) |  |
| [2929](#L2929) |  |
| [2930](#L2930) |  |
| [2931](#L2931) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [2932](#L2932) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [2933](#L2933) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [2934](#L2934) | margin:<?php echo $settings ['imageMargin'];?>, |
| [2935](#L2935) | target:'<?php echo $target;?>', |
| [2936](#L2936) | init : function() { }, |
| [2937](#L2937) | loadPicture : function(event, img) {  }, |
| [2938](#L2938) | resize : function(event, gallery) {  }, |
| [2939](#L2939) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [2940](#L2940) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [2941](#L2941) | }); |
| [2942](#L2942) |  |
| [2943](#L2943) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [2944](#L2944) |  |
| [2945](#L2945) | 'overlayColor':'#000000', |
| [2946](#L2946) | 'padding': 3, |
| [2947](#L2947) | 'margin': 20, |
| [2948](#L2948) | 'autoScale': true, |
| [2949](#L2949) | 'autoDimensions':true, |
| [2950](#L2950) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [2951](#L2951) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [2952](#L2952) | 'transitionIn':'fade', |
| [2953](#L2953) | 'transitionOut':'fade', |
| [2954](#L2954) | 'titlePosition': 'outside', |
| [2955](#L2955) | 'cyclic':true, |
| [2956](#L2956) | 'hideOnContentClick':false, |
| [2957](#L2957) | 'width' : 650, |
| [2958](#L2958) | 'height' : 400, |
| [2959](#L2959) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [2960](#L2960) |  |
| [2961](#L2961) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [2962](#L2962) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [2963](#L2963) |  |
| [2964](#L2964) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [2965](#L2965) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [2966](#L2966) | } |
| [2967](#L2967) | else{ |
| [2968](#L2968) | return ''; |
| [2969](#L2969) | } |
| [2970](#L2970) |  |
| [2971](#L2971) | } |
| [2972](#L2972) | }); |
| [2973](#L2973) |  |
| [2974](#L2974) | jQuery(".page-numbers").show(); |
| [2975](#L2975) |  |
| [2976](#L2976) |  |
| [2977](#L2977) | }); |
| [2978](#L2978) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [2979](#L2979) |  |
| [2980](#L2980) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [2981](#L2981) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [2982](#L2982) |  |
| [2983](#L2983) | e.preventDefault(); |
| [2984](#L2984) | var data = { |
| [2985](#L2985) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [2986](#L2986) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [2987](#L2987) | 'grid\_id':0, |
| [2988](#L2988) | 'total\_rec':'<?php echo $total; ?>', |
| [2989](#L2989) | 'vNonce':'<?php echo $vNonce;?>' |
| [2990](#L2990) | }; |
| [2991](#L2991) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [2992](#L2992) |  |
| [2993](#L2993) |  |
| [2994](#L2994) | jQuery('html, body').animate({ |
| [2995](#L2995) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [2996](#L2996) | }, 800); |
| [2997](#L2997) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [2998](#L2998) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [2999](#L2999) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [3000](#L3000) |  |
| [3001](#L3001) |  |
| [3002](#L3002) | }); |
| [3003](#L3003) |  |
| [3004](#L3004) |  |
| [3005](#L3005) |  |
| [3006](#L3006) | }); |
| [3007](#L3007) |  |
| [3008](#L3008) |  |
| [3009](#L3009) |  |
| [3010](#L3010) | </script> |
| [3011](#L3011) |  |
| [3012](#L3012) |  |
| [3013](#L3013) | <?php } ?> |
| [3014](#L3014) |  |
| [3015](#L3015) | <div class="clear"></div> |
| [3016](#L3016) |  |
| [3017](#L3017) | <?php |
| [3018](#L3018) | $output = ob\_get\_clean(); |
| [3019](#L3019) | echo $output; |
| [3020](#L3020) | exit; |
| [3021](#L3021) |  |
| [3022](#L3022) | } |
| [3023](#L3023) | function rjg\_get\_youtube\_info\_justified\_gallery\_callback(){ |
| [3024](#L3024) |  |
| [3025](#L3025) | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
| [3026](#L3026) |  |
| [3027](#L3027) |  |
| [3028](#L3028) | $retrieved\_nonce = ''; |
| [3029](#L3029) |  |
| [3030](#L3030) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [3031](#L3031) |  |
| [3032](#L3032) | $retrieved\_nonce = sanitize\_text\_field($\_POST['vNonce']); |
| [3033](#L3033) | } |
| [3034](#L3034) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [3035](#L3035) |  |
| [3036](#L3036) |  |
| [3037](#L3037) | wp\_die('Security check fail'); |
| [3038](#L3038) | } |
| [3039](#L3039) |  |
| [3040](#L3040) |  |
| [3041](#L3041) | $vid=sanitize\_text\_field($\_POST['vid']); |
| [3042](#L3042) | $url=$\_POST['url']; |
| [3043](#L3043) |  |
| [3044](#L3044) | $output=  wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [3045](#L3045) |  |
| [3046](#L3046) | $output=json\_decode($output); |
| [3047](#L3047) |  |
| [3048](#L3048) |  |
| [3049](#L3049) |  |
| [3050](#L3050) | $return=array(); |
| [3051](#L3051) | if(is\_object($output)){ |
| [3052](#L3052) |  |
| [3053](#L3053) | $return['title']=sanitize\_text\_field($output->title); |
| [3054](#L3054) | $return['thumbnail\_url']=sanitize\_text\_field($output->thumbnail\_url); |
| [3055](#L3055) |  |
| [3056](#L3056) |  |
| [3057](#L3057) | } |
| [3058](#L3058) |  |
| [3059](#L3059) | echo json\_encode($return); |
| [3060](#L3060) | exit; |
| [3061](#L3061) |  |
| [3062](#L3062) | } |
| [3063](#L3063) |  |
| [3064](#L3064) | } |
| [3065](#L3065) | function rjg\_check\_file\_exist\_justified\_gallery\_callback() { |
| [3066](#L3066) |  |
| [3067](#L3067) | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
| [3068](#L3068) |  |
| [3069](#L3069) |  |
| [3070](#L3070) | $retrieved\_nonce = ''; |
| [3071](#L3071) |  |
| [3072](#L3072) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [3073](#L3073) |  |
| [3074](#L3074) | $retrieved\_nonce = sanitize\_text\_field($\_POST['vNonce']); |
| [3075](#L3075) | } |
| [3076](#L3076) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [3077](#L3077) |  |
| [3078](#L3078) |  |
| [3079](#L3079) | wp\_die('Security check fail'); |
| [3080](#L3080) | } |
| [3081](#L3081) |  |
| [3082](#L3082) | $response = wp\_remote\_get(sanitize\_text\_field($\_POST['url'])); |
| [3083](#L3083) | $httpCode = wp\_remote\_retrieve\_response\_code( $response ); |
| [3084](#L3084) |  |
| [3085](#L3085) | echo trim((string)$httpCode);die; |
| [3086](#L3086) |  |
| [3087](#L3087) | } |
| [3088](#L3088) |  |
| [3089](#L3089) | } |
| [3090](#L3090) | function rjg\_responsive\_justified\_gallery\_with\_lightbox\_admin\_options\_func() { |
| [3091](#L3091) |  |
| [3092](#L3092) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_settings' ) ) { |
| [3093](#L3093) |  |
| [3094](#L3094) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [3095](#L3095) |  |
| [3096](#L3096) | } |
| [3097](#L3097) |  |
| [3098](#L3098) | $url='admin.php?page=responsive\_justified\_gallery\_with\_lightbox'; |
| [3099](#L3099) |  |
| [3100](#L3100) |  |
| [3101](#L3101) | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
| [3102](#L3102) |  |
| [3103](#L3103) | if (isset ( $\_POST ['btnsave'] )) { |
| [3104](#L3104) |  |
| [3105](#L3105) | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
| [3106](#L3106) |  |
| [3107](#L3107) | wp\_die('Security check fail'); |
| [3108](#L3108) | } |
| [3109](#L3109) |  |
| [3110](#L3110) | $imageheight = intval(sanitize\_text\_field( $\_POST['imageheight'] )); |
| [3111](#L3111) | $imageMargin = intval(sanitize\_text\_field( $\_POST['imageMargin'] )); |
| [3112](#L3112) | $page\_size = intval(sanitize\_text\_field( $\_POST['page\_size'] )); |
| [3113](#L3113) | $BackgroundColor = sanitize\_text\_field( $\_POST['BackgroundColor']); |
| [3114](#L3114) | $show\_hover\_caption = intval(sanitize\_text\_field( $\_POST['show\_hover\_caption'] )); |
| [3115](#L3115) | $show\_hover\_icon = intval(sanitize\_text\_field( $\_POST['show\_hover\_icon'] )); |
| [3116](#L3116) |  |
| [3117](#L3117) | $rjg\_settings=array( |
| [3118](#L3118) |  |
| [3119](#L3119) | 'BackgroundColor'=>$BackgroundColor, |
| [3120](#L3120) | 'imageheight'=>$imageheight, |
| [3121](#L3121) | 'imageMargin'=>$imageMargin, |
| [3122](#L3122) | 'page\_size'=>$page\_size, |
| [3123](#L3123) | 'show\_hover\_caption'=>$show\_hover\_caption, |
| [3124](#L3124) | 'show\_hover\_icon'=>$show\_hover\_icon |
| [3125](#L3125) |  |
| [3126](#L3126) | ); |
| [3127](#L3127) |  |
| [3128](#L3128) |  |
| [3129](#L3129) | update\_option('rjg\_settings',$rjg\_settings); |
| [3130](#L3130) |  |
| [3131](#L3131) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [3132](#L3132) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [3133](#L3133) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Settings saved successfully.','wp-responsive-photo-gallery' ); |
| [3134](#L3134) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [3135](#L3135) |  |
| [3136](#L3136) |  |
| [3137](#L3137) | $location = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox'; |
| [3138](#L3138) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [3139](#L3139) | exit (); |
| [3140](#L3140) | } |
| [3141](#L3141) |  |
| [3142](#L3142) | $settings=get\_option('rjg\_settings'); |
| [3143](#L3143) |  |
| [3144](#L3144) |  |
| [3145](#L3145) | ?> |
| [3146](#L3146) | <div style="width: 100%;"> |
| [3147](#L3147) | <div style="float: left; width: 100%;"> |
| [3148](#L3148) | <div class="wrap"> |
| [3149](#L3149) | <table> |
| [3150](#L3150) | <tr> |
| [3151](#L3151) |  |
| [3152](#L3152) | <td> |
| [3153](#L3153) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [3154](#L3154) | <div id="fb-root"></div> |
| [3155](#L3155) | <script>(function(d, s, id) { |
| [3156](#L3156) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [3157](#L3157) | if (d.getElementById(id)) return; |
| [3158](#L3158) | js = d.createElement(s); js.id = id; |
| [3159](#L3159) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [3160](#L3160) | fjs.parentNode.insertBefore(js, fjs); |
| [3161](#L3161) | }(document, 'script', 'facebook-jssdk'));</script> |
| [3162](#L3162) | </td> |
| [3163](#L3163) | <td> |
| [3164](#L3164) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [3165](#L3165) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [3166](#L3166) | </a> |
| [3167](#L3167) | </td> |
| [3168](#L3168) | </tr> |
| [3169](#L3169) | </table> |
| [3170](#L3170) | <div style="clear:both"> |
| [3171](#L3171) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [3172](#L3172) | </div> |
| [3173](#L3173) | <?php |
| [3174](#L3174) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [3175](#L3175) | $type=''; |
| [3176](#L3176) | $message=''; |
| [3177](#L3177) | if(isset($messages['type']) and $messages['type']!=""){ |
| [3178](#L3178) |  |
| [3179](#L3179) | $type=$messages['type']; |
| [3180](#L3180) | $message=$messages['message']; |
| [3181](#L3181) |  |
| [3182](#L3182) | } |
| [3183](#L3183) |  |
| [3184](#L3184) |  |
| [3185](#L3185) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3186](#L3186) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3187](#L3187) |  |
| [3188](#L3188) |  |
| [3189](#L3189) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [3190](#L3190) | ?> |
| [3191](#L3191) | <h2><?php echo \_\_('Gallery Settings','wp-responsive-photo-gallery');?></h2> |
| [3192](#L3192) |  |
| [3193](#L3193) | <br> |
| [3194](#L3194) | <div id="poststuff"> |
| [3195](#L3195) | <div id="post-body"  class="metabox-holder columns-2"> |
| [3196](#L3196) | <div id="post-body-content"  > |
| [3197](#L3197) | <form method="post" action="" id="scrollersettiings" |
| [3198](#L3198) | name="scrollersettiings"> |
| [3199](#L3199) |  |
| [3200](#L3200) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3201](#L3201) | <h3> |
| [3202](#L3202) | <label><?php echo \_\_('Gallery Background color','wp-responsive-photo-gallery');?></label> |
| [3203](#L3203) | </h3> |
| [3204](#L3204) | <div class="inside"> |
| [3205](#L3205) | <table> |
| [3206](#L3206) | <tr> |
| [3207](#L3207) | <td><input type="text" id="BackgroundColor" size="30" |
| [3208](#L3208) | name="BackgroundColor" |
| [3209](#L3209) | value="<?php echo $settings['BackgroundColor']; ?>" |
| [3210](#L3210) | style="width: 100px;"> |
| [3211](#L3211) | <div style="clear: both"></div> |
| [3212](#L3212) | <div></div></td> |
| [3213](#L3213) | </tr> |
| [3214](#L3214) | </table> |
| [3215](#L3215) |  |
| [3216](#L3216) | <div style="clear: both"></div> |
| [3217](#L3217) | </div> |
| [3218](#L3218) | </div> |
| [3219](#L3219) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3220](#L3220) | <h3> |
| [3221](#L3221) | <label><?php echo \_\_('Max Image Height','wp-responsive-photo-gallery');?></label> |
| [3222](#L3222) | </h3> |
| [3223](#L3223) | <div class="inside"> |
| [3224](#L3224) | <table> |
| [3225](#L3225) | <tr> |
| [3226](#L3226) | <td><input type="text" id="imageheight" size="30" |
| [3227](#L3227) | name="imageheight" |
| [3228](#L3228) | value="<?php echo $settings['imageheight']; ?>" |
| [3229](#L3229) | style="width: 100px;"> |
| [3230](#L3230) | <div style="clear: both"></div> |
| [3231](#L3231) | <div></div></td> |
| [3232](#L3232) | </tr> |
| [3233](#L3233) | </table> |
| [3234](#L3234) |  |
| [3235](#L3235) | <div style="clear: both"></div> |
| [3236](#L3236) | </div> |
| [3237](#L3237) | </div> |
| [3238](#L3238) |  |
| [3239](#L3239) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3240](#L3240) | <h3> |
| [3241](#L3241) | <label><?php echo \_\_('Image Margin','wp-responsive-photo-gallery');?></label> |
| [3242](#L3242) | </h3> |
| [3243](#L3243) | <div class="inside"> |
| [3244](#L3244) | <table> |
| [3245](#L3245) | <tr> |
| [3246](#L3246) | <td><input type="text" id="imageMargin" size="30" |
| [3247](#L3247) | name="imageMargin" |
| [3248](#L3248) | value="<?php echo $settings['imageMargin']; ?>" |
| [3249](#L3249) | style="width: 100px;"> |
| [3250](#L3250) | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Gap between two images','wp-responsive-photo-gallery');?></div> |
| [3251](#L3251) | <div></div></td> |
| [3252](#L3252) | </tr> |
| [3253](#L3253) | </table> |
| [3254](#L3254) |  |
| [3255](#L3255) | <div style="clear: both"></div> |
| [3256](#L3256) | </div> |
| [3257](#L3257) | </div> |
| [3258](#L3258) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3259](#L3259) | <h3> |
| [3260](#L3260) | <label><?php echo \_\_('Page Size','wp-responsive-photo-gallery');?> </label> |
| [3261](#L3261) | </h3> |
| [3262](#L3262) | <div class="inside"> |
| [3263](#L3263) | <table> |
| [3264](#L3264) | <tr> |
| [3265](#L3265) | <td> |
| [3266](#L3266) | <input type="text" id="page\_size" size="30" |
| [3267](#L3267) | name="page\_size" |
| [3268](#L3268) | value="<?php echo $settings['page\_size']; ?>" |
| [3269](#L3269) | style="width: 100px;"> |
| [3270](#L3270) |  |
| [3271](#L3271) | <div style="clear: both"></div> |
| [3272](#L3272) | <div></div></td> |
| [3273](#L3273) | </tr> |
| [3274](#L3274) | </table> |
| [3275](#L3275) | <div style="clear: both"></div> |
| [3276](#L3276) | </div> |
| [3277](#L3277) | </div> |
| [3278](#L3278) |  |
| [3279](#L3279) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3280](#L3280) | <h3> |
| [3281](#L3281) | <label><?php echo \_\_('Show Caption On Hover ?','wp-responsive-photo-gallery');?></label> |
| [3282](#L3282) | </h3> |
| [3283](#L3283) | <div class="inside"> |
| [3284](#L3284) | <table> |
| [3285](#L3285) | <tr> |
| [3286](#L3286) | <td><input style="width: 20px;" type='radio' |
| [3287](#L3287) | <?php |
| [3288](#L3288) | if ($settings ['show\_hover\_caption'] == true) { |
| [3289](#L3289) | echo "checked='checked'"; |
| [3290](#L3290) | } |
| [3291](#L3291) | ?> |
| [3292](#L3292) | name='show\_hover\_caption' value='1'><?php echo \_\_('yes','wp-responsive-photo-gallery');?> &nbsp;<input |
| [3293](#L3293) | style="width: 20px;" type='radio' name='show\_hover\_caption' |
| [3294](#L3294) | <?php |
| [3295](#L3295) | if ($settings ['show\_hover\_caption'] == false) { |
| [3296](#L3296) | echo "checked='checked'"; |
| [3297](#L3297) | } |
| [3298](#L3298) | ?> |
| [3299](#L3299) | value='0'><?php echo \_\_('No','wp-responsive-photo-gallery');?> |
| [3300](#L3300) | <div style="clear: both"></div> |
| [3301](#L3301) | <div></div></td> |
| [3302](#L3302) | </tr> |
| [3303](#L3303) | </table> |
| [3304](#L3304) | <div style="clear: both"></div> |
| [3305](#L3305) | </div> |
| [3306](#L3306) | </div> |
| [3307](#L3307) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3308](#L3308) | <h3> |
| [3309](#L3309) | <label><?php echo \_\_('Show Icon On Hover ?','wp-responsive-photo-gallery');?></label> |
| [3310](#L3310) | </h3> |
| [3311](#L3311) | <div class="inside"> |
| [3312](#L3312) | <table> |
| [3313](#L3313) | <tr> |
| [3314](#L3314) | <td><input style="width: 20px;" type='radio' |
| [3315](#L3315) | <?php |
| [3316](#L3316) | if ($settings ['show\_hover\_icon'] == true) { |
| [3317](#L3317) | echo "checked='checked'"; |
| [3318](#L3318) | } |
| [3319](#L3319) | ?> |
| [3320](#L3320) | name='show\_hover\_icon' value='1'><?php echo \_\_('yes','wp-responsive-photo-gallery');?> &nbsp;<input |
| [3321](#L3321) | style="width: 20px;" type='radio' name='show\_hover\_icon' |
| [3322](#L3322) | <?php |
| [3323](#L3323) | if ($settings ['show\_hover\_icon'] == false) { |
| [3324](#L3324) | echo "checked='checked'"; |
| [3325](#L3325) | } |
| [3326](#L3326) | ?> |
| [3327](#L3327) | value='0'><?php echo \_\_('No','wp-responsive-photo-gallery');?> |
| [3328](#L3328) | <div style="clear: both"></div> |
| [3329](#L3329) | <div></div></td> |
| [3330](#L3330) | </tr> |
| [3331](#L3331) | </table> |
| [3332](#L3332) | <div style="clear: both"></div> |
| [3333](#L3333) | </div> |
| [3334](#L3334) | </div> |
| [3335](#L3335) |  |
| [3336](#L3336) |  |
| [3337](#L3337) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [3338](#L3338) | <input type="submit" |
| [3339](#L3339) | name="btnsave" id="btnsave" |
| [3340](#L3340) | value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [3341](#L3341) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [3342](#L3342) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" class="button-primary" |
| [3343](#L3343) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox'"> |
| [3344](#L3344) |  |
| [3345](#L3345) | </form> |
| [3346](#L3346) | <script type="text/javascript"> |
| [3347](#L3347) |  |
| [3348](#L3348) |  |
| [3349](#L3349) | jQuery(document).ready(function() { |
| [3350](#L3350) |  |
| [3351](#L3351) | jQuery("#scrollersettiings").validate({ |
| [3352](#L3352) | rules: { |
| [3353](#L3353) | name: { |
| [3354](#L3354) | required:true, |
| [3355](#L3355) | maxlength:200, |
| [3356](#L3356) | minlength:3, |
| [3357](#L3357) | }, |
| [3358](#L3358) | BackgroundColor:{ |
| [3359](#L3359) | required:true, |
| [3360](#L3360) | maxlength:7 |
| [3361](#L3361) | }, |
| [3362](#L3362) | imageheight:{ |
| [3363](#L3363) | required:true, |
| [3364](#L3364) | digits:true, |
| [3365](#L3365) | maxlength:15 |
| [3366](#L3366) | }, |
| [3367](#L3367) |  |
| [3368](#L3368) | imageMargin:{ |
| [3369](#L3369) | required:true, |
| [3370](#L3370) | number:true, |
| [3371](#L3371) | maxlength:15 |
| [3372](#L3372) | }, |
| [3373](#L3373) |  |
| [3374](#L3374) | page\_size:{ |
| [3375](#L3375) | required:true, |
| [3376](#L3376) | number:true, |
| [3377](#L3377) | maxlength:15 |
| [3378](#L3378) | } |
| [3379](#L3379) |  |
| [3380](#L3380) |  |
| [3381](#L3381) | }, |
| [3382](#L3382) | errorClass: "image\_error", |
| [3383](#L3383) | errorPlacement: function(error, element) { |
| [3384](#L3384) | error.appendTo(element.next().next()); |
| [3385](#L3385) | } |
| [3386](#L3386) |  |
| [3387](#L3387) |  |
| [3388](#L3388) | }) |
| [3389](#L3389) |  |
| [3390](#L3390) | jQuery('#BackgroundColor').wpColorPicker(); |
| [3391](#L3391) | }); |
| [3392](#L3392) | </script> |
| [3393](#L3393) |  |
| [3394](#L3394) | </div> |
| [3395](#L3395) | <div id="postbox-container-1" class="postbox-container" > |
| [3396](#L3396) |  |
| [3397](#L3397) | <div class="postbox"> |
| [3398](#L3398) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [3399](#L3399) | <div class="inside"> |
| [3400](#L3400) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [3401](#L3401) |  |
| [3402](#L3402) | <div style="margin:10px 5px"> |
| [3403](#L3403) |  |
| [3404](#L3404) | </div> |
| [3405](#L3405) | </div></div> |
| [3406](#L3406) | <div class="postbox"> |
| [3407](#L3407) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [3408](#L3408) | <div class="inside"> |
| [3409](#L3409) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px;width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [3410](#L3410) | <div style="margin:10px 5px"> |
| [3411](#L3411) | </div> |
| [3412](#L3412) | </div></div> |
| [3413](#L3413) |  |
| [3414](#L3414) |  |
| [3415](#L3415) |  |
| [3416](#L3416) | </div> |
| [3417](#L3417) | </div> |
| [3418](#L3418) | </div> |
| [3419](#L3419) | </div> |
| [3420](#L3420) | </div> |
| [3421](#L3421) | <div class="clear"></div> |
| [3422](#L3422) | </div> |
| [3423](#L3423) |  |
| [3424](#L3424) | <?php |
| [3425](#L3425) | } |
| [3426](#L3426) | function rjg\_responsive\_justified\_gallery\_with\_lightbox\_media\_management\_func() { |
| [3427](#L3427) |  |
| [3428](#L3428) | global $wpdb; |
| [3429](#L3429) | $action = 'gridview'; |
| [3430](#L3430) |  |
| [3431](#L3431) |  |
| [3432](#L3432) | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
| [3433](#L3433) |  |
| [3434](#L3434) | $action = trim ( sanitize\_text\_field($\_GET ['action'] )); |
| [3435](#L3435) |  |
| [3436](#L3436) | if(isset($\_GET['order\_by'])){ |
| [3437](#L3437) |  |
| [3438](#L3438) | if(sanitize\_sql\_orderby($\_GET['order\_by'])){ |
| [3439](#L3439) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3440](#L3440) | } |
| [3441](#L3441) | else{ |
| [3442](#L3442) |  |
| [3443](#L3443) | $order\_by=' id '; |
| [3444](#L3444) | } |
| [3445](#L3445) | } |
| [3446](#L3446) |  |
| [3447](#L3447) | if(isset($\_GET['order\_pos'])){ |
| [3448](#L3448) |  |
| [3449](#L3449) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3450](#L3450) | } |
| [3451](#L3451) |  |
| [3452](#L3452) | $search\_term\_=''; |
| [3453](#L3453) | if(isset($\_GET['search\_term'])){ |
| [3454](#L3454) |  |
| [3455](#L3455) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3456](#L3456) | } |
| [3457](#L3457) | } |
| [3458](#L3458) |  |
| [3459](#L3459) | $search\_term\_=''; |
| [3460](#L3460) | if(isset($\_GET['search\_term'])){ |
| [3461](#L3461) |  |
| [3462](#L3462) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3463](#L3463) | } |
| [3464](#L3464) | ?> |
| [3465](#L3465) |  |
| [3466](#L3466) | <?php |
| [3467](#L3467) | if (strtolower ( $action ) == strtolower ( 'gridview' )) { |
| [3468](#L3468) |  |
| [3469](#L3469) |  |
| [3470](#L3470) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_view\_media' ) ) { |
| [3471](#L3471) |  |
| [3472](#L3472) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [3473](#L3473) |  |
| [3474](#L3474) | } |
| [3475](#L3475) |  |
| [3476](#L3476) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [3477](#L3477) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [3478](#L3478) |  |
| [3479](#L3479) | $uploads = wp\_upload\_dir (); |
| [3480](#L3480) | $baseurl = $uploads ['baseurl']; |
| [3481](#L3481) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [3482](#L3482) |  |
| [3483](#L3483) | ?> |
| [3484](#L3484) | <div class="wrap"> |
| [3485](#L3485) |  |
| [3486](#L3486) | <table><tr> |
| [3487](#L3487) | <td> |
| [3488](#L3488) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [3489](#L3489) | <div id="fb-root"></div> |
| [3490](#L3490) | <script>(function(d, s, id) { |
| [3491](#L3491) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [3492](#L3492) | if (d.getElementById(id)) return; |
| [3493](#L3493) | js = d.createElement(s); js.id = id; |
| [3494](#L3494) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [3495](#L3495) | fjs.parentNode.insertBefore(js, fjs); |
| [3496](#L3496) | }(document, 'script', 'facebook-jssdk'));</script> |
| [3497](#L3497) | </td> |
| [3498](#L3498) | <td> |
| [3499](#L3499) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [3500](#L3500) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [3501](#L3501) | </a> |
| [3502](#L3502) | </td> |
| [3503](#L3503) | </tr> |
| [3504](#L3504) | </table> |
| [3505](#L3505) | <div style="clear:both"> |
| [3506](#L3506) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [3507](#L3507) | </div> |
| [3508](#L3508) | <?php |
| [3509](#L3509) | $messages = get\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages' ); |
| [3510](#L3510) | $type = ''; |
| [3511](#L3511) | $message = ''; |
| [3512](#L3512) | if (isset ( $messages ['type'] ) and $messages ['type'] != "") { |
| [3513](#L3513) |  |
| [3514](#L3514) | $type = $messages ['type']; |
| [3515](#L3515) | $message = $messages ['message']; |
| [3516](#L3516) | } |
| [3517](#L3517) |  |
| [3518](#L3518) |  |
| [3519](#L3519) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3520](#L3520) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3521](#L3521) |  |
| [3522](#L3522) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [3523](#L3523) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', array () ); |
| [3524](#L3524) | ?> |
| [3525](#L3525) |  |
| [3526](#L3526) | <div style="width: 100%;"> |
| [3527](#L3527) | <div id="modelMainDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [3528](#L3528) | <div id="LoaderDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [3529](#L3529) | <div id="ContainDiv" style="display:none;z-index: 1056; position: fixed; padding: 5px; margin: 0px; width: 30%; top: 40%; left: 35%; text-align: center; color: rgb(0, 0, 0); border: 1px solid #999999; background-color: rgb(255, 255, 255); cursor: wait;" > |
| [3530](#L3530) | <img src="<?php echo $url.'images/ajax-loader.gif'?>" /> |
| [3531](#L3531) | <h5 id="wait"><?php echo \_\_('Please wait while uploading images...','wp-responsive-photo-gallery');?></h5> |
| [3532](#L3532) | </div> |
| [3533](#L3533) | <div id="poststuff"> |
| [3534](#L3534) | <div id="post-body" class="metabox-holder columns-2"> |
| [3535](#L3535) | <div id="post-body-content"> |
| [3536](#L3536) | <div class="icon32 icon32-posts-post" id="icon-edit"> |
| [3537](#L3537) | <br> |
| [3538](#L3538) | </div> |
| [3539](#L3539) | <h1> |
| [3540](#L3540) | <?php echo \_\_('Media','wp-responsive-photo-gallery');?><a class="button add-new-h2" href="admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=addedit"><?php echo \_\_('Add New','wp-responsive-photo-gallery');?></a> |
| [3541](#L3541) | &nbsp;&nbsp; |
| [3542](#L3542) | <a class="massAdd button add-new-h2" href="javascript:void(0)"><?php echo \_\_('Mass Image Add','wp-responsive-photo-gallery');?></a> |
| [3543](#L3543) |  |
| [3544](#L3544) | </h1> |
| [3545](#L3545) | <br /> |
| [3546](#L3546) |  |
| [3547](#L3547) | <form method="POST" |
| [3548](#L3548) | action="admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=deleteselected" |
| [3549](#L3549) | id="posts-filter" onkeypress="return event.keyCode != 13;"> |
| [3550](#L3550) | <div class="alignleft actions"> |
| [3551](#L3551) | <select name="action\_upper" id="action\_upper"> |
| [3552](#L3552) | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','wp-responsive-photo-gallery');?></option> |
| [3553](#L3553) | <option value="delete"><?php echo \_\_('delete','wp-responsive-photo-gallery');?></option> |
| [3554](#L3554) | </select> <input type="submit" value="<?php echo \_\_('Apply','wp-responsive-photo-gallery');?>" |
| [3555](#L3555) | class="button-secondary action" id="deleteselected" |
| [3556](#L3556) | name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [3557](#L3557) | </div> |
| [3558](#L3558) | <?php |
| [3559](#L3559) |  |
| [3560](#L3560) |  |
| [3561](#L3561) |  |
| [3562](#L3562) | $setacrionpage='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [3563](#L3563) |  |
| [3564](#L3564) | if(isset($\_GET['order\_by']) and $\_GET['order\_by']!=""){ |
| [3565](#L3565) | $setacrionpage.='&order\_by='.esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3566](#L3566) | } |
| [3567](#L3567) |  |
| [3568](#L3568) | if(isset($\_GET['order\_pos']) and $\_GET['order\_pos']!=""){ |
| [3569](#L3569) | $setacrionpage.='&order\_pos='.esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3570](#L3570) | } |
| [3571](#L3571) |  |
| [3572](#L3572) | $seval=""; |
| [3573](#L3573) | if(isset($\_GET['search\_term']) and $\_GET['search\_term']!=""){ |
| [3574](#L3574) | $seval=esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3575](#L3575) | } |
| [3576](#L3576) |  |
| [3577](#L3577) | ?> |
| [3578](#L3578) | <br class="clear"> |
| [3579](#L3579) | <?php |
| [3580](#L3580) | global $wpdb; |
| [3581](#L3581) |  |
| [3582](#L3582) |  |
| [3583](#L3583) | $order\_by='id'; |
| [3584](#L3584) | $order\_pos="asc"; |
| [3585](#L3585) |  |
| [3586](#L3586) | if(isset($\_GET['order\_by']) and sanitize\_sql\_orderby($\_GET['order\_by'])!==false){ |
| [3587](#L3587) |  |
| [3588](#L3588) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3589](#L3589) | } |
| [3590](#L3590) |  |
| [3591](#L3591) | if(isset($\_GET['order\_pos'])){ |
| [3592](#L3592) |  |
| [3593](#L3593) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3594](#L3594) | } |
| [3595](#L3595) |  |
| [3596](#L3596) | $search\_term=''; |
| [3597](#L3597) | if(isset($\_GET['search\_term'])){ |
| [3598](#L3598) |  |
| [3599](#L3599) | $search\_term= esc\_html(sanitize\_text\_field(esc\_sql($\_GET['search\_term']))); |
| [3600](#L3600) | } |
| [3601](#L3601) |  |
| [3602](#L3602) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery "; |
| [3603](#L3603) | $queryCount = "SELECT count(\*) FROM " . $wpdb->prefix . "rjg\_gallery "; |
| [3604](#L3604) | if($search\_term!=''){ |
| [3605](#L3605) | $query.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [3606](#L3606) | $queryCount.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [3607](#L3607) | } |
| [3608](#L3608) |  |
| [3609](#L3609) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [3610](#L3610) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [3611](#L3611) |  |
| [3612](#L3612) | $query.=" order by $order\_by $order\_pos"; |
| [3613](#L3613) |  |
| [3614](#L3614) | $rowsCount=$wpdb->get\_var($queryCount); |
| [3615](#L3615) |  |
| [3616](#L3616) |  |
| [3617](#L3617) | ?> |
| [3618](#L3618) |  |
| [3619](#L3619) | <div style="padding-top:5px;padding-bottom:5px"> |
| [3620](#L3620) | <b><?php echo \_\_( 'Search','wp-responsive-photo-gallery');?> : </b> |
| [3621](#L3621) | <input type="text" value="<?php echo $seval;?>" id="search\_term" name="search\_term">&nbsp; |
| [3622](#L3622) | <input type='button'  value='<?php echo \_\_( 'Search','wp-responsive-photo-gallery');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
| [3623](#L3623) | <input type='button'  value='<?php echo \_\_( 'Reset Search','wp-responsive-photo-gallery');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
| [3624](#L3624) | </div> |
| [3625](#L3625) | <script type="text/javascript" > |
| [3626](#L3626) |  |
| [3627](#L3627) | jQuery('#search\_term').on("keyup", function(e) { |
| [3628](#L3628) | if (e.which == 13) { |
| [3629](#L3629) |  |
| [3630](#L3630) | SearchredirectTO(); |
| [3631](#L3631) | } |
| [3632](#L3632) | }); |
| [3633](#L3633) | function SearchredirectTO(){ |
| [3634](#L3634) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [3635](#L3635) | var searchval=jQuery('#search\_term').val(); |
| [3636](#L3636) | redirectto=redirectto+'&search\_term='+jQuery.trim(encodeURIComponent(searchval)); |
| [3637](#L3637) | window.location.href=redirectto; |
| [3638](#L3638) | } |
| [3639](#L3639) | function ResetSearch(){ |
| [3640](#L3640) |  |
| [3641](#L3641) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [3642](#L3642) | window.location.href=redirectto; |
| [3643](#L3643) | exit; |
| [3644](#L3644) | } |
| [3645](#L3645) | </script> |
| [3646](#L3646) | <div id="no-more-tables"> |
| [3647](#L3647) | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf wp-list-table widefat"> |
| [3648](#L3648) | <thead> |
| [3649](#L3649) | <tr> |
| [3650](#L3650) | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
| [3651](#L3651) | <?php if($order\_by=="id" and $order\_pos=="asc"):?> |
| [3652](#L3652) |  |
| [3653](#L3653) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3654](#L3654) | <?php else:?> |
| [3655](#L3655) | <?php if($order\_by=="id"):?> |
| [3656](#L3656) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3657](#L3657) | <?php else:?> |
| [3658](#L3658) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?></a></th> |
| [3659](#L3659) | <?php endif;?> |
| [3660](#L3660) | <?php endif;?> |
| [3661](#L3661) | <?php if($order\_by=="media\_type" and $order\_pos=="asc"):?> |
| [3662](#L3662) |  |
| [3663](#L3663) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3664](#L3664) | <?php else:?> |
| [3665](#L3665) | <?php if($order\_by=="media\_type"):?> |
| [3666](#L3666) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3667](#L3667) | <?php else:?> |
| [3668](#L3668) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?></a></th> |
| [3669](#L3669) | <?php endif;?> |
| [3670](#L3670) | <?php endif;?> |
| [3671](#L3671) |  |
| [3672](#L3672) |  |
| [3673](#L3673) | <?php if($order\_by=="title" and $order\_pos=="asc"):?> |
| [3674](#L3674) |  |
| [3675](#L3675) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3676](#L3676) | <?php else:?> |
| [3677](#L3677) | <?php if($order\_by=="title"):?> |
| [3678](#L3678) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3679](#L3679) | <?php else:?> |
| [3680](#L3680) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?></a></th> |
| [3681](#L3681) | <?php endif;?> |
| [3682](#L3682) | <?php endif;?> |
| [3683](#L3683) | <th><span></span></th> |
| [3684](#L3684) |  |
| [3685](#L3685) |  |
| [3686](#L3686) |  |
| [3687](#L3687) | <?php if($order\_by=="createdon" and $order\_pos=="asc"):?> |
| [3688](#L3688) |  |
| [3689](#L3689) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3690](#L3690) | <?php else:?> |
| [3691](#L3691) | <?php if($order\_by=="createdon"):?> |
| [3692](#L3692) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3693](#L3693) | <?php else:?> |
| [3694](#L3694) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?></a></th> |
| [3695](#L3695) | <?php endif;?> |
| [3696](#L3696) | <?php endif;?> |
| [3697](#L3697) |  |
| [3698](#L3698) |  |
| [3699](#L3699) | <th><span><?php echo \_\_('Edit','wp-responsive-photo-gallery');?></span></th> |
| [3700](#L3700) | <th><span><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></span></th> |
| [3701](#L3701) | </tr> |
| [3702](#L3702) | </thead> |
| [3703](#L3703) |  |
| [3704](#L3704) | <tbody id="the-list"> |
| [3705](#L3705) | <?php |
| [3706](#L3706) | if ($rowsCount > 0) { |
| [3707](#L3707) |  |
| [3708](#L3708) | global $wp\_rewrite; |
| [3709](#L3709) | $rows\_per\_page = 15; |
| [3710](#L3710) |  |
| [3711](#L3711) | $current = (isset($\_GET ['paged'])) ? ((int) intval(sanitize\_text\_field($\_GET ['paged']))) : 1; |
| [3712](#L3712) | $pagination\_args = array ( |
| [3713](#L3713) | 'base' => @add\_query\_arg ( 'paged', '%#%' ), |
| [3714](#L3714) | 'format' => '', |
| [3715](#L3715) | 'total' => ceil ( $rowsCount / $rows\_per\_page ), |
| [3716](#L3716) | 'current' => $current, |
| [3717](#L3717) | 'show\_all' => false, |
| [3718](#L3718) | 'type' => 'plain' |
| [3719](#L3719) | ); |
| [3720](#L3720) |  |
| [3721](#L3721) | $offset = ($current - 1) \* $rows\_per\_page; |
| [3722](#L3722) | $query.=" limit $offset, $rows\_per\_page"; |
| [3723](#L3723) | $rows = $wpdb->get\_results ( $query ,ARRAY\_A); |
| [3724](#L3724) | $delRecNonce = wp\_create\_nonce('delete\_image'); |
| [3725](#L3725) | foreach($rows as $row) { |
| [3726](#L3726) |  |
| [3727](#L3727) | $id = $row ['id']; |
| [3728](#L3728) | $editlink = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=addedit&id=$id"; |
| [3729](#L3729) | $deletelink = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=delete&id=$id&nonce=$delRecNonce"; |
| [3730](#L3730) |  |
| [3731](#L3731) | $outputimgmain = $baseurl . $row ['image\_name'].'?rand='.  rand(0, 5000); |
| [3732](#L3732) | ?> |
| [3733](#L3733) | <tr valign="top"> |
| [3734](#L3734) | <td class="alignCenter check-column" data-title="Select Record"><input |
| [3735](#L3735) | type="checkbox" value="<?php echo $row['id'] ?>" |
| [3736](#L3736) | name="thumbnails[]"></td> |
| [3737](#L3737) | <td data-title="<?php echo \_\_('Id','wp-responsive-photo-gallery');?>" class="alignCenter"><?php echo $row['id']; ?></td> |
| [3738](#L3738) | <td data-title="Video Type" class="alignCenter"><div> |
| [3739](#L3739) | <strong><?php echo $row['media\_type']; ?> <?php if($row['media\_type']=='video'):?> - <?php echo $row['vtype'];?><?php endif;?> </strong> |
| [3740](#L3740) | </div></td> |
| [3741](#L3741) | <td data-title="<?php echo \_\_('Title','wp-responsive-photo-gallery');?>" class="alignCenter"> |
| [3742](#L3742) | <div> |
| [3743](#L3743) | <strong><?php echo $row['title']; ?></strong> |
| [3744](#L3744) | </div></td> |
| [3745](#L3745) | <td class="alignCenter"><img src="<?php echo $outputimgmain; ?>" style="width: 100px" height="100px" /></td> |
| [3746](#L3746) | <td data-title="<?php echo \_\_('Published On','wp-responsive-photo-gallery');?>" class="alignCenter"><?php echo $row['createdon'] ?></td> |
| [3747](#L3747) | <td data-title="<?php echo \_\_('Edit','wp-responsive-photo-gallery');?>" class="alignCenter"><strong><a href='<?php echo $editlink; ?>' title="<?php echo \_\_('Edit','wp-responsive-photo-gallery');?>"><?php echo \_\_('Edit','wp-responsive-photo-gallery');?></a></strong></td> |
| [3748](#L3748) | <td data-title="<?php echo \_\_('Delete','wp-responsive-photo-gallery');?>" class="alignCenter"><strong><a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();" title="<?php echo \_\_('Delete','wp-responsive-photo-gallery');?>"><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></a> </strong></td> |
| [3749](#L3749) | </tr> |
| [3750](#L3750) | <?php |
| [3751](#L3751) | } |
| [3752](#L3752) | } else { |
| [3753](#L3753) | ?> |
| [3754](#L3754) | <tr valign="top" class="" |
| [3755](#L3755) | id=""> |
| [3756](#L3756) | <td colspan="9" data-title="<?php echo \_\_('No Record','wp-responsive-photo-gallery');?>" align="center"><strong><?php echo \_\_('No Media Found','wp-responsive-photo-gallery');?></strong></td> |
| [3757](#L3757) | </tr> |
| [3758](#L3758) | <?php |
| [3759](#L3759) | } |
| [3760](#L3760) | ?> |
| [3761](#L3761) | </tbody> |
| [3762](#L3762) | </table> |
| [3763](#L3763) | </div> |
| [3764](#L3764) | <?php |
| [3765](#L3765) | if ($rowsCount> 0) { |
| [3766](#L3766) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [3767](#L3767) | echo paginate\_links ( $pagination\_args ); |
| [3768](#L3768) | echo "</div>"; |
| [3769](#L3769) | } |
| [3770](#L3770) | ?> |
| [3771](#L3771) | <br /> |
| [3772](#L3772) | <div class="alignleft actions"> |
| [3773](#L3773) | <select name="action" id="action\_bottom"> |
| [3774](#L3774) | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','wp-responsive-photo-gallery');?></option> |
| [3775](#L3775) | <option value="delete"><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></option> |
| [3776](#L3776) | </select> |
| [3777](#L3777) | <?php wp\_nonce\_field('action\_settings\_mass\_delete', 'mass\_delete\_nonce'); ?> |
| [3778](#L3778) | <input type="submit" value="<?php echo \_\_('Apply','wp-responsive-photo-gallery');?>" |
| [3779](#L3779) | class="button-secondary action" id="deleteselected" |
| [3780](#L3780) | name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [3781](#L3781) | </div> |
| [3782](#L3782) |  |
| [3783](#L3783) | </form> |
| [3784](#L3784) | <script type="text/JavaScript"> |
| [3785](#L3785) |  |
| [3786](#L3786) | function  confirmDelete\_bulk(){ |
| [3787](#L3787) | var topval=document.getElementById("action\_bottom").value; |
| [3788](#L3788) | var bottomVal=document.getElementById("action\_upper").value; |
| [3789](#L3789) |  |
| [3790](#L3790) | if(topval=='delete' || bottomVal=='delete'){ |
| [3791](#L3791) |  |
| [3792](#L3792) |  |
| [3793](#L3793) | var agree=confirm("<?php echo \_\_('Are you sure you want to delete selected media ?','wp-responsive-photo-gallery');?>"); |
| [3794](#L3794) | if (agree) |
| [3795](#L3795) | return true ; |
| [3796](#L3796) | else |
| [3797](#L3797) | return false; |
| [3798](#L3798) | } |
| [3799](#L3799) | } |
| [3800](#L3800) |  |
| [3801](#L3801) | function  confirmDelete(){ |
| [3802](#L3802) | var agree=confirm("<?php echo \_\_('Are you sure you want to delete this media ?','wp-responsive-photo-gallery');?>"); |
| [3803](#L3803) | if (agree) |
| [3804](#L3804) | return true ; |
| [3805](#L3805) | else |
| [3806](#L3806) | return false; |
| [3807](#L3807) | } |
| [3808](#L3808) |  |
| [3809](#L3809) | var nonce\_sec='<?php echo wp\_create\_nonce( "thumbnail-mass-image" );?>'; |
| [3810](#L3810) | jQuery(document).ready(function() { |
| [3811](#L3811) | //uploading files variable |
| [3812](#L3812) | var custom\_file\_frame; |
| [3813](#L3813) | jQuery(".massAdd").click(function(event) { |
| [3814](#L3814) | var slider\_id=jQuery(this).attr('id'); |
| [3815](#L3815) | event.preventDefault(); |
| [3816](#L3816) | //If the frame already exists, reopen it |
| [3817](#L3817) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [3818](#L3818) | custom\_file\_frame.close(); |
| [3819](#L3819) | } |
| [3820](#L3820) |  |
| [3821](#L3821) | //Create WP media frame. |
| [3822](#L3822) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [3823](#L3823) | //Title of media manager frame |
| [3824](#L3824) | title: "<?php echo \_\_("WP Media Uploader",'wp-responsive-photo-gallery');?>", |
| [3825](#L3825) | library: { |
| [3826](#L3826) | type: 'image' |
| [3827](#L3827) | }, |
| [3828](#L3828) | button: { |
| [3829](#L3829) | //Button text |
| [3830](#L3830) | text: "<?php echo \_\_("Set Image",'wp-responsive-photo-gallery');?>" |
| [3831](#L3831) | }, |
| [3832](#L3832) | //Do not allow multiple files, if you want multiple, set true |
| [3833](#L3833) | multiple: true |
| [3834](#L3834) | }); |
| [3835](#L3835) |  |
| [3836](#L3836) | //callback for selected image |
| [3837](#L3837) |  |
| [3838](#L3838) | custom\_file\_frame.on('select', function() { |
| [3839](#L3839) |  |
| [3840](#L3840) |  |
| [3841](#L3841) | jQuery("#modelMainDiv").show(); |
| [3842](#L3842) | jQuery("#LoaderDiv").show(); |
| [3843](#L3843) | jQuery("#ContainDiv").show(); |
| [3844](#L3844) | var selection = custom\_file\_frame.state().get('selection'); |
| [3845](#L3845) | selection.map(function(attachment) { |
| [3846](#L3846) |  |
| [3847](#L3847) | attachment = attachment.toJSON(); |
| [3848](#L3848) | var validExtensions=new Array(); |
| [3849](#L3849) | validExtensions[0]='jpg'; |
| [3850](#L3850) | validExtensions[1]='jpeg'; |
| [3851](#L3851) | validExtensions[2]='png'; |
| [3852](#L3852) | validExtensions[3]='gif'; |
| [3853](#L3853) |  |
| [3854](#L3854) |  |
| [3855](#L3855) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [3856](#L3856) |  |
| [3857](#L3857) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [3858](#L3858) |  |
| [3859](#L3859) | var titleTouse=""; |
| [3860](#L3860) | var imageDescriptionTouse=""; |
| [3861](#L3861) |  |
| [3862](#L3862) | if(jQuery.trim(attachment.title)!=''){ |
| [3863](#L3863) |  |
| [3864](#L3864) | titleTouse=jQuery.trim(attachment.title); |
| [3865](#L3865) | } |
| [3866](#L3866) | else if(jQuery.trim(attachment.caption)!=''){ |
| [3867](#L3867) |  |
| [3868](#L3868) | titleTouse=jQuery.trim(attachment.caption); |
| [3869](#L3869) | } |
| [3870](#L3870) |  |
| [3871](#L3871) | if(jQuery.trim(attachment.description)!=''){ |
| [3872](#L3872) |  |
| [3873](#L3873) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [3874](#L3874) | } |
| [3875](#L3875) | else if(jQuery.trim(attachment.caption)!=''){ |
| [3876](#L3876) |  |
| [3877](#L3877) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [3878](#L3878) | } |
| [3879](#L3879) |  |
| [3880](#L3880) | var data = { |
| [3881](#L3881) | imagetitle:titleTouse, |
| [3882](#L3882) | image\_description: imageDescriptionTouse, |
| [3883](#L3883) | attachment\_id:attachment.id, |
| [3884](#L3884) | slider\_id:slider\_id, |
| [3885](#L3885) | action: 'mass\_upload\_wpresponsivephgalleryms', |
| [3886](#L3886) | thumbnail\_security:nonce\_sec |
| [3887](#L3887) | }; |
| [3888](#L3888) |  |
| [3889](#L3889) | url='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=mass\_upload\_wpresponsivephgalleryms' |
| [3890](#L3890) | jQuery.ajax({ |
| [3891](#L3891) | type: 'POST', |
| [3892](#L3892) | url: ajaxurl, |
| [3893](#L3893) | data: data, |
| [3894](#L3894) | success: function(result) { |
| [3895](#L3895) | if(result.isOk == false) |
| [3896](#L3896) | alert(result.message); |
| [3897](#L3897) | }, |
| [3898](#L3898) | dataType:'html', |
| [3899](#L3899) | async:false |
| [3900](#L3900) | }); |
| [3901](#L3901) |  |
| [3902](#L3902) |  |
| [3903](#L3903) | } |
| [3904](#L3904) |  |
| [3905](#L3905) | }); |
| [3906](#L3906) |  |
| [3907](#L3907) | jQuery("#modelMainDiv").hide(); |
| [3908](#L3908) | jQuery("#LoaderDiv").hide(); |
| [3909](#L3909) | jQuery("#ContainDiv").hide(); |
| [3910](#L3910) |  |
| [3911](#L3911) | }); |
| [3912](#L3912) |  |
| [3913](#L3913) | custom\_file\_frame.on('close', function() { |
| [3914](#L3914) | window.location.reload(); |
| [3915](#L3915) | }); |
| [3916](#L3916) |  |
| [3917](#L3917) | //Open modal |
| [3918](#L3918) | custom\_file\_frame.open(); |
| [3919](#L3919) | }); |
| [3920](#L3920) | }) |
| [3921](#L3921) | </script> |
| [3922](#L3922) |  |
| [3923](#L3923) | <br class="clear"> |
| [3924](#L3924) | <div style="clear: both;"></div> |
| [3925](#L3925) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [3926](#L3926) |  |
| [3927](#L3927) |  |
| [3928](#L3928) |  |
| [3929](#L3929) | <h3><?php echo \_\_('To print this masonry gallery into WordPress Post/Page use below code','wp-responsive-photo-gallery');?></h3> |
| [3930](#L3930) | <input type="text" |
| [3931](#L3931) | value='[print\_masonry\_gallery\_plus\_lightbox] ' |
| [3932](#L3932) | style="width: 400px; height: 30px" |
| [3933](#L3933) | onclick="this.focus(); this.select()" /> |
| [3934](#L3934) | <div class="clear"></div> |
| [3935](#L3935) | <h3><?php echo \_\_('To print this masonry gallery into WordPress theme/template PHP files use below code','wp-responsive-photo-gallery');?></h3> |
| [3936](#L3936) | <?php |
| [3937](#L3937) | $shortcode = '[print\_masonry\_gallery\_plus\_lightbox]'; |
| [3938](#L3938) | ?> |
| [3939](#L3939) | <input type="text" |
| [3940](#L3940) | value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" |
| [3941](#L3941) | style="width: 400px; height: 30px" |
| [3942](#L3942) | onclick="this.focus(); this.select()" /> |
| [3943](#L3943) | <div class="clear"></div> |
| [3944](#L3944) | </div> |
| [3945](#L3945) |  |
| [3946](#L3946) | <div id="postbox-container-1" class="postbox-container"  > |
| [3947](#L3947) |  |
| [3948](#L3948) | <div class="postbox"> |
| [3949](#L3949) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [3950](#L3950) | <div class="inside"> |
| [3951](#L3951) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [3952](#L3952) |  |
| [3953](#L3953) | <div style="margin:10px 5px"> |
| [3954](#L3954) |  |
| [3955](#L3955) | </div> |
| [3956](#L3956) | </div></div> |
| [3957](#L3957) | <div class="postbox"> |
| [3958](#L3958) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [3959](#L3959) | <div class="inside"> |
| [3960](#L3960) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [3961](#L3961) | <div style="margin:10px 5px"> |
| [3962](#L3962) | </div> |
| [3963](#L3963) | </div></div> |
| [3964](#L3964) |  |
| [3965](#L3965) |  |
| [3966](#L3966) | </div> |
| [3967](#L3967) | </div> |
| [3968](#L3968) |  |
| [3969](#L3969) | </div> |
| [3970](#L3970) | </div> |
| [3971](#L3971) | <?php |
| [3972](#L3972) | } else if (strtolower ( $action ) == strtolower ( 'addedit' )) { |
| [3973](#L3973) | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
| [3974](#L3974) | $vNonce = wp\_create\_nonce('vNonce'); |
| [3975](#L3975) | ?><?php |
| [3976](#L3976) | if (isset ( $\_POST ['btnsave'] )) { |
| [3977](#L3977) |  |
| [3978](#L3978) | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
| [3979](#L3979) |  |
| [3980](#L3980) | wp\_die('Security check fail'); |
| [3981](#L3981) | } |
| [3982](#L3982) | $uploads = wp\_upload\_dir (); |
| [3983](#L3983) | $baseDir = $uploads ['basedir']; |
| [3984](#L3984) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [3985](#L3985) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [3986](#L3986) |  |
| [3987](#L3987) | if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='video'){ |
| [3988](#L3988) |  |
| [3989](#L3989) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [3990](#L3990) | $vtype = trim ( sanitize\_text\_field( $\_POST ['vtype'] ) ); |
| [3991](#L3991) | $videourl = trim (esc\_url\_raw($\_POST ['videourl'] )); |
| [3992](#L3992) | // echo $videourl;die; |
| [3993](#L3993) |  |
| [3994](#L3994) |  |
| [3995](#L3995) |  |
| [3996](#L3996) | $vid = uniqid ( 'vid\_' ); |
| [3997](#L3997) | $embed\_url=''; |
| [3998](#L3998) | if ($vtype == 'youtube') { |
| [3999](#L3999) | // parse |
| [4000](#L4000) |  |
| [4001](#L4001) | $parseUrl = @parse\_url ( $videourl ); |
| [4002](#L4002) | if (is\_array ( $parseUrl )) { |
| [4003](#L4003) |  |
| [4004](#L4004) | $queryStr = $parseUrl ['query']; |
| [4005](#L4005) | parse\_str ( $queryStr, $array ); |
| [4006](#L4006) | if (is\_array ( $array ) and isset ( $array ['v'] )) { |
| [4007](#L4007) |  |
| [4008](#L4008) | $vid = $array ['v']; |
| [4009](#L4009) | } |
| [4010](#L4010) | } |
| [4011](#L4011) |  |
| [4012](#L4012) | $embed\_url="//www.youtube.com/embed/$vid"; |
| [4013](#L4013) | } |
| [4014](#L4014) |  |
| [4015](#L4015) | else if($vtype=='dailymotion'){ |
| [4016](#L4016) |  |
| [4017](#L4017) | $url\_arr = parse\_url($videourl); |
| [4018](#L4018) | if(isset($url\_arr['query'])){ |
| [4019](#L4019) |  |
| [4020](#L4020) | $query = $url\_arr['query']; |
| [4021](#L4021) | $videourl = str\_replace(array($query,'?'), '', $videourl); |
| [4022](#L4022) | } |
| [4023](#L4023) | $pos = strpos($videourl, '/video/'); |
| [4024](#L4024) | $vid=0; |
| [4025](#L4025) | if ($pos !== false){ |
| [4026](#L4026) |  |
| [4027](#L4027) | $vid=substr($videourl, $pos+strlen('/video/')); |
| [4028](#L4028) |  |
| [4029](#L4029) | } |
| [4030](#L4030) |  |
| [4031](#L4031) |  |
| [4032](#L4032) | $embed\_url="//www.dailymotion.com/embed/video/$vid"; |
| [4033](#L4033) |  |
| [4034](#L4034) | } |
| [4035](#L4035) |  |
| [4036](#L4036) |  |
| [4037](#L4037) |  |
| [4038](#L4038) | $HdnMediaSelection = trim ( esc\_url\_raw($\_POST ['HdnMediaSelection'] )); |
| [4039](#L4039) | $videotitle = trim ( sanitize\_text\_field($\_POST ['title'] )) ; |
| [4040](#L4040) |  |
| [4041](#L4041) | $videotitle = str\_replace("'","’",$videotitle); |
| [4042](#L4042) | $videotitle = str\_replace('"', '&quot;', $videotitle); |
| [4043](#L4043) |  |
| [4044](#L4044) |  |
| [4045](#L4045) | if($vtype=='html5'){ |
| [4046](#L4046) |  |
| [4047](#L4047) | $open\_link\_in = 1; |
| [4048](#L4048) |  |
| [4049](#L4049) | }else{ |
| [4050](#L4050) |  |
| [4051](#L4051) | if (isset ( $\_POST ['open\_link\_in'] )) |
| [4052](#L4052) | $open\_link\_in = 1; |
| [4053](#L4053) | else |
| [4054](#L4054) | $open\_link\_in = 0; |
| [4055](#L4055) |  |
| [4056](#L4056) | } |
| [4057](#L4057) |  |
| [4058](#L4058) |  |
| [4059](#L4059) |  |
| [4060](#L4060) |  |
| [4061](#L4061) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4062](#L4062) | // edit save |
| [4063](#L4063) |  |
| [4064](#L4064) | if (isset ( $\_POST ['videoid'] )) { |
| [4065](#L4065) |  |
| [4066](#L4066) |  |
| [4067](#L4067) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4068](#L4068) |  |
| [4069](#L4069) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4070](#L4070) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4071](#L4071) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4072](#L4072) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4073](#L4073) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4074](#L4074) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4075](#L4075) | exit; |
| [4076](#L4076) |  |
| [4077](#L4077) | } |
| [4078](#L4078) |  |
| [4079](#L4079) | try { |
| [4080](#L4080) |  |
| [4081](#L4081) | $videoidEdit=intval($\_POST ['videoid']); |
| [4082](#L4082) | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
| [4083](#L4083) |  |
| [4084](#L4084) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4085](#L4085) | $myrow = $wpdb->get\_row($query); |
| [4086](#L4086) |  |
| [4087](#L4087) |  |
| [4088](#L4088) | if (is\_object($myrow)) { |
| [4089](#L4089) |  |
| [4090](#L4090) | $image\_name = $myrow->image\_name; |
| [4091](#L4091) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4092](#L4092) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4093](#L4093) | $pInfo2 = pathinfo($imagetoDel); |
| [4094](#L4094) | $ext = $pInfo2 ['extension']; |
| [4095](#L4095) |  |
| [4096](#L4096) | @unlink($imagetoDel); |
| [4097](#L4097) |  |
| [4098](#L4098) | } |
| [4099](#L4099) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4100](#L4100) | $ext = $pInfo ['extension']; |
| [4101](#L4101) | $imagename = uniqid("vid\_") .".". $ext; |
| [4102](#L4102) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4103](#L4103) |  |
| [4104](#L4104) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4105](#L4105) | if(!file\_exists($imageUploadTo)){ |
| [4106](#L4106) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4107](#L4107) | } |
| [4108](#L4108) |  |
| [4109](#L4109) |  |
| [4110](#L4110) | } |
| [4111](#L4111) |  |
| [4112](#L4112) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4113](#L4113) | set media\_type='$media\_type', vtype='$vtype',vid='$vid',murl='$videourl',embed\_url='$embed\_url',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4114](#L4114) | title='$videotitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4115](#L4115) |  |
| [4116](#L4116) | //echo $query;die; |
| [4117](#L4117) | $wpdb->query ( $query ); |
| [4118](#L4118) |  |
| [4119](#L4119) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4120](#L4120) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4121](#L4121) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Video updated successfully.','wp-responsive-photo-gallery'); |
| [4122](#L4122) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4123](#L4123) |  |
| [4124](#L4124) | } catch ( Exception $e ) { |
| [4125](#L4125) |  |
| [4126](#L4126) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4127](#L4127) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4128](#L4128) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding video','wp-responsive-photo-gallery'); |
| [4129](#L4129) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4130](#L4130) | } |
| [4131](#L4131) |  |
| [4132](#L4132) |  |
| [4133](#L4133) |  |
| [4134](#L4134) |  |
| [4135](#L4135) |  |
| [4136](#L4136) | } else { |
| [4137](#L4137) |  |
| [4138](#L4138) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4139](#L4139) |  |
| [4140](#L4140) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4141](#L4141) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4142](#L4142) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4143](#L4143) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4144](#L4144) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4145](#L4145) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4146](#L4146) | exit; |
| [4147](#L4147) |  |
| [4148](#L4148) | } |
| [4149](#L4149) |  |
| [4150](#L4150) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4151](#L4151) | if (function\_exists ( 'date\_i18n' )) { |
| [4152](#L4152) |  |
| [4153](#L4153) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4154](#L4154) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4155](#L4155) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4156](#L4156) | else |
| [4157](#L4157) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4158](#L4158) | } |
| [4159](#L4159) |  |
| [4160](#L4160) | try { |
| [4161](#L4161) |  |
| [4162](#L4162) | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
| [4163](#L4163) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4164](#L4164) | $ext = isset($pInfo ['extension'])?$pInfo ['extension']:'jpeg'; |
| [4165](#L4165) | $imagename = uniqid("vid\_") . ".".$ext; |
| [4166](#L4166) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4167](#L4167) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4168](#L4168) | if(!file\_exists($imageUploadTo)){ |
| [4169](#L4169) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4170](#L4170) | } |
| [4171](#L4171) | } |
| [4172](#L4172) |  |
| [4173](#L4173) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4174](#L4174) | (media\_type,image\_name,title,murl,open\_link\_in,vtype,vid,videourl,embed\_url,HdnMediaSelection,createdon) |
| [4175](#L4175) | VALUES ('$media\_type','$imagename','$videotitle','$videourl', |
| [4176](#L4176) | $open\_link\_in,'$vtype','$vid','$videourl','$embed\_url','$HdnMediaSelection', '$createdOn')"; |
| [4177](#L4177) |  |
| [4178](#L4178) |  |
| [4179](#L4179) | $wpdb->query ( $query ); |
| [4180](#L4180) |  |
| [4181](#L4181) |  |
| [4182](#L4182) |  |
| [4183](#L4183) |  |
| [4184](#L4184) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4185](#L4185) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4186](#L4186) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New video added successfully.','wp-responsive-photo-gallery'); |
| [4187](#L4187) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4188](#L4188) | } catch ( Exception $e ) { |
| [4189](#L4189) |  |
| [4190](#L4190) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4191](#L4191) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4192](#L4192) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding video','wp-responsive-photo-gallery'); |
| [4193](#L4193) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4194](#L4194) | } |
| [4195](#L4195) |  |
| [4196](#L4196) |  |
| [4197](#L4197) | } |
| [4198](#L4198) |  |
| [4199](#L4199) | } |
| [4200](#L4200) | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='image'){ |
| [4201](#L4201) |  |
| [4202](#L4202) | global $wpdb; |
| [4203](#L4203) | $vid = uniqid ( 'vid\_' ); |
| [4204](#L4204) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [4205](#L4205) | $HdnMediaSelection = trim ( esc\_url\_raw($\_POST ['HdnMediaSelection\_image'] )); |
| [4206](#L4206) | $mtitle = trim ( sanitize\_text\_field($\_POST ['title'] )) ; |
| [4207](#L4207) |  |
| [4208](#L4208) | $mtitle = str\_replace("'","’",$mtitle); |
| [4209](#L4209) | $mtitle = str\_replace('"', '&quot;', $mtitle); |
| [4210](#L4210) | $murl = trim ( sanitize\_text\_field($\_POST ['murl'] )); |
| [4211](#L4211) |  |
| [4212](#L4212) |  |
| [4213](#L4213) |  |
| [4214](#L4214) |  |
| [4215](#L4215) | if (isset ( $\_POST ['open\_link\_in'] )) |
| [4216](#L4216) | $open\_link\_in = 1; |
| [4217](#L4217) | else |
| [4218](#L4218) | $open\_link\_in = 0; |
| [4219](#L4219) |  |
| [4220](#L4220) |  |
| [4221](#L4221) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4222](#L4222) | // edit save |
| [4223](#L4223) | if (isset ( $\_POST ['imageid'] )) { |
| [4224](#L4224) |  |
| [4225](#L4225) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4226](#L4226) |  |
| [4227](#L4227) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4228](#L4228) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4229](#L4229) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4230](#L4230) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4231](#L4231) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4232](#L4232) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4233](#L4233) | exit; |
| [4234](#L4234) |  |
| [4235](#L4235) | } |
| [4236](#L4236) |  |
| [4237](#L4237) | try { |
| [4238](#L4238) |  |
| [4239](#L4239) | $videoidEdit=intval(sanitize\_text\_field($\_POST ['imageid'])); |
| [4240](#L4240) | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
| [4241](#L4241) |  |
| [4242](#L4242) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4243](#L4243) | $myrow = $wpdb->get\_row($query); |
| [4244](#L4244) |  |
| [4245](#L4245) |  |
| [4246](#L4246) | if (is\_object($myrow)) { |
| [4247](#L4247) |  |
| [4248](#L4248) | $image\_name = $myrow->image\_name; |
| [4249](#L4249) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4250](#L4250) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4251](#L4251) | $pInfo2 = pathinfo($imagetoDel); |
| [4252](#L4252) | $ext = $pInfo2 ['extension']; |
| [4253](#L4253) |  |
| [4254](#L4254) | @unlink($imagetoDel); |
| [4255](#L4255) |  |
| [4256](#L4256) | } |
| [4257](#L4257) |  |
| [4258](#L4258) |  |
| [4259](#L4259) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4260](#L4260) | $ext = $pInfo ['extension']; |
| [4261](#L4261) | $imagename = uniqid("vid\_").".". $ext; |
| [4262](#L4262) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4263](#L4263) |  |
| [4264](#L4264) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4265](#L4265) | if(!file\_exists($imageUploadTo)){ |
| [4266](#L4266) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4267](#L4267) | } |
| [4268](#L4268) |  |
| [4269](#L4269) |  |
| [4270](#L4270) | } |
| [4271](#L4271) |  |
| [4272](#L4272) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4273](#L4273) | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4274](#L4274) | title='$mtitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4275](#L4275) |  |
| [4276](#L4276) | //echo $query;die; |
| [4277](#L4277) | $wpdb->query ( $query ); |
| [4278](#L4278) |  |
| [4279](#L4279) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4280](#L4280) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4281](#L4281) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Image updated successfully.','wp-responsive-photo-gallery'); |
| [4282](#L4282) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4283](#L4283) |  |
| [4284](#L4284) | } catch ( Exception $e ) { |
| [4285](#L4285) |  |
| [4286](#L4286) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4287](#L4287) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4288](#L4288) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding image','wp-responsive-photo-gallery'); |
| [4289](#L4289) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4290](#L4290) | } |
| [4291](#L4291) |  |
| [4292](#L4292) |  |
| [4293](#L4293) |  |
| [4294](#L4294) | } else { |
| [4295](#L4295) |  |
| [4296](#L4296) |  |
| [4297](#L4297) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4298](#L4298) |  |
| [4299](#L4299) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4300](#L4300) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4301](#L4301) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4302](#L4302) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4303](#L4303) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4304](#L4304) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4305](#L4305) | exit; |
| [4306](#L4306) |  |
| [4307](#L4307) | } |
| [4308](#L4308) |  |
| [4309](#L4309) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4310](#L4310) | if (function\_exists ( 'date\_i18n' )) { |
| [4311](#L4311) |  |
| [4312](#L4312) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4313](#L4313) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4314](#L4314) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4315](#L4315) | else |
| [4316](#L4316) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4317](#L4317) | } |
| [4318](#L4318) |  |
| [4319](#L4319) | try { |
| [4320](#L4320) |  |
| [4321](#L4321) | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
| [4322](#L4322) |  |
| [4323](#L4323) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4324](#L4324) | $ext = $pInfo ['extension']; |
| [4325](#L4325) | $imagename = uniqid("vid\_").".". $ext; |
| [4326](#L4326) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4327](#L4327) |  |
| [4328](#L4328) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4329](#L4329) | if(!file\_exists($imageUploadTo)){ |
| [4330](#L4330) |  |
| [4331](#L4331) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4332](#L4332) |  |
| [4333](#L4333) | } |
| [4334](#L4334) | } |
| [4335](#L4335) |  |
| [4336](#L4336) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4337](#L4337) | (media\_type,image\_name,title,murl,open\_link\_in, |
| [4338](#L4338) | HdnMediaSelection,createdon) |
| [4339](#L4339) | VALUES ('$media\_type','$imagename','$mtitle','$murl', |
| [4340](#L4340) | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
| [4341](#L4341) |  |
| [4342](#L4342) |  |
| [4343](#L4343) | $wpdb->query ( $query ); |
| [4344](#L4344) |  |
| [4345](#L4345) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4346](#L4346) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4347](#L4347) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New image added successfully.','wp-responsive-photo-gallery'); |
| [4348](#L4348) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4349](#L4349) |  |
| [4350](#L4350) | } |
| [4351](#L4351) | catch ( Exception $e ) { |
| [4352](#L4352) |  |
| [4353](#L4353) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4354](#L4354) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4355](#L4355) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding image','wp-responsive-photo-gallery'); |
| [4356](#L4356) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4357](#L4357) | } |
| [4358](#L4358) |  |
| [4359](#L4359) |  |
| [4360](#L4360) | } |
| [4361](#L4361) |  |
| [4362](#L4362) |  |
| [4363](#L4363) |  |
| [4364](#L4364) | } |
| [4365](#L4365) | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='link'){ |
| [4366](#L4366) |  |
| [4367](#L4367) | $vid = uniqid ( 'vid\_' ); |
| [4368](#L4368) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [4369](#L4369) | $HdnMediaSelection = trim (sanitize\_text\_field( $\_POST ['HdnMediaSelection\_link'] )); |
| [4370](#L4370) | $mtitle = trim (sanitize\_text\_field( $\_POST ['title'] )); |
| [4371](#L4371) | $murl = trim ( esc\_url\_raw($\_POST ['murl'] )); |
| [4372](#L4372) | $mtitle = str\_replace("'","’",$mtitle); |
| [4373](#L4373) | $mtitle = str\_replace('"', '&quot;', $mtitle); |
| [4374](#L4374) | $open\_link\_in=1; |
| [4375](#L4375) |  |
| [4376](#L4376) |  |
| [4377](#L4377) | if (isset ( $\_POST ['open\_title\_link\_in'] )) |
| [4378](#L4378) | $open\_title\_link\_in = 1; |
| [4379](#L4379) | else |
| [4380](#L4380) | $open\_title\_link\_in = 0; |
| [4381](#L4381) |  |
| [4382](#L4382) |  |
| [4383](#L4383) |  |
| [4384](#L4384) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4385](#L4385) | // edit save |
| [4386](#L4386) | if (isset ( $\_POST ['linkid'] )) { |
| [4387](#L4387) |  |
| [4388](#L4388) |  |
| [4389](#L4389) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4390](#L4390) |  |
| [4391](#L4391) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4392](#L4392) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4393](#L4393) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4394](#L4394) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4395](#L4395) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4396](#L4396) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4397](#L4397) | exit; |
| [4398](#L4398) |  |
| [4399](#L4399) | } |
| [4400](#L4400) |  |
| [4401](#L4401) |  |
| [4402](#L4402) | try { |
| [4403](#L4403) |  |
| [4404](#L4404) | $videoidEdit=intval($\_POST ['linkid']); |
| [4405](#L4405) | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
| [4406](#L4406) |  |
| [4407](#L4407) |  |
| [4408](#L4408) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4409](#L4409) | $myrow = $wpdb->get\_row($query); |
| [4410](#L4410) |  |
| [4411](#L4411) |  |
| [4412](#L4412) | if (is\_object($myrow)) { |
| [4413](#L4413) |  |
| [4414](#L4414) | $image\_name = $myrow->image\_name; |
| [4415](#L4415) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4416](#L4416) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4417](#L4417) | $pInfo2 = pathinfo($imagetoDel); |
| [4418](#L4418) | $ext = $pInfo2 ['extension']; |
| [4419](#L4419) | @unlink($imagetoDel); |
| [4420](#L4420) |  |
| [4421](#L4421) | } |
| [4422](#L4422) |  |
| [4423](#L4423) |  |
| [4424](#L4424) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4425](#L4425) | $ext = $pInfo ['extension']; |
| [4426](#L4426) | $imagename = uniqid("vid\_") . ".". $ext; |
| [4427](#L4427) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4428](#L4428) |  |
| [4429](#L4429) |  |
| [4430](#L4430) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4431](#L4431) | if(!file\_exists($imageUploadTo)){ |
| [4432](#L4432) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4433](#L4433) | } |
| [4434](#L4434) |  |
| [4435](#L4435) |  |
| [4436](#L4436) | } |
| [4437](#L4437) |  |
| [4438](#L4438) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4439](#L4439) | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4440](#L4440) | title='$mtitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4441](#L4441) |  |
| [4442](#L4442) | //echo $query;die; |
| [4443](#L4443) | $wpdb->query ( $query ); |
| [4444](#L4444) |  |
| [4445](#L4445) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4446](#L4446) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4447](#L4447) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Link updated successfully.','wp-responsive-photo-gallery'); |
| [4448](#L4448) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4449](#L4449) |  |
| [4450](#L4450) | } |
| [4451](#L4451) | catch ( Exception $e ) { |
| [4452](#L4452) |  |
| [4453](#L4453) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4454](#L4454) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4455](#L4455) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding link','wp-responsive-photo-gallery'); |
| [4456](#L4456) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4457](#L4457) | } |
| [4458](#L4458) |  |
| [4459](#L4459) |  |
| [4460](#L4460) |  |
| [4461](#L4461) |  |
| [4462](#L4462) | } else { |
| [4463](#L4463) |  |
| [4464](#L4464) |  |
| [4465](#L4465) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4466](#L4466) |  |
| [4467](#L4467) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4468](#L4468) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4469](#L4469) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4470](#L4470) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4471](#L4471) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4472](#L4472) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4473](#L4473) | exit; |
| [4474](#L4474) |  |
| [4475](#L4475) | } |
| [4476](#L4476) |  |
| [4477](#L4477) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4478](#L4478) | if (function\_exists ( 'date\_i18n' )) { |
| [4479](#L4479) |  |
| [4480](#L4480) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4481](#L4481) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4482](#L4482) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4483](#L4483) | else |
| [4484](#L4484) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4485](#L4485) | } |
| [4486](#L4486) |  |
| [4487](#L4487) | try { |
| [4488](#L4488) |  |
| [4489](#L4489) | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
| [4490](#L4490) |  |
| [4491](#L4491) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4492](#L4492) | $ext = $pInfo ['extension']; |
| [4493](#L4493) | $imagename = uniqid("vid\_")."." . $ext; |
| [4494](#L4494) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4495](#L4495) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4496](#L4496) | if(!file\_exists($imageUploadTo)){ |
| [4497](#L4497) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4498](#L4498) | } |
| [4499](#L4499) |  |
| [4500](#L4500) | } |
| [4501](#L4501) |  |
| [4502](#L4502) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4503](#L4503) | (media\_type,image\_name,title,murl,open\_link\_in,HdnMediaSelection,createdon) |
| [4504](#L4504) | VALUES ('$media\_type','$imagename','$mtitle','$murl', |
| [4505](#L4505) | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
| [4506](#L4506) |  |
| [4507](#L4507) |  |
| [4508](#L4508) | $wpdb->query ( $query ); |
| [4509](#L4509) |  |
| [4510](#L4510) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4511](#L4511) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4512](#L4512) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New link added successfully.','wp-responsive-photo-gallery'); |
| [4513](#L4513) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4514](#L4514) |  |
| [4515](#L4515) | } |
| [4516](#L4516) | catch ( Exception $e ) { |
| [4517](#L4517) |  |
| [4518](#L4518) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4519](#L4519) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4520](#L4520) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding link','wp-responsive-photo-gallery'); |
| [4521](#L4521) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4522](#L4522) | } |
| [4523](#L4523) |  |
| [4524](#L4524) |  |
| [4525](#L4525) | } |
| [4526](#L4526) |  |
| [4527](#L4527) |  |
| [4528](#L4528) | } |
| [4529](#L4529) |  |
| [4530](#L4530) |  |
| [4531](#L4531) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4532](#L4532) | exit (); |
| [4533](#L4533) |  |
| [4534](#L4534) |  |
| [4535](#L4535) | } else { |
| [4536](#L4536) |  |
| [4537](#L4537) | $uploads = wp\_upload\_dir (); |
| [4538](#L4538) | $baseurl = $uploads ['baseurl']; |
| [4539](#L4539) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [4540](#L4540) | ?> |
| [4541](#L4541) | <div style="float: left; width: 100%;"> |
| [4542](#L4542) |  |
| [4543](#L4543) | <table><tr> |
| [4544](#L4544) | <td> |
| [4545](#L4545) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [4546](#L4546) | <div id="fb-root"></div> |
| [4547](#L4547) | <script>(function(d, s, id) { |
| [4548](#L4548) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [4549](#L4549) | if (d.getElementById(id)) return; |
| [4550](#L4550) | js = d.createElement(s); js.id = id; |
| [4551](#L4551) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [4552](#L4552) | fjs.parentNode.insertBefore(js, fjs); |
| [4553](#L4553) | }(document, 'script', 'facebook-jssdk'));</script> |
| [4554](#L4554) | </td> |
| [4555](#L4555) | <td> |
| [4556](#L4556) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [4557](#L4557) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [4558](#L4558) | </a> |
| [4559](#L4559) | </td> |
| [4560](#L4560) | </tr> |
| [4561](#L4561) | </table> |
| [4562](#L4562) | <div style="clear:both"> |
| [4563](#L4563) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [4564](#L4564) | </div> |
| [4565](#L4565) | <div class="wrap"> |
| [4566](#L4566) | <?php |
| [4567](#L4567) | if (isset ( $\_GET ['id'] ) and intval($\_GET ['id']) > 0) { |
| [4568](#L4568) |  |
| [4569](#L4569) |  |
| [4570](#L4570) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4571](#L4571) |  |
| [4572](#L4572) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4573](#L4573) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4574](#L4574) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4575](#L4575) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4576](#L4576) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4577](#L4577) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4578](#L4578) | exit; |
| [4579](#L4579) |  |
| [4580](#L4580) | } |
| [4581](#L4581) |  |
| [4582](#L4582) | $id = intval($\_GET ['id']); |
| [4583](#L4583) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$id "; |
| [4584](#L4584) |  |
| [4585](#L4585) | $myrow = $wpdb->get\_row ( $query ); |
| [4586](#L4586) |  |
| [4587](#L4587) | if (is\_object ( $myrow )) { |
| [4588](#L4588) |  |
| [4589](#L4589) | $media\_type =  esc\_html($myrow->media\_type ); |
| [4590](#L4590) | $vtype =  esc\_html($myrow->vtype); |
| [4591](#L4591) | $title =  esc\_html($myrow->title) ; |
| [4592](#L4592) | $murl =   esc\_url($myrow->murl); |
| [4593](#L4593) | $image\_name = esc\_html($myrow->image\_name); |
| [4594](#L4594) | $video\_url = esc\_url($myrow->murl); |
| [4595](#L4595) | $HdnMediaSelection = esc\_url($myrow->HdnMediaSelection); |
| [4596](#L4596) | $videotitle = esc\_html($myrow->title); |
| [4597](#L4597) | $videotitleurl=esc\_url($myrow->videourl); |
| [4598](#L4598) | $open\_link\_in = intval($myrow->open\_link\_in); |
| [4599](#L4599) | } |
| [4600](#L4600) | ?> |
| [4601](#L4601) | <h2><?php echo \_\_( 'Update Image','wp-responsive-photo-gallery' );?></h2><?php |
| [4602](#L4602) | } |
| [4603](#L4603) | else { |
| [4604](#L4604) |  |
| [4605](#L4605) | $media\_type =  ""; |
| [4606](#L4606) | $vtype =  ""; |
| [4607](#L4607) | $title =  ""; |
| [4608](#L4608) | $murl =   ""; |
| [4609](#L4609) | $image\_name = ""; |
| [4610](#L4610) | $video\_url = ""; |
| [4611](#L4611) | $HdnMediaSelection = ""; |
| [4612](#L4612) | $videotitle = ""; |
| [4613](#L4613) | $videotitleurl=""; |
| [4614](#L4614) | $open\_link\_in = ""; |
| [4615](#L4615) |  |
| [4616](#L4616) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4617](#L4617) |  |
| [4618](#L4618) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4619](#L4619) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4620](#L4620) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4621](#L4621) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4622](#L4622) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4623](#L4623) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4624](#L4624) | exit; |
| [4625](#L4625) |  |
| [4626](#L4626) | } |
| [4627](#L4627) |  |
| [4628](#L4628) | ?> |
| [4629](#L4629) | <h2><?php echo \_\_( 'Add Media','wp-responsive-photo-gallery' );?></h2> |
| [4630](#L4630) | <?php } ?> |
| [4631](#L4631) | <br /> |
| [4632](#L4632) | <div id="poststuff"> |
| [4633](#L4633) | <div id="post-body" class="metabox-holder columns-2"> |
| [4634](#L4634) | <div id="post-body-content"> |
| [4635](#L4635) |  |
| [4636](#L4636) | <div class="stuffbox" id="mediatype" style="width: 100%"> |
| [4637](#L4637) | <h3> |
| [4638](#L4638) | <label for="link\_name"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?> (<span |
| [4639](#L4639) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Media Type','wp-responsive-photo-gallery');?></span>) |
| [4640](#L4640) | </label> |
| [4641](#L4641) | </h3> |
| [4642](#L4642) | <div class="inside"> |
| [4643](#L4643) | <div> |
| [4644](#L4644) | <input type="radio" value="image" name="media\_type\_p" <?php if($media\_type=='image'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_image" /><?php echo \_\_('Image','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4645](#L4645) | <input type="radio" value="video" name="media\_type\_p" <?php if($media\_type=='video'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_video" /><?php echo \_\_('Video','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4646](#L4646) | <input <?php if($media\_type=='link'): ?> checked='checked' <?php endif;?> type="radio" value="link" name="media\_type\_p" style="width: 15px" id="type\_link" /><?php echo \_\_('Link','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4647](#L4647) |  |
| [4648](#L4648) | </div> |
| [4649](#L4649) | <div style="clear: both"></div> |
| [4650](#L4650) | <div></div> |
| [4651](#L4651) | <div style="clear: both"></div> |
| [4652](#L4652) | <br /> |
| [4653](#L4653) |  |
| [4654](#L4654) | </div> |
| [4655](#L4655) |  |
| [4656](#L4656) | <script> |
| [4657](#L4657) |  |
| [4658](#L4658) |  |
| [4659](#L4659) | jQuery(document).ready(function() { |
| [4660](#L4660) | jQuery("input[name = 'media\_type\_p']").click(function(){ |
| [4661](#L4661) | var radioValue = jQuery("input[name='media\_type\_p']:checked").val(); |
| [4662](#L4662) | if(radioValue=='video'){ |
| [4663](#L4663) |  |
| [4664](#L4664) | jQuery("#addvideo").show(500); |
| [4665](#L4665) | jQuery("#addimage\_").hide(500); |
| [4666](#L4666) | jQuery("#addlink\_").hide(500); |
| [4667](#L4667) |  |
| [4668](#L4668) | } |
| [4669](#L4669) | else if(radioValue=='image'){ |
| [4670](#L4670) |  |
| [4671](#L4671) | jQuery("#addvideo").hide(500); |
| [4672](#L4672) | jQuery("#addimage\_").show(500); |
| [4673](#L4673) | jQuery("#addlink\_").hide(500); |
| [4674](#L4674) | } |
| [4675](#L4675) | else if(radioValue=='link'){ |
| [4676](#L4676) |  |
| [4677](#L4677) | jQuery("#addlink\_").show(500); |
| [4678](#L4678) | jQuery("#addvideo").hide(500); |
| [4679](#L4679) | jQuery("#addimage\_").hide(500); |
| [4680](#L4680) |  |
| [4681](#L4681) | } |
| [4682](#L4682) |  |
| [4683](#L4683) | }); |
| [4684](#L4684) |  |
| [4685](#L4685) | <?php if(isset($\_GET['id']) and (int) $\_GET['id']>0):?> |
| [4686](#L4686) |  |
| [4687](#L4687) | <?php if($media\_type=='video') :?> |
| [4688](#L4688) | jQuery("#type\_video").trigger('click'); |
| [4689](#L4689) | <?php elseif($media\_type=='image'):?> |
| [4690](#L4690) | jQuery("#type\_image").trigger('click'); |
| [4691](#L4691) | <?php elseif($media\_type=='link'):?> |
| [4692](#L4692) | jQuery("#type\_link").trigger('click'); |
| [4693](#L4693) | <?php endif;?> |
| [4694](#L4694) |  |
| [4695](#L4695) | <?php endif;?> |
| [4696](#L4696) |  |
| [4697](#L4697) | }); |
| [4698](#L4698) |  |
| [4699](#L4699) |  |
| [4700](#L4700) | </script> |
| [4701](#L4701) | </div> |
| [4702](#L4702) | <form method="post" action="" id="addvideo" name="addvideo" enctype="multipart/form-data" style="display:none"> |
| [4703](#L4703) |  |
| [4704](#L4704) | <input type="hidden" name="media\_type" id="media\_type" value="video" /> |
| [4705](#L4705) | <div class="stuffbox" id="videoinfo\_div\_1" style="width: 100%;"> |
| [4706](#L4706) | <h3> |
| [4707](#L4707) | <label for="link\_name"><?php echo \_\_('Video Information','wp-responsive-photo-gallery');?> (<span |
| [4708](#L4708) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Video Site','wp-responsive-photo-gallery');?></span>) |
| [4709](#L4709) | </label> |
| [4710](#L4710) | </h3> |
| [4711](#L4711) | <div class="inside"> |
| [4712](#L4712) | <div> |
| [4713](#L4713) | <input type="radio" value="youtube" name="vtype" |
| [4714](#L4714) | <?php if($vtype=='youtube'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_youtube" /><?php echo \_\_('Youtube','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4715](#L4715) |  |
| [4716](#L4716) | <input <?php if($vtype=='dailymotion'): ?> checked='checked' <?php endif;?> type="radio" value="dailymotion" name="vtype" |
| [4717](#L4717) | style="width: 15px" id="type\_DailyMotion" /><?php echo \_\_('DailyMotion','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4718](#L4718) | </div> |
| [4719](#L4719) | <div style="clear: both"></div> |
| [4720](#L4720) | <div></div> |
| [4721](#L4721) | <div style="clear: both"></div> |
| [4722](#L4722) | <br /> |
| [4723](#L4723) | <div id='vurl\_' > |
| [4724](#L4724) | <b ><?php echo \_\_('Video Url','wp-responsive-photo-gallery');?></b> <input style="width:98%" type="text" id="videourl" class="url" tabindex="1"  name="videourl" value="<?php echo $video\_url; ?>"> |
| [4725](#L4725) | </div> |
| [4726](#L4726) |  |
| [4727](#L4727) |  |
| [4728](#L4728) |  |
| [4729](#L4729) | <div style="clear: both"></div> |
| [4730](#L4730) | <div></div> |
| [4731](#L4731) | <div style="clear: both"> |
| [4732](#L4732) | <div id="youtube\_note" style="font-size:12px;display:none"> |
| [4733](#L4733) | <?php echo \_\_('Please do not use youtube.be, instead of use youtube.com','video-grid');?> |
| [4734](#L4734) | </div> |
| [4735](#L4735) | </div> |
| [4736](#L4736) | </div> |
| [4737](#L4737) | </div> |
| [4738](#L4738) | <div class="stuffbox" id="videoinfo\_div\_2" style="width: 100%;"> |
| [4739](#L4739) | <h3> |
| [4740](#L4740) | <label for="link\_name"><?php echo \_\_('Video Thumbnail Information','wp-responsive-photo-gallery');?></label> |
| [4741](#L4741) | </h3> |
| [4742](#L4742) | <div class="inside" id="fileuploaddiv"> |
| [4743](#L4743) | <?php if ($image\_name != "") { ?> |
| [4744](#L4744) | <div> |
| [4745](#L4745) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?>: </b> |
| [4746](#L4746) | <br/> |
| [4747](#L4747) | <img id="img\_disp" name="img\_disp" |
| [4748](#L4748) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [4749](#L4749) | </div> |
| [4750](#L4750) | <?php }else{ ?> |
| [4751](#L4751) | <img |
| [4752](#L4752) | src="<?php echo plugins\_url('/images/no-img.jpeg', \_\_FILE\_\_); ?>" |
| [4753](#L4753) | id="img\_disp" name="img\_disp" /> |
| [4754](#L4754) |  |
| [4755](#L4755) | <?php } ?> |
| [4756](#L4756) | <br /> <a |
| [4757](#L4757) | href="javascript:;" class="niks\_media" |
| [4758](#L4758) | id="videoFromExternalSite"  ><b><?php echo \_\_('Click Here to get video information and thumbnail','wp-responsive-photo-gallery');?><span id='fromval'> From <?php echo $vtype;?></span> |
| [4759](#L4759) | </b></a>&nbsp;<img |
| [4760](#L4760) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [4761](#L4761) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [4762](#L4762) | <div style="clear: both"></div> |
| [4763](#L4763) | <div></div> |
| [4764](#L4764) | <div class="uploader"> |
| [4765](#L4765) | <br /> <b style="margin-left: 50px;" id='or\_\_'>OR</b> |
| [4766](#L4766) | <div style="clear: both; margin-top: 15px;"></div> |
| [4767](#L4767) |  |
| [4768](#L4768) | <a |
| [4769](#L4769) | href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_('Click Here to upload custom video thumbnail','wp-responsive-photo-gallery');?></b></a> |
| [4770](#L4770) |  |
| [4771](#L4771) | <br /> <br /> |
| [4772](#L4772) | <div> |
| [4773](#L4773) | <input id="HdnMediaSelection" name="HdnMediaSelection" |
| [4774](#L4774) | type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [4775](#L4775) | </div> |
| [4776](#L4776) | <div style="clear: both"></div> |
| [4777](#L4777) | <div></div> |
| [4778](#L4778) | <div style="clear: both"></div> |
| [4779](#L4779) |  |
| [4780](#L4780) | <br /> |
| [4781](#L4781) | </div> |
| [4782](#L4782) |  |
| [4783](#L4783) | <script> |
| [4784](#L4784) |  |
| [4785](#L4785) |  |
| [4786](#L4786) | function GetParameterValues(param,str) { |
| [4787](#L4787) | var return\_p=''; |
| [4788](#L4788) | var url = str.slice(str.indexOf('?') + 1).split('&'); |
| [4789](#L4789) | for (var i = 0; i < url.length; i++) { |
| [4790](#L4790) | var urlparam = url[i].split('='); |
| [4791](#L4791) | if (urlparam[0] == param) { |
| [4792](#L4792) | return\_p= urlparam[1]; |
| [4793](#L4793) | } |
| [4794](#L4794) | } |
| [4795](#L4795) | return return\_p; |
| [4796](#L4796) | } |
| [4797](#L4797) |  |
| [4798](#L4798) |  |
| [4799](#L4799) |  |
| [4800](#L4800) | function UrlExists(url, cb){ |
| [4801](#L4801) | jQuery.ajax({ |
| [4802](#L4802) | url:      url, |
| [4803](#L4803) | dataType: 'text', |
| [4804](#L4804) | type:     'GET', |
| [4805](#L4805) | complete:  function(xhr){ |
| [4806](#L4806) | if(typeof cb === 'function') |
| [4807](#L4807) | cb.apply(this, [xhr.status]); |
| [4808](#L4808) | } |
| [4809](#L4809) | }); |
| [4810](#L4810) | } |
| [4811](#L4811) |  |
| [4812](#L4812) | function getDailyMotionId(url) { |
| [4813](#L4813) | if (url.indexOf("?") > 0) { |
| [4814](#L4814) | url = url.substring(0, url.indexOf("?")); |
| [4815](#L4815) | } |
| [4816](#L4816) | var m = url.match(/^.+dailymotion.com\/(video|hub)\/([^\_]+)[^#]\*(#video=([^\_&]+))?/); |
| [4817](#L4817) | if (m !== null) { |
| [4818](#L4818) | if(m[4] !== undefined) { |
| [4819](#L4819) | return m[4]; |
| [4820](#L4820) | } |
| [4821](#L4821) | return m[2]; |
| [4822](#L4822) | } |
| [4823](#L4823) | return null; |
| [4824](#L4824) | } |
| [4825](#L4825) |  |
| [4826](#L4826) |  |
| [4827](#L4827) | jQuery(document).ready(function() { |
| [4828](#L4828) |  |
| [4829](#L4829) |  |
| [4830](#L4830) |  |
| [4831](#L4831) | jQuery("input:radio[name=vtype]").click(function() { |
| [4832](#L4832) |  |
| [4833](#L4833) |  |
| [4834](#L4834) | var value = jQuery(this).val(); |
| [4835](#L4835) | jQuery("#fromval").html(" from " + value); |
| [4836](#L4836) | if(value=="youtube"){ |
| [4837](#L4837) |  |
| [4838](#L4838) | jQuery("#youtube\_note").show(); |
| [4839](#L4839) | } |
| [4840](#L4840) | else{ |
| [4841](#L4841) |  |
| [4842](#L4842) | jQuery("#youtube\_note").hide(); |
| [4843](#L4843) | } |
| [4844](#L4844) | }); |
| [4845](#L4845) | jQuery("#videoFromExternalSite").click(function() { |
| [4846](#L4846) |  |
| [4847](#L4847) |  |
| [4848](#L4848) | var videoService = jQuery('input[name="vtype"]:checked').length; |
| [4849](#L4849) | var videourlVal = jQuery.trim(jQuery("#videourl").val()); |
| [4850](#L4850) | var flag = true; |
| [4851](#L4851) | if (videourlVal == '' && videoService == 0){ |
| [4852](#L4852) |  |
| [4853](#L4853) | alert('Please select video site.\nPlease enter video url.'); |
| [4854](#L4854) | jQuery("input:radio[name=vtype]").focus(); |
| [4855](#L4855) | flag = false; |
| [4856](#L4856) |  |
| [4857](#L4857) | } |
| [4858](#L4858) | else if (videoService == 0){ |
| [4859](#L4859) |  |
| [4860](#L4860) | alert('Please select video site.'); |
| [4861](#L4861) | jQuery("input:radio[name=vtype]").focus(); |
| [4862](#L4862) | flag = false; |
| [4863](#L4863) | } |
| [4864](#L4864) | else if (videourlVal == ''){ |
| [4865](#L4865) |  |
| [4866](#L4866) | alert('Please enter video url.'); |
| [4867](#L4867) | jQuery("#videourl").focus(); |
| [4868](#L4868) | flag = false; |
| [4869](#L4869) | } |
| [4870](#L4870) |  |
| [4871](#L4871) | if (flag){ |
| [4872](#L4872) |  |
| [4873](#L4873) | setTimeout(function() { |
| [4874](#L4874) | jQuery("#loading\_img").show(); |
| [4875](#L4875) | }, 100); |
| [4876](#L4876) |  |
| [4877](#L4877) | var selectedRadio = jQuery('input[name=vtype]'); |
| [4878](#L4878) | var checkedValueRadio = selectedRadio.filter(':checked').val(); |
| [4879](#L4879) | if (checkedValueRadio == 'youtube') { |
| [4880](#L4880) | var vId = GetParameterValues('v', videourlVal); |
| [4881](#L4881) | if(vId!=''){ |
| [4882](#L4882) |  |
| [4883](#L4883) |  |
| [4884](#L4884) | var tumbnailImg='https://img.youtube.com/vi/'+vId+'/maxresdefault.jpg'; |
| [4885](#L4885) |  |
| [4886](#L4886) | var data = { |
| [4887](#L4887) | 'action': 'rjg\_check\_file\_exist\_justified\_gallery', |
| [4888](#L4888) | 'url': tumbnailImg, |
| [4889](#L4889) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4890](#L4890) | }; |
| [4891](#L4891) |  |
| [4892](#L4892) | jQuery.post(ajaxurl, data, function(response) { |
| [4893](#L4893) |  |
| [4894](#L4894) |  |
| [4895](#L4895) |  |
| [4896](#L4896) | var youtubeJsonUri='https://www.youtube.com/oembed?url=https://www.youtube.com/watch%3Fv='+vId+'&format=json'; |
| [4897](#L4897) | var data\_youtube = { |
| [4898](#L4898) | 'action': 'rjg\_get\_youtube\_info\_justified\_gallery', |
| [4899](#L4899) | 'url': youtubeJsonUri, |
| [4900](#L4900) | 'vid':vId, |
| [4901](#L4901) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4902](#L4902) | }; |
| [4903](#L4903) |  |
| [4904](#L4904) | jQuery.post(ajaxurl, data\_youtube, function(data) { |
| [4905](#L4905) |  |
| [4906](#L4906) | data = jQuery.parseJSON(data); |
| [4907](#L4907) |  |
| [4908](#L4908) | if(typeof data =='object'){ |
| [4909](#L4909) | if(typeof data =='object'){ |
| [4910](#L4910) |  |
| [4911](#L4911) | if(data.title!='' && data.title!=''){ |
| [4912](#L4912) | jQuery("#title").val(data.title); |
| [4913](#L4913) | } |
| [4914](#L4914) | jQuery("#murl").val(videourlVal); |
| [4915](#L4915) | if(data.description!='' && data.description!=''){ |
| [4916](#L4916) | jQuery("#mdescription").val(data.description); |
| [4917](#L4917) | } |
| [4918](#L4918) | if(response=='404' && data.thumbnail\_url!=''){ |
| [4919](#L4919) | tumbnailImg=data.thumbnail\_url; |
| [4920](#L4920) | } |
| [4921](#L4921) | else{ |
| [4922](#L4922) | tumbnailImg='https://img.youtube.com/vi/'+vId+'/0.jpg'; |
| [4923](#L4923) | } |
| [4924](#L4924) |  |
| [4925](#L4925) | jQuery("#img\_disp").attr('src', tumbnailImg); |
| [4926](#L4926) | jQuery("#HdnMediaSelection").val(tumbnailImg); |
| [4927](#L4927) | jQuery("#loading\_img").hide(); |
| [4928](#L4928) |  |
| [4929](#L4929) | } |
| [4930](#L4930) |  |
| [4931](#L4931) | } |
| [4932](#L4932) | jQuery("#loading\_img").hide(); |
| [4933](#L4933) | }) |
| [4934](#L4934) |  |
| [4935](#L4935) |  |
| [4936](#L4936) | }); |
| [4937](#L4937) |  |
| [4938](#L4938) | } |
| [4939](#L4939) | else{ |
| [4940](#L4940) | alert('Could not found such video'); |
| [4941](#L4941) | jQuery("#loading\_img").hide(); |
| [4942](#L4942) | } |
| [4943](#L4943) | } |
| [4944](#L4944) | else if (checkedValueRadio == 'vimeo') { |
| [4945](#L4945) |  |
| [4946](#L4946) | var n = videourlVal.lastIndexOf('/'); |
| [4947](#L4947) | var vId = videourlVal.substring(n + 1); |
| [4948](#L4948) |  |
| [4949](#L4949) |  |
| [4950](#L4950) | var VimeoJsonUri='https://vimeo.com/api/v2/video/'+vId+'.json'; |
| [4951](#L4951) | jQuery.getJSON( VimeoJsonUri, function( data ) { |
| [4952](#L4952) |  |
| [4953](#L4953) | if(typeof data =='object'){ |
| [4954](#L4954) | if(typeof data[0] =='object'){ |
| [4955](#L4955) |  |
| [4956](#L4956) | if(data[0].title!='' && data[0].title!=''){ |
| [4957](#L4957) | jQuery("#title").val(data[0].title); |
| [4958](#L4958) | } |
| [4959](#L4959) |  |
| [4960](#L4960) | jQuery("#murl").val(videourlVal); |
| [4961](#L4961) | if(data[0].description!='' && data[0].description!=''){ |
| [4962](#L4962) | jQuery("#mdescription").val(data[0].description); |
| [4963](#L4963) | } |
| [4964](#L4964) | jQuery("#img\_disp").attr('src', data[0].thumbnail\_large); |
| [4965](#L4965) | jQuery("#HdnMediaSelection").val(data[0].thumbnail\_large); |
| [4966](#L4966) | jQuery("#loading\_img").hide(); |
| [4967](#L4967) |  |
| [4968](#L4968) | } |
| [4969](#L4969) |  |
| [4970](#L4970) | } |
| [4971](#L4971) |  |
| [4972](#L4972) | jQuery("#loading\_img").hide(); |
| [4973](#L4973) | }) |
| [4974](#L4974) |  |
| [4975](#L4975) |  |
| [4976](#L4976) |  |
| [4977](#L4977) | } |
| [4978](#L4978) | else if(checkedValueRadio == 'metacafe'){ |
| [4979](#L4979) |  |
| [4980](#L4980) | jQuery("#loading\_img").show(); |
| [4981](#L4981) | var data = { |
| [4982](#L4982) | 'action': 'rjg\_get\_metacafe\_info\_justified\_gallery', |
| [4983](#L4983) | 'url': videourlVal, |
| [4984](#L4984) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4985](#L4985) | }; |
| [4986](#L4986) |  |
| [4987](#L4987) | jQuery.post(ajaxurl, data,function(response) { |
| [4988](#L4988) |  |
| [4989](#L4989) | obj = jQuery.parseJSON(response); |
| [4990](#L4990) | jQuery("#HdnMediaSelection").val(obj.HdnMediaSelection); |
| [4991](#L4991) | jQuery("#title").val(jQuery.trim(obj.videotitle)); |
| [4992](#L4992) | jQuery("#murl").val(obj.videotitleurl); |
| [4993](#L4993) | jQuery("#mdescription").val(jQuery.trim(obj.video\_description)); |
| [4994](#L4994) | jQuery("#img\_disp").attr('src', obj.HdnMediaSelection); |
| [4995](#L4995) | jQuery("#loading\_img").hide(); |
| [4996](#L4996) | }); |
| [4997](#L4997) |  |
| [4998](#L4998) |  |
| [4999](#L4999) | } |
| [5000](#L5000) | else if(checkedValueRadio == 'dailymotion'){ |
| [5001](#L5001) |  |
| [5002](#L5002) | var vid=getDailyMotionId(videourlVal); |
| [5003](#L5003) | var apiUrl='https://api.dailymotion.com/video/'+vid+'?fields=description,id,thumbnail\_720\_url,title'; |
| [5004](#L5004) | jQuery.getJSON( apiUrl, function( data ) { |
| [5005](#L5005) | if(typeof data =='object'){ |
| [5006](#L5006) |  |
| [5007](#L5007) |  |
| [5008](#L5008) | jQuery("#HdnMediaSelection").val(data.thumbnail\_720\_url); |
| [5009](#L5009) | jQuery("#title").val(jQuery.trim(data.title)); |
| [5010](#L5010) | jQuery("#murl").val(videourlVal); |
| [5011](#L5011) | jQuery("#mdescription").val(data.description); |
| [5012](#L5012) | jQuery("#img\_disp").attr('src', data.thumbnail\_720\_url); |
| [5013](#L5013) | jQuery("#loading\_img").hide(); |
| [5014](#L5014) | } |
| [5015](#L5015) | jQuery("#loading\_img").hide(); |
| [5016](#L5016) | }) |
| [5017](#L5017) |  |
| [5018](#L5018) |  |
| [5019](#L5019) | jQuery("#loading\_img").hide(); |
| [5020](#L5020) | } |
| [5021](#L5021) |  |
| [5022](#L5022) | jQuery("#loading\_img").hide(); |
| [5023](#L5023) | } |
| [5024](#L5024) |  |
| [5025](#L5025) | setTimeout(function() { |
| [5026](#L5026) | jQuery("#loading\_img").hide(); |
| [5027](#L5027) | }, 2000); |
| [5028](#L5028) |  |
| [5029](#L5029) | }); |
| [5030](#L5030) | //uploading files variable |
| [5031](#L5031) | var custom\_file\_frame; |
| [5032](#L5032) | jQuery("#myMediaUploader").click(function(event) { |
| [5033](#L5033) | event.preventDefault(); |
| [5034](#L5034) | //If the frame already exists, reopen it |
| [5035](#L5035) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5036](#L5036) | custom\_file\_frame.close(); |
| [5037](#L5037) | } |
| [5038](#L5038) |  |
| [5039](#L5039) | //Create WP media frame. |
| [5040](#L5040) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5041](#L5041) | //Title of media manager frame |
| [5042](#L5042) | title: "WP Media Uploader", |
| [5043](#L5043) | library: { |
| [5044](#L5044) | type: 'image' |
| [5045](#L5045) | }, |
| [5046](#L5046) | button: { |
| [5047](#L5047) | //Button text |
| [5048](#L5048) | text: "Set Image" |
| [5049](#L5049) | }, |
| [5050](#L5050) | //Do not allow multiple files, if you want multiple, set true |
| [5051](#L5051) | multiple: false |
| [5052](#L5052) | }); |
| [5053](#L5053) | //callback for selected image |
| [5054](#L5054) | custom\_file\_frame.on('select', function() { |
| [5055](#L5055) |  |
| [5056](#L5056) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5057](#L5057) | var validExtensions = new Array(); |
| [5058](#L5058) | validExtensions[0] = 'jpg'; |
| [5059](#L5059) | validExtensions[1] = 'jpeg'; |
| [5060](#L5060) | validExtensions[2] = 'png'; |
| [5061](#L5061) | validExtensions[3] = 'gif'; |
| [5062](#L5062) |  |
| [5063](#L5063) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5064](#L5064) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5065](#L5065) |  |
| [5066](#L5066) | var titleTouse = ""; |
| [5067](#L5067) | var imageDescriptionTouse = ""; |
| [5068](#L5068) | if (jQuery.trim(attachment.title) != ''){ |
| [5069](#L5069) |  |
| [5070](#L5070) | titleTouse = jQuery.trim(attachment.title); |
| [5071](#L5071) | } |
| [5072](#L5072) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5073](#L5073) |  |
| [5074](#L5074) | titleTouse = jQuery.trim(attachment.caption); |
| [5075](#L5075) | } |
| [5076](#L5076) |  |
| [5077](#L5077) | if (jQuery.trim(attachment.description) != ''){ |
| [5078](#L5078) |  |
| [5079](#L5079) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5080](#L5080) | } |
| [5081](#L5081) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5082](#L5082) |  |
| [5083](#L5083) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5084](#L5084) | } |
| [5085](#L5085) |  |
| [5086](#L5086) | // jQuery("#videotitle").val(titleTouse); |
| [5087](#L5087) | //  jQuery("#video\_description").val(imageDescriptionTouse); |
| [5088](#L5088) |  |
| [5089](#L5089) | if (attachment.id != ''){ |
| [5090](#L5090) |  |
| [5091](#L5091) | jQuery("#HdnMediaSelection").val(attachment.url); |
| [5092](#L5092) | jQuery("#img\_disp").attr('src', attachment.url); |
| [5093](#L5093) |  |
| [5094](#L5094) | } |
| [5095](#L5095) |  |
| [5096](#L5096) | } |
| [5097](#L5097) | else{ |
| [5098](#L5098) |  |
| [5099](#L5099) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5100](#L5100) | } |
| [5101](#L5101) | //do something with attachment variable, for example attachment.filename |
| [5102](#L5102) | //Object: |
| [5103](#L5103) | //attachment.alt - image alt |
| [5104](#L5104) | //attachment.author - author id |
| [5105](#L5105) | //attachment.caption |
| [5106](#L5106) | //attachment.dateFormatted - date of image uploaded |
| [5107](#L5107) | //attachment.description |
| [5108](#L5108) | //attachment.editLink - edit link of media |
| [5109](#L5109) | //attachment.filename |
| [5110](#L5110) | //attachment.height |
| [5111](#L5111) | //attachment.icon - don't know WTF?)) |
| [5112](#L5112) | //attachment.id - id of attachment |
| [5113](#L5113) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5114](#L5114) | //attachment.menuOrder |
| [5115](#L5115) | //attachment.mime - mime type, for example image/jpeg" |
| [5116](#L5116) | //attachment.name - name of attachment file, for example "my-image" |
| [5117](#L5117) | //attachment.status - usual is "inherit" |
| [5118](#L5118) | //attachment.subtype - "jpeg" if is "jpg" |
| [5119](#L5119) | //attachment.title |
| [5120](#L5120) | //attachment.type - "image" |
| [5121](#L5121) | //attachment.uploadedTo |
| [5122](#L5122) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5123](#L5123) | //attachment.width |
| [5124](#L5124) | }); |
| [5125](#L5125) | //Open modal |
| [5126](#L5126) | custom\_file\_frame.open(); |
| [5127](#L5127) | }); |
| [5128](#L5128) | }) |
| [5129](#L5129) | </script> |
| [5130](#L5130) | </div> |
| [5131](#L5131) | </div> |
| [5132](#L5132) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5133](#L5133) | <h3> |
| [5134](#L5134) | <label for="link\_name"><?php echo \_\_('Video Title','wp-responsive-photo-gallery');?> (<span |
| [5135](#L5135) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','wp-responsive-photo-gallery');?></span>) |
| [5136](#L5136) | </label> |
| [5137](#L5137) | </h3> |
| [5138](#L5138) | <div class="inside"> |
| [5139](#L5139) | <div> |
| [5140](#L5140) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5141](#L5141) | </div> |
| [5142](#L5142) | <div style="clear: both"></div> |
| [5143](#L5143) | <div></div> |
| [5144](#L5144) | <div style="clear: both"></div> |
| [5145](#L5145) | </div> |
| [5146](#L5146) | </div> |
| [5147](#L5147) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5148](#L5148) | <h3> |
| [5149](#L5149) | <label for="link\_name"><?php echo \_\_('Video Title Url','wp-responsive-photo-gallery');?> (<span |
| [5150](#L5150) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for video title','wp-responsive-photo-gallery');?></span>) |
| [5151](#L5151) | </label> |
| [5152](#L5152) | </h3> |
| [5153](#L5153) | <div class="inside"> |
| [5154](#L5154) | <div> |
| [5155](#L5155) | <input type="text" id="murl" |
| [5156](#L5156) | tabindex="1" size="30" name="murl" |
| [5157](#L5157) | value="<?php echo $videotitleurl; ?>"> |
| [5158](#L5158) | </div> |
| [5159](#L5159) | <div style="clear: both"></div> |
| [5160](#L5160) | <div></div> |
| [5161](#L5161) | <div style="clear: both"></div> |
| [5162](#L5162) |  |
| [5163](#L5163) | </div> |
| [5164](#L5164) | </div> |
| [5165](#L5165) |  |
| [5166](#L5166) | <div class="stuffbox playvideoinlightbox" id="namediv" style="width: 100%"> |
| [5167](#L5167) | <h3> |
| [5168](#L5168) | <label><?php echo \_\_('Play Video In Lightbox?','wp-responsive-photo-gallery');?> (<span |
| [5169](#L5169) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show video in lightbox or redirect?','wp-responsive-photo-gallery');?></span>) |
| [5170](#L5170) | </label> |
| [5171](#L5171) | </h3> |
| [5172](#L5172) | <div class="inside"> |
| [5173](#L5173) | <table> |
| [5174](#L5174) | <tr> |
| [5175](#L5175) | <td> |
| [5176](#L5176) | <div> |
| [5177](#L5177) | <input type="checkbox" id="open\_link\_in" size="30" |
| [5178](#L5178) | name="open\_link\_in" value="" |
| [5179](#L5179) | <?php |
| [5180](#L5180) | if ($open\_link\_in == true) { |
| [5181](#L5181) | echo "checked='checked'"; |
| [5182](#L5182) | } |
| [5183](#L5183) | ?> |
| [5184](#L5184) | style="width: 20px;">&nbsp;<?php echo \_\_('Show Video In Lightbox?','wp-responsive-photo-gallery');?> |
| [5185](#L5185) | </div> |
| [5186](#L5186) | <div style="clear: both"></div> |
| [5187](#L5187) | <div></div> |
| [5188](#L5188) | </td> |
| [5189](#L5189) | </tr> |
| [5190](#L5190) | </table> |
| [5191](#L5191) | <div style="clear: both"></div> |
| [5192](#L5192) | </div> |
| [5193](#L5193) | </div> |
| [5194](#L5194) |  |
| [5195](#L5195) |  |
| [5196](#L5196) |  |
| [5197](#L5197) | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
| [5198](#L5198) | <input type="hidden" name="videoid" id="videoid" value="<?php echo (int) $\_GET['id']; ?>"> |
| [5199](#L5199) | <?php |
| [5200](#L5200) | } |
| [5201](#L5201) | ?> |
| [5202](#L5202) |  |
| [5203](#L5203) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5204](#L5204) | <input type="submit" |
| [5205](#L5205) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5206](#L5206) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5207](#L5207) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5208](#L5208) | class="button-primary" |
| [5209](#L5209) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5210](#L5210) |  |
| [5211](#L5211) | </form> |
| [5212](#L5212) | <form method="post" action="" id="addimage\_" name="addimage\_" enctype="multipart/form-data" style="display:none"> |
| [5213](#L5213) |  |
| [5214](#L5214) | <input type="hidden" name="media\_type" id="media\_type" value="image" /> |
| [5215](#L5215) | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
| [5216](#L5216) | <h3> |
| [5217](#L5217) | <label for="link\_name"><?php echo \_\_('Image Information','wp-responsive-photo-gallery');?></label> |
| [5218](#L5218) | </h3> |
| [5219](#L5219) | <div class="inside" id="fileuploaddiv"> |
| [5220](#L5220) | <?php if ($image\_name != "") { ?> |
| [5221](#L5221) | <div> |
| [5222](#L5222) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?> : </b> |
| [5223](#L5223) | <br/> |
| [5224](#L5224) | <img id="img\_disp\_img" name="img\_disp\_img" |
| [5225](#L5225) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [5226](#L5226) | </div> |
| [5227](#L5227) | <?php }else{ ?> |
| [5228](#L5228) | <img |
| [5229](#L5229) | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
| [5230](#L5230) | id="img\_disp\_img" name="img\_disp\_img" /> |
| [5231](#L5231) |  |
| [5232](#L5232) | <?php } ?> |
| [5233](#L5233) | <img |
| [5234](#L5234) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [5235](#L5235) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [5236](#L5236) | <div style="clear: both"></div> |
| [5237](#L5237) | <div></div> |
| [5238](#L5238) | <div class="uploader"> |
| [5239](#L5239) |  |
| [5240](#L5240) | <div style="clear: both; margin-top: 15px;"></div> |
| [5241](#L5241) | <a |
| [5242](#L5242) | href="javascript:;" class="niks\_media" id="myMediaUploader\_image"><b><?php echo \_\_('Click Here to upload Image','wp-responsive-photo-gallery');?></b></a> |
| [5243](#L5243) | <br /> <br /> |
| [5244](#L5244) | <div> |
| [5245](#L5245) | <input id="HdnMediaSelection\_image" name="HdnMediaSelection\_image" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [5246](#L5246) | </div> |
| [5247](#L5247) | <div style="clear: both"></div> |
| [5248](#L5248) | <div></div> |
| [5249](#L5249) | <div style="clear: both"></div> |
| [5250](#L5250) |  |
| [5251](#L5251) | <br /> |
| [5252](#L5252) | </div> |
| [5253](#L5253) | </div> |
| [5254](#L5254) |  |
| [5255](#L5255) | <script> |
| [5256](#L5256) | //uploading files variable |
| [5257](#L5257) | var custom\_file\_frame; |
| [5258](#L5258) | jQuery("#myMediaUploader\_image").click(function(event) { |
| [5259](#L5259) | event.preventDefault(); |
| [5260](#L5260) | //If the frame already exists, reopen it |
| [5261](#L5261) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5262](#L5262) | custom\_file\_frame.close(); |
| [5263](#L5263) | } |
| [5264](#L5264) |  |
| [5265](#L5265) | //Create WP media frame. |
| [5266](#L5266) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5267](#L5267) | //Title of media manager frame |
| [5268](#L5268) | title: "WP Media Uploader", |
| [5269](#L5269) | library: { |
| [5270](#L5270) | type: 'image' |
| [5271](#L5271) | }, |
| [5272](#L5272) | button: { |
| [5273](#L5273) | //Button text |
| [5274](#L5274) | text: "Set Image" |
| [5275](#L5275) | }, |
| [5276](#L5276) | //Do not allow multiple files, if you want multiple, set true |
| [5277](#L5277) | multiple: false |
| [5278](#L5278) | }); |
| [5279](#L5279) | //callback for selected image |
| [5280](#L5280) | custom\_file\_frame.on('select', function() { |
| [5281](#L5281) |  |
| [5282](#L5282) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5283](#L5283) | var validExtensions = new Array(); |
| [5284](#L5284) | validExtensions[0] = 'jpg'; |
| [5285](#L5285) | validExtensions[1] = 'jpeg'; |
| [5286](#L5286) | validExtensions[2] = 'png'; |
| [5287](#L5287) | validExtensions[3] = 'gif'; |
| [5288](#L5288) |  |
| [5289](#L5289) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5290](#L5290) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5291](#L5291) |  |
| [5292](#L5292) | var titleTouse = ""; |
| [5293](#L5293) | var imageDescriptionTouse = ""; |
| [5294](#L5294) | if (jQuery.trim(attachment.title) != ''){ |
| [5295](#L5295) |  |
| [5296](#L5296) | titleTouse = jQuery.trim(attachment.title); |
| [5297](#L5297) | } |
| [5298](#L5298) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5299](#L5299) |  |
| [5300](#L5300) | titleTouse = jQuery.trim(attachment.caption); |
| [5301](#L5301) | } |
| [5302](#L5302) |  |
| [5303](#L5303) | if (jQuery.trim(attachment.description) != ''){ |
| [5304](#L5304) |  |
| [5305](#L5305) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5306](#L5306) | } |
| [5307](#L5307) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5308](#L5308) |  |
| [5309](#L5309) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5310](#L5310) | } |
| [5311](#L5311) |  |
| [5312](#L5312) | jQuery("#addimage\_ #title").val(titleTouse); |
| [5313](#L5313) | jQuery("#addimage\_ #mdescription").val(imageDescriptionTouse); |
| [5314](#L5314) |  |
| [5315](#L5315) | if (attachment.id != ''){ |
| [5316](#L5316) |  |
| [5317](#L5317) | jQuery("#HdnMediaSelection\_image").val(attachment.url); |
| [5318](#L5318) | jQuery("#img\_disp\_img").attr('src', attachment.url); |
| [5319](#L5319) |  |
| [5320](#L5320) | } |
| [5321](#L5321) |  |
| [5322](#L5322) | } |
| [5323](#L5323) | else{ |
| [5324](#L5324) |  |
| [5325](#L5325) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5326](#L5326) | } |
| [5327](#L5327) | //do something with attachment variable, for example attachment.filename |
| [5328](#L5328) | //Object: |
| [5329](#L5329) | //attachment.alt - image alt |
| [5330](#L5330) | //attachment.author - author id |
| [5331](#L5331) | //attachment.caption |
| [5332](#L5332) | //attachment.dateFormatted - date of image uploaded |
| [5333](#L5333) | //attachment.description |
| [5334](#L5334) | //attachment.editLink - edit link of media |
| [5335](#L5335) | //attachment.filename |
| [5336](#L5336) | //attachment.height |
| [5337](#L5337) | //attachment.icon - don't know WTF?)) |
| [5338](#L5338) | //attachment.id - id of attachment |
| [5339](#L5339) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5340](#L5340) | //attachment.menuOrder |
| [5341](#L5341) | //attachment.mime - mime type, for example image/jpeg" |
| [5342](#L5342) | //attachment.name - name of attachment file, for example "my-image" |
| [5343](#L5343) | //attachment.status - usual is "inherit" |
| [5344](#L5344) | //attachment.subtype - "jpeg" if is "jpg" |
| [5345](#L5345) | //attachment.title |
| [5346](#L5346) | //attachment.type - "image" |
| [5347](#L5347) | //attachment.uploadedTo |
| [5348](#L5348) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5349](#L5349) | //attachment.width |
| [5350](#L5350) | }); |
| [5351](#L5351) | //Open modal |
| [5352](#L5352) | custom\_file\_frame.open(); |
| [5353](#L5353) | }); |
| [5354](#L5354) |  |
| [5355](#L5355) | </script> |
| [5356](#L5356) | </div> |
| [5357](#L5357) |  |
| [5358](#L5358) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5359](#L5359) | <h3> |
| [5360](#L5360) | <label for="link\_name"><?php echo \_\_('Image Title','wp-responsive-photo-gallery');?> (<span |
| [5361](#L5361) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','wp-responsive-photo-gallery');?></span>) |
| [5362](#L5362) | </label> |
| [5363](#L5363) | </h3> |
| [5364](#L5364) | <div class="inside"> |
| [5365](#L5365) | <div> |
| [5366](#L5366) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5367](#L5367) | </div> |
| [5368](#L5368) | <div style="clear: both"></div> |
| [5369](#L5369) | <div></div> |
| [5370](#L5370) | <div style="clear: both"></div> |
| [5371](#L5371) | </div> |
| [5372](#L5372) | </div> |
| [5373](#L5373) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5374](#L5374) | <h3> |
| [5375](#L5375) | <label for="link\_name"><?php echo \_\_('Image Title Url','wp-responsive-photo-gallery');?> (<span |
| [5376](#L5376) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for video title','wp-responsive-photo-gallery');?></span>) |
| [5377](#L5377) | </label> |
| [5378](#L5378) | </h3> |
| [5379](#L5379) | <div class="inside"> |
| [5380](#L5380) | <div> |
| [5381](#L5381) | <input type="text" id="murl" |
| [5382](#L5382) | tabindex="1" size="30" name="murl" |
| [5383](#L5383) | value="<?php echo $murl; ?>"> |
| [5384](#L5384) | </div> |
| [5385](#L5385) | <div style="clear: both"></div> |
| [5386](#L5386) | <div></div> |
| [5387](#L5387) | <div style="clear: both"></div> |
| [5388](#L5388) |  |
| [5389](#L5389) | </div> |
| [5390](#L5390) | </div> |
| [5391](#L5391) |  |
| [5392](#L5392) |  |
| [5393](#L5393) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5394](#L5394) | <h3> |
| [5395](#L5395) | <label><?php echo \_\_('Show Image In Lightbox?','wp-responsive-photo-gallery');?> (<span |
| [5396](#L5396) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show image in lightbox or redirect ?','wp-responsive-photo-gallery');?></span>) |
| [5397](#L5397) | </label> |
| [5398](#L5398) | </h3> |
| [5399](#L5399) | <div class="inside"> |
| [5400](#L5400) | <table> |
| [5401](#L5401) | <tr> |
| [5402](#L5402) | <td> |
| [5403](#L5403) | <div> |
| [5404](#L5404) | <input type="checkbox" id="open\_link\_in" size="30" |
| [5405](#L5405) | name="open\_link\_in" value="" |
| [5406](#L5406) | <?php |
| [5407](#L5407) | if ($open\_link\_in == true) { |
| [5408](#L5408) | echo "checked='checked'"; |
| [5409](#L5409) | } |
| [5410](#L5410) | ?> |
| [5411](#L5411) | style="width: 20px;">&nbsp;Show image In Lightbox? |
| [5412](#L5412) | </div> |
| [5413](#L5413) | <div style="clear: both"></div> |
| [5414](#L5414) | <div></div> |
| [5415](#L5415) | </td> |
| [5416](#L5416) | </tr> |
| [5417](#L5417) | </table> |
| [5418](#L5418) | <div style="clear: both"></div> |
| [5419](#L5419) | </div> |
| [5420](#L5420) | </div> |
| [5421](#L5421) | <?php if (isset($\_GET['id']) and intval($\_GET['id']) > 0) { ?> |
| [5422](#L5422) | <input type="hidden" name="imageid" id="imageid" value="<?php echo intval($\_GET['id']); ?>"> |
| [5423](#L5423) | <?php |
| [5424](#L5424) | } |
| [5425](#L5425) | ?> |
| [5426](#L5426) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5427](#L5427) | <input type="submit" |
| [5428](#L5428) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5429](#L5429) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5430](#L5430) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5431](#L5431) | class="button-primary" |
| [5432](#L5432) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5433](#L5433) |  |
| [5434](#L5434) | </form> |
| [5435](#L5435) | <form method="post" action="" id="addlink\_" name="addlink\_" enctype="multipart/form-data" style="display:none"> |
| [5436](#L5436) |  |
| [5437](#L5437) | <input type="hidden" name="media\_type" id="media\_type" value="link" /> |
| [5438](#L5438) | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
| [5439](#L5439) | <h3> |
| [5440](#L5440) | <label for="link\_name"><?php echo \_\_('Image Information','wp-responsive-photo-gallery');?></label> |
| [5441](#L5441) | </h3> |
| [5442](#L5442) | <div class="inside" id="fileuploaddiv"> |
| [5443](#L5443) | <?php if ($image\_name != "") { ?> |
| [5444](#L5444) | <div> |
| [5445](#L5445) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?>: </b> |
| [5446](#L5446) | <br/> |
| [5447](#L5447) | <img id="img\_disp\_link" name="img\_disp\_link" |
| [5448](#L5448) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [5449](#L5449) | </div> |
| [5450](#L5450) | <?php }else{ ?> |
| [5451](#L5451) | <img |
| [5452](#L5452) | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
| [5453](#L5453) | id="img\_disp\_link" name="img\_disp\_link" /> |
| [5454](#L5454) |  |
| [5455](#L5455) | <?php } ?> |
| [5456](#L5456) | <img |
| [5457](#L5457) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [5458](#L5458) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [5459](#L5459) | <div style="clear: both"></div> |
| [5460](#L5460) | <div></div> |
| [5461](#L5461) | <div class="uploader"> |
| [5462](#L5462) |  |
| [5463](#L5463) | <div style="clear: both; margin-top: 15px;"></div> |
| [5464](#L5464) | <a href="javascript:;" class="niks\_media" id="myMediaUploader\_link"><b><?php echo \_\_('Click Here to upload Image','wp-responsive-photo-gallery');?></b></a> |
| [5465](#L5465) | <br /> <br /> |
| [5466](#L5466) | <div> |
| [5467](#L5467) | <input id="HdnMediaSelection\_link" name="HdnMediaSelection\_link" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [5468](#L5468) | </div> |
| [5469](#L5469) | <div style="clear: both"></div> |
| [5470](#L5470) | <div></div> |
| [5471](#L5471) | <div style="clear: both"></div> |
| [5472](#L5472) |  |
| [5473](#L5473) | <br /> |
| [5474](#L5474) | </div> |
| [5475](#L5475) | </div> |
| [5476](#L5476) |  |
| [5477](#L5477) | <script> |
| [5478](#L5478) | //uploading files variable |
| [5479](#L5479) | var custom\_file\_frame; |
| [5480](#L5480) | jQuery("#myMediaUploader\_link").click(function(event) { |
| [5481](#L5481) | event.preventDefault(); |
| [5482](#L5482) | //If the frame already exists, reopen it |
| [5483](#L5483) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5484](#L5484) | custom\_file\_frame.close(); |
| [5485](#L5485) | } |
| [5486](#L5486) |  |
| [5487](#L5487) | //Create WP media frame. |
| [5488](#L5488) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5489](#L5489) | //Title of media manager frame |
| [5490](#L5490) | title: "WP Media Uploader", |
| [5491](#L5491) | library: { |
| [5492](#L5492) | type: 'image' |
| [5493](#L5493) | }, |
| [5494](#L5494) | button: { |
| [5495](#L5495) | //Button text |
| [5496](#L5496) | text: "Set Image" |
| [5497](#L5497) | }, |
| [5498](#L5498) | //Do not allow multiple files, if you want multiple, set true |
| [5499](#L5499) | multiple: false |
| [5500](#L5500) | }); |
| [5501](#L5501) | //callback for selected image |
| [5502](#L5502) | custom\_file\_frame.on('select', function() { |
| [5503](#L5503) |  |
| [5504](#L5504) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5505](#L5505) | var validExtensions = new Array(); |
| [5506](#L5506) | validExtensions[0] = 'jpg'; |
| [5507](#L5507) | validExtensions[1] = 'jpeg'; |
| [5508](#L5508) | validExtensions[2] = 'png'; |
| [5509](#L5509) | validExtensions[3] = 'gif'; |
| [5510](#L5510) |  |
| [5511](#L5511) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5512](#L5512) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5513](#L5513) |  |
| [5514](#L5514) | var titleTouse = ""; |
| [5515](#L5515) | var imageDescriptionTouse = ""; |
| [5516](#L5516) | if (jQuery.trim(attachment.title) != ''){ |
| [5517](#L5517) |  |
| [5518](#L5518) | titleTouse = jQuery.trim(attachment.title); |
| [5519](#L5519) | } |
| [5520](#L5520) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5521](#L5521) |  |
| [5522](#L5522) | titleTouse = jQuery.trim(attachment.caption); |
| [5523](#L5523) | } |
| [5524](#L5524) |  |
| [5525](#L5525) | if (jQuery.trim(attachment.description) != ''){ |
| [5526](#L5526) |  |
| [5527](#L5527) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5528](#L5528) | } |
| [5529](#L5529) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5530](#L5530) |  |
| [5531](#L5531) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5532](#L5532) | } |
| [5533](#L5533) |  |
| [5534](#L5534) | jQuery("#addlink\_ #title").val(titleTouse); |
| [5535](#L5535) |  |
| [5536](#L5536) | if (attachment.id != ''){ |
| [5537](#L5537) |  |
| [5538](#L5538) | jQuery("#HdnMediaSelection\_link").val(attachment.url); |
| [5539](#L5539) | jQuery("#img\_disp\_link").attr('src', attachment.url); |
| [5540](#L5540) |  |
| [5541](#L5541) | } |
| [5542](#L5542) |  |
| [5543](#L5543) | } |
| [5544](#L5544) | else{ |
| [5545](#L5545) |  |
| [5546](#L5546) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5547](#L5547) | } |
| [5548](#L5548) | //do something with attachment variable, for example attachment.filename |
| [5549](#L5549) | //Object: |
| [5550](#L5550) | //attachment.alt - image alt |
| [5551](#L5551) | //attachment.author - author id |
| [5552](#L5552) | //attachment.caption |
| [5553](#L5553) | //attachment.dateFormatted - date of image uploaded |
| [5554](#L5554) | //attachment.description |
| [5555](#L5555) | //attachment.editLink - edit link of media |
| [5556](#L5556) | //attachment.filename |
| [5557](#L5557) | //attachment.height |
| [5558](#L5558) | //attachment.icon - don't know WTF?)) |
| [5559](#L5559) | //attachment.id - id of attachment |
| [5560](#L5560) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5561](#L5561) | //attachment.menuOrder |
| [5562](#L5562) | //attachment.mime - mime type, for example image/jpeg" |
| [5563](#L5563) | //attachment.name - name of attachment file, for example "my-image" |
| [5564](#L5564) | //attachment.status - usual is "inherit" |
| [5565](#L5565) | //attachment.subtype - "jpeg" if is "jpg" |
| [5566](#L5566) | //attachment.title |
| [5567](#L5567) | //attachment.type - "image" |
| [5568](#L5568) | //attachment.uploadedTo |
| [5569](#L5569) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5570](#L5570) | //attachment.width |
| [5571](#L5571) | }); |
| [5572](#L5572) | //Open modal |
| [5573](#L5573) | custom\_file\_frame.open(); |
| [5574](#L5574) | }); |
| [5575](#L5575) |  |
| [5576](#L5576) | </script> |
| [5577](#L5577) | </div> |
| [5578](#L5578) |  |
| [5579](#L5579) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5580](#L5580) | <h3> |
| [5581](#L5581) | <label for="link\_name"><?php echo \_\_('Link Title','wp-responsive-photo-gallery');?> (<span style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into Caption','wp-responsive-photo-gallery');?></span>) |
| [5582](#L5582) | </label> |
| [5583](#L5583) | </h3> |
| [5584](#L5584) | <div class="inside"> |
| [5585](#L5585) | <div> |
| [5586](#L5586) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5587](#L5587) | </div> |
| [5588](#L5588) | <div style="clear: both"></div> |
| [5589](#L5589) | <div></div> |
| [5590](#L5590) | <div style="clear: both"></div> |
| [5591](#L5591) | </div> |
| [5592](#L5592) | </div> |
| [5593](#L5593) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5594](#L5594) | <h3> |
| [5595](#L5595) | <label for="link\_name"><?php echo \_\_('Link Url','wp-responsive-photo-gallery');?> (<span |
| [5596](#L5596) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on image will redirect to this url.','wp-responsive-photo-gallery');?></span>) |
| [5597](#L5597) | </label> |
| [5598](#L5598) | </h3> |
| [5599](#L5599) | <div class="inside"> |
| [5600](#L5600) | <div> |
| [5601](#L5601) | <input type="text" id="murl" |
| [5602](#L5602) | tabindex="1" size="30" name="murl" |
| [5603](#L5603) | value="<?php echo $murl; ?>"> |
| [5604](#L5604) | </div> |
| [5605](#L5605) | <div style="clear: both"></div> |
| [5606](#L5606) | <div></div> |
| [5607](#L5607) | <div style="clear: both"></div> |
| [5608](#L5608) |  |
| [5609](#L5609) | </div> |
| [5610](#L5610) | </div> |
| [5611](#L5611) |  |
| [5612](#L5612) | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
| [5613](#L5613) | <input type="hidden" name="linkid" id="linkid" value="<?php echo (int) $\_GET['id']; ?>"> |
| [5614](#L5614) | <?php |
| [5615](#L5615) | } |
| [5616](#L5616) | ?> |
| [5617](#L5617) |  |
| [5618](#L5618) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5619](#L5619) | <input type="submit" |
| [5620](#L5620) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5621](#L5621) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5622](#L5622) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5623](#L5623) | class="button-primary" |
| [5624](#L5624) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5625](#L5625) |  |
| [5626](#L5626) | </form> |
| [5627](#L5627) | <script type="text/javascript"> |
| [5628](#L5628) |  |
| [5629](#L5629) |  |
| [5630](#L5630) | jQuery(document).ready(function() { |
| [5631](#L5631) |  |
| [5632](#L5632) | jQuery.validator.setDefaults({ |
| [5633](#L5633) | ignore: [], |
| [5634](#L5634) | // any other default options and/or rules |
| [5635](#L5635) | }); |
| [5636](#L5636) |  |
| [5637](#L5637) | jQuery("#addvideo").validate({ |
| [5638](#L5638) | rules: { |
| [5639](#L5639) | videotitle: { |
| [5640](#L5640) | required:true, |
| [5641](#L5641) | maxlength: 200 |
| [5642](#L5642) | }, |
| [5643](#L5643) | vtype: { |
| [5644](#L5644) | required:true |
| [5645](#L5645) |  |
| [5646](#L5646) | }, |
| [5647](#L5647) | videourl: { |
| [5648](#L5648) | required: function(element) { |
| [5649](#L5649) | return jQuery("#type\_html5").is(':checked')==0; |
| [5650](#L5650) | }, |
| [5651](#L5651) | maxlength: 500 |
| [5652](#L5652) | }, |
| [5653](#L5653) | HdnMediaSelection:{ |
| [5654](#L5654) | required:true |
| [5655](#L5655) | } |
| [5656](#L5656) |  |
| [5657](#L5657) |  |
| [5658](#L5658) | }, |
| [5659](#L5659) | errorClass: "image\_error", |
| [5660](#L5660) | errorPlacement: function(error, element) { |
| [5661](#L5661) | error.appendTo(element.parent().next().next()); |
| [5662](#L5662) | }, messages: { |
| [5663](#L5663) | HdnMediaSelection: "Please select video thumbnail.", |
| [5664](#L5664) |  |
| [5665](#L5665) | } |
| [5666](#L5666) |  |
| [5667](#L5667) | }) |
| [5668](#L5668) |  |
| [5669](#L5669) |  |
| [5670](#L5670) | jQuery("#addimage\_").validate({ |
| [5671](#L5671) | rules: { |
| [5672](#L5672) | HdnMediaSelection\_image:{ |
| [5673](#L5673) | required:true |
| [5674](#L5674) | }, |
| [5675](#L5675) | murl: { |
| [5676](#L5676) |  |
| [5677](#L5677) | /\* url:true,\*/ |
| [5678](#L5678) | maxlength: 500 |
| [5679](#L5679) | } |
| [5680](#L5680) |  |
| [5681](#L5681) |  |
| [5682](#L5682) | }, |
| [5683](#L5683) | errorClass: "image\_error", |
| [5684](#L5684) | errorPlacement: function(error, element) { |
| [5685](#L5685) | error.appendTo(element.parent().next().next()); |
| [5686](#L5686) | }, messages: { |
| [5687](#L5687) | HdnMediaSelection: "Please select image thumbnail or Upload by wordpress media uploader.", |
| [5688](#L5688) |  |
| [5689](#L5689) | } |
| [5690](#L5690) |  |
| [5691](#L5691) | }) |
| [5692](#L5692) | jQuery("#addlink\_").validate({ |
| [5693](#L5693) | rules: { |
| [5694](#L5694) | HdnMediaSelection\_link:{ |
| [5695](#L5695) | required:true |
| [5696](#L5696) | }, |
| [5697](#L5697) | murl: { |
| [5698](#L5698) | required:true, |
| [5699](#L5699) | /\* url:true,\*/ |
| [5700](#L5700) | maxlength: 500 |
| [5701](#L5701) | } |
| [5702](#L5702) |  |
| [5703](#L5703) | }, |
| [5704](#L5704) | errorClass: "image\_error", |
| [5705](#L5705) | errorPlacement: function(error, element) { |
| [5706](#L5706) | error.appendTo(element.parent().next().next()); |
| [5707](#L5707) | }, messages: { |
| [5708](#L5708) | HdnMediaSelection: "Please select link thumbnail or Upload by wordpress media uploader.", |
| [5709](#L5709) |  |
| [5710](#L5710) | } |
| [5711](#L5711) |  |
| [5712](#L5712) |  |
| [5713](#L5713) |  |
| [5714](#L5714) | }) |
| [5715](#L5715) |  |
| [5716](#L5716) |  |
| [5717](#L5717) | }); |
| [5718](#L5718) |  |
| [5719](#L5719) |  |
| [5720](#L5720) | </script> |
| [5721](#L5721) |  |
| [5722](#L5722) | </div> |
| [5723](#L5723) | <div id="postbox-container-1" class="postbox-container"  > |
| [5724](#L5724) |  |
| [5725](#L5725) | <div class="postbox"> |
| [5726](#L5726) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [5727](#L5727) | <div class="inside"> |
| [5728](#L5728) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [5729](#L5729) |  |
| [5730](#L5730) | <div style="margin:10px 5px"> |
| [5731](#L5731) |  |
| [5732](#L5732) | </div> |
| [5733](#L5733) | </div></div> |
| [5734](#L5734) | <div class="postbox"> |
| [5735](#L5735) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [5736](#L5736) | <div class="inside"> |
| [5737](#L5737) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [5738](#L5738) | <div style="margin:10px 5px"> |
| [5739](#L5739) | </div> |
| [5740](#L5740) | </div></div> |
| [5741](#L5741) |  |
| [5742](#L5742) |  |
| [5743](#L5743) | </div> |
| [5744](#L5744) | </div> |
| [5745](#L5745) | </div> |
| [5746](#L5746) | </div> |
| [5747](#L5747) | </div> |
| [5748](#L5748) | <?php |
| [5749](#L5749) | } |
| [5750](#L5750) | } else if (strtolower ( $action ) == strtolower ( 'delete' )) { |
| [5751](#L5751) |  |
| [5752](#L5752) | $retrieved\_nonce = ''; |
| [5753](#L5753) |  |
| [5754](#L5754) | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
| [5755](#L5755) |  |
| [5756](#L5756) | $retrieved\_nonce=sanitize\_text\_field($\_GET['nonce']); |
| [5757](#L5757) |  |
| [5758](#L5758) | } |
| [5759](#L5759) | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
| [5760](#L5760) |  |
| [5761](#L5761) |  |
| [5762](#L5762) | wp\_die('Security check fail'); |
| [5763](#L5763) | } |
| [5764](#L5764) |  |
| [5765](#L5765) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_delete\_media' ) ) { |
| [5766](#L5766) |  |
| [5767](#L5767) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [5768](#L5768) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [5769](#L5769) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [5770](#L5770) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [5771](#L5771) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [5772](#L5772) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5773](#L5773) | exit; |
| [5774](#L5774) |  |
| [5775](#L5775) | } |
| [5776](#L5776) |  |
| [5777](#L5777) | $uploads = wp\_upload\_dir (); |
| [5778](#L5778) | $baseDir = $uploads ['basedir']; |
| [5779](#L5779) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [5780](#L5780) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [5781](#L5781) |  |
| [5782](#L5782) |  |
| [5783](#L5783) |  |
| [5784](#L5784) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [5785](#L5785) | $deleteId = (int) htmlentities(intval($\_GET ['id']),ENT\_QUOTES); |
| [5786](#L5786) |  |
| [5787](#L5787) | try { |
| [5788](#L5788) |  |
| [5789](#L5789) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$deleteId"; |
| [5790](#L5790) | $myrow = $wpdb->get\_row ( $query ); |
| [5791](#L5791) |  |
| [5792](#L5792) | if (is\_object ( $myrow )) { |
| [5793](#L5793) |  |
| [5794](#L5794) |  |
| [5795](#L5795) | $image\_name = $myrow->image\_name; |
| [5796](#L5796) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [5797](#L5797) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [5798](#L5798) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [5799](#L5799) | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
| [5800](#L5800) | $pInfo2 = pathinfo ( $imagetoDel ); |
| [5801](#L5801) | $ext = $pInfo2 ['extension']; |
| [5802](#L5802) |  |
| [5803](#L5803) | @unlink ( $imagetoDel ); |
| [5804](#L5804) |  |
| [5805](#L5805) | $query = "delete from  " . $wpdb->prefix . "rjg\_gallery where id=$deleteId"; |
| [5806](#L5806) | $wpdb->query ( $query ); |
| [5807](#L5807) |  |
| [5808](#L5808) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5809](#L5809) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [5810](#L5810) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] =  \_\_('Video deleted successfully.','wp-responsive-photo-gallery'); |
| [5811](#L5811) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5812](#L5812) | } |
| [5813](#L5813) | } catch ( Exception $e ) { |
| [5814](#L5814) |  |
| [5815](#L5815) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5816](#L5816) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [5817](#L5817) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] =  \_\_('Error while deleting video.','wp-responsive-photo-gallery'); |
| [5818](#L5818) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5819](#L5819) | } |
| [5820](#L5820) |  |
| [5821](#L5821) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5822](#L5822) | exit (); |
| [5823](#L5823) | } else if (strtolower ( $action ) == strtolower ( 'deleteselected' )) { |
| [5824](#L5824) |  |
| [5825](#L5825) | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
| [5826](#L5826) |  |
| [5827](#L5827) | wp\_die('Security check fail'); |
| [5828](#L5828) | } |
| [5829](#L5829) |  |
| [5830](#L5830) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_delete\_media' ) ) { |
| [5831](#L5831) |  |
| [5832](#L5832) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [5833](#L5833) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [5834](#L5834) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [5835](#L5835) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [5836](#L5836) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [5837](#L5837) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5838](#L5838) | exit; |
| [5839](#L5839) |  |
| [5840](#L5840) | } |
| [5841](#L5841) |  |
| [5842](#L5842) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [5843](#L5843) |  |
| [5844](#L5844) | if (isset ( $\_POST ) and isset ( $\_POST ['deleteselected'] ) and ($\_POST ['action'] == 'delete' or $\_POST ['action\_upper'] == 'delete')) { |
| [5845](#L5845) |  |
| [5846](#L5846) | $uploads = wp\_upload\_dir (); |
| [5847](#L5847) | $baseDir = $uploads ['basedir']; |
| [5848](#L5848) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [5849](#L5849) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [5850](#L5850) |  |
| [5851](#L5851) | if (sizeof ( $\_POST ['thumbnails'] ) > 0) { |
| [5852](#L5852) |  |
| [5853](#L5853) | $deleteto = $\_POST ['thumbnails']; |
| [5854](#L5854) | $implode = implode ( ',', $deleteto ); |
| [5855](#L5855) |  |
| [5856](#L5856) | try { |
| [5857](#L5857) |  |
| [5858](#L5858) | foreach ( $deleteto as $img ) { |
| [5859](#L5859) |  |
| [5860](#L5860) | $img=intval($img); |
| [5861](#L5861) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$img"; |
| [5862](#L5862) | $myrow = $wpdb->get\_row ( $query ); |
| [5863](#L5863) |  |
| [5864](#L5864) |  |
| [5865](#L5865) |  |
| [5866](#L5866) | if (is\_object ( $myrow )) { |
| [5867](#L5867) |  |
| [5868](#L5868) | $image\_name = $myrow->image\_name ; |
| [5869](#L5869) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [5870](#L5870) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [5871](#L5871) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [5872](#L5872) |  |
| [5873](#L5873) | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
| [5874](#L5874) | $pInfo2 = pathinfo ( $imagetoDel ); |
| [5875](#L5875) | $ext = $pInfo2 ['extension']; |
| [5876](#L5876) |  |
| [5877](#L5877) | @unlink ( $imagetoDel ); |
| [5878](#L5878) |  |
| [5879](#L5879) |  |
| [5880](#L5880) | $query = "delete from  " . $wpdb->prefix . "rjg\_gallery where id=$img"; |
| [5881](#L5881) | $wpdb->query ( $query ); |
| [5882](#L5882) |  |
| [5883](#L5883) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5884](#L5884) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [5885](#L5885) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('selected media deleted successfully.','wp-responsive-photo-gallery'); |
| [5886](#L5886) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5887](#L5887) | } |
| [5888](#L5888) | } |
| [5889](#L5889) | } catch ( Exception $e ) { |
| [5890](#L5890) |  |
| [5891](#L5891) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5892](#L5892) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [5893](#L5893) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while deleting videos.','wp-responsive-photo-gallery'); |
| [5894](#L5894) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5895](#L5895) | } |
| [5896](#L5896) |  |
| [5897](#L5897) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5898](#L5898) | exit (); |
| [5899](#L5899) | } else { |
| [5900](#L5900) |  |
| [5901](#L5901) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5902](#L5902) | exit (); |
| [5903](#L5903) | } |
| [5904](#L5904) | } else { |
| [5905](#L5905) |  |
| [5906](#L5906) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5907](#L5907) | exit (); |
| [5908](#L5908) | } |
| [5909](#L5909) | } |
| [5910](#L5910) | } |
| [5911](#L5911) |  |
| [5912](#L5912) | function rjg\_justified\_gallery\_get\_wp\_version() { |
| [5913](#L5913) | global $wp\_version; |
| [5914](#L5914) | return $wp\_version; |
| [5915](#L5915) | } |
| [5916](#L5916) |  |
| [5917](#L5917) | // also we will add an option function that will check for plugin admin page or not |
| [5918](#L5918) | function rjg\_responsive\_justified\_gallery\_plus\_lightbox\_is\_plugin\_page() { |
| [5919](#L5919) |  |
| [5920](#L5920) | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
| [5921](#L5921) |  |
| [5922](#L5922) | foreach ( array ('responsive\_photo\_gallery\_image\_management', 'responsive\_justified\_gallery\_with\_lightbox\_media\_management','responsive\_justified\_gallery\_with\_lightbox' |
| [5923](#L5923) | ) as $allowURI ) { |
| [5924](#L5924) | if (stristr ( $server\_uri, $allowURI )) |
| [5925](#L5925) | return true; |
| [5926](#L5926) | } |
| [5927](#L5927) | return false; |
| [5928](#L5928) | } |
| [5929](#L5929) | function my\_responsive\_photo\_gallery\_admin\_scripts\_init() { |
| [5930](#L5930) | if(my\_responsive\_photo\_gallery\_is\_plugin\_page()) { |
| [5931](#L5931) | //double check for WordPress version and function exists |
| [5932](#L5932) | if(function\_exists('wp\_enqueue\_media') && version\_compare(my\_responsive\_photo\_gallery\_get\_wp\_version(), '3.5', '>=')) { |
| [5933](#L5933) | //call for new media manager |
| [5934](#L5934) | wp\_enqueue\_media(); |
| [5935](#L5935) | } |
| [5936](#L5936) | wp\_enqueue\_style('media'); |
| [5937](#L5937) | } |
| [5938](#L5938) | } |
| [5939](#L5939) |  |
| [5940](#L5940) | // add media WP scripts |
| [5941](#L5941) | function rjg\_responsive\_justified\_gallery\_plus\_lightbox\_admin\_scripts\_init() { |
| [5942](#L5942) |  |
| [5943](#L5943) | if (rjg\_responsive\_justified\_gallery\_plus\_lightbox\_is\_plugin\_page()) { |
| [5944](#L5944) | // double check for WordPress version and function exists |
| [5945](#L5945) | if (function\_exists ( 'wp\_enqueue\_media' ) && version\_compare ( rjg\_justified\_gallery\_get\_wp\_version (), '3.5', '>=' )) { |
| [5946](#L5946) | // call for new media manager |
| [5947](#L5947) | wp\_enqueue\_media (); |
| [5948](#L5948) | } |
| [5949](#L5949) | wp\_enqueue\_style ( 'media' ); |
| [5950](#L5950) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [5951](#L5951) | wp\_enqueue\_script( 'wp-color-picker' ); |
| [5952](#L5952) |  |
| [5953](#L5953) | } |
| [5954](#L5954) | } |
| [5955](#L5955) | function wrpg\_remove\_extra\_p\_tags($content){ |
| [5956](#L5956) |  |
| [5957](#L5957) | if(strpos($content, 'print\_my\_responsive\_photo\_gallery\_func')!==false){ |
| [5958](#L5958) |  |
| [5959](#L5959) |  |
| [5960](#L5960) | $pattern = "/<!-- print\_my\_responsive\_photo\_gallery\_func -->(.\*)<!-- end print\_my\_responsive\_photo\_gallery\_func -->/Uis"; |
| [5961](#L5961) | $content = preg\_replace\_callback($pattern, function($matches) { |
| [5962](#L5962) |  |
| [5963](#L5963) |  |
| [5964](#L5964) | $altered = str\_replace("<p>","",$matches[1]); |
| [5965](#L5965) | $altered = str\_replace("</p>","",$altered); |
| [5966](#L5966) |  |
| [5967](#L5967) | $altered=str\_replace("&#038;","&",$altered); |
| [5968](#L5968) | $altered=str\_replace("&#8221;",'"',$altered); |
| [5969](#L5969) |  |
| [5970](#L5970) |  |
| [5971](#L5971) | return @str\_replace($matches[1], $altered, $matches[0]); |
| [5972](#L5972) | }, $content); |
| [5973](#L5973) |  |
| [5974](#L5974) |  |
| [5975](#L5975) |  |
| [5976](#L5976) | } |
| [5977](#L5977) |  |
| [5978](#L5978) | $content = str\_replace("<p><!-- print\_my\_responsive\_photo\_gallery\_func -->","<!-- print\_my\_responsive\_photo\_gallery\_func -->",$content); |
| [5979](#L5979) | $content = str\_replace("<!-- end print\_my\_responsive\_photo\_gallery\_func --></p>","<!-- end print\_my\_responsive\_photo\_gallery\_func -->",$content); |
| [5980](#L5980) |  |
| [5981](#L5981) |  |
| [5982](#L5982) | return $content; |
| [5983](#L5983) | } |
| [5984](#L5984) |  |
| [5985](#L5985) | add\_filter('widget\_text\_content', 'wrpg\_remove\_extra\_p\_tags', 999); |
| [5986](#L5986) | add\_filter('the\_content', 'wrpg\_remove\_extra\_p\_tags', 999); |
| [5987](#L5987) |  |
| [5988](#L5988) |  |
| [5989](#L5989) | function rjg\_print\_masonry\_gallery\_plus\_lightbox\_func($atts) { |
| [5990](#L5990) |  |
| [5991](#L5991) |  |
| [5992](#L5992) | global $wpdb; |
| [5993](#L5993) | $settings=get\_option('rjg\_settings'); |
| [5994](#L5994) | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
| [5995](#L5995) | $limit = $settings['page\_size']; |
| [5996](#L5996) | $offset = ( $pagenum - 1 ) \* $limit; |
| [5997](#L5997) |  |
| [5998](#L5998) | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
| [5999](#L5999) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [6000](#L6000) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [6001](#L6001) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [6002](#L6002) |  |
| [6003](#L6003) |  |
| [6004](#L6004) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6005](#L6005) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6006](#L6006) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [6007](#L6007) |  |
| [6008](#L6008) | $uploads = wp\_upload\_dir (); |
| [6009](#L6009) | $baseDir = $uploads ['basedir']; |
| [6010](#L6010) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6011](#L6011) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [6012](#L6012) | $baseurl = $uploads ['baseurl']; |
| [6013](#L6013) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [6014](#L6014) |  |
| [6015](#L6015) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6016](#L6016) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6017](#L6017) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [6018](#L6018) | $randOmeRel = uniqid ( 'rel\_' ); |
| [6019](#L6019) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [6020](#L6020) | $vNonce = wp\_create\_nonce('vNonce'); |
| [6021](#L6021) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [6022](#L6022) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [6023](#L6023) |  |
| [6024](#L6024) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [6025](#L6025) | if(strtolower($LoadingBackColor)=='none'){ |
| [6026](#L6026) | $LoadingBackColor='#ffffff'; |
| [6027](#L6027) | } |
| [6028](#L6028) | $imageMargin=$settings['imageMargin']; |
| [6029](#L6029) |  |
| [6030](#L6030) | wp\_enqueue\_style('rjg-lbox'); |
| [6031](#L6031) | wp\_enqueue\_style('rjg-justified-gallery'); |
| [6032](#L6032) | wp\_enqueue\_script('jquery'); |
| [6033](#L6033) | wp\_enqueue\_script('rjg-justified-gallery'); |
| [6034](#L6034) | wp\_enqueue\_script('rjg-lbox-js'); |
| [6035](#L6035) |  |
| [6036](#L6036) | ob\_start(); |
| [6037](#L6037) | ?> |
| [6038](#L6038) | <!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --><?php if (is\_array($settings)) { ?> |
| [6039](#L6039) |  |
| [6040](#L6040) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [6041](#L6041) | <div style="clear: both;"></div> |
| [6042](#L6042) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6043](#L6043) | <div style="clear: both;"></div> |
| [6044](#L6044) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6045](#L6045) |  |
| [6046](#L6046) |  |
| [6047](#L6047) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" style="visibility: hidden" > |
| [6048](#L6048) |  |
| [6049](#L6049) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [6050](#L6050) |  |
| [6051](#L6051) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [6052](#L6052) |  |
| [6053](#L6053) | <?php |
| [6054](#L6054) |  |
| [6055](#L6055) | $imageheight = $settings ['imageheight']; |
| [6056](#L6056) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [6057](#L6057) | $firstChild='firstimg'; |
| [6058](#L6058) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [6059](#L6059) |  |
| [6060](#L6060) |  |
| [6061](#L6061) | if (count ( $rows ) > 0) { |
| [6062](#L6062) |  |
| [6063](#L6063) | foreach ( $rows as $row ) { |
| [6064](#L6064) |  |
| [6065](#L6065) | $imagename = $row ['image\_name']; |
| [6066](#L6066) | $video\_url = $row ['videourl']; |
| [6067](#L6067) | $video\_url\_org = $row ['murl']; |
| [6068](#L6068) | $Url\_vid = @parse\_url($video\_url\_org); |
| [6069](#L6069) |  |
| [6070](#L6070) |  |
| [6071](#L6071) |  |
| [6072](#L6072) | $relend = ''; |
| [6073](#L6073) | $flag=false; |
| [6074](#L6074) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [6075](#L6075) |  |
| [6076](#L6076) |  |
| [6077](#L6077) | parse\_str($Url\_vid['query'], $get\_array); |
| [6078](#L6078) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [6079](#L6079) |  |
| [6080](#L6080) | foreach($get\_array as $k=>$v){ |
| [6081](#L6081) |  |
| [6082](#L6082) | if($flag==false){ |
| [6083](#L6083) |  |
| [6084](#L6084) | $flag=true; |
| [6085](#L6085) | $relend.="?$k=$v"; |
| [6086](#L6086) | } |
| [6087](#L6087) | else{ |
| [6088](#L6088) |  |
| [6089](#L6089) | $relend.="&$k=$v"; |
| [6090](#L6090) |  |
| [6091](#L6091) | } |
| [6092](#L6092) |  |
| [6093](#L6093) |  |
| [6094](#L6094) | } |
| [6095](#L6095) |  |
| [6096](#L6096) |  |
| [6097](#L6097) | } |
| [6098](#L6098) |  |
| [6099](#L6099) |  |
| [6100](#L6100) |  |
| [6101](#L6101) | } |
| [6102](#L6102) |  |
| [6103](#L6103) | $vtype= $row ['vtype']; |
| [6104](#L6104) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [6105](#L6105) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [6106](#L6106) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [6107](#L6107) | $filenamewithoutextension = $pathinfo ['filename']; |
| [6108](#L6108) |  |
| [6109](#L6109) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [6110](#L6110) | $outputimg=$outputimgmain; |
| [6111](#L6111) | $media\_type=$row['media\_type']; |
| [6112](#L6112) | $hoverClass=''; |
| [6113](#L6113) | if($media\_type=="link") |
| [6114](#L6114) | $hoverClass="playbtnCss\_link"; |
| [6115](#L6115) | else if($media\_type=="video") |
| [6116](#L6116) | $hoverClass="playbtnCss\_video"; |
| [6117](#L6117) | else if($media\_type=="image") |
| [6118](#L6118) | $hoverClass="playbtnCss\_zoom"; |
| [6119](#L6119) |  |
| [6120](#L6120) | $title = ""; |
| [6121](#L6121) | $rowTitle = $row['title']; |
| [6122](#L6122) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [6123](#L6123) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [6124](#L6124) |  |
| [6125](#L6125) |  |
| [6126](#L6126) |  |
| [6127](#L6127) | $open\_link\_in = $row['open\_link\_in']; |
| [6128](#L6128) | $open\_title\_link\_in = 1; |
| [6129](#L6129) |  |
| [6130](#L6130) | if(!$open\_title\_link\_in) |
| [6131](#L6131) | $openImageInNewTab = '\_self'; |
| [6132](#L6132) | else |
| [6133](#L6133) | $openImageInNewTab = '\_blank'; |
| [6134](#L6134) |  |
| [6135](#L6135) | $embed\_url=$row['embed\_url'].$relend; |
| [6136](#L6136) | if($media\_type=="video"){ |
| [6137](#L6137) |  |
| [6138](#L6138) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [6139](#L6139) |  |
| [6140](#L6140) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [6141](#L6141) |  |
| [6142](#L6142) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [6143](#L6143) |  |
| [6144](#L6144) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6145](#L6145) |  |
| [6146](#L6146) | } else { |
| [6147](#L6147) |  |
| [6148](#L6148) | if ($row['mdescription'] != '') |
| [6149](#L6149) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6150](#L6150) |  |
| [6151](#L6151) | } |
| [6152](#L6152) | } |
| [6153](#L6153) | else if($media\_type=="image"){ |
| [6154](#L6154) |  |
| [6155](#L6155) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [6156](#L6156) |  |
| [6157](#L6157) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [6158](#L6158) |  |
| [6159](#L6159) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [6160](#L6160) |  |
| [6161](#L6161) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6162](#L6162) |  |
| [6163](#L6163) | } else { |
| [6164](#L6164) |  |
| [6165](#L6165) | if ($row['mdescription'] != '') |
| [6166](#L6166) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6167](#L6167) |  |
| [6168](#L6168) | } |
| [6169](#L6169) |  |
| [6170](#L6170) | } |
| [6171](#L6171) |  |
| [6172](#L6172) | $title= htmlentities($title); |
| [6173](#L6173) | ?> |
| [6174](#L6174) |  |
| [6175](#L6175) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [6176](#L6176) |  |
| [6177](#L6177) | <?php if ($open\_link\_in == 1): ?> |
| [6178](#L6178) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [6179](#L6179) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6180](#L6180) | </a> |
| [6181](#L6181) | <?php else: ?> |
| [6182](#L6182) |  |
| [6183](#L6183) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [6184](#L6184) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6185](#L6185) | </a> |
| [6186](#L6186) | <?php endif;?> |
| [6187](#L6187) |  |
| [6188](#L6188) | <?php else:?> |
| [6189](#L6189) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [6190](#L6190) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6191](#L6191) | </a> |
| [6192](#L6192) |  |
| [6193](#L6193) | <?php endif;?> |
| [6194](#L6194) |  |
| [6195](#L6195) |  |
| [6196](#L6196) |  |
| [6197](#L6197) | <?php } ?> |
| [6198](#L6198) |  |
| [6199](#L6199) | <?php } ?> |
| [6200](#L6200) | <br style="clear: both;"> |
| [6201](#L6201) | </div> |
| [6202](#L6202) | <?php |
| [6203](#L6203) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [6204](#L6204) | $num\_of\_pages = ceil($total / $limit); |
| [6205](#L6205) | $page\_links = paginate\_links(array( |
| [6206](#L6206) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [6207](#L6207) | 'format' => '', |
| [6208](#L6208) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [6209](#L6209) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [6210](#L6210) | 'total' => $num\_of\_pages, |
| [6211](#L6211) | 'current' => $pagenum, |
| [6212](#L6212) | 'prev\_next' => true, |
| [6213](#L6213) | 'type' => 'list', |
| [6214](#L6214) | )); |
| [6215](#L6215) |  |
| [6216](#L6216) | if ($page\_links) { |
| [6217](#L6217) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [6218](#L6218) |  |
| [6219](#L6219) | } |
| [6220](#L6220) | ?> |
| [6221](#L6221) |  |
| [6222](#L6222) | <div style="clear:both"></div> |
| [6223](#L6223) | </div> |
| [6224](#L6224) |  |
| [6225](#L6225) | <script> |
| [6226](#L6226) |  |
| [6227](#L6227) | <?php $intval= uniqid('interval\_');?> |
| [6228](#L6228) |  |
| [6229](#L6229) | var <?php echo $intval;?> = setInterval(function() { |
| [6230](#L6230) |  |
| [6231](#L6231) | if(document.readyState === 'complete') { |
| [6232](#L6232) |  |
| [6233](#L6233) | clearInterval(<?php echo $intval;?>); |
| [6234](#L6234) |  |
| [6235](#L6235) |  |
| [6236](#L6236) | jQuery(".gallery\_wrap0").css('visibility','visible'); |
| [6237](#L6237) |  |
| [6238](#L6238) | <?php $uniqId = uniqid(); ?> |
| [6239](#L6239) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [6240](#L6240) |  |
| [6241](#L6241) |  |
| [6242](#L6242) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [6243](#L6243) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [6244](#L6244) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [6245](#L6245) | margin:<?php echo $settings ['imageMargin'];?>, |
| [6246](#L6246) | target:'<?php echo $target;?>', |
| [6247](#L6247) | init : function() { }, |
| [6248](#L6248) | loadPicture : function(event, img) {  }, |
| [6249](#L6249) | resize : function(event, gallery) {  }, |
| [6250](#L6250) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [6251](#L6251) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [6252](#L6252) | }); |
| [6253](#L6253) |  |
| [6254](#L6254) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [6255](#L6255) |  |
| [6256](#L6256) | 'overlayColor':'#000000', |
| [6257](#L6257) | 'padding': 3, |
| [6258](#L6258) | 'margin': 20, |
| [6259](#L6259) | 'autoScale': true, |
| [6260](#L6260) | 'autoDimensions':true, |
| [6261](#L6261) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [6262](#L6262) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [6263](#L6263) | 'transitionIn':'fade', |
| [6264](#L6264) | 'transitionOut':'fade', |
| [6265](#L6265) | 'titlePosition': 'outside', |
| [6266](#L6266) | 'cyclic':true, |
| [6267](#L6267) | 'hideOnContentClick':false, |
| [6268](#L6268) | 'width' : 650, |
| [6269](#L6269) | 'height' : 400, |
| [6270](#L6270) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [6271](#L6271) |  |
| [6272](#L6272) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [6273](#L6273) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [6274](#L6274) |  |
| [6275](#L6275) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [6276](#L6276) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [6277](#L6277) | } |
| [6278](#L6278) | else{ |
| [6279](#L6279) | return ''; |
| [6280](#L6280) | } |
| [6281](#L6281) |  |
| [6282](#L6282) | } |
| [6283](#L6283) | }); |
| [6284](#L6284) |  |
| [6285](#L6285) | jQuery(".page-numbers").show(); |
| [6286](#L6286) |  |
| [6287](#L6287) |  |
| [6288](#L6288) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [6289](#L6289) |  |
| [6290](#L6290) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [6291](#L6291) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [6292](#L6292) |  |
| [6293](#L6293) | e.preventDefault(); |
| [6294](#L6294) | var data = { |
| [6295](#L6295) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [6296](#L6296) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [6297](#L6297) | 'grid\_id':0, |
| [6298](#L6298) | 'total\_rec':'<?php echo $total; ?>', |
| [6299](#L6299) | 'vNonce':'<?php echo $vNonce;?>' |
| [6300](#L6300) | }; |
| [6301](#L6301) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [6302](#L6302) |  |
| [6303](#L6303) |  |
| [6304](#L6304) | jQuery('html, body').animate({ |
| [6305](#L6305) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [6306](#L6306) | }, 800); |
| [6307](#L6307) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [6308](#L6308) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [6309](#L6309) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [6310](#L6310) |  |
| [6311](#L6311) |  |
| [6312](#L6312) | }); |
| [6313](#L6313) |  |
| [6314](#L6314) |  |
| [6315](#L6315) |  |
| [6316](#L6316) | }); |
| [6317](#L6317) |  |
| [6318](#L6318) | } |
| [6319](#L6319) | }, 100); |
| [6320](#L6320) |  |
| [6321](#L6321) |  |
| [6322](#L6322) | </script> |
| [6323](#L6323) |  |
| [6324](#L6324) |  |
| [6325](#L6325) | <?php } ?> |
| [6326](#L6326) |  |
| [6327](#L6327) | <div class="clear"></div> |
| [6328](#L6328) | <!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --> |
| [6329](#L6329) | <?php |
| [6330](#L6330) | $output = ob\_get\_clean (); |
| [6331](#L6331) | return $output; |
| [6332](#L6332) | } |
| [6333](#L6333) | function rfp\_responsive\_justified\_gallery\_with\_lightbox\_media\_preview\_func() { |
| [6334](#L6334) |  |
| [6335](#L6335) | global $wpdb; |
| [6336](#L6336) |  |
| [6337](#L6337) |  |
| [6338](#L6338) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_preview' ) ) { |
| [6339](#L6339) |  |
| [6340](#L6340) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6341](#L6341) |  |
| [6342](#L6342) | } |
| [6343](#L6343) |  |
| [6344](#L6344) | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
| [6345](#L6345) |  |
| [6346](#L6346) | $settings=get\_option('rjg\_settings'); |
| [6347](#L6347) |  |
| [6348](#L6348) |  |
| [6349](#L6349) | $limit = $settings['page\_size']; |
| [6350](#L6350) | $offset = ( $pagenum - 1 ) \* $limit; |
| [6351](#L6351) |  |
| [6352](#L6352) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [6353](#L6353) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [6354](#L6354) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [6355](#L6355) |  |
| [6356](#L6356) |  |
| [6357](#L6357) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6358](#L6358) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6359](#L6359) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [6360](#L6360) |  |
| [6361](#L6361) | $uploads = wp\_upload\_dir (); |
| [6362](#L6362) | $baseDir = $uploads ['basedir']; |
| [6363](#L6363) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6364](#L6364) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [6365](#L6365) | $baseurl = $uploads ['baseurl']; |
| [6366](#L6366) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [6367](#L6367) |  |
| [6368](#L6368) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6369](#L6369) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6370](#L6370) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [6371](#L6371) | $randOmeRel = uniqid ( 'rel\_' ); |
| [6372](#L6372) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [6373](#L6373) | $vNonce = wp\_create\_nonce('vNonce'); |
| [6374](#L6374) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [6375](#L6375) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [6376](#L6376) | $imageMargin=$settings['imageMargin']; |
| [6377](#L6377) |  |
| [6378](#L6378) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [6379](#L6379) | if(strtolower($LoadingBackColor)=='none'){ |
| [6380](#L6380) | $LoadingBackColor='#ffffff'; |
| [6381](#L6381) | } |
| [6382](#L6382) | ?> |
| [6383](#L6383) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [6384](#L6384) | <div style="width: 100%;"> |
| [6385](#L6385) | <br/> |
| [6386](#L6386) | <div style="float: left; width: 100%;"> |
| [6387](#L6387) | <table><tr> |
| [6388](#L6388) | <td> |
| [6389](#L6389) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [6390](#L6390) | <div id="fb-root"></div> |
| [6391](#L6391) | <script>(function(d, s, id) { |
| [6392](#L6392) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [6393](#L6393) | if (d.getElementById(id)) return; |
| [6394](#L6394) | js = d.createElement(s); js.id = id; |
| [6395](#L6395) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [6396](#L6396) | fjs.parentNode.insertBefore(js, fjs); |
| [6397](#L6397) | }(document, 'script', 'facebook-jssdk'));</script> |
| [6398](#L6398) | </td> |
| [6399](#L6399) | <td> |
| [6400](#L6400) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [6401](#L6401) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [6402](#L6402) | </a> |
| [6403](#L6403) | </td> |
| [6404](#L6404) | </tr> |
| [6405](#L6405) | </table> |
| [6406](#L6406) | <div style="clear:both"> |
| [6407](#L6407) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [6408](#L6408) | </div> |
| [6409](#L6409) | <h2><?php echo \_\_('Masonry Gallery Preview','wp-responsive-photo-gallery');?></h2> |
| [6410](#L6410) |  |
| [6411](#L6411) | <?php if (is\_array($settings)) { |
| [6412](#L6412) |  |
| [6413](#L6413) | ?> |
| [6414](#L6414) |  |
| [6415](#L6415) | <div style="clear: both;"></div> |
| [6416](#L6416) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6417](#L6417) | <div style="clear: both;"></div> |
| [6418](#L6418) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6419](#L6419) |  |
| [6420](#L6420) |  |
| [6421](#L6421) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" > |
| [6422](#L6422) |  |
| [6423](#L6423) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [6424](#L6424) |  |
| [6425](#L6425) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [6426](#L6426) |  |
| [6427](#L6427) | <?php |
| [6428](#L6428) |  |
| [6429](#L6429) | $imageheight = $settings ['imageheight']; |
| [6430](#L6430) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [6431](#L6431) | $firstChild='firstimg'; |
| [6432](#L6432) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [6433](#L6433) |  |
| [6434](#L6434) |  |
| [6435](#L6435) | if (count ( $rows ) > 0) { |
| [6436](#L6436) |  |
| [6437](#L6437) | foreach ( $rows as $row ) { |
| [6438](#L6438) |  |
| [6439](#L6439) | $imagename = $row ['image\_name']; |
| [6440](#L6440) | $video\_url = $row ['videourl']; |
| [6441](#L6441) | $video\_url\_org = $row ['murl']; |
| [6442](#L6442) | $Url\_vid = @parse\_url($video\_url\_org); |
| [6443](#L6443) |  |
| [6444](#L6444) |  |
| [6445](#L6445) |  |
| [6446](#L6446) | $relend = ''; |
| [6447](#L6447) | $flag=false; |
| [6448](#L6448) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [6449](#L6449) |  |
| [6450](#L6450) |  |
| [6451](#L6451) | parse\_str($Url\_vid['query'], $get\_array); |
| [6452](#L6452) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [6453](#L6453) |  |
| [6454](#L6454) | foreach($get\_array as $k=>$v){ |
| [6455](#L6455) |  |
| [6456](#L6456) | if($flag==false){ |
| [6457](#L6457) |  |
| [6458](#L6458) | $flag=true; |
| [6459](#L6459) | $relend.="?$k=$v"; |
| [6460](#L6460) | } |
| [6461](#L6461) | else{ |
| [6462](#L6462) |  |
| [6463](#L6463) | $relend.="&$k=$v"; |
| [6464](#L6464) |  |
| [6465](#L6465) | } |
| [6466](#L6466) |  |
| [6467](#L6467) |  |
| [6468](#L6468) | } |
| [6469](#L6469) |  |
| [6470](#L6470) |  |
| [6471](#L6471) | } |
| [6472](#L6472) |  |
| [6473](#L6473) |  |
| [6474](#L6474) |  |
| [6475](#L6475) | } |
| [6476](#L6476) |  |
| [6477](#L6477) | $vtype= $row ['vtype']; |
| [6478](#L6478) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [6479](#L6479) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [6480](#L6480) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [6481](#L6481) | $filenamewithoutextension = $pathinfo ['filename']; |
| [6482](#L6482) |  |
| [6483](#L6483) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [6484](#L6484) | $outputimg=$outputimgmain; |
| [6485](#L6485) | $media\_type=$row['media\_type']; |
| [6486](#L6486) | $hoverClass=''; |
| [6487](#L6487) | if($media\_type=="link") |
| [6488](#L6488) | $hoverClass="playbtnCss\_link"; |
| [6489](#L6489) | else if($media\_type=="video") |
| [6490](#L6490) | $hoverClass="playbtnCss\_video"; |
| [6491](#L6491) | else if($media\_type=="image") |
| [6492](#L6492) | $hoverClass="playbtnCss\_zoom"; |
| [6493](#L6493) |  |
| [6494](#L6494) | $title = ""; |
| [6495](#L6495) | $rowTitle = $row['title']; |
| [6496](#L6496) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [6497](#L6497) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [6498](#L6498) |  |
| [6499](#L6499) |  |
| [6500](#L6500) |  |
| [6501](#L6501) | $open\_link\_in = $row['open\_link\_in']; |
| [6502](#L6502) | $open\_title\_link\_in = 1; |
| [6503](#L6503) |  |
| [6504](#L6504) | if(!$open\_title\_link\_in) |
| [6505](#L6505) | $openImageInNewTab = '\_self'; |
| [6506](#L6506) | else |
| [6507](#L6507) | $openImageInNewTab = '\_blank'; |
| [6508](#L6508) |  |
| [6509](#L6509) | $embed\_url=$row['embed\_url'].$relend; |
| [6510](#L6510) | if($media\_type=="video"){ |
| [6511](#L6511) |  |
| [6512](#L6512) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [6513](#L6513) |  |
| [6514](#L6514) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [6515](#L6515) |  |
| [6516](#L6516) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [6517](#L6517) |  |
| [6518](#L6518) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6519](#L6519) |  |
| [6520](#L6520) | } else { |
| [6521](#L6521) |  |
| [6522](#L6522) | if ($row['mdescription'] != '') |
| [6523](#L6523) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6524](#L6524) |  |
| [6525](#L6525) | } |
| [6526](#L6526) | } |
| [6527](#L6527) | else if($media\_type=="image"){ |
| [6528](#L6528) |  |
| [6529](#L6529) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [6530](#L6530) |  |
| [6531](#L6531) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [6532](#L6532) |  |
| [6533](#L6533) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [6534](#L6534) |  |
| [6535](#L6535) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6536](#L6536) |  |
| [6537](#L6537) | } else { |
| [6538](#L6538) |  |
| [6539](#L6539) | if ($row['mdescription'] != '') |
| [6540](#L6540) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6541](#L6541) |  |
| [6542](#L6542) | } |
| [6543](#L6543) |  |
| [6544](#L6544) | } |
| [6545](#L6545) |  |
| [6546](#L6546) |  |
| [6547](#L6547) | ?> |
| [6548](#L6548) |  |
| [6549](#L6549) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [6550](#L6550) |  |
| [6551](#L6551) | <?php if ($open\_link\_in == 1): ?> |
| [6552](#L6552) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [6553](#L6553) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6554](#L6554) | </a> |
| [6555](#L6555) | <?php else: ?> |
| [6556](#L6556) |  |
| [6557](#L6557) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [6558](#L6558) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6559](#L6559) | </a> |
| [6560](#L6560) | <?php endif;?> |
| [6561](#L6561) |  |
| [6562](#L6562) | <?php else:?> |
| [6563](#L6563) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [6564](#L6564) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6565](#L6565) | </a> |
| [6566](#L6566) |  |
| [6567](#L6567) | <?php endif;?> |
| [6568](#L6568) |  |
| [6569](#L6569) |  |
| [6570](#L6570) |  |
| [6571](#L6571) | <?php } ?> |
| [6572](#L6572) |  |
| [6573](#L6573) | <?php } ?> |
| [6574](#L6574) | <br style="clear: both;"> |
| [6575](#L6575) | </div> |
| [6576](#L6576) | <?php |
| [6577](#L6577) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [6578](#L6578) | $num\_of\_pages = ceil($total / $limit); |
| [6579](#L6579) | $page\_links = paginate\_links(array( |
| [6580](#L6580) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [6581](#L6581) | 'format' => '', |
| [6582](#L6582) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [6583](#L6583) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [6584](#L6584) | 'total' => $num\_of\_pages, |
| [6585](#L6585) | 'current' => $pagenum, |
| [6586](#L6586) | 'prev\_next' => true, |
| [6587](#L6587) | 'type' => 'list', |
| [6588](#L6588) | )); |
| [6589](#L6589) |  |
| [6590](#L6590) | if ($page\_links) { |
| [6591](#L6591) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [6592](#L6592) |  |
| [6593](#L6593) | } |
| [6594](#L6594) | ?> |
| [6595](#L6595) |  |
| [6596](#L6596) | <div style="clear:both"></div> |
| [6597](#L6597) | </div> |
| [6598](#L6598) |  |
| [6599](#L6599) | <script> |
| [6600](#L6600) |  |
| [6601](#L6601) | <?php $uniqId = uniqid(); ?> |
| [6602](#L6602) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [6603](#L6603) |  |
| [6604](#L6604) | jQuery(document).ready(function() { |
| [6605](#L6605) |  |
| [6606](#L6606) |  |
| [6607](#L6607) |  |
| [6608](#L6608) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [6609](#L6609) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [6610](#L6610) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [6611](#L6611) | margin:<?php echo $settings ['imageMargin'];?>, |
| [6612](#L6612) | target:'<?php echo $target;?>', |
| [6613](#L6613) | init : function() { }, |
| [6614](#L6614) | loadPicture : function(event, img) {  }, |
| [6615](#L6615) | resize : function(event, gallery) {  }, |
| [6616](#L6616) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [6617](#L6617) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [6618](#L6618) | }); |
| [6619](#L6619) |  |
| [6620](#L6620) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [6621](#L6621) |  |
| [6622](#L6622) | 'overlayColor':'#000000', |
| [6623](#L6623) | 'padding': 3, |
| [6624](#L6624) | 'margin': 20, |
| [6625](#L6625) | 'autoScale': true, |
| [6626](#L6626) | 'autoDimensions':true, |
| [6627](#L6627) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [6628](#L6628) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [6629](#L6629) | 'transitionIn':'fade', |
| [6630](#L6630) | 'transitionOut':'fade', |
| [6631](#L6631) | 'titlePosition': 'outside', |
| [6632](#L6632) | 'cyclic':true, |
| [6633](#L6633) | 'hideOnContentClick':false, |
| [6634](#L6634) | 'width' : 650, |
| [6635](#L6635) | 'height' : 400, |
| [6636](#L6636) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [6637](#L6637) |  |
| [6638](#L6638) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [6639](#L6639) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [6640](#L6640) |  |
| [6641](#L6641) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [6642](#L6642) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [6643](#L6643) | } |
| [6644](#L6644) | else{ |
| [6645](#L6645) | return ''; |
| [6646](#L6646) | } |
| [6647](#L6647) |  |
| [6648](#L6648) | } |
| [6649](#L6649) | }); |
| [6650](#L6650) |  |
| [6651](#L6651) | jQuery(".page-numbers").show(); |
| [6652](#L6652) |  |
| [6653](#L6653) |  |
| [6654](#L6654) | }); |
| [6655](#L6655) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [6656](#L6656) |  |
| [6657](#L6657) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [6658](#L6658) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [6659](#L6659) |  |
| [6660](#L6660) | e.preventDefault(); |
| [6661](#L6661) | var data = { |
| [6662](#L6662) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [6663](#L6663) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [6664](#L6664) | 'grid\_id':0, |
| [6665](#L6665) | 'total\_rec':'<?php echo $total; ?>', |
| [6666](#L6666) | 'vNonce':'<?php echo $vNonce;?>' |
| [6667](#L6667) | }; |
| [6668](#L6668) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [6669](#L6669) |  |
| [6670](#L6670) |  |
| [6671](#L6671) | jQuery('html, body').animate({ |
| [6672](#L6672) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [6673](#L6673) | }, 800); |
| [6674](#L6674) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [6675](#L6675) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [6676](#L6676) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [6677](#L6677) |  |
| [6678](#L6678) |  |
| [6679](#L6679) | }); |
| [6680](#L6680) |  |
| [6681](#L6681) |  |
| [6682](#L6682) |  |
| [6683](#L6683) | }); |
| [6684](#L6684) |  |
| [6685](#L6685) |  |
| [6686](#L6686) |  |
| [6687](#L6687) | </script> |
| [6688](#L6688) |  |
| [6689](#L6689) |  |
| [6690](#L6690) | <?php } ?> |
| [6691](#L6691) | </div> |
| [6692](#L6692) | </div> |
| [6693](#L6693) | <div class="clear"></div> |
| [6694](#L6694) |  |
| [6695](#L6695) | <?php if (is\_array($settings)) { ?> |
| [6696](#L6696) |  |
| [6697](#L6697) | <h3><?php echo \_\_('To print this masonry gallery into WordPress Post/Page use below code','wp-responsive-photo-gallery');?></h3> |
| [6698](#L6698) | <input type="text" value='[print\_masonry\_gallery\_plus\_lightbox ] ' |
| [6699](#L6699) | style="width: 400px; height: 30px" |
| [6700](#L6700) | onclick="this.focus(); this.select()" /> |
| [6701](#L6701) | <div class="clear"></div> |
| [6702](#L6702) | <h3><?php echo \_\_('To print this masonry gallery into WordPress theme/template PHP files use below code','wp-responsive-photo-gallery');?></h3> |
| [6703](#L6703) | <?php |
| [6704](#L6704) | $shortcode = '[print\_masonry\_gallery\_plus\_lightbox ]'; |
| [6705](#L6705) | ?> |
| [6706](#L6706) | <input type="text" value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" style="width: 400px; height: 30px" onclick="this.focus(); this.select()" /> |
| [6707](#L6707) | <?php } ?> |
| [6708](#L6708) | <div class="clear"></div> |
| [6709](#L6709) | <?php |
| [6710](#L6710) | } |
| [6711](#L6711) | function rjg\_remove\_extra\_p\_tags($content){ |
| [6712](#L6712) |  |
| [6713](#L6713) | if(strpos($content, 'rjg\_print\_masonry\_gallery\_plus\_lightbox\_func')!==false){ |
| [6714](#L6714) |  |
| [6715](#L6715) |  |
| [6716](#L6716) | $pattern = "/<!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->(.\*)<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->/Uis"; |
| [6717](#L6717) | $content = preg\_replace\_callback($pattern, function($matches) { |
| [6718](#L6718) |  |
| [6719](#L6719) |  |
| [6720](#L6720) | $altered = str\_replace("<p>","",$matches[1]); |
| [6721](#L6721) | $altered = str\_replace("</p>","",$altered); |
| [6722](#L6722) |  |
| [6723](#L6723) | $altered=str\_replace("&#038;","&",$altered); |
| [6724](#L6724) | $altered=str\_replace("&#8221;",'"',$altered); |
| [6725](#L6725) |  |
| [6726](#L6726) |  |
| [6727](#L6727) | return @str\_replace($matches[1], $altered, $matches[0]); |
| [6728](#L6728) | }, $content); |
| [6729](#L6729) |  |
| [6730](#L6730) |  |
| [6731](#L6731) |  |
| [6732](#L6732) | } |
| [6733](#L6733) |  |
| [6734](#L6734) | $content = str\_replace("<p><!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->","<!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->",$content); |
| [6735](#L6735) | $content = str\_replace("<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --></p>","<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->",$content); |
| [6736](#L6736) |  |
| [6737](#L6737) |  |
| [6738](#L6738) | return $content; |
| [6739](#L6739) | } |
| [6740](#L6740) |  |
| [6741](#L6741) |  |
| [6742](#L6742) | function wrthslider\_slider\_mass\_upload\_wpresponsivephgallery(){ |
| [6743](#L6743) |  |
| [6744](#L6744) | global $wpdb; |
| [6745](#L6745) |  |
| [6746](#L6746) | $uploads = wp\_upload\_dir (); |
| [6747](#L6747) | $baseDir = $uploads ['basedir']; |
| [6748](#L6748) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6749](#L6749) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery/'; |
| [6750](#L6750) |  |
| [6751](#L6751) | if(isset($\_POST) and sizeof($\_POST)>0){ |
| [6752](#L6752) |  |
| [6753](#L6753) | if(!check\_ajax\_referer( 'thumbnail-mass-image','thumbnail\_security' )){ |
| [6754](#L6754) |  |
| [6755](#L6755) | wp\_die('Security check fail'); |
| [6756](#L6756) |  |
| [6757](#L6757) | } |
| [6758](#L6758) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [6759](#L6759) |  |
| [6760](#L6760) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6761](#L6761) |  |
| [6762](#L6762) | } |
| [6763](#L6763) | $createdOn=date('Y-m-d h:i:s'); |
| [6764](#L6764) | if(function\_exists('date\_i18n')){ |
| [6765](#L6765) |  |
| [6766](#L6766) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [6767](#L6767) | if(get\_option('time\_format')=='H:i') |
| [6768](#L6768) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [6769](#L6769) | else |
| [6770](#L6770) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [6771](#L6771) | } |
| [6772](#L6772) | $attachment\_id=(int)$\_POST['attachment\_id']; |
| [6773](#L6773) | $photoMeta = wp\_get\_attachment\_metadata( $attachment\_id ); |
| [6774](#L6774) |  |
| [6775](#L6775) | $open\_link\_in=0; |
| [6776](#L6776) | $enable\_light\_box\_img\_desc=0; |
| [6777](#L6777) | $imageurl=''; |
| [6778](#L6778) | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
| [6779](#L6779) | $enable\_light\_box\_img\_desc=0; |
| [6780](#L6780) |  |
| [6781](#L6781) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [6782](#L6782) |  |
| [6783](#L6783) | $fileName=$photoMeta['file']; |
| [6784](#L6784) | $phyPath=ABSPATH; |
| [6785](#L6785) | $phyPath=str\_replace("\\","/",$phyPath); |
| [6786](#L6786) |  |
| [6787](#L6787) | $pathArray=pathinfo($fileName); |
| [6788](#L6788) |  |
| [6789](#L6789) | $imagename=$pathArray['basename']; |
| [6790](#L6790) | $imagename\_=$pathArray['filename']; |
| [6791](#L6791) | $file\_ext=$pathArray['extension']; |
| [6792](#L6792) | $imagename=$imagename\_.uniqid().".".$file\_ext; |
| [6793](#L6793) | $upload\_dir\_n = wp\_upload\_dir(); |
| [6794](#L6794) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [6795](#L6795) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [6796](#L6796) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [6797](#L6797) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [6798](#L6798) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [6799](#L6799) | $imageUploadTo=$pathToImagesFolder."/".$imagename; |
| [6800](#L6800) | @copy($fileUrl, $imageUploadTo); |
| [6801](#L6801) |  |
| [6802](#L6802) | if(!file\_exists($imageUploadTo)){ |
| [6803](#L6803) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [6804](#L6804) | } |
| [6805](#L6805) |  |
| [6806](#L6806) | } |
| [6807](#L6807) |  |
| [6808](#L6808) |  |
| [6809](#L6809) | $query = "INSERT INTO ".$wpdb->prefix."gv\_responsive\_slider (title, image\_name,createdon) |
| [6810](#L6810) | VALUES ('$title','$imagename','$createdOn')"; |
| [6811](#L6811) |  |
| [6812](#L6812) | $wpdb->query($query); |
| [6813](#L6813) |  |
| [6814](#L6814) |  |
| [6815](#L6815) |  |
| [6816](#L6816) |  |
| [6817](#L6817) | } |
| [6818](#L6818) |  |
| [6819](#L6819) | } |
| [6820](#L6820) |  |
| [6821](#L6821) | function wrthslider\_slider\_mass\_upload\_wpresponsivephgalleryms(){ |
| [6822](#L6822) |  |
| [6823](#L6823) | global $wpdb; |
| [6824](#L6824) |  |
| [6825](#L6825) | $uploads = wp\_upload\_dir (); |
| [6826](#L6826) | $baseDir = $uploads ['basedir']; |
| [6827](#L6827) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6828](#L6828) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery/'; |
| [6829](#L6829) |  |
| [6830](#L6830) | if(isset($\_POST) and sizeof($\_POST)>0){ |
| [6831](#L6831) |  |
| [6832](#L6832) | if(!check\_ajax\_referer( 'thumbnail-mass-image','thumbnail\_security' )){ |
| [6833](#L6833) |  |
| [6834](#L6834) | wp\_die('Security check fail'); |
| [6835](#L6835) |  |
| [6836](#L6836) | } |
| [6837](#L6837) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [6838](#L6838) |  |
| [6839](#L6839) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6840](#L6840) |  |
| [6841](#L6841) | } |
| [6842](#L6842) | $createdOn=date('Y-m-d h:i:s'); |
| [6843](#L6843) | if(function\_exists('date\_i18n')){ |
| [6844](#L6844) |  |
| [6845](#L6845) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [6846](#L6846) | if(get\_option('time\_format')=='H:i') |
| [6847](#L6847) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [6848](#L6848) | else |
| [6849](#L6849) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [6850](#L6850) | } |
| [6851](#L6851) | $attachment\_id=(int)$\_POST['attachment\_id']; |
| [6852](#L6852) | $photoMeta = wp\_get\_attachment\_metadata( $attachment\_id ); |
| [6853](#L6853) |  |
| [6854](#L6854) | $open\_link\_in=0; |
| [6855](#L6855) | $enable\_light\_box\_img\_desc=0; |
| [6856](#L6856) | $imageurl=''; |
| [6857](#L6857) | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
| [6858](#L6858) | $enable\_light\_box\_img\_desc=0; |
| [6859](#L6859) |  |
| [6860](#L6860) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [6861](#L6861) |  |
| [6862](#L6862) | $fileName=$photoMeta['file']; |
| [6863](#L6863) | $phyPath=ABSPATH; |
| [6864](#L6864) | $phyPath=str\_replace("\\","/",$phyPath); |
| [6865](#L6865) |  |
| [6866](#L6866) | $pathArray=pathinfo($fileName); |
| [6867](#L6867) |  |
| [6868](#L6868) | $imagename=$pathArray['basename']; |
| [6869](#L6869) | $imagename\_=$pathArray['filename']; |
| [6870](#L6870) | $file\_ext=$pathArray['extension']; |
| [6871](#L6871) | $imagename=$imagename\_.uniqid().".".$file\_ext; |
| [6872](#L6872) | $upload\_dir\_n = wp\_upload\_dir(); |
| [6873](#L6873) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [6874](#L6874) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [6875](#L6875) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [6876](#L6876) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [6877](#L6877) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [6878](#L6878) | $imageUploadTo=$pathToImagesFolder."/".$imagename; |
| [6879](#L6879) | @copy($fileUrl, $imageUploadTo); |
| [6880](#L6880) |  |
| [6881](#L6881) | if(!file\_exists($imageUploadTo)){ |
| [6882](#L6882) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [6883](#L6883) | } |
| [6884](#L6884) |  |
| [6885](#L6885) | } |
| [6886](#L6886) |  |
| [6887](#L6887) |  |
| [6888](#L6888) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [6889](#L6889) | (media\_type,image\_name,title,murl,open\_link\_in, |
| [6890](#L6890) | HdnMediaSelection,createdon) |
| [6891](#L6891) | VALUES ('image','$imagename','$title','',1,'$fileUrl', '$createdOn')"; |
| [6892](#L6892) |  |
| [6893](#L6893) | $wpdb->query($query); |
| [6894](#L6894) |  |
| [6895](#L6895) |  |
| [6896](#L6896) |  |
| [6897](#L6897) |  |
| [6898](#L6898) | } |
| [6899](#L6899) |  |
| [6900](#L6900) | } |
| [6901](#L6901) |  |
| [6902](#L6902) | add\_filter('widget\_text\_content', 'rjg\_remove\_extra\_p\_tags', 999); |
| [6903](#L6903) | add\_filter('the\_content', 'rjg\_remove\_extra\_p\_tags', 999); |
| [6904](#L6904) |  |
| [6905](#L6905) |  |
| [6906](#L6906) |  |
| [6907](#L6907) | function i13\_rpg\_render\_block\_defaults($block\_content, $block) { |
| [6908](#L6908) |  |
| [6909](#L6909) | $block\_content=wrpg\_remove\_extra\_p\_tags($block\_content); |
| [6910](#L6910) | $block\_content=rjg\_remove\_extra\_p\_tags($block\_content); |
| [6911](#L6911) | return $block\_content; |
| [6912](#L6912) |  |
| [6913](#L6913) | } |
| [6914](#L6914) |  |
| [6915](#L6915) |  |
| [6916](#L6916) | add\_filter( 'render\_block', 'i13\_rpg\_render\_block\_defaults', 10, 2 ); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?format=txt)
* [Original Format](/export/3222443/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_ef5aa871_20250114_185525.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-responsive-photo-gallery%2Ftags%2F1.0.15%2Fwp-responsive-photo-gallery.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-responsive-photo-gallery](/browser/wp-responsive-photo-gallery?order=name "View wp-responsive-photo-gallery")/[tags](/browser/wp-responsive-photo-gallery/tags?order=name "View tags")/[1.0.15](/browser/wp-responsive-photo-gallery/tags/1.0.15?order=name "View 1.0.15")/[wp-responsive-photo-gallery.php](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?order=name "View wp-responsive-photo-gallery.php")

View diff against:

View revision:

| [Last change](/changeset/2968045/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php "View differences") on this file was [2968045](/changeset/2968045/ "View changeset 2968045"), checked in by nik00726, [16 months ago](/timeline?from=2023-09-17T17%3A18%3A25Z&precision=second "See timeline at 09/17/2023 05:18:25 PM") |
| --- |
| * Make plugin compatible with block editor * Tested with [WordPress](/wiki/WordPress) 6.3 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 437.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name:Masonry Tiled Gallery & Photo Gallery Slideshow |
| [4](#L4) | Plugin URI:https://www.i13websolution.com |
| [5](#L5) | Author URI:https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/ |
| [6](#L6) | Description: This is beautiful masonry tiled gallery and photo gallery slideshow plugin for wordPress blogs and sites.Admin can manages any number of images for photo slideshow and unlimited media into the masonry gallery. |
| [7](#L7) | Author:I Thirteen Web Solution |
| [8](#L8) | Version:1.0.15 |
| [9](#L9) | Text Domain:wp-responsive-photo-gallery |
| [10](#L10) | Domain Path: /languages |
| [11](#L11) | \*/ |
| [12](#L12) | //error\_reporting(0); |
| [13](#L13) |  |
| [14](#L14) | if ( ! defined( 'ABSPATH' ) ) exit; |
| [15](#L15) |  |
| [16](#L16) | $dir = plugin\_dir\_path( \_\_FILE\_\_ ); |
| [17](#L17) | $dir=str\_replace("\\","/",$dir); |
| [18](#L18) | if(!class\_exists('resize')){ |
| [19](#L19) |  |
| [20](#L20) | require\_once($dir.'classes/class.Images.php'); |
| [21](#L21) | } |
| [22](#L22) |  |
| [23](#L23) | add\_action('admin\_menu', 'add\_my\_responsive\_photo\_gallery\_admin\_menu'); |
| [24](#L24) | //add\_action( 'admin\_init', 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [25](#L25) | register\_activation\_hook(\_\_FILE\_\_,'install\_my\_responsive\_photo\_gallery'); |
| [26](#L26) | register\_deactivation\_hook(\_\_FILE\_\_,'rsp\_responsive\_photo\_gallery\_remove\_access\_capabilities'); |
| [27](#L27) | add\_action('wp\_enqueue\_scripts', 'my\_responsive\_photo\_gallery\_load\_styles\_and\_js'); |
| [28](#L28) | add\_shortcode('print\_my\_responsive\_photo\_gallery', 'print\_my\_responsive\_photo\_gallery\_func' ); |
| [29](#L29) | add\_filter('widget\_text', 'do\_shortcode'); |
| [30](#L30) | add\_action ( 'admin\_notices', 'wp\_responsive\_photo\_gallery\_admin\_notices' ); |
| [31](#L31) | add\_action('plugins\_loaded', 'rsp\_responsive\_photo\_gallery\_load\_lang'); |
| [32](#L32) |  |
| [33](#L33) | add\_action( 'wp\_ajax\_rjg\_check\_file\_exist\_justified\_gallery', 'rjg\_check\_file\_exist\_justified\_gallery\_callback' ); |
| [34](#L34) | add\_action( 'wp\_ajax\_rjg\_get\_youtube\_info\_justified\_gallery', 'rjg\_get\_youtube\_info\_justified\_gallery\_callback' ); |
| [35](#L35) | add\_action( 'wp\_ajax\_rjg\_get\_metacafe\_info\_justified\_gallery', 'rjg\_get\_metacafe\_info\_justified\_gallery\_callback' ); |
| [36](#L36) |  |
| [37](#L37) | add\_action('wp\_ajax\_rjg\_get\_grid\_data\_justified\_gallery', 'rjg\_get\_grid\_data\_justified\_gallery\_callback'); |
| [38](#L38) | add\_action('wp\_ajax\_nopriv\_rjg\_get\_grid\_data\_justified\_gallery', 'rjg\_get\_grid\_data\_justified\_gallery\_callback'); |
| [39](#L39) | add\_shortcode ( 'print\_masonry\_gallery\_plus\_lightbox', 'rjg\_print\_masonry\_gallery\_plus\_lightbox\_func' ); |
| [40](#L40) | add\_filter( 'user\_has\_cap', 'rsp\_responsive\_photo\_gallery\_admin\_cap\_list' , 10, 4 ); |
| [41](#L41) | add\_action( 'wp\_ajax\_mass\_upload\_wpresponsivephgallery', 'wrthslider\_slider\_mass\_upload\_wpresponsivephgallery' ); |
| [42](#L42) | add\_action( 'wp\_ajax\_mass\_upload\_wpresponsivephgalleryms', 'wrthslider\_slider\_mass\_upload\_wpresponsivephgalleryms' ); |
| [43](#L43) |  |
| [44](#L44) | function rsp\_responsive\_photo\_gallery\_load\_lang() { |
| [45](#L45) |  |
| [46](#L46) | load\_plugin\_textdomain( 'wp-responsive-photo-gallery', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [47](#L47) | add\_filter( 'map\_meta\_cap',  'map\_rsp\_responsive\_photo\_gallery\_meta\_caps', 10, 4 ); |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | function rs\_photogallery\_save\_image\_remote\_lbox($url,$saveto){ |
| [51](#L51) |  |
| [52](#L52) | $raw = wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [53](#L53) |  |
| [54](#L54) | if(file\_exists($saveto)){ |
| [55](#L55) | @unlink($saveto); |
| [56](#L56) | } |
| [57](#L57) | $fp = @fopen($saveto,'x'); |
| [58](#L58) | @fwrite($fp, $raw); |
| [59](#L59) | @fclose($fp); |
| [60](#L60) | } |
| [61](#L61) | function map\_rsp\_responsive\_photo\_gallery\_meta\_caps( array $caps, $cap, $user\_id, array $args  ) { |
| [62](#L62) |  |
| [63](#L63) |  |
| [64](#L64) | if ( ! in\_array( $cap, array( |
| [65](#L65) | 'rsp\_responsive\_photo\_gallery\_slideshow\_settings', |
| [66](#L66) | 'rsp\_responsive\_photo\_gallery\_view\_images', |
| [67](#L67) | 'rsp\_responsive\_photo\_gallery\_add\_image', |
| [68](#L68) | 'rsp\_responsive\_photo\_gallery\_edit\_image', |
| [69](#L69) | 'rsp\_responsive\_photo\_gallery\_delete\_image', |
| [70](#L70) | 'rsp\_responsive\_photo\_gallery\_preview', |
| [71](#L71) | 'rsp\_masonry\_gallery\_settings', |
| [72](#L72) | 'rsp\_masonry\_gallery\_view\_media', |
| [73](#L73) | 'rsp\_masonry\_gallery\_add\_media', |
| [74](#L74) | 'rsp\_masonry\_gallery\_edit\_media', |
| [75](#L75) | 'rsp\_masonry\_gallery\_delete\_media', |
| [76](#L76) | 'rsp\_masonry\_gallery\_preview', |
| [77](#L77) |  |
| [78](#L78) | ), true ) ) { |
| [79](#L79) |  |
| [80](#L80) | return $caps; |
| [81](#L81) | } |
| [82](#L82) |  |
| [83](#L83) |  |
| [84](#L84) |  |
| [85](#L85) |  |
| [86](#L86) | $caps = array(); |
| [87](#L87) |  |
| [88](#L88) | switch ( $cap ) { |
| [89](#L89) |  |
| [90](#L90) | case 'rsp\_responsive\_photo\_gallery\_slideshow\_settings': |
| [91](#L91) | $caps[] = 'rsp\_responsive\_photo\_gallery\_slideshow\_settings'; |
| [92](#L92) | break; |
| [93](#L93) |  |
| [94](#L94) | case 'rsp\_responsive\_photo\_gallery\_view\_images': |
| [95](#L95) | $caps[] = 'rsp\_responsive\_photo\_gallery\_view\_images'; |
| [96](#L96) | break; |
| [97](#L97) |  |
| [98](#L98) | case 'rsp\_responsive\_photo\_gallery\_add\_image': |
| [99](#L99) | $caps[] = 'rsp\_responsive\_photo\_gallery\_add\_image'; |
| [100](#L100) | break; |
| [101](#L101) |  |
| [102](#L102) | case 'rsp\_responsive\_photo\_gallery\_edit\_image': |
| [103](#L103) | $caps[] = 'rsp\_responsive\_photo\_gallery\_edit\_image'; |
| [104](#L104) | break; |
| [105](#L105) |  |
| [106](#L106) | case 'rsp\_responsive\_photo\_gallery\_delete\_image': |
| [107](#L107) | $caps[] = 'rsp\_responsive\_photo\_gallery\_delete\_image'; |
| [108](#L108) | break; |
| [109](#L109) |  |
| [110](#L110) | case 'rsp\_responsive\_photo\_gallery\_preview': |
| [111](#L111) | $caps[] = 'rsp\_responsive\_photo\_gallery\_preview'; |
| [112](#L112) | break; |
| [113](#L113) |  |
| [114](#L114) | case 'rsp\_masonry\_gallery\_settings': |
| [115](#L115) | $caps[] = 'rsp\_masonry\_gallery\_settings'; |
| [116](#L116) | break; |
| [117](#L117) |  |
| [118](#L118) | case 'rsp\_masonry\_gallery\_view\_media': |
| [119](#L119) | $caps[] = 'rsp\_masonry\_gallery\_view\_media'; |
| [120](#L120) | break; |
| [121](#L121) |  |
| [122](#L122) | case 'rsp\_masonry\_gallery\_add\_media': |
| [123](#L123) | $caps[] = 'rsp\_masonry\_gallery\_add\_media'; |
| [124](#L124) | break; |
| [125](#L125) |  |
| [126](#L126) | case 'rsp\_masonry\_gallery\_edit\_media': |
| [127](#L127) | $caps[] = 'rsp\_masonry\_gallery\_edit\_media'; |
| [128](#L128) | break; |
| [129](#L129) |  |
| [130](#L130) | case 'rsp\_masonry\_gallery\_delete\_media': |
| [131](#L131) | $caps[] = 'rsp\_masonry\_gallery\_delete\_media'; |
| [132](#L132) | break; |
| [133](#L133) | case 'rsp\_masonry\_gallery\_preview': |
| [134](#L134) | $caps[] = 'rsp\_masonry\_gallery\_preview'; |
| [135](#L135) | break; |
| [136](#L136) |  |
| [137](#L137) | default: |
| [138](#L138) |  |
| [139](#L139) | $caps[] = 'do\_not\_allow'; |
| [140](#L140) | break; |
| [141](#L141) | } |
| [142](#L142) |  |
| [143](#L143) |  |
| [144](#L144) | return apply\_filters( 'rsp\_responsive\_photo\_gallery\_meta\_caps', $caps, $cap, $user\_id, $args ); |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) |  |
| [148](#L148) | function rsp\_responsive\_photo\_gallery\_admin\_cap\_list($allcaps, $caps, $args, $user){ |
| [149](#L149) |  |
| [150](#L150) |  |
| [151](#L151) | if ( ! in\_array( 'administrator', $user->roles ) ) { |
| [152](#L152) |  |
| [153](#L153) | return $allcaps; |
| [154](#L154) | } |
| [155](#L155) | else{ |
| [156](#L156) |  |
| [157](#L157) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_slideshow\_settings'])){ |
| [158](#L158) |  |
| [159](#L159) | $allcaps['rsp\_responsive\_photo\_gallery\_slideshow\_settings']=true; |
| [160](#L160) | } |
| [161](#L161) |  |
| [162](#L162) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_view\_images'])){ |
| [163](#L163) |  |
| [164](#L164) | $allcaps['rsp\_responsive\_photo\_gallery\_view\_images']=true; |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_add\_image'])){ |
| [168](#L168) |  |
| [169](#L169) | $allcaps['rsp\_responsive\_photo\_gallery\_add\_image']=true; |
| [170](#L170) | } |
| [171](#L171) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_edit\_image'])){ |
| [172](#L172) |  |
| [173](#L173) | $allcaps['rsp\_responsive\_photo\_gallery\_edit\_image']=true; |
| [174](#L174) | } |
| [175](#L175) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_delete\_image'])){ |
| [176](#L176) |  |
| [177](#L177) | $allcaps['rsp\_responsive\_photo\_gallery\_delete\_image']=true; |
| [178](#L178) | } |
| [179](#L179) | if(!isset($allcaps['rsp\_responsive\_photo\_gallery\_preview'])){ |
| [180](#L180) |  |
| [181](#L181) | $allcaps['rsp\_responsive\_photo\_gallery\_preview']=true; |
| [182](#L182) | } |
| [183](#L183) | if(!isset($allcaps['rsp\_masonry\_gallery\_settings'])){ |
| [184](#L184) |  |
| [185](#L185) | $allcaps['rsp\_masonry\_gallery\_settings']=true; |
| [186](#L186) | } |
| [187](#L187) | if(!isset($allcaps['rsp\_masonry\_gallery\_view\_media'])){ |
| [188](#L188) |  |
| [189](#L189) | $allcaps['rsp\_masonry\_gallery\_view\_media']=true; |
| [190](#L190) | } |
| [191](#L191) | if(!isset($allcaps['rsp\_masonry\_gallery\_add\_media'])){ |
| [192](#L192) |  |
| [193](#L193) | $allcaps['rsp\_masonry\_gallery\_add\_media']=true; |
| [194](#L194) | } |
| [195](#L195) | if(!isset($allcaps['rsp\_masonry\_gallery\_edit\_media'])){ |
| [196](#L196) |  |
| [197](#L197) | $allcaps['rsp\_masonry\_gallery\_edit\_media']=true; |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | if(!isset($allcaps['rsp\_masonry\_gallery\_delete\_media'])){ |
| [201](#L201) |  |
| [202](#L202) | $allcaps['rsp\_masonry\_gallery\_delete\_media']=true; |
| [203](#L203) | } |
| [204](#L204) | if(!isset($allcaps['rsp\_masonry\_gallery\_preview'])){ |
| [205](#L205) |  |
| [206](#L206) | $allcaps['rsp\_masonry\_gallery\_preview']=true; |
| [207](#L207) | } |
| [208](#L208) |  |
| [209](#L209) | } |
| [210](#L210) |  |
| [211](#L211) | return $allcaps; |
| [212](#L212) |  |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | function  rsp\_responsive\_photo\_gallery\_add\_access\_capabilities() { |
| [216](#L216) |  |
| [217](#L217) | // Capabilities for all roles. |
| [218](#L218) | $roles = array( 'administrator' ); |
| [219](#L219) | foreach ( $roles as $role ) { |
| [220](#L220) |  |
| [221](#L221) | $role = get\_role( $role ); |
| [222](#L222) | if ( empty( $role ) ) { |
| [223](#L223) | continue; |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) |  |
| [227](#L227) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ) ){ |
| [228](#L228) |  |
| [229](#L229) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ); |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ) ){ |
| [233](#L233) |  |
| [234](#L234) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ); |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) |  |
| [238](#L238) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ){ |
| [239](#L239) |  |
| [240](#L240) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ); |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ){ |
| [244](#L244) |  |
| [245](#L245) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ); |
| [246](#L246) | } |
| [247](#L247) |  |
| [248](#L248) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ){ |
| [249](#L249) |  |
| [250](#L250) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ); |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | if(!$role->has\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ) ){ |
| [254](#L254) |  |
| [255](#L255) | $role->add\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ); |
| [256](#L256) | } |
| [257](#L257) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_settings' ) ){ |
| [258](#L258) |  |
| [259](#L259) | $role->add\_cap( 'rsp\_masonry\_gallery\_settings' ); |
| [260](#L260) | } |
| [261](#L261) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_view\_media' ) ){ |
| [262](#L262) |  |
| [263](#L263) | $role->add\_cap( 'rsp\_masonry\_gallery\_view\_media' ); |
| [264](#L264) | } |
| [265](#L265) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_add\_media' ) ){ |
| [266](#L266) |  |
| [267](#L267) | $role->add\_cap( 'rsp\_masonry\_gallery\_add\_media' ); |
| [268](#L268) | } |
| [269](#L269) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_edit\_media' ) ){ |
| [270](#L270) |  |
| [271](#L271) | $role->add\_cap( 'rsp\_masonry\_gallery\_edit\_media' ); |
| [272](#L272) | } |
| [273](#L273) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_delete\_media' ) ){ |
| [274](#L274) |  |
| [275](#L275) | $role->add\_cap( 'rsp\_masonry\_gallery\_delete\_media' ); |
| [276](#L276) | } |
| [277](#L277) | if(!$role->has\_cap( 'rsp\_masonry\_gallery\_preview' ) ){ |
| [278](#L278) |  |
| [279](#L279) | $role->add\_cap( 'rsp\_masonry\_gallery\_preview' ); |
| [280](#L280) | } |
| [281](#L281) |  |
| [282](#L282) |  |
| [283](#L283) | } |
| [284](#L284) |  |
| [285](#L285) | $user = wp\_get\_current\_user(); |
| [286](#L286) | $user->get\_role\_caps(); |
| [287](#L287) |  |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | function rsp\_responsive\_photo\_gallery\_remove\_access\_capabilities(){ |
| [291](#L291) |  |
| [292](#L292) | global $wp\_roles; |
| [293](#L293) |  |
| [294](#L294) | if ( ! isset( $wp\_roles ) ) { |
| [295](#L295) | $wp\_roles = new WP\_Roles(); |
| [296](#L296) | } |
| [297](#L297) |  |
| [298](#L298) | foreach ( $wp\_roles->roles as $role => $details ) { |
| [299](#L299) | $role = $wp\_roles->get\_role( $role ); |
| [300](#L300) | if ( empty( $role ) ) { |
| [301](#L301) | continue; |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ); |
| [305](#L305) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_view\_images' ); |
| [306](#L306) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_add\_image' ); |
| [307](#L307) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_edit\_image' ); |
| [308](#L308) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_delete\_image' ); |
| [309](#L309) | $role->remove\_cap( 'rsp\_responsive\_photo\_gallery\_preview' ); |
| [310](#L310) | $role->remove\_cap( 'rsp\_masonry\_gallery\_settings' ); |
| [311](#L311) | $role->remove\_cap( 'rsp\_masonry\_gallery\_view\_media' ); |
| [312](#L312) | $role->remove\_cap( 'rsp\_masonry\_gallery\_add\_media' ); |
| [313](#L313) | $role->remove\_cap( 'rsp\_masonry\_gallery\_edit\_media' ); |
| [314](#L314) | $role->remove\_cap( 'rsp\_masonry\_gallery\_delete\_media' ); |
| [315](#L315) | $role->remove\_cap( 'rsp\_masonry\_gallery\_preview' ); |
| [316](#L316) |  |
| [317](#L317) |  |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) | // Refresh current set of capabilities of the user, to be able to directly use the new caps. |
| [321](#L321) | $user = wp\_get\_current\_user(); |
| [322](#L322) | $user->get\_role\_caps(); |
| [323](#L323) |  |
| [324](#L324) | } |
| [325](#L325) |  |
| [326](#L326) | function my\_responsive\_photo\_gallery\_load\_styles\_and\_js(){ |
| [327](#L327) |  |
| [328](#L328) | if (! is\_admin ()) { |
| [329](#L329) |  |
| [330](#L330) |  |
| [331](#L331) |  |
| [332](#L332) | wp\_register\_style( 'jquery.galleryview-3.0-dev-responsive', plugins\_url('/css/jquery.galleryview-3.0-dev-responsive.css', \_\_FILE\_\_) ); |
| [333](#L333) | wp\_register\_script('jquery.timers-1.2',plugins\_url('/js/jquery.timers-1.2.js', \_\_FILE\_\_),array('jquery'),'1.0.8'); |
| [334](#L334) | wp\_register\_script('jquery.easing.1.3',plugins\_url('/js/jquery.easing.1.3.js', \_\_FILE\_\_),array('jquery'),'1.0.8'); |
| [335](#L335) | wp\_register\_script('jquery.gview-3.0-dev-responsive',plugins\_url('/js/jquery.gview-3.0-dev-responsive.js', \_\_FILE\_\_),array('jquery'),'1.0.11'); |
| [336](#L336) |  |
| [337](#L337) | wp\_register\_style ( 'rjg-lbox', plugins\_url ( '/css/rjg-lbox.css', \_\_FILE\_\_ ) ,array(),'1.0.11'); |
| [338](#L338) | wp\_register\_style ( 'rjg-justified-gallery', plugins\_url ( '/css/rjg-justified-gallery.css', \_\_FILE\_\_ ) ); |
| [339](#L339) | wp\_register\_script ( 'rjg-justified-gallery', plugins\_url ( '/js/rjg-justified-gallery.js', \_\_FILE\_\_ ),array('jquery'),'1.0.8' ); |
| [340](#L340) | wp\_register\_script ( 'rjg-lbox-js', plugins\_url ( '/js/rjg-lbox-js.js', \_\_FILE\_\_ ),array('jquery'),'1.0.11' ); |
| [341](#L341) |  |
| [342](#L342) |  |
| [343](#L343) | } |
| [344](#L344) |  |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | function install\_my\_responsive\_photo\_gallery(){ |
| [348](#L348) |  |
| [349](#L349) | global $wpdb; |
| [350](#L350) | $table\_name = $wpdb->prefix . "gv\_responsive\_slider"; |
| [351](#L351) | $table\_nameg\_rjg = $wpdb->prefix . "rjg\_gallery"; |
| [352](#L352) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [353](#L353) |  |
| [354](#L354) | $sql = "CREATE TABLE " . $table\_name . " ( |
| [355](#L355) | id int(10) unsigned NOT NULL auto\_increment, |
| [356](#L356) | title varchar(1000) NOT NULL, |
| [357](#L357) | image\_name varchar(500) NOT NULL, |
| [358](#L358) | createdon datetime NOT NULL, |
| [359](#L359) | custom\_link varchar(1000) default NULL, |
| [360](#L360) | post\_id int(10) unsigned default NULL, |
| [361](#L361) | PRIMARY KEY  (id) |
| [362](#L362) | ) $charset\_collate; " |
| [363](#L363) | . "CREATE TABLE " . $table\_nameg\_rjg . " ( |
| [364](#L364) | `id` int(11) NOT NULL AUTO\_INCREMENT, |
| [365](#L365) | `media\_type` varchar(10) NOT NULL, |
| [366](#L366) | `image\_name` varchar(500) NOT NULL, |
| [367](#L367) | `title` varchar(500) NOT NULL, |
| [368](#L368) | `murl` varchar(2000) DEFAULT NULL, |
| [369](#L369) | `open\_link\_in` tinyint(1) NOT NULL DEFAULT '0', |
| [370](#L370) | `vtype` varchar(50) DEFAULT NULL, |
| [371](#L371) | `vid` varchar(300) DEFAULT NULL, |
| [372](#L372) | `videourl` varchar(1000) DEFAULT NULL, |
| [373](#L373) | `embed\_url` varchar(300) DEFAULT NULL, |
| [374](#L374) | `HdnMediaSelection` varchar(300) NOT NULL, |
| [375](#L375) | `createdon` datetime NOT NULL, |
| [376](#L376) | `slider\_id` int(11) NOT NULL DEFAULT '1', |
| [377](#L377) | PRIMARY KEY (`id`) |
| [378](#L378) | ) $charset\_collate;"; |
| [379](#L379) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [380](#L380) | dbDelta($sql); |
| [381](#L381) |  |
| [382](#L382) |  |
| [383](#L383) | $my\_responsive\_photo\_gallery\_slider\_settings=array('transition\_speed' => '1000', |
| [384](#L384) | 'transition\_interval' => '4000', |
| [385](#L385) | 'show\_panels' =>'1', |
| [386](#L386) | 'show\_panel\_nav' =>'1', |
| [387](#L387) | 'enable\_overlays' => '0', |
| [388](#L388) | 'panel\_width'=>'550', |
| [389](#L389) | 'panel\_height' => '400', |
| [390](#L390) | 'panel\_animation' => 'fade', |
| [391](#L391) | 'panel\_scale' => 'crop', |
| [392](#L392) | 'overlay\_position'=> 'bottom', |
| [393](#L393) | 'pan\_images' => '1', |
| [394](#L394) | 'pan\_style'=>'drag', |
| [395](#L395) | 'start\_frame'=>'1', |
| [396](#L396) | 'show\_filmstrip'=>'1', |
| [397](#L397) | 'show\_filmstrip\_nav'=>'0', |
| [398](#L398) | 'enable\_slideshow'=>'1', |
| [399](#L399) | 'autoplay'=>'1', |
| [400](#L400) | 'filmstrip\_position'=>'bottom', |
| [401](#L401) | 'frame\_width'=>80, |
| [402](#L402) | 'frame\_height'=>80, |
| [403](#L403) | 'frame\_opacity'=>0.4, |
| [404](#L404) | 'frame\_scale'=>'crop', |
| [405](#L405) | 'filmstrip\_style'=>'scroll', |
| [406](#L406) | 'frame\_gap'=>1, |
| [407](#L407) | 'show\_captions'=>0, |
| [408](#L408) | 'show\_infobar'=>0, |
| [409](#L409) | 'infobar\_opacity'=>1 |
| [410](#L410) | ); |
| [411](#L411) |  |
| [412](#L412) | if( !get\_option( 'my\_responsive\_photo\_gallery\_slider\_settings' ) ) { |
| [413](#L413) |  |
| [414](#L414) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings',$my\_responsive\_photo\_gallery\_slider\_settings); |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | $rjg\_settings=array( |
| [418](#L418) |  |
| [419](#L419) | 'BackgroundColor'=>'#FFFFFF', |
| [420](#L420) | 'imageheight'=>160, |
| [421](#L421) | 'imageMargin'=>5, |
| [422](#L422) | 'page\_size'=>50, |
| [423](#L423) | 'show\_hover\_caption'=>1, |
| [424](#L424) | 'show\_hover\_icon'=>1 |
| [425](#L425) |  |
| [426](#L426) | ); |
| [427](#L427) |  |
| [428](#L428) | if( !get\_option( 'rjg\_settings' ) ) { |
| [429](#L429) |  |
| [430](#L430) | update\_option('rjg\_settings',$rjg\_settings); |
| [431](#L431) | } |
| [432](#L432) |  |
| [433](#L433) |  |
| [434](#L434) | $uploads = wp\_upload\_dir (); |
| [435](#L435) | $baseDir = $uploads ['basedir']; |
| [436](#L436) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [437](#L437) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [438](#L438) | wp\_mkdir\_p ( $pathToImagesFolder ); |
| [439](#L439) | rsp\_responsive\_photo\_gallery\_add\_access\_capabilities(); |
| [440](#L440) |  |
| [441](#L441) | } |
| [442](#L442) |  |
| [443](#L443) |  |
| [444](#L444) | function rjg\_do\_upgrade\_if\_not\_done(){ |
| [445](#L445) |  |
| [446](#L446) |  |
| [447](#L447) | global $wpdb; |
| [448](#L448) | $table\_nameg\_rjg = $wpdb->prefix . "rjg\_gallery"; |
| [449](#L449) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [450](#L450) |  |
| [451](#L451) |  |
| [452](#L452) | if($wpdb->get\_var("SHOW TABLES LIKE '$table\_nameg\_rjg'") != $table\_nameg\_rjg) { |
| [453](#L453) |  |
| [454](#L454) | $sql = "CREATE TABLE " . $table\_nameg\_rjg . " ( |
| [455](#L455) | `id` int(11) NOT NULL AUTO\_INCREMENT, |
| [456](#L456) | `media\_type` varchar(10) NOT NULL, |
| [457](#L457) | `image\_name` varchar(500) NOT NULL, |
| [458](#L458) | `title` varchar(500) NOT NULL, |
| [459](#L459) | `murl` varchar(2000) DEFAULT NULL, |
| [460](#L460) | `open\_link\_in` tinyint(1) NOT NULL DEFAULT '0', |
| [461](#L461) | `vtype` varchar(50) DEFAULT NULL, |
| [462](#L462) | `vid` varchar(300) DEFAULT NULL, |
| [463](#L463) | `videourl` varchar(1000) DEFAULT NULL, |
| [464](#L464) | `embed\_url` varchar(300) DEFAULT NULL, |
| [465](#L465) | `HdnMediaSelection` varchar(300) NOT NULL, |
| [466](#L466) | `createdon` datetime NOT NULL, |
| [467](#L467) | `slider\_id` int(11) NOT NULL DEFAULT '1', |
| [468](#L468) | PRIMARY KEY (`id`) |
| [469](#L469) | ) $charset\_collate;"; |
| [470](#L470) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [471](#L471) | dbDelta($sql); |
| [472](#L472) | } |
| [473](#L473) | $rjg\_settings=array( |
| [474](#L474) |  |
| [475](#L475) | 'BackgroundColor'=>'#FFFFFF', |
| [476](#L476) | 'imageheight'=>160, |
| [477](#L477) | 'imageMargin'=>5, |
| [478](#L478) | 'page\_size'=>50, |
| [479](#L479) | 'show\_hover\_caption'=>1, |
| [480](#L480) | 'show\_hover\_icon'=>1 |
| [481](#L481) |  |
| [482](#L482) | ); |
| [483](#L483) |  |
| [484](#L484) | if( !get\_option( 'rjg\_settings' ) ) { |
| [485](#L485) |  |
| [486](#L486) | update\_option('rjg\_settings',$rjg\_settings); |
| [487](#L487) | } |
| [488](#L488) |  |
| [489](#L489) |  |
| [490](#L490) | } |
| [491](#L491) |  |
| [492](#L492) | function wp\_responsive\_photo\_gallery\_admin\_notices(){ |
| [493](#L493) |  |
| [494](#L494) | if (is\_plugin\_active('wp-responsive-photo-gallery/wp-responsive-photo-gallery.php')) { |
| [495](#L495) |  |
| [496](#L496) | $uploads = wp\_upload\_dir(); |
| [497](#L497) | $baseDir=$uploads['basedir']; |
| [498](#L498) | $baseDir=str\_replace("\\","/",$baseDir); |
| [499](#L499) | $pathToImagesFolder=$baseDir.'/wp-responsive-photo-gallery'; |
| [500](#L500) |  |
| [501](#L501) | if(file\_exists($pathToImagesFolder) and is\_dir($pathToImagesFolder)){ |
| [502](#L502) |  |
| [503](#L503) | if( !is\_writable($pathToImagesFolder)){ |
| [504](#L504) |  |
| [505](#L505) | echo "<div class='updated'><p>".\_\_( 'Photo Gallery Plugin is active but does not have write permission on','wp-responsive-photo-gallery')."</p><p><b>" . $pathToImagesFolder . "</b>".\_\_( ' directory.Please allow write permission.','wp-responsive-photo-gallery')."</p></div> "; |
| [506](#L506) |  |
| [507](#L507) | } |
| [508](#L508) | } |
| [509](#L509) | else{ |
| [510](#L510) |  |
| [511](#L511) | wp\_mkdir\_p($pathToImagesFolder); |
| [512](#L512) | if(!file\_exists($pathToImagesFolder) and !is\_dir($pathToImagesFolder)){ |
| [513](#L513) |  |
| [514](#L514) | echo "<div class='updated'><p>".\_\_( 'Photo Gallery Plugin is active but plugin does not have permission to create directory','wp-responsive-photo-gallery')."</p><p><b>" . $pathToImagesFolder . "</b> ".\_\_( '.Please create post-slider-carousel directory inside upload directory and allow write permission.','wp-responsive-photo-gallery')."</p></div> "; |
| [515](#L515) |  |
| [516](#L516) | } |
| [517](#L517) | } |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | function add\_my\_responsive\_photo\_gallery\_admin\_menu(){ |
| [523](#L523) |  |
| [524](#L524) |  |
| [525](#L525) |  |
| [526](#L526) | $hook\_suffix\_r\_p=add\_menu\_page( \_\_( 'Photo Slideshow & Masonry Gallery','wp-responsive-photo-gallery'), \_\_( 'Photo Slideshow & Masonry Gallery','wp-responsive-photo-gallery' ), 'rsp\_responsive\_photo\_gallery\_slideshow\_settings', 'responsive\_photo\_gallery\_slider', 'responsive\_photo\_gallery\_slider\_admin\_options' ); |
| [527](#L527) | $hook\_suffix\_r\_p=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Settings','wp-responsive-photo-gallery'), \_\_( 'Slideshow Settings','wp-responsive-photo-gallery' ),'rsp\_responsive\_photo\_gallery\_slideshow\_settings', 'responsive\_photo\_gallery\_slider', 'responsive\_photo\_gallery\_slider\_admin\_options' ); |
| [528](#L528) | $hook\_suffix\_r\_p\_1=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Images','wp-responsive-photo-gallery'), \_\_( 'Slideshow Images','wp-responsive-photo-gallery'),'rsp\_responsive\_photo\_gallery\_view\_images', 'responsive\_photo\_gallery\_image\_management', 'responsive\_photo\_gallery\_image\_management' ); |
| [529](#L529) | $hook\_suffix\_r\_p\_2=add\_submenu\_page( 'responsive\_photo\_gallery\_slider', \_\_( 'Slideshow Preview','wp-responsive-photo-gallery'), \_\_( 'Slideshow Preview','wp-responsive-photo-gallery'),'rsp\_responsive\_photo\_gallery\_preview', 'responsive\_photo\_galleryrsp\_responsive\_photo\_gallery\_preview\_slider\_preview', 'responsive\_photo\_gallery\_slider\_admin\_preview' ); |
| [530](#L530) |  |
| [531](#L531) | $hook\_suffix=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Settings','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Settings','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_settings', 'responsive\_justified\_gallery\_with\_lightbox', 'rjg\_responsive\_justified\_gallery\_with\_lightbox\_admin\_options\_func' ); |
| [532](#L532) | $hook\_suffix\_image=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Media','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Media','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_view\_media', 'responsive\_justified\_gallery\_with\_lightbox\_media\_management', 'rjg\_responsive\_justified\_gallery\_with\_lightbox\_media\_management\_func' ); |
| [533](#L533) | $hook\_suffix\_prev=add\_submenu\_page ( 'responsive\_photo\_gallery\_slider', \_\_ ( 'Masonry Gallery Preview','wp-responsive-photo-gallery' ), \_\_ ( 'Masonry Gallery Preview','wp-responsive-photo-gallery' ), 'rsp\_masonry\_gallery\_preview', 'responsive\_justified\_gallery\_with\_lightbox\_media\_preview', 'rfp\_responsive\_justified\_gallery\_with\_lightbox\_media\_preview\_func' ); |
| [534](#L534) |  |
| [535](#L535) | add\_action( 'load-' . $hook\_suffix , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [536](#L536) | add\_action( 'load-' . $hook\_suffix\_image , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [537](#L537) | add\_action( 'load-' . $hook\_suffix\_prev , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [538](#L538) |  |
| [539](#L539) |  |
| [540](#L540) | add\_action( 'load-' . $hook\_suffix\_r\_p , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [541](#L541) | add\_action( 'load-' . $hook\_suffix\_r\_p\_1 , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [542](#L542) | add\_action( 'load-' . $hook\_suffix\_r\_p\_2 , 'my\_responsive\_photo\_gallery\_admin\_init' ); |
| [543](#L543) |  |
| [544](#L544) |  |
| [545](#L545) |  |
| [546](#L546) |  |
| [547](#L547) |  |
| [548](#L548) | } |
| [549](#L549) |  |
| [550](#L550) | function my\_responsive\_photo\_gallery\_admin\_init(){ |
| [551](#L551) |  |
| [552](#L552) |  |
| [553](#L553) |  |
| [554](#L554) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [555](#L555) |  |
| [556](#L556) | wp\_enqueue\_style( 'admin-css-responsive', plugins\_url('/css/admin-css-responsive.css', \_\_FILE\_\_) ); |
| [557](#L557) | wp\_enqueue\_style( 'jquery.galleryview-3.0-dev-responsive', plugins\_url('/css/jquery.galleryview-3.0-dev-responsive.css', \_\_FILE\_\_) ); |
| [558](#L558) | wp\_enqueue\_style ( 'rjg-lbox', plugins\_url ( '/css/rjg-lbox.css', \_\_FILE\_\_ ) ); |
| [559](#L559) | wp\_enqueue\_style ( 'rjg-justified-gallery', plugins\_url ( '/css/rjg-justified-gallery.css', \_\_FILE\_\_ ) ); |
| [560](#L560) |  |
| [561](#L561) | wp\_enqueue\_script('jquery'); |
| [562](#L562) | wp\_enqueue\_script("jquery-ui-core"); |
| [563](#L563) | wp\_enqueue\_script('jquery.timers-1.2',plugins\_url('/js/jquery.timers-1.2.js', \_\_FILE\_\_)); |
| [564](#L564) | wp\_enqueue\_script('jquery.easing.1.3',plugins\_url('/js/jquery.easing.1.3.js', \_\_FILE\_\_)); |
| [565](#L565) | wp\_enqueue\_script('jquery.gview-3.0-dev-responsive',plugins\_url('/js/jquery.gview-3.0-dev-responsive.js', \_\_FILE\_\_)); |
| [566](#L566) | wp\_enqueue\_script('jquery.validate',plugins\_url('/js/jquery.validate.js', \_\_FILE\_\_)); |
| [567](#L567) | wp\_enqueue\_script ( 'rjg-justified-gallery', plugins\_url ( '/js/rjg-justified-gallery.js', \_\_FILE\_\_ ) ); |
| [568](#L568) | wp\_enqueue\_script ( 'rjg-lbox-js', plugins\_url ( '/js/rjg-lbox-js.js', \_\_FILE\_\_ ) ); |
| [569](#L569) |  |
| [570](#L570) |  |
| [571](#L571) | rjg\_responsive\_justified\_gallery\_plus\_lightbox\_admin\_scripts\_init(); |
| [572](#L572) | //my\_responsive\_photo\_gallery\_admin\_scripts\_init(); |
| [573](#L573) |  |
| [574](#L574) | rjg\_do\_upgrade\_if\_not\_done(); |
| [575](#L575) |  |
| [576](#L576) |  |
| [577](#L577) | } |
| [578](#L578) |  |
| [579](#L579) | function responsive\_photo\_gallery\_slider\_admin\_options(){ |
| [580](#L580) |  |
| [581](#L581) |  |
| [582](#L582) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_slideshow\_settings' ) ) { |
| [583](#L583) |  |
| [584](#L584) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [585](#L585) |  |
| [586](#L586) | } |
| [587](#L587) |  |
| [588](#L588) | if(isset($\_POST['btnsave'])){ |
| [589](#L589) |  |
| [590](#L590) | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
| [591](#L591) |  |
| [592](#L592) | wp\_die('Security check fail'); |
| [593](#L593) | } |
| [594](#L594) |  |
| [595](#L595) |  |
| [596](#L596) | $options=array(); |
| [597](#L597) | $options['transition\_speed']       =(int)trim(htmlentities(sanitize\_text\_field($\_POST['transition\_speed']),ENT\_QUOTES)); |
| [598](#L598) | $options['transition\_interval']    =(int)trim(htmlentities(sanitize\_text\_field($\_POST['transition\_interval']),ENT\_QUOTES)); |
| [599](#L599) | $options['show\_panel\_nav']         =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_panel\_nav']),ENT\_QUOTES)); |
| [600](#L600) | $options['panel\_width']            =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_width']),ENT\_QUOTES)); |
| [601](#L601) | $options['panel\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_height']),ENT\_QUOTES)); |
| [602](#L602) | $options['panel\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['panel\_height']),ENT\_QUOTES)); |
| [603](#L603) | $options['panel\_scale']            =trim(htmlentities(sanitize\_text\_field($\_POST['panel\_scale']),ENT\_QUOTES)); |
| [604](#L604) | $options['pan\_style'   ]           =trim(htmlentities(sanitize\_text\_field($\_POST['pan\_style']),ENT\_QUOTES)); |
| [605](#L605) | $options['pan\_images']             =(int)trim(htmlentities(sanitize\_text\_field($\_POST['pan\_images']),ENT\_QUOTES)); |
| [606](#L606) | $options['show\_filmstrip']         =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_filmstrip']),ENT\_QUOTES)); |
| [607](#L607) | $options['autoplay']               =(int)trim(htmlentities(sanitize\_text\_field($\_POST['autoplay']),ENT\_QUOTES)); |
| [608](#L608) | $options['frame\_width']            =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_width']),ENT\_QUOTES)); |
| [609](#L609) | $options['frame\_height']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_height']),ENT\_QUOTES)); |
| [610](#L610) | $options['frame\_opacity']          =trim(htmlentities(sanitize\_text\_field($\_POST['frame\_opacity']),ENT\_QUOTES)); |
| [611](#L611) | $options['frame\_scale']            =trim(htmlentities(sanitize\_text\_field($\_POST['frame\_scale']),ENT\_QUOTES)); |
| [612](#L612) | $options['filmstrip\_style']        ='scroll'; |
| [613](#L613) | $options['frame\_gap']              =(int)trim(htmlentities(sanitize\_text\_field($\_POST['frame\_gap']),ENT\_QUOTES)); |
| [614](#L614) | $options['show\_infobar']           =(int)trim(htmlentities(sanitize\_text\_field($\_POST['show\_infobar']),ENT\_QUOTES)); |
| [615](#L615) | $options['infobar\_opacity']        = floatval(htmlentities(sanitize\_text\_field($\_POST['infobar\_opacity']),ENT\_QUOTES)); |
| [616](#L616) | $options['start\_frame']            =1; |
| [617](#L617) | $options['panel\_animation']        ='fade'; |
| [618](#L618) | $options['overlay\_position']       ='bottom'; |
| [619](#L619) | $options['filmstrip\_position']     ='bottom'; |
| [620](#L620) | $options['enable\_overlays']        =0; |
| [621](#L621) | $options['show\_captions']          =0; |
| [622](#L622) | $options['show\_filmstrip\_nav']     =0; |
| [623](#L623) | $options['show\_panels']            =1; |
| [624](#L624) |  |
| [625](#L625) | if((int)trim($\_POST['autoplay'])) |
| [626](#L626) | $options['enable\_slideshow']=1; |
| [627](#L627) | else |
| [628](#L628) | $options['enable\_slideshow']=0; |
| [629](#L629) |  |
| [630](#L630) | $settings=update\_option('my\_responsive\_photo\_gallery\_slider\_settings',$options); |
| [631](#L631) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [632](#L632) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [633](#L633) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Settings saved successfully.','wp-responsive-photo-gallery' ); |
| [634](#L634) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [635](#L635) |  |
| [636](#L636) |  |
| [637](#L637) |  |
| [638](#L638) | } |
| [639](#L639) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [640](#L640) |  |
| [641](#L641) | ?> |
| [642](#L642) | <div style="width: 100%;"> |
| [643](#L643) | <div style="float:left;width:100%;"> |
| [644](#L644) | <div class="wrap"> |
| [645](#L645) | <table><tr> |
| [646](#L646) | <td> |
| [647](#L647) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [648](#L648) | <div id="fb-root"></div> |
| [649](#L649) | <script>(function(d, s, id) { |
| [650](#L650) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [651](#L651) | if (d.getElementById(id)) return; |
| [652](#L652) | js = d.createElement(s); js.id = id; |
| [653](#L653) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [654](#L654) | fjs.parentNode.insertBefore(js, fjs); |
| [655](#L655) | }(document, 'script', 'facebook-jssdk'));</script> |
| [656](#L656) | </td> |
| [657](#L657) | <td> |
| [658](#L658) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [659](#L659) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [660](#L660) | </a> |
| [661](#L661) | </td> |
| [662](#L662) | </tr> |
| [663](#L663) | </table> |
| [664](#L664) | <div style="clear:both"> |
| [665](#L665) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [666](#L666) | </div> |
| [667](#L667) | <?php |
| [668](#L668) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [669](#L669) | $type=''; |
| [670](#L670) | $message=''; |
| [671](#L671) | if(isset($messages['type']) and $messages['type']!=""){ |
| [672](#L672) |  |
| [673](#L673) | $type=$messages['type']; |
| [674](#L674) | $message=$messages['message']; |
| [675](#L675) |  |
| [676](#L676) | } |
| [677](#L677) |  |
| [678](#L678) |  |
| [679](#L679) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [680](#L680) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [681](#L681) |  |
| [682](#L682) |  |
| [683](#L683) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [684](#L684) | ?> |
| [685](#L685) |  |
| [686](#L686) |  |
| [687](#L687) | <h2><?php echo \_\_( 'Gallery Settings','wp-responsive-photo-gallery' );?></h2> |
| [688](#L688) |  |
| [689](#L689) | <div id="poststuff"> |
| [690](#L690) | <div id="post-body" class="metabox-holder columns-2"> |
| [691](#L691) | <div id="post-body-content"> |
| [692](#L692) | <form method="post" action="" id="scrollersettiings" name="scrollersettiings" > |
| [693](#L693) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [694](#L694) | <h3><label for="link\_name"><?php echo \_\_( 'Settings','wp-responsive-photo-gallery' );?></label></h3> |
| [695](#L695) | <table cellspacing="0" class="form-list" cellpadding="10"> |
| [696](#L696) | <tbody> |
| [697](#L697) | <tr> |
| [698](#L698) | <td class="label"> |
| [699](#L699) | <label for="transition\_speed"><?php echo \_\_( 'Transition Speed','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [700](#L700) | </td> |
| [701](#L701) | <td class="value"> |
| [702](#L702) | <input id="transition\_speed" value="<?php echo $settings['transition\_speed']; ?>" name="transition\_speed"  class="input-text" type="text"> |
| [703](#L703) | <div style="clear:both"></div> |
| [704](#L704) | <div></div> |
| [705](#L705) | </td> |
| [706](#L706) | </tr> |
| [707](#L707) | <tr> |
| [708](#L708) | <td class="label"> |
| [709](#L709) | <label for="transition\_interval"><?php echo \_\_( 'Transition Interval','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [710](#L710) | </td> |
| [711](#L711) | <td class="value"> |
| [712](#L712) | <input id="transition\_interval"  value="<?php echo $settings['transition\_interval']; ?>" name="transition\_interval"  class="input-text" type="text"> |
| [713](#L713) | <div style="clear:both"></div> |
| [714](#L714) | <div></div> |
| [715](#L715) | </td> |
| [716](#L716) | </tr> |
| [717](#L717) | <tr> |
| [718](#L718) | <td class="label"> |
| [719](#L719) | <label for="show\_panel\_nav"><?php echo \_\_( 'Show Slider Navigation arrows','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [720](#L720) | </td> |
| [721](#L721) | <td class="value"> |
| [722](#L722) | <select id="show\_panel\_nav" name="show\_panel\_nav" class="select"> |
| [723](#L723) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [724](#L724) | <option <?php if($settings['show\_panel\_nav']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [725](#L725) | <option <?php if($settings['show\_panel\_nav']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [726](#L726) | </select> |
| [727](#L727) | <div style="clear:both"></div> |
| [728](#L728) | <div></div> |
| [729](#L729) | </td> |
| [730](#L730) | </tr> |
| [731](#L731) | <tr> |
| [732](#L732) | <td class="label"> |
| [733](#L733) | <label for="panel\_width"><?php echo \_\_( 'Width','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [734](#L734) | </td> |
| [735](#L735) | <td class="value"> |
| [736](#L736) | <input id="panel\_width" value="<?php echo $settings['panel\_width']; ?>" name="panel\_width"  class="input-text" type="text"> |
| [737](#L737) | <div style="clear:both"></div> |
| [738](#L738) | <div></div> |
| [739](#L739) | </td> |
| [740](#L740) | </tr> |
| [741](#L741) | <tr> |
| [742](#L742) | <td class="label"> |
| [743](#L743) | <label for="panel\_height"><?php echo \_\_( 'Height','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [744](#L744) | </td> |
| [745](#L745) | <td class="value"> |
| [746](#L746) | <input id="panel\_height" value="<?php echo $settings['panel\_height']; ?>"  name="panel\_height"  class="input-text" type="text"> |
| [747](#L747) | <div style="clear:both"></div> |
| [748](#L748) | <div></div> |
| [749](#L749) | </td> |
| [750](#L750) | </tr> |
| [751](#L751) | <tr> |
| [752](#L752) | <td class="label"> |
| [753](#L753) | <label for="panel\_scale"><?php echo \_\_( 'Scale','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label> |
| [754](#L754) | </td> |
| [755](#L755) | <td class="value"> |
| [756](#L756) | <select id="panel\_scale" name="panel\_scale" class="select"> |
| [757](#L757) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [758](#L758) | <option <?php if($settings['panel\_scale']=='crop'):?> selected="selected" <?php endif;?> value="crop"><?php echo \_\_( 'Crop','wp-responsive-photo-gallery' );?></option> |
| [759](#L759) | <option <?php if($settings['panel\_scale']=='fit'):?> selected="selected" <?php endif;?> value="fit" ><?php echo \_\_( 'Fit','wp-responsive-photo-gallery' );?></option> |
| [760](#L760) | </select> |
| [761](#L761) | <div style="clear:both"></div> |
| [762](#L762) | <div></div> |
| [763](#L763) | </td> |
| [764](#L764) | </tr> |
| [765](#L765) | <tr> |
| [766](#L766) | <td class="label"> |
| [767](#L767) | <label for="pan\_images"><?php echo \_\_( 'Pan Images','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label> |
| [768](#L768) | </td> |
| [769](#L769) | <td class="value"> |
| [770](#L770) | <select id="pan\_images" name="pan\_images" class="select"> |
| [771](#L771) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [772](#L772) | <option <?php if($settings['pan\_images']==1):?> selected="selected" <?php endif;?>  value="1"><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [773](#L773) | <option <?php if($settings['pan\_images']==0):?> selected="selected" <?php endif;?>  value="0" ><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [774](#L774) | </select> |
| [775](#L775) | <div style="clear:both"></div> |
| [776](#L776) | <div></div> |
| [777](#L777) | </td> |
| [778](#L778) | </tr> |
| [779](#L779) | <tr> |
| [780](#L780) | <td class="label"> |
| [781](#L781) | <label for="pan\_style"><?php echo \_\_( 'Pan Style','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [782](#L782) | </td> |
| [783](#L783) | <td class="value"> |
| [784](#L784) | <select id="pan\_style" name="pan\_style" class="select"> |
| [785](#L785) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [786](#L786) | <option <?php if($settings['pan\_style']=='drag'):?> selected="selected" <?php endif;?>  value="drag"><?php echo \_\_( 'Drag','wp-responsive-photo-gallery' );?></option> |
| [787](#L787) | <option <?php if($settings['pan\_style']=='track'):?> selected="selected" <?php endif;?>  value="track" ><?php echo \_\_( 'Track','wp-responsive-photo-gallery' );?></option> |
| [788](#L788) | </select> |
| [789](#L789) | <div style="clear:both"></div> |
| [790](#L790) | <div></div> |
| [791](#L791) | </td> |
| [792](#L792) | </tr> |
| [793](#L793) | <tr> |
| [794](#L794) | <td class="label"> |
| [795](#L795) | <label for="show\_filmstrip"><?php echo \_\_( 'Show Thumbnail Gallery','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [796](#L796) | </td> |
| [797](#L797) | <td class="value"> |
| [798](#L798) | <select id="show\_filmstrip" name="show\_filmstrip" class="select"> |
| [799](#L799) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [800](#L800) | <option <?php if($settings['show\_filmstrip']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [801](#L801) | <option <?php if($settings['show\_filmstrip']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [802](#L802) | </select> |
| [803](#L803) | <div style="clear:both"></div> |
| [804](#L804) | <div></div> |
| [805](#L805) | </td> |
| [806](#L806) | </tr> |
| [807](#L807) | <tr> |
| [808](#L808) | <td class="label"><label for="autoplay"><?php echo \_\_( 'Auto play?','wp-responsive-photo-gallery' );?>   <span class="required">\*</span></label></td> |
| [809](#L809) | <td class="value"> |
| [810](#L810) | <select id="autoplay" name="autoplay" class="select"> |
| [811](#L811) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [812](#L812) | <option <?php if($settings['autoplay']==1):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [813](#L813) | <option <?php if($settings['autoplay']==0):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [814](#L814) | </select> |
| [815](#L815) | <div style="clear:both"></div> |
| [816](#L816) | <div></div> |
| [817](#L817) | </td> |
| [818](#L818) | </tr> |
| [819](#L819) | <tr> |
| [820](#L820) | <td class="label"> |
| [821](#L821) | <label for="frame\_width"><?php echo \_\_( 'Thumbnail Width','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [822](#L822) | </td> |
| [823](#L823) | <td class="value"> |
| [824](#L824) | <input id="frame\_width" value="<?php echo $settings['frame\_width']; ?>" name="frame\_width" value="80" class="input-text" type="text"> |
| [825](#L825) | <div style="clear:both"></div> |
| [826](#L826) | <div></div> |
| [827](#L827) | </td> |
| [828](#L828) | </tr> |
| [829](#L829) | <tr> |
| [830](#L830) | <td class="label"> |
| [831](#L831) | <label for="frame\_height"><?php echo \_\_( 'Thumbnail Height','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [832](#L832) | </td> |
| [833](#L833) | <td class="value"> |
| [834](#L834) | <input id="frame\_height" value="<?php echo $settings['frame\_height']; ?>" name="frame\_height"  class="input-text" type="text"> |
| [835](#L835) | <div style="clear:both"></div> |
| [836](#L836) | <div></div> |
| [837](#L837) | </td> |
| [838](#L838) | </tr> |
| [839](#L839) | <tr> |
| [840](#L840) | <td class="label"> |
| [841](#L841) | <label for="frame\_opacity"><?php echo \_\_( 'Thumbnail Opacity','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [842](#L842) | </td> |
| [843](#L843) | <td class="value"> |
| [844](#L844) | <input id="frame\_opacity" value="<?php echo $settings['frame\_opacity']; ?>" name="frame\_opacity"  class="input-text" type="text"> |
| [845](#L845) | <div style="clear:both"></div> |
| [846](#L846) | <div></div> |
| [847](#L847) | </td> |
| [848](#L848) | </tr> |
| [849](#L849) | <tr> |
| [850](#L850) | <td class="label"> |
| [851](#L851) | <label for="frame\_scale"><?php echo \_\_( 'Thumbnail Scale','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [852](#L852) | </td> |
| [853](#L853) | <td class="value"> |
| [854](#L854) | <select id="frame\_scale" name="frame\_scale" class="select"> |
| [855](#L855) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [856](#L856) | <option <?php if($settings['frame\_scale']=='crop'):?> selected="selected" <?php endif;?> value="crop" ><?php echo \_\_( 'Crop','wp-responsive-photo-gallery' );?></option> |
| [857](#L857) | <option <?php if($settings['frame\_scale']=='fit'):?> selected="selected" <?php endif;?>  value="fit"><?php echo \_\_( 'Fit','wp-responsive-photo-gallery' );?></option> |
| [858](#L858) | </select> |
| [859](#L859) | <div style="clear:both"></div> |
| [860](#L860) | <div></div> |
| [861](#L861) | </td> |
| [862](#L862) | </tr> |
| [863](#L863) | <tr> |
| [864](#L864) | <td class="label"> |
| [865](#L865) | <label for="frame\_gap"><?php echo \_\_( 'Thumbnail Gap','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [866](#L866) | </td> |
| [867](#L867) | <td class="value"> |
| [868](#L868) | <input id="frame\_gap" value="<?php echo $settings['frame\_gap']; ?>" name="frame\_gap"  class="input-text" type="text"> |
| [869](#L869) | <div style="clear:both"></div> |
| [870](#L870) | <div></div> |
| [871](#L871) | </td> |
| [872](#L872) | </tr> |
| [873](#L873) | <tr> |
| [874](#L874) | <td class="label"><label for="show\_infobar"><?php echo \_\_( 'Show Infobar?','wp-responsive-photo-gallery' );?>  <span class="required">\*</span></label></td> |
| [875](#L875) | <td class="value"> |
| [876](#L876) | <select id="show\_infobar" name="show\_infobar" class=" select"> |
| [877](#L877) | <option value=""><?php echo \_\_( 'Select','wp-responsive-photo-gallery' );?></option> |
| [878](#L878) | <option <?php if($settings['show\_infobar']==1):?> selected="selected" <?php endif;?>  value="1"><?php echo \_\_( 'Yes','wp-responsive-photo-gallery' );?></option> |
| [879](#L879) | <option <?php if($settings['show\_infobar']==0):?> selected="selected" <?php endif;?>  value="0" ><?php echo \_\_( 'No','wp-responsive-photo-gallery' );?></option> |
| [880](#L880) | </select> |
| [881](#L881) | <div style="clear:both"></div> |
| [882](#L882) | <div></div> |
| [883](#L883) | </td> |
| [884](#L884) | </tr> |
| [885](#L885) | <tr> |
| [886](#L886) | <td class="label"> |
| [887](#L887) | <label for="infobar\_opacity"><?php echo \_\_( 'Infobar Opacity','wp-responsive-photo-gallery' );?> <span class="required">\*</span></label> |
| [888](#L888) | </td> |
| [889](#L889) | <td class="value"> |
| [890](#L890) | <input id="infobar\_opacity" value="<?php echo $settings['infobar\_opacity']; ?>" name="infobar\_opacity"  class="input-text" type="text"> |
| [891](#L891) | <div style="clear:both"></div> |
| [892](#L892) | <div></div> |
| [893](#L893) | </td> |
| [894](#L894) | </tr> |
| [895](#L895) | <tr> |
| [896](#L896) | <td class="label"> |
| [897](#L897) | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
| [898](#L898) | <input type="submit"  name="btnsave" id="btnsave" value="<?php echo \_\_( 'Save Changes','wp-responsive-photo-gallery' );?>" class="button-primary"> |
| [899](#L899) | </td> |
| [900](#L900) | <td class="value"> |
| [901](#L901) |  |
| [902](#L902) | <input type="button" name="cancle" id="cancle" value="<?php echo \_\_( 'Cancel','wp-responsive-photo-gallery' );?>" class="button-primary" onclick="location.href='admin.php?page=responsive\_photo\_gallery\_slider'"> |
| [903](#L903) |  |
| [904](#L904) | </td> |
| [905](#L905) | </tr> |
| [906](#L906) | </tbody> |
| [907](#L907) | </table> |
| [908](#L908) | </div> |
| [909](#L909) | <input type="hidden" name="start\_frame" id="start\_frame" value="1"> |
| [910](#L910) | <input type="hidden" name="enable\_slideshow" id="start\_frame" value="1"> |
| [911](#L911) | <input type="hidden" name="panel\_animation" id="panel\_animation" value="fade"> |
| [912](#L912) | <input type="hidden" name="overlay\_position" id="overlay\_position" value="bottom"> |
| [913](#L913) | <input type="hidden" name="filmstrip\_position" id="filmstrip\_position" value="bottom"> |
| [914](#L914) | <input type="hidden" name="enable\_overlays" id="enable\_overlays" value="0"> |
| [915](#L915) | <input type="hidden" name="show\_captions" id="show\_captions" value="0"> |
| [916](#L916) | <input type="hidden" name="show\_filmstrip\_nav" id="show\_filmstrip\_nav" value="0"> |
| [917](#L917) | <input type="hidden" name="show\_panels" id="show\_panels" value="1"> |
| [918](#L918) | </form> |
| [919](#L919) | <script type="text/javascript"> |
| [920](#L920) |  |
| [921](#L921) | jQuery(document).ready(function() { |
| [922](#L922) |  |
| [923](#L923) | jQuery("#scrollersettiings").validate({ |
| [924](#L924) | rules: { |
| [925](#L925) | transition\_speed: { |
| [926](#L926) | required:true, |
| [927](#L927) | number:true, |
| [928](#L928) | maxlength:10 |
| [929](#L929) | },transition\_interval: { |
| [930](#L930) | required:true, |
| [931](#L931) | number:true, |
| [932](#L932) | maxlength:10 |
| [933](#L933) | },show\_panel\_nav: { |
| [934](#L934) | required:true, |
| [935](#L935) | }, |
| [936](#L936) | panel\_width:{ |
| [937](#L937) | required:true, |
| [938](#L938) | number:true, |
| [939](#L939) | maxlength:10 |
| [940](#L940) |  |
| [941](#L941) | }, |
| [942](#L942) | panel\_height:{ |
| [943](#L943) | required:true, |
| [944](#L944) | number:true, |
| [945](#L945) | maxlength:10 |
| [946](#L946) | }, |
| [947](#L947) | panel\_scale:{ |
| [948](#L948) | required:true |
| [949](#L949) | }, |
| [950](#L950) | pan\_images:{ |
| [951](#L951) | required:true |
| [952](#L952) |  |
| [953](#L953) | }, |
| [954](#L954) | pan\_style:{ |
| [955](#L955) | required:true |
| [956](#L956) | },show\_filmstrip:{ |
| [957](#L957) | required:true |
| [958](#L958) |  |
| [959](#L959) | },autoplay:{ |
| [960](#L960) | required:true |
| [961](#L961) |  |
| [962](#L962) | },frame\_width:{ |
| [963](#L963) | required:true, |
| [964](#L964) | number:true, |
| [965](#L965) | maxlength:10 |
| [966](#L966) | },frame\_height:{ |
| [967](#L967) | required:true, |
| [968](#L968) | number:true, |
| [969](#L969) | maxlength:10 |
| [970](#L970) | } |
| [971](#L971) | ,frame\_opacity:{ |
| [972](#L972) | required:true, |
| [973](#L973) | number:true, |
| [974](#L974) | maxlength:10 |
| [975](#L975) | } |
| [976](#L976) | ,frame\_scale:{ |
| [977](#L977) | required:true |
| [978](#L978) |  |
| [979](#L979) | },frame\_gap:{ |
| [980](#L980) | required:true, |
| [981](#L981) | number:true, |
| [982](#L982) | maxlength:10 |
| [983](#L983) |  |
| [984](#L984) | },show\_infobar:{ |
| [985](#L985) | required:true |
| [986](#L986) |  |
| [987](#L987) | },infobar\_opacity:{ |
| [988](#L988) | required:true, |
| [989](#L989) | number:true, |
| [990](#L990) | maxlength:10 |
| [991](#L991) | } |
| [992](#L992) |  |
| [993](#L993) | }, |
| [994](#L994) | errorClass: "image\_error", |
| [995](#L995) | errorPlacement: function(error, element) { |
| [996](#L996) | error.appendTo( element.next().next()); |
| [997](#L997) | } |
| [998](#L998) |  |
| [999](#L999) |  |
| [1000](#L1000) | }) |
| [1001](#L1001) | }); |
| [1002](#L1002) |  |
| [1003](#L1003) | </script> |
| [1004](#L1004) |  |
| [1005](#L1005) | </div> |
| [1006](#L1006) | <div id="postbox-container-1" class="postbox-container"  > |
| [1007](#L1007) |  |
| [1008](#L1008) | <div class="postbox"> |
| [1009](#L1009) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [1010](#L1010) | <div class="inside"> |
| [1011](#L1011) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [1012](#L1012) |  |
| [1013](#L1013) | <div style="margin:10px 5px"> |
| [1014](#L1014) |  |
| [1015](#L1015) | </div> |
| [1016](#L1016) | </div></div> |
| [1017](#L1017) | <div class="postbox"> |
| [1018](#L1018) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [1019](#L1019) | <div class="inside"> |
| [1020](#L1020) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px;width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>"  border="0"></a></center> |
| [1021](#L1021) | <div style="margin:10px 5px"> |
| [1022](#L1022) | </div> |
| [1023](#L1023) | </div></div> |
| [1024](#L1024) |  |
| [1025](#L1025) |  |
| [1026](#L1026) |  |
| [1027](#L1027) | </div> |
| [1028](#L1028) | <div class="clear"></div> |
| [1029](#L1029) | </div> |
| [1030](#L1030) |  |
| [1031](#L1031) | </div> |
| [1032](#L1032) | </div> |
| [1033](#L1033) | </div> |
| [1034](#L1034) |  |
| [1035](#L1035) |  |
| [1036](#L1036) |  |
| [1037](#L1037) | <div class="clear"></div></div> |
| [1038](#L1038) | <?php |
| [1039](#L1039) | } |
| [1040](#L1040) | function responsive\_photo\_gallery\_image\_management(){ |
| [1041](#L1041) |  |
| [1042](#L1042) |  |
| [1043](#L1043) | $uploads = wp\_upload\_dir (); |
| [1044](#L1044) | $baseDir = $uploads ['basedir']; |
| [1045](#L1045) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [1046](#L1046) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [1047](#L1047) |  |
| [1048](#L1048) | $baseurl=$uploads['baseurl']; |
| [1049](#L1049) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [1050](#L1050) |  |
| [1051](#L1051) | global $wpdb; |
| [1052](#L1052) |  |
| [1053](#L1053) |  |
| [1054](#L1054) | $action = 'gridview'; |
| [1055](#L1055) |  |
| [1056](#L1056) | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
| [1057](#L1057) |  |
| [1058](#L1058) | $action = trim ( sanitize\_text\_field($\_GET ['action'] )); |
| [1059](#L1059) |  |
| [1060](#L1060) | if(isset($\_GET['order\_by'])){ |
| [1061](#L1061) |  |
| [1062](#L1062) | if(sanitize\_sql\_orderby($\_GET['order\_by'])){ |
| [1063](#L1063) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1064](#L1064) | } |
| [1065](#L1065) | else{ |
| [1066](#L1066) |  |
| [1067](#L1067) | $order\_by=' id '; |
| [1068](#L1068) | } |
| [1069](#L1069) | } |
| [1070](#L1070) |  |
| [1071](#L1071) | if(isset($\_GET['order\_pos'])){ |
| [1072](#L1072) |  |
| [1073](#L1073) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1074](#L1074) | } |
| [1075](#L1075) |  |
| [1076](#L1076) | $search\_term\_=''; |
| [1077](#L1077) | if(isset($\_GET['search\_term'])){ |
| [1078](#L1078) |  |
| [1079](#L1079) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1080](#L1080) | } |
| [1081](#L1081) | } |
| [1082](#L1082) |  |
| [1083](#L1083) | $search\_term\_=''; |
| [1084](#L1084) | if(isset($\_GET['search\_term'])){ |
| [1085](#L1085) |  |
| [1086](#L1086) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1087](#L1087) | } |
| [1088](#L1088) |  |
| [1089](#L1089) | ?> |
| [1090](#L1090) |  |
| [1091](#L1091) | <?php |
| [1092](#L1092) | if(strtolower($action)==strtolower('gridview')){ |
| [1093](#L1093) |  |
| [1094](#L1094) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_view\_images' ) ) { |
| [1095](#L1095) |  |
| [1096](#L1096) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [1097](#L1097) |  |
| [1098](#L1098) | } |
| [1099](#L1099) |  |
| [1100](#L1100) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1101](#L1101) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1102](#L1102) |  |
| [1103](#L1103) |  |
| [1104](#L1104) |  |
| [1105](#L1105) | ?> |
| [1106](#L1106) | <div class="wrap"> |
| [1107](#L1107) | <table><tr> |
| [1108](#L1108) | <td> |
| [1109](#L1109) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [1110](#L1110) | <div id="fb-root"></div> |
| [1111](#L1111) | <script>(function(d, s, id) { |
| [1112](#L1112) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [1113](#L1113) | if (d.getElementById(id)) return; |
| [1114](#L1114) | js = d.createElement(s); js.id = id; |
| [1115](#L1115) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [1116](#L1116) | fjs.parentNode.insertBefore(js, fjs); |
| [1117](#L1117) | }(document, 'script', 'facebook-jssdk'));</script> |
| [1118](#L1118) | </td> |
| [1119](#L1119) | <td> |
| [1120](#L1120) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [1121](#L1121) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [1122](#L1122) | </a> |
| [1123](#L1123) | </td> |
| [1124](#L1124) | </tr> |
| [1125](#L1125) | </table> |
| [1126](#L1126) | <div style="clear:both"> |
| [1127](#L1127) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [1128](#L1128) | </div> |
| [1129](#L1129) |  |
| [1130](#L1130) | <?php |
| [1131](#L1131) |  |
| [1132](#L1132) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [1133](#L1133) | $type=''; |
| [1134](#L1134) | $message=''; |
| [1135](#L1135) | if(isset($messages['type']) and $messages['type']!=""){ |
| [1136](#L1136) |  |
| [1137](#L1137) | $type=$messages['type']; |
| [1138](#L1138) | $message=$messages['message']; |
| [1139](#L1139) |  |
| [1140](#L1140) | } |
| [1141](#L1141) |  |
| [1142](#L1142) |  |
| [1143](#L1143) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1144](#L1144) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1145](#L1145) |  |
| [1146](#L1146) |  |
| [1147](#L1147) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [1148](#L1148) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [1149](#L1149) | ?> |
| [1150](#L1150) | <div id="modelMainDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [1151](#L1151) | <div id="LoaderDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [1152](#L1152) | <div id="ContainDiv" style="display:none;z-index: 1056; position: fixed; padding: 5px; margin: 0px; width: 30%; top: 40%; left: 35%; text-align: center; color: rgb(0, 0, 0); border: 1px solid #999999; background-color: rgb(255, 255, 255); cursor: wait;" > |
| [1153](#L1153) | <img src="<?php echo $url.'images/ajax-loader.gif'?>" /> |
| [1154](#L1154) | <h5 id="wait"><?php echo \_\_('Please wait while uploading images...','wp-responsive-photo-gallery');?></h5> |
| [1155](#L1155) | </div> |
| [1156](#L1156) | <div id="poststuff" > |
| [1157](#L1157) | <div id="post-body" class="metabox-holder columns-2"> |
| [1158](#L1158) | <div id="post-body-content" > |
| [1159](#L1159) |  |
| [1160](#L1160) | <div class="icon32 icon32-posts-post" id="icon-edit"><br></div> |
| [1161](#L1161) | <h1> |
| [1162](#L1162) | <?php echo \_\_( 'Images','wp-responsive-photo-gallery' );?> <a class="button add-new-h2" href="admin.php?page=responsive\_photo\_gallery\_image\_management&action=addedit"><?php echo \_\_( 'Add New','wp-responsive-photo-gallery' );?></a> |
| [1163](#L1163) | &nbsp;&nbsp; |
| [1164](#L1164) | <a class="massAdd button add-new-h2" href="javascript:void(0)"><?php echo \_\_('Mass Add','wp-responsive-photo-gallery');?></a> |
| [1165](#L1165) |  |
| [1166](#L1166) | </h1> |
| [1167](#L1167) | <br/> |
| [1168](#L1168) |  |
| [1169](#L1169) | <form method="POST" action="admin.php?page=responsive\_photo\_gallery\_image\_management&action=deleteselected"  id="posts-filter" onkeypress="return event.keyCode != 13;"> |
| [1170](#L1170) | <div class="alignleft actions"> |
| [1171](#L1171) | <select name="action\_upper" id="action\_upper"> |
| [1172](#L1172) | <option selected="selected" value="-1"><?php echo \_\_( 'Bulk Actions','wp-responsive-photo-gallery' );?></option> |
| [1173](#L1173) | <option value="delete"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></option> |
| [1174](#L1174) | </select> |
| [1175](#L1175) | <input type="submit" value="<?php echo \_\_( 'Apply','wp-responsive-photo-gallery' );?>" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [1176](#L1176) | </div> |
| [1177](#L1177) | <br class="clear"> |
| [1178](#L1178) | <?php |
| [1179](#L1179) |  |
| [1180](#L1180) | $setacrionpage='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1181](#L1181) |  |
| [1182](#L1182) | if(isset($\_GET['order\_by']) and $\_GET['order\_by']!=""){ |
| [1183](#L1183) | $setacrionpage.='&order\_by='.esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1184](#L1184) | } |
| [1185](#L1185) |  |
| [1186](#L1186) | if(isset($\_GET['order\_pos']) and $\_GET['order\_pos']!=""){ |
| [1187](#L1187) | $setacrionpage.='&order\_pos='.esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1188](#L1188) | } |
| [1189](#L1189) |  |
| [1190](#L1190) | $seval=""; |
| [1191](#L1191) | if(isset($\_GET['search\_term']) and $\_GET['search\_term']!=""){ |
| [1192](#L1192) | $seval=esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) |  |
| [1196](#L1196) | $order\_by='id'; |
| [1197](#L1197) | $order\_pos="asc"; |
| [1198](#L1198) |  |
| [1199](#L1199) | if(isset($\_GET['order\_by']) and sanitize\_sql\_orderby($\_GET['order\_by'])!==false){ |
| [1200](#L1200) |  |
| [1201](#L1201) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [1202](#L1202) | } |
| [1203](#L1203) |  |
| [1204](#L1204) | if(isset($\_GET['order\_pos'])){ |
| [1205](#L1205) |  |
| [1206](#L1206) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [1207](#L1207) | } |
| [1208](#L1208) |  |
| [1209](#L1209) | $search\_term=''; |
| [1210](#L1210) | if(isset($\_GET['search\_term'])){ |
| [1211](#L1211) |  |
| [1212](#L1212) | $search\_term= esc\_html(sanitize\_text\_field(esc\_sql($\_GET['search\_term']))); |
| [1213](#L1213) | } |
| [1214](#L1214) |  |
| [1215](#L1215) |  |
| [1216](#L1216) | ?> |
| [1217](#L1217) | <?php |
| [1218](#L1218) |  |
| [1219](#L1219) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [1220](#L1220) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider "; |
| [1221](#L1221) | $queryCount="SELECT count(\*) FROM ".$wpdb->prefix."gv\_responsive\_slider "; |
| [1222](#L1222) | if($search\_term!=''){ |
| [1223](#L1223) | $query.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [1224](#L1224) | $queryCount.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [1225](#L1225) | } |
| [1226](#L1226) |  |
| [1227](#L1227) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [1228](#L1228) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [1229](#L1229) |  |
| [1230](#L1230) | $rowsCount=$wpdb->get\_var($queryCount); |
| [1231](#L1231) | $query.=" order by $order\_by $order\_pos"; |
| [1232](#L1232) |  |
| [1233](#L1233) |  |
| [1234](#L1234) | ?> |
| [1235](#L1235) |  |
| [1236](#L1236) | <div style="padding-top:5px;padding-bottom:5px"> |
| [1237](#L1237) | <b><?php echo \_\_( 'Search','wp-responsive-photo-gallery');?> : </b> |
| [1238](#L1238) | <input type="text" value="<?php echo $seval;?>" id="search\_term" name="search\_term">&nbsp; |
| [1239](#L1239) | <input type='button'  value='<?php echo \_\_( 'Search','wp-responsive-photo-gallery');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
| [1240](#L1240) | <input type='button'  value='<?php echo \_\_( 'Reset Search','wp-responsive-photo-gallery');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
| [1241](#L1241) | </div> |
| [1242](#L1242) | <script type="text/javascript" > |
| [1243](#L1243) |  |
| [1244](#L1244) | jQuery('#search\_term').on("keyup", function(e) { |
| [1245](#L1245) | if (e.which == 13) { |
| [1246](#L1246) |  |
| [1247](#L1247) | SearchredirectTO(); |
| [1248](#L1248) | } |
| [1249](#L1249) | }); |
| [1250](#L1250) | function SearchredirectTO(){ |
| [1251](#L1251) |  |
| [1252](#L1252) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [1253](#L1253) | var searchval=jQuery('#search\_term').val(); |
| [1254](#L1254) | redirectto=redirectto+'&search\_term='+jQuery.trim(encodeURIComponent(searchval)); |
| [1255](#L1255) | window.location.href=redirectto; |
| [1256](#L1256) | } |
| [1257](#L1257) | function ResetSearch(){ |
| [1258](#L1258) |  |
| [1259](#L1259) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [1260](#L1260) | window.location.href=redirectto; |
| [1261](#L1261) | exit; |
| [1262](#L1262) | } |
| [1263](#L1263) | </script> |
| [1264](#L1264) | <div id="no-more-tables"> |
| [1265](#L1265) | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf" > |
| [1266](#L1266) | <thead> |
| [1267](#L1267) | <tr> |
| [1268](#L1268) | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
| [1269](#L1269) | <?php if($order\_by=="id" and $order\_pos=="asc"):?> |
| [1270](#L1270) |  |
| [1271](#L1271) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1272](#L1272) | <?php else:?> |
| [1273](#L1273) | <?php if($order\_by=="id"):?> |
| [1274](#L1274) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1275](#L1275) | <?php else:?> |
| [1276](#L1276) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?></a></th> |
| [1277](#L1277) | <?php endif;?> |
| [1278](#L1278) | <?php endif;?> |
| [1279](#L1279) | <?php if($order\_by=="title" and $order\_pos=="asc"):?> |
| [1280](#L1280) |  |
| [1281](#L1281) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1282](#L1282) | <?php else:?> |
| [1283](#L1283) | <?php if($order\_by=="title"):?> |
| [1284](#L1284) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1285](#L1285) | <?php else:?> |
| [1286](#L1286) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?></a></th> |
| [1287](#L1287) | <?php endif;?> |
| [1288](#L1288) | <?php endif;?> |
| [1289](#L1289) | <th><span></span></th> |
| [1290](#L1290) | <?php if($order\_by=="createdon" and $order\_pos=="asc"):?> |
| [1291](#L1291) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1292](#L1292) | <?php else:?> |
| [1293](#L1293) | <?php if($order\_by=="createdon"):?> |
| [1294](#L1294) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [1295](#L1295) | <?php else:?> |
| [1296](#L1296) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?></a></th> |
| [1297](#L1297) | <?php endif;?> |
| [1298](#L1298) | <?php endif;?> |
| [1299](#L1299) | <th><span><?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?></span></th> |
| [1300](#L1300) | <th><span><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></span></th> |
| [1301](#L1301) | </tr> |
| [1302](#L1302) | </thead> |
| [1303](#L1303) | <tbody id="the-list"> |
| [1304](#L1304) | <?php |
| [1305](#L1305) |  |
| [1306](#L1306) | if($rowsCount > 0){ |
| [1307](#L1307) |  |
| [1308](#L1308) | global $wp\_rewrite; |
| [1309](#L1309) | $rows\_per\_page = 10; |
| [1310](#L1310) |  |
| [1311](#L1311) | $current = (isset($\_GET['paged'])) ? (intval($\_GET['paged'])) : 1; |
| [1312](#L1312) | $pagination\_args = array( |
| [1313](#L1313) | 'base' => @add\_query\_arg('paged','%#%'), |
| [1314](#L1314) | 'format' => '', |
| [1315](#L1315) | 'total' => ceil($rowsCount/$rows\_per\_page), |
| [1316](#L1316) | 'current' => $current, |
| [1317](#L1317) | 'show\_all' => false, |
| [1318](#L1318) | 'type' => 'plain', |
| [1319](#L1319) | ); |
| [1320](#L1320) |  |
| [1321](#L1321) |  |
| [1322](#L1322) | $offset = ($current - 1) \* $rows\_per\_page; |
| [1323](#L1323) | $query.=" limit $offset, $rows\_per\_page"; |
| [1324](#L1324) | $rows = $wpdb->get\_results ( $query ,ARRAY\_A); |
| [1325](#L1325) | $delRecNonce=wp\_create\_nonce('delete\_image'); |
| [1326](#L1326) |  |
| [1327](#L1327) | foreach ($rows as $row ) { |
| [1328](#L1328) |  |
| [1329](#L1329) | $id=$row['id']; |
| [1330](#L1330) | $editlink="admin.php?page=responsive\_photo\_gallery\_image\_management&action=addedit&id=$id"; |
| [1331](#L1331) | $deletelink="admin.php?page=responsive\_photo\_gallery\_image\_management&action=delete&id=$id&nonce=$delRecNonce"; |
| [1332](#L1332) | $outputimgmain = $baseurl.$row['image\_name']; |
| [1333](#L1333) |  |
| [1334](#L1334) | ?> |
| [1335](#L1335) | <tr valign="top"> |
| [1336](#L1336) | <td class="alignCenter check-column"   data-title="<?php echo \_\_( 'Select Record','wp-responsive-photo-gallery' );?>" ><input type="checkbox" value="<?php echo $row['id']; ?>" name="thumbnails[]"></td> |
| [1337](#L1337) | <td class="alignCenter" data-title="<?php echo \_\_( 'ID','wp-responsive-photo-gallery' );?>"><strong><?php echo $row['id']; ?></strong></td> |
| [1338](#L1338) | <td class="alignCenter" data-title="<?php echo \_\_( 'Title','wp-responsive-photo-gallery' );?>"><strong><?php echo $row['title']; ?></strong></td> |
| [1339](#L1339) | <td class="alignCenter"> |
| [1340](#L1340) | <img src="<?php echo $outputimgmain;?>" style="width:50px" height="50px"/> |
| [1341](#L1341) | </td> |
| [1342](#L1342) | <td class="alignCenter" data-title="<?php echo \_\_( 'Published On','wp-responsive-photo-gallery' );?>"><?php echo $row['createdon'] ?></td> |
| [1343](#L1343) | <td class="alignCenter"   data-title="<?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?>"><strong><a href='<?php echo $editlink; ?>' title="<?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?>"><?php echo \_\_( 'Edit','wp-responsive-photo-gallery' );?></a></strong></td> |
| [1344](#L1344) | <td class="alignCenter"   data-title="<?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?>"><strong><a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();"  title="<?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?>"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></a> </strong></td> |
| [1345](#L1345) | </tr> |
| [1346](#L1346) | <?php |
| [1347](#L1347) | } |
| [1348](#L1348) | } |
| [1349](#L1349) | else{ |
| [1350](#L1350) | ?> |
| [1351](#L1351) |  |
| [1352](#L1352) | <tr valign="top" class="" id=""> |
| [1353](#L1353) | <td colspan="7" data-title="No Record" align="center"><strong><?php echo \_\_( 'No Images Found','wp-responsive-photo-gallery' );?></strong></td> |
| [1354](#L1354) | </tr> |
| [1355](#L1355) | <?php |
| [1356](#L1356) | } |
| [1357](#L1357) | ?> |
| [1358](#L1358) | </tbody> |
| [1359](#L1359) | </table> |
| [1360](#L1360) | </div> |
| [1361](#L1361) | <?php |
| [1362](#L1362) | if($rowsCount>0){ |
| [1363](#L1363) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [1364](#L1364) | echo paginate\_links($pagination\_args); |
| [1365](#L1365) | echo "</div>"; |
| [1366](#L1366) | } |
| [1367](#L1367) | ?> |
| [1368](#L1368) | <br/> |
| [1369](#L1369) | <div class="alignleft actions"> |
| [1370](#L1370) | <select name="action" id="action\_bottom"> |
| [1371](#L1371) | <option selected="selected" value="-1"><?php echo \_\_( 'Bulk Actions','wp-responsive-photo-gallery' );?></option> |
| [1372](#L1372) | <option value="delete"><?php echo \_\_( 'Delete','wp-responsive-photo-gallery' );?></option> |
| [1373](#L1373) | </select> |
| [1374](#L1374) | <?php wp\_nonce\_field('action\_settings\_mass\_delete','mass\_delete\_nonce'); ?> |
| [1375](#L1375) | <input type="submit" value="<?php echo \_\_( 'Apply','wp-responsive-photo-gallery' );?>" class="button-secondary action" id="deleteselected" name="deleteselected"> |
| [1376](#L1376) | </div> |
| [1377](#L1377) |  |
| [1378](#L1378) | </form> |
| [1379](#L1379) | <script type="text/JavaScript"> |
| [1380](#L1380) |  |
| [1381](#L1381) | function  confirmDelete\_bulk(){ |
| [1382](#L1382) | var topval=document.getElementById("action\_bottom").value; |
| [1383](#L1383) | var bottomVal=document.getElementById("action\_upper").value; |
| [1384](#L1384) |  |
| [1385](#L1385) | if(topval=='delete' || bottomVal=='delete'){ |
| [1386](#L1386) |  |
| [1387](#L1387) |  |
| [1388](#L1388) | var agree=confirm("<?php echo \_\_( 'Are you sure you want to delete selected images','wp-responsive-photo-gallery' );?> ?"); |
| [1389](#L1389) | if (agree) |
| [1390](#L1390) | return true ; |
| [1391](#L1391) | else |
| [1392](#L1392) | return false; |
| [1393](#L1393) | } |
| [1394](#L1394) | } |
| [1395](#L1395) | function  confirmDelete(){ |
| [1396](#L1396) | var agree=confirm("<?php echo \_\_( 'Are you sure you want to delete this image ?','wp-responsive-photo-gallery' );?>"); |
| [1397](#L1397) | if (agree) |
| [1398](#L1398) | return true ; |
| [1399](#L1399) | else |
| [1400](#L1400) | return false; |
| [1401](#L1401) | } |
| [1402](#L1402) |  |
| [1403](#L1403) | var nonce\_sec='<?php echo wp\_create\_nonce( "thumbnail-mass-image" );?>'; |
| [1404](#L1404) | jQuery(document).ready(function() { |
| [1405](#L1405) | //uploading files variable |
| [1406](#L1406) | var custom\_file\_frame; |
| [1407](#L1407) | jQuery(".massAdd").click(function(event) { |
| [1408](#L1408) | var slider\_id=jQuery(this).attr('id'); |
| [1409](#L1409) | event.preventDefault(); |
| [1410](#L1410) | //If the frame already exists, reopen it |
| [1411](#L1411) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [1412](#L1412) | custom\_file\_frame.close(); |
| [1413](#L1413) | } |
| [1414](#L1414) |  |
| [1415](#L1415) | //Create WP media frame. |
| [1416](#L1416) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [1417](#L1417) | //Title of media manager frame |
| [1418](#L1418) | title: "<?php echo \_\_("WP Media Uploader",'wp-responsive-photo-gallery');?>", |
| [1419](#L1419) | library: { |
| [1420](#L1420) | type: 'image' |
| [1421](#L1421) | }, |
| [1422](#L1422) | button: { |
| [1423](#L1423) | //Button text |
| [1424](#L1424) | text: "<?php echo \_\_("Set Image",'wp-responsive-photo-gallery');?>" |
| [1425](#L1425) | }, |
| [1426](#L1426) | //Do not allow multiple files, if you want multiple, set true |
| [1427](#L1427) | multiple: true |
| [1428](#L1428) | }); |
| [1429](#L1429) |  |
| [1430](#L1430) | //callback for selected image |
| [1431](#L1431) |  |
| [1432](#L1432) | custom\_file\_frame.on('select', function() { |
| [1433](#L1433) |  |
| [1434](#L1434) |  |
| [1435](#L1435) | jQuery("#modelMainDiv").show(); |
| [1436](#L1436) | jQuery("#LoaderDiv").show(); |
| [1437](#L1437) | jQuery("#ContainDiv").show(); |
| [1438](#L1438) | var selection = custom\_file\_frame.state().get('selection'); |
| [1439](#L1439) | selection.map(function(attachment) { |
| [1440](#L1440) |  |
| [1441](#L1441) | attachment = attachment.toJSON(); |
| [1442](#L1442) | var validExtensions=new Array(); |
| [1443](#L1443) | validExtensions[0]='jpg'; |
| [1444](#L1444) | validExtensions[1]='jpeg'; |
| [1445](#L1445) | validExtensions[2]='png'; |
| [1446](#L1446) | validExtensions[3]='gif'; |
| [1447](#L1447) |  |
| [1448](#L1448) |  |
| [1449](#L1449) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [1450](#L1450) |  |
| [1451](#L1451) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [1452](#L1452) |  |
| [1453](#L1453) | var titleTouse=""; |
| [1454](#L1454) | var imageDescriptionTouse=""; |
| [1455](#L1455) |  |
| [1456](#L1456) | if(jQuery.trim(attachment.title)!=''){ |
| [1457](#L1457) |  |
| [1458](#L1458) | titleTouse=jQuery.trim(attachment.title); |
| [1459](#L1459) | } |
| [1460](#L1460) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1461](#L1461) |  |
| [1462](#L1462) | titleTouse=jQuery.trim(attachment.caption); |
| [1463](#L1463) | } |
| [1464](#L1464) |  |
| [1465](#L1465) | if(jQuery.trim(attachment.description)!=''){ |
| [1466](#L1466) |  |
| [1467](#L1467) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [1468](#L1468) | } |
| [1469](#L1469) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1470](#L1470) |  |
| [1471](#L1471) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [1472](#L1472) | } |
| [1473](#L1473) |  |
| [1474](#L1474) | var data = { |
| [1475](#L1475) | imagetitle:titleTouse, |
| [1476](#L1476) | image\_description: imageDescriptionTouse, |
| [1477](#L1477) | attachment\_id:attachment.id, |
| [1478](#L1478) | slider\_id:slider\_id, |
| [1479](#L1479) | action: 'mass\_upload\_wpresponsivephgallery', |
| [1480](#L1480) | thumbnail\_security:nonce\_sec |
| [1481](#L1481) | }; |
| [1482](#L1482) |  |
| [1483](#L1483) | url='admin.php?page=responsive\_photo\_gallery\_image\_management&action=mass\_upload\_wpresponsivephgallery' |
| [1484](#L1484) | jQuery.ajax({ |
| [1485](#L1485) | type: 'POST', |
| [1486](#L1486) | url: ajaxurl, |
| [1487](#L1487) | data: data, |
| [1488](#L1488) | success: function(result) { |
| [1489](#L1489) | if(result.isOk == false) |
| [1490](#L1490) | alert(result.message); |
| [1491](#L1491) | }, |
| [1492](#L1492) | dataType:'html', |
| [1493](#L1493) | async:false |
| [1494](#L1494) | }); |
| [1495](#L1495) |  |
| [1496](#L1496) |  |
| [1497](#L1497) | } |
| [1498](#L1498) |  |
| [1499](#L1499) | }); |
| [1500](#L1500) |  |
| [1501](#L1501) | jQuery("#modelMainDiv").hide(); |
| [1502](#L1502) | jQuery("#LoaderDiv").hide(); |
| [1503](#L1503) | jQuery("#ContainDiv").hide(); |
| [1504](#L1504) |  |
| [1505](#L1505) | }); |
| [1506](#L1506) |  |
| [1507](#L1507) | custom\_file\_frame.on('close', function() { |
| [1508](#L1508) | window.location.reload(); |
| [1509](#L1509) | }); |
| [1510](#L1510) |  |
| [1511](#L1511) | //Open modal |
| [1512](#L1512) | custom\_file\_frame.open(); |
| [1513](#L1513) | }); |
| [1514](#L1514) | }) |
| [1515](#L1515) | </script> |
| [1516](#L1516) |  |
| [1517](#L1517) | <br class="clear"> |
| [1518](#L1518) |  |
| [1519](#L1519) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress Post/Page use below Short code','wp-responsive-photo-gallery' );?></h3> |
| [1520](#L1520) | <input type="text" value="[print\_my\_responsive\_photo\_gallery]" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [1521](#L1521) | <div class="clear"></div> |
| [1522](#L1522) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress theme/template PHP files use below php code','wp-responsive-photo-gallery' );?></h3> |
| [1523](#L1523) | <input type="text" value="&lt;?php echo do\_shortcode('[print\_my\_responsive\_photo\_gallery]'); ?&gt;" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [1524](#L1524) |  |
| [1525](#L1525) | <div class="clear"></div> |
| [1526](#L1526) | </div> |
| [1527](#L1527) | <div id="postbox-container-1" class="postbox-container"  > |
| [1528](#L1528) |  |
| [1529](#L1529) | <div class="postbox"> |
| [1530](#L1530) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [1531](#L1531) | <div class="inside"> |
| [1532](#L1532) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [1533](#L1533) |  |
| [1534](#L1534) | <div style="margin:10px 5px"> |
| [1535](#L1535) |  |
| [1536](#L1536) | </div> |
| [1537](#L1537) | </div></div> |
| [1538](#L1538) | <div class="postbox"> |
| [1539](#L1539) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [1540](#L1540) | <div class="inside"> |
| [1541](#L1541) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [1542](#L1542) | <div style="margin:10px 5px"> |
| [1543](#L1543) | </div> |
| [1544](#L1544) | </div></div> |
| [1545](#L1545) |  |
| [1546](#L1546) |  |
| [1547](#L1547) | </div> |
| [1548](#L1548) | <div class="clear"></div> |
| [1549](#L1549) | </div> |
| [1550](#L1550) |  |
| [1551](#L1551) | <div style="clear: both;"></div> |
| [1552](#L1552) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
| [1553](#L1553) | </div> |
| [1554](#L1554) | </div> |
| [1555](#L1555) |  |
| [1556](#L1556) | <?php |
| [1557](#L1557) | } |
| [1558](#L1558) | else if(strtolower($action)==strtolower('addedit')){ |
| [1559](#L1559) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [1560](#L1560) |  |
| [1561](#L1561) | ?> |
| [1562](#L1562) | <?php |
| [1563](#L1563) | if(isset($\_POST['btnsave'])){ |
| [1564](#L1564) |  |
| [1565](#L1565) | //edit save |
| [1566](#L1566) | if(isset($\_POST['imageid'])){ |
| [1567](#L1567) |  |
| [1568](#L1568) | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
| [1569](#L1569) |  |
| [1570](#L1570) | wp\_die('Security check fail'); |
| [1571](#L1571) | } |
| [1572](#L1572) |  |
| [1573](#L1573) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ) { |
| [1574](#L1574) |  |
| [1575](#L1575) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1576](#L1576) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1577](#L1577) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1578](#L1578) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1579](#L1579) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1580](#L1580) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1581](#L1581) | exit; |
| [1582](#L1582) |  |
| [1583](#L1583) | } |
| [1584](#L1584) |  |
| [1585](#L1585) |  |
| [1586](#L1586) |  |
| [1587](#L1587) | //add new |
| [1588](#L1588) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1589](#L1589) | $title=trim(htmlentities(sanitize\_text\_field($\_POST['imagetitle']),ENT\_QUOTES)); |
| [1590](#L1590) | $imageurl=trim(htmlentities(esc\_url\_raw($\_POST['imageurl']),ENT\_QUOTES)); |
| [1591](#L1591) | $imageid=intval(htmlentities(sanitize\_text\_field($\_POST['imageid']),ENT\_QUOTES)); |
| [1592](#L1592) | $imagename=""; |
| [1593](#L1593) | if(trim($\_POST['HdnMediaSelection'])!=''){ |
| [1594](#L1594) |  |
| [1595](#L1595) | $postThumbnailID=(int) htmlentities(strip\_tags($\_POST['HdnMediaSelection']),ENT\_QUOTES); |
| [1596](#L1596) | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
| [1597](#L1597) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [1598](#L1598) |  |
| [1599](#L1599) | $fileName=$photoMeta['file']; |
| [1600](#L1600) | $phyPath=ABSPATH; |
| [1601](#L1601) | $phyPath=str\_replace("\\","/",$phyPath); |
| [1602](#L1602) |  |
| [1603](#L1603) | $pathArray=pathinfo($fileName); |
| [1604](#L1604) |  |
| [1605](#L1605) | $imagename=$pathArray['basename']; |
| [1606](#L1606) |  |
| [1607](#L1607) | $upload\_dir\_n = wp\_upload\_dir(); |
| [1608](#L1608) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [1609](#L1609) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [1610](#L1610) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [1611](#L1611) |  |
| [1612](#L1612) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1613](#L1613) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1614](#L1614) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [1615](#L1615) |  |
| [1616](#L1616) | @copy($fileUrl, $imageUploadTo); |
| [1617](#L1617) | if(!file\_exists($imageUploadTo)){ |
| [1618](#L1618) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [1619](#L1619) | } |
| [1620](#L1620) |  |
| [1621](#L1621) |  |
| [1622](#L1622) | } |
| [1623](#L1623) |  |
| [1624](#L1624) | } |
| [1625](#L1625) |  |
| [1626](#L1626) |  |
| [1627](#L1627) | try{ |
| [1628](#L1628) | if($imagename!=""){ |
| [1629](#L1629) | $query = "update ".$wpdb->prefix."gv\_responsive\_slider set title='$title',image\_name='$imagename', |
| [1630](#L1630) | custom\_link='$imageurl' where id=$imageid"; |
| [1631](#L1631) | } |
| [1632](#L1632) | else{ |
| [1633](#L1633) | $query = "update ".$wpdb->prefix."gv\_responsive\_slider set title='$title', |
| [1634](#L1634) | custom\_link='$imageurl' where id=$imageid"; |
| [1635](#L1635) | } |
| [1636](#L1636) | $wpdb->query($query); |
| [1637](#L1637) |  |
| [1638](#L1638) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1639](#L1639) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [1640](#L1640) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Image updated successfully.','wp-responsive-photo-gallery' ); |
| [1641](#L1641) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1642](#L1642) |  |
| [1643](#L1643) |  |
| [1644](#L1644) | } |
| [1645](#L1645) | catch(Exception $e){ |
| [1646](#L1646) |  |
| [1647](#L1647) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1648](#L1648) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1649](#L1649) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Error while updating image.','wp-responsive-photo-gallery' ); |
| [1650](#L1650) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1651](#L1651) | } |
| [1652](#L1652) |  |
| [1653](#L1653) |  |
| [1654](#L1654) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1655](#L1655) | } |
| [1656](#L1656) | else{ |
| [1657](#L1657) |  |
| [1658](#L1658) | //add new |
| [1659](#L1659) |  |
| [1660](#L1660) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [1661](#L1661) |  |
| [1662](#L1662) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1663](#L1663) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1664](#L1664) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1665](#L1665) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1666](#L1666) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1667](#L1667) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1668](#L1668) | exit; |
| [1669](#L1669) |  |
| [1670](#L1670) | } |
| [1671](#L1671) |  |
| [1672](#L1672) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1673](#L1673) | $title=trim(htmlentities(sanitize\_text\_field($\_POST['imagetitle']),ENT\_QUOTES)); |
| [1674](#L1674) | $imageurl=trim(htmlentities(esc\_url\_raw($\_POST['imageurl']),ENT\_QUOTES)); |
| [1675](#L1675) | $createdOn=date('Y-m-d h:i:s'); |
| [1676](#L1676) | if(function\_exists('date\_i18n')){ |
| [1677](#L1677) |  |
| [1678](#L1678) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [1679](#L1679) | if(get\_option('time\_format')=='H:i') |
| [1680](#L1680) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [1681](#L1681) | else |
| [1682](#L1682) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [1683](#L1683) |  |
| [1684](#L1684) | } |
| [1685](#L1685) |  |
| [1686](#L1686) |  |
| [1687](#L1687) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1688](#L1688) |  |
| [1689](#L1689) | try{ |
| [1690](#L1690) |  |
| [1691](#L1691) | if(trim($\_POST['HdnMediaSelection'])!=''){ |
| [1692](#L1692) |  |
| [1693](#L1693) | $postThumbnailID=(int) htmlentities(strip\_tags($\_POST['HdnMediaSelection']),ENT\_QUOTES); |
| [1694](#L1694) | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
| [1695](#L1695) |  |
| [1696](#L1696) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [1697](#L1697) |  |
| [1698](#L1698) | $fileName=$photoMeta['file']; |
| [1699](#L1699) | $phyPath=ABSPATH; |
| [1700](#L1700) | $phyPath=str\_replace("\\","/",$phyPath); |
| [1701](#L1701) |  |
| [1702](#L1702) | $pathArray=pathinfo($fileName); |
| [1703](#L1703) |  |
| [1704](#L1704) | $imagename=$pathArray['basename']; |
| [1705](#L1705) |  |
| [1706](#L1706) | $upload\_dir\_n = wp\_upload\_dir(); |
| [1707](#L1707) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [1708](#L1708) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [1709](#L1709) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [1710](#L1710) |  |
| [1711](#L1711) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [1712](#L1712) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [1713](#L1713) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [1714](#L1714) |  |
| [1715](#L1715) | @copy($fileUrl, $imageUploadTo); |
| [1716](#L1716) | if(!file\_exists($imageUploadTo)){ |
| [1717](#L1717) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [1718](#L1718) | } |
| [1719](#L1719) |  |
| [1720](#L1720) | } |
| [1721](#L1721) |  |
| [1722](#L1722) | } |
| [1723](#L1723) |  |
| [1724](#L1724) |  |
| [1725](#L1725) | $query = "INSERT INTO ".$wpdb->prefix."gv\_responsive\_slider (title, image\_name,createdon,custom\_link) |
| [1726](#L1726) | VALUES ('$title','$imagename','$createdOn','$imageurl')"; |
| [1727](#L1727) |  |
| [1728](#L1728) | $wpdb->query($query); |
| [1729](#L1729) |  |
| [1730](#L1730) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1731](#L1731) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [1732](#L1732) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='New image added successfully.'; |
| [1733](#L1733) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1734](#L1734) |  |
| [1735](#L1735) |  |
| [1736](#L1736) | } |
| [1737](#L1737) | catch(Exception $e){ |
| [1738](#L1738) |  |
| [1739](#L1739) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1740](#L1740) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1741](#L1741) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='Error while adding image.'; |
| [1742](#L1742) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1743](#L1743) | } |
| [1744](#L1744) |  |
| [1745](#L1745) |  |
| [1746](#L1746) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1747](#L1747) |  |
| [1748](#L1748) | } |
| [1749](#L1749) |  |
| [1750](#L1750) | } |
| [1751](#L1751) | else{ |
| [1752](#L1752) |  |
| [1753](#L1753) | ?> |
| [1754](#L1754) | <div style="width: 100%;"> |
| [1755](#L1755) | <div style="float:left;width:100%;" > |
| [1756](#L1756) | <div class="wrap"> |
| [1757](#L1757) | <?php if(isset($\_GET['id']) and intval($\_GET['id'])>0) |
| [1758](#L1758) | { |
| [1759](#L1759) |  |
| [1760](#L1760) |  |
| [1761](#L1761) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_edit\_image' ) ) { |
| [1762](#L1762) |  |
| [1763](#L1763) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1764](#L1764) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1765](#L1765) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1766](#L1766) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1767](#L1767) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1768](#L1768) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1769](#L1769) | exit; |
| [1770](#L1770) |  |
| [1771](#L1771) | } |
| [1772](#L1772) |  |
| [1773](#L1773) | $id= intval($\_GET['id']); |
| [1774](#L1774) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$id"; |
| [1775](#L1775) | $myrow  = $wpdb->get\_row($query); |
| [1776](#L1776) |  |
| [1777](#L1777) | if(is\_object($myrow)){ |
| [1778](#L1778) |  |
| [1779](#L1779) | $title=$myrow->title; |
| [1780](#L1780) | $image\_link=$myrow->custom\_link; |
| [1781](#L1781) | $image\_name=$myrow->image\_name; |
| [1782](#L1782) |  |
| [1783](#L1783) | } |
| [1784](#L1784) |  |
| [1785](#L1785) | ?> |
| [1786](#L1786) |  |
| [1787](#L1787) | <h2><?php echo \_\_( 'Update Image','wp-responsive-photo-gallery' );?> </h2> |
| [1788](#L1788) |  |
| [1789](#L1789) | <?php }else{ |
| [1790](#L1790) |  |
| [1791](#L1791) | $title=''; |
| [1792](#L1792) | $image\_link=''; |
| [1793](#L1793) | $image\_name=''; |
| [1794](#L1794) |  |
| [1795](#L1795) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [1796](#L1796) |  |
| [1797](#L1797) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [1798](#L1798) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [1799](#L1799) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [1800](#L1800) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [1801](#L1801) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [1802](#L1802) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [1803](#L1803) | exit; |
| [1804](#L1804) |  |
| [1805](#L1805) | } |
| [1806](#L1806) | ?> |
| [1807](#L1807) | <div style="clear:both"> |
| [1808](#L1808) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [1809](#L1809) | </div> |
| [1810](#L1810) | <h2><?php echo \_\_( 'Add Image','wp-responsive-photo-gallery' );?></h2> |
| [1811](#L1811) | <?php } ?> |
| [1812](#L1812) |  |
| [1813](#L1813) | <div id="poststuff"> |
| [1814](#L1814) | <div id="post-body" class="metabox-holder columns-2"> |
| [1815](#L1815) | <div id="post-body-content"> |
| [1816](#L1816) | <form method="post" action="" id="addimage" name="addimage" enctype="multipart/form-data" > |
| [1817](#L1817) |  |
| [1818](#L1818) | <div class="stuffbox" id="namediv" style="width:100%;"> |
| [1819](#L1819) | <h3><label for="link\_name"><?php echo \_\_( 'Upload Image','wp-responsive-photo-gallery' );?></label></h3> |
| [1820](#L1820) | <div class="inside" id="fileuploaddiv"> |
| [1821](#L1821) | <?php if($image\_name!=""){ ?> |
| [1822](#L1822) | <div><b><?php echo \_\_( 'Current Image :','wp-responsive-photo-gallery' );?></b><a id="currImg" href="<?php echo $baseurl.$image\_name; ?>" target="\_new"><?php echo $image\_name; ?></a></div> |
| [1823](#L1823) | <?php } ?> |
| [1824](#L1824) |  |
| [1825](#L1825) | <div class="uploader"> |
| [1826](#L1826) |  |
| [1827](#L1827) | <a href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_( 'Click Here to upload','wp-responsive-photo-gallery' );?></b></a> |
| [1828](#L1828) | <input id="HdnMediaSelection" name="HdnMediaSelection" type="hidden" value="" /> |
| [1829](#L1829) | <br/> |
| [1830](#L1830) | </div> |
| [1831](#L1831) |  |
| [1832](#L1832) | <script> |
| [1833](#L1833) |  |
| [1834](#L1834) | jQuery(document).ready(function() { |
| [1835](#L1835) | //uploading files variable |
| [1836](#L1836) | var custom\_file\_frame; |
| [1837](#L1837) | jQuery("#myMediaUploader").click(function(event) { |
| [1838](#L1838) | event.preventDefault(); |
| [1839](#L1839) | //If the frame already exists, reopen it |
| [1840](#L1840) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [1841](#L1841) | custom\_file\_frame.close(); |
| [1842](#L1842) | } |
| [1843](#L1843) |  |
| [1844](#L1844) | //Create WP media frame. |
| [1845](#L1845) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [1846](#L1846) | //Title of media manager frame |
| [1847](#L1847) | title: "<?php echo \_\_( 'WP Media Uploader','wp-responsive-photo-gallery' );?>", |
| [1848](#L1848) | library: { |
| [1849](#L1849) | type: 'image' |
| [1850](#L1850) | }, |
| [1851](#L1851) | button: { |
| [1852](#L1852) | //Button text |
| [1853](#L1853) | text: "<?php echo \_\_( 'Set Image','wp-responsive-photo-gallery' );?>" |
| [1854](#L1854) | }, |
| [1855](#L1855) | //Do not allow multiple files, if you want multiple, set true |
| [1856](#L1856) | multiple: false |
| [1857](#L1857) | }); |
| [1858](#L1858) |  |
| [1859](#L1859) | //callback for selected image |
| [1860](#L1860) | custom\_file\_frame.on('select', function() { |
| [1861](#L1861) |  |
| [1862](#L1862) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [1863](#L1863) |  |
| [1864](#L1864) | var validExtensions=new Array(); |
| [1865](#L1865) | validExtensions[0]='jpg'; |
| [1866](#L1866) | validExtensions[1]='jpeg'; |
| [1867](#L1867) | validExtensions[2]='png'; |
| [1868](#L1868) | validExtensions[3]='gif'; |
| [1869](#L1869) |  |
| [1870](#L1870) |  |
| [1871](#L1871) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [1872](#L1872) |  |
| [1873](#L1873) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [1874](#L1874) |  |
| [1875](#L1875) | var titleTouse=""; |
| [1876](#L1876) | var imageDescriptionTouse=""; |
| [1877](#L1877) |  |
| [1878](#L1878) | if(jQuery.trim(attachment.title)!=''){ |
| [1879](#L1879) |  |
| [1880](#L1880) | titleTouse=jQuery.trim(attachment.title); |
| [1881](#L1881) | } |
| [1882](#L1882) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1883](#L1883) |  |
| [1884](#L1884) | titleTouse=jQuery.trim(attachment.caption); |
| [1885](#L1885) | } |
| [1886](#L1886) |  |
| [1887](#L1887) | if(jQuery.trim(attachment.description)!=''){ |
| [1888](#L1888) |  |
| [1889](#L1889) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [1890](#L1890) | } |
| [1891](#L1891) | else if(jQuery.trim(attachment.caption)!=''){ |
| [1892](#L1892) |  |
| [1893](#L1893) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [1894](#L1894) | } |
| [1895](#L1895) |  |
| [1896](#L1896) | jQuery("#imagetitle").val(titleTouse); |
| [1897](#L1897) | jQuery("#image\_description").val(imageDescriptionTouse); |
| [1898](#L1898) |  |
| [1899](#L1899) | if(attachment.id!=''){ |
| [1900](#L1900) | jQuery("#HdnMediaSelection").val(attachment.id); |
| [1901](#L1901) | } |
| [1902](#L1902) |  |
| [1903](#L1903) | } |
| [1904](#L1904) | else{ |
| [1905](#L1905) |  |
| [1906](#L1906) | alert('<?php echo \_\_( 'Invalid image selection','wp-responsive-photo-gallery' );?>.'); |
| [1907](#L1907) | } |
| [1908](#L1908) | //do something with attachment variable, for example attachment.filename |
| [1909](#L1909) | //Object: |
| [1910](#L1910) | //attachment.alt - image alt |
| [1911](#L1911) | //attachment.author - author id |
| [1912](#L1912) | //attachment.caption |
| [1913](#L1913) | //attachment.dateFormatted - date of image uploaded |
| [1914](#L1914) | //attachment.description |
| [1915](#L1915) | //attachment.editLink - edit link of media |
| [1916](#L1916) | //attachment.filename |
| [1917](#L1917) | //attachment.height |
| [1918](#L1918) | //attachment.icon - don't know WTF?)) |
| [1919](#L1919) | //attachment.id - id of attachment |
| [1920](#L1920) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [1921](#L1921) | //attachment.menuOrder |
| [1922](#L1922) | //attachment.mime - mime type, for example image/jpeg" |
| [1923](#L1923) | //attachment.name - name of attachment file, for example "my-image" |
| [1924](#L1924) | //attachment.status - usual is "inherit" |
| [1925](#L1925) | //attachment.subtype - "jpeg" if is "jpg" |
| [1926](#L1926) | //attachment.title |
| [1927](#L1927) | //attachment.type - "image" |
| [1928](#L1928) | //attachment.uploadedTo |
| [1929](#L1929) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [1930](#L1930) | //attachment.width |
| [1931](#L1931) | }); |
| [1932](#L1932) |  |
| [1933](#L1933) | //Open modal |
| [1934](#L1934) | custom\_file\_frame.open(); |
| [1935](#L1935) | }); |
| [1936](#L1936) | }) |
| [1937](#L1937) | </script> |
| [1938](#L1938) |  |
| [1939](#L1939) | </div> |
| [1940](#L1940) | </div> |
| [1941](#L1941) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [1942](#L1942) | <h3><label for="link\_name"><?php echo \_\_( 'Image Title','wp-responsive-photo-gallery' );?></label></h3> |
| [1943](#L1943) | <div class="inside"> |
| [1944](#L1944) | <input type="text" id="imagetitle"  size="30" name="imagetitle" value="<?php echo $title;?>"> |
| [1945](#L1945) | <div style="clear:both"></div> |
| [1946](#L1946) | <div></div> |
| [1947](#L1947) | <div style="clear:both"></div> |
| [1948](#L1948) | <p><?php echo \_\_( 'Used in image alt for seo','wp-responsive-photo-gallery' );?></p> |
| [1949](#L1949) | </div> |
| [1950](#L1950) | </div> |
| [1951](#L1951) | <div class="stuffbox" id="namediv" style="width:100%"> |
| [1952](#L1952) | <h3><label for="link\_name"><?php echo \_\_( 'Image Url','wp-responsive-photo-gallery' );?>(<?php echo \_\_( 'On click redirect to this url.','wp-responsive-photo-gallery' );?>)</label></h3> |
| [1953](#L1953) | <div class="inside"> |
| [1954](#L1954) | <input type="text" id="imageurl" class=""   size="30" name="imageurl" value="<?php echo $image\_link; ?>"> |
| [1955](#L1955) | <div style="clear:both"></div> |
| [1956](#L1956) | <div></div> |
| [1957](#L1957) | <div style="clear:both"></div> |
| [1958](#L1958) | <p><?php echo \_\_( 'On image click users will redirect to this url.','wp-responsive-photo-gallery' );?></p> |
| [1959](#L1959) | </div> |
| [1960](#L1960) | </div> |
| [1961](#L1961) |  |
| [1962](#L1962) | <?php if(isset($\_GET['id']) and intval($\_GET['id'])>0){ ?> |
| [1963](#L1963) | <input type="hidden" name="imageid" id="imageid" value="<?php echo htmlentities(intval($\_GET['id']),ENT\_QUOTES);?>"> |
| [1964](#L1964) | <?php |
| [1965](#L1965) | } |
| [1966](#L1966) | ?> |
| [1967](#L1967) | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
| [1968](#L1968) | <input type="submit" onclick="return validateFile();" name="btnsave" id="btnsave" value="<?php echo \_\_( 'Save Changes','wp-responsive-photo-gallery' );?>" class="button-primary">&nbsp;&nbsp;<input type="button" name="cancle" id="cancle" value="Cancel" class="button-primary" onclick="location.href='admin.php?page=responsive\_photo\_gallery\_image\_management'"> |
| [1969](#L1969) |  |
| [1970](#L1970) | </form> |
| [1971](#L1971) | <script type="text/javascript"> |
| [1972](#L1972) |  |
| [1973](#L1973) |  |
| [1974](#L1974) | jQuery(document).ready(function() { |
| [1975](#L1975) |  |
| [1976](#L1976) | jQuery("#addimage").validate({ |
| [1977](#L1977) | rules: { |
| [1978](#L1978) | imagetitle: { |
| [1979](#L1979) | required:true, |
| [1980](#L1980) | maxlength: 200 |
| [1981](#L1981) | },imageurl: { |
| [1982](#L1982) | url2:true, |
| [1983](#L1983) | maxlength: 500 |
| [1984](#L1984) | }, |
| [1985](#L1985) | image\_name:{ |
| [1986](#L1986) | isimage:true |
| [1987](#L1987) | } |
| [1988](#L1988) | }, |
| [1989](#L1989) | errorClass: "image\_error", |
| [1990](#L1990) | errorPlacement: function(error, element) { |
| [1991](#L1991) | error.appendTo( element.next().next().next()); |
| [1992](#L1992) | } |
| [1993](#L1993) |  |
| [1994](#L1994) |  |
| [1995](#L1995) | }) |
| [1996](#L1996) | }); |
| [1997](#L1997) |  |
| [1998](#L1998) | function validateFile(){ |
| [1999](#L1999) |  |
| [2000](#L2000) |  |
| [2001](#L2001) | if(jQuery('#currImg').length>0 || jQuery.trim(jQuery("#HdnMediaSelection").val())!="" ){ |
| [2002](#L2002) | return true; |
| [2003](#L2003) | } |
| [2004](#L2004) | else |
| [2005](#L2005) | { |
| [2006](#L2006) | jQuery("#err\_daynamic").remove(); |
| [2007](#L2007) | jQuery("#myMediaUploader").after('<br/><label class="image\_error" id="err\_daynamic"><?php echo \_\_( 'Please select file','wp-responsive-photo-gallery' );?>.</label>'); |
| [2008](#L2008) | return false; |
| [2009](#L2009) | } |
| [2010](#L2010) |  |
| [2011](#L2011) | } |
| [2012](#L2012) | </script> |
| [2013](#L2013) |  |
| [2014](#L2014) | </div> |
| [2015](#L2015) | <div id="postbox-container-1" class="postbox-container" > |
| [2016](#L2016) |  |
| [2017](#L2017) | <div class="postbox"> |
| [2018](#L2018) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [2019](#L2019) | <div class="inside"> |
| [2020](#L2020) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [2021](#L2021) |  |
| [2022](#L2022) | <div style="margin:10px 5px"> |
| [2023](#L2023) |  |
| [2024](#L2024) | </div> |
| [2025](#L2025) | </div></div> |
| [2026](#L2026) |  |
| [2027](#L2027) |  |
| [2028](#L2028) | </div> |
| [2029](#L2029) | </div> |
| [2030](#L2030) | </div> |
| [2031](#L2031) |  |
| [2032](#L2032) | </div> |
| [2033](#L2033) | </div> |
| [2034](#L2034) |  |
| [2035](#L2035) |  |
| [2036](#L2036) | <?php |
| [2037](#L2037) | } |
| [2038](#L2038) | } |
| [2039](#L2039) |  |
| [2040](#L2040) | else if(strtolower($action)==strtolower('delete')){ |
| [2041](#L2041) |  |
| [2042](#L2042) |  |
| [2043](#L2043) | $retrieved\_nonce = ''; |
| [2044](#L2044) |  |
| [2045](#L2045) | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
| [2046](#L2046) |  |
| [2047](#L2047) | $retrieved\_nonce=sanitize\_text\_field($\_GET['nonce']); |
| [2048](#L2048) |  |
| [2049](#L2049) | } |
| [2050](#L2050) | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
| [2051](#L2051) |  |
| [2052](#L2052) |  |
| [2053](#L2053) | wp\_die('Security check fail'); |
| [2054](#L2054) | } |
| [2055](#L2055) |  |
| [2056](#L2056) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ) { |
| [2057](#L2057) |  |
| [2058](#L2058) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2059](#L2059) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2060](#L2060) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2061](#L2061) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [2062](#L2062) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2063](#L2063) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2064](#L2064) | exit; |
| [2065](#L2065) |  |
| [2066](#L2066) | } |
| [2067](#L2067) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2068](#L2068) | $deleteId=(int) htmlentities(strip\_tags($\_GET['id']),ENT\_QUOTES); |
| [2069](#L2069) |  |
| [2070](#L2070) | try{ |
| [2071](#L2071) |  |
| [2072](#L2072) |  |
| [2073](#L2073) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$deleteId"; |
| [2074](#L2074) | $myrow  = $wpdb->get\_row($query); |
| [2075](#L2075) |  |
| [2076](#L2076) | if(is\_object($myrow)){ |
| [2077](#L2077) |  |
| [2078](#L2078) | $image\_name=$myrow->image\_name; |
| [2079](#L2079) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2080](#L2080) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2081](#L2081) | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
| [2082](#L2082) | @unlink($imagetoDel); |
| [2083](#L2083) |  |
| [2084](#L2084) | $query = "delete from  ".$wpdb->prefix."gv\_responsive\_slider where id=$deleteId"; |
| [2085](#L2085) | $wpdb->query($query); |
| [2086](#L2086) |  |
| [2087](#L2087) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2088](#L2088) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [2089](#L2089) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Image deleted successfully.','wp-responsive-photo-gallery' ); |
| [2090](#L2090) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2091](#L2091) | } |
| [2092](#L2092) |  |
| [2093](#L2093) |  |
| [2094](#L2094) | } |
| [2095](#L2095) | catch(Exception $e){ |
| [2096](#L2096) |  |
| [2097](#L2097) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2098](#L2098) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2099](#L2099) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Error while deleting image.','wp-responsive-photo-gallery' ); |
| [2100](#L2100) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2101](#L2101) | } |
| [2102](#L2102) |  |
| [2103](#L2103) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2104](#L2104) |  |
| [2105](#L2105) | } |
| [2106](#L2106) | else if(strtolower($action)==strtolower('deleteselected')){ |
| [2107](#L2107) |  |
| [2108](#L2108) | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
| [2109](#L2109) |  |
| [2110](#L2110) | wp\_die('Security check fail'); |
| [2111](#L2111) | } |
| [2112](#L2112) |  |
| [2113](#L2113) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_delete\_image' ) ) { |
| [2114](#L2114) |  |
| [2115](#L2115) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2116](#L2116) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2117](#L2117) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2118](#L2118) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [2119](#L2119) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2120](#L2120) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2121](#L2121) | exit; |
| [2122](#L2122) |  |
| [2123](#L2123) | } |
| [2124](#L2124) |  |
| [2125](#L2125) | $location='admin.php?page=responsive\_photo\_gallery\_image\_management'; |
| [2126](#L2126) | if(isset($\_POST) and isset($\_POST['deleteselected']) and  ( $\_POST['action']=='delete' or $\_POST['action\_upper']=='delete')){ |
| [2127](#L2127) |  |
| [2128](#L2128) | if(sizeof($\_POST['thumbnails']) >0){ |
| [2129](#L2129) |  |
| [2130](#L2130) | $deleteto=$\_POST['thumbnails']; |
| [2131](#L2131) | $implode=implode(',',$deleteto); |
| [2132](#L2132) |  |
| [2133](#L2133) | try{ |
| [2134](#L2134) |  |
| [2135](#L2135) | foreach($deleteto as $img){ |
| [2136](#L2136) |  |
| [2137](#L2137) | $img=intval($img); |
| [2138](#L2138) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider WHERE id=$img"; |
| [2139](#L2139) | $myrow  = $wpdb->get\_row($query); |
| [2140](#L2140) |  |
| [2141](#L2141) | if(is\_object($myrow)){ |
| [2142](#L2142) |  |
| [2143](#L2143) | $image\_name=$myrow->image\_name; |
| [2144](#L2144) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2145](#L2145) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2146](#L2146) | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
| [2147](#L2147) | @unlink($imagetoDel); |
| [2148](#L2148) | $query = "delete from  ".$wpdb->prefix."gv\_responsive\_slider where id=$img"; |
| [2149](#L2149) | $wpdb->query($query); |
| [2150](#L2150) |  |
| [2151](#L2151) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2152](#L2152) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [2153](#L2153) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Selected images deleted successfully.','wp-responsive-photo-gallery' ); |
| [2154](#L2154) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2155](#L2155) | } |
| [2156](#L2156) |  |
| [2157](#L2157) | } |
| [2158](#L2158) |  |
| [2159](#L2159) | } |
| [2160](#L2160) | catch(Exception $e){ |
| [2161](#L2161) |  |
| [2162](#L2162) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [2163](#L2163) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [2164](#L2164) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']='Error while deleting image.'; |
| [2165](#L2165) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [2166](#L2166) | } |
| [2167](#L2167) |  |
| [2168](#L2168) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2169](#L2169) |  |
| [2170](#L2170) |  |
| [2171](#L2171) | } |
| [2172](#L2172) | else{ |
| [2173](#L2173) |  |
| [2174](#L2174) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2175](#L2175) | } |
| [2176](#L2176) |  |
| [2177](#L2177) | } |
| [2178](#L2178) | else{ |
| [2179](#L2179) |  |
| [2180](#L2180) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [2181](#L2181) | } |
| [2182](#L2182) |  |
| [2183](#L2183) | } |
| [2184](#L2184) | } |
| [2185](#L2185) | function responsive\_photo\_gallery\_slider\_admin\_preview(){ |
| [2186](#L2186) |  |
| [2187](#L2187) |  |
| [2188](#L2188) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [2189](#L2189) |  |
| [2190](#L2190) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_preview' ) ) { |
| [2191](#L2191) |  |
| [2192](#L2192) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [2193](#L2193) |  |
| [2194](#L2194) | } |
| [2195](#L2195) |  |
| [2196](#L2196) | ?> |
| [2197](#L2197) | <div style=""> |
| [2198](#L2198) | <div style=""> |
| [2199](#L2199) | <br/> |
| [2200](#L2200) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [2201](#L2201) | <div class="wrap"> |
| [2202](#L2202) | <h2><?php echo \_\_( 'Slider Preview','wp-responsive-photo-gallery' );?></h2> |
| [2203](#L2203) | <br> |
| [2204](#L2204) |  |
| [2205](#L2205) | <?php |
| [2206](#L2206) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2207](#L2207) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2208](#L2208) |  |
| [2209](#L2209) | $uploads = wp\_upload\_dir (); |
| [2210](#L2210) | $baseDir = $uploads ['basedir']; |
| [2211](#L2211) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2212](#L2212) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2213](#L2213) |  |
| [2214](#L2214) | $baseurl=$uploads['baseurl']; |
| [2215](#L2215) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [2216](#L2216) |  |
| [2217](#L2217) |  |
| [2218](#L2218) | ?> |
| [2219](#L2219) | <?php $slider\_id\_html=time().rand(0,5000);?> |
| [2220](#L2220) | <div id="poststuff"> |
| [2221](#L2221) | <div id="post-body" class="metabox-holder columns-2"> |
| [2222](#L2222) | <div id="post-body-content"> |
| [2223](#L2223) | <div style="clear: both;"></div> |
| [2224](#L2224) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
| [2225](#L2225) | <div id="divSliderMain\_admin" style="max-width:<?php echo $settings['panel\_width'];?>px;"> |
| [2226](#L2226) | <ul id="<?php echo $slider\_id\_html;?>"> |
| [2227](#L2227) | <?php |
| [2228](#L2228) | global $wpdb; |
| [2229](#L2229) | $imageheight=$settings['panel\_height']; |
| [2230](#L2230) | $imagewidth=$settings['panel\_width']; |
| [2231](#L2231) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider order by createdon desc"; |
| [2232](#L2232) | $rows=$wpdb->get\_results($query,'ARRAY\_A'); |
| [2233](#L2233) |  |
| [2234](#L2234) | if(count($rows) > 0){ |
| [2235](#L2235) | foreach($rows as $row){ |
| [2236](#L2236) |  |
| [2237](#L2237) | $imagename=$row['image\_name']; |
| [2238](#L2238) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [2239](#L2239) | $imageUploadTo=str\_replace("\\","/",$imageUploadTo); |
| [2240](#L2240) | $pathinfo=pathinfo($imageUploadTo); |
| [2241](#L2241) | $filenamewithoutextension=$pathinfo['filename']; |
| [2242](#L2242) | $outputimg=""; |
| [2243](#L2243) |  |
| [2244](#L2244) | if($settings['panel\_scale']=='fit'){ |
| [2245](#L2245) |  |
| [2246](#L2246) | $outputimg = $baseurl.$imagename; |
| [2247](#L2247) |  |
| [2248](#L2248) | }else{ |
| [2249](#L2249) |  |
| [2250](#L2250) | list($width, $height) = getimagesize($pathToImagesFolder."/".$row['image\_name']); |
| [2251](#L2251) | if($width<$imagewidth){ |
| [2252](#L2252) | $imagewidth=$width; |
| [2253](#L2253) | } |
| [2254](#L2254) |  |
| [2255](#L2255) | if($height<$imageheight){ |
| [2256](#L2256) |  |
| [2257](#L2257) | $imageheight=$height; |
| [2258](#L2258) | } |
| [2259](#L2259) |  |
| [2260](#L2260) | $imagetoCheck=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2261](#L2261) | $imagetoCheckSmall=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2262](#L2262) |  |
| [2263](#L2263) |  |
| [2264](#L2264) | if(file\_exists($imagetoCheck)){ |
| [2265](#L2265) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2266](#L2266) |  |
| [2267](#L2267) | } |
| [2268](#L2268) | else if(file\_exists($imagetoCheckSmall)){ |
| [2269](#L2269) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2270](#L2270) | } |
| [2271](#L2271) | else{ |
| [2272](#L2272) |  |
| [2273](#L2273) | if(file\_exists($pathToImagesFolder."/".$row['image\_name'])){ |
| [2274](#L2274) |  |
| [2275](#L2275) | $resizeObj = new resize($pathToImagesFolder."/".$row['image\_name']); |
| [2276](#L2276) | $resizeObj -> resizeImage($imagewidth, $imageheight, "exact"); |
| [2277](#L2277) | $resizeObj -> saveImage($pathToImagesFolder."/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension'], 100); |
| [2278](#L2278) | //$outputimg = plugin\_dir\_url(\_\_FILE\_\_)."imagestoscroll/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2279](#L2279) |  |
| [2280](#L2280) | if(file\_exists($imagetoCheck)){ |
| [2281](#L2281) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2282](#L2282) | } |
| [2283](#L2283) | else if(file\_exists($imagetoCheckSmall)){ |
| [2284](#L2284) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2285](#L2285) | } |
| [2286](#L2286) |  |
| [2287](#L2287) | }else{ |
| [2288](#L2288) |  |
| [2289](#L2289) | $outputimg = $baseurl.$imagename; |
| [2290](#L2290) | } |
| [2291](#L2291) |  |
| [2292](#L2292) | } |
| [2293](#L2293) |  |
| [2294](#L2294) | } |
| [2295](#L2295) | ?> |
| [2296](#L2296) | <li><img data-target="1" data-href="<?php echo $row['custom\_link'];?>" org-src-="<?php echo $outputimg;?>"  /></li> |
| [2297](#L2297) |  |
| [2298](#L2298) | <?php }?> |
| [2299](#L2299) | <?php }?> |
| [2300](#L2300) | </ul> |
| [2301](#L2301) | </div> |
| [2302](#L2302) | <script type="text/javascript"> |
| [2303](#L2303) |  |
| [2304](#L2304) | jQuery(document).ready(function() { |
| [2305](#L2305) |  |
| [2306](#L2306) | <?php $galRandNo=rand(0,13313); ?> |
| [2307](#L2307) | var galleryItems<?php echo $galRandNo;?>; |
| [2308](#L2308) | jQuery(function(){ |
| [2309](#L2309) | galleryItems<?php echo $galRandNo;?> = jQuery("#<?php echo $slider\_id\_html;?>"); |
| [2310](#L2310) |  |
| [2311](#L2311) | var galleryItemDivs = jQuery('#divSliderMain\_admin'); |
| [2312](#L2312) |  |
| [2313](#L2313) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2314](#L2314) | item.parent\_data = jQuery(item).parent("#divSliderMain\_admin"); |
| [2315](#L2315) | }); |
| [2316](#L2316) |  |
| [2317](#L2317) |  |
| [2318](#L2318) | galleryItemDivs.each(function(index, item){ |
| [2319](#L2319) | jQuery("ul",this).galleryView({ |
| [2320](#L2320) |  |
| [2321](#L2321) | transition\_speed:<?php echo $settings['transition\_speed'];?>,         //INT - duration of panel/frame transition (in milliseconds) |
| [2322](#L2322) | transition\_interval:<?php echo $settings['transition\_interval'];?>,         //INT - delay between panel/frame transitions (in milliseconds) |
| [2323](#L2323) | easing:'<?php echo isset($settings['easing'])?$settings['easing']:'';?>',                 //STRING - easing method to use for animations (jQuery provides 'swing' or 'linear', more available with jQuery UI or Easing plugin) |
| [2324](#L2324) | show\_panels:<?php echo ($settings['show\_panels']==1)?'true':'false' ;?>,                 //BOOLEAN - flag to show or hide panel portion of gallery |
| [2325](#L2325) | show\_panel\_nav:<?php echo ($settings['show\_panel\_nav']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel navigation buttons |
| [2326](#L2326) | enable\_overlays:<?php echo ($settings['enable\_overlays']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel overlays |
| [2327](#L2327) | panel\_width:<?php echo $settings['panel\_width'];?>,                 //INT - width of gallery panel (in pixels) |
| [2328](#L2328) | panel\_height:<?php echo $settings['panel\_height'];?>,                 //INT - height of gallery panel (in pixels) |
| [2329](#L2329) | panel\_animation:'<?php echo $settings['panel\_animation'];?>',         //STRING - animation method for panel transitions (crossfade,fade,slide,none) |
| [2330](#L2330) | panel\_scale: '<?php echo $settings['panel\_scale'];?>',             //STRING - cropping option for panel images (crop = scale image and fit to aspect ratio determined by panel\_width and panel\_height, fit = scale image and preserve original aspect ratio) |
| [2331](#L2331) | overlay\_position:'<?php echo $settings['overlay\_position'];?>',     //STRING - position of panel overlay (bottom, top) |
| [2332](#L2332) | pan\_images:<?php echo ($settings['pan\_images']==1)?'true':'false' ;?>,                //BOOLEAN - flag to allow user to grab/drag oversized images within gallery |
| [2333](#L2333) | pan\_style:'<?php echo $settings['pan\_style'];?>',                //STRING - panning method (drag = user clicks and drags image to pan, track = image automatically pans based on mouse position |
| [2334](#L2334) | start\_frame:'<?php echo $settings['start\_frame'];?>',                 //INT - index of panel/frame to show first when gallery loads |
| [2335](#L2335) | show\_filmstrip:<?php echo ($settings['show\_filmstrip']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide filmstrip portion of gallery |
| [2336](#L2336) | show\_filmstrip\_nav:<?php echo ($settings['show\_filmstrip\_nav']==1)?'true':'false' ;?>,         //BOOLEAN - flag indicating whether to display navigation buttons |
| [2337](#L2337) | enable\_slideshow:<?php echo ($settings['enable\_slideshow']==1)?'true':'false' ;?>,            //BOOLEAN - flag indicating whether to display slideshow play/pause button |
| [2338](#L2338) | autoplay:<?php echo ($settings['autoplay']==1)?'true':'false' ;?>,                //BOOLEAN - flag to start slideshow on gallery load |
| [2339](#L2339) | show\_captions:<?php echo ($settings['show\_captions']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide frame captions |
| [2340](#L2340) | filmstrip\_style: '<?php echo $settings['filmstrip\_style'];?>',         //STRING - type of filmstrip to use (scroll = display one line of frames, scroll filmstrip if necessary, showall = display multiple rows of frames if necessary) |
| [2341](#L2341) | filmstrip\_position:'<?php echo $settings['filmstrip\_position'];?>',     //STRING - position of filmstrip within gallery (bottom, top, left, right) |
| [2342](#L2342) | frame\_width:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2343](#L2343) | frame\_height:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2344](#L2344) | frame\_opacity:<?php echo $settings['frame\_opacity'];?>,             //FLOAT - transparency of non-active frames (1.0 = opaque, 0.0 = transparent) |
| [2345](#L2345) | frame\_scale: '<?php echo $settings['frame\_scale'];?>',             //STRING - cropping option for filmstrip images (same as above) |
| [2346](#L2346) | frame\_gap:<?php echo $settings['frame\_gap'];?>,                     //INT - spacing between frames within filmstrip (in pixels) |
| [2347](#L2347) | show\_infobar:<?php echo ($settings['show\_infobar']==1)?'true':'false' ;?>,                //BOOLEAN - flag to show or hide infobar |
| [2348](#L2348) | infobar\_opacity:<?php echo $settings['infobar\_opacity'];?>,               //FLOAT - transparency for info bar |
| [2349](#L2349) | clickable: 'all' |
| [2350](#L2350) |  |
| [2351](#L2351) | }); |
| [2352](#L2352) |  |
| [2353](#L2353) | }); |
| [2354](#L2354) |  |
| [2355](#L2355) | }); |
| [2356](#L2356) |  |
| [2357](#L2357) |  |
| [2358](#L2358) | // |
| [2359](#L2359) | // Resize the image gallery |
| [2360](#L2360) | // |
| [2361](#L2361) | var oldsize\_w<?php echo $galRandNo;?>=<?php echo $settings['panel\_width'];?>; |
| [2362](#L2362) | var oldsize\_h<?php echo $galRandNo;?>=<?php echo $settings['panel\_height'];?>; |
| [2363](#L2363) |  |
| [2364](#L2364) | function resizegallery<?php echo $galRandNo;?>(){ |
| [2365](#L2365) |  |
| [2366](#L2366) | if(galleryItems<?php echo $galRandNo;?>==undefined){return;} |
| [2367](#L2367) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2368](#L2368) | var $parent = item.parent\_data; |
| [2369](#L2369) |  |
| [2370](#L2370) | // width based on parent? |
| [2371](#L2371) | var width = ($parent.innerWidth()-10);//2 times 5 pixels margin |
| [2372](#L2372) | var height = ($parent.innerHeight()-10);//2 times 5 pixels margin |
| [2373](#L2373) | if(oldsize\_w<?php echo $galRandNo;?>==width){ |
| [2374](#L2374) | return; |
| [2375](#L2375) | } |
| [2376](#L2376) | oldsize\_w<?php echo $galRandNo;?>=width; |
| [2377](#L2377) | var resizeToHeight=width/3\*2; |
| [2378](#L2378) | if(resizeToHeight><?php echo $settings['panel\_height'];?>){ |
| [2379](#L2379) | resizeToHeight=<?php echo $settings['panel\_height'];?>; |
| [2380](#L2380) | } |
| [2381](#L2381) | thumbfactor = width/(<?php echo $settings['panel\_width'];?>-10); |
| [2382](#L2382) |  |
| [2383](#L2383) | jQuery(item).resizeGalleryView( |
| [2384](#L2384) | width,resizeToHeight, <?php echo $settings['frame\_width'];?>\*thumbfactor, <?php echo $settings['frame\_height'];?>\*thumbfactor); |
| [2385](#L2385) |  |
| [2386](#L2386) | }); |
| [2387](#L2387) | } |
| [2388](#L2388) |  |
| [2389](#L2389) | var inited<?php echo $galRandNo;?>=false; |
| [2390](#L2390) |  |
| [2391](#L2391) | function onresize<?php echo $galRandNo;?>(){ |
| [2392](#L2392) |  |
| [2393](#L2393) | resizegallery<?php echo $galRandNo;?>(); |
| [2394](#L2394) | inited<?php echo $galRandNo;?>=true; |
| [2395](#L2395) | } |
| [2396](#L2396) |  |
| [2397](#L2397) |  |
| [2398](#L2398) | jQuery(window).resize(onresize<?php echo $galRandNo;?>); |
| [2399](#L2399) | jQuery( document ).ready(function() { |
| [2400](#L2400) | onresize<?php echo $galRandNo;?>(); |
| [2401](#L2401) | }); |
| [2402](#L2402) |  |
| [2403](#L2403) | }); |
| [2404](#L2404) |  |
| [2405](#L2405) |  |
| [2406](#L2406) | </script> |
| [2407](#L2407) | </div> |
| [2408](#L2408) | </div> |
| [2409](#L2409) | </div> |
| [2410](#L2410) | </div> |
| [2411](#L2411) | </div> |
| [2412](#L2412) | <div class="clear"></div> |
| [2413](#L2413) | </div> |
| [2414](#L2414) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress Post/Page use below Short code','wp-responsive-photo-gallery' );?></h3> |
| [2415](#L2415) | <input type="text" value="[print\_my\_responsive\_photo\_gallery]" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [2416](#L2416) | <div class="clear"></div> |
| [2417](#L2417) | <h3><?php echo \_\_( 'To print this slideshow gallery into WordPress theme/template PHP files use below php code','wp-responsive-photo-gallery' );?></h3> |
| [2418](#L2418) | <input type="text" value="&lt;?php echo do\_shortcode('[print\_my\_responsive\_photo\_gallery]'); ?&gt;" style="width: 400px;height: 30px" onclick="this.focus();this.select()" /> |
| [2419](#L2419) | <div class="clear"></div> |
| [2420](#L2420) | <?php |
| [2421](#L2421) | } |
| [2422](#L2422) |  |
| [2423](#L2423) | function print\_my\_responsive\_photo\_gallery\_func(){ |
| [2424](#L2424) |  |
| [2425](#L2425) | $settings=get\_option('my\_responsive\_photo\_gallery\_slider\_settings'); |
| [2426](#L2426) | $rand\_Numb=uniqid('gallery\_slider'); |
| [2427](#L2427) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [2428](#L2428) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [2429](#L2429) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2430](#L2430) |  |
| [2431](#L2431) | $uploads = wp\_upload\_dir (); |
| [2432](#L2432) | $baseDir = $uploads ['basedir']; |
| [2433](#L2433) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2434](#L2434) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2435](#L2435) |  |
| [2436](#L2436) | $baseurl=$uploads['baseurl']; |
| [2437](#L2437) | $baseurl.='/wp-responsive-photo-gallery/'; |
| [2438](#L2438) |  |
| [2439](#L2439) | wp\_enqueue\_style('jquery.galleryview-3.0-dev-responsive'); |
| [2440](#L2440) | wp\_enqueue\_script('jquery'); |
| [2441](#L2441) | wp\_enqueue\_script('jquery-ui-core'); |
| [2442](#L2442) | wp\_enqueue\_script('jquery.timers-1.2'); |
| [2443](#L2443) | wp\_enqueue\_script('jquery.easing.1.3'); |
| [2444](#L2444) | wp\_enqueue\_script('jquery.gview-3.0-dev-responsive'); |
| [2445](#L2445) |  |
| [2446](#L2446) | ob\_start(); |
| [2447](#L2447) | ?><!-- print\_my\_responsive\_photo\_gallery\_func --><div id="divSliderMain\_admin\_<?php echo $rand\_Numb;?>" style="max-width:<?php echo $settings['panel\_width'];?>px;"> |
| [2448](#L2448) | <ul id="<?php echo $rand\_Numb;?>" style="visibility: hidden"> |
| [2449](#L2449) | <?php |
| [2450](#L2450) | global $wpdb; |
| [2451](#L2451) | $imageheight=$settings['panel\_height']; |
| [2452](#L2452) | $imagewidth=$settings['panel\_width']; |
| [2453](#L2453) | $query="SELECT \* FROM ".$wpdb->prefix."gv\_responsive\_slider order by createdon desc"; |
| [2454](#L2454) | $rows=$wpdb->get\_results($query,'ARRAY\_A'); |
| [2455](#L2455) |  |
| [2456](#L2456) | if(count($rows) > 0){ |
| [2457](#L2457) | foreach($rows as $row){ |
| [2458](#L2458) |  |
| [2459](#L2459) | $imagename=$row['image\_name']; |
| [2460](#L2460) | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
| [2461](#L2461) | $imageUploadTo=str\_replace("\\","/",$imageUploadTo); |
| [2462](#L2462) | $pathinfo=pathinfo($imageUploadTo); |
| [2463](#L2463) | $filenamewithoutextension=$pathinfo['filename']; |
| [2464](#L2464) | $outputimg=""; |
| [2465](#L2465) |  |
| [2466](#L2466) | if($settings['panel\_scale']=='fit'){ |
| [2467](#L2467) |  |
| [2468](#L2468) | $outputimg = $baseurl.$imagename; |
| [2469](#L2469) |  |
| [2470](#L2470) | }else{ |
| [2471](#L2471) | list($width, $height) = getimagesize($pathToImagesFolder."/".$row['image\_name']); |
| [2472](#L2472) | if($width<$imagewidth){ |
| [2473](#L2473) | $imagewidth=$width; |
| [2474](#L2474) | } |
| [2475](#L2475) |  |
| [2476](#L2476) | if($height<$imageheight){ |
| [2477](#L2477) |  |
| [2478](#L2478) | $imageheight=$height; |
| [2479](#L2479) | } |
| [2480](#L2480) |  |
| [2481](#L2481) | $imagetoCheck=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2482](#L2482) | $imagetoCheckSmall=$pathToImagesFolder.'/'.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2483](#L2483) |  |
| [2484](#L2484) | if(file\_exists($imagetoCheck)){ |
| [2485](#L2485) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2486](#L2486) |  |
| [2487](#L2487) | } |
| [2488](#L2488) | else if(file\_exists($imagetoCheckSmall)){ |
| [2489](#L2489) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.strtolower($pathinfo['extension']); |
| [2490](#L2490) | } |
| [2491](#L2491) | else{ |
| [2492](#L2492) |  |
| [2493](#L2493) | if(file\_exists($pathToImagesFolder."/".$row['image\_name'])){ |
| [2494](#L2494) |  |
| [2495](#L2495) | $resizeObj = new resize($pathToImagesFolder."/".$row['image\_name']); |
| [2496](#L2496) | $resizeObj -> resizeImage($imagewidth, $imageheight, "exact"); |
| [2497](#L2497) | $resizeObj -> saveImage($pathToImagesFolder."/".$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension'], 100); |
| [2498](#L2498) | $outputimg = $baseurl.$filenamewithoutextension.'\_'.$imageheight.'\_'.$imagewidth.'.'.$pathinfo['extension']; |
| [2499](#L2499) | }else{ |
| [2500](#L2500) |  |
| [2501](#L2501) | $outputimg = $baseurl.$imagename; |
| [2502](#L2502) | } |
| [2503](#L2503) |  |
| [2504](#L2504) | } |
| [2505](#L2505) |  |
| [2506](#L2506) | } |
| [2507](#L2507) | ?> |
| [2508](#L2508) | <li><img data-target="1" data-href="<?php echo $row['custom\_link'];?>" org-src-="<?php echo $outputimg;?>"  /></li> |
| [2509](#L2509) |  |
| [2510](#L2510) | <?php }?> |
| [2511](#L2511) | <?php }?> |
| [2512](#L2512) | </ul> |
| [2513](#L2513) | </div> |
| [2514](#L2514) | <script type="text/javascript"> |
| [2515](#L2515) |  |
| [2516](#L2516) |  |
| [2517](#L2517) | <?php $intval= uniqid('interval\_');?> |
| [2518](#L2518) |  |
| [2519](#L2519) | var <?php echo $intval;?> = setInterval(function() { |
| [2520](#L2520) |  |
| [2521](#L2521) | if(document.readyState === 'complete') { |
| [2522](#L2522) |  |
| [2523](#L2523) | clearInterval(<?php echo $intval;?>); |
| [2524](#L2524) |  |
| [2525](#L2525) |  |
| [2526](#L2526) |  |
| [2527](#L2527) | jQuery("#<?php echo $rand\_Numb;?>").css('visibility','visible'); |
| [2528](#L2528) | <?php $galRandNo=rand(0,13313); ?> |
| [2529](#L2529) | var galleryItems<?php echo $galRandNo;?>; |
| [2530](#L2530) | jQuery(function(){ |
| [2531](#L2531) | galleryItems<?php echo $galRandNo;?> = jQuery("#<?php echo $rand\_Numb;?>"); |
| [2532](#L2532) |  |
| [2533](#L2533) | var galleryItemDivs = jQuery('#divSliderMain\_admin\_<?php echo $rand\_Numb;?>'); |
| [2534](#L2534) |  |
| [2535](#L2535) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2536](#L2536) | item.parent\_data = jQuery(item).parent("#divSliderMain\_admin\_<?php echo $rand\_Numb;?>"); |
| [2537](#L2537) | }); |
| [2538](#L2538) |  |
| [2539](#L2539) | galleryItemDivs.each(function(index, item){ |
| [2540](#L2540) |  |
| [2541](#L2541) | jQuery("ul",this).galleryView({ |
| [2542](#L2542) |  |
| [2543](#L2543) | transition\_speed:<?php echo $settings['transition\_speed'];?>,         //INT - duration of panel/frame transition (in milliseconds) |
| [2544](#L2544) | transition\_interval:<?php echo $settings['transition\_interval'];?>,         //INT - delay between panel/frame transitions (in milliseconds) |
| [2545](#L2545) | easing:'<?php echo isset($settings['easing'])?$settings['easing']:'';?>',                 //STRING - easing method to use for animations (jQuery provides 'swing' or 'linear', more available with jQuery UI or Easing plugin) |
| [2546](#L2546) | show\_panels:<?php echo ($settings['show\_panels']==1)?'true':'false' ;?>,                 //BOOLEAN - flag to show or hide panel portion of gallery |
| [2547](#L2547) | show\_panel\_nav:<?php echo ($settings['show\_panel\_nav']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel navigation buttons |
| [2548](#L2548) | enable\_overlays:<?php echo ($settings['enable\_overlays']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide panel overlays |
| [2549](#L2549) | panel\_width:<?php echo $settings['panel\_width'];?>,                 //INT - width of gallery panel (in pixels) |
| [2550](#L2550) | panel\_height:<?php echo $settings['panel\_height'];?>,                 //INT - height of gallery panel (in pixels) |
| [2551](#L2551) | panel\_animation:'<?php echo $settings['panel\_animation'];?>',         //STRING - animation method for panel transitions (crossfade,fade,slide,none) |
| [2552](#L2552) | panel\_scale: '<?php echo $settings['panel\_scale'];?>',             //STRING - cropping option for panel images (crop = scale image and fit to aspect ratio determined by panel\_width and panel\_height, fit = scale image and preserve original aspect ratio) |
| [2553](#L2553) | overlay\_position:'<?php echo $settings['overlay\_position'];?>',     //STRING - position of panel overlay (bottom, top) |
| [2554](#L2554) | pan\_images:<?php echo ($settings['pan\_images']==1)?'true':'false' ;?>,                //BOOLEAN - flag to allow user to grab/drag oversized images within gallery |
| [2555](#L2555) | pan\_style:'<?php echo $settings['pan\_style'];?>',                //STRING - panning method (drag = user clicks and drags image to pan, track = image automatically pans based on mouse position |
| [2556](#L2556) | start\_frame:'<?php echo $settings['start\_frame'];?>',                 //INT - index of panel/frame to show first when gallery loads |
| [2557](#L2557) | show\_filmstrip:<?php echo ($settings['show\_filmstrip']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide filmstrip portion of gallery |
| [2558](#L2558) | show\_filmstrip\_nav:<?php echo ($settings['show\_filmstrip\_nav']==1)?'true':'false' ;?>,         //BOOLEAN - flag indicating whether to display navigation buttons |
| [2559](#L2559) | enable\_slideshow:<?php echo ($settings['enable\_slideshow']==1)?'true':'false' ;?>,            //BOOLEAN - flag indicating whether to display slideshow play/pause button |
| [2560](#L2560) | autoplay:<?php echo ($settings['autoplay']==1)?'true':'false' ;?>,                //BOOLEAN - flag to start slideshow on gallery load |
| [2561](#L2561) | show\_captions:<?php echo ($settings['show\_captions']==1)?'true':'false' ;?>,             //BOOLEAN - flag to show or hide frame captions |
| [2562](#L2562) | filmstrip\_style: '<?php echo $settings['filmstrip\_style'];?>',         //STRING - type of filmstrip to use (scroll = display one line of frames, scroll filmstrip if necessary, showall = display multiple rows of frames if necessary) |
| [2563](#L2563) | filmstrip\_position:'<?php echo $settings['filmstrip\_position'];?>',     //STRING - position of filmstrip within gallery (bottom, top, left, right) |
| [2564](#L2564) | frame\_width:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2565](#L2565) | frame\_height:<?php echo $settings['frame\_width'];?>,                 //INT - width of filmstrip frames (in pixels) |
| [2566](#L2566) | frame\_opacity:<?php echo $settings['frame\_opacity'];?>,             //FLOAT - transparency of non-active frames (1.0 = opaque, 0.0 = transparent) |
| [2567](#L2567) | frame\_scale: '<?php echo $settings['frame\_scale'];?>',             //STRING - cropping option for filmstrip images (same as above) |
| [2568](#L2568) | frame\_gap:<?php echo $settings['frame\_gap'];?>,                     //INT - spacing between frames within filmstrip (in pixels) |
| [2569](#L2569) | show\_infobar:<?php echo ($settings['show\_infobar']==1)?'true':'false' ;?>,                //BOOLEAN - flag to show or hide infobar |
| [2570](#L2570) | infobar\_opacity:<?php echo $settings['infobar\_opacity'];?>,               //FLOAT - transparency for info bar |
| [2571](#L2571) | clickable: 'all' |
| [2572](#L2572) |  |
| [2573](#L2573) | }); |
| [2574](#L2574) |  |
| [2575](#L2575) | }); |
| [2576](#L2576) |  |
| [2577](#L2577) |  |
| [2578](#L2578) | var oldsize\_w<?php echo $galRandNo;?>=<?php echo $settings['panel\_width'];?>; |
| [2579](#L2579) | var oldsize\_h<?php echo $galRandNo;?>=<?php echo $settings['panel\_height'];?>; |
| [2580](#L2580) |  |
| [2581](#L2581) | function resizegallery<?php echo $galRandNo;?>(){ |
| [2582](#L2582) |  |
| [2583](#L2583) | if(galleryItems<?php echo $galRandNo;?>==undefined){return;} |
| [2584](#L2584) | galleryItems<?php echo $galRandNo;?>.each(function (index, item){ |
| [2585](#L2585) | var $parent = item.parent\_data; |
| [2586](#L2586) |  |
| [2587](#L2587) | // width based on parent? |
| [2588](#L2588) | var width = ($parent.innerWidth()-10);//2 times 5 pixels margin |
| [2589](#L2589) | var height = ($parent.innerHeight()-10);//2 times 5 pixels margin |
| [2590](#L2590) | if(oldsize\_w<?php echo $galRandNo;?>==width){ |
| [2591](#L2591) | return; |
| [2592](#L2592) | } |
| [2593](#L2593) | oldsize\_w<?php echo $galRandNo;?>=width; |
| [2594](#L2594) | var resizeToHeight=width/3\*2; |
| [2595](#L2595) | if(resizeToHeight><?php echo $settings['panel\_height'];?>){ |
| [2596](#L2596) | resizeToHeight=<?php echo $settings['panel\_height'];?>; |
| [2597](#L2597) | } |
| [2598](#L2598) | thumbfactor = width/(<?php echo $settings['panel\_width'];?>-10); |
| [2599](#L2599) |  |
| [2600](#L2600) | jQuery(item).resizeGalleryView( |
| [2601](#L2601) | width, |
| [2602](#L2602) | resizeToHeight, <?php echo $settings['frame\_width'];?>\*thumbfactor, <?php echo $settings['frame\_height'];?>\*thumbfactor); |
| [2603](#L2603) |  |
| [2604](#L2604) | }); |
| [2605](#L2605) | } |
| [2606](#L2606) |  |
| [2607](#L2607) | var inited<?php echo $galRandNo;?>=false; |
| [2608](#L2608) |  |
| [2609](#L2609) | function onresize<?php echo $galRandNo;?>(){ |
| [2610](#L2610) | resizegallery<?php echo $galRandNo;?>(); |
| [2611](#L2611) | inited<?php echo $galRandNo;?>=true; |
| [2612](#L2612) | } |
| [2613](#L2613) |  |
| [2614](#L2614) |  |
| [2615](#L2615) | jQuery(window).resize(onresize<?php echo $galRandNo;?>); |
| [2616](#L2616) | jQuery( document ).ready(function() { |
| [2617](#L2617) | onresize<?php echo $galRandNo;?>(); |
| [2618](#L2618) | }); |
| [2619](#L2619) |  |
| [2620](#L2620) | }); |
| [2621](#L2621) |  |
| [2622](#L2622) |  |
| [2623](#L2623) | } |
| [2624](#L2624) | }, 100); |
| [2625](#L2625) |  |
| [2626](#L2626) |  |
| [2627](#L2627) | </script><!-- end print\_my\_responsive\_photo\_gallery\_func --><?php |
| [2628](#L2628) | $output = ob\_get\_clean(); |
| [2629](#L2629) | return $output; |
| [2630](#L2630) | } |
| [2631](#L2631) |  |
| [2632](#L2632) | function my\_responsive\_photo\_gallery\_get\_wp\_version() { |
| [2633](#L2633) |  |
| [2634](#L2634) | global $wp\_version; |
| [2635](#L2635) | return $wp\_version; |
| [2636](#L2636) | } |
| [2637](#L2637) |  |
| [2638](#L2638) |  |
| [2639](#L2639) | function my\_responsive\_photo\_gallery\_is\_plugin\_page() { |
| [2640](#L2640) | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
| [2641](#L2641) |  |
| [2642](#L2642) | foreach (array('responsive\_photo\_gallery\_image\_management') as $allowURI) { |
| [2643](#L2643) | if(stristr($server\_uri, $allowURI)) return true; |
| [2644](#L2644) | } |
| [2645](#L2645) | return false; |
| [2646](#L2646) | } |
| [2647](#L2647) |  |
| [2648](#L2648) |  |
| [2649](#L2649) | function rjg\_save\_image\_remote($url,$saveto){ |
| [2650](#L2650) |  |
| [2651](#L2651) | $raw = wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [2652](#L2652) |  |
| [2653](#L2653) | if(file\_exists($saveto)){ |
| [2654](#L2654) | @unlink($saveto); |
| [2655](#L2655) | } |
| [2656](#L2656) | $fp = @fopen($saveto,'x'); |
| [2657](#L2657) | @fwrite($fp, $raw); |
| [2658](#L2658) | @fclose($fp); |
| [2659](#L2659) | } |
| [2660](#L2660) |  |
| [2661](#L2661) |  |
| [2662](#L2662) | function rjg\_i13\_get\_http\_response\_code\_gallery($url) { |
| [2663](#L2663) | $headers = @get\_headers($url); |
| [2664](#L2664) | return @substr($headers[0], 9, 3); |
| [2665](#L2665) | } |
| [2666](#L2666) |  |
| [2667](#L2667) |  |
| [2668](#L2668) | function rjg\_get\_grid\_data\_justified\_gallery\_callback() { |
| [2669](#L2669) |  |
| [2670](#L2670) | $retrieved\_nonce=''; |
| [2671](#L2671) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [2672](#L2672) |  |
| [2673](#L2673) | $retrieved\_nonce = $\_POST['vNonce']; |
| [2674](#L2674) | } |
| [2675](#L2675) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [2676](#L2676) |  |
| [2677](#L2677) |  |
| [2678](#L2678) | wp\_die('Security check fail'); |
| [2679](#L2679) | } |
| [2680](#L2680) |  |
| [2681](#L2681) | ob\_start(); |
| [2682](#L2682) | global $wpdb; |
| [2683](#L2683) |  |
| [2684](#L2684) | $pageUrl = urldecode($\_POST['page\_url']); |
| [2685](#L2685) | $urlComponents = parse\_url($pageUrl); |
| [2686](#L2686) | $queryStr = $urlComponents['query']; |
| [2687](#L2687) | if ($queryStr != '') { |
| [2688](#L2688) | parse\_str($queryStr, $qStrArr); |
| [2689](#L2689) | } |
| [2690](#L2690) |  |
| [2691](#L2691) | $pagenum = 0; |
| [2692](#L2692) | if (isset($qStrArr['pagenum']) and (int) $qStrArr['pagenum'] > 0) { |
| [2693](#L2693) |  |
| [2694](#L2694) | $pagenum = intval($qStrArr['pagenum']); |
| [2695](#L2695) | } |
| [2696](#L2696) |  |
| [2697](#L2697) | $settings=get\_option('rjg\_settings'); |
| [2698](#L2698) |  |
| [2699](#L2699) |  |
| [2700](#L2700) | $limit = $settings['page\_size']; |
| [2701](#L2701) | $offset = ( $pagenum - 1 ) \* $limit; |
| [2702](#L2702) |  |
| [2703](#L2703) | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
| [2704](#L2704) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [2705](#L2705) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [2706](#L2706) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [2707](#L2707) |  |
| [2708](#L2708) |  |
| [2709](#L2709) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [2710](#L2710) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [2711](#L2711) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [2712](#L2712) |  |
| [2713](#L2713) | $uploads = wp\_upload\_dir (); |
| [2714](#L2714) | $baseDir = $uploads ['basedir']; |
| [2715](#L2715) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [2716](#L2716) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [2717](#L2717) | $baseurl = $uploads ['baseurl']; |
| [2718](#L2718) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [2719](#L2719) |  |
| [2720](#L2720) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [2721](#L2721) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [2722](#L2722) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [2723](#L2723) | $randOmeRel = uniqid ( 'rel\_' ); |
| [2724](#L2724) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [2725](#L2725) | $vNonce = wp\_create\_nonce('vNonce'); |
| [2726](#L2726) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2727](#L2727) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [2728](#L2728) | $imageMargin=$settings['imageMargin']; |
| [2729](#L2729) |  |
| [2730](#L2730) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [2731](#L2731) | if(strtolower($LoadingBackColor)=='none'){ |
| [2732](#L2732) | $LoadingBackColor='#ffffff'; |
| [2733](#L2733) | } |
| [2734](#L2734) | if (is\_array($settings)) { |
| [2735](#L2735) |  |
| [2736](#L2736) | ?> |
| [2737](#L2737) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [2738](#L2738) | <div style="clear: both;"></div> |
| [2739](#L2739) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [2740](#L2740) | <div style="clear: both;"></div> |
| [2741](#L2741) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [2742](#L2742) |  |
| [2743](#L2743) |  |
| [2744](#L2744) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" > |
| [2745](#L2745) |  |
| [2746](#L2746) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [2747](#L2747) |  |
| [2748](#L2748) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [2749](#L2749) |  |
| [2750](#L2750) | <?php |
| [2751](#L2751) |  |
| [2752](#L2752) | $imageheight = $settings ['imageheight']; |
| [2753](#L2753) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [2754](#L2754) | $firstChild='firstimg'; |
| [2755](#L2755) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [2756](#L2756) |  |
| [2757](#L2757) |  |
| [2758](#L2758) | if (count ( $rows ) > 0) { |
| [2759](#L2759) |  |
| [2760](#L2760) | foreach ( $rows as $row ) { |
| [2761](#L2761) |  |
| [2762](#L2762) | $imagename = $row ['image\_name']; |
| [2763](#L2763) | $video\_url = $row ['videourl']; |
| [2764](#L2764) | $video\_url\_org = $row ['murl']; |
| [2765](#L2765) | $Url\_vid = @parse\_url($video\_url\_org); |
| [2766](#L2766) |  |
| [2767](#L2767) |  |
| [2768](#L2768) |  |
| [2769](#L2769) | $relend = ''; |
| [2770](#L2770) | $flag=false; |
| [2771](#L2771) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [2772](#L2772) |  |
| [2773](#L2773) |  |
| [2774](#L2774) | parse\_str($Url\_vid['query'], $get\_array); |
| [2775](#L2775) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [2776](#L2776) |  |
| [2777](#L2777) | foreach($get\_array as $k=>$v){ |
| [2778](#L2778) |  |
| [2779](#L2779) | if($flag==false){ |
| [2780](#L2780) |  |
| [2781](#L2781) | $flag=true; |
| [2782](#L2782) | $relend.="?$k=$v"; |
| [2783](#L2783) | } |
| [2784](#L2784) | else{ |
| [2785](#L2785) |  |
| [2786](#L2786) | $relend.="&$k=$v"; |
| [2787](#L2787) |  |
| [2788](#L2788) | } |
| [2789](#L2789) |  |
| [2790](#L2790) |  |
| [2791](#L2791) | } |
| [2792](#L2792) |  |
| [2793](#L2793) |  |
| [2794](#L2794) | } |
| [2795](#L2795) |  |
| [2796](#L2796) |  |
| [2797](#L2797) |  |
| [2798](#L2798) | } |
| [2799](#L2799) |  |
| [2800](#L2800) | $vtype= $row ['vtype']; |
| [2801](#L2801) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [2802](#L2802) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [2803](#L2803) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [2804](#L2804) | $filenamewithoutextension = $pathinfo ['filename']; |
| [2805](#L2805) |  |
| [2806](#L2806) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [2807](#L2807) | $outputimg=$outputimgmain; |
| [2808](#L2808) | $media\_type=$row['media\_type']; |
| [2809](#L2809) | $hoverClass=''; |
| [2810](#L2810) | if($media\_type=="link") |
| [2811](#L2811) | $hoverClass="playbtnCss\_link"; |
| [2812](#L2812) | else if($media\_type=="video") |
| [2813](#L2813) | $hoverClass="playbtnCss\_video"; |
| [2814](#L2814) | else if($media\_type=="image") |
| [2815](#L2815) | $hoverClass="playbtnCss\_zoom"; |
| [2816](#L2816) |  |
| [2817](#L2817) | $title = ""; |
| [2818](#L2818) | $rowTitle = $row['title']; |
| [2819](#L2819) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [2820](#L2820) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [2821](#L2821) |  |
| [2822](#L2822) |  |
| [2823](#L2823) |  |
| [2824](#L2824) | $open\_link\_in = $row['open\_link\_in']; |
| [2825](#L2825) | $open\_title\_link\_in = 1; |
| [2826](#L2826) |  |
| [2827](#L2827) | if(!$open\_title\_link\_in) |
| [2828](#L2828) | $openImageInNewTab = '\_self'; |
| [2829](#L2829) | else |
| [2830](#L2830) | $openImageInNewTab = '\_blank'; |
| [2831](#L2831) |  |
| [2832](#L2832) | $embed\_url=$row['embed\_url'].$relend; |
| [2833](#L2833) | if($media\_type=="video"){ |
| [2834](#L2834) |  |
| [2835](#L2835) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [2836](#L2836) |  |
| [2837](#L2837) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [2838](#L2838) |  |
| [2839](#L2839) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [2840](#L2840) |  |
| [2841](#L2841) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [2842](#L2842) |  |
| [2843](#L2843) | } else { |
| [2844](#L2844) |  |
| [2845](#L2845) | if ($row['mdescription'] != '') |
| [2846](#L2846) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [2847](#L2847) |  |
| [2848](#L2848) | } |
| [2849](#L2849) | } |
| [2850](#L2850) | else if($media\_type=="image"){ |
| [2851](#L2851) |  |
| [2852](#L2852) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [2853](#L2853) |  |
| [2854](#L2854) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [2855](#L2855) |  |
| [2856](#L2856) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [2857](#L2857) |  |
| [2858](#L2858) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [2859](#L2859) |  |
| [2860](#L2860) | } else { |
| [2861](#L2861) |  |
| [2862](#L2862) | if ($row['mdescription'] != '') |
| [2863](#L2863) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [2864](#L2864) |  |
| [2865](#L2865) | } |
| [2866](#L2866) |  |
| [2867](#L2867) | } |
| [2868](#L2868) |  |
| [2869](#L2869) |  |
| [2870](#L2870) | ?> |
| [2871](#L2871) |  |
| [2872](#L2872) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [2873](#L2873) |  |
| [2874](#L2874) | <?php if ($open\_link\_in == 1): ?> |
| [2875](#L2875) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [2876](#L2876) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2877](#L2877) | </a> |
| [2878](#L2878) | <?php else: ?> |
| [2879](#L2879) |  |
| [2880](#L2880) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [2881](#L2881) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2882](#L2882) | </a> |
| [2883](#L2883) | <?php endif;?> |
| [2884](#L2884) |  |
| [2885](#L2885) | <?php else:?> |
| [2886](#L2886) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [2887](#L2887) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [2888](#L2888) | </a> |
| [2889](#L2889) |  |
| [2890](#L2890) | <?php endif;?> |
| [2891](#L2891) |  |
| [2892](#L2892) |  |
| [2893](#L2893) |  |
| [2894](#L2894) | <?php } ?> |
| [2895](#L2895) |  |
| [2896](#L2896) | <?php } ?> |
| [2897](#L2897) | <br style="clear: both;"> |
| [2898](#L2898) | </div> |
| [2899](#L2899) | <?php |
| [2900](#L2900) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [2901](#L2901) | $num\_of\_pages = ceil($total / $limit); |
| [2902](#L2902) | $page\_links = paginate\_links(array( |
| [2903](#L2903) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [2904](#L2904) | 'format' => '', |
| [2905](#L2905) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [2906](#L2906) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [2907](#L2907) | 'total' => $num\_of\_pages, |
| [2908](#L2908) | 'current' => $pagenum, |
| [2909](#L2909) | 'prev\_next' => true, |
| [2910](#L2910) | 'type' => 'list', |
| [2911](#L2911) | )); |
| [2912](#L2912) |  |
| [2913](#L2913) | if ($page\_links) { |
| [2914](#L2914) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [2915](#L2915) |  |
| [2916](#L2916) | } |
| [2917](#L2917) | ?> |
| [2918](#L2918) |  |
| [2919](#L2919) | <div style="clear:both"></div> |
| [2920](#L2920) | </div> |
| [2921](#L2921) |  |
| [2922](#L2922) | <script> |
| [2923](#L2923) |  |
| [2924](#L2924) | <?php $uniqId = uniqid(); ?> |
| [2925](#L2925) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [2926](#L2926) |  |
| [2927](#L2927) | jQuery(document).ready(function() { |
| [2928](#L2928) |  |
| [2929](#L2929) |  |
| [2930](#L2930) |  |
| [2931](#L2931) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [2932](#L2932) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [2933](#L2933) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [2934](#L2934) | margin:<?php echo $settings ['imageMargin'];?>, |
| [2935](#L2935) | target:'<?php echo $target;?>', |
| [2936](#L2936) | init : function() { }, |
| [2937](#L2937) | loadPicture : function(event, img) {  }, |
| [2938](#L2938) | resize : function(event, gallery) {  }, |
| [2939](#L2939) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [2940](#L2940) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [2941](#L2941) | }); |
| [2942](#L2942) |  |
| [2943](#L2943) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [2944](#L2944) |  |
| [2945](#L2945) | 'overlayColor':'#000000', |
| [2946](#L2946) | 'padding': 3, |
| [2947](#L2947) | 'margin': 20, |
| [2948](#L2948) | 'autoScale': true, |
| [2949](#L2949) | 'autoDimensions':true, |
| [2950](#L2950) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [2951](#L2951) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [2952](#L2952) | 'transitionIn':'fade', |
| [2953](#L2953) | 'transitionOut':'fade', |
| [2954](#L2954) | 'titlePosition': 'outside', |
| [2955](#L2955) | 'cyclic':true, |
| [2956](#L2956) | 'hideOnContentClick':false, |
| [2957](#L2957) | 'width' : 650, |
| [2958](#L2958) | 'height' : 400, |
| [2959](#L2959) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [2960](#L2960) |  |
| [2961](#L2961) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [2962](#L2962) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [2963](#L2963) |  |
| [2964](#L2964) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [2965](#L2965) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [2966](#L2966) | } |
| [2967](#L2967) | else{ |
| [2968](#L2968) | return ''; |
| [2969](#L2969) | } |
| [2970](#L2970) |  |
| [2971](#L2971) | } |
| [2972](#L2972) | }); |
| [2973](#L2973) |  |
| [2974](#L2974) | jQuery(".page-numbers").show(); |
| [2975](#L2975) |  |
| [2976](#L2976) |  |
| [2977](#L2977) | }); |
| [2978](#L2978) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [2979](#L2979) |  |
| [2980](#L2980) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [2981](#L2981) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [2982](#L2982) |  |
| [2983](#L2983) | e.preventDefault(); |
| [2984](#L2984) | var data = { |
| [2985](#L2985) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [2986](#L2986) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [2987](#L2987) | 'grid\_id':0, |
| [2988](#L2988) | 'total\_rec':'<?php echo $total; ?>', |
| [2989](#L2989) | 'vNonce':'<?php echo $vNonce;?>' |
| [2990](#L2990) | }; |
| [2991](#L2991) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [2992](#L2992) |  |
| [2993](#L2993) |  |
| [2994](#L2994) | jQuery('html, body').animate({ |
| [2995](#L2995) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [2996](#L2996) | }, 800); |
| [2997](#L2997) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [2998](#L2998) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [2999](#L2999) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [3000](#L3000) |  |
| [3001](#L3001) |  |
| [3002](#L3002) | }); |
| [3003](#L3003) |  |
| [3004](#L3004) |  |
| [3005](#L3005) |  |
| [3006](#L3006) | }); |
| [3007](#L3007) |  |
| [3008](#L3008) |  |
| [3009](#L3009) |  |
| [3010](#L3010) | </script> |
| [3011](#L3011) |  |
| [3012](#L3012) |  |
| [3013](#L3013) | <?php } ?> |
| [3014](#L3014) |  |
| [3015](#L3015) | <div class="clear"></div> |
| [3016](#L3016) |  |
| [3017](#L3017) | <?php |
| [3018](#L3018) | $output = ob\_get\_clean(); |
| [3019](#L3019) | echo $output; |
| [3020](#L3020) | exit; |
| [3021](#L3021) |  |
| [3022](#L3022) | } |
| [3023](#L3023) | function rjg\_get\_youtube\_info\_justified\_gallery\_callback(){ |
| [3024](#L3024) |  |
| [3025](#L3025) | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
| [3026](#L3026) |  |
| [3027](#L3027) |  |
| [3028](#L3028) | $retrieved\_nonce = ''; |
| [3029](#L3029) |  |
| [3030](#L3030) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [3031](#L3031) |  |
| [3032](#L3032) | $retrieved\_nonce = sanitize\_text\_field($\_POST['vNonce']); |
| [3033](#L3033) | } |
| [3034](#L3034) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [3035](#L3035) |  |
| [3036](#L3036) |  |
| [3037](#L3037) | wp\_die('Security check fail'); |
| [3038](#L3038) | } |
| [3039](#L3039) |  |
| [3040](#L3040) |  |
| [3041](#L3041) | $vid=sanitize\_text\_field($\_POST['vid']); |
| [3042](#L3042) | $url=$\_POST['url']; |
| [3043](#L3043) |  |
| [3044](#L3044) | $output=  wp\_remote\_retrieve\_body( wp\_remote\_get( $url ) ); |
| [3045](#L3045) |  |
| [3046](#L3046) | $output=json\_decode($output); |
| [3047](#L3047) |  |
| [3048](#L3048) |  |
| [3049](#L3049) |  |
| [3050](#L3050) | $return=array(); |
| [3051](#L3051) | if(is\_object($output)){ |
| [3052](#L3052) |  |
| [3053](#L3053) | $return['title']=sanitize\_text\_field($output->title); |
| [3054](#L3054) | $return['thumbnail\_url']=sanitize\_text\_field($output->thumbnail\_url); |
| [3055](#L3055) |  |
| [3056](#L3056) |  |
| [3057](#L3057) | } |
| [3058](#L3058) |  |
| [3059](#L3059) | echo json\_encode($return); |
| [3060](#L3060) | exit; |
| [3061](#L3061) |  |
| [3062](#L3062) | } |
| [3063](#L3063) |  |
| [3064](#L3064) | } |
| [3065](#L3065) | function rjg\_check\_file\_exist\_justified\_gallery\_callback() { |
| [3066](#L3066) |  |
| [3067](#L3067) | if(isset($\_POST) and is\_array($\_POST) and  isset($\_POST['url'])){ |
| [3068](#L3068) |  |
| [3069](#L3069) |  |
| [3070](#L3070) | $retrieved\_nonce = ''; |
| [3071](#L3071) |  |
| [3072](#L3072) | if (isset($\_POST['vNonce']) and $\_POST['vNonce'] != '') { |
| [3073](#L3073) |  |
| [3074](#L3074) | $retrieved\_nonce = sanitize\_text\_field($\_POST['vNonce']); |
| [3075](#L3075) | } |
| [3076](#L3076) | if (!wp\_verify\_nonce($retrieved\_nonce, 'vNonce')) { |
| [3077](#L3077) |  |
| [3078](#L3078) |  |
| [3079](#L3079) | wp\_die('Security check fail'); |
| [3080](#L3080) | } |
| [3081](#L3081) |  |
| [3082](#L3082) | $response = wp\_remote\_get(sanitize\_text\_field($\_POST['url'])); |
| [3083](#L3083) | $httpCode = wp\_remote\_retrieve\_response\_code( $response ); |
| [3084](#L3084) |  |
| [3085](#L3085) | echo trim((string)$httpCode);die; |
| [3086](#L3086) |  |
| [3087](#L3087) | } |
| [3088](#L3088) |  |
| [3089](#L3089) | } |
| [3090](#L3090) | function rjg\_responsive\_justified\_gallery\_with\_lightbox\_admin\_options\_func() { |
| [3091](#L3091) |  |
| [3092](#L3092) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_settings' ) ) { |
| [3093](#L3093) |  |
| [3094](#L3094) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [3095](#L3095) |  |
| [3096](#L3096) | } |
| [3097](#L3097) |  |
| [3098](#L3098) | $url='admin.php?page=responsive\_justified\_gallery\_with\_lightbox'; |
| [3099](#L3099) |  |
| [3100](#L3100) |  |
| [3101](#L3101) | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
| [3102](#L3102) |  |
| [3103](#L3103) | if (isset ( $\_POST ['btnsave'] )) { |
| [3104](#L3104) |  |
| [3105](#L3105) | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
| [3106](#L3106) |  |
| [3107](#L3107) | wp\_die('Security check fail'); |
| [3108](#L3108) | } |
| [3109](#L3109) |  |
| [3110](#L3110) | $imageheight = intval(sanitize\_text\_field( $\_POST['imageheight'] )); |
| [3111](#L3111) | $imageMargin = intval(sanitize\_text\_field( $\_POST['imageMargin'] )); |
| [3112](#L3112) | $page\_size = intval(sanitize\_text\_field( $\_POST['page\_size'] )); |
| [3113](#L3113) | $BackgroundColor = sanitize\_text\_field( $\_POST['BackgroundColor']); |
| [3114](#L3114) | $show\_hover\_caption = intval(sanitize\_text\_field( $\_POST['show\_hover\_caption'] )); |
| [3115](#L3115) | $show\_hover\_icon = intval(sanitize\_text\_field( $\_POST['show\_hover\_icon'] )); |
| [3116](#L3116) |  |
| [3117](#L3117) | $rjg\_settings=array( |
| [3118](#L3118) |  |
| [3119](#L3119) | 'BackgroundColor'=>$BackgroundColor, |
| [3120](#L3120) | 'imageheight'=>$imageheight, |
| [3121](#L3121) | 'imageMargin'=>$imageMargin, |
| [3122](#L3122) | 'page\_size'=>$page\_size, |
| [3123](#L3123) | 'show\_hover\_caption'=>$show\_hover\_caption, |
| [3124](#L3124) | 'show\_hover\_icon'=>$show\_hover\_icon |
| [3125](#L3125) |  |
| [3126](#L3126) | ); |
| [3127](#L3127) |  |
| [3128](#L3128) |  |
| [3129](#L3129) | update\_option('rjg\_settings',$rjg\_settings); |
| [3130](#L3130) |  |
| [3131](#L3131) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [3132](#L3132) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='succ'; |
| [3133](#L3133) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_( 'Settings saved successfully.','wp-responsive-photo-gallery' ); |
| [3134](#L3134) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [3135](#L3135) |  |
| [3136](#L3136) |  |
| [3137](#L3137) | $location = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox'; |
| [3138](#L3138) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [3139](#L3139) | exit (); |
| [3140](#L3140) | } |
| [3141](#L3141) |  |
| [3142](#L3142) | $settings=get\_option('rjg\_settings'); |
| [3143](#L3143) |  |
| [3144](#L3144) |  |
| [3145](#L3145) | ?> |
| [3146](#L3146) | <div style="width: 100%;"> |
| [3147](#L3147) | <div style="float: left; width: 100%;"> |
| [3148](#L3148) | <div class="wrap"> |
| [3149](#L3149) | <table> |
| [3150](#L3150) | <tr> |
| [3151](#L3151) |  |
| [3152](#L3152) | <td> |
| [3153](#L3153) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [3154](#L3154) | <div id="fb-root"></div> |
| [3155](#L3155) | <script>(function(d, s, id) { |
| [3156](#L3156) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [3157](#L3157) | if (d.getElementById(id)) return; |
| [3158](#L3158) | js = d.createElement(s); js.id = id; |
| [3159](#L3159) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [3160](#L3160) | fjs.parentNode.insertBefore(js, fjs); |
| [3161](#L3161) | }(document, 'script', 'facebook-jssdk'));</script> |
| [3162](#L3162) | </td> |
| [3163](#L3163) | <td> |
| [3164](#L3164) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [3165](#L3165) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [3166](#L3166) | </a> |
| [3167](#L3167) | </td> |
| [3168](#L3168) | </tr> |
| [3169](#L3169) | </table> |
| [3170](#L3170) | <div style="clear:both"> |
| [3171](#L3171) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [3172](#L3172) | </div> |
| [3173](#L3173) | <?php |
| [3174](#L3174) | $messages=get\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages'); |
| [3175](#L3175) | $type=''; |
| [3176](#L3176) | $message=''; |
| [3177](#L3177) | if(isset($messages['type']) and $messages['type']!=""){ |
| [3178](#L3178) |  |
| [3179](#L3179) | $type=$messages['type']; |
| [3180](#L3180) | $message=$messages['message']; |
| [3181](#L3181) |  |
| [3182](#L3182) | } |
| [3183](#L3183) |  |
| [3184](#L3184) |  |
| [3185](#L3185) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3186](#L3186) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3187](#L3187) |  |
| [3188](#L3188) |  |
| [3189](#L3189) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', array()); |
| [3190](#L3190) | ?> |
| [3191](#L3191) | <h2><?php echo \_\_('Gallery Settings','wp-responsive-photo-gallery');?></h2> |
| [3192](#L3192) |  |
| [3193](#L3193) | <br> |
| [3194](#L3194) | <div id="poststuff"> |
| [3195](#L3195) | <div id="post-body"  class="metabox-holder columns-2"> |
| [3196](#L3196) | <div id="post-body-content"  > |
| [3197](#L3197) | <form method="post" action="" id="scrollersettiings" |
| [3198](#L3198) | name="scrollersettiings"> |
| [3199](#L3199) |  |
| [3200](#L3200) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3201](#L3201) | <h3> |
| [3202](#L3202) | <label><?php echo \_\_('Gallery Background color','wp-responsive-photo-gallery');?></label> |
| [3203](#L3203) | </h3> |
| [3204](#L3204) | <div class="inside"> |
| [3205](#L3205) | <table> |
| [3206](#L3206) | <tr> |
| [3207](#L3207) | <td><input type="text" id="BackgroundColor" size="30" |
| [3208](#L3208) | name="BackgroundColor" |
| [3209](#L3209) | value="<?php echo $settings['BackgroundColor']; ?>" |
| [3210](#L3210) | style="width: 100px;"> |
| [3211](#L3211) | <div style="clear: both"></div> |
| [3212](#L3212) | <div></div></td> |
| [3213](#L3213) | </tr> |
| [3214](#L3214) | </table> |
| [3215](#L3215) |  |
| [3216](#L3216) | <div style="clear: both"></div> |
| [3217](#L3217) | </div> |
| [3218](#L3218) | </div> |
| [3219](#L3219) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3220](#L3220) | <h3> |
| [3221](#L3221) | <label><?php echo \_\_('Max Image Height','wp-responsive-photo-gallery');?></label> |
| [3222](#L3222) | </h3> |
| [3223](#L3223) | <div class="inside"> |
| [3224](#L3224) | <table> |
| [3225](#L3225) | <tr> |
| [3226](#L3226) | <td><input type="text" id="imageheight" size="30" |
| [3227](#L3227) | name="imageheight" |
| [3228](#L3228) | value="<?php echo $settings['imageheight']; ?>" |
| [3229](#L3229) | style="width: 100px;"> |
| [3230](#L3230) | <div style="clear: both"></div> |
| [3231](#L3231) | <div></div></td> |
| [3232](#L3232) | </tr> |
| [3233](#L3233) | </table> |
| [3234](#L3234) |  |
| [3235](#L3235) | <div style="clear: both"></div> |
| [3236](#L3236) | </div> |
| [3237](#L3237) | </div> |
| [3238](#L3238) |  |
| [3239](#L3239) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3240](#L3240) | <h3> |
| [3241](#L3241) | <label><?php echo \_\_('Image Margin','wp-responsive-photo-gallery');?></label> |
| [3242](#L3242) | </h3> |
| [3243](#L3243) | <div class="inside"> |
| [3244](#L3244) | <table> |
| [3245](#L3245) | <tr> |
| [3246](#L3246) | <td><input type="text" id="imageMargin" size="30" |
| [3247](#L3247) | name="imageMargin" |
| [3248](#L3248) | value="<?php echo $settings['imageMargin']; ?>" |
| [3249](#L3249) | style="width: 100px;"> |
| [3250](#L3250) | <div style="clear: both; padding-top: 5px"><?php echo \_\_('Gap between two images','wp-responsive-photo-gallery');?></div> |
| [3251](#L3251) | <div></div></td> |
| [3252](#L3252) | </tr> |
| [3253](#L3253) | </table> |
| [3254](#L3254) |  |
| [3255](#L3255) | <div style="clear: both"></div> |
| [3256](#L3256) | </div> |
| [3257](#L3257) | </div> |
| [3258](#L3258) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3259](#L3259) | <h3> |
| [3260](#L3260) | <label><?php echo \_\_('Page Size','wp-responsive-photo-gallery');?> </label> |
| [3261](#L3261) | </h3> |
| [3262](#L3262) | <div class="inside"> |
| [3263](#L3263) | <table> |
| [3264](#L3264) | <tr> |
| [3265](#L3265) | <td> |
| [3266](#L3266) | <input type="text" id="page\_size" size="30" |
| [3267](#L3267) | name="page\_size" |
| [3268](#L3268) | value="<?php echo $settings['page\_size']; ?>" |
| [3269](#L3269) | style="width: 100px;"> |
| [3270](#L3270) |  |
| [3271](#L3271) | <div style="clear: both"></div> |
| [3272](#L3272) | <div></div></td> |
| [3273](#L3273) | </tr> |
| [3274](#L3274) | </table> |
| [3275](#L3275) | <div style="clear: both"></div> |
| [3276](#L3276) | </div> |
| [3277](#L3277) | </div> |
| [3278](#L3278) |  |
| [3279](#L3279) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3280](#L3280) | <h3> |
| [3281](#L3281) | <label><?php echo \_\_('Show Caption On Hover ?','wp-responsive-photo-gallery');?></label> |
| [3282](#L3282) | </h3> |
| [3283](#L3283) | <div class="inside"> |
| [3284](#L3284) | <table> |
| [3285](#L3285) | <tr> |
| [3286](#L3286) | <td><input style="width: 20px;" type='radio' |
| [3287](#L3287) | <?php |
| [3288](#L3288) | if ($settings ['show\_hover\_caption'] == true) { |
| [3289](#L3289) | echo "checked='checked'"; |
| [3290](#L3290) | } |
| [3291](#L3291) | ?> |
| [3292](#L3292) | name='show\_hover\_caption' value='1'><?php echo \_\_('yes','wp-responsive-photo-gallery');?> &nbsp;<input |
| [3293](#L3293) | style="width: 20px;" type='radio' name='show\_hover\_caption' |
| [3294](#L3294) | <?php |
| [3295](#L3295) | if ($settings ['show\_hover\_caption'] == false) { |
| [3296](#L3296) | echo "checked='checked'"; |
| [3297](#L3297) | } |
| [3298](#L3298) | ?> |
| [3299](#L3299) | value='0'><?php echo \_\_('No','wp-responsive-photo-gallery');?> |
| [3300](#L3300) | <div style="clear: both"></div> |
| [3301](#L3301) | <div></div></td> |
| [3302](#L3302) | </tr> |
| [3303](#L3303) | </table> |
| [3304](#L3304) | <div style="clear: both"></div> |
| [3305](#L3305) | </div> |
| [3306](#L3306) | </div> |
| [3307](#L3307) | <div class="stuffbox" id="namediv" style="width: 100%;"> |
| [3308](#L3308) | <h3> |
| [3309](#L3309) | <label><?php echo \_\_('Show Icon On Hover ?','wp-responsive-photo-gallery');?></label> |
| [3310](#L3310) | </h3> |
| [3311](#L3311) | <div class="inside"> |
| [3312](#L3312) | <table> |
| [3313](#L3313) | <tr> |
| [3314](#L3314) | <td><input style="width: 20px;" type='radio' |
| [3315](#L3315) | <?php |
| [3316](#L3316) | if ($settings ['show\_hover\_icon'] == true) { |
| [3317](#L3317) | echo "checked='checked'"; |
| [3318](#L3318) | } |
| [3319](#L3319) | ?> |
| [3320](#L3320) | name='show\_hover\_icon' value='1'><?php echo \_\_('yes','wp-responsive-photo-gallery');?> &nbsp;<input |
| [3321](#L3321) | style="width: 20px;" type='radio' name='show\_hover\_icon' |
| [3322](#L3322) | <?php |
| [3323](#L3323) | if ($settings ['show\_hover\_icon'] == false) { |
| [3324](#L3324) | echo "checked='checked'"; |
| [3325](#L3325) | } |
| [3326](#L3326) | ?> |
| [3327](#L3327) | value='0'><?php echo \_\_('No','wp-responsive-photo-gallery');?> |
| [3328](#L3328) | <div style="clear: both"></div> |
| [3329](#L3329) | <div></div></td> |
| [3330](#L3330) | </tr> |
| [3331](#L3331) | </table> |
| [3332](#L3332) | <div style="clear: both"></div> |
| [3333](#L3333) | </div> |
| [3334](#L3334) | </div> |
| [3335](#L3335) |  |
| [3336](#L3336) |  |
| [3337](#L3337) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [3338](#L3338) | <input type="submit" |
| [3339](#L3339) | name="btnsave" id="btnsave" |
| [3340](#L3340) | value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [3341](#L3341) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [3342](#L3342) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" class="button-primary" |
| [3343](#L3343) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox'"> |
| [3344](#L3344) |  |
| [3345](#L3345) | </form> |
| [3346](#L3346) | <script type="text/javascript"> |
| [3347](#L3347) |  |
| [3348](#L3348) |  |
| [3349](#L3349) | jQuery(document).ready(function() { |
| [3350](#L3350) |  |
| [3351](#L3351) | jQuery("#scrollersettiings").validate({ |
| [3352](#L3352) | rules: { |
| [3353](#L3353) | name: { |
| [3354](#L3354) | required:true, |
| [3355](#L3355) | maxlength:200, |
| [3356](#L3356) | minlength:3, |
| [3357](#L3357) | }, |
| [3358](#L3358) | BackgroundColor:{ |
| [3359](#L3359) | required:true, |
| [3360](#L3360) | maxlength:7 |
| [3361](#L3361) | }, |
| [3362](#L3362) | imageheight:{ |
| [3363](#L3363) | required:true, |
| [3364](#L3364) | digits:true, |
| [3365](#L3365) | maxlength:15 |
| [3366](#L3366) | }, |
| [3367](#L3367) |  |
| [3368](#L3368) | imageMargin:{ |
| [3369](#L3369) | required:true, |
| [3370](#L3370) | number:true, |
| [3371](#L3371) | maxlength:15 |
| [3372](#L3372) | }, |
| [3373](#L3373) |  |
| [3374](#L3374) | page\_size:{ |
| [3375](#L3375) | required:true, |
| [3376](#L3376) | number:true, |
| [3377](#L3377) | maxlength:15 |
| [3378](#L3378) | } |
| [3379](#L3379) |  |
| [3380](#L3380) |  |
| [3381](#L3381) | }, |
| [3382](#L3382) | errorClass: "image\_error", |
| [3383](#L3383) | errorPlacement: function(error, element) { |
| [3384](#L3384) | error.appendTo(element.next().next()); |
| [3385](#L3385) | } |
| [3386](#L3386) |  |
| [3387](#L3387) |  |
| [3388](#L3388) | }) |
| [3389](#L3389) |  |
| [3390](#L3390) | jQuery('#BackgroundColor').wpColorPicker(); |
| [3391](#L3391) | }); |
| [3392](#L3392) | </script> |
| [3393](#L3393) |  |
| [3394](#L3394) | </div> |
| [3395](#L3395) | <div id="postbox-container-1" class="postbox-container" > |
| [3396](#L3396) |  |
| [3397](#L3397) | <div class="postbox"> |
| [3398](#L3398) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery' );?></h3> |
| [3399](#L3399) | <div class="inside"> |
| [3400](#L3400) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [3401](#L3401) |  |
| [3402](#L3402) | <div style="margin:10px 5px"> |
| [3403](#L3403) |  |
| [3404](#L3404) | </div> |
| [3405](#L3405) | </div></div> |
| [3406](#L3406) | <div class="postbox"> |
| [3407](#L3407) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [3408](#L3408) | <div class="inside"> |
| [3409](#L3409) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px;width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [3410](#L3410) | <div style="margin:10px 5px"> |
| [3411](#L3411) | </div> |
| [3412](#L3412) | </div></div> |
| [3413](#L3413) |  |
| [3414](#L3414) |  |
| [3415](#L3415) |  |
| [3416](#L3416) | </div> |
| [3417](#L3417) | </div> |
| [3418](#L3418) | </div> |
| [3419](#L3419) | </div> |
| [3420](#L3420) | </div> |
| [3421](#L3421) | <div class="clear"></div> |
| [3422](#L3422) | </div> |
| [3423](#L3423) |  |
| [3424](#L3424) | <?php |
| [3425](#L3425) | } |
| [3426](#L3426) | function rjg\_responsive\_justified\_gallery\_with\_lightbox\_media\_management\_func() { |
| [3427](#L3427) |  |
| [3428](#L3428) | global $wpdb; |
| [3429](#L3429) | $action = 'gridview'; |
| [3430](#L3430) |  |
| [3431](#L3431) |  |
| [3432](#L3432) | if (isset ( $\_GET ['action'] ) and $\_GET ['action'] != '') { |
| [3433](#L3433) |  |
| [3434](#L3434) | $action = trim ( sanitize\_text\_field($\_GET ['action'] )); |
| [3435](#L3435) |  |
| [3436](#L3436) | if(isset($\_GET['order\_by'])){ |
| [3437](#L3437) |  |
| [3438](#L3438) | if(sanitize\_sql\_orderby($\_GET['order\_by'])){ |
| [3439](#L3439) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3440](#L3440) | } |
| [3441](#L3441) | else{ |
| [3442](#L3442) |  |
| [3443](#L3443) | $order\_by=' id '; |
| [3444](#L3444) | } |
| [3445](#L3445) | } |
| [3446](#L3446) |  |
| [3447](#L3447) | if(isset($\_GET['order\_pos'])){ |
| [3448](#L3448) |  |
| [3449](#L3449) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3450](#L3450) | } |
| [3451](#L3451) |  |
| [3452](#L3452) | $search\_term\_=''; |
| [3453](#L3453) | if(isset($\_GET['search\_term'])){ |
| [3454](#L3454) |  |
| [3455](#L3455) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3456](#L3456) | } |
| [3457](#L3457) | } |
| [3458](#L3458) |  |
| [3459](#L3459) | $search\_term\_=''; |
| [3460](#L3460) | if(isset($\_GET['search\_term'])){ |
| [3461](#L3461) |  |
| [3462](#L3462) | $search\_term\_='&search\_term='.esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3463](#L3463) | } |
| [3464](#L3464) | ?> |
| [3465](#L3465) |  |
| [3466](#L3466) | <?php |
| [3467](#L3467) | if (strtolower ( $action ) == strtolower ( 'gridview' )) { |
| [3468](#L3468) |  |
| [3469](#L3469) |  |
| [3470](#L3470) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_view\_media' ) ) { |
| [3471](#L3471) |  |
| [3472](#L3472) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [3473](#L3473) |  |
| [3474](#L3474) | } |
| [3475](#L3475) |  |
| [3476](#L3476) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [3477](#L3477) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [3478](#L3478) |  |
| [3479](#L3479) | $uploads = wp\_upload\_dir (); |
| [3480](#L3480) | $baseurl = $uploads ['baseurl']; |
| [3481](#L3481) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [3482](#L3482) |  |
| [3483](#L3483) | ?> |
| [3484](#L3484) | <div class="wrap"> |
| [3485](#L3485) |  |
| [3486](#L3486) | <table><tr> |
| [3487](#L3487) | <td> |
| [3488](#L3488) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [3489](#L3489) | <div id="fb-root"></div> |
| [3490](#L3490) | <script>(function(d, s, id) { |
| [3491](#L3491) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [3492](#L3492) | if (d.getElementById(id)) return; |
| [3493](#L3493) | js = d.createElement(s); js.id = id; |
| [3494](#L3494) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [3495](#L3495) | fjs.parentNode.insertBefore(js, fjs); |
| [3496](#L3496) | }(document, 'script', 'facebook-jssdk'));</script> |
| [3497](#L3497) | </td> |
| [3498](#L3498) | <td> |
| [3499](#L3499) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [3500](#L3500) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [3501](#L3501) | </a> |
| [3502](#L3502) | </td> |
| [3503](#L3503) | </tr> |
| [3504](#L3504) | </table> |
| [3505](#L3505) | <div style="clear:both"> |
| [3506](#L3506) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [3507](#L3507) | </div> |
| [3508](#L3508) | <?php |
| [3509](#L3509) | $messages = get\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages' ); |
| [3510](#L3510) | $type = ''; |
| [3511](#L3511) | $message = ''; |
| [3512](#L3512) | if (isset ( $messages ['type'] ) and $messages ['type'] != "") { |
| [3513](#L3513) |  |
| [3514](#L3514) | $type = $messages ['type']; |
| [3515](#L3515) | $message = $messages ['message']; |
| [3516](#L3516) | } |
| [3517](#L3517) |  |
| [3518](#L3518) |  |
| [3519](#L3519) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3520](#L3520) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [3521](#L3521) |  |
| [3522](#L3522) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [3523](#L3523) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', array () ); |
| [3524](#L3524) | ?> |
| [3525](#L3525) |  |
| [3526](#L3526) | <div style="width: 100%;"> |
| [3527](#L3527) | <div id="modelMainDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [3528](#L3528) | <div id="LoaderDiv" style="display:none;z-index: 1000; border: medium none; margin: 0pt; padding: 0pt; width: 100%; height: 100%; top: 0pt; left: 0pt; background-color: rgb(0, 0, 0); opacity: 0.2; cursor: wait; position: fixed;filter:alpha(opacity=15)" ></div> |
| [3529](#L3529) | <div id="ContainDiv" style="display:none;z-index: 1056; position: fixed; padding: 5px; margin: 0px; width: 30%; top: 40%; left: 35%; text-align: center; color: rgb(0, 0, 0); border: 1px solid #999999; background-color: rgb(255, 255, 255); cursor: wait;" > |
| [3530](#L3530) | <img src="<?php echo $url.'images/ajax-loader.gif'?>" /> |
| [3531](#L3531) | <h5 id="wait"><?php echo \_\_('Please wait while uploading images...','wp-responsive-photo-gallery');?></h5> |
| [3532](#L3532) | </div> |
| [3533](#L3533) | <div id="poststuff"> |
| [3534](#L3534) | <div id="post-body" class="metabox-holder columns-2"> |
| [3535](#L3535) | <div id="post-body-content"> |
| [3536](#L3536) | <div class="icon32 icon32-posts-post" id="icon-edit"> |
| [3537](#L3537) | <br> |
| [3538](#L3538) | </div> |
| [3539](#L3539) | <h1> |
| [3540](#L3540) | <?php echo \_\_('Media','wp-responsive-photo-gallery');?><a class="button add-new-h2" href="admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=addedit"><?php echo \_\_('Add New','wp-responsive-photo-gallery');?></a> |
| [3541](#L3541) | &nbsp;&nbsp; |
| [3542](#L3542) | <a class="massAdd button add-new-h2" href="javascript:void(0)"><?php echo \_\_('Mass Image Add','wp-responsive-photo-gallery');?></a> |
| [3543](#L3543) |  |
| [3544](#L3544) | </h1> |
| [3545](#L3545) | <br /> |
| [3546](#L3546) |  |
| [3547](#L3547) | <form method="POST" |
| [3548](#L3548) | action="admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=deleteselected" |
| [3549](#L3549) | id="posts-filter" onkeypress="return event.keyCode != 13;"> |
| [3550](#L3550) | <div class="alignleft actions"> |
| [3551](#L3551) | <select name="action\_upper" id="action\_upper"> |
| [3552](#L3552) | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','wp-responsive-photo-gallery');?></option> |
| [3553](#L3553) | <option value="delete"><?php echo \_\_('delete','wp-responsive-photo-gallery');?></option> |
| [3554](#L3554) | </select> <input type="submit" value="<?php echo \_\_('Apply','wp-responsive-photo-gallery');?>" |
| [3555](#L3555) | class="button-secondary action" id="deleteselected" |
| [3556](#L3556) | name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [3557](#L3557) | </div> |
| [3558](#L3558) | <?php |
| [3559](#L3559) |  |
| [3560](#L3560) |  |
| [3561](#L3561) |  |
| [3562](#L3562) | $setacrionpage='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [3563](#L3563) |  |
| [3564](#L3564) | if(isset($\_GET['order\_by']) and $\_GET['order\_by']!=""){ |
| [3565](#L3565) | $setacrionpage.='&order\_by='.esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3566](#L3566) | } |
| [3567](#L3567) |  |
| [3568](#L3568) | if(isset($\_GET['order\_pos']) and $\_GET['order\_pos']!=""){ |
| [3569](#L3569) | $setacrionpage.='&order\_pos='.esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3570](#L3570) | } |
| [3571](#L3571) |  |
| [3572](#L3572) | $seval=""; |
| [3573](#L3573) | if(isset($\_GET['search\_term']) and $\_GET['search\_term']!=""){ |
| [3574](#L3574) | $seval=esc\_html(sanitize\_text\_field($\_GET['search\_term'])); |
| [3575](#L3575) | } |
| [3576](#L3576) |  |
| [3577](#L3577) | ?> |
| [3578](#L3578) | <br class="clear"> |
| [3579](#L3579) | <?php |
| [3580](#L3580) | global $wpdb; |
| [3581](#L3581) |  |
| [3582](#L3582) |  |
| [3583](#L3583) | $order\_by='id'; |
| [3584](#L3584) | $order\_pos="asc"; |
| [3585](#L3585) |  |
| [3586](#L3586) | if(isset($\_GET['order\_by']) and sanitize\_sql\_orderby($\_GET['order\_by'])!==false){ |
| [3587](#L3587) |  |
| [3588](#L3588) | $order\_by=esc\_html(sanitize\_text\_field($\_GET['order\_by'])); |
| [3589](#L3589) | } |
| [3590](#L3590) |  |
| [3591](#L3591) | if(isset($\_GET['order\_pos'])){ |
| [3592](#L3592) |  |
| [3593](#L3593) | $order\_pos=esc\_html(sanitize\_text\_field($\_GET['order\_pos'])); |
| [3594](#L3594) | } |
| [3595](#L3595) |  |
| [3596](#L3596) | $search\_term=''; |
| [3597](#L3597) | if(isset($\_GET['search\_term'])){ |
| [3598](#L3598) |  |
| [3599](#L3599) | $search\_term= esc\_html(sanitize\_text\_field(esc\_sql($\_GET['search\_term']))); |
| [3600](#L3600) | } |
| [3601](#L3601) |  |
| [3602](#L3602) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery "; |
| [3603](#L3603) | $queryCount = "SELECT count(\*) FROM " . $wpdb->prefix . "rjg\_gallery "; |
| [3604](#L3604) | if($search\_term!=''){ |
| [3605](#L3605) | $query.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [3606](#L3606) | $queryCount.=" where id like '%$search\_term%' or title like '%$search\_term%' "; |
| [3607](#L3607) | } |
| [3608](#L3608) |  |
| [3609](#L3609) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [3610](#L3610) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [3611](#L3611) |  |
| [3612](#L3612) | $query.=" order by $order\_by $order\_pos"; |
| [3613](#L3613) |  |
| [3614](#L3614) | $rowsCount=$wpdb->get\_var($queryCount); |
| [3615](#L3615) |  |
| [3616](#L3616) |  |
| [3617](#L3617) | ?> |
| [3618](#L3618) |  |
| [3619](#L3619) | <div style="padding-top:5px;padding-bottom:5px"> |
| [3620](#L3620) | <b><?php echo \_\_( 'Search','wp-responsive-photo-gallery');?> : </b> |
| [3621](#L3621) | <input type="text" value="<?php echo $seval;?>" id="search\_term" name="search\_term">&nbsp; |
| [3622](#L3622) | <input type='button'  value='<?php echo \_\_( 'Search','wp-responsive-photo-gallery');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp; |
| [3623](#L3623) | <input type='button'  value='<?php echo \_\_( 'Reset Search','wp-responsive-photo-gallery');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" > |
| [3624](#L3624) | </div> |
| [3625](#L3625) | <script type="text/javascript" > |
| [3626](#L3626) |  |
| [3627](#L3627) | jQuery('#search\_term').on("keyup", function(e) { |
| [3628](#L3628) | if (e.which == 13) { |
| [3629](#L3629) |  |
| [3630](#L3630) | SearchredirectTO(); |
| [3631](#L3631) | } |
| [3632](#L3632) | }); |
| [3633](#L3633) | function SearchredirectTO(){ |
| [3634](#L3634) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [3635](#L3635) | var searchval=jQuery('#search\_term').val(); |
| [3636](#L3636) | redirectto=redirectto+'&search\_term='+jQuery.trim(encodeURIComponent(searchval)); |
| [3637](#L3637) | window.location.href=redirectto; |
| [3638](#L3638) | } |
| [3639](#L3639) | function ResetSearch(){ |
| [3640](#L3640) |  |
| [3641](#L3641) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [3642](#L3642) | window.location.href=redirectto; |
| [3643](#L3643) | exit; |
| [3644](#L3644) | } |
| [3645](#L3645) | </script> |
| [3646](#L3646) | <div id="no-more-tables"> |
| [3647](#L3647) | <table cellspacing="0" id="gridTbl" class="table-bordered table-striped table-condensed cf wp-list-table widefat"> |
| [3648](#L3648) | <thead> |
| [3649](#L3649) | <tr> |
| [3650](#L3650) | <th class="manage-column column-cb check-column" scope="col"><input type="checkbox"></th> |
| [3651](#L3651) | <?php if($order\_by=="id" and $order\_pos=="asc"):?> |
| [3652](#L3652) |  |
| [3653](#L3653) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3654](#L3654) | <?php else:?> |
| [3655](#L3655) | <?php if($order\_by=="id"):?> |
| [3656](#L3656) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3657](#L3657) | <?php else:?> |
| [3658](#L3658) | <th><a href="<?php echo $setacrionpage;?>&order\_by=id&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Id','wp-responsive-photo-gallery');?></a></th> |
| [3659](#L3659) | <?php endif;?> |
| [3660](#L3660) | <?php endif;?> |
| [3661](#L3661) | <?php if($order\_by=="media\_type" and $order\_pos=="asc"):?> |
| [3662](#L3662) |  |
| [3663](#L3663) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3664](#L3664) | <?php else:?> |
| [3665](#L3665) | <?php if($order\_by=="media\_type"):?> |
| [3666](#L3666) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3667](#L3667) | <?php else:?> |
| [3668](#L3668) | <th><a href="<?php echo $setacrionpage;?>&order\_by=media\_type&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?></a></th> |
| [3669](#L3669) | <?php endif;?> |
| [3670](#L3670) | <?php endif;?> |
| [3671](#L3671) |  |
| [3672](#L3672) |  |
| [3673](#L3673) | <?php if($order\_by=="title" and $order\_pos=="asc"):?> |
| [3674](#L3674) |  |
| [3675](#L3675) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3676](#L3676) | <?php else:?> |
| [3677](#L3677) | <?php if($order\_by=="title"):?> |
| [3678](#L3678) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3679](#L3679) | <?php else:?> |
| [3680](#L3680) | <th><a href="<?php echo $setacrionpage;?>&order\_by=title&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Title','wp-responsive-photo-gallery');?></a></th> |
| [3681](#L3681) | <?php endif;?> |
| [3682](#L3682) | <?php endif;?> |
| [3683](#L3683) | <th><span></span></th> |
| [3684](#L3684) |  |
| [3685](#L3685) |  |
| [3686](#L3686) |  |
| [3687](#L3687) | <?php if($order\_by=="createdon" and $order\_pos=="asc"):?> |
| [3688](#L3688) |  |
| [3689](#L3689) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3690](#L3690) | <?php else:?> |
| [3691](#L3691) | <?php if($order\_by=="createdon"):?> |
| [3692](#L3692) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [3693](#L3693) | <?php else:?> |
| [3694](#L3694) | <th><a href="<?php echo $setacrionpage;?>&order\_by=createdon&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Published On','wp-responsive-photo-gallery');?></a></th> |
| [3695](#L3695) | <?php endif;?> |
| [3696](#L3696) | <?php endif;?> |
| [3697](#L3697) |  |
| [3698](#L3698) |  |
| [3699](#L3699) | <th><span><?php echo \_\_('Edit','wp-responsive-photo-gallery');?></span></th> |
| [3700](#L3700) | <th><span><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></span></th> |
| [3701](#L3701) | </tr> |
| [3702](#L3702) | </thead> |
| [3703](#L3703) |  |
| [3704](#L3704) | <tbody id="the-list"> |
| [3705](#L3705) | <?php |
| [3706](#L3706) | if ($rowsCount > 0) { |
| [3707](#L3707) |  |
| [3708](#L3708) | global $wp\_rewrite; |
| [3709](#L3709) | $rows\_per\_page = 15; |
| [3710](#L3710) |  |
| [3711](#L3711) | $current = (isset($\_GET ['paged'])) ? ((int) intval(sanitize\_text\_field($\_GET ['paged']))) : 1; |
| [3712](#L3712) | $pagination\_args = array ( |
| [3713](#L3713) | 'base' => @add\_query\_arg ( 'paged', '%#%' ), |
| [3714](#L3714) | 'format' => '', |
| [3715](#L3715) | 'total' => ceil ( $rowsCount / $rows\_per\_page ), |
| [3716](#L3716) | 'current' => $current, |
| [3717](#L3717) | 'show\_all' => false, |
| [3718](#L3718) | 'type' => 'plain' |
| [3719](#L3719) | ); |
| [3720](#L3720) |  |
| [3721](#L3721) | $offset = ($current - 1) \* $rows\_per\_page; |
| [3722](#L3722) | $query.=" limit $offset, $rows\_per\_page"; |
| [3723](#L3723) | $rows = $wpdb->get\_results ( $query ,ARRAY\_A); |
| [3724](#L3724) | $delRecNonce = wp\_create\_nonce('delete\_image'); |
| [3725](#L3725) | foreach($rows as $row) { |
| [3726](#L3726) |  |
| [3727](#L3727) | $id = $row ['id']; |
| [3728](#L3728) | $editlink = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=addedit&id=$id"; |
| [3729](#L3729) | $deletelink = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=delete&id=$id&nonce=$delRecNonce"; |
| [3730](#L3730) |  |
| [3731](#L3731) | $outputimgmain = $baseurl . $row ['image\_name'].'?rand='.  rand(0, 5000); |
| [3732](#L3732) | ?> |
| [3733](#L3733) | <tr valign="top"> |
| [3734](#L3734) | <td class="alignCenter check-column" data-title="Select Record"><input |
| [3735](#L3735) | type="checkbox" value="<?php echo $row['id'] ?>" |
| [3736](#L3736) | name="thumbnails[]"></td> |
| [3737](#L3737) | <td data-title="<?php echo \_\_('Id','wp-responsive-photo-gallery');?>" class="alignCenter"><?php echo $row['id']; ?></td> |
| [3738](#L3738) | <td data-title="Video Type" class="alignCenter"><div> |
| [3739](#L3739) | <strong><?php echo $row['media\_type']; ?> <?php if($row['media\_type']=='video'):?> - <?php echo $row['vtype'];?><?php endif;?> </strong> |
| [3740](#L3740) | </div></td> |
| [3741](#L3741) | <td data-title="<?php echo \_\_('Title','wp-responsive-photo-gallery');?>" class="alignCenter"> |
| [3742](#L3742) | <div> |
| [3743](#L3743) | <strong><?php echo $row['title']; ?></strong> |
| [3744](#L3744) | </div></td> |
| [3745](#L3745) | <td class="alignCenter"><img src="<?php echo $outputimgmain; ?>" style="width: 100px" height="100px" /></td> |
| [3746](#L3746) | <td data-title="<?php echo \_\_('Published On','wp-responsive-photo-gallery');?>" class="alignCenter"><?php echo $row['createdon'] ?></td> |
| [3747](#L3747) | <td data-title="<?php echo \_\_('Edit','wp-responsive-photo-gallery');?>" class="alignCenter"><strong><a href='<?php echo $editlink; ?>' title="<?php echo \_\_('Edit','wp-responsive-photo-gallery');?>"><?php echo \_\_('Edit','wp-responsive-photo-gallery');?></a></strong></td> |
| [3748](#L3748) | <td data-title="<?php echo \_\_('Delete','wp-responsive-photo-gallery');?>" class="alignCenter"><strong><a href='<?php echo $deletelink; ?>' onclick="return confirmDelete();" title="<?php echo \_\_('Delete','wp-responsive-photo-gallery');?>"><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></a> </strong></td> |
| [3749](#L3749) | </tr> |
| [3750](#L3750) | <?php |
| [3751](#L3751) | } |
| [3752](#L3752) | } else { |
| [3753](#L3753) | ?> |
| [3754](#L3754) | <tr valign="top" class="" |
| [3755](#L3755) | id=""> |
| [3756](#L3756) | <td colspan="9" data-title="<?php echo \_\_('No Record','wp-responsive-photo-gallery');?>" align="center"><strong><?php echo \_\_('No Media Found','wp-responsive-photo-gallery');?></strong></td> |
| [3757](#L3757) | </tr> |
| [3758](#L3758) | <?php |
| [3759](#L3759) | } |
| [3760](#L3760) | ?> |
| [3761](#L3761) | </tbody> |
| [3762](#L3762) | </table> |
| [3763](#L3763) | </div> |
| [3764](#L3764) | <?php |
| [3765](#L3765) | if ($rowsCount> 0) { |
| [3766](#L3766) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [3767](#L3767) | echo paginate\_links ( $pagination\_args ); |
| [3768](#L3768) | echo "</div>"; |
| [3769](#L3769) | } |
| [3770](#L3770) | ?> |
| [3771](#L3771) | <br /> |
| [3772](#L3772) | <div class="alignleft actions"> |
| [3773](#L3773) | <select name="action" id="action\_bottom"> |
| [3774](#L3774) | <option selected="selected" value="-1"><?php echo \_\_('Bulk Actions','wp-responsive-photo-gallery');?></option> |
| [3775](#L3775) | <option value="delete"><?php echo \_\_('Delete','wp-responsive-photo-gallery');?></option> |
| [3776](#L3776) | </select> |
| [3777](#L3777) | <?php wp\_nonce\_field('action\_settings\_mass\_delete', 'mass\_delete\_nonce'); ?> |
| [3778](#L3778) | <input type="submit" value="<?php echo \_\_('Apply','wp-responsive-photo-gallery');?>" |
| [3779](#L3779) | class="button-secondary action" id="deleteselected" |
| [3780](#L3780) | name="deleteselected" onclick="return confirmDelete\_bulk();"> |
| [3781](#L3781) | </div> |
| [3782](#L3782) |  |
| [3783](#L3783) | </form> |
| [3784](#L3784) | <script type="text/JavaScript"> |
| [3785](#L3785) |  |
| [3786](#L3786) | function  confirmDelete\_bulk(){ |
| [3787](#L3787) | var topval=document.getElementById("action\_bottom").value; |
| [3788](#L3788) | var bottomVal=document.getElementById("action\_upper").value; |
| [3789](#L3789) |  |
| [3790](#L3790) | if(topval=='delete' || bottomVal=='delete'){ |
| [3791](#L3791) |  |
| [3792](#L3792) |  |
| [3793](#L3793) | var agree=confirm("<?php echo \_\_('Are you sure you want to delete selected media ?','wp-responsive-photo-gallery');?>"); |
| [3794](#L3794) | if (agree) |
| [3795](#L3795) | return true ; |
| [3796](#L3796) | else |
| [3797](#L3797) | return false; |
| [3798](#L3798) | } |
| [3799](#L3799) | } |
| [3800](#L3800) |  |
| [3801](#L3801) | function  confirmDelete(){ |
| [3802](#L3802) | var agree=confirm("<?php echo \_\_('Are you sure you want to delete this media ?','wp-responsive-photo-gallery');?>"); |
| [3803](#L3803) | if (agree) |
| [3804](#L3804) | return true ; |
| [3805](#L3805) | else |
| [3806](#L3806) | return false; |
| [3807](#L3807) | } |
| [3808](#L3808) |  |
| [3809](#L3809) | var nonce\_sec='<?php echo wp\_create\_nonce( "thumbnail-mass-image" );?>'; |
| [3810](#L3810) | jQuery(document).ready(function() { |
| [3811](#L3811) | //uploading files variable |
| [3812](#L3812) | var custom\_file\_frame; |
| [3813](#L3813) | jQuery(".massAdd").click(function(event) { |
| [3814](#L3814) | var slider\_id=jQuery(this).attr('id'); |
| [3815](#L3815) | event.preventDefault(); |
| [3816](#L3816) | //If the frame already exists, reopen it |
| [3817](#L3817) | if (typeof(custom\_file\_frame)!=="undefined") { |
| [3818](#L3818) | custom\_file\_frame.close(); |
| [3819](#L3819) | } |
| [3820](#L3820) |  |
| [3821](#L3821) | //Create WP media frame. |
| [3822](#L3822) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [3823](#L3823) | //Title of media manager frame |
| [3824](#L3824) | title: "<?php echo \_\_("WP Media Uploader",'wp-responsive-photo-gallery');?>", |
| [3825](#L3825) | library: { |
| [3826](#L3826) | type: 'image' |
| [3827](#L3827) | }, |
| [3828](#L3828) | button: { |
| [3829](#L3829) | //Button text |
| [3830](#L3830) | text: "<?php echo \_\_("Set Image",'wp-responsive-photo-gallery');?>" |
| [3831](#L3831) | }, |
| [3832](#L3832) | //Do not allow multiple files, if you want multiple, set true |
| [3833](#L3833) | multiple: true |
| [3834](#L3834) | }); |
| [3835](#L3835) |  |
| [3836](#L3836) | //callback for selected image |
| [3837](#L3837) |  |
| [3838](#L3838) | custom\_file\_frame.on('select', function() { |
| [3839](#L3839) |  |
| [3840](#L3840) |  |
| [3841](#L3841) | jQuery("#modelMainDiv").show(); |
| [3842](#L3842) | jQuery("#LoaderDiv").show(); |
| [3843](#L3843) | jQuery("#ContainDiv").show(); |
| [3844](#L3844) | var selection = custom\_file\_frame.state().get('selection'); |
| [3845](#L3845) | selection.map(function(attachment) { |
| [3846](#L3846) |  |
| [3847](#L3847) | attachment = attachment.toJSON(); |
| [3848](#L3848) | var validExtensions=new Array(); |
| [3849](#L3849) | validExtensions[0]='jpg'; |
| [3850](#L3850) | validExtensions[1]='jpeg'; |
| [3851](#L3851) | validExtensions[2]='png'; |
| [3852](#L3852) | validExtensions[3]='gif'; |
| [3853](#L3853) |  |
| [3854](#L3854) |  |
| [3855](#L3855) | var inarr=parseInt(jQuery.inArray( attachment.subtype, validExtensions)); |
| [3856](#L3856) |  |
| [3857](#L3857) | if(inarr>0 && attachment.type.toLowerCase()=='image' ){ |
| [3858](#L3858) |  |
| [3859](#L3859) | var titleTouse=""; |
| [3860](#L3860) | var imageDescriptionTouse=""; |
| [3861](#L3861) |  |
| [3862](#L3862) | if(jQuery.trim(attachment.title)!=''){ |
| [3863](#L3863) |  |
| [3864](#L3864) | titleTouse=jQuery.trim(attachment.title); |
| [3865](#L3865) | } |
| [3866](#L3866) | else if(jQuery.trim(attachment.caption)!=''){ |
| [3867](#L3867) |  |
| [3868](#L3868) | titleTouse=jQuery.trim(attachment.caption); |
| [3869](#L3869) | } |
| [3870](#L3870) |  |
| [3871](#L3871) | if(jQuery.trim(attachment.description)!=''){ |
| [3872](#L3872) |  |
| [3873](#L3873) | imageDescriptionTouse=jQuery.trim(attachment.description); |
| [3874](#L3874) | } |
| [3875](#L3875) | else if(jQuery.trim(attachment.caption)!=''){ |
| [3876](#L3876) |  |
| [3877](#L3877) | imageDescriptionTouse=jQuery.trim(attachment.caption); |
| [3878](#L3878) | } |
| [3879](#L3879) |  |
| [3880](#L3880) | var data = { |
| [3881](#L3881) | imagetitle:titleTouse, |
| [3882](#L3882) | image\_description: imageDescriptionTouse, |
| [3883](#L3883) | attachment\_id:attachment.id, |
| [3884](#L3884) | slider\_id:slider\_id, |
| [3885](#L3885) | action: 'mass\_upload\_wpresponsivephgalleryms', |
| [3886](#L3886) | thumbnail\_security:nonce\_sec |
| [3887](#L3887) | }; |
| [3888](#L3888) |  |
| [3889](#L3889) | url='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management&action=mass\_upload\_wpresponsivephgalleryms' |
| [3890](#L3890) | jQuery.ajax({ |
| [3891](#L3891) | type: 'POST', |
| [3892](#L3892) | url: ajaxurl, |
| [3893](#L3893) | data: data, |
| [3894](#L3894) | success: function(result) { |
| [3895](#L3895) | if(result.isOk == false) |
| [3896](#L3896) | alert(result.message); |
| [3897](#L3897) | }, |
| [3898](#L3898) | dataType:'html', |
| [3899](#L3899) | async:false |
| [3900](#L3900) | }); |
| [3901](#L3901) |  |
| [3902](#L3902) |  |
| [3903](#L3903) | } |
| [3904](#L3904) |  |
| [3905](#L3905) | }); |
| [3906](#L3906) |  |
| [3907](#L3907) | jQuery("#modelMainDiv").hide(); |
| [3908](#L3908) | jQuery("#LoaderDiv").hide(); |
| [3909](#L3909) | jQuery("#ContainDiv").hide(); |
| [3910](#L3910) |  |
| [3911](#L3911) | }); |
| [3912](#L3912) |  |
| [3913](#L3913) | custom\_file\_frame.on('close', function() { |
| [3914](#L3914) | window.location.reload(); |
| [3915](#L3915) | }); |
| [3916](#L3916) |  |
| [3917](#L3917) | //Open modal |
| [3918](#L3918) | custom\_file\_frame.open(); |
| [3919](#L3919) | }); |
| [3920](#L3920) | }) |
| [3921](#L3921) | </script> |
| [3922](#L3922) |  |
| [3923](#L3923) | <br class="clear"> |
| [3924](#L3924) | <div style="clear: both;"></div> |
| [3925](#L3925) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [3926](#L3926) |  |
| [3927](#L3927) |  |
| [3928](#L3928) |  |
| [3929](#L3929) | <h3><?php echo \_\_('To print this masonry gallery into WordPress Post/Page use below code','wp-responsive-photo-gallery');?></h3> |
| [3930](#L3930) | <input type="text" |
| [3931](#L3931) | value='[print\_masonry\_gallery\_plus\_lightbox] ' |
| [3932](#L3932) | style="width: 400px; height: 30px" |
| [3933](#L3933) | onclick="this.focus(); this.select()" /> |
| [3934](#L3934) | <div class="clear"></div> |
| [3935](#L3935) | <h3><?php echo \_\_('To print this masonry gallery into WordPress theme/template PHP files use below code','wp-responsive-photo-gallery');?></h3> |
| [3936](#L3936) | <?php |
| [3937](#L3937) | $shortcode = '[print\_masonry\_gallery\_plus\_lightbox]'; |
| [3938](#L3938) | ?> |
| [3939](#L3939) | <input type="text" |
| [3940](#L3940) | value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" |
| [3941](#L3941) | style="width: 400px; height: 30px" |
| [3942](#L3942) | onclick="this.focus(); this.select()" /> |
| [3943](#L3943) | <div class="clear"></div> |
| [3944](#L3944) | </div> |
| [3945](#L3945) |  |
| [3946](#L3946) | <div id="postbox-container-1" class="postbox-container"  > |
| [3947](#L3947) |  |
| [3948](#L3948) | <div class="postbox"> |
| [3949](#L3949) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [3950](#L3950) | <div class="inside"> |
| [3951](#L3951) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [3952](#L3952) |  |
| [3953](#L3953) | <div style="margin:10px 5px"> |
| [3954](#L3954) |  |
| [3955](#L3955) | </div> |
| [3956](#L3956) | </div></div> |
| [3957](#L3957) | <div class="postbox"> |
| [3958](#L3958) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [3959](#L3959) | <div class="inside"> |
| [3960](#L3960) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [3961](#L3961) | <div style="margin:10px 5px"> |
| [3962](#L3962) | </div> |
| [3963](#L3963) | </div></div> |
| [3964](#L3964) |  |
| [3965](#L3965) |  |
| [3966](#L3966) | </div> |
| [3967](#L3967) | </div> |
| [3968](#L3968) |  |
| [3969](#L3969) | </div> |
| [3970](#L3970) | </div> |
| [3971](#L3971) | <?php |
| [3972](#L3972) | } else if (strtolower ( $action ) == strtolower ( 'addedit' )) { |
| [3973](#L3973) | $url = plugin\_dir\_url ( \_\_FILE\_\_ ); |
| [3974](#L3974) | $vNonce = wp\_create\_nonce('vNonce'); |
| [3975](#L3975) | ?><?php |
| [3976](#L3976) | if (isset ( $\_POST ['btnsave'] )) { |
| [3977](#L3977) |  |
| [3978](#L3978) | if (!check\_admin\_referer('action\_image\_add\_edit', 'add\_edit\_image\_nonce')) { |
| [3979](#L3979) |  |
| [3980](#L3980) | wp\_die('Security check fail'); |
| [3981](#L3981) | } |
| [3982](#L3982) | $uploads = wp\_upload\_dir (); |
| [3983](#L3983) | $baseDir = $uploads ['basedir']; |
| [3984](#L3984) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [3985](#L3985) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [3986](#L3986) |  |
| [3987](#L3987) | if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='video'){ |
| [3988](#L3988) |  |
| [3989](#L3989) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [3990](#L3990) | $vtype = trim ( sanitize\_text\_field( $\_POST ['vtype'] ) ); |
| [3991](#L3991) | $videourl = trim (esc\_url\_raw($\_POST ['videourl'] )); |
| [3992](#L3992) | // echo $videourl;die; |
| [3993](#L3993) |  |
| [3994](#L3994) |  |
| [3995](#L3995) |  |
| [3996](#L3996) | $vid = uniqid ( 'vid\_' ); |
| [3997](#L3997) | $embed\_url=''; |
| [3998](#L3998) | if ($vtype == 'youtube') { |
| [3999](#L3999) | // parse |
| [4000](#L4000) |  |
| [4001](#L4001) | $parseUrl = @parse\_url ( $videourl ); |
| [4002](#L4002) | if (is\_array ( $parseUrl )) { |
| [4003](#L4003) |  |
| [4004](#L4004) | $queryStr = $parseUrl ['query']; |
| [4005](#L4005) | parse\_str ( $queryStr, $array ); |
| [4006](#L4006) | if (is\_array ( $array ) and isset ( $array ['v'] )) { |
| [4007](#L4007) |  |
| [4008](#L4008) | $vid = $array ['v']; |
| [4009](#L4009) | } |
| [4010](#L4010) | } |
| [4011](#L4011) |  |
| [4012](#L4012) | $embed\_url="//www.youtube.com/embed/$vid"; |
| [4013](#L4013) | } |
| [4014](#L4014) |  |
| [4015](#L4015) | else if($vtype=='dailymotion'){ |
| [4016](#L4016) |  |
| [4017](#L4017) | $url\_arr = parse\_url($videourl); |
| [4018](#L4018) | if(isset($url\_arr['query'])){ |
| [4019](#L4019) |  |
| [4020](#L4020) | $query = $url\_arr['query']; |
| [4021](#L4021) | $videourl = str\_replace(array($query,'?'), '', $videourl); |
| [4022](#L4022) | } |
| [4023](#L4023) | $pos = strpos($videourl, '/video/'); |
| [4024](#L4024) | $vid=0; |
| [4025](#L4025) | if ($pos !== false){ |
| [4026](#L4026) |  |
| [4027](#L4027) | $vid=substr($videourl, $pos+strlen('/video/')); |
| [4028](#L4028) |  |
| [4029](#L4029) | } |
| [4030](#L4030) |  |
| [4031](#L4031) |  |
| [4032](#L4032) | $embed\_url="//www.dailymotion.com/embed/video/$vid"; |
| [4033](#L4033) |  |
| [4034](#L4034) | } |
| [4035](#L4035) |  |
| [4036](#L4036) |  |
| [4037](#L4037) |  |
| [4038](#L4038) | $HdnMediaSelection = trim ( esc\_url\_raw($\_POST ['HdnMediaSelection'] )); |
| [4039](#L4039) | $videotitle = trim ( sanitize\_text\_field($\_POST ['title'] )) ; |
| [4040](#L4040) |  |
| [4041](#L4041) | $videotitle = str\_replace("'","’",$videotitle); |
| [4042](#L4042) | $videotitle = str\_replace('"', '&quot;', $videotitle); |
| [4043](#L4043) |  |
| [4044](#L4044) |  |
| [4045](#L4045) | if($vtype=='html5'){ |
| [4046](#L4046) |  |
| [4047](#L4047) | $open\_link\_in = 1; |
| [4048](#L4048) |  |
| [4049](#L4049) | }else{ |
| [4050](#L4050) |  |
| [4051](#L4051) | if (isset ( $\_POST ['open\_link\_in'] )) |
| [4052](#L4052) | $open\_link\_in = 1; |
| [4053](#L4053) | else |
| [4054](#L4054) | $open\_link\_in = 0; |
| [4055](#L4055) |  |
| [4056](#L4056) | } |
| [4057](#L4057) |  |
| [4058](#L4058) |  |
| [4059](#L4059) |  |
| [4060](#L4060) |  |
| [4061](#L4061) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4062](#L4062) | // edit save |
| [4063](#L4063) |  |
| [4064](#L4064) | if (isset ( $\_POST ['videoid'] )) { |
| [4065](#L4065) |  |
| [4066](#L4066) |  |
| [4067](#L4067) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4068](#L4068) |  |
| [4069](#L4069) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4070](#L4070) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4071](#L4071) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4072](#L4072) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4073](#L4073) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4074](#L4074) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4075](#L4075) | exit; |
| [4076](#L4076) |  |
| [4077](#L4077) | } |
| [4078](#L4078) |  |
| [4079](#L4079) | try { |
| [4080](#L4080) |  |
| [4081](#L4081) | $videoidEdit=intval($\_POST ['videoid']); |
| [4082](#L4082) | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
| [4083](#L4083) |  |
| [4084](#L4084) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4085](#L4085) | $myrow = $wpdb->get\_row($query); |
| [4086](#L4086) |  |
| [4087](#L4087) |  |
| [4088](#L4088) | if (is\_object($myrow)) { |
| [4089](#L4089) |  |
| [4090](#L4090) | $image\_name = $myrow->image\_name; |
| [4091](#L4091) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4092](#L4092) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4093](#L4093) | $pInfo2 = pathinfo($imagetoDel); |
| [4094](#L4094) | $ext = $pInfo2 ['extension']; |
| [4095](#L4095) |  |
| [4096](#L4096) | @unlink($imagetoDel); |
| [4097](#L4097) |  |
| [4098](#L4098) | } |
| [4099](#L4099) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4100](#L4100) | $ext = $pInfo ['extension']; |
| [4101](#L4101) | $imagename = uniqid("vid\_") .".". $ext; |
| [4102](#L4102) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4103](#L4103) |  |
| [4104](#L4104) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4105](#L4105) | if(!file\_exists($imageUploadTo)){ |
| [4106](#L4106) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4107](#L4107) | } |
| [4108](#L4108) |  |
| [4109](#L4109) |  |
| [4110](#L4110) | } |
| [4111](#L4111) |  |
| [4112](#L4112) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4113](#L4113) | set media\_type='$media\_type', vtype='$vtype',vid='$vid',murl='$videourl',embed\_url='$embed\_url',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4114](#L4114) | title='$videotitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4115](#L4115) |  |
| [4116](#L4116) | //echo $query;die; |
| [4117](#L4117) | $wpdb->query ( $query ); |
| [4118](#L4118) |  |
| [4119](#L4119) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4120](#L4120) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4121](#L4121) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Video updated successfully.','wp-responsive-photo-gallery'); |
| [4122](#L4122) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4123](#L4123) |  |
| [4124](#L4124) | } catch ( Exception $e ) { |
| [4125](#L4125) |  |
| [4126](#L4126) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4127](#L4127) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4128](#L4128) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding video','wp-responsive-photo-gallery'); |
| [4129](#L4129) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4130](#L4130) | } |
| [4131](#L4131) |  |
| [4132](#L4132) |  |
| [4133](#L4133) |  |
| [4134](#L4134) |  |
| [4135](#L4135) |  |
| [4136](#L4136) | } else { |
| [4137](#L4137) |  |
| [4138](#L4138) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4139](#L4139) |  |
| [4140](#L4140) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4141](#L4141) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4142](#L4142) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4143](#L4143) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4144](#L4144) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4145](#L4145) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4146](#L4146) | exit; |
| [4147](#L4147) |  |
| [4148](#L4148) | } |
| [4149](#L4149) |  |
| [4150](#L4150) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4151](#L4151) | if (function\_exists ( 'date\_i18n' )) { |
| [4152](#L4152) |  |
| [4153](#L4153) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4154](#L4154) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4155](#L4155) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4156](#L4156) | else |
| [4157](#L4157) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4158](#L4158) | } |
| [4159](#L4159) |  |
| [4160](#L4160) | try { |
| [4161](#L4161) |  |
| [4162](#L4162) | if (trim ( $\_POST ['HdnMediaSelection'] ) != '') { |
| [4163](#L4163) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4164](#L4164) | $ext = isset($pInfo ['extension'])?$pInfo ['extension']:'jpeg'; |
| [4165](#L4165) | $imagename = uniqid("vid\_") . ".".$ext; |
| [4166](#L4166) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4167](#L4167) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4168](#L4168) | if(!file\_exists($imageUploadTo)){ |
| [4169](#L4169) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4170](#L4170) | } |
| [4171](#L4171) | } |
| [4172](#L4172) |  |
| [4173](#L4173) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4174](#L4174) | (media\_type,image\_name,title,murl,open\_link\_in,vtype,vid,videourl,embed\_url,HdnMediaSelection,createdon) |
| [4175](#L4175) | VALUES ('$media\_type','$imagename','$videotitle','$videourl', |
| [4176](#L4176) | $open\_link\_in,'$vtype','$vid','$videourl','$embed\_url','$HdnMediaSelection', '$createdOn')"; |
| [4177](#L4177) |  |
| [4178](#L4178) |  |
| [4179](#L4179) | $wpdb->query ( $query ); |
| [4180](#L4180) |  |
| [4181](#L4181) |  |
| [4182](#L4182) |  |
| [4183](#L4183) |  |
| [4184](#L4184) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4185](#L4185) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4186](#L4186) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New video added successfully.','wp-responsive-photo-gallery'); |
| [4187](#L4187) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4188](#L4188) | } catch ( Exception $e ) { |
| [4189](#L4189) |  |
| [4190](#L4190) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4191](#L4191) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4192](#L4192) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding video','wp-responsive-photo-gallery'); |
| [4193](#L4193) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4194](#L4194) | } |
| [4195](#L4195) |  |
| [4196](#L4196) |  |
| [4197](#L4197) | } |
| [4198](#L4198) |  |
| [4199](#L4199) | } |
| [4200](#L4200) | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='image'){ |
| [4201](#L4201) |  |
| [4202](#L4202) | global $wpdb; |
| [4203](#L4203) | $vid = uniqid ( 'vid\_' ); |
| [4204](#L4204) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [4205](#L4205) | $HdnMediaSelection = trim ( esc\_url\_raw($\_POST ['HdnMediaSelection\_image'] )); |
| [4206](#L4206) | $mtitle = trim ( sanitize\_text\_field($\_POST ['title'] )) ; |
| [4207](#L4207) |  |
| [4208](#L4208) | $mtitle = str\_replace("'","’",$mtitle); |
| [4209](#L4209) | $mtitle = str\_replace('"', '&quot;', $mtitle); |
| [4210](#L4210) | $murl = trim ( sanitize\_text\_field($\_POST ['murl'] )); |
| [4211](#L4211) |  |
| [4212](#L4212) |  |
| [4213](#L4213) |  |
| [4214](#L4214) |  |
| [4215](#L4215) | if (isset ( $\_POST ['open\_link\_in'] )) |
| [4216](#L4216) | $open\_link\_in = 1; |
| [4217](#L4217) | else |
| [4218](#L4218) | $open\_link\_in = 0; |
| [4219](#L4219) |  |
| [4220](#L4220) |  |
| [4221](#L4221) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4222](#L4222) | // edit save |
| [4223](#L4223) | if (isset ( $\_POST ['imageid'] )) { |
| [4224](#L4224) |  |
| [4225](#L4225) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4226](#L4226) |  |
| [4227](#L4227) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4228](#L4228) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4229](#L4229) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4230](#L4230) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4231](#L4231) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4232](#L4232) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4233](#L4233) | exit; |
| [4234](#L4234) |  |
| [4235](#L4235) | } |
| [4236](#L4236) |  |
| [4237](#L4237) | try { |
| [4238](#L4238) |  |
| [4239](#L4239) | $videoidEdit=intval(sanitize\_text\_field($\_POST ['imageid'])); |
| [4240](#L4240) | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
| [4241](#L4241) |  |
| [4242](#L4242) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4243](#L4243) | $myrow = $wpdb->get\_row($query); |
| [4244](#L4244) |  |
| [4245](#L4245) |  |
| [4246](#L4246) | if (is\_object($myrow)) { |
| [4247](#L4247) |  |
| [4248](#L4248) | $image\_name = $myrow->image\_name; |
| [4249](#L4249) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4250](#L4250) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4251](#L4251) | $pInfo2 = pathinfo($imagetoDel); |
| [4252](#L4252) | $ext = $pInfo2 ['extension']; |
| [4253](#L4253) |  |
| [4254](#L4254) | @unlink($imagetoDel); |
| [4255](#L4255) |  |
| [4256](#L4256) | } |
| [4257](#L4257) |  |
| [4258](#L4258) |  |
| [4259](#L4259) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4260](#L4260) | $ext = $pInfo ['extension']; |
| [4261](#L4261) | $imagename = uniqid("vid\_").".". $ext; |
| [4262](#L4262) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4263](#L4263) |  |
| [4264](#L4264) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4265](#L4265) | if(!file\_exists($imageUploadTo)){ |
| [4266](#L4266) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4267](#L4267) | } |
| [4268](#L4268) |  |
| [4269](#L4269) |  |
| [4270](#L4270) | } |
| [4271](#L4271) |  |
| [4272](#L4272) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4273](#L4273) | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4274](#L4274) | title='$mtitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4275](#L4275) |  |
| [4276](#L4276) | //echo $query;die; |
| [4277](#L4277) | $wpdb->query ( $query ); |
| [4278](#L4278) |  |
| [4279](#L4279) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4280](#L4280) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4281](#L4281) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Image updated successfully.','wp-responsive-photo-gallery'); |
| [4282](#L4282) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4283](#L4283) |  |
| [4284](#L4284) | } catch ( Exception $e ) { |
| [4285](#L4285) |  |
| [4286](#L4286) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4287](#L4287) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4288](#L4288) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding image','wp-responsive-photo-gallery'); |
| [4289](#L4289) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4290](#L4290) | } |
| [4291](#L4291) |  |
| [4292](#L4292) |  |
| [4293](#L4293) |  |
| [4294](#L4294) | } else { |
| [4295](#L4295) |  |
| [4296](#L4296) |  |
| [4297](#L4297) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4298](#L4298) |  |
| [4299](#L4299) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4300](#L4300) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4301](#L4301) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4302](#L4302) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4303](#L4303) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4304](#L4304) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4305](#L4305) | exit; |
| [4306](#L4306) |  |
| [4307](#L4307) | } |
| [4308](#L4308) |  |
| [4309](#L4309) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4310](#L4310) | if (function\_exists ( 'date\_i18n' )) { |
| [4311](#L4311) |  |
| [4312](#L4312) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4313](#L4313) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4314](#L4314) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4315](#L4315) | else |
| [4316](#L4316) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4317](#L4317) | } |
| [4318](#L4318) |  |
| [4319](#L4319) | try { |
| [4320](#L4320) |  |
| [4321](#L4321) | if (trim ( $\_POST ['HdnMediaSelection\_image'] ) != '') { |
| [4322](#L4322) |  |
| [4323](#L4323) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4324](#L4324) | $ext = $pInfo ['extension']; |
| [4325](#L4325) | $imagename = uniqid("vid\_").".". $ext; |
| [4326](#L4326) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4327](#L4327) |  |
| [4328](#L4328) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4329](#L4329) | if(!file\_exists($imageUploadTo)){ |
| [4330](#L4330) |  |
| [4331](#L4331) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4332](#L4332) |  |
| [4333](#L4333) | } |
| [4334](#L4334) | } |
| [4335](#L4335) |  |
| [4336](#L4336) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4337](#L4337) | (media\_type,image\_name,title,murl,open\_link\_in, |
| [4338](#L4338) | HdnMediaSelection,createdon) |
| [4339](#L4339) | VALUES ('$media\_type','$imagename','$mtitle','$murl', |
| [4340](#L4340) | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
| [4341](#L4341) |  |
| [4342](#L4342) |  |
| [4343](#L4343) | $wpdb->query ( $query ); |
| [4344](#L4344) |  |
| [4345](#L4345) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4346](#L4346) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4347](#L4347) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New image added successfully.','wp-responsive-photo-gallery'); |
| [4348](#L4348) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4349](#L4349) |  |
| [4350](#L4350) | } |
| [4351](#L4351) | catch ( Exception $e ) { |
| [4352](#L4352) |  |
| [4353](#L4353) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4354](#L4354) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4355](#L4355) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding image','wp-responsive-photo-gallery'); |
| [4356](#L4356) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4357](#L4357) | } |
| [4358](#L4358) |  |
| [4359](#L4359) |  |
| [4360](#L4360) | } |
| [4361](#L4361) |  |
| [4362](#L4362) |  |
| [4363](#L4363) |  |
| [4364](#L4364) | } |
| [4365](#L4365) | else if(isset($\_POST['media\_type']) and $\_POST['media\_type']=='link'){ |
| [4366](#L4366) |  |
| [4367](#L4367) | $vid = uniqid ( 'vid\_' ); |
| [4368](#L4368) | $media\_type=trim(sanitize\_text\_field($\_POST['media\_type'])); |
| [4369](#L4369) | $HdnMediaSelection = trim (sanitize\_text\_field( $\_POST ['HdnMediaSelection\_link'] )); |
| [4370](#L4370) | $mtitle = trim (sanitize\_text\_field( $\_POST ['title'] )); |
| [4371](#L4371) | $murl = trim ( esc\_url\_raw($\_POST ['murl'] )); |
| [4372](#L4372) | $mtitle = str\_replace("'","’",$mtitle); |
| [4373](#L4373) | $mtitle = str\_replace('"', '&quot;', $mtitle); |
| [4374](#L4374) | $open\_link\_in=1; |
| [4375](#L4375) |  |
| [4376](#L4376) |  |
| [4377](#L4377) | if (isset ( $\_POST ['open\_title\_link\_in'] )) |
| [4378](#L4378) | $open\_title\_link\_in = 1; |
| [4379](#L4379) | else |
| [4380](#L4380) | $open\_title\_link\_in = 0; |
| [4381](#L4381) |  |
| [4382](#L4382) |  |
| [4383](#L4383) |  |
| [4384](#L4384) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [4385](#L4385) | // edit save |
| [4386](#L4386) | if (isset ( $\_POST ['linkid'] )) { |
| [4387](#L4387) |  |
| [4388](#L4388) |  |
| [4389](#L4389) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4390](#L4390) |  |
| [4391](#L4391) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4392](#L4392) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4393](#L4393) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4394](#L4394) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4395](#L4395) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4396](#L4396) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4397](#L4397) | exit; |
| [4398](#L4398) |  |
| [4399](#L4399) | } |
| [4400](#L4400) |  |
| [4401](#L4401) |  |
| [4402](#L4402) | try { |
| [4403](#L4403) |  |
| [4404](#L4404) | $videoidEdit=intval($\_POST ['linkid']); |
| [4405](#L4405) | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
| [4406](#L4406) |  |
| [4407](#L4407) |  |
| [4408](#L4408) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$videoidEdit"; |
| [4409](#L4409) | $myrow = $wpdb->get\_row($query); |
| [4410](#L4410) |  |
| [4411](#L4411) |  |
| [4412](#L4412) | if (is\_object($myrow)) { |
| [4413](#L4413) |  |
| [4414](#L4414) | $image\_name = $myrow->image\_name; |
| [4415](#L4415) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [4416](#L4416) | $pInfo = pathinfo($myrow->HdnMediaSelection); |
| [4417](#L4417) | $pInfo2 = pathinfo($imagetoDel); |
| [4418](#L4418) | $ext = $pInfo2 ['extension']; |
| [4419](#L4419) | @unlink($imagetoDel); |
| [4420](#L4420) |  |
| [4421](#L4421) | } |
| [4422](#L4422) |  |
| [4423](#L4423) |  |
| [4424](#L4424) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4425](#L4425) | $ext = $pInfo ['extension']; |
| [4426](#L4426) | $imagename = uniqid("vid\_") . ".". $ext; |
| [4427](#L4427) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4428](#L4428) |  |
| [4429](#L4429) |  |
| [4430](#L4430) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4431](#L4431) | if(!file\_exists($imageUploadTo)){ |
| [4432](#L4432) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4433](#L4433) | } |
| [4434](#L4434) |  |
| [4435](#L4435) |  |
| [4436](#L4436) | } |
| [4437](#L4437) |  |
| [4438](#L4438) | $query = "update " . $wpdb->prefix . "rjg\_gallery |
| [4439](#L4439) | set media\_type='$media\_type', murl='$murl',image\_name='$imagename',HdnMediaSelection='$HdnMediaSelection', |
| [4440](#L4440) | title='$mtitle',open\_link\_in=$open\_link\_in where id=$videoidEdit"; |
| [4441](#L4441) |  |
| [4442](#L4442) | //echo $query;die; |
| [4443](#L4443) | $wpdb->query ( $query ); |
| [4444](#L4444) |  |
| [4445](#L4445) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4446](#L4446) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4447](#L4447) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Link updated successfully.','wp-responsive-photo-gallery'); |
| [4448](#L4448) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4449](#L4449) |  |
| [4450](#L4450) | } |
| [4451](#L4451) | catch ( Exception $e ) { |
| [4452](#L4452) |  |
| [4453](#L4453) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4454](#L4454) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4455](#L4455) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding link','wp-responsive-photo-gallery'); |
| [4456](#L4456) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4457](#L4457) | } |
| [4458](#L4458) |  |
| [4459](#L4459) |  |
| [4460](#L4460) |  |
| [4461](#L4461) |  |
| [4462](#L4462) | } else { |
| [4463](#L4463) |  |
| [4464](#L4464) |  |
| [4465](#L4465) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4466](#L4466) |  |
| [4467](#L4467) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4468](#L4468) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4469](#L4469) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4470](#L4470) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4471](#L4471) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4472](#L4472) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4473](#L4473) | exit; |
| [4474](#L4474) |  |
| [4475](#L4475) | } |
| [4476](#L4476) |  |
| [4477](#L4477) | $createdOn = date ( 'Y-m-d h:i:s' ); |
| [4478](#L4478) | if (function\_exists ( 'date\_i18n' )) { |
| [4479](#L4479) |  |
| [4480](#L4480) | $createdOn = date\_i18n ( 'Y-m-d' . ' ' . get\_option ( 'time\_format' ), false, false ); |
| [4481](#L4481) | if (get\_option ( 'time\_format' ) == 'H:i') |
| [4482](#L4482) | $createdOn = date ( 'Y-m-d H:i:s', strtotime ( $createdOn ) ); |
| [4483](#L4483) | else |
| [4484](#L4484) | $createdOn = date ( 'Y-m-d h:i:s', strtotime ( $createdOn ) ); |
| [4485](#L4485) | } |
| [4486](#L4486) |  |
| [4487](#L4487) | try { |
| [4488](#L4488) |  |
| [4489](#L4489) | if (trim ( $\_POST ['HdnMediaSelection\_link'] ) != '') { |
| [4490](#L4490) |  |
| [4491](#L4491) | $pInfo = pathinfo ( $HdnMediaSelection ); |
| [4492](#L4492) | $ext = $pInfo ['extension']; |
| [4493](#L4493) | $imagename = uniqid("vid\_")."." . $ext; |
| [4494](#L4494) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [4495](#L4495) | @copy ( $HdnMediaSelection, $imageUploadTo ); |
| [4496](#L4496) | if(!file\_exists($imageUploadTo)){ |
| [4497](#L4497) | rs\_photogallery\_save\_image\_remote\_lbox($HdnMediaSelection,$imageUploadTo); |
| [4498](#L4498) | } |
| [4499](#L4499) |  |
| [4500](#L4500) | } |
| [4501](#L4501) |  |
| [4502](#L4502) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [4503](#L4503) | (media\_type,image\_name,title,murl,open\_link\_in,HdnMediaSelection,createdon) |
| [4504](#L4504) | VALUES ('$media\_type','$imagename','$mtitle','$murl', |
| [4505](#L4505) | $open\_link\_in,'$HdnMediaSelection', '$createdOn')"; |
| [4506](#L4506) |  |
| [4507](#L4507) |  |
| [4508](#L4508) | $wpdb->query ( $query ); |
| [4509](#L4509) |  |
| [4510](#L4510) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4511](#L4511) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [4512](#L4512) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('New link added successfully.','wp-responsive-photo-gallery'); |
| [4513](#L4513) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4514](#L4514) |  |
| [4515](#L4515) | } |
| [4516](#L4516) | catch ( Exception $e ) { |
| [4517](#L4517) |  |
| [4518](#L4518) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [4519](#L4519) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [4520](#L4520) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while adding link','wp-responsive-photo-gallery'); |
| [4521](#L4521) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [4522](#L4522) | } |
| [4523](#L4523) |  |
| [4524](#L4524) |  |
| [4525](#L4525) | } |
| [4526](#L4526) |  |
| [4527](#L4527) |  |
| [4528](#L4528) | } |
| [4529](#L4529) |  |
| [4530](#L4530) |  |
| [4531](#L4531) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4532](#L4532) | exit (); |
| [4533](#L4533) |  |
| [4534](#L4534) |  |
| [4535](#L4535) | } else { |
| [4536](#L4536) |  |
| [4537](#L4537) | $uploads = wp\_upload\_dir (); |
| [4538](#L4538) | $baseurl = $uploads ['baseurl']; |
| [4539](#L4539) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [4540](#L4540) | ?> |
| [4541](#L4541) | <div style="float: left; width: 100%;"> |
| [4542](#L4542) |  |
| [4543](#L4543) | <table><tr> |
| [4544](#L4544) | <td> |
| [4545](#L4545) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [4546](#L4546) | <div id="fb-root"></div> |
| [4547](#L4547) | <script>(function(d, s, id) { |
| [4548](#L4548) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [4549](#L4549) | if (d.getElementById(id)) return; |
| [4550](#L4550) | js = d.createElement(s); js.id = id; |
| [4551](#L4551) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [4552](#L4552) | fjs.parentNode.insertBefore(js, fjs); |
| [4553](#L4553) | }(document, 'script', 'facebook-jssdk'));</script> |
| [4554](#L4554) | </td> |
| [4555](#L4555) | <td> |
| [4556](#L4556) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [4557](#L4557) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [4558](#L4558) | </a> |
| [4559](#L4559) | </td> |
| [4560](#L4560) | </tr> |
| [4561](#L4561) | </table> |
| [4562](#L4562) | <div style="clear:both"> |
| [4563](#L4563) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [4564](#L4564) | </div> |
| [4565](#L4565) | <div class="wrap"> |
| [4566](#L4566) | <?php |
| [4567](#L4567) | if (isset ( $\_GET ['id'] ) and intval($\_GET ['id']) > 0) { |
| [4568](#L4568) |  |
| [4569](#L4569) |  |
| [4570](#L4570) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_edit\_media' ) ) { |
| [4571](#L4571) |  |
| [4572](#L4572) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4573](#L4573) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4574](#L4574) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4575](#L4575) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4576](#L4576) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4577](#L4577) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4578](#L4578) | exit; |
| [4579](#L4579) |  |
| [4580](#L4580) | } |
| [4581](#L4581) |  |
| [4582](#L4582) | $id = intval($\_GET ['id']); |
| [4583](#L4583) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$id "; |
| [4584](#L4584) |  |
| [4585](#L4585) | $myrow = $wpdb->get\_row ( $query ); |
| [4586](#L4586) |  |
| [4587](#L4587) | if (is\_object ( $myrow )) { |
| [4588](#L4588) |  |
| [4589](#L4589) | $media\_type =  esc\_html($myrow->media\_type ); |
| [4590](#L4590) | $vtype =  esc\_html($myrow->vtype); |
| [4591](#L4591) | $title =  esc\_html($myrow->title) ; |
| [4592](#L4592) | $murl =   esc\_url($myrow->murl); |
| [4593](#L4593) | $image\_name = esc\_html($myrow->image\_name); |
| [4594](#L4594) | $video\_url = esc\_url($myrow->murl); |
| [4595](#L4595) | $HdnMediaSelection = esc\_url($myrow->HdnMediaSelection); |
| [4596](#L4596) | $videotitle = esc\_html($myrow->title); |
| [4597](#L4597) | $videotitleurl=esc\_url($myrow->videourl); |
| [4598](#L4598) | $open\_link\_in = intval($myrow->open\_link\_in); |
| [4599](#L4599) | } |
| [4600](#L4600) | ?> |
| [4601](#L4601) | <h2><?php echo \_\_( 'Update Image','wp-responsive-photo-gallery' );?></h2><?php |
| [4602](#L4602) | } |
| [4603](#L4603) | else { |
| [4604](#L4604) |  |
| [4605](#L4605) | $media\_type =  ""; |
| [4606](#L4606) | $vtype =  ""; |
| [4607](#L4607) | $title =  ""; |
| [4608](#L4608) | $murl =   ""; |
| [4609](#L4609) | $image\_name = ""; |
| [4610](#L4610) | $video\_url = ""; |
| [4611](#L4611) | $HdnMediaSelection = ""; |
| [4612](#L4612) | $videotitle = ""; |
| [4613](#L4613) | $videotitleurl=""; |
| [4614](#L4614) | $open\_link\_in = ""; |
| [4615](#L4615) |  |
| [4616](#L4616) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [4617](#L4617) |  |
| [4618](#L4618) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [4619](#L4619) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [4620](#L4620) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [4621](#L4621) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [4622](#L4622) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [4623](#L4623) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [4624](#L4624) | exit; |
| [4625](#L4625) |  |
| [4626](#L4626) | } |
| [4627](#L4627) |  |
| [4628](#L4628) | ?> |
| [4629](#L4629) | <h2><?php echo \_\_( 'Add Media','wp-responsive-photo-gallery' );?></h2> |
| [4630](#L4630) | <?php } ?> |
| [4631](#L4631) | <br /> |
| [4632](#L4632) | <div id="poststuff"> |
| [4633](#L4633) | <div id="post-body" class="metabox-holder columns-2"> |
| [4634](#L4634) | <div id="post-body-content"> |
| [4635](#L4635) |  |
| [4636](#L4636) | <div class="stuffbox" id="mediatype" style="width: 100%"> |
| [4637](#L4637) | <h3> |
| [4638](#L4638) | <label for="link\_name"><?php echo \_\_('Media Type','wp-responsive-photo-gallery');?> (<span |
| [4639](#L4639) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Media Type','wp-responsive-photo-gallery');?></span>) |
| [4640](#L4640) | </label> |
| [4641](#L4641) | </h3> |
| [4642](#L4642) | <div class="inside"> |
| [4643](#L4643) | <div> |
| [4644](#L4644) | <input type="radio" value="image" name="media\_type\_p" <?php if($media\_type=='image'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_image" /><?php echo \_\_('Image','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4645](#L4645) | <input type="radio" value="video" name="media\_type\_p" <?php if($media\_type=='video'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_video" /><?php echo \_\_('Video','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4646](#L4646) | <input <?php if($media\_type=='link'): ?> checked='checked' <?php endif;?> type="radio" value="link" name="media\_type\_p" style="width: 15px" id="type\_link" /><?php echo \_\_('Link','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4647](#L4647) |  |
| [4648](#L4648) | </div> |
| [4649](#L4649) | <div style="clear: both"></div> |
| [4650](#L4650) | <div></div> |
| [4651](#L4651) | <div style="clear: both"></div> |
| [4652](#L4652) | <br /> |
| [4653](#L4653) |  |
| [4654](#L4654) | </div> |
| [4655](#L4655) |  |
| [4656](#L4656) | <script> |
| [4657](#L4657) |  |
| [4658](#L4658) |  |
| [4659](#L4659) | jQuery(document).ready(function() { |
| [4660](#L4660) | jQuery("input[name = 'media\_type\_p']").click(function(){ |
| [4661](#L4661) | var radioValue = jQuery("input[name='media\_type\_p']:checked").val(); |
| [4662](#L4662) | if(radioValue=='video'){ |
| [4663](#L4663) |  |
| [4664](#L4664) | jQuery("#addvideo").show(500); |
| [4665](#L4665) | jQuery("#addimage\_").hide(500); |
| [4666](#L4666) | jQuery("#addlink\_").hide(500); |
| [4667](#L4667) |  |
| [4668](#L4668) | } |
| [4669](#L4669) | else if(radioValue=='image'){ |
| [4670](#L4670) |  |
| [4671](#L4671) | jQuery("#addvideo").hide(500); |
| [4672](#L4672) | jQuery("#addimage\_").show(500); |
| [4673](#L4673) | jQuery("#addlink\_").hide(500); |
| [4674](#L4674) | } |
| [4675](#L4675) | else if(radioValue=='link'){ |
| [4676](#L4676) |  |
| [4677](#L4677) | jQuery("#addlink\_").show(500); |
| [4678](#L4678) | jQuery("#addvideo").hide(500); |
| [4679](#L4679) | jQuery("#addimage\_").hide(500); |
| [4680](#L4680) |  |
| [4681](#L4681) | } |
| [4682](#L4682) |  |
| [4683](#L4683) | }); |
| [4684](#L4684) |  |
| [4685](#L4685) | <?php if(isset($\_GET['id']) and (int) $\_GET['id']>0):?> |
| [4686](#L4686) |  |
| [4687](#L4687) | <?php if($media\_type=='video') :?> |
| [4688](#L4688) | jQuery("#type\_video").trigger('click'); |
| [4689](#L4689) | <?php elseif($media\_type=='image'):?> |
| [4690](#L4690) | jQuery("#type\_image").trigger('click'); |
| [4691](#L4691) | <?php elseif($media\_type=='link'):?> |
| [4692](#L4692) | jQuery("#type\_link").trigger('click'); |
| [4693](#L4693) | <?php endif;?> |
| [4694](#L4694) |  |
| [4695](#L4695) | <?php endif;?> |
| [4696](#L4696) |  |
| [4697](#L4697) | }); |
| [4698](#L4698) |  |
| [4699](#L4699) |  |
| [4700](#L4700) | </script> |
| [4701](#L4701) | </div> |
| [4702](#L4702) | <form method="post" action="" id="addvideo" name="addvideo" enctype="multipart/form-data" style="display:none"> |
| [4703](#L4703) |  |
| [4704](#L4704) | <input type="hidden" name="media\_type" id="media\_type" value="video" /> |
| [4705](#L4705) | <div class="stuffbox" id="videoinfo\_div\_1" style="width: 100%;"> |
| [4706](#L4706) | <h3> |
| [4707](#L4707) | <label for="link\_name"><?php echo \_\_('Video Information','wp-responsive-photo-gallery');?> (<span |
| [4708](#L4708) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Choose Video Site','wp-responsive-photo-gallery');?></span>) |
| [4709](#L4709) | </label> |
| [4710](#L4710) | </h3> |
| [4711](#L4711) | <div class="inside"> |
| [4712](#L4712) | <div> |
| [4713](#L4713) | <input type="radio" value="youtube" name="vtype" |
| [4714](#L4714) | <?php if($vtype=='youtube'): ?> checked='checked' <?php endif;?> style="width: 15px" id="type\_youtube" /><?php echo \_\_('Youtube','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4715](#L4715) |  |
| [4716](#L4716) | <input <?php if($vtype=='dailymotion'): ?> checked='checked' <?php endif;?> type="radio" value="dailymotion" name="vtype" |
| [4717](#L4717) | style="width: 15px" id="type\_DailyMotion" /><?php echo \_\_('DailyMotion','wp-responsive-photo-gallery');?>&nbsp;&nbsp; |
| [4718](#L4718) | </div> |
| [4719](#L4719) | <div style="clear: both"></div> |
| [4720](#L4720) | <div></div> |
| [4721](#L4721) | <div style="clear: both"></div> |
| [4722](#L4722) | <br /> |
| [4723](#L4723) | <div id='vurl\_' > |
| [4724](#L4724) | <b ><?php echo \_\_('Video Url','wp-responsive-photo-gallery');?></b> <input style="width:98%" type="text" id="videourl" class="url" tabindex="1"  name="videourl" value="<?php echo $video\_url; ?>"> |
| [4725](#L4725) | </div> |
| [4726](#L4726) |  |
| [4727](#L4727) |  |
| [4728](#L4728) |  |
| [4729](#L4729) | <div style="clear: both"></div> |
| [4730](#L4730) | <div></div> |
| [4731](#L4731) | <div style="clear: both"> |
| [4732](#L4732) | <div id="youtube\_note" style="font-size:12px;display:none"> |
| [4733](#L4733) | <?php echo \_\_('Please do not use youtube.be, instead of use youtube.com','video-grid');?> |
| [4734](#L4734) | </div> |
| [4735](#L4735) | </div> |
| [4736](#L4736) | </div> |
| [4737](#L4737) | </div> |
| [4738](#L4738) | <div class="stuffbox" id="videoinfo\_div\_2" style="width: 100%;"> |
| [4739](#L4739) | <h3> |
| [4740](#L4740) | <label for="link\_name"><?php echo \_\_('Video Thumbnail Information','wp-responsive-photo-gallery');?></label> |
| [4741](#L4741) | </h3> |
| [4742](#L4742) | <div class="inside" id="fileuploaddiv"> |
| [4743](#L4743) | <?php if ($image\_name != "") { ?> |
| [4744](#L4744) | <div> |
| [4745](#L4745) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?>: </b> |
| [4746](#L4746) | <br/> |
| [4747](#L4747) | <img id="img\_disp" name="img\_disp" |
| [4748](#L4748) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [4749](#L4749) | </div> |
| [4750](#L4750) | <?php }else{ ?> |
| [4751](#L4751) | <img |
| [4752](#L4752) | src="<?php echo plugins\_url('/images/no-img.jpeg', \_\_FILE\_\_); ?>" |
| [4753](#L4753) | id="img\_disp" name="img\_disp" /> |
| [4754](#L4754) |  |
| [4755](#L4755) | <?php } ?> |
| [4756](#L4756) | <br /> <a |
| [4757](#L4757) | href="javascript:;" class="niks\_media" |
| [4758](#L4758) | id="videoFromExternalSite"  ><b><?php echo \_\_('Click Here to get video information and thumbnail','wp-responsive-photo-gallery');?><span id='fromval'> From <?php echo $vtype;?></span> |
| [4759](#L4759) | </b></a>&nbsp;<img |
| [4760](#L4760) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [4761](#L4761) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [4762](#L4762) | <div style="clear: both"></div> |
| [4763](#L4763) | <div></div> |
| [4764](#L4764) | <div class="uploader"> |
| [4765](#L4765) | <br /> <b style="margin-left: 50px;" id='or\_\_'>OR</b> |
| [4766](#L4766) | <div style="clear: both; margin-top: 15px;"></div> |
| [4767](#L4767) |  |
| [4768](#L4768) | <a |
| [4769](#L4769) | href="javascript:;" class="niks\_media" id="myMediaUploader"><b><?php echo \_\_('Click Here to upload custom video thumbnail','wp-responsive-photo-gallery');?></b></a> |
| [4770](#L4770) |  |
| [4771](#L4771) | <br /> <br /> |
| [4772](#L4772) | <div> |
| [4773](#L4773) | <input id="HdnMediaSelection" name="HdnMediaSelection" |
| [4774](#L4774) | type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [4775](#L4775) | </div> |
| [4776](#L4776) | <div style="clear: both"></div> |
| [4777](#L4777) | <div></div> |
| [4778](#L4778) | <div style="clear: both"></div> |
| [4779](#L4779) |  |
| [4780](#L4780) | <br /> |
| [4781](#L4781) | </div> |
| [4782](#L4782) |  |
| [4783](#L4783) | <script> |
| [4784](#L4784) |  |
| [4785](#L4785) |  |
| [4786](#L4786) | function GetParameterValues(param,str) { |
| [4787](#L4787) | var return\_p=''; |
| [4788](#L4788) | var url = str.slice(str.indexOf('?') + 1).split('&'); |
| [4789](#L4789) | for (var i = 0; i < url.length; i++) { |
| [4790](#L4790) | var urlparam = url[i].split('='); |
| [4791](#L4791) | if (urlparam[0] == param) { |
| [4792](#L4792) | return\_p= urlparam[1]; |
| [4793](#L4793) | } |
| [4794](#L4794) | } |
| [4795](#L4795) | return return\_p; |
| [4796](#L4796) | } |
| [4797](#L4797) |  |
| [4798](#L4798) |  |
| [4799](#L4799) |  |
| [4800](#L4800) | function UrlExists(url, cb){ |
| [4801](#L4801) | jQuery.ajax({ |
| [4802](#L4802) | url:      url, |
| [4803](#L4803) | dataType: 'text', |
| [4804](#L4804) | type:     'GET', |
| [4805](#L4805) | complete:  function(xhr){ |
| [4806](#L4806) | if(typeof cb === 'function') |
| [4807](#L4807) | cb.apply(this, [xhr.status]); |
| [4808](#L4808) | } |
| [4809](#L4809) | }); |
| [4810](#L4810) | } |
| [4811](#L4811) |  |
| [4812](#L4812) | function getDailyMotionId(url) { |
| [4813](#L4813) | if (url.indexOf("?") > 0) { |
| [4814](#L4814) | url = url.substring(0, url.indexOf("?")); |
| [4815](#L4815) | } |
| [4816](#L4816) | var m = url.match(/^.+dailymotion.com\/(video|hub)\/([^\_]+)[^#]\*(#video=([^\_&]+))?/); |
| [4817](#L4817) | if (m !== null) { |
| [4818](#L4818) | if(m[4] !== undefined) { |
| [4819](#L4819) | return m[4]; |
| [4820](#L4820) | } |
| [4821](#L4821) | return m[2]; |
| [4822](#L4822) | } |
| [4823](#L4823) | return null; |
| [4824](#L4824) | } |
| [4825](#L4825) |  |
| [4826](#L4826) |  |
| [4827](#L4827) | jQuery(document).ready(function() { |
| [4828](#L4828) |  |
| [4829](#L4829) |  |
| [4830](#L4830) |  |
| [4831](#L4831) | jQuery("input:radio[name=vtype]").click(function() { |
| [4832](#L4832) |  |
| [4833](#L4833) |  |
| [4834](#L4834) | var value = jQuery(this).val(); |
| [4835](#L4835) | jQuery("#fromval").html(" from " + value); |
| [4836](#L4836) | if(value=="youtube"){ |
| [4837](#L4837) |  |
| [4838](#L4838) | jQuery("#youtube\_note").show(); |
| [4839](#L4839) | } |
| [4840](#L4840) | else{ |
| [4841](#L4841) |  |
| [4842](#L4842) | jQuery("#youtube\_note").hide(); |
| [4843](#L4843) | } |
| [4844](#L4844) | }); |
| [4845](#L4845) | jQuery("#videoFromExternalSite").click(function() { |
| [4846](#L4846) |  |
| [4847](#L4847) |  |
| [4848](#L4848) | var videoService = jQuery('input[name="vtype"]:checked').length; |
| [4849](#L4849) | var videourlVal = jQuery.trim(jQuery("#videourl").val()); |
| [4850](#L4850) | var flag = true; |
| [4851](#L4851) | if (videourlVal == '' && videoService == 0){ |
| [4852](#L4852) |  |
| [4853](#L4853) | alert('Please select video site.\nPlease enter video url.'); |
| [4854](#L4854) | jQuery("input:radio[name=vtype]").focus(); |
| [4855](#L4855) | flag = false; |
| [4856](#L4856) |  |
| [4857](#L4857) | } |
| [4858](#L4858) | else if (videoService == 0){ |
| [4859](#L4859) |  |
| [4860](#L4860) | alert('Please select video site.'); |
| [4861](#L4861) | jQuery("input:radio[name=vtype]").focus(); |
| [4862](#L4862) | flag = false; |
| [4863](#L4863) | } |
| [4864](#L4864) | else if (videourlVal == ''){ |
| [4865](#L4865) |  |
| [4866](#L4866) | alert('Please enter video url.'); |
| [4867](#L4867) | jQuery("#videourl").focus(); |
| [4868](#L4868) | flag = false; |
| [4869](#L4869) | } |
| [4870](#L4870) |  |
| [4871](#L4871) | if (flag){ |
| [4872](#L4872) |  |
| [4873](#L4873) | setTimeout(function() { |
| [4874](#L4874) | jQuery("#loading\_img").show(); |
| [4875](#L4875) | }, 100); |
| [4876](#L4876) |  |
| [4877](#L4877) | var selectedRadio = jQuery('input[name=vtype]'); |
| [4878](#L4878) | var checkedValueRadio = selectedRadio.filter(':checked').val(); |
| [4879](#L4879) | if (checkedValueRadio == 'youtube') { |
| [4880](#L4880) | var vId = GetParameterValues('v', videourlVal); |
| [4881](#L4881) | if(vId!=''){ |
| [4882](#L4882) |  |
| [4883](#L4883) |  |
| [4884](#L4884) | var tumbnailImg='https://img.youtube.com/vi/'+vId+'/maxresdefault.jpg'; |
| [4885](#L4885) |  |
| [4886](#L4886) | var data = { |
| [4887](#L4887) | 'action': 'rjg\_check\_file\_exist\_justified\_gallery', |
| [4888](#L4888) | 'url': tumbnailImg, |
| [4889](#L4889) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4890](#L4890) | }; |
| [4891](#L4891) |  |
| [4892](#L4892) | jQuery.post(ajaxurl, data, function(response) { |
| [4893](#L4893) |  |
| [4894](#L4894) |  |
| [4895](#L4895) |  |
| [4896](#L4896) | var youtubeJsonUri='https://www.youtube.com/oembed?url=https://www.youtube.com/watch%3Fv='+vId+'&format=json'; |
| [4897](#L4897) | var data\_youtube = { |
| [4898](#L4898) | 'action': 'rjg\_get\_youtube\_info\_justified\_gallery', |
| [4899](#L4899) | 'url': youtubeJsonUri, |
| [4900](#L4900) | 'vid':vId, |
| [4901](#L4901) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4902](#L4902) | }; |
| [4903](#L4903) |  |
| [4904](#L4904) | jQuery.post(ajaxurl, data\_youtube, function(data) { |
| [4905](#L4905) |  |
| [4906](#L4906) | data = jQuery.parseJSON(data); |
| [4907](#L4907) |  |
| [4908](#L4908) | if(typeof data =='object'){ |
| [4909](#L4909) | if(typeof data =='object'){ |
| [4910](#L4910) |  |
| [4911](#L4911) | if(data.title!='' && data.title!=''){ |
| [4912](#L4912) | jQuery("#title").val(data.title); |
| [4913](#L4913) | } |
| [4914](#L4914) | jQuery("#murl").val(videourlVal); |
| [4915](#L4915) | if(data.description!='' && data.description!=''){ |
| [4916](#L4916) | jQuery("#mdescription").val(data.description); |
| [4917](#L4917) | } |
| [4918](#L4918) | if(response=='404' && data.thumbnail\_url!=''){ |
| [4919](#L4919) | tumbnailImg=data.thumbnail\_url; |
| [4920](#L4920) | } |
| [4921](#L4921) | else{ |
| [4922](#L4922) | tumbnailImg='https://img.youtube.com/vi/'+vId+'/0.jpg'; |
| [4923](#L4923) | } |
| [4924](#L4924) |  |
| [4925](#L4925) | jQuery("#img\_disp").attr('src', tumbnailImg); |
| [4926](#L4926) | jQuery("#HdnMediaSelection").val(tumbnailImg); |
| [4927](#L4927) | jQuery("#loading\_img").hide(); |
| [4928](#L4928) |  |
| [4929](#L4929) | } |
| [4930](#L4930) |  |
| [4931](#L4931) | } |
| [4932](#L4932) | jQuery("#loading\_img").hide(); |
| [4933](#L4933) | }) |
| [4934](#L4934) |  |
| [4935](#L4935) |  |
| [4936](#L4936) | }); |
| [4937](#L4937) |  |
| [4938](#L4938) | } |
| [4939](#L4939) | else{ |
| [4940](#L4940) | alert('Could not found such video'); |
| [4941](#L4941) | jQuery("#loading\_img").hide(); |
| [4942](#L4942) | } |
| [4943](#L4943) | } |
| [4944](#L4944) | else if (checkedValueRadio == 'vimeo') { |
| [4945](#L4945) |  |
| [4946](#L4946) | var n = videourlVal.lastIndexOf('/'); |
| [4947](#L4947) | var vId = videourlVal.substring(n + 1); |
| [4948](#L4948) |  |
| [4949](#L4949) |  |
| [4950](#L4950) | var VimeoJsonUri='https://vimeo.com/api/v2/video/'+vId+'.json'; |
| [4951](#L4951) | jQuery.getJSON( VimeoJsonUri, function( data ) { |
| [4952](#L4952) |  |
| [4953](#L4953) | if(typeof data =='object'){ |
| [4954](#L4954) | if(typeof data[0] =='object'){ |
| [4955](#L4955) |  |
| [4956](#L4956) | if(data[0].title!='' && data[0].title!=''){ |
| [4957](#L4957) | jQuery("#title").val(data[0].title); |
| [4958](#L4958) | } |
| [4959](#L4959) |  |
| [4960](#L4960) | jQuery("#murl").val(videourlVal); |
| [4961](#L4961) | if(data[0].description!='' && data[0].description!=''){ |
| [4962](#L4962) | jQuery("#mdescription").val(data[0].description); |
| [4963](#L4963) | } |
| [4964](#L4964) | jQuery("#img\_disp").attr('src', data[0].thumbnail\_large); |
| [4965](#L4965) | jQuery("#HdnMediaSelection").val(data[0].thumbnail\_large); |
| [4966](#L4966) | jQuery("#loading\_img").hide(); |
| [4967](#L4967) |  |
| [4968](#L4968) | } |
| [4969](#L4969) |  |
| [4970](#L4970) | } |
| [4971](#L4971) |  |
| [4972](#L4972) | jQuery("#loading\_img").hide(); |
| [4973](#L4973) | }) |
| [4974](#L4974) |  |
| [4975](#L4975) |  |
| [4976](#L4976) |  |
| [4977](#L4977) | } |
| [4978](#L4978) | else if(checkedValueRadio == 'metacafe'){ |
| [4979](#L4979) |  |
| [4980](#L4980) | jQuery("#loading\_img").show(); |
| [4981](#L4981) | var data = { |
| [4982](#L4982) | 'action': 'rjg\_get\_metacafe\_info\_justified\_gallery', |
| [4983](#L4983) | 'url': videourlVal, |
| [4984](#L4984) | 'vNonce':'<?php echo $vNonce; ?>' |
| [4985](#L4985) | }; |
| [4986](#L4986) |  |
| [4987](#L4987) | jQuery.post(ajaxurl, data,function(response) { |
| [4988](#L4988) |  |
| [4989](#L4989) | obj = jQuery.parseJSON(response); |
| [4990](#L4990) | jQuery("#HdnMediaSelection").val(obj.HdnMediaSelection); |
| [4991](#L4991) | jQuery("#title").val(jQuery.trim(obj.videotitle)); |
| [4992](#L4992) | jQuery("#murl").val(obj.videotitleurl); |
| [4993](#L4993) | jQuery("#mdescription").val(jQuery.trim(obj.video\_description)); |
| [4994](#L4994) | jQuery("#img\_disp").attr('src', obj.HdnMediaSelection); |
| [4995](#L4995) | jQuery("#loading\_img").hide(); |
| [4996](#L4996) | }); |
| [4997](#L4997) |  |
| [4998](#L4998) |  |
| [4999](#L4999) | } |
| [5000](#L5000) | else if(checkedValueRadio == 'dailymotion'){ |
| [5001](#L5001) |  |
| [5002](#L5002) | var vid=getDailyMotionId(videourlVal); |
| [5003](#L5003) | var apiUrl='https://api.dailymotion.com/video/'+vid+'?fields=description,id,thumbnail\_720\_url,title'; |
| [5004](#L5004) | jQuery.getJSON( apiUrl, function( data ) { |
| [5005](#L5005) | if(typeof data =='object'){ |
| [5006](#L5006) |  |
| [5007](#L5007) |  |
| [5008](#L5008) | jQuery("#HdnMediaSelection").val(data.thumbnail\_720\_url); |
| [5009](#L5009) | jQuery("#title").val(jQuery.trim(data.title)); |
| [5010](#L5010) | jQuery("#murl").val(videourlVal); |
| [5011](#L5011) | jQuery("#mdescription").val(data.description); |
| [5012](#L5012) | jQuery("#img\_disp").attr('src', data.thumbnail\_720\_url); |
| [5013](#L5013) | jQuery("#loading\_img").hide(); |
| [5014](#L5014) | } |
| [5015](#L5015) | jQuery("#loading\_img").hide(); |
| [5016](#L5016) | }) |
| [5017](#L5017) |  |
| [5018](#L5018) |  |
| [5019](#L5019) | jQuery("#loading\_img").hide(); |
| [5020](#L5020) | } |
| [5021](#L5021) |  |
| [5022](#L5022) | jQuery("#loading\_img").hide(); |
| [5023](#L5023) | } |
| [5024](#L5024) |  |
| [5025](#L5025) | setTimeout(function() { |
| [5026](#L5026) | jQuery("#loading\_img").hide(); |
| [5027](#L5027) | }, 2000); |
| [5028](#L5028) |  |
| [5029](#L5029) | }); |
| [5030](#L5030) | //uploading files variable |
| [5031](#L5031) | var custom\_file\_frame; |
| [5032](#L5032) | jQuery("#myMediaUploader").click(function(event) { |
| [5033](#L5033) | event.preventDefault(); |
| [5034](#L5034) | //If the frame already exists, reopen it |
| [5035](#L5035) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5036](#L5036) | custom\_file\_frame.close(); |
| [5037](#L5037) | } |
| [5038](#L5038) |  |
| [5039](#L5039) | //Create WP media frame. |
| [5040](#L5040) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5041](#L5041) | //Title of media manager frame |
| [5042](#L5042) | title: "WP Media Uploader", |
| [5043](#L5043) | library: { |
| [5044](#L5044) | type: 'image' |
| [5045](#L5045) | }, |
| [5046](#L5046) | button: { |
| [5047](#L5047) | //Button text |
| [5048](#L5048) | text: "Set Image" |
| [5049](#L5049) | }, |
| [5050](#L5050) | //Do not allow multiple files, if you want multiple, set true |
| [5051](#L5051) | multiple: false |
| [5052](#L5052) | }); |
| [5053](#L5053) | //callback for selected image |
| [5054](#L5054) | custom\_file\_frame.on('select', function() { |
| [5055](#L5055) |  |
| [5056](#L5056) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5057](#L5057) | var validExtensions = new Array(); |
| [5058](#L5058) | validExtensions[0] = 'jpg'; |
| [5059](#L5059) | validExtensions[1] = 'jpeg'; |
| [5060](#L5060) | validExtensions[2] = 'png'; |
| [5061](#L5061) | validExtensions[3] = 'gif'; |
| [5062](#L5062) |  |
| [5063](#L5063) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5064](#L5064) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5065](#L5065) |  |
| [5066](#L5066) | var titleTouse = ""; |
| [5067](#L5067) | var imageDescriptionTouse = ""; |
| [5068](#L5068) | if (jQuery.trim(attachment.title) != ''){ |
| [5069](#L5069) |  |
| [5070](#L5070) | titleTouse = jQuery.trim(attachment.title); |
| [5071](#L5071) | } |
| [5072](#L5072) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5073](#L5073) |  |
| [5074](#L5074) | titleTouse = jQuery.trim(attachment.caption); |
| [5075](#L5075) | } |
| [5076](#L5076) |  |
| [5077](#L5077) | if (jQuery.trim(attachment.description) != ''){ |
| [5078](#L5078) |  |
| [5079](#L5079) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5080](#L5080) | } |
| [5081](#L5081) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5082](#L5082) |  |
| [5083](#L5083) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5084](#L5084) | } |
| [5085](#L5085) |  |
| [5086](#L5086) | // jQuery("#videotitle").val(titleTouse); |
| [5087](#L5087) | //  jQuery("#video\_description").val(imageDescriptionTouse); |
| [5088](#L5088) |  |
| [5089](#L5089) | if (attachment.id != ''){ |
| [5090](#L5090) |  |
| [5091](#L5091) | jQuery("#HdnMediaSelection").val(attachment.url); |
| [5092](#L5092) | jQuery("#img\_disp").attr('src', attachment.url); |
| [5093](#L5093) |  |
| [5094](#L5094) | } |
| [5095](#L5095) |  |
| [5096](#L5096) | } |
| [5097](#L5097) | else{ |
| [5098](#L5098) |  |
| [5099](#L5099) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5100](#L5100) | } |
| [5101](#L5101) | //do something with attachment variable, for example attachment.filename |
| [5102](#L5102) | //Object: |
| [5103](#L5103) | //attachment.alt - image alt |
| [5104](#L5104) | //attachment.author - author id |
| [5105](#L5105) | //attachment.caption |
| [5106](#L5106) | //attachment.dateFormatted - date of image uploaded |
| [5107](#L5107) | //attachment.description |
| [5108](#L5108) | //attachment.editLink - edit link of media |
| [5109](#L5109) | //attachment.filename |
| [5110](#L5110) | //attachment.height |
| [5111](#L5111) | //attachment.icon - don't know WTF?)) |
| [5112](#L5112) | //attachment.id - id of attachment |
| [5113](#L5113) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5114](#L5114) | //attachment.menuOrder |
| [5115](#L5115) | //attachment.mime - mime type, for example image/jpeg" |
| [5116](#L5116) | //attachment.name - name of attachment file, for example "my-image" |
| [5117](#L5117) | //attachment.status - usual is "inherit" |
| [5118](#L5118) | //attachment.subtype - "jpeg" if is "jpg" |
| [5119](#L5119) | //attachment.title |
| [5120](#L5120) | //attachment.type - "image" |
| [5121](#L5121) | //attachment.uploadedTo |
| [5122](#L5122) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5123](#L5123) | //attachment.width |
| [5124](#L5124) | }); |
| [5125](#L5125) | //Open modal |
| [5126](#L5126) | custom\_file\_frame.open(); |
| [5127](#L5127) | }); |
| [5128](#L5128) | }) |
| [5129](#L5129) | </script> |
| [5130](#L5130) | </div> |
| [5131](#L5131) | </div> |
| [5132](#L5132) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5133](#L5133) | <h3> |
| [5134](#L5134) | <label for="link\_name"><?php echo \_\_('Video Title','wp-responsive-photo-gallery');?> (<span |
| [5135](#L5135) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','wp-responsive-photo-gallery');?></span>) |
| [5136](#L5136) | </label> |
| [5137](#L5137) | </h3> |
| [5138](#L5138) | <div class="inside"> |
| [5139](#L5139) | <div> |
| [5140](#L5140) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5141](#L5141) | </div> |
| [5142](#L5142) | <div style="clear: both"></div> |
| [5143](#L5143) | <div></div> |
| [5144](#L5144) | <div style="clear: both"></div> |
| [5145](#L5145) | </div> |
| [5146](#L5146) | </div> |
| [5147](#L5147) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5148](#L5148) | <h3> |
| [5149](#L5149) | <label for="link\_name"><?php echo \_\_('Video Title Url','wp-responsive-photo-gallery');?> (<span |
| [5150](#L5150) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for video title','wp-responsive-photo-gallery');?></span>) |
| [5151](#L5151) | </label> |
| [5152](#L5152) | </h3> |
| [5153](#L5153) | <div class="inside"> |
| [5154](#L5154) | <div> |
| [5155](#L5155) | <input type="text" id="murl" |
| [5156](#L5156) | tabindex="1" size="30" name="murl" |
| [5157](#L5157) | value="<?php echo $videotitleurl; ?>"> |
| [5158](#L5158) | </div> |
| [5159](#L5159) | <div style="clear: both"></div> |
| [5160](#L5160) | <div></div> |
| [5161](#L5161) | <div style="clear: both"></div> |
| [5162](#L5162) |  |
| [5163](#L5163) | </div> |
| [5164](#L5164) | </div> |
| [5165](#L5165) |  |
| [5166](#L5166) | <div class="stuffbox playvideoinlightbox" id="namediv" style="width: 100%"> |
| [5167](#L5167) | <h3> |
| [5168](#L5168) | <label><?php echo \_\_('Play Video In Lightbox?','wp-responsive-photo-gallery');?> (<span |
| [5169](#L5169) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show video in lightbox or redirect?','wp-responsive-photo-gallery');?></span>) |
| [5170](#L5170) | </label> |
| [5171](#L5171) | </h3> |
| [5172](#L5172) | <div class="inside"> |
| [5173](#L5173) | <table> |
| [5174](#L5174) | <tr> |
| [5175](#L5175) | <td> |
| [5176](#L5176) | <div> |
| [5177](#L5177) | <input type="checkbox" id="open\_link\_in" size="30" |
| [5178](#L5178) | name="open\_link\_in" value="" |
| [5179](#L5179) | <?php |
| [5180](#L5180) | if ($open\_link\_in == true) { |
| [5181](#L5181) | echo "checked='checked'"; |
| [5182](#L5182) | } |
| [5183](#L5183) | ?> |
| [5184](#L5184) | style="width: 20px;">&nbsp;<?php echo \_\_('Show Video In Lightbox?','wp-responsive-photo-gallery');?> |
| [5185](#L5185) | </div> |
| [5186](#L5186) | <div style="clear: both"></div> |
| [5187](#L5187) | <div></div> |
| [5188](#L5188) | </td> |
| [5189](#L5189) | </tr> |
| [5190](#L5190) | </table> |
| [5191](#L5191) | <div style="clear: both"></div> |
| [5192](#L5192) | </div> |
| [5193](#L5193) | </div> |
| [5194](#L5194) |  |
| [5195](#L5195) |  |
| [5196](#L5196) |  |
| [5197](#L5197) | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
| [5198](#L5198) | <input type="hidden" name="videoid" id="videoid" value="<?php echo (int) $\_GET['id']; ?>"> |
| [5199](#L5199) | <?php |
| [5200](#L5200) | } |
| [5201](#L5201) | ?> |
| [5202](#L5202) |  |
| [5203](#L5203) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5204](#L5204) | <input type="submit" |
| [5205](#L5205) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5206](#L5206) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5207](#L5207) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5208](#L5208) | class="button-primary" |
| [5209](#L5209) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5210](#L5210) |  |
| [5211](#L5211) | </form> |
| [5212](#L5212) | <form method="post" action="" id="addimage\_" name="addimage\_" enctype="multipart/form-data" style="display:none"> |
| [5213](#L5213) |  |
| [5214](#L5214) | <input type="hidden" name="media\_type" id="media\_type" value="image" /> |
| [5215](#L5215) | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
| [5216](#L5216) | <h3> |
| [5217](#L5217) | <label for="link\_name"><?php echo \_\_('Image Information','wp-responsive-photo-gallery');?></label> |
| [5218](#L5218) | </h3> |
| [5219](#L5219) | <div class="inside" id="fileuploaddiv"> |
| [5220](#L5220) | <?php if ($image\_name != "") { ?> |
| [5221](#L5221) | <div> |
| [5222](#L5222) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?> : </b> |
| [5223](#L5223) | <br/> |
| [5224](#L5224) | <img id="img\_disp\_img" name="img\_disp\_img" |
| [5225](#L5225) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [5226](#L5226) | </div> |
| [5227](#L5227) | <?php }else{ ?> |
| [5228](#L5228) | <img |
| [5229](#L5229) | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
| [5230](#L5230) | id="img\_disp\_img" name="img\_disp\_img" /> |
| [5231](#L5231) |  |
| [5232](#L5232) | <?php } ?> |
| [5233](#L5233) | <img |
| [5234](#L5234) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [5235](#L5235) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [5236](#L5236) | <div style="clear: both"></div> |
| [5237](#L5237) | <div></div> |
| [5238](#L5238) | <div class="uploader"> |
| [5239](#L5239) |  |
| [5240](#L5240) | <div style="clear: both; margin-top: 15px;"></div> |
| [5241](#L5241) | <a |
| [5242](#L5242) | href="javascript:;" class="niks\_media" id="myMediaUploader\_image"><b><?php echo \_\_('Click Here to upload Image','wp-responsive-photo-gallery');?></b></a> |
| [5243](#L5243) | <br /> <br /> |
| [5244](#L5244) | <div> |
| [5245](#L5245) | <input id="HdnMediaSelection\_image" name="HdnMediaSelection\_image" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [5246](#L5246) | </div> |
| [5247](#L5247) | <div style="clear: both"></div> |
| [5248](#L5248) | <div></div> |
| [5249](#L5249) | <div style="clear: both"></div> |
| [5250](#L5250) |  |
| [5251](#L5251) | <br /> |
| [5252](#L5252) | </div> |
| [5253](#L5253) | </div> |
| [5254](#L5254) |  |
| [5255](#L5255) | <script> |
| [5256](#L5256) | //uploading files variable |
| [5257](#L5257) | var custom\_file\_frame; |
| [5258](#L5258) | jQuery("#myMediaUploader\_image").click(function(event) { |
| [5259](#L5259) | event.preventDefault(); |
| [5260](#L5260) | //If the frame already exists, reopen it |
| [5261](#L5261) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5262](#L5262) | custom\_file\_frame.close(); |
| [5263](#L5263) | } |
| [5264](#L5264) |  |
| [5265](#L5265) | //Create WP media frame. |
| [5266](#L5266) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5267](#L5267) | //Title of media manager frame |
| [5268](#L5268) | title: "WP Media Uploader", |
| [5269](#L5269) | library: { |
| [5270](#L5270) | type: 'image' |
| [5271](#L5271) | }, |
| [5272](#L5272) | button: { |
| [5273](#L5273) | //Button text |
| [5274](#L5274) | text: "Set Image" |
| [5275](#L5275) | }, |
| [5276](#L5276) | //Do not allow multiple files, if you want multiple, set true |
| [5277](#L5277) | multiple: false |
| [5278](#L5278) | }); |
| [5279](#L5279) | //callback for selected image |
| [5280](#L5280) | custom\_file\_frame.on('select', function() { |
| [5281](#L5281) |  |
| [5282](#L5282) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5283](#L5283) | var validExtensions = new Array(); |
| [5284](#L5284) | validExtensions[0] = 'jpg'; |
| [5285](#L5285) | validExtensions[1] = 'jpeg'; |
| [5286](#L5286) | validExtensions[2] = 'png'; |
| [5287](#L5287) | validExtensions[3] = 'gif'; |
| [5288](#L5288) |  |
| [5289](#L5289) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5290](#L5290) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5291](#L5291) |  |
| [5292](#L5292) | var titleTouse = ""; |
| [5293](#L5293) | var imageDescriptionTouse = ""; |
| [5294](#L5294) | if (jQuery.trim(attachment.title) != ''){ |
| [5295](#L5295) |  |
| [5296](#L5296) | titleTouse = jQuery.trim(attachment.title); |
| [5297](#L5297) | } |
| [5298](#L5298) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5299](#L5299) |  |
| [5300](#L5300) | titleTouse = jQuery.trim(attachment.caption); |
| [5301](#L5301) | } |
| [5302](#L5302) |  |
| [5303](#L5303) | if (jQuery.trim(attachment.description) != ''){ |
| [5304](#L5304) |  |
| [5305](#L5305) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5306](#L5306) | } |
| [5307](#L5307) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5308](#L5308) |  |
| [5309](#L5309) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5310](#L5310) | } |
| [5311](#L5311) |  |
| [5312](#L5312) | jQuery("#addimage\_ #title").val(titleTouse); |
| [5313](#L5313) | jQuery("#addimage\_ #mdescription").val(imageDescriptionTouse); |
| [5314](#L5314) |  |
| [5315](#L5315) | if (attachment.id != ''){ |
| [5316](#L5316) |  |
| [5317](#L5317) | jQuery("#HdnMediaSelection\_image").val(attachment.url); |
| [5318](#L5318) | jQuery("#img\_disp\_img").attr('src', attachment.url); |
| [5319](#L5319) |  |
| [5320](#L5320) | } |
| [5321](#L5321) |  |
| [5322](#L5322) | } |
| [5323](#L5323) | else{ |
| [5324](#L5324) |  |
| [5325](#L5325) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5326](#L5326) | } |
| [5327](#L5327) | //do something with attachment variable, for example attachment.filename |
| [5328](#L5328) | //Object: |
| [5329](#L5329) | //attachment.alt - image alt |
| [5330](#L5330) | //attachment.author - author id |
| [5331](#L5331) | //attachment.caption |
| [5332](#L5332) | //attachment.dateFormatted - date of image uploaded |
| [5333](#L5333) | //attachment.description |
| [5334](#L5334) | //attachment.editLink - edit link of media |
| [5335](#L5335) | //attachment.filename |
| [5336](#L5336) | //attachment.height |
| [5337](#L5337) | //attachment.icon - don't know WTF?)) |
| [5338](#L5338) | //attachment.id - id of attachment |
| [5339](#L5339) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5340](#L5340) | //attachment.menuOrder |
| [5341](#L5341) | //attachment.mime - mime type, for example image/jpeg" |
| [5342](#L5342) | //attachment.name - name of attachment file, for example "my-image" |
| [5343](#L5343) | //attachment.status - usual is "inherit" |
| [5344](#L5344) | //attachment.subtype - "jpeg" if is "jpg" |
| [5345](#L5345) | //attachment.title |
| [5346](#L5346) | //attachment.type - "image" |
| [5347](#L5347) | //attachment.uploadedTo |
| [5348](#L5348) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5349](#L5349) | //attachment.width |
| [5350](#L5350) | }); |
| [5351](#L5351) | //Open modal |
| [5352](#L5352) | custom\_file\_frame.open(); |
| [5353](#L5353) | }); |
| [5354](#L5354) |  |
| [5355](#L5355) | </script> |
| [5356](#L5356) | </div> |
| [5357](#L5357) |  |
| [5358](#L5358) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5359](#L5359) | <h3> |
| [5360](#L5360) | <label for="link\_name"><?php echo \_\_('Image Title','wp-responsive-photo-gallery');?> (<span |
| [5361](#L5361) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into lightbox','wp-responsive-photo-gallery');?></span>) |
| [5362](#L5362) | </label> |
| [5363](#L5363) | </h3> |
| [5364](#L5364) | <div class="inside"> |
| [5365](#L5365) | <div> |
| [5366](#L5366) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5367](#L5367) | </div> |
| [5368](#L5368) | <div style="clear: both"></div> |
| [5369](#L5369) | <div></div> |
| [5370](#L5370) | <div style="clear: both"></div> |
| [5371](#L5371) | </div> |
| [5372](#L5372) | </div> |
| [5373](#L5373) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5374](#L5374) | <h3> |
| [5375](#L5375) | <label for="link\_name"><?php echo \_\_('Image Title Url','wp-responsive-photo-gallery');?> (<span |
| [5376](#L5376) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on title redirect to this url.Used in lightbox for video title','wp-responsive-photo-gallery');?></span>) |
| [5377](#L5377) | </label> |
| [5378](#L5378) | </h3> |
| [5379](#L5379) | <div class="inside"> |
| [5380](#L5380) | <div> |
| [5381](#L5381) | <input type="text" id="murl" |
| [5382](#L5382) | tabindex="1" size="30" name="murl" |
| [5383](#L5383) | value="<?php echo $murl; ?>"> |
| [5384](#L5384) | </div> |
| [5385](#L5385) | <div style="clear: both"></div> |
| [5386](#L5386) | <div></div> |
| [5387](#L5387) | <div style="clear: both"></div> |
| [5388](#L5388) |  |
| [5389](#L5389) | </div> |
| [5390](#L5390) | </div> |
| [5391](#L5391) |  |
| [5392](#L5392) |  |
| [5393](#L5393) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5394](#L5394) | <h3> |
| [5395](#L5395) | <label><?php echo \_\_('Show Image In Lightbox?','wp-responsive-photo-gallery');?> (<span |
| [5396](#L5396) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('show image in lightbox or redirect ?','wp-responsive-photo-gallery');?></span>) |
| [5397](#L5397) | </label> |
| [5398](#L5398) | </h3> |
| [5399](#L5399) | <div class="inside"> |
| [5400](#L5400) | <table> |
| [5401](#L5401) | <tr> |
| [5402](#L5402) | <td> |
| [5403](#L5403) | <div> |
| [5404](#L5404) | <input type="checkbox" id="open\_link\_in" size="30" |
| [5405](#L5405) | name="open\_link\_in" value="" |
| [5406](#L5406) | <?php |
| [5407](#L5407) | if ($open\_link\_in == true) { |
| [5408](#L5408) | echo "checked='checked'"; |
| [5409](#L5409) | } |
| [5410](#L5410) | ?> |
| [5411](#L5411) | style="width: 20px;">&nbsp;Show image In Lightbox? |
| [5412](#L5412) | </div> |
| [5413](#L5413) | <div style="clear: both"></div> |
| [5414](#L5414) | <div></div> |
| [5415](#L5415) | </td> |
| [5416](#L5416) | </tr> |
| [5417](#L5417) | </table> |
| [5418](#L5418) | <div style="clear: both"></div> |
| [5419](#L5419) | </div> |
| [5420](#L5420) | </div> |
| [5421](#L5421) | <?php if (isset($\_GET['id']) and intval($\_GET['id']) > 0) { ?> |
| [5422](#L5422) | <input type="hidden" name="imageid" id="imageid" value="<?php echo intval($\_GET['id']); ?>"> |
| [5423](#L5423) | <?php |
| [5424](#L5424) | } |
| [5425](#L5425) | ?> |
| [5426](#L5426) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5427](#L5427) | <input type="submit" |
| [5428](#L5428) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5429](#L5429) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5430](#L5430) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5431](#L5431) | class="button-primary" |
| [5432](#L5432) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5433](#L5433) |  |
| [5434](#L5434) | </form> |
| [5435](#L5435) | <form method="post" action="" id="addlink\_" name="addlink\_" enctype="multipart/form-data" style="display:none"> |
| [5436](#L5436) |  |
| [5437](#L5437) | <input type="hidden" name="media\_type" id="media\_type" value="link" /> |
| [5438](#L5438) | <div class="stuffbox" id="image\_info" style="width: 100%;"> |
| [5439](#L5439) | <h3> |
| [5440](#L5440) | <label for="link\_name"><?php echo \_\_('Image Information','wp-responsive-photo-gallery');?></label> |
| [5441](#L5441) | </h3> |
| [5442](#L5442) | <div class="inside" id="fileuploaddiv"> |
| [5443](#L5443) | <?php if ($image\_name != "") { ?> |
| [5444](#L5444) | <div> |
| [5445](#L5445) | <b><?php echo \_\_('Current Image','wp-responsive-photo-gallery');?>: </b> |
| [5446](#L5446) | <br/> |
| [5447](#L5447) | <img id="img\_disp\_link" name="img\_disp\_link" |
| [5448](#L5448) | src="<?php echo $baseurl . $image\_name; ?>" /> |
| [5449](#L5449) | </div> |
| [5450](#L5450) | <?php }else{ ?> |
| [5451](#L5451) | <img |
| [5452](#L5452) | src="<?php echo plugins\_url('/images/no-image-selected.png', \_\_FILE\_\_); ?>" |
| [5453](#L5453) | id="img\_disp\_link" name="img\_disp\_link" /> |
| [5454](#L5454) |  |
| [5455](#L5455) | <?php } ?> |
| [5456](#L5456) | <img |
| [5457](#L5457) | src="<?php echo plugins\_url('/images/ajax-loader.gif', \_\_FILE\_\_); ?>" |
| [5458](#L5458) | style="display: none" id="loading\_img" name="loading\_img" /> |
| [5459](#L5459) | <div style="clear: both"></div> |
| [5460](#L5460) | <div></div> |
| [5461](#L5461) | <div class="uploader"> |
| [5462](#L5462) |  |
| [5463](#L5463) | <div style="clear: both; margin-top: 15px;"></div> |
| [5464](#L5464) | <a href="javascript:;" class="niks\_media" id="myMediaUploader\_link"><b><?php echo \_\_('Click Here to upload Image','wp-responsive-photo-gallery');?></b></a> |
| [5465](#L5465) | <br /> <br /> |
| [5466](#L5466) | <div> |
| [5467](#L5467) | <input id="HdnMediaSelection\_link" name="HdnMediaSelection\_link" type="hidden" value="<?php echo $HdnMediaSelection;?>" /> |
| [5468](#L5468) | </div> |
| [5469](#L5469) | <div style="clear: both"></div> |
| [5470](#L5470) | <div></div> |
| [5471](#L5471) | <div style="clear: both"></div> |
| [5472](#L5472) |  |
| [5473](#L5473) | <br /> |
| [5474](#L5474) | </div> |
| [5475](#L5475) | </div> |
| [5476](#L5476) |  |
| [5477](#L5477) | <script> |
| [5478](#L5478) | //uploading files variable |
| [5479](#L5479) | var custom\_file\_frame; |
| [5480](#L5480) | jQuery("#myMediaUploader\_link").click(function(event) { |
| [5481](#L5481) | event.preventDefault(); |
| [5482](#L5482) | //If the frame already exists, reopen it |
| [5483](#L5483) | if (typeof (custom\_file\_frame) !== "undefined") { |
| [5484](#L5484) | custom\_file\_frame.close(); |
| [5485](#L5485) | } |
| [5486](#L5486) |  |
| [5487](#L5487) | //Create WP media frame. |
| [5488](#L5488) | custom\_file\_frame = wp.media.frames.customHeader = wp.media({ |
| [5489](#L5489) | //Title of media manager frame |
| [5490](#L5490) | title: "WP Media Uploader", |
| [5491](#L5491) | library: { |
| [5492](#L5492) | type: 'image' |
| [5493](#L5493) | }, |
| [5494](#L5494) | button: { |
| [5495](#L5495) | //Button text |
| [5496](#L5496) | text: "Set Image" |
| [5497](#L5497) | }, |
| [5498](#L5498) | //Do not allow multiple files, if you want multiple, set true |
| [5499](#L5499) | multiple: false |
| [5500](#L5500) | }); |
| [5501](#L5501) | //callback for selected image |
| [5502](#L5502) | custom\_file\_frame.on('select', function() { |
| [5503](#L5503) |  |
| [5504](#L5504) | var attachment = custom\_file\_frame.state().get('selection').first().toJSON(); |
| [5505](#L5505) | var validExtensions = new Array(); |
| [5506](#L5506) | validExtensions[0] = 'jpg'; |
| [5507](#L5507) | validExtensions[1] = 'jpeg'; |
| [5508](#L5508) | validExtensions[2] = 'png'; |
| [5509](#L5509) | validExtensions[3] = 'gif'; |
| [5510](#L5510) |  |
| [5511](#L5511) | var inarr = parseInt(jQuery.inArray(attachment.subtype, validExtensions)); |
| [5512](#L5512) | if (inarr > 0 && attachment.type.toLowerCase() == 'image'){ |
| [5513](#L5513) |  |
| [5514](#L5514) | var titleTouse = ""; |
| [5515](#L5515) | var imageDescriptionTouse = ""; |
| [5516](#L5516) | if (jQuery.trim(attachment.title) != ''){ |
| [5517](#L5517) |  |
| [5518](#L5518) | titleTouse = jQuery.trim(attachment.title); |
| [5519](#L5519) | } |
| [5520](#L5520) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5521](#L5521) |  |
| [5522](#L5522) | titleTouse = jQuery.trim(attachment.caption); |
| [5523](#L5523) | } |
| [5524](#L5524) |  |
| [5525](#L5525) | if (jQuery.trim(attachment.description) != ''){ |
| [5526](#L5526) |  |
| [5527](#L5527) | imageDescriptionTouse = jQuery.trim(attachment.description); |
| [5528](#L5528) | } |
| [5529](#L5529) | else if (jQuery.trim(attachment.caption) != ''){ |
| [5530](#L5530) |  |
| [5531](#L5531) | imageDescriptionTouse = jQuery.trim(attachment.caption); |
| [5532](#L5532) | } |
| [5533](#L5533) |  |
| [5534](#L5534) | jQuery("#addlink\_ #title").val(titleTouse); |
| [5535](#L5535) |  |
| [5536](#L5536) | if (attachment.id != ''){ |
| [5537](#L5537) |  |
| [5538](#L5538) | jQuery("#HdnMediaSelection\_link").val(attachment.url); |
| [5539](#L5539) | jQuery("#img\_disp\_link").attr('src', attachment.url); |
| [5540](#L5540) |  |
| [5541](#L5541) | } |
| [5542](#L5542) |  |
| [5543](#L5543) | } |
| [5544](#L5544) | else{ |
| [5545](#L5545) |  |
| [5546](#L5546) | alert("<?php echo \_\_('Invalid image selection.','wp-responsive-photo-gallery');?>"); |
| [5547](#L5547) | } |
| [5548](#L5548) | //do something with attachment variable, for example attachment.filename |
| [5549](#L5549) | //Object: |
| [5550](#L5550) | //attachment.alt - image alt |
| [5551](#L5551) | //attachment.author - author id |
| [5552](#L5552) | //attachment.caption |
| [5553](#L5553) | //attachment.dateFormatted - date of image uploaded |
| [5554](#L5554) | //attachment.description |
| [5555](#L5555) | //attachment.editLink - edit link of media |
| [5556](#L5556) | //attachment.filename |
| [5557](#L5557) | //attachment.height |
| [5558](#L5558) | //attachment.icon - don't know WTF?)) |
| [5559](#L5559) | //attachment.id - id of attachment |
| [5560](#L5560) | //attachment.link - public link of attachment, for example ""http://site.com/?attachment\_id=115"" |
| [5561](#L5561) | //attachment.menuOrder |
| [5562](#L5562) | //attachment.mime - mime type, for example image/jpeg" |
| [5563](#L5563) | //attachment.name - name of attachment file, for example "my-image" |
| [5564](#L5564) | //attachment.status - usual is "inherit" |
| [5565](#L5565) | //attachment.subtype - "jpeg" if is "jpg" |
| [5566](#L5566) | //attachment.title |
| [5567](#L5567) | //attachment.type - "image" |
| [5568](#L5568) | //attachment.uploadedTo |
| [5569](#L5569) | //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg" |
| [5570](#L5570) | //attachment.width |
| [5571](#L5571) | }); |
| [5572](#L5572) | //Open modal |
| [5573](#L5573) | custom\_file\_frame.open(); |
| [5574](#L5574) | }); |
| [5575](#L5575) |  |
| [5576](#L5576) | </script> |
| [5577](#L5577) | </div> |
| [5578](#L5578) |  |
| [5579](#L5579) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5580](#L5580) | <h3> |
| [5581](#L5581) | <label for="link\_name"><?php echo \_\_('Link Title','wp-responsive-photo-gallery');?> (<span style="font-size: 11px; font-weight: normal"><?php echo \_\_('Used into Caption','wp-responsive-photo-gallery');?></span>) |
| [5582](#L5582) | </label> |
| [5583](#L5583) | </h3> |
| [5584](#L5584) | <div class="inside"> |
| [5585](#L5585) | <div> |
| [5586](#L5586) | <input type="text" id="title" tabindex="1" size="30" name="title" value="<?php echo $videotitle; ?>"> |
| [5587](#L5587) | </div> |
| [5588](#L5588) | <div style="clear: both"></div> |
| [5589](#L5589) | <div></div> |
| [5590](#L5590) | <div style="clear: both"></div> |
| [5591](#L5591) | </div> |
| [5592](#L5592) | </div> |
| [5593](#L5593) | <div class="stuffbox" id="namediv" style="width: 100%"> |
| [5594](#L5594) | <h3> |
| [5595](#L5595) | <label for="link\_name"><?php echo \_\_('Link Url','wp-responsive-photo-gallery');?> (<span |
| [5596](#L5596) | style="font-size: 11px; font-weight: normal"><?php echo \_\_('click on image will redirect to this url.','wp-responsive-photo-gallery');?></span>) |
| [5597](#L5597) | </label> |
| [5598](#L5598) | </h3> |
| [5599](#L5599) | <div class="inside"> |
| [5600](#L5600) | <div> |
| [5601](#L5601) | <input type="text" id="murl" |
| [5602](#L5602) | tabindex="1" size="30" name="murl" |
| [5603](#L5603) | value="<?php echo $murl; ?>"> |
| [5604](#L5604) | </div> |
| [5605](#L5605) | <div style="clear: both"></div> |
| [5606](#L5606) | <div></div> |
| [5607](#L5607) | <div style="clear: both"></div> |
| [5608](#L5608) |  |
| [5609](#L5609) | </div> |
| [5610](#L5610) | </div> |
| [5611](#L5611) |  |
| [5612](#L5612) | <?php if (isset($\_GET['id']) and (int) $\_GET['id'] > 0) { ?> |
| [5613](#L5613) | <input type="hidden" name="linkid" id="linkid" value="<?php echo (int) $\_GET['id']; ?>"> |
| [5614](#L5614) | <?php |
| [5615](#L5615) | } |
| [5616](#L5616) | ?> |
| [5617](#L5617) |  |
| [5618](#L5618) | <?php wp\_nonce\_field('action\_image\_add\_edit', 'add\_edit\_image\_nonce'); ?> |
| [5619](#L5619) | <input type="submit" |
| [5620](#L5620) | onclick="" name="btnsave" id="btnsave" value="<?php echo \_\_('Save Changes','wp-responsive-photo-gallery');?>" |
| [5621](#L5621) | class="button-primary">&nbsp;&nbsp;<input type="button" |
| [5622](#L5622) | name="cancle" id="cancle" value="<?php echo \_\_('Cancel','wp-responsive-photo-gallery');?>" |
| [5623](#L5623) | class="button-primary" |
| [5624](#L5624) | onclick="location.href = 'admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'"> |
| [5625](#L5625) |  |
| [5626](#L5626) | </form> |
| [5627](#L5627) | <script type="text/javascript"> |
| [5628](#L5628) |  |
| [5629](#L5629) |  |
| [5630](#L5630) | jQuery(document).ready(function() { |
| [5631](#L5631) |  |
| [5632](#L5632) | jQuery.validator.setDefaults({ |
| [5633](#L5633) | ignore: [], |
| [5634](#L5634) | // any other default options and/or rules |
| [5635](#L5635) | }); |
| [5636](#L5636) |  |
| [5637](#L5637) | jQuery("#addvideo").validate({ |
| [5638](#L5638) | rules: { |
| [5639](#L5639) | videotitle: { |
| [5640](#L5640) | required:true, |
| [5641](#L5641) | maxlength: 200 |
| [5642](#L5642) | }, |
| [5643](#L5643) | vtype: { |
| [5644](#L5644) | required:true |
| [5645](#L5645) |  |
| [5646](#L5646) | }, |
| [5647](#L5647) | videourl: { |
| [5648](#L5648) | required: function(element) { |
| [5649](#L5649) | return jQuery("#type\_html5").is(':checked')==0; |
| [5650](#L5650) | }, |
| [5651](#L5651) | maxlength: 500 |
| [5652](#L5652) | }, |
| [5653](#L5653) | HdnMediaSelection:{ |
| [5654](#L5654) | required:true |
| [5655](#L5655) | } |
| [5656](#L5656) |  |
| [5657](#L5657) |  |
| [5658](#L5658) | }, |
| [5659](#L5659) | errorClass: "image\_error", |
| [5660](#L5660) | errorPlacement: function(error, element) { |
| [5661](#L5661) | error.appendTo(element.parent().next().next()); |
| [5662](#L5662) | }, messages: { |
| [5663](#L5663) | HdnMediaSelection: "Please select video thumbnail.", |
| [5664](#L5664) |  |
| [5665](#L5665) | } |
| [5666](#L5666) |  |
| [5667](#L5667) | }) |
| [5668](#L5668) |  |
| [5669](#L5669) |  |
| [5670](#L5670) | jQuery("#addimage\_").validate({ |
| [5671](#L5671) | rules: { |
| [5672](#L5672) | HdnMediaSelection\_image:{ |
| [5673](#L5673) | required:true |
| [5674](#L5674) | }, |
| [5675](#L5675) | murl: { |
| [5676](#L5676) |  |
| [5677](#L5677) | /\* url:true,\*/ |
| [5678](#L5678) | maxlength: 500 |
| [5679](#L5679) | } |
| [5680](#L5680) |  |
| [5681](#L5681) |  |
| [5682](#L5682) | }, |
| [5683](#L5683) | errorClass: "image\_error", |
| [5684](#L5684) | errorPlacement: function(error, element) { |
| [5685](#L5685) | error.appendTo(element.parent().next().next()); |
| [5686](#L5686) | }, messages: { |
| [5687](#L5687) | HdnMediaSelection: "Please select image thumbnail or Upload by wordpress media uploader.", |
| [5688](#L5688) |  |
| [5689](#L5689) | } |
| [5690](#L5690) |  |
| [5691](#L5691) | }) |
| [5692](#L5692) | jQuery("#addlink\_").validate({ |
| [5693](#L5693) | rules: { |
| [5694](#L5694) | HdnMediaSelection\_link:{ |
| [5695](#L5695) | required:true |
| [5696](#L5696) | }, |
| [5697](#L5697) | murl: { |
| [5698](#L5698) | required:true, |
| [5699](#L5699) | /\* url:true,\*/ |
| [5700](#L5700) | maxlength: 500 |
| [5701](#L5701) | } |
| [5702](#L5702) |  |
| [5703](#L5703) | }, |
| [5704](#L5704) | errorClass: "image\_error", |
| [5705](#L5705) | errorPlacement: function(error, element) { |
| [5706](#L5706) | error.appendTo(element.parent().next().next()); |
| [5707](#L5707) | }, messages: { |
| [5708](#L5708) | HdnMediaSelection: "Please select link thumbnail or Upload by wordpress media uploader.", |
| [5709](#L5709) |  |
| [5710](#L5710) | } |
| [5711](#L5711) |  |
| [5712](#L5712) |  |
| [5713](#L5713) |  |
| [5714](#L5714) | }) |
| [5715](#L5715) |  |
| [5716](#L5716) |  |
| [5717](#L5717) | }); |
| [5718](#L5718) |  |
| [5719](#L5719) |  |
| [5720](#L5720) | </script> |
| [5721](#L5721) |  |
| [5722](#L5722) | </div> |
| [5723](#L5723) | <div id="postbox-container-1" class="postbox-container"  > |
| [5724](#L5724) |  |
| [5725](#L5725) | <div class="postbox"> |
| [5726](#L5726) | <h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','wp-responsive-photo-gallery');?></h3> |
| [5727](#L5727) | <div class="inside"> |
| [5728](#L5728) | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"></a></center> |
| [5729](#L5729) |  |
| [5730](#L5730) | <div style="margin:10px 5px"> |
| [5731](#L5731) |  |
| [5732](#L5732) | </div> |
| [5733](#L5733) | </div></div> |
| [5734](#L5734) | <div class="postbox"> |
| [5735](#L5735) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','wp-responsive-photo-gallery');?></h3> </center> |
| [5736](#L5736) | <div class="inside"> |
| [5737](#L5737) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="width:100%" src="<?php echo plugins\_url( 'images/gsuite\_promo.png', \_\_FILE\_\_ ) ;?>" border="0"></a></center> |
| [5738](#L5738) | <div style="margin:10px 5px"> |
| [5739](#L5739) | </div> |
| [5740](#L5740) | </div></div> |
| [5741](#L5741) |  |
| [5742](#L5742) |  |
| [5743](#L5743) | </div> |
| [5744](#L5744) | </div> |
| [5745](#L5745) | </div> |
| [5746](#L5746) | </div> |
| [5747](#L5747) | </div> |
| [5748](#L5748) | <?php |
| [5749](#L5749) | } |
| [5750](#L5750) | } else if (strtolower ( $action ) == strtolower ( 'delete' )) { |
| [5751](#L5751) |  |
| [5752](#L5752) | $retrieved\_nonce = ''; |
| [5753](#L5753) |  |
| [5754](#L5754) | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
| [5755](#L5755) |  |
| [5756](#L5756) | $retrieved\_nonce=sanitize\_text\_field($\_GET['nonce']); |
| [5757](#L5757) |  |
| [5758](#L5758) | } |
| [5759](#L5759) | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
| [5760](#L5760) |  |
| [5761](#L5761) |  |
| [5762](#L5762) | wp\_die('Security check fail'); |
| [5763](#L5763) | } |
| [5764](#L5764) |  |
| [5765](#L5765) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_delete\_media' ) ) { |
| [5766](#L5766) |  |
| [5767](#L5767) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [5768](#L5768) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [5769](#L5769) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [5770](#L5770) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [5771](#L5771) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [5772](#L5772) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5773](#L5773) | exit; |
| [5774](#L5774) |  |
| [5775](#L5775) | } |
| [5776](#L5776) |  |
| [5777](#L5777) | $uploads = wp\_upload\_dir (); |
| [5778](#L5778) | $baseDir = $uploads ['basedir']; |
| [5779](#L5779) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [5780](#L5780) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [5781](#L5781) |  |
| [5782](#L5782) |  |
| [5783](#L5783) |  |
| [5784](#L5784) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [5785](#L5785) | $deleteId = (int) htmlentities(intval($\_GET ['id']),ENT\_QUOTES); |
| [5786](#L5786) |  |
| [5787](#L5787) | try { |
| [5788](#L5788) |  |
| [5789](#L5789) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$deleteId"; |
| [5790](#L5790) | $myrow = $wpdb->get\_row ( $query ); |
| [5791](#L5791) |  |
| [5792](#L5792) | if (is\_object ( $myrow )) { |
| [5793](#L5793) |  |
| [5794](#L5794) |  |
| [5795](#L5795) | $image\_name = $myrow->image\_name; |
| [5796](#L5796) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [5797](#L5797) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [5798](#L5798) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [5799](#L5799) | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
| [5800](#L5800) | $pInfo2 = pathinfo ( $imagetoDel ); |
| [5801](#L5801) | $ext = $pInfo2 ['extension']; |
| [5802](#L5802) |  |
| [5803](#L5803) | @unlink ( $imagetoDel ); |
| [5804](#L5804) |  |
| [5805](#L5805) | $query = "delete from  " . $wpdb->prefix . "rjg\_gallery where id=$deleteId"; |
| [5806](#L5806) | $wpdb->query ( $query ); |
| [5807](#L5807) |  |
| [5808](#L5808) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5809](#L5809) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [5810](#L5810) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] =  \_\_('Video deleted successfully.','wp-responsive-photo-gallery'); |
| [5811](#L5811) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5812](#L5812) | } |
| [5813](#L5813) | } catch ( Exception $e ) { |
| [5814](#L5814) |  |
| [5815](#L5815) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5816](#L5816) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [5817](#L5817) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] =  \_\_('Error while deleting video.','wp-responsive-photo-gallery'); |
| [5818](#L5818) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5819](#L5819) | } |
| [5820](#L5820) |  |
| [5821](#L5821) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5822](#L5822) | exit (); |
| [5823](#L5823) | } else if (strtolower ( $action ) == strtolower ( 'deleteselected' )) { |
| [5824](#L5824) |  |
| [5825](#L5825) | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
| [5826](#L5826) |  |
| [5827](#L5827) | wp\_die('Security check fail'); |
| [5828](#L5828) | } |
| [5829](#L5829) |  |
| [5830](#L5830) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_delete\_media' ) ) { |
| [5831](#L5831) |  |
| [5832](#L5832) | $location='admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management'; |
| [5833](#L5833) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages=array(); |
| [5834](#L5834) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['type']='err'; |
| [5835](#L5835) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages['message']=\_\_('Access Denied. Please contact your administrator.','wp-responsive-photo-gallery'); |
| [5836](#L5836) | update\_option('my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages); |
| [5837](#L5837) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5838](#L5838) | exit; |
| [5839](#L5839) |  |
| [5840](#L5840) | } |
| [5841](#L5841) |  |
| [5842](#L5842) | $location = "admin.php?page=responsive\_justified\_gallery\_with\_lightbox\_media\_management"; |
| [5843](#L5843) |  |
| [5844](#L5844) | if (isset ( $\_POST ) and isset ( $\_POST ['deleteselected'] ) and ($\_POST ['action'] == 'delete' or $\_POST ['action\_upper'] == 'delete')) { |
| [5845](#L5845) |  |
| [5846](#L5846) | $uploads = wp\_upload\_dir (); |
| [5847](#L5847) | $baseDir = $uploads ['basedir']; |
| [5848](#L5848) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [5849](#L5849) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [5850](#L5850) |  |
| [5851](#L5851) | if (sizeof ( $\_POST ['thumbnails'] ) > 0) { |
| [5852](#L5852) |  |
| [5853](#L5853) | $deleteto = $\_POST ['thumbnails']; |
| [5854](#L5854) | $implode = implode ( ',', $deleteto ); |
| [5855](#L5855) |  |
| [5856](#L5856) | try { |
| [5857](#L5857) |  |
| [5858](#L5858) | foreach ( $deleteto as $img ) { |
| [5859](#L5859) |  |
| [5860](#L5860) | $img=intval($img); |
| [5861](#L5861) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery WHERE id=$img"; |
| [5862](#L5862) | $myrow = $wpdb->get\_row ( $query ); |
| [5863](#L5863) |  |
| [5864](#L5864) |  |
| [5865](#L5865) |  |
| [5866](#L5866) | if (is\_object ( $myrow )) { |
| [5867](#L5867) |  |
| [5868](#L5868) | $image\_name = $myrow->image\_name ; |
| [5869](#L5869) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [5870](#L5870) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [5871](#L5871) | $imagetoDel = $pathToImagesFolder . '/' . $image\_name; |
| [5872](#L5872) |  |
| [5873](#L5873) | $pInfo = pathinfo ( $myrow->HdnMediaSelection ); |
| [5874](#L5874) | $pInfo2 = pathinfo ( $imagetoDel ); |
| [5875](#L5875) | $ext = $pInfo2 ['extension']; |
| [5876](#L5876) |  |
| [5877](#L5877) | @unlink ( $imagetoDel ); |
| [5878](#L5878) |  |
| [5879](#L5879) |  |
| [5880](#L5880) | $query = "delete from  " . $wpdb->prefix . "rjg\_gallery where id=$img"; |
| [5881](#L5881) | $wpdb->query ( $query ); |
| [5882](#L5882) |  |
| [5883](#L5883) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5884](#L5884) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'succ'; |
| [5885](#L5885) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('selected media deleted successfully.','wp-responsive-photo-gallery'); |
| [5886](#L5886) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5887](#L5887) | } |
| [5888](#L5888) | } |
| [5889](#L5889) | } catch ( Exception $e ) { |
| [5890](#L5890) |  |
| [5891](#L5891) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages = array (); |
| [5892](#L5892) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['type'] = 'err'; |
| [5893](#L5893) | $my\_responsive\_photo\_gallery\_slider\_settings\_messages ['message'] = \_\_('Error while deleting videos.','wp-responsive-photo-gallery'); |
| [5894](#L5894) | update\_option ( 'my\_responsive\_photo\_gallery\_slider\_settings\_messages', $my\_responsive\_photo\_gallery\_slider\_settings\_messages ); |
| [5895](#L5895) | } |
| [5896](#L5896) |  |
| [5897](#L5897) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5898](#L5898) | exit (); |
| [5899](#L5899) | } else { |
| [5900](#L5900) |  |
| [5901](#L5901) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5902](#L5902) | exit (); |
| [5903](#L5903) | } |
| [5904](#L5904) | } else { |
| [5905](#L5905) |  |
| [5906](#L5906) | echo "<script type='text/javascript'> location.href='$location';</script>"; |
| [5907](#L5907) | exit (); |
| [5908](#L5908) | } |
| [5909](#L5909) | } |
| [5910](#L5910) | } |
| [5911](#L5911) |  |
| [5912](#L5912) | function rjg\_justified\_gallery\_get\_wp\_version() { |
| [5913](#L5913) | global $wp\_version; |
| [5914](#L5914) | return $wp\_version; |
| [5915](#L5915) | } |
| [5916](#L5916) |  |
| [5917](#L5917) | // also we will add an option function that will check for plugin admin page or not |
| [5918](#L5918) | function rjg\_responsive\_justified\_gallery\_plus\_lightbox\_is\_plugin\_page() { |
| [5919](#L5919) |  |
| [5920](#L5920) | $server\_uri = "http://{$\_SERVER['HTTP\_HOST']}{$\_SERVER['REQUEST\_URI']}"; |
| [5921](#L5921) |  |
| [5922](#L5922) | foreach ( array ('responsive\_photo\_gallery\_image\_management', 'responsive\_justified\_gallery\_with\_lightbox\_media\_management','responsive\_justified\_gallery\_with\_lightbox' |
| [5923](#L5923) | ) as $allowURI ) { |
| [5924](#L5924) | if (stristr ( $server\_uri, $allowURI )) |
| [5925](#L5925) | return true; |
| [5926](#L5926) | } |
| [5927](#L5927) | return false; |
| [5928](#L5928) | } |
| [5929](#L5929) | function my\_responsive\_photo\_gallery\_admin\_scripts\_init() { |
| [5930](#L5930) | if(my\_responsive\_photo\_gallery\_is\_plugin\_page()) { |
| [5931](#L5931) | //double check for WordPress version and function exists |
| [5932](#L5932) | if(function\_exists('wp\_enqueue\_media') && version\_compare(my\_responsive\_photo\_gallery\_get\_wp\_version(), '3.5', '>=')) { |
| [5933](#L5933) | //call for new media manager |
| [5934](#L5934) | wp\_enqueue\_media(); |
| [5935](#L5935) | } |
| [5936](#L5936) | wp\_enqueue\_style('media'); |
| [5937](#L5937) | } |
| [5938](#L5938) | } |
| [5939](#L5939) |  |
| [5940](#L5940) | // add media WP scripts |
| [5941](#L5941) | function rjg\_responsive\_justified\_gallery\_plus\_lightbox\_admin\_scripts\_init() { |
| [5942](#L5942) |  |
| [5943](#L5943) | if (rjg\_responsive\_justified\_gallery\_plus\_lightbox\_is\_plugin\_page()) { |
| [5944](#L5944) | // double check for WordPress version and function exists |
| [5945](#L5945) | if (function\_exists ( 'wp\_enqueue\_media' ) && version\_compare ( rjg\_justified\_gallery\_get\_wp\_version (), '3.5', '>=' )) { |
| [5946](#L5946) | // call for new media manager |
| [5947](#L5947) | wp\_enqueue\_media (); |
| [5948](#L5948) | } |
| [5949](#L5949) | wp\_enqueue\_style ( 'media' ); |
| [5950](#L5950) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [5951](#L5951) | wp\_enqueue\_script( 'wp-color-picker' ); |
| [5952](#L5952) |  |
| [5953](#L5953) | } |
| [5954](#L5954) | } |
| [5955](#L5955) | function wrpg\_remove\_extra\_p\_tags($content){ |
| [5956](#L5956) |  |
| [5957](#L5957) | if(strpos($content, 'print\_my\_responsive\_photo\_gallery\_func')!==false){ |
| [5958](#L5958) |  |
| [5959](#L5959) |  |
| [5960](#L5960) | $pattern = "/<!-- print\_my\_responsive\_photo\_gallery\_func -->(.\*)<!-- end print\_my\_responsive\_photo\_gallery\_func -->/Uis"; |
| [5961](#L5961) | $content = preg\_replace\_callback($pattern, function($matches) { |
| [5962](#L5962) |  |
| [5963](#L5963) |  |
| [5964](#L5964) | $altered = str\_replace("<p>","",$matches[1]); |
| [5965](#L5965) | $altered = str\_replace("</p>","",$altered); |
| [5966](#L5966) |  |
| [5967](#L5967) | $altered=str\_replace("&#038;","&",$altered); |
| [5968](#L5968) | $altered=str\_replace("&#8221;",'"',$altered); |
| [5969](#L5969) |  |
| [5970](#L5970) |  |
| [5971](#L5971) | return @str\_replace($matches[1], $altered, $matches[0]); |
| [5972](#L5972) | }, $content); |
| [5973](#L5973) |  |
| [5974](#L5974) |  |
| [5975](#L5975) |  |
| [5976](#L5976) | } |
| [5977](#L5977) |  |
| [5978](#L5978) | $content = str\_replace("<p><!-- print\_my\_responsive\_photo\_gallery\_func -->","<!-- print\_my\_responsive\_photo\_gallery\_func -->",$content); |
| [5979](#L5979) | $content = str\_replace("<!-- end print\_my\_responsive\_photo\_gallery\_func --></p>","<!-- end print\_my\_responsive\_photo\_gallery\_func -->",$content); |
| [5980](#L5980) |  |
| [5981](#L5981) |  |
| [5982](#L5982) | return $content; |
| [5983](#L5983) | } |
| [5984](#L5984) |  |
| [5985](#L5985) | add\_filter('widget\_text\_content', 'wrpg\_remove\_extra\_p\_tags', 999); |
| [5986](#L5986) | add\_filter('the\_content', 'wrpg\_remove\_extra\_p\_tags', 999); |
| [5987](#L5987) |  |
| [5988](#L5988) |  |
| [5989](#L5989) | function rjg\_print\_masonry\_gallery\_plus\_lightbox\_func($atts) { |
| [5990](#L5990) |  |
| [5991](#L5991) |  |
| [5992](#L5992) | global $wpdb; |
| [5993](#L5993) | $settings=get\_option('rjg\_settings'); |
| [5994](#L5994) | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
| [5995](#L5995) | $limit = $settings['page\_size']; |
| [5996](#L5996) | $offset = ( $pagenum - 1 ) \* $limit; |
| [5997](#L5997) |  |
| [5998](#L5998) | $rand\_Numb = uniqid ( 'thumnail\_slider' ); |
| [5999](#L5999) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [6000](#L6000) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [6001](#L6001) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [6002](#L6002) |  |
| [6003](#L6003) |  |
| [6004](#L6004) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6005](#L6005) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6006](#L6006) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [6007](#L6007) |  |
| [6008](#L6008) | $uploads = wp\_upload\_dir (); |
| [6009](#L6009) | $baseDir = $uploads ['basedir']; |
| [6010](#L6010) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6011](#L6011) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [6012](#L6012) | $baseurl = $uploads ['baseurl']; |
| [6013](#L6013) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [6014](#L6014) |  |
| [6015](#L6015) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6016](#L6016) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6017](#L6017) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [6018](#L6018) | $randOmeRel = uniqid ( 'rel\_' ); |
| [6019](#L6019) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [6020](#L6020) | $vNonce = wp\_create\_nonce('vNonce'); |
| [6021](#L6021) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [6022](#L6022) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [6023](#L6023) |  |
| [6024](#L6024) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [6025](#L6025) | if(strtolower($LoadingBackColor)=='none'){ |
| [6026](#L6026) | $LoadingBackColor='#ffffff'; |
| [6027](#L6027) | } |
| [6028](#L6028) | $imageMargin=$settings['imageMargin']; |
| [6029](#L6029) |  |
| [6030](#L6030) | wp\_enqueue\_style('rjg-lbox'); |
| [6031](#L6031) | wp\_enqueue\_style('rjg-justified-gallery'); |
| [6032](#L6032) | wp\_enqueue\_script('jquery'); |
| [6033](#L6033) | wp\_enqueue\_script('rjg-justified-gallery'); |
| [6034](#L6034) | wp\_enqueue\_script('rjg-lbox-js'); |
| [6035](#L6035) |  |
| [6036](#L6036) | ob\_start(); |
| [6037](#L6037) | ?> |
| [6038](#L6038) | <!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --><?php if (is\_array($settings)) { ?> |
| [6039](#L6039) |  |
| [6040](#L6040) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [6041](#L6041) | <div style="clear: both;"></div> |
| [6042](#L6042) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6043](#L6043) | <div style="clear: both;"></div> |
| [6044](#L6044) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6045](#L6045) |  |
| [6046](#L6046) |  |
| [6047](#L6047) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" style="visibility: hidden" > |
| [6048](#L6048) |  |
| [6049](#L6049) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [6050](#L6050) |  |
| [6051](#L6051) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [6052](#L6052) |  |
| [6053](#L6053) | <?php |
| [6054](#L6054) |  |
| [6055](#L6055) | $imageheight = $settings ['imageheight']; |
| [6056](#L6056) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [6057](#L6057) | $firstChild='firstimg'; |
| [6058](#L6058) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [6059](#L6059) |  |
| [6060](#L6060) |  |
| [6061](#L6061) | if (count ( $rows ) > 0) { |
| [6062](#L6062) |  |
| [6063](#L6063) | foreach ( $rows as $row ) { |
| [6064](#L6064) |  |
| [6065](#L6065) | $imagename = $row ['image\_name']; |
| [6066](#L6066) | $video\_url = $row ['videourl']; |
| [6067](#L6067) | $video\_url\_org = $row ['murl']; |
| [6068](#L6068) | $Url\_vid = @parse\_url($video\_url\_org); |
| [6069](#L6069) |  |
| [6070](#L6070) |  |
| [6071](#L6071) |  |
| [6072](#L6072) | $relend = ''; |
| [6073](#L6073) | $flag=false; |
| [6074](#L6074) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [6075](#L6075) |  |
| [6076](#L6076) |  |
| [6077](#L6077) | parse\_str($Url\_vid['query'], $get\_array); |
| [6078](#L6078) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [6079](#L6079) |  |
| [6080](#L6080) | foreach($get\_array as $k=>$v){ |
| [6081](#L6081) |  |
| [6082](#L6082) | if($flag==false){ |
| [6083](#L6083) |  |
| [6084](#L6084) | $flag=true; |
| [6085](#L6085) | $relend.="?$k=$v"; |
| [6086](#L6086) | } |
| [6087](#L6087) | else{ |
| [6088](#L6088) |  |
| [6089](#L6089) | $relend.="&$k=$v"; |
| [6090](#L6090) |  |
| [6091](#L6091) | } |
| [6092](#L6092) |  |
| [6093](#L6093) |  |
| [6094](#L6094) | } |
| [6095](#L6095) |  |
| [6096](#L6096) |  |
| [6097](#L6097) | } |
| [6098](#L6098) |  |
| [6099](#L6099) |  |
| [6100](#L6100) |  |
| [6101](#L6101) | } |
| [6102](#L6102) |  |
| [6103](#L6103) | $vtype= $row ['vtype']; |
| [6104](#L6104) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [6105](#L6105) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [6106](#L6106) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [6107](#L6107) | $filenamewithoutextension = $pathinfo ['filename']; |
| [6108](#L6108) |  |
| [6109](#L6109) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [6110](#L6110) | $outputimg=$outputimgmain; |
| [6111](#L6111) | $media\_type=$row['media\_type']; |
| [6112](#L6112) | $hoverClass=''; |
| [6113](#L6113) | if($media\_type=="link") |
| [6114](#L6114) | $hoverClass="playbtnCss\_link"; |
| [6115](#L6115) | else if($media\_type=="video") |
| [6116](#L6116) | $hoverClass="playbtnCss\_video"; |
| [6117](#L6117) | else if($media\_type=="image") |
| [6118](#L6118) | $hoverClass="playbtnCss\_zoom"; |
| [6119](#L6119) |  |
| [6120](#L6120) | $title = ""; |
| [6121](#L6121) | $rowTitle = $row['title']; |
| [6122](#L6122) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [6123](#L6123) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [6124](#L6124) |  |
| [6125](#L6125) |  |
| [6126](#L6126) |  |
| [6127](#L6127) | $open\_link\_in = $row['open\_link\_in']; |
| [6128](#L6128) | $open\_title\_link\_in = 1; |
| [6129](#L6129) |  |
| [6130](#L6130) | if(!$open\_title\_link\_in) |
| [6131](#L6131) | $openImageInNewTab = '\_self'; |
| [6132](#L6132) | else |
| [6133](#L6133) | $openImageInNewTab = '\_blank'; |
| [6134](#L6134) |  |
| [6135](#L6135) | $embed\_url=$row['embed\_url'].$relend; |
| [6136](#L6136) | if($media\_type=="video"){ |
| [6137](#L6137) |  |
| [6138](#L6138) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [6139](#L6139) |  |
| [6140](#L6140) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [6141](#L6141) |  |
| [6142](#L6142) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [6143](#L6143) |  |
| [6144](#L6144) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6145](#L6145) |  |
| [6146](#L6146) | } else { |
| [6147](#L6147) |  |
| [6148](#L6148) | if ($row['mdescription'] != '') |
| [6149](#L6149) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6150](#L6150) |  |
| [6151](#L6151) | } |
| [6152](#L6152) | } |
| [6153](#L6153) | else if($media\_type=="image"){ |
| [6154](#L6154) |  |
| [6155](#L6155) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [6156](#L6156) |  |
| [6157](#L6157) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [6158](#L6158) |  |
| [6159](#L6159) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [6160](#L6160) |  |
| [6161](#L6161) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6162](#L6162) |  |
| [6163](#L6163) | } else { |
| [6164](#L6164) |  |
| [6165](#L6165) | if ($row['mdescription'] != '') |
| [6166](#L6166) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6167](#L6167) |  |
| [6168](#L6168) | } |
| [6169](#L6169) |  |
| [6170](#L6170) | } |
| [6171](#L6171) |  |
| [6172](#L6172) | $title= htmlentities($title); |
| [6173](#L6173) | ?> |
| [6174](#L6174) |  |
| [6175](#L6175) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [6176](#L6176) |  |
| [6177](#L6177) | <?php if ($open\_link\_in == 1): ?> |
| [6178](#L6178) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [6179](#L6179) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6180](#L6180) | </a> |
| [6181](#L6181) | <?php else: ?> |
| [6182](#L6182) |  |
| [6183](#L6183) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [6184](#L6184) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6185](#L6185) | </a> |
| [6186](#L6186) | <?php endif;?> |
| [6187](#L6187) |  |
| [6188](#L6188) | <?php else:?> |
| [6189](#L6189) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [6190](#L6190) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6191](#L6191) | </a> |
| [6192](#L6192) |  |
| [6193](#L6193) | <?php endif;?> |
| [6194](#L6194) |  |
| [6195](#L6195) |  |
| [6196](#L6196) |  |
| [6197](#L6197) | <?php } ?> |
| [6198](#L6198) |  |
| [6199](#L6199) | <?php } ?> |
| [6200](#L6200) | <br style="clear: both;"> |
| [6201](#L6201) | </div> |
| [6202](#L6202) | <?php |
| [6203](#L6203) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [6204](#L6204) | $num\_of\_pages = ceil($total / $limit); |
| [6205](#L6205) | $page\_links = paginate\_links(array( |
| [6206](#L6206) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [6207](#L6207) | 'format' => '', |
| [6208](#L6208) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [6209](#L6209) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [6210](#L6210) | 'total' => $num\_of\_pages, |
| [6211](#L6211) | 'current' => $pagenum, |
| [6212](#L6212) | 'prev\_next' => true, |
| [6213](#L6213) | 'type' => 'list', |
| [6214](#L6214) | )); |
| [6215](#L6215) |  |
| [6216](#L6216) | if ($page\_links) { |
| [6217](#L6217) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [6218](#L6218) |  |
| [6219](#L6219) | } |
| [6220](#L6220) | ?> |
| [6221](#L6221) |  |
| [6222](#L6222) | <div style="clear:both"></div> |
| [6223](#L6223) | </div> |
| [6224](#L6224) |  |
| [6225](#L6225) | <script> |
| [6226](#L6226) |  |
| [6227](#L6227) | <?php $intval= uniqid('interval\_');?> |
| [6228](#L6228) |  |
| [6229](#L6229) | var <?php echo $intval;?> = setInterval(function() { |
| [6230](#L6230) |  |
| [6231](#L6231) | if(document.readyState === 'complete') { |
| [6232](#L6232) |  |
| [6233](#L6233) | clearInterval(<?php echo $intval;?>); |
| [6234](#L6234) |  |
| [6235](#L6235) |  |
| [6236](#L6236) | jQuery(".gallery\_wrap0").css('visibility','visible'); |
| [6237](#L6237) |  |
| [6238](#L6238) | <?php $uniqId = uniqid(); ?> |
| [6239](#L6239) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [6240](#L6240) |  |
| [6241](#L6241) |  |
| [6242](#L6242) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [6243](#L6243) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [6244](#L6244) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [6245](#L6245) | margin:<?php echo $settings ['imageMargin'];?>, |
| [6246](#L6246) | target:'<?php echo $target;?>', |
| [6247](#L6247) | init : function() { }, |
| [6248](#L6248) | loadPicture : function(event, img) {  }, |
| [6249](#L6249) | resize : function(event, gallery) {  }, |
| [6250](#L6250) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [6251](#L6251) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [6252](#L6252) | }); |
| [6253](#L6253) |  |
| [6254](#L6254) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [6255](#L6255) |  |
| [6256](#L6256) | 'overlayColor':'#000000', |
| [6257](#L6257) | 'padding': 3, |
| [6258](#L6258) | 'margin': 20, |
| [6259](#L6259) | 'autoScale': true, |
| [6260](#L6260) | 'autoDimensions':true, |
| [6261](#L6261) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [6262](#L6262) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [6263](#L6263) | 'transitionIn':'fade', |
| [6264](#L6264) | 'transitionOut':'fade', |
| [6265](#L6265) | 'titlePosition': 'outside', |
| [6266](#L6266) | 'cyclic':true, |
| [6267](#L6267) | 'hideOnContentClick':false, |
| [6268](#L6268) | 'width' : 650, |
| [6269](#L6269) | 'height' : 400, |
| [6270](#L6270) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [6271](#L6271) |  |
| [6272](#L6272) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [6273](#L6273) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [6274](#L6274) |  |
| [6275](#L6275) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [6276](#L6276) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [6277](#L6277) | } |
| [6278](#L6278) | else{ |
| [6279](#L6279) | return ''; |
| [6280](#L6280) | } |
| [6281](#L6281) |  |
| [6282](#L6282) | } |
| [6283](#L6283) | }); |
| [6284](#L6284) |  |
| [6285](#L6285) | jQuery(".page-numbers").show(); |
| [6286](#L6286) |  |
| [6287](#L6287) |  |
| [6288](#L6288) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [6289](#L6289) |  |
| [6290](#L6290) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [6291](#L6291) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [6292](#L6292) |  |
| [6293](#L6293) | e.preventDefault(); |
| [6294](#L6294) | var data = { |
| [6295](#L6295) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [6296](#L6296) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [6297](#L6297) | 'grid\_id':0, |
| [6298](#L6298) | 'total\_rec':'<?php echo $total; ?>', |
| [6299](#L6299) | 'vNonce':'<?php echo $vNonce;?>' |
| [6300](#L6300) | }; |
| [6301](#L6301) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [6302](#L6302) |  |
| [6303](#L6303) |  |
| [6304](#L6304) | jQuery('html, body').animate({ |
| [6305](#L6305) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [6306](#L6306) | }, 800); |
| [6307](#L6307) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [6308](#L6308) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [6309](#L6309) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [6310](#L6310) |  |
| [6311](#L6311) |  |
| [6312](#L6312) | }); |
| [6313](#L6313) |  |
| [6314](#L6314) |  |
| [6315](#L6315) |  |
| [6316](#L6316) | }); |
| [6317](#L6317) |  |
| [6318](#L6318) | } |
| [6319](#L6319) | }, 100); |
| [6320](#L6320) |  |
| [6321](#L6321) |  |
| [6322](#L6322) | </script> |
| [6323](#L6323) |  |
| [6324](#L6324) |  |
| [6325](#L6325) | <?php } ?> |
| [6326](#L6326) |  |
| [6327](#L6327) | <div class="clear"></div> |
| [6328](#L6328) | <!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --> |
| [6329](#L6329) | <?php |
| [6330](#L6330) | $output = ob\_get\_clean (); |
| [6331](#L6331) | return $output; |
| [6332](#L6332) | } |
| [6333](#L6333) | function rfp\_responsive\_justified\_gallery\_with\_lightbox\_media\_preview\_func() { |
| [6334](#L6334) |  |
| [6335](#L6335) | global $wpdb; |
| [6336](#L6336) |  |
| [6337](#L6337) |  |
| [6338](#L6338) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_preview' ) ) { |
| [6339](#L6339) |  |
| [6340](#L6340) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6341](#L6341) |  |
| [6342](#L6342) | } |
| [6343](#L6343) |  |
| [6344](#L6344) | $pagenum = isset($\_GET['pagenum']) ? (int) absint($\_GET['pagenum']) : 1; |
| [6345](#L6345) |  |
| [6346](#L6346) | $settings=get\_option('rjg\_settings'); |
| [6347](#L6347) |  |
| [6348](#L6348) |  |
| [6349](#L6349) | $limit = $settings['page\_size']; |
| [6350](#L6350) | $offset = ( $pagenum - 1 ) \* $limit; |
| [6351](#L6351) |  |
| [6352](#L6352) | $rand\_Num\_td = uniqid ( 'divSliderMain' ); |
| [6353](#L6353) | $rand\_var\_name = uniqid ( 'rand\_' ); |
| [6354](#L6354) | $target = uniqid ( 'target'.rand(1,2000000) ); |
| [6355](#L6355) |  |
| [6356](#L6356) |  |
| [6357](#L6357) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6358](#L6358) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6359](#L6359) | // $settings=get\_option('thumbnail\_slider\_settings'); |
| [6360](#L6360) |  |
| [6361](#L6361) | $uploads = wp\_upload\_dir (); |
| [6362](#L6362) | $baseDir = $uploads ['basedir']; |
| [6363](#L6363) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6364](#L6364) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery'; |
| [6365](#L6365) | $baseurl = $uploads ['baseurl']; |
| [6366](#L6366) | $baseurl .= '/wp-responsive-photo-gallery/'; |
| [6367](#L6367) |  |
| [6368](#L6368) | $wpcurrentdir = dirname ( \_\_FILE\_\_ ); |
| [6369](#L6369) | $wpcurrentdir = str\_replace ( "\\", "/", $wpcurrentdir ); |
| [6370](#L6370) | $randOmeAlbName = uniqid ( 'alb\_' ); |
| [6371](#L6371) | $randOmeRel = uniqid ( 'rel\_' ); |
| [6372](#L6372) | $randOmVlBox = uniqid('video\_lbox\_'); |
| [6373](#L6373) | $vNonce = wp\_create\_nonce('vNonce'); |
| [6374](#L6374) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [6375](#L6375) | $loaderImg = $url . 'images/bx\_loader.gif'; |
| [6376](#L6376) | $imageMargin=$settings['imageMargin']; |
| [6377](#L6377) |  |
| [6378](#L6378) | $LoadingBackColor=$settings ['BackgroundColor']; |
| [6379](#L6379) | if(strtolower($LoadingBackColor)=='none'){ |
| [6380](#L6380) | $LoadingBackColor='#ffffff'; |
| [6381](#L6381) | } |
| [6382](#L6382) | ?> |
| [6383](#L6383) | <style>#<?php echo $rand\_var\_name;?>{background-color:<?php echo $LoadingBackColor;?>;padding-top:<?php echo $imageMargin;?>px;padding-left:<?php echo $imageMargin;?>px;padding-right:<?php echo $imageMargin;?>px;}</style> |
| [6384](#L6384) | <div style="width: 100%;"> |
| [6385](#L6385) | <br/> |
| [6386](#L6386) | <div style="float: left; width: 100%;"> |
| [6387](#L6387) | <table><tr> |
| [6388](#L6388) | <td> |
| [6389](#L6389) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [6390](#L6390) | <div id="fb-root"></div> |
| [6391](#L6391) | <script>(function(d, s, id) { |
| [6392](#L6392) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [6393](#L6393) | if (d.getElementById(id)) return; |
| [6394](#L6394) | js = d.createElement(s); js.id = id; |
| [6395](#L6395) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [6396](#L6396) | fjs.parentNode.insertBefore(js, fjs); |
| [6397](#L6397) | }(document, 'script', 'facebook-jssdk'));</script> |
| [6398](#L6398) | </td> |
| [6399](#L6399) | <td> |
| [6400](#L6400) | <a target="\_blank" title="Donate" href="http://i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [6401](#L6401) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [6402](#L6402) | </a> |
| [6403](#L6403) | </td> |
| [6404](#L6404) | </tr> |
| [6405](#L6405) | </table> |
| [6406](#L6406) | <div style="clear:both"> |
| [6407](#L6407) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/photo-gallery-slideshow-masonry-tiled-gallery/"><?php echo \_\_( 'UPGRADE TO PRO VERSION','wp-responsive-photo-gallery' );?></a></h3></span> |
| [6408](#L6408) | </div> |
| [6409](#L6409) | <h2><?php echo \_\_('Masonry Gallery Preview','wp-responsive-photo-gallery');?></h2> |
| [6410](#L6410) |  |
| [6411](#L6411) | <?php if (is\_array($settings)) { |
| [6412](#L6412) |  |
| [6413](#L6413) | ?> |
| [6414](#L6414) |  |
| [6415](#L6415) | <div style="clear: both;"></div> |
| [6416](#L6416) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6417](#L6417) | <div style="clear: both;"></div> |
| [6418](#L6418) | <?php $url = plugin\_dir\_url(\_\_FILE\_\_); ?> |
| [6419](#L6419) |  |
| [6420](#L6420) |  |
| [6421](#L6421) | <div class="gallery\_wrap0" id="<?php echo $rand\_Num\_td;?>" > |
| [6422](#L6422) |  |
| [6423](#L6423) | <div class="gallery\_ gallery\_0" id="<?php echo $rand\_var\_name;?>" > |
| [6424](#L6424) |  |
| [6425](#L6425) | <div id="<?php echo $rand\_var\_name; ?>\_overlay\_grid" class="overlay\_grid" style="background: <?php echo $LoadingBackColor; ?> url('<?php echo $loaderImg; ?>') no-repeat scroll 50% 50%;" ></div> |
| [6426](#L6426) |  |
| [6427](#L6427) | <?php |
| [6428](#L6428) |  |
| [6429](#L6429) | $imageheight = $settings ['imageheight']; |
| [6430](#L6430) | $query = "SELECT \* FROM " . $wpdb->prefix . "rjg\_gallery  order by createdon desc LIMIT $offset, $limit"; |
| [6431](#L6431) | $firstChild='firstimg'; |
| [6432](#L6432) | $rows = $wpdb->get\_results ( $query, 'ARRAY\_A' ); |
| [6433](#L6433) |  |
| [6434](#L6434) |  |
| [6435](#L6435) | if (count ( $rows ) > 0) { |
| [6436](#L6436) |  |
| [6437](#L6437) | foreach ( $rows as $row ) { |
| [6438](#L6438) |  |
| [6439](#L6439) | $imagename = $row ['image\_name']; |
| [6440](#L6440) | $video\_url = $row ['videourl']; |
| [6441](#L6441) | $video\_url\_org = $row ['murl']; |
| [6442](#L6442) | $Url\_vid = @parse\_url($video\_url\_org); |
| [6443](#L6443) |  |
| [6444](#L6444) |  |
| [6445](#L6445) |  |
| [6446](#L6446) | $relend = ''; |
| [6447](#L6447) | $flag=false; |
| [6448](#L6448) | if (isset($Url\_vid['query']) and $Url\_vid['query'] != '') { |
| [6449](#L6449) |  |
| [6450](#L6450) |  |
| [6451](#L6451) | parse\_str($Url\_vid['query'], $get\_array); |
| [6452](#L6452) | if(is\_array($get\_array) and sizeof($get\_array)>0){ |
| [6453](#L6453) |  |
| [6454](#L6454) | foreach($get\_array as $k=>$v){ |
| [6455](#L6455) |  |
| [6456](#L6456) | if($flag==false){ |
| [6457](#L6457) |  |
| [6458](#L6458) | $flag=true; |
| [6459](#L6459) | $relend.="?$k=$v"; |
| [6460](#L6460) | } |
| [6461](#L6461) | else{ |
| [6462](#L6462) |  |
| [6463](#L6463) | $relend.="&$k=$v"; |
| [6464](#L6464) |  |
| [6465](#L6465) | } |
| [6466](#L6466) |  |
| [6467](#L6467) |  |
| [6468](#L6468) | } |
| [6469](#L6469) |  |
| [6470](#L6470) |  |
| [6471](#L6471) | } |
| [6472](#L6472) |  |
| [6473](#L6473) |  |
| [6474](#L6474) |  |
| [6475](#L6475) | } |
| [6476](#L6476) |  |
| [6477](#L6477) | $vtype= $row ['vtype']; |
| [6478](#L6478) | $imageUploadTo = $pathToImagesFolder . '/' . $imagename; |
| [6479](#L6479) | $imageUploadTo = str\_replace ( "\\", "/", $imageUploadTo ); |
| [6480](#L6480) | $pathinfo = pathinfo ( $imageUploadTo ); |
| [6481](#L6481) | $filenamewithoutextension = $pathinfo ['filename']; |
| [6482](#L6482) |  |
| [6483](#L6483) | $outputimgmain = $baseurl . $row ['image\_name']; |
| [6484](#L6484) | $outputimg=$outputimgmain; |
| [6485](#L6485) | $media\_type=$row['media\_type']; |
| [6486](#L6486) | $hoverClass=''; |
| [6487](#L6487) | if($media\_type=="link") |
| [6488](#L6488) | $hoverClass="playbtnCss\_link"; |
| [6489](#L6489) | else if($media\_type=="video") |
| [6490](#L6490) | $hoverClass="playbtnCss\_video"; |
| [6491](#L6491) | else if($media\_type=="image") |
| [6492](#L6492) | $hoverClass="playbtnCss\_zoom"; |
| [6493](#L6493) |  |
| [6494](#L6494) | $title = ""; |
| [6495](#L6495) | $rowTitle = $row['title']; |
| [6496](#L6496) | $rowTitle = str\_replace("'", "’", $rowTitle); |
| [6497](#L6497) | $rowTitle = str\_replace('"', '”', $rowTitle); |
| [6498](#L6498) |  |
| [6499](#L6499) |  |
| [6500](#L6500) |  |
| [6501](#L6501) | $open\_link\_in = $row['open\_link\_in']; |
| [6502](#L6502) | $open\_title\_link\_in = 1; |
| [6503](#L6503) |  |
| [6504](#L6504) | if(!$open\_title\_link\_in) |
| [6505](#L6505) | $openImageInNewTab = '\_self'; |
| [6506](#L6506) | else |
| [6507](#L6507) | $openImageInNewTab = '\_blank'; |
| [6508](#L6508) |  |
| [6509](#L6509) | $embed\_url=$row['embed\_url'].$relend; |
| [6510](#L6510) | if($media\_type=="video"){ |
| [6511](#L6511) |  |
| [6512](#L6512) | if (trim($row['title']) != '' and trim($row['videourl']) != '') { |
| [6513](#L6513) |  |
| [6514](#L6514) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['videourl']}'>{$rowTitle}</a>"; |
| [6515](#L6515) |  |
| [6516](#L6516) | } else if (trim($row['title']) != '' and trim($row['videourl']) == '') { |
| [6517](#L6517) |  |
| [6518](#L6518) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6519](#L6519) |  |
| [6520](#L6520) | } else { |
| [6521](#L6521) |  |
| [6522](#L6522) | if ($row['mdescription'] != '') |
| [6523](#L6523) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6524](#L6524) |  |
| [6525](#L6525) | } |
| [6526](#L6526) | } |
| [6527](#L6527) | else if($media\_type=="image"){ |
| [6528](#L6528) |  |
| [6529](#L6529) | if (trim($row['title']) != '' and trim($row['murl']) != '') { |
| [6530](#L6530) |  |
| [6531](#L6531) | $title = "<a class='Imglink' target='$openImageInNewTab' href='{$row['murl']}'>{$rowTitle}</a>"; |
| [6532](#L6532) |  |
| [6533](#L6533) | } else if (trim($row['title']) != '' and trim($row['murl']) == '') { |
| [6534](#L6534) |  |
| [6535](#L6535) | $title = "<a class='Imglink' >{$rowTitle}</a>"; |
| [6536](#L6536) |  |
| [6537](#L6537) | } else { |
| [6538](#L6538) |  |
| [6539](#L6539) | if ($row['mdescription'] != '') |
| [6540](#L6540) | $title = "<div class='clear\_description\_'>{$row['mdescription']}</div>"; |
| [6541](#L6541) |  |
| [6542](#L6542) | } |
| [6543](#L6543) |  |
| [6544](#L6544) | } |
| [6545](#L6545) |  |
| [6546](#L6546) |  |
| [6547](#L6547) | ?> |
| [6548](#L6548) |  |
| [6549](#L6549) | <?php if($media\_type=='image' or $media\_type=='video') :?> |
| [6550](#L6550) |  |
| [6551](#L6551) | <?php if ($open\_link\_in == 1): ?> |
| [6552](#L6552) | <a data-rel="<?php echo $randOmeRel; ?>"  data-overlay="1" data-type="<?php echo $media\_type;?>"  data-title="<?php echo $title; ?>" class="thumbnail\_ <?php echo $randOmVlBox; ?> <?php if($media\_type=='video'):?>iframe <?php endif;?> "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>"  > |
| [6553](#L6553) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6554](#L6554) | </a> |
| [6555](#L6555) | <?php else: ?> |
| [6556](#L6556) |  |
| [6557](#L6557) | <a   data-type="<?php echo $media\_type;?>" data-overlay="1" data-title="<?php echo $title; ?>" class="thumbnail\_ "  href="<?php if($media\_type=='video'):?><?php echo $embed\_url; ?> <?php else:?><?php echo $outputimgmain; ?><?php endif;?>" > |
| [6558](#L6558) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6559](#L6559) | </a> |
| [6560](#L6560) | <?php endif;?> |
| [6561](#L6561) |  |
| [6562](#L6562) | <?php else:?> |
| [6563](#L6563) | <a   data-type="<?php echo $media\_type;?>" target='<?php echo $openImageInNewTab;?>' class="thumbnail\_ "  href="<?php echo $row['murl']; ?>" > |
| [6564](#L6564) | <figure class="<?php echo $target;?> figure\_\_" data-title="<?php echo $rowTitle;?>" data-url="<?php echo $outputimgmain;?>"></figure> |
| [6565](#L6565) | </a> |
| [6566](#L6566) |  |
| [6567](#L6567) | <?php endif;?> |
| [6568](#L6568) |  |
| [6569](#L6569) |  |
| [6570](#L6570) |  |
| [6571](#L6571) | <?php } ?> |
| [6572](#L6572) |  |
| [6573](#L6573) | <?php } ?> |
| [6574](#L6574) | <br style="clear: both;"> |
| [6575](#L6575) | </div> |
| [6576](#L6576) | <?php |
| [6577](#L6577) | $total = $wpdb->get\_var("SELECT COUNT(`id`) FROM {$wpdb->prefix}rjg\_gallery "); |
| [6578](#L6578) | $num\_of\_pages = ceil($total / $limit); |
| [6579](#L6579) | $page\_links = paginate\_links(array( |
| [6580](#L6580) | 'base' => add\_query\_arg('pagenum', '%#%'), |
| [6581](#L6581) | 'format' => '', |
| [6582](#L6582) | 'prev\_text' => \_\_('&laquo;', 'aag'), |
| [6583](#L6583) | 'next\_text' => \_\_('&raquo;', 'aag'), |
| [6584](#L6584) | 'total' => $num\_of\_pages, |
| [6585](#L6585) | 'current' => $pagenum, |
| [6586](#L6586) | 'prev\_next' => true, |
| [6587](#L6587) | 'type' => 'list', |
| [6588](#L6588) | )); |
| [6589](#L6589) |  |
| [6590](#L6590) | if ($page\_links) { |
| [6591](#L6591) | echo '<div class="navigation\_grid\_rjg" style="margin-bottom:10px;display:table">' . $page\_links . '</div>'; |
| [6592](#L6592) |  |
| [6593](#L6593) | } |
| [6594](#L6594) | ?> |
| [6595](#L6595) |  |
| [6596](#L6596) | <div style="clear:both"></div> |
| [6597](#L6597) | </div> |
| [6598](#L6598) |  |
| [6599](#L6599) | <script> |
| [6600](#L6600) |  |
| [6601](#L6601) | <?php $uniqId = uniqid(); ?> |
| [6602](#L6602) | var uniqObj<?php echo $uniqId ?> = jQuery("a[data-rel='<?php echo $randOmeRel; ?>']"); |
| [6603](#L6603) |  |
| [6604](#L6604) | jQuery(document).ready(function() { |
| [6605](#L6605) |  |
| [6606](#L6606) |  |
| [6607](#L6607) |  |
| [6608](#L6608) | jQuery("#<?php echo $rand\_var\_name;?>").latae({ |
| [6609](#L6609) | loader : '<?php echo plugins\_url( 'images/loader.gif', \_\_FILE\_\_ ) ;?>', |
| [6610](#L6610) | max\_height:<?php echo $settings ['imageheight'];?>, |
| [6611](#L6611) | margin:<?php echo $settings ['imageMargin'];?>, |
| [6612](#L6612) | target:'<?php echo $target;?>', |
| [6613](#L6613) | init : function() { }, |
| [6614](#L6614) | loadPicture : function(event, img) {  }, |
| [6615](#L6615) | resize : function(event, gallery) {  }, |
| [6616](#L6616) | displayTitle: <?php echo ($settings['show\_hover\_caption']==1) ?  'true':'false' ?>, |
| [6617](#L6617) | displayIcons: <?php echo ($settings['show\_hover\_icon']==1) ?  'true':'false' ?> |
| [6618](#L6618) | }); |
| [6619](#L6619) |  |
| [6620](#L6620) | jQuery(".<?php echo $randOmVlBox; ?>").fancybox\_rjg({ |
| [6621](#L6621) |  |
| [6622](#L6622) | 'overlayColor':'#000000', |
| [6623](#L6623) | 'padding': 3, |
| [6624](#L6624) | 'margin': 20, |
| [6625](#L6625) | 'autoScale': true, |
| [6626](#L6626) | 'autoDimensions':true, |
| [6627](#L6627) | 'uniqObj':uniqObj<?php echo $uniqId; ?>, |
| [6628](#L6628) | 'uniqRel':'<?php echo $randOmeRel; ?>', |
| [6629](#L6629) | 'transitionIn':'fade', |
| [6630](#L6630) | 'transitionOut':'fade', |
| [6631](#L6631) | 'titlePosition': 'outside', |
| [6632](#L6632) | 'cyclic':true, |
| [6633](#L6633) | 'hideOnContentClick':false, |
| [6634](#L6634) | 'width' : 650, |
| [6635](#L6635) | 'height' : 400, |
| [6636](#L6636) | 'titleFormat': function(title, currentArray, currentIndex, currentOpts) { |
| [6637](#L6637) |  |
| [6638](#L6638) | var currtElem = jQuery('#<?php echo $rand\_var\_name; ?> a[href="' + currentOpts.href + '"]'); |
| [6639](#L6639) | var isoverlay = jQuery(currtElem).attr('data-overlay') |
| [6640](#L6640) |  |
| [6641](#L6641) | if (isoverlay == "1" && jQuery.trim(title) != ""){ |
| [6642](#L6642) | return '<span id="fancybox\_rjg-title-over">' + title + '</span>'; |
| [6643](#L6643) | } |
| [6644](#L6644) | else{ |
| [6645](#L6645) | return ''; |
| [6646](#L6646) | } |
| [6647](#L6647) |  |
| [6648](#L6648) | } |
| [6649](#L6649) | }); |
| [6650](#L6650) |  |
| [6651](#L6651) | jQuery(".page-numbers").show(); |
| [6652](#L6652) |  |
| [6653](#L6653) |  |
| [6654](#L6654) | }); |
| [6655](#L6655) | jQuery("body").delegate("#<?php echo $rand\_Num\_td; ?> .navigation\_grid\_rjg ul.page-numbers li a.page-numbers", "click", function(e) { |
| [6656](#L6656) |  |
| [6657](#L6657) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", jQuery("#<?php echo $rand\_var\_name; ?>").width()); |
| [6658](#L6658) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", jQuery("#<?php echo $rand\_var\_name; ?>").height()); |
| [6659](#L6659) |  |
| [6660](#L6660) | e.preventDefault(); |
| [6661](#L6661) | var data = { |
| [6662](#L6662) | 'action': 'rjg\_get\_grid\_data\_justified\_gallery', |
| [6663](#L6663) | 'page\_url': encodeURI(jQuery(this).attr('href')), |
| [6664](#L6664) | 'grid\_id':0, |
| [6665](#L6665) | 'total\_rec':'<?php echo $total; ?>', |
| [6666](#L6666) | 'vNonce':'<?php echo $vNonce;?>' |
| [6667](#L6667) | }; |
| [6668](#L6668) | jQuery.post('<?php echo admin\_url('admin-ajax.php'); ?>', data, function(response) { |
| [6669](#L6669) |  |
| [6670](#L6670) |  |
| [6671](#L6671) | jQuery('html, body').animate({ |
| [6672](#L6672) | scrollTop: jQuery("#<?php echo $rand\_Num\_td; ?>").offset().top |
| [6673](#L6673) | }, 800); |
| [6674](#L6674) | jQuery("#<?php echo $rand\_Num\_td; ?>").replaceWith(response); |
| [6675](#L6675) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("width", "0px"); |
| [6676](#L6676) | jQuery("#<?php echo $rand\_var\_name; ?>\_overlay\_grid").css("height", "0px"); |
| [6677](#L6677) |  |
| [6678](#L6678) |  |
| [6679](#L6679) | }); |
| [6680](#L6680) |  |
| [6681](#L6681) |  |
| [6682](#L6682) |  |
| [6683](#L6683) | }); |
| [6684](#L6684) |  |
| [6685](#L6685) |  |
| [6686](#L6686) |  |
| [6687](#L6687) | </script> |
| [6688](#L6688) |  |
| [6689](#L6689) |  |
| [6690](#L6690) | <?php } ?> |
| [6691](#L6691) | </div> |
| [6692](#L6692) | </div> |
| [6693](#L6693) | <div class="clear"></div> |
| [6694](#L6694) |  |
| [6695](#L6695) | <?php if (is\_array($settings)) { ?> |
| [6696](#L6696) |  |
| [6697](#L6697) | <h3><?php echo \_\_('To print this masonry gallery into WordPress Post/Page use below code','wp-responsive-photo-gallery');?></h3> |
| [6698](#L6698) | <input type="text" value='[print\_masonry\_gallery\_plus\_lightbox ] ' |
| [6699](#L6699) | style="width: 400px; height: 30px" |
| [6700](#L6700) | onclick="this.focus(); this.select()" /> |
| [6701](#L6701) | <div class="clear"></div> |
| [6702](#L6702) | <h3><?php echo \_\_('To print this masonry gallery into WordPress theme/template PHP files use below code','wp-responsive-photo-gallery');?></h3> |
| [6703](#L6703) | <?php |
| [6704](#L6704) | $shortcode = '[print\_masonry\_gallery\_plus\_lightbox ]'; |
| [6705](#L6705) | ?> |
| [6706](#L6706) | <input type="text" value="&lt;?php echo do\_shortcode('<?php echo htmlentities($shortcode, ENT\_QUOTES); ?>'); ?&gt;" style="width: 400px; height: 30px" onclick="this.focus(); this.select()" /> |
| [6707](#L6707) | <?php } ?> |
| [6708](#L6708) | <div class="clear"></div> |
| [6709](#L6709) | <?php |
| [6710](#L6710) | } |
| [6711](#L6711) | function rjg\_remove\_extra\_p\_tags($content){ |
| [6712](#L6712) |  |
| [6713](#L6713) | if(strpos($content, 'rjg\_print\_masonry\_gallery\_plus\_lightbox\_func')!==false){ |
| [6714](#L6714) |  |
| [6715](#L6715) |  |
| [6716](#L6716) | $pattern = "/<!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->(.\*)<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->/Uis"; |
| [6717](#L6717) | $content = preg\_replace\_callback($pattern, function($matches) { |
| [6718](#L6718) |  |
| [6719](#L6719) |  |
| [6720](#L6720) | $altered = str\_replace("<p>","",$matches[1]); |
| [6721](#L6721) | $altered = str\_replace("</p>","",$altered); |
| [6722](#L6722) |  |
| [6723](#L6723) | $altered=str\_replace("&#038;","&",$altered); |
| [6724](#L6724) | $altered=str\_replace("&#8221;",'"',$altered); |
| [6725](#L6725) |  |
| [6726](#L6726) |  |
| [6727](#L6727) | return @str\_replace($matches[1], $altered, $matches[0]); |
| [6728](#L6728) | }, $content); |
| [6729](#L6729) |  |
| [6730](#L6730) |  |
| [6731](#L6731) |  |
| [6732](#L6732) | } |
| [6733](#L6733) |  |
| [6734](#L6734) | $content = str\_replace("<p><!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->","<!-- rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->",$content); |
| [6735](#L6735) | $content = str\_replace("<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func --></p>","<!-- end rjg\_print\_masonry\_gallery\_plus\_lightbox\_func -->",$content); |
| [6736](#L6736) |  |
| [6737](#L6737) |  |
| [6738](#L6738) | return $content; |
| [6739](#L6739) | } |
| [6740](#L6740) |  |
| [6741](#L6741) |  |
| [6742](#L6742) | function wrthslider\_slider\_mass\_upload\_wpresponsivephgallery(){ |
| [6743](#L6743) |  |
| [6744](#L6744) | global $wpdb; |
| [6745](#L6745) |  |
| [6746](#L6746) | $uploads = wp\_upload\_dir (); |
| [6747](#L6747) | $baseDir = $uploads ['basedir']; |
| [6748](#L6748) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6749](#L6749) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery/'; |
| [6750](#L6750) |  |
| [6751](#L6751) | if(isset($\_POST) and sizeof($\_POST)>0){ |
| [6752](#L6752) |  |
| [6753](#L6753) | if(!check\_ajax\_referer( 'thumbnail-mass-image','thumbnail\_security' )){ |
| [6754](#L6754) |  |
| [6755](#L6755) | wp\_die('Security check fail'); |
| [6756](#L6756) |  |
| [6757](#L6757) | } |
| [6758](#L6758) | if ( ! current\_user\_can( 'rsp\_responsive\_photo\_gallery\_add\_image' ) ) { |
| [6759](#L6759) |  |
| [6760](#L6760) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6761](#L6761) |  |
| [6762](#L6762) | } |
| [6763](#L6763) | $createdOn=date('Y-m-d h:i:s'); |
| [6764](#L6764) | if(function\_exists('date\_i18n')){ |
| [6765](#L6765) |  |
| [6766](#L6766) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [6767](#L6767) | if(get\_option('time\_format')=='H:i') |
| [6768](#L6768) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [6769](#L6769) | else |
| [6770](#L6770) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [6771](#L6771) | } |
| [6772](#L6772) | $attachment\_id=(int)$\_POST['attachment\_id']; |
| [6773](#L6773) | $photoMeta = wp\_get\_attachment\_metadata( $attachment\_id ); |
| [6774](#L6774) |  |
| [6775](#L6775) | $open\_link\_in=0; |
| [6776](#L6776) | $enable\_light\_box\_img\_desc=0; |
| [6777](#L6777) | $imageurl=''; |
| [6778](#L6778) | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
| [6779](#L6779) | $enable\_light\_box\_img\_desc=0; |
| [6780](#L6780) |  |
| [6781](#L6781) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [6782](#L6782) |  |
| [6783](#L6783) | $fileName=$photoMeta['file']; |
| [6784](#L6784) | $phyPath=ABSPATH; |
| [6785](#L6785) | $phyPath=str\_replace("\\","/",$phyPath); |
| [6786](#L6786) |  |
| [6787](#L6787) | $pathArray=pathinfo($fileName); |
| [6788](#L6788) |  |
| [6789](#L6789) | $imagename=$pathArray['basename']; |
| [6790](#L6790) | $imagename\_=$pathArray['filename']; |
| [6791](#L6791) | $file\_ext=$pathArray['extension']; |
| [6792](#L6792) | $imagename=$imagename\_.uniqid().".".$file\_ext; |
| [6793](#L6793) | $upload\_dir\_n = wp\_upload\_dir(); |
| [6794](#L6794) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [6795](#L6795) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [6796](#L6796) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [6797](#L6797) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [6798](#L6798) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [6799](#L6799) | $imageUploadTo=$pathToImagesFolder."/".$imagename; |
| [6800](#L6800) | @copy($fileUrl, $imageUploadTo); |
| [6801](#L6801) |  |
| [6802](#L6802) | if(!file\_exists($imageUploadTo)){ |
| [6803](#L6803) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [6804](#L6804) | } |
| [6805](#L6805) |  |
| [6806](#L6806) | } |
| [6807](#L6807) |  |
| [6808](#L6808) |  |
| [6809](#L6809) | $query = "INSERT INTO ".$wpdb->prefix."gv\_responsive\_slider (title, image\_name,createdon) |
| [6810](#L6810) | VALUES ('$title','$imagename','$createdOn')"; |
| [6811](#L6811) |  |
| [6812](#L6812) | $wpdb->query($query); |
| [6813](#L6813) |  |
| [6814](#L6814) |  |
| [6815](#L6815) |  |
| [6816](#L6816) |  |
| [6817](#L6817) | } |
| [6818](#L6818) |  |
| [6819](#L6819) | } |
| [6820](#L6820) |  |
| [6821](#L6821) | function wrthslider\_slider\_mass\_upload\_wpresponsivephgalleryms(){ |
| [6822](#L6822) |  |
| [6823](#L6823) | global $wpdb; |
| [6824](#L6824) |  |
| [6825](#L6825) | $uploads = wp\_upload\_dir (); |
| [6826](#L6826) | $baseDir = $uploads ['basedir']; |
| [6827](#L6827) | $baseDir = str\_replace ( "\\", "/", $baseDir ); |
| [6828](#L6828) | $pathToImagesFolder = $baseDir . '/wp-responsive-photo-gallery/'; |
| [6829](#L6829) |  |
| [6830](#L6830) | if(isset($\_POST) and sizeof($\_POST)>0){ |
| [6831](#L6831) |  |
| [6832](#L6832) | if(!check\_ajax\_referer( 'thumbnail-mass-image','thumbnail\_security' )){ |
| [6833](#L6833) |  |
| [6834](#L6834) | wp\_die('Security check fail'); |
| [6835](#L6835) |  |
| [6836](#L6836) | } |
| [6837](#L6837) | if ( ! current\_user\_can( 'rsp\_masonry\_gallery\_add\_media' ) ) { |
| [6838](#L6838) |  |
| [6839](#L6839) | wp\_die( \_\_( "Access Denied", "wp-responsive-photo-gallery" ) ); |
| [6840](#L6840) |  |
| [6841](#L6841) | } |
| [6842](#L6842) | $createdOn=date('Y-m-d h:i:s'); |
| [6843](#L6843) | if(function\_exists('date\_i18n')){ |
| [6844](#L6844) |  |
| [6845](#L6845) | $createdOn=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [6846](#L6846) | if(get\_option('time\_format')=='H:i') |
| [6847](#L6847) | $createdOn=date('Y-m-d H:i:s',strtotime($createdOn)); |
| [6848](#L6848) | else |
| [6849](#L6849) | $createdOn=date('Y-m-d h:i:s',strtotime($createdOn)); |
| [6850](#L6850) | } |
| [6851](#L6851) | $attachment\_id=(int)$\_POST['attachment\_id']; |
| [6852](#L6852) | $photoMeta = wp\_get\_attachment\_metadata( $attachment\_id ); |
| [6853](#L6853) |  |
| [6854](#L6854) | $open\_link\_in=0; |
| [6855](#L6855) | $enable\_light\_box\_img\_desc=0; |
| [6856](#L6856) | $imageurl=''; |
| [6857](#L6857) | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
| [6858](#L6858) | $enable\_light\_box\_img\_desc=0; |
| [6859](#L6859) |  |
| [6860](#L6860) | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
| [6861](#L6861) |  |
| [6862](#L6862) | $fileName=$photoMeta['file']; |
| [6863](#L6863) | $phyPath=ABSPATH; |
| [6864](#L6864) | $phyPath=str\_replace("\\","/",$phyPath); |
| [6865](#L6865) |  |
| [6866](#L6866) | $pathArray=pathinfo($fileName); |
| [6867](#L6867) |  |
| [6868](#L6868) | $imagename=$pathArray['basename']; |
| [6869](#L6869) | $imagename\_=$pathArray['filename']; |
| [6870](#L6870) | $file\_ext=$pathArray['extension']; |
| [6871](#L6871) | $imagename=$imagename\_.uniqid().".".$file\_ext; |
| [6872](#L6872) | $upload\_dir\_n = wp\_upload\_dir(); |
| [6873](#L6873) | $upload\_dir\_n=$upload\_dir\_n['basedir']; |
| [6874](#L6874) | $fileUrl=$upload\_dir\_n.'/'.$fileName; |
| [6875](#L6875) | $fileUrl=str\_replace("\\","/",$fileUrl); |
| [6876](#L6876) | $wpcurrentdir=dirname(\_\_FILE\_\_); |
| [6877](#L6877) | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
| [6878](#L6878) | $imageUploadTo=$pathToImagesFolder."/".$imagename; |
| [6879](#L6879) | @copy($fileUrl, $imageUploadTo); |
| [6880](#L6880) |  |
| [6881](#L6881) | if(!file\_exists($imageUploadTo)){ |
| [6882](#L6882) | rs\_photogallery\_save\_image\_remote\_lbox($fileUrl,$imageUploadTo); |
| [6883](#L6883) | } |
| [6884](#L6884) |  |
| [6885](#L6885) | } |
| [6886](#L6886) |  |
| [6887](#L6887) |  |
| [6888](#L6888) | $query = "INSERT INTO " . $wpdb->prefix . "rjg\_gallery |
| [6889](#L6889) | (media\_type,image\_name,title,murl,open\_link\_in, |
| [6890](#L6890) | HdnMediaSelection,createdon) |
| [6891](#L6891) | VALUES ('image','$imagename','$title','',1,'$fileUrl', '$createdOn')"; |
| [6892](#L6892) |  |
| [6893](#L6893) | $wpdb->query($query); |
| [6894](#L6894) |  |
| [6895](#L6895) |  |
| [6896](#L6896) |  |
| [6897](#L6897) |  |
| [6898](#L6898) | } |
| [6899](#L6899) |  |
| [6900](#L6900) | } |
| [6901](#L6901) |  |
| [6902](#L6902) | add\_filter('widget\_text\_content', 'rjg\_remove\_extra\_p\_tags', 999); |
| [6903](#L6903) | add\_filter('the\_content', 'rjg\_remove\_extra\_p\_tags', 999); |
| [6904](#L6904) |  |
| [6905](#L6905) |  |
| [6906](#L6906) |  |
| [6907](#L6907) | function i13\_rpg\_render\_block\_defaults($block\_content, $block) { |
| [6908](#L6908) |  |
| [6909](#L6909) | $block\_content=wrpg\_remove\_extra\_p\_tags($block\_content); |
| [6910](#L6910) | $block\_content=rjg\_remove\_extra\_p\_tags($block\_content); |
| [6911](#L6911) | return $block\_content; |
| [6912](#L6912) |  |
| [6913](#L6913) | } |
| [6914](#L6914) |  |
| [6915](#L6915) |  |
| [6916](#L6916) | add\_filter( 'render\_block', 'i13\_rpg\_render\_block\_defaults', 10, 2 ); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php?format=txt)
* [Original Format](/export/3222443/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_3ceb10c9_20250114_185527.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Photo Gallery Slideshow & Masonry Tiled Gallery <= 1.0.15 - Authenticated (Subscriber+) Limited Server-Side Request Forgery

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Photo Gallery Slideshow & Masonry Tiled Gallery <= 1.0.15 - Authenticated (Subscriber+) Limited Server-Side Request Forgery

4.3

**Server-Side Request Forgery (SSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-12237](https://www.cve.org/CVERecord?id=CVE-2024-12237) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | January 3, 2025 |
| Last Updated | January 3, 2025 |
| Researcher | [shaman0x01 - Shaman Red Team](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/khayal-farzaliyev) |

### Description

The Photo Gallery Slideshow & Masonry Tiled Gallery plugin for WordPress is vulnerable to Server-Side Request Forgery in all versions up to, and including, 1.0.15 via the rjg\_get\_youtube\_info\_justified\_gallery\_callback function. This makes it possible for authenticated attackers, with Subscriber-level access and above, to make web requests to arbitrary locations originating from the web application and can be used to retrieve limited information from internal services.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php#L3023)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-responsive-photo-gallery/tags/1.0.15/wp-responsive-photo-gallery.php#L3044)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-responsive-photo-gallery%2Fphoto-gallery-slideshow-masonry-tiled-gallery-1015-authenticated-subscriber-limited-server-side-request-forgery&t=Photo%20Gallery%20Slideshow%20%26%20Masonry%20Tiled%20Gallery%20%3C%3D%201.0.15%20-%20Authenticated%20%28Subscriber%2B%29%20Limited%20Server-Side%20Request%20Forgery "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-responsive-photo-gallery%2Fphoto-gallery-slideshow-masonry-tiled-gallery-1015-authenticated-subscriber-limited-server-side-request-forgery&text=Photo%20Gallery%20Slideshow%20%26%20Masonry%20Tiled%20Gallery%20%3C%3D%201.0.15%20-%20Authenticated%20%28Subscriber%2B%29%20Limited%20Server-Side%20Request%20Forgery "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-responsive-photo-gallery%2Fphoto-gallery-slideshow-masonry-tiled-gallery-1015-authenticated-subscriber-limited-server-side-request-forgery "LinkedIn")
Email

## Vulnerability Details for Photo Gallery Slideshow & Masonry Tiled Gallery

#### [Photo Gallery Slideshow & Masonry Tiled Gallery](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-responsive-photo-gallery)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-responsive-photo-gallery [(view on wordpress.org)](https://wordpress.org/plugins/wp-responsive-photo-gallery) |
| Patched? | Yes |
| Remediation | Update to version 1.0.16, or a newer patched version |
| Affected Version | * <= 1.0.15 |
| Patched Version | * 1.0.16 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


