=== Content from plugins.trac.wordpress.org_2f024d90_20250114_224639.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Flast-viewed-posts%2Ftrunk%2Finc%2Fnamespace.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3062246 "Revision 3062246")
* Next Revision →
* [Blame](/browser/last-viewed-posts/trunk/inc/namespace.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/last-viewed-posts/trunk/inc/namespace.php)

---

# [source:](/browser?order=name "Go to repository root") [last-viewed-posts](/browser/last-viewed-posts?order=name "View last-viewed-posts")/[trunk](/browser/last-viewed-posts/trunk?order=name "View trunk")/[inc](/browser/last-viewed-posts/trunk/inc?order=name "View inc")/[namespace.php](/browser/last-viewed-posts/trunk/inc/namespace.php?order=name "View namespace.php")

View diff against:

View revision:

| [Last change](/changeset/3205041/last-viewed-posts/trunk/inc/namespace.php "View differences") on this file was [3205041](/changeset/3205041/ "View changeset 3205041"), checked in by \_smartik\_, [5 weeks ago](/timeline?from=2024-12-09T17%3A24%3A44Z&precision=second "See timeline at 12/09/2024 05:24:44 PM") |
| --- |
| Release 1.0.2 |
| **File size:** 4.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | namespace AM\LastViewedPosts; |
| [3](#L3) |  |
| [4](#L4) | /\*\* |
| [5](#L5) | \* Kick it off! |
| [6](#L6) | \* |
| [7](#L7) | \* Register actions and filters required for the plugin. This runs |
| [8](#L8) | \* as WordPress includes the file. |
| [9](#L9) | \*/ |
| [10](#L10) | function bootstrap() { |
| [11](#L11) | global\_setup(); |
| [12](#L12) | add\_action( 'wp\_enqueue\_scripts', \_\_NAMESPACE\_\_ . '\\enqueue\_scripts' ); |
| [13](#L13) | add\_action( 'widgets\_init', \_\_NAMESPACE\_\_ . '\\widget\_init' ); |
| [14](#L14) | } |
| [15](#L15) |  |
| [16](#L16) | /\*\* |
| [17](#L17) | \* Backward compatibility for globals used previously. |
| [18](#L18) | \* |
| [19](#L19) | \* Checks if any of the globals used in previous versions are set |
| [20](#L20) | \* and shims them to the new filter if they are. The globals in |
| [21](#L21) | \* question are: |
| [22](#L22) | \* |
| [23](#L23) | \* - $zg\_cookie\_expire |
| [24](#L24) | \* - $zg\_number\_of\_posts |
| [25](#L25) | \* - $zg\_recognize\_pages |
| [26](#L26) | \* |
| [27](#L27) | \* This is done by registering filters to run on the hook returning |
| [28](#L28) | \* the global value if it is set. To avoid interferring with plugins |
| [29](#L29) | \* using the more recent filter method, these are registered to run |
| [30](#L30) | \* early (priority 5). |
| [31](#L31) | \*/ |
| [32](#L32) | function global\_setup() { |
| [33](#L33) | global $zg\_cookie\_expire, $zg\_number\_of\_posts, $zg\_recognize\_pages; |
| [34](#L34) |  |
| [35](#L35) | if ( isset( $zg\_cookie\_expire ) ) { |
| [36](#L36) | add\_filter( |
| [37](#L37) | 'am.last\_viewed\_posts.expiration\_period', |
| [38](#L38) | function ( $expiration\_period ) use ( $zg\_cookie\_expire ) { |
| [39](#L39) | return $zg\_cookie\_expire; |
| [40](#L40) | }, |
| [41](#L41) | 5 |
| [42](#L42) | ); |
| [43](#L43) | } |
| [44](#L44) |  |
| [45](#L45) | if ( isset( $zg\_number\_of\_posts ) ) { |
| [46](#L46) | add\_filter( |
| [47](#L47) | 'am.last\_viewed\_posts.number\_posts\_to\_display', |
| [48](#L48) | function ( $number\_of\_posts ) use ( $zg\_number\_of\_posts ) { |
| [49](#L49) | return $zg\_number\_of\_posts; |
| [50](#L50) | }, |
| [51](#L51) | 5 |
| [52](#L52) | ); |
| [53](#L53) | } |
| [54](#L54) |  |
| [55](#L55) | if ( isset( $zg\_recognize\_pages ) ) { |
| [56](#L56) | add\_filter( |
| [57](#L57) | 'am.last\_viewed\_posts.post\_types', |
| [58](#L58) | function ( $post\_types ) use ( $zg\_recognize\_pages ) { |
| [59](#L59) | if ( ! $zg\_recognize\_pages ) { |
| [60](#L60) | $post\_types = array\_diff( array\_unique( (array) $post\_types ), array( 'page' ) ); |
| [61](#L61) | } |
| [62](#L62) | return $post\_types; |
| [63](#L63) | }, |
| [64](#L64) | 5 |
| [65](#L65) | ); |
| [66](#L66) | } |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | /\*\* |
| [70](#L70) | \* Returns how long the array of posts is valid for in seconds. |
| [71](#L71) | \* |
| [72](#L72) | \* @return int Period to store recent posts in seconds. Default 360 days. |
| [73](#L73) | \*/ |
| [74](#L74) | function expiration\_period() { |
| [75](#L75) | /\*\* |
| [76](#L76) | \* Modify how long to store the user's recent posts in days. |
| [77](#L77) | \* |
| [78](#L78) | \* @param int $expiration\_period How many days to store the user's recent posts. Default 360. |
| [79](#L79) | \*/ |
| [80](#L80) | $expiration\_period = (int) apply\_filters( 'am.last\_viewed\_posts.expiration\_period', 360 ); |
| [81](#L81) | return $expiration\_period \* DAY\_IN\_SECONDS; |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | /\*\* |
| [85](#L85) | \* Returns number of posts to store as recently visited. |
| [86](#L86) | \* |
| [87](#L87) | \* @return int Number of recent posts to display. Default 10. |
| [88](#L88) | \*/ |
| [89](#L89) | function number\_posts\_to\_display() { |
| [90](#L90) | /\*\* |
| [91](#L91) | \* Modify the number of posts to display to a visitor. |
| [92](#L92) | \* |
| [93](#L93) | \* @param int $posts\_displayed How many posts to display. Default 10. |
| [94](#L94) | \*/ |
| [95](#L95) | return (int) apply\_filters( 'am.last\_viewed\_posts.number\_posts\_to\_display', 10 ); |
| [96](#L96) | } |
| [97](#L97) |  |
| [98](#L98) | /\*\* |
| [99](#L99) | \* Returns post types to include in recently visited list. |
| [100](#L100) | \* |
| [101](#L101) | \* @return string[] Array of post types to include. Default: post, page. |
| [102](#L102) | \*/ |
| [103](#L103) | function include\_post\_types() { |
| [104](#L104) | $default\_post\_types = array( 'post', 'page' ); |
| [105](#L105) | /\*\* |
| [106](#L106) | \* Modify post types to display to visitors. |
| [107](#L107) | \* |
| [108](#L108) | \* @param string[] $post\_types Array of types to display. Default: post, page. |
| [109](#L109) | \*/ |
| [110](#L110) | $post\_types = (array) apply\_filters( 'am.last\_viewed\_posts.post\_types', $default\_post\_types ); |
| [111](#L111) |  |
| [112](#L112) | if ( empty( $post\_types ) ) { |
| [113](#L113) | // Return to default. |
| [114](#L114) | return $default\_post\_types; |
| [115](#L115) | } |
| [116](#L116) |  |
| [117](#L117) | return $post\_types; |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | /\*\* |
| [121](#L121) | \* Enqueue JavaScript and CSS for recent posts plugin. |
| [122](#L122) | \*/ |
| [123](#L123) | function enqueue\_scripts() { |
| [124](#L124) | wp\_enqueue\_script( |
| [125](#L125) | 'am.view\_last\_posts', |
| [126](#L126) | plugins\_url( '/assets/index.js', \_\_DIR\_\_ ), |
| [127](#L127) | array(), |
| [128](#L128) | '1.0.0', |
| [129](#L129) | true |
| [130](#L130) | ); |
| [131](#L131) |  |
| [132](#L132) | $script\_settings = array( |
| [133](#L133) | 'save\_url'       => is\_singular( include\_post\_types() ) && ! is\_home() && ! is\_front\_page() && get\_post\_status() === 'publish', |
| [134](#L134) | 'post\_id'        => get\_the\_ID(), |
| [135](#L135) | 'post\_permalink' => get\_permalink(), |
| [136](#L136) | 'post\_title'     => wp\_strip\_all\_tags( get\_the\_title() ), |
| [137](#L137) | 'home\_url'       => home\_url(), |
| [138](#L138) | 'expiry\_period'  => expiration\_period(), |
| [139](#L139) | 'posts\_to\_store' => number\_posts\_to\_display(), |
| [140](#L140) | ); |
| [141](#L141) |  |
| [142](#L142) | wp\_add\_inline\_script( |
| [143](#L143) | 'am.view\_last\_posts', |
| [144](#L144) | ' |
| [145](#L145) | amViewLastPosts = window.amViewLastPosts || {}; |
| [146](#L146) | amViewLastPosts.settings = ' . wp\_json\_encode( $script\_settings ) . ';', |
| [147](#L147) | 'before' |
| [148](#L148) | ); |
| [149](#L149) |  |
| [150](#L150) | // Null stylesheets used for inline styles need to be registered then enqueued. |
| [151](#L151) | wp\_register\_style( 'am.view\_last\_posts', '', array(), '1.0.0' ); |
| [152](#L152) | wp\_add\_inline\_style( |
| [153](#L153) | 'am.view\_last\_posts', |
| [154](#L154) | ' |
| [155](#L155) | .am\\.last-viewed-posts\\.display-none.am\\.last-viewed-posts\\.display-none { |
| [156](#L156) | display:none !important; |
| [157](#L157) | } |
| [158](#L158) | ' |
| [159](#L159) | ); |
| [160](#L160) | wp\_enqueue\_style( 'am.view\_last\_posts' ); |
| [161](#L161) | } |
| [162](#L162) |  |
| [163](#L163) | /\*\* |
| [164](#L164) | \* Initialise the widget. |
| [165](#L165) | \*/ |
| [166](#L166) | function widget\_init() { |
| [167](#L167) | register\_widget( \_\_NAMESPACE\_\_ . '\\Widget' ); |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | /\*\* |
| [171](#L171) | \* Display list of recently viewed posts. |
| [172](#L172) | \*/ |
| [173](#L173) | function recently\_viewed() { |
| [174](#L174) | ?> |
| [175](#L175) | <ul class="viewed\_posts am.last-viewed-posts.display-none"></ul> |
| [176](#L176) | <script> |
| [177](#L177) | ( 'amViewLastPosts' in window && 'script' in amViewLastPosts && amViewLastPosts.script(amViewLastPosts.settings, window, document) ) |
| [178](#L178) | </script> |
| [179](#L179) | <?php |
| [180](#L180) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/last-viewed-posts/trunk/inc/namespace.php?format=txt)
* [Original Format](/export/3222502/last-viewed-posts/trunk/inc/namespace.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_32c41f67_20250114_224642.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3205041)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3205040 "Changeset 3205040")
* [Next Changeset](/changeset/3205042 "Changeset 3205042") →

---

# Changeset 3205041

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/09/2024 05:24:44 PM
([5 weeks](/timeline?from=2024-12-09T17%3A24%3A44Z&precision=second "See timeline at 12/09/2024 05:24:44 PM") ago)

Author:
\_smartik\_
Message:

Release 1.0.2

Location:
[last-viewed-posts](/browser/last-viewed-posts?rev=3205041)
Files:

8 edited
1 copied

* [tags/1.0.2](/browser/last-viewed-posts/tags/1.0.2?rev=3205041 "Show entry in browser")
  (copied)
  *(copied from [last-viewed-posts/trunk](/browser/last-viewed-posts/trunk?rev=3062252 "Show original file (revision 3205039)"))*
* [tags/1.0.2/assets/index.js](/browser/last-viewed-posts/tags/1.0.2/assets/index.js?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [tags/1.0.2/inc/namespace.php](/browser/last-viewed-posts/tags/1.0.2/inc/namespace.php?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [tags/1.0.2/last\_viewed\_posts.php](/browser/last-viewed-posts/tags/1.0.2/last_viewed_posts.php?rev=3205041 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/1.0.2/readme.txt](/browser/last-viewed-posts/tags/1.0.2/readme.txt?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [trunk/assets/index.js](/browser/last-viewed-posts/trunk/assets/index.js?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [trunk/inc/namespace.php](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [trunk/last\_viewed\_posts.php](/browser/last-viewed-posts/trunk/last_viewed_posts.php?rev=3205041 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [trunk/readme.txt](/browser/last-viewed-posts/trunk/readme.txt?rev=3205041 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [last-viewed-posts/tags/1.0.2/assets/index.js](/changeset/3205041/last-viewed-posts/tags/1.0.2/assets/index.js "Show the changeset 3205041 restricted to last-viewed-posts/tags/1.0.2/assets/index.js")

  | [r3062246](/browser/last-viewed-posts/trunk/assets/index.js?rev=3062246#L15 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/tags/1.0.2/assets/index.js?rev=3205041#L15 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | (amViewLastPosts.script = function( settings, window, document ) { |
  | 16 | 16 | var localStorageName = 'amViewLastPosts.recentPosts'; |
  | 17 |  | ~~var legacyCookieName = 'WP-LastViewedPosts';~~ |
  | 18 |  |  |
  | 19 |  | ~~/\*\*~~ |
  | 20 |  | ~~\* Determine if storage API is available.~~ |
  | 21 |  | ~~\*~~ |
  | 22 |  | ~~\* Source: https://developer.mozilla.org/en-US/docs/Web/API/Web\_Storage\_API/Using\_the\_Web\_Storage\_API~~ |
  | 23 |  | ~~\*~~ |
  | 24 |  | ~~\* @param {string} type Storage type to check for.~~ |
  | 25 |  | ~~\* @returns {boolean} Whether storage is available.~~ |
  | 26 |  | ~~\*/~~ |
  | 27 |  | ~~function storageAvailable(type) {~~ |
  | 28 |  | ~~var storage;~~ |
  | 29 |  | ~~try {~~ |
  | 30 |  | ~~storage = window[type];~~ |
  | 31 |  | ~~var x = '\_\_storage\_test\_\_';~~ |
  | 32 |  | ~~storage.setItem(x, x);~~ |
  | 33 |  | ~~storage.removeItem(x);~~ |
  | 34 |  | ~~return true;~~ |
  | 35 |  | ~~}~~ |
  | 36 |  | ~~catch(e) {~~ |
  | 37 |  | ~~return e instanceof DOMException && (~~ |
  | 38 |  | ~~// everything except Firefox~~ |
  | 39 |  | ~~e.code === 22 ||~~ |
  | 40 |  | ~~// Firefox~~ |
  | 41 |  | ~~e.code === 1014 ||~~ |
  | 42 |  | ~~// test name field too, because code might not be present~~ |
  | 43 |  | ~~// everything except Firefox~~ |
  | 44 |  | ~~e.name === 'QuotaExceededError' ||~~ |
  | 45 |  | ~~// Firefox~~ |
  | 46 |  | ~~e.name === 'NS\_ERROR\_DOM\_QUOTA\_REACHED') &&~~ |
  | 47 |  | ~~// acknowledge QuotaExceededError only if there's something already stored~~ |
  | 48 |  | ~~(storage && storage.length !== 0);~~ |
  | 49 |  | ~~}~~ |
  | 50 |  | ~~}~~ |
  | 51 |  |  |
  | 52 |  | ~~/\*\*~~ |
  | 53 |  | ~~\* Remove the legacy cookie.~~ |
  | 54 |  | ~~\*/~~ |
  | 55 |  | ~~function removeCookie() {~~ |
  | 56 |  | ~~var expires = new Date( 0 ).toGMTString();~~ |
  | 57 |  | ~~document.cookie = legacyCookieName + '=;expires=' + expires + ';path=' + settings.legacy.path + ';domain=' + settings.legacy.domain;;~~ |
  | 58 |  | ~~}~~ |
  | 59 |  |  |
  | 60 |  | ~~/\*\*~~ |
  | 61 |  | ~~\* Convert the legacy cookie to local storage.~~ |
  | 62 |  | ~~\*/~~ |
  | 63 |  | ~~function cookiesToLocalStorage() {~~ |
  | 64 |  | ~~if ( ! settings.legacy ) {~~ |
  | 65 |  | ~~return;~~ |
  | 66 |  | ~~}~~ |
  | 67 |  |  |
  | 68 |  | ~~var legacyPosts = settings.legacy.posts;~~ |
  | 69 |  | ~~var l = legacyPosts.length;~~ |
  | 70 |  | ~~for ( var i = 0; i < l; i++ ) {~~ |
  | 71 |  | ~~addPost( legacyPosts[i] );~~ |
  | 72 |  | ~~}~~ |
  | 73 |  |  |
  | 74 |  | ~~removeCookie();~~ |
  | 75 |  | ~~}~~ |
  | 76 | 17 |  |
  | 77 | 18 | /\*\* |
  | […](/browser/last-viewed-posts/trunk/assets/index.js?rev=3062246#L196) | […](/browser/last-viewed-posts/tags/1.0.2/assets/index.js?rev=3205041#L137) |  |
  | 196 | 137 | } |
  | 197 | 138 |  |
  | 198 |  | ~~if ( ! storageAvailable( 'localStorage' ) ) {~~ |
  | 199 |  | ~~// User's browser does not support local storage.~~ |
  | 200 |  | ~~removeCookie();~~ |
  | 201 |  | ~~return;~~ |
  | 202 |  | ~~}~~ |
  | 203 |  | ~~cookiesToLocalStorage();~~ |
  | 204 | 139 | maybeAddCurrentPost(); |
  | 205 | 140 | displayRecentlyViewed(); |
* ## [last-viewed-posts/tags/1.0.2/inc/namespace.php](/changeset/3205041/last-viewed-posts/tags/1.0.2/inc/namespace.php "Show the changeset 3205041 restricted to last-viewed-posts/tags/1.0.2/inc/namespace.php")

  | [r3062246](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3062246#L119 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/tags/1.0.2/inc/namespace.php?rev=3205041#L119 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 119 | 119 |  |
  | 120 | 120 | /\*\* |
  | 121 |  | ~~\* Return array populated with data stored in legacy cookie~~ |
  | 122 |  | ~~\*~~ |
  | 123 |  | ~~\* @return array {~~ |
  | 124 |  | ~~\*     Data stored in legacy cookie.~~ |
  | 125 |  | ~~\*~~ |
  | 126 |  | ~~\*     @type array[] $posts  Associative array of post data.~~ |
  | 127 |  | ~~\*     @type string  $path   Path used when setting cookie.~~ |
  | 128 |  | ~~\*     @type string  $domain Domain used when setting cookie.~~ |
  | 129 |  | ~~\* } | false~~ |
  | 130 |  | ~~\*/~~ |
  | 131 |  | ~~function get\_legacy\_cookies() {~~ |
  | 132 |  | ~~if ( empty( $\_COOKIE['WP-LastViewedPosts'] ) ) {~~ |
  | 133 |  | ~~return false;~~ |
  | 134 |  | ~~}~~ |
  | 135 |  |  |
  | 136 |  | ~~$post\_ids = safe\_maybe\_unserialize( wp\_unslash( $\_COOKIE['WP-LastViewedPosts'] ) );~~ |
  | 137 |  | ~~$home\_url = wp\_parse\_url( home\_url( '/' ) );~~ |
  | 138 |  | ~~$return   = array(~~ |
  | 139 |  | ~~'path'   => ! empty( $home\_url['path'] ) ? $home\_url['path'] : '/',~~ |
  | 140 |  | ~~'domain' => ! empty( $home\_url['host'] ) ? ".{$home\_url['host']}" : '',~~ |
  | 141 |  | ~~'posts'  => array(),~~ |
  | 142 |  | ~~);~~ |
  | 143 |  |  |
  | 144 |  | ~~if ( ! is\_array( $post\_ids ) ) {~~ |
  | 145 |  | ~~return false;~~ |
  | 146 |  | ~~}~~ |
  | 147 |  |  |
  | 148 |  | ~~// Little hack to warm the caches.~~ |
  | 149 |  | ~~get\_posts(~~ |
  | 150 |  | ~~array(~~ |
  | 151 |  | ~~'include'     => $post\_ids,~~ |
  | 152 |  | ~~'numberposts' => number\_posts\_to\_display(),~~ |
  | 153 |  | ~~)~~ |
  | 154 |  | ~~);~~ |
  | 155 |  |  |
  | 156 |  | ~~foreach ( $post\_ids as $post\_id ) {~~ |
  | 157 |  | ~~$return['posts'][] = array(~~ |
  | 158 |  | ~~'id'    => (int) $post\_id,~~ |
  | 159 |  | ~~'url'   => get\_permalink( $post\_id ),~~ |
  | 160 |  | ~~'title' => wp\_strip\_all\_tags( get\_the\_title( $post\_id ) ),~~ |
  | 161 |  | ~~);~~ |
  | 162 |  | ~~}~~ |
  | 163 |  |  |
  | 164 |  | ~~return $return;~~ |
  | 165 |  | ~~}~~ |
  | 166 |  |  |
  | 167 |  | ~~function safe\_maybe\_unserialize( $data ) {~~ |
  | 168 |  | ~~if ( is\_serialized( $data ) ) { // Don't attempt to unserialize data that wasn't serialized going in.~~ |
  | 169 |  | ~~return @unserialize( trim( $data ), array( 'allowed\_classes' => false ) );~~ |
  | 170 |  | ~~}~~ |
  | 171 |  |  |
  | 172 |  | ~~return $data;~~ |
  | 173 |  | ~~}~~ |
  | 174 |  |  |
  | 175 |  | ~~/\*\*~~ |
  | 176 | 121 | \* Enqueue JavaScript and CSS for recent posts plugin. |
  | 177 | 122 | \*/ |
  | […](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3062246#L186) | […](/browser/last-viewed-posts/tags/1.0.2/inc/namespace.php?rev=3205041#L131) |  |
  | 186 | 131 |  |
  | 187 | 132 | $script\_settings = array( |
  | 188 |  | 'save\_url'       => is\_singular( include\_post\_types() ) && ! is\_home() && ! is\_front\_page(), |
  |  | 133 | 'save\_url'       => is\_singular( include\_post\_types() ) && ! is\_home() && ! is\_front\_page() && get\_post\_status() === 'publish', |
  | 189 | 134 | 'post\_id'        => get\_the\_ID(), |
  | 190 | 135 | 'post\_permalink' => get\_permalink(), |
  | 191 | 136 | 'post\_title'     => wp\_strip\_all\_tags( get\_the\_title() ), |
  | 192 | 137 | 'home\_url'       => home\_url(), |
  | 193 |  | ~~'legacy'         => get\_legacy\_cookies(),~~ |
  | 194 | 138 | 'expiry\_period'  => expiration\_period(), |
  | 195 | 139 | 'posts\_to\_store' => number\_posts\_to\_display(), |
* ## [last-viewed-posts/tags/1.0.2/last\_viewed\_posts.php](/changeset/3205041/last-viewed-posts/tags/1.0.2/last_viewed_posts.php "Show the changeset 3205041 restricted to last-viewed-posts/tags/1.0.2/last_viewed_posts.php")

  | [r3062246](/browser/last-viewed-posts/trunk/last_viewed_posts.php?rev=3062246#L5 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/tags/1.0.2/last_viewed_posts.php?rev=3205041#L5 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Description: Shows your site's visitors a personalized list of posts and pages they have recently viewed. |
  | 6 | 6 | Author: WPBeginner |
  | 7 |  | Version: 1.0.~~1~~ |
  |  | 7 | Version: 1.0.2 |
  | 8 | 8 | Author URI: https://www.wpbeginner.com/ |
  | 9 | 9 | Requires at least: 4.9 |
  | 10 |  | Tested up to: 6.~~5~~ |
  |  | 10 | Tested up to: 6.7.1 |
  | 11 | 11 | Requires PHP: 5.6 |
  | 12 | 12 | License: GPLv2 |
* ## [last-viewed-posts/tags/1.0.2/readme.txt](/changeset/3205041/last-viewed-posts/tags/1.0.2/readme.txt "Show the changeset 3205041 restricted to last-viewed-posts/tags/1.0.2/readme.txt")

  | [r3062252](/browser/last-viewed-posts/trunk/readme.txt?rev=3062252#L1 "Show revision 3062252 of this file in browser") | [r3205041](/browser/last-viewed-posts/tags/1.0.2/readme.txt?rev=3205041#L1 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Last Viewed Posts by WPBeginner === |
  | 2 |  | Contributors: noumaan, smub, ~~deb255~~ |
  | 3 |  | Stable tag: 1.0.~~1~~ |
  |  | 2 | Contributors: noumaan, smub, \_smartik\_ |
  |  | 3 | Stable tag: 1.0.2 |
  | 4 | 4 | Requires at least: 4.9 |
  | 5 |  | Tested up to: 6.~~5~~ |
  |  | 5 | Tested up to: 6.7.1 |
  | 6 | 6 | Requires PHP: 5.6 |
  | 7 | 7 | License: GPLv2 |
  | […](/browser/last-viewed-posts/trunk/readme.txt?rev=3062252#L65) | […](/browser/last-viewed-posts/tags/1.0.2/readme.txt?rev=3205041#L65) |  |
  | 65 | 65 | == Changelog == |
  | 66 | 66 |  |
  |  | 67 | = 1.0.2 = |
  |  | 68 | \* Remove the legacy cookie based code. |
  |  | 69 | \* Test on WordPress 6.7.1. |
  |  | 70 |  |
  | 67 | 71 | = 1.0.1 = |
  | 68 | 72 | \* Fix for legacy widget settings. |
* ## [last-viewed-posts/trunk/assets/index.js](/changeset/3205041/last-viewed-posts/trunk/assets/index.js "Show the changeset 3205041 restricted to last-viewed-posts/trunk/assets/index.js")

  | [r3062246](/browser/last-viewed-posts/trunk/assets/index.js?rev=3062246#L15 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/trunk/assets/index.js?rev=3205041#L15 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | (amViewLastPosts.script = function( settings, window, document ) { |
  | 16 | 16 | var localStorageName = 'amViewLastPosts.recentPosts'; |
  | 17 |  | ~~var legacyCookieName = 'WP-LastViewedPosts';~~ |
  | 18 |  |  |
  | 19 |  | ~~/\*\*~~ |
  | 20 |  | ~~\* Determine if storage API is available.~~ |
  | 21 |  | ~~\*~~ |
  | 22 |  | ~~\* Source: https://developer.mozilla.org/en-US/docs/Web/API/Web\_Storage\_API/Using\_the\_Web\_Storage\_API~~ |
  | 23 |  | ~~\*~~ |
  | 24 |  | ~~\* @param {string} type Storage type to check for.~~ |
  | 25 |  | ~~\* @returns {boolean} Whether storage is available.~~ |
  | 26 |  | ~~\*/~~ |
  | 27 |  | ~~function storageAvailable(type) {~~ |
  | 28 |  | ~~var storage;~~ |
  | 29 |  | ~~try {~~ |
  | 30 |  | ~~storage = window[type];~~ |
  | 31 |  | ~~var x = '\_\_storage\_test\_\_';~~ |
  | 32 |  | ~~storage.setItem(x, x);~~ |
  | 33 |  | ~~storage.removeItem(x);~~ |
  | 34 |  | ~~return true;~~ |
  | 35 |  | ~~}~~ |
  | 36 |  | ~~catch(e) {~~ |
  | 37 |  | ~~return e instanceof DOMException && (~~ |
  | 38 |  | ~~// everything except Firefox~~ |
  | 39 |  | ~~e.code === 22 ||~~ |
  | 40 |  | ~~// Firefox~~ |
  | 41 |  | ~~e.code === 1014 ||~~ |
  | 42 |  | ~~// test name field too, because code might not be present~~ |
  | 43 |  | ~~// everything except Firefox~~ |
  | 44 |  | ~~e.name === 'QuotaExceededError' ||~~ |
  | 45 |  | ~~// Firefox~~ |
  | 46 |  | ~~e.name === 'NS\_ERROR\_DOM\_QUOTA\_REACHED') &&~~ |
  | 47 |  | ~~// acknowledge QuotaExceededError only if there's something already stored~~ |
  | 48 |  | ~~(storage && storage.length !== 0);~~ |
  | 49 |  | ~~}~~ |
  | 50 |  | ~~}~~ |
  | 51 |  |  |
  | 52 |  | ~~/\*\*~~ |
  | 53 |  | ~~\* Remove the legacy cookie.~~ |
  | 54 |  | ~~\*/~~ |
  | 55 |  | ~~function removeCookie() {~~ |
  | 56 |  | ~~var expires = new Date( 0 ).toGMTString();~~ |
  | 57 |  | ~~document.cookie = legacyCookieName + '=;expires=' + expires + ';path=' + settings.legacy.path + ';domain=' + settings.legacy.domain;;~~ |
  | 58 |  | ~~}~~ |
  | 59 |  |  |
  | 60 |  | ~~/\*\*~~ |
  | 61 |  | ~~\* Convert the legacy cookie to local storage.~~ |
  | 62 |  | ~~\*/~~ |
  | 63 |  | ~~function cookiesToLocalStorage() {~~ |
  | 64 |  | ~~if ( ! settings.legacy ) {~~ |
  | 65 |  | ~~return;~~ |
  | 66 |  | ~~}~~ |
  | 67 |  |  |
  | 68 |  | ~~var legacyPosts = settings.legacy.posts;~~ |
  | 69 |  | ~~var l = legacyPosts.length;~~ |
  | 70 |  | ~~for ( var i = 0; i < l; i++ ) {~~ |
  | 71 |  | ~~addPost( legacyPosts[i] );~~ |
  | 72 |  | ~~}~~ |
  | 73 |  |  |
  | 74 |  | ~~removeCookie();~~ |
  | 75 |  | ~~}~~ |
  | 76 | 17 |  |
  | 77 | 18 | /\*\* |
  | […](/browser/last-viewed-posts/trunk/assets/index.js?rev=3062246#L196) | […](/browser/last-viewed-posts/trunk/assets/index.js?rev=3205041#L137) |  |
  | 196 | 137 | } |
  | 197 | 138 |  |
  | 198 |  | ~~if ( ! storageAvailable( 'localStorage' ) ) {~~ |
  | 199 |  | ~~// User's browser does not support local storage.~~ |
  | 200 |  | ~~removeCookie();~~ |
  | 201 |  | ~~return;~~ |
  | 202 |  | ~~}~~ |
  | 203 |  | ~~cookiesToLocalStorage();~~ |
  | 204 | 139 | maybeAddCurrentPost(); |
  | 205 | 140 | displayRecentlyViewed(); |
* ## [last-viewed-posts/trunk/inc/namespace.php](/changeset/3205041/last-viewed-posts/trunk/inc/namespace.php "Show the changeset 3205041 restricted to last-viewed-posts/trunk/inc/namespace.php")

  | [r3062246](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3062246#L119 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3205041#L119 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 119 | 119 |  |
  | 120 | 120 | /\*\* |
  | 121 |  | ~~\* Return array populated with data stored in legacy cookie~~ |
  | 122 |  | ~~\*~~ |
  | 123 |  | ~~\* @return array {~~ |
  | 124 |  | ~~\*     Data stored in legacy cookie.~~ |
  | 125 |  | ~~\*~~ |
  | 126 |  | ~~\*     @type array[] $posts  Associative array of post data.~~ |
  | 127 |  | ~~\*     @type string  $path   Path used when setting cookie.~~ |
  | 128 |  | ~~\*     @type string  $domain Domain used when setting cookie.~~ |
  | 129 |  | ~~\* } | false~~ |
  | 130 |  | ~~\*/~~ |
  | 131 |  | ~~function get\_legacy\_cookies() {~~ |
  | 132 |  | ~~if ( empty( $\_COOKIE['WP-LastViewedPosts'] ) ) {~~ |
  | 133 |  | ~~return false;~~ |
  | 134 |  | ~~}~~ |
  | 135 |  |  |
  | 136 |  | ~~$post\_ids = safe\_maybe\_unserialize( wp\_unslash( $\_COOKIE['WP-LastViewedPosts'] ) );~~ |
  | 137 |  | ~~$home\_url = wp\_parse\_url( home\_url( '/' ) );~~ |
  | 138 |  | ~~$return   = array(~~ |
  | 139 |  | ~~'path'   => ! empty( $home\_url['path'] ) ? $home\_url['path'] : '/',~~ |
  | 140 |  | ~~'domain' => ! empty( $home\_url['host'] ) ? ".{$home\_url['host']}" : '',~~ |
  | 141 |  | ~~'posts'  => array(),~~ |
  | 142 |  | ~~);~~ |
  | 143 |  |  |
  | 144 |  | ~~if ( ! is\_array( $post\_ids ) ) {~~ |
  | 145 |  | ~~return false;~~ |
  | 146 |  | ~~}~~ |
  | 147 |  |  |
  | 148 |  | ~~// Little hack to warm the caches.~~ |
  | 149 |  | ~~get\_posts(~~ |
  | 150 |  | ~~array(~~ |
  | 151 |  | ~~'include'     => $post\_ids,~~ |
  | 152 |  | ~~'numberposts' => number\_posts\_to\_display(),~~ |
  | 153 |  | ~~)~~ |
  | 154 |  | ~~);~~ |
  | 155 |  |  |
  | 156 |  | ~~foreach ( $post\_ids as $post\_id ) {~~ |
  | 157 |  | ~~$return['posts'][] = array(~~ |
  | 158 |  | ~~'id'    => (int) $post\_id,~~ |
  | 159 |  | ~~'url'   => get\_permalink( $post\_id ),~~ |
  | 160 |  | ~~'title' => wp\_strip\_all\_tags( get\_the\_title( $post\_id ) ),~~ |
  | 161 |  | ~~);~~ |
  | 162 |  | ~~}~~ |
  | 163 |  |  |
  | 164 |  | ~~return $return;~~ |
  | 165 |  | ~~}~~ |
  | 166 |  |  |
  | 167 |  | ~~function safe\_maybe\_unserialize( $data ) {~~ |
  | 168 |  | ~~if ( is\_serialized( $data ) ) { // Don't attempt to unserialize data that wasn't serialized going in.~~ |
  | 169 |  | ~~return @unserialize( trim( $data ), array( 'allowed\_classes' => false ) );~~ |
  | 170 |  | ~~}~~ |
  | 171 |  |  |
  | 172 |  | ~~return $data;~~ |
  | 173 |  | ~~}~~ |
  | 174 |  |  |
  | 175 |  | ~~/\*\*~~ |
  | 176 | 121 | \* Enqueue JavaScript and CSS for recent posts plugin. |
  | 177 | 122 | \*/ |
  | […](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3062246#L186) | […](/browser/last-viewed-posts/trunk/inc/namespace.php?rev=3205041#L131) |  |
  | 186 | 131 |  |
  | 187 | 132 | $script\_settings = array( |
  | 188 |  | 'save\_url'       => is\_singular( include\_post\_types() ) && ! is\_home() && ! is\_front\_page(), |
  |  | 133 | 'save\_url'       => is\_singular( include\_post\_types() ) && ! is\_home() && ! is\_front\_page() && get\_post\_status() === 'publish', |
  | 189 | 134 | 'post\_id'        => get\_the\_ID(), |
  | 190 | 135 | 'post\_permalink' => get\_permalink(), |
  | 191 | 136 | 'post\_title'     => wp\_strip\_all\_tags( get\_the\_title() ), |
  | 192 | 137 | 'home\_url'       => home\_url(), |
  | 193 |  | ~~'legacy'         => get\_legacy\_cookies(),~~ |
  | 194 | 138 | 'expiry\_period'  => expiration\_period(), |
  | 195 | 139 | 'posts\_to\_store' => number\_posts\_to\_display(), |
* ## [last-viewed-posts/trunk/last\_viewed\_posts.php](/changeset/3205041/last-viewed-posts/trunk/last_viewed_posts.php "Show the changeset 3205041 restricted to last-viewed-posts/trunk/last_viewed_posts.php")

  | [r3062246](/browser/last-viewed-posts/trunk/last_viewed_posts.php?rev=3062246#L5 "Show revision 3062246 of this file in browser") | [r3205041](/browser/last-viewed-posts/trunk/last_viewed_posts.php?rev=3205041#L5 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Description: Shows your site's visitors a personalized list of posts and pages they have recently viewed. |
  | 6 | 6 | Author: WPBeginner |
  | 7 |  | Version: 1.0.~~1~~ |
  |  | 7 | Version: 1.0.2 |
  | 8 | 8 | Author URI: https://www.wpbeginner.com/ |
  | 9 | 9 | Requires at least: 4.9 |
  | 10 |  | Tested up to: 6.~~5~~ |
  |  | 10 | Tested up to: 6.7.1 |
  | 11 | 11 | Requires PHP: 5.6 |
  | 12 | 12 | License: GPLv2 |
* ## [last-viewed-posts/trunk/readme.txt](/changeset/3205041/last-viewed-posts/trunk/readme.txt "Show the changeset 3205041 restricted to last-viewed-posts/trunk/readme.txt")

  | [r3062252](/browser/last-viewed-posts/trunk/readme.txt?rev=3062252#L1 "Show revision 3062252 of this file in browser") | [r3205041](/browser/last-viewed-posts/trunk/readme.txt?rev=3205041#L1 "Show revision 3205041 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Last Viewed Posts by WPBeginner === |
  | 2 |  | Contributors: noumaan, smub, ~~deb255~~ |
  | 3 |  | Stable tag: 1.0.~~1~~ |
  |  | 2 | Contributors: noumaan, smub, \_smartik\_ |
  |  | 3 | Stable tag: 1.0.2 |
  | 4 | 4 | Requires at least: 4.9 |
  | 5 |  | Tested up to: 6.~~5~~ |
  |  | 5 | Tested up to: 6.7.1 |
  | 6 | 6 | Requires PHP: 5.6 |
  | 7 | 7 | License: GPLv2 |
  | […](/browser/last-viewed-posts/trunk/readme.txt?rev=3062252#L65) | […](/browser/last-viewed-posts/trunk/readme.txt?rev=3205041#L65) |  |
  | 65 | 65 | == Changelog == |
  | 66 | 66 |  |
  |  | 67 | = 1.0.2 = |
  |  | 68 | \* Remove the legacy cookie based code. |
  |  | 69 | \* Test on WordPress 6.7.1. |
  |  | 70 |  |
  | 67 | 71 | = 1.0.1 = |
  | 68 | 72 | \* Fix for legacy widget settings. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3205041)
* [Zip Archive](?format=zip&new=3205041)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_8f9f93ae_20250114_224643.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Last Viewed Posts by WPBeginner <= 1.0.1 - Unauthenticated Sensitive Information Exposure

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Last Viewed Posts by WPBeginner <= 1.0.1 - Unauthenticated Sensitive Information Exposure

5.3

**Improper Access Control**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-12294](https://www.cve.org/CVERecord?id=CVE-2024-12294) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | December 10, 2024 |
| Last Updated | December 11, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Last Viewed Posts by WPBeginner plugin for WordPress is vulnerable to Sensitive Information Exposure in all versions up to, and including, 1.0.1 via the 'get\_legacy\_cookies' function. This makes it possible for unauthenticated attackers to extract sensitive data including titles and permalinks of private, password-protected, pending, and draft posts.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/last-viewed-posts/trunk/inc/namespace.php#L131)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3205041/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Flast-viewed-posts%2Flast-viewed-posts-by-wpbeginner-101-unauthenticated-sensitive-information-exposure&t=Last%20Viewed%20Posts%20by%20WPBeginner%20%3C%3D%201.0.1%20-%20Unauthenticated%20Sensitive%20Information%20Exposure "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Flast-viewed-posts%2Flast-viewed-posts-by-wpbeginner-101-unauthenticated-sensitive-information-exposure&text=Last%20Viewed%20Posts%20by%20WPBeginner%20%3C%3D%201.0.1%20-%20Unauthenticated%20Sensitive%20Information%20Exposure "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Flast-viewed-posts%2Flast-viewed-posts-by-wpbeginner-101-unauthenticated-sensitive-information-exposure "LinkedIn")
Email

## Vulnerability Details for Last Viewed Posts by WPBeginner

#### [Last Viewed Posts by WPBeginner](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/last-viewed-posts)

| Software Type | Plugin |
| --- | --- |
| Software Slug | last-viewed-posts [(view on wordpress.org)](https://wordpress.org/plugins/last-viewed-posts) |
| Patched? | Yes |
| Remediation | Update to version 1.0.2, or a newer patched version |
| Affected Version | * <= 1.0.1 |
| Patched Version | * 1.0.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


