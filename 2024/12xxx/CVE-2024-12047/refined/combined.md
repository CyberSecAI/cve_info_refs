=== Content from plugins.trac.wordpress.org_7e99e76e_20250114_182126.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3213738)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3213737 "Changeset 3213737")
* [Next Changeset](/changeset/3213739 "Changeset 3213739") →

---

# Changeset 3213738

Timestamp:
12/27/2024 10:43:51 AM
([3 weeks](/timeline?from=2024-12-27T10%3A43%3A51Z&precision=second "See timeline at 12/27/2024 10:43:51 AM") ago)

Author:
smartersite
Message:
# 6.30.04

* Improved UI in Excludes Popup
* Fixed Replace Code for 480w
* Removed Preload for Logged In Users
* Integrations Cleanup
* Removed Download\_URL and Replaced with WP\_Remote\_Get
* Fixed Sanitize\_URL for Caching
* Improved Caching Logic
* Improved Video Source Lazy Loading
* Improved CSS Critical Logic
* Added Improved Excludes Logic
* Upgraded DelayJS Logic
* Added Logic For Blocked Page Speed Tests

Location:
[wp-compress-image-optimizer/tags/6.30.04](/browser/wp-compress-image-optimizer/tags/6.30.04?rev=3213738)
Files:

701 added

* [.](/browser/wp-compress-image-optimizer/tags/6.30.04?rev=3213738 "Show entry in browser")
  (added)
* [addons](/browser/wp-compress-image-optimizer/tags/6.30.04/addons?rev=3213738 "Show entry in browser")
  (added)
* [addons/bgLazy](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/bgLazy?rev=3213738 "Show entry in browser")
  (added)
* [addons/bgLazy/bgLazy.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/bgLazy/bgLazy.class.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/cache](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cache?rev=3213738 "Show entry in browser")
  (added)
* [addons/cache/advancedCache.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cache/advancedCache.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/cache/cacheHtml.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cache/cacheHtml.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/cdn](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cdn?rev=3213738 "Show entry in browser")
  (added)
* [addons/cdn/cdn-rewrite.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cdn/cdn-rewrite.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/cdn/rewriteLogic.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cdn/rewriteLogic.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/cf-sdk](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cf-sdk?rev=3213738 "Show entry in browser")
  (added)
* [addons/cf-sdk/cf-sdk.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/cf-sdk/cf-sdk.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/criticalCss](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/criticalCss?rev=3213738 "Show entry in browser")
  (added)
* [addons/criticalCss/criticalCss.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/criticalCss/criticalCss.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/legacy](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/legacy?rev=3213738 "Show entry in browser")
  (added)
* [addons/legacy/compress.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/legacy/compress.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/local](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/local?rev=3213738 "Show entry in browser")
  (added)
* [addons/local/delivery.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/local/delivery.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/minify](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/minify?rev=3213738 "Show entry in browser")
  (added)
* [addons/minify/html.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/minify/html.php?rev=3213738 "Show entry in browser")
  (added)
* [addons/offloading](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/offloading?rev=3213738 "Show entry in browser")
  (added)
* [addons/offloading/offloading.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/addons/offloading/offloading.class.php?rev=3213738 "Show entry in browser")
  (added)
* [assets](/browser/wp-compress-image-optimizer/tags/6.30.04/assets?rev=3213738 "Show entry in browser")
  (added)
* [assets/crying.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/crying.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin-bar.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin-bar.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin-bar.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin-bar.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin-bar.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin-bar.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin-bar.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin-bar.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin-bar.min.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin-bar.min.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.media-library.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.media-library.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.media-library.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.media-library.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.media-library.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.media-library.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.styles.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.styles.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.styles.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.styles.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin.styles.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin.styles.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin\_notices.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin_notices.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin\_notices.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin_notices.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin\_notices.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin_notices.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/admin\_notices.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/admin_notices.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/checkbox.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/checkbox.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/checkbox.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/checkbox.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/checkbox.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/checkbox.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/lazy.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/lazy.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/lazy.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/lazy.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/lazy.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/lazy.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/menu.wp.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/menu.wp.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/menu.wp.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/menu.wp.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/menu.wp.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/menu.wp.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/multisite.style.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/multisite.style.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/multisite.style.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/multisite.style.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/multisite.style.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/multisite.style.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/settings\_page.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/settings_page.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/settings\_page.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/settings_page.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/css/settings\_page.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/css/settings_page.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaBlack.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaBlack.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaBold.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaBold.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaLight.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaLight.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaRegular.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaRegular.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaSemibold.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaSemibold.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/fonts/proxima/ProximaNovaThin.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/fonts/proxima/ProximaNovaThin.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk/average-savings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk/average-savings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk/compression-complete.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk/compression-complete.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk/original-images.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk/original-images.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk/total-images.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk/total-images.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/bulk/total-savings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/bulk/total-savings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/config.json](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/config.json?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/animation.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/animation.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/animation.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/animation.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-codes.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-codes.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-codes.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-codes.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-embedded.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-embedded.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-embedded.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-embedded.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-ie7-codes.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-ie7-codes.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-ie7-codes.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-ie7-codes.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-ie7.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-ie7.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello-ie7.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello-ie7.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/css/fontello.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/css/fontello.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/demo.html](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/demo.html?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font/fontello.eot](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font/fontello.eot?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font/fontello.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font/fontello.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font/fontello.ttf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font/fontello.ttf?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font/fontello.woff](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font/fontello.woff?rev=3213738 "Show entry in browser")
  (added)
* [assets/icons/font/fontello.woff2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/icons/font/fontello.woff2?rev=3213738 "Show entry in browser")
  (added)
* [assets/images](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/arrow-improvement.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/arrow-improvement.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bolt-after.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bolt-after.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/broken-placeholder.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/broken-placeholder.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk-compress-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk-compress-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk-restore-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk-restore-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/circle.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/circle.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/compress-complete.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/compress-complete.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/quality.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/quality.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/restore-completed-image.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/restore-completed-image.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/restore-completed-image\_opt.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/restore-completed-image_opt.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/restore-completed-logo.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/restore-completed-logo.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/restore-completed-logo.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/restore-completed-logo.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/restore-sparkles.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/restore-sparkles.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/saved.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/saved.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/bulk/webp.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/bulk/webp.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/cog.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/cog.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/compatibility.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/compatibility.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/confirmed.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/confirmed.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/credits.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/credits.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/error.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/error.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/exclude-lazy.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/exclude-lazy.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/fireworks.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/fireworks.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/i\_icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/i_icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-after-optimization.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-after-optimization.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-cdn-custom.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-cdn-custom.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-configure.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-configure.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-custom-cdn.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-custom-cdn.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-exclude-from-cdn.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-exclude-from-cdn.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-exclude-list.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-exclude-list.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-geolocation-popup.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-geolocation-popup.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-geolocation.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-geolocation.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-original-size.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-original-size.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/icon-total-images.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/icon-total-images.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-compress-hover.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-compress-hover.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-compress.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-compress.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-exclude-hover.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-exclude-hover.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-include-hover.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-include-hover.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-include.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-include.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/icon-restore-hover.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/icon-restore-hover.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/logo-compressed.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/logo-compressed.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/logo-excluded.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/logo-excluded.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/logo-not-compressed.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/logo-not-compressed.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/no-credits.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/no-credits.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/popup-background-transparent.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/popup-background-transparent.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/popup-background.jpg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/popup-background.jpg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/popup-bottom-background.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/popup-bottom-background.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/legacy/restore-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/legacy/restore-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live-optimization-btn.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live-optimization-btn.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live-optimization-popup.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live-optimization-popup.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/background.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/background.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/bars.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/bars.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/bolt-icon.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/bolt-icon.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/bolt-icon\_opt.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/bolt-icon_opt.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/error-v2.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/error-v2.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/error-v2\_opt.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/error-v2_opt.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/error.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/error.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/live.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/live.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/live.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/live.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/rocket.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/rocket.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/wp-compress-logo-white.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/wp-compress-logo-white.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/live/wp-compress-logo.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/live/wp-compress-logo.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/local-optimization-btn.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/local-optimization-btn.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/local-optimization-popup.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/local-optimization-popup.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/lock-white.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/lock-white.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/logo](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/logo?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/logo-wpc.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/logo-wpc.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/logo-wpc.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/logo-wpc.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/logo/blue-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/logo/blue-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/logo/grey-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/logo/grey-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/main-logo.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/main-logo.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cache\_exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cache_exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cache\_fully\_active.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cache_fully_active.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cache\_not\_generated.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cache_not_generated.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cache\_off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cache_off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cdn\_exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cdn_exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cdn\_fully\_active.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cdn_fully_active.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cdn\_not\_generated.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cdn_not_generated.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/cdn\_off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/cdn_off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/css\_exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/css_exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/css\_fully\_active.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/css_fully_active.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/css\_not\_generated.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/css_not_generated.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/css\_off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/css_off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/images\_exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/images_exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/images\_fully\_active.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/images_fully_active.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/images\_not\_generated.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/images_not_generated.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/images\_off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/images_off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/js\_exclude.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/js_exclude.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/js\_fully\_active.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/js_fully_active.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/js\_not\_generated.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/js_not_generated.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/optimization\_page\_icons/js\_off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/optimization_page_icons/js_off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/projected-alert.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/projected-alert.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/projected-ok.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/projected-ok.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/rocket.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/rocket.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/rocket\_opt.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/rocket_opt.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/set-default.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/set-default.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/shield.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/shield.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/images/star.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/images/star.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/admin-bar.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/admin-bar.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/admin-bar.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/admin-bar.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/admin-notices.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/admin-notices.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/admin-notices.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/admin-notices.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/charts](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/charts?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/charts/chartsjs.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/charts/chartsjs.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/charts/chartsjs.min.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/charts/chartsjs.min.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/check-bulk-running.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/check-bulk-running.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/check-bulk-running.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/check-bulk-running.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/live-settings.admin.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/live-settings.admin.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/live-settings.admin.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/live-settings.admin.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/lottie](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/lottie?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/lottie/lottie-player.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/lottie/lottie-player.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-filters.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-filters.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-filters.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-filters.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-library-actions.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-library-actions.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-library-actions.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-library-actions.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-library-bulk.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-library-bulk.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/media-library-bulk.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/media-library-bulk.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/mu-settings.admin.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/mu-settings.admin.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/mu-settings.admin.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/mu-settings.admin.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/select-modes.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/select-modes.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/select-modes.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/select-modes.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/settings.admin.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/settings.admin.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/settings.admin.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/settings.admin.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/sweetalert](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/sweetalert?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/sweetalert/sweetalert2.all.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/sweetalert/sweetalert2.all.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/sweetalert/sweetalert2.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/sweetalert/sweetalert2.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/visitor\_mode.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/visitor_mode.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/admin/visitor\_mode.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/admin/visitor_mode.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/circle-progress](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/circle-progress?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/circle-progress/circle-progress.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/circle-progress/circle-progress.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/circle-progress/circle-progress.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/circle-progress/circle-progress.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/connect.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/connect.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/connect.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/connect.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.adaptive.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.adaptive.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.adaptive.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.adaptive.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.adaptive.pixel.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.adaptive.pixel.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.adaptive.pixel.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.adaptive.pixel.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local-lazy.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local-lazy.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local-lazy.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local-lazy.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local-lazy.pixel.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local-lazy.pixel.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local-lazy.pixel.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local-lazy.pixel.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local.pixel.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local.pixel.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.local.pixel.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.local.pixel.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.pixel.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.pixel.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/dist/optimizer.pixel.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/dist/optimizer.pixel.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/inlined-delay.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/inlined-delay.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/inlined-delay.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/inlined-delay.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/mu.connect.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/mu.connect.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/mu.connect.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/mu.connect.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/cdn](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/cdn?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/cdn/only-optimizer.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/cdn/only-optimizer.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/cdn/only-optimizer.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/cdn/only-optimizer.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/cdn/optimizer-functions.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/cdn/optimizer-functions.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/cdn/optimizer-functions.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/cdn/optimizer-functions.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/delayJS-new.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/delayJS-new.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/delayJS-new.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/delayJS-new.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/delayJS.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/delayJS.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/delayJS.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/delayJS.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/isMobile.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/isMobile.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/isMobile.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/isMobile.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/local](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/local?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/local/lazy.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/local/lazy.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/local/lazy.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/local/lazy.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/local/script.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/local/script.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/local/script.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/local/script.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/only-optimizer-adaptive.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/only-optimizer-adaptive.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/only-optimizer-adaptive.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/only-optimizer-adaptive.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/pixelRatio.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/pixelRatio.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/src/pixelRatio.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/src/pixelRatio.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/upgrade.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/upgrade.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/js/upgrade.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/js/upgrade.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/advanced-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/advanced-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/arrow-down.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/arrow-down.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/arrow-up.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/arrow-up.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/blur-bg.jpg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/blur-bg.jpg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/blur-bg.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/blur-bg.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/bolt.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/bolt.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/btn-arrow.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/btn-arrow.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/checkbox-link.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/checkbox-link.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/desktop-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/desktop-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/error.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/error.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/falling-star.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/falling-star.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/gps-after.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/gps-after.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/gps-before.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/gps-before.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/green-check.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/green-check.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/icon-1.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/icon-1.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/info.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/info.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/magic-wand.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/magic-wand.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/mobile-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/mobile-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/projected-stats.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/projected-stats.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/refresh.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/refresh.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/small-arrow.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/small-arrow.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/stats-speed.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/stats-speed.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/tool.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/tool.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/turtle.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/turtle.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/unlock-24-7.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/unlock-24-7.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/unlock-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/unlock-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/up-pro.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/up-pro.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/wl-popup-img.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/wl-popup-img.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/lite/images/wohoo.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lite/images/wohoo.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/lottie-icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lottie-icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/lottie-icons/done.json](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/lottie-icons/done.json?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect/bg.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect/bg.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect/bg.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect/bg.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect/hill.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect/hill.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect/middle.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect/middle.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/connect/tree.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/connect/tree.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/disconnect-x.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/disconnect-x.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/disconnect.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/disconnect.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/gear-blue.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/gear-blue.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/gear-grey.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/gear-grey.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/gear-white.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/gear-white.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/gear.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/gear.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/link.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/link.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-bulk-off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-bulk-off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-bulk.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-bulk.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-default-settings-off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-default-settings-off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-default-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-default-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-manage-website-off.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-manage-website-off.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/mu-manage-website.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/mu-manage-website.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/new-celebration.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/new-celebration.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/not-connected-v2.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/not-connected-v2.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/mu/images/not-connected.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/mu/images/not-connected.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/preparing.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/preparing.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/purple-confetti.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/purple-confetti.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/refresh.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/refresh.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/stats-box-placeholder.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/stats-box-placeholder.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-borderless.min.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-noir.min.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.min.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.min.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/tooltipster.bundle.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/tooltipster.bundle.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/tooltipster.bundle.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/tooltipster.bundle.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/tooltipster.main.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/tooltipster.main.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/css/tooltipster.main.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/css/tooltipster.main.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/SVG](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/SVG?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.min.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/SVG/tooltipster-SVG.min.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/sideTip](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/sideTip?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/sideTip/themes](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/sideTip/themes?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/sideTip/themes/wpcompress.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/sideTip/themes/wpcompress.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/plugins/tooltipster/sideTip/themes/wpcompress.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/plugins/tooltipster/sideTip/themes/wpcompress.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/tooltipster.bundle.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/tooltipster.bundle.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/tooltipster.bundle.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/tooltipster.bundle.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/tooltipster.main.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/tooltipster.main.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/tooltip/js/tooltipster.main.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/tooltip/js/tooltipster.main.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/Circular-Std-Bold.ttf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/Circular-Std-Bold.ttf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/Circular-Std-Book.ttf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/Circular-Std-Book.ttf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/Proxima-Nova-Bold.otf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/Proxima-Nova-Bold.otf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/Proxima-Nova-Medium.otf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/Proxima-Nova-Medium.otf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/Proxima-Nova-Semibold.ttf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/Proxima-Nova-Semibold.ttf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/fonts/ProximaNova-Regular.otf](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/fonts/ProximaNova-Regular.otf?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/accordion-m.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/accordion-m.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/accordion-p.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/accordion-p.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/calendar.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/calendar.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/cdn-domain.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/cdn-domain.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/check.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/check.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/configure.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/configure.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/dd-arrow.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/dd-arrow.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/document.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/document.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/exclude-list.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/exclude-list.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/geo-location.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/geo-location.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/headset.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/headset.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/lock.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/lock.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/notification-light.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/notification-light.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/notification.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/notification.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/popup-triangle.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/popup-triangle.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/popup-triangle.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/popup-triangle.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/remove.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/remove.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/signal.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/signal.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/assets/images/switcher-ball.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/assets/images/switcher-ball.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/custom.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/custom.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/custom.min.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/custom.min.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/custom.scss](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/custom.scss?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/style.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/style.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/style.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/style.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/style.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/style.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/css/style.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/css/style.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/popups.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/popups.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/popups.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/popups.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/scripts.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/scripts.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/scripts.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/scripts.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/tooltip.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/tooltip.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v2/js/tooltip.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v2/js/tooltip.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/custom.min.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/custom.min.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/custom.min.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/custom.min.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/custom.scss](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/custom.scss?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/style.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/style.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/style.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/style.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/css/style.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/css/style.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/js/slider.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/js/slider.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v3/js/slider.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v3/js/slider.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/css/style.css](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/css/style.css?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/css/style.css.map](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/css/style.css.map?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/css/style.less](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/css/style.less?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/desktop-score.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/desktop-score.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/magnifying-glass-solid.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/magnifying-glass-solid.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/mobile-score.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/mobile-score.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/select\_pages\_icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/select_pages_icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/select\_posts\_icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/select_posts_icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/select\_product\_icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/select_product_icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/icons/thunder-icon-white.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/icons/thunder-icon-white.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/24bubble.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/24bubble.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/24monitor.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/24monitor.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/aperture.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/aperture.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/background.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/background.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/caching](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/caching?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/caching/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/caching/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/caching/tab-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/caching/tab-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/caret-down-v2.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/caret-down-v2.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/caret-down.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/caret-down.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery-options.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery-options.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/css.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/css.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/font.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/font.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/gif.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/gif.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/jpg.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/jpg.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/js.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/js.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/png.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/png.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cdn-delivery/svg.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cdn-delivery/svg.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/check.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/check.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/cog.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/cog.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/css-optimization](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/css-optimization?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/css-optimization/css-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/css-optimization/css-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/css-optimization/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/css-optimization/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/floppy.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/floppy.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/html-optimization](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/html-optimization?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/html-optimization/html-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/html-optimization/html-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/html-optimization/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/html-optimization/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/icon-gray.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/icon-gray.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/icon\_check.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/icon_check.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/image-optimization](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/image-optimization?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/image-optimization/image-optimization.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/image-optimization/image-optimization.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/image-optimization/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/image-optimization/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/javascript-optimization](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/javascript-optimization?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/javascript-optimization/js-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/javascript-optimization/js-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/javascript-optimization/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/javascript-optimization/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/lite-check.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/lite-check.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/lite-connect-popup.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/lite-connect-popup.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/loading-icon-media.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/loading-icon-media.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/lock-grey.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/lock-grey.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/logo.png](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/logo.png?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/main-logo.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/main-logo.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/dashboard.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/dashboard.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/image-optimization.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/image-optimization.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/other.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/other.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/rocket.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/rocket.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/star-shooting-duotone.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/star-shooting-duotone.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/ux.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/ux.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/menu-icons/www.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/menu-icons/www.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/optimize-sparkle.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/optimize-sparkle.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/option-locked-gray.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/option-locked-gray.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/option-locked.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/option-locked.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/other-optimization](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/other-optimization?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/other-optimization/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/other-optimization/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/other-optimization/tab-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/other-optimization/tab-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/pages\_optimized.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/pages_optimized.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/alert-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/alert-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/compatibility-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/compatibility-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/info-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/info-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/selectMode](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/selectMode?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/selectMode/advanced-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/selectMode/advanced-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/selectMode/option-1.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/selectMode/option-1.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/selectMode/save.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/selectMode/save.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/popups/support-btn.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/popups/support-btn.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/preset-modes.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/preset-modes.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings/optimization-level.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings/optimization-level.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings/optimize-on-upload.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings/optimize-on-upload.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings/real-time-optimization.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings/real-time-optimization.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/recommended-settings/recommended-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/recommended-settings/recommended-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/refresh-page-option.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/refresh-page-option.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/shield.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/shield.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/backup-local.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/backup-local.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/caching.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/caching.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/on-upload.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/on-upload.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/optimization-level.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/optimization-level.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/real-time.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/real-time.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/recommended.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/recommended.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/tab-icons/ux-settings.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/tab-icons/ux-settings.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/three-dots.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/three-dots.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/ux-settings](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/ux-settings?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/ux-settings/menu-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/ux-settings/menu-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/ux-settings/tab-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/ux-settings/tab-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/warning-icon.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/warning-icon.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/warning.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/warning.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/wpc-logo.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/wpc-logo.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/images/x.svg](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/images/x.svg?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/lite.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/lite.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/lite.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/lite.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/popups.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/popups.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/popups.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/popups.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/scripts.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/scripts.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/scripts.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/scripts.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/tabs.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/tabs.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/tabs.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/tabs.min.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/tooltip.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/tooltip.js?rev=3213738 "Show entry in browser")
  (added)
* [assets/v4/js/tooltip.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/assets/v4/js/tooltip.min.js?rev=3213738 "Show entry in browser")
  (added)
* [classes](/browser/wp-compress-image-optimizer/tags/6.30.04/classes?rev=3213738 "Show entry in browser")
  (added)
* [classes/ajax.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/ajax.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/amp.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/amp.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/cache-integrations.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/cache-integrations.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/cache.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/cache.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/cache\_warmup.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/cache_warmup.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/combine\_css.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/combine_css.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/combine\_js.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/combine_js.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/comms.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/comms.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/compress.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/compress.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/config.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/config.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/connect.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/connect.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/controller.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/controller.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/enqueues.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/enqueues.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/gui-v4.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/gui-v4.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/htaccess.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/htaccess.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/inline\_css.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/inline_css.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/integrations.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/integrations.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/js\_delay.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/js_delay.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/local.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/local.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/log.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/log.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/logger.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/logger.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/mainwp.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/mainwp.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/media\_library\_live.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/media_library_live.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/menu.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/menu.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/meta\_box.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/meta_box.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/modes.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/modes.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/mu.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/mu.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/notices.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/notices.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/oEmbed.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/oEmbed.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/options.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/options.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/preload.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/preload.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/preload\_warmup.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/preload_warmup.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/queue.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/queue.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/remote\_actions.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/remote_actions.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/remote\_restore.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/remote_restore.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/requests.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/requests.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/stats.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/stats.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/templates.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/templates.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/upgrader.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/upgrader.class.php?rev=3213738 "Show entry in browser")
  (added)
* [classes/visitor\_mode.class.php](/browser/wp-compress-image-optimizer/tags/6.30.04/classes/visitor_mode.class.php?rev=3213738 "Show entry in browser")
  (added)
* [debug.php](/browser/wp-compress-image-optimizer/tags/6.30.04/debug.php?rev=3213738 "Show entry in browser")
  (added)
* [defines.php](/browser/wp-compress-image-optimizer/tags/6.30.04/defines.php?rev=3213738 "Show entry in browser")
  (added)
* [fixCss.php](/browser/wp-compress-image-optimizer/tags/6.30.04/fixCss.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations?rev=3213738 "Show entry in browser")
  (added)
* [integrations/elementor.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/elementor.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/avada.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/avada.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/avada.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/avada.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/avada.min.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/avada.min.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/divi.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/divi.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/divi.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/divi.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/divi.min.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/divi.min.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/elementor.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/elementor.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/elementor.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/elementor.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/js/elementor.min.min.js](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/js/elementor.min.min.js?rev=3213738 "Show entry in browser")
  (added)
* [integrations/litespeed.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/litespeed.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/optimizepress.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/optimizepress.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/perfmatters.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/perfmatters.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/rocket.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/rocket.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/themes](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/themes?rev=3213738 "Show entry in browser")
  (added)
* [integrations/themes/avada.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/themes/avada.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/themes/divi.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/themes/divi.php?rev=3213738 "Show entry in browser")
  (added)
* [integrations/themes/theme.integrations.php](/browser/wp-compress-image-optimizer/tags/6.30.04/integrations/themes/theme.integrations.php?rev=3213738 "Show entry in browser")
  (added)
* [readme.txt](/browser/wp-compress-image-optimizer/tags/6.30.04/readme.txt?rev=3213738 "Show entry in browser")
  (added)
* [sample-data-live.json](/browser/wp-compress-image-optimizer/tags/6.30.04/sample-data-live.json?rev=3213738 "Show entry in browser")
  (added)
* [templates](/browser/wp-compress-image-optimizer/tags/6.30.04/templates?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/advanced\_settings\_v4.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/advanced_settings_v4.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/bulk.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/bulk.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/connect](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/connect?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/connect/api-connect.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/connect/api-connect.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/connect/lite-api-connect.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/connect/lite-api-connect.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/connect/lite-api-locked.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/connect/lite-api-locked.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/connect/lite-api-upgrade.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/connect/lite-api-upgrade.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/debug\_tool.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/debug_tool.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/lite\_settings.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/lite_settings.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/mu-getting-started.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/mu-getting-started.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/multisite-setup.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/multisite-setup.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/boxes](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/boxes?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/boxes/optimization-mode.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/boxes/optimization-mode.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/boxes/stats-bar.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/boxes/stats-bar.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/footer-links.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/footer-links.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/footer-scripts.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/footer-scripts.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/lite](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/lite?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/lite/stats.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/lite/stats.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/bulk](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/bulk?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/bulk/popups.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/bulk/popups.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/cname.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/cname.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/compatibility-popups.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/compatibility-popups.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/css](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/css?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/css/exclude-css-combine.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/css/exclude-css-combine.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/css/exclude-css-minify.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/css/exclude-css-minify.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/css/exclude-css-render-blocking.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/css/exclude-css-render-blocking.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/css/inline-css.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/css/inline-css.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-adaptive.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-adaptive.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-advanced-caching.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-advanced-caching.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-cdn.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-cdn.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-critical-css.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-critical-css.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-inline-css.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-inline-css.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-lazy.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-lazy.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-minify-html.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-minify-html.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-simple-caching.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-simple-caching.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-url.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-url.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/exclude-webp.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/exclude-webp.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/geolocation.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/geolocation.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/delay-js-configuration.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/delay-js-configuration.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/exclude-js-combine.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/exclude-js-combine.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/exclude-js-defer.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/exclude-js-defer.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/exclude-js-delay.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/exclude-js-delay.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/exclude-js-minify.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/exclude-js-minify.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/exclude-scripts-to-footer.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/exclude-scripts-to-footer.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/popups/js/inline-js.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/popups/js/inline-js.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/tooltips](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/tooltips?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/tooltips/all.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/tooltips/all.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/chart.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/chart.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/footer-scripts.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/footer-scripts.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/liteChart.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/liteChart.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/pageview-stats.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/pageview-stats.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/pull-stats.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/pull-stats.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/partials/v4/stats.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/partials/v4/stats.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/preload.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/preload.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/selectModes](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/selectModes?rev=3213738 "Show entry in browser")
  (added)
* [templates/admin/selectModes/popup.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/admin/selectModes/popup.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/connected.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/connected.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/multisite-connect.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/multisite-connect.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/not-connected.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/not-connected.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/bulk-configure-settings.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/bulk-configure-settings.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/bulk-connect-list.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/bulk-connect-list.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/bulk-connect.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/bulk-connect.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/bulk-connecting-process.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/bulk-connecting-process.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/bulk-default-settings.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/bulk-default-settings.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/default-settings.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/default-settings.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/manage-websites.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/manage-websites.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/mu/tabs/overlay-settings.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/mu/tabs/overlay-settings.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/notices](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/notices?rev=3213738 "Show entry in browser")
  (added)
* [templates/notices/activate\_list\_mode.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/notices/activate_list_mode.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/notices/connect\_api\_message.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/notices/connect_api_message.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/pages](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/pages?rev=3213738 "Show entry in browser")
  (added)
* [templates/pages/compress-all.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/pages/compress-all.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/pages/mu-getting-started.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/pages/mu-getting-started.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/pages/multisite-setup.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/pages/multisite-setup.php?rev=3213738 "Show entry in browser")
  (added)
* [templates/samples](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/samples?rev=3213738 "Show entry in browser")
  (added)
* [templates/samples/advancedCacheSample.php](/browser/wp-compress-image-optimizer/tags/6.30.04/templates/samples/advancedCacheSample.php?rev=3213738 "Show entry in browser")
  (added)
* [traits](/browser/wp-compress-image-optimizer/tags/6.30.04/traits?rev=3213738 "Show entry in browser")
  (added)
* [traits/excludes.php](/browser/wp-compress-image-optimizer/tags/6.30.04/traits/excludes.php?rev=3213738 "Show entry in browser")
  (added)
* [traits/url\_key.php](/browser/wp-compress-image-optimizer/tags/6.30.04/traits/url_key.php?rev=3213738 "Show entry in browser")
  (added)
* [wp-compress-core.php](/browser/wp-compress-image-optimizer/tags/6.30.04/wp-compress-core.php?rev=3213738 "Show entry in browser")
  (added)
* [wp-compress.php](/browser/wp-compress-image-optimizer/tags/6.30.04/wp-compress.php?rev=3213738 "Show entry in browser")
  (added)

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3213738)
* [Zip Archive](?format=zip&new=3213738)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_8cc9d07c_20250114_182131.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP Compress – Instant Performance & Speed Optimization <= 6.30.03 - Reflected Cross-Site Scripting via custom\_server Parameter

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP Compress – Instant Performance & Speed Optimization <= 6.30.03 - Reflected Cross-Site Scripting via custom\_server Parameter

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-12047](https://www.cve.org/CVERecord?id=CVE-2024-12047) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | January 3, 2025 |
| Last Updated | January 4, 2025 |
| Researcher | [vgo0](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dale-mavers) |

### Description

The WP Compress – Instant Performance & Speed Optimization plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘custom\_server’ parameter in all versions up to, and including, 6.30.03 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php#L459)
* [wordpress.org](https://wordpress.org/plugins/wp-compress-image-optimizer/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3213738/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-compress-image-optimizer%2Fwp-compress-instant-performance-speed-optimization-63003-reflected-cross-site-scripting-via-custom-server-parameter&t=WP%20Compress%20%E2%80%93%20Instant%20Performance%20%26%20Speed%20Optimization%20%3C%3D%206.30.03%20-%20Reflected%20Cross-Site%20Scripting%20via%20custom_server%20Parameter "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-compress-image-optimizer%2Fwp-compress-instant-performance-speed-optimization-63003-reflected-cross-site-scripting-via-custom-server-parameter&text=WP%20Compress%20%E2%80%93%20Instant%20Performance%20%26%20Speed%20Optimization%20%3C%3D%206.30.03%20-%20Reflected%20Cross-Site%20Scripting%20via%20custom_server%20Parameter "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-compress-image-optimizer%2Fwp-compress-instant-performance-speed-optimization-63003-reflected-cross-site-scripting-via-custom-server-parameter "LinkedIn")
Email

## Vulnerability Details for WP Compress – Instant Performance & Speed Optimization

#### [WP Compress – Instant Performance & Speed Optimization](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-compress-image-optimizer)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-compress-image-optimizer [(view on wordpress.org)](https://wordpress.org/plugins/wp-compress-image-optimizer) |
| Patched? | Yes |
| Remediation | Update to version 6.30.04, or a newer patched version |
| Affected Version | * <= 6.30.03 |
| Patched Version | * 6.30.04 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_2781538a_20250114_182122.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-compress-image-optimizer%2Ftags%2F6.30.00%2Faddons%2Fcdn%2Fcdn-rewrite.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-compress-image-optimizer](/browser/wp-compress-image-optimizer?order=name "View wp-compress-image-optimizer")/[tags](/browser/wp-compress-image-optimizer/tags?order=name "View tags")/[6.30.00](/browser/wp-compress-image-optimizer/tags/6.30.00?order=name "View 6.30.00")/[addons](/browser/wp-compress-image-optimizer/tags/6.30.00/addons?order=name "View addons")/[cdn](/browser/wp-compress-image-optimizer/tags/6.30.00/addons/cdn?order=name "View cdn")/[cdn-rewrite.php](/browser/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php?order=name "View cdn-rewrite.php")

View diff against:

View revision:

| [Last change](/changeset/3199069/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php "View differences") on this file was [3199069](/changeset/3199069/ "View changeset 3199069"), checked in by smartersite, [7 weeks ago](/timeline?from=2024-11-28T18%3A17%3A00Z&precision=second "See timeline at 11/28/2024 06:17:00 PM") |
| --- |
| 6.30.00  * New UI * Added Google Page Speed UI * Patches for Critical CSS |
| **File size:** 140.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | include 'rewriteLogic.php'; |
| [3](#L3) | include WPS\_IC\_DIR . 'addons/minify/html.php'; |
| [4](#L4) | include\_once WPS\_IC\_DIR . 'addons/cache/cacheHtml.php'; |
| [5](#L5) | include WPS\_IC\_DIR . 'addons/criticalCss/criticalCss.php'; |
| [6](#L6) |  |
| [7](#L7) | class wps\_cdn\_rewrite |
| [8](#L8) | { |
| [9](#L9) |  |
| [10](#L10) | public static $settings; |
| [11](#L11) | public static $options; |
| [12](#L12) | public static $lazy\_excluded\_list; |
| [13](#L13) | public static $excluded\_list; |
| [14](#L14) | public static $default\_excluded\_list; |
| [15](#L15) | public static $cdnEnabled; |
| [16](#L16) | public static $preloaderAPI; |
| [17](#L17) | public static $excludes\_class; |
| [18](#L18) |  |
| [19](#L19) | public static $assets\_to\_preload; |
| [20](#L20) | public static $assets\_to\_defer; |
| [21](#L21) |  |
| [22](#L22) | public static $emoji\_remove; |
| [23](#L23) |  |
| [24](#L24) | public static $isAjax; |
| [25](#L25) | public static $brizyCache; |
| [26](#L26) | public static $brizyActive; |
| [27](#L27) |  |
| [28](#L28) | // Regexp Url & Dirs |
| [29](#L29) | public static $regExURL; |
| [30](#L30) | public static $regExDir; |
| [31](#L31) | public static $findImages; |
| [32](#L32) |  |
| [33](#L33) | // Predefined API URLs |
| [34](#L34) | public static $apiUrl; |
| [35](#L35) | public static $apiAssetUrl; |
| [36](#L36) |  |
| [37](#L37) | // Site URL, Upload Dir |
| [38](#L38) | public static $updir; |
| [39](#L39) | public static $home\_url; |
| [40](#L40) | public static $site\_url; |
| [41](#L41) | public static $site\_url\_scheme; |
| [42](#L42) |  |
| [43](#L43) | // SVG Placeholder (empty svg) |
| [44](#L44) | public static $svg\_placeholder; |
| [45](#L45) |  |
| [46](#L46) |  |
| [47](#L47) | // CSS / JS Variables |
| [48](#L48) | public static $excludes; |
| [49](#L49) | public static $fonts; |
| [50](#L50) | public static $css; |
| [51](#L51) | public static $css\_img\_url; |
| [52](#L52) | public static $css\_minify; |
| [53](#L53) | public static $js; |
| [54](#L54) | public static $js\_minify; |
| [55](#L55) |  |
| [56](#L56) | // Image Compress Variables |
| [57](#L57) | public static $replaceAllLinks; |
| [58](#L58) | public static $external\_url\_excluded; |
| [59](#L59) | public static $externalUrlEnabled; |
| [60](#L60) | public static $zone\_test; |
| [61](#L61) | public static $zone\_name; |
| [62](#L62) | public static $is\_retina; |
| [63](#L63) | public static $exif; |
| [64](#L64) | public static $webp; |
| [65](#L65) | public static $retina\_enabled; |
| [66](#L66) | public static $adaptive\_enabled; |
| [67](#L67) | public static $webp\_enabled; |
| [68](#L68) | public static $lazy\_enabled; |
| [69](#L69) | public static $native\_lazy\_enabled; |
| [70](#L70) | public static $sizes; |
| [71](#L71) | public static $randomHash; |
| [72](#L72) | public static $is\_multisite; |
| [73](#L73) | public static $keys; |
| [74](#L74) |  |
| [75](#L75) | //Overrides |
| [76](#L76) | public static $delay\_js\_override; |
| [77](#L77) | public static $defer\_js\_override; |
| [78](#L78) | public static $lazy\_override; |
| [79](#L79) |  |
| [80](#L80) | public static $rewriteLogic; |
| [81](#L81) | public static $minifyHtml; |
| [82](#L82) | public static $cacheHtml; |
| [83](#L83) | public static $criticalCss; |
| [84](#L84) | public static $combineCss; |
| [85](#L85) | public static $page\_excludes; |
| [86](#L86) | public static $post\_id; |
| [87](#L87) | public static $page\_excludes\_files; |
| [88](#L88) | public static $isActive; |
| [89](#L89) | public static $wpcPreloadLinks; |
| [90](#L90) | private static $isAmp; |
| [91](#L91) | private static $themeIntegrations; |
| [92](#L92) |  |
| [93](#L93) | private static $lazyLoadedImages; |
| [94](#L94) | private static $lazyLoadedImagesLimit; |
| [95](#L95) | private static $lazyLoadSkipFirstImages; |
| [96](#L96) | private static $removeSrcset; |
| [97](#L97) | public $compatibility; |
| [98](#L98) | public $criticalCombine; |
| [99](#L99) | public $inline\_js; |
| [100](#L100) | public $delay\_js\_exclude; |
| [101](#L101) |  |
| [102](#L102) | public function \_\_construct() |
| [103](#L103) | { |
| [104](#L104) |  |
| [105](#L105) | // Theme Integrations |
| [106](#L106) | require\_once WPS\_IC\_DIR . 'integrations/themes/theme.integrations.php'; |
| [107](#L107) | self::$themeIntegrations = new ThemeIntegrations(); |
| [108](#L108) |  |
| [109](#L109) | // Lazy Limits |
| [110](#L110) | self::$lazyLoadedImages = 0; |
| [111](#L111) | self::$lazyLoadedImagesLimit = 1; |
| [112](#L112) |  |
| [113](#L113) | self::$settings = get\_option(WPS\_IC\_SETTINGS); |
| [114](#L114) | self::$excludes = get\_option('wpc-excludes'); |
| [115](#L115) |  |
| [116](#L116) | if (empty(self::$excludes)) { |
| [117](#L117) | self::$excludes = []; |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | if (!isset(self::$excludes['cdn'])) { |
| [121](#L121) | self::$excludes['cdn'] = []; |
| [122](#L122) | } |
| [123](#L123) |  |
| [124](#L124) | self::$excludes['cdn'][] = '.php'; //pagelayer .php requests fix |
| [125](#L125) | self::$excludes['cdn'][] = '/wp-fastest-cache/'; //icon in admin bugfix |
| [126](#L126) |  |
| [127](#L127) | self::$removeSrcset = self::$settings['remove-srcset']; |
| [128](#L128) |  |
| [129](#L129) | if (empty(self::$settings['lazySkipCount'])) { |
| [130](#L130) | self::$lazyLoadSkipFirstImages = 4; |
| [131](#L131) | } else { |
| [132](#L132) | self::$lazyLoadSkipFirstImages = self::$settings['lazySkipCount']; |
| [133](#L133) | } |
| [134](#L134) |  |
| [135](#L135) | self::$excludes\_class = new wps\_ic\_excludes(); |
| [136](#L136) | global $post; |
| [137](#L137) |  |
| [138](#L138) | if ($this->is\_home\_url()) { |
| [139](#L139) | $per\_page\_settings = isset(self::$excludes['per\_page\_settings']['home']) ? self::$excludes['per\_page\_settings']['home'] : []; |
| [140](#L140) | } elseif (!empty($post->ID)) { |
| [141](#L141) | $per\_page\_settings = isset(self::$excludes['per\_page\_settings'][$post->ID]) ? self::$excludes['per\_page\_settings'][$post->ID] : []; |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | if (!empty($per\_page\_settings) && isset($per\_page\_settings['skip\_lazy']) && $per\_page\_settings['skip\_lazy'] !== '') { |
| [145](#L145) | self::$lazyLoadSkipFirstImages = $per\_page\_settings['skip\_lazy']; |
| [146](#L146) | } |
| [147](#L147) |  |
| [148](#L148) | self::$wpcPreloadLinks = []; |
| [149](#L149) | self::$isActive = true; |
| [150](#L150) | $options = get\_option(WPS\_IC\_OPTIONS); |
| [151](#L151) | if (empty($options['api\_key'])) { |
| [152](#L152) | self::$isActive = false; |
| [153](#L153) | } |
| [154](#L154) | } |
| [155](#L155) |  |
| [156](#L156) | public function is\_home\_url() |
| [157](#L157) | { |
| [158](#L158) | $home\_url = rtrim(home\_url(), '/'); |
| [159](#L159) | $current\_url = (isset($\_SERVER['HTTPS']) && $\_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://$\_SERVER[HTTP\_HOST]$\_SERVER[REQUEST\_URI]"; |
| [160](#L160) | $current\_url = rtrim($current\_url, '/'); |
| [161](#L161) |  |
| [162](#L162) | return $home\_url === $current\_url; |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) |  |
| [166](#L166) | public function buffer\_local\_go() |
| [167](#L167) | { |
| [168](#L168) | if (self::$isAjax) { |
| [169](#L169) | $wps\_ic\_cdn = new wps\_cdn\_rewrite(); |
| [170](#L170) | } |
| [171](#L171) |  |
| [172](#L172) | ob\_start([$this, 'buffer\_local\_callback']); |
| [173](#L173) | } |
| [174](#L174) |  |
| [175](#L175) | public static function init() |
| [176](#L176) | { |
| [177](#L177) | global $ic\_running; |
| [178](#L178) |  |
| [179](#L179) | if (strpos($\_SERVER['REQUEST\_URI'], '.xml') !== false) { |
| [180](#L180) | return true; |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) | if (is\_admin() || strpos($\_SERVER['REQUEST\_URI'], 'wp-login.php') !== false) { |
| [184](#L184) | return true; |
| [185](#L185) | } |
| [186](#L186) |  |
| [187](#L187) | if ($ic\_running) { |
| [188](#L188) | return true; |
| [189](#L189) | } |
| [190](#L190) |  |
| [191](#L191) | $ic\_running = true; |
| [192](#L192) |  |
| [193](#L193) | if (!empty($\_GET['ignore\_cdn']) || !empty($\_GET['ignore\_ic'])) { |
| [194](#L194) | return true; |
| [195](#L195) | } |
| [196](#L196) |  |
| [197](#L197) | $options = get\_option(WPS\_IC\_OPTIONS); |
| [198](#L198) | $apikey = $options['api\_key']; |
| [199](#L199) | if (empty($apikey)) { |
| [200](#L200) | return true; |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | if (self::$settings['css'] == 0 && self::$settings['js'] == 0 && self::$settings['serve']['jpg'] == 0 && self::$settings['serve']['png'] == 0 && self::$settings['serve']['gif'] == 0 && self::$settings['serve']['svg'] == 0) { |
| [204](#L204) | return true; |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) | self::$isAjax = (function\_exists("wp\_doing\_ajax") && wp\_doing\_ajax()) || (defined('DOING\_AJAX') && DOING\_AJAX); |
| [208](#L208) |  |
| [209](#L209) | // Don't run in admin side! |
| [210](#L210) | if (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") { |
| [211](#L211) | return true; |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | // TODO: Check this for wpadmin and frontend ajax |
| [215](#L215) | if (!self::$isAjax) { |
| [216](#L216) | if (wp\_is\_json\_request() || is\_admin() || (!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor') || !empty($\_GET['trp-edit-translation']) || !empty($\_GET['elementor-preview']) || !empty($\_GET['preview']) || !empty($\_GET['PageSpeed']) || (!empty($\_GET['fl\_builder']) || isset($\_GET['fl\_builder'])) || isset($\_GET['is-editor-iframe']) || !empty($\_GET['et\_fb']) || !empty($\_GET['tatsu']) || !empty($\_GET['tve']) || !empty($\_GET['fb-edit']) || !empty($\_GET['ct\_builder']) || (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") || (!empty($\_GET['page']) && $\_GET['page'] == 'livecomposer\_editor')) { |
| [217](#L217) | return true; |
| [218](#L218) | } |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | add\_filter('get\_site\_icon\_url', ['wps\_cdn\_rewrite', 'favicon\_replace'], 10, 1); |
| [222](#L222) | return true; |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | public static function favicon\_replace($url) |
| [226](#L226) | { |
| [227](#L227) | if (empty($url)) { |
| [228](#L228) | return $url; |
| [229](#L229) | } |
| [230](#L230) |  |
| [231](#L231) | if (strpos($url, self::$zone\_name) !== false) { |
| [232](#L232) | return $url; |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | $url = 'https://' . self::$zone\_name . '/m:0/a:' . self::reformat\_url($url); |
| [236](#L236) |  |
| [237](#L237) | return $url; |
| [238](#L238) | } |
| [239](#L239) |  |
| [240](#L240) | public static function reformat\_url($url, $remove\_site\_url = false) |
| [241](#L241) | { |
| [242](#L242) | $url = trim($url); |
| [243](#L243) |  |
| [244](#L244) | if (!empty($\_GET['dbg\_reformaturl\_first'])) { |
| [245](#L245) | return print\_r([$url, $remove\_site\_url], true); |
| [246](#L246) | } |
| [247](#L247) |  |
| [248](#L248) | if (strpos($url, 'login') !== false) { |
| [249](#L249) | return $url; |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | // Check if url is maybe a relative URL (no http or https) |
| [253](#L253) | if (strpos($url, 'http') === false) { |
| [254](#L254) | // Check if url is maybe absolute but without http/s |
| [255](#L255) | if (strpos($url, '//') === 0) { |
| [256](#L256) | // Just needs http/s |
| [257](#L257) | $url = 'https:' . $url; |
| [258](#L258) | } else { |
| [259](#L259) |  |
| [260](#L260) | if (strpos($url, '/') !== 0) { |
| [261](#L261) | $url = str\_replace('../wp-content', 'wp-content', $url); |
| [262](#L262) | //if we replace all we break things like '.../wp-content/cache/min/1/wp-content/...' |
| [263](#L263) | $url\_replace = preg\_replace('/\/wp-content/', 'wp-content', $url, 1); |
| [264](#L264) | $url = self::$site\_url; |
| [265](#L265) | $url = rtrim($url, '/'); |
| [266](#L266) | $url .= '/' . $url\_replace; |
| [267](#L267) | } else { |
| [268](#L268) | $urlEnd = $url; |
| [269](#L269) | $urlEnd = ltrim($urlEnd, '/'); |
| [270](#L270) | $urlEnd = rtrim($urlEnd, '/'); |
| [271](#L271) | $url = self::$site\_url; |
| [272](#L272) | $url = ltrim($url, '/'); |
| [273](#L273) | $url = rtrim($url, '/'); |
| [274](#L274) | $url .= '/' . $urlEnd; |
| [275](#L275) | } |
| [276](#L276) | } |
| [277](#L277) | } |
| [278](#L278) |  |
| [279](#L279) | $formatted\_url = $url; |
| [280](#L280) |  |
| [281](#L281) |  |
| [282](#L282) | if (strpos($formatted\_url, '?brizy\_media') === false && strpos($formatted\_url, '.php') === false) { |
| [283](#L283) | $formatted\_url = explode('?', $formatted\_url); |
| [284](#L284) | $formatted\_url = $formatted\_url[0]; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'log\_url\_format') { |
| [288](#L288) | $fp = fopen(WPS\_IC\_DIR . 'url\_Format.txt', 'a+'); |
| [289](#L289) | fwrite($fp, 'URL: ' . $formatted\_url . "\r\n"); |
| [290](#L290) | fwrite($fp, 'Site URL: ' . self::$site\_url . "\r\n"); |
| [291](#L291) | fwrite($fp, 'Slashes: ' . addcslashes(self::$site\_url, '/') . "\r\n"); |
| [292](#L292) | fwrite($fp, '---' . "\r\n"); |
| [293](#L293) | fclose($fp); |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | if ($remove\_site\_url) { |
| [297](#L297) | $formatted\_url = str\_replace(self::$site\_url, '', $formatted\_url); |
| [298](#L298) | $formatted\_url = str\_replace(str\_replace(['https://', 'http://'], '', self::$site\_url), '', $formatted\_url); |
| [299](#L299) | $formatted\_url = str\_replace(addcslashes(self::$site\_url, '/'), '', $formatted\_url); |
| [300](#L300) | $formatted\_url = ltrim($formatted\_url, '\/'); |
| [301](#L301) | $formatted\_url = ltrim($formatted\_url, '/'); |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | if (!empty($\_GET['dbg\_reformaturl'])) { |
| [305](#L305) | return print\_r([$url, $formatted\_url], true); |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | if (!empty(self::$cdnEnabled) && self::$cdnEnabled == '1') { |
| [309](#L309) | if (self::$randomHash == 0 && strpos($formatted\_url, '.css') !== false) { |
| [310](#L310) | $formatted\_url .= '?icv=' . WPS\_IC\_HASH; |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | if (self::$randomHash == 0 && strpos($formatted\_url, '.js') !== false) { |
| [314](#L314) | $formatted\_url .= '?js\_icv=' . WPS\_IC\_JS\_HASH; |
| [315](#L315) | } |
| [316](#L316) |  |
| [317](#L317) | if (self::$randomHash != 0) { |
| [318](#L318) | return $formatted\_url . '?icv\_random=' . self::$randomHash; |
| [319](#L319) | } |
| [320](#L320) | } |
| [321](#L321) |  |
| [322](#L322) | return $formatted\_url; |
| [323](#L323) | } |
| [324](#L324) |  |
| [325](#L325) | public function isActive() |
| [326](#L326) | { |
| [327](#L327) | return self::$isActive; |
| [328](#L328) | } |
| [329](#L329) |  |
| [330](#L330) | public function add\_scripts\_inline($tag, $handle, $src) |
| [331](#L331) | { |
| [332](#L332) | if (strpos(strtolower($src), 'webpack') !== false) { |
| [333](#L333) | return $tag; |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | // TODO: Hrvoje |
| [337](#L337) | if (strpos(strtolower($src), 'tweenmax') !== false) { |
| [338](#L338) | $urlGet = false; |
| [339](#L339) | // TODO: Move to default defers |
| [340](#L340) | $check = wp\_http\_validate\_url($src); |
| [341](#L341) | if ($check || strpos($src, '//') === 0) { |
| [342](#L342) | if (strpos($src, 'http') === false) { |
| [343](#L343) | $src = 'https:' . $src; |
| [344](#L344) | } |
| [345](#L345) | $urlGet = true; |
| [346](#L346) | $url = $src; |
| [347](#L347) | } else { |
| [348](#L348) | $url = get\_home\_url() . $src; |
| [349](#L349) | } |
| [350](#L350) |  |
| [351](#L351) | if ($urlGet) { |
| [352](#L352) | $tag = '<script type="text/javascript" class="wps-inline" id="tweenmax-js">' . $this->get\_script\_content\_url($url) . '</script>'; |
| [353](#L353) | } else { |
| [354](#L354) | $tag = '<script type="text/javascript" class="wps-inline" id="tweenmax-js">' . $this->get\_script\_content($url) . '</script>'; |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | return $tag; |
| [358](#L358) | } |
| [359](#L359) |  |
| [360](#L360) | if (empty($this->inline\_js) || !is\_array($this->inline\_js)) { |
| [361](#L361) | $this->inline\_js = []; |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | $found = false; |
| [365](#L365) | foreach ($this->inline\_js as $k => $inlineJs) { |
| [366](#L366) | if (strpos(strtolower($src), $inlineJs) !== false) { |
| [367](#L367) | $found = true; |
| [368](#L368) | break; |
| [369](#L369) | } |
| [370](#L370) | } |
| [371](#L371) |  |
| [372](#L372) | if ($found) { |
| [373](#L373) | global $wp\_scripts; |
| [374](#L374) |  |
| [375](#L375) | $check = wp\_http\_validate\_url($src); |
| [376](#L376) | if ($check || strpos($src, '//') === 0) { |
| [377](#L377) | $url = $src; |
| [378](#L378) | } else { |
| [379](#L379) | $url = get\_home\_url() . $src; |
| [380](#L380) | } |
| [381](#L381) |  |
| [382](#L382) | $tag = ''; |
| [383](#L383) | if (!empty($wp\_scripts->registered[$handle]->extra['before'][1])) { |
| [384](#L384) | $tag .= '<script type="text/javascript" id="' . $handle . '-js-before">' . $wp\_scripts->registered[$handle]->extra['before'][1] . '</script>'; |
| [385](#L385) | } |
| [386](#L386) |  |
| [387](#L387) | // TODO: Make more elegant |
| [388](#L388) | if (strpos($handle, 'awesome') !== false) { |
| [389](#L389) | $tag .= '<script type="text/javascript" defer class="wps-inline" id="' . $handle . '-js">' . $this->get\_script\_content($url) . '</script>'; |
| [390](#L390) | } else { |
| [391](#L391) | if (strpos($handle, 'aio') !== false || strpos($handle, 'theme') !== false) { |
| [392](#L392) | $tag .= '<script type="text/javascript" class="wps-inline" id="' . $handle . '-js" defer>' . $this->get\_script\_content($url) . '</script>'; |
| [393](#L393) | } else { |
| [394](#L394) | $tag .= '<script type="wpc-delay-script" class="wps-inline" id="' . $handle . '-js">' . $this->get\_script\_content($url) . '</script>'; |
| [395](#L395) | } |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | if (!empty($wp\_scripts->registered[$handle]->extra['after'][1])) { |
| [399](#L399) | $tag .= '<script type="text/javascript" id="' . $handle . '-js-after">' . $wp\_scripts->registered[$handle]->extra['after'][1] . '</script>'; |
| [400](#L400) | } |
| [401](#L401) | } |
| [402](#L402) |  |
| [403](#L403) | return $tag; |
| [404](#L404) | } |
| [405](#L405) |  |
| [406](#L406) | public function get\_script\_content\_url($url) |
| [407](#L407) | { |
| [408](#L408) | $ch = curl\_init(); |
| [409](#L409) | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); |
| [410](#L410) | curl\_setopt($ch, CURLOPT\_URL, $url); |
| [411](#L411) | $data = curl\_exec($ch); |
| [412](#L412) | curl\_close($ch); |
| [413](#L413) |  |
| [414](#L414) | return $data; |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | public function get\_script\_content($url) |
| [418](#L418) | { |
| [419](#L419) | // |
| [420](#L420) | //    $ch = curl\_init(); |
| [421](#L421) | //    curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); |
| [422](#L422) | //    curl\_setopt($ch, CURLOPT\_URL, $url); |
| [423](#L423) | //    $data = curl\_exec($ch); |
| [424](#L424) | //    curl\_close($ch); |
| [425](#L425) |  |
| [426](#L426) | $relativePath = wp\_make\_link\_relative($url); |
| [427](#L427) | $path = ltrim($relativePath, '/'); |
| [428](#L428) |  |
| [429](#L429) | //check if is folder install and if folder is in url remove it (it is already in ABSPATH) |
| [430](#L430) | $last\_abspath = basename(ABSPATH); |
| [431](#L431) | $first\_path = explode('/', $path)[0]; |
| [432](#L432) | if ($last\_abspath == $first\_path) { |
| [433](#L433) | $path = substr($path, strlen($first\_path)); |
| [434](#L434) | $path = ltrim($path, '/'); |
| [435](#L435) | } |
| [436](#L436) |  |
| [437](#L437) | $path = explode('?', $path); |
| [438](#L438) | $path = $path[0]; |
| [439](#L439) |  |
| [440](#L440) | // TODO: What if file does not exist? |
| [441](#L441) | if (!file\_exists(ABSPATH . $path)) { |
| [442](#L442) | // Can't just return empty , because it's in script tags, fix!! |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $content = file\_get\_contents(ABSPATH . $path); |
| [446](#L446) |  |
| [447](#L447) | // Remove comments |
| [448](#L448) | $jsCode = preg\_replace('!/\\*[^\*]\*\\*+([^/][^\*]\*\\*+)\*/!', '', $content); |
| [449](#L449) |  |
| [450](#L450) | return $jsCode; |
| [451](#L451) | } |
| [452](#L452) |  |
| [453](#L453) | public function dnsPrefetch() |
| [454](#L454) | { |
| [455](#L455) | if (strlen(trim(self::$zone\_name)) > 0) { |
| [456](#L456) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'direct') { |
| [457](#L457) | if (!empty($\_GET['custom\_server'])) { |
| [458](#L458) | self::$zone\_name = $\_GET['custom\_server'] . '/key:' . self::$options['api\_key']; |
| [459](#L459) | echo '<link rel="dns-prefetch" href="//' . $\_GET['custom\_server'] . '" />'; |
| [460](#L460) | } |
| [461](#L461) | } else { |
| [462](#L462) | //                              echo '<link rel="dns-prefetch" href="https://cdn.zapwp.net" />'; |
| [463](#L463) | //                              echo '<link rel="preconnect" href="https://cdn.zapwp.net">'; |
| [464](#L464) | echo '<link rel="dns-prefetch" href="https://optimizerwpc.b-cdn.net" />'; |
| [465](#L465) | echo '<link rel="preconnect" href="https://optimizerwpc.b-cdn.net">'; |
| [466](#L466) | echo '<link rel="dns-prefetch" href="//' . self::$zone\_name . '" />'; |
| [467](#L467) | echo '<link rel="preconnect" href="https://' . self::$zone\_name . '">'; |
| [468](#L468) | } |
| [469](#L469) | } |
| [470](#L470) | } |
| [471](#L471) |  |
| [472](#L472) | public function deferJSAssets($tag, $handle, $src) |
| [473](#L473) | { |
| [474](#L474) | return $tag; |
| [475](#L475) | } |
| [476](#L476) |  |
| [477](#L477) | public function rewrite\_script\_tag($tag, $handle, $src) |
| [478](#L478) | { |
| [479](#L479) |  |
| [480](#L480) | $src = trim($src); |
| [481](#L481) |  |
| [482](#L482) | if (!empty($\_GET['dbg\_src\_excludes'])) { |
| [483](#L483) | return print\_r([$tag, $src, self::isExcludedFrom('cdn', $src), self::$excludes]); |
| [484](#L484) | } |
| [485](#L485) |  |
| [486](#L486) | if (self::isExcludedFrom('cdn', $src)) { |
| [487](#L487) | return $tag; |
| [488](#L488) | } |
| [489](#L489) |  |
| [490](#L490) | if (self::isExcludedFrom('cdn', $tag)) { |
| [491](#L491) | return $tag; |
| [492](#L492) | } |
| [493](#L493) |  |
| [494](#L494) | if ($this->defaultExcluded($src)) { |
| [495](#L495) | return $tag; |
| [496](#L496) | } |
| [497](#L497) |  |
| [498](#L498) | if (self::is\_excluded\_link($src)) { |
| [499](#L499) | return $tag; |
| [500](#L500) | } |
| [501](#L501) |  |
| [502](#L502) | /\*\* |
| [503](#L503) | \* TODO: |
| [504](#L504) | \* check if external is enabled |
| [505](#L505) | \*/ |
| [506](#L506) | if ((self::$externalUrlEnabled == '0' || empty(self::$externalUrlEnabled))) { |
| [507](#L507) | if (!self::image\_url\_matching\_site\_url($src)) { |
| [508](#L508) | // External not enabled |
| [509](#L509) | return $tag; |
| [510](#L510) | } |
| [511](#L511) | } |
| [512](#L512) |  |
| [513](#L513) | if (self::$externalUrlEnabled == '1' && !self::image\_url\_matching\_site\_url($src)) { |
| [514](#L514) | // External not enabled |
| [515](#L515) | if (strpos($src, self::$zone\_name) === false) { |
| [516](#L516) | if (strpos($src, 'http') === false) { |
| [517](#L517) | $src = ltrim($src, '//'); |
| [518](#L518) | $src = 'https://' . $src; |
| [519](#L519) | } |
| [520](#L520) |  |
| [521](#L521) | if (!self::is\_excluded\_link($src)) { |
| [522](#L522) | $src = 'https://' . self::$zone\_name . '/m:0/a:' . $src; |
| [523](#L523) | } |
| [524](#L524) | } |
| [525](#L525) | } |
| [526](#L526) |  |
| [527](#L527) | if (self::$cdnEnabled == '1' && self::$js == '1') { |
| [528](#L528) | if (strpos($src, self::$zone\_name) === false) { |
| [529](#L529) | $fileMinify = self::$js\_minify; |
| [530](#L530) | if (self::isExcluded('js\_minify', $src)) { |
| [531](#L531) | $fileMinify = '0'; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) | /\*\* |
| [535](#L535) | \* Is script inside Wp-content or Wp-includes |
| [536](#L536) | \*/ |
| [537](#L537) | if (strpos($src, 'wp-content') !== false || strpos($src, 'wp-includes') !== false) { |
| [538](#L538) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [539](#L539) | } else { |
| [540](#L540) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [541](#L541) | } |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | if (!empty(self::$settings['js\_defer'])) { |
| [545](#L545) | if (self::$settings['js\_defer'] == '1' && !self::$defer\_js\_override) { |
| [546](#L546) | foreach (self::$assets\_to\_defer as $i => $defer\_key) { |
| [547](#L547) | if (strpos($tag, $defer\_key) !== false) { |
| [548](#L548) | if (!self::isExcluded('defer\_js', $src) && !strpos($src, 'slide')) { |
| [549](#L549) | $tag = '<script type="text/javascript" src="' . $src . '" defer></script>'; |
| [550](#L550) | } |
| [551](#L551) | } |
| [552](#L552) | } |
| [553](#L553) | } else { |
| [554](#L554) | $tag = preg\_replace('/src=["|\'](.\*?)["|\']/si', 'src="' . $src . '"', $tag); |
| [555](#L555) | } |
| [556](#L556) | } else { |
| [557](#L557) |  |
| [558](#L558) | if (strpos($src, 'gtag') !== false) { |
| [559](#L559) | $tag = '<script type="text/javascript" src="' . $src . '" defer></script>'; |
| [560](#L560) | } |
| [561](#L561) |  |
| [562](#L562) | if (strpos($src, 'fontawesome') !== false) { |
| [563](#L563) | $tag = '<script type="text/javascript" src="' . $src . '" defer></script>'; |
| [564](#L564) |  |
| [565](#L565) | return $tag; |
| [566](#L566) | } |
| [567](#L567) |  |
| [568](#L568) | $tag = preg\_replace('/src=["|\'](.\*?)["|\']/si', 'src="' . $src . '"', $tag); |
| [569](#L569) | } |
| [570](#L570) |  |
| [571](#L571) | return $tag; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | return $tag; |
| [575](#L575) | } |
| [576](#L576) |  |
| [577](#L577) | public static function isExcludedFrom($setting, $link) |
| [578](#L578) | { |
| [579](#L579) | if (isset(self::$excludes[$setting])) { |
| [580](#L580) | $excludeList = self::$excludes[$setting]; |
| [581](#L581) | if (!empty($excludeList)) { |
| [582](#L582) | foreach ($excludeList as $key => $value) { |
| [583](#L583) | if (strpos($link, $value) !== false && $value != '') { |
| [584](#L584) | return true; |
| [585](#L585) | } |
| [586](#L586) | } |
| [587](#L587) | } |
| [588](#L588) | } |
| [589](#L589) |  |
| [590](#L590) | if (isset(self::$page\_excludes\_files[$setting])) { |
| [591](#L591) | $excludeList = self::$page\_excludes\_files[$setting]; |
| [592](#L592) | if (!empty($excludeList)) { |
| [593](#L593) | foreach ($excludeList as $key => $value) { |
| [594](#L594) | if (strpos($link, $value) !== false && $value != '') { |
| [595](#L595) | return true; |
| [596](#L596) | } |
| [597](#L597) | } |
| [598](#L598) | } |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) |  |
| [602](#L602) | return false; |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) | public function defaultExcluded($string) |
| [606](#L606) | { |
| [607](#L607) | foreach (self::$default\_excluded\_list as $i => $excluded\_string) { |
| [608](#L608) | if (strpos($string, $excluded\_string) !== false) { |
| [609](#L609) | return true; |
| [610](#L610) | } |
| [611](#L611) | } |
| [612](#L612) |  |
| [613](#L613) | return false; |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) | public static function is\_excluded\_link($link) |
| [617](#L617) | { |
| [618](#L618) | /\*\* |
| [619](#L619) | \* Is the link in excluded list? |
| [620](#L620) | \*/ |
| [621](#L621) | if (empty($link)) { |
| [622](#L622) | return false; |
| [623](#L623) | } |
| [624](#L624) |  |
| [625](#L625) | if (strpos($link, '.css') !== false || strpos($link, '.js') !== false) { |
| [626](#L626) | foreach (self::$default\_excluded\_list as $i => $excluded\_string) { |
| [627](#L627) | if (strpos($link, $excluded\_string) !== false) { |
| [628](#L628) | return true; |
| [629](#L629) | } |
| [630](#L630) | } |
| [631](#L631) | } |
| [632](#L632) |  |
| [633](#L633) | if (!empty(self::$excluded\_list)) { |
| [634](#L634) | foreach (self::$excluded\_list as $i => $value) { |
| [635](#L635) | if (strpos($link, $value) !== false) { |
| [636](#L636) | // Link is excluded |
| [637](#L637) | return true; |
| [638](#L638) | } |
| [639](#L639) | } |
| [640](#L640) | } |
| [641](#L641) |  |
| [642](#L642) | return false; |
| [643](#L643) | } |
| [644](#L644) |  |
| [645](#L645) | /\*\* |
| [646](#L646) | \* Is link matching the site url? |
| [647](#L647) | \* |
| [648](#L648) | \* @param $image |
| [649](#L649) | \* |
| [650](#L650) | \* @return bool |
| [651](#L651) | \*/ |
| [652](#L652) | public static function image\_url\_matching\_site\_url($image) |
| [653](#L653) | { |
| [654](#L654) | $site\_url = self::$site\_url; |
| [655](#L655) | $image = str\_replace(['https://', 'http://'], '', $image); |
| [656](#L656) | $site\_url = str\_replace(['https://', 'http://'], '', $site\_url); |
| [657](#L657) |  |
| [658](#L658) | if (strpos($image, '.css') !== false || strpos($image, '.js') !== false) { |
| [659](#L659) | foreach (self::$default\_excluded\_list as $i => $excluded\_string) { |
| [660](#L660) | if (strpos($image, $excluded\_string) !== false) { |
| [661](#L661) | return false; |
| [662](#L662) | } |
| [663](#L663) | } |
| [664](#L664) | } |
| [665](#L665) |  |
| [666](#L666) | if (strpos($image, $site\_url) === false) { |
| [667](#L667) | // Image not on site |
| [668](#L668) | return false; |
| [669](#L669) | } else { |
| [670](#L670) | // Image on site |
| [671](#L671) | return true; |
| [672](#L672) | } |
| [673](#L673) | } |
| [674](#L674) |  |
| [675](#L675) | public static function isExcluded($setting, $link) |
| [676](#L676) | { |
| [677](#L677) | if (isset(self::$excludes[$setting])) { |
| [678](#L678) | $excludeList = self::$excludes[$setting]; |
| [679](#L679) | if (!empty($excludeList)) { |
| [680](#L680) | foreach ($excludeList as $key => $value) { |
| [681](#L681) | if (strpos($link, $value) !== false && $value != '') { |
| [682](#L682) | return true; |
| [683](#L683) | } |
| [684](#L684) | } |
| [685](#L685) | } |
| [686](#L686) | } |
| [687](#L687) |  |
| [688](#L688) |  |
| [689](#L689) | return false; |
| [690](#L690) | } |
| [691](#L691) |  |
| [692](#L692) | public function crittr\_style\_tag($html, $handle, $href, $media) |
| [693](#L693) | { |
| [694](#L694) |  |
| [695](#L695) | if (strpos($href, self::$site\_url) === false) { |
| [696](#L696) |  |
| [697](#L697) | } else { |
| [698](#L698) | $cdnHref = WPS\_IC\_URI . 'fixCss.php?zoneName=' . self::$zone\_name . '&css=' . urlencode($href) . '&rand=' . time(); |
| [699](#L699) | $html = str\_replace($href, $cdnHref, $html); |
| [700](#L700) | } |
| [701](#L701) |  |
| [702](#L702) | return $html; |
| [703](#L703) | } |
| [704](#L704) |  |
| [705](#L705) | public function inlineCSS($html, $handle, $href, $media) |
| [706](#L706) | { |
| [707](#L707) | if (strpos($html, 'src=')) { |
| [708](#L708) | // It has a src attribute, inline it |
| [709](#L709) | if (strpos($href, self::$site\_url) !== false) { |
| [710](#L710) | // Href is local |
| [711](#L711) | $content = file\_get\_contents($href); |
| [712](#L712) | $content = self::$combineCss->minifyCSS($content); |
| [713](#L713) | $return = '<style id="inline-css-' . mt\_rand(999, 9999) . '">'; |
| [714](#L714) | $return .= $content; |
| [715](#L715) | $return .= '</style>'; |
| [716](#L716) |  |
| [717](#L717) | return $return; |
| [718](#L718) | } |
| [719](#L719) | } |
| [720](#L720) |  |
| [721](#L721) | return $html; |
| [722](#L722) | } |
| [723](#L723) |  |
| [724](#L724) | public function adjust\_style\_tag($html, $handle, $href, $media) |
| [725](#L725) | { |
| [726](#L726) |  |
| [727](#L727) | if (!empty(self::$settings['remove-render-blocking']) && self::$settings['remove-render-blocking'] == '1') { |
| [728](#L728) | foreach (self::$assets\_to\_preload as $i => $preload\_key) { |
| [729](#L729) | if (self::$excludes\_class->strInArray($html, self::$excludes\_class->renderBlockingCSSExcludes())) { |
| [730](#L730) | return $html; |
| [731](#L731) | } |
| [732](#L732) | if (strpos($href, $preload\_key) !== false) { |
| [733](#L733) | if (!strpos($html, 'preload')) { |
| [734](#L734) | if (strpos($html, 'rel=') !== false) { |
| [735](#L735) | // Rel exists, change it |
| [736](#L736) | $html = preg\_replace('/rel\=["|\'](.\*?)["|\']/', 'rel="preload" as="style" onload="this.rel=\'stylesheet\'" ', $html); |
| [737](#L737) | } else { |
| [738](#L738) | // Rel does not exist, create it |
| [739](#L739) | $html = str\_replace('/>', 'rel="preload" as="style" onload="this.rel=\'stylesheet\'"/>', $html); |
| [740](#L740) | } |
| [741](#L741) | } |
| [742](#L742) |  |
| [743](#L743) | return $html; |
| [744](#L744) | } |
| [745](#L745) |  |
| [746](#L746) | } |
| [747](#L747) | } |
| [748](#L748) |  |
| [749](#L749) | if (strpos($href, 'wp-includes/css/dist/block-library') !== false) { |
| [750](#L750) | if (!empty($this::$settings['disable-gutenberg']) && $this::$settings['disable-gutenberg'] == '1') { |
| [751](#L751) | return ''; |
| [752](#L752) | } |
| [753](#L753) | } |
| [754](#L754) |  |
| [755](#L755) | return $html; |
| [756](#L756) | } |
| [757](#L757) |  |
| [758](#L758) | public function strInArray($haystack, $needles = []) |
| [759](#L759) | { |
| [760](#L760) |  |
| [761](#L761) | if (empty($needles)) { |
| [762](#L762) | return false; |
| [763](#L763) | } |
| [764](#L764) |  |
| [765](#L765) | $haystack = strtolower($haystack); |
| [766](#L766) |  |
| [767](#L767) | foreach ($needles as $needle) { |
| [768](#L768) | $needle = strtolower(trim($needle)); |
| [769](#L769) |  |
| [770](#L770) | $res = strpos($haystack, $needle); |
| [771](#L771) | if ($res !== false) { |
| [772](#L772) | return true; |
| [773](#L773) | } |
| [774](#L774) | } |
| [775](#L775) |  |
| [776](#L776) | return false; |
| [777](#L777) | } |
| [778](#L778) |  |
| [779](#L779) | public function adjust\_src\_url($src) |
| [780](#L780) | { |
| [781](#L781) |  |
| [782](#L782) | $src = trim($src); |
| [783](#L783) |  |
| [784](#L784) | if (strpos($src, '.css') !== false && empty(self::$css) || self::$css == '0') { |
| [785](#L785) | return $src; |
| [786](#L786) | } elseif (strpos($src, '.js') !== false && empty(self::$js) || self::$js == '0') { |
| [787](#L787) | return $src; |
| [788](#L788) | } else if (strpos($src, '.php') !== false) { |
| [789](#L789) | return $src; |
| [790](#L790) | } |
| [791](#L791) |  |
| [792](#L792) | if (self::isExcludedFrom('cdn', $src)) { |
| [793](#L793) | return $src; |
| [794](#L794) | } |
| [795](#L795) |  |
| [796](#L796) | if ($this->defaultExcluded($src)) { |
| [797](#L797) | return $src; |
| [798](#L798) | } |
| [799](#L799) |  |
| [800](#L800) | if (self::is\_excluded\_link($src)) { |
| [801](#L801) | return $src; |
| [802](#L802) | } |
| [803](#L803) |  |
| [804](#L804) | /\*\* |
| [805](#L805) | \* TODO: |
| [806](#L806) | \* check if external is enabled |
| [807](#L807) | \*/ |
| [808](#L808) | if ((self::$externalUrlEnabled == '0' || empty(self::$externalUrlEnabled))) { |
| [809](#L809) | if (!self::image\_url\_matching\_site\_url($src)) { |
| [810](#L810) | // External not enabled |
| [811](#L811) | return $src; |
| [812](#L812) | } |
| [813](#L813) | } |
| [814](#L814) |  |
| [815](#L815) | if (self::$externalUrlEnabled == '1' && !self::image\_url\_matching\_site\_url($src)) { |
| [816](#L816) | // External not enabled |
| [817](#L817) | if (strpos($src, self::$zone\_name) === false) { |
| [818](#L818) | if (strpos($src, 'http') === false) { |
| [819](#L819) | $src = ltrim($src, '//'); |
| [820](#L820) | $src = 'https://' . $src; |
| [821](#L821) | } |
| [822](#L822) |  |
| [823](#L823) | if (!self::is\_excluded\_link($src)) { |
| [824](#L824) | $src = 'https://' . self::$zone\_name . '/m:0/a:' . $src; |
| [825](#L825) | } |
| [826](#L826) | } |
| [827](#L827) |  |
| [828](#L828) | return $src; |
| [829](#L829) | } |
| [830](#L830) |  |
| [831](#L831) | if (strpos($src, self::$zone\_name) === false) { |
| [832](#L832) | if (strpos($src, '.css') !== false) { |
| [833](#L833) | $fileMinify = self::$css\_minify; |
| [834](#L834) | if (self::isExcluded('css\_minify', $src)) { |
| [835](#L835) | $fileMinify = '0'; |
| [836](#L836) | } |
| [837](#L837) |  |
| [838](#L838) | if (!empty(self::$settings['font-subsetting']) && self::$settings['font-subsetting'] == '1') { |
| [839](#L839) | $fileMinify = '1'; |
| [840](#L840) | } |
| [841](#L841) |  |
| [842](#L842) | if (!self::is\_excluded\_link($src)) { |
| [843](#L843) | if (self::$css\_img\_url == '1') { |
| [844](#L844) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src); |
| [845](#L845) | } else { |
| [846](#L846) | if (strpos($src, 'wp-content') !== false || strpos($src, 'wp-includes') !== false) { |
| [847](#L847) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [848](#L848) | } else { |
| [849](#L849) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [850](#L850) | } |
| [851](#L851) | } |
| [852](#L852) | } |
| [853](#L853) | } elseif (strpos($src, '.js') !== false) { |
| [854](#L854) | $fileMinify = self::$js\_minify; |
| [855](#L855) | if (self::isExcluded('js\_minify', $src)) { |
| [856](#L856) | $fileMinify = '0'; |
| [857](#L857) | } |
| [858](#L858) |  |
| [859](#L859) | if (strpos($src, 'wp-content') !== false || strpos($src, 'wp-includes') !== false) { |
| [860](#L860) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [861](#L861) | } else { |
| [862](#L862) | $src = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($src, false); |
| [863](#L863) | } |
| [864](#L864) | } |
| [865](#L865) | } |
| [866](#L866) |  |
| [867](#L867) | return $src; |
| [868](#L868) | } |
| [869](#L869) |  |
| [870](#L870) | public function buffer\_local\_callback($html) |
| [871](#L871) | { |
| [872](#L872) |  |
| [873](#L873) | if (!self::dontRunif()) { |
| [874](#L874) | return $html; |
| [875](#L875) | } |
| [876](#L876) |  |
| [877](#L877) | if (!empty($\_GET['criticalCombine']) && $\_GET['criticalCombine'] == 'true') { |
| [878](#L878) | $this->criticalCombine = true; |
| [879](#L879) | } |
| [880](#L880) | //Do something with the buffer (HTML) |
| [881](#L881) | if (isset($\_GET['brizy-edit-iframe']) || isset($\_GET['brizy-edit']) || isset($\_GET['preview'])) { |
| [882](#L882) | return $html; |
| [883](#L883) | } |
| [884](#L884) |  |
| [885](#L885) | if (self::$isAjax) { |
| [886](#L886) | return $html; |
| [887](#L887) | } |
| [888](#L888) |  |
| [889](#L889) | if (is\_admin() || is\_feed() || (!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor') || !empty($\_GET['trp-edit-translation']) || !empty($\_GET['elementor-preview']) || !empty($\_GET['preview']) || !empty($\_GET['is-editor-iframe']) || !empty($\_GET['PageSpeed']) || !empty($\_GET['tve']) || !empty($\_GET['et\_fb']) || (!empty($\_GET['fl\_builder']) || isset($\_GET['fl\_builder'])) || !empty($\_GET['ct\_builder']) || !empty |
| [890](#L890) | ($\_GET['tatsu']) || !empty($\_GET['fb-edit']) || !empty($\_GET['bricks']) || (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") || (!empty($\_GET['page']) && $\_GET['page'] == 'livecomposer\_editor')) { |
| [891](#L891) | return $html; |
| [892](#L892) | } |
| [893](#L893) |  |
| [894](#L894) | if (self::$cdnEnabled == 0) { |
| [895](#L895) | $htmlBefore = $html; |
| [896](#L896) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$this, 'local\_script\_encode'], $html); |
| [897](#L897) |  |
| [898](#L898) | if (empty($html)) { |
| [899](#L899) | $html = $htmlBefore; |
| [900](#L900) | } |
| [901](#L901) |  |
| [902](#L902) | $html = preg\_replace\_callback('/(?<![\"|\'])<img[^>]\*>/i', [$this, 'local\_image\_tags'], $html); |
| [903](#L903) |  |
| [904](#L904) | if (self::$fonts == 1) { |
| [905](#L905) | $html = self::$rewriteLogic->fonts($html); |
| [906](#L906) | } |
| [907](#L907) |  |
| [908](#L908) | $html = preg\_replace\_callback('/\[script\-wpc\](.\*?)\[\/script\-wpc\]/i', [$this, 'local\_script\_decode'], $html); |
| [909](#L909) |  |
| [910](#L910) | $html = preg\_replace\_callback('/<style\b[^>]\*>(.\*?)<\/style>?/is', [self::$rewriteLogic, |
| [911](#L911) | 'replaceBackgroundImagesInCSSLocal'], $html); |
| [912](#L912) |  |
| [913](#L913) | //Combine JS |
| [914](#L914) | if ($this->doCacheCombine() && (isset(self::$settings['js\_combine']) && self::$settings['js\_combine'] == '1')) { |
| [915](#L915) | $combine\_js = new wps\_ic\_combine\_js(); |
| [916](#L916) | $html = $combine\_js->maybe\_do\_combine($html); |
| [917](#L917) | } |
| [918](#L918) | } |
| [919](#L919) |  |
| [920](#L920) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'setImageSize') { |
| [921](#L921) | return $html; |
| [922](#L922) | } |
| [923](#L923) |  |
| [924](#L924) | $html = preg\_replace\_callback('/<img[^>]\*src=[\'"]([^\'"]+)[\'"][^>]\*>/si', [$this, 'set\_image\_sizes'], $html); |
| [925](#L925) | $html = preg\_replace\_callback('/<picture>.\*?<\/picture>/is', [$this, 'set\_image\_sizes'], $html); |
| [926](#L926) |  |
| [927](#L927) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'combine\_css') { |
| [928](#L928) | return $html; |
| [929](#L929) | } |
| [930](#L930) |  |
| [931](#L931) | if (!empty($\_GET['debug\_preload\_inject'])) { |
| [932](#L932) | $dbg = 'Before:'; |
| [933](#L933) | $dbg .= $html; |
| [934](#L934) | } |
| [935](#L935) |  |
| [936](#L936) |  |
| [937](#L937) | $html = preg\_replace\_callback('/<head\b[^>]\*>/si', [$this, 'injectPreloadImages'], $html); |
| [938](#L938) |  |
| [939](#L939) | if (!empty($\_GET['debug\_preload\_inject'])) { |
| [940](#L940) | $dbg .= 'After:'; |
| [941](#L941) | $dbg .= $html; |
| [942](#L942) |  |
| [943](#L943) | return $dbg; |
| [944](#L944) | } |
| [945](#L945) |  |
| [946](#L946) | $combine\_css = new wps\_ic\_combine\_css(); |
| [947](#L947) | if (!empty($\_GET['criticalCombine']) || ($this->doCacheCombine() && (isset(self::$settings['css\_combine']) && self::$settings['css\_combine'] == '1'))) { |
| [948](#L948) | if (empty($\_GET['stopCombineCSS'])) { |
| [949](#L949) | $html = $combine\_css->maybe\_do\_combine($html); |
| [950](#L950) | } |
| [951](#L951) | } |
| [952](#L952) |  |
| [953](#L953) | // Critical CSS Remove from Header |
| [954](#L954) | $criticalActive = !(isset(self::$page\_excludes['critical\_css']) && self::$page\_excludes['critical\_css'] == '0') && ((isset(self::$settings['critical']['css']) && self::$settings['critical']['css'] == '1') || (isset(self::$page\_excludes['critical\_css']) && self::$page\_excludes['critical\_css'] == '1')); |
| [955](#L955) |  |
| [956](#L956) | $criticalCSS = new wps\_criticalCss(); |
| [957](#L957) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [958](#L958) |  |
| [959](#L959) | if ((empty($\_GET['disableCritical']) && empty($\_GET['generateCriticalAPI'])) && empty($\_GET['criticalCombine'])) { |
| [960](#L960) | if (!is\_user\_logged\_in() && !is\_admin\_bar\_showing()) { |
| [961](#L961) |  |
| [962](#L962) | if ($criticalActive && !self::$preloaderAPI) { |
| [963](#L963) | global $post; |
| [964](#L964) |  |
| [965](#L965) | if (!empty($\_GET['forceCriticalAjax'])) { |
| [966](#L966) | $html = self::$rewriteLogic->runCriticalAjax($html); |
| [967](#L967) | } else { |
| [968](#L968) | if (empty($criticalCSSExists)) { |
| [969](#L969) | $criticalRunning = $criticalCSS->criticalRunning(); |
| [970](#L970) | if (!$criticalRunning) { |
| [971](#L971) | set\_transient('wpc\_critical\_ajax\_' . md5($\_SERVER['REQUEST\_URI']), date('d.m.Y H:i:s'), 60 \* 5); |
| [972](#L972) | $html = self::$rewriteLogic->runCriticalAjax($html); |
| [973](#L973) | } |
| [974](#L974) | } |
| [975](#L975) |  |
| [976](#L976) | } |
| [977](#L977) | } |
| [978](#L978) |  |
| [979](#L979) | } |
| [980](#L980) | } |
| [981](#L981) |  |
| [982](#L982) | if (empty($\_GET['criticalCombine'])) { |
| [983](#L983) | if (isset(self::$settings['inline-css']) && self::$settings['inline-css'] == '1') { |
| [984](#L984) | // TODO: Maybe add something? |
| [985](#L985) | if ($criticalActive && !empty($criticalCSSExists)) { |
| [986](#L986) | //critical exists, dont inline |
| [987](#L987) | } else { |
| [988](#L988) | $html = $combine\_css->doInline($html); |
| [989](#L989) | } |
| [990](#L990) | } else { |
| [991](#L991) |  |
| [992](#L992) | //Combine CSS |
| [993](#L993) | if (($this->doCacheCombine() && (isset(self::$settings['css\_combine']) && self::$settings['css\_combine'] == '1')) || $this->criticalCombine) { |
| [994](#L994) | if (empty($\_GET['stopCombineCSS'])) { |
| [995](#L995) | $html = $combine\_css->maybe\_do\_combine($html); |
| [996](#L996) | } |
| [997](#L997) | } |
| [998](#L998) |  |
| [999](#L999) | } |
| [1000](#L1000) | } |
| [1001](#L1001) |  |
| [1002](#L1002) | if ((empty($\_GET['disableCritical']) && empty($\_GET['generateCriticalAPI'])) && empty($\_GET['criticalCombine'])) { |
| [1003](#L1003) | if (!is\_user\_logged\_in() && !is\_admin\_bar\_showing()) { |
| [1004](#L1004) | if (!empty($\_GET['debugCriticalRunning'])) { |
| [1005](#L1005) | $html .= print\_r([self::$settings['critical']['css'], $criticalCSSExists, $criticalRunning], true); |
| [1006](#L1006) | } |
| [1007](#L1007) |  |
| [1008](#L1008) |  |
| [1009](#L1009) | if (!empty($\_GET['debugCritical\_replace'])) { |
| [1010](#L1010) | #global $post; |
| [1011](#L1011) | $criticalCSS = new wps\_criticalCss(); |
| [1012](#L1012) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [1013](#L1013) | $criticalCSSContent = file\_get\_contents($criticalCSSExists['file']); |
| [1014](#L1014) |  |
| [1015](#L1015) | return print\_r([ |
| [1016](#L1016) | 'critActive:' => $criticalActive, |
| [1017](#L1017) | 'preloadApi' => self::$preloaderAPI, |
| [1018](#L1018) | 'excluded' => self::isURLExcluded('critical\_css'), |
| [1019](#L1019) | $criticalCSSExists, |
| [1020](#L1020) | $criticalCSSContent |
| [1021](#L1021) | ], true); |
| [1022](#L1022) | } |
| [1023](#L1023) |  |
| [1024](#L1024) | if (!empty($\_GET['testCritical'])) { |
| [1025](#L1025) | self::$settings['critical']['css'] = '1'; |
| [1026](#L1026) | $html = self::$rewriteLogic->lazyCSS($html); |
| [1027](#L1027) | $html = self::$rewriteLogic->addCritical($html); |
| [1028](#L1028) | } |
| [1029](#L1029) |  |
| [1030](#L1030) | if ($criticalActive && !self::$preloaderAPI) { |
| [1031](#L1031) |  |
| [1032](#L1032) | if (!self::isURLExcluded('critical\_css')) { |
| [1033](#L1033) |  |
| [1034](#L1034) | #global $post; |
| [1035](#L1035) | $criticalCSS = new wps\_criticalCss(); |
| [1036](#L1036) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [1037](#L1037) |  |
| [1038](#L1038) | if (!empty($criticalCSSExists)) { |
| [1039](#L1039) | $html = self::$rewriteLogic->lazyCSS($html); |
| [1040](#L1040) | $html = self::$rewriteLogic->addCritical($html); |
| [1041](#L1041) | } else { |
| [1042](#L1042) | //this way should be ok for multisite |
| [1043](#L1043) | } |
| [1044](#L1044) | } |
| [1045](#L1045) | } |
| [1046](#L1046) | } |
| [1047](#L1047) | } |
| [1048](#L1048) |  |
| [1049](#L1049) | //Delay JS |
| [1050](#L1050) | if (empty($\_GET['disableDelay']) && empty($\_GET['criticalCombine'])) { |
| [1051](#L1051) | $js\_delay = new wps\_ic\_js\_delay(); |
| [1052](#L1052) |  |
| [1053](#L1053) | $delayActive = !(isset(self::$page\_excludes['delay\_js']) && self::$page\_excludes['delay\_js'] == '0') && ((isset(self::$settings['delay-js']) && self::$settings['delay-js'] == '1') || (isset(self::$page\_excludes['delay\_js']) && self::$page\_excludes['delay\_js'] == '1')); |
| [1054](#L1054) |  |
| [1055](#L1055) | if (empty($\_GET['disableCritical']) && $delayActive && !current\_user\_can('manage\_options') && !self::$delay\_js\_override && !self::$preloaderAPI) { |
| [1056](#L1056) | if (!empty(self::$settings['preload-scripts']) && self::$settings['preload-scripts'] == '1') { |
| [1057](#L1057) | $html = $js\_delay->preload\_scripts($html); |
| [1058](#L1058) | } |
| [1059](#L1059) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$js\_delay, 'delay\_script\_replace'], $html); |
| [1060](#L1060) | } else { |
| [1061](#L1061) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$js\_delay, 'removeNoDelay'], $html); |
| [1062](#L1062) | } |
| [1063](#L1063) | } |
| [1064](#L1064) |  |
| [1065](#L1065) | // Cache |
| [1066](#L1066) | $cacheActive = !(isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '0') && ((isset(self::$settings['cache']['advanced']) && self::$settings['cache']['advanced'] == '1') || (isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '1')); |
| [1067](#L1067) |  |
| [1068](#L1068) | // Theme Integrations |
| [1069](#L1069) | return self::$themeIntegrations->getIntegration($html); |
| [1070](#L1070) | } |
| [1071](#L1071) |  |
| [1072](#L1072) | public static function dontRunif() |
| [1073](#L1073) | { |
| [1074](#L1074) | // is url excluded? |
| [1075](#L1075) | if (!empty(self::$settings['exclude-url-from-all']) && self::$settings['exclude-url-from-all'] == 1) { |
| [1076](#L1076) | $url = $\_SERVER['HTTP\_HOST'] . $\_SERVER['REQUEST\_URI']; |
| [1077](#L1077) | $url = explode('?', $url); |
| [1078](#L1078) | $url = $url[0]; |
| [1079](#L1079) | $url\_excludes = get\_option('wpc-url-excludes'); |
| [1080](#L1080) | if (!empty($url\_excludes['exclude-url-from-all']) && in\_array($url, $url\_excludes['exclude-url-from-all'])) { |
| [1081](#L1081) | return false; |
| [1082](#L1082) | } |
| [1083](#L1083) | } |
| [1084](#L1084) |  |
| [1085](#L1085) | if (!empty($\_GET['pagelayer-live'])) { |
| [1086](#L1086) | return true; |
| [1087](#L1087) | } |
| [1088](#L1088) |  |
| [1089](#L1089) | // Any hide login plugins active? |
| [1090](#L1090) | if (self::hiddenAdminArea()) { |
| [1091](#L1091) | return false; |
| [1092](#L1092) | } |
| [1093](#L1093) |  |
| [1094](#L1094) | //WP User Frontend check |
| [1095](#L1095) | if (class\_exists('WP\_User\_Frontend')) { |
| [1096](#L1096) | $content = get\_post\_field('post\_content', get\_the\_ID()); |
| [1097](#L1097) |  |
| [1098](#L1098) | // Check if the content contains wpuf shorcode |
| [1099](#L1099) | if (preg\_match('/\[wpuf/', $content)) { |
| [1100](#L1100) | return false; |
| [1101](#L1101) | } |
| [1102](#L1102) | } |
| [1103](#L1103) |  |
| [1104](#L1104) | if (self::MediaActions()) { |
| [1105](#L1105) | return false; |
| [1106](#L1106) | } |
| [1107](#L1107) |  |
| [1108](#L1108) | if (strpos($\_SERVER['REQUEST\_URI'], 'jm-ajax') !== false) { |
| [1109](#L1109) | return false; |
| [1110](#L1110) | } |
| [1111](#L1111) |  |
| [1112](#L1112) | if (isset($\_GET['woo\_ajax']) || isset($\_POST['woo\_ajax']) || (isset($\_SERVER['REQUEST\_URI']) && (strpos($\_SERVER['REQUEST\_URI'], 'woo\_ajax') !== false))) { |
| [1113](#L1113) | return false; |
| [1114](#L1114) | } |
| [1115](#L1115) |  |
| [1116](#L1116) | if (defined('DOING\_AUTOSAVE')) { |
| [1117](#L1117) | return false; |
| [1118](#L1118) | } |
| [1119](#L1119) |  |
| [1120](#L1120) | if (isset($\_SERVER['REQUEST\_URI']) && (strpos($\_SERVER['REQUEST\_URI'], 'cornerstone') !== false || strpos($\_SERVER['REQUEST\_URI'], 'sitemap') !== false)) { |
| [1121](#L1121) | return false; |
| [1122](#L1122) | } |
| [1123](#L1123) |  |
| [1124](#L1124) | if (!empty($\_POST['\_cs\_nonce'])) { //cornerstone |
| [1125](#L1125) | return false; |
| [1126](#L1126) | } |
| [1127](#L1127) |  |
| [1128](#L1128) | if (is\_admin() || strpos($\_SERVER['REQUEST\_URI'], 'wp-login.php') !== false) { |
| [1129](#L1129) | return false; |
| [1130](#L1130) | } |
| [1131](#L1131) |  |
| [1132](#L1132) | if (!empty($\_SERVER['REQUEST\_URI'])) { |
| [1133](#L1133) | if (strpos($\_SERVER['REQUEST\_URI'], 'wp-json') || strpos($\_SERVER['REQUEST\_URI'], 'rest\_route')) { |
| [1134](#L1134) | return false; |
| [1135](#L1135) | } |
| [1136](#L1136) | } |
| [1137](#L1137) |  |
| [1138](#L1138) | if (isset($\_GET['brizy-edit-iframe']) || isset($\_GET['brizy-edit']) || isset($\_GET['preview'])) { |
| [1139](#L1139) | return false; |
| [1140](#L1140) | } |
| [1141](#L1141) |  |
| [1142](#L1142) | if (!empty($\_GET['page']) && $\_GET['page'] == 'bwc') { |
| [1143](#L1143) | return false; |
| [1144](#L1144) | } |
| [1145](#L1145) |  |
| [1146](#L1146) |  |
| [1147](#L1147) | if (!empty($\_GET['trp-edit-translation']) || (!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor') || !empty($\_GET['bwc']) || !empty($\_GET['fb-edit']) || !empty($\_GET['bricks']) || !empty($\_GET['elementor-preview']) || !empty($\_GET['PageSpeed']) || (!empty($\_GET['fl\_builder']) || isset($\_GET['fl\_builder'])) || !empty($\_GET['et\_fb']) || !empty($\_GET['tatsu']) || !empty($\_GET['tatsu-header']) || !empty($\_GET['tatsu-footer']) || !empty($\_GET['tve'])  || !empty($\_GET['is-editor-iframe']) || !empty |
| [1148](#L1148) | ($\_GET['ct\_builder']) || (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") || (!empty($\_GET['page']) && $\_GET['page'] == 'livecomposer\_editor')) { |
| [1149](#L1149) | return false; |
| [1150](#L1150) | } |
| [1151](#L1151) |  |
| [1152](#L1152) | if ((!empty($\_GET['action']) && $\_GET['action'] == 'edit#op-builder') || !empty($\_GET['op3editor'])) { |
| [1153](#L1153) | //optimizePress builder fix |
| [1154](#L1154) | return false; |
| [1155](#L1155) | } |
| [1156](#L1156) |  |
| [1157](#L1157) | if (!empty($\_POST['pp\_action'])) { |
| [1158](#L1158) | //power pack for beaver builder ajax get posts fix |
| [1159](#L1159) | return false; |
| [1160](#L1160) | } |
| [1161](#L1161) |  |
| [1162](#L1162) | if (!empty($\_POST['add-to-cart'])) { |
| [1163](#L1163) | //woo on some themes slow add to cart fix |
| [1164](#L1164) | return false; |
| [1165](#L1165) | } |
| [1166](#L1166) |  |
| [1167](#L1167) | if (!empty($\_GET['wc-ajax']) && $\_GET['wc-ajax'] == 'get\_refreshed\_fragments') { |
| [1168](#L1168) | return false; |
| [1169](#L1169) | } |
| [1170](#L1170) |  |
| [1171](#L1171) | if (!empty($\_GET['lc\_action\_launch\_editing'])) { |
| [1172](#L1172) | return false; |
| [1173](#L1173) | } |
| [1174](#L1174) |  |
| [1175](#L1175) | return true; |
| [1176](#L1176) | } |
| [1177](#L1177) |  |
| [1178](#L1178) | public static function hiddenAdminArea() |
| [1179](#L1179) | { |
| [1180](#L1180) |  |
| [1181](#L1181) | // AIOS |
| [1182](#L1182) | if (class\_exists('AIO\_WP\_Security')) { |
| [1183](#L1183) | // Hide Login Exists |
| [1184](#L1184) | $configs = get\_option('aio\_wp\_security\_configs'); |
| [1185](#L1185) | if (!empty($configs['aiowps\_login\_page\_slug'])) { |
| [1186](#L1186) | if (strpos($\_SERVER['REQUEST\_URI'], $configs['aiowps\_login\_page\_slug']) !== false) { |
| [1187](#L1187) | return true; |
| [1188](#L1188) | } |
| [1189](#L1189) | } |
| [1190](#L1190) | } |
| [1191](#L1191) |  |
| [1192](#L1192) | // WPS Hide Login |
| [1193](#L1193) | if (class\_exists('WPS\WPS\_Hide\_Login\Plugin')) { |
| [1194](#L1194) | // Hide Login Exists |
| [1195](#L1195) | $loginPage = get\_option('whl\_page'); |
| [1196](#L1196) | if (!empty($loginPage)) { |
| [1197](#L1197) | if (strpos($\_SERVER['REQUEST\_URI'], '/' . $loginPage) !== false) { |
| [1198](#L1198) | return true; |
| [1199](#L1199) | } |
| [1200](#L1200) | } |
| [1201](#L1201) | } |
| [1202](#L1202) |  |
| [1203](#L1203) | // Hide My WP - Ghost |
| [1204](#L1204) | if (class\_exists('HMWP\_Classes\_ObjController')) { |
| [1205](#L1205) | $option = get\_option('hmwp\_options'); |
| [1206](#L1206) |  |
| [1207](#L1207) | if (!empty($option)) { |
| [1208](#L1208) | $option = json\_decode($option, true); |
| [1209](#L1209) | $loginPage = $option['hmwp\_login\_url']; |
| [1210](#L1210) | if (!empty($loginPage)) { |
| [1211](#L1211) | if (strpos($\_SERVER['REQUEST\_URI'], $loginPage) !== false) { |
| [1212](#L1212) | return true; |
| [1213](#L1213) | } |
| [1214](#L1214) | } |
| [1215](#L1215) | } |
| [1216](#L1216) | } |
| [1217](#L1217) |  |
| [1218](#L1218) | } |
| [1219](#L1219) |  |
| [1220](#L1220) | public static function MediaActions() |
| [1221](#L1221) | { |
| [1222](#L1222) | if (!empty($\_GET['preloadCache'])) { |
| [1223](#L1223) | return true; |
| [1224](#L1224) | } |
| [1225](#L1225) |  |
| [1226](#L1226) | if (!empty($\_GET['getAllImages'])) { |
| [1227](#L1227) | return true; |
| [1228](#L1228) | } |
| [1229](#L1229) |  |
| [1230](#L1230) | if (!empty($\_POST['getImageByID']) || !empty($\_GET['getImageByID'])) { |
| [1231](#L1231) | return true; |
| [1232](#L1232) | } |
| [1233](#L1233) |  |
| [1234](#L1234) | if (!empty($\_POST['deliverSingleImage']) || !empty($\_GET['deliverSingleImage'])) { |
| [1235](#L1235) | return true; |
| [1236](#L1236) | } |
| [1237](#L1237) |  |
| [1238](#L1238) | if (!empty($\_POST['deliverImages']) || !empty($\_GET['deliverImages'])) { |
| [1239](#L1239) | return true; |
| [1240](#L1240) | } |
| [1241](#L1241) |  |
| [1242](#L1242) | if (!empty($\_POST['restoreImages']) || !empty($\_GET['restoreImages'])) { |
| [1243](#L1243) | return true; |
| [1244](#L1244) | } |
| [1245](#L1245) | } |
| [1246](#L1246) |  |
| [1247](#L1247) | public function doCacheCombine() |
| [1248](#L1248) | { |
| [1249](#L1249) | if (is\_404()) { |
| [1250](#L1250) | return false; |
| [1251](#L1251) | } |
| [1252](#L1252) |  |
| [1253](#L1253) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'direct') { |
| [1254](#L1254) | return false; |
| [1255](#L1255) | } |
| [1256](#L1256) |  |
| [1257](#L1257) | if (!empty($\_GET['forceRecombine']) && $\_GET['forceRecombine'] == 'true') { |
| [1258](#L1258) | return true; |
| [1259](#L1259) | } |
| [1260](#L1260) |  |
| [1261](#L1261) | $keys = new wps\_ic\_url\_key(); |
| [1262](#L1262) | $allowed\_params = $keys->get\_allowed\_params(); |
| [1263](#L1263) | $get\_keys = array\_keys($\_GET); |
| [1264](#L1264) |  |
| [1265](#L1265) | sort($allowed\_params); |
| [1266](#L1266) | sort($get\_keys); |
| [1267](#L1267) |  |
| [1268](#L1268) | if ($allowed\_params === $get\_keys) { |
| [1269](#L1269) | return true; |
| [1270](#L1270) | } |
| [1271](#L1271) |  |
| [1272](#L1272) | if (!empty($\_GET)) { |
| [1273](#L1273) | return false; |
| [1274](#L1274) | } |
| [1275](#L1275) |  |
| [1276](#L1276) | if (current\_user\_can('manage\_options')) { |
| [1277](#L1277) | return false; |
| [1278](#L1278) | } |
| [1279](#L1279) |  |
| [1280](#L1280) | if (self::dontRunif()) { |
| [1281](#L1281) | return true; |
| [1282](#L1282) | } |
| [1283](#L1283) |  |
| [1284](#L1284) | if ($this->isPageBuilder()) { |
| [1285](#L1285) | return false; |
| [1286](#L1286) | } |
| [1287](#L1287) |  |
| [1288](#L1288) | if ($this->isPageBuilderFE()) { |
| [1289](#L1289) | return false; |
| [1290](#L1290) | } |
| [1291](#L1291) |  |
| [1292](#L1292) | if ($this->isFEBuilder()) { |
| [1293](#L1293) | return false; |
| [1294](#L1294) | } |
| [1295](#L1295) |  |
| [1296](#L1296) | if ($this->isAPICall()) { |
| [1297](#L1297) | return false; |
| [1298](#L1298) | } |
| [1299](#L1299) |  |
| [1300](#L1300) | if (wp\_doing\_cron()) { |
| [1301](#L1301) | return false; |
| [1302](#L1302) | } |
| [1303](#L1303) |  |
| [1304](#L1304) |  |
| [1305](#L1305) | return true; |
| [1306](#L1306) | } |
| [1307](#L1307) |  |
| [1308](#L1308) | /\*\* |
| [1309](#L1309) | \* FrontEnd Editors Detection for various page builders |
| [1310](#L1310) | \* @return bool |
| [1311](#L1311) | \*/ |
| [1312](#L1312) | public static function isPageBuilder() |
| [1313](#L1313) | { |
| [1314](#L1314) | $page\_builders = [ |
| [1315](#L1315) | 'run\_compress', //wpc |
| [1316](#L1316) | 'run\_restore', //wpc |
| [1317](#L1317) | 'elementor-preview', //elementor |
| [1318](#L1318) | 'fl\_builder', //beaver builder |
| [1319](#L1319) | 'et\_fb', //divi |
| [1320](#L1320) | 'preview', //WP Preview |
| [1321](#L1321) | 'builder', //builder |
| [1322](#L1322) | 'brizy', //brizy |
| [1323](#L1323) | 'fb-edit', //avada |
| [1324](#L1324) | 'bricks', //bricks |
| [1325](#L1325) | 'ct\_template', //ct\_template |
| [1326](#L1326) | 'ct\_builder', //ct\_builder |
| [1327](#L1327) | 'cs-render', //cornerstone |
| [1328](#L1328) | 'tatsu', //tatsu |
| [1329](#L1329) | 'trp-edit-translation', //thrive |
| [1330](#L1330) | 'brizy-edit-iframe', //brizy |
| [1331](#L1331) | 'ct\_builder', //oxygen |
| [1332](#L1332) | 'livecomposer\_editor', //livecomposer |
| [1333](#L1333) | 'tatsu', //tatsu |
| [1334](#L1334) | 'tatsu-header', //tatsu-header |
| [1335](#L1335) | 'tatsu-footer', //tatsu-footer |
| [1336](#L1336) | 'is-editor-iframe', //tatsu-footer |
| [1337](#L1337) | 'tve', //thrive |
| [1338](#L1338) | 'pagelayer-live' |
| [1339](#L1339) | ]; |
| [1340](#L1340) |  |
| [1341](#L1341) | if (isset($\_SERVER['REQUEST\_URI']) && strpos($\_SERVER['REQUEST\_URI'], 'cornerstone') !== false) { |
| [1342](#L1342) | return true; |
| [1343](#L1343) | } |
| [1344](#L1344) |  |
| [1345](#L1345) | if ((!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor')) { |
| [1346](#L1346) | //brizyFrontend fix |
| [1347](#L1347) | return true; |
| [1348](#L1348) | } |
| [1349](#L1349) |  |
| [1350](#L1350) | if ((!empty($\_GET['action']) && sanitize\_text\_field($\_GET['action']) == 'edit#op-builder') || !empty($\_GET['op3editor'])) { |
| [1351](#L1351) | //optimizePress builder fix |
| [1352](#L1352) | return true; |
| [1353](#L1353) | } |
| [1354](#L1354) |  |
| [1355](#L1355) | if (!empty($\_SERVER['REQUEST\_URI'])) { |
| [1356](#L1356) | if (strpos($\_SERVER['REQUEST\_URI'], 'wp-json') || strpos($\_SERVER['REQUEST\_URI'], 'rest\_route')) { |
| [1357](#L1357) | return false; |
| [1358](#L1358) | } |
| [1359](#L1359) | } |
| [1360](#L1360) |  |
| [1361](#L1361) | if (!empty($page\_builders)) { |
| [1362](#L1362) | foreach ($page\_builders as $page\_builder) { |
| [1363](#L1363) | if (isset($\_GET[$page\_builder])) { |
| [1364](#L1364) | return true; |
| [1365](#L1365) | } |
| [1366](#L1366) | } |
| [1367](#L1367) | } |
| [1368](#L1368) |  |
| [1369](#L1369) | return false; |
| [1370](#L1370) | } |
| [1371](#L1371) |  |
| [1372](#L1372) | /\*\* |
| [1373](#L1373) | \* FrontEnd Editors Detection for various page builders |
| [1374](#L1374) | \* @return bool |
| [1375](#L1375) | \*/ |
| [1376](#L1376) | public static function isPageBuilderFE() |
| [1377](#L1377) | { |
| [1378](#L1378) | if (class\_exists('BT\_BB\_Root')) { |
| [1379](#L1379) | if (is\_user\_logged\_in() && !is\_admin()) { |
| [1380](#L1380) | return true; |
| [1381](#L1381) | } |
| [1382](#L1382) | } |
| [1383](#L1383) |  |
| [1384](#L1384) | return false; |
| [1385](#L1385) | } |
| [1386](#L1386) |  |
| [1387](#L1387) | public static function isFEBuilder() |
| [1388](#L1388) | { |
| [1389](#L1389) | if (!empty($\_GET['trp-edit-translation']) || (!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor') || !empty($\_GET['elementor-preview']) || !empty($\_GET['tatsu']) || !empty($\_GET['preview']) || !empty($\_GET['PageSpeed']) || !empty($\_GET['tve']) || !empty($\_GET['et\_fb']) || (!empty($\_GET['fl\_builder']) || isset($\_GET['fl\_builder'])) || !empty($\_GET['ct\_builder']) || !empty($\_GET['fb-edit']) || !empty($\_GET['bricks'])|| !empty($\_GET['is-editor-iframe']) || !empty($\_GET['brizy-edit-iframe']) || !empty($\_GET['brizy-edit']) || (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") || (!empty($\_GET['page']) && $\_GET['page'] == 'livecomposer\_editor')) { |
| [1390](#L1390) | return true; |
| [1391](#L1391) | } else { |
| [1392](#L1392) | return false; |
| [1393](#L1393) | } |
| [1394](#L1394) | } |
| [1395](#L1395) |  |
| [1396](#L1396) | public function isAPICall() |
| [1397](#L1397) | { |
| [1398](#L1398) | if (!empty($\_SERVER['HTTP\_USER\_AGENT'])) { |
| [1399](#L1399) | if (strpos($\_SERVER['HTTP\_USER\_AGENT'], 'Compress-API') !== false) { |
| [1400](#L1400) | return true; |
| [1401](#L1401) | } |
| [1402](#L1402) | } |
| [1403](#L1403) |  |
| [1404](#L1404) | return false; |
| [1405](#L1405) | } |
| [1406](#L1406) |  |
| [1407](#L1407) | public static function isURLExcluded($setting) |
| [1408](#L1408) | { |
| [1409](#L1409) | if (!isset(self::$excludes[$setting]) || empty(self::$excludes[$setting])) { |
| [1410](#L1410) | return false; |
| [1411](#L1411) | } |
| [1412](#L1412) |  |
| [1413](#L1413) | $url = self::$keys->url; |
| [1414](#L1414) | $excludeList = self::$excludes[$setting]; |
| [1415](#L1415) | if (!empty($excludeList)) { |
| [1416](#L1416) | foreach ($excludeList as $key => $value) { |
| [1417](#L1417) | if ($value) { |
| [1418](#L1418) | if (strpos($url, $value) !== false) { |
| [1419](#L1419) | return true; |
| [1420](#L1420) | } |
| [1421](#L1421) | } |
| [1422](#L1422) | } |
| [1423](#L1423) | } |
| [1424](#L1424) |  |
| [1425](#L1425) | return false; |
| [1426](#L1426) | } |
| [1427](#L1427) |  |
| [1428](#L1428) | public function checkCache() |
| [1429](#L1429) | { |
| [1430](#L1430) | if (!empty($\_GET['disableCache']) || !empty($\_GET['forceRecombine'])) { |
| [1431](#L1431) | return true; |
| [1432](#L1432) | } |
| [1433](#L1433) |  |
| [1434](#L1434) | if (!empty($\_GET['dbg\_checkCache'])) { |
| [1435](#L1435) | die('Check cache'); |
| [1436](#L1436) | } |
| [1437](#L1437) |  |
| [1438](#L1438) | if (self::dontRunif()) { |
| [1439](#L1439) | /\*\* |
| [1440](#L1440) | \* Check for cache first |
| [1441](#L1441) | \*/ |
| [1442](#L1442) |  |
| [1443](#L1443) | if (!empty($\_GET['dontRunCache'])) { |
| [1444](#L1444) | die('Check cache 23'); |
| [1445](#L1445) | } |
| [1446](#L1446) |  |
| [1447](#L1447) | $isUserLoggedIn = is\_user\_logged\_in(); |
| [1448](#L1448) | if ($isUserLoggedIn) { |
| [1449](#L1449) | return true; |
| [1450](#L1450) | } |
| [1451](#L1451) |  |
| [1452](#L1452) | $cache = new wps\_cacheHtml(); |
| [1453](#L1453) | if ($cache->cacheEnabled()) { |
| [1454](#L1454) |  |
| [1455](#L1455) | if (!empty($\_GET['cacheDbg2'])) { |
| [1456](#L1456) | die('x'); |
| [1457](#L1457) | } |
| [1458](#L1458) |  |
| [1459](#L1459) | $mobile = self::is\_mobile(); |
| [1460](#L1460) | $prefix = ''; |
| [1461](#L1461) | if ($mobile) { |
| [1462](#L1462) | $prefix = 'mobile'; |
| [1463](#L1463) | } |
| [1464](#L1464) | if ($cache->cacheExists($prefix)) { |
| [1465](#L1465) | $isCacheExpired = false; |
| [1466](#L1466) |  |
| [1467](#L1467) | // Not required as get cache sorts this |
| [1468](#L1468) | $isCacheValid = true; |
| [1469](#L1469) |  |
| [1470](#L1470) | if (!$isCacheExpired && $isCacheValid) { |
| [1471](#L1471) | $cache->getCache($prefix); |
| [1472](#L1472) | die(); |
| [1473](#L1473) | } |
| [1474](#L1474) |  |
| [1475](#L1475) | } |
| [1476](#L1476) | } |
| [1477](#L1477) |  |
| [1478](#L1478) | } |
| [1479](#L1479) | } |
| [1480](#L1480) |  |
| [1481](#L1481) | public function is\_mobile() |
| [1482](#L1482) | { |
| [1483](#L1483) | if (!empty($\_GET['simulate\_mobile'])) { |
| [1484](#L1484) | return true; |
| [1485](#L1485) | } |
| [1486](#L1486) |  |
| [1487](#L1487) | if (isset($\_SERVER['HTTP\_USER\_AGENT']) && (preg\_match('#^.\*(2.0\ MMP|240x320|400X240|AvantGo|BlackBerry|Blazer|Cellphone|Danger|DoCoMo|Elaine/3.0|EudoraWeb|Googlebot-Mobile|hiptop|IEMobile|KYOCERA/WX310K|LG/U990|MIDP-2.|MMEF20|MOT-V|NetFront|Newt|Nintendo\ Wii|Nitro|Nokia|Opera\ Mini|Palm|PlayStation\ Portable|portalmmm|Proxinet|ProxiNet|SHARP-TQ-GX10|SHG-i900|Small|SonyEricsson|Symbian\ OS|SymbianOS|TS21i-10|UP.Browser|UP.Link|webOS|Windows\ CE|WinWAP|YahooSeeker/M1A1-R2D2|iPhone|iPod|Android|BlackBerry9530|LG-TU915\ Obigo|LGE\ VX|webOS|Nokia5800).\*#i', $\_SERVER['HTTP\_USER\_AGENT']) || preg\_match('#^(w3c\ |w3c-|acs-|alav|alca|amoi|audi|avan|benq|bird|blac|blaz|brew|cell|cldc|cmd-|dang|doco|eric|hipt|htc\_|inno|ipaq|ipod|jigs|kddi|keji|leno|lg-c|lg-d|lg-g|lge-|lg/u|maui|maxo|midp|mits|mmef|mobi|mot-|moto|mwbp|nec-|newt|noki|palm|pana|pant|phil|play|port|prox|qwap|sage|sams|sany|sch-|sec-|send|seri|sgh-|shar|sie-|siem|smal|smar|sony|sph-|symb|t-mo|teli|tim-|tosh|tsm-|upg1|upsi|vk-v|voda|wap-|wapa|wapi|wapp|wapr|webc|winw|winw|xda\ |xda-).\*#i', substr($\_SERVER['HTTP\_USER\_AGENT'], 0, 4)))) { |
| [1488](#L1488) | return true; |
| [1489](#L1489) | } |
| [1490](#L1490) |  |
| [1491](#L1491) | return false; |
| [1492](#L1492) | } |
| [1493](#L1493) |  |
| [1494](#L1494) | public function checkCache\_plugins\_loaded() |
| [1495](#L1495) | { |
| [1496](#L1496) | if (!empty($\_GET['disableCache']) || !empty($\_GET['forceRecombine'])) { |
| [1497](#L1497) | return true; |
| [1498](#L1498) | } |
| [1499](#L1499) |  |
| [1500](#L1500) | if (!empty($\_GET['dbg\_checkCache'])) { |
| [1501](#L1501) | die('Check cache'); |
| [1502](#L1502) | } |
| [1503](#L1503) |  |
| [1504](#L1504) | if (self::dontRunif()) { |
| [1505](#L1505) | /\*\* |
| [1506](#L1506) | \* Check for cache first |
| [1507](#L1507) | \*/ |
| [1508](#L1508) |  |
| [1509](#L1509) | if (!empty($\_GET['dontRunCache'])) { |
| [1510](#L1510) | die('Check cache 23'); |
| [1511](#L1511) | } |
| [1512](#L1512) |  |
| [1513](#L1513) | $isUserLoggedIn = is\_user\_logged\_in(); |
| [1514](#L1514) | if ($isUserLoggedIn) { |
| [1515](#L1515) | return true; |
| [1516](#L1516) | } |
| [1517](#L1517) |  |
| [1518](#L1518) | $cache = new wps\_cacheHtml(); |
| [1519](#L1519) | if ($cache->cacheEnabled()) { |
| [1520](#L1520) |  |
| [1521](#L1521) | if (!empty($\_GET['cacheDbg2'])) { |
| [1522](#L1522) | die('x'); |
| [1523](#L1523) | } |
| [1524](#L1524) |  |
| [1525](#L1525) | $mobile = self::is\_mobile(); |
| [1526](#L1526) | $prefix = ''; |
| [1527](#L1527) | if ($mobile) { |
| [1528](#L1528) | $prefix = 'mobile'; |
| [1529](#L1529) | } |
| [1530](#L1530) | if ($cache->cacheExists($prefix)) { |
| [1531](#L1531) | $isCacheExpired = false; |
| [1532](#L1532) |  |
| [1533](#L1533) | // Not required as get cache sorts this |
| [1534](#L1534) | $isCacheValid = true; |
| [1535](#L1535) |  |
| [1536](#L1536) | if (!$isCacheExpired && $isCacheValid) { |
| [1537](#L1537) | $cache->getCache($prefix); |
| [1538](#L1538) | die(); |
| [1539](#L1539) | } |
| [1540](#L1540) |  |
| [1541](#L1541) | } else { |
| [1542](#L1542) | ob\_start([$this, 'saveCache']); |
| [1543](#L1543) | } |
| [1544](#L1544) | } |
| [1545](#L1545) |  |
| [1546](#L1546) | } |
| [1547](#L1547) | } |
| [1548](#L1548) |  |
| [1549](#L1549) | public function buffer\_callback\_v3() |
| [1550](#L1550) | { |
| [1551](#L1551) |  |
| [1552](#L1552) | if (is\_admin()) { |
| [1553](#L1553) | return true; |
| [1554](#L1554) | } |
| [1555](#L1555) |  |
| [1556](#L1556) | if (!empty($\_GET['buffer\_callback'])) { |
| [1557](#L1557) | echo 'Buffer CallBack is Working'; |
| [1558](#L1558) | die(); |
| [1559](#L1559) | } |
| [1560](#L1560) |  |
| [1561](#L1561) | // Is an ajax request? |
| [1562](#L1562) | self::$isAjax = (function\_exists("wp\_doing\_ajax") && wp\_doing\_ajax()) || (defined('DOING\_AJAX') && DOING\_AJAX); |
| [1563](#L1563) |  |
| [1564](#L1564) | // TODO: Check this for wpadmin and frontend ajax |
| [1565](#L1565) | if (!self::$isAjax) { |
| [1566](#L1566) | if (is\_admin() || !empty($\_GET['trp-edit-translation']) || (!empty($\_GET['action']) && $\_GET['action'] == 'in-front-editor') || (!empty($\_GET['fl\_builder']) || isset($\_GET['fl\_builder'])) || !empty($\_GET['elementor-preview']) || !empty($\_GET['preview']) || !empty($\_GET['PageSpeed']) || !empty($\_GET['et\_fb']) || !empty($\_GET['is-editor-iframe']) || !empty($\_GET['tve']) || !empty($\_GET['tatsu']) || !empty($\_GET['ct\_builder']) || !empty($\_GET['fb-edit']) || (!empty($\_GET['builder']) && !empty($\_GET['builder\_id'])) || !empty($\_GET['bricks']) || (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") || (!empty($\_GET['page']) && $\_GET['page'] == 'livecomposer\_editor') || !empty($\_GET['pagelayer-live'])) { |
| [1567](#L1567) | return true; |
| [1568](#L1568) | } |
| [1569](#L1569) |  |
| [1570](#L1570) | if (!empty($\_GET['tatsu']) || !empty($\_GET['tatsu-header']) || !empty($\_GET['tatsu-footer'])) { |
| [1571](#L1571) | return true; |
| [1572](#L1572) | } |
| [1573](#L1573) | } |
| [1574](#L1574) |  |
| [1575](#L1575) | $init = $this->mainInit(); |
| [1576](#L1576) |  |
| [1577](#L1577) | if (!self::$cdnEnabled && !in\_array($\_SERVER['PHP\_SELF'], ['/wp-login.php', '/wp-register.php'])) { |
| [1578](#L1578) | $this->cdn = new wps\_cdn\_rewrite(); |
| [1579](#L1579) | add\_action('template\_redirect', [$this->cdn, 'buffer\_local\_go']); |
| [1580](#L1580) |  |
| [1581](#L1581) | return true; |
| [1582](#L1582) | } |
| [1583](#L1583) |  |
| [1584](#L1584) | if (isset($post->post\_type) && strpos($post->post\_type, 'wfocu') !== false) { |
| [1585](#L1585) | // Ignore Post Types |
| [1586](#L1586) | } else { |
| [1587](#L1587) | if (!empty($\_GET['generateCritical'])) { |
| [1588](#L1588) | if (!empty(self::$settings['critical']['css']) && self::$settings['critical']['css'] == '1') { |
| [1589](#L1589) | self::$criticalCss->sendCriticalUrl(); |
| [1590](#L1590) | } |
| [1591](#L1591) | } |
| [1592](#L1592) |  |
| [1593](#L1593) | if (empty($\_GET['wpc\_no\_buffer'])) { |
| [1594](#L1594) | ob\_start([$this, 'cdnRewriter']); |
| [1595](#L1595) | } |
| [1596](#L1596) | } |
| [1597](#L1597) | } |
| [1598](#L1598) |  |
| [1599](#L1599) | public function mainInit() |
| [1600](#L1600) | { |
| [1601](#L1601) | if (is\_admin()) { |
| [1602](#L1602) | return; |
| [1603](#L1603) | } |
| [1604](#L1604) |  |
| [1605](#L1605) | // Raise memory limit |
| [1606](#L1606) | ini\_set('memory\_limit', '1024M'); |
| [1607](#L1607) |  |
| [1608](#L1608) | global $post; |
| [1609](#L1609) | self::$options = get\_option(WPS\_IC\_OPTIONS); |
| [1610](#L1610) |  |
| [1611](#L1611) | if (!isset(self::$options['api\_key']) || empty(self::$options['api\_key'])) { |
| [1612](#L1612) | return; |
| [1613](#L1613) | } |
| [1614](#L1614) |  |
| [1615](#L1615) | if ($this->is\_home\_url()) { |
| [1616](#L1616) | if (!self::is\_mobile()) { |
| [1617](#L1617) | add\_action('wp\_head', [$this, 'preload\_custom\_assets'], 1); |
| [1618](#L1618) | } else { |
| [1619](#L1619) | add\_action('wp\_head', [$this, 'preload\_custom\_assetsMobile'], 1); |
| [1620](#L1620) | } |
| [1621](#L1621) | } |
| [1622](#L1622) |  |
| [1623](#L1623) | self::$excludes\_class = new wps\_ic\_excludes(); |
| [1624](#L1624) | self::$isAmp = new wps\_ic\_amp(); |
| [1625](#L1625) | self::$preloaderAPI = 0; |
| [1626](#L1626) |  |
| [1627](#L1627) | self::$settings = get\_option(WPS\_IC\_SETTINGS); |
| [1628](#L1628) | $this->compatibility = new wps\_ic\_compatibility(); |
| [1629](#L1629) | self::$settings = $this->compatibility->check(self::$settings); |
| [1630](#L1630) |  |
| [1631](#L1631) | if ($this->is\_home\_url()) { |
| [1632](#L1632) | self::$post\_id = 'home'; |
| [1633](#L1633) | self::$page\_excludes = isset(self::$excludes['page\_excludes']['home']) ? self::$excludes['page\_excludes']['home'] : []; |
| [1634](#L1634) | self::$page\_excludes\_files = isset(self::$excludes['page\_excludes\_files']['home']) ? self::$excludes['page\_excludes\_files']['home'] : []; |
| [1635](#L1635) | } elseif (!empty(get\_queried\_object\_id())) { |
| [1636](#L1636) | self::$post\_id = get\_queried\_object\_id(); |
| [1637](#L1637) | self::$page\_excludes = isset(self::$excludes['page\_excludes'][self::$post\_id]) ? self::$excludes['page\_excludes'][self::$post\_id] : []; |
| [1638](#L1638) | self::$page\_excludes\_files = isset(self::$excludes['page\_excludes\_files'][self::$post\_id]) ? self::$excludes['page\_excludes\_files'][self::$post\_id] : []; |
| [1639](#L1639) | } else if (!empty($post->ID)) { |
| [1640](#L1640) | self::$post\_id = $post->ID; |
| [1641](#L1641) | self::$page\_excludes = isset(self::$excludes['page\_excludes'][self::$post\_id]) ? self::$excludes['page\_excludes'][self::$post\_id] : []; |
| [1642](#L1642) | self::$page\_excludes\_files = isset(self::$excludes['page\_excludes\_files'][self::$post\_id]) ? self::$excludes['page\_excludes\_files'][self::$post\_id] : []; |
| [1643](#L1643) | } else { |
| [1644](#L1644) | self::$post\_id = false; |
| [1645](#L1645) | self::$page\_excludes = []; |
| [1646](#L1646) | self::$page\_excludes\_files = []; |
| [1647](#L1647) | } |
| [1648](#L1648) |  |
| [1649](#L1649) | if (isset(self::$page\_excludes['adaptive'])) { |
| [1650](#L1650) | self::$adaptive\_enabled = self::$page\_excludes['adaptive']; |
| [1651](#L1651) | } |
| [1652](#L1652) |  |
| [1653](#L1653) | if (self::$isAmp->isAmp()) { |
| [1654](#L1654) | self::$lazy\_enabled = '0'; |
| [1655](#L1655) | self::$adaptive\_enabled = '0'; |
| [1656](#L1656) | self::$retina\_enabled = '0'; |
| [1657](#L1657) | self::$settings['delay\_js'] = '0'; |
| [1658](#L1658) | self::$settings['inline-js'] = '0'; |
| [1659](#L1659) | } |
| [1660](#L1660) |  |
| [1661](#L1661) | $this->criticalCombine = false; |
| [1662](#L1662) | if (!empty($\_GET['criticalCombine']) && $\_GET['criticalCombine'] == 'true') { |
| [1663](#L1663) | $this->criticalCombine = true; |
| [1664](#L1664) | self::$settings['critical']['css'] = 0; |
| [1665](#L1665) | } |
| [1666](#L1666) |  |
| [1667](#L1667) | if (!empty($\_GET['forceRecombine']) && $\_GET['forceRecombine'] == 'true') { |
| [1668](#L1668) | $post\_id = get\_the\_ID(); |
| [1669](#L1669) | $cache = new wps\_ic\_cache(); |
| [1670](#L1670) | $cache->update\_css\_hash($post\_id); |
| [1671](#L1671) | $cache->removeHtmlCacheFiles($post\_id); |
| [1672](#L1672) | } |
| [1673](#L1673) |  |
| [1674](#L1674) | self::$findImages = ''; |
| [1675](#L1675) | if (!empty(self::$settings['serve']['jpg']) && self::$settings['serve']['jpg'] == '1') { |
| [1676](#L1676) | self::$findImages .= 'jpg|jpeg|'; |
| [1677](#L1677) | } |
| [1678](#L1678) |  |
| [1679](#L1679) | if (!empty(self::$settings['serve']['png']) && self::$settings['serve']['png'] == '1') { |
| [1680](#L1680) | self::$findImages .= 'png|'; |
| [1681](#L1681) | } |
| [1682](#L1682) |  |
| [1683](#L1683) | if (!empty(self::$settings['serve']['gif']) && self::$settings['serve']['gif'] == '1') { |
| [1684](#L1684) | self::$findImages .= 'gif|'; |
| [1685](#L1685) | } |
| [1686](#L1686) |  |
| [1687](#L1687) | if (!empty(self::$settings['serve']['svg']) && self::$settings['serve']['svg'] == '1') { |
| [1688](#L1688) | self::$findImages .= 'svg|'; |
| [1689](#L1689) | } |
| [1690](#L1690) |  |
| [1691](#L1691) | self::$keys = new wps\_ic\_url\_key(); |
| [1692](#L1692) |  |
| [1693](#L1693) | self::$findImages .= 'webp|'; |
| [1694](#L1694) |  |
| [1695](#L1695) | self::$findImages = rtrim(self::$findImages, '|'); |
| [1696](#L1696) |  |
| [1697](#L1697) | // Plugin is NOT Activated |
| [1698](#L1698) | $apikey = self::$options['api\_key']; |
| [1699](#L1699) | if (empty($apikey)) { |
| [1700](#L1700) | return; |
| [1701](#L1701) | } |
| [1702](#L1702) |  |
| [1703](#L1703) | if (strpos($\_SERVER['HTTP\_USER\_AGENT'], 'PreloaderAPI') !== false || !empty($\_GET['dbg\_preload'])) { |
| [1704](#L1704) | self::$preloaderAPI = 1; |
| [1705](#L1705) | } |
| [1706](#L1706) |  |
| [1707](#L1707) | self::$zone\_test = 0; |
| [1708](#L1708) | self::$is\_multisite = is\_multisite(); |
| [1709](#L1709) |  |
| [1710](#L1710) | self::$randomHash = 0; |
| [1711](#L1711) |  |
| [1712](#L1712) | self::$rewriteLogic = new wps\_rewriteLogic(); |
| [1713](#L1713) | self::$minifyHtml = new wps\_minifyHtml(); |
| [1714](#L1714) | self::$cacheHtml = new wps\_cacheHtml(); |
| [1715](#L1715) | self::$criticalCss = new wps\_criticalCss(); |
| [1716](#L1716) | self::$combineCss = new wps\_ic\_combine\_css(); |
| [1717](#L1717) |  |
| [1718](#L1718) | //Add files inline |
| [1719](#L1719) | if (self::dontRunif()) { |
| [1720](#L1720) | $inline\_scripts = get\_option('wpc-inline'); |
| [1721](#L1721) | if (!empty($inline\_scripts['inline\_js'])) { |
| [1722](#L1722) | $this->inline\_js = $inline\_scripts['inline\_js']; |
| [1723](#L1723) | } |
| [1724](#L1724) | if (!empty($inline\_scripts['inline\_css'])) { |
| [1725](#L1725) | $this->inline\_css = $inline\_scripts['inline\_css']; |
| [1726](#L1726) | } |
| [1727](#L1727) |  |
| [1728](#L1728) | if (!empty(self::$settings['inline-js']) && self::$settings['inline-js'] == 1) { |
| [1729](#L1729) | if (!empty($this->inline\_js)) { |
| [1730](#L1730) | foreach ($this->inline\_js as $key => $script) { |
| [1731](#L1731) | if (substr($script, -3) == '-js') { |
| [1732](#L1732) | $this->inline\_js[$key] = substr($script, 0, -3); |
| [1733](#L1733) | } |
| [1734](#L1734) | } |
| [1735](#L1735) | } |
| [1736](#L1736) | add\_filter('script\_loader\_tag', [$this, 'add\_scripts\_inline'], PHP\_INT\_MAX, 3); |
| [1737](#L1737) | } |
| [1738](#L1738) | } |
| [1739](#L1739) |  |
| [1740](#L1740) | //Perfmatters settings check |
| [1741](#L1741) | //$this->perfMattersOverride(); |
| [1742](#L1742) |  |
| [1743](#L1743) | //Rocket settings check |
| [1744](#L1744) | //$this->rocketOverride(); |
| [1745](#L1745) |  |
| [1746](#L1746) | $integrations = new wps\_ic\_integrations(); |
| [1747](#L1747) | self::$defer\_js\_override = $integrations->is\_override\_active('defer\_js'); |
| [1748](#L1748) | self::$delay\_js\_override = $integrations->is\_override\_active('delay\_js'); |
| [1749](#L1749) | self::$lazy\_override = $integrations->is\_override\_active('lazy'); |
| [1750](#L1750) |  |
| [1751](#L1751) | // default excluded keywords |
| [1752](#L1752) | self::$default\_excluded\_list = [ |
| [1753](#L1753) | 'redditstatic', |
| [1754](#L1754) | 'ai-uncode', |
| [1755](#L1755) | 'gtm', |
| [1756](#L1756) | 'instagram.com', |
| [1757](#L1757) | 'fbcdn.net', |
| [1758](#L1758) | 'twitter', |
| [1759](#L1759) | 'google', |
| [1760](#L1760) | 'coinbase', |
| [1761](#L1761) | 'cookie', |
| [1762](#L1762) | 'schema', |
| [1763](#L1763) | 'recaptcha', |
| [1764](#L1764) | 'data:image', |
| [1765](#L1765) | 'stats.jpg' |
| [1766](#L1766) | ]; |
| [1767](#L1767) |  |
| [1768](#L1768) | // Preload anything inside themes,elementor,wp-includes |
| [1769](#L1769) | self::$assets\_to\_preload = ['themes', 'elementor', 'wp-includes', 'google']; |
| [1770](#L1770) | self::$assets\_to\_defer = ['themes', 'tracking', 'fontawesome']; |
| [1771](#L1771) |  |
| [1772](#L1772) | if (!empty($\_GET['ignore\_ic'])) { |
| [1773](#L1773) | return; |
| [1774](#L1774) | } |
| [1775](#L1775) |  |
| [1776](#L1776) | if (!empty($\_GET['randomHash'])) { |
| [1777](#L1777) | self::$randomHash = time(); |
| [1778](#L1778) | } |
| [1779](#L1779) |  |
| [1780](#L1780) | if (strpos($\_SERVER['REQUEST\_URI'], '.xml') !== false) { |
| [1781](#L1781) | return; |
| [1782](#L1782) | } |
| [1783](#L1783) |  |
| [1784](#L1784) | if (empty(self::$options['css\_hash'])) { |
| [1785](#L1785) | self::$options['css\_hash'] = 5021; |
| [1786](#L1786) | } |
| [1787](#L1787) |  |
| [1788](#L1788) | if (empty(self::$options['js\_hash'])) { |
| [1789](#L1789) | self::$options['js\_hash'] = 5021; |
| [1790](#L1790) | } |
| [1791](#L1791) |  |
| [1792](#L1792) | if (!defined('WPS\_IC\_HASH')) { |
| [1793](#L1793) | define('WPS\_IC\_HASH', self::$options['css\_hash']); |
| [1794](#L1794) | } |
| [1795](#L1795) |  |
| [1796](#L1796) | if (!defined('WPS\_IC\_JS\_HASH')) { |
| [1797](#L1797) | define('WPS\_IC\_JS\_HASH', self::$options['js\_hash']); |
| [1798](#L1798) | } |
| [1799](#L1799) |  |
| [1800](#L1800) | if (!empty(self::$excludes['delay\_js'])) { |
| [1801](#L1801) | $this->delay\_js\_exclude = self::$excludes['delay\_js']; |
| [1802](#L1802) | } else { |
| [1803](#L1803) | $this->delay\_js\_exclude = ''; |
| [1804](#L1804) | } |
| [1805](#L1805) |  |
| [1806](#L1806) | $allowLive = get\_option('wps\_ic\_allow\_live'); |
| [1807](#L1807) |  |
| [1808](#L1808) | self::$cdnEnabled = self::$settings['live-cdn']; |
| [1809](#L1809) | if ((isset(self::$page\_excludes['cdn']) && self::$page\_excludes['cdn'] == '0') || !$allowLive) { |
| [1810](#L1810) | self::$cdnEnabled = 0; |
| [1811](#L1811) | self::$settings['css'] = 0; |
| [1812](#L1812) | self::$settings['js'] = 0; |
| [1813](#L1813) | self::$settings['serve']['jpg'] = 0; |
| [1814](#L1814) | self::$settings['serve']['png'] = 0; |
| [1815](#L1815) | self::$settings['serve']['gif'] = 0; |
| [1816](#L1816) | self::$settings['serve']['svg'] = 0; |
| [1817](#L1817) | } else if (isset(self::$page\_excludes['cdn']) && self::$page\_excludes['cdn'] == '1') { |
| [1818](#L1818) | self::$cdnEnabled = 1; |
| [1819](#L1819) | self::$settings['css'] = 1; |
| [1820](#L1820) | self::$settings['js'] = 1; |
| [1821](#L1821) | self::$settings['serve']['jpg'] = 1; |
| [1822](#L1822) | self::$settings['serve']['png'] = 1; |
| [1823](#L1823) | self::$settings['serve']['gif'] = 1; |
| [1824](#L1824) | self::$settings['serve']['svg'] = 1; |
| [1825](#L1825) | } |
| [1826](#L1826) |  |
| [1827](#L1827) |  |
| [1828](#L1828) | if (self::$settings['css'] == 0 && self::$settings['js'] == 0 && self::$settings['serve']['jpg'] == 0 && self::$settings['serve']['png'] == 0 && self::$settings['serve']['gif'] == 0 && self::$settings['serve']['svg'] == 0) { |
| [1829](#L1829) | self::$cdnEnabled = 0; |
| [1830](#L1830) | } |
| [1831](#L1831) |  |
| [1832](#L1832) | if (!empty($\_GET['criticalCombine'])) { |
| [1833](#L1833) | self::$cdnEnabled = 0; |
| [1834](#L1834) | self::$settings['css'] = 0; |
| [1835](#L1835) | self::$settings['js'] = 0; |
| [1836](#L1836) | self::$settings['serve']['jpg'] = 0; |
| [1837](#L1837) | self::$settings['serve']['png'] = 0; |
| [1838](#L1838) | self::$settings['serve']['gif'] = 0; |
| [1839](#L1839) | self::$settings['serve']['svg'] = 0; |
| [1840](#L1840) | } |
| [1841](#L1841) |  |
| [1842](#L1842) | // Is an ajax request? |
| [1843](#L1843) | self::$isAjax = (function\_exists("wp\_doing\_ajax") && wp\_doing\_ajax()) || (defined('DOING\_AJAX') && DOING\_AJAX); |
| [1844](#L1844) |  |
| [1845](#L1845) | // Don't run in admin side! |
| [1846](#L1846) | if (!empty($\_SERVER['SCRIPT\_URL']) && $\_SERVER['SCRIPT\_URL'] == "/wp-admin/customize.php") { |
| [1847](#L1847) | return; |
| [1848](#L1848) | } |
| [1849](#L1849) |  |
| [1850](#L1850) | self::$svg\_placeholder = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAwIiBoZWlnaHQ9IjEwMCI+PHBhdGggZD0iTTIgMmgxMDAwdjEwMEgyeiIgZmlsbD0iI2ZmZiIgb3BhY2l0eT0iMCIvPjwvc3ZnPg=='; |
| [1851](#L1851) |  |
| [1852](#L1852) | self::$updir = wp\_upload\_dir(); |
| [1853](#L1853) |  |
| [1854](#L1854) | if (!is\_multisite()) { |
| [1855](#L1855) | self::$site\_url = site\_url(); |
| [1856](#L1856) | self::$home\_url = home\_url(); |
| [1857](#L1857) | } else { |
| [1858](#L1858) | $current\_blog\_id = get\_current\_blog\_id(); |
| [1859](#L1859) | switch\_to\_blog($current\_blog\_id); |
| [1860](#L1860) |  |
| [1861](#L1861) | self::$site\_url = network\_site\_url(); |
| [1862](#L1862) | self::$home\_url = home\_url(); |
| [1863](#L1863) | } |
| [1864](#L1864) |  |
| [1865](#L1865) | self::$site\_url\_scheme = parse\_url(self::$site\_url, PHP\_URL\_SCHEME); |
| [1866](#L1866) |  |
| [1867](#L1867) | self::$lazy\_excluded\_list = get\_option('wpc-ic-lazy-exclude'); |
| [1868](#L1868) | self::$excluded\_list = get\_option('wpc-ic-external-url-exclude'); |
| [1869](#L1869) |  |
| [1870](#L1870) | if (!is\_array(self::$excluded\_list)) { |
| [1871](#L1871) | self::$external\_url\_excluded = explode("\n", self::$excluded\_list); |
| [1872](#L1872) | } else { |
| [1873](#L1873) | self::$external\_url\_excluded = self::$excluded\_list; |
| [1874](#L1874) | } |
| [1875](#L1875) |  |
| [1876](#L1876) | if (defined('BRIZY\_VERSION')) { |
| [1877](#L1877) | self::$brizyCache = get\_option('wps\_ic\_brizy\_cache'); |
| [1878](#L1878) | self::$brizyActive = true; |
| [1879](#L1879) | } else { |
| [1880](#L1880) | self::$brizyActive = false; |
| [1881](#L1881) | } |
| [1882](#L1882) |  |
| [1883](#L1883) | $custom\_cname = get\_option('ic\_custom\_cname'); |
| [1884](#L1884) |  |
| [1885](#L1885) | if (empty($custom\_cname) || !$custom\_cname) { |
| [1886](#L1886) | self::$zone\_name = get\_option('ic\_cdn\_zone\_name'); |
| [1887](#L1887) | } else { |
| [1888](#L1888) | self::$zone\_name = $custom\_cname; |
| [1889](#L1889) | } |
| [1890](#L1890) |  |
| [1891](#L1891) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'direct') { |
| [1892](#L1892) | if (!empty($\_GET['custom\_server'])) { |
| [1893](#L1893) | self::$zone\_name = $\_GET['custom\_server'] . '/key:' . self::$options['api\_key']; |
| [1894](#L1894) | } |
| [1895](#L1895) | } |
| [1896](#L1896) |  |
| [1897](#L1897) | if (empty(self::$zone\_name)) { |
| [1898](#L1898) | return; |
| [1899](#L1899) | } |
| [1900](#L1900) |  |
| [1901](#L1901) | self::$is\_retina = '0'; |
| [1902](#L1902) | self::$webp = '0'; |
| [1903](#L1903) | self::$externalUrlEnabled = 'false'; |
| [1904](#L1904) |  |
| [1905](#L1905) | self::$lazy\_enabled = self::$settings['lazy']; |
| [1906](#L1906) | self::$native\_lazy\_enabled = self::$settings['nativeLazy']; |
| [1907](#L1907) | self::$adaptive\_enabled = self::$settings['generate\_adaptive']; |
| [1908](#L1908) | self::$webp\_enabled = self::$settings['generate\_webp']; |
| [1909](#L1909) | self::$retina\_enabled = self::$settings['retina']; |
| [1910](#L1910) | if (!empty(self::$settings['replace-all-link'])) { |
| [1911](#L1911) | self::$replaceAllLinks = self::$settings['replace-all-link']; |
| [1912](#L1912) | } else { |
| [1913](#L1913) | self::$replaceAllLinks = '0'; |
| [1914](#L1914) | } |
| [1915](#L1915) |  |
| [1916](#L1916) | if (!empty($\_GET['disableLazy'])) { |
| [1917](#L1917) | self::$lazy\_enabled = '0'; |
| [1918](#L1918) | self::$native\_lazy\_enabled = '0'; |
| [1919](#L1919) | } |
| [1920](#L1920) |  |
| [1921](#L1921) | if (!empty(self::$settings['external-url'])) { |
| [1922](#L1922) | self::$externalUrlEnabled = self::$settings['external-url']; |
| [1923](#L1923) | } |
| [1924](#L1924) |  |
| [1925](#L1925) | if (empty(self::$settings['emoji-remove'])) { |
| [1926](#L1926) | self::$settings['emoji-remove'] = 0; |
| [1927](#L1927) | } |
| [1928](#L1928) |  |
| [1929](#L1929) | if (empty(self::$settings['external-url'])) { |
| [1930](#L1930) | self::$settings['external-url'] = 0; |
| [1931](#L1931) | } |
| [1932](#L1932) |  |
| [1933](#L1933) | if (empty(self::$settings['css'])) { |
| [1934](#L1934) | self::$settings['css'] = 0; |
| [1935](#L1935) | } |
| [1936](#L1936) |  |
| [1937](#L1937) | if (empty(self::$settings['fonts'])) { |
| [1938](#L1938) | self::$settings['fonts'] = 0; |
| [1939](#L1939) | } |
| [1940](#L1940) |  |
| [1941](#L1941) | if (empty(self::$settings['js'])) { |
| [1942](#L1942) | self::$settings['js'] = 0; |
| [1943](#L1943) | } |
| [1944](#L1944) |  |
| [1945](#L1945) | if (empty(self::$settings['preserve\_exif'])) { |
| [1946](#L1946) | self::$settings['preserve\_exif'] = 0; |
| [1947](#L1947) | } |
| [1948](#L1948) |  |
| [1949](#L1949) | if (!empty($\_GET['ic\_override\_setting']) && $\_GET['ic\_override\_setting'] == 'lazy') { |
| [1950](#L1950) | self::$lazy\_enabled = (bool)$\_GET['value']; |
| [1951](#L1951) | } |
| [1952](#L1952) |  |
| [1953](#L1953) | if (!empty($\_GET['ic\_lazy'])) { |
| [1954](#L1954) | self::$lazy\_enabled = (bool)$\_GET['ic\_lazy']; |
| [1955](#L1955) | self::$settings['css'] = 1; |
| [1956](#L1956) | self::$settings['js'] = 1; |
| [1957](#L1957) | } |
| [1958](#L1958) |  |
| [1959](#L1959) | if (!empty($\_GET['css'])) { |
| [1960](#L1960) | self::$settings['css'] = (bool)$\_GET['css']; |
| [1961](#L1961) | } |
| [1962](#L1962) |  |
| [1963](#L1963) | if (!empty($\_GET['js'])) { |
| [1964](#L1964) | self::$settings['js'] = (bool)$\_GET['js']; |
| [1965](#L1965) | } |
| [1966](#L1966) |  |
| [1967](#L1967) | if (empty(self::$settings['css\_image\_urls']) || !isset(self::$settings['css\_image\_urls'])) { |
| [1968](#L1968) | self::$settings['css\_image\_urls'] = '0'; |
| [1969](#L1969) | } |
| [1970](#L1970) |  |
| [1971](#L1971) | if (!empty(self::$settings['minify-css']) && self::$settings['minify-css']) { |
| [1972](#L1972) | self::$settings['minify-css'] = '1'; |
| [1973](#L1973) | } else { |
| [1974](#L1974) | self::$settings['minify-css'] = '0'; |
| [1975](#L1975) | } |
| [1976](#L1976) |  |
| [1977](#L1977) | if (!empty(self::$settings['minify-js']) && self::$settings['minify-js']) { |
| [1978](#L1978) | self::$settings['minify-js'] = '1'; |
| [1979](#L1979) | } else { |
| [1980](#L1980) | self::$settings['minify-js'] = '0'; |
| [1981](#L1981) | } |
| [1982](#L1982) |  |
| [1983](#L1983) | self::$externalUrlEnabled = self::$settings['external-url']; |
| [1984](#L1984) | self::$css = self::$settings['css']; |
| [1985](#L1985) | self::$css\_img\_url = self::$settings['css\_image\_urls']; |
| [1986](#L1986) | self::$css\_minify = self::$settings['css\_minify']; |
| [1987](#L1987) | self::$js = self::$settings['js']; |
| [1988](#L1988) | self::$js\_minify = self::$settings['js\_minify']; |
| [1989](#L1989) | self::$emoji\_remove = self::$settings['emoji-remove']; |
| [1990](#L1990) | self::$exif = self::$settings['preserve\_exif']; |
| [1991](#L1991) | self::$fonts = self::$settings['fonts']; |
| [1992](#L1992) |  |
| [1993](#L1993) | // If Optimization Quality is Not set... |
| [1994](#L1994) | if (empty(self::$settings['optimization']) || self::$settings['optimization'] == '' || self::$settings['optimization'] == '0') { |
| [1995](#L1995) | self::$settings['optimization'] = 'i'; |
| [1996](#L1996) | } |
| [1997](#L1997) |  |
| [1998](#L1998) | if (!empty(self::$retina\_enabled) && self::$retina\_enabled == '1') { |
| [1999](#L1999) | if (isset($\_COOKIE["ic\_pixel\_ratio"])) { |
| [2000](#L2000) | if ($\_COOKIE["ic\_pixel\_ratio"] >= 2) { |
| [2001](#L2001) | self::$is\_retina = '1'; |
| [2002](#L2002) | } |
| [2003](#L2003) | } |
| [2004](#L2004) | } |
| [2005](#L2005) |  |
| [2006](#L2006) | if (!empty(self::$webp\_enabled) && self::$webp\_enabled == '1') { |
| [2007](#L2007) | self::$webp = '1'; |
| [2008](#L2008) |  |
| [2009](#L2009) | if (strpos($\_SERVER['HTTP\_USER\_AGENT'], 'Safari') && !strpos($\_SERVER['HTTP\_USER\_AGENT'], 'Chrome')) { |
| [2010](#L2010) | self::$webp\_enabled = false; |
| [2011](#L2011) | self::$webp = '0'; |
| [2012](#L2012) | } |
| [2013](#L2013) | } |
| [2014](#L2014) |  |
| [2015](#L2015) | if (!empty($\_GET['test\_zone'])) { |
| [2016](#L2016) | if ($\_GET['test\_zone'] == 'cdn-rage4') { |
| [2017](#L2017) | self::$zone\_test = 1; |
| [2018](#L2018) | self::$zone\_name = $\_GET['server'] . '.zapwp.net/key:' . self::$options['api\_key']; |
| [2019](#L2019) | } else { |
| [2020](#L2020) | self::$zone\_name = $\_GET['test\_zone'] . '.wpmediacompress.com/key:' . self::$options['api\_key']; |
| [2021](#L2021) | } |
| [2022](#L2022) | } |
| [2023](#L2023) |  |
| [2024](#L2024) | if (!empty(self::$exif) && self::$exif == '1') { |
| [2025](#L2025) | self::$apiUrl = 'https://' . self::$zone\_name . '/q:' . self::$settings['optimization'] . '/e:1'; |
| [2026](#L2026) | } else { |
| [2027](#L2027) | self::$apiUrl = 'https://' . self::$zone\_name . '/q:' . self::$settings['optimization']; |
| [2028](#L2028) | } |
| [2029](#L2029) |  |
| [2030](#L2030) | self::$apiAssetUrl = 'https://' . self::$zone\_name . '/a:'; |
| [2031](#L2031) |  |
| [2032](#L2032) | if (self::$preloaderAPI) { |
| [2033](#L2033) | global $post; |
| [2034](#L2034) | self::$lazy\_enabled = '0'; |
| [2035](#L2035) | self::$native\_lazy\_enabled = '0'; |
| [2036](#L2036) | self::$adaptive\_enabled = '0'; |
| [2037](#L2037) | self::$retina\_enabled = '0'; |
| [2038](#L2038) | self::$settings['remove-render-blocking'] = 0; |
| [2039](#L2039) | $preloaded\_pages = get\_option('wpc-ic-preloaded-pages'); |
| [2040](#L2040) | //check if page is preloaded, and add to list if not |
| [2041](#L2041) | if (is\_array($preloaded\_pages) && !in\_array($post->ID, $preloaded\_pages)) { |
| [2042](#L2042) | array\_push($preloaded\_pages, $post->ID); |
| [2043](#L2043) | update\_option('wpc-ic-preloaded-pages', $preloaded\_pages); |
| [2044](#L2044) | } else if ($preloaded\_pages === false) { |
| [2045](#L2045) | update\_option('wpc-ic-preloaded-pages', [$post->ID]); |
| [2046](#L2046) | } |
| [2047](#L2047) | } |
| [2048](#L2048) |  |
| [2049](#L2049) | if (!empty($\_GET['overwrite\_retina'])) { |
| [2050](#L2050) | self::$retina\_enabled = '1'; |
| [2051](#L2051) | self::$is\_retina = '1'; |
| [2052](#L2052) | } |
| [2053](#L2053) |  |
| [2054](#L2054) | if (!empty($\_GET['debugCritical']) || !empty($\_GET['generateCriticalAPI'])) { |
| [2055](#L2055) | add\_filter('style\_loader\_tag', [$this, 'crittr\_style\_tag'], 10, 4); |
| [2056](#L2056) | } |
| [2057](#L2057) |  |
| [2058](#L2058) | //todo: Why are we checking this again? |
| [2059](#L2059) | if ((isset(self::$page\_excludes['cdn']) && self::$page\_excludes['cdn'] == '0') || !$allowLive) { |
| [2060](#L2060) | self::$cdnEnabled = 0; |
| [2061](#L2061) | self::$settings['css'] = 0; |
| [2062](#L2062) | self::$settings['js'] = 0; |
| [2063](#L2063) | self::$settings['serve']['jpg'] = 0; |
| [2064](#L2064) | self::$settings['serve']['png'] = 0; |
| [2065](#L2065) | self::$settings['serve']['gif'] = 0; |
| [2066](#L2066) | self::$settings['serve']['svg'] = 0; |
| [2067](#L2067) | } else if (isset(self::$page\_excludes['cdn']) && self::$page\_excludes['cdn'] == '1') { |
| [2068](#L2068) | self::$cdnEnabled = 1; |
| [2069](#L2069) | self::$settings['css'] = 1; |
| [2070](#L2070) | self::$settings['js'] = 1; |
| [2071](#L2071) | self::$settings['serve']['jpg'] = 1; |
| [2072](#L2072) | self::$settings['serve']['png'] = 1; |
| [2073](#L2073) | self::$settings['serve']['gif'] = 1; |
| [2074](#L2074) | self::$settings['serve']['svg'] = 1; |
| [2075](#L2075) | } |
| [2076](#L2076) |  |
| [2077](#L2077) | if (self::$settings['css'] == 0 && self::$settings['js'] == 0 && self::$settings['serve']['jpg'] == 0 && self::$settings['serve']['png'] == 0 && self::$settings['serve']['gif'] == 0 && self::$settings['serve']['svg'] == 0) { |
| [2078](#L2078) | self::$cdnEnabled = 0; |
| [2079](#L2079) | } |
| [2080](#L2080) |  |
| [2081](#L2081) | if (self::$cdnEnabled == 1) { |
| [2082](#L2082) | if (self::dontRunif()) { |
| [2083](#L2083) |  |
| [2084](#L2084) | if (self::$settings['inline-css'] == '1' && empty($\_GET['criticalCombine'])) { |
| [2085](#L2085) | add\_filter('style\_loader\_tag', [$this, 'inlineCSS'], 10, 4); |
| [2086](#L2086) | } else { |
| [2087](#L2087) | if (self::$css == "1") { |
| [2088](#L2088) | add\_filter('style\_loader\_src', [$this, 'adjust\_src\_url'], 10, 2); |
| [2089](#L2089) | add\_filter('style\_loader\_tag', [$this, 'adjust\_style\_tag'], 10, 4); |
| [2090](#L2090) | } |
| [2091](#L2091) | } |
| [2092](#L2092) |  |
| [2093](#L2093) | if (self::$js == "1") { |
| [2094](#L2094) | add\_filter('script\_loader\_tag', [$this, 'rewrite\_script\_tag'], 10, 3); |
| [2095](#L2095) | } |
| [2096](#L2096) |  |
| [2097](#L2097) | #add\_filter('script\_loader\_tag', [$this, 'deferJSAssets'], 10, 3); |
| [2098](#L2098) | } |
| [2099](#L2099) |  |
| [2100](#L2100) | add\_action("wp\_head", [$this, 'dnsPrefetch'], 0); |
| [2101](#L2101) | } else { |
| [2102](#L2102) | // Local Mode |
| [2103](#L2103) | if (self::dontRunif()) { |
| [2104](#L2104) | if (self::$settings['inline-css'] == '1' && empty($\_GET['criticalCombine'])) { |
| [2105](#L2105) | add\_filter('style\_loader\_tag', [$this, 'inlineCSS'], 10, 4); |
| [2106](#L2106) | } |
| [2107](#L2107) |  |
| [2108](#L2108) | if (self::$css == "1") { |
| [2109](#L2109) | add\_filter('style\_loader\_src', [$this, 'adjust\_src\_url'], 10, 2); |
| [2110](#L2110) | add\_filter('style\_loader\_tag', [$this, 'adjust\_style\_tag'], 10, 4); |
| [2111](#L2111) | } |
| [2112](#L2112) |  |
| [2113](#L2113) | if (self::$js == "1") { |
| [2114](#L2114) | add\_filter('script\_loader\_src', [$this, 'adjust\_src\_url'], 10, 2); |
| [2115](#L2115) | } |
| [2116](#L2116) | } |
| [2117](#L2117) |  |
| [2118](#L2118) | if (self::$js == "1" || self::$css == "1") { |
| [2119](#L2119) | add\_action("wp\_head", [$this, 'dnsPrefetch'], 0); |
| [2120](#L2120) | } |
| [2121](#L2121) | } |
| [2122](#L2122) | } |
| [2123](#L2123) |  |
| [2124](#L2124) | public function preload\_custom\_assetsMobile() |
| [2125](#L2125) | { |
| [2126](#L2126) | $preloads = get\_option('wps\_ic\_preloadsMobile'); |
| [2127](#L2127) |  |
| [2128](#L2128) | if (!empty($preloads) && is\_array($preloads)) { |
| [2129](#L2129) |  |
| [2130](#L2130) | $newPreloads = []; |
| [2131](#L2131) |  |
| [2132](#L2132) | // Create a new array |
| [2133](#L2133) | if (!empty($preloads['lcp'])) { |
| [2134](#L2134) | $newPreloads = ['lcp' => $preloads['lcp']]; |
| [2135](#L2135) | } |
| [2136](#L2136) |  |
| [2137](#L2137) | if (!empty($preloads['custom'])) { |
| [2138](#L2138) | foreach ($preloads['custom'] as $index => $value) { |
| [2139](#L2139) | $key = 'custom\_' . ($index + 1); |
| [2140](#L2140) | $newPreloads[$key] = $value; |
| [2141](#L2141) | } |
| [2142](#L2142) | } |
| [2143](#L2143) |  |
| [2144](#L2144) | foreach ($newPreloads as $preload) { |
| [2145](#L2145) | $type = ''; |
| [2146](#L2146) | $extra = ''; |
| [2147](#L2147) | $ext = pathinfo($preload, PATHINFO\_EXTENSION); |
| [2148](#L2148) | switch ($ext) { |
| [2149](#L2149) | case 'css': |
| [2150](#L2150) | $as = 'style'; |
| [2151](#L2151) | $type = 'text/css'; |
| [2152](#L2152) | break; |
| [2153](#L2153) | case 'js': |
| [2154](#L2154) | $as = 'script'; |
| [2155](#L2155) | $type = 'text/javascript'; |
| [2156](#L2156) | break; |
| [2157](#L2157) | case 'woff': |
| [2158](#L2158) | case 'woff2': |
| [2159](#L2159) | case 'ttf': |
| [2160](#L2160) | case 'otf': |
| [2161](#L2161) | $extra = 'crossorigin'; |
| [2162](#L2162) | $as = 'font'; |
| [2163](#L2163) | if ($ext == 'woff' || $ext == 'woff2') { |
| [2164](#L2164) | $type = 'font/woff'; |
| [2165](#L2165) | } else { |
| [2166](#L2166) | $type = 'font/' . $ext; |
| [2167](#L2167) | } |
| [2168](#L2168) | break; |
| [2169](#L2169) | case 'jpg': |
| [2170](#L2170) | case 'jpeg': |
| [2171](#L2171) | case 'png': |
| [2172](#L2172) | case 'gif': |
| [2173](#L2173) | case 'webp': |
| [2174](#L2174) | case 'svg': |
| [2175](#L2175) | $as = 'image'; |
| [2176](#L2176) | if ($ext == 'jpg' || $ext == 'jpeg') { |
| [2177](#L2177) | $type = 'image/jpg'; |
| [2178](#L2178) | } else if ($ext == 'gif') { |
| [2179](#L2179) | $type = 'image/gif'; |
| [2180](#L2180) | } else if ($ext == 'png') { |
| [2181](#L2181) | $type = 'image/png'; |
| [2182](#L2182) | } else if ($ext == 'webp') { |
| [2183](#L2183) | $type = 'image/webp'; |
| [2184](#L2184) | } else if ($ext == 'svg') { |
| [2185](#L2185) | $type = 'image/svg+xml'; |
| [2186](#L2186) | } |
| [2187](#L2187) | break; |
| [2188](#L2188) | default: |
| [2189](#L2189) | $as = ''; |
| [2190](#L2190) | break; |
| [2191](#L2191) | } |
| [2192](#L2192) |  |
| [2193](#L2193) |  |
| [2194](#L2194) | if (!empty($as)) { |
| [2195](#L2195) | echo '<link rel="preload" href="' . esc\_url($preload) . '" as="' . esc\_attr($as) . '" type="' . $type . '"'; |
| [2196](#L2196) |  |
| [2197](#L2197) | if (!empty(self::$settings['fetchpriority-high']) && self::$settings['fetchpriority-high'] == '1') { |
| [2198](#L2198) | echo ' fetchpriority="high"'; |
| [2199](#L2199) | } |
| [2200](#L2200) |  |
| [2201](#L2201) | echo ' ' . $extra . '>' . "\n"; |
| [2202](#L2202) | } |
| [2203](#L2203) | } |
| [2204](#L2204) | } |
| [2205](#L2205) | } |
| [2206](#L2206) |  |
| [2207](#L2207) | public function preload\_custom\_assets() |
| [2208](#L2208) | { |
| [2209](#L2209) | $preloads = get\_option('wps\_ic\_preloads'); |
| [2210](#L2210) |  |
| [2211](#L2211) | if (!empty($preloads) && is\_array($preloads)) { |
| [2212](#L2212) | $newPreloads = []; |
| [2213](#L2213) |  |
| [2214](#L2214) | // Create a new array |
| [2215](#L2215) | if (!empty($preloads['lcp'])) { |
| [2216](#L2216) | $newPreloads = ['lcp' => $preloads['lcp']]; |
| [2217](#L2217) | } |
| [2218](#L2218) |  |
| [2219](#L2219) | if (!empty($preloads['custom'])) { |
| [2220](#L2220) | foreach ($preloads['custom'] as $index => $value) { |
| [2221](#L2221) | $key = 'custom\_' . ($index + 1); |
| [2222](#L2222) | $newPreloads[$key] = $value; |
| [2223](#L2223) | } |
| [2224](#L2224) | } |
| [2225](#L2225) |  |
| [2226](#L2226) | foreach ($newPreloads as $preload) { |
| [2227](#L2227) | $extra = ''; |
| [2228](#L2228) | $type = ''; |
| [2229](#L2229) | $ext = pathinfo($preload, PATHINFO\_EXTENSION); |
| [2230](#L2230) | switch ($ext) { |
| [2231](#L2231) | case 'css': |
| [2232](#L2232) | $as = 'style'; |
| [2233](#L2233) | $type = 'text/css'; |
| [2234](#L2234) | break; |
| [2235](#L2235) | case 'js': |
| [2236](#L2236) | $as = 'script'; |
| [2237](#L2237) | $type = 'text/javascript'; |
| [2238](#L2238) | break; |
| [2239](#L2239) | case 'woff': |
| [2240](#L2240) | case 'woff2': |
| [2241](#L2241) | case 'ttf': |
| [2242](#L2242) | case 'otf': |
| [2243](#L2243) | $extra = 'crossorigin'; |
| [2244](#L2244) | $as = 'font'; |
| [2245](#L2245) | if ($ext == 'woff' || $ext == 'woff2') { |
| [2246](#L2246) | $type = 'font/woff'; |
| [2247](#L2247) | } else { |
| [2248](#L2248) | $type = 'font/' . $ext; |
| [2249](#L2249) | } |
| [2250](#L2250) | break; |
| [2251](#L2251) | case 'jpg': |
| [2252](#L2252) | case 'jpeg': |
| [2253](#L2253) | case 'png': |
| [2254](#L2254) | case 'gif': |
| [2255](#L2255) | case 'webp': |
| [2256](#L2256) | case 'svg': |
| [2257](#L2257) | $as = 'image'; |
| [2258](#L2258) | if ($ext == 'jpg' || $ext == 'jpeg') { |
| [2259](#L2259) | $type = 'image/jpg'; |
| [2260](#L2260) | } else if ($ext == 'gif') { |
| [2261](#L2261) | $type = 'image/gif'; |
| [2262](#L2262) | } else if ($ext == 'png') { |
| [2263](#L2263) | $type = 'image/png'; |
| [2264](#L2264) | } else if ($ext == 'webp') { |
| [2265](#L2265) | $type = 'image/webp'; |
| [2266](#L2266) | } else if ($ext == 'svg') { |
| [2267](#L2267) | $type = 'image/svg+xml'; |
| [2268](#L2268) | } |
| [2269](#L2269) | break; |
| [2270](#L2270) | default: |
| [2271](#L2271) | $as = ''; |
| [2272](#L2272) | break; |
| [2273](#L2273) | } |
| [2274](#L2274) |  |
| [2275](#L2275) |  |
| [2276](#L2276) | if (!empty($as)) { |
| [2277](#L2277) | echo '<link rel="preload" href="' . esc\_url($preload) . '" as="' . esc\_attr($as) . '" type="' . $type . '"'; |
| [2278](#L2278) |  |
| [2279](#L2279) | if (!empty(self::$settings['fetchpriority-high']) && self::$settings['fetchpriority-high'] == '1') { |
| [2280](#L2280) | echo ' fetchpriority="high"'; |
| [2281](#L2281) | } |
| [2282](#L2282) |  |
| [2283](#L2283) | echo ' ' . $extra . '>' . "\n"; |
| [2284](#L2284) | } |
| [2285](#L2285) | } |
| [2286](#L2286) | } |
| [2287](#L2287) | } |
| [2288](#L2288) |  |
| [2289](#L2289) | public function perfMattersOverride() |
| [2290](#L2290) | { |
| [2291](#L2291) | if (function\_exists('perfmatters\_version\_check')) { |
| [2292](#L2292) | $perfmatters\_options = get\_option('perfmatters\_options'); |
| [2293](#L2293) |  |
| [2294](#L2294) | if (!empty($perfmatters\_options['assets']['delay\_js']) && $perfmatters\_options['assets']['delay\_js']) { |
| [2295](#L2295) | self::$delay\_js\_override = 1; |
| [2296](#L2296) | } |
| [2297](#L2297) |  |
| [2298](#L2298) | if (!empty($perfmatters\_options['assets']['defer\_js']) && $perfmatters\_options['assets']['defer\_js']) { |
| [2299](#L2299) | self::$defer\_js\_override = 1; |
| [2300](#L2300) | } |
| [2301](#L2301) |  |
| [2302](#L2302) | if (!empty($perfmatters\_options['lazyload']['lazy\_loading']) && $perfmatters\_options['lazyload']['lazy\_loading']) { |
| [2303](#L2303) | self::$lazy\_override = 1; |
| [2304](#L2304) | } |
| [2305](#L2305) | } |
| [2306](#L2306) | } |
| [2307](#L2307) |  |
| [2308](#L2308) | public function rocketOverride() |
| [2309](#L2309) | { |
| [2310](#L2310) | if (function\_exists('get\_rocket\_option')) { |
| [2311](#L2311) | $rocket\_settings = get\_option('wp\_rocket\_settings'); |
| [2312](#L2312) |  |
| [2313](#L2313) | if ($rocket\_settings['delay\_js']) { |
| [2314](#L2314) | self::$delay\_js\_override = 1; |
| [2315](#L2315) | } |
| [2316](#L2316) |  |
| [2317](#L2317) | if ($rocket\_settings['defer\_all\_js']) { |
| [2318](#L2318) | self::$defer\_js\_override = 1; |
| [2319](#L2319) | } |
| [2320](#L2320) |  |
| [2321](#L2321) | if ($rocket\_settings['lazyload']) { |
| [2322](#L2322) | self::$lazy\_override = 1; |
| [2323](#L2323) | } |
| [2324](#L2324) | } |
| [2325](#L2325) | } |
| [2326](#L2326) |  |
| [2327](#L2327) | public function script\_encode($html) |
| [2328](#L2328) | { |
| [2329](#L2329) | $html = base64\_encode($html[0]); |
| [2330](#L2330) |  |
| [2331](#L2331) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_encode') { |
| [2332](#L2332) | return print\_r([$html], true); |
| [2333](#L2333) | } |
| [2334](#L2334) |  |
| [2335](#L2335) | return '[script-wpc]' . $html . '[/script-wpc]'; |
| [2336](#L2336) | } |
| [2337](#L2337) |  |
| [2338](#L2338) | public function script\_decode($html) |
| [2339](#L2339) | { |
| [2340](#L2340) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode') { |
| [2341](#L2341) | return print\_r([$html], true); |
| [2342](#L2342) | } |
| [2343](#L2343) |  |
| [2344](#L2344) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'no\_decode') { |
| [2345](#L2345) | return $html[1]; |
| [2346](#L2346) | } |
| [2347](#L2347) |  |
| [2348](#L2348) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'after\_base64\_replace') { |
| [2349](#L2349) | return $html[1]; |
| [2350](#L2350) | } |
| [2351](#L2351) |  |
| [2352](#L2352) | $html = base64\_decode($html[1]); |
| [2353](#L2353) |  |
| [2354](#L2354) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'after\_base64\_decode') { |
| [2355](#L2355) | return $html; |
| [2356](#L2356) | } |
| [2357](#L2357) |  |
| [2358](#L2358) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode\_after') { |
| [2359](#L2359) | return print\_r([str\_replace('<iframe', 'framea', $html)], true); |
| [2360](#L2360) | } |
| [2361](#L2361) |  |
| [2362](#L2362) | return $html; |
| [2363](#L2363) | } |
| [2364](#L2364) |  |
| [2365](#L2365) | public function noscript\_encode($html) |
| [2366](#L2366) | { |
| [2367](#L2367) | $html = base64\_encode($html[0]); |
| [2368](#L2368) |  |
| [2369](#L2369) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_encode') { |
| [2370](#L2370) | return print\_r([$html], true); |
| [2371](#L2371) | } |
| [2372](#L2372) |  |
| [2373](#L2373) | return '[noscript-wpc]' . $html . '[/noscript-wpc]'; |
| [2374](#L2374) | } |
| [2375](#L2375) |  |
| [2376](#L2376) | public function noscript\_decode($html) |
| [2377](#L2377) | { |
| [2378](#L2378) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode') { |
| [2379](#L2379) | return print\_r([$html], true); |
| [2380](#L2380) | } |
| [2381](#L2381) |  |
| [2382](#L2382) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'no\_decode') { |
| [2383](#L2383) | return $html[1]; |
| [2384](#L2384) | } |
| [2385](#L2385) |  |
| [2386](#L2386) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'after\_base64\_replace') { |
| [2387](#L2387) | return $html[1]; |
| [2388](#L2388) | } |
| [2389](#L2389) |  |
| [2390](#L2390) | $html = base64\_decode($html[1]); |
| [2391](#L2391) |  |
| [2392](#L2392) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'after\_base64\_decode') { |
| [2393](#L2393) | return $html; |
| [2394](#L2394) | } |
| [2395](#L2395) |  |
| [2396](#L2396) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode\_after') { |
| [2397](#L2397) | return print\_r([str\_replace('<iframe', 'framea', $html)], true); |
| [2398](#L2398) | } |
| [2399](#L2399) |  |
| [2400](#L2400) | return $html; |
| [2401](#L2401) | } |
| [2402](#L2402) |  |
| [2403](#L2403) | public function jetsmart\_ajax\_rewrite($args) |
| [2404](#L2404) | { |
| [2405](#L2405) | $html = $args['content']; |
| [2406](#L2406) |  |
| [2407](#L2407) | //Prep Site URL |
| [2408](#L2408) | $escapedSiteURL = quotemeta(self::$home\_url); |
| [2409](#L2409) | $regExURL = '(https?:|)' . substr($escapedSiteURL, strpos($escapedSiteURL, '//')); |
| [2410](#L2410) |  |
| [2411](#L2411) | //Prep Included Directories |
| [2412](#L2412) | $directories = 'wp\-content|wp\-includes'; |
| [2413](#L2413) | if (!empty($cdn['cdn\_directories'])) { |
| [2414](#L2414) | $directoriesArray = array\_map('trim', explode(',', $cdn['cdn\_directories'])); |
| [2415](#L2415) |  |
| [2416](#L2416) | if (count($directoriesArray) > 0) { |
| [2417](#L2417) | $directories = implode('|', array\_map('quotemeta', array\_filter($directoriesArray))); |
| [2418](#L2418) | } |
| [2419](#L2419) | } |
| [2420](#L2420) |  |
| [2421](#L2421) | $old\_values['lazy'] = self::$lazy\_enabled; |
| [2422](#L2422) | $old\_values['adaptive'] = self::$adaptive\_enabled; |
| [2423](#L2423) |  |
| [2424](#L2424) | self::$lazy\_enabled = 0; |
| [2425](#L2425) | self::$adaptive\_enabled = 0; |
| [2426](#L2426) |  |
| [2427](#L2427) | $regEx = '#(?<=[(\"\'])(?:' . $regExURL . ')?/(?:((?:' . $directories . ')[^\"\')]+)|([^/\"\']+\.[^/\"\')]+))(?=[\"\')])#'; |
| [2428](#L2428) | $html = preg\_replace\_callback($regEx, [$this, 'cdn\_rewrite\_url'], $html, true); |
| [2429](#L2429) |  |
| [2430](#L2430) | self::$lazy\_enabled = $old\_values['lazy']; |
| [2431](#L2431) | self::$adaptive\_enabled = $old\_values['adaptive']; |
| [2432](#L2432) |  |
| [2433](#L2433) | $args['content'] = $html; |
| [2434](#L2434) |  |
| [2435](#L2435) | return $args; |
| [2436](#L2436) | } |
| [2437](#L2437) |  |
| [2438](#L2438) | public function saveCache($html) |
| [2439](#L2439) | { |
| [2440](#L2440) |  |
| [2441](#L2441) | $cacheActive = !(isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '0') && ((isset(self::$settings['cache']['advanced']) && self::$settings['cache']['advanced'] == '1') || (isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '1')); |
| [2442](#L2442) |  |
| [2443](#L2443) | if ($cacheActive) { |
| [2444](#L2444) | if ((!self::isExcludedFromCache($html) && $this->doCacheCombine())) { |
| [2445](#L2445) | if (!self::is\_mobile()) { |
| [2446](#L2446) | return self::$cacheHtml->saveCache($html); |
| [2447](#L2447) | } else { |
| [2448](#L2448) | return self::$cacheHtml->saveCache($html, 'mobile'); |
| [2449](#L2449) | } |
| [2450](#L2450) | } |
| [2451](#L2451) | } |
| [2452](#L2452) |  |
| [2453](#L2453) | return $html; |
| [2454](#L2454) | } |
| [2455](#L2455) |  |
| [2456](#L2456) | public static function isExcludedFromCache($html) |
| [2457](#L2457) | { |
| [2458](#L2458) | $output = []; |
| [2459](#L2459) |  |
| [2460](#L2460) | if ((strpos($html, 'id="wp-admin-bar') !== false || strpos($html, "id='wp-admin-bar") !== false) || (strpos($html, 'id="wpadminbar"') !== false || strpos($html, "id='wpadminbar'") !== false)) { |
| [2461](#L2461) | return true; |
| [2462](#L2462) | } |
| [2463](#L2463) |  |
| [2464](#L2464) | if (isset(self::$excludes['cache'])) { |
| [2465](#L2465) | if (!is\_array(self::$excludes['cache'])) { |
| [2466](#L2466) | $excludedUrls = explode("\n", self::$excludes['cache']); |
| [2467](#L2467) | } else { |
| [2468](#L2468) | $excludedUrls = self::$excludes['cache']; |
| [2469](#L2469) | } |
| [2470](#L2470) |  |
| [2471](#L2471) |  |
| [2472](#L2472) | if (!empty($excludedUrls)) { |
| [2473](#L2473) | foreach ($excludedUrls as $k => $path) { |
| [2474](#L2474) | if (!empty($path)) { |
| [2475](#L2475) | $path = trim($path); |
| [2476](#L2476) | if (strpos($\_SERVER['REQUEST\_URI'], $path) !== false) { |
| [2477](#L2477) | return true; |
| [2478](#L2478) | } |
| [2479](#L2479) | } |
| [2480](#L2480) | } |
| [2481](#L2481) | } |
| [2482](#L2482) | } |
| [2483](#L2483) |  |
| [2484](#L2484) | // Is Woo commerce Cart |
| [2485](#L2485) | if (class\_exists('WooCommerce')) { |
| [2486](#L2486) | if (is\_cart() || is\_checkout()) { |
| [2487](#L2487) | return true; |
| [2488](#L2488) | } |
| [2489](#L2489) | } |
| [2490](#L2490) |  |
| [2491](#L2491) | return false; |
| [2492](#L2492) | } |
| [2493](#L2493) |  |
| [2494](#L2494) | public function cdnRewriter($html) |
| [2495](#L2495) | { |
| [2496](#L2496) |  |
| [2497](#L2497) | self::$wpcPreloadLinks = []; |
| [2498](#L2498) |  |
| [2499](#L2499) | $isUserLoggedIn = is\_user\_logged\_in(); |
| [2500](#L2500) | $isVisitorMode = false; |
| [2501](#L2501) | if (!empty($\_GET['wpc\_visitor\_mode']) && $\_GET['wpc\_visitor\_mode']) { |
| [2502](#L2502) | $isVisitorMode = $\_GET['wpc\_visitor\_mode']; |
| [2503](#L2503) | } |
| [2504](#L2504) |  |
| [2505](#L2505) | $criticalCombine = false; |
| [2506](#L2506) | if (!empty($\_GET['criticalCombine']) && $\_GET['criticalCombine']) { |
| [2507](#L2507) | $criticalCombine = true; |
| [2508](#L2508) | } |
| [2509](#L2509) |  |
| [2510](#L2510) | if (!empty($\_GET['no\_rewriter'])) { |
| [2511](#L2511) | return 'no-cdn-rewriter'; |
| [2512](#L2512) | } |
| [2513](#L2513) |  |
| [2514](#L2514) | if (!empty($\_GET['ignore\_ic']) || !self::dontRunif()) { |
| [2515](#L2515) | return $html; |
| [2516](#L2516) | } |
| [2517](#L2517) |  |
| [2518](#L2518) | /\*\* |
| [2519](#L2519) | \* Woocommerce fix - store stops working |
| [2520](#L2520) | \*/ |
| [2521](#L2521) | if (isset($\_GET['wc-ajax']) || isset($\_GET['product\_sku']) || !empty($\_POST['product\_sku'])) { |
| [2522](#L2522) | return $html; |
| [2523](#L2523) | } |
| [2524](#L2524) |  |
| [2525](#L2525) | if (is\_feed()) { |
| [2526](#L2526) | return $html; |
| [2527](#L2527) | } |
| [2528](#L2528) |  |
| [2529](#L2529) | if (self::$isAjax) { |
| [2530](#L2530) | return $html; |
| [2531](#L2531) | } |
| [2532](#L2532) |  |
| [2533](#L2533) | if (strpos($\_SERVER['REQUEST\_URI'], 'xmlrpc') !== false || strpos($\_SERVER['REQUEST\_URI'], 'wp-json') !== false) { |
| [2534](#L2534) | return $html; |
| [2535](#L2535) | } |
| [2536](#L2536) |  |
| [2537](#L2537) | self::$isAmp = new wps\_ic\_amp(); |
| [2538](#L2538) | $combine\_css = new wps\_ic\_combine\_css(); |
| [2539](#L2539) |  |
| [2540](#L2540) | if (self::$isAmp->isAmp()) { |
| [2541](#L2541) | self::$lazy\_enabled = '0'; |
| [2542](#L2542) | self::$adaptive\_enabled = '0'; |
| [2543](#L2543) | self::$retina\_enabled = '0'; |
| [2544](#L2544) | self::$settings['delay\_js'] = '0'; |
| [2545](#L2545) | self::$settings['inline-js'] = '0'; |
| [2546](#L2546) | } |
| [2547](#L2547) |  |
| [2548](#L2548) |  |
| [2549](#L2549) | // This is for AJAX Replace, works on Jet Engine and some others - might need integration |
| [2550](#L2550) | // TODO: Integration for other ajax loaders |
| [2551](#L2551) | if (!empty($\_POST['action'])) { |
| [2552](#L2552) | // Find all URLs on page that have not been replaced |
| [2553](#L2553) | $html = preg\_replace\_callback('/(?<![\"|\'])<img[^>]\*>/i', [ |
| [2554](#L2554) | self::$rewriteLogic, |
| [2555](#L2555) | 'replaceImageTagsDoSlash' |
| [2556](#L2556) | ], $html); |
| [2557](#L2557) |  |
| [2558](#L2558) | return $html; |
| [2559](#L2559) | } |
| [2560](#L2560) |  |
| [2561](#L2561) | if (empty($\_GET['wpc\_disableCommentClear'])) { |
| [2562](#L2562) | //clear html comments (so combine doesn't pick them up) |
| [2563](#L2563) | $html = preg\_replace("/<!--->/ms", '', $html); |
| [2564](#L2564) | $html = preg\_replace\_callback("/<!--(.\*?)-->/ms", function ($matches) { |
| [2565](#L2565) | if (strpos($matches[1], 'sc\_project') !== false) { |
| [2566](#L2566) | // statcounter puts some of their needed JS inside html comments |
| [2567](#L2567) | return $matches[0]; |
| [2568](#L2568) | } else { |
| [2569](#L2569) | return ''; |
| [2570](#L2570) | } |
| [2571](#L2571) | }, $html); |
| [2572](#L2572) | } |
| [2573](#L2573) |  |
| [2574](#L2574) | //Prep Site URL |
| [2575](#L2575) | $this->getRegexp(); |
| [2576](#L2576) |  |
| [2577](#L2577) | if (empty($\_GET['wpc\_disableStrip'])) { |
| [2578](#L2578) | $html = self::$rewriteLogic->scriptContent($html); |
| [2579](#L2579) | } |
| [2580](#L2580) |  |
| [2581](#L2581) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replace\_iframe\_tags') { |
| [2582](#L2582) | return $html; |
| [2583](#L2583) | } |
| [2584](#L2584) |  |
| [2585](#L2585) | // Layzload Iframe - sets load="lazy" to iframe tag |
| [2586](#L2586) | // TODO: Fix so that it checks does iframe already have load="lazy|auto" |
| [2587](#L2587) | if (!empty(self::$settings['iframe-lazy']) && self::$settings['iframe-lazy'] == '1' && !$isUserLoggedIn) { |
| [2588](#L2588) | $html = preg\_replace\_callback('/<iframe[^>]\*>(.\*?)<\/iframe>/si', [$this, 'replace\_iframe\_tags'], $html); |
| [2589](#L2589) | } |
| [2590](#L2590) |  |
| [2591](#L2591) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'encode\_iframe') { |
| [2592](#L2592) | return $html; |
| [2593](#L2593) | } |
| [2594](#L2594) |  |
| [2595](#L2595) | if (!$isUserLoggedIn) { |
| [2596](#L2596) | $html = self::$rewriteLogic->encodeIframe($html); |
| [2597](#L2597) | } |
| [2598](#L2598) |  |
| [2599](#L2599) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'crittr\_replace\_css') { |
| [2600](#L2600) | return $html; |
| [2601](#L2601) | } |
| [2602](#L2602) |  |
| [2603](#L2603) | if ((!empty($\_GET['debugCritical']) || !empty($\_GET['generateCriticalAPI']))) { |
| [2604](#L2604) | $isUserLoggedIn = is\_user\_logged\_in(); |
| [2605](#L2605) | $html = preg\_replace\_callback('/<link\b[^>]\*>/si', [$this, 'crittr\_replace\_css'], $html); |
| [2606](#L2606) | } |
| [2607](#L2607) |  |
| [2608](#L2608) | $html = preg\_replace\_callback('/<noscript><iframe.\*?<\/noscript>/is', [$this, 'noscript\_encode'], $html); |
| [2609](#L2609) |  |
| [2610](#L2610) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'backgroundSizing') { |
| [2611](#L2611) | return $html; |
| [2612](#L2612) | } |
| [2613](#L2613) |  |
| [2614](#L2614) | // Replace Background |
| [2615](#L2615) | if (!empty(self::$settings['background-sizing']) && self::$settings['background-sizing'] == '1') { |
| [2616](#L2616) | $html = self::$rewriteLogic->backgroundSizing($html); |
| [2617](#L2617) | } |
| [2618](#L2618) |  |
| [2619](#L2619) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replaceImageTags') { |
| [2620](#L2620) | return $html; |
| [2621](#L2621) | } |
| [2622](#L2622) |  |
| [2623](#L2623) |  |
| [2624](#L2624) | if (!empty($\_GET['debug\_preload\_inject'])) { |
| [2625](#L2625) | $dbg = 'Before:'; |
| [2626](#L2626) | $dbg .= $html; |
| [2627](#L2627) | } |
| [2628](#L2628) |  |
| [2629](#L2629) | $html = preg\_replace\_callback('/<head\b[^>]\*>/si', [$this, 'injectPreloadImages'], $html); |
| [2630](#L2630) |  |
| [2631](#L2631) | if (!empty($\_GET['debug\_preload\_inject'])) { |
| [2632](#L2632) | $dbg .= 'After:'; |
| [2633](#L2633) | $dbg .= $html; |
| [2634](#L2634) |  |
| [2635](#L2635) | return $dbg; |
| [2636](#L2636) | } |
| [2637](#L2637) |  |
| [2638](#L2638) |  |
| [2639](#L2639) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'wpFontsLocal') { |
| [2640](#L2640) | return $html; |
| [2641](#L2641) | } |
| [2642](#L2642) |  |
| [2643](#L2643) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replaceImageTags0') { |
| [2644](#L2644) | return $html; |
| [2645](#L2645) | } |
| [2646](#L2646) |  |
| [2647](#L2647) | $html = self::$rewriteLogic->defferFontAwesome($html); |
| [2648](#L2648) |  |
| [2649](#L2649) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'setImageSize') { |
| [2650](#L2650) | return $html; |
| [2651](#L2651) | } |
| [2652](#L2652) |  |
| [2653](#L2653) | $html = preg\_replace\_callback('/<img[^>]\*src=[\'"]([^\'"]+)[\'"][^>]\*>/si', [$this, 'set\_image\_sizes'], $html); |
| [2654](#L2654) | $html = preg\_replace\_callback('/<picture>.\*?<\/picture>/is', [$this, 'set\_image\_sizes'], $html); |
| [2655](#L2655) |  |
| [2656](#L2656) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replaceImageTags1') { |
| [2657](#L2657) | return $html; |
| [2658](#L2658) | } |
| [2659](#L2659) |  |
| [2660](#L2660) | // Replace <img> tags |
| [2661](#L2661) | $html = self::$rewriteLogic->replaceImageTags($html); |
| [2662](#L2662) |  |
| [2663](#L2663) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replaceImageTags2') { |
| [2664](#L2664) | return $html; |
| [2665](#L2665) | } |
| [2666](#L2666) |  |
| [2667](#L2667) | // Find Logo and LCP |
| [2668](#L2668) | $foundLCP = $combine\_css->preloadLCP($html); |
| [2669](#L2669) | if (!empty($foundLCP)) { |
| [2670](#L2670) | $preloadLCP = ''; |
| [2671](#L2671) | foreach ($foundLCP as $i => $imageUrl) { |
| [2672](#L2672) | #$preloadLCP .= '<link rel="preload" href="'.$imageUrl.'" as="image">'; |
| [2673](#L2673) | } |
| [2674](#L2674) |  |
| [2675](#L2675) | $html = str\_replace('<!--WPC\_INSERT\_PRELOAD\_MAIN-->', $preloadLCP, $html); |
| [2676](#L2676) | } |
| [2677](#L2677) |  |
| [2678](#L2678) | // Replace <picture> tags |
| [2679](#L2679) | $html = self::$rewriteLogic->replacePictureTags($html); |
| [2680](#L2680) |  |
| [2681](#L2681) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'replaceImageTags3') { |
| [2682](#L2682) | return $html; |
| [2683](#L2683) | } |
| [2684](#L2684) |  |
| [2685](#L2685) | // Find revSlider Data-thumb |
| [2686](#L2686) | $html = self::$rewriteLogic->revSliderReplace($html); |
| [2687](#L2687) |  |
| [2688](#L2688) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cdn\_rewrite\_url') { |
| [2689](#L2689) | return $html; |
| [2690](#L2690) | } |
| [2691](#L2691) |  |
| [2692](#L2692) | // Critical CSS Remove from Header |
| [2693](#L2693) | $criticalActive = !(isset(self::$page\_excludes['critical\_css']) && self::$page\_excludes['critical\_css'] == '0') && ((isset(self::$settings['critical']['css']) && self::$settings['critical']['css'] == '1') || (isset(self::$page\_excludes['critical\_css']) && self::$page\_excludes['critical\_css'] == '1')); |
| [2694](#L2694) |  |
| [2695](#L2695) | $criticalCSS = new wps\_criticalCss(); |
| [2696](#L2696) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [2697](#L2697) |  |
| [2698](#L2698) |  |
| [2699](#L2699) | //Combine CSS |
| [2700](#L2700) | if ($criticalCombine || (!empty(self::$settings['css\_combine']) && self::$settings['css\_combine'] == '1')) { |
| [2701](#L2701) | if (empty($\_GET['stopCombineCSS'])) { |
| [2702](#L2702) | $html = $combine\_css->maybe\_do\_combine($html); |
| [2703](#L2703) | } |
| [2704](#L2704) | } |
| [2705](#L2705) |  |
| [2706](#L2706) | if (!$criticalCombine) { |
| [2707](#L2707) | if (isset(self::$settings['inline-css']) && self::$settings['inline-css'] == '1') { |
| [2708](#L2708) | // TODO: Maybe add something? |
| [2709](#L2709) | if ($criticalActive && !empty($criticalCSSExists)) { |
| [2710](#L2710) | //critical exists, dont inline |
| [2711](#L2711) | } else { |
| [2712](#L2712) | $html = $combine\_css->doInline($html); |
| [2713](#L2713) | } |
| [2714](#L2714) | } |
| [2715](#L2715) | } |
| [2716](#L2716) |  |
| [2717](#L2717) | $addslashes = false; |
| [2718](#L2718) | if (!empty($\_POST['action'])) { |
| [2719](#L2719) | $addslashes = true; |
| [2720](#L2720) | } |
| [2721](#L2721) |  |
| [2722](#L2722) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cdn\_rewrite\_url\_2') { |
| [2723](#L2723) | return $html; |
| [2724](#L2724) | } |
| [2725](#L2725) |  |
| [2726](#L2726) | // Find all URLs on page that have not been replaced |
| [2727](#L2727) | $regEx = '#(?<=[(\"\'])(?:' . self::$regExURL . ')?/(?:((?:' . self::$regExDir . ')[^\"\')]+)|([^/\"\']+\.[^/\"\')]+))(?=[\"\')])#'; |
| [2728](#L2728) | $html = preg\_replace\_callback($regEx, [$this, 'cdn\_rewrite\_url'], $html); |
| [2729](#L2729) |  |
| [2730](#L2730) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'combine\_css') { |
| [2731](#L2731) | return $html; |
| [2732](#L2732) | } |
| [2733](#L2733) |  |
| [2734](#L2734) | if (isset(self::$settings['fontawesome-lazy']) && self::$settings['fontawesome-lazy'] == '1') { |
| [2735](#L2735) | // TODO: Maybe add something? |
| [2736](#L2736) | $html = $combine\_css->lazyFontawesome($html); |
| [2737](#L2737) | } |
| [2738](#L2738) |  |
| [2739](#L2739) | if (isset(self::$settings['gtag-lazy']) && self::$settings['gtag-lazy'] == '1') { |
| [2740](#L2740) | // TODO: Maybe add something? |
| [2741](#L2741) | $html = preg\_replace\_callback('/<script\b[^>]\*(src="[^"]\*gtag[^"]\*")[^>]\*>.\*?<\/script>/si', [ |
| [2742](#L2742) | $this, |
| [2743](#L2743) | 'gtagDelay' |
| [2744](#L2744) | ], $html); |
| [2745](#L2745) | } |
| [2746](#L2746) |  |
| [2747](#L2747) |  |
| [2748](#L2748) | if ((empty($\_GET['disableCritical']) && empty($\_GET['generateCriticalAPI'])) && !$this->criticalCombine) { |
| [2749](#L2749) | if (!is\_user\_logged\_in() && !is\_admin\_bar\_showing()) { |
| [2750](#L2750) |  |
| [2751](#L2751) | if ($criticalActive && !self::$preloaderAPI) { |
| [2752](#L2752) | global $post; |
| [2753](#L2753) | if (!empty($\_GET['forceCriticalAjax'])) { |
| [2754](#L2754) | $html = self::$rewriteLogic->runCriticalAjax($html); |
| [2755](#L2755) | } else { |
| [2756](#L2756) | if (empty($criticalCSSExists)) { |
| [2757](#L2757) | $criticalRunning = $criticalCSS->criticalRunning(); |
| [2758](#L2758) | if (!$criticalRunning) { |
| [2759](#L2759) | set\_transient('wpc\_critical\_ajax\_' . md5($\_SERVER['REQUEST\_URI']), date('d.m.Y H:i:s'), 60 \* 5); |
| [2760](#L2760) | $html = self::$rewriteLogic->runCriticalAjax($html); |
| [2761](#L2761) | } |
| [2762](#L2762) | } |
| [2763](#L2763) |  |
| [2764](#L2764) | } |
| [2765](#L2765) | } |
| [2766](#L2766) |  |
| [2767](#L2767) | } |
| [2768](#L2768) | } |
| [2769](#L2769) |  |
| [2770](#L2770) | if (empty($\_GET['criticalCombine'])) { |
| [2771](#L2771) | if (isset(self::$settings['inline-css']) && self::$settings['inline-css'] == '1') { |
| [2772](#L2772) | //                        // TODO: Maybe add something? |
| [2773](#L2773) | //                        if($criticalActive && !empty($criticalCSSExists)) { |
| [2774](#L2774) | //                                      //critical exists, dont inline |
| [2775](#L2775) | //                        } else { |
| [2776](#L2776) | //                                $html = $combine\_css->doInline($html); |
| [2777](#L2777) | //                        } |
| [2778](#L2778) | } else { |
| [2779](#L2779) | // Find and Preload Fonts!! |
| [2780](#L2780) | self::$wpcPreloadLinks = $combine\_css->preparePreloads($html); |
| [2781](#L2781) | if (!empty(self::$wpcPreloadLinks)) { |
| [2782](#L2782) | $preloadFonts = implode('', self::$wpcPreloadLinks); |
| [2783](#L2783) |  |
| [2784](#L2784) | $html = str\_replace('<!--WPC\_INSERT\_PRELOAD-->', $preloadFonts, $html); |
| [2785](#L2785) | } |
| [2786](#L2786) | } |
| [2787](#L2787) | } |
| [2788](#L2788) |  |
| [2789](#L2789) | if ((empty($\_GET['disableCritical']) && empty($\_GET['generateCriticalAPI'])) && !$this->criticalCombine) { |
| [2790](#L2790) | if (!is\_user\_logged\_in() && !is\_admin\_bar\_showing()) { |
| [2791](#L2791) | if (!empty($\_GET['debugCriticalRunning'])) { |
| [2792](#L2792) | $html .= print\_r([self::$settings['critical']['css'], $criticalCSSExists, $criticalRunning], true); |
| [2793](#L2793) | } |
| [2794](#L2794) |  |
| [2795](#L2795) |  |
| [2796](#L2796) | if (!empty($\_GET['debugCritical\_replace'])) { |
| [2797](#L2797) | #global $post; |
| [2798](#L2798) | $criticalCSS = new wps\_criticalCss(); |
| [2799](#L2799) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [2800](#L2800) | $criticalCSSContent = file\_get\_contents($criticalCSSExists['file']); |
| [2801](#L2801) |  |
| [2802](#L2802) | return print\_r([ |
| [2803](#L2803) | 'critActive:' => $criticalActive, |
| [2804](#L2804) | 'preloadApi' => self::$preloaderAPI, |
| [2805](#L2805) | 'excluded' => self::isURLExcluded('critical\_css'), |
| [2806](#L2806) | $criticalCSSExists, |
| [2807](#L2807) | $criticalCSSContent |
| [2808](#L2808) | ], true); |
| [2809](#L2809) | } |
| [2810](#L2810) |  |
| [2811](#L2811) | if (!empty($\_GET['testCritical'])) { |
| [2812](#L2812) | self::$settings['critical']['css'] = '1'; |
| [2813](#L2813) | $html = self::$rewriteLogic->lazyCSS($html); |
| [2814](#L2814) | $html = self::$rewriteLogic->addCritical($html); |
| [2815](#L2815) | } |
| [2816](#L2816) |  |
| [2817](#L2817) | if ($criticalActive && !self::$preloaderAPI) { |
| [2818](#L2818) | if (!self::isURLExcluded('critical\_css')) { |
| [2819](#L2819) |  |
| [2820](#L2820) | #global $post; |
| [2821](#L2821) | $criticalCSS = new wps\_criticalCss(); |
| [2822](#L2822) | $criticalCSSExists = $criticalCSS->criticalExists(); |
| [2823](#L2823) |  |
| [2824](#L2824) | if (!empty($criticalCSSExists)) { |
| [2825](#L2825) | $html = self::$rewriteLogic->lazyCSS($html); |
| [2826](#L2826) | $html = self::$rewriteLogic->addCritical($html); |
| [2827](#L2827) | } else { |
| [2828](#L2828) | //this way should be ok for multisite |
| [2829](#L2829) | } |
| [2830](#L2830) | } |
| [2831](#L2831) | } |
| [2832](#L2832) | } |
| [2833](#L2833) | } |
| [2834](#L2834) |  |
| [2835](#L2835) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'externalUrls') { |
| [2836](#L2836) | return $html; |
| [2837](#L2837) | } |
| [2838](#L2838) |  |
| [2839](#L2839) | if (self::$externalUrlEnabled == '1') { |
| [2840](#L2840) | $html = self::$rewriteLogic->externalUrls($html); |
| [2841](#L2841) | } else { |
| [2842](#L2842) | if (!empty(self::$replaceAllLinks) && self::$replaceAllLinks == '1') { |
| [2843](#L2843) | $html = self::$rewriteLogic->allLinks($html); |
| [2844](#L2844) | } |
| [2845](#L2845) | } |
| [2846](#L2846) |  |
| [2847](#L2847) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'fonts') { |
| [2848](#L2848) | return $html; |
| [2849](#L2849) | } |
| [2850](#L2850) |  |
| [2851](#L2851) | if (self::$fonts == 1) { |
| [2852](#L2852) | $html = self::$rewriteLogic->fonts($html); |
| [2853](#L2853) | } |
| [2854](#L2854) |  |
| [2855](#L2855) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'decodeIframe') { |
| [2856](#L2856) | return $html; |
| [2857](#L2857) | } |
| [2858](#L2858) |  |
| [2859](#L2859) | if (!$isUserLoggedIn) { |
| [2860](#L2860) | $html = self::$rewriteLogic->decodeIframe($html); |
| [2861](#L2861) | } |
| [2862](#L2862) |  |
| [2863](#L2863) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'noscript\_decode') { |
| [2864](#L2864) | return $html; |
| [2865](#L2865) | } |
| [2866](#L2866) |  |
| [2867](#L2867) | $html = preg\_replace\_callback('/\[noscript\-wpc\](.\*?)\[\/noscript\-wpc\]/i', [$this, 'noscript\_decode'], $html); |
| [2868](#L2868) |  |
| [2869](#L2869) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'Inline') { |
| [2870](#L2870) | return $html; |
| [2871](#L2871) | } |
| [2872](#L2872) |  |
| [2873](#L2873) |  |
| [2874](#L2874) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'combine\_js') { |
| [2875](#L2875) | return $html; |
| [2876](#L2876) | } |
| [2877](#L2877) |  |
| [2878](#L2878) | //Combine JS |
| [2879](#L2879) | if ($this->doCacheCombine() && (isset(self::$settings['js\_combine']) && self::$settings['js\_combine'] == '1')) { |
| [2880](#L2880) | $combine\_js = new wps\_ic\_combine\_js(); |
| [2881](#L2881) | $html = $combine\_js->maybe\_do\_combine($html); |
| [2882](#L2882) | } |
| [2883](#L2883) |  |
| [2884](#L2884) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'delay\_js') { |
| [2885](#L2885) | return $html; |
| [2886](#L2886) | } |
| [2887](#L2887) |  |
| [2888](#L2888) |  |
| [2889](#L2889) | //Delay JS |
| [2890](#L2890) | $delayActive = !(isset(self::$page\_excludes['delay\_js']) && self::$page\_excludes['delay\_js'] == '0') && ((isset(self::$settings['delay-js']) && self::$settings['delay-js'] == '1') || (isset(self::$page\_excludes['delay\_js']) && self::$page\_excludes['delay\_js'] == '1')); |
| [2891](#L2891) |  |
| [2892](#L2892) | if (empty($\_GET['disableDelay']) && empty($\_GET['criticalCombine'])) { |
| [2893](#L2893) | $js\_delay = new wps\_ic\_js\_delay(); |
| [2894](#L2894) | if (empty($\_GET['disableCritical']) && $delayActive && !current\_user\_can('manage\_options') && !self::$delay\_js\_override && !self::$preloaderAPI) { |
| [2895](#L2895) | if (!empty(self::$settings['preload-scripts']) && self::$settings['preload-scripts'] == '1') { |
| [2896](#L2896) | $html = $js\_delay->preload\_scripts($html); |
| [2897](#L2897) | } |
| [2898](#L2898) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$js\_delay, 'delay\_script\_replace'], $html); |
| [2899](#L2899) | } else { |
| [2900](#L2900) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$js\_delay, 'removeNoDelay'], $html); |
| [2901](#L2901) | } |
| [2902](#L2902) |  |
| [2903](#L2903) | } |
| [2904](#L2904) |  |
| [2905](#L2905) | if (!empty($\_GET['testGtag'])) { |
| [2906](#L2906) | $html = preg\_replace\_callback('/<script\s+src="([^"]+)"[^>]\*>/si', [$this, 'gtagDelay'], $html); |
| [2907](#L2907) |  |
| [2908](#L2908) | return print\_r([$html], true); |
| [2909](#L2909) | } |
| [2910](#L2910) |  |
| [2911](#L2911) | if (empty($\_GET['disableCritical']) && !empty(self::$settings['scripts-to-footer']) && self::$settings['scripts-to-footer'] == '1') { |
| [2912](#L2912) | $js\_delay = new wps\_ic\_js\_delay(); |
| [2913](#L2913) | $html = preg\_replace\_callback('/<script\b[^>]\*>(.\*?)<\/script>/si', [$js\_delay, 'scriptsToFooter'], $html); |
| [2914](#L2914) | $html = preg\_replace\_callback('/<\/body>/si', [$js\_delay, 'printFooterScripts'], $html); |
| [2915](#L2915) | } |
| [2916](#L2916) |  |
| [2917](#L2917) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cache\_minify') { |
| [2918](#L2918) | return $html; |
| [2919](#L2919) | } |
| [2920](#L2920) |  |
| [2921](#L2921) | if (!empty(self::$settings['cache']['minify']) && self::$settings['cache']['minify'] == '1') { |
| [2922](#L2922) | if (!self::isURLExcluded('minify\_html')) { |
| [2923](#L2923) | $html = self::$minifyHtml->minify($html); |
| [2924](#L2924) | } |
| [2925](#L2925) | } |
| [2926](#L2926) |  |
| [2927](#L2927) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cache\_settings') { |
| [2928](#L2928) | return $html; |
| [2929](#L2929) | } |
| [2930](#L2930) |  |
| [2931](#L2931) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'cache\_settings') { |
| [2932](#L2932) | return print\_r([ |
| [2933](#L2933) | 'settings' => self::$settings, |
| [2934](#L2934) | 'advanced' => self::$settings['cache']['advanced'], |
| [2935](#L2935) | 'html' => self::$settings['cache']['html'], |
| [2936](#L2936) | 'mobile' => self::$settings['cache']['mobile'], |
| [2937](#L2937) | 'is\_mobile' => self::is\_mobile(), |
| [2938](#L2938) | 'url\_excluded\_simple' => self::isURLExcluded('simple\_caching'), |
| [2939](#L2939) | 'url\_excluded\_advanced' => self::isURLExcluded('cache'), |
| [2940](#L2940) | 'exclude\_per\_page' => isset(self::$page\_excludes['advanced\_cache']) ? self::$page\_excludes['advanced\_cache'] : '' |
| [2941](#L2941) | ], true); |
| [2942](#L2942) | } |
| [2943](#L2943) |  |
| [2944](#L2944) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cache\_advanced') { |
| [2945](#L2945) | return $html; |
| [2946](#L2946) | } |
| [2947](#L2947) |  |
| [2948](#L2948) |  |
| [2949](#L2949) | // Cache |
| [2950](#L2950) | $cacheActive = !(isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '0') && ((isset(self::$settings['cache']['advanced']) && self::$settings['cache']['advanced'] == '1') || (isset(self::$page\_excludes['advanced\_cache']) && self::$page\_excludes['advanced\_cache'] == '1')); |
| [2951](#L2951) |  |
| [2952](#L2952) |  |
| [2953](#L2953) | if (!empty($\_GET['stop\_before']) && $\_GET['stop\_before'] == 'cache\_mobile') { |
| [2954](#L2954) | return $html; |
| [2955](#L2955) | } |
| [2956](#L2956) |  |
| [2957](#L2957) | // Theme Integrations |
| [2958](#L2958) | return self::$themeIntegrations->getIntegration($html); |
| [2959](#L2959) | } |
| [2960](#L2960) |  |
| [2961](#L2961) | public function getRegexp() |
| [2962](#L2962) | { |
| [2963](#L2963) | if (!isset(self::$options['regExUrl']) || !isset(self::$options['regexpDirectories']) || empty(self::$options['regExUrl']) || empty(self::$options['regexpDirectories'])) { |
| [2964](#L2964) | $escapedSiteURL = quotemeta(self::$home\_url); |
| [2965](#L2965) | self::$options['regExUrl'] = $regExURL = '(https?:|)' . substr($escapedSiteURL, strpos($escapedSiteURL, '//')); |
| [2966](#L2966) |  |
| [2967](#L2967) | //Prep Included Directories |
| [2968](#L2968) | $directories = 'wp\-content|wp\-includes'; |
| [2969](#L2969) | if (!empty($cdn['cdn\_directories'])) { |
| [2970](#L2970) | $directoriesArray = array\_map('trim', explode(',', $cdn['cdn\_directories'])); |
| [2971](#L2971) |  |
| [2972](#L2972) | if (count($directoriesArray) > 0) { |
| [2973](#L2973) | $directories = implode('|', array\_map('quotemeta', array\_filter($directoriesArray))); |
| [2974](#L2974) | } |
| [2975](#L2975) | } |
| [2976](#L2976) |  |
| [2977](#L2977) | self::$options['regexpDirectories'] = $directories; |
| [2978](#L2978) |  |
| [2979](#L2979) | self::$regExURL = $regExURL; |
| [2980](#L2980) | self::$regExDir = $directories; |
| [2981](#L2981) |  |
| [2982](#L2982) | update\_option(WPS\_IC\_OPTIONS, self::$options); |
| [2983](#L2983) | } else { |
| [2984](#L2984) | self::$regExURL = self::$options['regExUrl']; |
| [2985](#L2985) | self::$regExDir = self::$options['regexpDirectories']; |
| [2986](#L2986) | } |
| [2987](#L2987) | } |
| [2988](#L2988) |  |
| [2989](#L2989) | public function set\_image\_sizes($matches) |
| [2990](#L2990) | { |
| [2991](#L2991) |  |
| [2992](#L2992) | if (empty(self::$settings['add-image-sizes']) || self::$settings['add-image-sizes'] == '0') { |
| [2993](#L2993) | return $matches[0]; |
| [2994](#L2994) | } |
| [2995](#L2995) |  |
| [2996](#L2996) | // Check if the image is within a <picture> tag |
| [2997](#L2997) | if (strpos($matches[0], '<picture>') !== false) { |
| [2998](#L2998) | // Extract the <img> tag src from the <picture> |
| [2999](#L2999) | preg\_match('/<img[^>]\*src=[\'"]([^\'"]+)[\'"][^>]\*>/si', $matches[0], $imgMatches); |
| [3000](#L3000) | if (!$imgMatches) { |
| [3001](#L3001) | return $matches[0]; // No <img> tag found within <picture>, return original |
| [3002](#L3002) | } |
| [3003](#L3003) | $imageUrl = $imgMatches[1]; |
| [3004](#L3004) | } else { |
| [3005](#L3005) | // Direct <img> tag |
| [3006](#L3006) | $imageUrl = $matches[1]; |
| [3007](#L3007) | } |
| [3008](#L3008) |  |
| [3009](#L3009) | // Convert URL to local path for local images, or keep as URL for external images |
| [3010](#L3010) | $localPath = $this->url\_to\_path($imageUrl); |
| [3011](#L3011) |  |
| [3012](#L3012) | if (!$localPath) { |
| [3013](#L3013) | // If the image is external and external image handling is disabled, return the tag unchanged |
| [3014](#L3014) | return $matches[0]; |
| [3015](#L3015) | } |
| [3016](#L3016) |  |
| [3017](#L3017) | // Get image dimensions |
| [3018](#L3018) | $dimensions = $this->get\_image\_dimensions($localPath); |
| [3019](#L3019) | if ($dimensions === false) { |
| [3020](#L3020) | // Couldn't get dimensions, return the tag unchanged |
| [3021](#L3021) | return $matches[0]; |
| [3022](#L3022) | } |
| [3023](#L3023) |  |
| [3024](#L3024) | // Construct the width and height string |
| [3025](#L3025) | $widthHeightStr = 'width="' . round($dimensions[0], 0) . '" height="' . round($dimensions[1], 0) . '"'; |
| [3026](#L3026) |  |
| [3027](#L3027) | // Insert width and height into the <img> tag |
| [3028](#L3028) | if (isset($imgMatches)) { |
| [3029](#L3029) | // For <picture>, reconstruct the <img> tag with dimensions added |
| [3030](#L3030) | $newImgTag = preg\_replace('/<img([^>]+)>/', '<img$1 ' . $widthHeightStr . '>', $imgMatches[0]); |
| [3031](#L3031) |  |
| [3032](#L3032) | // Replace the old <img> tag with the new one within <picture> |
| [3033](#L3033) | return str\_replace($imgMatches[0], $newImgTag, $matches[0]); |
| [3034](#L3034) | } else { |
| [3035](#L3035) | // For direct <img> tags, add dimensions directly |
| [3036](#L3036) | return preg\_replace('/<img/', '<img ' . $widthHeightStr, $matches[0]); |
| [3037](#L3037) | } |
| [3038](#L3038) | } |
| [3039](#L3039) |  |
| [3040](#L3040) | public function url\_to\_path($url) |
| [3041](#L3041) | { |
| [3042](#L3042) | $parsedUrl = parse\_url($url); |
| [3043](#L3043) | $siteUrl = parse\_url(get\_site\_url()); |
| [3044](#L3044) |  |
| [3045](#L3045) | // Check if URL is external |
| [3046](#L3046) | if (!isset($parsedUrl['host']) || !isset($siteUrl['host']) || $parsedUrl['host'] !== $siteUrl['host']) { |
| [3047](#L3047) | return false; // URL is external, can't convert to local path |
| [3048](#L3048) | } |
| [3049](#L3049) |  |
| [3050](#L3050) | // Construct the path relative to WordPress root |
| [3051](#L3051) | $relPath = isset($parsedUrl['path']) ? $parsedUrl['path'] : ''; |
| [3052](#L3052) |  |
| [3053](#L3053) | // Get WordPress base directory path |
| [3054](#L3054) | $wpBasePath = ABSPATH; |
| [3055](#L3055) |  |
| [3056](#L3056) | // Sometimes, WordPress is installed in a subdirectory, adjust for that |
| [3057](#L3057) | if (!empty($siteUrl['path']) && $siteUrl['path'] !== '/') { |
| [3058](#L3058) | $wpBasePath = str\_replace(trim($siteUrl['path'], '/'), '', $wpBasePath); |
| [3059](#L3059) | } |
| [3060](#L3060) |  |
| [3061](#L3061) | // Combine the base path with the relative path |
| [3062](#L3062) | $localPath = realpath($wpBasePath . $relPath); |
| [3063](#L3063) |  |
| [3064](#L3064) | // Check if the file exists and return the path, or false if it doesn't |
| [3065](#L3065) | return file\_exists($localPath) ? $localPath : false; |
| [3066](#L3066) | } |
| [3067](#L3067) |  |
| [3068](#L3068) | public function get\_image\_dimensions($filename) |
| [3069](#L3069) | { |
| [3070](#L3070) | if (strtolower(pathinfo($filename, PATHINFO\_EXTENSION)) === 'svg') { |
| [3071](#L3071) | // Handle SVG files |
| [3072](#L3072) | $svgfile = @simplexml\_load\_file(rawurlencode($filename), 'SimpleXMLElement', LIBXML\_NOERROR | LIBXML\_NOWARNING); |
| [3073](#L3073) | if ($svgfile) { |
| [3074](#L3074) | $attributes = $svgfile->attributes(); |
| [3075](#L3075) | $width = isset($attributes->width) ? (string)$attributes->width : null; |
| [3076](#L3076) | $height = isset($attributes->height) ? (string)$attributes->height : null; |
| [3077](#L3077) |  |
| [3078](#L3078) | // Clean and format width and height. |
| [3079](#L3079) | $width = $this->format\_svg\_value($width); |
| [3080](#L3080) | $height = $this->format\_svg\_value($height); |
| [3081](#L3081) |  |
| [3082](#L3082) | if ($width && $height) { |
| [3083](#L3083) | // Return dimensions if directly available |
| [3084](#L3084) | return [$width, $height]; |
| [3085](#L3085) | } elseif (isset($attributes->viewBox)) { |
| [3086](#L3086) | // Parse viewBox for dimensions if width/height not available |
| [3087](#L3087) | $viewBox = explode(' ', $attributes->viewBox); |
| [3088](#L3088) | if (count($viewBox) === 4) { |
| [3089](#L3089) | $width = $viewBox[2]; |
| [3090](#L3090) | $height = $viewBox[3]; |
| [3091](#L3091) | return [$width, $height]; |
| [3092](#L3092) | } |
| [3093](#L3093) | } |
| [3094](#L3094) | } |
| [3095](#L3095) | // Return false if dimensions could not be determined |
| [3096](#L3096) | return false; |
| [3097](#L3097) | } else { |
| [3098](#L3098) | // Handle other image types (JPG, PNG, etc.) |
| [3099](#L3099) | $sizes = @getimagesize($filename); |
| [3100](#L3100) | return $sizes ? [$sizes[0], $sizes[1]] : false; |
| [3101](#L3101) | } |
| [3102](#L3102) | } |
| [3103](#L3103) |  |
| [3104](#L3104) | public function format\_svg\_value($value) |
| [3105](#L3105) | { |
| [3106](#L3106) | // No unit or empty, return the value directly. |
| [3107](#L3107) | if (empty($value) || is\_numeric($value)) { |
| [3108](#L3108) | return $value; |
| [3109](#L3109) | } |
| [3110](#L3110) |  |
| [3111](#L3111) | // Pattern to find numbers possibly followed by 'px' |
| [3112](#L3112) | $px\_pattern = '/([0-9]+)\s\*px/i'; |
| [3113](#L3113) |  |
| [3114](#L3114) | // If pixel unit or numeric, extract and return the numeric value. |
| [3115](#L3115) | if (preg\_match($px\_pattern, $value, $matches)) { |
| [3116](#L3116) | return $matches[1]; |
| [3117](#L3117) | } |
| [3118](#L3118) |  |
| [3119](#L3119) | // Return an empty string for unsupported units. |
| [3120](#L3120) | return ''; |
| [3121](#L3121) | } |
| [3122](#L3122) |  |
| [3123](#L3123) | public function injectPreloadImages($matches) |
| [3124](#L3124) | { |
| [3125](#L3125) | $originalHead = $matches[0]; |
| [3126](#L3126) |  |
| [3127](#L3127) | $inject = $originalHead; |
| [3128](#L3128) | $inject .= '<!--WPC\_INSERT\_CRITICAL-->'; |
| [3129](#L3129) | $inject .= '<!--WPC\_INSERT\_PRELOAD\_MAIN-->'; |
| [3130](#L3130) | $inject .= '<!--WPC\_INSERT\_PRELOAD-->'; |
| [3131](#L3131) | return $inject; |
| [3132](#L3132) | } |
| [3133](#L3133) |  |
| [3134](#L3134) |  |
| [3135](#L3135) | public function elementorAnimations($matches) |
| [3136](#L3136) | { |
| [3137](#L3137) | $animationData = $matches[1]; |
| [3138](#L3138) | if (strpos($animationData, '\_animation')) { |
| [3139](#L3139) | #$matches[0] = str\_replace('elementor-invisible', '', $matches[0]); |
| [3140](#L3140) | #$matches[0] = preg\_replace('/(<div[^>]\*\sclass="[^"]\*)(")/si', "$1 " . "animated fadeInLeft" . " $2", $matches[0]); |
| [3141](#L3141) | return $matches[0]; |
| [3142](#L3142) | } |
| [3143](#L3143) | return $matches[0]; |
| [3144](#L3144) | } |
| [3145](#L3145) |  |
| [3146](#L3146) |  |
| [3147](#L3147) | public function removeBgOverlay($html) |
| [3148](#L3148) | { |
| [3149](#L3149) | return ''; |
| [3150](#L3150) | } |
| [3151](#L3151) |  |
| [3152](#L3152) |  |
| [3153](#L3153) | public function gtagDelay($src) |
| [3154](#L3154) | { |
| [3155](#L3155) | // TODO: We have already delayed things, but speed tests don't recognize it |
| [3156](#L3156) | $tag = trim($src[0]); |
| [3157](#L3157) | $srcToLower = strtolower($tag); |
| [3158](#L3158) |  |
| [3159](#L3159) | if (strpos($tag, 'wps-inline') !== false) { |
| [3160](#L3160) | return $tag; |
| [3161](#L3161) | } |
| [3162](#L3162) |  |
| [3163](#L3163) | // Optimizer Exclude |
| [3164](#L3164) | if (strpos($srcToLower, 'optimizer.pixel') !== false || strpos($srcToLower, 'optimizer.adaptive') !== false || strpos($srcToLower, 'optimizer.local') !== false) { |
| [3165](#L3165) | return $tag; |
| [3166](#L3166) | } |
| [3167](#L3167) |  |
| [3168](#L3168) | if (strpos($srcToLower, 'googletag') !== false || strpos($srcToLower, 'gtag') !== false || strpos($srcToLower, 'facebook') !== false || strpos($srcToLower, 'recaptcha') !== false || strpos($srcToLower, 'tween') !== false || strpos($srcToLower, 'fontawesome') !== false) { |
| [3169](#L3169) |  |
| [3170](#L3170) | if (strpos($srcToLower, 'src=') === false) { |
| [3171](#L3171) | if (strpos($srcToLower, 'type=') === false) { |
| [3172](#L3172) | $tag = str\_replace('<script', '<script type="wpc-delay-last-script" data-from-wpc="3078"', $srcToLower); |
| [3173](#L3173) | } else { |
| [3174](#L3174) | $tag = str\_replace('text/javascript', 'wpc-delay-last-script', $srcToLower); |
| [3175](#L3175) | } |
| [3176](#L3176) | } else { |
| [3177](#L3177) | if (strpos($srcToLower, 'type=') === false) { |
| [3178](#L3178) | $tag = str\_replace('<script', '<script type="wpc-delay-last-script" data-from-wpc="3078"', $srcToLower); |
| [3179](#L3179) | } else { |
| [3180](#L3180) | $tag = str\_replace('text/javascript', 'wpc-delay-last-script', $srcToLower); |
| [3181](#L3181) | } |
| [3182](#L3182) | } |
| [3183](#L3183) |  |
| [3184](#L3184) | } |
| [3185](#L3185) |  |
| [3186](#L3186) | return $tag; |
| [3187](#L3187) | } |
| [3188](#L3188) |  |
| [3189](#L3189) | public function local\_script\_encode($html) |
| [3190](#L3190) | { |
| [3191](#L3191) | $found = strlen($html[0]); |
| [3192](#L3192) |  |
| [3193](#L3193) | $encoded = base64\_encode($html[0]); |
| [3194](#L3194) | $decode = base64\_decode($encoded); |
| [3195](#L3195) | $replaced = strlen($decode); |
| [3196](#L3196) |  |
| [3197](#L3197) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'script') { |
| [3198](#L3198) | return print\_r([$html], true); |
| [3199](#L3199) | } |
| [3200](#L3200) |  |
| [3201](#L3201) | $slashed = addslashes($html[0]); |
| [3202](#L3202) | $encoded = base64\_encode($slashed); |
| [3203](#L3203) |  |
| [3204](#L3204) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_encode') { |
| [3205](#L3205) | return print\_r($encoded, true); |
| [3206](#L3206) | } |
| [3207](#L3207) |  |
| [3208](#L3208) | return '[script-wpc]' . $encoded . '[/script-wpc]'; |
| [3209](#L3209) | } |
| [3210](#L3210) |  |
| [3211](#L3211) | public function local\_script\_decode($html) |
| [3212](#L3212) | { |
| [3213](#L3213) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode') { |
| [3214](#L3214) | return print\_r([$html], true); |
| [3215](#L3215) | } |
| [3216](#L3216) |  |
| [3217](#L3217) | $decode = str\_replace('[script-wpc]', '', $html[0]); |
| [3218](#L3218) | $decode = str\_replace('[/script-wpc]', '', $decode); |
| [3219](#L3219) |  |
| [3220](#L3220) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'bas64\_decode\_end') { |
| [3221](#L3221) | return print\_r([$decode], true); |
| [3222](#L3222) | } |
| [3223](#L3223) |  |
| [3224](#L3224) | $decode = base64\_decode($decode); |
| [3225](#L3225) | $decode = stripslashes($decode); |
| [3226](#L3226) |  |
| [3227](#L3227) | return $decode; |
| [3228](#L3228) | } |
| [3229](#L3229) |  |
| [3230](#L3230) | public function crittr\_replace\_css($links) |
| [3231](#L3231) | { |
| [3232](#L3232) | preg\_match\_all('/([a-zA-Z\-\\_]\*)\s\*\=["|\'](.\*?)["|\']/is', $links[0], $linkAtts); |
| [3233](#L3233) |  |
| [3234](#L3234) | if (!empty($\_GET['dbg\_links'])) { |
| [3235](#L3235) | return print\_r([$links], true); |
| [3236](#L3236) | } |
| [3237](#L3237) |  |
| [3238](#L3238) | if (!empty($\_GET['dbg\_links\_atts'])) { |
| [3239](#L3239) | return print\_r([$linkAtts], true); |
| [3240](#L3240) | } |
| [3241](#L3241) |  |
| [3242](#L3242) | if (!empty($linkAtts[1])) { |
| [3243](#L3243) | $linkHtml = '<link'; |
| [3244](#L3244) | $linkRel = ''; |
| [3245](#L3245) |  |
| [3246](#L3246) | $attNames = $linkAtts[1]; |
| [3247](#L3247) | $attValues = $linkAtts[2]; |
| [3248](#L3248) |  |
| [3249](#L3249) | foreach ($attNames as $i => $attName) { |
| [3250](#L3250) | if ($attName == 'rel' && $attValues[$i] == 'dns-prefetch') { |
| [3251](#L3251) | $linkRel = $attValues[$i]; |
| [3252](#L3252) | } elseif ($attName == 'href') { |
| [3253](#L3253) | if (!empty($\_GET['dbg\_link\_href'])) { |
| [3254](#L3254) | return print\_r([$attValues[$i], substr($attValues[$i], 0, 11)], true); |
| [3255](#L3255) | } |
| [3256](#L3256) |  |
| [3257](#L3257) | if (strpos($attValues[$i], self::$site\_url) === false) { |
| [3258](#L3258) |  |
| [3259](#L3259) | } else { |
| [3260](#L3260) |  |
| [3261](#L3261) | if (strpos($attValues[$i], self::$zone\_name) === false) { |
| [3262](#L3262) | $attValues[$i] = WPS\_IC\_URI . 'fixCss.php?zoneName=' . self::$zone\_name . '&css=' . urlencode($attValues[$i]) . '&rand=' . time(); |
| [3263](#L3263) | } |
| [3264](#L3264) |  |
| [3265](#L3265) | } |
| [3266](#L3266) | } |
| [3267](#L3267) |  |
| [3268](#L3268) | $linkHtml .= ' ' . $attName . '="' . $attValues[$i] . '"'; |
| [3269](#L3269) | } |
| [3270](#L3270) |  |
| [3271](#L3271) | if (!empty($\_GET['dbg\_links\_output'])) { |
| [3272](#L3272) | return print\_r([$linkHtml], true); |
| [3273](#L3273) | } |
| [3274](#L3274) |  |
| [3275](#L3275) | $linkHtml .= '/>'; |
| [3276](#L3276) |  |
| [3277](#L3277) | if ($linkRel == 'stylesheet') { |
| [3278](#L3278) | return $linkHtml; |
| [3279](#L3279) | } else { |
| [3280](#L3280) | return $links[0]; |
| [3281](#L3281) | } |
| [3282](#L3282) |  |
| [3283](#L3283) |  |
| [3284](#L3284) | } else { |
| [3285](#L3285) | return $links[0]; |
| [3286](#L3286) | } |
| [3287](#L3287) | } |
| [3288](#L3288) |  |
| [3289](#L3289) | public function replace\_iframe\_tags($iframe) |
| [3290](#L3290) | { |
| [3291](#L3291) | if (strpos($iframe[0], 'gform') !== false){ |
| [3292](#L3292) | return $iframe[0]; |
| [3293](#L3293) | } |
| [3294](#L3294) |  |
| [3295](#L3295) | preg\_match\_all('/([a-zA-Z0-9\-\\_]\*)\s\*\=["\']([^"]\*)["\']?/is', $iframe[0], $iframeAtts); |
| [3296](#L3296) |  |
| [3297](#L3297) | if (!empty($iframeAtts[1])) { |
| [3298](#L3298) | $iFrame = '<iframe'; |
| [3299](#L3299) | $hasClass = false; |
| [3300](#L3300) |  |
| [3301](#L3301) | $attNames = $iframeAtts[1]; |
| [3302](#L3302) | $attValues = $iframeAtts[2]; |
| [3303](#L3303) |  |
| [3304](#L3304) | if (!in\_array('loading', $attNames)) { |
| [3305](#L3305) | $attNames[] = 'loading'; |
| [3306](#L3306) | } |
| [3307](#L3307) |  |
| [3308](#L3308) | foreach ($attNames as $i => $attName) { |
| [3309](#L3309) | if ($attName == 'src') { |
| [3310](#L3310) | $attName = 'data-wpc-src'; |
| [3311](#L3311) | } elseif ($attName == 'class') { |
| [3312](#L3312) | $hasClass = true; |
| [3313](#L3313) | $attValues[$i] .= ' wpc-iframe-delay'; |
| [3314](#L3314) | } elseif ($attName == 'loading') { |
| [3315](#L3315) | $attValues[$i] = 'lazy'; |
| [3316](#L3316) | } |
| [3317](#L3317) |  |
| [3318](#L3318) | $iFrame .= ' ' . $attName . '="' . $attValues[$i] . '" '; |
| [3319](#L3319) | } |
| [3320](#L3320) |  |
| [3321](#L3321) | if (!$hasClass) { |
| [3322](#L3322) | $iFrame .= 'class="wpc-iframe-delay"'; |
| [3323](#L3323) | } |
| [3324](#L3324) |  |
| [3325](#L3325) | $iFrame .= '></iframe>'; |
| [3326](#L3326) |  |
| [3327](#L3327) | return $iFrame; |
| [3328](#L3328) | } else { |
| [3329](#L3329) | return $iframe; |
| [3330](#L3330) | } |
| [3331](#L3331) | } |
| [3332](#L3332) |  |
| [3333](#L3333) | public function maybe\_addslashes($image, $addslashes = false) |
| [3334](#L3334) | { |
| [3335](#L3335) | if ($addslashes) { |
| [3336](#L3336) | $image = addslashes($image); |
| [3337](#L3337) | } |
| [3338](#L3338) |  |
| [3339](#L3339) | return $image; |
| [3340](#L3340) | } |
| [3341](#L3341) |  |
| [3342](#L3342) | public function specialChars($url) |
| [3343](#L3343) | { |
| [3344](#L3344) | if (!self::$brizyActive) { |
| [3345](#L3345) | $url = htmlspecialchars($url); |
| [3346](#L3346) | } |
| [3347](#L3347) |  |
| [3348](#L3348) | return $url; |
| [3349](#L3349) | } |
| [3350](#L3350) |  |
| [3351](#L3351) | public function cdn\_rewrite\_url($url, $addslashes = false) |
| [3352](#L3352) | { |
| [3353](#L3353) | $width = 1; |
| [3354](#L3354) |  |
| [3355](#L3355) | if (self::$isAmp->isAmp()) { |
| [3356](#L3356) | $width = 600; |
| [3357](#L3357) | } |
| [3358](#L3358) |  |
| [3359](#L3359) | $url = $url[0]; |
| [3360](#L3360) | if (strpos($url, 'cookie') !== false) { |
| [3361](#L3361) | return $this->maybe\_slash($url, $addslashes); |
| [3362](#L3362) | } |
| [3363](#L3363) |  |
| [3364](#L3364) | if (self::isExcluded('cdn', $url)) { |
| [3365](#L3365) | return $this->maybe\_slash($url, $addslashes); |
| [3366](#L3366) | } |
| [3367](#L3367) |  |
| [3368](#L3368) | if (strpos($url, 'spinner.svg') !== false || strpos($url, 'gform\_ajax\_spinner') !== false) { |
| [3369](#L3369) | return $this->maybe\_slash($url, $addslashes); |
| [3370](#L3370) | } |
| [3371](#L3371) |  |
| [3372](#L3372) | $siteUrl = self::$home\_url; |
| [3373](#L3373) | $newUrl = str\_replace($siteUrl, '', $url); |
| [3374](#L3374) |  |
| [3375](#L3375) | // Check if site url is staging url? Anything after .com/something? |
| [3376](#L3376) | preg\_match('/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]\/([a-zA-Z0-9]+)/', $siteUrl, $isStaging); |
| [3377](#L3377) |  |
| [3378](#L3378) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'isstaging') { |
| [3379](#L3379) | return print\_r([$isStaging, $siteUrl], true); |
| [3380](#L3380) | } |
| [3381](#L3381) |  |
| [3382](#L3382) | // TODO: This is required for STAGING TO WORK!!! Don't remove SiteURL!!! LOOK for next TODO!!! |
| [3383](#L3383) |  |
| [3384](#L3384) | $originalUrl = $url; |
| [3385](#L3385) | $newSrcSet = ''; |
| [3386](#L3386) |  |
| [3387](#L3387) | preg\_match\_all('/((https?\:\/\/|\/\/)[^\s]+\S+\.(' . self::$findImages . '))\s(\d{1,5}+[wx])/', $url, $srcset\_links); |
| [3388](#L3388) |  |
| [3389](#L3389) | // TODO: Hrvoje fix for sites having bad srcset like https... 525w, https... without XYw |
| [3390](#L3390) | if (!empty($srcset\_links[0])) { |
| [3391](#L3391) | if (!empty(self::$settings['remove-srcset'])) { |
| [3392](#L3392) | return ''; |
| [3393](#L3393) | } |
| [3394](#L3394) | } |
| [3395](#L3395) |  |
| [3396](#L3396) | if (!empty($srcset\_links[0])) { |
| [3397](#L3397) | $debug = []; |
| [3398](#L3398) | foreach ($srcset\_links[0] as $i => $srcset) { |
| [3399](#L3399) | $src = explode(' ', $srcset); |
| [3400](#L3400) | $srcset\_url = $src[0]; |
| [3401](#L3401) | $srcset\_width = $src[1]; |
| [3402](#L3402) |  |
| [3403](#L3403) |  |
| [3404](#L3404) | if (self::is\_excluded\_link($srcset\_url) || self::is\_excluded($srcset\_url, $srcset\_url)) { |
| [3405](#L3405) | $newSrcSet .= $srcset\_url . ' ' . $srcset\_width . ','; |
| [3406](#L3406) | } else { |
| [3407](#L3407) | if (strpos($srcset\_width, 'x') !== false) { |
| [3408](#L3408) | $width\_url = 1; |
| [3409](#L3409) | $srcset\_width = str\_replace('x', '', $srcset\_width); |
| [3410](#L3410) | $extension = 'x'; |
| [3411](#L3411) | } else { |
| [3412](#L3412) | $width\_url = $srcset\_width = str\_replace('w', '', $srcset\_width); |
| [3413](#L3413) | $extension = 'w'; |
| [3414](#L3414) | } |
| [3415](#L3415) |  |
| [3416](#L3416) | if (strpos($srcset\_url, self::$zone\_name) !== false) { |
| [3417](#L3417) | $newSrcSet .= $srcset\_url . ' ' . $srcset\_width . $extension . ','; |
| [3418](#L3418) | continue; |
| [3419](#L3419) | } |
| [3420](#L3420) |  |
| [3421](#L3421) | $newSrcSet .= self::$apiUrl . '/r:' . self::$is\_retina . '/wp:' . self::$webp . '/w:' . $width\_url . '/u:' . self::reformat\_url($srcset\_url) . ' ' . $srcset\_width . $extension . ','; |
| [3422](#L3422) | } |
| [3423](#L3423) | } |
| [3424](#L3424) |  |
| [3425](#L3425) | $newSrcSet = rtrim($newSrcSet, ','); |
| [3426](#L3426) | $newSrcSet = $this->maybe\_slash($newSrcSet, $addslashes); |
| [3427](#L3427) | return $newSrcSet; |
| [3428](#L3428) | } else { |
| [3429](#L3429) | if (strpos($url, 'data:image') !== false) { |
| [3430](#L3430) | return $url; |
| [3431](#L3431) | } |
| [3432](#L3432) |  |
| [3433](#L3433) | if (self::is\_excluded\_link($url)) { |
| [3434](#L3434) | return $this->maybe\_slash($url, $addslashes); |
| [3435](#L3435) | } |
| [3436](#L3436) |  |
| [3437](#L3437) | if (strpos($url, self::$zone\_name) !== false) { |
| [3438](#L3438) | return $this->maybe\_slash($url, $addslashes); |
| [3439](#L3439) | } |
| [3440](#L3440) |  |
| [3441](#L3441) | // External is disabled? |
| [3442](#L3442) | if (empty(self::$externalUrlEnabled) || self::$externalUrlEnabled == '0') { |
| [3443](#L3443) | if (!self::image\_url\_matching\_site\_url($url)) { |
| [3444](#L3444) | return $this->maybe\_slash($url, $addslashes); |
| [3445](#L3445) | } |
| [3446](#L3446) | } else { |
| [3447](#L3447) | // Check if the URL is an image, then check if it's instagram etc... |
| [3448](#L3448) | if (strpos($url, '.jpg') !== false || strpos($url, '.png') !== false || strpos($url, '.gif') !== false || strpos($url, '.svg') !== false || strpos($url, '.jpeg') !== false) { |
| [3449](#L3449) | foreach (self::$default\_excluded\_list as $i => $excluded\_string) { |
| [3450](#L3450) | if (strpos($url, $excluded\_string) !== false) { |
| [3451](#L3451) | return $this->maybe\_slash($url, $addslashes); |
| [3452](#L3452) | } |
| [3453](#L3453) | } |
| [3454](#L3454) | } |
| [3455](#L3455) | } |
| [3456](#L3456) |  |
| [3457](#L3457) | if (!empty($url)) { |
| [3458](#L3458) | // Todo: Quick fix for Password Protected Pages |
| [3459](#L3459) | if (strpos($url, 'login') !== false) { |
| [3460](#L3460) | return $this->maybe\_slash($url, $addslashes); |
| [3461](#L3461) | } |
| [3462](#L3462) |  |
| [3463](#L3463) | if (strpos($url, '.css') !== false && self::$css == '1') { |
| [3464](#L3464) | $fileMinify = self::$css\_minify; |
| [3465](#L3465) |  |
| [3466](#L3466) | if (self::isExcluded('css\_minify', $url)) { |
| [3467](#L3467) | $fileMinify = '0'; |
| [3468](#L3468) | } |
| [3469](#L3469) |  |
| [3470](#L3470) |  |
| [3471](#L3471) | if (!empty(self::$settings['font-subsetting']) && self::$settings['font-subsetting'] == '1') { |
| [3472](#L3472) | $fileMinify = '1'; |
| [3473](#L3473) | } |
| [3474](#L3474) | /\*\* |
| [3475](#L3475) | \* CSS File |
| [3476](#L3476) | \*/ |
| [3477](#L3477) | $newUrl = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($url); |
| [3478](#L3478) |  |
| [3479](#L3479) | return $newUrl; |
| [3480](#L3480) | } elseif (strpos($url, '.js') !== false && self::$js == '1') { |
| [3481](#L3481) | $fileMinify = self::$js\_minify; |
| [3482](#L3482) | if (self::isExcluded('js\_minify', $url)) { |
| [3483](#L3483) | $fileMinify = '0'; |
| [3484](#L3484) | } |
| [3485](#L3485) |  |
| [3486](#L3486) | /\*\* |
| [3487](#L3487) | \* JS File |
| [3488](#L3488) | \*/ |
| [3489](#L3489) | if (strpos($url, 'wp-content') !== false || strpos($url, 'wp-includes') !== false) { |
| [3490](#L3490) | if (empty(self::$js\_minify) || self::$js\_minify == 'false') { |
| [3491](#L3491) | $newUrl = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($url, false); |
| [3492](#L3492) | } else { |
| [3493](#L3493) | $newUrl = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($url, false); |
| [3494](#L3494) | } |
| [3495](#L3495) | } else { |
| [3496](#L3496) | $newUrl = 'https://' . self::$zone\_name . '/m:' . $fileMinify . '/a:' . self::reformat\_url($url, false); |
| [3497](#L3497) | } |
| [3498](#L3498) |  |
| [3499](#L3499) | return $newUrl; |
| [3500](#L3500) | } elseif (strpos($url, '.svg') !== false) { |
| [3501](#L3501) | if (!empty(self::$settings['serve']['svg'])) { |
| [3502](#L3502) | /\*\* |
| [3503](#L3503) | \* SVG File |
| [3504](#L3504) | \*/ |
| [3505](#L3505) | if (!self::is\_excluded($url, $url)) { |
| [3506](#L3506) | if (self::$zone\_test == 0 && (strpos($url, 'wp-content') !== false || strpos($url, 'wp-includes') !== false)) { |
| [3507](#L3507) | $newUrl = 'https://' . self::$zone\_name . '/m:0/a:' . self::reformat\_url($url); |
| [3508](#L3508) | } else { |
| [3509](#L3509) | $newUrl = 'https://' . self::$zone\_name . '/m:0/a:' . self::reformat\_url($url, false); |
| [3510](#L3510) | } |
| [3511](#L3511) | } |
| [3512](#L3512) | } else { |
| [3513](#L3513) | $newUrl = self::reformat\_url($url, false); |
| [3514](#L3514) | } |
| [3515](#L3515) |  |
| [3516](#L3516) | return $newUrl; |
| [3517](#L3517) | } elseif (self::$fonts == 1 && (strpos($url, '.woff') !== false || strpos($url, '.woff2') !== false || strpos($url, '.eot') !== false || strpos($url, '.ttf') !== false)) { |
| [3518](#L3518) | /\*\* |
| [3519](#L3519) | \* JS File |
| [3520](#L3520) | \*/ |
| [3521](#L3521) | if (!empty(self::$settings['font-subsetting']) && self::$settings['font-subsetting'] == '1') { |
| [3522](#L3522) | if (strpos($url, 'icon') !== false || strpos($url, 'awesome') !== false || strpos($url, 'lightgallery') !== false || strpos($url, 'gallery') !== false || strpos($url, 'side-cart-woocommerce') !== false) { |
| [3523](#L3523) | $newUrl = 'https://' . self::$zone\_name . '/m:0/a:' . self::reformat\_url($url); |
| [3524](#L3524) | } else { |
| [3525](#L3525) | $newUrl = 'https://' . self::$zone\_name . '/font:true/a:' . self::reformat\_url($url); |
| [3526](#L3526) | } |
| [3527](#L3527) | } else { |
| [3528](#L3528) | $newUrl = 'https://' . self::$zone\_name . '/m:0/a:' . self::reformat\_url($url); |
| [3529](#L3529) | } |
| [3530](#L3530) | return $newUrl; |
| [3531](#L3531) | } |
| [3532](#L3532) |  |
| [3533](#L3533) | if (self::is\_excluded($url, $url)) { |
| [3534](#L3534) | return $this->maybe\_slash($originalUrl, $addslashes); |
| [3535](#L3535) | } |
| [3536](#L3536) |  |
| [3537](#L3537) | return $url; |
| [3538](#L3538) |  |
| [3539](#L3539) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'rewrite\_url\_to\_file') { |
| [3540](#L3540) | $fp = fopen(WPS\_IC\_DIR . 'rewrite\_url\_file.txt', 'a+'); |
| [3541](#L3541) | fwrite($fp, 'URL: ' . $url . "\r\n"); |
| [3542](#L3542) | fwrite($fp, 'URL: ' . $newUrl . "\r\n"); |
| [3543](#L3543) | fwrite($fp, '---' . "\r\n"); |
| [3544](#L3544) | fclose($fp); |
| [3545](#L3545) | } |
| [3546](#L3546) |  |
| [3547](#L3547) | // TODO: This is required for STAGING TO WORK!!! Don't remove SiteURL!!! LOOK for next TODO!!! |
| [3548](#L3548) | if (self::$is\_multisite) { |
| [3549](#L3549) | return $this->maybe\_slash($newUrl, $addslashes); |
| [3550](#L3550) | } elseif (empty($isStaging) || empty($isStaging[0])) { |
| [3551](#L3551) | // Not a staging site |
| [3552](#L3552) | return $this->maybe\_slash($newUrl, $addslashes); |
| [3553](#L3553) | } else { |
| [3554](#L3554) | // It's a staging site |
| [3555](#L3555) | return $this->maybe\_slash($originalUrl, $addslashes); |
| [3556](#L3556) | } |
| [3557](#L3557) | } |
| [3558](#L3558) |  |
| [3559](#L3559) | return $this->maybe\_slash($url, $addslashes); |
| [3560](#L3560) | } |
| [3561](#L3561) | } |
| [3562](#L3562) |  |
| [3563](#L3563) | public function maybe\_slash($url, $addslashes = false) |
| [3564](#L3564) | { |
| [3565](#L3565) | if ($addslashes) { |
| [3566](#L3566) | return addslashes($url); |
| [3567](#L3567) | } |
| [3568](#L3568) |  |
| [3569](#L3569) | return $url; |
| [3570](#L3570) | } |
| [3571](#L3571) |  |
| [3572](#L3572) | public static function is\_excluded($image\_element, $image\_link = '') |
| [3573](#L3573) | { |
| [3574](#L3574) | $image\_path = ''; |
| [3575](#L3575) |  |
| [3576](#L3576) | if (empty($image\_link)) { |
| [3577](#L3577) | preg\_match('@src="([^"]+)"@', $image\_element, $match\_url); |
| [3578](#L3578) | if (!empty($match\_url)) { |
| [3579](#L3579) | $image\_path = $match\_url[1]; |
| [3580](#L3580) | $basename\_original = basename($match\_url[1]); |
| [3581](#L3581) | } else { |
| [3582](#L3582) | $basename\_original = basename($image\_element); |
| [3583](#L3583) | } |
| [3584](#L3584) | } else { |
| [3585](#L3585) | $image\_path = $image\_link; |
| [3586](#L3586) | $basename\_original = basename($image\_link); |
| [3587](#L3587) | } |
| [3588](#L3588) |  |
| [3589](#L3589) | preg\_match("/([0-9]+)x([0-9]+)\.[a-zA-Z0-9]+/", $basename\_original, $matches); //the filename suffix way |
| [3590](#L3590) | if (empty($matches)) { |
| [3591](#L3591) | // Full Image |
| [3592](#L3592) | $basename = $basename\_original; |
| [3593](#L3593) | } else { |
| [3594](#L3594) | // Some thumbnail |
| [3595](#L3595) | $basename = str\_replace('-' . $matches[1] . 'x' . $matches[2], '', $basename\_original); |
| [3596](#L3596) | } |
| [3597](#L3597) |  |
| [3598](#L3598) | /\*\* |
| [3599](#L3599) | \* Is this image lazy excluded? |
| [3600](#L3600) | \*/ |
| [3601](#L3601) | if (!empty(self::$lazy\_excluded\_list) && !empty(self::$lazy\_enabled) && self::$lazy\_enabled == '1') { |
| [3602](#L3602) | //return 'asd'; |
| [3603](#L3603) | foreach (self::$lazy\_excluded\_list as $i => $lazy\_excluded) { |
| [3604](#L3604) | if (strpos($basename, $lazy\_excluded) !== false) { |
| [3605](#L3605) | return true; |
| [3606](#L3606) | } |
| [3607](#L3607) | } |
| [3608](#L3608) | } elseif (!empty(self::$excluded\_list)) { |
| [3609](#L3609) | foreach (self::$excluded\_list as $i => $excluded) { |
| [3610](#L3610) | if (strpos($basename, $excluded) !== false) { |
| [3611](#L3611) | return true; |
| [3612](#L3612) | } |
| [3613](#L3613) | } |
| [3614](#L3614) | } |
| [3615](#L3615) |  |
| [3616](#L3616) | if (!empty(self::$lazy\_excluded\_list) && in\_array($basename, self::$lazy\_excluded\_list)) { |
| [3617](#L3617) | return true; |
| [3618](#L3618) | } |
| [3619](#L3619) |  |
| [3620](#L3620) | if (!empty(self::$excluded\_list) && in\_array($basename, self::$excluded\_list)) { |
| [3621](#L3621) | return true; |
| [3622](#L3622) | } |
| [3623](#L3623) |  |
| [3624](#L3624) | return false; |
| [3625](#L3625) | } |
| [3626](#L3626) |  |
| [3627](#L3627) | public static function is\_image($image) |
| [3628](#L3628) | { |
| [3629](#L3629) | if (strpos($image, '.webp') === false && strpos($image, '.jpg') === false && strpos($image, '.jpeg') === false && strpos($image, '.png') === false && strpos($image, '.ico') === false && strpos($image, '.svg') === false && strpos($image, '.gif') === false) { |
| [3630](#L3630) | return false; |
| [3631](#L3631) | } else { |
| [3632](#L3632) | // Serve JPG Enabled? |
| [3633](#L3633) | if (strpos($image, '.jpg') !== false || strpos($image, '.jpeg') !== false) { |
| [3634](#L3634) | // is JPEG enabled |
| [3635](#L3635) | if (self::$settings['serve']['jpg'] == '0') { |
| [3636](#L3636) | return false; |
| [3637](#L3637) | } |
| [3638](#L3638) | } |
| [3639](#L3639) |  |
| [3640](#L3640) | // Serve GIF Enabled? |
| [3641](#L3641) | if (strpos($image, '.gif') !== false) { |
| [3642](#L3642) | // is JPEG enabled |
| [3643](#L3643) | if (self::$settings['serve']['gif'] == '0') { |
| [3644](#L3644) | return false; |
| [3645](#L3645) | } |
| [3646](#L3646) | } |
| [3647](#L3647) |  |
| [3648](#L3648) | // Serve PNG Enabled? |
| [3649](#L3649) | if (strpos($image, '.png') !== false) { |
| [3650](#L3650) | // is PNG enabled |
| [3651](#L3651) | if (self::$settings['serve']['png'] == '0') { |
| [3652](#L3652) | return false; |
| [3653](#L3653) | } |
| [3654](#L3654) | } |
| [3655](#L3655) |  |
| [3656](#L3656) | // Serve SVG Enabled? |
| [3657](#L3657) | if (strpos($image, '.svg') !== false) { |
| [3658](#L3658) | // is SVG enabled |
| [3659](#L3659) | if (self::$settings['serve']['svg'] == '0') { |
| [3660](#L3660) | return false; |
| [3661](#L3661) | } |
| [3662](#L3662) | } |
| [3663](#L3663) |  |
| [3664](#L3664) | return true; |
| [3665](#L3665) | } |
| [3666](#L3666) | } |
| [3667](#L3667) |  |
| [3668](#L3668) | public function local\_image\_tags($image) |
| [3669](#L3669) | { |
| [3670](#L3670) | $class\_Addon = ''; |
| [3671](#L3671) | $image\_tag = $image[0]; |
| [3672](#L3672) | $image\_source = ''; |
| [3673](#L3673) |  |
| [3674](#L3674) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'local\_start') { |
| [3675](#L3675) | return print\_r($image, true); |
| [3676](#L3676) | } |
| [3677](#L3677) |  |
| [3678](#L3678) | // File has already been replaced |
| [3679](#L3679) | if ($this->defaultExcluded($image[0])) { |
| [3680](#L3680) | return $image[0]; |
| [3681](#L3681) | } |
| [3682](#L3682) |  |
| [3683](#L3683) | // File is not an image |
| [3684](#L3684) | if (strpos($image[0], '.webp') === false && strpos($image[0], '.jpg') === false && strpos($image[0], '.jpeg') === false && strpos($image[0], '.png') === false && strpos($image[0], '.ico') === false && strpos($image[0], '.svg') === false && strpos($image[0], '.gif') === false) { |
| [3685](#L3685) | return $image[0]; |
| [3686](#L3686) | } |
| [3687](#L3687) |  |
| [3688](#L3688) | // File is excluded |
| [3689](#L3689) | if (self::is\_excluded($image[0])) { |
| [3690](#L3690) | $image\_source = $image[0]; |
| [3691](#L3691) | $image\_source = preg\_replace('/class=["|\'](.\*?)["|\']/is', 'class="$1 wps-ic-loaded"', $image\_source); |
| [3692](#L3692) |  |
| [3693](#L3693) | return $image\_source; |
| [3694](#L3694) | } |
| [3695](#L3695) |  |
| [3696](#L3696) | if ((self::$externalUrlEnabled == 'false' || self::$externalUrlEnabled == '0') && !self::image\_url\_matching\_site\_url($image[0])) { |
| [3697](#L3697) | return $image[0]; |
| [3698](#L3698) | } |
| [3699](#L3699) |  |
| [3700](#L3700) | // Count images that were lazy loaded |
| [3701](#L3701) | self::$lazyLoadedImages++; |
| [3702](#L3702) |  |
| [3703](#L3703) | // Original URL was |
| [3704](#L3704) | $original\_img\_tag = []; |
| [3705](#L3705) | $original\_img\_tag['original\_tags'] = $this->getAllTags($image[0], []); |
| [3706](#L3706) |  |
| [3707](#L3707) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'searchImage') { |
| [3708](#L3708) | return print\_r([$image[0], $original\_img\_tag['original\_tags']], true); |
| [3709](#L3709) | } |
| [3710](#L3710) |  |
| [3711](#L3711) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'local\_original\_tags') { |
| [3712](#L3712) | return print\_r($original\_img\_tag['original\_tags'], true); |
| [3713](#L3713) | } |
| [3714](#L3714) |  |
| [3715](#L3715) | if (!empty($original\_img\_tag['original\_tags']['src']) && empty($original\_img\_tag['original\_tags']['data-src'])) { |
| [3716](#L3716) | $image\_source = $original\_img\_tag['original\_tags']['src']; |
| [3717](#L3717) | } else { |
| [3718](#L3718) | $image\_source = $original\_img\_tag['original\_tags']['data-src']; |
| [3719](#L3719) | } |
| [3720](#L3720) |  |
| [3721](#L3721) | $original\_img\_tag['original\_src'] = $image\_source; |
| [3722](#L3722) |  |
| [3723](#L3723) | // Old Code Below |
| [3724](#L3724) |  |
| [3725](#L3725) | // Figure out image class |
| [3726](#L3726) | preg\_match('/srcset=["|\']([^"]+)["|\']/', $image\_tag, $image\_srcset); |
| [3727](#L3727) | if (!empty($image\_srcset[1])) { |
| [3728](#L3728) | $original\_img\_tag['srcset'] = $image\_srcset[1]; |
| [3729](#L3729) | } |
| [3730](#L3730) |  |
| [3731](#L3731) | $size = self::get\_image\_size($image\_source); |
| [3732](#L3732) |  |
| [3733](#L3733) | $svgAPI = $source\_svg = 'data:image/svg+xml;base64,' . base64\_encode('<svg xmlns="http://www.w3.org/2000/svg" width="' . $size[0] . '" height="' . $size[1] . '"><path d="M2 2h' . $size[0] . 'v' . $size[1] . 'H2z" fill="#fff" opacity="0"/></svg>'); |
| [3734](#L3734) |  |
| [3735](#L3735) | // OriginalImageSource |
| [3736](#L3736) | $original\_img\_src = $image\_source; |
| [3737](#L3737) |  |
| [3738](#L3738) | // Path to CSS File |
| [3739](#L3739) | $site\_url = str\_replace(['https://', 'http://'], '', self::$site\_url); |
| [3740](#L3740) | $image\_path = str\_replace(['https://' . $site\_url . '/', 'http://' . $site\_url . '/'], '', $image\_source); |
| [3741](#L3741) | $image\_path = explode('?', $image\_path); |
| [3742](#L3742) | $image\_path = ABSPATH . $image\_path[0]; |
| [3743](#L3743) |  |
| [3744](#L3744) | if (!empty($\_GET['dbg']) && $\_GET['dbg'] == 'local\_settings') { |
| [3745](#L3745) | $webP = str\_replace(['.jpeg', '.jpg', '.png'], '.webp', $image\_path); |
| [3746](#L3746) |  |
| [3747](#L3747) | return print\_r([self::$webp, $image\_path, $webP, file\_exists($webP)], true); |
| [3748](#L3748) | } |
| [3749](#L3749) |  |
| [3750](#L3750) | /\*\* |
| [3751](#L3751) | \* Local File does not exists? |
| [3752](#L3752) | \*/ |
| [3753](#L3753) | if (!file\_exists($image\_path)) { |
| [3754](#L3754) | return $image[0]; |
| [3755](#L3755) | } else { |
| [3756](#L3756) | if (self::$webp == 'true' || self::$webp == '1') { |
| [3757](#L3757) | // Check if WebP Exists in PATH? |
| [3758](#L3758) | $webP = str\_replace(['.jpeg', '.jpg', '.png'], '.webp', $image\_path); |
| [3759](#L3759) |  |
| [3760](#L3760) | if (!file\_exists($webP)) { |
| [3761](#L3761) | $webP = false; |
| [3762](#L3762) | $image\_source = $original\_img\_src; |
| [3763](#L3763) | } else { |
| [3764](#L3764) | $original\_img\_src = str\_replace(['.jpeg', '.jpg', '.png'], '.webp', $original\_img\_src); |
| [3765](#L3765) | $image\_source = $original\_img\_src; |
| [3766](#L3766) | } |
| [3767](#L3767) | } else { |
| [3768](#L3768) | $image\_source = $original\_img\_src; |
| [3769](#L3769) | } |
| [3770](#L3770) | } |
| [3771](#L3771) |  |
| [3772](#L3772) |  |
| [3773](#L3773) | // Is LazyLoading enabled in the plugin? |
| [3774](#L3774) | if (!empty(self::$lazy\_enabled) && self::$lazy\_enabled == '1' && !self::$lazy\_override) { |
| [3775](#L3775) |  |
| [3776](#L3776) | if (self::$lazyLoadedImages >= self::$lazyLoadSkipFirstImages) { |
| [3777](#L3777) | // If Logo remove wps-ic-lazy-image |
| [3778](#L3778) | if (strpos($image\_source, 'logo') !== false) { |
| [3779](#L3779) | $image\_tag = 'src="' . $image\_source . '"'; |
| [3780](#L3780) | } else { |
| [3781](#L3781) | $image\_tag = 'src="' . $svgAPI . '"'; |
| [3782](#L3782) | } |
| [3783](#L3783) |  |
| [3784](#L3784) | $image\_tag .= ' data-src="' . $image\_source . '"'; |
| [3785](#L3785) |  |
| [3786](#L3786) | // If Logo remove wps-ic-lazy-image |
| [3787](#L3787) | if (strpos($image\_source, 'logo') !== false) { |
| [3788](#L3788) | // Image is for logo |
| [3789](#L3789) | $class\_Addon .= 'wps-ic-local-lazy wps-ic-logo'; |
| [3790](#L3790) | } else { |
| [3791](#L3791) | // Image is not for logo |
| [3792](#L3792) | $class\_Addon .= 'wps-ic-local-lazy wps-ic-lazy-image '; |
| [3793](#L3793) | } |
| [3794](#L3794) |  |
| [3795](#L3795) | } else { |
| [3796](#L3796) | $image\_tag = 'src="' . $image\_source . '"'; |
| [3797](#L3797) | } |
| [3798](#L3798) |  |
| [3799](#L3799) | } else if ((!empty(self::$native\_lazy\_enabled) && self::$native\_lazy\_enabled == '1' && !self::$lazy\_override)) { |
| [3800](#L3800) | $image\_tag = 'src="' . $image\_source . '"'; |
| [3801](#L3801) |  |
| [3802](#L3802) | if (self::$lazyLoadedImages <= self::$lazyLoadSkipFirstImages) { |
| [3803](#L3803) | // Don't lazy load |
| [3804](#L3804) | } else { |
| [3805](#L3805) | // If Logo remove wps-ic-lazy-image |
| [3806](#L3806) | if (!strpos($image\_source, 'logo')) { |
| [3807](#L3807) | $image\_tag .= ' loading="lazy"'; |
| [3808](#L3808) | } |
| [3809](#L3809) | } |
| [3810](#L3810) |  |
| [3811](#L3811) | } else { |
| [3812](#L3812) | if (!empty(self::$adaptive\_enabled) && self::$adaptive\_enabled == '1') { |
| [3813](#L3813) | $image\_tag = 'src="' . $image\_source . '"'; |
| [3814](#L3814) | $image\_tag .= ' data-adaptive="true"'; |
| [3815](#L3815) | $image\_tag .= ' data-remove-src="true"'; |
| [3816](#L3816) | } else { |
| [3817](#L3817) | $image\_tag = 'src="' . $image\_source . '"'; |
| [3818](#L3818) | $image\_tag .= ' data-adaptive="false"'; |
| [3819](#L3819) | } |
| [3820](#L3820) |  |
| [3821](#L3821) | $image\_tag .= ' data-src="' . $image\_source . '"'; |
| [3822](#L3822) | } |
| [3823](#L3823) |  |
| [3824](#L3824) | $image\_tag .= ' data-count-lazy="' . self::$lazyLoadedImages . '"'; |
| [3825](#L3825) |  |
| [3826](#L3826) | if (!empty(self::$settings['fetchpriority-high']) && self::$settings['fetchpriority-high'] == '1') { |
| [3827](#L3827) | $image\_tag .= ' fetchpriority="high" decoding="async"'; |
| [3828](#L3828) | } |
| [3829](#L3829) |  |
| [3830](#L3830) |  |
| [3831](#L3831) | /\*\* |
| [3832](#L3832) | \* Srcset to WebP |
| [3833](#L3833) | \*/ |
| [3834](#L3834) | $srcset\_att = ''; |
| [3835](#L3835) |  |
| [3836](#L3836) | if (self::$webp == 'true' || self::$webp == '1') { |
| [3837](#L3837) | if (!empty($original\_img\_tag['srcset'])) { |
| [3838](#L3838) | $exploded\_scrcset = explode(',', $original\_img\_tag['srcset']); |
| [3839](#L3839) | if (!empty($exploded\_scrcset)) { |
| [3840](#L3840) | foreach ($exploded\_scrcset as $i => $src) { |
| [3841](#L3841) | $src = trim($src); |
| [3842](#L3842) | $src\_w = explode(' ', $src); |
| [3843](#L3843) |  |
| [3844](#L3844) | if (!empty($src\_w)) { |
| [3845](#L3845) | $real\_src = $src\_w[0]; |
| [3846](#L3846) | $real\_src\_width = $src\_w[1]; |
| [3847](#L3847) |  |
| [3848](#L3848) | $image\_path = str\_replace(self::$site\_url . '/', '', $real\_src); |
| [3849](#L3849) | $image\_path\_webP = ABSPATH . $image\_path; |
| [3850](#L3850) |  |
| [3851](#L3851) | $webP = str\_replace(['.jpeg', '.jpg', '.png'], '.webp', $real\_src); |
| [3852](#L3852) | $image\_path\_webP = str\_replace(['.jpeg', '.jpg', '.png'], '.webp', $image\_path\_webP); |
| [3853](#L3853) |  |
| [3854](#L3854) | if (!file\_exists($image\_path\_webP)) { |
| [3855](#L3855) | $srcset\_att .= $real\_src . ' ' . $real\_src\_width . ','; |
| [3856](#L3856) | } else { |
| [3857](#L3857) | $srcset\_att .= $webP . ' ' . $real\_src\_width . ','; |
| [3858](#L3858) | } |
| [3859](#L3859) | } |
| [3860](#L3860) | } |
| [3861](#L3861) | } |
| [3862](#L3862) | $srcset\_att = rtrim($srcset\_att, ','); |
| [3863](#L3863) | } |
| [3864](#L3864) | } |
| [3865](#L3865) |  |
| [3866](#L3866) |  |
| [3867](#L3867) | if (empty($srcset\_att)) { |
| [3868](#L3868) | $srcset\_att = $original\_img\_tag['srcset']; |
| [3869](#L3869) | } |
| [3870](#L3870) |  |
| [3871](#L3871) | if (!empty(self::$removeSrcset) && self::$removeSrcset == '1') { |
| [3872](#L3872) | unset($original\_img\_tag['original\_tags']['srcset']); |
| [3873](#L3873) | } else { |
| [3874](#L3874) | if (!empty($srcset\_att)) { |
| [3875](#L3875) | $image\_tag .= ' srcset="' . $srcset\_att . '" '; |
| [3876](#L3876) | unset($original\_img\_tag['original\_tags']['srcset']); |
| [3877](#L3877) | } |
| [3878](#L3878) | } |
| [3879](#L3879) |  |
| [3880](#L3880) | if (!empty($original\_img\_tag['original\_tags'])) { |
| [3881](#L3881) | foreach ($original\_img\_tag['original\_tags'] as $tag => $value) { |
| [3882](#L3882) | if ($tag == 'class') { |
| [3883](#L3883) | $value = $class\_Addon . ' ' . $value; |
| [3884](#L3884) | } |
| [3885](#L3885) |  |
| [3886](#L3886) | if ($tag == 'src' || $tag == 'data-src') { |
| [3887](#L3887) | continue; |
| [3888](#L3888) | } |
| [3889](#L3889) |  |
| [3890](#L3890) | if (!is\_null($value)) { |
| [3891](#L3891) | $image\_tag .= $tag . '="' . $value . '" '; |
| [3892](#L3892) | } else { |
| [3893](#L3893) | $image\_tag .= $tag . ' '; |
| [3894](#L3894) | } |
| [3895](#L3895) | } |
| [3896](#L3896) | } |
| [3897](#L3897) |  |
| [3898](#L3898) | return '<img ' . $image\_tag . ' />'; |
| [3899](#L3899) | } |
| [3900](#L3900) |  |
| [3901](#L3901) | public function getAllTags($image, $ignore\_tags = ['src', 'srcset', 'data-src', 'data-srcset']) |
| [3902](#L3902) | { |
| [3903](#L3903) | $found\_tags = []; |
| [3904](#L3904) |  |
| [3905](#L3905) | preg\_match\_all('/(\w+(?:-\w+)\*)(?:\s\*=\s\*(?:"([^"]\*)"|\'([^\']\*)\'|([^>\s]+)))?/', $image, $matches, PREG\_SET\_ORDER); |
| [3906](#L3906) |  |
| [3907](#L3907) | $attributes = []; |
| [3908](#L3908) | unset ($matches[0]); |
| [3909](#L3909) |  |
| [3910](#L3910) | foreach ($matches as $match) { |
| [3911](#L3911) | $attrName = $match[1]; // The attribute name |
| [3912](#L3912) | // Determine the attribute value based on the capturing group that caught it |
| [3913](#L3913) | // If no value is present, consider it as null or an empty string |
| [3914](#L3914) | $attrValue = isset($match[2]) ? $match[2] : (isset($match[3]) ? $match[3] : (isset($match[4]) ? $match[4] : null)); |
| [3915](#L3915) |  |
| [3916](#L3916) | // Save the attribute and its value (if any) as key => value pairs in the array |
| [3917](#L3917) | $attributes[$attrName] = $attrValue; |
| [3918](#L3918) | } |
| [3919](#L3919) |  |
| [3920](#L3920) | if (!empty($\_GET['getAllTags'])) { |
| [3921](#L3921) | return [$image, $attributes]; |
| [3922](#L3922) | } |
| [3923](#L3923) |  |
| [3924](#L3924) | foreach ($attributes as $tag => $value) { |
| [3925](#L3925) | if (!empty($ignore\_tags) && in\_array($tag, $ignore\_tags)) { |
| [3926](#L3926) | continue; |
| [3927](#L3927) | } |
| [3928](#L3928) |  |
| [3929](#L3929) | if ($tag == 'data-mk-image-src-set') { |
| [3930](#L3930) | $value = htmlspecialchars\_decode($value); |
| [3931](#L3931) | $value = json\_decode($value, true); |
| [3932](#L3932) | $value = $value['default']; |
| [3933](#L3933) | } |
| [3934](#L3934) |  |
| [3935](#L3935) | $found\_tags[$tag] = $value; |
| [3936](#L3936) | } |
| [3937](#L3937) |  |
| [3938](#L3938) | return $found\_tags; |
| [3939](#L3939) | } |
| [3940](#L3940) |  |
| [3941](#L3941) | public static function get\_image\_size($url) |
| [3942](#L3942) | { |
| [3943](#L3943) | preg\_match("/([0-9]+)x([0-9]+)\.[a-zA-Z0-9]+/", $url, $matches); //the filename suffix way |
| [3944](#L3944) | if (isset($matches[1]) && isset($matches[2])) { |
| [3945](#L3945) | return [$matches[1], $matches[2]]; |
| [3946](#L3946) | $sizes = [$matches[1], $matches[2]]; |
| [3947](#L3947) | } else { //the file |
| [3948](#L3948) | return [1024, 1024]; |
| [3949](#L3949) | } |
| [3950](#L3950) |  |
| [3951](#L3951) | return $sizes; |
| [3952](#L3952) | } |
| [3953](#L3953) |  |
| [3954](#L3954) |  |
| [3955](#L3955) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php?format=txt)
* [Original Format](/export/3222434/wp-compress-image-optimizer/tags/6.30.00/addons/cdn/cdn-rewrite.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_bad5f36e_20250114_182129.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

WP Compress – Instant Performance & Speed Optimization

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-compress-image-optimizer&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-compress-image-optimizer&locale=en_US)

Search plugins

![](https://ps.w.org/wp-compress-image-optimizer/assets/banner-772x250.jpg?rev=3100419)
![](https://ps.w.org/wp-compress-image-optimizer/assets/icon-256x256.png?rev=1803925)
# WP Compress – Instant Performance & Speed Optimization

By [WP Compress](https://www.wpcompress.com)

[Download](https://downloads.wordpress.org/plugin/wp-compress-image-optimizer.6.30.05.zip)

* [Details](https://wordpress.org/plugins/wp-compress-image-optimizer/#description)
* [Reviews](https://wordpress.org/plugins/wp-compress-image-optimizer/#reviews)
* [Installation](https://wordpress.org/plugins/wp-compress-image-optimizer/#installation)
* [Development](https://wordpress.org/plugins/wp-compress-image-optimizer/#developers)

[Support](https://wordpress.org/support/plugin/wp-compress-image-optimizer/)

## Description

WP Compress – Instant Performance & Speed Optimization

Instantly speed up WordPress performance and stop slow load times from costing you sales, signups, and visitors.

**Load Faster, Rank Higher & Convert Better on Complete Autopilot**

Simply link your website and you’re good to go – with no maintenance required after setup.

*It’s really that easy.*

### Instant Performance Boost for Your Website

* **One-Click Smart Optimization**: Simply link your website and run smart optimization for a boost in performance with no maintenance required.
* **Easy to Use, Yet Infinitely Customizable**: Tailor your site’s performance with customizable settings, page rules, and exclusions. Whether you prefer set-and-forget performance or hands-on control, WP Compress is built to fit your needs.
* **Effortlessly Speed Up Mobile Websites**: All performance tweaks provide specifically optimized versions, dedicated for mobile devices to instantly upgrade your mobile page speed and performance scores, which is critical in today’s mobile-first world.

### Key Features of WP Compress

* **Advanced Caching**: Unlock lightning-fast server responses, slash resource consumption, and avoid unnecessary hosting upgrades.
* **CSS & JavaScript Optimization**: Reduce page bloat and minimize code to load only the critical content, with no coding required.
* **Perfect Image Technology**: Slash file sizes and generate WebP images that intelligently adapt to look good and load fast on any device.
* **Global CDN Delivery** *(Optional)*: Replicate your website’s content across the globe, for ultra-fast delivery to viewers anywhere, anytime.
* **Smart Optimization + 24/7 Performance Monitoring**: We’ll automatically keep your site optimized around the clock, ensuring peak performance for each and every incoming visitor.

### All-in-One WordPress Performance Plugin

Enjoy one-click smart optimization for an instant performance upgrade, or customize settings, page rules and exclusions as you wish – either way, you’re in complete control.

### Set Up in Seconds, Optimized Forever

WP Compress is pre-configured with one-click settings options right out of the box.

### Essential Performance Suite

Get started using the essential performance suite, offering everything you need for a faster site, from one-click optimization to critical CSS improvements and lazy loading.

### Powerful Optimization Engine

Real-Time image optimization, media library compression, and advanced optimizations for adaptive performance based on the incoming visitor.

### Agency Features for Professionals

Agency access includes centralized management, detailed statistics, and custom branding, so you can take all of the credit for faster WordPress performance.

**PRECONFIGURED FOR YOU, YET EXTREMELY FLEXIBLE**

You’ll be good to go the moment you paste your access key into the WP Compress plugin. It comes pre-configured with what we think are the optimal and most supported settings – but feel free to play around!

*It’s really that simple and built for compatibility.*

### Essential Performance Suite

*The basics for a faster website, without lifting a finger past setup.*

* One-Click Smart Optimization
* Advanced Website Caching
* Critical CSS Optimizations
* JavaScript Code Optimization
* Improve Render Blocking
* Delay Unnecessary JavaScript
* Lazy Load Images
* Lazy Load Videos
* One-Click Performance Testing
* SmartPurge Technology
* WooCommerce Tweaks
* FontAwesome Tweaks
* Google Tag Manager Tweaks
* Other Performance Optimizations
* Frequent Updates
* Expert Support

**Powerful Optimization Engine**

*Advanced optimization that automatically adapts based on the incoming visitor for our fastest load times across the entire globe!*

* One-Click Smart Optimization
* Real-Time Image Optimization (Live)
* Media Library Compression (Traditional)
* Lossless, Intelligent & Ultra Compression Algorithms
* Adaptive Images (per device)
* Generate and Serve Next-Generation WebP Images
* Retina Device Support
* Over-Compression Prevention
* Optimize + Serve Images via CDN
* Optimize + Serve SVG via CDN
* Optimize + Serve CSS Assets via CDN
* Optimize + Serve JavaScript via CDN
* Optimize + Serve Fonts via CDN
* Support External URLs (Amazon S3 etc)
* Automated Image Resize
* Single Image Compression
* Single Image Restore from Cloud
* One-Click Bulk Optimization
* One-Click Bulk Restore
* Preserve EXIF Data
* Custom CDN Domains

**INCREDIBLE AGENCY FEATURES:**

*Not only is the plugin great for speeding up individual websites, but the whitelabel add-on is fully loaded with industry-leading Agency features such as:*

* Centralized Management Portal
* Monthly Quotas for Clients
* Remote Optimization
* Detailed Statistics (Per Site)
* Agency Statistics (Overview)
* Detailed Compression Reports
* Downloadable PDF Reports
* Send Monthly Email Reports
* MainWP Bulk Linking Extension
* Multisite Compatibility + Bulk Linking Plugin
* Hide from WordPress Admin
* Custom Branded Reports
* Custom CDN Domains
* Custom Branded Plugin

Features Overview

### Ease of Use

* **One-Click Performance:** Instantly apply recommended or aggressive settings.
* **Safe Mode:** If at any point you want to revert or compare, simply toggle safe mode.
* **Smart Optimization:** Dynamic adjustments based on traffic and updates.
* **Customizable Setup:** Simple yet highly adaptable to different needs.
* **Comprehensive Performance:** Modular toggles for website speed optimization.
* **Expert Support:** Access to chat and ticket support for guidance.

### Performance Enhancements

### Caching and Optimization

* **Advanced Cache:** Total website caching for faster response times and reduced load.
* **Real-Time Optimization:** Automatically adapt content based on the incoming visitor.
* **Script Optimization:** Minify, combine, or delay scripts as needed.
* **Cache Warmup:** Preloads essential content for faster access.
* **GZIP Compression:** Compresses HTML for quicker load times.
* **Global CDN Delivery:** Ensures fast performance worldwide.

### Image and Media Management

* **WebP Images:** Utilizes next-gen image formats for quicker loads.
* **Retina Device Support:** Optimizes images for high-resolution displays.
* **Media Library Compression:** Reduces image file sizes without losing quality.
* **Lazy Loading:** Loads media files only when needed.
* **Automatic Image Optimization:** On upload for autonomous optimization.

### Resource Management

* **Remove Unused JavaScript/CSS:** Cleans up unnecessary code for faster load times.
* **Font Optimization:** Manages font loading for optimal performance.
* **Smart Cache Purging:** Automatically purge based on website or content updates.
* **Prefetch DNS Connections:** Speeds up domain name resolution for assets.
* **External URL Support:** Allow external urls such as S3, offloaded images and more.

### Administrative Tools

* **Remote Management:** Manage all of your websites from the centralized dashboard.
* **Multisite Tools:** Bulk linking and custom settings for network sites.
* **Custom Client Quotas:** Set specific limits for bandwidth and resources.
* **UX Customization:** Adjust plugin appearance and functionality.
* **Sub-Account Management:** Oversee client access and site control.

### Whitelabel Features

* **Custom Branded Plugin:** Add your logo, icon, branding and more to take the credit.
* **Custom CDN Domains:** Use your domain for global content delivery.
* **Invisible Management:** Hide the plugin in the WP admin area.
* **Detailed Reporting:** Automated PDF and email reports branded with your logo.

### Platform Integration

* **Compatibility:** Supports WordPress, WooCommerce, MultiSite, and more.
* **MainWP Integration:** Simplifies management across WordPress sites.

Think of it as a fully managed solution, where you get to take the credit for faster loading client websites!

### We Always Have Your Back

We’ve built all features as a toggle system, you can simply turn something on and if there are ever any conflicts or issues, simply toggle it off and everything will revert back to how it was.

> With millions of possible combinations, there are vast differences in environment from one WordPress website to the next. Whether it be plugins, themes, hosting permissions or server specifications – there’s a lot of variability.

We also offer industry-leading live chat support with automatic ticket conversion. So if you ever have any questions, suggestions, or feature requests we’re here to help!

### Try it risk-free and see for yourself!

* Lower Bounce Rates
* Ultra-Fast Response Times
* Better First Impressions
* Reduced Resource Usage
* Increased Conversions

### How much does it cost?

We believe that every website deserves to load faster! You can use our essential performance suite for free and add-on the optimization engine or agency features if you wish!

View our [prices and plans](https://wpcompress.com/pricing/).

## Screenshots

* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-1.png?rev=2820887)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-1.png?rev=2820887)

  Centralized Management Portal for Effortless Monitoring and Monthly Quotas
* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-2.png?rev=2820887)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-2.png?rev=2820887)

  Compress, restore or exclude single images right from the Media Library
* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-3.png?rev=2820887)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-3.png?rev=2820887)

  Optimize all images in one click using Bulk Compress
* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-4.png?rev=3099537)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-4.png?rev=3099537)

  One-click optimization modes for instant performance.
* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-5.png?rev=3099537)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-5.png?rev=3099537)

  Smart Optimization + 24/7 Performance Monitoring
* [![](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-6.png?rev=3099537)](https://ps.w.org/wp-compress-image-optimizer/assets/screenshot-6.png?rev=3099537)

  Example Results from Aggressive Mode + Smart Optimization

## Installation

1. Upload `wp-compress.zip` via wp-admin and install the plugin.
2. Activate the plugin through the ‘Plugins’ menu in your WordPress admin area.
3. Create an account for the Management Portal to link your website.
4. Click ‘Add Website’ and choose your desired quota and settings, once you obtain your API key insert it in field “API Key” and click “Connect”
5. Select your mode and you are ready to boost your performance!

## FAQ

### Do I need to use the CDN?

No! You can simply toggle it off if desired.

You can optimize your media library locally for smaller file sizes and improved load times.

However, Live Mode is recommended as it uses our ultra-premium infrastructure for consistently fast global performance!

### Do you have further help documents?

Yes, in addition to our incredible live chat support you can visit our help desk at https://help.wpcompress.com/

## Reviews

![](https://secure.gravatar.com/avatar/802e7690688233958dbb4f3bde63df2e2ad7753175e04952c1ca3fd19ca3dc06?s=60&d=retro&r=g)
### [Amazing Service by James](https://wordpress.org/support/topic/amazing-service-by-james/)

[danielkim925](https://profiles.wordpress.org/danielkim925/ "Posts by danielkim925")
January 8, 2025

Amazing Service 👏 🤩 🙀
James made everything smooth. He got our initial page scores for mobile and desktops from the 30s into the 90s!!!
Best of all, he helped setup the whole thing himself.
Talk about awesome customer service.
If you are on the fence, don’t hesitate to give James and WP Compress a shot. You won’t regret it.

![](https://secure.gravatar.com/avatar/83fafe1c67df9981c19ff1f7c0bf2f0aa10596929ff1875519ca65f241d5ff5a?s=60&d=retro&r=g)
### [Boost WordPress site speed using targeted strategies for web agencies.](https://wordpress.org/support/topic/boost-wordpress-site-speed-using-targeted-strategies-for-web-agencies/)

[subbattle](https://profiles.wordpress.org/subbattle/ "Posts by subbattle")
December 7, 2024

I have tested this plugin extensively and the result is really great. Here is the list that takes my attention about wpcompress1. This plugin is dedicated to WordPress agencies, you can suit and change it into your brand.2. We can control setting the plugin without login client WordPress on wpcompress dashboard.3. Cache and work together with lite speed cache web server, even when we turn on both cache the wpcompress still really great performance.4. Image optimization really delivers great results with live optimization.5. All in one plugin that almost covers everything: cache, script management (css, javascript), CDN6. I have tested CDN delivery, it is really great that almost hit >95 % hit ratio.7. The owner james always does improvement, almost every two weeks we got an update on the plugin.8. The best UI/IX I have ever seen on the optimization WordPress plugin.things to consider for their improvement1. WPCompress should consider rebranding to a name that summarize the essence of an all-in-one solution for optimization. This new name should reflect its comprehensive capabilities. 2. Make a blog or educational content on their website to bring organic trafic.3. It would be beneficial to implement a dynamic caching system similar to what Quic Cloud has accomplished.

![](https://secure.gravatar.com/avatar/b3b45d161eea451870d00da4a3c1bc40079086d7379fb7db150dabb788e33167?s=60&d=retro&r=g)
### [Realmente funciona](https://wordpress.org/support/topic/realmente-funciona-8/)

[Agência Querobino](https://profiles.wordpress.org/agquerobino/ "Posts by Agência Querobino")
December 5, 2024

Um dos poucos plugins que realmente entregam o que prometem.
Impressionante que em poucos cliques a otimização é feita sem nenhum bug.
E pra completar, deixa no chinelo os concorrentes que não aceitam multisite e cobram 10x mais.

![](https://secure.gravatar.com/avatar/2627801e00dc308679c2b8dfe62c1df9cefd37bdf84dd3f26633d25e577b0ee5?s=60&d=retro&r=g)
### [Great](https://wordpress.org/support/topic/great-16586/)

[robrob81](https://profiles.wordpress.org/robrob81/ "Posts by robrob81")
November 29, 2024

Works very well

![](https://secure.gravatar.com/avatar/eced6a1cd591c19061b5eb98fe47cb9ae4fdb948c63645427dc6f6d0f11b3d5e?s=60&d=retro&r=g)
### [Successfully passing the performance indicators 😍](https://wordpress.org/support/topic/successfully-passing-the-performance-indicators-%F0%9F%98%8D/)

[waelalsadi](https://profiles.wordpress.org/waelalsadi/ "Posts by waelalsadi")
October 21, 2024

After using many tools over the past 7 years and experiencing unsatisfactory performance, I tried WP Compress, and the results were amazing!
I used it with simple and small Ampere servers, but with WP Compress, I was able to successfully pass the performance indicators. 😍 I truly love the green color!
Thank you to the amazing WP Compress team. Keep up the great work!

![](https://secure.gravatar.com/avatar/6ef54c2193187a2d247606a682a30067d8705e07f50a4f9da1314e9703c47fb1?s=60&d=retro&r=g)
### [fantastic plugin and more fantastic support](https://wordpress.org/support/topic/fantastic-plugin-and-more-fantastic-support/)

[visiodot](https://profiles.wordpress.org/visiodot/ "Posts by visiodot")
October 8, 2024

actualy i use this on every site that i have and it is fantastic that you have a central panel for all sites… and the non plus ultra is that its that the support response in less then 10 minutes every time i have need help.

[Read all 124 reviews](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/)
## Contributors & Developers

“WP Compress – Instant Performance & Speed Optimization” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/abfd185e745038857fcd6eb0516e9869e8e346b2cbe77e5bfa72e67c11fa2b2a?s=32&d=mm&r=g) [AresIT](https://profiles.wordpress.org/aresit/)

“WP Compress – Instant Performance & Speed Optimization” has been translated into 2 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wp-compress-image-optimizer/contributors) for their contributions.

[Translate “WP Compress – Instant Performance & Speed Optimization” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-compress-image-optimizer)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-compress-image-optimizer/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-compress-image-optimizer/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-compress-image-optimizer/) by [RSS](https://plugins.trac.wordpress.org/log/wp-compress-image-optimizer/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 6.30.05

* Patch for UI – Test Ran @ Wrong Date
* Patch for False Blocking Message
* Patch for Test Run Logic

#### 6.30.04

* Improved UI in Excludes Popup
* Fixed Replace Code for 480w
* Removed Preload for Logged In Users
* Integrations Cleanup
* Removed Download\_URL and Replaced with WP\_Remote\_Get
* Fixed Sanitize\_URL for Caching
* Improved Caching Logic
* Improved Video Source Lazy Loading
* Improved CSS Critical Logic
* Added Improved Excludes Logic
* Upgraded DelayJS Logic
* Added Logic For Blocked Page Speed Tests

#### 6.30.03

* Minor Patch for Delay

#### 6.30.02

* Added Patch for Delay Javascript
* Added Patch for Defer Javascript
* Fixed SrcSet Issues with Masonry

#### 6.30.01

* Added Smart URL Preloading
* Patches for Critical & Page Speed Tests
* Fixed Issues with GeoLocation
* Fixed Issues with Settings on Activation

#### 6.30.00

* New UI
* Added Google Page Speed UI
* Patches for Critical CSS

#### 6.21.19

* Patch for Critical CSS

#### 6.21.18

* Patches for Local and Connectivity

#### 6.21.17

* Patch for MultiSite
* Patch for Local
* Added Font Subsetting to Agressive Mode
* Updated User Agent for API Calls
* Fixed Woo Cart Issues
* Fixed Purge Hooks

#### 6.21.16

* Patch for Font-Subsetting
* Patch for MainWP Compatibility
* Updated User-Agent on API Calls

#### 6.21.15

* Added Font-Subsetting Option

#### 6.21.14

* Fixed Issues With Loading mo:1 on Certain Devices
* Removed Double Font Loading and Added Fonts to CDN
* Fixed Issues With Font SubSetting on Icons

#### 6.21.13

* Added Font SubSetting

#### 6.21.12

* Fixed Brizy FrontEnd Editor Compatibility

#### 6.21.11

* Fixed CDN Not Enabled on Activation

#### 6.21.10

* Added “sortable” to Delay Last Exclusion
* Added “Disable CDN” for Critical Combine
* Patched Remote Comms Issue
* Integration for UserCentrics Consent

#### 6.21.09

* Improved Connectivity Test

#### 6.21.08

* Added Additional Default Excludes in JS Delay

#### 6.21.07

* Excluded .php Files From CDN
* Added Hooks for Easier Communication with Portal

#### 6.21.06

* Excluded Woo\_Ajax Calls From Optimizations
* Added “slider” and “draggable” to LastDelayScripts
* Changed data-src to data-wpc-src in Iframe Delay

#### 6.21.05

* Patched iFrame Lazy Loading

#### 6.21.04

* Added Default Last Load Scripts – appended: mouse scripts
* Added runAdaptive On Scroll Event
* Added Patch to Remove “data-wpc-loaded” Attribute From Images

#### 6.21.03

* Added More Checks for File Access
* Patched Adaptive Loading

#### 6.21.02

* Removing Various PHP Notices and Warnings

#### 6.21.01

* Patch for Cron Schedule not defined
* Patch for PHP Notices

#### 6.20.13

* Patch for Delay JS with Elementor
* Patch for IMG SRC data:svg

#### 6.20.12

* Patch
* Fix for Cron “Schedule not existing”
* Added check for “Cron Schedule – every three hours”

#### 6.20.11

* Patch for Popup Mode

#### 6.20.10

* Patch for Smart Optimization Pages – Locked Status

#### 6.20.09

* Patch

#### 6.20.08

* Leftover Credits Bug Fix
* New API Stats
* Updated BugFix in Search & Replace
* Elementor Patch
* Lazy Patch

#### 6.20.07

* Fixed Console Error in Admin
* Removed Inline from Default Settings
* Divi Patch
* Fixed Retina Issues

#### 6.20.06

* Added Preload critical fonts toggle
* Optimize external URLs bugfix
* Inline CSS relative URLs bugfix

#### 6.20.05

* Patch in Image Replace for Retina

#### 6.20.04

* Improved Smart Optimization
* Added LCP Element Detection
* Fixed Local Mode
* Fixed Retina in SrcSet
* Warmup Bug Fixes
* Fixed Script Preloading Issues
* Fixed Duplicated LCP
* Excluded GTranslate from DelayJS

#### 6.20.03

* Fixed Preload Typo

#### 6.20.02

* Added BG on CDN to Agressive Mode
* Fix for Responsive Lightbox & Gallery Load More Button
* Preload Fix
* Delay FontAwesome Fix
* Iframe Fix
* Added Headers for CF

#### 6.20.01

* Increased Activation Timeout for API Call
* Integrations Tab, Disable Elementor Triggers
* Purge Cache on Mode Swap
* Added Preload Scripts Default on Agressive
* Added Preload Scripts to Recommended Settings

#### 6.20.00

* Added “lgx\_app” to Excludes
* Added Option to Preload Scripts
* Improved Page Optimization
* Improved DelayJS
* Improved InlineCSS
* Various Bug Fixes
* Improved Page Speed Optimization Process

#### 6.11.14

* Added “la-” and “fa-” to Exclude in Preload Fonts
* Patched WP\_CACHE Constant Issue

#### 6.11.13

* Minor Patches to UI

#### 6.11.12

* Minor Bug Patch on Smart Optimization

#### 6.11.11

* Improved Page Speed Optimization Process
* Improved DelayJS
* Automatic Smart Preloading of Fonts
* Improved Critical CSS
* Increased Timeout for API Key Verification
* Improved Overall Plugin Security

#### 6.11.10

* Various Bug Fixes
* Fixed Blank Page on Blocky Theme
* Improved Inline CSS

#### 6.11.09

* Fixed Params for Tags Extracting
* Additional Checks for Lazy Loading of Images and Scripts
* Fixed Double Elementor Initiator
* Fixed Missing Fonts with Inline
* Fixed Inline CSS
* Improved Delay JS
* Improved CDN Search&Replace

#### 6.11.08

* Fixed Critical CSS on Inline CSS

#### 6.11.07

* Missing Icon

#### 6.11.06

* Minor Patch

#### 6.11.04

* Minor Patch

#### 6.11.03

* Minor Patch

#### 6.11.02

* Minor Patch

#### 6.11.01

* Security Patch
* Added Smart Optimization for Posts & Products
* Improved Critical CSS
* Improved Inline CSS
* New Delay JS
* Added Field for Skipping Lazy Images
* Fixed Page Preload
* Fixed Combine CSS
* Fixed Fonts Delay
* Added Lazy Loading for Google Tag Manager
* Improved LCP Optimization

#### 6.10.35

* Major Updates to Overall Environment
* Added Smart Optimizer UI
* Improved CDN Delivery
* Improved Image Lazy Loading
* Fix for CSS Replace Script
* Fix for Extra Slash in URL

#### 6.10.34

* Security Patch Release

#### 6.10.33

* Added New Features for Whitelabel
* Fixed Rocket Critical Error
* Elementor Integrations
* Fixed DelayJS

#### 6.10.32

* Added Additional CDN/Cache Purge Hooks
* Fixed WooCommerce Fragments
* Fixed Kadence Theme Compatibility

#### 6.10.31

* Fixed Critical Issue with isAmp class

#### 6.10.30

* Improved API for Stats

#### 6.10.29

* Added UI for Pageviews Packages
* Improved Delay & Lazy Loading
* Improved LCP Lazy Loading
* Fixed Bug in Search & Replace

#### 6.10.28

* Remove Cache/Critical/Combine Folders on Deactivation
* Purge Combine/Cache On Plugin Update/Activation
* Fixed AMP Pages for Delay JS

#### 6.10.27

* Fixed On Plugin Update Issues with Purging Cache
* Fixed Issues with RevSlider

#### 6.10.26

* Added Purge CDN on Plugin Updated
* Added Purge HTML on Plugin Update

#### 6.10.25

* Fixed Cache for Languages Query
* Added Cloudflare to Default Excludes in DelayJS
* Disable DelayJS on AMP Pages
* Added Allowed Query Variables for Cache/Critical/Combine
* CriticalCSS Preload Bug Fix
* Fixed DelayJS Unclosed Tag Error
* Improved Image Replace Logic to select data-src if it exists
* Added Removal of “Data-prehidden” attribute
* Added Patch for Relative Urls

#### 6.10.24

* Fixed Delay JS LowerCaps bug
* Additional default delays
* CornerStone Builder Patch
* Fill Settings Bug Patch
* DelayJS Bug Fix

#### 6.10.23

* Improved Inline JavaScript
* Improved Delay JavaScript
* Adjusted Default Excludes in JavaScript

#### 6.10.22

* Improved Delay JS
* Improved Critical CSS
* Added Various Default Excludes
* Minor Changes to UI

#### 6.10.21

* Fixed CDN Rewrite Logic for Ajax Content Loading
* WooCommerce Pagination Fix
* Gravity Form Caching Fix
* Security Patch

#### 6.10.20

* Fixed WooCommerce Cache Issues
* Fixed GT JS Delay

#### 6.10.19

* Fixed Issue With Google Fonts

#### 6.10.18

* Implemented Excludes for “Move Scripts to Footer”
* Preloading Improvements
* Cache Purge Actions
* Ignore POST Requests for Cache
* Fixed Incompatibility with Rocket Minify JS
* Fixed Fatal Error on Some Hosting Providers
* Added Cache Improvements

#### 6.10.17

* Improved Advanced Caching
* Fixed Compatibility with Ajax Loading
* Safe Mode Removes Caching
* Fixed Caching for Logged-In Users
* Optimized Critical CSS
* Fixed PHP Error in Background Lazy

#### 6.10.16

* Improved Local Compression
* Patch for Password-Protected Pages
* Removed Cookie “ic\_pixel\_ratio”
* Fixed Not Excluding Adaptive
* Additionally Excluded Admin-Bar From Cache
* Tooltips in Media Library
* Changed Original/Compressed into Saved in Media Library

#### 6.10.15

* Fixed Iframe Lazy Loading Issues
* Fixed Page Links Recognized as Image Links
* Fixed Font Swap Issues

#### 6.00.04

* Added Lazy to WPC Vars

#### 6.00.04

* Fixed PHP Fatal Error on Disable Dashicons

#### 6.00.03

* Fixed PHP Fatal Error on Inline Scripts

#### 6.00.02

* Improved Is Critical Ajax Running Check Up
* Added UI for Multi Site
* Removed User Experience “Select All” Option

#### 6.00.01

* Fixed Remote Connection with Agency Portal

#### 6.00.00

* Improved WP Compress UI
* Improved Critical CSS
* Improved Delay JS
* When you deactivate plugin on reactivation you are not required to insert API Key
* Added Option to Connect Plugin with API (Account) Token
* Added Delay JS to Gain Performance
* Added Critical CSS
* Added HTML Cache & Mobile Caching
* Improved Image Lazy Loading to Gain Performance
* Improved Lazy Loading JavaScript
* Improved Adaptive Images JavaScript
* Improved Compatibility With Caching Plugins
* Removed Cache Purging Hooks
* Fixed CSS rel=”preload” Issues
* Fixed Ninja Forms Issue
* PerfMatters Lazy Compatibility Improved
* WP Rocket Compatibility Improved
* Patched getAllTags Function to Recognize HTML attributes without quotes
* On Reactivation of the Plugin don’t Ask for API Key if the Key is valid
* Added Reconnect Option in Plugin List
* Fixed Local Bulk
* Removed Cookie “ic\_window\_resolution”
* Added Disable oEmbed Option
* Added Disable Dashicons Option
* Added iFrame Lazy Loading
* Added Combine CSS & JavaScript
* Updated Charts Core

#### 5.00.00

* Local + Live Optimization
* External URL Support
* Upgraded Management Portal
* Fixed MySQL Query Issue
* Updated CDN/Live Search and Replace algorithm
* Added new algorithm to Lazy/Adaptive JS Libraries
* Changed recommended/default options on initial plugin activation
* Brizy – updated URL search and replace algorithm

#### 4.0.0

* Major release, recompiled plugin
* Updated API
* Added CDN Support
* Added AI Support
* Added WebP Support

#### 3.3.0

* Major upgrade release
* Added Compress All status report
* Added Restore All status report
* Updated Background Compress Algorithm
* Updated Background Restore Algorithm
* Removed Default ON for Debug Logs
* Removed unecessary/test code
* Cleaned database tables
* Cleaned Javacript/PHP functions

#### 1.0.0

* Initial release

## Meta

* Version **6.30.05**
* Last updated **2 weeks ago**
* Active installations **7,000+**
* WordPress version **5.6 or higher**
* Tested up to **6.6.2**
* PHP version **7.0 or higher**
* Languages
  See all 3

  Close

  [English (US)](https://wordpress.org/plugins/wp-compress-image-optimizer/), [Russian](https://ru.wordpress.org/plugins/wp-compress-image-optimizer/), and [Swedish](https://sv.wordpress.org/plugins/wp-compress-image-optimizer/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wp-compress-image-optimizer)
* Tags [cache](https://wordpress.org/plugins/tags/cache/)[image optimization](https://wordpress.org/plugins/tags/image-optimization/)[performance](https://wordpress.org/plugins/tags/performance/)[speed](https://wordpress.org/plugins/tags/speed/)[wpcompress](https://wordpress.org/plugins/tags/wpcompress/)
* [Advanced View](https://wordpress.org/plugins/wp-compress-image-optimizer/advanced/)

## Ratings

4.5 out of 5 stars.

* [104 5-star reviews
  5 stars

  104](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/?filter=5)
* [1 4-star review
  4 stars

  1](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/?filter=4)
* [4 3-star reviews
  3 stars

  4](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/?filter=3)
* [2 2-star reviews
  2 stars

  2](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/?filter=2)
* [13 1-star reviews
  1 star

  13](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/wp-compress-image-optimizer/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/abfd185e745038857fcd6eb0516e9869e8e346b2cbe77e5bfa72e67c11fa2b2a?s=32&d=mm&r=g) [AresIT](https://profiles.wordpress.org/aresit/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/wp-compress-image-optimizer/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


