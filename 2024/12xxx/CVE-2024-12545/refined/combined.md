=== Content from plugins.trac.wordpress.org_8824406d_20250114_203719.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3212730)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3212729 "Changeset 3212729")
* [Next Changeset](/changeset/3212731 "Changeset 3212731") →

---

# Changeset 3212730

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/24/2024 04:49:55 PM
([3 weeks](/timeline?from=2024-12-24T16%3A49%3A55Z&precision=second "See timeline at 12/24/2024 04:49:55 PM") ago)

Author:
akashmalik
Message:

Improvements and bug fixes

Location:
[scratch-win-giveaways-for-website-facebook/trunk](/browser/scratch-win-giveaways-for-website-facebook/trunk?rev=3212730)
Files:

5 edited

* [includes/swin-api.php](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3212730 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [js/socialscratchwin.js](/browser/scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js?rev=3212730 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.txt](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3212730 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [socialscratchwin.php](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730 "Show entry in browser")
  (modified)
  ([9 diffs](#file3 "Show differences"))
* [templates/settings.php](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730 "Show entry in browser")
  (modified)
  ([5 diffs](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php](/changeset/3212730/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php "Show the changeset 3212730 restricted to scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php")

  | [r3207629](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3207629#L81 "Show revision 3207629 of this file in browser") | [r3212730](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3212730#L81 "Show revision 3212730 of this file in browser") |  |
  | --- | --- | --- |
  | 81 | 81 | } |
  | 82 | 82 |  |
  | 83 |  | public function check\_api\_permission($request) |
  | 84 |  | { |
  | 85 |  | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
  | 86 |  | return false; |
  | 87 |  | } |
  | 88 |  |  |
  | 89 |  | $payload = get\_option('apmswn\_payload', 0); |
  | 90 |  | $post\_payload = sanitize\_text\_field($\_POST['payload']); |
  | 91 |  |  |
  | 92 |  | if (empty($payload) || empty($post\_payload) || $payload != $post\_payload) { |
  | 93 |  | return false; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  | return true; |
  | 97 |  | } |
  | 98 |  |  |
  |  | 83 | public function check\_api\_permission($request) |
  |  | 84 | { |
  |  | 85 | $msg = ''; |
  |  | 86 | try { |
  |  | 87 | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
  |  | 88 | throw new Exception('Error: '); |
  |  | 89 | } |
  |  | 90 |  |
  |  | 91 | if (empty($\_POST['payload'])) { |
  |  | 92 | throw new Exception('Error: '); |
  |  | 93 | } |
  |  | 94 |  |
  |  | 95 | $payload = get\_option('apmswn\_payload', 0); |
  |  | 96 | $post\_payload = sanitize\_text\_field($\_POST['payload']); |
  |  | 97 |  |
  |  | 98 | if ($payload != $post\_payload) { |
  |  | 99 | throw new Exception('Warning: '); |
  |  | 100 | } |
  |  | 101 |  |
  |  | 102 | return true; |
  |  | 103 | } catch (Exception $e) { |
  |  | 104 | $msg = $e->getMessage(); |
  |  | 105 | } |
  |  | 106 |  |
  |  | 107 | return new WP\_Error( |
  |  | 108 | 'sw\_rest\_forbidden', |
  |  | 109 | \_\_($msg . 'Sorry, you are not allowed! '), |
  |  | 110 | array('status' => rest\_authorization\_required\_code()) |
  |  | 111 | ); |
  |  | 112 | } |
  |  | 113 |  |
  | 99 | 114 | public function check\_api\_permission\_lite($request) |
  | 100 | 115 | { |
  | 101 |  | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
  | 102 |  | return false; |
  | 103 |  | } |
  | 104 |  |  |
  | 105 |  | $id\_shop = get\_option('apmswn\_shop\_id', 0); |
  | 106 |  | $post\_id\_shop = sanitize\_text\_field($\_POST['id\_shop']); |
  | 107 |  |  |
  | 108 |  | if (empty($id\_shop) || empty($post\_id\_shop) || $id\_shop != $post\_id\_shop) { |
  | 109 |  | return false; |
  | 110 |  | } |
  | 111 |  |  |
  | 112 |  | return true; |
  |  | 116 | $msg = ''; |
  |  | 117 | try { |
  |  | 118 | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
  |  | 119 | throw new Exception('Error: '); |
  |  | 120 | } |
  |  | 121 |  |
  |  | 122 | //Dont remove or change isset |
  |  | 123 | if (!isset($\_POST['id\_shop']) || !isset($\_POST['id\_site']) || empty($\_POST['payloadlite'])) { |
  |  | 124 | throw new Exception('Error: '); |
  |  | 125 | } |
  |  | 126 |  |
  |  | 127 | $id\_shop = get\_option('apmswn\_shop\_id', 0); |
  |  | 128 | $post\_id\_shop = sanitize\_text\_field($\_POST['id\_shop']); |
  |  | 129 |  |
  |  | 130 | if ($id\_shop != $post\_id\_shop) { |
  |  | 131 | throw new Exception('Warning: '); |
  |  | 132 | } |
  |  | 133 |  |
  |  | 134 | $id\_site = get\_option('apmswn\_appid', 0); |
  |  | 135 | $post\_id\_site = sanitize\_text\_field($\_POST['id\_site']); |
  |  | 136 |  |
  |  | 137 | if ($id\_site != $post\_id\_site) { |
  |  | 138 | throw new Exception('Warning: '); |
  |  | 139 | } |
  |  | 140 |  |
  |  | 141 | //Payload validation |
  |  | 142 | $params = []; |
  |  | 143 | $params['id\_site'] = $id\_site; |
  |  | 144 | $params['id\_shop'] = $id\_shop; |
  |  | 145 | $params['payloadlite'] = sanitize\_text\_field($\_POST['payloadlite']); |
  |  | 146 |  |
  |  | 147 | $urlApi = Appsmav\_Scratchwin::$\_callback\_url . Appsmav\_Scratchwin::$\_api\_version . 'validatePayload'; |
  |  | 148 |  |
  |  | 149 | $response = wp\_remote\_post($urlApi, array('body' => $params, 'timeout' => 10)); |
  |  | 150 | if (is\_wp\_error( $response ) || !isset($response['body'])) { |
  |  | 151 | throw new Exception('Error: '); |
  |  | 152 | } |
  |  | 153 |  |
  |  | 154 | $res = json\_decode($response['body'], true); |
  |  | 155 | if (empty($res) || !empty($res['error'])) { |
  |  | 156 | throw new Exception('Error: '); |
  |  | 157 | } |
  |  | 158 |  |
  |  | 159 | return true; |
  |  | 160 | } catch (Exception $e) { |
  |  | 161 | $msg = $e->getMessage(); |
  |  | 162 | } |
  |  | 163 |  |
  |  | 164 | return new WP\_Error( |
  |  | 165 | 'sw\_rest\_forbidden', |
  |  | 166 | \_\_($msg . 'Sorry, you are not allowed! '), |
  |  | 167 | array('status' => rest\_authorization\_required\_code()) |
  |  | 168 | ); |
  | 113 | 169 | } |
  | 114 | 170 |  |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3207629#L151) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3212730#L207) |  |
  | 151 | 207 | $data['error']  = 0; |
  | 152 | 208 | $data['id']     = $page->ID; |
  | 153 |  | $data['url']    = get\_permalink($id); |
  |  | 209 | $data['url']    = get\_permalink($id\_post); |
  | 154 | 210 | $data['is\_embed\_landing\_url'] = get\_post\_meta(get\_the\_ID(), 'is\_embed\_landing\_url'); |
  | 155 | 211 | $data['msg']    = 'Success'; |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3207629#L356) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3212730#L412) |  |
  | 356 | 412 | if (!empty($coupon->id)) |
  | 357 | 413 | { |
  | 358 |  | $validate\_usage = empty($\_POST['validate\_usage']) ? 0 : ~~$\_POST['validate\_usage']~~; |
  |  | 414 | $validate\_usage = empty($\_POST['validate\_usage']) ? 0 : sanitize\_text\_field($\_POST['validate\_usage']); |
  | 359 | 415 | if(!empty($validate\_usage) && (!isset($coupon->usage\_count) || $coupon->usage\_count != 0)) |
  | 360 | 416 | { |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3207629#L391) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3212730#L447) |  |
  | 391 | 447 | $data = array(); |
  | 392 | 448 | try { |
  | 393 |  | $email = sanitize\_text\_field(trim($\_POST['email'])); |
  | 394 |  | $user\_name = sanitize\_text\_field(trim($\_POST['user\_name'])); |
  | 395 |  | $first\_name = sanitize\_text\_field(trim($\_POST['first\_name'])); |
  | 396 |  | $last\_name = sanitize\_text\_field(trim($\_POST['last\_name'])); |
  | 397 |  |  |
  | 398 |  | if (empty($email) || !filter\_var($email, FILTER\_VALIDATE\_EMAIL)) { |
  |  | 449 |  |
  |  | 450 | if (empty($\_POST['email']) || !filter\_var($\_POST['email'], FILTER\_VALIDATE\_EMAIL)) { |
  | 399 | 451 | throw new Exception("Invalid email address"); |
  | 400 | 452 | } |
  | 401 | 453 |  |
  | 402 |  | if (empty($~~user\_name~~)) { |
  |  | 454 | if (empty($\_POST['user\_name'])) { |
  | 403 | 455 | throw new Exception("Invalid user name"); |
  | 404 | 456 | } |
  | 405 |  |  |
  | 406 |  | ~~if (empty($first\_name~~)) { |
  |  | 457 |  |
  |  | 458 | if (empty($\_POST['first\_name'])) { |
  | 407 | 459 | throw new Exception("Invalid first name"); |
  | 408 | 460 | } |
  |  | 461 |  |
  |  | 462 | $email = sanitize\_text\_field($\_POST['email']); |
  |  | 463 | $user\_name = sanitize\_text\_field($\_POST['user\_name']); |
  |  | 464 | $first\_name = sanitize\_text\_field($\_POST['first\_name']); |
  |  | 465 | $last\_name = empty($\_POST['last\_name']) ? '' : sanitize\_text\_field($\_POST['last\_name']); |
  | 409 | 466 |  |
  | 410 | 467 | $user = get\_user\_by('email', $email); |
* ## [scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js](/changeset/3212730/scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js "Show the changeset 3212730 restricted to scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js")

  | [r2163940](/browser/scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js?rev=2163940#L124 "Show revision 2163940 of this file in browser") | [r3212730](/browser/scratch-win-giveaways-for-website-facebook/trunk/js/socialscratchwin.js?rev=3212730#L124 "Show revision 3212730 of this file in browser") |  |
  | --- | --- | --- |
  | 124 | 124 | jQuery.post( |
  | 125 | 125 | ajaxurl, |
  | 126 |  | {action:'apmswncheck\_settings',raffd: jQuery('#raffd').val()}, |
  |  | 126 | {action:'apmswncheck\_settings',raffd: jQuery('#raffd').val(), security: jQuery('#security').val()}, |
  | 127 | 127 | function(response){ |
  | 128 | 128 |  |
* ## [scratch-win-giveaways-for-website-facebook/trunk/readme.txt](/changeset/3212730/scratch-win-giveaways-for-website-facebook/trunk/readme.txt "Show the changeset 3212730 restricted to scratch-win-giveaways-for-website-facebook/trunk/readme.txt")

  | [r3207629](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3207629#L5 "Show revision 3207629 of this file in browser") | [r3212730](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3212730#L5 "Show revision 3212730 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 3.0.1 |
  | 6 | 6 | Tested up to: 6.7 |
  | 7 |  | Stable tag: 2.~~7.1~~ |
  |  | 7 | Stable tag: 2.8.0 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3207629#L157) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3212730#L157) |  |
  | 157 | 157 |  |
  | 158 | 158 | == Changelog == |
  |  | 159 | = 2.8.0 = |
  |  | 160 | Bug fixes and improvements |
  |  | 161 |  |
  | 159 | 162 | = 2.7.1 = |
  | 160 | 163 | Bug fixes and improvements |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3207629#L260) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/readme.txt?rev=3212730#L263) |  |
  | 260 | 263 | This version enables Scratch & Win Giveaways. |
  | 261 | 264 |  |
  | 262 |  |  |
  | 263 | 265 | == Upgrade Notice == |
  | 264 |  | = 2.~~7.1~~ = |
  | 265 |  | Bug fixes and improvements |
  |  | 266 | = 2.8.0 = |
  |  | 267 | Bug fixes and improvements |
* ## [scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php](/changeset/3212730/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php "Show the changeset 3212730 restricted to scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php")

  | [r3207629](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L2 "Show revision 3207629 of this file in browser") | [r3212730](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L2 "Show revision 3212730 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* @package Scratch & win giveaways |
  | 4 |  | \* @version 2.~~7.1~~ |
  |  | 4 | \* @version 2.8.0 |
  | 5 | 5 | \*/ |
  | 6 | 6 | /\* |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L8) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L8) |  |
  | 8 | 8 | Plugin URI: http://appsmav.com |
  | 9 | 9 | Description: LAUNCH AWESOME SCRATCH CARD GIVEAWAYS- BOOST LEADS AND CONVERSIONS! BUILD LISTS. GET REFERRAL SALES. |
  | 10 |  | Version: 2.~~7.1~~ |
  |  | 10 | Version: 2.8.0 |
  | 11 | 11 | Author: Appsmav |
  | 12 | 12 | Author URI: http://appsmav.com |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L35) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L35) |  |
  | 35 | 35 | class Appsmav\_Scratchwin |
  | 36 | 36 | { |
  | 37 |  | public static $\_plugin\_version  = '2.~~7.1~~'; |
  | 38 |  | p~~rotected~~ static $\_callback\_url = 'https://win.appsmav.com/'; |
  | 39 |  | p~~rotected~~ static $\_api\_version  = 'api/v1/'; |
  |  | 37 | public static $\_plugin\_version  = '2.8.0'; |
  |  | 38 | public static $\_callback\_url = 'https://win.appsmav.com/'; |
  |  | 39 | public static $\_api\_version  = 'api/v1/'; |
  | 40 | 40 | protected static $\_api\_url  = 'https://clients.appsmav.com/api\_v1.php'; |
  | 41 |  | protected static $\_c\_sdk\_url    = '//cdn.appsmav.com/win/assets/js/swin-widget-sdk.js?v=2.~~7.1~~'; |
  |  | 41 | protected static $\_c\_sdk\_url    = '//cdn.appsmav.com/win/assets/js/swin-widget-sdk.js?v=2.8.0'; |
  | 42 | 42 |  |
  | 43 | 43 | /\*\* |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L135) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L135) |  |
  | 135 | 135 | $version = empty($\_SERVER['REQUEST\_TIME']) ? time() : $\_SERVER['REQUEST\_TIME']; |
  | 136 | 136 |  |
  | 137 |  | echo '<script>var AMSWINConfig = {user : {name : "'.$cname.'", email : "'.$cemail.'", id : "'.$cid.'", country : ""}, site : {id : "'.$id\_site.'", domain : "", platform : "wp", version: "'.self::$\_plugin\_version.'"}}; |
  |  | 137 | echo '<script>var AMSWINConfig = {user : {name : "'.$cname.'", email : "'.$cemail.'", id : "'.$cid.'", country : ""}, site : {id : "'.$id\_site.'", domain : "", platform : "wp", version: "'.self::$\_plugin\_version.'"}, sw\_nonce : "'. wp\_create\_nonce('sw\_nonce') .'"}; |
  | 138 | 138 | (function(d, s, id) { |
  | 139 | 139 | var js, amjs = d.getElementsByTagName(s)[0]; |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L147) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L147) |  |
  | 147 | 147 |  |
  | 148 | 148 | public static function apmswn\_show\_func($atts) { |
  | 149 |  | $id = isset($atts['id'])~~? trim($atts['id']) : '';~~ |
  | 150 |  | $patternAlphaNum = '/^[a-zA-Z0-9~~\_~~]+$/'; |
  | 151 |  | if (empty($id) || !preg\_match($patternAlphaNum, $id)~~)~~ |
  |  | 149 | $id = isset($atts['id']) ? sanitize\_text\_field($atts['id']) : ''; |
  |  | 150 | $patternAlphaNum = '/^[a-zA-Z0-9]+$/'; |
  |  | 151 | if (empty($id) || !preg\_match($patternAlphaNum, $id) || strlen($id) > 10) { |
  | 152 | 152 | return ''; |
  |  | 153 | } |
  | 153 | 154 |  |
  | 154 | 155 | $url        =   self::$\_callback\_url . 'contest/play/' . $id; |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L221) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L222) |  |
  | 221 | 222 |  |
  | 222 | 223 | public function apmswn\_ajax\_cpcheck\_settings(){ |
  | 223 |  |  |
  |  | 224 | // Verify nonce |
  |  | 225 | $msg = self::\_checkNonce(); |
  |  | 226 | if (!empty($msg)) { |
  |  | 227 | die(json\_encode(['cp\_reg' => 4, 'message' => $msg])); |
  |  | 228 | } |
  |  | 229 |  |
  | 224 | 230 | $raffd = isset($\_POST['raffd']) ? sanitize\_text\_field($\_POST['raffd']) : ''; |
  | 225 | 231 | $email = get\_option('apmswn\_admin\_email'); |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L331) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L337) |  |
  | 331 | 337 | } |
  | 332 | 338 |  |
  | 333 |  |  |
  | 334 | 339 | die(json\_encode($res)); |
  | 335 | 340 | } |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L339) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L344) |  |
  | 339 | 344 | try |
  | 340 | 345 | { |
  |  | 346 | // Verify nonce |
  |  | 347 | $msg = self::\_checkNonce(); |
  |  | 348 | if (!empty($msg)) { |
  |  | 349 | throw new Exception($msg); |
  |  | 350 | } |
  |  | 351 |  |
  | 341 | 352 | if(empty($\_POST['apmswn\_login\_email']) || !filter\_var($\_POST['apmswn\_login\_email'], FILTER\_VALIDATE\_EMAIL)) |
  | 342 | 353 | die("Please enter valid email"); |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3207629#L403) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/socialscratchwin.php?rev=3212730#L414) |  |
  | 403 | 414 |  |
  | 404 | 415 | public function apmswn\_ajax\_cpcreate\_account(){ |
  |  | 416 | // Verify nonce |
  |  | 417 | $msg = self::\_checkNonce(); |
  |  | 418 | if (!empty($msg)) { |
  |  | 419 | die(json\_encode(['cp\_reg' => 4, 'message' => $msg])); |
  |  | 420 | } |
  | 405 | 421 | self::callAcctRegister($\_POST); |
  | 406 | 422 | } |
  |  | 423 |  |
  |  | 424 | /\*\* |
  |  | 425 | \* Check for nonce is valid |
  |  | 426 | \* @param string $nonce |
  |  | 427 | \* @param string $key |
  |  | 428 | \* @return string |
  |  | 429 | \*/ |
  |  | 430 | protected static function \_checkNonce($nonce = 'sw\_nonce', $key = 'security') |
  |  | 431 | { |
  |  | 432 | try { |
  |  | 433 | $msg = ''; |
  |  | 434 | // Verify nonce |
  |  | 435 | $nonce\_check = check\_ajax\_referer($nonce, $key, false); |
  |  | 436 | if ($nonce\_check == false) { |
  |  | 437 | // Handle invalid nonce |
  |  | 438 | $msg = 'Sorry, you are not allowed!'; |
  |  | 439 | } |
  |  | 440 | } catch (Exception $e) { |
  |  | 441 | $msg = 'Sorry, you are not allowed!'; |
  |  | 442 | } |
  |  | 443 |  |
  |  | 444 | return $msg; |
  |  | 445 | } |
  | 407 | 446 |  |
  | 408 | 447 | protected static function callAcctRegister($p) |
* ## [scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php](/changeset/3212730/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php "Show the changeset 3212730 restricted to scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php")

  | [r2163940](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=2163940#L7 "Show revision 2163940 of this file in browser") | [r3212730](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730#L7 "Show revision 3212730 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | $displayLoaderBlock    = ($grRegisterAr == 2)?"block":"none"; |
  | 8 | 8 | $displayLoginBlock     = ($grRegisterAr == 3)?"block":"none"; |
  |  | 9 | $sw\_nonce = wp\_create\_nonce('sw\_nonce'); |
  | 9 | 10 | ?> |
  | 10 | 11 | <input type="hidden" id="grRegisterAr" value="<?php echo $grRegisterAr?>" /> |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=2163940#L20) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730#L21) |  |
  | 20 | 21 | <form class="formGr form-horizontal" method="post" action="#" id="verifyForm" style="display:none"> |
  | 21 | 22 | <input type="hidden" name="action" value="check\_gr\_settings" /> |
  |  | 23 | <input type="hidden" id="security" name="security" value="<?php echo $sw\_nonce; ?>" /> |
  | 22 | 24 | <p class="subtitle">Verify your Email</p> |
  | 23 | 25 | <div class="inputBox"> |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=2163940#L48) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730#L50) |  |
  | 48 | 50 | <form class="formGr form-horizontal" method="post" action="#" id="registerForm"> |
  | 49 | 51 | <input type="hidden" name="action" value="apmswncreate\_account" /> |
  |  | 52 | <input type="hidden" name="security" value="<?php echo $sw\_nonce; ?>" /> |
  | 50 | 53 | <?php $current\_user = wp\_get\_current\_user();?> |
  | 51 | 54 |  |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=2163940#L92) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730#L95) |  |
  | 92 | 95 | <form class="formGr form-horizontal" method="post" action="#" id="loginForm"> |
  | 93 | 96 | <input type="hidden" name="action" value="apmswncheck\_login" /> |
  |  | 97 | <input type="hidden" name="security" value="<?php echo $sw\_nonce; ?>" /> |
  | 94 | 98 | <p class="subtitle">Login with your Email and Password</p> |
  | 95 | 99 | <div class="inputBox"> |
  | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=2163940#L125) | […](/browser/scratch-win-giveaways-for-website-facebook/trunk/templates/settings.php?rev=3212730#L129) |  |
  | 125 | 129 | <img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ )?>../img/scratch-and-win-banner.jpg" alt="Scratch and Win" /> |
  | 126 | 130 | </figure> |
  | 127 |  | <a href="<?php echo ~~$frame\_url~~?>" target="\_blank" class="btn btn-success btn-lg" id="gr\_launch\_link"> |
  |  | 131 | <a href="<?php echo esc\_url($frame\_url); ?>" target="\_blank" class="btn btn-success btn-lg" id="gr\_launch\_link"> |
  | 128 | 132 | <span>LAUNCH APPLICATION</span> |
  | 129 | 133 | <img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ )?>../img/icon-link.png" height="14" alt="Scratch and Win" /> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3212730)
* [Zip Archive](?format=zip&new=3212730)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_4b9b8265_20250114_203721.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fscratch-win-giveaways-for-website-facebook&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fscratch-win-giveaways-for-website-facebook&locale=en_US)

Search plugins

![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/banner-772x250.png?rev=3147941)
![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/icon-256x256.png?rev=2824493)
# Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more

By [Appsmav](http://appsmav.com)

[Download](https://downloads.wordpress.org/plugin/scratch-win-giveaways-for-website-facebook.2.8.0.zip)

* [Details](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/#description)
* [Reviews](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/#reviews)
* [Installation](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/#installation)
* [Development](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/#developers)

[Support](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/)

## Description

### WANT THIS APP FREE?

> GET THIS APP FREE WITH ANY PAID ANNUAL PLAN OF OUR [SOCIAL BOOST](https://wordpress.org/plugins/social-boost/) OR [GRATISFACTION](https://wordpress.org/plugins/gratisfaction-all-in-one-loyalty-contests-referral-program-for-woocommerce/) APPS.

### WANT TO SMASH YOUR MARKETING GOALS THIS HOLIDAY SEASON?

Supercharge your holiday campaigns with this fun and exciting app. Get ready for an exciting Halloween, Black Friday, Cyber Monday, Thanksgiving, Christmas, and more. Check out the campaign templates designed to make this holiday season your best! <https://demo.appsmav.com/scratch-win/>

### FESTIVALS AND POPULAR EVENTS TEMPLATE LIBRARY NOW AVAILABLE:

> Use These Template To Launch Campaigns in Minutes for:
>
> [Halloween](https://demo.appsmav.com/scratch-win/swin-halloween/), [Black Friday Cyber Monday](https://demo.appsmav.com/scratch-win/swin-black-friday-cyber-monday/), [Thanksgiving](https://demo.appsmav.com/scratch-win/swin-thanksgiving/), [Christmas](https://demo.appsmav.com/scratch-win/swin-christmas/), [New Year](https://demo.appsmav.com/scratch-win/new-year/), [Valentines Day](https://demo.appsmav.com/scratch-win/swin-valentines-day/), [March Madness](https://demo.appsmav.com/scratch-win/march-madness/), [St. Patrick’s day](https://demo.appsmav.com/scratch-win/st-patricks-day/), [Easter](https://demo.appsmav.com/scratch-win/easter/), [Mother’s day](https://demo.appsmav.com/scratch-win/mothers-day/), [Father’s day](https://demo.appsmav.com/scratch-win/fathers-day/), [Fourth of July](https://demo.appsmav.com/scratch-win/july-4th/), [Raksha Bandhan](https://demo.appsmav.com/scratch-win/raksha-bandhan/), [Oktoberfest](https://demo.appsmav.com/scratch-win/oktoberfest/), [Diwali](https://demo.appsmav.com/scratch-win/diwali/), [Soccer](https://demo.appsmav.com/scratch-win/soccer/), [Celebration](https://demo.appsmav.com/scratch-win/celebration/), and more…

### DO YOU WANT TO GET MORE SUBSCRIBERS, WEBSITE TRAFFIC, SALES, LEADS AND REFERRALS?

Show a scratch card on your WordPress website or WooCommerce store- A super fun and attractive way to achieve many of your marketing goals

Customize and launch in minutes. No technical skills, No design skills required.

### LAUNCH AWESOME SCRATCH CARD GIVEAWAYS- BOOST LEADS AND CONVERSIONS! BUILD LISTS. GET REFERRAL SALES

Check out: [Live Demo!](https://demo.appsmav.com/scratch-win/)

* Displaying scratch cards is an awesome gamification strategy to boost your lists, leads and engagement
* Includes ‘refer & play again’. See your referrals grow
* Display anywhere including your website. Increase conversions, Likes & Fans
* ‘Play Again’: People can play again and again for their chance to win. Repeat visits are known to boost conversions
* Festivals themed scratch card design library now available: Launch exciting giveaways for easter, black friday cyber monday, christmas, thanksgiving, valentine’s day, and more…
* Integration with ActiveCampaign, Aweber, Campaign Monitor, Constant Contact, Klaviyo, MailChimp, MailerLite, Sendinblue

### How does it work?

A Scratch Card appears on your website. You can set it up to appear as a pop up with different behaviors e.g. ‘on exit intent’ (aka Exit popup), after a scroll percentage or time spent on your website. When visitors enter their email address or connect through their social media profile, they can then scratch the card for their chance to win. Scratch & win can be fully customized so you can specify multiple prizes and slots, change layout, add custom form fields, activate referral, play again and much more.

Gamify and watch your leads grow! Display a Scratch Card on your website to offer visitors a chance to win in return for entering their details. A fun and irresistible way to get leads, fans, repeat visits, referrals and sales ( And, for WooCommerce stores: Winners can immediately apply their coupon codes on checkout- This means more sales for you)

### Demo

Check out: [Live Demo!](https://demo.appsmav.com/scratch-win/)

Note: The Scratch card demo pop-up will appear immediately but you can configure to disable it or display on exit intent, scroll percentage or after a timed delay. The layout, behavior and design can be easily customized

> WordPress websites- Works out of the box- It will just take couple of minutes to run your giveaway.
>
> WooCommerce websites- Works out of the box. Additionally, winner prizes (i.e. coupon codes) will be automagically created in your WooCommerce store. So no manual work is required. And, winners can immediately claim their rewards at checkout. This will lead to increased sales opportunities

### Display anywhere

You can display this anywhere including as a pop up, on a page on your website, Blog, etc. It is 100% mobile and Google friendly

### Play again- Get repeat visits!

Participants can also come back and play again after a certain time as configured by you. Repeat visits are known to boost brand recall and conversions

### Refer to play again- Boost Referral traffic!

Scratch & win also has an awesome Refer-to-play-again feature, which gets you referral traffic. Entrants share your promotion with their friends and when friends participate, the referrals get another chance to play. So, you get both viral referral traffic and repeat visits!

### WooCommerce Stores: Automagic coupons for instant checkout- Increased sales opportunity

Scratch & win winners are more likely to use their coupon code since the discount is won and can be immediately applied at checkout. This also means you don’t need to spend hours creating and managing coupon codes manually- We do all this automagically!

### Features (Free for 50 users. All features included)

* Display a scratchcard to people who signup.
* Refer to play again feature is now available to help you boost referrals, leads and fans
* Play again feature. Participants can come back to play again and again after admin defined time interval. This will boost repeat visits to your website and ultimately lead to more sales.
* Set your own slots, prizes types and prize quantity
* Template library available to help you launch awesome looking giveaways in minutes
* Single Social Sign On
* Display campaign on your WordPress website
* Integrated Social Sharing features
* Easy to install – Just plug & play. No coding required
* Display in any language
* Restrict campaigns by country and age
* Integration with ActiveCampaign, Aweber, Campaign Monitor, Constant Contact, Klaviyo, MailChimp, MailerLite, Sendinblue
* GDPR
* Display custom design banners
* Footer credit removal option available
* Choose start & end dates
* Launch multiple campaigns
* No commitment. No obligation

> **Note:** This plugin is only really of use to you if you have an Apps Mav account.
>
> The plugin connects to our appsmav.com dashboard for the initial set up, configuration and ongoing management of the app. The plugin will take you through a simple, free & no obligation, registration (sign up) process.
>
> The account setup is done on appsmav.com and is totally free, has no commitments & no obligations.
>
> 50 Users plan is a fully featured plan and is absolutely free (except footer credit removal, which is an optional add-on in every plan including the paid plans). You can then select from our affordable [plans](https://appsmav.com/scratch-and-win-platinum/pricing-plan.php)
>
> The leads and all entry details are also stored on the Apps Mav server and can be both downloaded as a CSV file or passed through 3rd party platforms like ActiveCampaign, Aweber, Campaign Monitor, Constant Contact, Klaviyo, MailChimp, MailerLite, Sendinblue
>
> Keep in mind that you will be redirected to create an Apps Mav account for it to work with.

Contact us Anytime! For any pre-sales or product inquiries, send us an email to sales@appsmav.com

## Screenshots

* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-1.png?rev=2350330)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-1.png?rev=2350330)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-2.png?rev=2350330)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-2.png?rev=2350330)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-3.png?rev=2350330)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-3.png?rev=2350330)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-4.png?rev=2350330)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-4.png?rev=2350330)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-5.png?rev=2825720)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-5.png?rev=2825720)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-6.jpg?rev=2812529)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-6.jpg?rev=2812529)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-7.jpg?rev=2812529)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-7.jpg?rev=2812529)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-8.jpg?rev=2812529)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-8.jpg?rev=2812529)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-9.jpg?rev=2812529)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-9.jpg?rev=2812529)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-10.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-10.png?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-11.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-11.png?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-12.jpg?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-12.jpg?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-13.jpg?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-13.jpg?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-14.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-14.png?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-15.jpg?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-15.jpg?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-16.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-16.png?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-17.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-17.png?rev=2405101)
* [![](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-18.png?rev=2405101)](https://ps.w.org/scratch-win-giveaways-for-website-facebook/assets/screenshot-18.png?rev=2405101)

## Installation

Keep in mind that you will be redirected to create an Apps Mav account for it to work with.The initial setup will only take a few minutes, is totally free and has no commitments & no obligations.

1. Upload “Scratch & win giveaways for Website” to the “/wp-content/plugins/” directory.

2. Activate the plugin through the “Plugins” menu in WordPress.

3. Use the Settings->Scratch & win giveaways for Website to configure the plugin

4. A setup screen will now display your WordPress Admin email & name for your review. Clicking on the Next button will create a free account on https://appsmav.com.

5. You will now be taken to the next screen and click on the ‘launch your app’ button which will redirect you to the admin panel on https://appsmav.com. Here you can now configure the service.

## FAQ

### Is ‘Scratch & win giveaways app free?

Yes, the full featured version (excludes footer credit removal option) is FREE for 50 Users.

### Do I need an Apps Mav account to set up and manage this plugin?

Yes, you do. The set-up, configuration and ongoing management of the app is done through the appsmav.com dashboard.

All users’ and entry details are also stored on the Apps Mav server and can be both downloaded as a CSV file or passed through 3rd party platforms like Active Campaign, Aweber, Campaign Monitor, Constant Contact, Klaviyo, MailChimp, MailerLite, Sendinblue

The initial setup will only take a few minutes, is totally free and has no commitments & no obligations. 50 user plan is a fully featured plan and is absolutely free (except footer credit removal, which is an optional add-on in every plan including the paid plans). You can then select from our affordable [plans](https://appsmav.com/scratch-and-win-platinum/pricing-plan.php).

### What features are included in the free version?

All features except the footer credit upgrade (this is optional). Also, please note that the free version will only display details of 50 users.

### Is it possible to translate every single element of Scratch and Win campaign?

Yes, all elements are translatable in your app’s dashboard. Go to ‘Language’ tab in the app dashboard and translate texts in each field into your own language. These are all texts that are exposed to the users.

### Do I need to know any programming language to install and run scratch and win campaigns?

No, just install the plugin and then easily setup a new campaign in just a few minutes.

### What is the pricing for the paid plans?

All plans include all features (except footer credit removal which is an optional add-on). The plans are based on the number of users.

Each person that signs up to your campaign is considered a ‘user’. We do not double count- So irrespective of the number of campaigns a user signs up for, we only count it as one.

Additionally, we use multiple anti-cheat filters to check and block fake / spam/invalid email IDs – This ensures your user list includes valid emails only

Pricing and Plans can be viewed [here](https://appsmav.com/scratch-and-win-platinum/pricing-plan.php)

### What kind of support do I get?

‘Scratch & win giveaways for Website’ plugin is very easy and fast to set up. If you ever need assistance, we are here to support you. For any pre-sales or product inquiries, send us an email to sales@appsmav.com . Existing customers, please send email to support@appsmav.com . Our support is unavailable over weekends

### I have another question, what do I do?

Contact us Anytime! For any pre-sales or product inquiries, send us an email to sales@appsmav.com .

## Reviews

![](https://secure.gravatar.com/avatar/9b5e0b4948e00655361be1020707a0ceeb8cb1599e1c4b7a5d064609b49925e2?s=60&d=retro&r=g)
### [Great plugin, easy to deploy and works like a charm.](https://wordpress.org/support/topic/great-plugin-easy-to-deploy-and-works-like-a-charm/)

[Prateek Singh](https://profiles.wordpress.org/sprateek818/ "Posts by Prateek Singh")
November 29, 2024

I have used this plugin to setup a campaign for my company and the plugin was very easy to setup.

![](https://secure.gravatar.com/avatar/4ea18ec1362790cbee1332867f41c9da5d03a20d4c0f227cff3afdac981e9913?s=60&d=retro&r=g)
### [Mayor Scam and Phishing PLEASE BE AWARE](https://wordpress.org/support/topic/mayor-scam-and-phishing-please-be-aware/)

[Alfio DiPane](https://profiles.wordpress.org/alfiodipane/ "Posts by Alfio DiPane")
August 22, 2024
5 replies

Please do not download or use it, this is a scam and they wanted to extort our team.

![](https://secure.gravatar.com/avatar/559b11fac75544095758b3075c3257a631b9586026d3c22c107bba04e5685262?s=60&d=retro&r=g)
### [Great plugin](https://wordpress.org/support/topic/great-plugin-38791/)

[myszkaszara](https://profiles.wordpress.org/myszkaszara/ "Posts by myszkaszara")
April 16, 2024

Very interesting plugin, the only one so good for WordPress. Great support, they respond immediately and help 200%.

![](https://secure.gravatar.com/avatar/42c875b9bb944c17fcf9fea23e36215ba9361f87b0ae062f013bc316789648f3?s=60&d=retro&r=g)
### [Amazing Plugin](https://wordpress.org/support/topic/amazing-plugin-2514/)

[Whizdon](https://profiles.wordpress.org/whizdon/ "Posts by Whizdon")
December 14, 2023

Scratch and win plugin is an amazing way to reach out to your audience to appreciate them. Also, if you have issues with your account, there response time is amazing as well.

![](https://secure.gravatar.com/avatar/22d3fd2329773636db1b7bbe9f4d00321fa47d083fb0bc9022538d3e6f158001?s=60&d=retro&r=g)
### [🎉 Scratch and Win: A Game-Changing Lead Generation Magic Wand! 🎲✨](https://wordpress.org/support/topic/excelent-plugin-for-digital-marketing/)

[pabloyepez](https://profiles.wordpress.org/pabloyepez/ "Posts by pabloyepez")
December 17, 2024

⭐⭐⭐⭐⭐ (5/5 Stars)
Wow! 🤯 Scratch and Win is an absolute game-changer for anyone looking to supercharge their lead generation strategy! This tool is like having a secret weapon in your marketing arsenal. 🚀
Key Highlights:
💡 Incredibly innovative approach to capturing potential customer interest
🎯 Powerful mechanism for growing your contact list
🤝 Transforms boring lead generation into an exciting, interactive experience
Why I Love It: Scratch and Win takes something as mundane as collecting contact information and turns it into a fun, engaging game that people actually want to participate in! It’s like marketing magic – customers can’t resist the temptation to scratch and reveal their potential prize. 🎁
Pro Tip: This tool isn’t just about collecting leads; it’s about creating memorable interactions that make potential customers excited to hear from you! 📈
Highly recommended for marketers who want to stand out from the crowd and make lead generation feel less like a chore and more like an exciting opportunity! 🌟
Would you like me to modify anything about the review?

![](https://secure.gravatar.com/avatar/20551b594840c66ba8fcdc00aa624a531b05f92a5f25ffd6a3a92f9215c18361?s=60&d=retro&r=g)
### [Love the App](https://wordpress.org/support/topic/love-the-app-10/)

[partybrand1](https://profiles.wordpress.org/partybrand1/ "Posts by partybrand1")
April 5, 2023

We are having a good experience with the app, and Praveen Kumar is a very kind atendent.

[Read all 29 reviews](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/)
## Contributors & Developers

“Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/68059e41993c2e99cd84d74f13ab5712f248009c2ec097b72b988a8cd7af81d0?s=32&d=mm&r=g) [appsmav](https://profiles.wordpress.org/appsmav/)

[Translate “Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more” into your language.](https://translate.wordpress.org/projects/wp-plugins/scratch-win-giveaways-for-website-facebook)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/scratch-win-giveaways-for-website-facebook/), check out the [SVN repository](https://plugins.svn.wordpress.org/scratch-win-giveaways-for-website-facebook/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/scratch-win-giveaways-for-website-facebook/) by [RSS](https://plugins.trac.wordpress.org/log/scratch-win-giveaways-for-website-facebook/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 2.8.0

Bug fixes and improvements

#### 2.7.1

Bug fixes and improvements

#### 2.7.0

Bug fixes and improvements

#### 2.6.9

WordPress version 6.7 release compatibility

#### 2.6.8

WordPress version 6.6 release compatibility

#### 2.6.7

WordPress version 6.5 release compatibility

#### 2.6.6

WordPress version 6.4 release compatibility

#### 2.6.5

WordPress version 6.3 release compatibility

#### 2.6.4

New Feature – Get leads captured in your website. Entrants’ name and email will now be auto-synced to your website

#### 2.6.3

WordPress version 6.2 release compatibility

#### 2.6.2

Improvements and bug fixes

#### 2.6.1

WordPress version 6.1 release compatibility

#### 2.6.0

WordPress version 6.0 release compatibility

#### 2.5.9

WordPress version 5.9 release compatibility

#### 2.5.8

WordPress version 5.8 release compatibility

#### 2.5.7

Bug fixes and improvements

#### 2.5.6

Bug fixes and improvements

#### 2.5.5

Added additional coupon attributes

#### 2.5.4

WordPress version 5.5 support update

#### 2.5.3

Bug fixes and improvements

#### 2.5.2

WordPress version 5.4 update

#### 2.5.1

New Feature – Embed campaign into a new page

#### 2.5.0

WordPress Standards related improvements

#### 2.4.0

API URL changes

#### 2.3.0

Widget SDK moved to CDN

#### 2.2.2

Widget SDK loading issue fixed

#### 2.2.1

WordPress version 5.0 release compatibility

#### 2.1.1

Page load optimization

#### 2.1.0

GDPR Compliance added

UI & UX improvements

Bug Fixes

#### 2.0.2

Removed coupon extra variable

#### 2.0.1

Added max-width attribute for short code embedded version

#### 2.0.0

Improved coupon creation process

Improved App layout and preview section

Fixed email encoding issue

#### 0.2

Dynamic coupon insert feature added with integration of scratch & win.

#### 0.1

This version enables Scratch & Win Giveaways.

## Meta

* Version **2.8.0**
* Last updated **3 weeks ago**
* Active installations **300+**
* WordPress version **3.0.1 or higher**
* Tested up to **6.7.1**
* Tags [christmas](https://wordpress.org/plugins/tags/christmas/)[contest](https://wordpress.org/plugins/tags/contest/)[giveaways](https://wordpress.org/plugins/tags/giveaways/)[promotion](https://wordpress.org/plugins/tags/promotion/)[Thanksgiving](https://wordpress.org/plugins/tags/thanksgiving/)
* [Advanced View](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/advanced/)

## Ratings

4.7 out of 5 stars.

* [27 5-star reviews
  5 stars

  27](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/?filter=2)
* [2 1-star reviews
  1 star

  2](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/68059e41993c2e99cd84d74f13ab5712f248009c2ec097b72b988a8cd7af81d0?s=32&d=mm&r=g) [appsmav](https://profiles.wordpress.org/appsmav/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/scratch-win-giveaways-for-website-facebook/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://appsmav.com)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_c85ec96d_20250114_203718.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fscratch-win-giveaways-for-website-facebook%2Ftags%2F2.7.0%2Fincludes%2Fswin-api.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=2837833 "Revision 2837833")
* [Next Revision](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?rev=3207629 "Revision 3207629") →
* [Blame](/browser/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes/swin-api.php)

---

# [source:](/browser?order=name "Go to repository root") [scratch-win-giveaways-for-website-facebook](/browser/scratch-win-giveaways-for-website-facebook?order=name "View scratch-win-giveaways-for-website-facebook")/[tags](/browser/scratch-win-giveaways-for-website-facebook/tags?order=name "View tags")/[2.7.0](/browser/scratch-win-giveaways-for-website-facebook/tags/2.7.0?order=name "View 2.7.0")/[includes](/browser/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes?order=name "View includes")/[swin-api.php](/browser/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes/swin-api.php?order=name "View swin-api.php")

View diff against:

View revision:

| [Last change](/changeset/2946999/scratch-win-giveaways-for-website-facebook/trunk/includes/swin-api.php "View differences") on this file was [2946999](/changeset/2946999/ "View changeset 2946999"), checked in by akashmalik, [18 months ago](/timeline?from=2023-08-03T08%3A45%3A24Z&precision=second "See timeline at 08/03/2023 08:45:24 AM") |
| --- |
| New Feature - Get leads captured in your website. Entrants' name and email will now be auto-synced to your website |
| **File size:** 14.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | if( ! defined('ABSPATH')) |
| [4](#L4) | exit; |
| [5](#L5) |  |
| [6](#L6) | class Swin\_API extends WP\_REST\_Controller |
| [7](#L7) | { |
| [8](#L8) | public function register\_apis() |
| [9](#L9) | { |
| [10](#L10) | register\_rest\_route('swinwoo/v1', '/getPage', array( |
| [11](#L11) | array( |
| [12](#L12) | 'methods'               =>  WP\_REST\_Server::READABLE, |
| [13](#L13) | 'callback'              =>  array($this, 'get\_page'), |
| [14](#L14) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [15](#L15) | 'args'                  =>  array() |
| [16](#L16) | ) |
| [17](#L17) | )); |
| [18](#L18) | register\_rest\_route('swinwoo/v1', '/addPage', array( |
| [19](#L19) | array( |
| [20](#L20) | 'methods'               =>  WP\_REST\_Server::CREATABLE, |
| [21](#L21) | 'callback'              =>  array($this, 'add\_page'), |
| [22](#L22) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [23](#L23) | 'args'                  =>  array() |
| [24](#L24) | ) |
| [25](#L25) | )); |
| [26](#L26) | register\_rest\_route('swinwoo/v1', '/editPage', array( |
| [27](#L27) | array( |
| [28](#L28) | 'methods'               =>  WP\_REST\_Server::EDITABLE, |
| [29](#L29) | 'callback'              =>  array($this, 'edit\_page'), |
| [30](#L30) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [31](#L31) | 'args'                  =>  array() |
| [32](#L32) | ) |
| [33](#L33) | )); |
| [34](#L34) | register\_rest\_route('swinwoo/v1', '/deletePage', array( |
| [35](#L35) | array( |
| [36](#L36) | 'methods'               =>  WP\_REST\_Server::EDITABLE, |
| [37](#L37) | 'callback'              =>  array($this, 'delete\_page'), |
| [38](#L38) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [39](#L39) | 'args'                  =>  array() |
| [40](#L40) | ) |
| [41](#L41) | )); |
| [42](#L42) |  |
| [43](#L43) | register\_rest\_route('swinwoo/v1', '/getversion', array( |
| [44](#L44) | 'methods'               => 'POST', |
| [45](#L45) | 'callback'              => array($this, 'getversion'), |
| [46](#L46) | 'permission\_callback'   => array($this, 'check\_api\_permission'), |
| [47](#L47) | 'args'                  => array() |
| [48](#L48) | )); |
| [49](#L49) | register\_rest\_route('swinwoo/v1', '/resetInstallation', array( |
| [50](#L50) | array( |
| [51](#L51) | 'methods'               =>  'POST', |
| [52](#L52) | 'callback'              =>  array($this, 'reset\_installation'), |
| [53](#L53) | 'permission\_callback'   =>  array($this, 'check\_api\_permission\_lite'), |
| [54](#L54) | 'args'                  =>  array() |
| [55](#L55) | ) |
| [56](#L56) | )); |
| [57](#L57) | register\_rest\_route('swinwoo/v1', '/verifyCouponCode', array( |
| [58](#L58) | array( |
| [59](#L59) | 'methods'               =>  'POST', |
| [60](#L60) | 'callback'              =>  array($this, 'verify\_coupon\_code'), |
| [61](#L61) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [62](#L62) | 'args'                  =>  array() |
| [63](#L63) | ) |
| [64](#L64) | )); |
| [65](#L65) |  |
| [66](#L66) | register\_rest\_route('swinwoo/v1', '/deleteCouponCode', array( |
| [67](#L67) | array( |
| [68](#L68) | 'methods'               =>  'POST', |
| [69](#L69) | 'callback'              =>  array($this, 'delete\_coupon\_code'), |
| [70](#L70) | 'permission\_callback'   =>  array($this, 'check\_api\_permission'), |
| [71](#L71) | 'args'                  =>  array() |
| [72](#L72) | ) |
| [73](#L73) | )); |
| [74](#L74) |  |
| [75](#L75) | register\_rest\_route('swinwoo/v1', '/createcustomer', array( |
| [76](#L76) | 'methods'                   => 'POST', |
| [77](#L77) | 'callback'                  =>  array($this, 'createcustomer'), |
| [78](#L78) | 'permission\_callback'       =>  array($this, 'check\_api\_permission'), |
| [79](#L79) | 'args'                      =>  array() |
| [80](#L80) | )); |
| [81](#L81) | } |
| [82](#L82) |  |
| [83](#L83) | public function check\_api\_permission($request) |
| [84](#L84) | { |
| [85](#L85) | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
| [86](#L86) | return false; |
| [87](#L87) | } else { |
| [88](#L88) | $payload = get\_option('apmswn\_payload', 0); |
| [89](#L89) | $post\_payload = sanitize\_text\_field($\_POST['payload']); |
| [90](#L90) |  |
| [91](#L91) | if (empty($\_POST['payload']) || $payload != $post\_payload) { |
| [92](#L92) | return false; |
| [93](#L93) | } |
| [94](#L94) | } |
| [95](#L95) | return true; |
| [96](#L96) | } |
| [97](#L97) |  |
| [98](#L98) | public function check\_api\_permission\_lite($request) |
| [99](#L99) | { |
| [100](#L100) | if (strpos($request->get\_header('user\_agent'), 'Appsmav') === false) { |
| [101](#L101) | return false; |
| [102](#L102) | } |
| [103](#L103) | return true; |
| [104](#L104) | } |
| [105](#L105) |  |
| [106](#L106) | public function getversion($request) |
| [107](#L107) | { |
| [108](#L108) | try { |
| [109](#L109) | $version = ''; |
| [110](#L110) | if (class\_exists('Appsmav\_Scratchwin')) { |
| [111](#L111) | $version = Appsmav\_Scratchwin::$\_plugin\_version; |
| [112](#L112) | } |
| [113](#L113) |  |
| [114](#L114) | $data = array('error' => 0, 'plugin\_version' => $version); |
| [115](#L115) | } catch (Exception $e) { |
| [116](#L116) | $data['error'] = 1; |
| [117](#L117) | $data['msg'] = $e->getMessage(); |
| [118](#L118) | } |
| [119](#L119) | return new WP\_REST\_Response($data, 200); |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) | public function get\_page($request) |
| [123](#L123) | { |
| [124](#L124) | $data = array('error' => 0); |
| [125](#L125) |  |
| [126](#L126) | try |
| [127](#L127) | { |
| [128](#L128) | if (empty($\_POST['id'])) { |
| [129](#L129) | throw new Exception('Invalid Page'); |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | $id\_post = sanitize\_text\_field($\_POST['id']); |
| [133](#L133) | if (!get\_post\_status($id\_post)) { |
| [134](#L134) | throw new Exception('Invalid Page'); |
| [135](#L135) | } |
| [136](#L136) |  |
| [137](#L137) | $page = get\_post($id\_post); |
| [138](#L138) | if(is\_wp\_error($page)) { |
| [139](#L139) | throw new Exception('cannot\_update\_page'. $page->get\_error\_message()); |
| [140](#L140) | } |
| [141](#L141) |  |
| [142](#L142) | $data['error']      = 0; |
| [143](#L143) | $data['id']         = $page->ID; |
| [144](#L144) | $data['url']        = get\_permalink($id); |
| [145](#L145) | $data['is\_embed\_landing\_url'] = get\_post\_meta(get\_the\_ID(), 'is\_embed\_landing\_url'); |
| [146](#L146) | $data['msg']        = 'Success'; |
| [147](#L147) | } |
| [148](#L148) | catch(Exception $e) |
| [149](#L149) | { |
| [150](#L150) | $data['error']          =   1; |
| [151](#L151) | $data['error\_message']  =   $e->getMessage(); |
| [152](#L152) | } |
| [153](#L153) |  |
| [154](#L154) | return new WP\_REST\_Response($data, 200); |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | public function add\_page($request) |
| [158](#L158) | { |
| [159](#L159) | $data   =   array('error' => 0); |
| [160](#L160) |  |
| [161](#L161) | try |
| [162](#L162) | { |
| [163](#L163) | if (empty($\_POST['title'])) { |
| [164](#L164) | throw new Exception('Invalid Title'); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | if (empty($\_POST['content'])) { |
| [168](#L168) | throw new Exception('Invalid Content'); |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | $new\_page = array( |
| [172](#L172) | 'post\_title'   => sanitize\_text\_field($\_POST['title']), |
| [173](#L173) | 'post\_content' => sanitize\_text\_field($\_POST['content']), |
| [174](#L174) | 'post\_status'  => 'publish', |
| [175](#L175) | 'post\_type'    => 'page', |
| [176](#L176) | 'meta\_input'   => array( |
| [177](#L177) | 'is\_embed\_landing\_url' => 1 |
| [178](#L178) | ) |
| [179](#L179) | ); |
| [180](#L180) |  |
| [181](#L181) | $id = wp\_insert\_post( $new\_page, $wp\_error = false ); |
| [182](#L182) |  |
| [183](#L183) | if(is\_wp\_error($id)) { |
| [184](#L184) | throw new Exception('cannot\_create\_page'. $id->get\_error\_message()); |
| [185](#L185) | } |
| [186](#L186) |  |
| [187](#L187) | $data['error'] = 0; |
| [188](#L188) | $data['id']    = $id; |
| [189](#L189) | $data['url']   = get\_permalink($id); |
| [190](#L190) | $data['msg']   = 'Success'; |
| [191](#L191) | } |
| [192](#L192) | catch(Exception $e) |
| [193](#L193) | { |
| [194](#L194) | $data['error']         = 1; |
| [195](#L195) | $data['error\_message'] = $e->getMessage(); |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | return new WP\_REST\_Response($data, 200); |
| [199](#L199) | } |
| [200](#L200) |  |
| [201](#L201) | public function edit\_page($request) |
| [202](#L202) | { |
| [203](#L203) | $data = array('error' => 0); |
| [204](#L204) |  |
| [205](#L205) | try |
| [206](#L206) | { |
| [207](#L207) | if (isset($\_POST['title']) && empty($\_POST['title']) && !isset($\_POST['publish'])) { |
| [208](#L208) | throw new Exception('Invalid Title'); |
| [209](#L209) | } |
| [210](#L210) |  |
| [211](#L211) | if (empty($\_POST['id'])) { |
| [212](#L212) | throw new Exception('Invalid Page'); |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | $params['ID'] = sanitize\_text\_field($\_POST['id']); |
| [216](#L216) | if (!get\_post\_status($params['ID'])) { |
| [217](#L217) | throw new Exception('Invalid Page'); |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if (isset($\_POST['publish'])) |
| [221](#L221) | { |
| [222](#L222) | $publish\_status = sanitize\_text\_field($\_POST['publish']); |
| [223](#L223) | $params['post\_status'] = ($publish\_status == 1) ? 'publish' : 'draft'; |
| [224](#L224) | update\_post\_meta($params['ID'], 'is\_embed\_landing\_url', $publish\_status); |
| [225](#L225) | } |
| [226](#L226) | else |
| [227](#L227) | { |
| [228](#L228) | $params['post\_title'] = sanitize\_text\_field($\_POST['title']); |
| [229](#L229) | } |
| [230](#L230) |  |
| [231](#L231) | $id = wp\_update\_post( $params, $wp\_error = true ); |
| [232](#L232) |  |
| [233](#L233) | if(is\_wp\_error($id)) |
| [234](#L234) | throw new Exception('cannot\_update\_page'. $id->get\_error\_message()); |
| [235](#L235) |  |
| [236](#L236) | $page\_info = get\_post($id); |
| [237](#L237) |  |
| [238](#L238) | $data['error'] = 0; |
| [239](#L239) | $data['id']    = $page\_info->ID; |
| [240](#L240) | $data['title'] = $page\_info->post\_title; |
| [241](#L241) | $data['url']   = get\_permalink($page\_info->ID); |
| [242](#L242) | $data['msg']   = 'Success'; |
| [243](#L243) | } |
| [244](#L244) | catch(Exception $e) |
| [245](#L245) | { |
| [246](#L246) | $data['error']         = 1; |
| [247](#L247) | $data['error\_message'] = $e->getMessage(); |
| [248](#L248) | } |
| [249](#L249) |  |
| [250](#L250) | return new WP\_REST\_Response($data, 200); |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | public function delete\_page($request) |
| [254](#L254) | { |
| [255](#L255) | $data   =   array('error' => 0); |
| [256](#L256) |  |
| [257](#L257) | try |
| [258](#L258) | { |
| [259](#L259) | if (empty($\_POST['id'])) { |
| [260](#L260) | throw new Exception('Invalid Page'); |
| [261](#L261) | } |
| [262](#L262) |  |
| [263](#L263) | $id\_page = sanitize\_text\_field($\_POST['id']); |
| [264](#L264) | if (!get\_post\_status($id\_page)) { |
| [265](#L265) | throw new Exception('Invalid Page'); |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) | if(!wp\_delete\_post($id\_page, true)) { |
| [269](#L269) | throw new Exception('cannot\_delete\_page'); |
| [270](#L270) | } |
| [271](#L271) |  |
| [272](#L272) | $data['error'] = 0; |
| [273](#L273) | $data['msg']   = 'Success'; |
| [274](#L274) | } |
| [275](#L275) | catch(Exception $e) |
| [276](#L276) | { |
| [277](#L277) | $data['error']         = 1; |
| [278](#L278) | $data['error\_message'] = $e->getMessage(); |
| [279](#L279) | } |
| [280](#L280) |  |
| [281](#L281) | return new WP\_REST\_Response($data, 200); |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | public function reset\_installation($request) |
| [285](#L285) | { |
| [286](#L286) | try |
| [287](#L287) | { |
| [288](#L288) | $data['error'] = 0; |
| [289](#L289) |  |
| [290](#L290) | // Reset flags to show login screen |
| [291](#L291) | update\_option('apmswn\_register', 3); |
| [292](#L292) |  |
| [293](#L293) | $data['msg'] = 'yes'; |
| [294](#L294) | } |
| [295](#L295) | catch(Exception $e) { |
| [296](#L296) | $data['error'] = 1; |
| [297](#L297) | $data['msg']   = $e->getMessage(); |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | return new WP\_REST\_Response($data, 200); |
| [301](#L301) | } |
| [302](#L302) |  |
| [303](#L303) | public function verify\_coupon\_code($request) |
| [304](#L304) | { |
| [305](#L305) | try |
| [306](#L306) | { |
| [307](#L307) | $data['error'] = 0; |
| [308](#L308) |  |
| [309](#L309) | if (empty($\_POST['coupon\_code'])) { |
| [310](#L310) | throw new Exception('Coupon code cannot be empty. Please check'); |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | $coupon\_code = sanitize\_text\_field($\_POST['coupon\_code']); |
| [314](#L314) |  |
| [315](#L315) | $coupon = new WC\_Coupon($coupon\_code); |
| [316](#L316) | if (!empty($coupon->id)) |
| [317](#L317) | { |
| [318](#L318) | $data['msg'] = 'Yes'; |
| [319](#L319) | $data['coupon'] = json\_decode($coupon, true); |
| [320](#L320) | } |
| [321](#L321) | else |
| [322](#L322) | $data['msg'] = 'No'; |
| [323](#L323) | } |
| [324](#L324) | catch(Exception $e) { |
| [325](#L325) | $data['error'] = 1; |
| [326](#L326) | $data['msg']   = $e->getMessage(); |
| [327](#L327) | } |
| [328](#L328) |  |
| [329](#L329) | $result = new WP\_REST\_Response($data, 200); |
| [330](#L330) | // Set headers. |
| [331](#L331) | $result->set\_headers(array('Cache-Control' => 'no-store, no-cache, must-revalidate, max-age=0')); |
| [332](#L332) | return $result; |
| [333](#L333) | } |
| [334](#L334) |  |
| [335](#L335) | public function delete\_coupon\_code($request) |
| [336](#L336) | { |
| [337](#L337) | try |
| [338](#L338) | { |
| [339](#L339) | $data['error'] = 0; |
| [340](#L340) |  |
| [341](#L341) | if (empty($\_POST['coupon\_code'])) { |
| [342](#L342) | throw new Exception('Invalid coupon code'); |
| [343](#L343) | } |
| [344](#L344) |  |
| [345](#L345) | $coupon\_code = sanitize\_text\_field($\_POST['coupon\_code']); |
| [346](#L346) | $coupon = new WC\_Coupon($coupon\_code); |
| [347](#L347) | if (!empty($coupon->id)) |
| [348](#L348) | { |
| [349](#L349) | $validate\_usage = empty($\_POST['validate\_usage']) ? 0 : $\_POST['validate\_usage']; |
| [350](#L350) | if(!empty($validate\_usage) && (!isset($coupon->usage\_count) || $coupon->usage\_count != 0)) |
| [351](#L351) | { |
| [352](#L352) | $data['id'] = $coupon->id; |
| [353](#L353) | $data['usage\_count'] = $coupon->usage\_count; |
| [354](#L354) | throw new Exception('Coupon code already used'); |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | $post\_id = wp\_delete\_post($coupon->id, TRUE); |
| [358](#L358) | if ( is\_wp\_error( $post\_id ) ) { |
| [359](#L359) | throw new Exception( $post\_id->get\_error\_message()); |
| [360](#L360) | } |
| [361](#L361) |  |
| [362](#L362) | $data['msg'] = 'Successfully Deleted'; |
| [363](#L363) | } |
| [364](#L364) | else { |
| [365](#L365) | $data['msg'] = 'Coupon code not found.'; |
| [366](#L366) | } |
| [367](#L367) |  |
| [368](#L368) | } |
| [369](#L369) | catch(Exception $e) { |
| [370](#L370) | $data['error'] = 1; |
| [371](#L371) | $data['msg']   = $e->getMessage(); |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | $result = new WP\_REST\_Response($data, 200); |
| [375](#L375) | // Set headers. |
| [376](#L376) | $result->set\_headers(array('Cache-Control' => 'no-store, no-cache, must-revalidate, max-age=0')); |
| [377](#L377) | return $result; |
| [378](#L378) | } |
| [379](#L379) |  |
| [380](#L380) | public function createcustomer() |
| [381](#L381) | { |
| [382](#L382) | $data = array(); |
| [383](#L383) | try { |
| [384](#L384) | $email = sanitize\_text\_field(trim($\_POST['email'])); |
| [385](#L385) | $user\_name = sanitize\_text\_field(trim($\_POST['user\_name'])); |
| [386](#L386) | $first\_name = sanitize\_text\_field(trim($\_POST['first\_name'])); |
| [387](#L387) | $last\_name = sanitize\_text\_field(trim($\_POST['last\_name'])); |
| [388](#L388) |  |
| [389](#L389) | if (empty($email) || !filter\_var($email, FILTER\_VALIDATE\_EMAIL)) { |
| [390](#L390) | throw new Exception("Invalid email address"); |
| [391](#L391) | } |
| [392](#L392) |  |
| [393](#L393) | if (empty($user\_name)) { |
| [394](#L394) | throw new Exception("Invalid user name"); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | if (empty($first\_name)) { |
| [398](#L398) | throw new Exception("Invalid first name"); |
| [399](#L399) | } |
| [400](#L400) |  |
| [401](#L401) | $user = get\_user\_by('email', $email); |
| [402](#L402) | if (!empty($user)) { |
| [403](#L403) | throw new Exception("Email id already exists"); |
| [404](#L404) | } |
| [405](#L405) |  |
| [406](#L406) | $user = get\_user\_by('login', $user\_name); |
| [407](#L407) | if (!empty($user)) { |
| [408](#L408) | $user\_name = $email; |
| [409](#L409) | $user = get\_user\_by('login', $user\_name); |
| [410](#L410) | if (!empty($user)) { |
| [411](#L411) | throw new Exception("Username already exists"); |
| [412](#L412) | } |
| [413](#L413) | } |
| [414](#L414) |  |
| [415](#L415) | $user\_details = array( |
| [416](#L416) | 'user\_email' => $email, |
| [417](#L417) | 'user\_login' => $user\_name, |
| [418](#L418) | 'first\_name' => $first\_name, |
| [419](#L419) | 'last\_name' => $last\_name |
| [420](#L420) | ); |
| [421](#L421) |  |
| [422](#L422) | $user\_id = wp\_insert\_user($user\_details); |
| [423](#L423) | if (is\_wp\_error($user\_id)) { |
| [424](#L424) | throw new Exception($user\_id->get\_error\_message()); |
| [425](#L425) | } |
| [426](#L426) |  |
| [427](#L427) | $user = get\_user\_by('id', $user\_id); |
| [428](#L428) | if ( |
| [429](#L429) | !empty($user) && !empty($user->data) && !empty($user->data->user\_email) |
| [430](#L430) | && $user->data->user\_email == $email |
| [431](#L431) | ) { |
| [432](#L432) | $data = array( |
| [433](#L433) | 'error' => 0, |
| [434](#L434) | 'id' => $user\_id, |
| [435](#L435) | ); |
| [436](#L436) | } else { |
| [437](#L437) | throw new Exception("User creation failed"); |
| [438](#L438) | } |
| [439](#L439) | } catch (Exception $e) { |
| [440](#L440) | $data['error'] = 1; |
| [441](#L441) | $data['msg'] = $e->getMessage(); |
| [442](#L442) | } |
| [443](#L443) |  |
| [444](#L444) | $data['plugin\_version'] = Appsmav\_Scratchwin::$\_plugin\_version; |
| [445](#L445) |  |
| [446](#L446) | $result = new WP\_REST\_Response($data, 200); |
| [447](#L447) |  |
| [448](#L448) | // Set headers. |
| [449](#L449) | $result->set\_headers(array('Cache-Control' => 'no-store, no-cache, must-revalidate, max-age=0')); |
| [450](#L450) | return $result; |
| [451](#L451) | } |
| [452](#L452) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes/swin-api.php?format=txt)
* [Original Format](/export/3222468/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes/swin-api.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_2d237c87_20250114_203723.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Scratch & Win – Giveaways and Contests <= 2.7.1 - Cross-Site Request Forgery via reset\_installation Function

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Scratch & Win – Giveaways and Contests <= 2.7.1 - Cross-Site Request Forgery via reset\_installation Function

5.4

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

| CVE | [CVE-2024-12545](https://www.cve.org/CVERecord?id=CVE-2024-12545) |
| --- | --- |
| CVSS | 5.4 (Medium) |
| Publicly Published | January 3, 2025 |
| Last Updated | January 4, 2025 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.7.1. This is due to missing nonce validation on the reset\_installation() function. This makes it possible for unauthenticated attackers to reset the plugin’s installation via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/scratch-win-giveaways-for-website-facebook/tags/2.7.0/includes/swin-api.php)
* [wordpress.org](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3212730/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscratch-win-giveaways-for-website-facebook%2Fscratch-win-giveaways-and-contests-271-cross-site-request-forgery-via-reset-installation-function&t=Scratch%20%26%20Win%20%E2%80%93%20Giveaways%20and%20Contests%20%3C%3D%202.7.1%20-%20Cross-Site%20Request%20Forgery%20via%20reset_installation%20Function "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscratch-win-giveaways-for-website-facebook%2Fscratch-win-giveaways-and-contests-271-cross-site-request-forgery-via-reset-installation-function&text=Scratch%20%26%20Win%20%E2%80%93%20Giveaways%20and%20Contests%20%3C%3D%202.7.1%20-%20Cross-Site%20Request%20Forgery%20via%20reset_installation%20Function "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fscratch-win-giveaways-for-website-facebook%2Fscratch-win-giveaways-and-contests-271-cross-site-request-forgery-via-reset-installation-function "LinkedIn")
Email

## Vulnerability Details for Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more

#### [Scratch & Win – Giveaways and Contests. Boost subscribers, traffic, repeat visits, referrals, sales and more](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/scratch-win-giveaways-for-website-facebook)

| Software Type | Plugin |
| --- | --- |
| Software Slug | scratch-win-giveaways-for-website-facebook [(view on wordpress.org)](https://wordpress.org/plugins/scratch-win-giveaways-for-website-facebook) |
| Patched? | Yes |
| Remediation | Update to version 2.8.0, or a newer patched version |
| Affected Version | * <= 2.7.1 |
| Patched Version | * 2.8.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


