The provided content relates to CVE-2024-30618.

**Root cause of vulnerability:**
The vulnerability is due to the lack of proper sanitization of user-supplied input in the `content` parameter when displaying group messages.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- The application fails to sanitize the `content` parameter in `group_topics.php` before displaying it.

**Impact of exploitation:**
- An attacker can inject arbitrary JavaScript code, which will be executed in the browsers of other users who view the affected group messages.
- This could lead to session hijacking, cookie theft, defacement of the website, or other malicious activities.

**Attack vectors:**
- The attacker needs to create a social group and then create a thread with a malicious payload injected within the message's content.
- The XSS payload is embedded within the `content` parameter of a POST request to `group_topics.php`.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user of the Chamilo LMS platform.
- The attacker needs the ability to create social groups and post messages within those groups.
- An attacker requires an HTTP interceptor, such as Burp Suite, to modify the message's content to include a malicious XSS payload.

**Additional details:**
- The vulnerability was found in Chamilo LMS versions 1.11 up to 1.11.26.
- The fix involves using `Security::remove_XSS` to sanitize the message content before displaying it.