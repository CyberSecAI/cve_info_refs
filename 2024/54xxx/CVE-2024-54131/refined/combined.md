=== Content from github.com_48d48723_20250114_190952.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolide%2Flauncher%2Fsecurity%2Fadvisories%2FGHSA-66q9-2rvx-qfj5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolide%2Flauncher%2Fsecurity%2Fadvisories%2FGHSA-66q9-2rvx-qfj5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=kolide%2Flauncher)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kolide](/kolide)
/
**[launcher](/kolide/launcher)**
Public

* [Notifications](/login?return_to=%2Fkolide%2Flauncher) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkolide%2Flauncher)
* [Star
   511](/login?return_to=%2Fkolide%2Flauncher)

* [Code](/kolide/launcher)
* [Issues
  96](/kolide/launcher/issues)
* [Pull requests
  13](/kolide/launcher/pulls)
* [Actions](/kolide/launcher/actions)
* [Security](/kolide/launcher/security)
* [Insights](/kolide/launcher/pulse)

Additional navigation options

* [Code](/kolide/launcher)
* [Issues](/kolide/launcher/issues)
* [Pull requests](/kolide/launcher/pulls)
* [Actions](/kolide/launcher/actions)
* [Security](/kolide/launcher/security)
* [Insights](/kolide/launcher/pulse)

# Kolide Agent Privilege Escalation (Windows, Versions >= 1.5.3, < 1.12.3)

High

[directionless](/directionless)
published
GHSA-66q9-2rvx-qfj5
Dec 3, 2024

## Package

gomod

github.com/kolide/launcher
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

>= 1.5.3, < 1.12.3

## Patched versions

1.12.3

## Description

An implementation bug in the Kolide Agent (known as `launcher`) allows for local privilege escalation to the SYSTEM user on Windows 10 and 11. Impacted versions include versions >= 1.5.3 and the fix has been released in 1.12.3.

The bug was introduced in version 1.5.3 when launcher started storing upgraded binaries in the ProgramData directory ([#1510](https://github.com/kolide/launcher/pull/1510)). This move to the new directory meant the launcher root directory inherited default permissions that are not as strict as the previous location. These incorrect default permissions in conjunction with an omitted SystemDrive environmental variable (when launcher starts osqueryd), allows a malicious actor with access to the local Windows device to successfully place an arbitrary DLL into the osqueryd process's search path. Under some circumstances, this DLL will be executed when osqueryd performs a WMI query. This combination of events could then allow the attacker to escalate their privileges to SYSTEM.

This issue was found by Bryan Alexander of Atredis Partners and responsibly reported through the Kolide bug bounty program. Kolide made the appropriate changes and released a fix in version 1.12.3 of the `launcher` package.

### Severity

High

7.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Local

Attack Complexity
Low

Attack Requirements
Present

Privileges Required
Low

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
High

Availability
Low
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:L/SC:N/SI:N/SA:N

### CVE ID

CVE-2024-54131

### Weaknesses

[CWE-276](/advisories?query=cwe%3A276) [CWE-456](/advisories?query=cwe%3A456)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2e4263cb_20250114_190952.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolide%2Flauncher%2Fpull%2F1510)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolide%2Flauncher%2Fpull%2F1510)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=kolide%2Flauncher)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kolide](/kolide)
/
**[launcher](/kolide/launcher)**
Public

* [Notifications](/login?return_to=%2Fkolide%2Flauncher) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkolide%2Flauncher)
* [Star
   511](/login?return_to=%2Fkolide%2Flauncher)

* [Code](/kolide/launcher)
* [Issues
  96](/kolide/launcher/issues)
* [Pull requests
  13](/kolide/launcher/pulls)
* [Actions](/kolide/launcher/actions)
* [Security](/kolide/launcher/security)
* [Insights](/kolide/launcher/pulse)

Additional navigation options

* [Code](/kolide/launcher)
* [Issues](/kolide/launcher/issues)
* [Pull requests](/kolide/launcher/pulls)
* [Actions](/kolide/launcher/actions)
* [Security](/kolide/launcher/security)
* [Insights](/kolide/launcher/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkolide%2Flauncher%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkolide%2Flauncher%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# update windows data dir installation #1510

 Merged

[zackattack01](/zackattack01)
merged 6 commits into
[main](/kolide/launcher/tree/main "kolide/launcher:main")
from
[zack/windows\_install\_datadir](/kolide/launcher/tree/zack/windows_install_datadir "kolide/launcher:zack/windows_install_datadir")

Feb 8, 2024

 Merged

# [update windows data dir installation](#top) #1510

[zackattack01](/zackattack01)
merged 6 commits into
[main](/kolide/launcher/tree/main "kolide/launcher:main")
from
[zack/windows\_install\_datadir](/kolide/launcher/tree/zack/windows_install_datadir "kolide/launcher:zack/windows_install_datadir")

Feb 8, 2024

[Conversation
10](/kolide/launcher/pull/1510)
[Commits
6](/kolide/launcher/pull/1510/commits)
[Checks
25](/kolide/launcher/pull/1510/checks)
[Files changed](/kolide/launcher/pull/1510/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![zackattack01](https://avatars.githubusercontent.com/u/11861408?s=60&v=4)](/zackattack01)

Copy link

Contributor

### @zackattack01 **[zackattack01](/zackattack01)** commented [Dec 12, 2023](#issue-2038309345) • edited Loading

There are two pieces to this update:

1. breaks the windows installation out into:

* `C:\Program Files\Kolide\Launcher-[IDENTIFIER]\`
  + Still contains the `bin` and `conf` directories
* `C:\ProgramData\Kolide\Launcher-[IDENTIFIER]\`
  + Now contains the `data` directory
  + Still functions as the `rootDir`, containing all updates

2. creates an empty `launcher.db` file in the `data` directory

* doing this (along with any other files we want to add for cleanup) before the harvest tool (heat.exe) is run ensures that the launcher.db is cleaned up when an uninstall is initiated

Ideally we would integrate the wix [RemoveFolderEx](https://wixtoolset.org/docs/v3/xsd/util/removefolderex/) util extension into the wix-generated files (along with some registry updates) to achieve full cleanup, but this did not work as advertised after several attempts. Our cleanup complications come from arbitrarily nested directories containing filenames which are unknown at the time of harvest (e.g. rotated logs, updates, etc.). But because we are specifically concerned with the launcher.db cleanup, ensuring that file is present is enough for forward progress here.

Another option we can look into in the future if additional cleanup is needed is the wix [CustomAction](https://wixtoolset.org/docs/schema/wxs/customaction/) element. There are some reports of successful cleanup on this type of install structure using a separate removal script via CustomAction.

Including a quick logical overview of the changes here because it took me a bit to understand how wix works and how we integrate it within the build process - note that this is especially confusing because wix operates off of relative paths, expanded internally at build time, while the linux and darwin build processes are able to nest full paths within their respective root build directories back at the level of pkg/packaging/packaging.go. This makes it difficult to cleanly share as much logic as we would like between platform builds, and largely shaped this approach methodology in order to prevent excessive changes within the linux/darwin builds.

* within pkg/packaging/packaging.go, we needed to ensure the windows rootDir would point at ProgramData (see `canonicalizeRootDir` for the flag file generation
  + we also needed to prevent the data (root) dir from being created at this level for MSI targets to give the logic in pkg/pkgkit/wix/wix.go the chance to set up a separate data directory for harvest (in `ProgramData`)
* within pkg/pkgkit/wix/wix.go, we set up this directory and add any additional files we want to be included in the registry for cleanup on uninstall
  + we then run heat for `DATADIR` (expanded by wix into the `ProgramData` directory) with our pre-created file stubs, and include the newly generated component group from the main wix template

### Testing

To test locally (outside of CI builds) I'd recommend using git bash to build on a windows machine directly (otherwise you will need to make some modifications to the commands below).

Navigate to your launcher directory within git bash and pull down this branch. Most build setup should be identical to other platforms (i.e. `make deps && make`).

Note your existing enroll secret and replace in the command below: `cat C:/Program\ Files/Kolide/Launcher-kolide-k2/conf/secret`

Run the following to build an MSI for local installation:

```
./build/package-builder.exe make -debug=true -transport=jsonrpc -hostname=k2device-preprod.kolide.com -output_dir=./build/ -identifier=kolide-k2 -launcher_version=./build/launcher.exe -enroll_secret="<TAKEN_FROM_ABOVE>" -i-am-a-kolide-customer

```

Uninstall your existing Launcher installation from Control-Panel and ensure a fresh installation by removing all of `C:/Program\ Files/Kolide`.

Your new build for testing should be installable from `./build/launcher.windows-service-msi.msi`

Sorry, something went wrong.

All reactions

[![github-advanced-security[bot]](https://avatars.githubusercontent.com/in/57789?s=60&v=4)](/apps/github-advanced-security)

**[github-advanced-security](/apps/github-advanced-security)
bot**
found potential problems
[Dec 12, 2023](#pullrequestreview-1778166877)

 [View reviewed changes](/kolide/launcher/pull/1510/files)

[pkg/packagekit/wix/wix.go](/kolide/launcher/pull/1510/files#diff-584788c5bcdb8837ee9cfa3af914b8919c98eff88bfe0c056747a85dbd746be3)
Fixed

Show fixed

Hide fixed

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
[force-pushed](/kolide/launcher/compare/35b2b4c15e587b7828cec72cf20d1fd629d3c872..48ee53ae67f0c74a80ad59f5e7feff8e20ecdb32)
the
zack/windows\_install\_datadir

branch
from
[`35b2b4c`](/kolide/launcher/commit/35b2b4c15e587b7828cec72cf20d1fd629d3c872) to
[`48ee53a`](/kolide/launcher/commit/48ee53ae67f0c74a80ad59f5e7feff8e20ecdb32)  [Compare](/kolide/launcher/compare/35b2b4c15e587b7828cec72cf20d1fd629d3c872..48ee53ae67f0c74a80ad59f5e7feff8e20ecdb32)
[December 12, 2023 18:58](#event-11227560550)

[![directionless](https://avatars.githubusercontent.com/u/179542?s=60&v=4)](/directionless)

**[directionless](/directionless)**
reviewed
[Dec 13, 2023](#pullrequestreview-1779729884)

 [View reviewed changes](/kolide/launcher/pull/1510/files)

[pkg/packagekit/wix/wix.go](/kolide/launcher/pull/1510/files#diff-584788c5bcdb8837ee9cfa3af914b8919c98eff88bfe0c056747a85dbd746be3)
Outdated

Comment on lines
266
 to
267

|  |  | // touch these known file names before harvest to ensure they're cleaned up on uninstall |
| --- | --- | --- |
|  |  | dataFilenames := []string{"launcher.db", "metadata.json"} |

Copy link

Contributor

### @directionless **[directionless](/directionless)** [Dec 13, 2023](#discussion_r1425410948)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

note to self -- think about this

Sorry, something went wrong.

All reactions

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
marked this pull request as ready for review
[December 21, 2023 12:18](#event-11314764388)

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
changed the title
~~draft windows data dir installation~~
update windows data dir installation
[Dec 21, 2023](#event-11314784970)

[![@CLAassistant](https://avatars.githubusercontent.com/u/11571300?s=80&u=04709ab66059d1fb5246ce2d47bd3bc44e639ee0&v=4)](/CLAassistant)

Copy link

### **[CLAassistant](/CLAassistant)** commented [Dec 22, 2023](#issuecomment-1868046425) • edited Loading

| [CLA assistant check](https://cla-assistant.io/kolide/launcher?pullRequest=1510) All committers have signed the CLA. |
| --- |

All reactions

Sorry, something went wrong.

[![directionless](https://avatars.githubusercontent.com/u/179542?s=60&v=4)](/directionless)

**[directionless](/directionless)**
reviewed
[Jan 12, 2024](#pullrequestreview-1818200698)

 [View reviewed changes](/kolide/launcher/pull/1510/files)

Copy link

Contributor

### @directionless **[directionless](/directionless)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think this is probably correct, and I love how small it is.

How should we test this? We could build some nabalu packages with the branch maybe

Sorry, something went wrong.

All reactions

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
[force-pushed](/kolide/launcher/compare/537e4705ace0f650792acdc2214d6ef3cd66f52f..0a8d5f623cc04c9ea06be31fe5e7be1046032054)
the
zack/windows\_install\_datadir

branch
from
[`537e470`](/kolide/launcher/commit/537e4705ace0f650792acdc2214d6ef3cd66f52f) to
[`0a8d5f6`](/kolide/launcher/commit/0a8d5f623cc04c9ea06be31fe5e7be1046032054)  [Compare](/kolide/launcher/compare/537e4705ace0f650792acdc2214d6ef3cd66f52f..0a8d5f623cc04c9ea06be31fe5e7be1046032054)
[February 1, 2024 16:57](#event-11672995401)

 [zackattack01](/zackattack01)
added 5 commits
[February 6, 2024 11:26](#commits-pushed-5543df1)

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[working with smaller changeset](/kolide/launcher/pull/1510/commits/5543df1fcc6f286b7d9167e15d3681b62d98b714 "working with smaller changeset")`

`[5543df1](/kolide/launcher/pull/1510/commits/5543df1fcc6f286b7d9167e15d3681b62d98b714)`

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[fix setupDataDir to return err](/kolide/launcher/pull/1510/commits/de872b0dd072108d5f448656db2e1661feb65512 "fix setupDataDir to return err")`

`[de872b0](/kolide/launcher/pull/1510/commits/de872b0dd072108d5f448656db2e1661feb65512)`

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[wire identifier through base packaging logic to wix](/kolide/launcher/pull/1510/commits/4eecce4974aa6cb2aa00b3ae3e0bcf95922da1b6 "wire identifier through base packaging logic to wix")`

`[4eecce4](/kolide/launcher/pull/1510/commits/4eecce4974aa6cb2aa00b3ae3e0bcf95922da1b6)`

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[fix lint](/kolide/launcher/pull/1510/commits/ed50d0782b841e2a3012875517e6597a074e452f "fix lint")`

`[ed50d07](/kolide/launcher/pull/1510/commits/ed50d0782b841e2a3012875517e6597a074e452f)`

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[add kv.sqlite to data file cleanup](/kolide/launcher/pull/1510/commits/9e2bc43f862484d7b78c5e8206dd617e14368d75 "add kv.sqlite to data file cleanup")`

`[9e2bc43](/kolide/launcher/pull/1510/commits/9e2bc43f862484d7b78c5e8206dd617e14368d75)`

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
[force-pushed](/kolide/launcher/compare/0a8d5f623cc04c9ea06be31fe5e7be1046032054..9e2bc43f862484d7b78c5e8206dd617e14368d75)
the
zack/windows\_install\_datadir

branch
from
[`0a8d5f6`](/kolide/launcher/commit/0a8d5f623cc04c9ea06be31fe5e7be1046032054) to
[`9e2bc43`](/kolide/launcher/commit/9e2bc43f862484d7b78c5e8206dd617e14368d75)  [Compare](/kolide/launcher/compare/0a8d5f623cc04c9ea06be31fe5e7be1046032054..9e2bc43f862484d7b78c5e8206dd617e14368d75)
[February 6, 2024 16:28](#event-11720895809)

[![RebeccaMahany](https://avatars.githubusercontent.com/u/8119675?s=60&v=4)](/RebeccaMahany)

**[RebeccaMahany](/RebeccaMahany)**
previously approved these changes
[Feb 6, 2024](#pullrequestreview-1866205253)

 [View reviewed changes](/kolide/launcher/pull/1510/files/9e2bc43f862484d7b78c5e8206dd617e14368d75)

[pkg/packagekit/wix/wix.go](/kolide/launcher/pull/1510/files/9e2bc43f862484d7b78c5e8206dd617e14368d75#diff-584788c5bcdb8837ee9cfa3af914b8919c98eff88bfe0c056747a85dbd746be3)

|  |  | wo.cleanDirs = append(wo.cleanDirs, wo.packageDataRoot) |
| --- | --- | --- |
|  |  |  |
|  |  | fullIdentifier := fmt.Sprintf("Launcher-%s", wo.identifier) |
|  |  | dataFilesPath := filepath.Join(wo.packageDataRoot, fullIdentifier, "data") |

Copy link

Contributor

### @RebeccaMahany **[RebeccaMahany](/RebeccaMahany)** [Feb 6, 2024](#discussion_r1480467155)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Probably a good idea to update the default value here <https://github.com/kolide/launcher/blob/main/pkg/launcher/paths.go#L42> also?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @zackattack01 **[zackattack01](/zackattack01)** [Feb 7, 2024](#discussion_r1481601949)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

will do!

Sorry, something went wrong.

All reactions

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&v=4)](/zackattack01)

`[update default root directory for windows paths](/kolide/launcher/pull/1510/commits/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75 "update default root directory for windows paths")`

`[c9d34b4](/kolide/launcher/pull/1510/commits/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75)`

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
dismissed
[RebeccaMahany](/RebeccaMahany)’s [stale review](#pullrequestreview-1866205253)
via
`[c9d34b4](/kolide/launcher/commit/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75)`
[February 7, 2024 15:00](#event-11733666274)

[![RebeccaMahany](https://avatars.githubusercontent.com/u/8119675?s=60&v=4)](/RebeccaMahany)

**[RebeccaMahany](/RebeccaMahany)**
approved these changes
[Feb 7, 2024](#pullrequestreview-1868102947)

 [View reviewed changes](/kolide/launcher/pull/1510/files/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75)

Copy link

Contributor

### @RebeccaMahany **[RebeccaMahany](/RebeccaMahany)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM, thank you for the documentation in the code + in the PR description

Sorry, something went wrong.

All reactions

[![James-Pickett](https://avatars.githubusercontent.com/u/8415811?s=60&v=4)](/James-Pickett)

**[James-Pickett](/James-Pickett)**
reviewed
[Feb 7, 2024](#pullrequestreview-1868537339)

 [View reviewed changes](/kolide/launcher/pull/1510/files/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75)

[pkg/launcher/paths.go](/kolide/launcher/pull/1510/files/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75#diff-0a0910ae4a05425c272c9b61a248b8824bc69688c19941568718653888962764)

|  |  | @@ -39,7 +39,7 @@ func DefaultPath(path defaultPath) string { | |
| --- | --- | --- | --- |
|  |  | if runtime.GOOS == "windows" { |
|  |  | switch path { |
|  |  | case RootDirectory: |
|  |  | return "C:\\Program Files\\Kolide\\Launcher-kolide-k2\\data" |
|  |  | return "C:\\ProgramData\\Kolide\\Launcher-kolide-k2\\data" |

Copy link

Contributor

### @James-Pickett **[James-Pickett](/James-Pickett)** [Feb 7, 2024](#discussion_r1481932117)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

how is this going to work with existing installations? Do we need to do some kind of migration or peek at old dir first?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @zackattack01 **[zackattack01](/zackattack01)** [Feb 7, 2024](#discussion_r1482066113)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

this was a recent change I can re-run some tests with to verify- but with prior testing this has always worked out regardless of existing/new installation because only the new installations have the new path in launcher.flags

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @James-Pickett **[James-Pickett](/James-Pickett)** [Feb 7, 2024](#discussion_r1482075097)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ohh duh =) ... yea, I forgot this was assigned in launcher.flags

Sorry, something went wrong.

All reactions

[![James-Pickett](https://avatars.githubusercontent.com/u/8415811?s=60&v=4)](/James-Pickett)

**[James-Pickett](/James-Pickett)**
approved these changes
[Feb 7, 2024](#pullrequestreview-1868766861)

 [View reviewed changes](/kolide/launcher/pull/1510/files/c9d34b4a99ba8f09537bca51cf92c96ef5bf6d75)

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
added this pull request to the [merge queue](/kolide/launcher/queue/main)
[Feb 8, 2024](#event-11747796517)

 Hide details
View details

Merged
via the queue into
main

with commit [`18ea1da`](/kolide/launcher/commit/18ea1dab2f0dcb558209329f033dba1a4d1c5a97)
[Feb 8, 2024](https://github.com/kolide/launcher/pull/1510#event-11748028746)
26 checks passed

 [![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=40&u=7065795a96f6b692d1e6a35adb36a6eaa114cd09&v=4)](/zackattack01)
[zackattack01](/zackattack01)
deleted the
zack/windows\_install\_datadir

branch
[February 8, 2024 16:06](#event-11748029037)

[![@directionless](https://avatars.githubusercontent.com/u/179542?s=40&v=4)](/directionless)
[directionless](/directionless)
mentioned this pull request
[Feb 15, 2024](#ref-issue-1673259038)

[Windows install places data in `C:\Program Files\Kolide\Launcher-kolide-k2` and not somewhere more appropriate
#1143](/kolide/launcher/issues/1143)

Closed

This was referenced Dec 3, 2024

[x/vulndb: potential Go vuln in github.com/kolide/launcher: GHSA-66q9-2rvx-qfj5
golang/vulndb#3308](/golang/vulndb/issues/3308)

Closed

[x/vulndb: potential Go vuln in github.com/kolide/launcher: CVE-2024-54131
golang/vulndb#3309](/golang/vulndb/issues/3309)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolide%2Flauncher%2Fpull%2F1510)

Reviewers

[![@directionless](https://avatars.githubusercontent.com/u/179542?s=40&v=4)](/directionless) [directionless](/directionless)

directionless left review comments

[![@James-Pickett](https://avatars.githubusercontent.com/u/8415811?s=40&v=4)](/James-Pickett) [James-Pickett](/James-Pickett)

James-Pickett approved these changes

[![@RebeccaMahany](https://avatars.githubusercontent.com/u/8119675?s=40&v=4)](/RebeccaMahany) [RebeccaMahany](/RebeccaMahany)

RebeccaMahany approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@zackattack01](https://avatars.githubusercontent.com/u/11861408?s=52&v=4)](/zackattack01) [![@CLAassistant](https://avatars.githubusercontent.com/u/11571300?s=52&v=4)](/CLAassistant) [![@directionless](https://avatars.githubusercontent.com/u/179542?s=52&v=4)](/directionless) [![@RebeccaMahany](https://avatars.githubusercontent.com/u/8119675?s=52&v=4)](/RebeccaMahany) [![@James-Pickett](https://avatars.githubusercontent.com/u/8415811?s=52&v=4)](/James-Pickett)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


