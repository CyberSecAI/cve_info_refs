Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The vulnerability stems from the `cjwt` library's failure to enforce a strict distinction between symmetric (HMAC-SHA) and asymmetric (RSA, EC, PS) key types when verifying JWT signatures. This allows an attacker to use a public key as a secret key for HMAC algorithms, thereby forging valid signatures.

**Weaknesses/vulnerabilities present:**
- **Algorithm Confusion:** The library does not properly validate if the signing algorithm used in the JWT matches the expected key type. Specifically, the library allows a public key to be used as a secret key for HMAC algorithms (HS256, HS384, HS512).
- **Lack of Key Type Validation:** The library does not force the caller to specify whether they expect a symmetric or asymmetric key type.

**Impact of exploitation:**
- **Signature Bypass:** An attacker can forge JWT signatures by using the public key as the secret key for an HMAC algorithm, bypassing the intended security mechanism.
- **Unauthorized Access:** If an application relies on asymmetrically signed tokens and uses the vulnerable library, an attacker can gain unauthorized access by providing a crafted token.

**Attack vectors:**
- The attacker crafts a JWT with the `alg` header set to a symmetric algorithm (e.g., "HS256"), even though the server expects an asymmetric algorithm (e.g., "RS256").
- The attacker then uses the public key intended for asymmetric signature verification as the secret key for HMAC signature generation, which results in a valid signature given the flawed library logic.
- The server uses the provided public key to verify the signature as if it were a secret key, incorrectly validating the forged signature.

**Required attacker capabilities/position:**
- The attacker needs to know or obtain a public key that is meant to be used with an asymmetric algorithm.
- The attacker must be able to craft a JWT with a chosen header and payload.
- The attacker does not need to be in a privileged network position, as the vulnerability is within the logic of the library itself.

**Additional Notes:**

- The fix requires the caller to declare if they expect a symmetric cypher or not, using the `OPT_ALLOW_ONLY_HS_ALG` option.
- The `cjwt_decode` function now requires the caller to specify `OPT_ALLOW_ONLY_HS_ALG` if they intend to use an HMAC algorithm. This forces the developer to explicitly enable symmetric algorithms and prevents using the public key as a secret key.
- The provided proof-of-concept (PoC) code demonstrates how to exploit this vulnerability by using a public key to generate a valid HMAC signature.
- The `test_cjwt.c` file shows that tests have been modified to incorporate the new option for allowing only HS algorithms.
- The code changes include modifying the `alg_map` struct to include a `symmetric` bool, which helps determine whether the key is intended for an HS algorithm or not, thus enforcing the correct behavior by default.