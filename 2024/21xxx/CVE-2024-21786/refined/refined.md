- **Root cause of vulnerability**: The vulnerability stems from the lack of proper sanitization of the `filename` parameter in the HTTP request, which is then directly injected into an OS command. Specifically, the file extension extracted from the filename is used in the command without any validation, leading to command injection.
- **Weaknesses/vulnerabilities present**: OS command injection (CWE-78). The application does not sanitize the filename parameter, specifically the file extension, before using it in an OS command, allowing an attacker to inject arbitrary commands.
- **Impact of exploitation**: Successful exploitation leads to arbitrary command execution with root privileges on the affected device. This could allow an attacker to take complete control of the device, potentially leading to data breaches, system disruption, or other malicious activities.
- **Attack vectors**: The attack vector is an authenticated HTTP request to the `/cgi-bin/p/adm/cfg` endpoint, with a `multipart/form-data` content type. The attacker crafts a `filename` parameter that includes malicious OS commands embedded within the file extension.
- **Required attacker capabilities/position**: The attacker must be authenticated to access the web interface of the MC Technologies MC LR Router. The attacker needs to be able to craft and send HTTP POST requests to the vulnerable endpoint.