```
{
  "cve": "CVE-2024-21626",
  "description": "runc 1.1.11 and earlier has an internal file descriptor leak that can lead to container breakouts. The leaked file descriptor can be used to access the host filesystem by setting the container's working directory to a path resolved through the file descriptor. This allows for container escapes through `runc exec` or by using a malicious image. Additionally, the same mechanism can be used to overwrite host binaries.",
  "affected_versions": ">=v1.0.0-rc93,<=1.1.11",
  "fixed_versions": "1.1.12",
  "root_cause": "An internal file descriptor leak in runc, specifically a handle to the host's `/sys/fs/cgroup`, combined with insufficient validation of the working directory and missing file descriptor closing before `execve`.",
  "vulnerabilities": [
    "File descriptor leak",
     "Insufficient working directory validation",
     "Missing file descriptor closing before `execve`"
  ],
    "impact": "Container breakout, access to host filesystem, host binary overwrite and potential full control of the host system.",
  "attack_vectors": [
    "`runc run` with a malicious image",
    "`runc exec` with a crafted `--cwd` argument",
	"Overwriting host binaries using leaked file descriptors"
  ],
  "attacker_capabilities": "For attacks involving `runc run`, the attacker needs to trick a privileged user to run a malicious container image. For `runc exec` attacks, the attacker needs access to a container and knowledge of a path to target, which can often be predicted.",
  "additional_info": "The vulnerability allows different attack scenarios that can lead to full container breakout. `runc` did not check if the working directory was inside the container after `chdir(2)`. The `execve` attack uses a magic-link reference to overwrite host binaries. Patches include checking if the working directory is inside the container and marking all non-stdio file descriptors as `O_CLOEXEC`. Other container runtimes like crun, youki and lxc are also potentially vulnerable, but require a file descriptor leak to exploit."
}
```