=== Content from github.com_5cda9bf6_20250114_192210.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fsecurity%2Fadvisories%2FGHSA-pvcr-v8j8-j5q3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fsecurity%2Fadvisories%2FGHSA-pvcr-v8j8-j5q3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=lestrrat-go%2Fjwx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lestrrat-go](/lestrrat-go)
/
**[jwx](/lestrrat-go/jwx)**
Public

* [Notifications](/login?return_to=%2Flestrrat-go%2Fjwx) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Flestrrat-go%2Fjwx)
* [Star
   2k](/login?return_to=%2Flestrrat-go%2Fjwx)

* [Code](/lestrrat-go/jwx)
* [Issues
  4](/lestrrat-go/jwx/issues)
* [Pull requests
  5](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects
  0](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

Additional navigation options

* [Code](/lestrrat-go/jwx)
* [Issues](/lestrrat-go/jwx/issues)
* [Pull requests](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

# Parsing JSON serialized payload without protected field can lead to panic

Moderate

[lestrrat](/lestrrat)
published
GHSA-pvcr-v8j8-j5q3
Jan 9, 2024

## Package

gomod

github.com/lestrrat-go/jwx/v2/jws
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= v2.0.18
<= v1.2.27

## Patched versions

v2.0.19
v1.2.28

## Description

### Summary

Calling `jws.Parse` with a JSON serialized payload where the `signature` field is present while `protected` is absent can lead to a nil pointer dereference.

### Details

This seems to also affect other functions that calls `Parse` internally, like `jws.Verify`.

My understanding of these functions from the docs is that they are supposed to fail gracefully on invalid input and don't require any prior validation.

Based on the stack trace in the PoC, the issue seems to be that the processing done in `jws/message.go:UnmarshalJSON()` assumes that if a `signature` field is present, then a `protected` field is also present. If this is not the case, then the subsequent call to `getB64Value(sig.protected)` will dereference `sig.protected`, which is `nil`.

### PoC

Reproducer:

```
package poc

import (
        "testing"

        "github.com/lestrrat-go/jwx/v2/jws"
)

func TestPOC(t *testing.T) {
        _, _ = jws.Parse([]byte(`{"signature": ""}`))
}
```

Result:

```
$ go test
--- FAIL: TestPOC (0.00s)
panic: runtime error: invalid memory address or nil pointer dereference [recovered]
        panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x40 pc=0x5fd618]

goroutine 6 [running]:
testing.tRunner.func1.2({0x628800, 0x831030})
        /usr/local/go/src/testing/testing.go:1545 +0x238
testing.tRunner.func1()
        /usr/local/go/src/testing/testing.go:1548 +0x397
panic({0x628800?, 0x831030?})
        /usr/local/go/src/runtime/panic.go:914 +0x21f
github.com/lestrrat-go/jwx/v2/jws.getB64Value({0x0?, 0x0?})
        /home/fredrik/go/pkg/mod/github.com/lestrrat-go/jwx/v2@v2.0.18/jws/jws.go:484 +0x18
github.com/lestrrat-go/jwx/v2/jws.(*Message).UnmarshalJSON(0xc0000a2140, {0xc0000ec000, 0x11, 0x200})
        /home/fredrik/go/pkg/mod/github.com/lestrrat-go/jwx/v2@v2.0.18/jws/message.go:323 +0x4ad
encoding/json.(*decodeState).object(0xc0000ea028, {0x64fa60?, 0xc0000a2140?, 0x16?})
        /usr/local/go/src/encoding/json/decode.go:604 +0x6cc
encoding/json.(*decodeState).value(0xc0000ea028, {0x64fa60?, 0xc0000a2140?, 0xc00006e630?})
        /usr/local/go/src/encoding/json/decode.go:374 +0x3e
encoding/json.(*decodeState).unmarshal(0xc0000ea028, {0x64fa60?, 0xc0000a2140?})
        /usr/local/go/src/encoding/json/decode.go:181 +0x133
encoding/json.(*Decoder).Decode(0xc0000ea000, {0x64fa60, 0xc0000a2140})
        /usr/local/go/src/encoding/json/stream.go:73 +0x179
github.com/lestrrat-go/jwx/v2/internal/json.Unmarshal({0xc00001a288, 0x11, 0x11}, {0x64fa60, 0xc0000a2140})
        /home/fredrik/go/pkg/mod/github.com/lestrrat-go/jwx/v2@v2.0.18/internal/json/json.go:26 +0x97
github.com/lestrrat-go/jwx/v2/jws.parseJSON({0xc00001a288, 0x11, 0x11})
        /home/fredrik/go/pkg/mod/github.com/lestrrat-go/jwx/v2@v2.0.18/jws/jws.go:588 +0x50
github.com/lestrrat-go/jwx/v2/jws.Parse({0xc00001a288, 0x11, 0x11}, {0x0?, 0xc00006e760?, 0x48450f?})
        /home/fredrik/go/pkg/mod/github.com/lestrrat-go/jwx/v2@v2.0.18/jws/jws.go:525 +0x89
poc.TestPOC(0x0?)
        /home/fredrik/src/jwx_poc/poc_test.go:10 +0x57
testing.tRunner(0xc0000e4340, 0x68ef30)
        /usr/local/go/src/testing/testing.go:1595 +0xff
created by testing.(*T).Run in goroutine 1
        /usr/local/go/src/testing/testing.go:1648 +0x3ad
exit status 2
FAIL    poc     0.005s

```
### Impact

The vulnerability can be used to crash / DOS a system doing JWS verification.

### Severity

Moderate

4.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L

### CVE ID

CVE-2024-21664

### Weaknesses

No CWEs

### Credits

* [![@frestr](https://avatars.githubusercontent.com/u/7038699?s=40&v=4)](/frestr)
  [frestr](/frestr)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a915e133_20250114_192205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F0e8802ce6842625845d651456493e7c87625601f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F0e8802ce6842625845d651456493e7c87625601f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lestrrat-go%2Fjwx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lestrrat-go](/lestrrat-go)
/
**[jwx](/lestrrat-go/jwx)**
Public

* [Notifications](/login?return_to=%2Flestrrat-go%2Fjwx) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Flestrrat-go%2Fjwx)
* [Star
   2k](/login?return_to=%2Flestrrat-go%2Fjwx)

* [Code](/lestrrat-go/jwx)
* [Issues
  4](/lestrrat-go/jwx/issues)
* [Pull requests
  5](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects
  0](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

Additional navigation options

* [Code](/lestrrat-go/jwx)
* [Issues](/lestrrat-go/jwx/issues)
* [Pull requests](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

## Commit

[Permalink](/lestrrat-go/jwx/commit/0e8802ce6842625845d651456493e7c87625601f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-pvcr-v8j8-j5q3](https://github.com/advisories/GHSA-pvcr-v8j8-j5q3 "GHSA-pvcr-v8j8-j5q3")

[Browse files](/lestrrat-go/jwx/tree/0e8802ce6842625845d651456493e7c87625601f)
Browse the repository at this point in the history

```
* Add tests for empty protected headers

* check for sig.protected == nil

* Add one more case for missing protected headers in compact form

* Update Changes

* JWS: Check for sig.protected == nil on non-flattened input

---------

Co-authored-by: Fredrik Strupe <fredrik@strupe.net>
```

* Loading branch information

[![@lestrrat](https://avatars.githubusercontent.com/u/49281?s=40&v=4)](/lestrrat) [![@frestr](https://avatars.githubusercontent.com/u/7038699?s=40&v=4)](/frestr)

[lestrrat](/lestrrat-go/jwx/commits?author=lestrrat "View all commits by lestrrat")
and
[frestr](/lestrrat-go/jwx/commits?author=frestr "View all commits by frestr")
authored
Jan 9, 2024

1 parent
[ea70886](/lestrrat-go/jwx/commit/ea7088668dcd8b6e22d1d3d31d341fb95451c0f1)

commit 0e8802c

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**72 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changes
  [Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2)
* jws

  + jws/jws\_test.go
    [jws\_test.go](#diff-01fafce91c0a9808b43a3370f8af5801149a0418e1d5ac38f883d20bb182c095)
  + jws/message.go
    [message.go](#diff-53147420851a4a4017650d24d6176ea4a4157d83ef39f852ed74c1c07bc8b27b)

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2 "Changes")

Show comments

[View file](/lestrrat-go/jwx/blob/0e8802ce6842625845d651456493e7c87625601f/Changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,16 @@ v2.0.19 UNRELEASED |
|  |  | was caused by actual verification step or something else, for example, while fetching |
|  |  | a key from datasource |
|  |  |  |
|  |  | [Security Fixes] |
|  |  | \* [jws] JWS messages formated in full JSON format (i.e. not the compact format, which |
|  |  | consists of three base64 strings concatenated with a '.') with missing "protected" |
|  |  | headers could cause a panic, thereby introducing a possiblity of a DoS. |
|  |  |  |
|  |  | This has been fixed so that the `jws.Parse` function succeeds in parsing a JWS message |
|  |  | lacking a protected header. Calling `jws.Verify` on this same JWS message will result |
|  |  | in a failed verification attempt. Note that this behavior will differ slightly when |
|  |  | parsing JWS messages in compact form, which result in an error. |
|  |  |  |
|  |  | v2.0.18 03 Dec 2023 |
|  |  | [Security Fixes] |
|  |  | \* [jwe] A large number in p2c parameter for PBKDF2 based encryptions could cause a DoS attack, |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[jws/jws\_test.go](#diff-01fafce91c0a9808b43a3370f8af5801149a0418e1d5ac38f883d20bb182c095 "jws/jws_test.go")

Show comments

[View file](/lestrrat-go/jwx/blob/0e8802ce6842625845d651456493e7c87625601f/jws/jws_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1835,3 +1835,55 @@ func TestValidateKey(t \*testing.T) { |
|  |  | \_, err = jws.Verify(signed, jws.WithKey(jwa.RS256, pubKey), jws.WithValidateKey(true)) |
|  |  | require.NoError(t, err, `jws.Verify should succeed`) |
|  |  | } |
|  |  |  |
|  |  | func TestEmptyProtectedField(t \*testing.T) { |
|  |  | // MEMO: this was the only test case from the original report |
|  |  | // This passes. It should produce an invalid JWS message, but |
|  |  | // that's not `jws.Parse`'s problem. |
|  |  | \_, err := jws.Parse([]byte(`{"signature": ""}`)) |
|  |  | require.NoError(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // Also test that non-flattened serialization passes. |
|  |  | \_, err = jws.Parse([]byte(`{"signatures": [{}]}`)) |
|  |  | require.NoError(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // MEMO: rest of the cases are present to be extra pedantic about it |
|  |  |  |
|  |  | privKey, err := jwxtest.GenerateRsaJwk() |
|  |  | require.NoError(t, err, `jwxtest.GenerateRsaJwk should succeed`) |
|  |  |  |
|  |  | // This fails. `jws.Parse` works, but the subsequent verification |
|  |  | // workflow fails to verify anything without the presense of a signature or |
|  |  | // a protected header. |
|  |  | \_, err = jws.Verify([]byte(`{"signature": ""}`), jws.WithKey(jwa.RS256, privKey)) |
|  |  | require.Error(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // Create a valid signatre. |
|  |  | signed, err := jws.Sign([]byte("Lorem Ipsum"), jws.WithKey(jwa.RS256, privKey)) |
|  |  | require.NoError(t, err, `jws.Sign should succeed`) |
|  |  |  |
|  |  | \_, payload, signature, err := jws.SplitCompact(signed) |
|  |  | require.NoError(t, err, `jws.SplitCompact should succeed`) |
|  |  |  |
|  |  | // This fails as well. we have a valid signature and a valid |
|  |  | // key to verify it, but no protected headers |
|  |  | \_, err = jws.Verify( |
|  |  | []byte(fmt.Sprintf(`{"signature": "%s"}`, signature)), |
|  |  | jws.WithKey(jwa.RS256, privKey), |
|  |  | ) |
|  |  | require.Error(t, err, `jws.Verify should fail`) |
|  |  |  |
|  |  | // Test for cases when we have an incomplete compact form JWS |
|  |  | var buf bytes.Buffer |
|  |  | buf.WriteRune('.') |
|  |  | buf.Write(payload) |
|  |  | buf.WriteRune('.') |
|  |  | buf.Write(signature) |
|  |  | invalidMessage := buf.Bytes() |
|  |  |  |
|  |  | // This is an error because the format is simply wrong. |
|  |  | // Whereas in the other JSON-based JWS's case the lack of protected field |
|  |  | // is not a SYNTAX error, this one is, and therefore we barf. |
|  |  | \_, err = jws.Parse(invalidMessage) |
|  |  | require.Error(t, err, `jws.Parse should fail`) |
|  |  | } |

10 changes: 10 additions & 0 deletions

10
[jws/message.go](#diff-53147420851a4a4017650d24d6176ea4a4157d83ef39f852ed74c1c07bc8b27b "jws/message.go")

Show comments

[View file](/lestrrat-go/jwx/blob/0e8802ce6842625845d651456493e7c87625601f/jws/message.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -278,6 +278,11 @@ func (m \*Message) UnmarshalJSON(buf []byte) error { |
|  |  | } |
|  |  | sig.SetDecodeCtx(nil) |
|  |  |  |
|  |  | if sig.protected == nil { |
|  |  | // Instead of barfing on a nil protected header, use an empty header |
|  |  | sig.protected = NewHeaders() |
|  |  | } |
|  |  |  |
|  |  | if i == 0 { |
|  |  | if !getB64Value(sig.protected) { |
|  |  | b64 = false |
| Expand Down  Expand Up | | @@ -313,6 +318,11 @@ func (m \*Message) UnmarshalJSON(buf []byte) error { |
|  |  | sig.protected = prt |
|  |  | } |
|  |  |  |
|  |  | if sig.protected == nil { |
|  |  | // Instead of barfing on a nil protected header, use an empty header |
|  |  | sig.protected = NewHeaders() |
|  |  | } |
|  |  |  |
|  |  | decoded, err := base64.DecodeString(\*mup.Signature) |
|  |  | if err != nil { |
|  |  | return fmt.Errorf(`failed to base64 decode flattened signature: %w`, err) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0e8802c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F0e8802ce6842625845d651456493e7c87625601f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bc1c2d45_20250114_192209.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2Fd69a721931a5c48b9850a42404f18e143704adcd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2Fd69a721931a5c48b9850a42404f18e143704adcd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lestrrat-go%2Fjwx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lestrrat-go](/lestrrat-go)
/
**[jwx](/lestrrat-go/jwx)**
Public

* [Notifications](/login?return_to=%2Flestrrat-go%2Fjwx) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Flestrrat-go%2Fjwx)
* [Star
   2k](/login?return_to=%2Flestrrat-go%2Fjwx)

* [Code](/lestrrat-go/jwx)
* [Issues
  4](/lestrrat-go/jwx/issues)
* [Pull requests
  5](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects
  0](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

Additional navigation options

* [Code](/lestrrat-go/jwx)
* [Issues](/lestrrat-go/jwx/issues)
* [Pull requests](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

## Commit

[Permalink](/lestrrat-go/jwx/commit/d69a721931a5c48b9850a42404f18e143704adcd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

v2.0.19 ([#1051](https://github.com/lestrrat-go/jwx/pull/1051))

[Browse files](/lestrrat-go/jwx/tree/d69a721931a5c48b9850a42404f18e143704adcd)
Browse the repository at this point in the history

```
* Bump golang.org/x/crypto from 0.14.0 to 0.15.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.14.0 to 0.15.0.
- [Commits]([golang/crypto@v0.14.0...v0.15.0](https://github.com/golang/crypto/compare/v0.14.0...v0.15.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run gazelle-update-repos

* Add jwe.WithCEK ([#1011](https://github.com/lestrrat-go/jwx/pull/1011))

* Add jwe.WithCEK

* Allow using a static CEK via EncryptStatic

* appease linter

* Update go.sum

* Docs

* Update generated options

* Add test

* clarify when jwk.Set.RemoveKey can return error ([#1015](https://github.com/lestrrat-go/jwx/pull/1015))

* Remove signer instance upon call to jws.UnregisterSigner ([#1017](https://github.com/lestrrat-go/jwx/pull/1017))

* Delete signer instance upon call to jws.UnregisterSigner

* Update Changes

* Tweak documentation ([#1018](https://github.com/lestrrat-go/jwx/pull/1018))

* Bump golang.org/x/crypto from 0.15.0 to 0.16.0 ([#1020](https://github.com/lestrrat-go/jwx/pull/1020))

* Bump golang.org/x/crypto from 0.15.0 to 0.16.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.15.0 to 0.16.0.
- [Commits]([golang/crypto@v0.15.0...v0.16.0](https://github.com/golang/crypto/compare/v0.15.0...v0.16.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run bazel and tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Merge pull request from [GHSA-7f9x-gw85-8grf](https://github.com/advisories/GHSA-7f9x-gw85-8grf "GHSA-7f9x-gw85-8grf")

* Update Changes

* Appease linter

* fix deps.bzl

* Bump actions/setup-go from 4 to 5 ([#1027](https://github.com/lestrrat-go/jwx/pull/1027))

Bumps [actions/setup-go](<https://github.com/actions/setup-go>) from 4 to 5.
- [Release notes](<https://github.com/actions/setup-go/releases>)
- [Commits]([actions/setup-go@v4...v5](https://github.com/actions/setup-go/compare/v4...v5))

---
updated-dependencies:
- dependency-name: actions/setup-go
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump actions/stale from 8 to 9 ([#1029](https://github.com/lestrrat-go/jwx/pull/1029))

Bumps [actions/stale](<https://github.com/actions/stale>) from 8 to 9.
- [Release notes](<https://github.com/actions/stale/releases>)
- [Changelog](<https://github.com/actions/stale/blob/main/CHANGELOG.md>)
- [Commits]([actions/stale@v8...v9](https://github.com/actions/stale/compare/v8...v9))

---
updated-dependencies:
- dependency-name: actions/stale
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Merge [#1044](https://github.com/lestrrat-go/jwx/pull/1044) ([#1045](https://github.com/lestrrat-go/jwx/pull/1045))

* update all dependencies 12/19/2023

* Run gazelle-update-repos

---------

Co-authored-by: Nathan Lacey <nlacey@novetta.com>

* Update go version in go.mod to go1.18, which matches CI ([#1046](https://github.com/lestrrat-go/jwx/pull/1046))

* Bump github/codeql-action from 2 to 3 ([#1031](https://github.com/lestrrat-go/jwx/pull/1031))

Bumps [github/codeql-action](<https://github.com/github/codeql-action>) from 2 to 3.
- [Release notes](<https://github.com/github/codeql-action/releases>)
- [Changelog](<https://github.com/github/codeql-action/blob/main/CHANGELOG.md>)
- [Commits]([github/codeql-action@v2...v3](https://github.com/github/codeql-action/compare/v2...v3))

---
updated-dependencies:
- dependency-name: github/codeql-action
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Add jws.IsVerificationError ([#1049](https://github.com/lestrrat-go/jwx/pull/1049))

* Add jws.IsVerificationError

* tweak document

* Merge pull request from [GHSA-pvcr-v8j8-j5q3](https://github.com/advisories/GHSA-pvcr-v8j8-j5q3 "GHSA-pvcr-v8j8-j5q3")

* Add tests for empty protected headers

* check for sig.protected == nil

* Add one more case for missing protected headers in compact form

* Update Changes

* JWS: Check for sig.protected == nil on non-flattened input

---------

Co-authored-by: Fredrik Strupe <fredrik@strupe.net>

* Update Changes

* fix typo

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Shang Jian Ding <sding3@ncsu.edu>
Co-authored-by: Nathan Lacey <nlacey@novetta.com>
Co-authored-by: Fredrik Strupe <fredrik@strupe.net>
```

* Loading branch information

[![@lestrrat](https://avatars.githubusercontent.com/u/49281?s=40&v=4)](/lestrrat) [![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot)
[![@sding3](https://avatars.githubusercontent.com/u/18542826?s=40&v=4)](/sding3) [![@frestr](https://avatars.githubusercontent.com/u/7038699?s=40&v=4)](/frestr)

5 people

authored
Jan 9, 2024

1 parent
[e75b7c8](/lestrrat-go/jwx/commit/e75b7c8dcbf8e56ecfbeb17b8b3ffaa81a96914f)

commit d69a721

 Show file tree

 Hide file tree

Showing
**31 changed files**
with
**530 additions**
and
**733 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .bazelversion
  [.bazelversion](#diff-c3633fb973fb6f3cf898f53da86fa77e9310338a7c2933143709d5e226f05f75)
* .github/workflows

  + .github/workflows/benchmark.yml
    [benchmark.yml](#diff-aacbd0338bcf598920c120b69adaba2672acc7ea314cfca0f792bebe5fe2acd0)
  + .github/workflows/ci.yml
    [ci.yml](#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03f)
  + .github/workflows/codeql.yml
    [codeql.yml](#diff-12783128521e452af0cfac94b99b8d250413c516ec71fe6d97dbea666ff7ba27)
  + .github/workflows/lint.yml
    [lint.yml](#diff-107e910e9f2ebfb9a741fa10b2aa7100cc1fc4f5f3aca2dfe78b905cbd73c0d2)
  + .github/workflows/smoke.yml
    [smoke.yml](#diff-3e3a544a7087b3bc7dc0bc79025624035297abd1dc4a6619e7d89ee4e9ca21a7)
  + .github/workflows/stale.yml
    [stale.yml](#diff-b5e0854ed0838024d5cc25b4e030922e34648b9ea8c432807e35495fb805b894)
* Changes
  [Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2)
* cmd/jwx

  + cmd/jwx/go.mod
    [go.mod](#diff-7257986812d2e46d85b2961f1feb2a44f3c185bef0a41e42caa877c4fd4a5bfd)
  + cmd/jwx/go.sum
    [go.sum](#diff-c7b7db7b241280ca6bbe705cf5dda85605f6e24f77cfe29b8eca71bfbe63604b)
* deps.bzl
  [deps.bzl](#diff-fab376ba1470f856c3cef704121107abeb9ad4766665f4cc6315bb5a6d14bac1)
* examples

  + examples/go.sum
    [go.sum](#diff-b05a4695386fab24648f2bfbd368123e8f3dcd6dd9e1a8f38565b10bb9a028f5)
* go.mod
  [go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6)
* go.sum
  [go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63)
* jws

  + jws/jws.go
    [jws.go](#diff-942cf9b33fb3df34a0229792eb7efca602dd550a32a41be59c1fcdccb2676a32)
  + jws/jws\_test.go
    [jws\_test.go](#diff-01fafce91c0a9808b43a3370f8af5801149a0418e1d5ac38f883d20bb182c095)
  + jws/message.go
    [message.go](#diff-53147420851a4a4017650d24d6176ea4a4157d83ef39f852ed74c1c07bc8b27b)
* tools/cmd

  + genjwa

    - tools/cmd/genjwa/go.mod
      [go.mod](#diff-5482af3cbf443b2928d94ac4ff746c9d5ca7aa4610207793e45355105d8a1790)
    - tools/cmd/genjwa/go.sum
      [go.sum](#diff-3ca2504fb7382ae1052936bba7a678f7328bf565fde093982cab2ae9f095d5fe)
  + genjwe

    - tools/cmd/genjwe/go.mod
      [go.mod](#diff-da43e4c19e45025458bc900ed5581452c45876df3a68ee4eb219eff79a99e965)
    - tools/cmd/genjwe/go.sum
      [go.sum](#diff-bfe54cbc67b8dd4f1bdf1149535d1d070b229f7fcd402003175a0f71ad0bdde1)
  + genjwk

    - tools/cmd/genjwk/go.mod
      [go.mod](#diff-f97b77e05fbd44f34d344e4f4384eb0903307193daad72723175914f878e30b0)
    - tools/cmd/genjwk/go.sum
      [go.sum](#diff-e037ac804ab5c875a636c1a31c30f5ea7fb3e7e9fd9df9d6848e10945e517467)
  + genjws

    - tools/cmd/genjws/go.mod
      [go.mod](#diff-953c92807f752e1df66ceed88f217376a68a5951b9e12701390740d38fa64925)
    - tools/cmd/genjws/go.sum
      [go.sum](#diff-73d0fdaeef8061b108989876d717a84c48c142ed870a5df7b62990fe0225128d)
  + genjwt

    - tools/cmd/genjwt/go.mod
      [go.mod](#diff-57932850c6eaf61e6111bcb569b3616c1f60e8fd359b257ad77408c4b415e196)
    - tools/cmd/genjwt/go.sum
      [go.sum](#diff-cf499fc95b5f36d24c7b86c7e90ac764cac77c6f240aefc1de80a31353a92447)
  + genoptions

    - tools/cmd/genoptions/go.mod
      [go.mod](#diff-fd7b25d665f197e7f3706e442af6ae454a98bb94000bb3146ae42fbd11f30c43)
    - tools/cmd/genoptions/go.sum
      [go.sum](#diff-329858b2af6a1b54816cb104f555e5e4a12db90891c54fa2cf8fe55c1ee0c88e)
  + genreadfile

    - tools/cmd/genreadfile/go.mod
      [go.mod](#diff-b2520971a04b39a3430e5d488c515d1404a0f0fd50f26acd8065deb896f5d687)
    - tools/cmd/genreadfile/go.sum
      [go.sum](#diff-b80d1a5864a0a55c4b760ef7379e24d7da60f5bff78369ca20aec827c1a00b5d)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[.bazelversion](#diff-c3633fb973fb6f3cf898f53da86fa77e9310338a7c2933143709d5e226f05f75 ".bazelversion")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.bazelversion)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1 +1 @@ |
|  |  | 6.0.0 |
|  |  | 6.4.0 |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/benchmark.yml](#diff-aacbd0338bcf598920c120b69adaba2672acc7ea314cfca0f792bebe5fe2acd0 ".github/workflows/benchmark.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/benchmark.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,7 +24,7 @@ jobs: |
|  |  | restore-keys: | |
|  |  | ${{ runner.os }}-go- |
|  |  | - name: Install Go stable version |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | check-latest: true |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/ci.yml](#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03f ".github/workflows/ci.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/ci.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,7 @@ jobs: |
|  |  | ${{ runner.os }}-go- |
|  |  | - name: Install Go stable version |
|  |  | if: matrix.go != 'tip' |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | check-latest: true |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[.github/workflows/codeql.yml](#diff-12783128521e452af0cfac94b99b8d250413c516ec71fe6d97dbea666ff7ba27 ".github/workflows/codeql.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/codeql.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,7 +44,7 @@ jobs: |
|  |  |  |
|  |  | # Initializes the CodeQL tools for scanning. |
|  |  | - name: Initialize CodeQL |
|  |  | uses: github/codeql-action/init@v2 |
|  |  | uses: github/codeql-action/init@v3 |
|  |  | with: |
|  |  | languages: ${{ matrix.language }} |
|  |  | # If you wish to specify custom queries, you can do so here or in a config file. |
| Expand All | | @@ -58,7 +58,7 @@ jobs: |
|  |  | # Autobuild attempts to build any compiled languages (C/C++, C#, Go, or Java). |
|  |  | # If this step fails, then you should remove it and run the build manually (see below) |
|  |  | - name: Autobuild |
|  |  | uses: github/codeql-action/autobuild@v2 |
|  |  | uses: github/codeql-action/autobuild@v3 |
|  |  |  |
|  |  | # ℹ️ Command-line programs to run using the OS shell. |
|  |  | # 📚 See https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob\_idstepsrun |
| Expand All | | @@ -71,6 +71,6 @@ jobs: |
|  |  | # ./location\_of\_script\_within\_repo/buildscript.sh |
|  |  |  |
|  |  | - name: Perform CodeQL Analysis |
|  |  | uses: github/codeql-action/analyze@v2 |
|  |  | uses: github/codeql-action/analyze@v3 |
|  |  | with: |
|  |  | category: "/language:${{matrix.language}}" |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/lint.yml](#diff-107e910e9f2ebfb9a741fa10b2aa7100cc1fc4f5f3aca2dfe78b905cbd73c0d2 ".github/workflows/lint.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/lint.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ jobs: |
|  |  | runs-on: ubuntu-latest |
|  |  | steps: |
|  |  | - uses: actions/checkout@v4 |
|  |  | - uses: actions/setup-go@v4 |
|  |  | - uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: 1.19 |
|  |  | check-latest: true |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/smoke.yml](#diff-3e3a544a7087b3bc7dc0bc79025624035297abd1dc4a6619e7d89ee4e9ca21a7 ".github/workflows/smoke.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/smoke.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,7 +33,7 @@ jobs: |
|  |  | restore-keys: | |
|  |  | ${{ runner.os }}-go- |
|  |  | - name: Install Go stable version |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | check-latest: true |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/stale.yml](#diff-b5e0854ed0838024d5cc25b4e030922e34648b9ea8c432807e35495fb805b894 ".github/workflows/stale.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/.github/workflows/stale.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,7 +7,7 @@ jobs: |
|  |  | stale: |
|  |  | runs-on: ubuntu-latest |
|  |  | steps: |
|  |  | - uses: actions/stale@v8 |
|  |  | - uses: actions/stale@v9 |
|  |  | with: |
|  |  | stale-issue-message: 'This issue is stale because it has been open 14 days with no activity. Remove stale label or comment or this will be closed in 7 days.' |
|  |  | stale-pr-message: 'This PR is stale because it has been open 14 days with no activity. Remove stale label or comment or this will be closed in 14 days.' |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2 "Changes")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/Changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,22 @@ Changes |
|  |  | v2 has many incompatibilities with v1. To see the full list of differences between |
|  |  | v1 and v2, please read the Changes-v2.md file (https://github.com/lestrrat-go/jwx/blob/develop/v2/Changes-v2.md) |
|  |  |  |
|  |  | v2.0.19 09 Jan 2023 |
|  |  | [New Features] |
|  |  | \* [jws] Added jws.IsVerificationError to check if the error returned by `jws.Verify` |
|  |  | was caused by actual verification step or something else, for example, while fetching |
|  |  | a key from datasource |
|  |  |  |
|  |  | [Security Fixes] |
|  |  | \* [jws] JWS messages formated in full JSON format (i.e. not the compact format, which |
|  |  | consists of three base64 strings concatenated with a '.') with missing "protected" |
|  |  | headers could cause a panic, thereby introducing a possiblity of a DoS. |
|  |  |  |
|  |  | This has been fixed so that the `jws.Parse` function succeeds in parsing a JWS message |
|  |  | lacking a protected header. Calling `jws.Verify` on this same JWS message will result |
|  |  | in a failed verification attempt. Note that this behavior will differ slightly when |
|  |  | parsing JWS messages in compact form, which result in an error. |
|  |  |  |
|  |  | v2.0.18 03 Dec 2023 |
|  |  | [Security Fixes] |
|  |  | \* [jwe] A large number in p2c parameter for PBKDF2 based encryptions could cause a DoS attack, |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[cmd/jwx/go.mod](#diff-7257986812d2e46d85b2961f1feb2a44f3c185bef0a41e42caa877c4fd4a5bfd "cmd/jwx/go.mod")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/cmd/jwx/go.mod)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,22 +3,22 @@ module github.com/lestrrat-go/jwx/v2/cmd/jwx |
|  |  | go 1.17 |
|  |  |  |
|  |  | require ( |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.11 |
|  |  | github.com/urfave/cli/v2 v2.24.4 |
|  |  | golang.org/x/crypto v0.9.0 |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.18 |
|  |  | github.com/urfave/cli/v2 v2.26.0 |
|  |  | golang.org/x/crypto v0.17.0 |
|  |  | ) |
|  |  |  |
|  |  | require ( |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.2 // indirect |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.3 // indirect |
|  |  | github.com/decred/dcrd/dcrec/secp256k1/v4 v4.2.0 // indirect |
|  |  | github.com/goccy/go-json v0.10.2 // indirect |
|  |  | github.com/lestrrat-go/blackmagic v1.0.1 // indirect |
|  |  | github.com/lestrrat-go/blackmagic v1.0.2 // indirect |
|  |  | github.com/lestrrat-go/httpcc v1.0.1 // indirect |
|  |  | github.com/lestrrat-go/httprc v1.0.4 // indirect |
|  |  | github.com/lestrrat-go/iter v1.0.2 // indirect |
|  |  | github.com/lestrrat-go/option v1.0.1 // indirect |
|  |  | github.com/russross/blackfriday/v2 v2.1.0 // indirect |
|  |  | github.com/segmentio/asm v1.2.0 // indirect |
|  |  | github.com/xrash/smetrics v0.0.0-20201216005158-039620a65673 // indirect |
|  |  | golang.org/x/sys v0.8.0 // indirect |
|  |  | github.com/xrash/smetrics v0.0.0-20231213231151-1d8dd44e695e // indirect |
|  |  | golang.org/x/sys v0.15.0 // indirect |
|  |  | ) |

30 changes: 18 additions & 12 deletions

30
[cmd/jwx/go.sum](#diff-c7b7db7b241280ca6bbe705cf5dda85605f6e24f77cfe29b8eca71bfbe63604b "cmd/jwx/go.sum")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/cmd/jwx/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,7 @@ |
|  |  | github.com/BurntSushi/toml v1.2.1/go.mod h1:CxXYINrC8qIiEnFrOxCa7Jy5BFHlXnUU2pbicEuybxQ= |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.2 h1:p1EgwI/C7NhT0JmVkwCD2ZBK8j4aeHQX2pMHHBfMQ6w= |
|  |  | github.com/BurntSushi/toml v1.3.2/go.mod h1:CxXYINrC8qIiEnFrOxCa7Jy5BFHlXnUU2pbicEuybxQ= |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.2/go.mod h1:tgQtvFlXSQOSOSIRvRPT7W67SCa46tRHOmNcaadrF8o= |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.3 h1:qMCsGGgs+MAzDFyp9LpAe1Lqy/fY/qCovCm0qnXZOBM= |
|  |  | github.com/cpuguy83/go-md2man/v2 v2.0.3/go.mod h1:tgQtvFlXSQOSOSIRvRPT7W67SCa46tRHOmNcaadrF8o= |
|  |  | github.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38= |
|  |  | github.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c= |
|  |  | github.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38= |
| Expand All | | @@ -9,16 +10,16 @@ github.com/decred/dcrd/dcrec/secp256k1/v4 v4.2.0 h1:8UrgZ3GkP4i/CLijOJx79Yu+etly |
|  |  | github.com/decred/dcrd/dcrec/secp256k1/v4 v4.2.0/go.mod h1:v57UDF4pDQJcEfFUCRop3lJL149eHGSe9Jvczhzjo/0= |
|  |  | github.com/goccy/go-json v0.10.2 h1:CrxCmQqYDkv1z7lO7Wbh2HN93uovUHgrECaO5ZrCXAU= |
|  |  | github.com/goccy/go-json v0.10.2/go.mod h1:6MelG93GURQebXPDq3khkgXZkazVtN9CRI+MGFi0w8I= |
|  |  | github.com/lestrrat-go/blackmagic v1.0.1 h1:lS5Zts+5HIC/8og6cGHb0uCcNCa3OUt1ygh3Qz2Fe80= |
|  |  | github.com/lestrrat-go/blackmagic v1.0.1/go.mod h1:UrEqBzIR2U6CnzVyUtfM6oZNMt/7O7Vohk2J0OGSAtU= |
|  |  | github.com/lestrrat-go/blackmagic v1.0.2 h1:Cg2gVSc9h7sz9NOByczrbUvLopQmXrfFx//N+AkAr5k= |
|  |  | github.com/lestrrat-go/blackmagic v1.0.2/go.mod h1:UrEqBzIR2U6CnzVyUtfM6oZNMt/7O7Vohk2J0OGSAtU= |
|  |  | github.com/lestrrat-go/httpcc v1.0.1 h1:ydWCStUeJLkpYyjLDHihupbn2tYmZ7m22BGkcvZZrIE= |
|  |  | github.com/lestrrat-go/httpcc v1.0.1/go.mod h1:qiltp3Mt56+55GPVCbTdM9MlqhvzyuL6W/NMDA8vA5E= |
|  |  | github.com/lestrrat-go/httprc v1.0.4 h1:bAZymwoZQb+Oq8MEbyipag7iSq6YIga8Wj6GOiJGdI8= |
|  |  | github.com/lestrrat-go/httprc v1.0.4/go.mod h1:mwwz3JMTPBjHUkkDv/IGJ39aALInZLrhBp0X7KGUZlo= |
|  |  | github.com/lestrrat-go/iter v1.0.2 h1:gMXo1q4c2pHmC3dn8LzRhJfP1ceCbgSiT9lUydIzltI= |
|  |  | github.com/lestrrat-go/iter v1.0.2/go.mod h1:Momfcq3AnRlRjI5b5O8/G5/BvpzrhoFTZcn06fEOPt4= |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.11 h1:ViHMnaMeaO0qV16RZWBHM7GTrAnX2aFLVKofc7FuKLQ= |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.11/go.mod h1:ZtPtMFlrfDrH2Y0iwfa3dRFn8VzwBrB+cyrm3IBWdDg= |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.18 h1:HHZkYS5wWDDyAiNBwztEtDoX07WDhGEdixm8G06R50o= |
|  |  | github.com/lestrrat-go/jwx/v2 v2.0.18/go.mod h1:fAJ+k5eTgKdDqanzCuK6DAt3W7n3cs2/FX7JhQdk83U= |
|  |  | github.com/lestrrat-go/option v1.0.0/go.mod h1:5ZHFbivi4xwXxhxY9XHDe2FHo6/Z7WWmtT7T5nBBp3I= |
|  |  | github.com/lestrrat-go/option v1.0.1 h1:oAzP2fvZGQKWkvHa1/SAcFolBEca1oN+mQ7eooNBEYU= |
|  |  | github.com/lestrrat-go/option v1.0.1/go.mod h1:5ZHFbivi4xwXxhxY9XHDe2FHo6/Z7WWmtT7T5nBBp3I= |
| Expand All | | @@ -36,15 +37,17 @@ github.com/stretchr/testify v1.7.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/ |
|  |  | github.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU= |
|  |  | github.com/stretchr/testify v1.8.4 h1:CcVxjf3Q8PM0mHUKJCdn+eZZtm5yQwehR5yeSVQQcUk= |
|  |  | github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo= |
|  |  | github.com/urfave/cli/v2 v2.24.4 h1:0gyJJEBYtCV87zI/x2nZCPyDxD51K6xM8SkwjHFCNEU= |
|  |  | github.com/urfave/cli/v2 v2.24.4/go.mod h1:GHupkWPMM0M/sj1a2b4wUrWBPzazNrIjouW6fmdJLxc= |
|  |  | github.com/xrash/smetrics v0.0.0-20201216005158-039620a65673 h1:bAn7/zixMGCfxrRTfdpNzjtPYqr8smhKouy9mxVdGPU= |
|  |  | github.com/urfave/cli/v2 v2.26.0 h1:3f3AMg3HpThFNT4I++TKOejZO8yU55t3JnnSr4S4QEI= |
|  |  | github.com/urfave/cli/v2 v2.26.0/go.mod h1:8qnjx1vcq5s2/wpsqoZFndg2CE5tNFyrTvS6SinrnYQ= |
|  |  | github.com/xrash/smetrics v0.0.0-20201216005158-039620a65673/go.mod h1:N3UwUGtsrSj3ccvlPHLoLsHnpR27oXr4ZE984MbSER8= |
|  |  | github.com/xrash/smetrics v0.0.0-20231213231151-1d8dd44e695e h1:+SOyEddqYF09QP7vr7CgJ1eti3pY9Fn3LHO1M1r/0sI= |
|  |  | github.com/xrash/smetrics v0.0.0-20231213231151-1d8dd44e695e/go.mod h1:N3UwUGtsrSj3ccvlPHLoLsHnpR27oXr4ZE984MbSER8= |
|  |  | github.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc= |
|  |  | golang.org/x/crypto v0.9.0 h1:LF6fAI+IutBocDJ2OT0Q1g8plpYljMZ4+lty+dsqw3g= |
|  |  | golang.org/x/crypto v0.9.0/go.mod h1:yrmDGqONDYtNj3tH8X9dzUun2m2lzPa9ngI6/RUPGR0= |
|  |  | golang.org/x/crypto v0.16.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/crypto v0.17.0 h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k= |
|  |  | golang.org/x/crypto v0.17.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4= |
|  |  | golang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs= |
|  |  | golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s= |
| Expand All | | @@ -62,17 +65,20 @@ golang.org/x/sys v0.0.0-20220412211240-33da011f77ad/go.mod h1:oPkhp1MJrh7nUepCBc |
|  |  | golang.org/x/sys v0.0.0-20220520151302-bc2c85ada10a/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg= |
|  |  | golang.org/x/sys v0.0.0-20220722155257-8c9f86f7a55f/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg= |
|  |  | golang.org/x/sys v0.5.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg= |
|  |  | golang.org/x/sys v0.8.0 h1:EBmGv8NaZBZTWvrbjNoL6HVt+IVy3QDQpJs7VRIw3tU= |
|  |  | golang.org/x/sys v0.8.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg= |
|  |  | golang.org/x/sys v0.15.0 h1:h48lPFYpsTvQJZF4EKyI4aLHaev3CxivZmv7yZig9pc= |
|  |  | golang.org/x/sys v0.15.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA= |
|  |  | golang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo= |
|  |  | golang.org/x/term v0.0.0-20210927222741-03fcf44c2211/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8= |
|  |  | golang.org/x/term v0.5.0/go.mod h1:jMB1sMXY+tzblOD4FWmEbocvup2/aLOaQEp7JmGp78k= |
|  |  | golang.org/x/term v0.8.0/go.mod h1:xPskH00ivmX89bAKVGSKKtLOWNx2+17Eiy94tnKShWo= |
|  |  | golang.org/x/term v0.15.0/go.mod h1:BDl952bC7+uMoWR75FIrCDx79TPU9oHkTZ9yRbYOrX0= |
|  |  | golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ= |
|  |  | golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ= |
|  |  | golang.org/x/text v0.3.7/go.mod h1:u+2+/6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ= |
|  |  | golang.org/x/text v0.7.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8= |
|  |  | golang.org/x/text v0.9.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8= |
|  |  | golang.org/x/text v0.14.0/go.mod h1:18ZOQIKpY8NJVqYksKHtTdi31H5itFRjB5/qKTNYzSU= |
|  |  | golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ= |
|  |  | golang.org/x/tools v0.0.0-20191119224855-298f0cb1881e/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo= |
|  |  | golang.org/x/tools v0.1.12/go.mod h1:hNGJHUnrk76NpqgfD5Aqm5Crs+Hm0VOH/i9J2+nxYbc= |
| Expand Down | |  |

39 changes: 2 additions & 37 deletions

39
[deps.bzl](#diff-fab376ba1470f856c3cef704121107abeb9ad4766665f4cc6315bb5a6d14bac1 "deps.bzl")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/deps.bzl)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -95,13 +95,6 @@ def go\_dependencies(): |
|  |  | sum = "h1:CcVxjf3Q8PM0mHUKJCdn+eZZtm5yQwehR5yeSVQQcUk=", |
|  |  | version = "v1.8.4", |
|  |  | ) |
|  |  | go\_repository( |
|  |  | name = "com\_github\_yuin\_goldmark", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "github.com/yuin/goldmark", |
|  |  | sum = "h1:fVcFKWvrslecOb/tg+Cc05dkeYx540o0FuFt3nUVDoE=", |
|  |  | version = "v1.4.13", |
|  |  | ) |
|  |  |  |
|  |  | go\_repository( |
|  |  | name = "in\_gopkg\_check\_v1", |
| Expand All | | @@ -122,15 +115,8 @@ def go\_dependencies(): |
|  |  | name = "org\_golang\_x\_crypto", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "golang.org/x/crypto", |
|  |  | sum = "h1:mMMrFzRSCF0GvB7Ne27XVtVAaXLrPmgPC7/v0tkwHaY=", |
|  |  | version = "v0.16.0", |
|  |  | ) |
|  |  | go\_repository( |
|  |  | name = "org\_golang\_x\_mod", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "golang.org/x/mod", |
|  |  | sum = "h1:LUYupSeNrTNCGzR/hVBk2NHZO4hXcVaW1k4Qx7rjPx8=", |
|  |  | version = "v0.8.0", |
|  |  | sum = "h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k=", |
|  |  | version = "v0.17.0", |
|  |  | ) |
|  |  |  |
|  |  | go\_repository( |
| Expand All | | @@ -140,13 +126,6 @@ def go\_dependencies(): |
|  |  | sum = "h1:X2//UzNDwYmtCLn7To6G58Wr6f5ahEAQgKNzv9Y951M=", |
|  |  | version = "v0.10.0", |
|  |  | ) |
|  |  | go\_repository( |
|  |  | name = "org\_golang\_x\_sync", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "golang.org/x/sync", |
|  |  | sum = "h1:wsuoTGHzEhffawBOhz5CYhcrV4IdKZbEyZjBMuTp12o=", |
|  |  | version = "v0.1.0", |
|  |  | ) |
|  |  |  |
|  |  | go\_repository( |
|  |  | name = "org\_golang\_x\_sys", |
| Expand All | | @@ -170,17 +149,3 @@ def go\_dependencies(): |
|  |  | sum = "h1:ScX5w1eTa3QqT8oi6+ziP7dTV1S2+ALU0bI+0zXKWiQ=", |
|  |  | version = "v0.14.0", |
|  |  | ) |
|  |  | go\_repository( |
|  |  | name = "org\_golang\_x\_tools", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "golang.org/x/tools", |
|  |  | sum = "h1:BOw41kyTf3PuCW1pVQf8+Cyg8pMlkYB1oo9iJ6D/lKM=", |
|  |  | version = "v0.6.0", |
|  |  | ) |
|  |  | go\_repository( |
|  |  | name = "org\_golang\_x\_xerrors", |
|  |  | build\_file\_proto\_mode = "disable\_global", |
|  |  | importpath = "golang.org/x/xerrors", |
|  |  | sum = "h1:9zdDQZ7Thm29KFXgAX/+yaf3eVbP7djjWp/dXAppNCc=", |
|  |  | version = "v0.0.0-20190717185122-a985d3407aa7", |
|  |  | ) |

5 changes: 2 additions & 3 deletions

5
[examples/go.sum](#diff-b05a4695386fab24648f2bfbd368123e8f3dcd6dd9e1a8f38565b10bb9a028f5 "examples/go.sum")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/examples/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,8 +36,8 @@ github.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5t |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc= |
|  |  | golang.org/x/crypto v0.3.1-0.20221117191849-2c476679df9a/go.mod h1:hebNnKkNXi2UzZN1eVRvBB7co0a+JxK6XbPiWVs/3J4= |
|  |  | golang.org/x/crypto v0.16.0 h1:mMMrFzRSCF0GvB7Ne27XVtVAaXLrPmgPC7/v0tkwHaY= |
|  |  | golang.org/x/crypto v0.16.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/crypto v0.17.0 h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k= |
|  |  | golang.org/x/crypto v0.17.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4= |
|  |  | golang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs= |
|  |  | golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s= |
| Expand Down  Expand Up | | @@ -74,7 +74,6 @@ golang.org/x/text v0.4.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8= |
|  |  | golang.org/x/text v0.7.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8= |
|  |  | golang.org/x/text v0.9.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8= |
|  |  | golang.org/x/text v0.14.0/go.mod h1:18ZOQIKpY8NJVqYksKHtTdi31H5itFRjB5/qKTNYzSU= |
|  |  | golang.org/x/text v0.14.0/go.mod h1:18ZOQIKpY8NJVqYksKHtTdi31H5itFRjB5/qKTNYzSU= |
|  |  | golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ= |
|  |  | golang.org/x/tools v0.0.0-20191119224855-298f0cb1881e/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo= |
|  |  | golang.org/x/tools v0.1.12/go.mod h1:hNGJHUnrk76NpqgfD5Aqm5Crs+Hm0VOH/i9J2+nxYbc= |
| Expand Down | |  |

12 changes: 10 additions & 2 deletions

12
[go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6 "go.mod")

Show comments

[View file](/lestrrat-go/jwx/blob/d69a721931a5c48b9850a42404f18e143704adcd/go.mod)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | module github.com/lestrrat-go/jwx/v2 |
|  |  |  |
|  |  | go 1.16 |
|  |  | go 1.18 |
|  |  |  |
|  |  | require ( |
|  |  | github.com/decred/dcrd/dcrec/secp256k1/v4 v4.2.0 |
| Expand All | | @@ -11,5 +11,13 @@ require ( |
|  |  | github.com/lestrrat-go/option v1.0.1 |
|  |  | github.com/segmentio/asm v1.2.0 |
|  |  | github.com/stretchr/testify v1.8.4 |
|  |  | golang.org/x/crypto v0.16.0 |
|  |  | golang.org/x/crypto v0.17.0 |
|  |  | ) |
|  |  |  |
|  |  | require ( |
|  |  | github.com/davecgh/go-spew v1.1.1 // indirect |
|  |  | github.com/lestrrat-go/httpcc v1.0.1 // indirect |
|  |  | github.com/pmezard/go-difflib v1.0.0 // indirect |
|  |  | golang.org/x/sys v0.15.0 // indirect |
|  |  | gopkg.in/yaml.v3 v3.0.1 // indirect |
|  |  | ) |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d69a721`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2Fd69a721931a5c48b9850a42404f18e143704adcd) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6889584d_20250114_192206.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lestrrat-go%2Fjwx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lestrrat-go](/lestrrat-go)
/
**[jwx](/lestrrat-go/jwx)**
Public

* [Notifications](/login?return_to=%2Flestrrat-go%2Fjwx) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Flestrrat-go%2Fjwx)
* [Star
   2k](/login?return_to=%2Flestrrat-go%2Fjwx)

* [Code](/lestrrat-go/jwx)
* [Issues
  4](/lestrrat-go/jwx/issues)
* [Pull requests
  5](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects
  0](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

Additional navigation options

* [Code](/lestrrat-go/jwx)
* [Issues](/lestrrat-go/jwx/issues)
* [Pull requests](/lestrrat-go/jwx/pulls)
* [Discussions](/lestrrat-go/jwx/discussions)
* [Actions](/lestrrat-go/jwx/actions)
* [Projects](/lestrrat-go/jwx/projects)
* [Wiki](/lestrrat-go/jwx/wiki)
* [Security](/lestrrat-go/jwx/security)
* [Insights](/lestrrat-go/jwx/pulse)

## Commit

[Permalink](/lestrrat-go/jwx/commit/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

v1.2.28 ([#1052](https://github.com/lestrrat-go/jwx/pull/1052))

[Browse files](/lestrrat-go/jwx/tree/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65)
Browse the repository at this point in the history

```
* Update deps

* remove stray v2 import

* Bump github.com/stretchr/testify from 1.7.2 to 1.7.5

Bumps [github.com/stretchr/testify](<https://github.com/stretchr/testify>) from 1.7.2 to 1.7.5.
- [Release notes](<https://github.com/stretchr/testify/releases>)
- [Commits]([stretchr/testify@v1.7.2...v1.7.5](https://github.com/stretchr/testify/compare/v1.7.2...v1.7.5))

---
updated-dependencies:
- dependency-name: github.com/stretchr/testify
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

* Bump github.com/goccy/go-json from 0.9.7 to 0.9.8 ([#769](https://github.com/lestrrat-go/jwx/pull/769))

* Bump github.com/stretchr/testify from 1.7.5 to 1.8.0 ([#771](https://github.com/lestrrat-go/jwx/pull/771))

* bump github/goccy/go-json to 0.9.10 ([#780](https://github.com/lestrrat-go/jwx/pull/780))

* Update deps ([#800](https://github.com/lestrrat-go/jwx/pull/800))

* Update deps

* upgrade golangci-lint run

* Update develop/v1 to testify v1.8.1

* Bump github.com/goccy/go-json from 0.9.11 to 0.10.0 ([#856](https://github.com/lestrrat-go/jwx/pull/856))

* Bump github.com/goccy/go-json from 0.9.11 to 0.10.0

Bumps [github.com/goccy/go-json](<https://github.com/goccy/go-json>) from 0.9.11 to 0.10.0.
- [Release notes](<https://github.com/goccy/go-json/releases>)
- [Changelog](<https://github.com/goccy/go-json/blob/master/CHANGELOG.md>)
- [Commits]([goccy/go-json@v0.9.11...v0.10.0](https://github.com/goccy/go-json/compare/v0.9.11...v0.10.0))

---
updated-dependencies:
- dependency-name: github.com/goccy/go-json
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Update develop/v1 CI ([#862](https://github.com/lestrrat-go/jwx/pull/862))

* Update CI for develop/v1

* Update smoke as well

* silence warning

* regenerate file

* Update stale action version

* See if this allows us to bypass azure only when necessary

* run apt-get update as well

* Update ci.yml as well

* remove sed magic

* Check which algorithms are available before running tests

* log skipped algorithms

* Bump github.com/lestrrat-go/option from 1.0.0 to 1.0.1 ([#861](https://github.com/lestrrat-go/jwx/pull/861))

* Bump github.com/lestrrat-go/option from 1.0.0 to 1.0.1

Bumps [github.com/lestrrat-go/option](<https://github.com/lestrrat-go/option>) from 1.0.0 to 1.0.1.
- [Release notes](<https://github.com/lestrrat-go/option/releases>)
- [Commits]([lestrrat-go/option@v1.0.0...v1.0.1](https://github.com/lestrrat-go/option/compare/v1.0.0...v1.0.1))

---
updated-dependencies:
- dependency-name: github.com/lestrrat-go/option
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Update Changes

* Bump golang.org/x/crypto from 0.0.0-20220427172511-eb4f295cb31f to 0.6.0 ([#870](https://github.com/lestrrat-go/jwx/pull/870))

* Bump golang.org/x/crypto from 0.0.0-20220427172511-eb4f295cb31f to 0.6.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.0.0-20220427172511-eb4f295cb31f to 0.6.0.
- [Release notes](<https://github.com/golang/crypto/releases>)
- [Commits](<https://github.com/golang/crypto/commits/v0.6.0>)

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run appropriate `go get` and `go mod tidy` all over

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump github.com/stretchr/testify from 1.8.1 to 1.8.2 ([#874](https://github.com/lestrrat-go/jwx/pull/874))

* Bump github.com/stretchr/testify from 1.8.1 to 1.8.2

Bumps [github.com/stretchr/testify](<https://github.com/stretchr/testify>) from 1.8.1 to 1.8.2.
- [Release notes](<https://github.com/stretchr/testify/releases>)
- [Commits]([stretchr/testify@v1.8.1...v1.8.2](https://github.com/stretchr/testify/compare/v1.8.1...v1.8.2))

---
updated-dependencies:
- dependency-name: github.com/stretchr/testify
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* run `go get` and `go mod tidy` all over

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.6.0 to 0.7.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.6.0 to 0.7.0.
- [Release notes](<https://github.com/golang/crypto/releases>)
- [Commits]([golang/crypto@v0.6.0...v0.7.0](https://github.com/golang/crypto/compare/v0.6.0...v0.7.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

* Bump github.com/goccy/go-json from 0.10.0 to 0.10.1 ([#883](https://github.com/lestrrat-go/jwx/pull/883))

* Bump github.com/goccy/go-json from 0.10.0 to 0.10.1

Bumps [github.com/goccy/go-json](<https://github.com/goccy/go-json>) from 0.10.0 to 0.10.1.
- [Release notes](<https://github.com/goccy/go-json/releases>)
- [Changelog](<https://github.com/goccy/go-json/blob/master/CHANGELOG.md>)
- [Commits]([goccy/go-json@v0.10.0...v0.10.1](https://github.com/goccy/go-json/compare/v0.10.0...v0.10.1))

---
updated-dependencies:
- dependency-name: github.com/goccy/go-json
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump github.com/goccy/go-json from 0.10.1 to 0.10.2 ([#891](https://github.com/lestrrat-go/jwx/pull/891))

* Bump github.com/goccy/go-json from 0.10.1 to 0.10.2

Bumps [github.com/goccy/go-json](<https://github.com/goccy/go-json>) from 0.10.1 to 0.10.2.
- [Release notes](<https://github.com/goccy/go-json/releases>)
- [Changelog](<https://github.com/goccy/go-json/blob/master/CHANGELOG.md>)
- [Commits]([goccy/go-json@v0.10.1...v0.10.2](https://github.com/goccy/go-json/compare/v0.10.1...v0.10.2))

---
updated-dependencies:
- dependency-name: github.com/goccy/go-json
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.7.0 to 0.8.0 ([#898](https://github.com/lestrrat-go/jwx/pull/898))

* Bump golang.org/x/crypto from 0.7.0 to 0.8.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.7.0 to 0.8.0.
- [Release notes](<https://github.com/golang/crypto/releases>)
- [Commits]([golang/crypto@v0.7.0...v0.8.0](https://github.com/golang/crypto/compare/v0.7.0...v0.8.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump actions/checkout from 2 to 3 ([#900](https://github.com/lestrrat-go/jwx/pull/900))

Bumps [actions/checkout](<https://github.com/actions/checkout>) from 2 to 3.
- [Release notes](<https://github.com/actions/checkout/releases>)
- [Changelog](<https://github.com/actions/checkout/blob/main/CHANGELOG.md>)
- [Commits]([actions/checkout@v2...v3](https://github.com/actions/checkout/compare/v2...v3))

---
updated-dependencies:
- dependency-name: actions/checkout
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump kentaro-m/auto-assign-action from 1.2.0 to 1.2.5 ([#901](https://github.com/lestrrat-go/jwx/pull/901))

Bumps [kentaro-m/auto-assign-action](<https://github.com/kentaro-m/auto-assign-action>) from 1.2.0 to 1.2.5.
- [Release notes](<https://github.com/kentaro-m/auto-assign-action/releases>)
- [Commits]([kentaro-m/auto-assign-action@v1.2.0...v1.2.5](https://github.com/kentaro-m/auto-assign-action/compare/v1.2.0...v1.2.5))

---
updated-dependencies:
- dependency-name: kentaro-m/auto-assign-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump actions/cache from 2 to 3 ([#902](https://github.com/lestrrat-go/jwx/pull/902))

Bumps [actions/cache](<https://github.com/actions/cache>) from 2 to 3.
- [Release notes](<https://github.com/actions/cache/releases>)
- [Changelog](<https://github.com/actions/cache/blob/main/RELEASES.md>)
- [Commits]([actions/cache@v2...v3](https://github.com/actions/cache/compare/v2...v3))

---
updated-dependencies:
- dependency-name: actions/cache
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump actions/setup-go from 2 to 4 ([#903](https://github.com/lestrrat-go/jwx/pull/903))

Bumps [actions/setup-go](<https://github.com/actions/setup-go>) from 2 to 4.
- [Release notes](<https://github.com/actions/setup-go/releases>)
- [Commits]([actions/setup-go@v2...v4](https://github.com/actions/setup-go/compare/v2...v4))

---
updated-dependencies:
- dependency-name: actions/setup-go
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump actions/stale from 7 to 8 ([#904](https://github.com/lestrrat-go/jwx/pull/904))

Bumps [actions/stale](<https://github.com/actions/stale>) from 7 to 8.
- [Release notes](<https://github.com/actions/stale/releases>)
- [Changelog](<https://github.com/actions/stale/blob/main/CHANGELOG.md>)
- [Commits]([actions/stale@v7...v8](https://github.com/actions/stale/compare/v7...v8))

---
updated-dependencies:
- dependency-name: actions/stale
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump github.com/decred/dcrd/dcrec/secp256k1/v4 from 4.1.0 to 4.2.0 ([#906](https://github.com/lestrrat-go/jwx/pull/906))

* Bump github.com/decred/dcrd/dcrec/secp256k1/v4 from 4.1.0 to 4.2.0

Bumps [github.com/decred/dcrd/dcrec/secp256k1/v4](<https://github.com/decred/dcrd>) from 4.1.0 to 4.2.0.
- [Release notes](<https://github.com/decred/dcrd/releases>)
- [Changelog](<https://github.com/decred/dcrd/blob/master/CHANGES>)
- [Commits]([decred/dcrd@blockchain/v4.1.0...dcrec/secp256k1/v4.2.0](https://github.com/decred/dcrd/compare/blockchain/v4.1.0...dcrec/secp256k1/v4.2.0))

---
updated-dependencies:
- dependency-name: github.com/decred/dcrd/dcrec/secp256k1/v4
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.8.0 to 0.9.0 ([#920](https://github.com/lestrrat-go/jwx/pull/920))

* Bump golang.org/x/crypto from 0.8.0 to 0.9.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.8.0 to 0.9.0.
- [Commits]([golang/crypto@v0.8.0...v0.9.0](https://github.com/golang/crypto/compare/v0.8.0...v0.9.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump github.com/stretchr/testify from 1.8.2 to 1.8.3 ([#926](https://github.com/lestrrat-go/jwx/pull/926))

* Bump github.com/stretchr/testify from 1.8.2 to 1.8.3

Bumps [github.com/stretchr/testify](<https://github.com/stretchr/testify>) from 1.8.2 to 1.8.3.
- [Release notes](<https://github.com/stretchr/testify/releases>)
- [Commits]([stretchr/testify@v1.8.2...v1.8.3](https://github.com/stretchr/testify/compare/v1.8.2...v1.8.3))

---
updated-dependencies:
- dependency-name: github.com/stretchr/testify
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump github.com/stretchr/testify from 1.8.3 to 1.8.4 ([#930](https://github.com/lestrrat-go/jwx/pull/930))

* Bump github.com/stretchr/testify from 1.8.3 to 1.8.4

Bumps [github.com/stretchr/testify](<https://github.com/stretchr/testify>) from 1.8.3 to 1.8.4.
- [Release notes](<https://github.com/stretchr/testify/releases>)
- [Commits]([stretchr/testify@v1.8.3...v1.8.4](https://github.com/stretchr/testify/compare/v1.8.3...v1.8.4))

---
updated-dependencies:
- dependency-name: github.com/stretchr/testify
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* port extract padding fix from [3275e21](https://github.com/lestrrat-go/jwx/commit/3275e217fe0db5ced8c8e669503221f02f244e45) ([#934](https://github.com/lestrrat-go/jwx/pull/934))

* Update Changes

* Bump golang.org/x/crypto from 0.9.0 to 0.10.0 ([#937](https://github.com/lestrrat-go/jwx/pull/937))

* Bump golang.org/x/crypto from 0.9.0 to 0.10.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.9.0 to 0.10.0.
- [Commits]([golang/crypto@v0.9.0...v0.10.0](https://github.com/golang/crypto/compare/v0.9.0...v0.10.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Accept a single KeyOperation in key.Set() ([#946](https://github.com/lestrrat-go/jwx/pull/946))

* Bump golang.org/x/crypto from 0.10.0 to 0.11.0 ([#955](https://github.com/lestrrat-go/jwx/pull/955))

* Bump golang.org/x/crypto from 0.10.0 to 0.11.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.10.0 to 0.11.0.
- [Commits]([golang/crypto@v0.10.0...v0.11.0](https://github.com/golang/crypto/compare/v0.10.0...v0.11.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.11.0 to 0.12.0 ([#962](https://github.com/lestrrat-go/jwx/pull/962))

* Bump golang.org/x/crypto from 0.11.0 to 0.12.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.11.0 to 0.12.0.
- [Commits]([golang/crypto@v0.11.0...v0.12.0](https://github.com/golang/crypto/compare/v0.11.0...v0.12.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump actions/checkout from 3 to 4 ([#973](https://github.com/lestrrat-go/jwx/pull/973))

Bumps [actions/checkout](<https://github.com/actions/checkout>) from 3 to 4.
- [Release notes](<https://github.com/actions/checkout/releases>)
- [Changelog](<https://github.com/actions/checkout/blob/main/CHANGELOG.md>)
- [Commits]([actions/checkout@v3...v4](https://github.com/actions/checkout/compare/v3...v4))

---
updated-dependencies:
- dependency-name: actions/checkout
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump golang.org/x/crypto from 0.12.0 to 0.13.0 ([#975](https://github.com/lestrrat-go/jwx/pull/975))

* Bump golang.org/x/crypto from 0.12.0 to 0.13.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.12.0 to 0.13.0.
- [Commits]([golang/crypto@v0.12.0...v0.13.0](https://github.com/golang/crypto/compare/v0.12.0...v0.13.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

* remove accidentally included jwx/v2

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Update golangci-lint to 1.54.2 ([#988](https://github.com/lestrrat-go/jwx/pull/988))

* Bump github.com/lestrrat-go/blackmagic from 1.0.1 to 1.0.2 ([#984](https://github.com/lestrrat-go/jwx/pull/984))

* Bump github.com/lestrrat-go/blackmagic from 1.0.1 to 1.0.2

Bumps [github.com/lestrrat-go/blackmagic](<https://github.com/lestrrat-go/blackmagic>) from 1.0.1 to 1.0.2.
- [Commits]([lestrrat-go/blackmagic@v1.0.1...v1.0.2](https://github.com/lestrrat-go/blackmagic/compare/v1.0.1...v1.0.2))

---
updated-dependencies:
- dependency-name: github.com/lestrrat-go/blackmagic
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.13.0 to 0.14.0 ([#992](https://github.com/lestrrat-go/jwx/pull/992))

* Bump golang.org/x/crypto from 0.13.0 to 0.14.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.13.0 to 0.14.0.
- [Commits]([golang/crypto@v0.13.0...v0.14.0](https://github.com/golang/crypto/compare/v0.13.0...v0.14.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Bump golang.org/x/crypto from 0.14.0 to 0.15.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.14.0 to 0.15.0.
- [Commits]([golang/crypto@v0.14.0...v0.15.0](https://github.com/golang/crypto/compare/v0.14.0...v0.15.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

* Bump golang.org/x/crypto from 0.15.0 to 0.16.0 ([#1021](https://github.com/lestrrat-go/jwx/pull/1021))

* Bump golang.org/x/crypto from 0.15.0 to 0.16.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.15.0 to 0.16.0.
- [Commits]([golang/crypto@v0.15.0...v0.16.0](https://github.com/golang/crypto/compare/v0.15.0...v0.16.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* run make tidy

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Daisuke Maki <lestrrat+github@gmail.com>

* Fix p2c ([#1025](https://github.com/lestrrat-go/jwx/pull/1025))

* Fix p2c handling

* Update Changes

* Update Changes

* Bump actions/setup-go from 4 to 5 ([#1028](https://github.com/lestrrat-go/jwx/pull/1028))

Bumps [actions/setup-go](<https://github.com/actions/setup-go>) from 4 to 5.
- [Release notes](<https://github.com/actions/setup-go/releases>)
- [Commits]([actions/setup-go@v4...v5](https://github.com/actions/setup-go/compare/v4...v5))

---
updated-dependencies:
- dependency-name: actions/setup-go
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump actions/stale from 8 to 9 ([#1030](https://github.com/lestrrat-go/jwx/pull/1030))

Bumps [actions/stale](<https://github.com/actions/stale>) from 8 to 9.
- [Release notes](<https://github.com/actions/stale/releases>)
- [Changelog](<https://github.com/actions/stale/blob/main/CHANGELOG.md>)
- [Commits]([actions/stale@v8...v9](https://github.com/actions/stale/compare/v8...v9))

---
updated-dependencies:
- dependency-name: actions/stale
  dependency-type: direct:production
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Bump golang.org/x/crypto from 0.16.0 to 0.17.0

Bumps [golang.org/x/crypto](<https://github.com/golang/crypto>) from 0.16.0 to 0.17.0.
- [Commits]([golang/crypto@v0.16.0...v0.17.0](https://github.com/golang/crypto/compare/v0.16.0...v0.17.0))

---
updated-dependencies:
- dependency-name: golang.org/x/crypto
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

* Run make tidy

* Merge pull request from [GHSA-pvcr-v8j8-j5q3](https://github.com/advisories/GHSA-pvcr-v8j8-j5q3 "GHSA-pvcr-v8j8-j5q3")

* Apply (almost) the same changes as in 5c74fb787e5bd6a29818629b24d92d4cc753301e...42d749aaef80d30e2817c6b5a998e714e7caf27a

* JWS: Check for sig.protected == nil on non-flattened input

(cherry picked from commit bd3148e2d345465a51bcf8a96cb411f14b73f1c1)

* JWS: Check that unmarshalled signature is present before decoding

---------

Co-authored-by: Fredrik Strupe <fredrik@strupe.net>

* Update Changes

* Fix typo

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Fredrik Strupe <fredrik@strupe.net>
```

* Loading branch information

[![@lestrrat](https://avatars.githubusercontent.com/u/49281?s=40&v=4)](/lestrrat) [![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot) [![@frestr](https://avatars.githubusercontent.com/u/7038699?s=40&v=4)](/frestr)

3 people

authored
Jan 9, 2024

1 parent
[611567b](/lestrrat-go/jwx/commit/611567baacc0ef42263708892a08533812324a14)

commit 8c53d0a

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**93 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .github/workflows

  + .github/workflows/benchmark.yml
    [benchmark.yml](#diff-aacbd0338bcf598920c120b69adaba2672acc7ea314cfca0f792bebe5fe2acd0)
  + .github/workflows/ci.yml
    [ci.yml](#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03f)
  + .github/workflows/lint.yml
    [lint.yml](#diff-107e910e9f2ebfb9a741fa10b2aa7100cc1fc4f5f3aca2dfe78b905cbd73c0d2)
  + .github/workflows/smoke.yml
    [smoke.yml](#diff-3e3a544a7087b3bc7dc0bc79025624035297abd1dc4a6619e7d89ee4e9ca21a7)
  + .github/workflows/stale.yml
    [stale.yml](#diff-b5e0854ed0838024d5cc25b4e030922e34648b9ea8c432807e35495fb805b894)
* Changes
  [Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2)
* bench/performance

  + bench/performance/go.sum
    [go.sum](#diff-701c1050c6ee68c1ae3f66682ba159e306fb87ead68e61adfa42e7a7cb09a141)
* examples

  + examples/go.sum
    [go.sum](#diff-b05a4695386fab24648f2bfbd368123e8f3dcd6dd9e1a8f38565b10bb9a028f5)
* go.mod
  [go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6)
* go.sum
  [go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63)
* jws

  + jws/jws\_test.go
    [jws\_test.go](#diff-01fafce91c0a9808b43a3370f8af5801149a0418e1d5ac38f883d20bb182c095)
  + jws/message.go
    [message.go](#diff-53147420851a4a4017650d24d6176ea4a4157d83ef39f852ed74c1c07bc8b27b)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[.github/workflows/benchmark.yml](#diff-aacbd0338bcf598920c120b69adaba2672acc7ea314cfca0f792bebe5fe2acd0 ".github/workflows/benchmark.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/.github/workflows/benchmark.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,7 +24,7 @@ jobs: |
|  |  | restore-keys: | |
|  |  | ${{ runner.os }}-go- |
|  |  | - name: Install Go stable version |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | - name: Install benchstat |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/ci.yml](#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03f ".github/workflows/ci.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/.github/workflows/ci.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,7 +29,7 @@ jobs: |
|  |  | run: curl --connect-timeout 1 https://azure.archive.ubuntu.com || (sudo sed -i 's/azure\.//' /etc/apt/sources.list && sudo apt-get update) |
|  |  | - name: Install Go stable version |
|  |  | if: matrix.go != 'tip' |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | - name: Install Go tip |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/lint.yml](#diff-107e910e9f2ebfb9a741fa10b2aa7100cc1fc4f5f3aca2dfe78b905cbd73c0d2 ".github/workflows/lint.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/.github/workflows/lint.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ jobs: |
|  |  | runs-on: ubuntu-latest |
|  |  | steps: |
|  |  | - uses: actions/checkout@v4 |
|  |  | - uses: actions/setup-go@v4 |
|  |  | - uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: 1.19 |
|  |  | check-latest: true |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/smoke.yml](#diff-3e3a544a7087b3bc7dc0bc79025624035297abd1dc4a6619e7d89ee4e9ca21a7 ".github/workflows/smoke.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/.github/workflows/smoke.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,7 +31,7 @@ jobs: |
|  |  | - name: Munge APT Repositories |
|  |  | run: curl --connect-timeout 1 https://azure.archive.ubuntu.com || (sudo sed -i 's/azure\.//' /etc/apt/sources.list && sudo apt-get update) |
|  |  | - name: Install Go stable version |
|  |  | uses: actions/setup-go@v4 |
|  |  | uses: actions/setup-go@v5 |
|  |  | with: |
|  |  | go-version: ${{ matrix.go }} |
|  |  | - name: Install stringer |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[.github/workflows/stale.yml](#diff-b5e0854ed0838024d5cc25b4e030922e34648b9ea8c432807e35495fb805b894 ".github/workflows/stale.yml")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/.github/workflows/stale.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,7 +7,7 @@ jobs: |
|  |  | stale: |
|  |  | runs-on: ubuntu-latest |
|  |  | steps: |
|  |  | - uses: actions/stale@v8 |
|  |  | - uses: actions/stale@v9 |
|  |  | with: |
|  |  | stale-issue-message: 'This issue is stale because it has been open 14 days with no activity. Remove stale label or comment or this will be closed in 7 days.' |
|  |  | stale-pr-message: 'This PR is stale because it has been open 14 days with no activity. Remove stale label or comment or this will be closed in 14 days.' |
| Expand Down | |  |

13 changes: 12 additions & 1 deletion

13
[Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2 "Changes")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/Changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,17 @@ |
|  |  | Changes |
|  |  | ======= |
|  |  |  |
|  |  | v1.2.28 09 Jan 2024 |
|  |  | [Security Fixes] |
|  |  | \* [jws] JWS messages formated in full JSON format (i.e. not the compact format, which |
|  |  | consists of three base64 strings concatenated with a '.') with missing "protected" |
|  |  | headers could cause a panic, thereby introducing a possiblity of a DoS. |
|  |  |  |
|  |  | This has been fixed so that the `jws.Parse` function succeeds in parsing a JWS message |
|  |  | lacking a protected header. Calling `jws.Verify` on this same JWS message will result |
|  |  | in a failed verification attempt. Note that this behavior will differ slightly when |
|  |  | parsing JWS messages in compact form, which result in an error. |
|  |  |  |
|  |  | v1.2.27 - 03 Dec 2023 |
|  |  | [Security] |
|  |  | \* [jwe] A large number in p2c parameter for PBKDF2 based encryptions could cause a DoS attack, |
| Expand Down  Expand Up | | @@ -247,7 +258,7 @@ v1.2.6 24 Aug 2021 |
|  |  | \* Support `crypto.Signer` keys for RSA, ECDSA, and EdDSA family |
|  |  | of signatures in `jws.Sign` |
|  |  | [Miscellaneous] |
|  |  | \* `jwx.GuessFormat()` now requires the presense of both `payload` and |
|  |  | \* `jwx.GuessFormat()` now requires the presence of both `payload` and |
|  |  | `signatures` keys for it to guess that a JSON object is a JWS message. |
|  |  | \* Slightly enhance `jwt.Parse()` performance. |
|  |  |  |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[bench/performance/go.sum](#diff-701c1050c6ee68c1ae3f66682ba159e306fb87ead68e61adfa42e7a7cb09a141 "bench/performance/go.sum")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/bench/performance/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,8 +32,8 @@ github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXl |
|  |  | github.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc= |
|  |  | golang.org/x/crypto v0.16.0 h1:mMMrFzRSCF0GvB7Ne27XVtVAaXLrPmgPC7/v0tkwHaY= |
|  |  | golang.org/x/crypto v0.16.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/crypto v0.17.0 h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k= |
|  |  | golang.org/x/crypto v0.17.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4= |
|  |  | golang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs= |
|  |  | golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s= |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[examples/go.sum](#diff-b05a4695386fab24648f2bfbd368123e8f3dcd6dd9e1a8f38565b10bb9a028f5 "examples/go.sum")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/examples/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,8 +35,8 @@ github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXl |
|  |  | github.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc= |
|  |  | golang.org/x/crypto v0.16.0 h1:mMMrFzRSCF0GvB7Ne27XVtVAaXLrPmgPC7/v0tkwHaY= |
|  |  | golang.org/x/crypto v0.16.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/crypto v0.17.0 h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k= |
|  |  | golang.org/x/crypto v0.17.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4= |
|  |  | golang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs= |
|  |  | golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s= |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6 "go.mod")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/go.mod)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,7 @@ require ( |
|  |  | github.com/lestrrat-go/option v1.0.1 |
|  |  | github.com/pkg/errors v0.9.1 |
|  |  | github.com/stretchr/testify v1.8.4 |
|  |  | golang.org/x/crypto v0.16.0 |
|  |  | golang.org/x/crypto v0.17.0 |
|  |  | ) |
|  |  |  |
|  |  | retract v1.2.16 // Packaging problems. |

4 changes: 2 additions & 2 deletions

4
[go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63 "go.sum")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,8 +32,8 @@ github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXl |
|  |  | github.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc= |
|  |  | golang.org/x/crypto v0.16.0 h1:mMMrFzRSCF0GvB7Ne27XVtVAaXLrPmgPC7/v0tkwHaY= |
|  |  | golang.org/x/crypto v0.16.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/crypto v0.17.0 h1:r8bRNjWL3GshPW3gkd+RpvzWrZAwPS49OmTGZ/uhM4k= |
|  |  | golang.org/x/crypto v0.17.0/go.mod h1:gCAAfMLgwOJRpTjQ2zCCt2OcSfYMTeZVSRtQlPC7Nq4= |
|  |  | golang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4= |
|  |  | golang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs= |
|  |  | golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s= |
| Expand Down | |  |

53 changes: 53 additions & 0 deletions

53
[jws/jws\_test.go](#diff-01fafce91c0a9808b43a3370f8af5801149a0418e1d5ac38f883d20bb182c095 "jws/jws_test.go")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/jws/jws_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,6 +32,7 @@ import ( |
|  |  | "github.com/lestrrat-go/jwx/jwk" |
|  |  | "github.com/lestrrat-go/jwx/jws" |
|  |  | "github.com/stretchr/testify/assert" |
|  |  | "github.com/stretchr/testify/require" |
|  |  | ) |
|  |  |  |
|  |  | const examplePayload = `{"iss":"joe",` + "\r\n" + ` "exp":1300819380,` + "\r\n" + ` "http://example.com/is\_root":true}` |
| Expand Down  Expand Up | | @@ -1795,3 +1796,55 @@ func TestGH681(t \*testing.T) { |
|  |  | return |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestEmptyProtectedField(t \*testing.T) { |
|  |  | // MEMO: this was the only test case from the original report |
|  |  | // This passes. It should produce an invalid JWS message, but |
|  |  | // that's not `jws.Parse`'s problem. |
|  |  | \_, err := jws.Parse([]byte(`{"signature": ""}`)) |
|  |  | require.NoError(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // Also test that non-flattened serialization passes. |
|  |  | \_, err = jws.Parse([]byte(`{"signatures": [{}]}`)) |
|  |  | require.NoError(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // MEMO: rest of the cases are present to be extra pedantic about it |
|  |  |  |
|  |  | privKey, err := jwxtest.GenerateRsaJwk() |
|  |  | require.NoError(t, err, `jwxtest.GenerateRsaJwk should succeed`) |
|  |  |  |
|  |  | // This fails. `jws.Parse` works, but the subsequent verification |
|  |  | // workflow fails to verify anything without the presence of a signature or |
|  |  | // a protected header. |
|  |  | \_, err = jws.Verify([]byte(`{"signature": ""}`), jwa.RS256, privKey) |
|  |  | require.Error(t, err, `jws.Parse should fail`) |
|  |  |  |
|  |  | // Create a valid signatre. |
|  |  | signed, err := jws.Sign([]byte("Lorem Ipsum"), jwa.RS256, privKey) |
|  |  | require.NoError(t, err, `jws.Sign should succeed`) |
|  |  |  |
|  |  | \_, payload, signature, err := jws.SplitCompact(signed) |
|  |  | require.NoError(t, err, `jws.SplitCompact should succeed`) |
|  |  |  |
|  |  | // This fails as well. we have a valid signature and a valid |
|  |  | // key to verify it, but no protected headers |
|  |  | \_, err = jws.Verify( |
|  |  | []byte(fmt.Sprintf(`{"signature": "%s"}`, signature)), |
|  |  | jwa.RS256, privKey, |
|  |  | ) |
|  |  | require.Error(t, err, `jws.Verify should fail`) |
|  |  |  |
|  |  | // Test for cases when we have an incomplete compact form JWS |
|  |  | var buf bytes.Buffer |
|  |  | buf.WriteRune('.') |
|  |  | buf.Write(payload) |
|  |  | buf.WriteRune('.') |
|  |  | buf.Write(signature) |
|  |  | invalidMessage := buf.Bytes() |
|  |  |  |
|  |  | // This is an error because the format is simply wrong. |
|  |  | // Whereas in the other JSON-based JWS's case the lack of protected field |
|  |  | // is not a SYNTAX error, this one is, and therefore we barf. |
|  |  | \_, err = jws.Parse(invalidMessage) |
|  |  | require.Error(t, err, `jws.Parse should fail`) |
|  |  | } |

20 changes: 16 additions & 4 deletions

20
[jws/message.go](#diff-53147420851a4a4017650d24d6176ea4a4157d83ef39f852ed74c1c07bc8b27b "jws/message.go")

Show comments

[View file](/lestrrat-go/jwx/blob/8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65/jws/message.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -91,11 +91,13 @@ func (s \*Signature) UnmarshalJSON(data []byte) error { |
|  |  | s.protected = prt |
|  |  | } |
|  |  |  |
|  |  | decoded, err := base64.DecodeString(\*sup.Signature) |
|  |  | if err != nil { |
|  |  | return errors.Wrap(err, `failed to base decode signature`) |
|  |  | if sup.Signature != nil { |
|  |  | decoded, err := base64.DecodeString(\*sup.Signature) |
|  |  | if err != nil { |
|  |  | return errors.Wrap(err, `failed to base decode signature`) |
|  |  | } |
|  |  | s.signature = decoded |
|  |  | } |
|  |  | s.signature = decoded |
|  |  | return nil |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -282,6 +284,11 @@ func (m \*Message) UnmarshalJSON(buf []byte) error { |
|  |  | } |
|  |  | sig.SetDecodeCtx(nil) |
|  |  |  |
|  |  | if sig.protected == nil { |
|  |  | // Instead of barfing on a nil protected header, use an empty header |
|  |  | sig.protected = NewHeaders() |
|  |  | } |
|  |  |  |
|  |  | if i == 0 { |
|  |  | if !getB64Value(sig.protected) { |
|  |  | b64 = false |
| Expand Down  Expand Up | | @@ -317,6 +324,11 @@ func (m \*Message) UnmarshalJSON(buf []byte) error { |
|  |  | sig.protected = prt |
|  |  | } |
|  |  |  |
|  |  | if sig.protected == nil { |
|  |  | // Instead of barfing on a nil protected header, use an empty header |
|  |  | sig.protected = NewHeaders() |
|  |  | } |
|  |  |  |
|  |  | decoded, err := base64.DecodeString(\*mup.Signature) |
|  |  | if err != nil { |
|  |  | return errors.Wrap(err, `failed to base64 decode flattened signature`) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8c53d0a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flestrrat-go%2Fjwx%2Fcommit%2F8c53d0ae52d5ab1e2b37c5abb67def9e7958fd65) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


