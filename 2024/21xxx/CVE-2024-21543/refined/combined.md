=== Content from security.snyk.io_95f094f7_20250114_190525.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [pip](/vuln/pip)
4. djoser
# Authentication Bypass Affecting [djoser](/package/pip/djoser) package, versions **[,2.3.0)**

---

### Severity

 Recommended 0.0high010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-PYTHON-DJOSER-8366540#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.05% (18th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)

* Snyk ID**SNYK-PYTHON-DJOSER-8366540**
* published**12 Dec 2024**
* disclosed**9 Nov 2024**
* credit**Diego Cebrian**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 9 Nov 2024

[CVE-2024-21543  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2024-21543) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-287  (opens in a new tab)](https://cwe.mitre.org/data/definitions/287.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `djoser` to version 2.3.0 or higher.

## Overview

[djoser](https://pypi.org/project/djoser/) is a REST implementation of Django authentication system.

Affected versions of this package are vulnerable to Authentication Bypass when the `authenticate()` function fails. This is because the system falls back to querying the database directly, granting access to users with valid credentials, and eventually bypassing custom authentication checks such as two-factor authentication, LDAP validations, or requirements from configured `AUTHENTICATION_BACKENDS.`

## References

* [GitHub Commit](https://github.com/sunscrapers/djoser/commit/d33c3993c0c735f23cbedc60fa59fce69354f19d)
* [GitHub Issue](https://github.com/sunscrapers/djoser/issues/795)
* [GitHub PR](https://github.com/sunscrapers/djoser/pull/819)
* [GitHub Release](https://github.com/sunscrapers/djoser/releases/tag/2.3.0)
### CVSS Scores

version 4.0version 3.1
### Snyk

 Recommended 7.1 high

* Attack Vector (AV)

  The attack can be performed over the network.

  **Network**
* Attack Complexity (AC)

  The attack does not require special conditions.

  **Low**
* Attack Requirements (AT)

  No special requirements for the attack.

  **None**
* Privileges Required (PR)

  Low-level privileges are required.

  **Low**
* User Interaction (UI)

  No user interaction is required.

  **None**

* Confidentiality (VC)

  Significant impact on confidentiality.

  **High**
* Integrity (VI)

  Limited impact on integrity.

  **Low**
* Availability (VA)

  No impact on availability.

  **None**

* Confidentiality (SC)

  No impact on confidentiality.

  **None**
* Integrity (SI)

  No impact on integrity.

  **None**
* Availability (SA)

  No impact on availability.

  **None**
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_7505c5b5_20250114_190523.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Freleases%2Ftag%2F2.3.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Freleases%2Ftag%2F2.3.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=sunscrapers%2Fdjoser)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sunscrapers](/sunscrapers)
/
**[djoser](/sunscrapers/djoser)**
Public

* [Notifications](/login?return_to=%2Fsunscrapers%2Fdjoser) You must be signed in to change notification settings
* [Fork
  460](/login?return_to=%2Fsunscrapers%2Fdjoser)
* [Star
   2.6k](/login?return_to=%2Fsunscrapers%2Fdjoser)

* [Code](/sunscrapers/djoser/tree/2.3.0)
* [Issues
  150](/sunscrapers/djoser/issues)
* [Pull requests
  38](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects
  0](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

Additional navigation options

* [Code](/sunscrapers/djoser/tree/2.3.0)
* [Issues](/sunscrapers/djoser/issues)
* [Pull requests](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

1. [Releases](/sunscrapers/djoser/releases)
2. [2.3.0](/sunscrapers/djoser/releases/tag/2.3.0)

# 2.3.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/sunscrapers/djoser/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.3.0)

 Loading

[View all tags](/sunscrapers/djoser/tags)

![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)
[tomwojcik](/tomwojcik)
released this
09 Nov 14:33

·
[25 commits](/sunscrapers/djoser/compare/2.3.0...master)
to master
since this release

[2.3.0](/sunscrapers/djoser/tree/2.3.0)

[`db80fc7`](/sunscrapers/djoser/commit/db80fc721290b3acf5cfccaffc6dbd7b2d009947)

* a potentially breaking change: fix vuln where users were given tokens if the given password was correct, but they haven't passed Django internal AUTHENTICATION\_BACKENDS [#795](https://github.com/sunscrapers/djoser/issues/795)

 Assets
2

 Loading

 👍
2
 barseghyanartur and ulgens reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

 2 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c7e93f7d_20250114_190509.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fcommit%2Fd33c3993c0c735f23cbedc60fa59fce69354f19d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fcommit%2Fd33c3993c0c735f23cbedc60fa59fce69354f19d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sunscrapers%2Fdjoser)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sunscrapers](/sunscrapers)
/
**[djoser](/sunscrapers/djoser)**
Public

* [Notifications](/login?return_to=%2Fsunscrapers%2Fdjoser) You must be signed in to change notification settings
* [Fork
  460](/login?return_to=%2Fsunscrapers%2Fdjoser)
* [Star
   2.6k](/login?return_to=%2Fsunscrapers%2Fdjoser)

* [Code](/sunscrapers/djoser)
* [Issues
  150](/sunscrapers/djoser/issues)
* [Pull requests
  38](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects
  0](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

Additional navigation options

* [Code](/sunscrapers/djoser)
* [Issues](/sunscrapers/djoser/issues)
* [Pull requests](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

## Commit

[Permalink](/sunscrapers/djoser/commit/d33c3993c0c735f23cbedc60fa59fce69354f19d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

rollback [8f65bff](https://github.com/sunscrapers/djoser/commit/8f65bfff16577c7fb0f52bbabf5fb69f6809ba62), add support for ModelBackend.user\_can\_authenticate

[Browse files](/sunscrapers/djoser/tree/d33c3993c0c735f23cbedc60fa59fce69354f19d)
Browse the repository at this point in the history

* Loading branch information

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)

[tomwojcik](/sunscrapers/djoser/commits?author=tomwojcik "View all commits by tomwojcik")
committed
May 3, 2024

1 parent
[610c78c](/sunscrapers/djoser/commit/610c78c527d4d2c9d2ec834de4df275851200bfd)

commit d33c399

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**220 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* djoser

  + djoser/serializers.py
    [serializers.py](#diff-5f9ae18efb791553def3d5ecc2c6590ffcb906e53d0a400bcd46787c743743ed)
* testproject/testapp/tests

  + testproject/testapp/tests/test\_token\_create.py
    [test\_token\_create.py](#diff-32468070bde68512ec2192d1d72c2544aa494bdc00f2626c558a6415198a3268)

## There are no files selected for viewing

10 changes: 3 additions & 7 deletions

10
[djoser/serializers.py](#diff-5f9ae18efb791553def3d5ecc2c6590ffcb906e53d0a400bcd46787c743743ed "djoser/serializers.py")

Show comments

[View file](/sunscrapers/djoser/blob/d33c3993c0c735f23cbedc60fa59fce69354f19d/djoser/serializers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -118,17 +118,13 @@ def \_\_init\_\_(self, \*args, \*\*kwargs): |
|  |  |  |
|  |  | def validate(self, attrs): |
|  |  | password = attrs.get("password") |
|  |  | params = {settings.LOGIN\_FIELD: attrs.get(settings.LOGIN\_FIELD)} |
|  |  | params = {"username": attrs.get(settings.LOGIN\_FIELD)} |
|  |  | self.user = authenticate( |
|  |  | request=self.context.get("request"), \*\*params, password=password |
|  |  | ) |
|  |  | if not self.user: |
|  |  | self.user = User.objects.filter(\*\*params).first() |
|  |  | if self.user and not self.user.check\_password(password): |
|  |  | self.fail("invalid\_credentials") |
|  |  | if self.user and self.user.is\_active: |
|  |  | return attrs |
|  |  | self.fail("invalid\_credentials") |
|  |  | self.fail("invalid\_credentials") |
|  |  | return attrs |
|  |  |  |
|  |  |  |
|  |  | class UserFunctionsMixin: |
| Expand Down | |  |

234 changes: 217 additions & 17 deletions

234
[testproject/testapp/tests/test\_token\_create.py](#diff-32468070bde68512ec2192d1d72c2544aa494bdc00f2626c558a6415198a3268 "testproject/testapp/tests/test_token_create.py")

Show comments

[View file](/sunscrapers/djoser/blob/d33c3993c0c735f23cbedc60fa59fce69354f19d/testproject/testapp/tests/test_token_create.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,9 @@ |
|  |  | import django |
|  |  | from unittest import mock |
|  |  |  |
|  |  | from django.conf import settings as django\_settings |
|  |  | from django.contrib.auth import user\_logged\_in, user\_login\_failed |
|  |  | from django.contrib.auth.backends import ModelBackend |
|  |  | from django.test import override\_settings |
|  |  | from djet import assertions |
|  |  | from rest\_framework import status |
| Expand Down  Expand Up | | @@ -37,9 +40,221 @@ def test\_post\_should\_login\_user(self): |
|  |  | self.assertNotEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertTrue(self.signal\_sent) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=[ |
|  |  | "django.contrib.auth.backends.ModelBackend", |
|  |  | ] |
|  |  | ) |
|  |  | @override\_settings( |
|  |  | DJOSER=dict(django\_settings.DJOSER, \*\*{"LOGIN\_FIELD": "username"}) |
|  |  | ) |
|  |  | def test\_post\_should\_not\_login\_if\_model\_backend\_user\_can\_authenticate\_\_LOGIN\_FIELD\_username\_\_USERNAME\_FIELD\_username( # noqa: E501 |
|  |  | self, |
|  |  | ): |
|  |  | user = create\_user() |
|  |  | user\_logged\_in.connect(self.signal\_receiver) |
|  |  | previous\_last\_login = user.last\_login |
|  |  |  |
|  |  | with mock.patch("djoser.serializers.User.USERNAME\_FIELD", "username"): |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_200\_OK) |
|  |  |  |
|  |  | user.refresh\_from\_db() |
|  |  | self.assertEqual(response.data["auth\_token"], user.auth\_token.key) |
|  |  | self.assertNotEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertTrue(self.signal\_sent) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=[ |
|  |  | "django.contrib.auth.backends.ModelBackend", |
|  |  | ] |
|  |  | ) |
|  |  | @override\_settings(DJOSER=dict(django\_settings.DJOSER, \*\*{"LOGIN\_FIELD": "email"})) |
|  |  | def test\_post\_should\_not\_login\_if\_model\_backend\_user\_can\_authenticate\_\_LOGIN\_FIELD\_email\_\_USERNAME\_FIELD\_username( # noqa: E501 |
|  |  | self, |
|  |  | ): |
|  |  | user = create\_user() |
|  |  | user\_logged\_in.connect(self.signal\_receiver) |
|  |  | previous\_last\_login = user.last\_login |
|  |  |  |
|  |  | with mock.patch("djoser.serializers.User.USERNAME\_FIELD", "username"): |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | user.refresh\_from\_db() |
|  |  | self.assertEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertFalse(self.signal\_sent) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=[ |
|  |  | "django.contrib.auth.backends.ModelBackend", |
|  |  | ] |
|  |  | ) |
|  |  | @override\_settings( |
|  |  | DJOSER=dict(django\_settings.DJOSER, \*\*{"LOGIN\_FIELD": "username"}) |
|  |  | ) |
|  |  | def test\_post\_should\_not\_login\_if\_model\_backend\_user\_can\_authenticate\_\_LOGIN\_FIELD\_username\_\_USERNAME\_FIELD\_email( # noqa: E501 |
|  |  | self, |
|  |  | ): |
|  |  | user = create\_user() |
|  |  | user\_logged\_in.connect(self.signal\_receiver) |
|  |  | previous\_last\_login = user.last\_login |
|  |  |  |
|  |  | with mock.patch("djoser.serializers.User.USERNAME\_FIELD", "email"): |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | user.refresh\_from\_db() |
|  |  | self.assertEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertFalse(self.signal\_sent) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=[ |
|  |  | "django.contrib.auth.backends.ModelBackend", |
|  |  | ] |
|  |  | ) |
|  |  | @override\_settings(DJOSER=dict(django\_settings.DJOSER, \*\*{"LOGIN\_FIELD": "email"})) |
|  |  | def test\_post\_should\_not\_login\_if\_model\_backend\_user\_can\_authenticate\_\_LOGIN\_FIELD\_email\_\_USERNAME\_FIELD\_email( # noqa: E501 |
|  |  | self, |
|  |  | ): |
|  |  | user = create\_user() |
|  |  | user\_logged\_in.connect(self.signal\_receiver) |
|  |  | previous\_last\_login = user.last\_login |
|  |  |  |
|  |  | with mock.patch("djoser.serializers.User.USERNAME\_FIELD", "email"): |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, |
|  |  | {"username": user.username, "password": user.raw\_password}, |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=True |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_200\_OK) |
|  |  |  |
|  |  | user.refresh\_from\_db() |
|  |  | self.assertEqual(response.data["auth\_token"], user.auth\_token.key) |
|  |  | self.assertNotEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertTrue(self.signal\_sent) |
|  |  |  |
|  |  | with mock.patch.object( |
|  |  | ModelBackend, "user\_can\_authenticate", return\_value=False |
|  |  | ): |
|  |  | response = self.client.post( |
|  |  | self.base\_url, {"email": user.email, "password": user.raw\_password} |
|  |  | ) |
|  |  | self.assert\_status\_equal(response, status.HTTP\_400\_BAD\_REQUEST) |
|  |  |  |
|  |  | def test\_post\_should\_not\_login\_if\_user\_is\_not\_active(self): |
|  |  | """In Django >= 1.10 authenticate() returns None if user is inactive, |
|  |  | while in Django < 1.10 authenticate() succeeds if user is inactive.""" |
|  |  | user = create\_user() |
|  |  | data = {"username": user.username, "password": user.raw\_password} |
|  |  | user.is\_active = False |
| Expand Down  Expand Up | | @@ -81,18 +296,3 @@ def test\_post\_should\_not\_login\_if\_empty\_request(self): |
|  |  | response.data["non\_field\_errors"], |
|  |  | [settings.CONSTANTS.messages.INVALID\_CREDENTIALS\_ERROR], |
|  |  | ) |
|  |  |  |
|  |  | @override\_settings(DJOSER=dict(django\_settings.DJOSER, \*\*{"LOGIN\_FIELD": "email"})) |
|  |  | def test\_login\_using\_email(self): |
|  |  | user = create\_user() |
|  |  | previous\_last\_login = user.last\_login |
|  |  | data = {"email": user.email, "password": user.raw\_password} |
|  |  | user\_logged\_in.connect(self.signal\_receiver) |
|  |  |  |
|  |  | response = self.client.post(self.base\_url, data) |
|  |  | user.refresh\_from\_db() |
|  |  |  |
|  |  | self.assert\_status\_equal(response, status.HTTP\_200\_OK) |
|  |  | self.assertEqual(response.data["auth\_token"], user.auth\_token.key) |
|  |  | self.assertNotEqual(user.last\_login, previous\_last\_login) |
|  |  | self.assertTrue(self.signal\_sent) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d33c399`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fcommit%2Fd33c3993c0c735f23cbedc60fa59fce69354f19d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d09facb7_20250114_190512.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fissues%2F795)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fissues%2F795)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=sunscrapers%2Fdjoser)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sunscrapers](/sunscrapers)
/
**[djoser](/sunscrapers/djoser)**
Public

* [Notifications](/login?return_to=%2Fsunscrapers%2Fdjoser) You must be signed in to change notification settings
* [Fork
  460](/login?return_to=%2Fsunscrapers%2Fdjoser)
* [Star
   2.6k](/login?return_to=%2Fsunscrapers%2Fdjoser)

* [Code](/sunscrapers/djoser)
* [Issues
  150](/sunscrapers/djoser/issues)
* [Pull requests
  38](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects
  0](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

Additional navigation options

* [Code](/sunscrapers/djoser)
* [Issues](/sunscrapers/djoser/issues)
* [Pull requests](/sunscrapers/djoser/pulls)
* [Discussions](/sunscrapers/djoser/discussions)
* [Actions](/sunscrapers/djoser/actions)
* [Projects](/sunscrapers/djoser/projects)
* [Wiki](/sunscrapers/djoser/wiki)
* [Security](/sunscrapers/djoser/security)
* [Insights](/sunscrapers/djoser/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsunscrapers%2Fdjoser%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsunscrapers%2Fdjoser%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# DJOSER is giving tokens to users that don't pass the AUTHENTICATION\_BACKENDS.authenticate #795

Closed

[hisie](/hisie) opened this issue
Feb 16, 2024
· 7 comments
 · Fixed by [#819](https://github.com/sunscrapers/djoser/pull/819)

Closed

# [DJOSER is giving tokens to users that don't pass the AUTHENTICATION\_BACKENDS.authenticate](#top) #795

[hisie](/hisie) opened this issue
Feb 16, 2024
· 7 comments
 · Fixed by [#819](https://github.com/sunscrapers/djoser/pull/819)

Assignees
[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)

## Comments

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=80&v=4)](/hisie)

Copy link

### **[hisie](/hisie)** commented [Feb 16, 2024](#issue-2138636223) • edited Loading

| [djoser/djoser/serializers.py](https://github.com/sunscrapers/djoser/blob/4452009f628b59f02704373d5e7f991f1243397f/djoser/serializers.py#L127)  Line 127 in [4452009](/sunscrapers/djoser/commit/4452009f628b59f02704373d5e7f991f1243397f)   |  | if self.user and not self.user.check\_password(password): | | --- | --- |      When retrieving a token DJOSER check itself if the password match, or not. If password match, only active or not validation is done.  Django authentication backends propose a set of method to do authentication centralised by backend, while respecting the configuration order (first login accepted first groups and permissions given to the user).  django.contrib.auth.authenticate is used in AUTHENTICATION\_BACKENDShttps://github.com/sunscrapers/djoser/blob/4452009f628b59f02704373d5e7f991f1243397f/djoser/serializers.py#L122. This function call, in the order declared in AUTHENTICATION\_BACKENDS, the authenticate method for each backend.  After checking if the login is correct in all authentication backends, if one user without any permission to get token has a user -password that match, DJOSE give the token.  DJOSER should accept the result of authenticate because developpers can add more condition in the backends to allow user be authenticated. |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=40&v=4)](/hisie)
[hisie](/hisie)
changed the title
~~DJOSER is giving tokens to inactive users and user that don't have the AUTHENTICATION\_BACKENDS.user\_can\_authenticate~~
DJOSER is giving tokens to users that don't pass the AUTHENTICATION\_BACKENDS.authenticate
[Feb 16, 2024](#event-11828986471)

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=80&v=4)](/hisie)

Copy link

Author

### **[hisie](/hisie)** commented [Feb 16, 2024](#issuecomment-1948498990)

| After reading the doc ( <https://djoser.readthedocs.io/en/latest/settings.html#login-field>) I found this setting an overkill feature. If django user model allows setting the login-field, overriding this with another layer while ignoring the authenticate method can give more problems than solutions. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=80&v=4)](/tomwojcik)

Copy link

Contributor

### **[tomwojcik](/tomwojcik)** commented [Mar 31, 2024](#issuecomment-2028694045)

| After reading the doc ( <https://djoser.readthedocs.io/en/latest/settings.html#login-field>) I found this setting an overkill feature. If django user model allows setting the login-field, overriding this with another layer while ignoring the authenticate method can give more problems than solutions.  It literally works the same as Django, as the default of `LOGIN_FIELD` is `USERNAME_FIELD`. I don't understand what your concern is.  Both the title and the OG msg make it sound as if there was a security issue in Djoser. Djoser does NOT allow users to obtain tokens, if they did not pass the `authenticate` check.  Django's default behavior is to pass the provided credentials through all authentication backends until one succeeds. Once a backend successfully authenticates the user, Django doesn't continue to check other backends. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
closed this as [completed](/sunscrapers/djoser/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 31, 2024](#event-12303279822)

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
added
the
[invalid](/sunscrapers/djoser/labels/invalid)
label
[Mar 31, 2024](#event-12303280030)

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=80&v=4)](/hisie)

Copy link

Author

### **[hisie](/hisie)** commented [Apr 1, 2024](#issuecomment-2029981048)

| Djoser does NOT allow users to obtain tokens, if they did not pass the authenticate check.  This is not true: I have tokens sent to users not passing the only valid authenticate in my configuration:  I'm going to show the code. Maybe I'm doing something wrong: Backend authentication configuration: `AUTHENTICATION_BACKENDS = ["user_profile.auth_backend.MyCustomBackendAuthentication"]` Backend authentication:  ``` from django.contrib.auth.backends import ModelBackend   class MyCustomBackendAuthentication(ModelBackend):     def user_can_authenticate(self, user):         """         Reject users with is_active=False or are unsuscribed         """         return super().user_can_authenticate(user) and not user.is_unsuscribed() ```  Use case:  I have an active user that has unsubscribe to my service. user.is\_unsuscribed() is false, so authenticate (<https://github.com/django/django/blob/main/django/contrib/auth/backends.py#L48>) is false because of user\_can\_authenticate is false. He logs in giving correct user and password. My authentication backend says "No, you are unsubscribed, you should not log in", authenticate method (inherited from ModelBackend) says no because of "user\_can\_authenticate". I have only one authentication backend, so this is a definitely "NO".  Expected behaviour:   * DJOSER don't give this user any token, because the only allowed backend says no.   Obtained behaviour:   * DJOSER, knowing that this user has no permission to login (    [djoser/djoser/serializers.py](https://github.com/sunscrapers/djoser/blob/4452009f628b59f02704373d5e7f991f1243397f/djoser/serializers.py#L122)  Line 122   in   [4452009](/sunscrapers/djoser/commit/4452009f628b59f02704373d5e7f991f1243397f)       |  | self.user = authenticate( |   | --- | --- |            returns false because of the custom backend), its do an additional check after the reject from the backend (    [djoser/djoser/serializers.py](https://github.com/sunscrapers/djoser/blob/4452009f628b59f02704373d5e7f991f1243397f/djoser/serializers.py#L127)  Line 127   in   [4452009](/sunscrapers/djoser/commit/4452009f628b59f02704373d5e7f991f1243397f)       |  | if self.user and not self.user.check\_password(password): |   | --- | --- |            ) by simply checking if the user exists (it exists) and if the password is fine( the password is fine) to let an unauthorized user get a user token.   Sorry for the confusion about the LOGIN\_FIELD. I thought it was related to the problem I'm having. |
| --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
reopened this
[Apr 1, 2024](#event-12313277650)

[![@haxoza](https://avatars.githubusercontent.com/u/968786?s=80&v=4)](/haxoza)

Copy link

Member

### **[haxoza](/haxoza)** commented [Apr 3, 2024](#issuecomment-2033892273)

| Thank you [@hisie](https://github.com/hisie) for submitting it and defending your point!  After a brief analysis I think you're right. Djoser should not bypass django's auth backends.  It seems the issue is related to issue [#389](https://github.com/sunscrapers/djoser/issues/389) and commit [8f65bff](https://github.com/sunscrapers/djoser/commit/8f65bfff16577c7fb0f52bbabf5fb69f6809ba62) |
| --- |

All reactions

Sorry, something went wrong.

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=40&v=4)](/hisie)
[hisie](/hisie)
mentioned this issue
[Apr 5, 2024](#ref-pullrequest-2228463575)

[Separate LOGIN\_FIELD logic into a auth backend to avoid giving tokens…
#810](/sunscrapers/djoser/pull/810)
 Open

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=80&v=4)](/hisie)

Copy link

Author

### **[hisie](/hisie)** commented [Apr 10, 2024](#issuecomment-2047093689)

| Hello [@haxoza](https://github.com/haxoza) and [@tomwojcik](https://github.com/tomwojcik) . The ticket was set as invalid before my last answer and after Haxoza comment saying issue and related code is still invalid. I have done a proposal to keep old behaviour by adding a django auth backend. This allows:   * People using current behaviour, easily add the auth backend to keep it working, * People wanting more restricted behaviour, get expected login behaviour by default.   I have added tests to check no bypass is done in default configuration, and to check that custom auth backend works as expected (current behaviour)   Please, tell me if you need anything more to get my pull request acepted. I have not found a PR guide or protocol.  Thank you. |
| --- |

 👍
1
 haxoza reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
removed
the
[invalid](/sunscrapers/djoser/labels/invalid)
label
[May 3, 2024](#event-12698025034)

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=80&v=4)](/tomwojcik)

Copy link

Contributor

### **[tomwojcik](/tomwojcik)** commented [May 3, 2024](#issuecomment-2093386811)

| Thank you [@hisie](https://github.com/hisie) for providing more info. After adding more context, I agree with everything you said. Lets continue the discussion in the PR. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
mentioned this issue
[May 3, 2024](#ref-pullrequest-2278385966)

[use only authenticate for create token
#819](/sunscrapers/djoser/pull/819)
 Merged

[tomwojcik](/tomwojcik)
added a commit
that referenced
this issue
[Jun 7, 2024](#ref-commit-ec6a328)
[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)

`[Merge branch 'master' into feature/](/sunscrapers/djoser/commit/ec6a32852cfca5af3468ab4564b2a5ba8053435e "Merge branch 'master' into feature/#795")[#795](https://github.com/sunscrapers/djoser/issues/795)`

`[ec6a328](/sunscrapers/djoser/commit/ec6a32852cfca5af3468ab4564b2a5ba8053435e)`

[tomwojcik](/tomwojcik)
added a commit
that referenced
this issue
[Jun 7, 2024](#ref-commit-8e0af13)
[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)

`[Merge branch 'refs/heads/master' into feature/](/sunscrapers/djoser/commit/8e0af130c5af7e8f15ab2d41bb63883848bdcf93 "Merge branch 'refs/heads/master' into feature/#795")[#795](https://github.com/sunscrapers/djoser/issues/795)`

`[8e0af13](/sunscrapers/djoser/commit/8e0af130c5af7e8f15ab2d41bb63883848bdcf93)`

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
closed this as [completed](/sunscrapers/djoser/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#819](/sunscrapers/djoser/pull/819)
[Nov 9, 2024](#event-15238450388)

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=80&v=4)](/tomwojcik)

Copy link

Contributor

### **[tomwojcik](/tomwojcik)** commented [Nov 9, 2024](#issuecomment-2466241545)

| Thanks again, released in 2.3.0. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik)
[tomwojcik](/tomwojcik)
self-assigned this
[Nov 9, 2024](#event-15238575066)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsunscrapers%2Fdjoser%2Fissues%2F795)

Assignees

[![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=40&v=4)](/tomwojcik) [tomwojcik](/tomwojcik)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [use only authenticate for create token](/sunscrapers/djoser/pull/819)
 [sunscrapers/djoser](/sunscrapers/djoser)

3 participants

[![@hisie](https://avatars.githubusercontent.com/u/690193?s=52&v=4)](/hisie) [![@haxoza](https://avatars.githubusercontent.com/u/968786?s=52&v=4)](/haxoza) [![@tomwojcik](https://avatars.githubusercontent.com/u/11278746?s=52&v=4)](/tomwojcik)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


