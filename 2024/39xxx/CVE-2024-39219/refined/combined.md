=== Content from www.aginode.support_d201a1ae_20250114_204332.html ===


* [Login](https://www.aginode.support/support/login/ "Login")
* [Register](https://www.aginode.support/support/register/ "Register")

[![LANactive Support Portal](https://www.aginode.support/support/wp-content/uploads/2023/07/AGINODE_logo_horizontal_rgb_orange-darkblue_130x40px.jpg)](https://www.aginode.support/support/ "LANactive Support Portal")

Toggle Navigation

* [Kontakt](https://www.aginode.support/support/kontakt/ "Kontakt")
* [RMA](https://www.aginode.support/support/rma/ "RMA")
* [LANACTIVE Manager](https://www.aginode.support/support/manager/ "LANACTIVE Manager")
* [Firmware](https://www.aginode.support/support/firmware/ "Firmware")
* [SNMP MIBs](https://www.aginode.support/support/snmp-mibs/ "SNMP MIBs")
* [HTTPs](https://www.aginode.support/support/https/ "HTTPs")
* [Documentation](https://www.aginode.support/support/documentation/ "Documentation")
* [Datasheets](https://www.aginode.support/support/datasheets/ "Datasheets")
* [PSIRT](https://www.aginode.support/support/psirt/ "PSIRT")
* [Software](https://www.aginode.support/support/aginode_usb-html/ "Software")
* [FAQ](https://www.aginode.support/support/frequently-asked-questions/ "FAQ")
* [End-of-Life Policy](https://www.aginode.support/support/end-of-life-policy/ "End-of-Life Policy")

# Documentation

**Release Note**

[English](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Release_Notes_English_kd-0558e37_TD.pdf)[Download](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Release_Notes_English_kd-0558e37_TD.pdf)

**Switch Managment Manual**

[English](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Manual_English_kd-0674e32_TD.pdf)[Download](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Manual_English_kd-0674e32_TD.pdf)
[German](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Manual_German_kd-0674d32_TD.pdf)[Download](https://www.aginode.support/support/wp-content/uploads/2024/10/Mgmt_Manual_German_kd-0674d32_TD.pdf)

**LANactive Manager V7 Manual**

[English](https://www.aginode.support/support/wp-content/uploads/2024/09/LANactiveManager_Manual_V7_English_kd-0598e.pdf)[Download](https://www.aginode.support/support/wp-content/uploads/2024/09/LANactiveManager_Manual_V7_English_kd-0598e.pdf)

**LANactive Manager V8 Manual**

[English](https://www.aginode.support/support/wp-content/uploads/2024/09/LANactiveManager_Manual_English_kd-0598e.pdf)[Download](https://www.aginode.support/support/wp-content/uploads/2024/09/LANactiveManager_Manual_English_kd-0598e.pdf)

* E-Mail
* [LinkedIn](https://www.linkedin.com/company/aginode/)
* [Cookie Policy](https://www.aginode.net/en/misc/cookie_policy.html)
* [Pivacy Policy](https://www.aginode.net/en/misc/legal_notice.html)
* [Rate our Service](https://www.aginode.support/support/rate-our-service/)

Register now to get full access.

[Register](https://www.aginode.support/support/register/)

X



=== Content from blog.hackvens.fr_6dfa09d3_20250114_204331.html ===

[Hackvens](/)
üí°/üåô

[<-- home](/)

# advisories / CVE-2024-39967 et CVE-2024-39219 - GigaSwitch

*December 4, 2024*

| Composant vuln√©rable | CVE ID | S√©v√©rit√© de la vuln√©rabilit√© | Auteur |
| --- | --- | --- | --- |
| Aginode GigaSwitch V5 | CVE-2024-39967 | Majeur | Rapha√´l Huon et Christophe Hugueny |
| Aginode GigaSwitch V5 | CVE-2024-39219 | Important | Rapha√´l Huon et Christophe Hugueny |

<https://www.cve.org/CVERecord?id=CVE-2024-39967>

<https://www.cve.org/CVERecord?id=CVE-2024-39219>

## Contexte

Lors d‚Äôune prestation de test intrusion IOT, nous avons eu l‚Äôoccasion de travailler sur le GigaSwitch V5 du constructeur Aginode (anciennement Nexans) : https://www.aginode.support/support/wp-content/uploads/2021/03/DS\_GigaSwitch\_V5\_230VAC\_Series\_FR\_20191129.pdf. Ce dispositif FTTO (Fibre to the office) est destin√© √† amener un acc√®s r√©seau par fibre optique au plus pr√®s des utilisateurs. Lors de la mission, deux vuln√©rabilit√©s ont √©t√© identifi√©es sur la version la plus r√©cente du firmware :

* CVE-2024-39967 : vuln√©rabilit√© majeure permettant de r√©cup√©rer l‚Äôempreinte de mot de passe de l‚Äôadministrateur (ou le mot de passe en clair dans certaines conditions).
* CVE-2024-39219 : vuln√©rabilit√© importante permettant de flasher d‚Äôanciennes versions du firmware sur l‚Äô√©quipement afin de revenir √† une version connue pour √™tre vuln√©rable ([CVE-2022-32985](https://www.cve.org/CVERecord?id=CVE-2022-32985)).

## CVE-2024-39967

Diff√©rentes solutions sont impl√©ment√©es par le constructeur pour administrer le switch : `tftp`, `scp` et le port s√©rie.
Deux niveaux de privil√®ges sont pr√©sents et permettent d‚Äôacc√©der √† diff√©rentes informations : administrateur (acc√®s en lecture et en √©criture) et utilisateur standard (acc√®s en lecture, uniquement de quelques informations). D√ª √† un d√©faut de conception, il a √©t√© prouv√© qu‚Äôun simple utilisateur souhaitant r√©cup√©rer la configuration du switch via le protocole `scp` pouvait r√©cup√©rer l‚Äôempreinte de mot de passe (ou m√™me le mot de passe en clair dans certaines situations) de l‚Äôadministrateur :

```
scp -P 50271 user@<switch-ip>:/cfg ./configFileOutput

```

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/pass.png)

De cette fa√ßon, un utilisateur √† faibles privil√®ges peut r√©cup√©rer l‚Äôempreinte du mot de passe de l‚Äôadministrateur. D‚Äôapr√®s la documentation de l‚Äô√©diteur, plusieurs protocoles sont utilis√©s pour stocker le mot de passe de mani√®re s√©curis√©e :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/encrypt.png)

Le protocole d√©fini d√©faut est ‚Äústandard‚Äù. La documentation explique que celui-ci n‚Äôest pas suffisamment s√©curis√© et qu‚Äôil est d√©conseill√© de l‚Äôutiliser. En effet, lors de notre test le protocole par d√©faut n‚Äôavait pas √©t√© modifi√© et nous avons ainsi r√©cup√©r√© le mot de passe en clair dans la configuration.
Le mot de passe par d√©faut du compte simple utilisateur √©tant ‚Äúnexans‚Äù, si celui-ci n‚Äôest pas modifi√© lors du d√©ploiement de l‚Äô√©quipement, il est possible pour un attaquant de l‚Äôutiliser pour r√©cup√©rer les informations d‚Äôauthentification de l‚Äôadministrateur et d‚Äôen prendre le contr√¥le.

## CVE-2024-39219

En 2022, un chercheur a d√©couvert une vuln√©rabilit√© affectant toutes les versions avant `V6.02N`, `V7.02` : https://sec-consult.com/vulnerability-lab/advisory/hardcoded-backdoor-user-outdated-software-components-nexans-ftto-gigaswitch/. Un serveur SSH *Dropbear* √©tait expos√© sur le port 50200 de l‚Äôappareil et un compte root dont le mot de passe √©tait cod√© en dur dans le firmware permettait de s‚Äôy connecter. Une fois les pleins privil√®ges obtenus, il √©tait alors possible de compromettre enti√®rement l‚Äô√©quipement.
Lors de nos tests, les √©quipements √©taient √† jour et donc non vuln√©rables √† la CVE-2022-32985. Nous avons donc cherch√© √† voir si le m√©canisme de mise √† jour du switch permettait de flasher des versions plus anciennes. Avec un compte administrateur, il est possible de mettre √† jour le firmware en envoyant un fichier de mise √† jour SWU via le protocole SCP :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/update.png)

Apr√®s un red√©marrage, la mise √† jour a bien √©t√© pris en compte et nous avons r√©trograd√© l‚Äô√©quipement vers la version `V6.0.2N` :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/new-version.png)

Il est d√©sormais possible de d√©marrer le serveur SSH de debug gr√¢ce √† la commande suivante puis de s‚Äôy connecter en tant que root pour prendre le contr√¥le de l‚Äô√©quipement :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/dropbear.png)

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/passwd.png)

## Corrections

Le constructeur a √©t√© tr√®s r√©actif sur les vuln√©rabilit√©s identifi√©es et apr√®s diff√©rents √©changes, celles-ci ont √©t√© corrig√©es. Aginode a √©galement proc√©d√© au chiffrement de ses futurs firmware, la proc√©dure pour passer sur ces mises √† jour chiffr√©es est d√©taill√©e sur le site du constructeur : https://www.aginode.support/support/wp-content/uploads/2024/11/EN\_11\_FAQ\_SW\_Update\_Best\_Practices.pdf

### CVE-2024-39967

Depuis la version `V7.07ev` du firmware, il n‚Äôest maintenant plus possible de r√©cup√©rer le mot de passe en clair ou l‚Äôempreinte du mot de passe de l‚Äôadministrateur depuis un compte peu privil√©gi√© :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/corr1.png)

### CVE-2024-39219

Depuis la version `V7.07ev` du firmware, l‚Äô√©diteur a ajout√© une fonctionnalit√© emp√™chant le downgrade de firmware :

![](/assets/img/advisories/cve-2024-39967-cve-2024-39219/corr2.png)

## Chronologie

| Date | Description |
| --- | --- |
| 12/02/2024 | D√©couverte des vuln√©rabilit√©s |
| 18/04/2024 | Premier contact au sujet des vuln√©rabilit√©s avec les √©quipes d‚ÄôAginode |
| 19/04/2024 | Prise en compte des vuln√©rabilit√©s et pr√©paration d‚Äôun correctif |
| 08/11/2024 | Publication des correctifs |
| 05/12/2024 | Publication des deux CVE |


