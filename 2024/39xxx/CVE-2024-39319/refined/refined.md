```
{
  "vulnerability": {
    "root_cause": "The vulnerability stems from an insecure direct object reference (IDOR) in the account profile page, specifically in the review and subscription management functionalities.",
    "weaknesses": [
      "CWE-639",
      "Insecure Direct Object Reference"
    ],
    "impact": "An attacker can exploit the IDOR vulnerability to disable subscriptions and delete reviews belonging to other customers.",
    "attack_vectors": [
      "Network"
    ],
    "attacker_capabilities": "The attacker does not need any privileges or user interaction and can exploit this vulnerability remotely."
  },
  "commits": [
    {
      "commit_id": "6ea6b82f5a1fc18c574cb6f97225930d139b14a5",
      "description": "Fix: Check customer before deleting reviews\n The review delete function was modified to verify if the logged in user is the owner of review before allowing the delete operation.",
      "changes": [
        {
          "file": "src/Controller/Frontend/Review/Standard.php",
          "original_line": "216",
          "diff_line": "216",
          "change": "- $filter = $this->manager->filter()->add( [ 'review.id' => $ids ] );\n+ $filter = $this->manager->filter()->add( [ 'review.id' => $ids, 'review.customerid' => $this->context()->user() ] );"
        }
      ]
    },
    {
      "commit_id": "2ad5c062a629af374da470a319914c321c9bfee2",
      "description": "Fix: Check customer before deleting reviews\n The review delete function was modified to verify if the logged in user is the owner of review before allowing the delete operation.",
       "changes": [
        {
          "file": "src/Controller/Frontend/Review/Standard.php",
          "original_line": "216",
          "diff_line": "216",
          "change": "- $filter = $this->manager->filter()->add( [ 'review.id' => $ids ] );\n+ $filter = $this->manager->filter()->add( [ 'review.id' => $ids, 'review.customerid' => $this->context()->user() ] );"
        }
       ]
    },
        {
      "commit_id": "5833db6d18a889b94dc036dfb84b6f5cca73fbac",
      "description": "Fix: Check user before canceling subscription\n The subscription cancel function was modified to verify if the logged in user is the owner of subscription before allowing the cancel operation.",
      "changes": [
        {
          "file": "controller/frontend/src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "58",
           "diff_line": "58",
          "change": "- $item = $this->manager->getItem( $id );\n+ $item = $this->getObject()->get( $id );"
        }
      ]
    },
    {
      "commit_id": "f7c6a9ce2a6f5a9ad4af31313508870a78398f85",
      "description": "Fix: Check customer before deleting reviews\n The review delete function was modified to verify if the logged in user is the owner of review before allowing the delete operation.",
       "changes": [
        {
          "file": "src/Controller/Frontend/Review/Standard.php",
          "original_line": "218",
           "diff_line": "218",
          "change": "- $filter = $this->manager->filter()->add( [ 'review.id' => $ids ] );\n+ $filter = $this->manager->filter()->add( [ 'review.id' => $ids, 'review.customerid' => $this->context()->user() ] );"
        }
      ]
    },
    {
      "commit_id": "d4eac06f3a25330c089d8be4397f2ab1936dd9bb",
      "description": "Fix: Check user before canceling subscription\n The subscription cancel function was modified to verify if the logged in user is the owner of subscription before allowing the cancel operation.",
       "changes": [
        {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
           "original_line": "169",
           "diff_line": "169",
          "change": "- $item = $this->manager->get( $id );\n+ $item = $this->object()->get( $id );"
        },
                {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "201",
          "diff_line": "202",
          "change": "-        'order.customerid' => $userId,\n+        'order.customerid' => $user,"
         },
                 {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "210",
          "diff_line": "210",
           "change":"- throw new \\Aimeos\\Controller\\Frontend\\Subscription\\Exception( sprintf( $msg, $id, $userId ) );\n+ throw new \\Aimeos\\Controller\\Frontend\\Subscription\\Exception( sprintf( $msg, $id, $user ) );"
        }
      ]
    },
    {
      "commit_id": "53eebdc51fae34440dfd768a7811c169c7779aa9",
       "description": "Fix: Check user before canceling subscription\n The subscription cancel function was modified to verify if the logged in user is the owner of subscription before allowing the cancel operation.",
      "changes": [
        {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "169",
          "diff_line": "169",
          "change": "- $item = $this->manager->get( $id );\n+ $item = $this->object()->get( $id );"
        }
      ]
    },
    {
      "commit_id":"700da5ea2b622724b68c8684346bf74ac3bbca9b",
       "description": "Fix: Check customer before deleting reviews\n The review delete function was modified to verify if the logged in user is the owner of review before allowing the delete operation.",
      "changes": [
        {
          "file": "controller/frontend/src/Controller/Frontend/Review/Standard.php",
          "original_line": "106",
          "diff_line":"106",
          "change": "- $filter = $this->manager->filter()->add( [ 'review.id' => $ids ] );\n+ $filter = $this->manager->filter()->add( [ 'review.id' => $ids, 'review.customerid' => $this->context()->user() ] );"
        }
      ]
    },
        {
      "commit_id":"ae7baa3f2fbf594c2c1e4b1aae83364a84b241a6",
       "description": "Fix: Check user before canceling subscription\n The subscription cancel function was modified to verify if the logged in user is the owner of subscription before allowing the cancel operation.",
      "changes": [
        {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
           "original_line": "169",
           "diff_line": "169",
          "change": "- $item = $this->manager->get( $id );\n+ $item = $this->object()->get( $id );"
        },
                 {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "201",
           "diff_line":"202",
          "change": "-        'order.customerid' => $userId,\n+        'order.customerid' => $user,"
         },
          {
          "file": "src/Controller/Frontend/Subscription/Standard.php",
           "original_line": "210",
          "diff_line":"210",
          "change":"- throw new \\Aimeos\\Controller\\Frontend\\Subscription\\Exception( sprintf( $msg, $id, $userId ) );\n+ throw new \\Aimeos\\Controller\\Frontend\\Subscription\\Exception( sprintf( $msg, $id, $user ) );"
        }
      ]
    },
    {
      "commit_id":"cd8c95aa4663f54bd66a69c5952f2e42405426f3",
       "description": "Fix: Check customer before deleting reviews\n The review delete function was modified to verify if the logged in user is the owner of review before allowing the delete operation.",
      "changes": [
        {
          "file": "controller/frontend/src/Controller/Frontend/Review/Standard.php",
          "original_line":"107",
          "diff_line":"107",
           "change": "- $filter = $this->manager->filter()->add( [ 'review.id' => $ids ] );\n+ $filter = $this->manager->filter()->add( [ 'review.id' => $ids, 'review.customerid' => $this->context()->user() ] );"
        }
      ]
    },
    {
      "commit_id":"7c93139f86eff9ec26b117a8918e06ce6cc0000f",
        "description": "Fix: Check user before canceling subscription\n The subscription cancel function was modified to verify if the logged in user is the owner of subscription before allowing the cancel operation.",
      "changes": [
        {
          "file": "controller/frontend/src/Controller/Frontend/Subscription/Standard.php",
          "original_line": "57",
           "diff_line":"57",
          "change":"- $item = $this->manager->get( $id );\n+ $item = $this->getObject()->get( $id );"
        }
      ]
    }
  ]
}
```