=== Content from github.com_14c799b6_20250114_183937.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbinux%2Fpyspider%2Fblob%2Fmaster%2Fpyspider%2Fwebui%2Fdebug.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbinux%2Fpyspider%2Fblob%2Fmaster%2Fpyspider%2Fwebui%2Fdebug.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=binux%2Fpyspider)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jun 10, 2024. It is now read-only.

[binux](/binux)
/
**[pyspider](/binux/pyspider)**
Public archive

* [Notifications](/login?return_to=%2Fbinux%2Fpyspider) You must be signed in to change notification settings
* [Fork
  3.7k](/login?return_to=%2Fbinux%2Fpyspider)
* [Star
   16.5k](/login?return_to=%2Fbinux%2Fpyspider)

* [Code](/binux/pyspider)
* [Issues
  274](/binux/pyspider/issues)
* [Pull requests
  28](/binux/pyspider/pulls)
* [Actions](/binux/pyspider/actions)
* [Projects
  0](/binux/pyspider/projects)
* [Security](/binux/pyspider/security)
* [Insights](/binux/pyspider/pulse)

Additional navigation options

* [Code](/binux/pyspider)
* [Issues](/binux/pyspider/issues)
* [Pull requests](/binux/pyspider/pulls)
* [Actions](/binux/pyspider/actions)
* [Projects](/binux/pyspider/projects)
* [Security](/binux/pyspider/security)
* [Insights](/binux/pyspider/pulse)

## Files

 master
## Breadcrumbs

1. [pyspider](/binux/pyspider/tree/master)
2. /[pyspider](/binux/pyspider/tree/master/pyspider)
3. /[webui](/binux/pyspider/tree/master/pyspider/webui)
/
# debug.py

Copy path Blame  Blame
## Latest commit

## History

[History](/binux/pyspider/commits/master/pyspider/webui/debug.py)220 lines (191 loc) · 7.13 KB master
## Breadcrumbs

1. [pyspider](/binux/pyspider/tree/master)
2. /[pyspider](/binux/pyspider/tree/master/pyspider)
3. /[webui](/binux/pyspider/tree/master/pyspider/webui)
/
# debug.py

Top
## File metadata and controls

* Code
* Blame

220 lines (191 loc) · 7.13 KB[Raw](https://github.com/binux/pyspider/raw/refs/heads/master/pyspider/webui/debug.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220#!/usr/bin/env python# -\*- encoding: utf-8 -\*-# vim: set et sw=4 ts=4 sts=4 ff=unix fenc=utf8:# Author: Binux<i@binux.me># http://binux.me# Created on 2014-02-23 00:19:06
import sysimport timeimport socketimport inspectimport datetimeimport tracebackfrom flask import render\_template, request, json
try: import flask\_login as loginexcept ImportError: from flask.ext import login
from pyspider.libs import utils, sample\_handler, dataurlfrom pyspider.libs.response import rebuild\_responsefrom pyspider.processor.project\_module import ProjectManager, ProjectFinderfrom .app import app
default\_task = { 'taskid': 'data:,on\_start', 'project': '', 'url': 'data:,on\_start', 'process': { 'callback': 'on\_start', },}default\_script = inspect.getsource(sample\_handler)
@app.route('/debug/<project>', methods=['GET', 'POST'])def debug(project): projectdb = app.config['projectdb'] if not projectdb.verify\_project\_name(project): return 'project name is not allowed!', 400 info = projectdb.get(project, fields=['name', 'script']) if info: script = info['script'] else: script = (default\_script .replace('\_\_DATE\_\_', datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")) .replace('\_\_PROJECT\_NAME\_\_', project) .replace('\_\_START\_URL\_\_', request.values.get('start-urls') or '\_\_START\_URL\_\_'))
 taskid = request.args.get('taskid') if taskid: taskdb = app.config['taskdb'] task = taskdb.get\_task( project, taskid, ['taskid', 'project', 'url', 'fetch', 'process']) else: task = default\_task
 default\_task['project'] = project return render\_template("debug.html", task=task, script=script, project\_name=project)
@app.before\_first\_requestdef enable\_projects\_import(): sys.meta\_path.append(ProjectFinder(app.config['projectdb']))
@app.route('/debug/<project>/run', methods=['POST', ])def run(project): start\_time = time.time() try: task = utils.decode\_unicode\_obj(json.loads(request.form['task'])) except Exception: result = { 'fetch\_result': "", 'logs': u'task json error', 'follows': [], 'messages': [], 'result': None, 'time': time.time() - start\_time, } return json.dumps(utils.unicode\_obj(result)), \ 200, {'Content-Type': 'application/json'}
 project\_info = { 'name': project, 'status': 'DEBUG', 'script': request.form['script'], }
 if request.form.get('webdav\_mode') == 'true': projectdb = app.config['projectdb'] info = projectdb.get(project, fields=['name', 'script']) if not info: result = { 'fetch\_result': "", 'logs': u' in wevdav mode, cannot load script', 'follows': [], 'messages': [], 'result': None, 'time': time.time() - start\_time, } return json.dumps(utils.unicode\_obj(result)), \ 200, {'Content-Type': 'application/json'} project\_info['script'] = info['script']
 fetch\_result = {} try: module = ProjectManager.build\_module(project\_info, { 'debugger': True, 'process\_time\_limit': app.config['process\_time\_limit'], })
 # The code below is to mock the behavior that crawl\_config been joined when selected by scheduler. # but to have a better view of joined tasks, it has been done in BaseHandler.crawl when `is\_debugger is True` # crawl\_config = module['instance'].crawl\_config # task = module['instance'].task\_join\_crawl\_config(task, crawl\_config)
 fetch\_result = app.config['fetch'](task) response = rebuild\_response(fetch\_result)
 ret = module['instance'].run\_task(module['module'], task, response) except Exception: type, value, tb = sys.exc\_info() tb = utils.hide\_me(tb, globals()) logs = ''.join(traceback.format\_exception(type, value, tb)) result = { 'fetch\_result': fetch\_result, 'logs': logs, 'follows': [], 'messages': [], 'result': None, 'time': time.time() - start\_time, } else: result = { 'fetch\_result': fetch\_result, 'logs': ret.logstr(), 'follows': ret.follows, 'messages': ret.messages, 'result': ret.result, 'time': time.time() - start\_time, } result['fetch\_result']['content'] = response.text if (response.headers.get('content-type', '').startswith('image')): result['fetch\_result']['dataurl'] = dataurl.encode( response.content, response.headers['content-type'])
 try: # binary data can't encode to JSON, encode result as unicode obj # before send it to frontend return json.dumps(utils.unicode\_obj(result)), 200, {'Content-Type': 'application/json'} except Exception: type, value, tb = sys.exc\_info() tb = utils.hide\_me(tb, globals()) logs = ''.join(traceback.format\_exception(type, value, tb)) result = { 'fetch\_result': "", 'logs': logs, 'follows': [], 'messages': [], 'result': None, 'time': time.time() - start\_time, } return json.dumps(utils.unicode\_obj(result)), 200, {'Content-Type': 'application/json'}
@app.route('/debug/<project>/save', methods=['POST', ])def save(project): projectdb = app.config['projectdb'] if not projectdb.verify\_project\_name(project): return 'project name is not allowed!', 400 script = request.form['script'] project\_info = projectdb.get(project, fields=['name', 'status', 'group']) if project\_info and 'lock' in projectdb.split\_group(project\_info.get('group')) \ and not login.current\_user.is\_active(): return app.login\_response
 if project\_info: info = { 'script': script, } if project\_info.get('status') in ('DEBUG', 'RUNNING', ): info['status'] = 'CHECKING' projectdb.update(project, info) else: info = { 'name': project, 'script': script, 'status': 'TODO', 'rate': app.config.get('max\_rate', 1), 'burst': app.config.get('max\_burst', 3), } projectdb.insert(project, info)
 rpc = app.config['scheduler\_rpc'] if rpc is not None: try: rpc.update\_project() except socket.error as e: app.logger.warning('connect to scheduler rpc error: %r', e) return 'rpc error', 200
 return 'ok', 200
@app.route('/debug/<project>/get')def get\_script(project): projectdb = app.config['projectdb'] if not projectdb.verify\_project\_name(project): return 'project name is not allowed!', 400 info = projectdb.get(project, fields=['name', 'script']) return json.dumps(utils.unicode\_obj(info)), \ 200, {'Content-Type': 'application/json'}
@app.route('/blank.html')def blank\_html(): return ""

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.sonarsource.com_5a9187cd_20250114_183938.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Basic HTTP Authentication Risk: Uncovering pyspider Vulnerabilities

![](data:image/svg+xml;charset=utf-8...)![Yaniv Nizry photo]()![Yaniv Nizry photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/dd553287-d805-4e36-8f4f-17f11fbc1bea/Potrait_square.jpg?w=800&h=800&auto=format&fit=crop)

Yaniv Nizry

Vulnerability Researcher

September 2, 2024

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e503a8d1-03d9-4413-a51b-2e897698ac0c/pyspider_vulnerabilities_landscape_index.webp?w=2400&h=1256&auto=format&fit=crop)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e503a8d1-03d9-4413-a51b-2e897698ac0c/pyspider_vulnerabilities_landscape_index.webp?w=2400&h=1256&auto=format&fit=crop)

[pyspider](https://docs.pyspider.org/en/latest/ "pyspider") is a powerful and versatile web crawling framework that caters to various use cases. With its user-friendly approach, robust features, and extensive support for different technologies, it's a great choice for developers who want to build reliable and efficient web scrapers in Python. Unfortunately in the last years, the project was neglected and left unmaintained, and as a result of our reporting, the maintainer archived the GitHub repository to highlight that the project is not updated anymore. This also means that security vulnerabilities are not fixed.

Driven by our dedication to both open-source security and the advancement of our Clean Code technology, we leverage [SonarQube Cloud](https://sonarcloud.io/ "SonarQube Cloud") to conduct frequent vulnerability scans on open-source projects. This not only benefits the broader open-source community but also strengthens our own tools – and the best part? SonarQube Cloud offers free code analysis for any open-source project, making it accessible to everyone.

This article delves into the consequences of vulnerabilities found by our engine and uncovers the risk of using basic HTTP authentication. We'll also explore how attackers might leverage this vulnerability.

## Impact

An attacker might manipulate an authenticated victim to click on a malicious link, resulting in code execution on the host running pyspider. After we reported our findings, the maintainer has archived the repository on GitHub, making sure users are aware the project isn’t supported anymore (refer to the [Patch](#patch "Patch") and [Timeline](#timeline "Timeline") sections for more info).

## Technical Details

In this section, we will cover the technical details of the findings, and interesting security information for developers opting to use the basic HTTP authentication in their application.

### Background

Before delving into the details of the findings, we first need to understand some basic features of the application. pyspider provides users with a convenient [WebUI component](https://docs.pyspider.org/en/latest/Command-Line/#webui "WebUI component") that allows project management, task monitoring, viewing results, and crawl script code editors. From a security point of view, the code editor feature allows running arbitrary Python code on the machine through the web interface, by design. To protect an externally exposed instance, pyspider offers the ability to enable authentication via the [--need-auth](https://docs.pyspider.org/en/latest/Command-Line/#-need-auth "--need-auth") flag.

### Discovering vulnerabilities

SonarQube Cloud, our cloud-based code analysis service, employs cutting-edge static analysis techniques to identify quality issues, bugs, and security weaknesses within your code. During a routine scan of public open-source projects, SonarQube Cloud identified the following issues in pyspider's WebUI component ([see it yourself on SonarQube Cloud](https://sonarcloud.io/project/issues?resolved=false&types=VULNERABILITY&id=SonarSourceResearch_pyspider-blogpost&open=AY9xKZX48flNzQPVUOH6 "see it yourself on SonarQube Cloud")):

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aaa3c4d9-505e-413c-81df-9bca1c73fe2d/dashboard_sonar.png?w=1178&h=708&auto=format&fit=crop)

The first one is a detected vulnerability covering a Cross-Site Scripting (XSS) reflection on the `/update` route via the `name` parameter:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/d9430d1e-330d-45ad-ae10-3b7477cc1659/XSS_sonar.png?w=1999&h=1406&auto=format&fit=crop)

The second finding is a security hotspot warning us that there is a risk of Cross-Site Request Forgery (CSRF) when using Flask without any protection.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/17ea3d24-1bda-44fd-a1cb-7910043745f5/CSRF_sonar.png?w=1790&h=1090&auto=format&fit=crop)

The key distinction between a hotspot and a vulnerability lies in the **immediacy of the security risk**. ([read more in the official documentation](https://docs.sonarsource.com/sonarqube/latest/user-guide/security-hotspots/#vulnerability-or-hotspot "read more in the official documentation"))

* **Hotspot:** A hotspot flags a potentially risky code section that might become a vulnerability in certain contexts. It's like a yellow traffic light – proceed with caution and review the code. The overall application security might not be compromised, but further analysis is recommended.
* **Vulnerability:** A detected vulnerability represents a high likelihood of a security weakness that can be exploited by attackers. It's akin to a red traffic light – stop and fix the issue immediately. Vulnerabilities pose a clear and present danger to the application's security.

Let's consider a CSRF hotspot rule:
The scanner might highlight a POST endpoint that doesn't include a CSRF token. This is a hotspot because, without a token, an attacker could potentially craft a malicious request that tricks a user's browser into submitting the form unintentionally. However, a CSRF attack can be mitigated already depending on the cookie’s [SameSite](https://web.dev/articles/samesite-cookies-explained "SameSite") type used in the application. Or, the application logic of that endpoint doesn't have any security impact nor require authentication in the first place. For those reasons, it might be considered a low-priority hotspot for review, depending on the specific context of the application.

### Basic HTTP authentication CSRF (CVE-2024-39163)

In the case of pyspider, the hotspot was relevant and exploitable. As mentioned before, access to the pyspider WebUI is equivalent to code execution. In instances where authentication is not enabled, it's considered a risk introduced by the pyspider user rather than a vulnerability. We are interested to see what can go wrong if authentication is enabled.

Before trying to validate the CSRF hotspot, let's see how pyspider implements authentication. Setting up the application using the `--need-auth` flag, and trying to access the web interface we are introduced to the following browser-default login prompt:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/1e4e3dc9-f178-44cb-9399-3b51bdfe34a5/login_prompt.png?w=1764&h=1272&auto=format&fit=crop)

This authentication method is used under the hood is [*Basic HTTP authentication*](https://datatracker.ietf.org/doc/html/rfc7617 "Basic HTTP authentication"). While this is a rather legacy authentication mechanism it is still supported by modern browsers. On top of that they handle it conveniently, by using the built-in UI prompt and sending the credentials in the subsequent requests via the `Authorization` header:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/4858d20d-ac35-48de-a76c-564ce972f76c/network_flow.png?w=1600&h=698&auto=format&fit=crop)

Unlike the other common way of authentication and maintaining a session via cookies, the browser doesn't implement any CSRF mitigation for the basic HTTP authentication and the corresponding `Authorization` header, such as [SameSite cookies](https://web.dev/articles/samesite-cookies-explained "SameSite cookies"). The browser adds the `Authorization` header containing the Basic auth credentials to all cross-site requests as well. This means that the only thing standing between a CSRF vulnerability and the application are mitigations on the endpoint level (a [CSRF token](https://portswigger.net/web-security/csrf#:~:text=Common%20defences%20against%20CSRF "CSRF token"), for instance).

Because no mitigation steps are taken, an attacker would just need to understand which requests are made to execute arbitrary code on the machine and craft a malicious website that replicates them, exploiting the CSRF vulnerability. Manipulating an authenticated victim to visit the attacker’s website will result in arbitrary code execution.

### Reflected XSS Vulnerability (CVE-2024-39162)

The second detected vulnerability reported by SonarQube Cloud is an XSS in the `/update` endpoint.

```
@app.route('/update', methods=['POST', ])
def project_update():
    # ...
    name = request.form['name']
    # ...
    if name not in ('group', 'status', 'rate'):
        return 'unknown field: %s' % name, 400
```

This simple example showcases how a reflected XSS looks like on the code level. A parameter is taken from the request (a user input) and if certain conditions match, the value is reflected back to the user.

While this is a `POST`-only endpoint, an attacker cannot simply craft a malicious link with a reflected XSS payload, but by leveraging the first finding, an attacker can create a malicious website that uses CSRF and elevate it to XSS. From there, code execution on the server is an intended feature.

### Patch

After disclosing the vulnerabilities the maintainer stated that this project is no longer maintained and archived the repository on GitHub as a result. We recommend avoiding using unmaintained code, or as a last resort, disabling the *WebUI* component of pyspider.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2024-04-03 | We reported all issues to the maintainers |
| 2024-04-29 | We pinged the maintainers |
| 2024-05-03 | We pinged the maintainers again mentioning that 60 days had passed |
| 2024-06-03 | We notified the maintainers that the [90-day disclosure](https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-policy.html) window has passed and we will release a blog post about the findings |
| 2024-06-11 | The maintainer stated the project is unmaintained and archived the repository |
| 2024-07-05 | CVE-2024-39163 and CVE-2024-39162 were assigned |

## Summary

This blog post delves into the critical role of code analysis in safeguarding applications. We showcase the power of SonarQube Cloud, our cloud-based service that identifies security vulnerabilities often buried within your codebase. SonarQube Cloud ensures Clean Code practices enhancing code readability, maintainability, and security. Clean code and proactive code analysis empower developers to build more secure applications.

We explored real-world examples of vulnerabilities unearthed by SonarQube Cloud, highlighting the potential dangers they pose. And explained how legacy basic HTTP authentication could be convenient to use but might contain some security risks. Additionally, we demonstrated the differences between a “vulnerability” finding vs a “hotspot”, and why developers shouldn’t neglect them.

## Related Blog Posts

* [Dangerous Import: SourceForge Patches Critical Code Vulnerability](https://www.sonarsource.com/blog/dangerous-import-sourceforge-patches-critical-code-vulnerability/ "Dangerous Import: SourceForge Patches Critical Code Vulnerability")
* [Parallel Code Security: The Challenge of Concurrency](https://www.sonarsource.com/blog/avocado-nightmare-2/ "Parallel Code Security: The Challenge of Concurrency")
* [Apache Dubbo Consumer Risks: The Road Not Taken](https://www.sonarsource.com/blog/apache-dubbo-consumer-risks/ "Apache Dubbo Consumer Risks: The Road Not Taken")
* [Micro Services, Major Headaches: Detecting Vulnerabilities in Erxes' Microservices](https://www.sonarsource.com/blog/micro-services-major-headaches-detecting-vulnerabilities-in-erxes-microservices/ "Micro Services, Major Headaches: Detecting Vulnerabilities in Erxes' Microservices")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail
## Get new blogs delivered directly to your inbox!

Stay up-to-date with the latest Sonar content. Subscribe now to receive the latest blog articles.

Email\*cheqSign up

By submitting this form, you agree to the storing and processing of your personal data as described in the [Privacy Policy](/company/privacy/ "Privacy Policy") and [Cookie Policy](/company/cookie-policy/ "Cookie Policy"). You can withdraw your consent by unsubscribing at any time.

This site is protected by reCAPTCHA and the Google [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms) apply.

[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


