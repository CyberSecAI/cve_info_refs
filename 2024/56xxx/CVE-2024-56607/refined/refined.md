The provided content relates to CVE-2024-56607.

**Root cause of vulnerability:**
The vulnerability arises from the use of `ieee80211_iterate_stations_atomic` within the `ath12k_mac_op_set_bitrate_mask` function in the ath12k driver. This function is called when manually setting bitrates using the `iw` command, leading to a sleeping function being called from an invalid context. The `ieee80211_iterate_stations_atomic` function is intended for use in atomic contexts, but in this case it is called while holding other locks.

**Weaknesses/vulnerabilities present:**
The core weakness is the incorrect usage of `ieee80211_iterate_stations_atomic` in a context where it can cause a sleep and deadlock due to existing lock acquisitions. The correct function `ieee80211_iterate_stations_mtx` should be used in this scenario because it ensures that all locks required to perform the iteration are acquired and released in a safe way.

**Impact of exploitation:**
The immediate impact of this issue is a kernel panic and system crash, triggered by calling a sleeping function from invalid context. Specifically, the system freezes due to a lockup and a sleeping function being called from an atomic context. This can happen when using the `iw` command to set bitrates.

**Attack vectors:**
The attack vector involves a user with sufficient privileges to execute the `iw` command to manually set bitrates on a wireless interface.

**Required attacker capabilities/position:**
The attacker needs to be able to execute commands on the system, specifically the `iw` command, and needs to have the ability to manipulate wireless network interfaces. They must be able to trigger setting a bitrate on an interface that utilizes the affected ath12k driver and firmware.