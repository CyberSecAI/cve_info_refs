=== Content from git.kernel.org_a440f7d7_20250114_220549.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Helge Deller <deller@gmx.de> | 2024-11-14 15:26:27 +0100 |
| commit | [f89d17ae2ac42931be2a0153fecbf8533280c927](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f89d17ae2ac42931be2a0153fecbf8533280c927) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)) | |
| tree | [e3fc1273e27cb2d83305fb501f5e207c6647873a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f89d17ae2ac42931be2a0153fecbf8533280c927) | |
| parent | [2d5404caa8c7bb5c4e0435f94b28834ae5456623](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2d5404caa8c7bb5c4e0435f94b28834ae5456623) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f89d17ae2ac42931be2a0153fecbf8533280c927&id2=2d5404caa8c7bb5c4e0435f94b28834ae5456623)) | |
| download | [linux-f89d17ae2ac42931be2a0153fecbf8533280c927.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f89d17ae2ac42931be2a0153fecbf8533280c927.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f89d17ae2ac42931be2a0153fecbf8533280c927)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=f89d17ae2ac42931be2a0153fecbf8533280c927) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 3d2a27fefc874a..130adef2e46869 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=2d5404caa8c7bb5c4e0435f94b28834ae5456623)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=f89d17ae2ac42931be2a0153fecbf8533280c927)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:26 +0000



=== Content from git.kernel.org_5e89810a_20250114_220541.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:32:21 +0100 |
| commit | [3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)) | |
| tree | [93031c8d3977a266dfe25d47e0449aa98ea1db65](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2) | |
| parent | [1dd2d5630f0c639e4f9f7c2c53af5d60a2bcc4a7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1dd2d5630f0c639e4f9f7c2c53af5d60a2bcc4a7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2&id2=1dd2d5630f0c639e4f9f7c2c53af5d60a2bcc4a7)) | |
| download | [linux-3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 08a4943dc54184..d0ee5fec647adb 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=1dd2d5630f0c639e4f9f7c2c53af5d60a2bcc4a7)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=3dd9df8e5f34c6fc4217a7498c1fb3c352d4afc2)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:17 +0000



=== Content from git.kernel.org_350cbdc7_20250114_220539.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=29216bb390e36daeebef66abaa02d9751330252b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=29216bb390e36daeebef66abaa02d9751330252b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=29216bb390e36daeebef66abaa02d9751330252b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=29216bb390e36daeebef66abaa02d9751330252b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:00 +0100 |
| commit | [29216bb390e36daeebef66abaa02d9751330252b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=29216bb390e36daeebef66abaa02d9751330252b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=29216bb390e36daeebef66abaa02d9751330252b)) | |
| tree | [887c43b9682a3c81b420f217bdb33b0f23a29284](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=29216bb390e36daeebef66abaa02d9751330252b) | |
| parent | [d161e5ea0ca73187b8a7a25bf32b9e1cf8ed8cfc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d161e5ea0ca73187b8a7a25bf32b9e1cf8ed8cfc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=29216bb390e36daeebef66abaa02d9751330252b&id2=d161e5ea0ca73187b8a7a25bf32b9e1cf8ed8cfc)) | |
| download | [linux-29216bb390e36daeebef66abaa02d9751330252b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-29216bb390e36daeebef66abaa02d9751330252b.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=29216bb390e36daeebef66abaa02d9751330252b)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=29216bb390e36daeebef66abaa02d9751330252b) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 6adf048c1bae81..62e28d315d8155 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=d161e5ea0ca73187b8a7a25bf32b9e1cf8ed8cfc)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=29216bb390e36daeebef66abaa02d9751330252b)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:16 +0000



=== Content from git.kernel.org_bf99f3a9_20250114_220547.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:53:42 +0100 |
| commit | [d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)) | |
| tree | [1ffd4d448bab906a9deeec477b9a3ee5ee73683e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5) | |
| parent | [a153942d2512ad087c0f19c8e37a0cac66626ed2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a153942d2512ad087c0f19c8e37a0cac66626ed2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5&id2=a153942d2512ad087c0f19c8e37a0cac66626ed2)) | |
| download | [linux-d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 08a4943dc54184..d0ee5fec647adb 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=a153942d2512ad087c0f19c8e37a0cac66626ed2)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=d10cd53e5a7fb3b7c6f83d4d9a5ea1d97a3ed9a5)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:23 +0000



=== Content from git.kernel.org_276854f9_20250114_220545.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:02:14 +0100 |
| commit | [bad37309c8b8bf1cfc893750df0951a804009ca0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bad37309c8b8bf1cfc893750df0951a804009ca0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)) | |
| tree | [728a55c3b98f5e47533c316b8b0c619ad041c87b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bad37309c8b8bf1cfc893750df0951a804009ca0) | |
| parent | [55fdcd1f4aaafd8a0eed7256093306f50235075c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=55fdcd1f4aaafd8a0eed7256093306f50235075c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bad37309c8b8bf1cfc893750df0951a804009ca0&id2=55fdcd1f4aaafd8a0eed7256093306f50235075c)) | |
| download | [linux-bad37309c8b8bf1cfc893750df0951a804009ca0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bad37309c8b8bf1cfc893750df0951a804009ca0.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bad37309c8b8bf1cfc893750df0951a804009ca0)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=bad37309c8b8bf1cfc893750df0951a804009ca0) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 3d2a27fefc874a..130adef2e46869 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=55fdcd1f4aaafd8a0eed7256093306f50235075c)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=bad37309c8b8bf1cfc893750df0951a804009ca0)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:22 +0000



=== Content from git.kernel.org_6a491b22_20250114_220538.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 10:59:35 +0100 |
| commit | [0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)) | |
| tree | [383507b549e35fb4b34e45f28b3824b8418ec32d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce) | |
| parent | [3b69263adaaaa5513db98c5b3fe9053a21ff2a6d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3b69263adaaaa5513db98c5b3fe9053a21ff2a6d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce&id2=3b69263adaaaa5513db98c5b3fe9053a21ff2a6d)) | |
| download | [linux-0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex c8ba3aeb327789..d4ef70b178859b 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=3b69263adaaaa5513db98c5b3fe9053a21ff2a6d)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=0d3fb3b3e9d66f7b6346e3b90bc0ff48683539ce)@@ -412,12 +412,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:15 +0000



=== Content from git.kernel.org_f372e037_20250114_220543.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:53:42 +0100 |
| commit | [40f4326ed05a3b3537556ff2a844958b9e779a98](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40f4326ed05a3b3537556ff2a844958b9e779a98) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)) | |
| tree | [ea831b182916b47535f4265563541f5ed35c01c3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40f4326ed05a3b3537556ff2a844958b9e779a98) | |
| parent | [30293309efd5c956de13a3122f4d2047981f98a8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=30293309efd5c956de13a3122f4d2047981f98a8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40f4326ed05a3b3537556ff2a844958b9e779a98&id2=30293309efd5c956de13a3122f4d2047981f98a8)) | |
| download | [linux-40f4326ed05a3b3537556ff2a844958b9e779a98.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-40f4326ed05a3b3537556ff2a844958b9e779a98.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40f4326ed05a3b3537556ff2a844958b9e779a98)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=40f4326ed05a3b3537556ff2a844958b9e779a98) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 6adf048c1bae81..62e28d315d8155 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=30293309efd5c956de13a3122f4d2047981f98a8)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=40f4326ed05a3b3537556ff2a844958b9e779a98)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:19 +0000



=== Content from git.kernel.org_6ce34b13_20250114_220548.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d48cbfa90dce506030151915fa3346d67f964af4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d48cbfa90dce506030151915fa3346d67f964af4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d48cbfa90dce506030151915fa3346d67f964af4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d48cbfa90dce506030151915fa3346d67f964af4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:30 +0100 |
| commit | [d48cbfa90dce506030151915fa3346d67f964af4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d48cbfa90dce506030151915fa3346d67f964af4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d48cbfa90dce506030151915fa3346d67f964af4)) | |
| tree | [03cb70c9f091a1c2b5d6540efa141fa17a19b791](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d48cbfa90dce506030151915fa3346d67f964af4) | |
| parent | [dd3a6d5441c676cf4a316b977d7ae2b5d8242e5f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd3a6d5441c676cf4a316b977d7ae2b5d8242e5f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d48cbfa90dce506030151915fa3346d67f964af4&id2=dd3a6d5441c676cf4a316b977d7ae2b5d8242e5f)) | |
| download | [linux-d48cbfa90dce506030151915fa3346d67f964af4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d48cbfa90dce506030151915fa3346d67f964af4.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d48cbfa90dce506030151915fa3346d67f964af4)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=d48cbfa90dce506030151915fa3346d67f964af4) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex ac65163f40325c..e83232bbd7ff84 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=dd3a6d5441c676cf4a316b977d7ae2b5d8242e5f)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=d48cbfa90dce506030151915fa3346d67f964af4)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:25 +0000



=== Content from git.kernel.org_671b19d2_20250114_220548.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zhen Lei <thunder.leizhen@huawei.com> | 2024-10-26 11:56:34 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:03 +0100 |
| commit | [f4fbd70e15fafe36a7583954ce189aaf5536aeec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)) | |
| tree | [33b787efeb5d81aa2500ef656636362fbebd1d45](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec) | |
| parent | [038e1d56b252e5638055dfacd39c9987e95a8533](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=038e1d56b252e5638055dfacd39c9987e95a8533) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec&id2=038e1d56b252e5638055dfacd39c9987e95a8533)) | |
| download | [linux-f4fbd70e15fafe36a7583954ce189aaf5536aeec.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f4fbd70e15fafe36a7583954ce189aaf5536aeec.tar.gz) | |

fbdev: sh7760fb: Fix a possible memory leak in sh7760fb\_alloc\_mem()[ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
When information such as info->screen\_base is not ready, calling
sh7760fb\_free\_mem() does not release memory correctly. Call
dma\_free\_coherent() instead.
Fixes: 4a25e41831ee ("video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver")
Signed-off-by: Zhen Lei <thunder.leizhen@huawei.com>
Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)

| -rw-r--r-- | [drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/video/fbdev/sh7760fb.c?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/sh7760fb.c b/drivers/video/fbdev/sh7760fb.cindex 6adf048c1bae81..62e28d315d8155 100644--- a/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=038e1d56b252e5638055dfacd39c9987e95a8533)+++ b/[drivers/video/fbdev/sh7760fb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/video/fbdev/sh7760fb.c?id=f4fbd70e15fafe36a7583954ce189aaf5536aeec)@@ -409,12 +409,11 @@ static int sh7760fb\_alloc\_mem(struct fb\_info \*info) vram = PAGE\_SIZE;  fbmem = dma\_alloc\_coherent(info->device, vram, &par->fbdma, GFP\_KERNEL);- if (!fbmem) return -ENOMEM;  if ((par->fbdma & SH7760FB\_DMA\_MASK) != SH7760FB\_DMA\_MASK) {- sh7760fb\_free\_mem(info);+ dma\_free\_coherent(info->device, vram, fbmem, par->fbdma); dev\_err(info->device, "kernel gave me memory at 0x%08lx, which is" "unusable for the LCDC\n", (unsigned long)par->fbdma); return -ENOMEM; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:04:26 +0000


