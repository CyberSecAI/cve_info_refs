The provided content relates to CVE-2024-56706.

**Root cause of vulnerability:**
The vulnerability stems from a lack of mutex protection during the allocation of Sample Data Blocks (SDBs) in the s390/cpum_sf driver. The reservation of PMU hardware is protected by a mutex, but the subsequent memory allocation for SDBs is performed outside this mutex. This allows for multiple concurrent invocations of `perf_event_init()` to run in parallel and allocate SDBs multiple times for the same PMU.

**Weaknesses/vulnerabilities present:**
- Race condition during SDB allocation.
- Lack of synchronization when multiple threads call `perf_event_init()` concurrently.
- Memory corruption due to multiple allocations of the same SDB.

**Impact of exploitation:**
The vulnerability can lead to memory corruption due to the allocation of the same Sample Data Blocks multiple times, which could result in a system crash, denial of service or potentially other undefined behaviors.

**Attack vectors:**
Concurrent invocations of `perf_event_init()` through the perf subsystem.

**Required attacker capabilities/position:**
The attacker needs the ability to create performance events, which can be achieved through the perf subsystem interface. An attacker could trigger this vulnerability by concurrently creating performance events, leading to the described memory allocation issue.