- **Root cause of vulnerability:** An out-of-bounds `strcpy` (heap overflow) occurs in GRUB2 when parsing HFS filesystems due to an assumption that the volume name is a valid Pascal string.
- **Weaknesses/vulnerabilities present:** The code assumes that the first byte of the volume name (`data->sblock.volname[0]`) represents the length of the volume name string. It then copies the string to `key.str`, which has a fixed size of 31 bytes, without proper bounds checking. The `sblock` member, including `volname`, is attacker-controlled. This allows an attacker to specify a length that exceeds the buffer size, leading to a heap overflow.
- **Impact of exploitation:** A heap overflow can lead to arbitrary code execution.
- **Attack vectors:** By crafting a malicious HFS filesystem image, an attacker can control the `volname` in the superblock and trigger the heap overflow.
- **Required attacker capabilities/position:** An attacker needs to be able to provide a malicious HFS filesystem to GRUB2 during boot or file system probing.