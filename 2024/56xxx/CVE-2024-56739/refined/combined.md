=== Content from git.kernel.org_14aef324_20250114_224852.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:54:27 +0100 |
| commit | [a1f0b4af90cc18b10261ecde56c6a56b22c75bd1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)) | |
| tree | [4f00ecd2ba1b141615f46ac52d0560033e551694](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1) | |
| parent | [0ffa3b4cb8574c480b5d14008235c7f3a67e072b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ffa3b4cb8574c480b5d14008235c7f3a67e072b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1&id2=0ffa3b4cb8574c480b5d14008235c7f3a67e072b)) | |
| download | [linux-a1f0b4af90cc18b10261ecde56c6a56b22c75bd1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a1f0b4af90cc18b10261ecde56c6a56b22c75bd1.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex cca650b2e0b94d..aaf76406cd7d7d 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=0ffa3b4cb8574c480b5d14008235c7f3a67e072b)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=a1f0b4af90cc18b10261ecde56c6a56b22c75bd1)@@ -904,13 +904,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:30 +0000



=== Content from git.kernel.org_5ec083db_20250114_224853.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:32:55 +0100 |
| commit | [dd4b1cbcc916fad5d10c2662b62def9f05e453d4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)) | |
| tree | [1763413fc976ea98321a6296f35fa41d1b37a80e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4) | |
| parent | [a990130f67706155f4df1fae327d67fb097fa53c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a990130f67706155f4df1fae327d67fb097fa53c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4&id2=a990130f67706155f4df1fae327d67fb097fa53c)) | |
| download | [linux-dd4b1cbcc916fad5d10c2662b62def9f05e453d4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dd4b1cbcc916fad5d10c2662b62def9f05e453d4.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex 0b23706d9fd3cc..4a7c41a6c21e7d 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=a990130f67706155f4df1fae327d67fb097fa53c)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=dd4b1cbcc916fad5d10c2662b62def9f05e453d4)@@ -904,13 +904,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:30 +0000



=== Content from git.kernel.org_90ec8bf6_20250114_224852.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:40 +0100 |
| commit | [44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)) | |
| tree | [53c9435ba727d0f7eb4589b2421c449f110a4ceb](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2) | |
| parent | [1a7d4c093bcf42ce65256bc54df44c63380d660e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1a7d4c093bcf42ce65256bc54df44c63380d660e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2&id2=1a7d4c093bcf42ce65256bc54df44c63380d660e)) | |
| download | [linux-44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex d858cd819932ff..1536d53a7af7f3 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=1a7d4c093bcf42ce65256bc54df44c63380d660e)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2)@@ -894,13 +894,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:29 +0000



=== Content from git.kernel.org_1e5513d3_20250114_224854.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:03:04 +0100 |
| commit | [e77bce0a8c3989b4173c36f4195122bca8f4a3e1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)) | |
| tree | [cb1ea6019fb7e8a5733e1b5985796afdd53c736f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1) | |
| parent | [c9b411df55f102a4dd3ebbf9b567f9f503729a1a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c9b411df55f102a4dd3ebbf9b567f9f503729a1a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1&id2=c9b411df55f102a4dd3ebbf9b567f9f503729a1a)) | |
| download | [linux-e77bce0a8c3989b4173c36f4195122bca8f4a3e1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e77bce0a8c3989b4173c36f4195122bca8f4a3e1.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex cca650b2e0b94d..aaf76406cd7d7d 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=c9b411df55f102a4dd3ebbf9b567f9f503729a1a)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=e77bce0a8c3989b4173c36f4195122bca8f4a3e1)@@ -904,13 +904,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:31 +0000



=== Content from git.kernel.org_34c13903_20250114_224846.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:14 +0100 |
| commit | [0d68e8514d9040108ff7d1b37ca71096674b6efe](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)) | |
| tree | [e5bacc343de90ddec5b5b1bdc0ce5c244e18726b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe) | |
| parent | [cd154812858d48404982e0934bbcf3c14c2b5d6b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cd154812858d48404982e0934bbcf3c14c2b5d6b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe&id2=cd154812858d48404982e0934bbcf3c14c2b5d6b)) | |
| download | [linux-0d68e8514d9040108ff7d1b37ca71096674b6efe.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0d68e8514d9040108ff7d1b37ca71096674b6efe.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=0d68e8514d9040108ff7d1b37ca71096674b6efe) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex 154ea5ae2c0c3b..a755f4af1c2155 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=cd154812858d48404982e0934bbcf3c14c2b5d6b)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=0d68e8514d9040108ff7d1b37ca71096674b6efe)@@ -907,13 +907,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:24 +0000



=== Content from git.kernel.org_fd7799d7_20250114_224854.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Alexandre Belloni <alexandre.belloni@bootlin.com> | 2024-11-11 23:10:54 +0100 |
| commit | [e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)) | |
| tree | [4022f1d8d35e30ba19508fe9a3c5cb75672a6aa4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d) | |
| parent | [00f1bb9b8486bc963211e6c8eae34a1e759efbd1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=00f1bb9b8486bc963211e6c8eae34a1e759efbd1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d&id2=00f1bb9b8486bc963211e6c8eae34a1e759efbd1)) | |
| download | [linux-e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex cca650b2e0b94d..aaf76406cd7d7d 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=00f1bb9b8486bc963211e6c8eae34a1e759efbd1)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d)@@ -904,13 +904,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:31 +0000



=== Content from git.kernel.org_f2b04361_20250114_224855.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fde56535505dde3336df438e949ef4742b6d6d6e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fde56535505dde3336df438e949ef4742b6d6d6e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fde56535505dde3336df438e949ef4742b6d6d6e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fde56535505dde3336df438e949ef4742b6d6d6e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:07 +0100 |
| commit | [fde56535505dde3336df438e949ef4742b6d6d6e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fde56535505dde3336df438e949ef4742b6d6d6e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fde56535505dde3336df438e949ef4742b6d6d6e)) | |
| tree | [170f4df97ecd41b4c96f7a32c75075351ca8a68f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fde56535505dde3336df438e949ef4742b6d6d6e) | |
| parent | [54a60de9a64ae096021a4c4cf61365b70f6aae85](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=54a60de9a64ae096021a4c4cf61365b70f6aae85) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fde56535505dde3336df438e949ef4742b6d6d6e&id2=54a60de9a64ae096021a4c4cf61365b70f6aae85)) | |
| download | [linux-fde56535505dde3336df438e949ef4742b6d6d6e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fde56535505dde3336df438e949ef4742b6d6d6e.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fde56535505dde3336df438e949ef4742b6d6d6e)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=fde56535505dde3336df438e949ef4742b6d6d6e) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex c928037bf6f3af..04ce689dae92bb 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=54a60de9a64ae096021a4c4cf61365b70f6aae85)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=fde56535505dde3336df438e949ef4742b6d6d6e)@@ -904,13 +904,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:32 +0000



=== Content from git.kernel.org_edcafe3a_20250114_224851.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=246f621d363988e7040f4546d20203dc713fa3e1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=246f621d363988e7040f4546d20203dc713fa3e1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=246f621d363988e7040f4546d20203dc713fa3e1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=246f621d363988e7040f4546d20203dc713fa3e1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:20 +0100 |
| commit | [246f621d363988e7040f4546d20203dc713fa3e1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=246f621d363988e7040f4546d20203dc713fa3e1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=246f621d363988e7040f4546d20203dc713fa3e1)) | |
| tree | [56256a44a956f41f2166b30f302fd039b04e9dfe](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=246f621d363988e7040f4546d20203dc713fa3e1) | |
| parent | [7c6098bdb62a503ac5b1a6a420ff294a5f04b5b9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7c6098bdb62a503ac5b1a6a420ff294a5f04b5b9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=246f621d363988e7040f4546d20203dc713fa3e1&id2=7c6098bdb62a503ac5b1a6a420ff294a5f04b5b9)) | |
| download | [linux-246f621d363988e7040f4546d20203dc713fa3e1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-246f621d363988e7040f4546d20203dc713fa3e1.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=246f621d363988e7040f4546d20203dc713fa3e1)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=246f621d363988e7040f4546d20203dc713fa3e1) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex 29c12947e73fc4..7c62b13077627c 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=7c6098bdb62a503ac5b1a6a420ff294a5f04b5b9)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=246f621d363988e7040f4546d20203dc713fa3e1)@@ -893,13 +893,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:24 +0000



=== Content from git.kernel.org_bd8a1038_20250114_224851.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yongliang Gao <leonylgao@tencent.com> | 2024-10-11 12:31:53 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 10:59:41 +0100 |
| commit | [39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)) | |
| tree | [13df74b621df5fd0eb5016798a3b9b8e8716f540](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f) | |
| parent | [1cfae9575296f5040cdc84b0730e79078c081d2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1cfae9575296f5040cdc84b0730e79078c081d2d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f&id2=1cfae9575296f5040cdc84b0730e79078c081d2d)) | |
| download | [linux-39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f.tar.gz) | |

rtc: check if \_\_rtc\_read\_time was successful in rtc\_timer\_do\_work()[ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
If the \_\_rtc\_read\_time call fails,, the struct rtc\_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.
When calling rtc\_tm\_to\_ktime later, the result may be a very large value
(possibly KTIME\_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.
Fixes: 6610e0893b8b ("RTC: Rework RTC code to use timerqueue for events")
Signed-off-by: Yongliang Gao <leonylgao@tencent.com>
Acked-by: Jingqun Li <jingqunli@tencent.com>
Link: [https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com](https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao%40gmail.com)
Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)

| -rw-r--r-- | [drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/rtc/interface.c?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 1 deletions

| diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.cindex ce051f91829f9f..1ab619fb978a40 100644--- a/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=1cfae9575296f5040cdc84b0730e79078c081d2d)+++ b/[drivers/rtc/interface.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/rtc/interface.c?id=39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f)@@ -914,13 +914,18 @@ void rtc\_timer\_do\_work(struct work\_struct \*work) struct timerqueue\_node \*next; ktime\_t now; struct rtc\_time tm;+ int err;  struct rtc\_device \*rtc = container\_of(work, struct rtc\_device, irqwork);  mutex\_lock(&rtc->ops\_lock); again:- \_\_rtc\_read\_time(rtc, &tm);+ err = \_\_rtc\_read\_time(rtc, &tm);+ if (err) {+ mutex\_unlock(&rtc->ops\_lock);+ return;+ } now = rtc\_tm\_to\_ktime(tm); while ((next = timerqueue\_getnext(&rtc->timerqueue))) { if (next->expires > now) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:47:28 +0000


