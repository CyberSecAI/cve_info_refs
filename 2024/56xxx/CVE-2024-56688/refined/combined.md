=== Content from git.kernel.org_757edc06_20250114_221445.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:54:32 +0100 |
| commit | [638a8fa5a7e641f9401346c57e236f02379a0c40](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=638a8fa5a7e641f9401346c57e236f02379a0c40) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)) | |
| tree | [bc73a3e4fc544d15f830b6d1989670b1592e9812](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=638a8fa5a7e641f9401346c57e236f02379a0c40) | |
| parent | [f25bddb3b7c0ebb0526b7062d54b5f8a05cd0c3f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f25bddb3b7c0ebb0526b7062d54b5f8a05cd0c3f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=638a8fa5a7e641f9401346c57e236f02379a0c40&id2=f25bddb3b7c0ebb0526b7062d54b5f8a05cd0c3f)) | |
| download | [linux-638a8fa5a7e641f9401346c57e236f02379a0c40.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-638a8fa5a7e641f9401346c57e236f02379a0c40.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=638a8fa5a7e641f9401346c57e236f02379a0c40)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=638a8fa5a7e641f9401346c57e236f02379a0c40) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 1326fbf45a3479..539cdda2093e57 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=f25bddb3b7c0ebb0526b7062d54b5f8a05cd0c3f)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=638a8fa5a7e641f9401346c57e236f02379a0c40)@@ -1198,6 +1198,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:22 +0000



=== Content from git.kernel.org_1c3ab3a1_20250114_221444.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:33:00 +0100 |
| commit | [3811172e8c98ceebd12fe526ca6cb37a1263c964](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)) | |
| tree | [082a6bd03161f7c58409f4ae60bf19827684c942](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964) | |
| parent | [065902117a5b07153f3d4fa5cc812331d380a5fe](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=065902117a5b07153f3d4fa5cc812331d380a5fe) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964&id2=065902117a5b07153f3d4fa5cc812331d380a5fe)) | |
| download | [linux-3811172e8c98ceebd12fe526ca6cb37a1263c964.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3811172e8c98ceebd12fe526ca6cb37a1263c964.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=3811172e8c98ceebd12fe526ca6cb37a1263c964) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 50490b1e8a0d09..714da627fba8ec 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=065902117a5b07153f3d4fa5cc812331d380a5fe)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=3811172e8c98ceebd12fe526ca6cb37a1263c964)@@ -1186,6 +1186,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:21 +0000



=== Content from git.kernel.org_08bb7514_20250114_221446.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:03:09 +0100 |
| commit | [66d11ca91bf5100ae2e6b5efad97e58d8448843a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)) | |
| tree | [e088444e30542a256ed44eb16a75edd90fb9eb4c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a) | |
| parent | [56a5d998c912566e4467487db7efe2818cce1e1f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56a5d998c912566e4467487db7efe2818cce1e1f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a&id2=56a5d998c912566e4467487db7efe2818cce1e1f)) | |
| download | [linux-66d11ca91bf5100ae2e6b5efad97e58d8448843a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-66d11ca91bf5100ae2e6b5efad97e58d8448843a.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 1326fbf45a3479..539cdda2093e57 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=56a5d998c912566e4467487db7efe2818cce1e1f)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=66d11ca91bf5100ae2e6b5efad97e58d8448843a)@@ -1198,6 +1198,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:23 +0000



=== Content from git.kernel.org_1ab0d565_20250114_221449.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:21 +0100 |
| commit | [fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)) | |
| tree | [50e4f8b5d5281a94a4dc11807dabd49537d3df1a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960) | |
| parent | [f211501cfc2bd5b55ec223b3f2f1b083b249ac0f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f211501cfc2bd5b55ec223b3f2f1b083b249ac0f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960&id2=f211501cfc2bd5b55ec223b3f2f1b083b249ac0f)) | |
| download | [linux-fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 06ea4fb2d4532f..9e122c20fcc6e6 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=f211501cfc2bd5b55ec223b3f2f1b083b249ac0f)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=fe6cbf0b2ac3cf4e21824a44eaa336564ed5e960)@@ -1143,6 +1143,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:26 +0000



=== Content from git.kernel.org_ebe7b014_20250114_221448.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:42 +0100 |
| commit | [cc91d59d34ff6a6fee1c0b48612081a451e05e9a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)) | |
| tree | [5a4e252430f1aa909351879677f0fad0d807077a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a) | |
| parent | [e89ac70361666443d948056484f081d7332bb564](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e89ac70361666443d948056484f081d7332bb564) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a&id2=e89ac70361666443d948056484f081d7332bb564)) | |
| download | [linux-cc91d59d34ff6a6fee1c0b48612081a451e05e9a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cc91d59d34ff6a6fee1c0b48612081a451e05e9a.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex fde3fb7387d0dc..15a75e86c8943c 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=e89ac70361666443d948056484f081d7332bb564)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=cc91d59d34ff6a6fee1c0b48612081a451e05e9a)@@ -1241,6 +1241,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:25 +0000



=== Content from git.kernel.org_0996e06a_20250114_221448.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:09 +0100 |
| commit | [87a95ee34a48dfad198a2002e4966e1d63d53f2b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)) | |
| tree | [e908a8f475035f07ba5e7810c0216e05f0b85861](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b) | |
| parent | [0f29fd2cd33e89097f6e5a24e4d85264c89d1966](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f29fd2cd33e89097f6e5a24e4d85264c89d1966) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b&id2=0f29fd2cd33e89097f6e5a24e4d85264c89d1966)) | |
| download | [linux-87a95ee34a48dfad198a2002e4966e1d63d53f2b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-87a95ee34a48dfad198a2002e4966e1d63d53f2b.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 190dae11f634a2..b9dc8e197dde80 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=0f29fd2cd33e89097f6e5a24e4d85264c89d1966)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=87a95ee34a48dfad198a2002e4966e1d63d53f2b)@@ -1130,6 +1130,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:25 +0000



=== Content from git.kernel.org_8ec83a2e_20250114_221447.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:16 +0100 |
| commit | [86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)) | |
| tree | [acac521ad6f2f2c193f641482929a01fd6707e9a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e) | |
| parent | [8c06a00a9be6a1c123ea869845bfa1807e13109a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8c06a00a9be6a1c123ea869845bfa1807e13109a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e&id2=8c06a00a9be6a1c123ea869845bfa1807e13109a)) | |
| download | [linux-86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transport[ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
Since transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex 278d044e1fd4a8..79ce634017f9a0 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=8c06a00a9be6a1c123ea869845bfa1807e13109a)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=86a1f9fa24804cd7f9d7dd3f24af84fc7f8ec02e)@@ -1129,6 +1129,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:24 +0000



=== Content from git.kernel.org_ae9d3f7e_20250114_221445.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4db9ad82a6c823094da27de4825af693a3475d51)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4db9ad82a6c823094da27de4825af693a3475d51)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4db9ad82a6c823094da27de4825af693a3475d51)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4db9ad82a6c823094da27de4825af693a3475d51)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Liu Jian <liujian56@huawei.com> | 2024-11-15 17:38:04 +0800 |
| --- | --- | --- |
| committer | Trond Myklebust <trond.myklebust@hammerspace.com> | 2024-11-28 12:55:32 -0500 |
| commit | [4db9ad82a6c823094da27de4825af693a3475d51](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4db9ad82a6c823094da27de4825af693a3475d51) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4db9ad82a6c823094da27de4825af693a3475d51)) | |
| tree | [41bda1bf8f575ae488cf025bc855e775bba74562](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4db9ad82a6c823094da27de4825af693a3475d51) | |
| parent | [52cb7f8f177878b4f22397b9c4d2c8f743766be3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=52cb7f8f177878b4f22397b9c4d2c8f743766be3) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4db9ad82a6c823094da27de4825af693a3475d51&id2=52cb7f8f177878b4f22397b9c4d2c8f743766be3)) | |
| download | [linux-4db9ad82a6c823094da27de4825af693a3475d51.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4db9ad82a6c823094da27de4825af693a3475d51.tar.gz) | |

sunrpc: clear XPRT\_SOCK\_UPD\_TIMEOUT when reset transportSince transport->sock has been set to NULL during reset transport,
XPRT\_SOCK\_UPD\_TIMEOUT also needs to be cleared. Otherwise, the
xs\_tcp\_set\_socket\_timeouts() may be triggered in xs\_tcp\_send\_request()
to dereference the transport->sock that has been set to NULL.
Fixes: 7196dbb02ea0 ("SUNRPC: Allow changing of the TCP timeout parameters on the fly")
Signed-off-by: Li Lingfeng <lilingfeng3@huawei.com>
Signed-off-by: Liu Jian <liujian56@huawei.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4db9ad82a6c823094da27de4825af693a3475d51)

| -rw-r--r-- | [net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtsock.c?id=4db9ad82a6c823094da27de4825af693a3475d51) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/sunrpc/xprtsock.c b/net/sunrpc/xprtsock.cindex d587c261d99912..31bc046e285021 100644--- a/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=52cb7f8f177878b4f22397b9c4d2c8f743766be3)+++ b/[net/sunrpc/xprtsock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtsock.c?id=4db9ad82a6c823094da27de4825af693a3475d51)@@ -1198,6 +1198,7 @@ static void xs\_sock\_reset\_state\_flags(struct rpc\_xprt \*xprt) clear\_bit(XPRT\_SOCK\_WAKE\_WRITE, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_WAKE\_DISCONNECT, &transport->sock\_state); clear\_bit(XPRT\_SOCK\_NOSPACE, &transport->sock\_state);+ clear\_bit(XPRT\_SOCK\_UPD\_TIMEOUT, &transport->sock\_state); }  static void xs\_run\_error\_worker(struct sock\_xprt \*transport, unsigned int nr) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:13:22 +0000


