=== Content from git.kernel.org_22a5c6d8_20250114_182238.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:14 +0100 |
| commit | [5354599855a9b5568e05ce686119ee3ff8b19bd5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)) | |
| tree | [7bb117a6a9e63335a2487e5cd1925848b9436865](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5) | |
| parent | [8797b7712de704dc231f9e821d8eb3b9aeb3a032](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8797b7712de704dc231f9e821d8eb3b9aeb3a032) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5&id2=8797b7712de704dc231f9e821d8eb3b9aeb3a032)) | |
| download | [linux-5354599855a9b5568e05ce686119ee3ff8b19bd5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5354599855a9b5568e05ce686119ee3ff8b19bd5.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=5354599855a9b5568e05ce686119ee3ff8b19bd5) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex 4951d9bef57945..128baa08a98926 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=8797b7712de704dc231f9e821d8eb3b9aeb3a032)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=5354599855a9b5568e05ce686119ee3ff8b19bd5)@@ -283,6 +283,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -298,6 +300,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -315,6 +319,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_PTR\_EQ(test, string, (char \*)NULL); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:15 +0000



=== Content from git.kernel.org_1be053bb_20250114_182239.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=89265f88701e54dde255ddf862093baeca57548c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=89265f88701e54dde255ddf862093baeca57548c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89265f88701e54dde255ddf862093baeca57548c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89265f88701e54dde255ddf862093baeca57548c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:53:59 +0100 |
| commit | [89265f88701e54dde255ddf862093baeca57548c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89265f88701e54dde255ddf862093baeca57548c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=89265f88701e54dde255ddf862093baeca57548c)) | |
| tree | [d6bc9b249729fafba43550b4fba99987761672f7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=89265f88701e54dde255ddf862093baeca57548c) | |
| parent | [16c507df509113c037cdc0ba642b9ab3389bd26c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=16c507df509113c037cdc0ba642b9ab3389bd26c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89265f88701e54dde255ddf862093baeca57548c&id2=16c507df509113c037cdc0ba642b9ab3389bd26c)) | |
| download | [linux-89265f88701e54dde255ddf862093baeca57548c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-89265f88701e54dde255ddf862093baeca57548c.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89265f88701e54dde255ddf862093baeca57548c)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=89265f88701e54dde255ddf862093baeca57548c) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex 0711a0305df345..d5cdc3cb0755af 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=16c507df509113c037cdc0ba642b9ab3389bd26c)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=89265f88701e54dde255ddf862093baeca57548c)@@ -286,6 +286,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -301,6 +303,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -318,6 +322,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_NULL(test, string); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:17 +0000



=== Content from git.kernel.org_b629453b_20250114_182239.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7290f59231910ccba427d441a6e8b8c6f6112448)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7290f59231910ccba427d441a6e8b8c6f6112448)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7290f59231910ccba427d441a6e8b8c6f6112448)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7290f59231910ccba427d441a6e8b8c6f6112448)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | John Johansen <john.johansen@canonical.com> | 2024-11-26 19:21:05 -0800 |
| commit | [7290f59231910ccba427d441a6e8b8c6f6112448](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7290f59231910ccba427d441a6e8b8c6f6112448) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7290f59231910ccba427d441a6e8b8c6f6112448)) | |
| tree | [834b140bf7081ce7a166ec799b78d77e4a3ab684](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7290f59231910ccba427d441a6e8b8c6f6112448) | |
| parent | [75535669c9c1647e8098947f045c95db1bbdfa8c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=75535669c9c1647e8098947f045c95db1bbdfa8c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7290f59231910ccba427d441a6e8b8c6f6112448&id2=75535669c9c1647e8098947f045c95db1bbdfa8c)) | |
| download | [linux-7290f59231910ccba427d441a6e8b8c6f6112448.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7290f59231910ccba427d441a6e8b8c6f6112448.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7290f59231910ccba427d441a6e8b8c6f6112448)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=7290f59231910ccba427d441a6e8b8c6f6112448) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex c64733d6c98fbb..f070902da8fcce 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=75535669c9c1647e8098947f045c95db1bbdfa8c)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=7290f59231910ccba427d441a6e8b8c6f6112448)@@ -281,6 +281,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -296,6 +298,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -313,6 +317,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_NULL(test, string); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:16 +0000



=== Content from git.kernel.org_57e071c4_20250114_182237.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:32:45 +0100 |
| commit | [2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)) | |
| tree | [7dd235152c699ef187bc9e3ddd004eb2d0e23d53](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6) | |
| parent | [9b07fb464eb69a752406e78e62ab3a60bfa7b00d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9b07fb464eb69a752406e78e62ab3a60bfa7b00d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6&id2=9b07fb464eb69a752406e78e62ab3a60bfa7b00d)) | |
| download | [linux-2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex 2b8003eb4f463a..dd551587fe4ac7 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=9b07fb464eb69a752406e78e62ab3a60bfa7b00d)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=2a9b68f2dc6812bd1b8880b5c00e60203d6f61f6)@@ -281,6 +281,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -296,6 +298,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -313,6 +317,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_NULL(test, string); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:14 +0000



=== Content from git.kernel.org_ecfce02d_20250114_182238.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:54:11 +0100 |
| commit | [59a149e7c38e7b76616c8b333fc6aa5b6fb2293c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)) | |
| tree | [67443711ef799eb718402a30af6eca8cc19fa95b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c) | |
| parent | [c6963a06ce5c61d3238751ada04ee1569663a828](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c6963a06ce5c61d3238751ada04ee1569663a828) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c&id2=c6963a06ce5c61d3238751ada04ee1569663a828)) | |
| download | [linux-59a149e7c38e7b76616c8b333fc6aa5b6fb2293c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-59a149e7c38e7b76616c8b333fc6aa5b6fb2293c.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex c64733d6c98fbb..f070902da8fcce 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=c6963a06ce5c61d3238751ada04ee1569663a828)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=59a149e7c38e7b76616c8b333fc6aa5b6fb2293c)@@ -281,6 +281,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -296,6 +298,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -313,6 +317,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_NULL(test, string); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:16 +0000



=== Content from git.kernel.org_6917971a_20250114_182241.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:09 +0100 |
| commit | [f856246ff6da25c4f8fdd73a9c875e878b085e9f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)) | |
| tree | [6394537833a7efd619c69bc40d8a67dbe25cf657](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f) | |
| parent | [b9322408d83accc8b96322bc7356593206288c56](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b9322408d83accc8b96322bc7356593206288c56) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f&id2=b9322408d83accc8b96322bc7356593206288c56)) | |
| download | [linux-f856246ff6da25c4f8fdd73a9c875e878b085e9f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f856246ff6da25c4f8fdd73a9c875e878b085e9f.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex 4951d9bef57945..128baa08a98926 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=b9322408d83accc8b96322bc7356593206288c56)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=f856246ff6da25c4f8fdd73a9c875e878b085e9f)@@ -283,6 +283,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -298,6 +300,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -315,6 +319,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_PTR\_EQ(test, string, (char \*)NULL); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:18 +0000



=== Content from git.kernel.org_3fc722af_20250114_182240.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jinjie Ruan <ruanjinjie@huawei.com> | 2024-10-11 09:22:41 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:02:46 +0100 |
| commit | [d62ee5739a66644b0e7f11e657d562458cdcdea3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)) | |
| tree | [09f9196698a70e165385b06f8cd7709128e9a620](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3) | |
| parent | [297f14fbb81895f4ccdb0ad25d196786d6461e00](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=297f14fbb81895f4ccdb0ad25d196786d6461e00) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3&id2=297f14fbb81895f4ccdb0ad25d196786d6461e00)) | |
| download | [linux-d62ee5739a66644b0e7f11e657d562458cdcdea3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d62ee5739a66644b0e7f11e657d562458cdcdea3.tar.gz) | |

apparmor: test: Fix memory leak for aa\_unpack\_strdup()commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
The string allocated by kmemdup() in aa\_unpack\_strdup() is not
freed and cause following memory leaks, free them to fix it.
unreferenced object 0xffffff80c6af8a50 (size 8):
comm "kunit\_try\_catch", pid 225, jiffies 4294894407
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<000000008ecde918>] policy\_unpack\_test\_unpack\_strdup\_with\_null\_name+0xf8/0x3ec
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
unreferenced object 0xffffff80c2a29090 (size 8):
comm "kunit\_try\_catch", pid 227, jiffies 4294894409
hex dump (first 8 bytes):
74 65 73 74 69 6e 67 00 testing.
backtrace (crc 5eab668b):
[<0000000001e3714d>] kmemleak\_alloc+0x34/0x40
[<000000006e6c7776>] \_\_kmalloc\_node\_track\_caller\_noprof+0x300/0x3e0
[<000000006870467c>] kmemdup\_noprof+0x34/0x60
[<000000001176bb03>] aa\_unpack\_strdup+0xd0/0x18c
[<0000000046a45c1a>] policy\_unpack\_test\_unpack\_strdup\_with\_name+0xd0/0x3c4
[<0000000032ef8f77>] kunit\_try\_run\_case+0x13c/0x3ac
[<00000000f3edea23>] kunit\_generic\_run\_threadfn\_adapter+0x80/0xec
[<00000000adf936cf>] kthread+0x2e8/0x374
[<0000000041bb1628>] ret\_from\_fork+0x10/0x20
Cc: stable@vger.kernel.org
Fixes: 4d944bcd4e73 ("apparmor: add AppArmor KUnit tests for policy unpack")
Signed-off-by: Jinjie Ruan <ruanjinjie@huawei.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)

| -rw-r--r-- | [security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/security/apparmor/policy_unpack_test.c?id=d62ee5739a66644b0e7f11e657d562458cdcdea3) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/security/apparmor/policy\_unpack\_test.c b/security/apparmor/policy\_unpack\_test.cindex c64733d6c98fbb..f070902da8fcce 100644--- a/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=297f14fbb81895f4ccdb0ad25d196786d6461e00)+++ b/[security/apparmor/policy\_unpack\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/security/apparmor/policy_unpack_test.c?id=d62ee5739a66644b0e7f11e657d562458cdcdea3)@@ -281,6 +281,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_null\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test)@@ -296,6 +298,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_with\_name(struct kunit \*test) ((uintptr\_t)puf->e->start <= (uintptr\_t)string) && ((uintptr\_t)string <= (uintptr\_t)puf->e->end)); KUNIT\_EXPECT\_STREQ(test, string, TEST\_STRING\_DATA);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test)@@ -313,6 +317,8 @@ static void policy\_unpack\_test\_unpack\_strdup\_out\_of\_bounds(struct kunit \*test) KUNIT\_EXPECT\_EQ(test, size, 0); KUNIT\_EXPECT\_NULL(test, string); KUNIT\_EXPECT\_PTR\_EQ(test, puf->e->pos, start);++ kfree(string); }  static void policy\_unpack\_test\_unpack\_nameX\_with\_null\_name(struct kunit \*test) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:21:17 +0000


