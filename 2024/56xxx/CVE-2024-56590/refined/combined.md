=== Content from git.kernel.org_4c199951_20250114_213713.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-10-08 10:16:48 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 20:00:08 +0100 |
| commit | [5e50d12cc6e95e1fde08f5db6992b616f714b0fb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)) | |
| tree | [c9d34ec73a127d942bc2d25a7c98058a5b698ab7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb) | |
| parent | [36af575822ef8611a6f7370582ed40ae5715ce0e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=36af575822ef8611a6f7370582ed40ae5715ce0e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb&id2=36af575822ef8611a6f7370582ed40ae5715ce0e)) | |
| download | [linux-5e50d12cc6e95e1fde08f5db6992b616f714b0fb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5e50d12cc6e95e1fde08f5db6992b616f714b0fb.tar.gz) | |

Bluetooth: hci\_core: Fix not checking skb length on hci\_acldata\_packet[ Upstream commit 3fe288a8214e7dd784d1f9b7c9e448244d316b47 ]
This fixes not checking if skb really contains an ACL header otherwise
the code may attempt to access some uninitilized/invalid memory past the
valid skb->data.
Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Closes: https://syzkaller.appspot.com/bug?extid=6ea290ba76d8c1eb1ac2
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)

| -rw-r--r-- | [net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_core.c?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 4 deletions

| diff --git a/net/bluetooth/hci\_core.c b/net/bluetooth/hci\_core.cindex 3cf4dd9cad8a33..30519d47e8a695 100644--- a/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=36af575822ef8611a6f7370582ed40ae5715ce0e)+++ b/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=5e50d12cc6e95e1fde08f5db6992b616f714b0fb)@@ -3735,18 +3735,22 @@ static void hci\_tx\_work(struct work\_struct \*work) /\* ACL data packet \*/ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) {- struct hci\_acl\_hdr \*hdr = (void \*) skb->data;+ struct hci\_acl\_hdr \*hdr; struct hci\_conn \*conn; \_\_u16 handle, flags; - skb\_pull(skb, HCI\_ACL\_HDR\_SIZE);+ hdr = skb\_pull\_data(skb, sizeof(\*hdr));+ if (!hdr) {+ bt\_dev\_err(hdev, "ACL packet too small");+ goto drop;+ }  handle = \_\_le16\_to\_cpu(hdr->handle); flags = hci\_flags(handle); handle = hci\_handle(handle); - BT\_DBG("%s len %d handle 0x%4.4x flags 0x%4.4x", hdev->name, skb->len,- handle, flags);+ bt\_dev\_dbg(hdev, "len %d handle 0x%4.4x flags 0x%4.4x", skb->len,+ handle, flags);  hdev->stat.acl\_rx++; @@ -3765,6 +3769,7 @@ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) handle); } +drop: kfree\_skb(skb); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:35:50 +0000



=== Content from git.kernel.org_fdafca60_20250114_213712.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-10-08 10:16:48 -0400 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-11-14 15:29:54 -0500 |
| commit | [3fe288a8214e7dd784d1f9b7c9e448244d316b47](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)) | |
| tree | [c044e7de8c4edf886db2dc4af81b3b62ce3fe536](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47) | |
| parent | [c135a5bc34a89a75a739d07964ff3d1c4fa1b154](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c135a5bc34a89a75a739d07964ff3d1c4fa1b154) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47&id2=c135a5bc34a89a75a739d07964ff3d1c4fa1b154)) | |
| download | [linux-3fe288a8214e7dd784d1f9b7c9e448244d316b47.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3fe288a8214e7dd784d1f9b7c9e448244d316b47.tar.gz) | |

Bluetooth: hci\_core: Fix not checking skb length on hci\_acldata\_packetThis fixes not checking if skb really contains an ACL header otherwise
the code may attempt to access some uninitilized/invalid memory past the
valid skb->data.
Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Closes: https://syzkaller.appspot.com/bug?extid=6ea290ba76d8c1eb1ac2
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)

| -rw-r--r-- | [net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_core.c?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 4 deletions

| diff --git a/net/bluetooth/hci\_core.c b/net/bluetooth/hci\_core.cindex 96d097b21d13f2..f9e1df40901595 100644--- a/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=c135a5bc34a89a75a739d07964ff3d1c4fa1b154)+++ b/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=3fe288a8214e7dd784d1f9b7c9e448244d316b47)@@ -3771,18 +3771,22 @@ static void hci\_tx\_work(struct work\_struct \*work) /\* ACL data packet \*/ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) {- struct hci\_acl\_hdr \*hdr = (void \*) skb->data;+ struct hci\_acl\_hdr \*hdr; struct hci\_conn \*conn; \_\_u16 handle, flags; - skb\_pull(skb, HCI\_ACL\_HDR\_SIZE);+ hdr = skb\_pull\_data(skb, sizeof(\*hdr));+ if (!hdr) {+ bt\_dev\_err(hdev, "ACL packet too small");+ goto drop;+ }  handle = \_\_le16\_to\_cpu(hdr->handle); flags = hci\_flags(handle); handle = hci\_handle(handle); - BT\_DBG("%s len %d handle 0x%4.4x flags 0x%4.4x", hdev->name, skb->len,- handle, flags);+ bt\_dev\_dbg(hdev, "len %d handle 0x%4.4x flags 0x%4.4x", skb->len,+ handle, flags);  hdev->stat.acl\_rx++; @@ -3803,6 +3807,7 @@ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) handle); } +drop: kfree\_skb(skb); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:35:49 +0000



=== Content from git.kernel.org_c6ca1c59_20250114_213712.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-10-08 10:16:48 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:44 +0100 |
| commit | [559b1c7ac2e212a23b3833d3baf3bd957771d02e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)) | |
| tree | [b4cff39f5e82d47ab6ea2259bf7e29b45efaed9f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e) | |
| parent | [f2c3deaf2018601154f9e5ef0766159939cf1bc8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f2c3deaf2018601154f9e5ef0766159939cf1bc8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e&id2=f2c3deaf2018601154f9e5ef0766159939cf1bc8)) | |
| download | [linux-559b1c7ac2e212a23b3833d3baf3bd957771d02e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-559b1c7ac2e212a23b3833d3baf3bd957771d02e.tar.gz) | |

Bluetooth: hci\_core: Fix not checking skb length on hci\_acldata\_packet[ Upstream commit 3fe288a8214e7dd784d1f9b7c9e448244d316b47 ]
This fixes not checking if skb really contains an ACL header otherwise
the code may attempt to access some uninitilized/invalid memory past the
valid skb->data.
Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Closes: https://syzkaller.appspot.com/bug?extid=6ea290ba76d8c1eb1ac2
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)

| -rw-r--r-- | [net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_core.c?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 4 deletions

| diff --git a/net/bluetooth/hci\_core.c b/net/bluetooth/hci\_core.cindex 789f7f4a09089b..3cd7c212375fc7 100644--- a/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=f2c3deaf2018601154f9e5ef0766159939cf1bc8)+++ b/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=559b1c7ac2e212a23b3833d3baf3bd957771d02e)@@ -3829,18 +3829,22 @@ static void hci\_tx\_work(struct work\_struct \*work) /\* ACL data packet \*/ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) {- struct hci\_acl\_hdr \*hdr = (void \*) skb->data;+ struct hci\_acl\_hdr \*hdr; struct hci\_conn \*conn; \_\_u16 handle, flags; - skb\_pull(skb, HCI\_ACL\_HDR\_SIZE);+ hdr = skb\_pull\_data(skb, sizeof(\*hdr));+ if (!hdr) {+ bt\_dev\_err(hdev, "ACL packet too small");+ goto drop;+ }  handle = \_\_le16\_to\_cpu(hdr->handle); flags = hci\_flags(handle); handle = hci\_handle(handle); - BT\_DBG("%s len %d handle 0x%4.4x flags 0x%4.4x", hdev->name, skb->len,- handle, flags);+ bt\_dev\_dbg(hdev, "len %d handle 0x%4.4x flags 0x%4.4x", skb->len,+ handle, flags);  hdev->stat.acl\_rx++; @@ -3859,6 +3863,7 @@ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) handle); } +drop: kfree\_skb(skb); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:35:50 +0000



=== Content from git.kernel.org_35c77525_20250114_213714.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-10-08 10:16:48 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 20:03:56 +0100 |
| commit | [93a6160dc198ffe5786da8bd8588cfd17f53b29a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)) | |
| tree | [d935abf0607a3259660d23ed1a94fa77db56fe8b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a) | |
| parent | [c55a4c5a04bae40dcdc1e1c19d8eb79a06fb3397](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c55a4c5a04bae40dcdc1e1c19d8eb79a06fb3397) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a&id2=c55a4c5a04bae40dcdc1e1c19d8eb79a06fb3397)) | |
| download | [linux-93a6160dc198ffe5786da8bd8588cfd17f53b29a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-93a6160dc198ffe5786da8bd8588cfd17f53b29a.tar.gz) | |

Bluetooth: hci\_core: Fix not checking skb length on hci\_acldata\_packet[ Upstream commit 3fe288a8214e7dd784d1f9b7c9e448244d316b47 ]
This fixes not checking if skb really contains an ACL header otherwise
the code may attempt to access some uninitilized/invalid memory past the
valid skb->data.
Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Closes: https://syzkaller.appspot.com/bug?extid=6ea290ba76d8c1eb1ac2
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)

| -rw-r--r-- | [net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_core.c?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 4 deletions

| diff --git a/net/bluetooth/hci\_core.c b/net/bluetooth/hci\_core.cindex 0ac354db817794..72439764186ed2 100644--- a/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=c55a4c5a04bae40dcdc1e1c19d8eb79a06fb3397)+++ b/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=93a6160dc198ffe5786da8bd8588cfd17f53b29a)@@ -3771,18 +3771,22 @@ static void hci\_tx\_work(struct work\_struct \*work) /\* ACL data packet \*/ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) {- struct hci\_acl\_hdr \*hdr = (void \*) skb->data;+ struct hci\_acl\_hdr \*hdr; struct hci\_conn \*conn; \_\_u16 handle, flags; - skb\_pull(skb, HCI\_ACL\_HDR\_SIZE);+ hdr = skb\_pull\_data(skb, sizeof(\*hdr));+ if (!hdr) {+ bt\_dev\_err(hdev, "ACL packet too small");+ goto drop;+ }  handle = \_\_le16\_to\_cpu(hdr->handle); flags = hci\_flags(handle); handle = hci\_handle(handle); - BT\_DBG("%s len %d handle 0x%4.4x flags 0x%4.4x", hdev->name, skb->len,- handle, flags);+ bt\_dev\_dbg(hdev, "len %d handle 0x%4.4x flags 0x%4.4x", skb->len,+ handle, flags);  hdev->stat.acl\_rx++; @@ -3801,6 +3805,7 @@ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) handle); } +drop: kfree\_skb(skb); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:35:51 +0000



=== Content from git.kernel.org_f8de9b28_20250114_213711.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=219960a48771b35a3857a491b955c31d6c33d581)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=219960a48771b35a3857a491b955c31d6c33d581)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=219960a48771b35a3857a491b955c31d6c33d581)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=219960a48771b35a3857a491b955c31d6c33d581)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-10-08 10:16:48 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:39 +0100 |
| commit | [219960a48771b35a3857a491b955c31d6c33d581](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=219960a48771b35a3857a491b955c31d6c33d581) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=219960a48771b35a3857a491b955c31d6c33d581)) | |
| tree | [02c711aa79aa6f18385fa4aacde7b3d6098f35e8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=219960a48771b35a3857a491b955c31d6c33d581) | |
| parent | [dfb3f9d3f602602de208da7bdcc0f6d5ee74af68](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dfb3f9d3f602602de208da7bdcc0f6d5ee74af68) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=219960a48771b35a3857a491b955c31d6c33d581&id2=dfb3f9d3f602602de208da7bdcc0f6d5ee74af68)) | |
| download | [linux-219960a48771b35a3857a491b955c31d6c33d581.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-219960a48771b35a3857a491b955c31d6c33d581.tar.gz) | |

Bluetooth: hci\_core: Fix not checking skb length on hci\_acldata\_packet[ Upstream commit 3fe288a8214e7dd784d1f9b7c9e448244d316b47 ]
This fixes not checking if skb really contains an ACL header otherwise
the code may attempt to access some uninitilized/invalid memory past the
valid skb->data.
Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
Closes: https://syzkaller.appspot.com/bug?extid=6ea290ba76d8c1eb1ac2
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=219960a48771b35a3857a491b955c31d6c33d581)

| -rw-r--r-- | [net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_core.c?id=219960a48771b35a3857a491b955c31d6c33d581) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 4 deletions

| diff --git a/net/bluetooth/hci\_core.c b/net/bluetooth/hci\_core.cindex 7dff3f1a2a9eb6..7ed5d6e47e4f35 100644--- a/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=dfb3f9d3f602602de208da7bdcc0f6d5ee74af68)+++ b/[net/bluetooth/hci\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_core.c?id=219960a48771b35a3857a491b955c31d6c33d581)@@ -4943,18 +4943,22 @@ static void hci\_tx\_work(struct work\_struct \*work) /\* ACL data packet \*/ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) {- struct hci\_acl\_hdr \*hdr = (void \*) skb->data;+ struct hci\_acl\_hdr \*hdr; struct hci\_conn \*conn; \_\_u16 handle, flags; - skb\_pull(skb, HCI\_ACL\_HDR\_SIZE);+ hdr = skb\_pull\_data(skb, sizeof(\*hdr));+ if (!hdr) {+ bt\_dev\_err(hdev, "ACL packet too small");+ goto drop;+ }  handle = \_\_le16\_to\_cpu(hdr->handle); flags = hci\_flags(handle); handle = hci\_handle(handle); - BT\_DBG("%s len %d handle 0x%4.4x flags 0x%4.4x", hdev->name, skb->len,- handle, flags);+ bt\_dev\_dbg(hdev, "len %d handle 0x%4.4x flags 0x%4.4x", skb->len,+ handle, flags);  hdev->stat.acl\_rx++; @@ -4973,6 +4977,7 @@ static void hci\_acldata\_packet(struct hci\_dev \*hdev, struct sk\_buff \*skb) handle); } +drop: kfree\_skb(skb); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:35:48 +0000


