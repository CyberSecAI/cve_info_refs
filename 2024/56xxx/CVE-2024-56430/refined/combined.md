=== Content from github.com_c804dac1_20250114_230206.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfheorg%2Fopenfhe-development%2Fblob%2F7b8346f4eac27121543e36c17237b919e03ec058%2Fsrc%2Fbinfhe%2Flib%2Fbinfhe-base-scheme.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfheorg%2Fopenfhe-development%2Fblob%2F7b8346f4eac27121543e36c17237b919e03ec058%2Fsrc%2Fbinfhe%2Flib%2Fbinfhe-base-scheme.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openfheorg%2Fopenfhe-development)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openfheorg](/openfheorg)
/
**[openfhe-development](/openfheorg/openfhe-development)**
Public

* [Notifications](/login?return_to=%2Fopenfheorg%2Fopenfhe-development) You must be signed in to change notification settings
* [Fork
  200](/login?return_to=%2Fopenfheorg%2Fopenfhe-development)
* [Star
   801](/login?return_to=%2Fopenfheorg%2Fopenfhe-development)

* [Code](/openfheorg/openfhe-development)
* [Issues
  72](/openfheorg/openfhe-development/issues)
* [Pull requests
  12](/openfheorg/openfhe-development/pulls)
* [Discussions](/openfheorg/openfhe-development/discussions)
* [Actions](/openfheorg/openfhe-development/actions)
* [Projects
  0](/openfheorg/openfhe-development/projects)
* [Wiki](/openfheorg/openfhe-development/wiki)
* [Security](/openfheorg/openfhe-development/security)
* [Insights](/openfheorg/openfhe-development/pulse)

Additional navigation options

* [Code](/openfheorg/openfhe-development)
* [Issues](/openfheorg/openfhe-development/issues)
* [Pull requests](/openfheorg/openfhe-development/pulls)
* [Discussions](/openfheorg/openfhe-development/discussions)
* [Actions](/openfheorg/openfhe-development/actions)
* [Projects](/openfheorg/openfhe-development/projects)
* [Wiki](/openfheorg/openfhe-development/wiki)
* [Security](/openfheorg/openfhe-development/security)
* [Insights](/openfheorg/openfhe-development/pulse)

## Files

 7b8346f
## Breadcrumbs

1. [openfhe-development](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058)
2. /[src](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src)
3. /[binfhe](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe)
4. /[lib](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe/lib)
/
# binfhe-base-scheme.cpp

Copy path Blame  Blame
## Latest commit

## History

[History](/openfheorg/openfhe-development/commits/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe/lib/binfhe-base-scheme.cpp)607 lines (518 loc) · 25.1 KB 7b8346f
## Breadcrumbs

1. [openfhe-development](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058)
2. /[src](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src)
3. /[binfhe](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe)
4. /[lib](/openfheorg/openfhe-development/tree/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe/lib)
/
# binfhe-base-scheme.cpp

Top
## File metadata and controls

* Code
* Blame

607 lines (518 loc) · 25.1 KB[Raw](https://github.com/openfheorg/openfhe-development/raw/7b8346f4eac27121543e36c17237b919e03ec058/src/binfhe/lib/binfhe-base-scheme.cpp)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607//==================================================================================// BSD 2-Clause License//// Copyright (c) 2014-2022, NJIT, Duality Technologies Inc. and other contributors//// All rights reserved.//// Author TPOC: contact@openfhe.org//// Redistribution and use in source and binary forms, with or without// modification, are permitted provided that the following conditions are met://// 1. Redistributions of source code must retain the above copyright notice, this// list of conditions and the following disclaimer.//// 2. Redistributions in binary form must reproduce the above copyright notice,// this list of conditions and the following disclaimer in the documentation// and/or other materials provided with the distribution.//// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.//==================================================================================
#include "binfhe-base-scheme.h"
#include <string>
namespace lbcrypto {
// wrapper for KeyGen methodsRingGSWBTKey BinFHEScheme::KeyGen(const std::shared\_ptr<BinFHECryptoParams>& params, ConstLWEPrivateKey& LWEsk, KEYGEN\_MODE keygenMode = SYM\_ENCRYPT) const { const auto& LWEParams = params->GetLWEParams();
 RingGSWBTKey ek; LWEPrivateKey skN; if (keygenMode == SYM\_ENCRYPT) { skN = LWEscheme->KeyGen(LWEParams->GetN(), LWEParams->GetQ()); } else if (keygenMode == PUB\_ENCRYPT) { ConstLWEKeyPair kpN = LWEscheme->KeyGenPair(LWEParams); skN = kpN->secretKey; ek.Pkey = kpN->publicKey; } else { OPENFHE\_THROW("Invalid KeyGen mode"); }
 ek.KSkey = LWEscheme->KeySwitchGen(LWEParams, LWEsk, skN);
 const auto& RGSWParams = params->GetRingGSWParams(); const auto& polyParams = RGSWParams->GetPolyParams(); NativePoly skNPoly(polyParams); skNPoly.SetValues(std::move(skN->GetElement()), Format::COEFFICIENT); skNPoly.SetFormat(Format::EVALUATION);
 ek.BSkey = ACCscheme->KeyGenAcc(RGSWParams, skNPoly, LWEsk);
 return ek;}
// Full evaluation as described in https://eprint.iacr.org/2020/086LWECiphertext BinFHEScheme::EvalBinGate(const std::shared\_ptr<BinFHECryptoParams>& params, BINGATE gate, const RingGSWBTKey& EK, ConstLWECiphertext& ct1, ConstLWECiphertext& ct2, bool extended) const { if (ct1 == ct2) OPENFHE\_THROW("Input ciphertexts should be independant");
 const auto& LWEParams = params->GetLWEParams(); NativeInteger Q{LWEParams->GetQ()};
 // input cts expected with SMALL\_DIM auto cct1 = (Q == ct1->GetModulus()) ? LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ct1) : std::make\_shared<LWECiphertextImpl>(\*ct1); const auto cct2 = (Q == ct2->GetModulus()) ? LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ct2) : ct2;
 // the additive homomorphic operation for XOR/NXOR is different from the other gates we compute // 2\*(ct1 + ct2) mod 4 for XOR, 0 -> 0, 2 -> 1 // XOR\_FAST and XNOR\_FAST are included for backwards compatibility; they map to XOR and XNOR if ((gate == XOR) || (gate == XNOR) || (gate == XOR\_FAST) || (gate == XNOR\_FAST)) { LWEscheme->EvalAddEq(cct1, cct2); LWEscheme->EvalAddEq(cct1, cct1); } else { // for all other gates, we simply compute (ct1 + ct2) mod 4 // for AND: 0,1 -> 0 and 2,3 -> 1 // for OR: 1,2 -> 1 and 3,0 -> 0 LWEscheme->EvalAddEq(cct1, cct2); }
 // the accumulator result is encrypted w.r.t. the transposed secret key // we can transpose "a" to get an encryption under the original secret key auto accVec{BootstrapGateCore(params, gate, EK.BSkey, cct1)->GetElements()}; accVec[0] = accVec[0].Transpose(); accVec[0].SetFormat(Format::COEFFICIENT); accVec[1].SetFormat(Format::COEFFICIENT);
 // hardcoded for p = 4 // we add Q/8 to "b" to map back to Q/4 (i.e., mod 2) arithmetic. NativeInteger b{(Q >> 3) + 1}; b.ModAddFastEq(accVec[1][0], Q);
 auto ctExt = std::make\_shared<LWECiphertextImpl>(std::move(accVec[0].GetValues()), b);
 if (extended) return ctExt; return LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ctExt);}
// Full evaluation as described in https://eprint.iacr.org/2020/086LWECiphertext BinFHEScheme::EvalBinGate(const std::shared\_ptr<BinFHECryptoParams>& params, BINGATE gate, const RingGSWBTKey& EK, const std::vector<LWECiphertext>& ctvector, bool extended) const {
 // check if the ciphertexts are all independent uint32\_t length = ctvector.size(); for (uint32\_t i = 0; i < length; ++i) { for (uint32\_t j = i + 1; j < length; ++j) { if (ctvector[i] == ctvector[j]) { OPENFHE\_THROW("Input ciphertexts should be independent"); } } }
 if ((gate == AND3) || (gate == OR3) || (gate == AND4) || (gate == OR4) || (gate == MAJORITY)) { const auto& LWEParams = params->GetLWEParams(); NativeInteger Q{LWEParams->GetQ()};
 // input cts expected with SMALL\_DIM auto ct = (Q == ctvector[0]->GetModulus()) ? LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ctvector[0]) : std::make\_shared<LWECiphertextImpl>(\*ctvector[0]); for (uint32\_t i = 1; i < length; ++i) { LWEscheme->EvalAddEq(ct, (Q == ctvector[i]->GetModulus()) ? LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ctvector[i]) : ctvector[i]); }
 auto p = ctvector[0]->GetptModulus(); ct->SetptModulus(p);
 // the accumulator result is encrypted w.r.t. the transposed secret key // we can transpose "a" to get an encryption under the original secret key auto accVec{BootstrapGateCore(params, gate, EK.BSkey, ct)->GetElements()}; accVec[0] = accVec[0].Transpose(); accVec[0].SetFormat(Format::COEFFICIENT); accVec[1].SetFormat(Format::COEFFICIENT);
 NativeInteger b = Q / (p \* 2) + 1; b.ModAddFastEq(accVec[1][0], Q);
 auto ctExt = std::make\_shared<LWECiphertextImpl>(std::move(accVec[0].GetValues()), b);
 if (!extended) ctExt = LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ctExt);
 ctExt->SetptModulus(p); return ctExt; } else if (gate == CMUX) { if (length != 3) OPENFHE\_THROW("CMUX gate implemented for ciphertext vectors of size 3");
 auto&& ctNAND1 = EvalBinGate(params, NAND, EK, ctvector[0], EvalNOT(params, ctvector[2])); auto&& ctNAND2 = EvalBinGate(params, NAND, EK, ctvector[1], ctvector[2]); return EvalBinGate(params, NAND, EK, ctNAND1, ctNAND2); } else { OPENFHE\_THROW("This gate is not implemented for vector of ciphertexts at this time"); }}
// Full evaluation as described in https://eprint.iacr.org/2020/086LWECiphertext BinFHEScheme::Bootstrap(const std::shared\_ptr<BinFHECryptoParams>& params, const RingGSWBTKey& EK, ConstLWECiphertext& ct, bool extended) const {
 const auto& LWEParams = params->GetLWEParams(); NativeInteger Q{LWEParams->GetQ()}; // input ct expected with SMALL\_DIM auto cct = (Q == ct->GetModulus()) ? LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ct) : std::make\_shared<LWECiphertextImpl>(\*ct); LWEscheme->EvalAddConstEq(cct, (ct->GetModulus() >> 2));
 // the accumulator result is encrypted w.r.t. the transposed secret key // we can transpose "a" to get an encryption under the original secret key auto accVec{BootstrapGateCore(params, AND, EK.BSkey, cct)->GetElements()}; accVec[0] = accVec[0].Transpose(); accVec[0].SetFormat(Format::COEFFICIENT); accVec[1].SetFormat(Format::COEFFICIENT);
 NativeInteger b{Q / (ct->GetptModulus() \* 2) + 1}; b.ModAddFastEq(accVec[1][0], Q);
 auto ctExt = std::make\_shared<LWECiphertextImpl>(std::move(accVec[0].GetValues()), b);
 if (!extended) ctExt = LWEscheme->SwitchCTtoqn(LWEParams, EK.KSkey, ctExt);
 ctExt->SetptModulus(ct->GetptModulus()); return ctExt;}
// Evaluation of the NOT operation; no key material is neededLWECiphertext BinFHEScheme::EvalNOT(const std::shared\_ptr<BinFHECryptoParams>& params, ConstLWECiphertext& ct) const { NativeInteger q{ct->GetModulus()}; uint32\_t n{ct->GetLength()};
 NativeVector a(n, q); for (uint32\_t i = 0; i < n; ++i) a[i] = ct->GetA(i) == 0 ? 0 : q - ct->GetA(i);
 return std::make\_shared<LWECiphertextImpl>(std::move(a), (q >> 2).ModSubFast(ct->GetB(), q));}
// Evaluate Arbitrary Function homomorphically// Modulus of ct is q | 2NLWECiphertext BinFHEScheme::EvalFunc(const std::shared\_ptr<BinFHECryptoParams>& params, const RingGSWBTKey& EK, ConstLWECiphertext& ct, const std::vector<NativeInteger>& LUT, const NativeInteger& beta) const { auto ct1 = std::make\_shared<LWECiphertextImpl>(\*ct); NativeInteger q{ct->GetModulus()}; uint32\_t functionProperty{this->checkInputFunction(LUT, q)};
 if (functionProperty == 0) { // negacyclic function only needs one bootstrap auto fLUT = [LUT](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { return LUT[x.ConvertToInt()]; }; LWEscheme->EvalAddConstEq(ct1, beta); return BootstrapFunc(params, EK, ct1, fLUT, q); }
 if (functionProperty == 2) { // arbitary funciton const auto& LWEParams = params->GetLWEParams(); uint32\_t N{LWEParams->GetN()}; if (q.ConvertToInt() > N) { // need q to be at most = N for arbitary function std::string errMsg = "ERROR: ciphertext modulus q needs to be <= ring dimension for arbitrary function evaluation"; OPENFHE\_THROW(errMsg); }
 // TODO: figure out a way to not do this :(
 // repeat the LUT to make it periodic std::vector<NativeInteger> LUT2; LUT2.reserve(LUT.size() + LUT.size()); LUT2.insert(LUT2.end(), LUT.begin(), LUT.end()); LUT2.insert(LUT2.end(), LUT.begin(), LUT.end());
 NativeInteger dq{q << 1}; // raise the modulus of ct1 : q -> 2q ct1->GetA().SetModulus(dq); auto ct2 = std::make\_shared<LWECiphertextImpl>(\*ct1); LWEscheme->EvalAddConstEq(ct2, beta);
 // this is 1/4q\_small or -1/4q\_small mod q auto f0 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 1)) return Q - (q >> 2); else return (q >> 2); }; auto ct3 = BootstrapFunc(params, EK, ct2, f0, dq); LWEscheme->EvalSubEq2(ct1, ct3); LWEscheme->EvalAddConstEq(ct3, beta); LWEscheme->EvalSubConstEq(ct3, q >> 1);
 // Now the input is within the range [0, q/2). // Note that for non-periodic function, the input q is boosted up to 2q auto fLUT2 = [LUT2](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 1)) return LUT2[x.ConvertToInt()]; else return Q - LUT2[x.ConvertToInt() - q.ConvertToInt() / 2]; }; auto ct4 = BootstrapFunc(params, EK, ct3, fLUT2, dq); ct4->SetModulus(q); return ct4; }
 // Else it's periodic function so we evaluate directly LWEscheme->EvalAddConstEq(ct1, beta); // this is 1/4q\_small or -1/4q\_small mod q auto f0 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 1)) return Q - (q >> 2); else return (q >> 2); }; auto ct2 = BootstrapFunc(params, EK, ct1, f0, q); LWEscheme->EvalSubEq2(ct, ct2); LWEscheme->EvalAddConstEq(ct2, beta); LWEscheme->EvalSubConstEq(ct2, q >> 2);
 // Now the input is within the range [0, q/2). // Note that for non-periodic function, the input q is boosted up to 2q auto fLUT1 = [LUT](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 1)) return LUT[x.ConvertToInt()]; else return Q - LUT[x.ConvertToInt() - q.ConvertToInt() / 2]; }; return BootstrapFunc(params, EK, ct2, fLUT1, q);}
// Evaluate Homomorphic FlooringLWECiphertext BinFHEScheme::EvalFloor(const std::shared\_ptr<BinFHECryptoParams>& params, const RingGSWBTKey& EK, ConstLWECiphertext& ct, const NativeInteger& beta, uint32\_t roundbits) const { const auto& LWEParams = params->GetLWEParams(); NativeInteger q{roundbits == 0 ? LWEParams->Getq() : beta \* (1 << (roundbits + 1))}; NativeInteger mod{ct->GetModulus()};
 auto ct1 = std::make\_shared<LWECiphertextImpl>(\*ct); LWEscheme->EvalAddConstEq(ct1, beta);
 auto ct1Modq = std::make\_shared<LWECiphertextImpl>(\*ct1); ct1Modq->SetModulus(q); // this is 1/4q\_small or -1/4q\_small mod q auto f1 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 1)) return Q - (q >> 2); else return (q >> 2); }; auto ct2 = BootstrapFunc(params, EK, ct1Modq, f1, mod); LWEscheme->EvalSubEq(ct1, ct2);
 auto ct2Modq = std::make\_shared<LWECiphertextImpl>(\*ct1); ct2Modq->SetModulus(q);
 // now the input is only within the range [0, q/2) auto f2 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { if (x < (q >> 2)) return Q - (q >> 1) - x; else if (((q >> 2) <= x) && (x < 3 \* (q >> 2))) return x; else return Q + (q >> 1) - x; }; auto ct3 = BootstrapFunc(params, EK, ct2Modq, f2, mod); LWEscheme->EvalSubEq(ct1, ct3);
 return ct1;}
// Evaluate large-precision signLWECiphertext BinFHEScheme::EvalSign(const std::shared\_ptr<BinFHECryptoParams>& params, const std::map<uint32\_t, RingGSWBTKey>& EKs, ConstLWECiphertext& ct, const NativeInteger& beta, bool schemeSwitch) const { auto mod{ct->GetModulus()}; const auto& LWEParams = params->GetLWEParams(); auto q{LWEParams->Getq()}; if (mod <= q) { std::string errMsg = "ERROR: EvalSign is only for large precision. For small precision, please use bootstrapping directly"; OPENFHE\_THROW(errMsg); }
 const auto& RGSWParams = params->GetRingGSWParams(); const auto curBase = RGSWParams->GetBaseG(); auto search = EKs.find(curBase); if (search == EKs.end()) { std::string errMsg("ERROR: No key [" + std::to\_string(curBase) + "] found in the map"); OPENFHE\_THROW(errMsg); } RingGSWBTKey curEK(search->second);
 auto cttmp = std::make\_shared<LWECiphertextImpl>(\*ct); while (mod > q) { cttmp = EvalFloor(params, curEK, cttmp, beta); // round Q to 2betaQ/q // mod = mod / q \* 2 \* beta; mod = (mod << 1) \* beta / q; cttmp = LWEscheme->ModSwitch(mod, cttmp);
 // if dynamic if (EKs.size() == 3) { // TODO: use GetMSB()? uint32\_t binLog = static\_cast<uint32\_t>(ceil(GetMSB(mod.ConvertToInt()) - 1)); uint32\_t base{0}; if (binLog <= static\_cast<uint32\_t>(17)) base = static\_cast<uint32\_t>(1) << 27; else if (binLog <= static\_cast<uint32\_t>(26)) base = static\_cast<uint32\_t>(1) << 18;
 if (0 != base) { // if base is to change ... RGSWParams->Change\_BaseG(base);
 auto search = EKs.find(base); if (search == EKs.end()) { std::string errMsg("ERROR: No key [" + std::to\_string(curBase) + "] found in the map"); OPENFHE\_THROW(errMsg); } curEK = search->second; } } } LWEscheme->EvalAddConstEq(cttmp, beta);
 if (!schemeSwitch) { // if the ended q is smaller than q, we need to change the param for the final boostrapping auto f3 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { return (x < q / 2) ? (Q / 4) : (Q - Q / 4); }; cttmp = BootstrapFunc(params, curEK, cttmp, f3, q); // this is 1/4q\_small or -1/4q\_small mod q LWEscheme->EvalSubConstEq(cttmp, q >> 2); } else { // return the negated f3 and do not subtract q/4 for a more natural encoding in scheme switching // if the ended q is smaller than q, we need to change the param for the final boostrapping auto f3 = [](NativeInteger x, NativeInteger q, NativeInteger Q) -> NativeInteger { return (x < q / 2) ? (Q - Q / 4) : (Q / 4); }; cttmp = BootstrapFunc(params, curEK, cttmp, f3, q); // this is 1/4q\_small or -1/4q\_small mod q } RGSWParams->Change\_BaseG(curBase); return cttmp;}
// Evaluate Ciphertext Decompositionstd::vector<LWECiphertext> BinFHEScheme::EvalDecomp(const std::shared\_ptr<BinFHECryptoParams>& params, const std::map<uint32\_t, RingGSWBTKey>& EKs, ConstLWECiphertext& ct, const NativeInteger& beta) const { auto mod = ct->GetModulus(); auto& LWEParams = params->GetLWEParams(); auto& RGSWParams = params->GetRingGSWParams();
 NativeInteger q = LWEParams->Getq(); if (mod <= q) { std::string errMsg = "ERROR: EvalDecomp is only for large precision. For small precision, please use bootstrapping directly"; OPENFHE\_THROW(errMsg); }
 const auto curBase = RGSWParams->GetBaseG(); auto search = EKs.find(curBase); if (search == EKs.end()) { std::string errMsg("ERROR: No key [" + std::to\_string(curBase) + "] found in the map"); OPENFHE\_THROW(errMsg); } RingGSWBTKey curEK(search->second);
 auto cttmp = std::make\_shared<LWECiphertextImpl>(\*ct); std::vector<LWECiphertext> ret; while (mod > q) { auto ctq = std::make\_shared<LWECiphertextImpl>(\*cttmp); ctq->SetModulus(q); ret.push\_back(std::move(ctq));
 // Floor the input sequentially to obtain the most significant bit cttmp = EvalFloor(params, curEK, cttmp, beta); mod = mod / q \* 2 \* beta; // round Q to 2betaQ/q cttmp = LWEscheme->ModSwitch(mod, cttmp);
 if (EKs.size() == 3) { // if dynamic uint32\_t binLog = static\_cast<uint32\_t>(ceil(log2(mod.ConvertToInt()))); uint32\_t base = 0; if (binLog <= static\_cast<uint32\_t>(17)) base = static\_cast<uint32\_t>(1) << 27; else if (binLog <= static\_cast<uint32\_t>(26)) base = static\_cast<uint32\_t>(1) << 18;
 if (0 != base) { // if base is to change ... RGSWParams->Change\_BaseG(base);
 auto search = EKs.find(base); if (search == EKs.end()) { std::string errMsg("ERROR: No key [" + std::to\_string(curBase) + "] found in the map"); OPENFHE\_THROW(errMsg); } curEK = search->second; } } } RGSWParams->Change\_BaseG(curBase); ret.push\_back(std::move(cttmp)); return ret;}
// private:
RLWECiphertext BinFHEScheme::BootstrapGateCore(const std::shared\_ptr<BinFHECryptoParams>& params, BINGATE gate, ConstRingGSWACCKey& ek, ConstLWECiphertext& ct) const { if (ek == nullptr) { std::string errMsg = "Bootstrapping keys have not been generated. Please call BTKeyGen " "before calling bootstrapping."; OPENFHE\_THROW(errMsg); }
 // Specifies the range [lb, ub) that will be used for mapping NativeInteger q = ct->GetModulus(); auto qHalf = q.ConvertToInt<uint32\_t>() >> 1; auto& RGSWParams = params->GetRingGSWParams(); NativeInteger q1 = RGSWParams->GetGateConst()[static\_cast<size\_t>(gate)]; NativeInteger q2 = q1.ModAddFast(NativeInteger(qHalf), q);
 bool swap = q1 >= q2; auto lb = swap? q2 : q1; auto ub = swap? q1 : q2;
 // depending on whether the value is the range, it will be set // to either Q/8 or -Q/8 to match binary arithmetic auto& LWEParams = params->GetLWEParams(); NativeInteger Q = LWEParams->GetQ(); NativeInteger Q2p = Q / (ct->GetptModulus() \* 2) + 1; NativeInteger Q2pNeg = Q - Q2p;
 auto lv = swap? Q2p : Q2pNeg; auto uv = swap? Q2pNeg : Q2p;
 const uint32\_t N = LWEParams->GetN(); NativeVector m(N, Q); // Since q | (2\*N), we deal with a sparse embedding of Z\_Q[x]/(X^{q/2}+1) to // Z\_Q[x]/(X^N+1)
 const uint32\_t factor = (N / qHalf);
 NativeInteger b = ct->GetB();
 for (uint32\_t i = 0; i < N; i += factor) { m[i] = ((b >= lb) && (b < ub)) ? lv : uv; b.ModSubFastEq(1, q); }
 std::vector<NativePoly> res(2); auto& polyParams = RGSWParams->GetPolyParams(); // no need to do NTT as all coefficients of this poly are zero res[0] = NativePoly(polyParams, Format::EVALUATION, true); res[1] = NativePoly(polyParams, Format::COEFFICIENT, false); res[1].SetValues(std::move(m), Format::COEFFICIENT); res[1].SetFormat(Format::EVALUATION);
 // main accumulation computation // the following loop is the bottleneck of bootstrapping/binary gate // evaluation auto acc = std::make\_shared<RLWECiphertextImpl>(std::move(res)); ACCscheme->EvalAcc(RGSWParams, ek, acc, ct->GetA()); return acc;}
// Functions below are for large-precision sign evaluation,// flooring, homomorphic digit decomposition, and arbitrary// funciton evaluation, from https://eprint.iacr.org/2021/1337template <typename Func>RLWECiphertext BinFHEScheme::BootstrapFuncCore(const std::shared\_ptr<BinFHECryptoParams>& params, ConstRingGSWACCKey& ek, ConstLWECiphertext& ct, const Func f, const NativeInteger& fmod) const { if (ek == nullptr) { std::string errMsg = "Bootstrapping keys have not been generated. Please call BTKeyGen before calling bootstrapping."; OPENFHE\_THROW(errMsg); }
 auto& LWEParams = params->GetLWEParams(); auto& RGSWParams = params->GetRingGSWParams(); auto polyParams = RGSWParams->GetPolyParams();
 NativeInteger Q = LWEParams->GetQ(); uint32\_t N = LWEParams->GetN(); NativeVector m(N, Q); // For specific function evaluation instead of general bootstrapping NativeInteger ctMod = ct->GetModulus(); uint32\_t factor = (2 \* N / ctMod.ConvertToInt()); const NativeInteger& b = ct->GetB(); for (size\_t j = 0; j < (ctMod >> 1); ++j) { NativeInteger temp = b.ModSub(j, ctMod); m[j \* factor] = Q.ConvertToInt() / fmod.ConvertToInt() \* f(temp, ctMod, fmod); } std::vector<NativePoly> res(2); // no need to do NTT as all coefficients of this poly are zero res[0] = NativePoly(polyParams, Format::EVALUATION, true); res[1] = NativePoly(polyParams, Format::COEFFICIENT, false); res[1].SetValues(std::move(m), Format::COEFFICIENT); res[1].SetFormat(Format::EVALUATION);
 // main accumulation computation // the following loop is the bottleneck of bootstrapping/binary gate // evaluation auto acc = std::make\_shared<RLWECiphertextImpl>(std::move(res)); ACCscheme->EvalAcc(RGSWParams, ek, acc, ct->GetA()); return acc;}
// Full evaluation as described in https://eprint.iacr.org/2020/086template <typename Func>LWECiphertext BinFHEScheme::BootstrapFunc(const std::shared\_ptr<BinFHECryptoParams>& params, const RingGSWBTKey& EK, ConstLWECiphertext& ct, const Func f, const NativeInteger& fmod) const { // the accumulator result is encrypted w.r.t. the transposed secret key // we can transpose "a" to get an encryption under the original secret key auto accVec{BootstrapFuncCore(params, EK.BSkey, ct, f, fmod)->GetElements()}; accVec[0] = accVec[0].Transpose(); accVec[0].SetFormat(Format::COEFFICIENT); accVec[1].SetFormat(Format::COEFFICIENT);
 auto ctExt = std::make\_shared<LWECiphertextImpl>(std::move(accVec[0].GetValues()), accVec[1][0]);
 auto& LWEParams = params->GetLWEParams(); // Modulus switching to a middle step Q' auto ctMS = LWEscheme->ModSwitch(LWEParams->GetqKS(), ctExt); // Key switching auto ctKS = LWEscheme->KeySwitch(LWEParams, EK.KSkey, ctMS); // Modulus switching return LWEscheme->ModSwitch(fmod, ctKS);}
}; // namespace lbcrypto

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_04302c28_20250114_230203.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUnionTech-Software%2Fopenfhe-PoC)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUnionTech-Software%2Fopenfhe-PoC)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=UnionTech-Software%2Fopenfhe-PoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[UnionTech-Software](/UnionTech-Software)
/
**[openfhe-PoC](/UnionTech-Software/openfhe-PoC)**
Public

* [Notifications](/login?return_to=%2FUnionTech-Software%2Fopenfhe-PoC) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FUnionTech-Software%2Fopenfhe-PoC)
* [Star
   0](/login?return_to=%2FUnionTech-Software%2Fopenfhe-PoC)

[0
stars](/UnionTech-Software/openfhe-PoC/stargazers) [0
forks](/UnionTech-Software/openfhe-PoC/forks) [Branches](/UnionTech-Software/openfhe-PoC/branches) [Tags](/UnionTech-Software/openfhe-PoC/tags) [Activity](/UnionTech-Software/openfhe-PoC/activity)
 [Star](/login?return_to=%2FUnionTech-Software%2Fopenfhe-PoC)

 [Notifications](/login?return_to=%2FUnionTech-Software%2Fopenfhe-PoC) You must be signed in to change notification settings

* [Code](/UnionTech-Software/openfhe-PoC)
* [Issues
  0](/UnionTech-Software/openfhe-PoC/issues)
* [Pull requests
  0](/UnionTech-Software/openfhe-PoC/pulls)
* [Actions](/UnionTech-Software/openfhe-PoC/actions)
* [Projects
  0](/UnionTech-Software/openfhe-PoC/projects)
* [Security](/UnionTech-Software/openfhe-PoC/security)
* [Insights](/UnionTech-Software/openfhe-PoC/pulse)

Additional navigation options

* [Code](/UnionTech-Software/openfhe-PoC)
* [Issues](/UnionTech-Software/openfhe-PoC/issues)
* [Pull requests](/UnionTech-Software/openfhe-PoC/pulls)
* [Actions](/UnionTech-Software/openfhe-PoC/actions)
* [Projects](/UnionTech-Software/openfhe-PoC/projects)
* [Security](/UnionTech-Software/openfhe-PoC/security)
* [Insights](/UnionTech-Software/openfhe-PoC/pulse)

# UnionTech-Software/openfhe-PoC

    master[Branches](/UnionTech-Software/openfhe-PoC/branches)[Tags](/UnionTech-Software/openfhe-PoC/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2 Commits](/UnionTech-Software/openfhe-PoC/commits/master/) | | |
| [build](/UnionTech-Software/openfhe-PoC/tree/master/build "build") | | [build](/UnionTech-Software/openfhe-PoC/tree/master/build "build") |  |  |
| [CMakeLists.txt](/UnionTech-Software/openfhe-PoC/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/UnionTech-Software/openfhe-PoC/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [readme.md](/UnionTech-Software/openfhe-PoC/blob/master/readme.md "readme.md") | | [readme.md](/UnionTech-Software/openfhe-PoC/blob/master/readme.md "readme.md") |  |  |
| [test.cpp](/UnionTech-Software/openfhe-PoC/blob/master/test.cpp "test.cpp") | | [test.cpp](/UnionTech-Software/openfhe-PoC/blob/master/test.cpp "test.cpp") |  |  |
| View all files | | |

## Repository files navigation

* README

***\*1、Question\****

The PoC test code is as follows：

```
#include <iostream>

#include <string>

#include <stack>

#include <cstdlib>

#include <ctime>

#include <memory>

#include <fstream>

#include <iomanip>

#include "openfhe.h"

using namespace lbcrypto;

int main() {

  auto cc = BinFHEContext();

  cc.GenerateBinFHEContext(MEDIUM);

  auto sk = cc.KeyGen();

  cc.BTKeyGen(sk);

  auto ct = cc.EvalFloor(nullptr, 1);

  return 0;

}
```

After compiling the code, the execution reports a segmentation error：

> /home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/openfhe-development/src/binfhe/lib/binfhe-base-scheme.cpp:311:38: runtime error: member call on null pointer of type 'const struct element\_type'

> AddressSanitizer:DEADLYSIGNAL

> =================================================================

> ==12869==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fd3e9efa986 bp 0x0fffe636630c sp 0x7fff31b31720 T0)

> ==12869==The signal is caused by a READ memory access.

> ==12869==Hint: address points to the zero page.

> #0 0x7fd3e9efa985 in lbcrypto::BinFHEScheme::EvalFloor(std::shared\_ptrlbcrypto::BinFHECryptoParams const&, lbcrypto::RingGSWBTKey const&, std::shared\_ptr<lbcrypto::LWECiphertextImpl const> const&, intnat::NativeIntegerT const&, unsigned int) const /home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/openfhe-development/src/binfhe/lib/binfhe-base-scheme.cpp:311

> #1 0x7fd3e9ff1f73 in lbcrypto::BinFHEContext::EvalFloor(std::shared\_ptr<lbcrypto::LWECiphertextImpl const> const&, unsigned int) const /home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/openfhe-development/src/binfhe/lib/binfhecontext.cpp:312

> #2 0x406546 in main /home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/poc/poc7/test.cpp:18

> #3 0x7fd3e2a801fa in \_\_libc\_start\_main ../csu/libc-start.c:308

> #4 0x4075e9 in \_start (/home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/poc/poc7/build/test+0x4075e9)

> AddressSanitizer can not provide additional info.

> SUMMARY: AddressSanitizer: SEGV /home/dou/gerrit/CVE/PoC/openfhe/openfhe/openfhe/openfhe-development/src/binfhe/lib/binfhe-base-scheme.cpp:311 in lbcrypto::BinFHEScheme::EvalFloor(std::shared\_ptrlbcrypto::BinFHECryptoParams const&, lbcrypto::RingGSWBTKey const&, std::shared\_ptr<lbcrypto::LWECiphertextImpl const> const&, intnat::NativeIntegerT const&, unsigned int) const

> ==12869==ABORTING

***\*2、Analyze\****

According to the error message above, it can be known that the program is trying to access a null pointer, which causes a segmentation fault.

In the PoC code, a null pointer (nullptr) is indeed passed to `BinFHEContext::EvalFloor`, but `BinFHEContext::EvalFloor` does not handle the null pointer type, resulting in a segmentation fault.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/UnionTech-Software/openfhe-PoC/activity)
### Stars

[**0**
stars](/UnionTech-Software/openfhe-PoC/stargazers)
### Watchers

[**1**
watching](/UnionTech-Software/openfhe-PoC/watchers)
### Forks

[**0**
forks](/UnionTech-Software/openfhe-PoC/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FUnionTech-Software%2Fopenfhe-PoC&report=UnionTech-Software+%28user%29)

## [Releases](/UnionTech-Software/openfhe-PoC/releases)

No releases published

## [Packages 0](/users/UnionTech-Software/packages?repo_name=openfhe-PoC)

No packages published

## Languages

* [Makefile
  49.4%](/UnionTech-Software/openfhe-PoC/search?l=makefile)
* [C++
  30.7%](/UnionTech-Software/openfhe-PoC/search?l=c%2B%2B)
* [CMake
  19.8%](/UnionTech-Software/openfhe-PoC/search?l=cmake)
* [TypeScript
  0.1%](/UnionTech-Software/openfhe-PoC/search?l=typescript)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fd16546d_20250114_230207.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfheorg%2Fopenfhe-development%2Freleases%2Ftag%2Fv1.2.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenfheorg%2Fopenfhe-development%2Freleases%2Ftag%2Fv1.2.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=openfheorg%2Fopenfhe-development)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openfheorg](/openfheorg)
/
**[openfhe-development](/openfheorg/openfhe-development)**
Public

* [Notifications](/login?return_to=%2Fopenfheorg%2Fopenfhe-development) You must be signed in to change notification settings
* [Fork
  200](/login?return_to=%2Fopenfheorg%2Fopenfhe-development)
* [Star
   801](/login?return_to=%2Fopenfheorg%2Fopenfhe-development)

* [Code](/openfheorg/openfhe-development/tree/v1.2.3)
* [Issues
  72](/openfheorg/openfhe-development/issues)
* [Pull requests
  12](/openfheorg/openfhe-development/pulls)
* [Discussions](/openfheorg/openfhe-development/discussions)
* [Actions](/openfheorg/openfhe-development/actions)
* [Projects
  0](/openfheorg/openfhe-development/projects)
* [Wiki](/openfheorg/openfhe-development/wiki)
* [Security](/openfheorg/openfhe-development/security)
* [Insights](/openfheorg/openfhe-development/pulse)

Additional navigation options

* [Code](/openfheorg/openfhe-development/tree/v1.2.3)
* [Issues](/openfheorg/openfhe-development/issues)
* [Pull requests](/openfheorg/openfhe-development/pulls)
* [Discussions](/openfheorg/openfhe-development/discussions)
* [Actions](/openfheorg/openfhe-development/actions)
* [Projects](/openfheorg/openfhe-development/projects)
* [Wiki](/openfheorg/openfhe-development/wiki)
* [Security](/openfheorg/openfhe-development/security)
* [Insights](/openfheorg/openfhe-development/pulse)

1. [Releases](/openfheorg/openfhe-development/releases)
2. [v1.2.3](/openfheorg/openfhe-development/releases/tag/v1.2.3)

# Release v1.2.3

[Latest](/openfheorg/openfhe-development/releases/latest)

[Latest](/openfheorg/openfhe-development/releases/latest)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/openfheorg/openfhe-development/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.2.3)

 Loading

[View all tags](/openfheorg/openfhe-development/tags)

![@yspolyakov](https://avatars.githubusercontent.com/u/89226542?s=40&v=4)
[yspolyakov](/yspolyakov)
released this
30 Oct 22:04

[v1.2.3](/openfheorg/openfhe-development/tree/v1.2.3)

[`7b8346f`](/openfheorg/openfhe-development/commit/7b8346f4eac27121543e36c17237b919e03ec058)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

* Adds support for a custom PRNG implemented in an external library

The detailed list of changes is available at <https://github.com/openfheorg/openfhe-development/issues?q=is%3Aissue+milestone%3A%22Release+1.2.3%22>

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


